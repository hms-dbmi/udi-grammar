var Ode=Object.defineProperty;var Lde=(e,t,n)=>t in e?Ode(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Gh=(e,t,n)=>Lde(e,typeof t!="symbol"?t+"":t,n);import{aa as Nde,r as pn,d as kp,a as KT,w as yv,L as Wi,N as Xw,J as $de,ab as zD,O as YT,H as jn,c as mu,M as Bde,ac as $g,ad as pG,ae as Gde,af as zde,ag as Hde,g as hy,ah as Vde,o as Wde,ai as gG,I as Ude,aj as mG,ak as jde,al as qde,am as Kde,an as Yde,E as HD,P as NW,ao as Xde}from"./index-d8NWz7tZ.js";import{_ as XT}from"./_plugin-vue_export-helper-DlAUqK2U.js";var fy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};const Qde=/("(?:[^\\"]|\\.)*")|[:,]/g;function lF(e,t={}){const n=JSON.stringify([1],void 0,t.indent===void 0?2:t.indent).slice(2,-3),i=n===""?1/0:t.maxLength===void 0?80:t.maxLength;let{replacer:r}=t;return function s(o,a,l){o&&typeof o.toJSON=="function"&&(o=o.toJSON());const u=JSON.stringify(o,r);if(u===void 0)return u;const c=i-a.length-l;if(u.length<=c){const d=u.replace(Qde,(h,p)=>p||`${h} `);if(d.length<=c)return d}if(r!=null&&(o=JSON.parse(u),r=void 0),typeof o=="object"&&o!==null){const d=a+n,h=[];let p=0,g,v;if(Array.isArray(o)){g="[",v="]";const{length:C}=o;for(;p<C;p++)h.push(s(o[p],d,p===C-1?0:1)||"null")}else{g="{",v="}";const C=Object.keys(o),{length:y}=C;for(;p<y;p++){const b=C[p],S=`${JSON.stringify(b)}: `,x=s(o[b],d,S.length+(p===y-1?0:1));x!==void 0&&h.push(S+x)}}if(h.length>0)return[g,n+h.join(`,
${d}`),v].join(`
${a}`)}return u}(e,"",0)}function Ir(e,t,n){return e.fields=t||[],e.fname=n,e}function yn(e){return e==null?null:e.fname}function Pi(e){return e==null?null:e.fields}function $W(e){return e.length===1?Jde(e[0]):Zde(e)}const Jde=e=>function(t){return t[e]},Zde=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function Z(e){throw Error(e)}function Aa(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,l;e=e+"";function u(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(l=e[a],l==="\\")s+=e.substring(o,a++),o=a;else if(l===i)u(),i=null,r=-1;else{if(i)continue;o===r&&l==='"'||o===r&&l==="'"?(o=a+1,i=l):l==="."&&!r?a>o?u():o=a+1:l==="["?(a>o&&u(),r=o=a+1):l==="]"&&(r||Z("Access path missing open bracket: "+e),r>0&&u(),r=0,o=a+1)}return r&&Z("Access path missing closing bracket: "+e),i&&Z("Access path missing closing quote: "+e),a>o&&(a++,u()),t}function Ms(e,t,n){const i=Aa(e);return e=i.length===1?i[0]:e,Ir((n&&n.get||$W)(i),[e],t||e)}const C0=Ms("id"),_i=Ir(e=>e,[],"identity"),xu=Ir(()=>0,[],"zero"),Tp=Ir(()=>1,[],"one"),Is=Ir(()=>!0,[],"true"),fu=Ir(()=>!1,[],"false");function ehe(e,t,n){const i=[t].concat([].slice.call(n));console[e].apply(console,i)}const BW=0,QT=1,JT=2,GW=3,zW=4;function ZT(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ehe,i=e||BW;return{level(r){return arguments.length?(i=+r,this):i},error(){return i>=QT&&n(t||"error","ERROR",arguments),this},warn(){return i>=JT&&n(t||"warn","WARN",arguments),this},info(){return i>=GW&&n(t||"log","INFO",arguments),this},debug(){return i>=zW&&n(t||"log","DEBUG",arguments),this}}}var te=Array.isArray;function ye(e){return e===Object(e)}const vG=e=>e!=="__proto__";function Mp(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((i,r)=>{for(const s in r)if(s==="signals")i.signals=the(i.signals,r.signals);else{const o=s==="legend"?{layout:1}:s==="style"?!0:null;Ip(i,s,r[s],o)}return i},{})}function Ip(e,t,n,i){if(!vG(t))return;let r,s;if(ye(n)&&!te(n)){s=ye(e[t])?e[t]:e[t]={};for(r in n)i&&(i===!0||i[r])?Ip(s,r,n[r]):vG(r)&&(s[r]=n[r])}else e[t]=n}function the(e,t){if(e==null)return t;const n={},i=[];function r(s){n[s.name]||(n[s.name]=1,i.push(s))}return t.forEach(r),e.forEach(r),i}function gt(e){return e[e.length-1]}function Ai(e){return e==null||e===""?null:+e}const HW=e=>t=>e*Math.exp(t),VW=e=>t=>Math.log(e*t),WW=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),UW=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,Qw=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function l1(e,t,n,i){const r=n(e[0]),s=n(gt(e)),o=(s-r)*t;return[i(r-o),i(s-o)]}function jW(e,t){return l1(e,t,Ai,_i)}function qW(e,t){var n=Math.sign(e[0]);return l1(e,t,VW(n),HW(n))}function KW(e,t,n){return l1(e,t,Qw(n),Qw(1/n))}function YW(e,t,n){return l1(e,t,WW(n),UW(n))}function u1(e,t,n,i,r){const s=i(e[0]),o=i(gt(e)),a=t!=null?i(t):(s+o)/2;return[r(a+(s-a)*n),r(a+(o-a)*n)]}function eM(e,t,n){return u1(e,t,n,Ai,_i)}function tM(e,t,n){const i=Math.sign(e[0]);return u1(e,t,n,VW(i),HW(i))}function Jw(e,t,n,i){return u1(e,t,n,Qw(i),Qw(1/i))}function nM(e,t,n,i){return u1(e,t,n,WW(i),UW(i))}function XW(e){return 1+~~(new Date(e).getMonth()/3)}function QW(e){return 1+~~(new Date(e).getUTCMonth()/3)}function we(e){return e!=null?te(e)?e:[e]:[]}function JW(e,t,n){let i=e[0],r=e[1],s;return r<i&&(s=r,r=i,i=s),s=r-i,s>=n-t?[t,n]:[i=Math.min(Math.max(i,t),n-s),i+s]}function nt(e){return typeof e=="function"}const nhe="descending";function iM(e,t,n){n=n||{},t=we(t)||[];const i=[],r=[],s={},o=n.comparator||ihe;return we(e).forEach((a,l)=>{a!=null&&(i.push(t[l]===nhe?-1:1),r.push(a=nt(a)?a:Ms(a,null,n)),(Pi(a)||[]).forEach(u=>s[u]=1))}),r.length===0?null:Ir(o(r,i),Object.keys(s))}const _p=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),ihe=(e,t)=>e.length===1?rhe(e[0],t[0]):she(e,t,e.length),rhe=(e,t)=>function(n,i){return _p(e(n),e(i))*t},she=(e,t,n)=>(t.push(0),function(i,r){let s,o=0,a=-1;for(;o===0&&++a<n;)s=e[a],o=_p(s(i),s(r));return o*t[a]});function Oi(e){return nt(e)?e:()=>e}function rM(e,t){let n;return i=>{n&&clearTimeout(n),n=setTimeout(()=>(t(i),n=null),e)}}function Ze(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}function ma(e,t){let n=0,i,r,s,o;if(e&&(i=e.length))if(t==null){for(r=e[n];n<i&&(r==null||r!==r);r=e[++n]);for(s=o=r;n<i;++n)r=e[n],r!=null&&(r<s&&(s=r),r>o&&(o=r))}else{for(r=t(e[n]);n<i&&(r==null||r!==r);r=t(e[++n]));for(s=o=r;n<i;++n)r=t(e[n]),r!=null&&(r<s&&(s=r),r>o&&(o=r))}return[s,o]}function ZW(e,t){const n=e.length;let i=-1,r,s,o,a,l;if(t==null){for(;++i<n;)if(s=e[i],s!=null&&s>=s){r=o=s;break}if(i===n)return[-1,-1];for(a=l=i;++i<n;)s=e[i],s!=null&&(r>s&&(r=s,a=i),o<s&&(o=s,l=i))}else{for(;++i<n;)if(s=t(e[i],i,e),s!=null&&s>=s){r=o=s;break}if(i===n)return[-1,-1];for(a=l=i;++i<n;)s=t(e[i],i,e),s!=null&&(r>s&&(r=s,a=i),o<s&&(o=s,l=i))}return[a,l]}function Ee(e,t){return Object.hasOwn(e,t)}const py={};function Op(e){let t={},n;function i(s){return Ee(t,s)&&t[s]!==py}const r={size:0,empty:0,object:t,has:i,get(s){return i(s)?t[s]:void 0},set(s,o){return i(s)||(++r.size,t[s]===py&&--r.empty),t[s]=o,this},delete(s){return i(s)&&(--r.size,++r.empty,t[s]=py),this},clear(){r.size=r.empty=0,r.object=t={}},test(s){return arguments.length?(n=s,r):n},clean(){const s={};let o=0;for(const a in t){const l=t[a];l!==py&&(!n||!n(l))&&(s[a]=l,++o)}r.size=o,r.empty=0,r.object=t=s}};return e&&Object.keys(e).forEach(s=>{r.set(s,e[s])}),r}function e4(e,t,n,i,r,s){if(!n&&n!==0)return s;const o=+n;let a=e[0],l=gt(e),u;l<a&&(u=a,a=l,l=u),u=Math.abs(t-a);const c=Math.abs(l-t);return u<c&&u<=o?i:c<=o?r:s}function pe(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),Ze(i,n)}function lf(e,t,n,i){let r=t[0],s=t[t.length-1],o;return r>s&&(o=r,r=s,s=o),n=n===void 0||n,i=i===void 0||i,(n?r<=e:r<e)&&(i?e<=s:e<s)}function uc(e){return typeof e=="boolean"}function Ou(e){return Object.prototype.toString.call(e)==="[object Date]"}function t4(e){return e&&nt(e[Symbol.iterator])}function xt(e){return typeof e=="number"}function n4(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function be(e){return typeof e=="string"}function sM(e,t,n){e&&(e=t?we(e).map(a=>a.replace(/\\(.)/g,"$1")):we(e));const i=e&&e.length,r=n&&n.get||$W,s=a=>r(t?[a]:Aa(a));let o;if(!i)o=function(){return""};else if(i===1){const a=s(e[0]);o=function(l){return""+a(l)}}else{const a=e.map(s);o=function(l){let u=""+a[0](l),c=0;for(;++c<i;)u+="|"+a[c](l);return u}}return Ir(o,e,"key")}function i4(e,t){const n=e[0],i=gt(e),r=+t;return r?r===1?i:n+r*(i-n):n}const ohe=1e4;function r4(e){e=+e||ohe;let t,n,i;const r=()=>{t={},n={},i=0},s=(o,a)=>(++i>e&&(n=t,t={},i=1),t[o]=a);return r(),{clear:r,has:o=>Ee(t,o)||Ee(n,o),get:o=>Ee(t,o)?t[o]:Ee(n,o)?s(o,n[o]):void 0,set:(o,a)=>Ee(t,o)?t[o]=a:s(o,a)}}function s4(e,t,n,i){const r=t.length,s=n.length;if(!s)return t;if(!r)return n;const o=i||new t.constructor(r+s);let a=0,l=0,u=0;for(;a<r&&l<s;++u)o[u]=e(t[a],n[l])>0?n[l++]:t[a++];for(;a<r;++a,++u)o[u]=t[a];for(;l<s;++l,++u)o[u]=n[l];return o}function ym(e,t){let n="";for(;--t>=0;)n+=e;return n}function o4(e,t,n,i){const r=n||" ",s=e+"",o=t-s.length;return o<=0?s:i==="left"?ym(r,o)+s:i==="center"?ym(r,~~(o/2))+s+ym(r,Math.ceil(o/2)):s+ym(r,o)}function y0(e){return e&&gt(e)-e[0]||0}function he(e){return te(e)?"["+e.map(he)+"]":ye(e)||be(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function oM(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const ahe=e=>xt(e)||Ou(e)?e:Date.parse(e);function aM(e,t){return t=t||ahe,e==null||e===""?null:t(e)}function lM(e){return e==null||e===""?null:e+""}function Co(e){const t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t}function a4(e,t,n,i){const r=i??"…",s=e+"",o=s.length,a=Math.max(0,t-r.length);return o<=t?s:n==="left"?r+s.slice(o-a):n==="center"?s.slice(0,Math.ceil(a/2))+r+s.slice(o-~~(a/2)):s.slice(0,a)+r}function vu(e,t,n){if(e)if(t){const i=e.length;for(let r=0;r<i;++r){const s=t(e[r]);s&&n(s,r,e)}}else e.forEach(n)}var CG={},uF={},cF=34,Bg=10,dF=13;function l4(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function lhe(e,t){var n=l4(e);return function(i,r){return t(n(i),r,e)}}function yG(e){var t=Object.create(null),n=[];return e.forEach(function(i){for(var r in i)r in t||n.push(t[r]=r)}),n}function Cr(e,t){var n=e+"",i=n.length;return i<t?new Array(t-i+1).join(0)+n:n}function uhe(e){return e<0?"-"+Cr(-e,6):e>9999?"+"+Cr(e,6):Cr(e,4)}function che(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),i=e.getUTCSeconds(),r=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":uhe(e.getUTCFullYear())+"-"+Cr(e.getUTCMonth()+1,2)+"-"+Cr(e.getUTCDate(),2)+(r?"T"+Cr(t,2)+":"+Cr(n,2)+":"+Cr(i,2)+"."+Cr(r,3)+"Z":i?"T"+Cr(t,2)+":"+Cr(n,2)+":"+Cr(i,2)+"Z":n||t?"T"+Cr(t,2)+":"+Cr(n,2)+"Z":"")}function dhe(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function i(d,h){var p,g,v=r(d,function(C,y){if(p)return p(C,y-1);g=C,p=h?lhe(C,h):l4(C)});return v.columns=g||[],v}function r(d,h){var p=[],g=d.length,v=0,C=0,y,b=g<=0,S=!1;d.charCodeAt(g-1)===Bg&&--g,d.charCodeAt(g-1)===dF&&--g;function x(){if(b)return uF;if(S)return S=!1,CG;var A,F=v,k;if(d.charCodeAt(F)===cF){for(;v++<g&&d.charCodeAt(v)!==cF||d.charCodeAt(++v)===cF;);return(A=v)>=g?b=!0:(k=d.charCodeAt(v++))===Bg?S=!0:k===dF&&(S=!0,d.charCodeAt(v)===Bg&&++v),d.slice(F+1,A-1).replace(/""/g,'"')}for(;v<g;){if((k=d.charCodeAt(A=v++))===Bg)S=!0;else if(k===dF)S=!0,d.charCodeAt(v)===Bg&&++v;else if(k!==n)continue;return d.slice(F,A)}return b=!0,d.slice(F,g)}for(;(y=x())!==uF;){for(var E=[];y!==CG&&y!==uF;)E.push(y),y=x();h&&(E=h(E,C++))==null||p.push(E)}return p}function s(d,h){return d.map(function(p){return h.map(function(g){return c(p[g])}).join(e)})}function o(d,h){return h==null&&(h=yG(d)),[h.map(c).join(e)].concat(s(d,h)).join(`
`)}function a(d,h){return h==null&&(h=yG(d)),s(d,h).join(`
`)}function l(d){return d.map(u).join(`
`)}function u(d){return d.map(c).join(e)}function c(d){return d==null?"":d instanceof Date?che(d):t.test(d+="")?'"'+d.replace(/"/g,'""')+'"':d}return{parse:i,parseRows:r,format:o,formatBody:a,formatRows:l,formatRow:u,formatValue:c}}function hhe(e){return e}function fhe(e){if(e==null)return hhe;var t,n,i=e.scale[0],r=e.scale[1],s=e.translate[0],o=e.translate[1];return function(a,l){l||(t=n=0);var u=2,c=a.length,d=new Array(c);for(d[0]=(t+=a[0])*i+s,d[1]=(n+=a[1])*r+o;u<c;)d[u]=a[u],++u;return d}}function phe(e,t){for(var n,i=e.length,r=i-t;r<--i;)n=e[r],e[r++]=e[i],e[i]=n}function ghe(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return wG(e,n)})}:wG(e,t)}function wG(e,t){var n=t.id,i=t.bbox,r=t.properties==null?{}:t.properties,s=u4(e,t);return n==null&&i==null?{type:"Feature",properties:r,geometry:s}:i==null?{type:"Feature",id:n,properties:r,geometry:s}:{type:"Feature",id:n,bbox:i,properties:r,geometry:s}}function u4(e,t){var n=fhe(e.transform),i=e.arcs;function r(c,d){d.length&&d.pop();for(var h=i[c<0?~c:c],p=0,g=h.length;p<g;++p)d.push(n(h[p],p));c<0&&phe(d,g)}function s(c){return n(c)}function o(c){for(var d=[],h=0,p=c.length;h<p;++h)r(c[h],d);return d.length<2&&d.push(d[0]),d}function a(c){for(var d=o(c);d.length<4;)d.push(d[0]);return d}function l(c){return c.map(a)}function u(c){var d=c.type,h;switch(d){case"GeometryCollection":return{type:d,geometries:c.geometries.map(u)};case"Point":h=s(c.coordinates);break;case"MultiPoint":h=c.coordinates.map(s);break;case"LineString":h=o(c.arcs);break;case"MultiLineString":h=c.arcs.map(o);break;case"Polygon":h=l(c.arcs);break;case"MultiPolygon":h=c.arcs.map(l);break;default:return null}return{type:d,coordinates:h}}return u(t)}function mhe(e,t){var n={},i={},r={},s=[],o=-1;t.forEach(function(u,c){var d=e.arcs[u<0?~u:u],h;d.length<3&&!d[1][0]&&!d[1][1]&&(h=t[++o],t[o]=u,t[c]=h)}),t.forEach(function(u){var c=a(u),d=c[0],h=c[1],p,g;if(p=r[d])if(delete r[p.end],p.push(u),p.end=h,g=i[h]){delete i[g.start];var v=g===p?p:p.concat(g);i[v.start=p.start]=r[v.end=g.end]=v}else i[p.start]=r[p.end]=p;else if(p=i[h])if(delete i[p.start],p.unshift(u),p.start=d,g=r[d]){delete r[g.end];var C=g===p?p:g.concat(p);i[C.start=g.start]=r[C.end=p.end]=C}else i[p.start]=r[p.end]=p;else p=[u],i[p.start=d]=r[p.end=h]=p});function a(u){var c=e.arcs[u<0?~u:u],d=c[0],h;return e.transform?(h=[0,0],c.forEach(function(p){h[0]+=p[0],h[1]+=p[1]})):h=c[c.length-1],u<0?[h,d]:[d,h]}function l(u,c){for(var d in u){var h=u[d];delete c[h.start],delete h.start,delete h.end,h.forEach(function(p){n[p<0?~p:p]=1}),s.push(h)}}return l(r,i),l(i,r),t.forEach(function(u){n[u<0?~u:u]||s.push([u])}),s}function vhe(e){return u4(e,Che.apply(this,arguments))}function Che(e,t,n){var i,r,s;if(arguments.length>1)i=yhe(e,t,n);else for(r=0,i=new Array(s=e.arcs.length);r<s;++r)i[r]=r;return{type:"MultiLineString",arcs:mhe(e,i)}}function yhe(e,t,n){var i=[],r=[],s;function o(d){var h=d<0?~d:d;(r[h]||(r[h]=[])).push({i:d,g:s})}function a(d){d.forEach(o)}function l(d){d.forEach(a)}function u(d){d.forEach(l)}function c(d){switch(s=d,d.type){case"GeometryCollection":d.geometries.forEach(c);break;case"LineString":a(d.arcs);break;case"MultiLineString":case"Polygon":l(d.arcs);break;case"MultiPolygon":u(d.arcs);break}}return c(t),r.forEach(n==null?function(d){i.push(d[0].i)}:function(d){n(d[0].g,d[d.length-1].g)&&i.push(d[0].i)}),i}function ml(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function whe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Lp(e){let t,n,i;e.length!==2?(t=ml,n=(a,l)=>ml(e(a),l),i=(a,l)=>e(a)-l):(t=e===ml||e===whe?e:bhe,n=e,i=e);function r(a,l,u=0,c=a.length){if(u<c){if(t(l,l)!==0)return c;do{const d=u+c>>>1;n(a[d],l)<0?u=d+1:c=d}while(u<c)}return u}function s(a,l,u=0,c=a.length){if(u<c){if(t(l,l)!==0)return c;do{const d=u+c>>>1;n(a[d],l)<=0?u=d+1:c=d}while(u<c)}return u}function o(a,l,u=0,c=a.length){const d=r(a,l,u,c-1);return d>u&&i(a[d-1],l)>-i(a[d],l)?d-1:d}return{left:r,center:o,right:s}}function bhe(){return 0}function c4(e){return e===null?NaN:+e}function*She(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)(i=t(i,++n,e))!=null&&(i=+i)>=i&&(yield i)}}const d4=Lp(ml),Vu=d4.right,xhe=d4.left;Lp(c4).center;function Rhe(e,t){let n=0,i,r=0,s=0;if(t===void 0)for(let o of e)o!=null&&(o=+o)>=o&&(i=o-r,r+=i/++n,s+=i*(o-r));else{let o=-1;for(let a of e)(a=t(a,++o,e))!=null&&(a=+a)>=a&&(i=a-r,r+=i/++n,s+=i*(a-r))}if(n>1)return s/(n-1)}function Ehe(e,t){const n=Rhe(e,t);return n&&Math.sqrt(n)}class tr{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const s=n[r],o=t+s,a=Math.abs(t)<Math.abs(s)?t-(o-s):s-(o-t);a&&(n[i++]=a),t=o}return n[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let n=this._n,i,r,s,o=0;if(n>0){for(o=t[--n];n>0&&(i=o,r=t[--n],o=i+r,s=r-(o-i),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(r=s*2,i=o+r,r==i-o&&(o=i))}return o}}class bG extends Map{constructor(t,n=p4){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[i,r]of t)this.set(i,r)}get(t){return super.get(VD(this,t))}has(t){return super.has(VD(this,t))}set(t,n){return super.set(h4(this,t),n)}delete(t){return super.delete(f4(this,t))}}class Zw extends Set{constructor(t,n=p4){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const i of t)this.add(i)}has(t){return super.has(VD(this,t))}add(t){return super.add(h4(this,t))}delete(t){return super.delete(f4(this,t))}}function VD({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):n}function h4({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):(e.set(i,n),n)}function f4({_intern:e,_key:t},n){const i=t(n);return e.has(i)&&(n=e.get(i),e.delete(i)),n}function p4(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Fhe(e,t){return Array.from(t,n=>e[n])}function Ahe(e=ml){if(e===ml)return g4;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const i=e(t,n);return i||i===0?i:(e(n,n)===0)-(e(t,t)===0)}}function g4(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const Dhe=Math.sqrt(50),Phe=Math.sqrt(10),khe=Math.sqrt(2);function eb(e,t,n){const i=(t-e)/Math.max(0,n),r=Math.floor(Math.log10(i)),s=i/Math.pow(10,r),o=s>=Dhe?10:s>=Phe?5:s>=khe?2:1;let a,l,u;return r<0?(u=Math.pow(10,-r)/o,a=Math.round(e*u),l=Math.round(t*u),a/u<e&&++a,l/u>t&&--l,u=-u):(u=Math.pow(10,r)*o,a=Math.round(e/u),l=Math.round(t/u),a*u<e&&++a,l*u>t&&--l),l<a&&.5<=n&&n<2?eb(e,t,n*2):[a,l,u]}function WD(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const i=t<e,[r,s,o]=i?eb(t,e,n):eb(e,t,n);if(!(s>=r))return[];const a=s-r+1,l=new Array(a);if(i)if(o<0)for(let u=0;u<a;++u)l[u]=(s-u)/-o;else for(let u=0;u<a;++u)l[u]=(s-u)*o;else if(o<0)for(let u=0;u<a;++u)l[u]=(r+u)/-o;else for(let u=0;u<a;++u)l[u]=(r+u)*o;return l}function UD(e,t,n){return t=+t,e=+e,n=+n,eb(e,t,n)[2]}function Wu(e,t,n){t=+t,e=+e,n=+n;const i=t<e,r=i?UD(t,e,n):UD(e,t,n);return(i?-1:1)*(r<0?1/-r:r)}function hd(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n<r||n===void 0&&r>=r)&&(n=r)}return n}function jD(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n>r||n===void 0&&r>=r)&&(n=r)}return n}function m4(e,t,n=0,i=1/0,r){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),i=Math.floor(Math.min(e.length-1,i)),!(n<=t&&t<=i))return e;for(r=r===void 0?g4:Ahe(r);i>n;){if(i-n>600){const l=i-n+1,u=t-n+1,c=Math.log(l),d=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*d*(l-d)/l)*(u-l/2<0?-1:1),p=Math.max(n,Math.floor(t-u*d/l+h)),g=Math.min(i,Math.floor(t+(l-u)*d/l+h));m4(e,t,p,g,r)}const s=e[t];let o=n,a=i;for(Gg(e,n,t),r(e[i],s)>0&&Gg(e,n,i);o<a;){for(Gg(e,o,a),++o,--a;r(e[o],s)<0;)++o;for(;r(e[a],s)>0;)--a}r(e[n],s)===0?Gg(e,n,a):(++a,Gg(e,a,i)),a<=t&&(n=a+1),t<=a&&(i=a-1)}return e}function Gg(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function qD(e,t,n){if(e=Float64Array.from(She(e,n)),!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return jD(e);if(t>=1)return hd(e);var i,r=(i-1)*t,s=Math.floor(r),o=hd(m4(e,s).subarray(0,s+1)),a=jD(e.subarray(s+1));return o+(a-o)*(r-s)}}function v4(e,t,n=c4){if(!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return+n(e[0],0,e);if(t>=1)return+n(e[i-1],i-1,e);var i,r=(i-1)*t,s=Math.floor(r),o=+n(e[s],s,e),a=+n(e[s+1],s+1,e);return o+(a-o)*(r-s)}}function The(e,t){let n=0,i=0;if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(++n,i+=r);else{let r=-1;for(let s of e)(s=t(s,++r,e))!=null&&(s=+s)>=s&&(++n,i+=s)}if(n)return i/n}function C4(e,t){return qD(e,.5,t)}function*Mhe(e){for(const t of e)yield*t}function y4(e){return Array.from(Mhe(e))}function Sr(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(r);++i<r;)s[i]=e+i*n;return s}function w4(e,t){let n=0;for(let i of e)(i=+i)&&(n+=i);return n}function Ihe(e,...t){e=new Zw(e),t=t.map(_he);e:for(const n of e)for(const i of t)if(!i.has(n)){e.delete(n);continue e}return e}function _he(e){return e instanceof Zw?e:new Zw(e)}function Ohe(...e){const t=new Zw;for(const n of e)for(const i of n)t.add(i);return t}function Lhe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function tb(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function Bf(e){return e=tb(Math.abs(e)),e?e[1]:NaN}function Nhe(e,t){return function(n,i){for(var r=n.length,s=[],o=0,a=e[0],l=0;r>0&&a>0&&(l+a+1>i&&(a=Math.max(1,i-l)),s.push(n.substring(r-=a,r+a)),!((l+=a+1)>i));)a=e[o=(o+1)%e.length];return s.reverse().join(t)}}function $he(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var Bhe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Pd(e){if(!(t=Bhe.exec(e)))throw new Error("invalid format: "+e);var t;return new uM({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Pd.prototype=uM.prototype;function uM(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}uM.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Ghe(e){e:for(var t=e.length,n=1,i=-1,r;n<t;++n)switch(e[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+e[n])break e;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(r+1):e}var b4;function zhe(e,t){var n=tb(e,t);if(!n)return e+"";var i=n[0],r=n[1],s=r-(b4=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+tb(e,Math.max(0,t+s-1))[0]}function SG(e,t){var n=tb(e,t);if(!n)return e+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const xG={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Lhe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>SG(e*100,t),r:SG,s:zhe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function RG(e){return e}var EG=Array.prototype.map,FG=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function S4(e){var t=e.grouping===void 0||e.thousands===void 0?RG:Nhe(EG.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",r=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?RG:$he(EG.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"−":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function u(d){d=Pd(d);var h=d.fill,p=d.align,g=d.sign,v=d.symbol,C=d.zero,y=d.width,b=d.comma,S=d.precision,x=d.trim,E=d.type;E==="n"?(b=!0,E="g"):xG[E]||(S===void 0&&(S=12),x=!0,E="g"),(C||h==="0"&&p==="=")&&(C=!0,h="0",p="=");var A=v==="$"?n:v==="#"&&/[boxX]/.test(E)?"0"+E.toLowerCase():"",F=v==="$"?i:/[%p]/.test(E)?o:"",k=xG[E],P=/[defgprs%]/.test(E);S=S===void 0?6:/[gprs]/.test(E)?Math.max(1,Math.min(21,S)):Math.max(0,Math.min(20,S));function _(O){var H=A,W=F,$,L,G;if(E==="c")W=k(O)+W,O="";else{O=+O;var j=O<0||1/O<0;if(O=isNaN(O)?l:k(Math.abs(O),S),x&&(O=Ghe(O)),j&&+O==0&&g!=="+"&&(j=!1),H=(j?g==="("?g:a:g==="-"||g==="("?"":g)+H,W=(E==="s"?FG[8+b4/3]:"")+W+(j&&g==="("?")":""),P){for($=-1,L=O.length;++$<L;)if(G=O.charCodeAt($),48>G||G>57){W=(G===46?r+O.slice($+1):O.slice($))+W,O=O.slice(0,$);break}}}b&&!C&&(O=t(O,1/0));var ee=H.length+O.length+W.length,q=ee<y?new Array(y-ee+1).join(h):"";switch(b&&C&&(O=t(q+O,q.length?y-W.length:1/0),q=""),p){case"<":O=H+O+W+q;break;case"=":O=H+q+O+W;break;case"^":O=q.slice(0,ee=q.length>>1)+H+O+W+q.slice(ee);break;default:O=q+H+O+W;break}return s(O)}return _.toString=function(){return d+""},_}function c(d,h){var p=u((d=Pd(d),d.type="f",d)),g=Math.max(-8,Math.min(8,Math.floor(Bf(h)/3)))*3,v=Math.pow(10,-g),C=FG[8+g/3];return function(y){return p(v*y)+C}}return{format:u,formatPrefix:c}}var gy,c1,cM;Hhe({thousands:",",grouping:[3],currency:["$",""]});function Hhe(e){return gy=S4(e),c1=gy.format,cM=gy.formatPrefix,gy}function x4(e){return Math.max(0,-Bf(Math.abs(e)))}function R4(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Bf(t)/3)))*3-Bf(Math.abs(e)))}function E4(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Bf(t)-Bf(e))+1}const hF=new Date,fF=new Date;function Vn(e,t,n,i){function r(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return r.floor=s=>(e(s=new Date(+s)),s),r.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),r.round=s=>{const o=r(s),a=r.ceil(s);return s-o<a-s?o:a},r.offset=(s,o)=>(t(s=new Date(+s),o==null?1:Math.floor(o)),s),r.range=(s,o,a)=>{const l=[];if(s=r.ceil(s),a=a==null?1:Math.floor(a),!(s<o)||!(a>0))return l;let u;do l.push(u=new Date(+s)),t(s,a),e(s);while(u<s&&s<o);return l},r.filter=s=>Vn(o=>{if(o>=o)for(;e(o),!s(o);)o.setTime(o-1)},(o,a)=>{if(o>=o)if(a<0)for(;++a<=0;)for(;t(o,-1),!s(o););else for(;--a>=0;)for(;t(o,1),!s(o););}),n&&(r.count=(s,o)=>(hF.setTime(+s),fF.setTime(+o),e(hF),e(fF),Math.floor(n(hF,fF))),r.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?r.filter(i?o=>i(o)%s===0:o=>r.count(0,o)%s===0):r)),r}const Gf=Vn(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Gf.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Vn(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):Gf);Gf.range;const ul=1e3,Ss=ul*60,cl=Ss*60,Dl=cl*24,dM=Dl*7,AG=Dl*30,pF=Dl*365,dl=Vn(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*ul)},(e,t)=>(t-e)/ul,e=>e.getUTCSeconds());dl.range;const d1=Vn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ul)},(e,t)=>{e.setTime(+e+t*Ss)},(e,t)=>(t-e)/Ss,e=>e.getMinutes());d1.range;const h1=Vn(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ss)},(e,t)=>(t-e)/Ss,e=>e.getUTCMinutes());h1.range;const f1=Vn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ul-e.getMinutes()*Ss)},(e,t)=>{e.setTime(+e+t*cl)},(e,t)=>(t-e)/cl,e=>e.getHours());f1.range;const p1=Vn(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*cl)},(e,t)=>(t-e)/cl,e=>e.getUTCHours());p1.range;const vl=Vn(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ss)/Dl,e=>e.getDate()-1);vl.range;const Lu=Vn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Dl,e=>e.getUTCDate()-1);Lu.range;const F4=Vn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Dl,e=>Math.floor(e/Dl));F4.range;function th(e){return Vn(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Ss)/dM)}const Np=th(0),nb=th(1),Vhe=th(2),Whe=th(3),zf=th(4),Uhe=th(5),jhe=th(6);Np.range;nb.range;Vhe.range;Whe.range;zf.range;Uhe.range;jhe.range;function nh(e){return Vn(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/dM)}const $p=nh(0),ib=nh(1),qhe=nh(2),Khe=nh(3),Hf=nh(4),Yhe=nh(5),Xhe=nh(6);$p.range;ib.range;qhe.range;Khe.range;Hf.range;Yhe.range;Xhe.range;const wv=Vn(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());wv.range;const bv=Vn(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());bv.range;const va=Vn(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());va.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Vn(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});va.range;const Ca=Vn(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Ca.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Vn(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Ca.range;function A4(e,t,n,i,r,s){const o=[[dl,1,ul],[dl,5,5*ul],[dl,15,15*ul],[dl,30,30*ul],[s,1,Ss],[s,5,5*Ss],[s,15,15*Ss],[s,30,30*Ss],[r,1,cl],[r,3,3*cl],[r,6,6*cl],[r,12,12*cl],[i,1,Dl],[i,2,2*Dl],[n,1,dM],[t,1,AG],[t,3,3*AG],[e,1,pF]];function a(u,c,d){const h=c<u;h&&([u,c]=[c,u]);const p=d&&typeof d.range=="function"?d:l(u,c,d),g=p?p.range(u,+c+1):[];return h?g.reverse():g}function l(u,c,d){const h=Math.abs(c-u)/d,p=Lp(([,,C])=>C).right(o,h);if(p===o.length)return e.every(Wu(u/pF,c/pF,d));if(p===0)return Gf.every(Math.max(Wu(u,c,d),1));const[g,v]=o[h/o[p-1][2]<o[p][2]/h?p-1:p];return g.every(v)}return[a,l]}const[Qhe,Jhe]=A4(Ca,bv,$p,F4,p1,h1),[Zhe,efe]=A4(va,wv,Np,vl,f1,d1),fi="year",Ar="quarter",ki="month",Bn="week",Dr="date",Fi="day",ya="dayofyear",Zr="hours",es="minutes",_s="seconds",yo="milliseconds",hM=[fi,Ar,ki,Bn,Dr,Fi,ya,Zr,es,_s,yo],gF=hM.reduce((e,t,n)=>(e[t]=1+n,e),{});function fM(e){const t=we(e).slice(),n={};return t.length||Z("Missing time unit."),t.forEach(r=>{Ee(gF,r)?n[r]=1:Z(`Invalid time unit: ${r}.`)}),(n[Bn]||n[Fi]?1:0)+(n[Ar]||n[ki]||n[Dr]?1:0)+(n[ya]?1:0)>1&&Z(`Incompatible time units: ${e}`),t.sort((r,s)=>gF[r]-gF[s]),t}const tfe={[fi]:"%Y ",[Ar]:"Q%q ",[ki]:"%b ",[Dr]:"%d ",[Bn]:"W%U ",[Fi]:"%a ",[ya]:"%j ",[Zr]:"%H:00",[es]:"00:%M",[_s]:":%S",[yo]:".%L",[`${fi}-${ki}`]:"%Y-%m ",[`${fi}-${ki}-${Dr}`]:"%Y-%m-%d ",[`${Zr}-${es}`]:"%H:%M"};function D4(e,t){const n=Ze({},tfe,t),i=fM(e),r=i.length;let s="",o=0,a,l;for(o=0;o<r;)for(a=i.length;a>o;--a)if(l=i.slice(o,a).join("-"),n[l]!=null){s+=n[l],o=a;break}return s.trim()}const nd=new Date;function pM(e){return nd.setFullYear(e),nd.setMonth(0),nd.setDate(1),nd.setHours(0,0,0,0),nd}function P4(e){return T4(new Date(e))}function k4(e){return KD(new Date(e))}function T4(e){return vl.count(pM(e.getFullYear())-1,e)}function KD(e){return Np.count(pM(e.getFullYear())-1,e)}function YD(e){return pM(e).getDay()}function nfe(e,t,n,i,r,s,o){if(0<=e&&e<100){const a=new Date(-1,t,n,i,r,s,o);return a.setFullYear(e),a}return new Date(e,t,n,i,r,s,o)}function M4(e){return _4(new Date(e))}function I4(e){return XD(new Date(e))}function _4(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Lu.count(t-1,e)}function XD(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return $p.count(t-1,e)}function QD(e){return nd.setTime(Date.UTC(e,0,1)),nd.getUTCDay()}function ife(e,t,n,i,r,s,o){if(0<=e&&e<100){const a=new Date(Date.UTC(-1,t,n,i,r,s,o));return a.setUTCFullYear(n.y),a}return new Date(Date.UTC(e,t,n,i,r,s,o))}function O4(e,t,n,i,r){const s=t||1,o=gt(e),a=(y,b,S)=>(S=S||y,rfe(n[S],i[S],y===o&&s,b)),l=new Date,u=Co(e),c=u[fi]?a(fi):Oi(2012),d=u[ki]?a(ki):u[Ar]?a(Ar):xu,h=u[Bn]&&u[Fi]?a(Fi,1,Bn+Fi):u[Bn]?a(Bn,1):u[Fi]?a(Fi,1):u[Dr]?a(Dr,1):u[ya]?a(ya,1):Tp,p=u[Zr]?a(Zr):xu,g=u[es]?a(es):xu,v=u[_s]?a(_s):xu,C=u[yo]?a(yo):xu;return function(y){l.setTime(+y);const b=c(l);return r(b,d(l),h(l,b),p(l),g(l),v(l),C(l))}}function rfe(e,t,n,i){const r=n<=1?e:i?(s,o)=>i+n*Math.floor((e(s,o)-i)/n):(s,o)=>n*Math.floor(e(s,o)/n);return t?(s,o)=>t(r(s,o),o):r}function Vf(e,t,n){return t+e*7-(n+6)%7}const sfe={[fi]:e=>e.getFullYear(),[Ar]:e=>Math.floor(e.getMonth()/3),[ki]:e=>e.getMonth(),[Dr]:e=>e.getDate(),[Zr]:e=>e.getHours(),[es]:e=>e.getMinutes(),[_s]:e=>e.getSeconds(),[yo]:e=>e.getMilliseconds(),[ya]:e=>T4(e),[Bn]:e=>KD(e),[Bn+Fi]:(e,t)=>Vf(KD(e),e.getDay(),YD(t)),[Fi]:(e,t)=>Vf(1,e.getDay(),YD(t))},ofe={[Ar]:e=>3*e,[Bn]:(e,t)=>Vf(e,0,YD(t))};function L4(e,t){return O4(e,t||1,sfe,ofe,nfe)}const afe={[fi]:e=>e.getUTCFullYear(),[Ar]:e=>Math.floor(e.getUTCMonth()/3),[ki]:e=>e.getUTCMonth(),[Dr]:e=>e.getUTCDate(),[Zr]:e=>e.getUTCHours(),[es]:e=>e.getUTCMinutes(),[_s]:e=>e.getUTCSeconds(),[yo]:e=>e.getUTCMilliseconds(),[ya]:e=>_4(e),[Bn]:e=>XD(e),[Fi]:(e,t)=>Vf(1,e.getUTCDay(),QD(t)),[Bn+Fi]:(e,t)=>Vf(XD(e),e.getUTCDay(),QD(t))},lfe={[Ar]:e=>3*e,[Bn]:(e,t)=>Vf(e,0,QD(t))};function N4(e,t){return O4(e,t||1,afe,lfe,ife)}const ufe={[fi]:va,[Ar]:wv.every(3),[ki]:wv,[Bn]:Np,[Dr]:vl,[Fi]:vl,[ya]:vl,[Zr]:f1,[es]:d1,[_s]:dl,[yo]:Gf},cfe={[fi]:Ca,[Ar]:bv.every(3),[ki]:bv,[Bn]:$p,[Dr]:Lu,[Fi]:Lu,[ya]:Lu,[Zr]:p1,[es]:h1,[_s]:dl,[yo]:Gf};function Bp(e){return ufe[e]}function Gp(e){return cfe[e]}function $4(e,t,n){return e?e.offset(t,n):void 0}function B4(e,t,n){return $4(Bp(e),t,n)}function G4(e,t,n){return $4(Gp(e),t,n)}function z4(e,t,n,i){return e?e.range(t,n,i):void 0}function H4(e,t,n,i){return z4(Bp(e),t,n,i)}function V4(e,t,n,i){return z4(Gp(e),t,n,i)}const wm=1e3,bm=wm*60,Sm=bm*60,g1=Sm*24,dfe=g1*7,DG=g1*30,JD=g1*365,W4=[fi,ki,Dr,Zr,es,_s,yo],xm=W4.slice(0,-1),Rm=xm.slice(0,-1),Em=Rm.slice(0,-1),hfe=Em.slice(0,-1),ffe=[fi,Bn],PG=[fi,ki],U4=[fi],zg=[[xm,1,wm],[xm,5,5*wm],[xm,15,15*wm],[xm,30,30*wm],[Rm,1,bm],[Rm,5,5*bm],[Rm,15,15*bm],[Rm,30,30*bm],[Em,1,Sm],[Em,3,3*Sm],[Em,6,6*Sm],[Em,12,12*Sm],[hfe,1,g1],[ffe,1,dfe],[PG,1,DG],[PG,3,3*DG],[U4,1,JD]];function j4(e){const t=e.extent,n=e.maxbins||40,i=Math.abs(y0(t))/n;let r=Lp(a=>a[2]).right(zg,i),s,o;return r===zg.length?(s=U4,o=Wu(t[0]/JD,t[1]/JD,n)):r?(r=zg[i/zg[r-1][2]<zg[r][2]/i?r-1:r],s=r[0],o=r[1]):(s=W4,o=Math.max(Wu(t[0],t[1],n),1)),{units:s,step:o}}function mF(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function vF(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Hg(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function q4(e){var t=e.dateTime,n=e.date,i=e.time,r=e.periods,s=e.days,o=e.shortDays,a=e.months,l=e.shortMonths,u=Vg(r),c=Wg(r),d=Vg(s),h=Wg(s),p=Vg(o),g=Wg(o),v=Vg(a),C=Wg(a),y=Vg(l),b=Wg(l),S={a:j,A:ee,b:q,B:fe,c:null,d:OG,e:OG,f:Lfe,g:jfe,G:Kfe,H:Ife,I:_fe,j:Ofe,L:K4,m:Nfe,M:$fe,p:Re,q:Fe,Q:$G,s:BG,S:Bfe,u:Gfe,U:zfe,V:Hfe,w:Vfe,W:Wfe,x:null,X:null,y:Ufe,Y:qfe,Z:Yfe,"%":NG},x={a:ze,A:Ft,b:$e,B:nn,c:null,d:LG,e:LG,f:Zfe,g:upe,G:dpe,H:Xfe,I:Qfe,j:Jfe,L:X4,m:epe,M:tpe,p:za,q:dr,Q:$G,s:BG,S:npe,u:ipe,U:rpe,V:spe,w:ope,W:ape,x:null,X:null,y:lpe,Y:cpe,Z:hpe,"%":NG},E={a:_,A:O,b:H,B:W,c:$,d:IG,e:IG,f:Pfe,g:MG,G:TG,H:_G,I:_G,j:Efe,L:Dfe,m:Rfe,M:Ffe,p:P,q:xfe,Q:Tfe,s:Mfe,S:Afe,u:Cfe,U:yfe,V:wfe,w:vfe,W:bfe,x:L,X:G,y:MG,Y:TG,Z:Sfe,"%":kfe};S.x=A(n,S),S.X=A(i,S),S.c=A(t,S),x.x=A(n,x),x.X=A(i,x),x.c=A(t,x);function A(xe,Ye){return function(Xe){var le=[],Pn=-1,et=0,cn=xe.length,kn,Tn,Tc;for(Xe instanceof Date||(Xe=new Date(+Xe));++Pn<cn;)xe.charCodeAt(Pn)===37&&(le.push(xe.slice(et,Pn)),(Tn=kG[kn=xe.charAt(++Pn)])!=null?kn=xe.charAt(++Pn):Tn=kn==="e"?" ":"0",(Tc=Ye[kn])&&(kn=Tc(Xe,Tn)),le.push(kn),et=Pn+1);return le.push(xe.slice(et,Pn)),le.join("")}}function F(xe,Ye){return function(Xe){var le=Hg(1900,void 0,1),Pn=k(le,xe,Xe+="",0),et,cn;if(Pn!=Xe.length)return null;if("Q"in le)return new Date(le.Q);if("s"in le)return new Date(le.s*1e3+("L"in le?le.L:0));if(Ye&&!("Z"in le)&&(le.Z=0),"p"in le&&(le.H=le.H%12+le.p*12),le.m===void 0&&(le.m="q"in le?le.q:0),"V"in le){if(le.V<1||le.V>53)return null;"w"in le||(le.w=1),"Z"in le?(et=vF(Hg(le.y,0,1)),cn=et.getUTCDay(),et=cn>4||cn===0?ib.ceil(et):ib(et),et=Lu.offset(et,(le.V-1)*7),le.y=et.getUTCFullYear(),le.m=et.getUTCMonth(),le.d=et.getUTCDate()+(le.w+6)%7):(et=mF(Hg(le.y,0,1)),cn=et.getDay(),et=cn>4||cn===0?nb.ceil(et):nb(et),et=vl.offset(et,(le.V-1)*7),le.y=et.getFullYear(),le.m=et.getMonth(),le.d=et.getDate()+(le.w+6)%7)}else("W"in le||"U"in le)&&("w"in le||(le.w="u"in le?le.u%7:"W"in le?1:0),cn="Z"in le?vF(Hg(le.y,0,1)).getUTCDay():mF(Hg(le.y,0,1)).getDay(),le.m=0,le.d="W"in le?(le.w+6)%7+le.W*7-(cn+5)%7:le.w+le.U*7-(cn+6)%7);return"Z"in le?(le.H+=le.Z/100|0,le.M+=le.Z%100,vF(le)):mF(le)}}function k(xe,Ye,Xe,le){for(var Pn=0,et=Ye.length,cn=Xe.length,kn,Tn;Pn<et;){if(le>=cn)return-1;if(kn=Ye.charCodeAt(Pn++),kn===37){if(kn=Ye.charAt(Pn++),Tn=E[kn in kG?Ye.charAt(Pn++):kn],!Tn||(le=Tn(xe,Xe,le))<0)return-1}else if(kn!=Xe.charCodeAt(le++))return-1}return le}function P(xe,Ye,Xe){var le=u.exec(Ye.slice(Xe));return le?(xe.p=c.get(le[0].toLowerCase()),Xe+le[0].length):-1}function _(xe,Ye,Xe){var le=p.exec(Ye.slice(Xe));return le?(xe.w=g.get(le[0].toLowerCase()),Xe+le[0].length):-1}function O(xe,Ye,Xe){var le=d.exec(Ye.slice(Xe));return le?(xe.w=h.get(le[0].toLowerCase()),Xe+le[0].length):-1}function H(xe,Ye,Xe){var le=y.exec(Ye.slice(Xe));return le?(xe.m=b.get(le[0].toLowerCase()),Xe+le[0].length):-1}function W(xe,Ye,Xe){var le=v.exec(Ye.slice(Xe));return le?(xe.m=C.get(le[0].toLowerCase()),Xe+le[0].length):-1}function $(xe,Ye,Xe){return k(xe,t,Ye,Xe)}function L(xe,Ye,Xe){return k(xe,n,Ye,Xe)}function G(xe,Ye,Xe){return k(xe,i,Ye,Xe)}function j(xe){return o[xe.getDay()]}function ee(xe){return s[xe.getDay()]}function q(xe){return l[xe.getMonth()]}function fe(xe){return a[xe.getMonth()]}function Re(xe){return r[+(xe.getHours()>=12)]}function Fe(xe){return 1+~~(xe.getMonth()/3)}function ze(xe){return o[xe.getUTCDay()]}function Ft(xe){return s[xe.getUTCDay()]}function $e(xe){return l[xe.getUTCMonth()]}function nn(xe){return a[xe.getUTCMonth()]}function za(xe){return r[+(xe.getUTCHours()>=12)]}function dr(xe){return 1+~~(xe.getUTCMonth()/3)}return{format:function(xe){var Ye=A(xe+="",S);return Ye.toString=function(){return xe},Ye},parse:function(xe){var Ye=F(xe+="",!1);return Ye.toString=function(){return xe},Ye},utcFormat:function(xe){var Ye=A(xe+="",x);return Ye.toString=function(){return xe},Ye},utcParse:function(xe){var Ye=F(xe+="",!0);return Ye.toString=function(){return xe},Ye}}}var kG={"-":"",_:" ",0:"0"},ti=/^\s*\d+/,pfe=/^%/,gfe=/[\\^$*+?|[\]().{}]/g;function Rt(e,t,n){var i=e<0?"-":"",r=(i?-e:e)+"",s=r.length;return i+(s<n?new Array(n-s+1).join(t)+r:r)}function mfe(e){return e.replace(gfe,"\\$&")}function Vg(e){return new RegExp("^(?:"+e.map(mfe).join("|")+")","i")}function Wg(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function vfe(e,t,n){var i=ti.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function Cfe(e,t,n){var i=ti.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function yfe(e,t,n){var i=ti.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function wfe(e,t,n){var i=ti.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function bfe(e,t,n){var i=ti.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function TG(e,t,n){var i=ti.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function MG(e,t,n){var i=ti.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function Sfe(e,t,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function xfe(e,t,n){var i=ti.exec(t.slice(n,n+1));return i?(e.q=i[0]*3-3,n+i[0].length):-1}function Rfe(e,t,n){var i=ti.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function IG(e,t,n){var i=ti.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function Efe(e,t,n){var i=ti.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function _G(e,t,n){var i=ti.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function Ffe(e,t,n){var i=ti.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function Afe(e,t,n){var i=ti.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function Dfe(e,t,n){var i=ti.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function Pfe(e,t,n){var i=ti.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function kfe(e,t,n){var i=pfe.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function Tfe(e,t,n){var i=ti.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function Mfe(e,t,n){var i=ti.exec(t.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function OG(e,t){return Rt(e.getDate(),t,2)}function Ife(e,t){return Rt(e.getHours(),t,2)}function _fe(e,t){return Rt(e.getHours()%12||12,t,2)}function Ofe(e,t){return Rt(1+vl.count(va(e),e),t,3)}function K4(e,t){return Rt(e.getMilliseconds(),t,3)}function Lfe(e,t){return K4(e,t)+"000"}function Nfe(e,t){return Rt(e.getMonth()+1,t,2)}function $fe(e,t){return Rt(e.getMinutes(),t,2)}function Bfe(e,t){return Rt(e.getSeconds(),t,2)}function Gfe(e){var t=e.getDay();return t===0?7:t}function zfe(e,t){return Rt(Np.count(va(e)-1,e),t,2)}function Y4(e){var t=e.getDay();return t>=4||t===0?zf(e):zf.ceil(e)}function Hfe(e,t){return e=Y4(e),Rt(zf.count(va(e),e)+(va(e).getDay()===4),t,2)}function Vfe(e){return e.getDay()}function Wfe(e,t){return Rt(nb.count(va(e)-1,e),t,2)}function Ufe(e,t){return Rt(e.getFullYear()%100,t,2)}function jfe(e,t){return e=Y4(e),Rt(e.getFullYear()%100,t,2)}function qfe(e,t){return Rt(e.getFullYear()%1e4,t,4)}function Kfe(e,t){var n=e.getDay();return e=n>=4||n===0?zf(e):zf.ceil(e),Rt(e.getFullYear()%1e4,t,4)}function Yfe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Rt(t/60|0,"0",2)+Rt(t%60,"0",2)}function LG(e,t){return Rt(e.getUTCDate(),t,2)}function Xfe(e,t){return Rt(e.getUTCHours(),t,2)}function Qfe(e,t){return Rt(e.getUTCHours()%12||12,t,2)}function Jfe(e,t){return Rt(1+Lu.count(Ca(e),e),t,3)}function X4(e,t){return Rt(e.getUTCMilliseconds(),t,3)}function Zfe(e,t){return X4(e,t)+"000"}function epe(e,t){return Rt(e.getUTCMonth()+1,t,2)}function tpe(e,t){return Rt(e.getUTCMinutes(),t,2)}function npe(e,t){return Rt(e.getUTCSeconds(),t,2)}function ipe(e){var t=e.getUTCDay();return t===0?7:t}function rpe(e,t){return Rt($p.count(Ca(e)-1,e),t,2)}function Q4(e){var t=e.getUTCDay();return t>=4||t===0?Hf(e):Hf.ceil(e)}function spe(e,t){return e=Q4(e),Rt(Hf.count(Ca(e),e)+(Ca(e).getUTCDay()===4),t,2)}function ope(e){return e.getUTCDay()}function ape(e,t){return Rt(ib.count(Ca(e)-1,e),t,2)}function lpe(e,t){return Rt(e.getUTCFullYear()%100,t,2)}function upe(e,t){return e=Q4(e),Rt(e.getUTCFullYear()%100,t,2)}function cpe(e,t){return Rt(e.getUTCFullYear()%1e4,t,4)}function dpe(e,t){var n=e.getUTCDay();return e=n>=4||n===0?Hf(e):Hf.ceil(e),Rt(e.getUTCFullYear()%1e4,t,4)}function hpe(){return"+0000"}function NG(){return"%"}function $G(e){return+e}function BG(e){return Math.floor(+e/1e3)}var zh,gM,J4,mM,Z4;fpe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function fpe(e){return zh=q4(e),gM=zh.format,J4=zh.parse,mM=zh.utcFormat,Z4=zh.utcParse,zh}function Fm(e){const t={};return n=>t[n]||(t[n]=e(n))}function ppe(e,t){return n=>{const i=e(n),r=i.indexOf(t);if(r<0)return i;let s=gpe(i,r);const o=s<i.length?i.slice(s):"";for(;--s>r;)if(i[s]!=="0"){++s;break}return i.slice(0,s)+o}}function gpe(e,t){let n=e.lastIndexOf("e"),i;if(n>0)return n;for(n=e.length;--n>t;)if(i=e.charCodeAt(n),i>=48&&i<=57)return n+1}function e8(e){const t=Fm(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(i){const r=Pd(i||",");if(r.precision==null){switch(r.precision=12,r.type){case"%":r.precision-=2;break;case"e":r.precision-=1;break}return ppe(t(r),t(".1f")(1)[1])}else return t(r)},formatSpan(i,r,s,o){o=Pd(o??",f");const a=Wu(i,r,s),l=Math.max(Math.abs(i),Math.abs(r));let u;if(o.precision==null)switch(o.type){case"s":return isNaN(u=R4(a,l))||(o.precision=u),n(o,l);case"":case"e":case"g":case"p":case"r":{isNaN(u=E4(a,l))||(o.precision=u-(o.type==="e"));break}case"f":case"%":{isNaN(u=x4(a))||(o.precision=u-(o.type==="%")*2);break}}return t(o)}}}let ZD;t8();function t8(){return ZD=e8({format:c1,formatPrefix:cM})}function n8(e){return e8(S4(e))}function rb(e){return arguments.length?ZD=n8(e):ZD}function GG(e,t,n){n=n||{},ye(n)||Z(`Invalid time multi-format specifier: ${n}`);const i=t(_s),r=t(es),s=t(Zr),o=t(Dr),a=t(Bn),l=t(ki),u=t(Ar),c=t(fi),d=e(n[yo]||".%L"),h=e(n[_s]||":%S"),p=e(n[es]||"%I:%M"),g=e(n[Zr]||"%I %p"),v=e(n[Dr]||n[Fi]||"%a %d"),C=e(n[Bn]||"%b %d"),y=e(n[ki]||"%B"),b=e(n[Ar]||"%B"),S=e(n[fi]||"%Y");return x=>(i(x)<x?d:r(x)<x?h:s(x)<x?p:o(x)<x?g:l(x)<x?a(x)<x?v:C:c(x)<x?u(x)<x?y:b:S)(x)}function i8(e){const t=Fm(e.format),n=Fm(e.utcFormat);return{timeFormat:i=>be(i)?t(i):GG(t,Bp,i),utcFormat:i=>be(i)?n(i):GG(n,Gp,i),timeParse:Fm(e.parse),utcParse:Fm(e.utcParse)}}let eP;r8();function r8(){return eP=i8({format:gM,parse:J4,utcFormat:mM,utcParse:Z4})}function s8(e){return i8(q4(e))}function Sv(e){return arguments.length?eP=s8(e):eP}const tP=(e,t)=>Ze({},e,t);function o8(e,t){const n=e?n8(e):rb(),i=t?s8(t):Sv();return tP(n,i)}function vM(e,t){const n=arguments.length;return n&&n!==2&&Z("defaultLocale expects either zero or two arguments."),n?tP(rb(e),Sv(t)):tP(rb(),Sv())}function mpe(){return t8(),r8(),vM()}const vpe=/^(data:|([A-Za-z]+:)?\/\/)/,Cpe=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,ype=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,zG="file://";function wpe(e,t){return n=>({options:n||{},sanitize:Spe,load:bpe,fileAccess:!1,file:xpe(t),http:Epe(e)})}async function bpe(e,t){const n=await this.sanitize(e,t),i=n.href;return n.localFile?this.file(i):this.http(i,t)}async function Spe(e,t){t=Ze({},this.options,t);const n=this.fileAccess,i={href:null};let r,s,o;const a=Cpe.test(e.replace(ype,""));(e==null||typeof e!="string"||!a)&&Z("Sanitize failure, invalid URI: "+he(e));const l=vpe.test(e);return(o=t.baseURL)&&!l&&(!e.startsWith("/")&&!o.endsWith("/")&&(e="/"+e),e=o+e),s=(r=e.startsWith(zG))||t.mode==="file"||t.mode!=="http"&&!l&&n,r?e=e.slice(zG.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),s=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(i,"localFile",{value:!!s}),i.href=e,t.target&&(i.target=t.target+""),t.rel&&(i.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(i.crossOrigin=t.crossOrigin+""),i}function xpe(e){return e?t=>new Promise((n,i)=>{e.readFile(t,(r,s)=>{r?i(r):n(s)})}):Rpe}async function Rpe(){Z("No file system access.")}function Epe(e){return e?async function(t,n){const i=Ze({},this.options.http,n),r=n&&n.response,s=await e(t,i);return s.ok?nt(s[r])?s[r]():s.text():Z(s.status+""+s.statusText)}:Fpe}async function Fpe(){Z("No HTTP fetch method available.")}const Ape=e=>e!=null&&e===e,Dpe=e=>e==="true"||e==="false"||e===!0||e===!1,Ppe=e=>!Number.isNaN(Date.parse(e)),a8=e=>!Number.isNaN(+e)&&!(e instanceof Date),kpe=e=>a8(e)&&Number.isInteger(+e),nP={boolean:oM,integer:Ai,number:Ai,date:aM,string:lM,unknown:_i},my=[Dpe,kpe,a8,Ppe],Tpe=["boolean","integer","number","date"];function l8(e,t){if(!e||!e.length)return"unknown";const n=e.length,i=my.length,r=my.map((s,o)=>o+1);for(let s=0,o=0,a,l;s<n;++s)for(l=t?e[s][t]:e[s],a=0;a<i;++a)if(r[a]&&Ape(l)&&!my[a](l)&&(r[a]=0,++o,o===my.length))return"string";return Tpe[r.reduce((s,o)=>s===0?o:s,0)-1]}function u8(e,t){return t.reduce((n,i)=>(n[i]=l8(e,i),n),{})}function HG(e){const t=function(n,i){const r={delimiter:e};return CM(n,i?Ze(i,r):r)};return t.responseType="text",t}function CM(e,t){return t.header&&(e=t.header.map(he).join(t.delimiter)+`
`+e),dhe(t.delimiter).parse(e+"")}CM.responseType="text";function Mpe(e){return typeof Buffer=="function"&&nt(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function yM(e,t){const n=t&&t.property?Ms(t.property):_i;return ye(e)&&!Mpe(e)?Ipe(n(e),t):n(JSON.parse(e))}yM.responseType="json";function Ipe(e,t){return!te(e)&&t4(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}const _pe={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function c8(e,t){let n,i,r,s;return e=yM(e,t),t&&t.feature?(n=ghe,r=t.feature):t&&t.mesh?(n=vhe,r=t.mesh,s=_pe[t.filter]):Z("Missing TopoJSON feature or mesh parameter."),i=(i=e.objects[r])?n(e,i,s):Z("Invalid TopoJSON object: "+r),i&&i.features||[i]}c8.responseType="json";const mw={dsv:CM,csv:HG(","),tsv:HG("	"),json:yM,topojson:c8};function wM(e,t){return arguments.length>1?(mw[e]=t,this):Ee(mw,e)?mw[e]:null}function d8(e){const t=wM(e);return t&&t.responseType||"text"}function h8(e,t,n,i){t=t||{};const r=wM(t.type||"json");return r||Z("Unknown data format type: "+t.type),e=r(e,t),t.parse&&Ope(e,t.parse,n,i),Ee(e,"columns")&&delete e.columns,e}function Ope(e,t,n,i){if(!e.length)return;const r=Sv();n=n||r.timeParse,i=i||r.utcParse;let s=e.columns||Object.keys(e[0]),o,a,l,u,c,d;t==="auto"&&(t=u8(e,s)),s=Object.keys(t);const h=s.map(p=>{const g=t[p];let v,C;if(g&&(g.startsWith("date:")||g.startsWith("utc:")))return v=g.split(/:(.+)?/,2),C=v[1],(C[0]==="'"&&C[C.length-1]==="'"||C[0]==='"'&&C[C.length-1]==='"')&&(C=C.slice(1,-1)),(v[0]==="utc"?i:n)(C);if(!nP[g])throw Error("Illegal format pattern: "+p+":"+g);return nP[g]});for(l=0,c=e.length,d=s.length;l<c;++l)for(o=e[l],u=0;u<d;++u)a=s[u],o[a]=h[u](o[a])}const m1=wpe(typeof fetch<"u"&&fetch,null);function v1(e){const t=e||_i,n=[],i={};return n.add=r=>{const s=t(r);return i[s]||(i[s]=1,n.push(r)),n},n.remove=r=>{const s=t(r);if(i[s]){i[s]=0;const o=n.indexOf(r);o>=0&&n.splice(o,1)}return n},n}async function vw(e,t){try{await t(e)}catch(n){e.error(n)}}const f8=Symbol("vega_id");let Lpe=1;function C1(e){return!!(e&&_e(e))}function _e(e){return e[f8]}function p8(e,t){return e[f8]=t,e}function Dt(e){const t=e===Object(e)?e:{data:e};return _e(t)?t:p8(t,Lpe++)}function bM(e){return y1(e,Dt({}))}function y1(e,t){for(const n in e)t[n]=e[n];return t}function g8(e,t){return p8(t,_e(e))}function ih(e,t){return e?t?(n,i)=>e(n,i)||_e(t(n))-_e(t(i)):(n,i)=>e(n,i)||_e(n)-_e(i):null}function m8(e){return e&&e.constructor===cc}function cc(){const e=[],t=[],n=[],i=[],r=[];let s=null,o=!1;return{constructor:cc,insert(a){const l=we(a),u=l.length;for(let c=0;c<u;++c)e.push(l[c]);return this},remove(a){const l=nt(a)?i:t,u=we(a),c=u.length;for(let d=0;d<c;++d)l.push(u[d]);return this},modify(a,l,u){const c={field:l,value:Oi(u)};return nt(a)?(c.filter=a,r.push(c)):(c.tuple=a,n.push(c)),this},encode(a,l){return nt(a)?r.push({filter:a,field:l}):n.push({tuple:a,field:l}),this},clean(a){return s=a,this},reflow(){return o=!0,this},pulse(a,l){const u={},c={};let d,h,p,g,v,C;for(d=0,h=l.length;d<h;++d)u[_e(l[d])]=1;for(d=0,h=t.length;d<h;++d)v=t[d],u[_e(v)]=-1;for(d=0,h=i.length;d<h;++d)g=i[d],l.forEach(b=>{g(b)&&(u[_e(b)]=-1)});for(d=0,h=e.length;d<h;++d)v=e[d],C=_e(v),u[C]?u[C]=1:a.add.push(Dt(e[d]));for(d=0,h=l.length;d<h;++d)v=l[d],u[_e(v)]<0&&a.rem.push(v);function y(b,S,x){x?b[S]=x(b):a.encode=S,o||(c[_e(b)]=b)}for(d=0,h=n.length;d<h;++d)p=n[d],v=p.tuple,g=p.field,C=u[_e(v)],C>0&&(y(v,g,p.value),a.modifies(g));for(d=0,h=r.length;d<h;++d)p=r[d],g=p.filter,l.forEach(b=>{g(b)&&u[_e(b)]>0&&y(b,p.field,p.value)}),a.modifies(p.field);if(o)a.mod=t.length||i.length?l.filter(b=>u[_e(b)]>0):l.slice();else for(C in c)a.mod.push(c[C]);return(s||s==null&&(t.length||i.length))&&a.clean(!0),a}}}const Cw="_:mod:_";function w1(){Object.defineProperty(this,Cw,{writable:!0,value:{}})}w1.prototype={set(e,t,n,i){const r=this,s=r[e],o=r[Cw];return t!=null&&t>=0?(s[t]!==n||i)&&(s[t]=n,o[t+":"+e]=-1,o[e]=-1):(s!==n||i)&&(r[e]=n,o[e]=te(n)?1+n.length:-1),r},modified(e,t){const n=this[Cw];if(arguments.length){if(te(e)){for(let i=0;i<e.length;++i)if(n[e[i]])return!0;return!1}}else{for(const i in n)if(n[i])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[Cw]={},this}};let Npe=0;const $pe="pulse",Bpe=new w1,Gpe=1,zpe=2;function zt(e,t,n,i){this.id=++Npe,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,i)}function VG(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}zt.prototype={targets(){return this._targets||(this._targets=v1(C0))},set(e){return this.value!==e?(this.value=e,1):0},skip:VG(Gpe),modified:VG(zpe),parameters(e,t,n){t=t!==!1;const i=this._argval=this._argval||new w1,r=this._argops=this._argops||[],s=[];let o,a,l,u;const c=(d,h,p)=>{p instanceof zt?(p!==this&&(t&&p.targets().add(this),s.push(p)),r.push({op:p,name:d,index:h})):i.set(d,h,p)};for(o in e)if(a=e[o],o===$pe)we(a).forEach(d=>{d instanceof zt?d!==this&&(d.targets().add(this),s.push(d)):Z("Pulse parameters must be operator instances.")}),this.source=a;else if(te(a))for(i.set(o,-1,Array(l=a.length)),u=0;u<l;++u)c(o,u,a[u]);else c(o,-1,a);return this.marshall().clear(),n&&(r.initonly=!0),s},marshall(e){const t=this._argval||Bpe,n=this._argops;let i,r,s,o;if(n){const a=n.length;for(r=0;r<a;++r)i=n[r],s=i.op,o=s.modified()&&s.stamp===e,t.set(i.name,i.index,s.value,o);if(n.initonly){for(r=0;r<a;++r)i=n[r],i.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,i,r;if(e)for(t=0,n=e.length;t<n;++t)i=e[t],r=i.op,r._targets&&r._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),i=t.call(this,n,e);if(n.clear(),i!==this.value)this.value=i;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function Hpe(e,t,n,i){let r=1,s;return e instanceof zt?s=e:e&&e.prototype instanceof zt?s=new e:nt(e)?s=new zt(null,e):(r=0,s=new zt(e,t)),this.rank(s),r&&(i=n,n=t),n&&this.connect(s,s.parameters(n,i)),this.touch(s),s}function Vpe(e,t){const n=e.rank,i=t.length;for(let r=0;r<i;++r)if(n<t[r].rank){this.rerank(e);return}}let Wpe=0;function b1(e,t,n){this.id=++Wpe,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function pu(e,t,n){return new b1(e,t,n)}b1.prototype={_filter:Is,_apply:_i,targets(){return this._targets||(this._targets=v1(C0))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,i=n?n.length:0;for(let r=0;r<i;++r)n[r].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=pu(e);return this.targets().add(t),t},apply(e){const t=pu(null,e);return this.targets().add(t),t},merge(){const e=pu();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=pu();return this.targets().add(pu(null,null,rM(e,n=>{const i=n.dataflow;t.receive(n),i&&i.run&&i.run()}))),t},between(e,t){let n=!1;return e.targets().add(pu(null,null,()=>n=!0)),t.targets().add(pu(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=Is,this._targets=null}};function Upe(e,t,n,i){const r=this,s=pu(n,i),o=function(u){u.dataflow=r;try{s.receive(u)}catch(c){r.error(c)}finally{r.run()}};let a;typeof e=="string"&&typeof document<"u"?a=document.querySelectorAll(e):a=we(e);const l=a.length;for(let u=0;u<l;++u)a[u].addEventListener(t,o);return s}function jpe(e,t){const n=this.locale();return h8(e,t,n.timeParse,n.utcParse)}function qpe(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function Kpe(e,t){const n=this;let i=0,r;try{r=await n.loader().load(e,{context:"dataflow",response:d8(t&&t.type)});try{r=n.parse(r,t)}catch(s){i=-2,n.warn("Data ingestion failed",e,s)}}catch(s){i=-1,n.warn("Loading failed",e,s)}return{data:r,status:i}}async function Ype(e,t,n){const i=this,r=i._pending||Xpe(i);r.requests+=1;const s=await i.request(t,n);return i.pulse(e,i.changeset().remove(Is).insert(s.data||[])),r.done(),s}function Xpe(e){let t;const n=new Promise(i=>t=i);return n.requests=0,n.done=()=>{--n.requests===0&&(e._pending=null,t(e))},e._pending=n}const Qpe={skip:!0};function Jpe(e,t,n,i,r){return(e instanceof zt?ege:Zpe)(this,e,t,n,i,r),this}function Zpe(e,t,n,i,r,s){const o=Ze({},s,Qpe);let a,l;nt(n)||(n=Oi(n)),i===void 0?a=u=>e.touch(n(u)):nt(i)?(l=new zt(null,i,r,!1),a=u=>{l.evaluate(u);const c=n(u),d=l.value;m8(d)?e.pulse(c,d,s):e.update(c,d,o)}):a=u=>e.update(n(u),i,o),t.apply(a)}function ege(e,t,n,i,r,s){if(i===void 0)t.targets().add(n);else{const o=s||{},a=new zt(null,tge(n,i),r,!1);a.modified(o.force),a.rank=t.rank,t.targets().add(a),n&&(a.skip(!0),a.value=n.value,a.targets().add(n),e.connect(n,[a]))}}function tge(e,t){return t=nt(t)?t:Oi(t),e?function(n,i){const r=t(n,i);return e.skip()||(e.skip(r!==this.value).value=r),r}:t}function nge(e){e.rank=++this._rank}function ige(e){const t=[e];let n,i,r;for(;t.length;)if(this.rank(n=t.pop()),i=n._targets)for(r=i.length;--r>=0;)t.push(n=i[r]),n===e&&Z("Cycle detected in dataflow graph.")}const sb={},Zo=1,Cu=2,nl=4,rge=Zo|Cu,WG=Zo|nl,Hh=Zo|Cu|nl,UG=8,Ug=16,jG=32,qG=64;function Nu(e,t,n){this.dataflow=e,this.stamp=t??-1,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function CF(e,t){const n=[];return vu(e,t,i=>n.push(i)),n}function KG(e,t){const n={};return e.visit(t,i=>{n[_e(i)]=1}),i=>n[_e(i)]?null:i}function vy(e,t){return e?(n,i)=>e(n,i)&&t(n,i):t}Nu.prototype={StopPropagation:sb,ADD:Zo,REM:Cu,MOD:nl,ADD_REM:rge,ADD_MOD:WG,ALL:Hh,REFLOW:UG,SOURCE:Ug,NO_SOURCE:jG,NO_FIELDS:qG,fork(e){return new Nu(this.dataflow).init(this,e)},clone(){const e=this.fork(Hh);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(Hh|Ug)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new Nu(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&qG)&&(n.fields=e.fields),t&Zo?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&Cu?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&nl?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&jG?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||Hh;return t&Zo&&this.add.length||t&Cu&&this.rem.length||t&nl&&this.mod.length},reflow(e){if(e)return this.fork(Hh).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(nl,KG(this,Zo))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return te(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?te(e)?e.some(i=>n[i]):n[e]:!!n:!1},filter(e,t){const n=this;return e&Zo&&(n.addF=vy(n.addF,t)),e&Cu&&(n.remF=vy(n.remF,t)),e&nl&&(n.modF=vy(n.modF,t)),e&Ug&&(n.srcF=vy(n.srcF,t)),n},materialize(e){e=e||Hh;const t=this;return e&Zo&&t.addF&&(t.add=CF(t.add,t.addF),t.addF=null),e&Cu&&t.remF&&(t.rem=CF(t.rem,t.remF),t.remF=null),e&nl&&t.modF&&(t.mod=CF(t.mod,t.modF),t.modF=null),e&Ug&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,i=t;if(e&Ug)return vu(n.source,n.srcF,i),n;e&Zo&&vu(n.add,n.addF,i),e&Cu&&vu(n.rem,n.remF,i),e&nl&&vu(n.mod,n.modF,i);const r=n.source;if(e&UG&&r){const s=n.add.length+n.mod.length;s===r.length||(s?vu(r,KG(n,WG),i):vu(r,n.srcF,i))}return n}};function SM(e,t,n,i){const r=this;let s=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=i||null,this.pulses=n;for(const o of n)if(o.stamp===t){if(o.fields){const a=r.fields||(r.fields={});for(const l in o.fields)a[l]=1}o.changed(r.ADD)&&(s|=r.ADD),o.changed(r.REM)&&(s|=r.REM),o.changed(r.MOD)&&(s|=r.MOD)}this.changes=s}pe(SM,Nu,{fork(e){const t=new Nu(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?te(e)?e.some(i=>n[i]):n[e]:0},filter(){Z("MultiPulse does not support filtering.")},materialize(){Z("MultiPulse does not support materialization.")},visit(e,t){const n=this,i=n.pulses,r=i.length;let s=0;if(e&n.SOURCE)for(;s<r;++s)i[s].visit(e,t);else for(;s<r;++s)i[s].stamp===n.stamp&&i[s].visit(e,t);return n}});async function sge(e,t,n){const i=this,r=[];if(i._pulse)return v8(i);if(i._pending&&await i._pending,t&&await vw(i,t),!i._touched.length)return i.debug("Dataflow invoked, but nothing to do."),i;const s=++i._clock;i._pulse=new Nu(i,s,e),i._touched.forEach(c=>i._enqueue(c,!0)),i._touched=v1(C0);let o=0,a,l,u;try{for(;i._heap.size()>0;){if(a=i._heap.pop(),a.rank!==a.qrank){i._enqueue(a,!0);continue}l=a.run(i._getPulse(a,e)),l.then?l=await l:l.async&&(r.push(l.async),l=sb),l!==sb&&a._targets&&a._targets.forEach(c=>i._enqueue(c)),++o}}catch(c){i._heap.clear(),u=c}if(i._input={},i._pulse=null,i.debug(`Pulse ${s}: ${o} operators`),u&&(i._postrun=[],i.error(u)),i._postrun.length){const c=i._postrun.sort((d,h)=>h.priority-d.priority);i._postrun=[];for(let d=0;d<c.length;++d)await vw(i,c[d].callback)}return n&&await vw(i,n),r.length&&Promise.all(r).then(c=>i.runAsync(null,()=>{c.forEach(d=>{try{d(i)}catch(h){i.error(h)}})})),i}async function oge(e,t,n){for(;this._running;)await this._running;const i=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(i,i),this._running}function age(e,t,n){return this._pulse?v8(this):(this.evaluate(e,t,n),this)}function lge(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(i){this.error(i)}}function v8(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function uge(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function cge(e,t){const n=e.source,i=this._clock;return n&&te(n)?new SM(this,i,n.map(r=>r.pulse),t):this._input[e.id]||dge(this._pulse,n&&n.pulse)}function dge(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==sb&&(e.source=t.source),e)}const xM={skip:!1,force:!1};function hge(e,t){const n=t||xM;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function fge(e,t,n){const i=n||xM;return(e.set(t)||i.force)&&this.touch(e,i),this}function pge(e,t,n){this.touch(e,n||xM);const i=new Nu(this,this._clock+(this._pulse?0:1)),r=e.pulse&&e.pulse.source||[];return i.target=e,this._input[e.id]=t.pulse(i,r),this}function gge(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),C8(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let i;return t.length?(i=t[0],t[0]=n,mge(t,0,e)):i=n,i}}}function C8(e,t,n,i){let r,s;const o=e[n];for(;n>t;){if(s=n-1>>1,r=e[s],i(o,r)<0){e[n]=r,n=s;continue}break}return e[n]=o}function mge(e,t,n){const i=t,r=e.length,s=e[t];let o=(t<<1)+1,a;for(;o<r;)a=o+1,a<r&&n(e[o],e[a])>=0&&(o=a),e[t]=e[o],t=o,o=(t<<1)+1;return e[t]=s,C8(e,i,t,n)}function wf(){this.logger(ZT()),this.logLevel(QT),this._clock=0,this._rank=0,this._locale=vM();try{this._loader=m1()}catch{}this._touched=v1(C0),this._input={},this._pulse=null,this._heap=gge((e,t)=>e.qrank-t.qrank),this._postrun=[]}function jg(e){return function(){return this._log[e].apply(this,arguments)}}wf.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:jg("error"),warn:jg("warn"),info:jg("info"),debug:jg("debug"),logLevel:jg("level"),cleanThreshold:1e4,add:Hpe,connect:Vpe,rank:nge,rerank:ige,pulse:pge,touch:hge,update:fge,changeset:cc,ingest:qpe,parse:jpe,preload:Ype,request:Kpe,events:Upe,on:Jpe,evaluate:sge,run:age,runAsync:oge,runAfter:lge,_enqueue:uge,_getPulse:cge};function Y(e,t){zt.call(this,e,null,t)}pe(Y,zt,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const Wf={};function y8(e){const t=w8(e);return t&&t.Definition||null}function w8(e){return e=e&&e.toLowerCase(),Ee(Wf,e)?Wf[e]:null}function*b8(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)i=t(i,++n,e),i!=null&&i!==""&&(i=+i)>=i&&(yield i)}}function RM(e,t,n){const i=Float64Array.from(b8(e,n));return i.sort(ml),t.map(r=>v4(i,r))}function EM(e,t){return RM(e,[.25,.5,.75],t)}function FM(e,t){const n=e.length,i=Ehe(e,t),r=EM(e,t),s=(r[2]-r[0])/1.34;return 1.06*(Math.min(i,s)||i||Math.abs(r[0])||1)*Math.pow(n,-.2)}function S8(e){const t=e.maxbins||20,n=e.base||10,i=Math.log(n),r=e.divide||[5,2];let s=e.extent[0],o=e.extent[1],a,l,u,c,d,h;const p=e.span||o-s||Math.abs(s)||1;if(e.step)a=e.step;else if(e.steps){for(c=p/t,d=0,h=e.steps.length;d<h&&e.steps[d]<c;++d);a=e.steps[Math.max(0,d-1)]}else{for(l=Math.ceil(Math.log(t)/i),u=e.minstep||0,a=Math.max(u,Math.pow(n,Math.round(Math.log(p)/i)-l));Math.ceil(p/a)>t;)a*=n;for(d=0,h=r.length;d<h;++d)c=a/r[d],c>=u&&p/c<=t&&(a=c)}c=Math.log(a);const g=c>=0?0:~~(-c/i)+1,v=Math.pow(n,-g-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(s/a+v)*a,s=s<c?c-a:c,o=Math.ceil(o/a)*a),{start:s,stop:o===s?s+a:o,step:a}}var Os=Math.random;function vge(e){Os=e}function x8(e,t,n,i){if(!e.length)return[void 0,void 0];const r=Float64Array.from(b8(e,i)),s=r.length,o=t;let a,l,u,c;for(u=0,c=Array(o);u<o;++u){for(a=0,l=0;l<s;++l)a+=r[~~(Os()*s)];c[u]=a/s}return c.sort(ml),[qD(c,n/2),qD(c,1-n/2)]}function R8(e,t,n,i){i=i||(h=>h);const r=e.length,s=new Float64Array(r);let o=0,a=1,l=i(e[0]),u=l,c=l+t,d;for(;a<r;++a){if(d=i(e[a]),d>=c){for(u=(l+u)/2;o<a;++o)s[o]=u;c=d+t,l=d}u=d}for(u=(l+u)/2;o<a;++o)s[o]=u;return n?Cge(s,t+t/4):s}function Cge(e,t){const n=e.length;let i=0,r=1,s,o;for(;e[i]===e[r];)++r;for(;r<n;){for(s=r+1;e[r]===e[s];)++s;if(e[r]-e[r-1]<t){for(o=r+(i+s-r-r>>1);o<r;)e[o++]=e[r];for(;o>r;)e[o--]=e[i]}i=r,r=s}return e}function yge(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function wge(e,t){t==null&&(t=e,e=0);let n,i,r;const s={min(o){return arguments.length?(n=o||0,r=i-n,s):n},max(o){return arguments.length?(i=o||0,r=i-n,s):i},sample(){return n+Math.floor(r*Os())},pdf(o){return o===Math.floor(o)&&o>=n&&o<i?1/r:0},cdf(o){const a=Math.floor(o);return a<n?0:a>=i?1:(a-n+1)/r},icdf(o){return o>=0&&o<=1?n-1+Math.floor(o*r):NaN}};return s.min(e).max(t)}const E8=Math.sqrt(2*Math.PI),bge=Math.SQRT2;let qg=NaN;function S1(e,t){e=e||0,t=t??1;let n=0,i=0,r,s;if(qg===qg)n=qg,qg=NaN;else{do n=Os()*2-1,i=Os()*2-1,r=n*n+i*i;while(r===0||r>1);s=Math.sqrt(-2*Math.log(r)/r),n*=s,qg=i*s}return e+n*t}function AM(e,t,n){n=n??1;const i=(e-(t||0))/n;return Math.exp(-.5*i*i)/(n*E8)}function x1(e,t,n){t=t||0,n=n??1;const i=(e-t)/n,r=Math.abs(i);let s;if(r>37)s=0;else{const o=Math.exp(-r*r/2);let a;r<7.07106781186547?(a=.0352624965998911*r+.700383064443688,a=a*r+6.37396220353165,a=a*r+33.912866078383,a=a*r+112.079291497871,a=a*r+221.213596169931,a=a*r+220.206867912376,s=o*a,a=.0883883476483184*r+1.75566716318264,a=a*r+16.064177579207,a=a*r+86.7807322029461,a=a*r+296.564248779674,a=a*r+637.333633378831,a=a*r+793.826512519948,a=a*r+440.413735824752,s=s/a):(a=r+.65,a=r+4/a,a=r+3/a,a=r+2/a,a=r+1/a,s=o/a/2.506628274631)}return i>0?1-s:s}function R1(e,t,n){return e<0||e>1?NaN:(t||0)+(n??1)*bge*Sge(2*e-1)}function Sge(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function DM(e,t){let n,i;const r={mean(s){return arguments.length?(n=s||0,r):n},stdev(s){return arguments.length?(i=s??1,r):i},sample:()=>S1(n,i),pdf:s=>AM(s,n,i),cdf:s=>x1(s,n,i),icdf:s=>R1(s,n,i)};return r.mean(e).stdev(t)}function PM(e,t){const n=DM();let i=0;const r={data(s){return arguments.length?(e=s,i=s?s.length:0,r.bandwidth(t)):e},bandwidth(s){return arguments.length?(t=s,!t&&e&&(t=FM(e)),r):t},sample(){return e[~~(Os()*i)]+t*n.sample()},pdf(s){let o=0,a=0;for(;a<i;++a)o+=n.pdf((s-e[a])/t);return o/t/i},cdf(s){let o=0,a=0;for(;a<i;++a)o+=n.cdf((s-e[a])/t);return o/i},icdf(){throw Error("KDE icdf not supported.")}};return r.data(e)}function kM(e,t){return e=e||0,t=t??1,Math.exp(e+S1()*t)}function TM(e,t,n){if(e<=0)return 0;t=t||0,n=n??1;const i=(Math.log(e)-t)/n;return Math.exp(-.5*i*i)/(n*E8*e)}function MM(e,t,n){return x1(Math.log(e),t,n)}function IM(e,t,n){return Math.exp(R1(e,t,n))}function F8(e,t){let n,i;const r={mean(s){return arguments.length?(n=s||0,r):n},stdev(s){return arguments.length?(i=s??1,r):i},sample:()=>kM(n,i),pdf:s=>TM(s,n,i),cdf:s=>MM(s,n,i),icdf:s=>IM(s,n,i)};return r.mean(e).stdev(t)}function A8(e,t){let n=0,i;function r(o){const a=[];let l=0,u;for(u=0;u<n;++u)l+=a[u]=o[u]==null?1:+o[u];for(u=0;u<n;++u)a[u]/=l;return a}const s={weights(o){return arguments.length?(i=r(t=o||[]),s):t},distributions(o){return arguments.length?(o?(n=o.length,e=o):(n=0,e=[]),s.weights(t)):e},sample(){const o=Os();let a=e[n-1],l=i[0],u=0;for(;u<n-1;l+=i[++u])if(o<l){a=e[u];break}return a.sample()},pdf(o){let a=0,l=0;for(;l<n;++l)a+=i[l]*e[l].pdf(o);return a},cdf(o){let a=0,l=0;for(;l<n;++l)a+=i[l]*e[l].cdf(o);return a},icdf(){throw Error("Mixture icdf not supported.")}};return s.distributions(e).weights(t)}function _M(e,t){return t==null&&(t=e??1,e=0),e+(t-e)*Os()}function OM(e,t,n){return n==null&&(n=t??1,t=0),e>=t&&e<=n?1/(n-t):0}function LM(e,t,n){return n==null&&(n=t??1,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function NM(e,t,n){return n==null&&(n=t??1,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function D8(e,t){let n,i;const r={min(s){return arguments.length?(n=s||0,r):n},max(s){return arguments.length?(i=s??1,r):i},sample:()=>_M(n,i),pdf:s=>OM(s,n,i),cdf:s=>LM(s,n,i),icdf:s=>NM(s,n,i)};return t==null&&(t=e??1,e=0),r.min(e).max(t)}function $M(e,t,n){let i=0,r=0;for(const s of e){const o=n(s);t(s)==null||o==null||isNaN(o)||(i+=(o-i)/++r)}return{coef:[i],predict:()=>i,rSquared:0}}function w0(e,t,n,i){const r=i-e*e,s=Math.abs(r)<1e-24?0:(n-e*t)/r;return[t-s*e,s]}function E1(e,t,n,i){e=e.filter(p=>{let g=t(p),v=n(p);return g!=null&&(g=+g)>=g&&v!=null&&(v=+v)>=v}),i&&e.sort((p,g)=>t(p)-t(g));const r=e.length,s=new Float64Array(r),o=new Float64Array(r);let a=0,l=0,u=0,c,d,h;for(h of e)s[a]=c=+t(h),o[a]=d=+n(h),++a,l+=(c-l)/a,u+=(d-u)/a;for(a=0;a<r;++a)s[a]-=l,o[a]-=u;return[s,o,l,u]}function b0(e,t,n,i){let r=-1,s,o;for(const a of e)s=t(a),o=n(a),s!=null&&(s=+s)>=s&&o!=null&&(o=+o)>=o&&i(s,o,++r)}function zp(e,t,n,i,r){let s=0,o=0;return b0(e,t,n,(a,l)=>{const u=l-r(a),c=l-i;s+=u*u,o+=c*c}),1-s/o}function BM(e,t,n){let i=0,r=0,s=0,o=0,a=0;b0(e,t,n,(c,d)=>{++a,i+=(c-i)/a,r+=(d-r)/a,s+=(c*d-s)/a,o+=(c*c-o)/a});const l=w0(i,r,s,o),u=c=>l[0]+l[1]*c;return{coef:l,predict:u,rSquared:zp(e,t,n,r,u)}}function P8(e,t,n){let i=0,r=0,s=0,o=0,a=0;b0(e,t,n,(c,d)=>{++a,c=Math.log(c),i+=(c-i)/a,r+=(d-r)/a,s+=(c*d-s)/a,o+=(c*c-o)/a});const l=w0(i,r,s,o),u=c=>l[0]+l[1]*Math.log(c);return{coef:l,predict:u,rSquared:zp(e,t,n,r,u)}}function k8(e,t,n){const[i,r,s,o]=E1(e,t,n);let a=0,l=0,u=0,c=0,d=0,h,p,g;b0(e,t,n,(b,S)=>{h=i[d++],p=Math.log(S),g=h*S,a+=(S*p-a)/d,l+=(g-l)/d,u+=(g*p-u)/d,c+=(h*g-c)/d});const[v,C]=w0(l/o,a/o,u/o,c/o),y=b=>Math.exp(v+C*(b-s));return{coef:[Math.exp(v-C*s),C],predict:y,rSquared:zp(e,t,n,o,y)}}function T8(e,t,n){let i=0,r=0,s=0,o=0,a=0,l=0;b0(e,t,n,(d,h)=>{const p=Math.log(d),g=Math.log(h);++l,i+=(p-i)/l,r+=(g-r)/l,s+=(p*g-s)/l,o+=(p*p-o)/l,a+=(h-a)/l});const u=w0(i,r,s,o),c=d=>u[0]*Math.pow(d,u[1]);return u[0]=Math.exp(u[0]),{coef:u,predict:c,rSquared:zp(e,t,n,a,c)}}function GM(e,t,n){const[i,r,s,o]=E1(e,t,n),a=i.length;let l=0,u=0,c=0,d=0,h=0,p,g,v,C;for(p=0;p<a;)g=i[p],v=r[p++],C=g*g,l+=(C-l)/p,u+=(C*g-u)/p,c+=(C*C-c)/p,d+=(g*v-d)/p,h+=(C*v-h)/p;const y=c-l*l,b=l*y-u*u,S=(h*l-d*u)/b,x=(d*y-h*u)/b,E=-S*l,A=F=>(F=F-s,S*F*F+x*F+E+o);return{coef:[E-x*s+S*s*s+o,x-2*S*s,S],predict:A,rSquared:zp(e,t,n,o,A)}}function M8(e,t,n,i){if(i===0)return $M(e,t,n);if(i===1)return BM(e,t,n);if(i===2)return GM(e,t,n);const[r,s,o,a]=E1(e,t,n),l=r.length,u=[],c=[],d=i+1;let h,p,g,v,C;for(h=0;h<d;++h){for(g=0,v=0;g<l;++g)v+=Math.pow(r[g],h)*s[g];for(u.push(v),C=new Float64Array(d),p=0;p<d;++p){for(g=0,v=0;g<l;++g)v+=Math.pow(r[g],h+p);C[p]=v}c.push(C)}c.push(u);const y=Rge(c),b=S=>{S-=o;let x=a+y[0]+y[1]*S+y[2]*S*S;for(h=3;h<d;++h)x+=y[h]*Math.pow(S,h);return x};return{coef:xge(d,y,-o,a),predict:b,rSquared:zp(e,t,n,a,b)}}function xge(e,t,n,i){const r=Array(e);let s,o,a,l;for(s=0;s<e;++s)r[s]=0;for(s=e-1;s>=0;--s)for(a=t[s],l=1,r[s]+=a,o=1;o<=s;++o)l*=(s+1-o)/o,r[s-o]+=a*Math.pow(n,o)*l;return r[0]+=i,r}function Rge(e){const t=e.length-1,n=[];let i,r,s,o,a;for(i=0;i<t;++i){for(o=i,r=i+1;r<t;++r)Math.abs(e[i][r])>Math.abs(e[i][o])&&(o=r);for(s=i;s<t+1;++s)a=e[s][i],e[s][i]=e[s][o],e[s][o]=a;for(r=i+1;r<t;++r)for(s=t;s>=i;s--)e[s][r]-=e[s][i]*e[i][r]/e[i][i]}for(r=t-1;r>=0;--r){for(a=0,s=r+1;s<t;++s)a+=e[s][r]*n[s];n[r]=(e[t][r]-a)/e[r][r]}return n}const YG=2,XG=1e-12;function I8(e,t,n,i){const[r,s,o,a]=E1(e,t,n,!0),l=r.length,u=Math.max(2,~~(i*l)),c=new Float64Array(l),d=new Float64Array(l),h=new Float64Array(l).fill(1);for(let p=-1;++p<=YG;){const g=[0,u-1];for(let C=0;C<l;++C){const y=r[C],b=g[0],S=g[1],x=y-r[b]>r[S]-y?b:S;let E=0,A=0,F=0,k=0,P=0;const _=1/Math.abs(r[x]-y||1);for(let W=b;W<=S;++W){const $=r[W],L=s[W],G=Ege(Math.abs(y-$)*_)*h[W],j=$*G;E+=G,A+=j,F+=L*G,k+=L*j,P+=$*j}const[O,H]=w0(A/E,F/E,k/E,P/E);c[C]=O+H*y,d[C]=Math.abs(s[C]-c[C]),Fge(r,C+1,g)}if(p===YG)break;const v=C4(d);if(Math.abs(v)<XG)break;for(let C=0,y,b;C<l;++C)y=d[C]/(6*v),h[C]=y>=1?XG:(b=1-y*y)*b}return Age(r,c,o,a)}function Ege(e){return(e=1-e*e*e)*e*e}function Fge(e,t,n){const i=e[t];let r=n[0],s=n[1]+1;if(!(s>=e.length))for(;t>r&&e[s]-i<=i-e[r];)n[0]=++r,n[1]=s,++s}function Age(e,t,n,i){const r=e.length,s=[];let o=0,a=0,l=[],u;for(;o<r;++o)u=e[o]+n,l[0]===u?l[1]+=(t[o]-l[1])/++a:(a=0,l[1]+=i,l=[u,t[o]],s.push(l));return l[1]+=i,s}const Dge=.5*Math.PI/180;function F1(e,t,n,i){n=n||25,i=Math.max(n,i||200);const r=v=>[v,e(v)],s=t[0],o=t[1],a=o-s,l=a/i,u=[r(s)],c=[];if(n===i){for(let v=1;v<i;++v)u.push(r(s+v/n*a));return u.push(r(o)),u}else{c.push(r(o));for(let v=n;--v>0;)c.push(r(s+v/n*a))}let d=u[0],h=c[c.length-1];const p=1/a,g=Pge(d[1],c);for(;h;){const v=r((d[0]+h[0])/2);v[0]-d[0]>=l&&kge(d,v,h,p,g)>Dge?c.push(v):(d=h,u.push(h),c.pop()),h=c[c.length-1]}return u}function Pge(e,t){let n=e,i=e;const r=t.length;for(let s=0;s<r;++s){const o=t[s][1];o<n&&(n=o),o>i&&(i=o)}return 1/(i-n)}function kge(e,t,n,i,r){const s=Math.atan2(r*(n[1]-e[1]),i*(n[0]-e[0])),o=Math.atan2(r*(t[1]-e[1]),i*(t[0]-e[0]));return Math.abs(s-o)}function Tge(e){return t=>{const n=e.length;let i=1,r=String(e[0](t));for(;i<n;++i)r+="|"+e[i](t);return r}}function iP(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:Tge(e)}function _8(e,t,n){return n||e+(t?"_"+t:"")}const yF=()=>{},Mge={init:yF,add:yF,rem:yF,idx:0},xv={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.valid?e.sum:void 0,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3},exponential:{init:(e,t)=>{e.exp=0,e.exp_r=t},value:e=>e.valid?e.exp*(1-e.exp_r)/(1-e.exp_r**e.valid):void 0,add:(e,t)=>e.exp=e.exp_r*e.exp+t,rem:(e,t)=>e.exp=(e.exp-t/e.exp_r**(e.valid-1))/e.exp_r},exponentialb:{value:e=>e.valid?e.exp*(1-e.exp_r):void 0,req:["exponential"],idx:1}},S0=Object.keys(xv).filter(e=>e!=="__count__");function Ige(e,t){return(n,i)=>Ze({name:e,aggregate_param:i,out:n||e},Mge,t)}[...S0,"__count__"].forEach(e=>{xv[e]=Ige(e,xv[e])});function O8(e,t,n){return xv[e](n,t)}function L8(e,t){return e.idx-t.idx}function _ge(e){const t={};e.forEach(i=>t[i.name]=i);const n=i=>{i.req&&i.req.forEach(r=>{t[r]||n(t[r]=xv[r]())})};return e.forEach(n),Object.values(t).sort(L8)}function Oge(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.aggregate_param==null?e.init(this):e.init(this,e.aggregate_param))}function Lge(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function Nge(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function $ge(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function N8(e,t){const n=t||_i,i=_ge(e),r=e.slice().sort(L8);function s(o){this._ops=i,this._out=r,this.cell=o,this.init()}return s.prototype.init=Oge,s.prototype.add=Lge,s.prototype.rem=Nge,s.prototype.set=$ge,s.prototype.get=n,s.fields=e.map(o=>o.out),s}function zM(e){this._key=e?Ms(e):_e,this.reset()}const Ci=zM.prototype;Ci.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};Ci.add=function(e){this._add.push(e)};Ci.rem=function(e){this._rem.push(e)};Ci.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,i=e.length,r=t.length,s=Array(i-r),o={};let a,l,u;for(a=0;a<r;++a)o[n(t[a])]=1;for(a=0,l=0;a<i;++a)o[n(u=e[a])]?o[n(u)]=0:s[l++]=u;return this._rem=[],this._add=s};Ci.distinct=function(e){const t=this.values(),n={};let i=t.length,r=0,s;for(;--i>=0;)s=e(t[i])+"",Ee(n,s)||(n[s]=1,++r);return r};Ci.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=ZW(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext};Ci.argmin=function(e){return this.extent(e)[0]||{}};Ci.argmax=function(e){return this.extent(e)[1]||{}};Ci.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0};Ci.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0};Ci.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=EM(this.values(),e),this._get=e),this._q};Ci.q1=function(e){return this.quartile(e)[0]};Ci.q2=function(e){return this.quartile(e)[1]};Ci.q3=function(e){return this.quartile(e)[2]};Ci.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=x8(this.values(),1e3,.05,e),this._get=e),this._ci};Ci.ci0=function(e){return this.ci(e)[0]};Ci.ci1=function(e){return this.ci(e)[1]};function Uu(e){Y.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Uu.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:S0},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};pe(Uu,Y,{transform(e,t){const n=this,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.modified();return n.stamp=i.stamp,n.value&&(r||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=r?n.init(e):Object.create(null),t.visit(t.SOURCE,s=>n.add(s))):(n.value=n.value||n.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),i.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&i.clean(!0).runAfter(()=>this.clean()),n.changes(i)},cross(){const e=this,t=e.value,n=e._dnames,i=n.map(()=>({})),r=n.length;function s(a){let l,u,c,d;for(l in a)for(c=a[l].tuple,u=0;u<r;++u)i[u][d=c[n[u]]]=d}s(e._prev),s(t);function o(a,l,u){const c=n[u],d=i[u++];for(const h in d){const p=a?a+"|"+h:h;l[c]=d[h],u<r?o(p,l,u):t[p]||e.cell(p,l)}}o("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],i={};function r(b){const S=we(Pi(b)),x=S.length;let E=0,A;for(;E<x;++E)i[A=S[E]]||(i[A]=1,t.push(A))}this._dims=we(e.groupby),this._dnames=this._dims.map(b=>{const S=yn(b);return r(b),n.push(S),S}),this.cellkey=e.key?e.key:iP(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const s=e.fields||[null],o=e.ops||["count"],a=e.aggregate_params||[null],l=e.as||[],u=s.length,c={};let d,h,p,g,v,C,y;for(u!==o.length&&Z("Unmatched number of fields and aggregate ops."),y=0;y<u;++y){if(d=s[y],h=o[y],p=a[y]||null,d==null&&h!=="count"&&Z("Null aggregate field specified."),v=yn(d),C=_8(h,v,l[y]),n.push(C),h==="count"){this._counts.push(C);continue}g=c[v],g||(r(d),g=c[v]=[],g.field=d,this._measures.push(g)),h!=="count"&&(this._countOnly=!1),g.push(O8(h,p,C))}return this._measures=this._measures.map(b=>N8(b,b.field)),Object.create(null)},cellkey:iP(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const i=this._measures,r=i.length;n.agg=Array(r);for(let s=0;s<r;++s)n.agg[s]=new i[s](n)}return n.store&&(n.data=new zM),n},newtuple(e,t){const n=this._dnames,i=this._dims,r=i.length,s={};for(let o=0;o<r;++o)s[n[o]]=i[o](e);return t?g8(t.tuple,s):Dt(s)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const i=n.agg;for(let r=0,s=i.length;r<s;++r)i[r].add(i[r].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const i=n.agg;for(let r=0,s=i.length;r<s;++r)i[r].rem(i[r].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let i=0,r=n.length;i<r;++i)t[n[i]]=e.num;if(!this._countOnly){const i=e.agg;for(let r=0,s=i.length;r<s;++r)i[r].set(t)}return t},changes(e){const t=this._adds,n=this._mods,i=this._prev,r=this._drop,s=e.add,o=e.rem,a=e.mod;let l,u,c,d;if(i)for(u in i)l=i[u],(!r||l.num)&&o.push(l.tuple);for(c=0,d=this._alen;c<d;++c)s.push(this.celltuple(t[c])),t[c]=null;for(c=0,d=this._mlen;c<d;++c)l=n[c],(l.num===0&&r?o:a).push(this.celltuple(l)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});const Bge=1e-14;function HM(e){Y.call(this,null,e)}HM.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};pe(HM,Y,{transform(e,t){const n=e.interval!==!1,i=this._bins(e),r=i.start,s=i.step,o=e.as||["bin0","bin1"],a=o[0],l=o[1];let u;return e.modified()?(t=t.reflow(!0),u=t.SOURCE):u=t.modified(Pi(e.field))?t.ADD_MOD:t.ADD,t.visit(u,n?c=>{const d=i(c);c[a]=d,c[l]=d==null?null:r+s*(1+(d-r)/s)}:c=>c[a]=i(c)),t.modifies(n?o:a)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=S8(e),i=n.step;let r=n.start,s=r+Math.ceil((n.stop-r)/i)*i,o,a;(o=e.anchor)!=null&&(a=o-(r+i*Math.floor((o-r)/i)),r+=a,s+=a);const l=function(u){let c=Ai(t(u));return c==null?null:c<r?-1/0:c>s?1/0:(c=Math.max(r,Math.min(c,s-i)),r+i*Math.floor(Bge+(c-r)/i))};return l.start=r,l.stop=n.stop,l.step=i,this.value=Ir(l,Pi(t),e.name||"bin_"+yn(t))}});function $8(e,t,n){const i=e;let r=t||[],s=n||[],o={},a=0;return{add:l=>s.push(l),remove:l=>o[i(l)]=++a,size:()=>r.length,data:(l,u)=>(a&&(r=r.filter(c=>!o[i(c)]),o={},a=0),u&&l&&r.sort(l),s.length&&(r=l?s4(l,r,s.sort(l)):r.concat(s),s=[]),r)}}function VM(e){Y.call(this,[],e)}VM.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};pe(VM,Y,{transform(e,t){const n=t.fork(t.ALL),i=$8(_e,this.value,n.materialize(n.ADD).add),r=e.sort,s=t.changed()||r&&(e.modified("sort")||t.modified(r.fields));return n.visit(n.REM,i.remove),this.modified(s),this.value=n.source=i.data(ih(r),s),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function B8(e){zt.call(this,null,Gge,e)}pe(B8,zt);function Gge(e){return this.value&&!e.modified()?this.value:iM(e.fields,e.orders)}function WM(e){Y.call(this,null,e)}WM.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function zge(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}pe(WM,Y,{transform(e,t){const n=d=>h=>{for(var p=zge(a(h),e.case,s)||[],g,v=0,C=p.length;v<C;++v)o.test(g=p[v])||d(g)},i=this._parameterCheck(e,t),r=this._counts,s=this._match,o=this._stop,a=e.field,l=e.as||["text","count"],u=n(d=>r[d]=1+(r[d]||0)),c=n(d=>r[d]-=1);return i?t.visit(t.SOURCE,u):(t.visit(t.ADD,u),t.visit(t.REM,c)),this._finish(t,l)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,i=this._tuples||(this._tuples={}),r=t[0],s=t[1],o=e.fork(e.NO_SOURCE|e.NO_FIELDS);let a,l,u;for(a in n)l=i[a],u=n[a]||0,!l&&u?(i[a]=l=Dt({}),l[r]=a,l[s]=u,o.add.push(l)):u===0?(l&&o.rem.push(l),n[a]=null,i[a]=null):l[s]!==u&&(l[s]=u,o.mod.push(l));return o.modifies(t)}});function UM(e){Y.call(this,null,e)}UM.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};pe(UM,Y,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.as||["a","b"],r=i[0],s=i[1],o=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let a=this.value;return o?(a&&(n.rem=a),a=t.materialize(t.SOURCE).source,n.add=this.value=Hge(a,r,s,e.filter||Is)):n.mod=a,n.source=this.value,n.modifies(i)}});function Hge(e,t,n,i){for(var r=[],s={},o=e.length,a=0,l,u;a<o;++a)for(s[t]=u=e[a],l=0;l<o;++l)s[n]=e[l],i(s)&&(r.push(Dt(s)),s={},s[t]=u);return r}const QG={kde:PM,mixture:A8,normal:DM,lognormal:F8,uniform:D8},Vge="distributions",JG="function",Wge="field";function G8(e,t){const n=e[JG];Ee(QG,n)||Z("Unknown distribution function: "+n);const i=QG[n]();for(const r in e)r===Wge?i.data((e.from||t()).map(e[r])):r===Vge?i[r](e[r].map(s=>G8(s,t))):typeof i[r]===JG&&i[r](e[r]);return i}function jM(e){Y.call(this,null,e)}const z8=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],Uge={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:z8},{name:"weights",type:"number",array:!0}]};jM.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:z8.concat(Uge)},{name:"as",type:"string",array:!0,default:["value","density"]}]};pe(jM,Y,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=G8(e.distribution,jge(t)),r=e.steps||e.minsteps||25,s=e.steps||e.maxsteps||200;let o=e.method||"pdf";o!=="pdf"&&o!=="cdf"&&Z("Invalid density method: "+o),!e.extent&&!i.data&&Z("Missing density extent parameter."),o=i[o];const a=e.as||["value","density"],l=e.extent||ma(i.data()),u=F1(o,l,r,s).map(c=>{const d={};return d[a[0]]=c[0],d[a[1]]=c[1],Dt(d)});this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});function jge(e){return()=>e.materialize(e.SOURCE).source}function H8(e,t){return e?e.map((n,i)=>t[i]||yn(n)):null}function qM(e,t,n){const i=[],r=d=>d(l);let s,o,a,l,u,c;if(t==null)i.push(e.map(n));else for(s={},o=0,a=e.length;o<a;++o)l=e[o],u=t.map(r),c=s[u],c||(s[u]=c=[],c.dims=u,i.push(c)),c.push(n(l));return i}const V8="bin";function KM(e){Y.call(this,null,e)}KM.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:V8}]};const qge=(e,t)=>y0(ma(e,t))/30;pe(KM,Y,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,i=qM(t.source,e.groupby,_i),r=e.smooth||!1,s=e.field,o=e.step||qge(n,s),a=ih((g,v)=>s(g)-s(v)),l=e.as||V8,u=i.length;let c=1/0,d=-1/0,h=0,p;for(;h<u;++h){const g=i[h].sort(a);p=-1;for(const v of R8(g,o,r,s))v<c&&(c=v),v>d&&(d=v),g[++p][l]=v}return this.value={start:c,stop:d,step:o},t.reflow(!0).modifies(l)}});function W8(e){zt.call(this,null,Kge,e),this.modified(!0)}pe(W8,zt);function Kge(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:Ir(n=>t(n,e),Pi(t),yn(t))}function YM(e){Y.call(this,[void 0,void 0],e)}YM.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};pe(YM,Y,{transform(e,t){const n=this.value,i=e.field,r=t.changed()||t.modified(i.fields)||e.modified("field");let s=n[0],o=n[1];if((r||s==null)&&(s=1/0,o=-1/0),t.visit(r?t.SOURCE:t.ADD,a=>{const l=Ai(i(a));l!=null&&(l<s&&(s=l),l>o&&(o=l))}),!Number.isFinite(s)||!Number.isFinite(o)){let a=yn(i);a&&(a=` for field "${a}"`),t.dataflow.warn(`Infinite extent${a}: [${s}, ${o}]`),s=o=void 0}this.value=[s,o]}});function XM(e,t){zt.call(this,e),this.parent=t,this.count=0}pe(XM,zt,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function A1(e){Y.call(this,{},e),this._keys=Op();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let i=0,r=t.active;i<r;++i)n(t[i],i,t)}}pe(A1,Y,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,i){const r=this.value;let s=Ee(r,e)&&r[e],o,a;return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(a=i||(a=this._group[e])&&a.tuple,o=n.dataflow,s=new XM(n.fork(n.NO_SOURCE),this),o.add(s).connect(t(o,e,a)),r[e]=s,this.activate(s)),s},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const i=e[n].detachSubflow;i&&i(),delete e[n],++t}if(t){const n=this._targets.filter(i=>i&&i.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,i=e?e.length:0;let r=0;for(;r<i;++r)t[r]=e[r];for(;r<n&&t[r]!=null;++r)t[r]=null;t.active=i},transform(e,t){const n=t.dataflow,i=e.key,r=e.subflow,s=this._keys,o=e.modified("key"),a=l=>this.subflow(l,r,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,l=>{const u=_e(l),c=s.get(u);c!==void 0&&(s.delete(u),a(c).rem(l))}),t.visit(t.ADD,l=>{const u=i(l);s.set(_e(l),u),a(u).add(l)}),o||t.modified(i.fields)?t.visit(t.MOD,l=>{const u=_e(l),c=s.get(u),d=i(l);c===d?a(d).mod(l):(s.set(u,d),a(c).rem(l),a(d).add(l))}):t.changed(t.MOD)&&t.visit(t.MOD,l=>{a(s.get(_e(l))).mod(l)}),o&&t.visit(t.REFLOW,l=>{const u=_e(l),c=s.get(u),d=i(l);c!==d&&(s.set(u,d),a(c).rem(l),a(d).add(l))}),t.clean()?n.runAfter(()=>{this.clean(),s.clean()}):s.empty>n.cleanThreshold&&n.runAfter(s.clean),t}});function U8(e){zt.call(this,null,Yge,e)}pe(U8,zt);function Yge(e){return this.value&&!e.modified()?this.value:te(e.name)?we(e.name).map(t=>Ms(t)):Ms(e.name,e.as)}function QM(e){Y.call(this,Op(),e)}QM.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};pe(QM,Y,{transform(e,t){const n=t.dataflow,i=this.value,r=t.fork(),s=r.add,o=r.rem,a=r.mod,l=e.expr;let u=!0;t.visit(t.REM,d=>{const h=_e(d);i.has(h)?i.delete(h):o.push(d)}),t.visit(t.ADD,d=>{l(d,e)?s.push(d):i.set(_e(d),1)});function c(d){const h=_e(d),p=l(d,e),g=i.get(h);p&&g?(i.delete(h),s.push(d)):!p&&!g?(i.set(h,1),o.push(d)):u&&p&&!g&&a.push(d)}return t.visit(t.MOD,c),e.modified()&&(u=!1,t.visit(t.REFLOW,c)),i.empty>n.cleanThreshold&&n.runAfter(i.clean),r}});function JM(e){Y.call(this,[],e)}JM.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};pe(JM,Y,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=H8(i,e.as||[]),s=e.index||null,o=r.length;return n.rem=this.value,t.visit(t.SOURCE,a=>{const l=i.map(g=>g(a)),u=l.reduce((g,v)=>Math.max(g,v.length),0);let c=0,d,h,p;for(;c<u;++c){for(h=bM(a),d=0;d<o;++d)h[r[d]]=(p=l[d][c])==null?null:p;s&&(h[s]=c),n.add.push(h)}}),this.value=n.source=n.add,s&&n.modifies(s),n.modifies(r)}});function ZM(e){Y.call(this,[],e)}ZM.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};pe(ZM,Y,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=i.map(yn),s=e.as||["key","value"],o=s[0],a=s[1],l=i.length;return n.rem=this.value,t.visit(t.SOURCE,u=>{for(let c=0,d;c<l;++c)d=bM(u),d[o]=r[c],d[a]=i[c](u),n.add.push(d)}),this.value=n.source=n.add,n.modifies(s)}});function eI(e){Y.call(this,null,e)}eI.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};pe(eI,Y,{transform(e,t){const n=e.expr,i=e.as,r=e.modified(),s=e.initonly?t.ADD:r?t.SOURCE:t.modified(n.fields)||t.modified(i)?t.ADD_MOD:t.ADD;return r&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(i),t.visit(s,o=>o[i]=n(o,e))}});function j8(e){Y.call(this,[],e)}pe(j8,Y,{transform(e,t){const n=t.fork(t.ALL),i=e.generator;let r=this.value,s=e.size-r.length,o,a,l;if(s>0){for(o=[];--s>=0;)o.push(l=Dt(i(e))),r.push(l);n.add=n.add.length?n.materialize(n.ADD).add.concat(o):o}else a=r.slice(0,-s),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(a):a,r=r.slice(-s);return n.source=this.value=r,n}});const Cy={value:"value",median:C4,mean:The,min:jD,max:hd},Xge=[];function tI(e){Y.call(this,[],e)}tI.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function Qge(e){var t=e.method||Cy.value,n;if(Cy[t]==null)Z("Unrecognized imputation method: "+t);else return t===Cy.value?(n=e.value!==void 0?e.value:0,()=>n):Cy[t]}function Jge(e){const t=e.field;return n=>n?t(n):NaN}pe(tI,Y,{transform(e,t){var n=t.fork(t.ALL),i=Qge(e),r=Jge(e),s=yn(e.field),o=yn(e.key),a=(e.groupby||[]).map(yn),l=Zge(t.source,e.groupby,e.key,e.keyvals),u=[],c=this.value,d=l.domain.length,h,p,g,v,C,y,b,S,x,E;for(C=0,S=l.length;C<S;++C)for(h=l[C],g=h.values,p=NaN,b=0;b<d;++b)if(h[b]==null){for(v=l.domain[b],E={_impute:!0},y=0,x=g.length;y<x;++y)E[a[y]]=g[y];E[o]=v,E[s]=Number.isNaN(p)?p=i(h,r):p,u.push(Dt(E))}return u.length&&(n.add=n.materialize(n.ADD).add.concat(u)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=u,n}});function Zge(e,t,n,i){var r=y=>y(C),s=[],o=i?i.slice():[],a={},l={},u,c,d,h,p,g,v,C;for(o.forEach((y,b)=>a[y]=b+1),h=0,v=e.length;h<v;++h)C=e[h],g=n(C),p=a[g]||(a[g]=o.push(g)),c=(u=t?t.map(r):Xge)+"",(d=l[c])||(d=l[c]=[],s.push(d),d.values=u),d[p-1]=C;return s.domain=o,s}function nI(e){Uu.call(this,e)}nI.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:S0},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};pe(nI,Uu,{transform(e,t){const n=this,i=e.modified();let r;return n.value&&(i||t.modified(n._inputs,!0))?(r=n.value=i?n.init(e):{},t.visit(t.SOURCE,s=>n.add(s))):(r=n.value=n.value||this.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),n.changes(),t.visit(t.SOURCE,s=>{Ze(s,r[n.cellkey(s)].tuple)}),t.reflow(i).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,i;for(n=0,i=this._alen;n<i;++n)this.celltuple(e[n]),e[n]=null;for(n=0,i=this._mlen;n<i;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function iI(e){Y.call(this,null,e)}iI.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};pe(iI,Y,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=qM(i,e.groupby,e.field),s=(e.groupby||[]).map(yn),o=e.bandwidth,a=e.cumulative?"cdf":"pdf",l=e.as||["value","density"],u=[];let c=e.extent,d=e.steps||e.minsteps||25,h=e.steps||e.maxsteps||200;a!=="pdf"&&a!=="cdf"&&Z("Invalid density method: "+a),e.resolve==="shared"&&(c||(c=ma(i,e.field)),d=h=e.steps||h),r.forEach(p=>{const g=PM(p,o)[a],v=e.counts?p.length:1,C=c||ma(p);F1(g,C,d,h).forEach(y=>{const b={};for(let S=0;S<s.length;++S)b[s[S]]=p.dims[S];b[l[0]]=y[0],b[l[1]]=y[1]*v,u.push(Dt(b))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});function q8(e){zt.call(this,null,eme,e)}pe(q8,zt);function eme(e){return this.value&&!e.modified()?this.value:sM(e.fields,e.flat)}function K8(e){Y.call(this,[],e),this._pending=null}pe(K8,Y,{transform(e,t){const n=t.dataflow;return this._pending?wF(this,t,this._pending):tme(e)?t.StopPropagation:e.values?wF(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(r=>(this._pending=we(r.data),s=>s.touch(this)))}:n.request(e.url,e.format).then(i=>wF(this,t,we(i.data)))}});function tme(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function wF(e,t,n){n.forEach(Dt);const i=t.fork(t.NO_FIELDS&t.NO_SOURCE);return i.rem=e.value,e.value=i.source=i.add=n,e._pending=null,i.rem.length&&i.clean(!0),i}function rI(e){Y.call(this,{},e)}rI.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};pe(rI,Y,{transform(e,t){const n=e.fields,i=e.index,r=e.values,s=e.default==null?null:e.default,o=e.modified(),a=n.length;let l=o?t.SOURCE:t.ADD,u=t,c=e.as,d,h,p;return r?(h=r.length,a>1&&!c&&Z('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==a*h&&Z('The "as" parameter has too few output field names.'),c=c||r.map(yn),d=function(g){for(var v=0,C=0,y,b;v<a;++v)if(b=i.get(n[v](g)),b==null)for(y=0;y<h;++y,++C)g[c[C]]=s;else for(y=0;y<h;++y,++C)g[c[C]]=r[y](b)}):(c||Z("Missing output field names."),d=function(g){for(var v=0,C;v<a;++v)C=i.get(n[v](g)),g[c[v]]=C??s}),o?u=t.reflow(!0):(p=n.some(g=>t.modified(g.fields)),l|=p?t.MOD:0),t.visit(l,d),u.modifies(c)}});function Y8(e){zt.call(this,null,nme,e)}pe(Y8,zt);function nme(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let i=1/0,r=-1/0,s,o;for(s=0;s<n;++s)o=t[s],o[0]<i&&(i=o[0]),o[1]>r&&(r=o[1]);return[i,r]}function X8(e){zt.call(this,null,ime,e)}pe(X8,zt);function ime(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function Q8(e){Y.call(this,null,e)}pe(Q8,Y,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function sI(e){Uu.call(this,e)}sI.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:S0,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};pe(sI,Uu,{_transform:Uu.prototype.transform,transform(e,t){return this._transform(rme(e,t),t)}});function rme(e,t){const n=e.field,i=e.value,r=(e.op==="count"?"__count__":e.op)||"sum",s=Pi(n).concat(Pi(i)),o=ome(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:o.map(()=>r),fields:o.map(a=>sme(a,n,i,s)),as:o.map(a=>a+""),modified:e.modified.bind(e)}}function sme(e,t,n,i){return Ir(r=>t(r)===e?n(r):NaN,i,e+"")}function ome(e,t,n){const i={},r=[];return n.visit(n.SOURCE,s=>{const o=e(s);i[o]||(i[o]=1,r.push(o))}),r.sort(_p),t?r.slice(0,t):r}function J8(e){A1.call(this,e)}pe(J8,A1,{transform(e,t){const n=e.subflow,i=e.field,r=s=>this.subflow(_e(s),n,t,s);return(e.modified("field")||i&&t.modified(Pi(i)))&&Z("PreFacet does not support field modification."),this.initTargets(),i?(t.visit(t.MOD,s=>{const o=r(s);i(s).forEach(a=>o.mod(a))}),t.visit(t.ADD,s=>{const o=r(s);i(s).forEach(a=>o.add(Dt(a)))}),t.visit(t.REM,s=>{const o=r(s);i(s).forEach(a=>o.rem(a))})):(t.visit(t.MOD,s=>r(s).mod(s)),t.visit(t.ADD,s=>r(s).add(s)),t.visit(t.REM,s=>r(s).rem(s))),t.clean()&&t.runAfter(()=>this.clean()),t}});function oI(e){Y.call(this,null,e)}oI.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};pe(oI,Y,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=H8(e.fields,e.as||[]),s=i?(a,l)=>ame(a,l,i,r):y1;let o;return this.value?o=this.value:(t=t.addAll(),o=this.value={}),t.visit(t.REM,a=>{const l=_e(a);n.rem.push(o[l]),o[l]=null}),t.visit(t.ADD,a=>{const l=s(a,Dt({}));o[_e(a)]=l,n.add.push(l)}),t.visit(t.MOD,a=>{n.mod.push(s(a,o[_e(a)]))}),n}});function ame(e,t,n,i){for(let r=0,s=n.length;r<s;++r)t[i[r]]=n[r](e);return t}function Z8(e){Y.call(this,null,e)}pe(Z8,Y,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function aI(e){Y.call(this,null,e)}aI.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const lme=1e-14;pe(aI,Y,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const r=t.materialize(t.SOURCE).source,s=qM(r,e.groupby,e.field),o=(e.groupby||[]).map(yn),a=[],l=e.step||.01,u=e.probs||Sr(l/2,1-lme,l),c=u.length;return s.forEach(d=>{const h=RM(d,u);for(let p=0;p<c;++p){const g={};for(let v=0;v<o.length;++v)g[o[v]]=d.dims[v];g[i[0]]=u[p],g[i[1]]=h[p],a.push(Dt(g))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}});function eU(e){Y.call(this,null,e)}pe(eU,Y,{transform(e,t){let n,i;return this.value?i=this.value:(n=t=t.addAll(),i=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,r=>{const s=_e(r);n.rem.push(i[s]),i[s]=null}),t.visit(t.ADD,r=>{const s=bM(r);i[_e(r)]=s,n.add.push(s)}),t.visit(t.MOD,r=>{const s=i[_e(r)];for(const o in r)s[o]=r[o],n.modifies(o);n.mod.push(s)})),n}});function lI(e){Y.call(this,[],e),this.count=0}lI.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};pe(lI,Y,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.modified("size"),r=e.size,s=this.value.reduce((c,d)=>(c[_e(d)]=1,c),{});let o=this.value,a=this.count,l=0;function u(c){let d,h;o.length<r?o.push(c):(h=~~((a+1)*Os()),h<o.length&&h>=l&&(d=o[h],s[_e(d)]&&n.rem.push(d),o[h]=c)),++a}if(t.rem.length&&(t.visit(t.REM,c=>{const d=_e(c);s[d]&&(s[d]=-1,n.rem.push(c)),--a}),o=o.filter(c=>s[_e(c)]!==-1)),(t.rem.length||i)&&o.length<r&&t.source&&(l=a=o.length,t.visit(t.SOURCE,c=>{s[_e(c)]||u(c)}),l=-1),i&&o.length>r){const c=o.length-r;for(let d=0;d<c;++d)s[_e(o[d])]=-1,n.rem.push(o[d]);o=o.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{s[_e(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,u),(t.add.length||l<0)&&(n.add=o.filter(c=>!s[_e(c)])),this.count=a,this.value=n.source=o,n}});function uI(e){Y.call(this,null,e)}uI.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};pe(uI,Y,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),i=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=Sr(e.start,e.stop,e.step||1).map(r=>{const s={};return s[i]=r,Dt(s)}),n.add=t.add.concat(this.value),n}});function tU(e){Y.call(this,null,e),this.modified(!0)}pe(tU,Y,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function cI(e){Y.call(this,null,e)}const nU=["unit0","unit1"];cI.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:hM,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:nU}]};pe(cI,Y,{transform(e,t){const n=e.field,i=e.interval!==!1,r=e.timezone==="utc",s=this._floor(e,t),o=(r?Gp:Bp)(s.unit).offset,a=e.as||nU,l=a[0],u=a[1],c=s.step;let d=s.start||1/0,h=s.stop||-1/0,p=t.ADD;return(e.modified()||t.changed(t.REM)||t.modified(Pi(n)))&&(t=t.reflow(!0),p=t.SOURCE,d=1/0,h=-1/0),t.visit(p,g=>{const v=n(g);let C,y;v==null?(g[l]=null,i&&(g[u]=null)):(g[l]=C=y=s(v),i&&(g[u]=y=o(C,c)),C<d&&(d=C),y>h&&(h=y))}),s.start=d,s.stop=h,t.modifies(i?a:l)},_floor(e,t){const n=e.timezone==="utc",{units:i,step:r}=e.units?{units:e.units,step:e.step||1}:j4({extent:e.extent||ma(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),s=fM(i),o=this.value||{},a=(n?N4:L4)(s,r);return a.unit=gt(s),a.units=s,a.step=r,a.start=o.start,a.stop=o.stop,this.value=a}});function iU(e){Y.call(this,Op(),e)}pe(iU,Y,{transform(e,t){const n=t.dataflow,i=e.field,r=this.value,s=a=>r.set(i(a),a);let o=!0;return e.modified("field")||t.modified(i.fields)?(r.clear(),t.visit(t.SOURCE,s)):t.changed()?(t.visit(t.REM,a=>r.delete(i(a))),t.visit(t.ADD,s)):o=!1,this.modified(o),r.empty>n.cleanThreshold&&n.runAfter(r.clean),t.fork()}});function rU(e){Y.call(this,null,e)}pe(rU,Y,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(ih(e.sort)):t.source).map(e.field))}});function ume(e,t,n,i){const r=Rv[e](t,n);return{init:r.init||xu,update:function(s,o){o[i]=r.next(s)}}}const Rv={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?++e:e}}},percent_rank:function(){const e=Rv.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,i=t.compare;let r=t.index;if(e<r){for(;r+1<n.length&&!i(n[r],n[r+1]);)++r;e=r}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||Z("ntile num must be greater than zero.");const n=Rv.cume_dist(),i=n.next;return{init:n.init,next:r=>Math.ceil(t*i(r))}},lag:function(e,t){return t=+t||1,{next:n=>{const i=n.index-t;return i>=0?e(n.data[i]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const i=n.index+t,r=n.data;return i<r.length?e(r[i]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||Z("nth_value nth must be greater than zero."),{next:n=>{const i=n.i0+(t-1);return i<n.i1?e(n.data[i]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const i=e(n.data[n.index]);return i!=null?t=i:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:i=>{const r=i.data;return i.index<=n?t:(n=cme(e,r,i.index))<0?(n=r.length,t=null):t=e(r[n])}}}};function cme(e,t,n){for(let i=t.length;n<i;++n)if(e(t[n])!=null)return n;return-1}const dme=Object.keys(Rv);function sU(e){const t=we(e.ops),n=we(e.fields),i=we(e.params),r=we(e.aggregate_params),s=we(e.as),o=this.outputs=[],a=this.windows=[],l={},u={},c=[],d=[];let h=!0;function p(g){we(Pi(g)).forEach(v=>l[v]=1)}p(e.sort),t.forEach((g,v)=>{const C=n[v],y=i[v],b=r[v]||null,S=yn(C),x=_8(g,S,s[v]);if(p(C),o.push(x),Ee(Rv,g))a.push(ume(g,C,y,x));else{if(C==null&&g!=="count"&&Z("Null aggregate field specified."),g==="count"){c.push(x);return}h=!1;let E=u[S];E||(E=u[S]=[],E.field=C,d.push(E)),E.push(O8(g,b,x))}}),(c.length||d.length)&&(this.cell=hme(d,c,h)),this.inputs=Object.keys(l)}const oU=sU.prototype;oU.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()};oU.update=function(e,t){const n=this.cell,i=this.windows,r=e.data,s=i&&i.length;let o;if(n){for(o=e.p0;o<e.i0;++o)n.rem(r[o]);for(o=e.p1;o<e.i1;++o)n.add(r[o]);n.set(t)}for(o=0;o<s;++o)i[o].update(e,t)};function hme(e,t,n){e=e.map(l=>N8(l,l.field));const i={num:0,agg:null,store:!1,count:t};if(!n)for(var r=e.length,s=i.agg=Array(r),o=0;o<r;++o)s[o]=new e[o](i);if(i.store)var a=i.data=new zM;return i.add=function(l){if(i.num+=1,!n){a&&a.add(l);for(let u=0;u<r;++u)s[u].add(s[u].get(l),l)}},i.rem=function(l){if(i.num-=1,!n){a&&a.rem(l);for(let u=0;u<r;++u)s[u].rem(s[u].get(l),l)}},i.set=function(l){let u,c;for(a&&a.values(),u=0,c=t.length;u<c;++u)l[t[u]]=i.num;if(!n)for(u=0,c=s.length;u<c;++u)s[u].set(l)},i.init=function(){i.num=0,a&&a.reset();for(let l=0;l<r;++l)s[l].init()},i}function dI(e){Y.call(this,{},e),this._mlen=0,this._mods=[]}dI.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:dme.concat(S0)},{name:"params",type:"number",null:!0,array:!0},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};pe(dI,Y,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),i=ih(e.sort),r=iP(e.groupby),s=a=>this.group(r(a));let o=this.state;(!o||n)&&(o=this.state=new sU(e)),n||t.modified(o.inputs)?(this.value={},t.visit(t.SOURCE,a=>s(a).add(a))):(t.visit(t.REM,a=>s(a).remove(a)),t.visit(t.ADD,a=>s(a).add(a)));for(let a=0,l=this._mlen;a<l;++a)fme(this._mods[a],o,i,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(o.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=$8(_e),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function fme(e,t,n,i){const r=i.sort,s=r&&!i.ignorePeers,o=i.frame||[null,0],a=e.data(n),l=a.length,u=s?Lp(r):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:a,compare:r||Oi(-1)};t.init();for(let d=0;d<l;++d)pme(c,o,d,l),s&&gme(c,u),t.update(c,a[d])}function pme(e,t,n,i){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?i:Math.min(i,n+Math.abs(t[1])+1),e.index=n}function gme(e,t){const n=e.i0,i=e.i1-1,r=e.compare,s=e.data,o=s.length-1;n>0&&!r(s[n],s[n-1])&&(e.i0=t.left(s,s[n])),i<o&&!r(s[i],s[i+1])&&(e.i1=t.right(s,s[i]))}const mme=Object.freeze(Object.defineProperty({__proto__:null,aggregate:Uu,bin:HM,collect:VM,compare:B8,countpattern:WM,cross:UM,density:jM,dotbin:KM,expression:W8,extent:YM,facet:A1,field:U8,filter:QM,flatten:JM,fold:ZM,formula:eI,generate:j8,impute:tI,joinaggregate:nI,kde:iI,key:q8,load:K8,lookup:rI,multiextent:Y8,multivalues:X8,params:Q8,pivot:sI,prefacet:J8,project:oI,proxy:Z8,quantile:aI,relay:eU,sample:lI,sequence:uI,sieve:tU,subflow:XM,timeunit:cI,tupleindex:iU,values:rU,window:dI},Symbol.toStringTag,{value:"Module"}));function kt(e){return function(){return e}}const ZG=Math.abs,bi=Math.atan2,zc=Math.cos,vme=Math.max,bF=Math.min,Vo=Math.sin,ad=Math.sqrt,xi=1e-12,Uf=Math.PI,ob=Uf/2,aU=2*Uf;function Cme(e){return e>1?0:e<-1?Uf:Math.acos(e)}function e3(e){return e>=1?ob:e<=-1?-ob:Math.asin(e)}const rP=Math.PI,sP=2*rP,Jc=1e-6,yme=sP-Jc;function lU(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function wme(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return lU;const n=10**t;return function(i){this._+=i[0];for(let r=1,s=i.length;r<s;++r)this._+=Math.round(arguments[r]*n)/n+i[r]}}let hI=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?lU:wme(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,i,r){this._append`Q${+t},${+n},${this._x1=+i},${this._y1=+r}`}bezierCurveTo(t,n,i,r,s,o){this._append`C${+t},${+n},${+i},${+r},${this._x1=+s},${this._y1=+o}`}arcTo(t,n,i,r,s){if(t=+t,n=+n,i=+i,r=+r,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,a=this._y1,l=i-t,u=r-n,c=o-t,d=a-n,h=c*c+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(h>Jc)if(!(Math.abs(d*l-u*c)>Jc)||!s)this._append`L${this._x1=t},${this._y1=n}`;else{let p=i-o,g=r-a,v=l*l+u*u,C=p*p+g*g,y=Math.sqrt(v),b=Math.sqrt(h),S=s*Math.tan((rP-Math.acos((v+h-C)/(2*y*b)))/2),x=S/b,E=S/y;Math.abs(x-1)>Jc&&this._append`L${t+x*c},${n+x*d}`,this._append`A${s},${s},0,0,${+(d*p>c*g)},${this._x1=t+E*l},${this._y1=n+E*u}`}}arc(t,n,i,r,s,o){if(t=+t,n=+n,i=+i,o=!!o,i<0)throw new Error(`negative radius: ${i}`);let a=i*Math.cos(r),l=i*Math.sin(r),u=t+a,c=n+l,d=1^o,h=o?r-s:s-r;this._x1===null?this._append`M${u},${c}`:(Math.abs(this._x1-u)>Jc||Math.abs(this._y1-c)>Jc)&&this._append`L${u},${c}`,i&&(h<0&&(h=h%sP+sP),h>yme?this._append`A${i},${i},0,1,${d},${t-a},${n-l}A${i},${i},0,1,${d},${this._x1=u},${this._y1=c}`:h>Jc&&this._append`A${i},${i},0,${+(h>=rP)},${d},${this._x1=t+i*Math.cos(s)},${this._y1=n+i*Math.sin(s)}`)}rect(t,n,i,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${i=+i}v${+r}h${-i}Z`}toString(){return this._}};function D1(){return new hI}D1.prototype=hI.prototype;function P1(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const i=Math.floor(n);if(!(i>=0))throw new RangeError(`invalid digits: ${n}`);t=i}return e},()=>new hI(t)}function bme(e){return e.innerRadius}function Sme(e){return e.outerRadius}function xme(e){return e.startAngle}function Rme(e){return e.endAngle}function Eme(e){return e&&e.padAngle}function Fme(e,t,n,i,r,s,o,a){var l=n-e,u=i-t,c=o-r,d=a-s,h=d*l-c*u;if(!(h*h<xi))return h=(c*(t-s)-d*(e-r))/h,[e+h*l,t+h*u]}function yy(e,t,n,i,r,s,o){var a=e-n,l=t-i,u=(o?s:-s)/ad(a*a+l*l),c=u*l,d=-u*a,h=e+c,p=t+d,g=n+c,v=i+d,C=(h+g)/2,y=(p+v)/2,b=g-h,S=v-p,x=b*b+S*S,E=r-s,A=h*v-g*p,F=(S<0?-1:1)*ad(vme(0,E*E*x-A*A)),k=(A*S-b*F)/x,P=(-A*b-S*F)/x,_=(A*S+b*F)/x,O=(-A*b+S*F)/x,H=k-C,W=P-y,$=_-C,L=O-y;return H*H+W*W>$*$+L*L&&(k=_,P=O),{cx:k,cy:P,x01:-c,y01:-d,x11:k*(r/E-1),y11:P*(r/E-1)}}function Ame(){var e=bme,t=Sme,n=kt(0),i=null,r=xme,s=Rme,o=Eme,a=null,l=P1(u);function u(){var c,d,h=+e.apply(this,arguments),p=+t.apply(this,arguments),g=r.apply(this,arguments)-ob,v=s.apply(this,arguments)-ob,C=ZG(v-g),y=v>g;if(a||(a=c=l()),p<h&&(d=p,p=h,h=d),!(p>xi))a.moveTo(0,0);else if(C>aU-xi)a.moveTo(p*zc(g),p*Vo(g)),a.arc(0,0,p,g,v,!y),h>xi&&(a.moveTo(h*zc(v),h*Vo(v)),a.arc(0,0,h,v,g,y));else{var b=g,S=v,x=g,E=v,A=C,F=C,k=o.apply(this,arguments)/2,P=k>xi&&(i?+i.apply(this,arguments):ad(h*h+p*p)),_=bF(ZG(p-h)/2,+n.apply(this,arguments)),O=_,H=_,W,$;if(P>xi){var L=e3(P/h*Vo(k)),G=e3(P/p*Vo(k));(A-=L*2)>xi?(L*=y?1:-1,x+=L,E-=L):(A=0,x=E=(g+v)/2),(F-=G*2)>xi?(G*=y?1:-1,b+=G,S-=G):(F=0,b=S=(g+v)/2)}var j=p*zc(b),ee=p*Vo(b),q=h*zc(E),fe=h*Vo(E);if(_>xi){var Re=p*zc(S),Fe=p*Vo(S),ze=h*zc(x),Ft=h*Vo(x),$e;if(C<Uf)if($e=Fme(j,ee,ze,Ft,Re,Fe,q,fe)){var nn=j-$e[0],za=ee-$e[1],dr=Re-$e[0],xe=Fe-$e[1],Ye=1/Vo(Cme((nn*dr+za*xe)/(ad(nn*nn+za*za)*ad(dr*dr+xe*xe)))/2),Xe=ad($e[0]*$e[0]+$e[1]*$e[1]);O=bF(_,(h-Xe)/(Ye-1)),H=bF(_,(p-Xe)/(Ye+1))}else O=H=0}F>xi?H>xi?(W=yy(ze,Ft,j,ee,p,H,y),$=yy(Re,Fe,q,fe,p,H,y),a.moveTo(W.cx+W.x01,W.cy+W.y01),H<_?a.arc(W.cx,W.cy,H,bi(W.y01,W.x01),bi($.y01,$.x01),!y):(a.arc(W.cx,W.cy,H,bi(W.y01,W.x01),bi(W.y11,W.x11),!y),a.arc(0,0,p,bi(W.cy+W.y11,W.cx+W.x11),bi($.cy+$.y11,$.cx+$.x11),!y),a.arc($.cx,$.cy,H,bi($.y11,$.x11),bi($.y01,$.x01),!y))):(a.moveTo(j,ee),a.arc(0,0,p,b,S,!y)):a.moveTo(j,ee),!(h>xi)||!(A>xi)?a.lineTo(q,fe):O>xi?(W=yy(q,fe,Re,Fe,h,-O,y),$=yy(j,ee,ze,Ft,h,-O,y),a.lineTo(W.cx+W.x01,W.cy+W.y01),O<_?a.arc(W.cx,W.cy,O,bi(W.y01,W.x01),bi($.y01,$.x01),!y):(a.arc(W.cx,W.cy,O,bi(W.y01,W.x01),bi(W.y11,W.x11),!y),a.arc(0,0,h,bi(W.cy+W.y11,W.cx+W.x11),bi($.cy+$.y11,$.cx+$.x11),y),a.arc($.cx,$.cy,O,bi($.y11,$.x11),bi($.y01,$.x01),!y))):a.arc(0,0,h,E,x,y)}if(a.closePath(),c)return a=null,c+""||null}return u.centroid=function(){var c=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,d=(+r.apply(this,arguments)+ +s.apply(this,arguments))/2-Uf/2;return[zc(d)*c,Vo(d)*c]},u.innerRadius=function(c){return arguments.length?(e=typeof c=="function"?c:kt(+c),u):e},u.outerRadius=function(c){return arguments.length?(t=typeof c=="function"?c:kt(+c),u):t},u.cornerRadius=function(c){return arguments.length?(n=typeof c=="function"?c:kt(+c),u):n},u.padRadius=function(c){return arguments.length?(i=c==null?null:typeof c=="function"?c:kt(+c),u):i},u.startAngle=function(c){return arguments.length?(r=typeof c=="function"?c:kt(+c),u):r},u.endAngle=function(c){return arguments.length?(s=typeof c=="function"?c:kt(+c),u):s},u.padAngle=function(c){return arguments.length?(o=typeof c=="function"?c:kt(+c),u):o},u.context=function(c){return arguments.length?(a=c??null,u):a},u}function uU(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function cU(e){this._context=e}cU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function fI(e){return new cU(e)}function dU(e){return e[0]}function hU(e){return e[1]}function fU(e,t){var n=kt(!0),i=null,r=fI,s=null,o=P1(a);e=typeof e=="function"?e:e===void 0?dU:kt(e),t=typeof t=="function"?t:t===void 0?hU:kt(t);function a(l){var u,c=(l=uU(l)).length,d,h=!1,p;for(i==null&&(s=r(p=o())),u=0;u<=c;++u)!(u<c&&n(d=l[u],u,l))===h&&((h=!h)?s.lineStart():s.lineEnd()),h&&s.point(+e(d,u,l),+t(d,u,l));if(p)return s=null,p+""||null}return a.x=function(l){return arguments.length?(e=typeof l=="function"?l:kt(+l),a):e},a.y=function(l){return arguments.length?(t=typeof l=="function"?l:kt(+l),a):t},a.defined=function(l){return arguments.length?(n=typeof l=="function"?l:kt(!!l),a):n},a.curve=function(l){return arguments.length?(r=l,i!=null&&(s=r(i)),a):r},a.context=function(l){return arguments.length?(l==null?i=s=null:s=r(i=l),a):i},a}function pU(e,t,n){var i=null,r=kt(!0),s=null,o=fI,a=null,l=P1(u);e=typeof e=="function"?e:e===void 0?dU:kt(+e),t=typeof t=="function"?t:kt(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?hU:kt(+n);function u(d){var h,p,g,v=(d=uU(d)).length,C,y=!1,b,S=new Array(v),x=new Array(v);for(s==null&&(a=o(b=l())),h=0;h<=v;++h){if(!(h<v&&r(C=d[h],h,d))===y)if(y=!y)p=h,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),g=h-1;g>=p;--g)a.point(S[g],x[g]);a.lineEnd(),a.areaEnd()}y&&(S[h]=+e(C,h,d),x[h]=+t(C,h,d),a.point(i?+i(C,h,d):S[h],n?+n(C,h,d):x[h]))}if(b)return a=null,b+""||null}function c(){return fU().defined(r).curve(o).context(s)}return u.x=function(d){return arguments.length?(e=typeof d=="function"?d:kt(+d),i=null,u):e},u.x0=function(d){return arguments.length?(e=typeof d=="function"?d:kt(+d),u):e},u.x1=function(d){return arguments.length?(i=d==null?null:typeof d=="function"?d:kt(+d),u):i},u.y=function(d){return arguments.length?(t=typeof d=="function"?d:kt(+d),n=null,u):t},u.y0=function(d){return arguments.length?(t=typeof d=="function"?d:kt(+d),u):t},u.y1=function(d){return arguments.length?(n=d==null?null:typeof d=="function"?d:kt(+d),u):n},u.lineX0=u.lineY0=function(){return c().x(e).y(t)},u.lineY1=function(){return c().x(e).y(n)},u.lineX1=function(){return c().x(i).y(t)},u.defined=function(d){return arguments.length?(r=typeof d=="function"?d:kt(!!d),u):r},u.curve=function(d){return arguments.length?(o=d,s!=null&&(a=o(s)),u):o},u.context=function(d){return arguments.length?(d==null?s=a=null:a=o(s=d),u):s},u}const Dme={draw(e,t){const n=ad(t/Uf);e.moveTo(n,0),e.arc(0,0,n,0,aU)}};function Pme(e,t){let n=null,i=P1(r);e=typeof e=="function"?e:kt(e||Dme),t=typeof t=="function"?t:kt(t===void 0?64:+t);function r(){let s;if(n||(n=s=i()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),s)return n=null,s+""||null}return r.type=function(s){return arguments.length?(e=typeof s=="function"?s:kt(s),r):e},r.size=function(s){return arguments.length?(t=typeof s=="function"?s:kt(+s),r):t},r.context=function(s){return arguments.length?(n=s??null,r):n},r}function ju(){}function ab(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function k1(e){this._context=e}k1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:ab(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:ab(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function kme(e){return new k1(e)}function gU(e){this._context=e}gU.prototype={areaStart:ju,areaEnd:ju,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:ab(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Tme(e){return new gU(e)}function mU(e){this._context=e}mU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:ab(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Mme(e){return new mU(e)}function vU(e,t){this._basis=new k1(e),this._beta=t}vU.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var i=e[0],r=t[0],s=e[n]-i,o=t[n]-r,a=-1,l;++a<=n;)l=a/n,this._basis.point(this._beta*e[a]+(1-this._beta)*(i+l*s),this._beta*t[a]+(1-this._beta)*(r+l*o));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const Ime=function e(t){function n(i){return t===1?new k1(i):new vU(i,t)}return n.beta=function(i){return e(+i)},n}(.85);function lb(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function pI(e,t){this._context=e,this._k=(1-t)/6}pI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:lb(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:lb(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const _me=function e(t){function n(i){return new pI(i,t)}return n.tension=function(i){return e(+i)},n}(0);function gI(e,t){this._context=e,this._k=(1-t)/6}gI.prototype={areaStart:ju,areaEnd:ju,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:lb(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Ome=function e(t){function n(i){return new gI(i,t)}return n.tension=function(i){return e(+i)},n}(0);function mI(e,t){this._context=e,this._k=(1-t)/6}mI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:lb(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Lme=function e(t){function n(i){return new mI(i,t)}return n.tension=function(i){return e(+i)},n}(0);function vI(e,t,n){var i=e._x1,r=e._y1,s=e._x2,o=e._y2;if(e._l01_a>xi){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);i=(i*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,r=(r*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>xi){var u=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);s=(s*u+e._x1*e._l23_2a-t*e._l12_2a)/c,o=(o*u+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(i,r,s,o,e._x2,e._y2)}function CU(e,t){this._context=e,this._alpha=t}CU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:vI(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Nme=function e(t){function n(i){return t?new CU(i,t):new pI(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function yU(e,t){this._context=e,this._alpha=t}yU.prototype={areaStart:ju,areaEnd:ju,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:vI(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const $me=function e(t){function n(i){return t?new yU(i,t):new gI(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function wU(e,t){this._context=e,this._alpha=t}wU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:vI(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Bme=function e(t){function n(i){return t?new wU(i,t):new mI(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function bU(e){this._context=e}bU.prototype={areaStart:ju,areaEnd:ju,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Gme(e){return new bU(e)}function t3(e){return e<0?-1:1}function n3(e,t,n){var i=e._x1-e._x0,r=t-e._x1,s=(e._y1-e._y0)/(i||r<0&&-0),o=(n-e._y1)/(r||i<0&&-0),a=(s*r+o*i)/(i+r);return(t3(s)+t3(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(a))||0}function i3(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function SF(e,t,n){var i=e._x0,r=e._y0,s=e._x1,o=e._y1,a=(s-i)/3;e._context.bezierCurveTo(i+a,r+a*t,s-a,o-a*n,s,o)}function ub(e){this._context=e}ub.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:SF(this,this._t0,i3(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,SF(this,i3(this,n=n3(this,e,t)),n);break;default:SF(this,this._t0,n=n3(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function SU(e){this._context=new xU(e)}(SU.prototype=Object.create(ub.prototype)).point=function(e,t){ub.prototype.point.call(this,t,e)};function xU(e){this._context=e}xU.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,i,r,s){this._context.bezierCurveTo(t,e,i,n,s,r)}};function zme(e){return new ub(e)}function Hme(e){return new SU(e)}function RU(e){this._context=e}RU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var i=r3(e),r=r3(t),s=0,o=1;o<n;++s,++o)this._context.bezierCurveTo(i[0][s],r[0][s],i[1][s],r[1][s],e[o],t[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function r3(e){var t,n=e.length-1,i,r=new Array(n),s=new Array(n),o=new Array(n);for(r[0]=0,s[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)r[t]=1,s[t]=4,o[t]=4*e[t]+2*e[t+1];for(r[n-1]=2,s[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)i=r[t]/s[t-1],s[t]-=i,o[t]-=i*o[t-1];for(r[n-1]=o[n-1]/s[n-1],t=n-2;t>=0;--t)r[t]=(o[t]-r[t+1])/s[t];for(s[n-1]=(e[n]+r[n-1])/2,t=0;t<n-1;++t)s[t]=2*e[t+1]-r[t+1];return[r,s]}function Vme(e){return new RU(e)}function T1(e,t){this._context=e,this._t=t}T1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function Wme(e){return new T1(e,.5)}function Ume(e){return new T1(e,0)}function jme(e){return new T1(e,1)}function $u(e,t){if(typeof document<"u"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const qme=()=>typeof Image<"u"?Image:null;function Do(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function dc(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const oP=Symbol("implicit");function x0(){var e=new bG,t=[],n=[],i=oP;function r(s){let o=e.get(s);if(o===void 0){if(i!==oP)return i;e.set(s,o=t.push(s)-1)}return n[o%n.length]}return r.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new bG;for(const o of s)e.has(o)||e.set(o,t.push(o)-1);return r},r.range=function(s){return arguments.length?(n=Array.from(s),r):n.slice()},r.unknown=function(s){return arguments.length?(i=s,r):i},r.copy=function(){return x0(t,n).unknown(i)},Do.apply(r,arguments),r}function aP(){var e=x0().unknown(void 0),t=e.domain,n=e.range,i=0,r=1,s,o,a=!1,l=0,u=0,c=.5;delete e.unknown;function d(){var h=t().length,p=r<i,g=p?r:i,v=p?i:r;s=(v-g)/Math.max(1,h-l+u*2),a&&(s=Math.floor(s)),g+=(v-g-s*(h-l))*c,o=s*(1-l),a&&(g=Math.round(g),o=Math.round(o));var C=Sr(h).map(function(y){return g+s*y});return n(p?C.reverse():C)}return e.domain=function(h){return arguments.length?(t(h),d()):t()},e.range=function(h){return arguments.length?([i,r]=h,i=+i,r=+r,d()):[i,r]},e.rangeRound=function(h){return[i,r]=h,i=+i,r=+r,a=!0,d()},e.bandwidth=function(){return o},e.step=function(){return s},e.round=function(h){return arguments.length?(a=!!h,d()):a},e.padding=function(h){return arguments.length?(l=Math.min(1,u=+h),d()):l},e.paddingInner=function(h){return arguments.length?(l=Math.min(1,h),d()):l},e.paddingOuter=function(h){return arguments.length?(u=+h,d()):u},e.align=function(h){return arguments.length?(c=Math.max(0,Math.min(1,h)),d()):c},e.copy=function(){return aP(t(),[i,r]).round(a).paddingInner(l).paddingOuter(u).align(c)},Do.apply(d(),arguments)}function Hp(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function R0(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function hc(){}var kd=.7,jf=1/kd,bf="\\s*([+-]?\\d+)\\s*",Ev="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ua="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Kme=/^#([0-9a-f]{3,8})$/,Yme=new RegExp(`^rgb\\(${bf},${bf},${bf}\\)$`),Xme=new RegExp(`^rgb\\(${ua},${ua},${ua}\\)$`),Qme=new RegExp(`^rgba\\(${bf},${bf},${bf},${Ev}\\)$`),Jme=new RegExp(`^rgba\\(${ua},${ua},${ua},${Ev}\\)$`),Zme=new RegExp(`^hsl\\(${Ev},${ua},${ua}\\)$`),eve=new RegExp(`^hsla\\(${Ev},${ua},${ua},${Ev}\\)$`),s3={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Hp(hc,Fv,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:o3,formatHex:o3,formatHex8:tve,formatHsl:nve,formatRgb:a3,toString:a3});function o3(){return this.rgb().formatHex()}function tve(){return this.rgb().formatHex8()}function nve(){return EU(this).formatHsl()}function a3(){return this.rgb().formatRgb()}function Fv(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Kme.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?l3(t):n===3?new Kn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?wy(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?wy(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Yme.exec(e))?new Kn(t[1],t[2],t[3],1):(t=Xme.exec(e))?new Kn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Qme.exec(e))?wy(t[1],t[2],t[3],t[4]):(t=Jme.exec(e))?wy(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Zme.exec(e))?d3(t[1],t[2]/100,t[3]/100,1):(t=eve.exec(e))?d3(t[1],t[2]/100,t[3]/100,t[4]):s3.hasOwnProperty(e)?l3(s3[e]):e==="transparent"?new Kn(NaN,NaN,NaN,0):null}function l3(e){return new Kn(e>>16&255,e>>8&255,e&255,1)}function wy(e,t,n,i){return i<=0&&(e=t=n=NaN),new Kn(e,t,n,i)}function CI(e){return e instanceof hc||(e=Fv(e)),e?(e=e.rgb(),new Kn(e.r,e.g,e.b,e.opacity)):new Kn}function qu(e,t,n,i){return arguments.length===1?CI(e):new Kn(e,t,n,i??1)}function Kn(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}Hp(Kn,qu,R0(hc,{brighter(e){return e=e==null?jf:Math.pow(jf,e),new Kn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?kd:Math.pow(kd,e),new Kn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Kn(fd(this.r),fd(this.g),fd(this.b),cb(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:u3,formatHex:u3,formatHex8:ive,formatRgb:c3,toString:c3}));function u3(){return`#${ld(this.r)}${ld(this.g)}${ld(this.b)}`}function ive(){return`#${ld(this.r)}${ld(this.g)}${ld(this.b)}${ld((isNaN(this.opacity)?1:this.opacity)*255)}`}function c3(){const e=cb(this.opacity);return`${e===1?"rgb(":"rgba("}${fd(this.r)}, ${fd(this.g)}, ${fd(this.b)}${e===1?")":`, ${e})`}`}function cb(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function fd(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ld(e){return e=fd(e),(e<16?"0":"")+e.toString(16)}function d3(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new oo(e,t,n,i)}function EU(e){if(e instanceof oo)return new oo(e.h,e.s,e.l,e.opacity);if(e instanceof hc||(e=Fv(e)),!e)return new oo;if(e instanceof oo)return e;e=e.rgb();var t=e.r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),s=Math.max(t,n,i),o=NaN,a=s-r,l=(s+r)/2;return a?(t===s?o=(n-i)/a+(n<i)*6:n===s?o=(i-t)/a+2:o=(t-n)/a+4,a/=l<.5?s+r:2-s-r,o*=60):a=l>0&&l<1?0:o,new oo(o,a,l,e.opacity)}function db(e,t,n,i){return arguments.length===1?EU(e):new oo(e,t,n,i??1)}function oo(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}Hp(oo,db,R0(hc,{brighter(e){return e=e==null?jf:Math.pow(jf,e),new oo(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?kd:Math.pow(kd,e),new oo(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new Kn(xF(e>=240?e-240:e+120,r,i),xF(e,r,i),xF(e<120?e+240:e-120,r,i),this.opacity)},clamp(){return new oo(h3(this.h),by(this.s),by(this.l),cb(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=cb(this.opacity);return`${e===1?"hsl(":"hsla("}${h3(this.h)}, ${by(this.s)*100}%, ${by(this.l)*100}%${e===1?")":`, ${e})`}`}}));function h3(e){return e=(e||0)%360,e<0?e+360:e}function by(e){return Math.max(0,Math.min(1,e||0))}function xF(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const FU=Math.PI/180,AU=180/Math.PI,hb=18,DU=.96422,PU=1,kU=.82521,TU=4/29,Sf=6/29,MU=3*Sf*Sf,rve=Sf*Sf*Sf;function IU(e){if(e instanceof ca)return new ca(e.l,e.a,e.b,e.opacity);if(e instanceof hl)return _U(e);e instanceof Kn||(e=CI(e));var t=AF(e.r),n=AF(e.g),i=AF(e.b),r=RF((.2225045*t+.7168786*n+.0606169*i)/PU),s,o;return t===n&&n===i?s=o=r:(s=RF((.4360747*t+.3850649*n+.1430804*i)/DU),o=RF((.0139322*t+.0971045*n+.7141733*i)/kU)),new ca(116*r-16,500*(s-r),200*(r-o),e.opacity)}function fb(e,t,n,i){return arguments.length===1?IU(e):new ca(e,t,n,i??1)}function ca(e,t,n,i){this.l=+e,this.a=+t,this.b=+n,this.opacity=+i}Hp(ca,fb,R0(hc,{brighter(e){return new ca(this.l+hb*(e??1),this.a,this.b,this.opacity)},darker(e){return new ca(this.l-hb*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=DU*EF(t),e=PU*EF(e),n=kU*EF(n),new Kn(FF(3.1338561*t-1.6168667*e-.4906146*n),FF(-.9787684*t+1.9161415*e+.033454*n),FF(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function RF(e){return e>rve?Math.pow(e,1/3):e/MU+TU}function EF(e){return e>Sf?e*e*e:MU*(e-TU)}function FF(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function AF(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function sve(e){if(e instanceof hl)return new hl(e.h,e.c,e.l,e.opacity);if(e instanceof ca||(e=IU(e)),e.a===0&&e.b===0)return new hl(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*AU;return new hl(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function pb(e,t,n,i){return arguments.length===1?sve(e):new hl(e,t,n,i??1)}function hl(e,t,n,i){this.h=+e,this.c=+t,this.l=+n,this.opacity=+i}function _U(e){if(isNaN(e.h))return new ca(e.l,0,0,e.opacity);var t=e.h*FU;return new ca(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Hp(hl,pb,R0(hc,{brighter(e){return new hl(this.h,this.c,this.l+hb*(e??1),this.opacity)},darker(e){return new hl(this.h,this.c,this.l-hb*(e??1),this.opacity)},rgb(){return _U(this).rgb()}}));var OU=-.14861,yI=1.78277,wI=-.29227,M1=-.90649,Av=1.97294,f3=Av*M1,p3=Av*yI,g3=yI*wI-M1*OU;function ove(e){if(e instanceof pd)return new pd(e.h,e.s,e.l,e.opacity);e instanceof Kn||(e=CI(e));var t=e.r/255,n=e.g/255,i=e.b/255,r=(g3*i+f3*t-p3*n)/(g3+f3-p3),s=i-r,o=(Av*(n-r)-wI*s)/M1,a=Math.sqrt(o*o+s*s)/(Av*r*(1-r)),l=a?Math.atan2(o,s)*AU-120:NaN;return new pd(l<0?l+360:l,a,r,e.opacity)}function lP(e,t,n,i){return arguments.length===1?ove(e):new pd(e,t,n,i??1)}function pd(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}Hp(pd,lP,R0(hc,{brighter(e){return e=e==null?jf:Math.pow(jf,e),new pd(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?kd:Math.pow(kd,e),new pd(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*FU,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),i=Math.cos(e),r=Math.sin(e);return new Kn(255*(t+n*(OU*i+yI*r)),255*(t+n*(wI*i+M1*r)),255*(t+n*(Av*i)),this.opacity)}}));function LU(e,t,n,i,r){var s=e*e,o=s*e;return((1-3*e+3*s-o)*t+(4-6*s+3*o)*n+(1+3*e+3*s-3*o)*i+o*r)/6}function NU(e){var t=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[i],s=e[i+1],o=i>0?e[i-1]:2*r-s,a=i<t-1?e[i+2]:2*s-r;return LU((n-i/t)*t,o,r,s,a)}}function $U(e){var t=e.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*t),r=e[(i+t-1)%t],s=e[i%t],o=e[(i+1)%t],a=e[(i+2)%t];return LU((n-i/t)*t,r,s,o,a)}}const I1=e=>()=>e;function BU(e,t){return function(n){return e+n*t}}function ave(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}function _1(e,t){var n=t-e;return n?BU(e,n>180||n<-180?n-360*Math.round(n/360):n):I1(isNaN(e)?t:e)}function lve(e){return(e=+e)==1?Yn:function(t,n){return n-t?ave(t,n,e):I1(isNaN(t)?n:t)}}function Yn(e,t){var n=t-e;return n?BU(e,n):I1(isNaN(e)?t:e)}const uP=function e(t){var n=lve(t);function i(r,s){var o=n((r=qu(r)).r,(s=qu(s)).r),a=n(r.g,s.g),l=n(r.b,s.b),u=Yn(r.opacity,s.opacity);return function(c){return r.r=o(c),r.g=a(c),r.b=l(c),r.opacity=u(c),r+""}}return i.gamma=e,i}(1);function GU(e){return function(t){var n=t.length,i=new Array(n),r=new Array(n),s=new Array(n),o,a;for(o=0;o<n;++o)a=qu(t[o]),i[o]=a.r||0,r[o]=a.g||0,s[o]=a.b||0;return i=e(i),r=e(r),s=e(s),a.opacity=1,function(l){return a.r=i(l),a.g=r(l),a.b=s(l),a+""}}}var zU=GU(NU),uve=GU($U);function bI(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,i=t.slice(),r;return function(s){for(r=0;r<n;++r)i[r]=e[r]*(1-s)+t[r]*s;return i}}function HU(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function cve(e,t){return(HU(t)?bI:VU)(e,t)}function VU(e,t){var n=t?t.length:0,i=e?Math.min(n,e.length):0,r=new Array(i),s=new Array(n),o;for(o=0;o<i;++o)r[o]=fc(e[o],t[o]);for(;o<n;++o)s[o]=t[o];return function(a){for(o=0;o<i;++o)s[o]=r[o](a);return s}}function WU(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}function io(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function UU(e,t){var n={},i={},r;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in e?n[r]=fc(e[r],t[r]):i[r]=t[r];return function(s){for(r in n)i[r]=n[r](s);return i}}var cP=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,DF=new RegExp(cP.source,"g");function dve(e){return function(){return e}}function hve(e){return function(t){return e(t)+""}}function jU(e,t){var n=cP.lastIndex=DF.lastIndex=0,i,r,s,o=-1,a=[],l=[];for(e=e+"",t=t+"";(i=cP.exec(e))&&(r=DF.exec(t));)(s=r.index)>n&&(s=t.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(i=i[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,l.push({i:o,x:io(i,r)})),n=DF.lastIndex;return n<t.length&&(s=t.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?l[0]?hve(l[0].x):dve(t):(t=l.length,function(u){for(var c=0,d;c<t;++c)a[(d=l[c]).i]=d.x(u);return a.join("")})}function fc(e,t){var n=typeof t,i;return t==null||n==="boolean"?I1(t):(n==="number"?io:n==="string"?(i=Fv(t))?(t=i,uP):jU:t instanceof Fv?uP:t instanceof Date?WU:HU(t)?bI:Array.isArray(t)?VU:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?UU:io)(e,t)}function fve(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function pve(e,t){var n=_1(+e,+t);return function(i){var r=n(i);return r-360*Math.floor(r/360)}}function E0(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var m3=180/Math.PI,dP={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function qU(e,t,n,i,r,s){var o,a,l;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(l=e*n+t*i)&&(n-=e*l,i-=t*l),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,l/=a),e*i<t*n&&(e=-e,t=-t,l=-l,o=-o),{translateX:r,translateY:s,rotate:Math.atan2(t,e)*m3,skewX:Math.atan(l)*m3,scaleX:o,scaleY:a}}var Sy;function gve(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?dP:qU(t.a,t.b,t.c,t.d,t.e,t.f)}function mve(e){return e==null||(Sy||(Sy=document.createElementNS("http://www.w3.org/2000/svg","g")),Sy.setAttribute("transform",e),!(e=Sy.transform.baseVal.consolidate()))?dP:(e=e.matrix,qU(e.a,e.b,e.c,e.d,e.e,e.f))}function KU(e,t,n,i){function r(u){return u.length?u.pop()+" ":""}function s(u,c,d,h,p,g){if(u!==d||c!==h){var v=p.push("translate(",null,t,null,n);g.push({i:v-4,x:io(u,d)},{i:v-2,x:io(c,h)})}else(d||h)&&p.push("translate("+d+t+h+n)}function o(u,c,d,h){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),h.push({i:d.push(r(d)+"rotate(",null,i)-2,x:io(u,c)})):c&&d.push(r(d)+"rotate("+c+i)}function a(u,c,d,h){u!==c?h.push({i:d.push(r(d)+"skewX(",null,i)-2,x:io(u,c)}):c&&d.push(r(d)+"skewX("+c+i)}function l(u,c,d,h,p,g){if(u!==d||c!==h){var v=p.push(r(p)+"scale(",null,",",null,")");g.push({i:v-4,x:io(u,d)},{i:v-2,x:io(c,h)})}else(d!==1||h!==1)&&p.push(r(p)+"scale("+d+","+h+")")}return function(u,c){var d=[],h=[];return u=e(u),c=e(c),s(u.translateX,u.translateY,c.translateX,c.translateY,d,h),o(u.rotate,c.rotate,d,h),a(u.skewX,c.skewX,d,h),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,d,h),u=c=null,function(p){for(var g=-1,v=h.length,C;++g<v;)d[(C=h[g]).i]=C.x(p);return d.join("")}}}var vve=KU(gve,"px, ","px)","deg)"),Cve=KU(mve,", ",")",")"),yve=1e-12;function v3(e){return((e=Math.exp(e))+1/e)/2}function wve(e){return((e=Math.exp(e))-1/e)/2}function bve(e){return((e=Math.exp(2*e))-1)/(e+1)}const Sve=function e(t,n,i){function r(s,o){var a=s[0],l=s[1],u=s[2],c=o[0],d=o[1],h=o[2],p=c-a,g=d-l,v=p*p+g*g,C,y;if(v<yve)y=Math.log(h/u)/t,C=function(F){return[a+F*p,l+F*g,u*Math.exp(t*F*y)]};else{var b=Math.sqrt(v),S=(h*h-u*u+i*v)/(2*u*n*b),x=(h*h-u*u-i*v)/(2*h*n*b),E=Math.log(Math.sqrt(S*S+1)-S),A=Math.log(Math.sqrt(x*x+1)-x);y=(A-E)/t,C=function(F){var k=F*y,P=v3(E),_=u/(n*b)*(P*bve(t*k+E)-wve(E));return[a+_*p,l+_*g,u*P/v3(t*k+E)]}}return C.duration=y*1e3*t/Math.SQRT2,C}return r.rho=function(s){var o=Math.max(.001,+s),a=o*o,l=a*a;return e(o,a,l)},r}(Math.SQRT2,2,4);function YU(e){return function(t,n){var i=e((t=db(t)).h,(n=db(n)).h),r=Yn(t.s,n.s),s=Yn(t.l,n.l),o=Yn(t.opacity,n.opacity);return function(a){return t.h=i(a),t.s=r(a),t.l=s(a),t.opacity=o(a),t+""}}}const xve=YU(_1);var Rve=YU(Yn);function Eve(e,t){var n=Yn((e=fb(e)).l,(t=fb(t)).l),i=Yn(e.a,t.a),r=Yn(e.b,t.b),s=Yn(e.opacity,t.opacity);return function(o){return e.l=n(o),e.a=i(o),e.b=r(o),e.opacity=s(o),e+""}}function XU(e){return function(t,n){var i=e((t=pb(t)).h,(n=pb(n)).h),r=Yn(t.c,n.c),s=Yn(t.l,n.l),o=Yn(t.opacity,n.opacity);return function(a){return t.h=i(a),t.c=r(a),t.l=s(a),t.opacity=o(a),t+""}}}const Fve=XU(_1);var Ave=XU(Yn);function QU(e){return function t(n){n=+n;function i(r,s){var o=e((r=lP(r)).h,(s=lP(s)).h),a=Yn(r.s,s.s),l=Yn(r.l,s.l),u=Yn(r.opacity,s.opacity);return function(c){return r.h=o(c),r.s=a(c),r.l=l(Math.pow(c,n)),r.opacity=u(c),r+""}}return i.gamma=t,i}(1)}const Dve=QU(_1);var Pve=QU(Yn);function SI(e,t){t===void 0&&(t=e,e=fc);for(var n=0,i=t.length-1,r=t[0],s=new Array(i<0?0:i);n<i;)s[n]=e(r,r=t[++n]);return function(o){var a=Math.max(0,Math.min(i-1,Math.floor(o*=i)));return s[a](o-a)}}function kve(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e(i/(t-1));return n}const Tve=Object.freeze(Object.defineProperty({__proto__:null,interpolate:fc,interpolateArray:cve,interpolateBasis:NU,interpolateBasisClosed:$U,interpolateCubehelix:Dve,interpolateCubehelixLong:Pve,interpolateDate:WU,interpolateDiscrete:fve,interpolateHcl:Fve,interpolateHclLong:Ave,interpolateHsl:xve,interpolateHslLong:Rve,interpolateHue:pve,interpolateLab:Eve,interpolateNumber:io,interpolateNumberArray:bI,interpolateObject:UU,interpolateRgb:uP,interpolateRgbBasis:zU,interpolateRgbBasisClosed:uve,interpolateRound:E0,interpolateString:jU,interpolateTransformCss:vve,interpolateTransformSvg:Cve,interpolateZoom:Sve,piecewise:SI,quantize:kve},Symbol.toStringTag,{value:"Module"}));function Mve(e){return function(){return e}}function hP(e){return+e}var C3=[0,1];function xr(e){return e}function fP(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Mve(isNaN(t)?NaN:.5)}function Ive(e,t){var n;return e>t&&(n=e,e=t,t=n),function(i){return Math.max(e,Math.min(t,i))}}function _ve(e,t,n){var i=e[0],r=e[1],s=t[0],o=t[1];return r<i?(i=fP(r,i),s=n(o,s)):(i=fP(i,r),s=n(s,o)),function(a){return s(i(a))}}function Ove(e,t,n){var i=Math.min(e.length,t.length)-1,r=new Array(i),s=new Array(i),o=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<i;)r[o]=fP(e[o],e[o+1]),s[o]=n(t[o],t[o+1]);return function(a){var l=Vu(e,a,1,i)-1;return s[l](r[l](a))}}function F0(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function O1(){var e=C3,t=C3,n=fc,i,r,s,o=xr,a,l,u;function c(){var h=Math.min(e.length,t.length);return o!==xr&&(o=Ive(e[0],e[h-1])),a=h>2?Ove:_ve,l=u=null,d}function d(h){return h==null||isNaN(h=+h)?s:(l||(l=a(e.map(i),t,n)))(i(o(h)))}return d.invert=function(h){return o(r((u||(u=a(t,e.map(i),io)))(h)))},d.domain=function(h){return arguments.length?(e=Array.from(h,hP),c()):e.slice()},d.range=function(h){return arguments.length?(t=Array.from(h),c()):t.slice()},d.rangeRound=function(h){return t=Array.from(h),n=E0,c()},d.clamp=function(h){return arguments.length?(o=h?!0:xr,c()):o!==xr},d.interpolate=function(h){return arguments.length?(n=h,c()):n},d.unknown=function(h){return arguments.length?(s=h,d):s},function(h,p){return i=h,r=p,c()}}function JU(){return O1()(xr,xr)}function ZU(e,t,n,i){var r=Wu(e,t,n),s;switch(i=Pd(i??",f"),i.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return i.precision==null&&!isNaN(s=R4(r,o))&&(i.precision=s),cM(i,o)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(s=E4(r,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=s-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(s=x4(r))&&(i.precision=s-(i.type==="%")*2);break}}return c1(i)}function rh(e){var t=e.domain;return e.ticks=function(n){var i=t();return WD(i[0],i[i.length-1],n??10)},e.tickFormat=function(n,i){var r=t();return ZU(r[0],r[r.length-1],n??10,i)},e.nice=function(n){n==null&&(n=10);var i=t(),r=0,s=i.length-1,o=i[r],a=i[s],l,u,c=10;for(a<o&&(u=o,o=a,a=u,u=r,r=s,s=u);c-- >0;){if(u=UD(o,a,n),u===l)return i[r]=o,i[s]=a,t(i);if(u>0)o=Math.floor(o/u)*u,a=Math.ceil(a/u)*u;else if(u<0)o=Math.ceil(o*u)/u,a=Math.floor(a*u)/u;else break;l=u}return e},e}function uf(){var e=JU();return e.copy=function(){return F0(e,uf())},Do.apply(e,arguments),rh(e)}function e9(e){var t;function n(i){return i==null||isNaN(i=+i)?t:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(e=Array.from(i,hP),n):e.slice()},n.unknown=function(i){return arguments.length?(t=i,n):t},n.copy=function(){return e9(e).unknown(t)},e=arguments.length?Array.from(e,hP):[0,1],rh(n)}function t9(e,t){e=e.slice();var n=0,i=e.length-1,r=e[n],s=e[i],o;return s<r&&(o=n,n=i,i=o,o=r,r=s,s=o),e[n]=t.floor(r),e[i]=t.ceil(s),e}function y3(e){return Math.log(e)}function w3(e){return Math.exp(e)}function Lve(e){return-Math.log(-e)}function Nve(e){return-Math.exp(-e)}function $ve(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Bve(e){return e===10?$ve:e===Math.E?Math.exp:t=>Math.pow(e,t)}function Gve(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function b3(e){return(t,n)=>-e(-t,n)}function xI(e){const t=e(y3,w3),n=t.domain;let i=10,r,s;function o(){return r=Gve(i),s=Bve(i),n()[0]<0?(r=b3(r),s=b3(s),e(Lve,Nve)):e(y3,w3),t}return t.base=function(a){return arguments.length?(i=+a,o()):i},t.domain=function(a){return arguments.length?(n(a),o()):n()},t.ticks=a=>{const l=n();let u=l[0],c=l[l.length-1];const d=c<u;d&&([u,c]=[c,u]);let h=r(u),p=r(c),g,v;const C=a==null?10:+a;let y=[];if(!(i%1)&&p-h<C){if(h=Math.floor(h),p=Math.ceil(p),u>0){for(;h<=p;++h)for(g=1;g<i;++g)if(v=h<0?g/s(-h):g*s(h),!(v<u)){if(v>c)break;y.push(v)}}else for(;h<=p;++h)for(g=i-1;g>=1;--g)if(v=h>0?g/s(-h):g*s(h),!(v<u)){if(v>c)break;y.push(v)}y.length*2<C&&(y=WD(u,c,C))}else y=WD(h,p,Math.min(p-h,C)).map(s);return d?y.reverse():y},t.tickFormat=(a,l)=>{if(a==null&&(a=10),l==null&&(l=i===10?"s":","),typeof l!="function"&&(!(i%1)&&(l=Pd(l)).precision==null&&(l.trim=!0),l=c1(l)),a===1/0)return l;const u=Math.max(1,i*a/t.ticks().length);return c=>{let d=c/s(Math.round(r(c)));return d*i<i-.5&&(d*=i),d<=u?l(c):""}},t.nice=()=>n(t9(n(),{floor:a=>s(Math.floor(r(a))),ceil:a=>s(Math.ceil(r(a)))})),t}function n9(){const e=xI(O1()).domain([1,10]);return e.copy=()=>F0(e,n9()).base(e.base()),Do.apply(e,arguments),e}function S3(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function x3(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function RI(e){var t=1,n=e(S3(t),x3(t));return n.constant=function(i){return arguments.length?e(S3(t=+i),x3(t)):t},rh(n)}function i9(){var e=RI(O1());return e.copy=function(){return F0(e,i9()).constant(e.constant())},Do.apply(e,arguments)}function R3(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function zve(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Hve(e){return e<0?-e*e:e*e}function EI(e){var t=e(xr,xr),n=1;function i(){return n===1?e(xr,xr):n===.5?e(zve,Hve):e(R3(n),R3(1/n))}return t.exponent=function(r){return arguments.length?(n=+r,i()):n},rh(t)}function FI(){var e=EI(O1());return e.copy=function(){return F0(e,FI()).exponent(e.exponent())},Do.apply(e,arguments),e}function Vve(){return FI.apply(null,arguments).exponent(.5)}function r9(){var e=[],t=[],n=[],i;function r(){var o=0,a=Math.max(1,t.length);for(n=new Array(a-1);++o<a;)n[o-1]=v4(e,o/a);return s}function s(o){return o==null||isNaN(o=+o)?i:t[Vu(n,o)]}return s.invertExtent=function(o){var a=t.indexOf(o);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},s.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let a of o)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(ml),r()},s.range=function(o){return arguments.length?(t=Array.from(o),r()):t.slice()},s.unknown=function(o){return arguments.length?(i=o,s):i},s.quantiles=function(){return n.slice()},s.copy=function(){return r9().domain(e).range(t).unknown(i)},Do.apply(s,arguments)}function s9(){var e=0,t=1,n=1,i=[.5],r=[0,1],s;function o(l){return l!=null&&l<=l?r[Vu(i,l,0,n)]:s}function a(){var l=-1;for(i=new Array(n);++l<n;)i[l]=((l+1)*t-(l-n)*e)/(n+1);return o}return o.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,a()):[e,t]},o.range=function(l){return arguments.length?(n=(r=Array.from(l)).length-1,a()):r.slice()},o.invertExtent=function(l){var u=r.indexOf(l);return u<0?[NaN,NaN]:u<1?[e,i[0]]:u>=n?[i[n-1],t]:[i[u-1],i[u]]},o.unknown=function(l){return arguments.length&&(s=l),o},o.thresholds=function(){return i.slice()},o.copy=function(){return s9().domain([e,t]).range(r).unknown(s)},Do.apply(rh(o),arguments)}function o9(){var e=[.5],t=[0,1],n,i=1;function r(s){return s!=null&&s<=s?t[Vu(e,s,0,i)]:n}return r.domain=function(s){return arguments.length?(e=Array.from(s),i=Math.min(e.length,t.length-1),r):e.slice()},r.range=function(s){return arguments.length?(t=Array.from(s),i=Math.min(e.length,t.length-1),r):t.slice()},r.invertExtent=function(s){var o=t.indexOf(s);return[e[o-1],e[o]]},r.unknown=function(s){return arguments.length?(n=s,r):n},r.copy=function(){return o9().domain(e).range(t).unknown(n)},Do.apply(r,arguments)}function Wve(e){return new Date(e)}function Uve(e){return e instanceof Date?+e:+new Date(+e)}function AI(e,t,n,i,r,s,o,a,l,u){var c=JU(),d=c.invert,h=c.domain,p=u(".%L"),g=u(":%S"),v=u("%I:%M"),C=u("%I %p"),y=u("%a %d"),b=u("%b %d"),S=u("%B"),x=u("%Y");function E(A){return(l(A)<A?p:a(A)<A?g:o(A)<A?v:s(A)<A?C:i(A)<A?r(A)<A?y:b:n(A)<A?S:x)(A)}return c.invert=function(A){return new Date(d(A))},c.domain=function(A){return arguments.length?h(Array.from(A,Uve)):h().map(Wve)},c.ticks=function(A){var F=h();return e(F[0],F[F.length-1],A??10)},c.tickFormat=function(A,F){return F==null?E:u(F)},c.nice=function(A){var F=h();return(!A||typeof A.range!="function")&&(A=t(F[0],F[F.length-1],A??10)),A?h(t9(F,A)):c},c.copy=function(){return F0(c,AI(e,t,n,i,r,s,o,a,l,u))},c}function jve(){return Do.apply(AI(Zhe,efe,va,wv,Np,vl,f1,d1,dl,gM).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function qve(){return Do.apply(AI(Qhe,Jhe,Ca,bv,$p,Lu,p1,h1,dl,mM).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function L1(){var e=0,t=1,n,i,r,s,o=xr,a=!1,l;function u(d){return d==null||isNaN(d=+d)?l:o(r===0?.5:(d=(s(d)-n)*r,a?Math.max(0,Math.min(1,d)):d))}u.domain=function(d){return arguments.length?([e,t]=d,n=s(e=+e),i=s(t=+t),r=n===i?0:1/(i-n),u):[e,t]},u.clamp=function(d){return arguments.length?(a=!!d,u):a},u.interpolator=function(d){return arguments.length?(o=d,u):o};function c(d){return function(h){var p,g;return arguments.length?([p,g]=h,o=d(p,g),u):[o(0),o(1)]}}return u.range=c(fc),u.rangeRound=c(E0),u.unknown=function(d){return arguments.length?(l=d,u):l},function(d){return s=d,n=d(e),i=d(t),r=n===i?0:1/(i-n),u}}function pc(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function N1(){var e=rh(L1()(xr));return e.copy=function(){return pc(e,N1())},dc.apply(e,arguments)}function a9(){var e=xI(L1()).domain([1,10]);return e.copy=function(){return pc(e,a9()).base(e.base())},dc.apply(e,arguments)}function l9(){var e=RI(L1());return e.copy=function(){return pc(e,l9()).constant(e.constant())},dc.apply(e,arguments)}function DI(){var e=EI(L1());return e.copy=function(){return pc(e,DI()).exponent(e.exponent())},dc.apply(e,arguments)}function Kve(){return DI.apply(null,arguments).exponent(.5)}function $1(){var e=0,t=.5,n=1,i=1,r,s,o,a,l,u=xr,c,d=!1,h;function p(v){return isNaN(v=+v)?h:(v=.5+((v=+c(v))-s)*(i*v<i*s?a:l),u(d?Math.max(0,Math.min(1,v)):v))}p.domain=function(v){return arguments.length?([e,t,n]=v,r=c(e=+e),s=c(t=+t),o=c(n=+n),a=r===s?0:.5/(s-r),l=s===o?0:.5/(o-s),i=s<r?-1:1,p):[e,t,n]},p.clamp=function(v){return arguments.length?(d=!!v,p):d},p.interpolator=function(v){return arguments.length?(u=v,p):u};function g(v){return function(C){var y,b,S;return arguments.length?([y,b,S]=C,u=SI(v,[y,b,S]),p):[u(0),u(.5),u(1)]}}return p.range=g(fc),p.rangeRound=g(E0),p.unknown=function(v){return arguments.length?(h=v,p):h},function(v){return c=v,r=v(e),s=v(t),o=v(n),a=r===s?0:.5/(s-r),l=s===o?0:.5/(o-s),i=s<r?-1:1,p}}function u9(){var e=rh($1()(xr));return e.copy=function(){return pc(e,u9())},dc.apply(e,arguments)}function c9(){var e=xI($1()).domain([.1,1,10]);return e.copy=function(){return pc(e,c9()).base(e.base())},dc.apply(e,arguments)}function d9(){var e=RI($1());return e.copy=function(){return pc(e,d9()).constant(e.constant())},dc.apply(e,arguments)}function PI(){var e=EI($1());return e.copy=function(){return pc(e,PI()).exponent(e.exponent())},dc.apply(e,arguments)}function Yve(){return PI.apply(null,arguments).exponent(.5)}function Po(e){for(var t=e.length/6|0,n=new Array(t),i=0;i<t;)n[i]="#"+e.slice(i*6,++i*6);return n}const Xve=Po("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Qve=Po("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),Jve=Po("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),Zve=Po("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),e0e=Po("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),t0e=Po("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),n0e=Po("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),i0e=Po("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),r0e=Po("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),h9=Po("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),s0e=e=>zU(e[e.length-1]);var o0e=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Po);const a0e=s0e(o0e);function kI(e,t,n){const i=e-t+n*2;return e?i>0?i:1:0}const l0e="identity",qf="linear",Pl="log",A0="pow",D0="sqrt",B1="symlog",Td="time",Md="utc",da="sequential",Vp="diverging",Kf="quantile",G1="quantize",z1="threshold",TI="ordinal",pP="point",f9="band",MI="bin-ordinal",Wn="continuous",P0="discrete",k0="discretizing",Gs="interpolating",II="temporal";function u0e(e){return function(t){let n=t[0],i=t[1],r;return i<n&&(r=n,n=i,i=r),[e.invert(n),e.invert(i)]}}function c0e(e){return function(t){const n=e.range();let i=t[0],r=t[1],s=-1,o,a,l,u;for(r<i&&(a=i,i=r,r=a),l=0,u=n.length;l<u;++l)n[l]>=i&&n[l]<=r&&(s<0&&(s=l),o=l);if(!(s<0))return i=e.invertExtent(n[s]),r=e.invertExtent(n[o]),[i[0]===void 0?i[1]:i[0],r[1]===void 0?r[0]:r[1]]}}function _I(){const e=x0().unknown(void 0),t=e.domain,n=e.range;let i=[0,1],r,s,o=!1,a=0,l=0,u=.5;delete e.unknown;function c(){const d=t().length,h=i[1]<i[0],p=i[1-h],g=kI(d,a,l);let v=i[h-0];r=(p-v)/(g||1),o&&(r=Math.floor(r)),v+=(p-v-r*(d-a))*u,s=r*(1-a),o&&(v=Math.round(v),s=Math.round(s));const C=Sr(d).map(y=>v+r*y);return n(h?C.reverse():C)}return e.domain=function(d){return arguments.length?(t(d),c()):t()},e.range=function(d){return arguments.length?(i=[+d[0],+d[1]],c()):i.slice()},e.rangeRound=function(d){return i=[+d[0],+d[1]],o=!0,c()},e.bandwidth=function(){return s},e.step=function(){return r},e.round=function(d){return arguments.length?(o=!!d,c()):o},e.padding=function(d){return arguments.length?(l=Math.max(0,Math.min(1,d)),a=l,c()):a},e.paddingInner=function(d){return arguments.length?(a=Math.max(0,Math.min(1,d)),c()):a},e.paddingOuter=function(d){return arguments.length?(l=Math.max(0,Math.min(1,d)),c()):l},e.align=function(d){return arguments.length?(u=Math.max(0,Math.min(1,d)),c()):u},e.invertRange=function(d){if(d[0]==null||d[1]==null)return;const h=i[1]<i[0],p=h?n().reverse():n(),g=p.length-1;let v=+d[0],C=+d[1],y,b,S;if(!(v!==v||C!==C)&&(C<v&&(S=v,v=C,C=S),!(C<p[0]||v>i[1-h])))return y=Math.max(0,Vu(p,v)-1),b=v===C?y:Vu(p,C)-1,v-p[y]>s+1e-10&&++y,h&&(S=y,y=g-b,b=g-S),y>b?void 0:t().slice(y,b+1)},e.invert=function(d){const h=e.invertRange([d,d]);return h&&h[0]},e.copy=function(){return _I().domain(t()).range(i).round(o).paddingInner(a).paddingOuter(l).align(u)},c()}function p9(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return p9(t())},e}function d0e(){return p9(_I().paddingInner(1))}var h0e=Array.prototype.map;function f0e(e){return h0e.call(e,Ai)}const p0e=Array.prototype.slice;function g9(){let e=[],t=[];function n(i){return i==null||i!==i?void 0:t[(Vu(e,i)-1)%t.length]}return n.domain=function(i){return arguments.length?(e=f0e(i),n):e.slice()},n.range=function(i){return arguments.length?(t=p0e.call(i),n):t.slice()},n.tickFormat=function(i,r){return ZU(e[0],gt(e),i??10,r)},n.copy=function(){return g9().domain(n.domain()).range(n.range())},n}const gb=new Map,m9=Symbol("vega_scale");function v9(e){return e[m9]=!0,e}function g0e(e){return e&&e[m9]===!0}function m0e(e,t,n){const i=function(){const s=t();return s.invertRange||(s.invertRange=s.invert?u0e(s):s.invertExtent?c0e(s):void 0),s.type=e,v9(s)};return i.metadata=Co(we(n)),i}function Et(e,t,n){return arguments.length>1?(gb.set(e,m0e(e,t,n)),this):C9(e)?gb.get(e):void 0}Et(l0e,e9);Et(qf,uf,Wn);Et(Pl,n9,[Wn,Pl]);Et(A0,FI,Wn);Et(D0,Vve,Wn);Et(B1,i9,Wn);Et(Td,jve,[Wn,II]);Et(Md,qve,[Wn,II]);Et(da,N1,[Wn,Gs]);Et(`${da}-${qf}`,N1,[Wn,Gs]);Et(`${da}-${Pl}`,a9,[Wn,Gs,Pl]);Et(`${da}-${A0}`,DI,[Wn,Gs]);Et(`${da}-${D0}`,Kve,[Wn,Gs]);Et(`${da}-${B1}`,l9,[Wn,Gs]);Et(`${Vp}-${qf}`,u9,[Wn,Gs]);Et(`${Vp}-${Pl}`,c9,[Wn,Gs,Pl]);Et(`${Vp}-${A0}`,PI,[Wn,Gs]);Et(`${Vp}-${D0}`,Yve,[Wn,Gs]);Et(`${Vp}-${B1}`,d9,[Wn,Gs]);Et(Kf,r9,[k0,Kf]);Et(G1,s9,k0);Et(z1,o9,k0);Et(MI,g9,[P0,k0]);Et(TI,x0,P0);Et(f9,_I,P0);Et(pP,d0e,P0);function C9(e){return gb.has(e)}function sh(e,t){const n=gb.get(e);return n&&n.metadata[t]}function OI(e){return sh(e,Wn)}function Yf(e){return sh(e,P0)}function gP(e){return sh(e,k0)}function y9(e){return sh(e,Pl)}function v0e(e){return sh(e,II)}function w9(e){return sh(e,Gs)}function b9(e){return sh(e,Kf)}const C0e=["clamp","base","constant","exponent"];function S9(e,t){const n=t[0],i=gt(t)-n;return function(r){return e(n+r*i)}}function H1(e,t,n){return SI(LI(t||"rgb",n),e)}function x9(e,t){const n=new Array(t),i=t+1;for(let r=0;r<t;)n[r]=e(++r/i);return n}function R9(e,t,n){const i=n-t;let r,s,o;return!i||!Number.isFinite(i)?Oi(.5):(r=(s=e.type).indexOf("-"),s=r<0?s:s.slice(r+1),o=Et(s)().domain([t,n]).range([0,1]),C0e.forEach(a=>e[a]?o[a](e[a]()):0),o)}function LI(e,t){const n=Tve[y0e(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function y0e(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const w0e={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},b0e={accent:Qve,category10:Xve,category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",dark2:Jve,observable10:Zve,paired:e0e,pastel1:t0e,pastel2:n0e,set1:i0e,set2:r0e,set3:h9,tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5"};function E9(e){if(te(e))return e;const t=e.length/6|0,n=new Array(t);for(let i=0;i<t;)n[i]="#"+e.slice(i*6,++i*6);return n}function F9(e,t){for(const n in e)NI(n,t(e[n]))}const E3={};F9(b0e,E9);F9(w0e,e=>H1(E9(e)));function NI(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(E3[e]=t,this):E3[e]}const yw="symbol",S0e="discrete",x0e="gradient",R0e=e=>te(e)?e.map(t=>String(t)):String(e),E0e=(e,t)=>e[1]-t[1],F0e=(e,t)=>t[1]-e[1];function $I(e,t,n){let i;return xt(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(y0(e.domain())/n||1)+1))),ye(t)&&(i=t.step,t=t.interval),be(t)&&(t=e.type===Td?Bp(t):e.type==Md?Gp(t):Z("Only time and utc scales accept interval strings."),i&&(t=t.every(i))),t}function A9(e,t,n){let i=e.range(),r=i[0],s=gt(i),o=E0e;if(r>s&&(i=s,s=r,r=i,o=F0e),r=Math.floor(r),s=Math.ceil(s),t=t.map(a=>[a,e(a)]).filter(a=>r<=a[1]&&a[1]<=s).sort(o).map(a=>a[0]),n>0&&t.length>1){const a=[t[0],gt(t)];for(;t.length>n&&t.length>=3;)t=t.filter((l,u)=>!(u%2));t.length<3&&(t=a)}return t}function BI(e,t){return e.bins?A9(e,e.bins,t):e.ticks?e.ticks(t):e.domain()}function D9(e,t,n,i,r,s){const o=t.type;let a=R0e;if(o===Td||r===Td)a=e.timeFormat(i);else if(o===Md||r===Md)a=e.utcFormat(i);else if(y9(o)){const l=e.formatFloat(i);if(s||t.bins)a=l;else{const u=P9(t,n,!1);a=c=>u(c)?l(c):""}}else if(t.tickFormat){const l=t.domain();a=e.formatSpan(l[0],l[l.length-1],n,i)}else i&&(a=e.format(i));return a}function P9(e,t,n){const i=BI(e,t),r=e.base(),s=Math.log(r),o=Math.max(1,r*t/i.length),a=l=>{let u=l/Math.pow(r,Math.round(Math.log(l)/s));return u*r<r-.5&&(u*=r),u<=o};return n?i.filter(a):a}const mP={[Kf]:"quantiles",[G1]:"thresholds",[z1]:"domain"},k9={[Kf]:"quantiles",[G1]:"domain"};function T9(e,t){return e.bins?P0e(e.bins):e.type===Pl?P9(e,t,!0):mP[e.type]?D0e(e[mP[e.type]]()):BI(e,t)}function A0e(e,t,n){const i=t[k9[t.type]](),r=i.length;let s=r>1?i[1]-i[0]:i[0],o;for(o=1;o<r;++o)s=Math.min(s,i[o]-i[o-1]);return e.formatSpan(0,s,3*10,n)}function D0e(e){const t=[-1/0].concat(e);return t.max=1/0,t}function P0e(e){const t=e.slice(0,-1);return t.max=gt(e),t}const k0e=e=>mP[e.type]||e.bins;function M9(e,t,n,i,r,s,o){const a=k9[t.type]&&s!==Td&&s!==Md?A0e(e,t,r):D9(e,t,n,r,s,o);return i===yw&&k0e(t)?T0e(a):i===S0e?M0e(a):I0e(a)}const T0e=e=>(t,n,i)=>{const r=F3(i[n+1],F3(i.max,1/0)),s=A3(t,e),o=A3(r,e);return s&&o?s+" – "+o:o?"< "+o:"≥ "+s},F3=(e,t)=>e??t,M0e=e=>(t,n)=>n?e(t):null,I0e=e=>t=>e(t),A3=(e,t)=>Number.isFinite(e)?t(e):null;function _0e(e){const t=e.domain(),n=t.length-1;let i=+t[0],r=+gt(t),s=r-i;if(e.type===z1){const o=n?s/n:.1;i-=o,r+=o,s=r-i}return o=>(o-i)/s}function O0e(e,t,n,i){const r=i||t.type;return be(n)&&v0e(r)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&r===Td?e.timeFormat("%A, %d %B %Y, %X"):!n&&r===Md?e.utcFormat("%A, %d %B %Y, %X UTC"):M9(e,t,5,null,n,i,!0)}function I9(e,t,n){n=n||{};const i=Math.max(3,n.maxlen||7),r=O0e(e,t,n.format,n.formatType);if(gP(t.type)){const s=T9(t).slice(1).map(r),o=s.length;return`${o} boundar${o===1?"y":"ies"}: ${s.join(", ")}`}else if(Yf(t.type)){const s=t.domain(),o=s.length,a=o>i?s.slice(0,i-2).map(r).join(", ")+", ending with "+s.slice(-1).map(r):s.map(r).join(", ");return`${o} value${o===1?"":"s"}: ${a}`}else{const s=t.domain();return`values from ${r(s[0])} to ${r(gt(s))}`}}let _9=0;function L0e(){_9=0}const mb="p_";function GI(e){return e&&e.gradient}function O9(e,t,n){const i=e.gradient;let r=e.id,s=i==="radial"?mb:"";return r||(r=e.id="gradient_"+_9++,i==="radial"?(e.x1=Wo(e.x1,.5),e.y1=Wo(e.y1,.5),e.r1=Wo(e.r1,0),e.x2=Wo(e.x2,.5),e.y2=Wo(e.y2,.5),e.r2=Wo(e.r2,.5),s=mb):(e.x1=Wo(e.x1,0),e.y1=Wo(e.y1,0),e.x2=Wo(e.x2,1),e.y2=Wo(e.y2,0))),t[r]=e,"url("+(n||"")+"#"+s+r+")"}function Wo(e,t){return e??t}function L9(e,t){var n=[],i;return i={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(r,s){return n.push({offset:r,color:s}),i}}}const D3={basis:{curve:kme},"basis-closed":{curve:Tme},"basis-open":{curve:Mme},bundle:{curve:Ime,tension:"beta",value:.85},cardinal:{curve:_me,tension:"tension",value:0},"cardinal-open":{curve:Lme,tension:"tension",value:0},"cardinal-closed":{curve:Ome,tension:"tension",value:0},"catmull-rom":{curve:Nme,tension:"alpha",value:.5},"catmull-rom-closed":{curve:$me,tension:"alpha",value:.5},"catmull-rom-open":{curve:Bme,tension:"alpha",value:.5},linear:{curve:fI},"linear-closed":{curve:Gme},monotone:{horizontal:Hme,vertical:zme},natural:{curve:Vme},step:{curve:Wme},"step-after":{curve:jme},"step-before":{curve:Ume}};function zI(e,t,n){var i=Ee(D3,e)&&D3[e],r=null;return i&&(r=i.curve||i[t||"vertical"],i.tension&&n!=null&&(r=r[i.tension](n))),r}const N0e={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},$0e=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,B0e=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,G0e=/^((\s+,?\s*)|(,\s*))/,z0e=/^[01]/;function Xf(e){const t=[];return(e.match($0e)||[]).forEach(i=>{let r=i[0];const s=r.toLowerCase(),o=N0e[s],a=H0e(s,o,i.slice(1).trim()),l=a.length;if(l<o||l&&l%o!==0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([r,...a.slice(0,o)]),l!==o){s==="m"&&(r=r==="M"?"L":"l");for(let u=o;u<l;u+=o)t.push([r,...a.slice(u,u+o)])}}),t}function H0e(e,t,n){const i=[];for(let r=0;t&&r<n.length;)for(let s=0;s<t;++s){const o=e==="a"&&(s===3||s===4)?z0e:B0e,a=n.slice(r).match(o);if(a===null)throw Error("Invalid SVG path, incorrect parameter type");r+=a[0].length,i.push(+a[0]);const l=n.slice(r).match(G0e);l!==null&&(r+=l[0].length)}return i}const Ku=Math.PI/180,V0e=1e-14,id=Math.PI/2,na=Math.PI*2,Vh=Math.sqrt(3)/2;var PF={},kF={},N9=[].join;function W0e(e,t,n,i,r,s,o,a,l){const u=N9.call(arguments);if(PF[u])return PF[u];const c=o*Ku,d=Math.sin(c),h=Math.cos(c);n=Math.abs(n),i=Math.abs(i);const p=h*(a-e)*.5+d*(l-t)*.5,g=h*(l-t)*.5-d*(a-e)*.5;let v=p*p/(n*n)+g*g/(i*i);v>1&&(v=Math.sqrt(v),n*=v,i*=v);const C=h/n,y=d/n,b=-d/i,S=h/i,x=C*a+y*l,E=b*a+S*l,A=C*e+y*t,F=b*e+S*t;let P=1/((A-x)*(A-x)+(F-E)*(F-E))-.25;P<0&&(P=0);let _=Math.sqrt(P);s==r&&(_=-_);const O=.5*(x+A)-_*(F-E),H=.5*(E+F)+_*(A-x),W=Math.atan2(E-H,x-O);let L=Math.atan2(F-H,A-O)-W;L<0&&s===1?L+=na:L>0&&s===0&&(L-=na);const G=Math.ceil(Math.abs(L/(id+.001))),j=[];for(let ee=0;ee<G;++ee){const q=W+ee*L/G,fe=W+(ee+1)*L/G;j[ee]=[O,H,q,fe,n,i,d,h]}return PF[u]=j}function U0e(e){const t=N9.call(e);if(kF[t])return kF[t];var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7];const c=u*o,d=-l*a,h=l*o,p=u*a,g=Math.cos(r),v=Math.sin(r),C=Math.cos(s),y=Math.sin(s),b=.5*(s-r),S=Math.sin(b*.5),x=8/3*S*S/Math.sin(b),E=n+g-x*v,A=i+v+x*g,F=n+C,k=i+y,P=F+x*y,_=k-x*C;return kF[t]=[c*E+d*A,h*E+p*A,c*P+d*_,h*P+p*_,c*F+d*k,h*F+p*k]}const fs=["l",0,0,0,0,0,0,0];function j0e(e,t,n){const i=fs[0]=e[0];if(i==="a"||i==="A")fs[1]=t*e[1],fs[2]=n*e[2],fs[3]=e[3],fs[4]=e[4],fs[5]=e[5],fs[6]=t*e[6],fs[7]=n*e[7];else if(i==="h"||i==="H")fs[1]=t*e[1];else if(i==="v"||i==="V")fs[1]=n*e[1];else for(var r=1,s=e.length;r<s;++r)fs[r]=(r%2==1?t:n)*e[r];return fs}function Dv(e,t,n,i,r,s){var o,a=null,l=0,u=0,c=0,d=0,h,p,g,v,C=0,y=0;n==null&&(n=0),i==null&&(i=0),r==null&&(r=1),s==null&&(s=r),e.beginPath&&e.beginPath();for(var b=0,S=t.length;b<S;++b){switch(o=t[b],(r!==1||s!==1)&&(o=j0e(o,r,s)),o[0]){case"l":l+=o[1],u+=o[2],e.lineTo(l+n,u+i);break;case"L":l=o[1],u=o[2],e.lineTo(l+n,u+i);break;case"h":l+=o[1],e.lineTo(l+n,u+i);break;case"H":l=o[1],e.lineTo(l+n,u+i);break;case"v":u+=o[1],e.lineTo(l+n,u+i);break;case"V":u=o[1],e.lineTo(l+n,u+i);break;case"m":l+=o[1],u+=o[2],C=l,y=u,e.moveTo(l+n,u+i);break;case"M":l=o[1],u=o[2],C=l,y=u,e.moveTo(l+n,u+i);break;case"c":h=l+o[5],p=u+o[6],c=l+o[3],d=u+o[4],e.bezierCurveTo(l+o[1]+n,u+o[2]+i,c+n,d+i,h+n,p+i),l=h,u=p;break;case"C":l=o[5],u=o[6],c=o[3],d=o[4],e.bezierCurveTo(o[1]+n,o[2]+i,c+n,d+i,l+n,u+i);break;case"s":h=l+o[3],p=u+o[4],c=2*l-c,d=2*u-d,e.bezierCurveTo(c+n,d+i,l+o[1]+n,u+o[2]+i,h+n,p+i),c=l+o[1],d=u+o[2],l=h,u=p;break;case"S":h=o[3],p=o[4],c=2*l-c,d=2*u-d,e.bezierCurveTo(c+n,d+i,o[1]+n,o[2]+i,h+n,p+i),l=h,u=p,c=o[1],d=o[2];break;case"q":h=l+o[3],p=u+o[4],c=l+o[1],d=u+o[2],e.quadraticCurveTo(c+n,d+i,h+n,p+i),l=h,u=p;break;case"Q":h=o[3],p=o[4],e.quadraticCurveTo(o[1]+n,o[2]+i,h+n,p+i),l=h,u=p,c=o[1],d=o[2];break;case"t":h=l+o[1],p=u+o[2],a[0].match(/[QqTt]/)===null?(c=l,d=u):a[0]==="t"?(c=2*l-g,d=2*u-v):a[0]==="q"&&(c=2*l-c,d=2*u-d),g=c,v=d,e.quadraticCurveTo(c+n,d+i,h+n,p+i),l=h,u=p,c=l+o[1],d=u+o[2];break;case"T":h=o[1],p=o[2],c=2*l-c,d=2*u-d,e.quadraticCurveTo(c+n,d+i,h+n,p+i),l=h,u=p;break;case"a":P3(e,l+n,u+i,[o[1],o[2],o[3],o[4],o[5],o[6]+l+n,o[7]+u+i]),l+=o[6],u+=o[7];break;case"A":P3(e,l+n,u+i,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+i]),l=o[6],u=o[7];break;case"z":case"Z":l=C,u=y,e.closePath();break}a=o}}function P3(e,t,n,i){const r=W0e(i[5],i[6],i[0],i[1],i[3],i[4],i[2],t,n);for(let s=0;s<r.length;++s){const o=U0e(r[s]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}const k3=.5773502691896257,T3={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,na)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/2.5;e.moveTo(-n,-i),e.lineTo(-n,i),e.lineTo(-i,i),e.lineTo(-i,n),e.lineTo(i,n),e.lineTo(i,i),e.lineTo(n,i),e.lineTo(n,-i),e.lineTo(i,-i),e.lineTo(i,-n),e.lineTo(-i,-n),e.lineTo(-i,-i),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),i=-n/2;e.rect(i,i,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/7,r=n/2.5,s=n/8;e.moveTo(-i,n),e.lineTo(i,n),e.lineTo(i,-s),e.lineTo(r,-s),e.lineTo(0,-n),e.lineTo(-r,-s),e.lineTo(-i,-s),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,i=Vh*n,r=i-n*k3,s=n/4;e.moveTo(0,-i-r),e.lineTo(-s,i-r),e.lineTo(s,i-r),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,i=Vh*n,r=i-n*k3;e.moveTo(0,-i-r),e.lineTo(-n,i-r),e.lineTo(n,i-r),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Vh*n;e.moveTo(0,-i),e.lineTo(-n,i),e.lineTo(n,i),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Vh*n;e.moveTo(0,i),e.lineTo(-n,-i),e.lineTo(n,-i),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Vh*n;e.moveTo(i,0),e.lineTo(-i,-n),e.lineTo(-i,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Vh*n;e.moveTo(-i,0),e.lineTo(i,-n),e.lineTo(i,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function $9(e){return Ee(T3,e)?T3[e]:q0e(e)}var TF={};function q0e(e){if(!Ee(TF,e)){const t=Xf(e);TF[e]={draw:function(n,i){Dv(n,t,0,0,Math.sqrt(i)/2)}}}return TF[e]}const cu=.448084975506;function K0e(e){return e.x}function Y0e(e){return e.y}function X0e(e){return e.width}function Q0e(e){return e.height}function Qa(e){return typeof e=="function"?e:()=>+e}function xy(e,t,n){return Math.max(t,Math.min(e,n))}function B9(){var e=K0e,t=Y0e,n=X0e,i=Q0e,r=Qa(0),s=r,o=r,a=r,l=null;function u(c,d,h){var p,g=d??+e.call(this,c),v=h??+t.call(this,c),C=+n.call(this,c),y=+i.call(this,c),b=Math.min(C,y)/2,S=xy(+r.call(this,c),0,b),x=xy(+s.call(this,c),0,b),E=xy(+o.call(this,c),0,b),A=xy(+a.call(this,c),0,b);if(l||(l=p=D1()),S<=0&&x<=0&&E<=0&&A<=0)l.rect(g,v,C,y);else{var F=g+C,k=v+y;l.moveTo(g+S,v),l.lineTo(F-x,v),l.bezierCurveTo(F-cu*x,v,F,v+cu*x,F,v+x),l.lineTo(F,k-A),l.bezierCurveTo(F,k-cu*A,F-cu*A,k,F-A,k),l.lineTo(g+E,k),l.bezierCurveTo(g+cu*E,k,g,k-cu*E,g,k-E),l.lineTo(g,v+S),l.bezierCurveTo(g,v+cu*S,g+cu*S,v,g+S,v),l.closePath()}if(p)return l=null,p+""||null}return u.x=function(c){return arguments.length?(e=Qa(c),u):e},u.y=function(c){return arguments.length?(t=Qa(c),u):t},u.width=function(c){return arguments.length?(n=Qa(c),u):n},u.height=function(c){return arguments.length?(i=Qa(c),u):i},u.cornerRadius=function(c,d,h,p){return arguments.length?(r=Qa(c),s=d!=null?Qa(d):r,a=h!=null?Qa(h):r,o=p!=null?Qa(p):s,u):r},u.context=function(c){return arguments.length?(l=c??null,u):l},u}function G9(){var e,t,n,i,r=null,s,o,a,l;function u(d,h,p){const g=p/2;if(s){var v=a-h,C=d-o;if(v||C){var y=Math.hypot(v,C),b=(v/=y)*l,S=(C/=y)*l,x=Math.atan2(C,v);r.moveTo(o-b,a-S),r.lineTo(d-v*g,h-C*g),r.arc(d,h,g,x-Math.PI,x),r.lineTo(o+b,a+S),r.arc(o,a,l,x,x+Math.PI)}else r.arc(d,h,g,0,na);r.closePath()}else s=1;o=d,a=h,l=g}function c(d){var h,p=d.length,g,v=!1,C;for(r==null&&(r=C=D1()),h=0;h<=p;++h)!(h<p&&i(g=d[h],h,d))===v&&(v=!v)&&(s=0),v&&u(+e(g,h,d),+t(g,h,d),+n(g,h,d));if(C)return r=null,C+""||null}return c.x=function(d){return arguments.length?(e=d,c):e},c.y=function(d){return arguments.length?(t=d,c):t},c.size=function(d){return arguments.length?(n=d,c):n},c.defined=function(d){return arguments.length?(i=d,c):i},c.context=function(d){return arguments.length?(d==null?r=null:r=d,c):r},c}function T0(e,t){return e??t}const M0=e=>e.x||0,I0=e=>e.y||0,J0e=e=>e.width||0,Z0e=e=>e.height||0,eCe=e=>(e.x||0)+(e.width||0),tCe=e=>(e.y||0)+(e.height||0),nCe=e=>e.startAngle||0,iCe=e=>e.endAngle||0,rCe=e=>e.padAngle||0,sCe=e=>e.innerRadius||0,oCe=e=>e.outerRadius||0,aCe=e=>e.cornerRadius||0,lCe=e=>T0(e.cornerRadiusTopLeft,e.cornerRadius)||0,uCe=e=>T0(e.cornerRadiusTopRight,e.cornerRadius)||0,cCe=e=>T0(e.cornerRadiusBottomRight,e.cornerRadius)||0,dCe=e=>T0(e.cornerRadiusBottomLeft,e.cornerRadius)||0,hCe=e=>T0(e.size,64),fCe=e=>e.size||1,V1=e=>e.defined!==!1,pCe=e=>$9(e.shape||"circle"),gCe=Ame().startAngle(nCe).endAngle(iCe).padAngle(rCe).innerRadius(sCe).outerRadius(oCe).cornerRadius(aCe),mCe=pU().x(M0).y1(I0).y0(tCe).defined(V1),vCe=pU().y(I0).x1(M0).x0(eCe).defined(V1),CCe=fU().x(M0).y(I0).defined(V1),yCe=B9().x(M0).y(I0).width(J0e).height(Z0e).cornerRadius(lCe,uCe,cCe,dCe),wCe=Pme().type(pCe).size(hCe),bCe=G9().x(M0).y(I0).defined(V1).size(fCe);function HI(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function SCe(e,t){return gCe.context(e)(t)}function xCe(e,t){const n=t[0],i=n.interpolate||"linear";return(n.orient==="horizontal"?vCe:mCe).curve(zI(i,n.orient,n.tension)).context(e)(t)}function RCe(e,t){const n=t[0],i=n.interpolate||"linear";return CCe.curve(zI(i,n.orient,n.tension)).context(e)(t)}function Wp(e,t,n,i){return yCe.context(e)(t,n,i)}function ECe(e,t){return(t.mark.shape||t.shape).context(e)(t)}function FCe(e,t){return wCe.context(e)(t)}function ACe(e,t){return bCe.context(e)(t)}var z9=1;function H9(){z9=1}function VI(e,t,n){var i=t.clip,r=e._defs,s=t.clip_id||(t.clip_id="clip"+z9++),o=r.clipping[s]||(r.clipping[s]={id:s});return nt(i)?o.path=i(null):HI(n)?o.path=Wp(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+s+")"}function Mn(e){this.clear(),e&&this.union(e)}Mn.prototype={clone(){return new Mn(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,i){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),i<t?(this.y2=t,this.y1=i):(this.y1=t,this.y2=i),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const i=this.rotatedPoints(e,t,n);return this.clear().add(i[0],i[1]).add(i[2],i[3]).add(i[4],i[5]).add(i[6],i[7])},rotatedPoints(e,t,n){var{x1:i,y1:r,x2:s,y2:o}=this,a=Math.cos(e),l=Math.sin(e),u=t-t*a+n*l,c=n-t*l-n*a;return[a*i-l*r+u,l*i+a*r+c,a*i-l*o+u,l*i+a*o+c,a*s-l*r+u,l*s+a*r+c,a*s-l*o+u,l*s+a*o+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function W1(e){this.mark=e,this.bounds=this.bounds||new Mn}function U1(e){W1.call(this,e),this.items=this.items||[]}pe(U1,W1);class V9{constructor(t){this._pending=0,this._loader=t||m1()}pending(){return this._pending}sanitizeURL(t){const n=this;return M3(n),n._loader.sanitize(t,{context:"href"}).then(i=>(Kg(n),i)).catch(()=>(Kg(n),null))}loadImage(t){const n=this,i=qme();return M3(n),n._loader.sanitize(t,{context:"image"}).then(r=>{const s=r.href;if(!s||!i)throw{url:s};const o=new i,a=Ee(r,"crossOrigin")?r.crossOrigin:"anonymous";return a!=null&&(o.crossOrigin=a),o.onload=()=>Kg(n),o.onerror=()=>Kg(n),o.src=s,o}).catch(r=>(Kg(n),{complete:!1,width:0,height:0,src:r&&r.url||""}))}ready(){const t=this;return new Promise(n=>{function i(r){t.pending()?setTimeout(()=>{i(!0)},10):n(r)}i(!1)})}}function M3(e){e._pending+=1}function Kg(e){e._pending-=1}function Vl(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const i=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(i+(n?DCe(t,i):0))}return e}function DCe(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const PCe=na-1e-8;let j1,ww,bw,ud,vP,Sw,CP,yP;const Eu=(e,t)=>j1.add(e,t),xw=(e,t)=>Eu(ww=e,bw=t),I3=e=>Eu(e,j1.y1),_3=e=>Eu(j1.x1,e),rd=(e,t)=>vP*e+CP*t,sd=(e,t)=>Sw*e+yP*t,MF=(e,t)=>Eu(rd(e,t),sd(e,t)),IF=(e,t)=>xw(rd(e,t),sd(e,t));function _0(e,t){return j1=e,t?(ud=t*Ku,vP=yP=Math.cos(ud),Sw=Math.sin(ud),CP=-Sw):(vP=yP=1,ud=Sw=CP=0),kCe}const kCe={beginPath(){},closePath(){},moveTo:IF,lineTo:IF,rect(e,t,n,i){ud?(MF(e+n,t),MF(e+n,t+i),MF(e,t+i),IF(e,t)):(Eu(e+n,t+i),xw(e,t))},quadraticCurveTo(e,t,n,i){const r=rd(e,t),s=sd(e,t),o=rd(n,i),a=sd(n,i);O3(ww,r,o,I3),O3(bw,s,a,_3),xw(o,a)},bezierCurveTo(e,t,n,i,r,s){const o=rd(e,t),a=sd(e,t),l=rd(n,i),u=sd(n,i),c=rd(r,s),d=sd(r,s);L3(ww,o,l,c,I3),L3(bw,a,u,d,_3),xw(c,d)},arc(e,t,n,i,r,s){if(i+=ud,r+=ud,ww=n*Math.cos(r)+e,bw=n*Math.sin(r)+t,Math.abs(r-i)>PCe)Eu(e-n,t-n),Eu(e+n,t+n);else{const o=u=>Eu(n*Math.cos(u)+e,n*Math.sin(u)+t);let a,l;if(o(i),o(r),r!==i)if(i=i%na,i<0&&(i+=na),r=r%na,r<0&&(r+=na),r<i&&(s=!s,a=i,i=r,r=a),s)for(r-=na,a=i-i%id,l=0;l<4&&a>r;++l,a-=id)o(a);else for(a=i-i%id+id,l=0;l<4&&a<r;++l,a=a+id)o(a)}}};function O3(e,t,n,i){const r=(e-t)/(e+n-2*t);0<r&&r<1&&i(e+(t-e)*r)}function L3(e,t,n,i,r){const s=i-e+3*t-3*n,o=e+n-2*t,a=e-t;let l=0,u=0,c;Math.abs(s)>V0e?(c=o*o+a*s,c>=0&&(c=Math.sqrt(c),l=(-o+c)/s,u=(-o-c)/s)):l=.5*a/o,0<l&&l<1&&r(N3(l,e,t,n,i)),0<u&&u<1&&r(N3(u,e,t,n,i))}function N3(e,t,n,i,r){const s=1-e,o=s*s,a=e*e;return o*s*t+3*o*e*n+3*s*a*i+a*e*r}var Bu=(Bu=$u(1,1))?Bu.getContext("2d"):null;const wP=new Mn;function WI(e){return function(t,n){if(!Bu)return!0;e(Bu,t),wP.clear().union(t.bounds).intersect(n).round();const{x1:i,y1:r,x2:s,y2:o}=wP;for(let a=r;a<=o;++a)for(let l=i;l<=s;++l)if(Bu.isPointInPath(l,a))return!0;return!1}}function UI(e,t){return t.contains(e.x||0,e.y||0)}function W9(e,t){const n=e.x||0,i=e.y||0,r=e.width||0,s=e.height||0;return t.intersects(wP.set(n,i,n+r,i+s))}function U9(e,t){const n=e.x||0,i=e.y||0,r=e.x2!=null?e.x2:n,s=e.y2!=null?e.y2:i;return cf(t,n,i,r,s)}function cf(e,t,n,i,r){const{x1:s,y1:o,x2:a,y2:l}=e,u=i-t,c=r-n;let d=0,h=1,p,g,v,C;for(C=0;C<4;++C){if(C===0&&(p=-u,g=-(s-t)),C===1&&(p=u,g=a-t),C===2&&(p=-c,g=-(o-n)),C===3&&(p=c,g=l-n),Math.abs(p)<1e-10&&g<0)return!1;if(v=g/p,p<0){if(v>h)return!1;v>d&&(d=v)}else if(p>0){if(v<d)return!1;v<h&&(h=v)}}return!0}function Qf(e,t){e.globalCompositeOperation=t.blend||"source-over"}function Js(e,t){return e??t}function $3(e,t){const n=t.length;for(let i=0;i<n;++i)e.addColorStop(t[i].offset,t[i].color);return e}function TCe(e,t,n){const i=n.width(),r=n.height();let s;if(t.gradient==="radial")s=e.createRadialGradient(n.x1+Js(t.x1,.5)*i,n.y1+Js(t.y1,.5)*r,Math.max(i,r)*Js(t.r1,0),n.x1+Js(t.x2,.5)*i,n.y1+Js(t.y2,.5)*r,Math.max(i,r)*Js(t.r2,.5));else{const o=Js(t.x1,0),a=Js(t.y1,0),l=Js(t.x2,1),u=Js(t.y2,0);if(o===l||a===u||i===r)s=e.createLinearGradient(n.x1+o*i,n.y1+a*r,n.x1+l*i,n.y1+u*r);else{const c=$u(Math.ceil(i),Math.ceil(r)),d=c.getContext("2d");return d.scale(i,r),d.fillStyle=$3(d.createLinearGradient(o,a,l,u),t.stops),d.fillRect(0,0,i,r),e.createPattern(c,"no-repeat")}}return $3(s,t.stops)}function j9(e,t,n){return GI(n)?TCe(e,n,t.bounds):n}function vb(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=j9(e,t,t.fill),!0):!1}var MCe=[];function Jf(e,t,n){var i=(i=t.strokeWidth)!=null?i:1;return i<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=j9(e,t,t.stroke),e.lineWidth=i,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||MCe),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function ICe(e,t){return e.zindex-t.zindex||e.index-t.index}function jI(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],i,r,s;for(r=0,s=t.length;r<s;++r)i=t[r],i.index=r,i.zindex&&n.push(i);return e.zdirty=!1,e.zitems=n.sort(ICe)}function wo(e,t){var n=e.items,i,r;if(!n||!n.length)return;const s=jI(e);if(s&&s.length){for(i=0,r=n.length;i<r;++i)n[i].zindex||t(n[i]);n=s}for(i=0,r=n.length;i<r;++i)t(n[i])}function Cb(e,t){var n=e.items,i,r;if(!n||!n.length)return null;const s=jI(e);for(s&&s.length&&(n=s),r=n.length;--r>=0;)if(i=t(n[r]))return i;if(n===s){for(n=e.items,r=n.length;--r>=0;)if(!n[r].zindex&&(i=t(n[r])))return i}return null}function qI(e){return function(t,n,i){wo(n,r=>{(!i||i.intersects(r.bounds))&&q9(e,t,r,r)})}}function _Ce(e){return function(t,n,i){n.items.length&&(!i||i.intersects(n.bounds))&&q9(e,t,n.items[0],n.items)}}function q9(e,t,n,i){var r=n.opacity==null?1:n.opacity;r!==0&&(e(t,i)||(Qf(t,n),n.fill&&vb(t,n,r)&&t.fill(),n.stroke&&Jf(t,n,r)&&t.stroke()))}function q1(e){return e=e||Is,function(t,n,i,r,s,o){return i*=t.pixelRatio,r*=t.pixelRatio,Cb(n,a=>{const l=a.bounds;if(!(l&&!l.contains(s,o)||!l)&&e(t,a,i,r,s,o))return a})}}function O0(e,t){return function(n,i,r,s){var o=Array.isArray(i)?i[0]:i,a=t??o.fill,l=o.stroke&&n.isPointInStroke,u,c;return l&&(u=o.strokeWidth,c=o.strokeCap,n.lineWidth=u??1,n.lineCap=c??"butt"),e(n,i)?!1:a&&n.isPointInPath(r,s)||l&&n.isPointInStroke(r,s)}}function KI(e){return q1(O0(e))}function gd(e,t){return"translate("+e+","+t+")"}function YI(e){return"rotate("+e+")"}function OCe(e,t){return"scale("+e+","+t+")"}function K9(e){return gd(e.x||0,e.y||0)}function LCe(e){return gd(e.x||0,e.y||0)+(e.angle?" "+YI(e.angle):"")}function NCe(e){return gd(e.x||0,e.y||0)+(e.angle?" "+YI(e.angle):"")+(e.scaleX||e.scaleY?" "+OCe(e.scaleX||1,e.scaleY||1):"")}function XI(e,t,n){function i(o,a){o("transform",LCe(a)),o("d",t(null,a))}function r(o,a){return t(_0(o,a.angle),a),Vl(o,a).translate(a.x||0,a.y||0)}function s(o,a){var l=a.x||0,u=a.y||0,c=a.angle||0;o.translate(l,u),c&&o.rotate(c*=Ku),o.beginPath(),t(o,a),c&&o.rotate(-c),o.translate(-l,-u)}return{type:e,tag:"path",nested:!1,attr:i,bound:r,draw:qI(s),pick:KI(s),isect:n||WI(s)}}var $Ce=XI("arc",SCe);function BCe(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],i=e[0].orient==="horizontal"?"y":"x",r=e.length,s=1/0,o,a;--r>=0;)e[r].defined!==!1&&(a=Math.abs(e[r][i]-n),a<s&&(s=a,o=e[r]));return o}function GCe(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),i=e.length,r,s,o;--i>=0;)if(e[i].defined!==!1&&(r=e[i].x-t[0],s=e[i].y-t[1],o=r*r+s*s,o<n))return e[i];return null}function zCe(e,t){for(var n=e.length,i,r,s;--n>=0;)if(e[n].defined!==!1&&(i=e[n].x-t[0],r=e[n].y-t[1],s=i*i+r*r,i=e[n].size||1,s<i*i))return e[n];return null}function QI(e,t,n){function i(l,u){var c=u.mark.items;c.length&&l("d",t(null,c))}function r(l,u){var c=u.items;return c.length===0?l:(t(_0(l),c),Vl(l,c[0]))}function s(l,u){l.beginPath(),t(l,u)}const o=O0(s);function a(l,u,c,d,h,p){var g=u.items,v=u.bounds;return!g||!g.length||v&&!v.contains(h,p)?null:(c*=l.pixelRatio,d*=l.pixelRatio,o(l,g,c,d)?g[0]:null)}return{type:e,tag:"path",nested:!0,attr:i,bound:r,draw:_Ce(s),pick:a,isect:UI,tip:n}}var HCe=QI("area",xCe,BCe);function VCe(e,t){var n=t.clip;e.save(),nt(n)?(e.beginPath(),n(e),e.clip()):Y9(e,t.group)}function Y9(e,t){e.beginPath(),HI(t)?Wp(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function X9(e){const t=Js(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function WCe(e,t){e("transform",K9(t))}function Q9(e,t){const n=X9(t);e("d",Wp(null,t,n,n))}function UCe(e,t){e("class","background"),e("aria-hidden",!0),Q9(e,t)}function jCe(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?Q9(e,t):e("d","")}function qCe(e,t,n){const i=t.clip?VI(n,t,t):null;e("clip-path",i)}function KCe(e,t){if(!t.clip&&t.items){const n=t.items,i=n.length;for(let r=0;r<i;++r)e.union(n[r].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),Vl(e,t),e.translate(t.x||0,t.y||0)}function Pv(e,t,n,i){const r=X9(t);e.beginPath(),Wp(e,t,(n||0)+r,(i||0)+r)}const YCe=O0(Pv),XCe=O0(Pv,!1),QCe=O0(Pv,!0);function JCe(e,t,n,i){wo(t,r=>{const s=r.x||0,o=r.y||0,a=r.strokeForeground,l=r.opacity==null?1:r.opacity;(r.stroke||r.fill)&&l&&(Pv(e,r,s,o),Qf(e,r),r.fill&&vb(e,r,l)&&e.fill(),r.stroke&&!a&&Jf(e,r,l)&&e.stroke()),e.save(),e.translate(s,o),r.clip&&Y9(e,r),n&&n.translate(-s,-o),wo(r,u=>{(u.marktype==="group"||i==null||i.includes(u.marktype))&&this.draw(e,u,n,i)}),n&&n.translate(s,o),e.restore(),a&&r.stroke&&l&&(Pv(e,r,s,o),Qf(e,r),Jf(e,r,l)&&e.stroke())})}function ZCe(e,t,n,i,r,s){if(t.bounds&&!t.bounds.contains(r,s)||!t.items)return null;const o=n*e.pixelRatio,a=i*e.pixelRatio;return Cb(t,l=>{let u,c,d;const h=l.bounds;if(h&&!h.contains(r,s))return;c=l.x||0,d=l.y||0;const p=c+(l.width||0),g=d+(l.height||0),v=l.clip;if(v&&(r<c||r>p||s<d||s>g))return;if(e.save(),e.translate(c,d),c=r-c,d=s-d,v&&HI(l)&&!QCe(e,l,o,a))return e.restore(),null;const C=l.strokeForeground,y=t.interactive!==!1;return y&&C&&l.stroke&&XCe(e,l,o,a)?(e.restore(),l):(u=Cb(l,b=>eye(b,c,d)?this.pick(b,n,i,c,d):null),!u&&y&&(l.fill||!C&&l.stroke)&&YCe(e,l,o,a)&&(u=l),e.restore(),u||null)})}function eye(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var tye={type:"group",tag:"g",nested:!1,attr:WCe,bound:KCe,draw:JCe,pick:ZCe,isect:W9,content:qCe,background:UCe,foreground:jCe},kv={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function JI(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(i=>{e.image=i,e.image.url=e.url})),n}function ZI(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function e2(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function K1(e,t){return e==="center"?t/2:e==="right"?t:0}function Y1(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function nye(e,t,n){const i=JI(t,n),r=ZI(t,i),s=e2(t,i),o=(t.x||0)-K1(t.align,r),a=(t.y||0)-Y1(t.baseline,s),l=!i.src&&i.toDataURL?i.toDataURL():i.src||"";e("href",l,kv["xmlns:xlink"],"xlink:href"),e("transform",gd(o,a)),e("width",r),e("height",s),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function iye(e,t){const n=t.image,i=ZI(t,n),r=e2(t,n),s=(t.x||0)-K1(t.align,i),o=(t.y||0)-Y1(t.baseline,r);return e.set(s,o,s+i,o+r)}function rye(e,t,n){wo(t,i=>{if(n&&!n.intersects(i.bounds))return;const r=JI(i,this);let s=ZI(i,r),o=e2(i,r);if(s===0||o===0)return;let a=(i.x||0)-K1(i.align,s),l=(i.y||0)-Y1(i.baseline,o),u,c,d,h;i.aspect!==!1&&(c=r.width/r.height,d=i.width/i.height,c===c&&d===d&&c!==d&&(d<c?(h=s/c,l+=(o-h)/2,o=h):(h=o*c,a+=(s-h)/2,s=h))),(r.complete||r.toDataURL)&&(Qf(e,i),e.globalAlpha=(u=i.opacity)!=null?u:1,e.imageSmoothingEnabled=i.smooth!==!1,e.drawImage(r,a,l,s,o))})}var sye={type:"image",tag:"image",nested:!1,attr:nye,bound:iye,draw:rye,pick:q1(),isect:Is,get:JI,xOffset:K1,yOffset:Y1},oye=QI("line",RCe,GCe);function aye(e,t){var n=t.scaleX||1,i=t.scaleY||1;(n!==1||i!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",NCe(t)),e("d",t.path)}function Rw(e,t){var n=t.path;if(n==null)return!0;var i=t.x||0,r=t.y||0,s=t.scaleX||1,o=t.scaleY||1,a=(t.angle||0)*Ku,l=t.pathCache;(!l||l.path!==n)&&((t.pathCache=l=Xf(n)).path=n),a&&e.rotate&&e.translate?(e.translate(i,r),e.rotate(a),Dv(e,l,0,0,s,o),e.rotate(-a),e.translate(-i,-r)):Dv(e,l,i,r,s,o)}function lye(e,t){return Rw(_0(e,t.angle),t)?e.set(0,0,0,0):Vl(e,t,!0)}var uye={type:"path",tag:"path",nested:!1,attr:aye,bound:lye,draw:qI(Rw),pick:KI(Rw),isect:WI(Rw)};function cye(e,t){e("d",Wp(null,t))}function dye(e,t){var n,i;return Vl(e.set(n=t.x||0,i=t.y||0,n+t.width||0,i+t.height||0),t)}function B3(e,t){e.beginPath(),Wp(e,t)}var hye={type:"rect",tag:"path",nested:!1,attr:cye,bound:dye,draw:qI(B3),pick:KI(B3),isect:W9};function fye(e,t){e("transform",K9(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function pye(e,t){var n,i;return Vl(e.set(n=t.x||0,i=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:i),t)}function J9(e,t,n){var i,r,s,o;return t.stroke&&Jf(e,t,n)?(i=t.x||0,r=t.y||0,s=t.x2!=null?t.x2:i,o=t.y2!=null?t.y2:r,e.beginPath(),e.moveTo(i,r),e.lineTo(s,o),!0):!1}function gye(e,t,n){wo(t,i=>{if(!(n&&!n.intersects(i.bounds))){var r=i.opacity==null?1:i.opacity;r&&J9(e,i,r)&&(Qf(e,i),e.stroke())}})}function mye(e,t,n,i){return e.isPointInStroke?J9(e,t,1)&&e.isPointInStroke(n,i):!1}var vye={type:"rule",tag:"line",nested:!1,attr:fye,bound:pye,draw:gye,pick:q1(mye),isect:U9},Cye=XI("shape",ECe),yye=XI("symbol",FCe,UI);const G3=r4();var Yr={height:Da,measureWidth:t2,estimateWidth:yb,width:yb,canvas:Z9};Z9(!0);function Z9(e){Yr.width=e&&Bu?t2:yb}function yb(e,t){return e7(Xu(e,t),Da(e))}function e7(e,t){return~~(.8*e.length*t)}function t2(e,t){return Da(e)<=0||!(t=Xu(e,t))?0:t7(t,X1(e))}function t7(e,t){const n=`(${t}) ${e}`;let i=G3.get(n);return i===void 0&&(Bu.font=t,i=Bu.measureText(e).width,G3.set(n,i)),i}function Da(e){return e.fontSize!=null?+e.fontSize||0:11}function Yu(e){return e.lineHeight!=null?e.lineHeight:Da(e)+2}function wye(e){return te(e)?e.length>1?e:e[0]:e}function L0(e){return wye(e.lineBreak&&e.text&&!te(e.text)?e.text.split(e.lineBreak):e.text)}function n2(e){const t=L0(e);return(te(t)?t.length-1:0)*Yu(e)}function Xu(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?Sye(e,n):n}function bye(e){if(Yr.width===t2){const t=X1(e);return n=>t7(n,t)}else if(Yr.width===yb){const t=Da(e);return n=>e7(n,t)}else return t=>Yr.width(e,t)}function Sye(e,t){var n=+e.limit,i=bye(e);if(i(t)<n)return t;var r=e.ellipsis||"…",s=e.dir==="rtl",o=0,a=t.length,l;if(n-=i(r),s){for(;o<a;)l=o+a>>>1,i(t.slice(l))>n?o=l+1:a=l;return r+t.slice(o)}else{for(;o<a;)l=1+(o+a>>>1),i(t.slice(0,l))<n?o=l:a=l-1;return t.slice(0,o)+r}}function N0(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function X1(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+Da(e)+"px "+N0(e,t)}function i2(e){var t=e.baseline,n=Da(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*Yu(e):t==="line-bottom"?.29*n-.5*Yu(e):0)}const xye={left:"start",center:"middle",right:"end"},jm=new Mn;function Q1(e){var t=e.x||0,n=e.y||0,i=e.radius||0,r;return i&&(r=(e.theta||0)-id,t+=i*Math.cos(r),n+=i*Math.sin(r)),jm.x1=t,jm.y1=n,jm}function Rye(e,t){var n=t.dx||0,i=(t.dy||0)+i2(t),r=Q1(t),s=r.x1,o=r.y1,a=t.angle||0,l;e("text-anchor",xye[t.align]||"start"),a?(l=gd(s,o)+" "+YI(a),(n||i)&&(l+=" "+gd(n,i))):l=gd(s+n,o+i),e("transform",l)}function r2(e,t,n){var i=Yr.height(t),r=t.align,s=Q1(t),o=s.x1,a=s.y1,l=t.dx||0,u=(t.dy||0)+i2(t)-Math.round(.8*i),c=L0(t),d;if(te(c)?(i+=Yu(t)*(c.length-1),d=c.reduce((h,p)=>Math.max(h,Yr.width(t,p)),0)):d=Yr.width(t,c),r==="center"?l-=d/2:r==="right"&&(l-=d),e.set(l+=o,u+=a,l+d,u+i),t.angle&&!n)e.rotate(t.angle*Ku,o,a);else if(n===2)return e.rotatedPoints(t.angle*Ku,o,a);return e}function Eye(e,t,n){wo(t,i=>{var r=i.opacity==null?1:i.opacity,s,o,a,l,u,c,d;if(!(n&&!n.intersects(i.bounds)||r===0||i.fontSize<=0||i.text==null||i.text.length===0)){if(e.font=X1(i),e.textAlign=i.align||"left",s=Q1(i),o=s.x1,a=s.y1,i.angle&&(e.save(),e.translate(o,a),e.rotate(i.angle*Ku),o=a=0),o+=i.dx||0,a+=(i.dy||0)+i2(i),c=L0(i),Qf(e,i),te(c))for(u=Yu(i),l=0;l<c.length;++l)d=Xu(i,c[l]),i.fill&&vb(e,i,r)&&e.fillText(d,o,a),i.stroke&&Jf(e,i,r)&&e.strokeText(d,o,a),a+=u;else d=Xu(i,c),i.fill&&vb(e,i,r)&&e.fillText(d,o,a),i.stroke&&Jf(e,i,r)&&e.strokeText(d,o,a);i.angle&&e.restore()}})}function Fye(e,t,n,i,r,s){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var o=Q1(t),a=o.x1,l=o.y1,u=r2(jm,t,1),c=-t.angle*Ku,d=Math.cos(c),h=Math.sin(c),p=d*r-h*s+(a-d*a+h*l),g=h*r+d*s+(l-h*a-d*l);return u.contains(p,g)}function Aye(e,t){const n=r2(jm,e,2);return cf(t,n[0],n[1],n[2],n[3])||cf(t,n[0],n[1],n[4],n[5])||cf(t,n[4],n[5],n[6],n[7])||cf(t,n[2],n[3],n[6],n[7])}var Dye={type:"text",tag:"text",nested:!1,attr:Rye,bound:r2,draw:Eye,pick:q1(Fye),isect:Aye},Pye=QI("trail",ACe,zCe),ts={arc:$Ce,area:HCe,group:tye,image:sye,line:oye,path:uye,rect:hye,rule:vye,shape:Cye,symbol:yye,text:Dye,trail:Pye};function bP(e,t,n){var i=ts[e.mark.marktype],r=t||i.bound;return i.nested&&(e=e.mark),r(e.bounds||(e.bounds=new Mn),e,n)}var z3={mark:null};function n7(e,t,n){var i=ts[e.marktype],r=i.bound,s=e.items,o=s&&s.length,a,l,u,c;if(i.nested)return o?u=s[0]:(z3.mark=e,u=z3),c=bP(u,r,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new Mn,o)for(a=0,l=s.length;a<l;++a)t.union(bP(s[a],r,n));return e.bounds=t}const kye=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function i7(e,t){return JSON.stringify(e,kye,t)}function r7(e){const t=typeof e=="string"?JSON.parse(e):e;return s7(t)}function s7(e){var t=e.marktype,n=e.items,i,r,s;if(n)for(r=0,s=n.length;r<s;++r)i=t?"mark":"group",n[r][i]=e,n[r].zindex&&(n[r][i].zdirty=!0),(t||i)==="group"&&s7(n[r]);return t&&n7(e),e}class o7{constructor(t){arguments.length?this.root=r7(t):(this.root=H3({marktype:"group",name:"root",role:"frame"}),this.root.items=[new U1(this.root)])}toJSON(t){return i7(this.root,t||0)}mark(t,n,i){n=n||this.root.items[0];const r=H3(t,n);return n.items[i]=r,r.zindex&&(r.group.zdirty=!0),r}}function H3(e,t){const n={bounds:new Mn,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function Fu(e,t,n){return!e&&typeof document<"u"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function s2(e,t){t=t.toLowerCase();for(var n=e.childNodes,i=0,r=n.length;i<r;++i)if(n[i].tagName.toLowerCase()===t)return n[i]}function Nn(e,t,n,i){var r=e.childNodes[t],s;return(!r||r.tagName.toLowerCase()!==n.toLowerCase())&&(s=r||null,r=Fu(e.ownerDocument,n,i),e.insertBefore(r,s)),r}function Cs(e,t){for(var n=e.childNodes,i=n.length;i>t;)e.removeChild(n[--i]);return e}function a7(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function J1(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function Tye(e,t,n,i){var r=e&&e.mark,s,o;if(r&&(s=ts[r.marktype]).tip){for(o=J1(t,n),o[0]-=i[0],o[1]-=i[1];e=e.mark.group;)o[0]-=e.x||0,o[1]-=e.y||0;e=s.tip(r.items,o)}return e}let o2=class{constructor(t,n){this._active=null,this._handlers={},this._loader=t||m1(),this._tooltip=n||Mye}initialize(t,n,i){return this._el=t,this._obj=i||null,this.origin(n)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()}scene(t){return arguments.length?(this._scene=t,this):this._scene}on(){}off(){}_handlerIndex(t,n,i){for(let r=t?t.length:0;--r>=0;)if(t[r].type===n&&(!i||t[r].handler===i))return r;return-1}handlers(t){const n=this._handlers,i=[];if(t)i.push(...n[this.eventName(t)]);else for(const r in n)i.push(...n[r]);return i}eventName(t){const n=t.indexOf(".");return n<0?t:t.slice(0,n)}handleHref(t,n,i){this._loader.sanitize(i,{context:"href"}).then(r=>{const s=new MouseEvent(t.type,t),o=Fu(null,"a");for(const a in r)o.setAttribute(a,r[a]);o.dispatchEvent(s)}).catch(()=>{})}handleTooltip(t,n,i){if(n&&n.tooltip!=null){n=Tye(n,t,this.canvas(),this._origin);const r=i&&n&&n.tooltip||null;this._tooltip.call(this._obj,this,t,n,r)}}getItemBoundingClientRect(t){const n=this.canvas();if(!n)return;const i=n.getBoundingClientRect(),r=this._origin,s=t.bounds,o=s.width(),a=s.height();let l=s.x1+r[0]+i.left,u=s.y1+r[1]+i.top;for(;t.mark&&(t=t.mark.group);)l+=t.x||0,u+=t.y||0;return{x:l,y:u,width:o,height:a,left:l,top:u,right:l+o,bottom:u+a}}};function Mye(e,t,n,i){e.element().setAttribute("title",i||"")}class $0{constructor(t){this._el=null,this._bgcolor=null,this._loader=new V9(t)}initialize(t,n,i,r,s){return this._el=t,this.resize(n,i,r,s)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}background(t){return arguments.length===0?this._bgcolor:(this._bgcolor=t,this)}resize(t,n,i,r){return this._width=t,this._height=n,this._origin=i||[0,0],this._scale=r||1,this}dirty(){}render(t,n){const i=this;return i._call=function(){i._render(t,n)},i._call(),i._call=null,i}_render(){}renderAsync(t,n){const i=this.render(t,n);return this._ready?this._ready.then(()=>i):Promise.resolve(i)}_load(t,n){var i=this,r=i._loader[t](n);if(!i._ready){const s=i._call;i._ready=i._loader.ready().then(o=>{o&&s(),i._ready=null})}return r}sanitizeURL(t){return this._load("sanitizeURL",t)}loadImage(t){return this._load("loadImage",t)}}const Iye="keydown",_ye="keypress",Oye="keyup",l7="dragenter",Ew="dragleave",u7="dragover",SP="pointerdown",Lye="pointerup",wb="pointermove",Fw="pointerout",c7="pointerover",xP="mousedown",Nye="mouseup",d7="mousemove",bb="mouseout",h7="mouseover",Sb="click",$ye="dblclick",Bye="wheel",f7="mousewheel",xb="touchstart",Rb="touchmove",Eb="touchend",Gye=[Iye,_ye,Oye,l7,Ew,u7,SP,Lye,wb,Fw,c7,xP,Nye,d7,bb,h7,Sb,$ye,Bye,f7,xb,Rb,Eb],RP=wb,qm=bb,EP=Sb;class B0 extends o2{constructor(t,n){super(t,n),this._down=null,this._touch=null,this._first=!0,this._events={},this.events=Gye,this.pointermove=W3([wb,d7],[c7,h7],[Fw,bb]),this.dragover=W3([u7],[l7],[Ew]),this.pointerout=U3([Fw,bb]),this.dragleave=U3([Ew])}initialize(t,n,i){return this._canvas=t&&s2(t,"canvas"),[Sb,xP,SP,wb,Fw,Ew].forEach(r=>V3(this,r)),super.initialize(t,n,i)}canvas(){return this._canvas}context(){return this._canvas.getContext("2d")}DOMMouseScroll(t){this.fire(f7,t)}pointerdown(t){this._down=this._active,this.fire(SP,t)}mousedown(t){this._down=this._active,this.fire(xP,t)}click(t){this._down===this._active&&(this.fire(Sb,t),this._down=null)}touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(xb,t,!0)}touchmove(t){this.fire(Rb,t,!0)}touchend(t){this.fire(Eb,t,!0),this._touch=null}fire(t,n,i){const r=i?this._touch:this._active,s=this._handlers[t];if(n.vegaType=t,t===EP&&r&&r.href?this.handleHref(n,r,r.href):(t===RP||t===qm)&&this.handleTooltip(n,r,t!==qm),s)for(let o=0,a=s.length;o<a;++o)s[o].handler.call(this._obj,n,r)}on(t,n){const i=this.eventName(t),r=this._handlers;return this._handlerIndex(r[i],t,n)<0&&(V3(this,t),(r[i]||(r[i]=[])).push({type:t,handler:n})),this}off(t,n){const i=this.eventName(t),r=this._handlers[i],s=this._handlerIndex(r,t,n);return s>=0&&r.splice(s,1),this}pickEvent(t){const n=J1(t,this._canvas),i=this._origin;return this.pick(this._scene,n[0],n[1],n[0]-i[0],n[1]-i[1])}pick(t,n,i,r,s){const o=this.context();return ts[t.marktype].pick.call(this,o,t,n,i,r,s)}}const zye=e=>e===xb||e===Rb||e===Eb?[xb,Rb,Eb]:[e];function V3(e,t){zye(t).forEach(n=>Hye(e,n))}function Hye(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?i=>e[t](i):i=>e.fire(t,i)))}function Am(e,t,n){t.forEach(i=>e.fire(i,n))}function W3(e,t,n){return function(i){const r=this._active,s=this.pickEvent(i);s===r?Am(this,e,i):((!r||!r.exit)&&Am(this,n,i),this._active=s,Am(this,t,i),Am(this,e,i))}}function U3(e){return function(t){Am(this,e,t),this._active=null}}function Vye(){return typeof window<"u"&&window.devicePixelRatio||1}function Wye(e,t,n,i,r,s){const o=typeof HTMLElement<"u"&&e instanceof HTMLElement&&e.parentNode!=null,a=e.getContext("2d"),l=o?Vye():r;e.width=t*l,e.height=n*l;for(const u in s)a[u]=s[u];return o&&l!==1&&(e.style.width=t+"px",e.style.height=n+"px"),a.pixelRatio=l,a.setTransform(l,0,0,l,l*i[0],l*i[1]),e}class Fb extends $0{constructor(t){super(t),this._options={},this._redraw=!1,this._dirty=new Mn,this._tempb=new Mn}initialize(t,n,i,r,s,o){return this._options=o||{},this._canvas=this._options.externalContext?null:$u(1,1,this._options.type),t&&this._canvas&&(Cs(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),super.initialize(t,n,i,r,s)}resize(t,n,i,r){if(super.resize(t,n,i,r),this._canvas)Wye(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const s=this._options.externalContext;s||Z("CanvasRenderer is missing a valid canvas or context"),s.scale(this._scale,this._scale),s.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this}canvas(){return this._canvas}context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)}dirty(t){const n=this._tempb.clear().union(t.bounds);let i=t.mark.group;for(;i;)n.translate(i.x||0,i.y||0),i=i.mark.group;this._dirty.union(n)}_render(t,n){const i=this.context(),r=this._origin,s=this._width,o=this._height,a=this._dirty,l=Uye(r,s,o);i.save();const u=this._redraw||a.empty()?(this._redraw=!1,l.expand(1)):jye(i,l.intersect(a),r);return this.clear(-r[0],-r[1],s,o),this.draw(i,t,u,n),i.restore(),a.clear(),this}draw(t,n,i,r){if(n.marktype!=="group"&&r!=null&&!r.includes(n.marktype))return;const s=ts[n.marktype];n.clip&&VCe(t,n),s.draw.call(this,t,n,i,r),n.clip&&t.restore()}clear(t,n,i,r){const s=this._options,o=this.context();s.type!=="pdf"&&!s.externalContext&&o.clearRect(t,n,i,r),this._bgcolor!=null&&(o.fillStyle=this._bgcolor,o.fillRect(t,n,i,r))}}const Uye=(e,t,n)=>new Mn().set(0,0,t,n).translate(-e[0],-e[1]);function jye(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}class p7 extends o2{constructor(t,n){super(t,n);const i=this;i._hrefHandler=_F(i,(r,s)=>{s&&s.href&&i.handleHref(r,s,s.href)}),i._tooltipHandler=_F(i,(r,s)=>{i.handleTooltip(r,s,r.type!==qm)})}initialize(t,n,i){let r=this._svg;return r&&(r.removeEventListener(EP,this._hrefHandler),r.removeEventListener(RP,this._tooltipHandler),r.removeEventListener(qm,this._tooltipHandler)),this._svg=r=t&&s2(t,"svg"),r&&(r.addEventListener(EP,this._hrefHandler),r.addEventListener(RP,this._tooltipHandler),r.addEventListener(qm,this._tooltipHandler)),super.initialize(t,n,i)}canvas(){return this._svg}on(t,n){const i=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[i],t,n)<0){const o={type:t,handler:n,listener:_F(this,n)};(r[i]||(r[i]=[])).push(o),this._svg&&this._svg.addEventListener(i,o.listener)}return this}off(t,n){const i=this.eventName(t),r=this._handlers[i],s=this._handlerIndex(r,t,n);return s>=0&&(this._svg&&this._svg.removeEventListener(i,r[s].listener),r.splice(s,1)),this}}const _F=(e,t)=>n=>{let i=n.target.__data__;i=Array.isArray(i)?i[0]:i,n.vegaType=n.type,t.call(e._obj,n,i)},g7="aria-hidden",a2="aria-label",l2="role",u2="aria-roledescription",m7="graphics-object",c2="graphics-symbol",v7=(e,t,n)=>({[l2]:e,[u2]:t,[a2]:n||void 0}),qye=Co(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),j3={axis:{desc:"axis",caption:Xye},legend:{desc:"legend",caption:Qye},"title-text":{desc:"title",caption:e=>`Title text '${K3(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${K3(e)}'`}},q3={ariaRole:l2,ariaRoleDescription:u2,description:a2};function C7(e,t){const n=t.aria===!1;if(e(g7,n||void 0),n||t.description==null)for(const i in q3)e(q3[i],void 0);else{const i=t.mark.marktype;e(a2,t.description),e(l2,t.ariaRole||(i==="group"?m7:c2)),e(u2,t.ariaRoleDescription||`${i} mark`)}}function y7(e){return e.aria===!1?{[g7]:!0}:qye[e.role]?null:j3[e.role]?Yye(e,j3[e.role]):Kye(e)}function Kye(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(i=>i.description!=null&&i.aria!==!1);return v7(n?m7:c2,`${t} mark container`,e.description)}function Yye(e,t){try{const n=e.items[0],i=t.caption||(()=>"");return v7(t.role||c2,t.desc,n.description||i(n))}catch{return null}}function K3(e){return we(e.text).join(" ")}function Xye(e){const t=e.datum,n=e.orient,i=t.title?w7(e):null,r=e.context,s=r.scales[t.scale].value,o=r.dataflow.locale(),a=s.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(i?` titled '${i}'`:"")+` for a ${Yf(a)?"discrete":a} scale with ${I9(o,s,e)}`}function Qye(e){const t=e.datum,n=t.title?w7(e):null,i=`${t.type||""} legend`.trim(),r=t.scales,s=Object.keys(r),o=e.context,a=o.scales[r[s[0]]].value,l=o.dataflow.locale();return Zye(i)+(n?` titled '${n}'`:"")+` for ${Jye(s)} with ${I9(l,a,e)}`}function w7(e){try{return we(gt(e.items).items[0].text).join(" ")}catch{return null}}function Jye(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+gt(e)}function Zye(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const b7=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),ewe=e=>b7(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function d2(){let e="",t="",n="";const i=[],r=()=>t=n="",s=l=>{t&&(e+=`${t}>${n}`,r()),i.push(l)},o=(l,u)=>(u!=null&&(t+=` ${l}="${ewe(u)}"`),a),a={open(l){s(l),t="<"+l;for(var u=arguments.length,c=new Array(u>1?u-1:0),d=1;d<u;d++)c[d-1]=arguments[d];for(const h of c)for(const p in h)o(p,h[p]);return a},close(){const l=i.pop();return t?e+=t+(n?`>${n}</${l}>`:"/>"):e+=`</${l}>`,r(),a},attr:o,text:l=>(n+=b7(l),a),toString:()=>e};return a}const S7=e=>x7(d2(),e)+"";function x7(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,i=n.length;for(let r=0;r<i;++r)e.attr(n[r].name,n[r].value)}if(t.hasChildNodes()){const n=t.childNodes;for(const i of n)i.nodeType===3?e.text(i.nodeValue):x7(e,i)}return e.close()}const Ab={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},Db={blend:"mix-blend-mode"},R7={fill:"none","stroke-miterlimit":10},Yg=0,Y3="http://www.w3.org/2000/xmlns/",Ln=kv.xmlns;class h2 extends $0{constructor(t){super(t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}initialize(t,n,i,r,s){return this._defs={},this._clearDefs(),t&&(this._svg=Nn(t,0,"svg",Ln),this._svg.setAttributeNS(Y3,"xmlns",Ln),this._svg.setAttributeNS(Y3,"xmlns:xlink",kv["xmlns:xlink"]),this._svg.setAttribute("version",kv.version),this._svg.setAttribute("class","marks"),Cs(t,1),this._root=Nn(this._svg,Yg,"g",Ln),Au(this._root,R7),Cs(this._svg,Yg+1)),this.background(this._bgcolor),super.initialize(t,n,i,r,s)}background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),super.background(...arguments)}resize(t,n,i,r){return super.resize(t,n,i,r),this._svg&&(Au(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this}canvas(){return this._svg}svg(){const t=this._svg,n=this._bgcolor;if(!t)return null;let i;n&&(t.removeAttribute("style"),i=Nn(t,Yg,"rect",Ln),Au(i,{width:this._width,height:this._height,fill:n}));const r=S7(t);return n&&(t.removeChild(i),this._svg.style.setProperty("background-color",n)),r}_render(t,n){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t,void 0,n),Cs(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this}dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))}isDirty(t){return this._dirtyAll||!t._svg||!t._svg.ownerSVGElement||t.dirty===this._dirtyID}_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const n=++this._dirtyID;let i,r,s,o,a,l,u;for(a=0,l=t.length;a<l;++a)if(i=t[a],r=i.mark,r.marktype!==s&&(s=r.marktype,o=ts[s]),r.zdirty&&r.dirty!==n&&(this._dirtyAll=!1,X3(i,n),r.items.forEach(c=>{c.dirty=n})),!r.zdirty){if(i.exit){o.nested&&r.items.length?(u=r.items[0],u._svg&&this._update(o,u._svg,u)):i._svg&&(u=i._svg.parentNode,u&&u.removeChild(i._svg)),i._svg=null;continue}i=o.nested?r.items[0]:i,i._update!==n&&(!i._svg||!i._svg.ownerSVGElement?(this._dirtyAll=!1,X3(i,n)):this._update(o,i._svg,i),i._update=n)}return!this._dirtyAll}mark(t,n,i,r){if(!this.isDirty(n))return n._svg;const s=this._svg,o=n.marktype,a=ts[o],l=n.interactive===!1?"none":null,u=a.tag==="g",c=Q3(n,t,i,"g",s);if(o!=="group"&&r!=null&&!r.includes(o))return Cs(c,0),n._svg;c.setAttribute("class",a7(n));const d=y7(n);for(const v in d)Vi(c,v,d[v]);u||Vi(c,"pointer-events",l),Vi(c,"clip-path",n.clip?VI(this,n,n.group):null);let h=null,p=0;const g=v=>{const C=this.isDirty(v),y=Q3(v,c,h,a.tag,s);C&&(this._update(a,y,v),u&&iwe(this,y,v,r)),h=y,++p};return a.nested?n.items.length&&g(n.items[0]):wo(n,g),Cs(c,p),c}_update(t,n,i){fl=n,Ei=n.__values__,C7(Km,i),t.attr(Km,i,this);const r=swe[t.type];r&&r.call(this,t,n,i),fl&&this.style(fl,i)}style(t,n){if(n!=null){for(const i in Ab){let r=i==="font"?N0(n):n[i];if(r===Ei[i])continue;const s=Ab[i];r==null?t.removeAttribute(s):(GI(r)&&(r=O9(r,this._defs.gradient,E7())),t.setAttribute(s,r+"")),Ei[i]=r}for(const i in Db)Aw(t,Db[i],n[i])}}defs(){const t=this._svg,n=this._defs;let i=n.el,r=0;for(const s in n.gradient)i||(n.el=i=Nn(t,Yg+1,"defs",Ln)),r=twe(i,n.gradient[s],r);for(const s in n.clipping)i||(n.el=i=Nn(t,Yg+1,"defs",Ln)),r=nwe(i,n.clipping[s],r);i&&(r===0?(t.removeChild(i),n.el=null):Cs(i,r))}_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}}function X3(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function twe(e,t,n){let i,r,s;if(t.gradient==="radial"){let o=Nn(e,n++,"pattern",Ln);Au(o,{id:mb+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),o=Nn(o,0,"rect",Ln),Au(o,{width:1,height:1,fill:`url(${E7()}#${t.id})`}),e=Nn(e,n++,"radialGradient",Ln),Au(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=Nn(e,n++,"linearGradient",Ln),Au(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(i=0,r=t.stops.length;i<r;++i)s=Nn(e,i,"stop",Ln),s.setAttribute("offset",t.stops[i].offset),s.setAttribute("stop-color",t.stops[i].color);return Cs(e,i),n}function nwe(e,t,n){let i;return e=Nn(e,n,"clipPath",Ln),e.setAttribute("id",t.id),t.path?(i=Nn(e,0,"path",Ln),i.setAttribute("d",t.path)):(i=Nn(e,0,"rect",Ln),Au(i,{x:0,y:0,width:t.width,height:t.height})),Cs(e,1),n+1}function iwe(e,t,n,i){t=t.lastChild.previousSibling;let r,s=0;wo(n,o=>{r=e.mark(t,o,r,i),++s}),Cs(t,1+s)}function Q3(e,t,n,i,r){let s=e._svg,o;if(!s&&(o=t.ownerDocument,s=Fu(o,i,Ln),e._svg=s,e.mark&&(s.__data__=e,s.__values__={fill:"default"},i==="g"))){const a=Fu(o,"path",Ln);s.appendChild(a),a.__data__=e;const l=Fu(o,"g",Ln);s.appendChild(l),l.__data__=e;const u=Fu(o,"path",Ln);s.appendChild(u),u.__data__=e,u.__values__={fill:"default"}}return(s.ownerSVGElement!==r||rwe(s,n))&&t.insertBefore(s,n?n.nextSibling:t.firstChild),s}function rwe(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let fl=null,Ei=null;const swe={group(e,t,n){const i=fl=t.childNodes[2];Ei=i.__values__,e.foreground(Km,n,this),Ei=t.__values__,fl=t.childNodes[1],e.content(Km,n,this);const r=fl=t.childNodes[0];e.background(Km,n,this);const s=n.mark.interactive===!1?"none":null;if(s!==Ei.events&&(Vi(i,"pointer-events",s),Vi(r,"pointer-events",s),Ei.events=s),n.strokeForeground&&n.stroke){const o=n.fill;Vi(i,"display",null),this.style(r,n),Vi(r,"stroke",null),o&&(n.fill=null),Ei=i.__values__,this.style(i,n),o&&(n.fill=o),fl=null}else Vi(i,"display","none")},image(e,t,n){n.smooth===!1?(Aw(t,"image-rendering","optimizeSpeed"),Aw(t,"image-rendering","pixelated")):Aw(t,"image-rendering",null)},text(e,t,n){const i=L0(n);let r,s,o,a;te(i)?(s=i.map(l=>Xu(n,l)),r=s.join(`
`),r!==Ei.text&&(Cs(t,0),o=t.ownerDocument,a=Yu(n),s.forEach((l,u)=>{const c=Fu(o,"tspan",Ln);c.__data__=n,c.textContent=l,u&&(c.setAttribute("x",0),c.setAttribute("dy",a)),t.appendChild(c)}),Ei.text=r)):(s=Xu(n,i),s!==Ei.text&&(t.textContent=s,Ei.text=s)),Vi(t,"font-family",N0(n)),Vi(t,"font-size",Da(n)+"px"),Vi(t,"font-style",n.fontStyle),Vi(t,"font-variant",n.fontVariant),Vi(t,"font-weight",n.fontWeight)}};function Km(e,t,n){t!==Ei[e]&&(n?owe(fl,e,t,n):Vi(fl,e,t),Ei[e]=t)}function Aw(e,t,n){n!==Ei[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),Ei[t]=n)}function Au(e,t){for(const n in t)Vi(e,n,t[n])}function Vi(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function owe(e,t,n,i){n!=null?e.setAttributeNS(i,t,n):e.removeAttributeNS(i,t)}function E7(){let e;return typeof window>"u"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}class F7 extends $0{constructor(t){super(t),this._text=null,this._defs={gradient:{},clipping:{}}}svg(){return this._text}_render(t){const n=d2();n.open("svg",Ze({},kv,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const i=this._bgcolor;return i&&i!=="transparent"&&i!=="none"&&n.open("rect",{width:this._width,height:this._height,fill:i}).close(),n.open("g",R7,{transform:"translate("+this._origin+")"}),this.mark(n,t),n.close(),this.defs(n),this._text=n.close()+"",this}mark(t,n){const i=ts[n.marktype],r=i.tag,s=[C7,i.attr];t.open("g",{class:a7(n),"clip-path":n.clip?VI(this,n,n.group):null},y7(n),{"pointer-events":r!=="g"&&n.interactive===!1?"none":null});const o=a=>{const l=this.href(a);if(l&&t.open("a",l),t.open(r,this.attr(n,a,s,r!=="g"?r:null)),r==="text"){const u=L0(a);if(te(u)){const c={x:0,dy:Yu(a)};for(let d=0;d<u.length;++d)t.open("tspan",d?c:null).text(Xu(a,u[d])).close()}else t.text(Xu(a,u))}else if(r==="g"){const u=a.strokeForeground,c=a.fill,d=a.stroke;u&&d&&(a.stroke=null),t.open("path",this.attr(n,a,i.background,"bgrect")).close(),t.open("g",this.attr(n,a,i.content)),wo(a,h=>this.mark(t,h)),t.close(),u&&d?(c&&(a.fill=null),a.stroke=d,t.open("path",this.attr(n,a,i.foreground,"bgrect")).close(),c&&(a.fill=c)):t.open("path",this.attr(n,a,i.foreground,"bgfore")).close()}t.close(),l&&t.close()};return i.nested?n.items&&n.items.length&&o(n.items[0]):wo(n,o),t.close()}href(t){const n=t.href;let i;if(n){if(i=this._hrefs&&this._hrefs[n])return i;this.sanitizeURL(n).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[n]=r})}return null}attr(t,n,i,r){const s={},o=(a,l,u,c)=>{s[c||a]=l};return Array.isArray(i)?i.forEach(a=>a(o,n,this)):i(o,n,this),r&&awe(s,n,t,r,this._defs),s}defs(t){const n=this._defs.gradient,i=this._defs.clipping;if(Object.keys(n).length+Object.keys(i).length!==0){t.open("defs");for(const s in n){const o=n[s],a=o.stops;o.gradient==="radial"?(t.open("pattern",{id:mb+s,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+s+")"}).close(),t.close(),t.open("radialGradient",{id:s,fx:o.x1,fy:o.y1,fr:o.r1,cx:o.x2,cy:o.y2,r:o.r2})):t.open("linearGradient",{id:s,x1:o.x1,x2:o.x2,y1:o.y1,y2:o.y2});for(let l=0;l<a.length;++l)t.open("stop",{offset:a[l].offset,"stop-color":a[l].color}).close();t.close()}for(const s in i){const o=i[s];t.open("clipPath",{id:s}),o.path?t.open("path",{d:o.path}).close():t.open("rect",{x:0,y:0,width:o.width,height:o.height}).close(),t.close()}t.close()}}}function awe(e,t,n,i,r){let s;if(t==null||(i==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),i==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;i==="image"&&t.smooth===!1&&(s=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),i==="text"&&(e["font-family"]=N0(t),e["font-size"]=Da(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const o in Ab){let a=t[o];const l=Ab[o];a==="transparent"&&(l==="fill"||l==="stroke")||a!=null&&(GI(a)&&(a=O9(a,r.gradient,"")),e[l]=a)}for(const o in Db){const a=t[o];a!=null&&(s=s||[],s.push(`${Db[o]}: ${a};`))}return s&&(e.style=s.join(" ")),e}const to={svgMarkTypes:["text"],svgOnTop:!0,debug:!1};function lwe(e){to.svgMarkTypes=e.svgMarkTypes??["text"],to.svgOnTop=e.svgOnTop??!0,to.debug=e.debug??!1}class FP extends $0{constructor(t){super(t),this._svgRenderer=new h2(t),this._canvasRenderer=new Fb(t)}initialize(t,n,i,r,s){this._root_el=Nn(t,0,"div");const o=Nn(this._root_el,0,"div"),a=Nn(this._root_el,1,"div");return this._root_el.style.position="relative",to.debug||(o.style.height="100%",a.style.position="absolute",a.style.top="0",a.style.left="0",a.style.height="100%",a.style.width="100%"),this._svgEl=to.svgOnTop?a:o,this._canvasEl=to.svgOnTop?o:a,this._svgEl.style.pointerEvents="none",this._canvasRenderer.initialize(this._canvasEl,n,i,r,s),this._svgRenderer.initialize(this._svgEl,n,i,r,s),super.initialize(t,n,i,r,s)}dirty(t){return to.svgMarkTypes.includes(t.mark.marktype)?this._svgRenderer.dirty(t):this._canvasRenderer.dirty(t),this}_render(t,n){const r=(n??["arc","area","image","line","path","rect","rule","shape","symbol","text","trail"]).filter(s=>!to.svgMarkTypes.includes(s));this._svgRenderer.render(t,to.svgMarkTypes),this._canvasRenderer.render(t,r)}resize(t,n,i,r){return super.resize(t,n,i,r),this._svgRenderer.resize(t,n,i,r),this._canvasRenderer.resize(t,n,i,r),this}background(t){return to.svgOnTop?this._canvasRenderer.background(t):this._svgRenderer.background(t),this}}class A7 extends B0{constructor(t,n){super(t,n)}initialize(t,n,i){const r=Nn(Nn(t,0,"div"),to.svgOnTop?0:1,"div");return super.initialize(r,n,i)}}const D7="canvas",P7="hybrid",k7="png",T7="svg",M7="none",Du={Canvas:D7,PNG:k7,SVG:T7,Hybrid:P7,None:M7},Id={};Id[D7]=Id[k7]={renderer:Fb,headless:Fb,handler:B0};Id[T7]={renderer:h2,headless:F7,handler:p7};Id[P7]={renderer:FP,headless:FP,handler:A7};Id[M7]={};function Z1(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(Id[e]=t,this):Id[e]}function I7(e,t,n){const i=[],r=new Mn().union(t),s=e.marktype;return s?_7(e,r,n,i):s==="group"?O7(e,r,n,i):Z("Intersect scene must be mark node or group item.")}function _7(e,t,n,i){if(uwe(e,t,n)){const r=e.items,s=e.marktype,o=r.length;let a=0;if(s==="group")for(;a<o;++a)O7(r[a],t,n,i);else for(const l=ts[s].isect;a<o;++a){const u=r[a];L7(u,t,l)&&i.push(u)}}return i}function uwe(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function O7(e,t,n,i){n&&n(e.mark)&&L7(e,t,ts.group.isect)&&i.push(e);const r=e.items,s=r&&r.length;if(s){const o=e.x||0,a=e.y||0;t.translate(-o,-a);for(let l=0;l<s;++l)_7(r[l],t,n,i);t.translate(o,a)}return i}function L7(e,t,n){const i=e.bounds;return t.encloses(i)||t.intersects(i)&&n(e,t)}const OF=new Mn;function N7(e){const t=e.clip;if(nt(t))t(_0(OF.clear()));else if(t)OF.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(OF)}const cwe=1e-9;function f2(e,t,n){return e===t?!0:n==="path"?$7(e,t):e instanceof Date&&t instanceof Date?+e==+t:xt(e)&&xt(t)?Math.abs(e-t)<=cwe:!e||!t||!ye(e)&&!ye(t)?e==t:dwe(e,t)}function $7(e,t){return f2(Xf(e),Xf(t))}function dwe(e,t){var n=Object.keys(e),i=Object.keys(t),r,s;if(n.length!==i.length)return!1;for(n.sort(),i.sort(),s=n.length-1;s>=0;s--)if(n[s]!=i[s])return!1;for(s=n.length-1;s>=0;s--)if(r=n[s],!f2(e[r],t[r],r))return!1;return typeof e==typeof t}function hwe(){H9(),L0e()}const Zf="top",ao="left",lo="right",Qu="bottom",fwe="top-left",pwe="top-right",gwe="bottom-left",mwe="bottom-right",p2="start",AP="middle",ji="end",vwe="x",Cwe="y",ex="group",g2="axis",m2="title",ywe="frame",wwe="scope",v2="legend",B7="row-header",G7="row-footer",z7="row-title",H7="column-header",V7="column-footer",W7="column-title",bwe="padding",Swe="symbol",U7="fit",j7="fit-x",q7="fit-y",xwe="pad",C2="none",Ry="all",DP="each",y2="flush",Pu="column",ku="row";function K7(e){Y.call(this,null,e)}pe(K7,Y,{transform(e,t){const n=t.dataflow,i=e.mark,r=i.marktype,s=ts[r],o=s.bound;let a=i.bounds,l;if(s.nested)i.items.length&&n.dirty(i.items[0]),a=Ey(i,o),i.items.forEach(u=>{u.bounds.clear().union(a)});else if(r===ex||e.modified())switch(t.visit(t.MOD,u=>n.dirty(u)),a.clear(),i.items.forEach(u=>a.union(Ey(u,o))),i.role){case g2:case v2:case m2:t.reflow()}else l=t.changed(t.REM),t.visit(t.ADD,u=>{a.union(Ey(u,o))}),t.visit(t.MOD,u=>{l=l||a.alignsWith(u.bounds),n.dirty(u),a.union(Ey(u,o))}),l&&(a.clear(),i.items.forEach(u=>a.union(u.bounds)));return N7(i),t.modifies("bounds")}});function Ey(e,t,n){return t(e.bounds.clear(),e,n)}const J3=":vega_identifier:";function w2(e){Y.call(this,0,e)}w2.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};pe(w2,Y,{transform(e,t){const n=Rwe(t.dataflow),i=e.as;let r=n.value;return t.visit(t.ADD,s=>s[i]=s[i]||++r),n.set(this.value=r),t}});function Rwe(e){return e._signals[J3]||(e._signals[J3]=e.add(0))}function Y7(e){Y.call(this,null,e)}pe(Y7,Y,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,Ewe(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const i=n.marktype===ex?U1:W1;return t.visit(t.ADD,r=>i.call(r,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function Ewe(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function X7(e){Y.call(this,null,e)}const Z3={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((i,r)=>!r||!Q7(n.bounds,i.bounds,t)?(n=i,1):i.opacity=0)}},Q7=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),ez=(e,t)=>{for(var n=1,i=e.length,r=e[0].bounds,s;n<i;r=s,++n)if(Q7(r,s=e[n].bounds,t))return!0},Fwe=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},Awe=(e,t,n)=>{var i=e.range(),r=new Mn;return t===Zf||t===Qu?r.set(i[0],-1/0,i[1],1/0):r.set(-1/0,i[0],1/0,i[1]),r.expand(n||1),s=>r.encloses(s.bounds)},tz=e=>(e.forEach(t=>t.opacity=1),e),nz=(e,t)=>e.reflow(t.modified()).modifies("opacity");pe(X7,Y,{transform(e,t){const n=Z3[e.method]||Z3.parity,i=e.separation||0;let r=t.materialize(t.SOURCE).source,s,o;if(!r||!r.length)return;if(!e.method)return e.modified("method")&&(tz(r),t=nz(t,e)),t;if(r=r.filter(Fwe),!r.length)return;if(e.sort&&(r=r.slice().sort(e.sort)),s=tz(r),t=nz(t,e),s.length>=3&&ez(s,i)){do s=n(s,i);while(s.length>=3&&ez(s,i));s.length<3&&!gt(r).opacity&&(s.length>1&&(gt(s).opacity=0),gt(r).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(o=Awe(e.boundScale,e.boundOrient,+e.boundTolerance),r.forEach(l=>{o(l)||(l.opacity=0)}));const a=s[0].mark.bounds.clear();return r.forEach(l=>{l.opacity&&a.union(l.bounds)}),t}});function J7(e){Y.call(this,null,e)}pe(J7,Y,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,i=>n.dirty(i)),t.fields&&t.fields.zindex){const i=t.source&&t.source[0];i&&(i.mark.zdirty=!0)}}});const Ri=new Mn;function df(e,t,n){return e[t]===n?0:(e[t]=n,1)}function Dwe(e){var t=e.items[0].orient;return t===ao||t===lo}function Pwe(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function kwe(e,t,n,i){var r=t.items[0],s=r.datum,o=r.translate!=null?r.translate:.5,a=r.orient,l=Pwe(s),u=r.range,c=r.offset,d=r.position,h=r.minExtent,p=r.maxExtent,g=s.title&&r.items[l[2]].items[0],v=r.titlePadding,C=r.bounds,y=g&&n2(g),b=0,S=0,x,E;switch(Ri.clear().union(C),C.clear(),(x=l[0])>-1&&C.union(r.items[x].bounds),(x=l[1])>-1&&C.union(r.items[x].bounds),a){case Zf:b=d||0,S=-c,E=Math.max(h,Math.min(p,-C.y1)),C.add(0,-E).add(u,0),g&&Fy(e,g,E,v,y,0,-1,C);break;case ao:b=-c,S=d||0,E=Math.max(h,Math.min(p,-C.x1)),C.add(-E,0).add(0,u),g&&Fy(e,g,E,v,y,1,-1,C);break;case lo:b=n+c,S=d||0,E=Math.max(h,Math.min(p,C.x2)),C.add(0,0).add(E,u),g&&Fy(e,g,E,v,y,1,1,C);break;case Qu:b=d||0,S=i+c,E=Math.max(h,Math.min(p,C.y2)),C.add(0,0).add(u,E),g&&Fy(e,g,E,v,0,0,1,C);break;default:b=r.x,S=r.y}return Vl(C.translate(b,S),r),df(r,"x",b+o)|df(r,"y",S+o)&&(r.bounds=Ri,e.dirty(r),r.bounds=C,e.dirty(r)),r.mark.bounds.clear().union(C)}function Fy(e,t,n,i,r,s,o,a){const l=t.bounds;if(t.auto){const u=o*(n+r+i);let c=0,d=0;e.dirty(t),s?c=(t.x||0)-(t.x=u):d=(t.y||0)-(t.y=u),t.mark.bounds.clear().union(l.translate(-c,-d)),e.dirty(t)}a.union(l)}const iz=(e,t)=>Math.floor(Math.min(e,t)),rz=(e,t)=>Math.ceil(Math.max(e,t));function Twe(e){var t=e.items,n=t.length,i=0,r,s;const o={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;i<n;++i)if(r=t[i],s=r.items,r.marktype===ex)switch(r.role){case g2:case v2:case m2:break;case B7:o.rowheaders.push(...s);break;case G7:o.rowfooters.push(...s);break;case H7:o.colheaders.push(...s);break;case V7:o.colfooters.push(...s);break;case z7:o.rowtitle=s[0];break;case W7:o.coltitle=s[0];break;default:o.marks.push(...s)}return o}function Mwe(e){return new Mn().set(0,0,e.width||0,e.height||0)}function Iwe(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function Jt(e,t,n){const i=ye(e)?e[t]:e;return i??(n!==void 0?n:0)}function sz(e){return e<0?Math.ceil(-e):0}function Z7(e,t,n){var i=!n.nodirty,r=n.bounds===y2?Mwe:Iwe,s=Ri.set(0,0,0,0),o=Jt(n.align,Pu),a=Jt(n.align,ku),l=Jt(n.padding,Pu),u=Jt(n.padding,ku),c=n.columns||t.length,d=c<=0?1:Math.ceil(t.length/c),h=t.length,p=Array(h),g=Array(c),v=0,C=Array(h),y=Array(d),b=0,S=Array(h),x=Array(h),E=Array(h),A,F,k,P,_,O,H,W,$,L,G;for(F=0;F<c;++F)g[F]=0;for(F=0;F<d;++F)y[F]=0;for(F=0;F<h;++F)O=t[F],_=E[F]=r(O),O.x=O.x||0,S[F]=0,O.y=O.y||0,x[F]=0,k=F%c,P=~~(F/c),v=Math.max(v,H=Math.ceil(_.x2)),b=Math.max(b,W=Math.ceil(_.y2)),g[k]=Math.max(g[k],H),y[P]=Math.max(y[P],W),p[F]=l+sz(_.x1),C[F]=u+sz(_.y1),i&&e.dirty(t[F]);for(F=0;F<h;++F)F%c===0&&(p[F]=0),F<c&&(C[F]=0);if(o===DP)for(k=1;k<c;++k){for(G=0,F=k;F<h;F+=c)G<p[F]&&(G=p[F]);for(F=k;F<h;F+=c)p[F]=G+g[k-1]}else if(o===Ry){for(G=0,F=0;F<h;++F)F%c&&G<p[F]&&(G=p[F]);for(F=0;F<h;++F)F%c&&(p[F]=G+v)}else for(o=!1,k=1;k<c;++k)for(F=k;F<h;F+=c)p[F]+=g[k-1];if(a===DP)for(P=1;P<d;++P){for(G=0,F=P*c,A=F+c;F<A;++F)G<C[F]&&(G=C[F]);for(F=P*c;F<A;++F)C[F]=G+y[P-1]}else if(a===Ry){for(G=0,F=c;F<h;++F)G<C[F]&&(G=C[F]);for(F=c;F<h;++F)C[F]=G+b}else for(a=!1,P=1;P<d;++P)for(F=P*c,A=F+c;F<A;++F)C[F]+=y[P-1];for($=0,F=0;F<h;++F)$=p[F]+(F%c?$:0),S[F]+=$-t[F].x;for(k=0;k<c;++k)for(L=0,F=k;F<h;F+=c)L+=C[F],x[F]+=L-t[F].y;if(o&&Jt(n.center,Pu)&&d>1)for(F=0;F<h;++F)_=o===Ry?v:g[F%c],$=_-E[F].x2-t[F].x-S[F],$>0&&(S[F]+=$/2);if(a&&Jt(n.center,ku)&&c!==1)for(F=0;F<h;++F)_=a===Ry?b:y[~~(F/c)],L=_-E[F].y2-t[F].y-x[F],L>0&&(x[F]+=L/2);for(F=0;F<h;++F)s.union(E[F].translate(S[F],x[F]));switch($=Jt(n.anchor,vwe),L=Jt(n.anchor,Cwe),Jt(n.anchor,Pu)){case ji:$-=s.width();break;case AP:$-=s.width()/2}switch(Jt(n.anchor,ku)){case ji:L-=s.height();break;case AP:L-=s.height()/2}for($=Math.round($),L=Math.round(L),s.clear(),F=0;F<h;++F)t[F].mark.bounds.clear();for(F=0;F<h;++F)O=t[F],O.x+=S[F]+=$,O.y+=x[F]+=L,s.union(O.mark.bounds.union(O.bounds.translate(S[F],x[F]))),i&&e.dirty(O);return s}function _we(e,t,n){var i=Twe(t),r=i.marks,s=n.bounds===y2?Owe:Lwe,o=n.offset,a=n.columns||r.length,l=a<=0?1:Math.ceil(r.length/a),u=l*a,c,d,h,p,g,v,C;const y=Z7(e,r,n);y.empty()&&y.set(0,0,0,0),i.rowheaders&&(v=Jt(n.headerBand,ku,null),c=Ay(e,i.rowheaders,r,a,l,-Jt(o,"rowHeader"),iz,0,s,"x1",0,a,1,v)),i.colheaders&&(v=Jt(n.headerBand,Pu,null),d=Ay(e,i.colheaders,r,a,a,-Jt(o,"columnHeader"),iz,1,s,"y1",0,1,a,v)),i.rowfooters&&(v=Jt(n.footerBand,ku,null),h=Ay(e,i.rowfooters,r,a,l,Jt(o,"rowFooter"),rz,0,s,"x2",a-1,a,1,v)),i.colfooters&&(v=Jt(n.footerBand,Pu,null),p=Ay(e,i.colfooters,r,a,a,Jt(o,"columnFooter"),rz,1,s,"y2",u-a,1,a,v)),i.rowtitle&&(g=Jt(n.titleAnchor,ku),C=Jt(o,"rowTitle"),C=g===ji?h+C:c-C,v=Jt(n.titleBand,ku,.5),oz(e,i.rowtitle,C,0,y,v)),i.coltitle&&(g=Jt(n.titleAnchor,Pu),C=Jt(o,"columnTitle"),C=g===ji?p+C:d-C,v=Jt(n.titleBand,Pu,.5),oz(e,i.coltitle,C,1,y,v))}function Owe(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function Lwe(e,t){return e.bounds[t]}function Ay(e,t,n,i,r,s,o,a,l,u,c,d,h,p){var g=n.length,v=0,C=0,y,b,S,x,E,A,F,k,P;if(!g)return v;for(y=c;y<g;y+=d)n[y]&&(v=o(v,l(n[y],u)));if(!t.length)return v;for(t.length>r&&(e.warn("Grid headers exceed limit: "+r),t=t.slice(0,r)),v+=s,b=0,x=t.length;b<x;++b)e.dirty(t[b]),t[b].mark.bounds.clear();for(y=c,b=0,x=t.length;b<x;++b,y+=d){for(A=t[b],E=A.mark.bounds,S=y;S>=0&&(F=n[S])==null;S-=h);a?(k=p==null?F.x:Math.round(F.bounds.x1+p*F.bounds.width()),P=v):(k=v,P=p==null?F.y:Math.round(F.bounds.y1+p*F.bounds.height())),E.union(A.bounds.translate(k-(A.x||0),P-(A.y||0))),A.x=k,A.y=P,e.dirty(A),C=o(C,E[u])}return C}function oz(e,t,n,i,r,s){if(t){e.dirty(t);var o=n,a=n;i?o=Math.round(r.x1+s*r.width()):a=Math.round(r.y1+s*r.height()),t.bounds.translate(o-(t.x||0),a-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=o,t.y=a,e.dirty(t)}}function Nwe(e,t){const n=e[t]||{};return(i,r)=>n[i]!=null?n[i]:e[i]!=null?e[i]:r}function $we(e,t){let n=-1/0;return e.forEach(i=>{i.offset!=null&&(n=Math.max(n,i.offset))}),n>-1/0?n:t}function Bwe(e,t,n,i,r,s,o){const a=Nwe(n,t),l=$we(e,a("offset",0)),u=a("anchor",p2),c=u===ji?1:u===AP?.5:0,d={align:DP,bounds:a("bounds",y2),columns:a("direction")==="vertical"?1:e.length,padding:a("margin",8),center:a("center"),nodirty:!0};switch(t){case ao:d.anchor={x:Math.floor(i.x1)-l,column:ji,y:c*(o||i.height()+2*i.y1),row:u};break;case lo:d.anchor={x:Math.ceil(i.x2)+l,y:c*(o||i.height()+2*i.y1),row:u};break;case Zf:d.anchor={y:Math.floor(r.y1)-l,row:ji,x:c*(s||r.width()+2*r.x1),column:u};break;case Qu:d.anchor={y:Math.ceil(r.y2)+l,x:c*(s||r.width()+2*r.x1),column:u};break;case fwe:d.anchor={x:l,y:l};break;case pwe:d.anchor={x:s-l,y:l,column:ji};break;case gwe:d.anchor={x:l,y:o-l,row:ji};break;case mwe:d.anchor={x:s-l,y:o-l,column:ji,row:ji};break}return d}function Gwe(e,t){var n=t.items[0],i=n.datum,r=n.orient,s=n.bounds,o=n.x,a=n.y,l,u;return n._bounds?n._bounds.clear().union(s):n._bounds=s.clone(),s.clear(),Hwe(e,n,n.items[0].items[0]),s=zwe(n,s),l=2*n.padding,u=2*n.padding,s.empty()||(l=Math.ceil(s.width()+l),u=Math.ceil(s.height()+u)),i.type===Swe&&Vwe(n.items[0].items[0].items[0].items),r!==C2&&(n.x=o=0,n.y=a=0),n.width=l,n.height=u,Vl(s.set(o,a,o+l,a+u),n),n.mark.bounds.clear().union(s),n}function zwe(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function Hwe(e,t,n){var i=t.padding,r=i-n.x,s=i-n.y;if(!t.datum.title)(r||s)&&Xg(e,n,r,s);else{var o=t.items[1].items[0],a=o.anchor,l=t.titlePadding||0,u=i-o.x,c=i-o.y;switch(o.orient){case ao:r+=Math.ceil(o.bounds.width())+l;break;case lo:case Qu:break;default:s+=o.bounds.height()+l}switch((r||s)&&Xg(e,n,r,s),o.orient){case ao:c+=Wh(t,n,o,a,1,1);break;case lo:u+=Wh(t,n,o,ji,0,0)+l,c+=Wh(t,n,o,a,1,1);break;case Qu:u+=Wh(t,n,o,a,0,0),c+=Wh(t,n,o,ji,-1,0,1)+l;break;default:u+=Wh(t,n,o,a,0,0)}(u||c)&&Xg(e,o,u,c),(u=Math.round(o.bounds.x1-i))<0&&(Xg(e,n,-u,0),Xg(e,o,-u,0))}}function Wh(e,t,n,i,r,s,o){const a=e.datum.type!=="symbol",l=n.datum.vgrad,u=a&&(s||!l)&&!o?t.items[0]:t,c=u.bounds[r?"y2":"x2"]-e.padding,d=l&&s?c:0,h=l&&s?0:c,p=r<=0?0:n2(n);return Math.round(i===p2?d:i===ji?h-p:.5*(c-p))}function Xg(e,t,n,i){t.x+=n,t.y+=i,t.bounds.translate(n,i),t.mark.bounds.translate(n,i),e.dirty(t)}function Vwe(e){const t=e.reduce((n,i)=>(n[i.column]=Math.max(i.bounds.x2-i.x,n[i.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function Wwe(e,t,n,i,r){var s=t.items[0],o=s.frame,a=s.orient,l=s.anchor,u=s.offset,c=s.padding,d=s.items[0].items[0],h=s.items[1]&&s.items[1].items[0],p=a===ao||a===lo?i:n,g=0,v=0,C=0,y=0,b=0,S;if(o!==ex?a===ao?(g=r.y2,p=r.y1):a===lo?(g=r.y1,p=r.y2):(g=r.x1,p=r.x2):a===ao&&(g=i,p=0),S=l===p2?g:l===ji?p:(g+p)/2,h&&h.text){switch(a){case Zf:case Qu:b=d.bounds.height()+c;break;case ao:y=d.bounds.width()+c;break;case lo:y=-d.bounds.width()-c;break}Ri.clear().union(h.bounds),Ri.translate(y-(h.x||0),b-(h.y||0)),df(h,"x",y)|df(h,"y",b)&&(e.dirty(h),h.bounds.clear().union(Ri),h.mark.bounds.clear().union(Ri),e.dirty(h)),Ri.clear().union(h.bounds)}else Ri.clear();switch(Ri.union(d.bounds),a){case Zf:v=S,C=r.y1-Ri.height()-u;break;case ao:v=r.x1-Ri.width()-u,C=S;break;case lo:v=r.x2+Ri.width()+u,C=S;break;case Qu:v=S,C=r.y2+u;break;default:v=s.x,C=s.y}return df(s,"x",v)|df(s,"y",C)&&(Ri.translate(v,C),e.dirty(s),s.bounds.clear().union(Ri),t.bounds.clear().union(Ri),e.dirty(s)),s.bounds}function ej(e){Y.call(this,null,e)}pe(ej,Y,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(i=>{e.layout&&_we(n,i,e.layout),jwe(n,i,e)}),Uwe(e.mark.group)?t.reflow():t}});function Uwe(e){return e&&e.mark.role!=="legend-entry"}function jwe(e,t,n){var i=t.items,r=Math.max(0,t.width||0),s=Math.max(0,t.height||0),o=new Mn().set(0,0,r,s),a=o.clone(),l=o.clone(),u=[],c,d,h,p,g,v;for(g=0,v=i.length;g<v;++g)switch(d=i[g],d.role){case g2:p=Dwe(d)?a:l,p.union(kwe(e,d,r,s));break;case m2:c=d;break;case v2:u.push(Gwe(e,d));break;case ywe:case wwe:case B7:case G7:case z7:case H7:case V7:case W7:a.union(d.bounds),l.union(d.bounds);break;default:o.union(d.bounds)}if(u.length){const C={};u.forEach(y=>{h=y.orient||lo,h!==C2&&(C[h]||(C[h]=[])).push(y)});for(const y in C){const b=C[y];Z7(e,b,Bwe(b,y,n.legends,a,l,r,s))}u.forEach(y=>{const b=y.bounds;if(b.equals(y._bounds)||(y.bounds=y._bounds,e.dirty(y),y.bounds=b,e.dirty(y)),n.autosize&&(n.autosize.type===U7||n.autosize.type===j7||n.autosize.type===q7))switch(y.orient){case ao:case lo:o.add(b.x1,0).add(b.x2,0);break;case Zf:case Qu:o.add(0,b.y1).add(0,b.y2)}else o.union(b)})}o.union(a).union(l),c&&o.union(Wwe(e,c,r,s,o)),t.clip&&o.set(0,0,t.width||0,t.height||0),qwe(e,t,o,n)}function qwe(e,t,n,i){const r=i.autosize||{},s=r.type;if(e._autosize<1||!s)return;let o=e._width,a=e._height,l=Math.max(0,t.width||0),u=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),d=Math.max(0,Math.ceil(-n.y1));const h=Math.max(0,Math.ceil(n.x2-l)),p=Math.max(0,Math.ceil(n.y2-c));if(r.contains===bwe){const g=e.padding();o-=g.left+g.right,a-=g.top+g.bottom}s===C2?(u=0,d=0,l=o,c=a):s===U7?(l=Math.max(0,o-u-h),c=Math.max(0,a-d-p)):s===j7?(l=Math.max(0,o-u-h),a=c+d+p):s===q7?(o=l+u+h,c=Math.max(0,a-d-p)):s===xwe&&(o=l+u+h,a=c+d+p),e._resizeView(o,a,l,c,[u,d],r.resize)}const Kwe=Object.freeze(Object.defineProperty({__proto__:null,bound:K7,identifier:w2,mark:Y7,overlap:X7,render:J7,viewlayout:ej},Symbol.toStringTag,{value:"Module"}));function tj(e){Y.call(this,null,e)}pe(tj,Y,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,s=e.scale,o=e.count==null?e.values?e.values.length:10:e.count,a=$I(s,o,e.minstep),l=e.format||D9(n,s,a,e.formatSpecifier,e.formatType,!!e.values),u=e.values?A9(s,e.values,a):BI(s,a);return r&&(i.rem=r),r=u.map((c,d)=>Dt({index:d/(u.length-1||1),value:c,label:l(c)})),e.extra&&r.length&&r.push(Dt({index:-1,extra:{value:r[0].value},label:""})),i.source=r,i.add=r,this.value=r,i}});function nj(e){Y.call(this,null,e)}function Ywe(){return Dt({})}function Xwe(e){const t=Op().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}pe(nj,Y,{transform(e,t){var n=t.dataflow,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.item||Ywe,s=e.key||_e,o=this.value;return te(i.encode)&&(i.encode=null),o&&(e.modified("key")||t.modified(s))&&Z("DataJoin does not support modified key function or fields."),o||(t=t.addAll(),this.value=o=Xwe(s)),t.visit(t.ADD,a=>{const l=s(a);let u=o.get(l);u?u.exit?(o.empty--,i.add.push(u)):i.mod.push(u):(u=r(a),o.set(l,u),i.add.push(u)),u.datum=a,u.exit=!1}),t.visit(t.MOD,a=>{const l=s(a),u=o.get(l);u&&(u.datum=a,i.mod.push(u))}),t.visit(t.REM,a=>{const l=s(a),u=o.get(l);a===u.datum&&!u.exit&&(i.rem.push(u),u.exit=!0,++o.empty)}),t.changed(t.ADD_MOD)&&i.modifies("datum"),(t.clean()||e.clean&&o.empty>n.cleanThreshold)&&n.runAfter(o.clean),i}});function ij(e){Y.call(this,null,e)}pe(ij,Y,{transform(e,t){var n=t.fork(t.ADD_REM),i=e.mod||!1,r=e.encoders,s=t.encode;if(te(s))if(n.changed()||s.every(d=>r[d]))s=s[0],n.encode=null;else return t.StopPropagation;var o=s==="enter",a=r.update||fu,l=r.enter||fu,u=r.exit||fu,c=(s&&!o?r[s]:a)||fu;if(t.changed(t.ADD)&&(t.visit(t.ADD,d=>{l(d,e),a(d,e)}),n.modifies(l.output),n.modifies(a.output),c!==fu&&c!==a&&(t.visit(t.ADD,d=>{c(d,e)}),n.modifies(c.output))),t.changed(t.REM)&&u!==fu&&(t.visit(t.REM,d=>{u(d,e)}),n.modifies(u.output)),o||c!==fu){const d=t.MOD|(e.modified()?t.REFLOW:0);o?(t.visit(d,h=>{const p=l(h,e)||i;(c(h,e)||p)&&n.mod.push(h)}),n.mod.length&&n.modifies(l.output)):t.visit(d,h=>{(c(h,e)||i)&&n.mod.push(h)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});function rj(e){Y.call(this,[],e)}pe(rj,Y,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,s=e.type||yw,o=e.scale,a=+e.limit,l=$I(o,e.count==null?5:e.count,e.minstep),u=!!e.values||s===yw,c=e.format||M9(n,o,l,s,e.formatSpecifier,e.formatType,u),d=e.values||T9(o,l),h,p,g,v,C;return r&&(i.rem=r),s===yw?(a&&d.length>a?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),r=d.slice(0,a-1),C=!0):r=d,nt(g=e.size)?(!e.values&&o(r[0])===0&&(r=r.slice(1)),v=r.reduce((y,b)=>Math.max(y,g(b,e)),0)):g=Oi(v=g||8),r=r.map((y,b)=>Dt({index:b,label:c(y,b,r),value:y,offset:v,size:g(y,e)})),C&&(C=d[r.length],r.push(Dt({index:r.length,label:`…${d.length-r.length} entries`,value:C,offset:v,size:g(C,e)})))):s===x0e?(h=o.domain(),p=R9(o,h[0],gt(h)),d.length<3&&!e.values&&h[0]!==gt(h)&&(d=[h[0],gt(h)]),r=d.map((y,b)=>Dt({index:b,label:c(y,b,d),value:y,perc:p(y)}))):(g=d.length-1,p=_0e(o),r=d.map((y,b)=>Dt({index:b,label:c(y,b,d),value:y,perc:b?p(y):0,perc2:b===g?1:p(d[b+1])}))),i.source=r,i.add=r,this.value=r,i}});const Qwe=e=>e.source.x,Jwe=e=>e.source.y,Zwe=e=>e.target.x,ebe=e=>e.target.y;function b2(e){Y.call(this,{},e)}b2.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};pe(b2,Y,{transform(e,t){var n=e.sourceX||Qwe,i=e.sourceY||Jwe,r=e.targetX||Zwe,s=e.targetY||ebe,o=e.as||"path",a=e.orient||"vertical",l=e.shape||"line",u=az.get(l+"-"+a)||az.get(l);return u||Z("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[o]=u(n(c),i(c),r(c),s(c))}),t.reflow(e.modified()).modifies(o)}});const sj=(e,t,n,i)=>"M"+e+","+t+"L"+n+","+i,tbe=(e,t,n,i)=>sj(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),oj=(e,t,n,i)=>{var r=n-e,s=i-t,o=Math.hypot(r,s)/2,a=180*Math.atan2(s,r)/Math.PI;return"M"+e+","+t+"A"+o+","+o+" "+a+" 0 1 "+n+","+i},nbe=(e,t,n,i)=>oj(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),aj=(e,t,n,i)=>{const r=n-e,s=i-t,o=.2*(r+s),a=.2*(s-r);return"M"+e+","+t+"C"+(e+o)+","+(t+a)+" "+(n+a)+","+(i-o)+" "+n+","+i},ibe=(e,t,n,i)=>aj(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),rbe=(e,t,n,i)=>"M"+e+","+t+"V"+i+"H"+n,sbe=(e,t,n,i)=>"M"+e+","+t+"H"+n+"V"+i,obe=(e,t,n,i)=>{const r=Math.cos(e),s=Math.sin(e),o=Math.cos(n),a=Math.sin(n),l=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*r+","+t*s+"A"+t+","+t+" 0 0,"+(l?1:0)+" "+t*o+","+t*a+"L"+i*o+","+i*a},abe=(e,t,n,i)=>{const r=(e+n)/2;return"M"+e+","+t+"C"+r+","+t+" "+r+","+i+" "+n+","+i},lbe=(e,t,n,i)=>{const r=(t+i)/2;return"M"+e+","+t+"C"+e+","+r+" "+n+","+r+" "+n+","+i},ube=(e,t,n,i)=>{const r=Math.cos(e),s=Math.sin(e),o=Math.cos(n),a=Math.sin(n),l=(t+i)/2;return"M"+t*r+","+t*s+"C"+l*r+","+l*s+" "+l*o+","+l*a+" "+i*o+","+i*a},az=Op({line:sj,"line-radial":tbe,arc:oj,"arc-radial":nbe,curve:aj,"curve-radial":ibe,"orthogonal-horizontal":rbe,"orthogonal-vertical":sbe,"orthogonal-radial":obe,"diagonal-horizontal":abe,"diagonal-vertical":lbe,"diagonal-radial":ube});function S2(e){Y.call(this,null,e)}S2.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};pe(S2,Y,{transform(e,t){var n=e.as||["startAngle","endAngle"],i=n[0],r=n[1],s=e.field||Tp,o=e.startAngle||0,a=e.endAngle!=null?e.endAngle:2*Math.PI,l=t.source,u=l.map(s),c=u.length,d=o,h=(a-o)/w4(u),p=Sr(c),g,v,C;for(e.sort&&p.sort((y,b)=>u[y]-u[b]),g=0;g<c;++g)C=u[p[g]],v=l[p[g]],v[i]=d,v[r]=d+=C*h;return this.value=u,t.reflow(e.modified()).modifies(n)}});const cbe=5;function dbe(e){const t=e.type;return!e.bins&&(t===qf||t===A0||t===D0)}function lj(e){return OI(e)&&e!==da}const hbe=Co(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function uj(e){Y.call(this,null,e),this.modified(!0)}pe(uj,Y,{transform(e,t){var n=t.dataflow,i=this.value,r=fbe(e);(!i||r!==i.type)&&(this.value=i=Et(r)());for(r in e)if(!hbe[r]){if(r==="padding"&&lj(i.type))continue;nt(i[r])?i[r](e[r]):n.warn("Unsupported scale property: "+r)}return ybe(i,e,Cbe(i,e,gbe(i,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function fbe(e){var t=e.type,n="",i;return t===da?da+"-"+qf:(pbe(e)&&(i=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=i===2?da+"-":i===3?Vp+"-":""),(n+t||qf).toLowerCase())}function pbe(e){const t=e.type;return OI(t)&&t!==Td&&t!==Md&&(e.scheme||e.range&&e.range.length&&e.range.every(be))}function gbe(e,t,n){const i=mbe(e,t.domainRaw,n);if(i>-1)return i;var r=t.domain,s=e.type,o=t.zero||t.zero===void 0&&dbe(e),a,l;if(!r)return 0;if((o||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(a=(r=r.slice()).length-1||1,o&&(r[0]>0&&(r[0]=0),r[a]<0&&(r[a]=0)),t.domainMin!=null&&(r[0]=t.domainMin),t.domainMax!=null&&(r[a]=t.domainMax),t.domainMid!=null)){l=t.domainMid;const u=l>r[a]?a+1:l<r[0]?0:a;u!==a&&n.warn("Scale domainMid exceeds domain min or max.",l),r.splice(u,0,l)}return lj(s)&&t.padding&&r[0]!==gt(r)&&(r=vbe(s,r,t.range,t.padding,t.exponent,t.constant)),e.domain(cj(s,r,n)),s===TI&&e.unknown(t.domainImplicit?oP:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&$I(e,t.nice)||null),r.length}function mbe(e,t,n){return t?(e.domain(cj(e.type,t,n)),t.length):-1}function vbe(e,t,n,i,r,s){var o=Math.abs(gt(n)-n[0]),a=o/(o-2*i),l=e===Pl?tM(t,null,a):e===D0?Jw(t,null,a,.5):e===A0?Jw(t,null,a,r||1):e===B1?nM(t,null,a,s||1):eM(t,null,a);return t=t.slice(),t[0]=l[0],t[t.length-1]=l[1],t}function cj(e,t,n){if(y9(e)){var i=Math.abs(t.reduce((r,s)=>r+(s<0?-1:s>0?1:0),0));i!==t.length&&n.warn("Log scale domain includes zero: "+he(t))}return t}function Cbe(e,t,n){let i=t.bins;if(i&&!te(i)){const r=e.domain(),s=r[0],o=gt(r),a=i.step;let l=i.start==null?s:i.start,u=i.stop==null?o:i.stop;a||Z("Scale bins parameter missing step property."),l<s&&(l=a*Math.ceil(s/a)),u>o&&(u=a*Math.floor(o/a)),i=Sr(l,u+a/2,a)}return i?e.bins=i:e.bins&&delete e.bins,e.type===MI&&(i?!t.domain&&!t.domainRaw&&(e.domain(i),n=i.length):e.bins=e.domain()),n}function ybe(e,t,n){var i=e.type,r=t.round||!1,s=t.range;if(t.rangeStep!=null)s=wbe(i,t,n);else if(t.scheme&&(s=bbe(i,t,n),nt(s))){if(e.interpolator)return e.interpolator(s);Z(`Scale type ${i} does not support interpolating color schemes.`)}if(s&&w9(i))return e.interpolator(H1(PP(s,t.reverse),t.interpolate,t.interpolateGamma));s&&t.interpolate&&e.interpolate?e.interpolate(LI(t.interpolate,t.interpolateGamma)):nt(e.round)?e.round(r):nt(e.rangeRound)&&e.interpolate(r?E0:fc),s&&e.range(PP(s,t.reverse))}function wbe(e,t,n){e!==f9&&e!==pP&&Z("Only band and point scales support rangeStep.");var i=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,r=e===pP?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*kI(n,r,i)]}function bbe(e,t,n){var i=t.schemeExtent,r,s;return te(t.scheme)?s=H1(t.scheme,t.interpolate,t.interpolateGamma):(r=t.scheme.toLowerCase(),s=NI(r),s||Z(`Unrecognized scheme name: ${t.scheme}`)),n=e===z1?n+1:e===MI?n-1:e===Kf||e===G1?+t.schemeCount||cbe:n,w9(e)?lz(s,i,t.reverse):nt(s)?x9(lz(s,i),n):e===TI?s:s.slice(0,n)}function lz(e,t,n){return nt(e)&&(t||n)?S9(e,PP(t||[0,1],n)):e}function PP(e,t){return t?e.slice().reverse():e}function dj(e){Y.call(this,null,e)}pe(dj,Y,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(ih(e.sort)),this.modified(n),t}});const uz="zero",hj="center",fj="normalize",pj=["y0","y1"];function x2(e){Y.call(this,null,e)}x2.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:uz,values:[uz,hj,fj]},{name:"as",type:"string",array:!0,length:2,default:pj}]};pe(x2,Y,{transform(e,t){var n=e.as||pj,i=n[0],r=n[1],s=ih(e.sort),o=e.field||Tp,a=e.offset===hj?Sbe:e.offset===fj?xbe:Rbe,l,u,c,d;for(l=Ebe(t.source,e.groupby,s,o),u=0,c=l.length,d=l.max;u<c;++u)a(l[u],d,o,i,r);return t.reflow(e.modified()).modifies(n)}});function Sbe(e,t,n,i,r){for(var s=(t-e.sum)/2,o=e.length,a=0,l;a<o;++a)l=e[a],l[i]=s,l[r]=s+=Math.abs(n(l))}function xbe(e,t,n,i,r){for(var s=1/e.sum,o=0,a=e.length,l=0,u=0,c;l<a;++l)c=e[l],c[i]=o,c[r]=o=s*(u+=Math.abs(n(c)))}function Rbe(e,t,n,i,r){for(var s=0,o=0,a=e.length,l=0,u,c;l<a;++l)c=e[l],u=+n(c),u<0?(c[i]=o,c[r]=o+=u):(c[i]=s,c[r]=s+=u)}function Ebe(e,t,n,i){var r=[],s=v=>v(c),o,a,l,u,c,d,h,p,g;if(t==null)r.push(e.slice());else for(o={},a=0,l=e.length;a<l;++a)c=e[a],d=t.map(s),h=o[d],h||(o[d]=h=[],r.push(h)),h.push(c);for(d=0,g=0,u=r.length;d<u;++d){for(h=r[d],a=0,p=0,l=h.length;a<l;++a)p+=Math.abs(i(h[a]));h.sum=p,p>g&&(g=p),n&&h.sort(n)}return r.max=g,r}const Fbe=Object.freeze(Object.defineProperty({__proto__:null,axisticks:tj,datajoin:nj,encode:ij,legendentries:rj,linkpath:b2,pie:S2,scale:uj,sortitems:dj,stack:x2},Symbol.toStringTag,{value:"Module"}));var Be=1e-6,kP=1e-12,ot=Math.PI,vn=ot/2,Pb=ot/4,rr=ot*2,xn=180/ot,st=ot/180,pt=Math.abs,Up=Math.atan,Ls=Math.atan2,Le=Math.cos,Dy=Math.ceil,gj=Math.exp,TP=Math.hypot,kb=Math.log,LF=Math.pow,Oe=Math.sin,xs=Math.sign||function(e){return e>0?1:e<0?-1:0},sr=Math.sqrt,R2=Math.tan;function mj(e){return e>1?0:e<-1?ot:Math.acos(e)}function Pr(e){return e>1?vn:e<-1?-vn:Math.asin(e)}function ci(){}function Tb(e,t){e&&dz.hasOwnProperty(e.type)&&dz[e.type](e,t)}var cz={Feature:function(e,t){Tb(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)Tb(n[i].geometry,t)}},dz={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)e=n[i],t.point(e[0],e[1],e[2])},LineString:function(e,t){MP(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)MP(n[i],t,0)},Polygon:function(e,t){hz(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)hz(n[i],t)},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)Tb(n[i],t)}};function MP(e,t,n){var i=-1,r=e.length-n,s;for(t.lineStart();++i<r;)s=e[i],t.point(s[0],s[1],s[2]);t.lineEnd()}function hz(e,t){var n=-1,i=e.length;for(t.polygonStart();++n<i;)MP(e[n],t,1);t.polygonEnd()}function al(e,t){e&&cz.hasOwnProperty(e.type)?cz[e.type](e,t):Tb(e,t)}var Mb=new tr,Ib=new tr,vj,Cj,IP,_P,OP,wa={point:ci,lineStart:ci,lineEnd:ci,polygonStart:function(){Mb=new tr,wa.lineStart=Abe,wa.lineEnd=Dbe},polygonEnd:function(){var e=+Mb;Ib.add(e<0?rr+e:e),this.lineStart=this.lineEnd=this.point=ci},sphere:function(){Ib.add(rr)}};function Abe(){wa.point=Pbe}function Dbe(){yj(vj,Cj)}function Pbe(e,t){wa.point=yj,vj=e,Cj=t,e*=st,t*=st,IP=e,_P=Le(t=t/2+Pb),OP=Oe(t)}function yj(e,t){e*=st,t*=st,t=t/2+Pb;var n=e-IP,i=n>=0?1:-1,r=i*n,s=Le(t),o=Oe(t),a=OP*o,l=_P*s+a*Le(r),u=a*i*Oe(r);Mb.add(Ls(u,l)),IP=e,_P=s,OP=o}function kbe(e){return Ib=new tr,al(e,wa),Ib*2}function _b(e){return[Ls(e[1],e[0]),Pr(e[2])]}function _d(e){var t=e[0],n=e[1],i=Le(n);return[i*Le(t),i*Oe(t),Oe(n)]}function Py(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function ep(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function NF(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function ky(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Ob(e){var t=sr(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var sn,wr,hn,Vr,Zc,wj,bj,xf,Ym,yu,kl,il={point:LP,lineStart:fz,lineEnd:pz,polygonStart:function(){il.point=xj,il.lineStart=Tbe,il.lineEnd=Mbe,Ym=new tr,wa.polygonStart()},polygonEnd:function(){wa.polygonEnd(),il.point=LP,il.lineStart=fz,il.lineEnd=pz,Mb<0?(sn=-(hn=180),wr=-(Vr=90)):Ym>Be?Vr=90:Ym<-1e-6&&(wr=-90),kl[0]=sn,kl[1]=hn},sphere:function(){sn=-(hn=180),wr=-(Vr=90)}};function LP(e,t){yu.push(kl=[sn=e,hn=e]),t<wr&&(wr=t),t>Vr&&(Vr=t)}function Sj(e,t){var n=_d([e*st,t*st]);if(xf){var i=ep(xf,n),r=[i[1],-i[0],0],s=ep(r,i);Ob(s),s=_b(s);var o=e-Zc,a=o>0?1:-1,l=s[0]*xn*a,u,c=pt(o)>180;c^(a*Zc<l&&l<a*e)?(u=s[1]*xn,u>Vr&&(Vr=u)):(l=(l+360)%360-180,c^(a*Zc<l&&l<a*e)?(u=-s[1]*xn,u<wr&&(wr=u)):(t<wr&&(wr=t),t>Vr&&(Vr=t))),c?e<Zc?Hr(sn,e)>Hr(sn,hn)&&(hn=e):Hr(e,hn)>Hr(sn,hn)&&(sn=e):hn>=sn?(e<sn&&(sn=e),e>hn&&(hn=e)):e>Zc?Hr(sn,e)>Hr(sn,hn)&&(hn=e):Hr(e,hn)>Hr(sn,hn)&&(sn=e)}else yu.push(kl=[sn=e,hn=e]);t<wr&&(wr=t),t>Vr&&(Vr=t),xf=n,Zc=e}function fz(){il.point=Sj}function pz(){kl[0]=sn,kl[1]=hn,il.point=LP,xf=null}function xj(e,t){if(xf){var n=e-Zc;Ym.add(pt(n)>180?n+(n>0?360:-360):n)}else wj=e,bj=t;wa.point(e,t),Sj(e,t)}function Tbe(){wa.lineStart()}function Mbe(){xj(wj,bj),wa.lineEnd(),pt(Ym)>Be&&(sn=-(hn=180)),kl[0]=sn,kl[1]=hn,xf=null}function Hr(e,t){return(t-=e)<0?t+360:t}function Ibe(e,t){return e[0]-t[0]}function gz(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function _be(e){var t,n,i,r,s,o,a;if(Vr=hn=-(sn=wr=1/0),yu=[],al(e,il),n=yu.length){for(yu.sort(Ibe),t=1,i=yu[0],s=[i];t<n;++t)r=yu[t],gz(i,r[0])||gz(i,r[1])?(Hr(i[0],r[1])>Hr(i[0],i[1])&&(i[1]=r[1]),Hr(r[0],i[1])>Hr(i[0],i[1])&&(i[0]=r[0])):s.push(i=r);for(o=-1/0,n=s.length-1,t=0,i=s[n];t<=n;i=r,++t)r=s[t],(a=Hr(i[1],r[0]))>o&&(o=a,sn=r[0],hn=i[1])}return yu=kl=null,sn===1/0||wr===1/0?[[NaN,NaN],[NaN,NaN]]:[[sn,wr],[hn,Vr]]}var Dm,Lb,Nb,$b,Bb,Gb,zb,Hb,NP,$P,BP,Rj,Ej,qi,Ki,Yi,uo={sphere:ci,point:E2,lineStart:mz,lineEnd:vz,polygonStart:function(){uo.lineStart=Nbe,uo.lineEnd=$be},polygonEnd:function(){uo.lineStart=mz,uo.lineEnd=vz}};function E2(e,t){e*=st,t*=st;var n=Le(t);G0(n*Le(e),n*Oe(e),Oe(t))}function G0(e,t,n){++Dm,Nb+=(e-Nb)/Dm,$b+=(t-$b)/Dm,Bb+=(n-Bb)/Dm}function mz(){uo.point=Obe}function Obe(e,t){e*=st,t*=st;var n=Le(t);qi=n*Le(e),Ki=n*Oe(e),Yi=Oe(t),uo.point=Lbe,G0(qi,Ki,Yi)}function Lbe(e,t){e*=st,t*=st;var n=Le(t),i=n*Le(e),r=n*Oe(e),s=Oe(t),o=Ls(sr((o=Ki*s-Yi*r)*o+(o=Yi*i-qi*s)*o+(o=qi*r-Ki*i)*o),qi*i+Ki*r+Yi*s);Lb+=o,Gb+=o*(qi+(qi=i)),zb+=o*(Ki+(Ki=r)),Hb+=o*(Yi+(Yi=s)),G0(qi,Ki,Yi)}function vz(){uo.point=E2}function Nbe(){uo.point=Bbe}function $be(){Fj(Rj,Ej),uo.point=E2}function Bbe(e,t){Rj=e,Ej=t,e*=st,t*=st,uo.point=Fj;var n=Le(t);qi=n*Le(e),Ki=n*Oe(e),Yi=Oe(t),G0(qi,Ki,Yi)}function Fj(e,t){e*=st,t*=st;var n=Le(t),i=n*Le(e),r=n*Oe(e),s=Oe(t),o=Ki*s-Yi*r,a=Yi*i-qi*s,l=qi*r-Ki*i,u=TP(o,a,l),c=Pr(u),d=u&&-c/u;NP.add(d*o),$P.add(d*a),BP.add(d*l),Lb+=c,Gb+=c*(qi+(qi=i)),zb+=c*(Ki+(Ki=r)),Hb+=c*(Yi+(Yi=s)),G0(qi,Ki,Yi)}function Gbe(e){Dm=Lb=Nb=$b=Bb=Gb=zb=Hb=0,NP=new tr,$P=new tr,BP=new tr,al(e,uo);var t=+NP,n=+$P,i=+BP,r=TP(t,n,i);return r<kP&&(t=Gb,n=zb,i=Hb,Lb<Be&&(t=Nb,n=$b,i=Bb),r=TP(t,n,i),r<kP)?[NaN,NaN]:[Ls(n,t)*xn,Pr(i/r)*xn]}function GP(e,t){function n(i,r){return i=e(i,r),t(i[0],i[1])}return e.invert&&t.invert&&(n.invert=function(i,r){return i=t.invert(i,r),i&&e.invert(i[0],i[1])}),n}function zP(e,t){return pt(e)>ot&&(e-=Math.round(e/rr)*rr),[e,t]}zP.invert=zP;function Aj(e,t,n){return(e%=rr)?t||n?GP(yz(e),wz(t,n)):yz(e):t||n?wz(t,n):zP}function Cz(e){return function(t,n){return t+=e,pt(t)>ot&&(t-=Math.round(t/rr)*rr),[t,n]}}function yz(e){var t=Cz(e);return t.invert=Cz(-e),t}function wz(e,t){var n=Le(e),i=Oe(e),r=Le(t),s=Oe(t);function o(a,l){var u=Le(l),c=Le(a)*u,d=Oe(a)*u,h=Oe(l),p=h*n+c*i;return[Ls(d*r-p*s,c*n-h*i),Pr(p*r+d*s)]}return o.invert=function(a,l){var u=Le(l),c=Le(a)*u,d=Oe(a)*u,h=Oe(l),p=h*r-d*s;return[Ls(d*r+h*s,c*n+p*i),Pr(p*n-c*i)]},o}function zbe(e){e=Aj(e[0]*st,e[1]*st,e.length>2?e[2]*st:0);function t(n){return n=e(n[0]*st,n[1]*st),n[0]*=xn,n[1]*=xn,n}return t.invert=function(n){return n=e.invert(n[0]*st,n[1]*st),n[0]*=xn,n[1]*=xn,n},t}function Hbe(e,t,n,i,r,s){if(n){var o=Le(t),a=Oe(t),l=i*n;r==null?(r=t+i*rr,s=t-l/2):(r=bz(o,r),s=bz(o,s),(i>0?r<s:r>s)&&(r+=i*rr));for(var u,c=r;i>0?c>s:c<s;c-=l)u=_b([o,-a*Le(c),-a*Oe(c)]),e.point(u[0],u[1])}}function bz(e,t){t=_d(t),t[0]-=e,Ob(t);var n=mj(-t[1]);return((-t[2]<0?-n:n)+rr-Be)%rr}function Dj(){var e=[],t;return{point:function(n,i,r){t.push([n,i,r])},lineStart:function(){e.push(t=[])},lineEnd:ci,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function Dw(e,t){return pt(e[0]-t[0])<Be&&pt(e[1]-t[1])<Be}function Ty(e,t,n,i){this.x=e,this.z=t,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function Pj(e,t,n,i,r){var s=[],o=[],a,l;if(e.forEach(function(g){if(!((v=g.length-1)<=0)){var v,C=g[0],y=g[v],b;if(Dw(C,y)){if(!C[2]&&!y[2]){for(r.lineStart(),a=0;a<v;++a)r.point((C=g[a])[0],C[1]);r.lineEnd();return}y[0]+=2*Be}s.push(b=new Ty(C,g,null,!0)),o.push(b.o=new Ty(C,null,b,!1)),s.push(b=new Ty(y,g,null,!1)),o.push(b.o=new Ty(y,null,b,!0))}}),!!s.length){for(o.sort(t),Sz(s),Sz(o),a=0,l=o.length;a<l;++a)o[a].e=n=!n;for(var u=s[0],c,d;;){for(var h=u,p=!0;h.v;)if((h=h.n)===u)return;c=h.z,r.lineStart();do{if(h.v=h.o.v=!0,h.e){if(p)for(a=0,l=c.length;a<l;++a)r.point((d=c[a])[0],d[1]);else i(h.x,h.n.x,1,r);h=h.n}else{if(p)for(c=h.p.z,a=c.length-1;a>=0;--a)r.point((d=c[a])[0],d[1]);else i(h.x,h.p.x,-1,r);h=h.p}h=h.o,c=h.z,p=!p}while(!h.v);r.lineEnd()}}}function Sz(e){if(t=e.length){for(var t,n=0,i=e[0],r;++n<t;)i.n=r=e[n],r.p=i,i=r;i.n=r=e[0],r.p=i}}function $F(e){return pt(e[0])<=ot?e[0]:xs(e[0])*((pt(e[0])+ot)%rr-ot)}function Vbe(e,t){var n=$F(t),i=t[1],r=Oe(i),s=[Oe(n),-Le(n),0],o=0,a=0,l=new tr;r===1?i=vn+Be:r===-1&&(i=-vn-Be);for(var u=0,c=e.length;u<c;++u)if(h=(d=e[u]).length)for(var d,h,p=d[h-1],g=$F(p),v=p[1]/2+Pb,C=Oe(v),y=Le(v),b=0;b<h;++b,g=x,C=A,y=F,p=S){var S=d[b],x=$F(S),E=S[1]/2+Pb,A=Oe(E),F=Le(E),k=x-g,P=k>=0?1:-1,_=P*k,O=_>ot,H=C*A;if(l.add(Ls(H*P*Oe(_),y*F+H*Le(_))),o+=O?k+P*rr:k,O^g>=n^x>=n){var W=ep(_d(p),_d(S));Ob(W);var $=ep(s,W);Ob($);var L=(O^k>=0?-1:1)*Pr($[2]);(i>L||i===L&&(W[0]||W[1]))&&(a+=O^k>=0?1:-1)}}return(o<-1e-6||o<Be&&l<-1e-12)^a&1}function kj(e,t,n,i){return function(r){var s=t(r),o=Dj(),a=t(o),l=!1,u,c,d,h={point:p,lineStart:v,lineEnd:C,polygonStart:function(){h.point=y,h.lineStart=b,h.lineEnd=S,c=[],u=[]},polygonEnd:function(){h.point=p,h.lineStart=v,h.lineEnd=C,c=y4(c);var x=Vbe(u,i);c.length?(l||(r.polygonStart(),l=!0),Pj(c,Ube,x,n,r)):x&&(l||(r.polygonStart(),l=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),l&&(r.polygonEnd(),l=!1),c=u=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function p(x,E){e(x,E)&&r.point(x,E)}function g(x,E){s.point(x,E)}function v(){h.point=g,s.lineStart()}function C(){h.point=p,s.lineEnd()}function y(x,E){d.push([x,E]),a.point(x,E)}function b(){a.lineStart(),d=[]}function S(){y(d[0][0],d[0][1]),a.lineEnd();var x=a.clean(),E=o.result(),A,F=E.length,k,P,_;if(d.pop(),u.push(d),d=null,!!F){if(x&1){if(P=E[0],(k=P.length-1)>0){for(l||(r.polygonStart(),l=!0),r.lineStart(),A=0;A<k;++A)r.point((_=P[A])[0],_[1]);r.lineEnd()}return}F>1&&x&2&&E.push(E.pop().concat(E.shift())),c.push(E.filter(Wbe))}}return h}}function Wbe(e){return e.length>1}function Ube(e,t){return((e=e.x)[0]<0?e[1]-vn-Be:vn-e[1])-((t=t.x)[0]<0?t[1]-vn-Be:vn-t[1])}const xz=kj(function(){return!0},jbe,Kbe,[-ot,-vn]);function jbe(e){var t=NaN,n=NaN,i=NaN,r;return{lineStart:function(){e.lineStart(),r=1},point:function(s,o){var a=s>0?ot:-ot,l=pt(s-t);pt(l-ot)<Be?(e.point(t,n=(n+o)/2>0?vn:-vn),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(a,n),e.point(s,n),r=0):i!==a&&l>=ot&&(pt(t-i)<Be&&(t-=i*Be),pt(s-a)<Be&&(s-=a*Be),n=qbe(t,n,s,o),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(a,n),r=0),e.point(t=s,n=o),i=a},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-r}}}function qbe(e,t,n,i){var r,s,o=Oe(e-n);return pt(o)>Be?Up((Oe(t)*(s=Le(i))*Oe(n)-Oe(i)*(r=Le(t))*Oe(e))/(r*s*o)):(t+i)/2}function Kbe(e,t,n,i){var r;if(e==null)r=n*vn,i.point(-ot,r),i.point(0,r),i.point(ot,r),i.point(ot,0),i.point(ot,-r),i.point(0,-r),i.point(-ot,-r),i.point(-ot,0),i.point(-ot,r);else if(pt(e[0]-t[0])>Be){var s=e[0]<t[0]?ot:-ot;r=n*s/2,i.point(-s,r),i.point(0,r),i.point(s,r)}else i.point(t[0],t[1])}function Ybe(e){var t=Le(e),n=2*st,i=t>0,r=pt(t)>Be;function s(c,d,h,p){Hbe(p,e,n,h,c,d)}function o(c,d){return Le(c)*Le(d)>t}function a(c){var d,h,p,g,v;return{lineStart:function(){g=p=!1,v=1},point:function(C,y){var b=[C,y],S,x=o(C,y),E=i?x?0:u(C,y):x?u(C+(C<0?ot:-ot),y):0;if(!d&&(g=p=x)&&c.lineStart(),x!==p&&(S=l(d,b),(!S||Dw(d,S)||Dw(b,S))&&(b[2]=1)),x!==p)v=0,x?(c.lineStart(),S=l(b,d),c.point(S[0],S[1])):(S=l(d,b),c.point(S[0],S[1],2),c.lineEnd()),d=S;else if(r&&d&&i^x){var A;!(E&h)&&(A=l(b,d,!0))&&(v=0,i?(c.lineStart(),c.point(A[0][0],A[0][1]),c.point(A[1][0],A[1][1]),c.lineEnd()):(c.point(A[1][0],A[1][1]),c.lineEnd(),c.lineStart(),c.point(A[0][0],A[0][1],3)))}x&&(!d||!Dw(d,b))&&c.point(b[0],b[1]),d=b,p=x,h=E},lineEnd:function(){p&&c.lineEnd(),d=null},clean:function(){return v|(g&&p)<<1}}}function l(c,d,h){var p=_d(c),g=_d(d),v=[1,0,0],C=ep(p,g),y=Py(C,C),b=C[0],S=y-b*b;if(!S)return!h&&c;var x=t*y/S,E=-t*b/S,A=ep(v,C),F=ky(v,x),k=ky(C,E);NF(F,k);var P=A,_=Py(F,P),O=Py(P,P),H=_*_-O*(Py(F,F)-1);if(!(H<0)){var W=sr(H),$=ky(P,(-_-W)/O);if(NF($,F),$=_b($),!h)return $;var L=c[0],G=d[0],j=c[1],ee=d[1],q;G<L&&(q=L,L=G,G=q);var fe=G-L,Re=pt(fe-ot)<Be,Fe=Re||fe<Be;if(!Re&&ee<j&&(q=j,j=ee,ee=q),Fe?Re?j+ee>0^$[1]<(pt($[0]-L)<Be?j:ee):j<=$[1]&&$[1]<=ee:fe>ot^(L<=$[0]&&$[0]<=G)){var ze=ky(P,(-_+W)/O);return NF(ze,F),[$,_b(ze)]}}}function u(c,d){var h=i?e:ot-e,p=0;return c<-h?p|=1:c>h&&(p|=2),d<-h?p|=4:d>h&&(p|=8),p}return kj(o,a,s,i?[0,-e]:[-ot,e-ot])}function Xbe(e,t,n,i,r,s){var o=e[0],a=e[1],l=t[0],u=t[1],c=0,d=1,h=l-o,p=u-a,g;if(g=n-o,!(!h&&g>0)){if(g/=h,h<0){if(g<c)return;g<d&&(d=g)}else if(h>0){if(g>d)return;g>c&&(c=g)}if(g=r-o,!(!h&&g<0)){if(g/=h,h<0){if(g>d)return;g>c&&(c=g)}else if(h>0){if(g<c)return;g<d&&(d=g)}if(g=i-a,!(!p&&g>0)){if(g/=p,p<0){if(g<c)return;g<d&&(d=g)}else if(p>0){if(g>d)return;g>c&&(c=g)}if(g=s-a,!(!p&&g<0)){if(g/=p,p<0){if(g>d)return;g>c&&(c=g)}else if(p>0){if(g<c)return;g<d&&(d=g)}return c>0&&(e[0]=o+c*h,e[1]=a+c*p),d<1&&(t[0]=o+d*h,t[1]=a+d*p),!0}}}}}var My=1e9,Iy=-1e9;function Tj(e,t,n,i){function r(u,c){return e<=u&&u<=n&&t<=c&&c<=i}function s(u,c,d,h){var p=0,g=0;if(u==null||(p=o(u,d))!==(g=o(c,d))||l(u,c)<0^d>0)do h.point(p===0||p===3?e:n,p>1?i:t);while((p=(p+d+4)%4)!==g);else h.point(c[0],c[1])}function o(u,c){return pt(u[0]-e)<Be?c>0?0:3:pt(u[0]-n)<Be?c>0?2:1:pt(u[1]-t)<Be?c>0?1:0:c>0?3:2}function a(u,c){return l(u.x,c.x)}function l(u,c){var d=o(u,1),h=o(c,1);return d!==h?d-h:d===0?c[1]-u[1]:d===1?u[0]-c[0]:d===2?u[1]-c[1]:c[0]-u[0]}return function(u){var c=u,d=Dj(),h,p,g,v,C,y,b,S,x,E,A,F={point:k,lineStart:H,lineEnd:W,polygonStart:_,polygonEnd:O};function k(L,G){r(L,G)&&c.point(L,G)}function P(){for(var L=0,G=0,j=p.length;G<j;++G)for(var ee=p[G],q=1,fe=ee.length,Re=ee[0],Fe,ze,Ft=Re[0],$e=Re[1];q<fe;++q)Fe=Ft,ze=$e,Re=ee[q],Ft=Re[0],$e=Re[1],ze<=i?$e>i&&(Ft-Fe)*(i-ze)>($e-ze)*(e-Fe)&&++L:$e<=i&&(Ft-Fe)*(i-ze)<($e-ze)*(e-Fe)&&--L;return L}function _(){c=d,h=[],p=[],A=!0}function O(){var L=P(),G=A&&L,j=(h=y4(h)).length;(G||j)&&(u.polygonStart(),G&&(u.lineStart(),s(null,null,1,u),u.lineEnd()),j&&Pj(h,a,L,s,u),u.polygonEnd()),c=u,h=p=g=null}function H(){F.point=$,p&&p.push(g=[]),E=!0,x=!1,b=S=NaN}function W(){h&&($(v,C),y&&x&&d.rejoin(),h.push(d.result())),F.point=k,x&&c.lineEnd()}function $(L,G){var j=r(L,G);if(p&&g.push([L,G]),E)v=L,C=G,y=j,E=!1,j&&(c.lineStart(),c.point(L,G));else if(j&&x)c.point(L,G);else{var ee=[b=Math.max(Iy,Math.min(My,b)),S=Math.max(Iy,Math.min(My,S))],q=[L=Math.max(Iy,Math.min(My,L)),G=Math.max(Iy,Math.min(My,G))];Xbe(ee,q,e,t,n,i)?(x||(c.lineStart(),c.point(ee[0],ee[1])),c.point(q[0],q[1]),j||c.lineEnd(),A=!1):j&&(c.lineStart(),c.point(L,G),A=!1)}b=L,S=G,x=j}return F}}function Rz(e,t,n){var i=Sr(e,t-Be,n).concat(t);return function(r){return i.map(function(s){return[r,s]})}}function Ez(e,t,n){var i=Sr(e,t-Be,n).concat(t);return function(r){return i.map(function(s){return[s,r]})}}function Qbe(){var e,t,n,i,r,s,o,a,l=10,u=l,c=90,d=360,h,p,g,v,C=2.5;function y(){return{type:"MultiLineString",coordinates:b()}}function b(){return Sr(Dy(i/c)*c,n,c).map(g).concat(Sr(Dy(a/d)*d,o,d).map(v)).concat(Sr(Dy(t/l)*l,e,l).filter(function(S){return pt(S%c)>Be}).map(h)).concat(Sr(Dy(s/u)*u,r,u).filter(function(S){return pt(S%d)>Be}).map(p))}return y.lines=function(){return b().map(function(S){return{type:"LineString",coordinates:S}})},y.outline=function(){return{type:"Polygon",coordinates:[g(i).concat(v(o).slice(1),g(n).reverse().slice(1),v(a).reverse().slice(1))]}},y.extent=function(S){return arguments.length?y.extentMajor(S).extentMinor(S):y.extentMinor()},y.extentMajor=function(S){return arguments.length?(i=+S[0][0],n=+S[1][0],a=+S[0][1],o=+S[1][1],i>n&&(S=i,i=n,n=S),a>o&&(S=a,a=o,o=S),y.precision(C)):[[i,a],[n,o]]},y.extentMinor=function(S){return arguments.length?(t=+S[0][0],e=+S[1][0],s=+S[0][1],r=+S[1][1],t>e&&(S=t,t=e,e=S),s>r&&(S=s,s=r,r=S),y.precision(C)):[[t,s],[e,r]]},y.step=function(S){return arguments.length?y.stepMajor(S).stepMinor(S):y.stepMinor()},y.stepMajor=function(S){return arguments.length?(c=+S[0],d=+S[1],y):[c,d]},y.stepMinor=function(S){return arguments.length?(l=+S[0],u=+S[1],y):[l,u]},y.precision=function(S){return arguments.length?(C=+S,h=Rz(s,r,90),p=Ez(t,e,C),g=Rz(a,o,90),v=Ez(i,n,C),y):C},y.extentMajor([[-180,-90+Be],[180,90-Be]]).extentMinor([[-180,-80-Be],[180,80+Be]])}const Tv=e=>e;var BF=new tr,HP=new tr,Mj,Ij,VP,WP,ll={point:ci,lineStart:ci,lineEnd:ci,polygonStart:function(){ll.lineStart=Jbe,ll.lineEnd=eSe},polygonEnd:function(){ll.lineStart=ll.lineEnd=ll.point=ci,BF.add(pt(HP)),HP=new tr},result:function(){var e=BF/2;return BF=new tr,e}};function Jbe(){ll.point=Zbe}function Zbe(e,t){ll.point=_j,Mj=VP=e,Ij=WP=t}function _j(e,t){HP.add(WP*e-VP*t),VP=e,WP=t}function eSe(){_j(Mj,Ij)}var tp=1/0,Vb=tp,Mv=-tp,Wb=Mv,Ub={point:tSe,lineStart:ci,lineEnd:ci,polygonStart:ci,polygonEnd:ci,result:function(){var e=[[tp,Vb],[Mv,Wb]];return Mv=Wb=-(Vb=tp=1/0),e}};function tSe(e,t){e<tp&&(tp=e),e>Mv&&(Mv=e),t<Vb&&(Vb=t),t>Wb&&(Wb=t)}var UP=0,jP=0,Pm=0,jb=0,qb=0,hf=0,qP=0,KP=0,km=0,Oj,Lj,ia,ra,ws={point:Od,lineStart:Fz,lineEnd:Az,polygonStart:function(){ws.lineStart=rSe,ws.lineEnd=sSe},polygonEnd:function(){ws.point=Od,ws.lineStart=Fz,ws.lineEnd=Az},result:function(){var e=km?[qP/km,KP/km]:hf?[jb/hf,qb/hf]:Pm?[UP/Pm,jP/Pm]:[NaN,NaN];return UP=jP=Pm=jb=qb=hf=qP=KP=km=0,e}};function Od(e,t){UP+=e,jP+=t,++Pm}function Fz(){ws.point=nSe}function nSe(e,t){ws.point=iSe,Od(ia=e,ra=t)}function iSe(e,t){var n=e-ia,i=t-ra,r=sr(n*n+i*i);jb+=r*(ia+e)/2,qb+=r*(ra+t)/2,hf+=r,Od(ia=e,ra=t)}function Az(){ws.point=Od}function rSe(){ws.point=oSe}function sSe(){Nj(Oj,Lj)}function oSe(e,t){ws.point=Nj,Od(Oj=ia=e,Lj=ra=t)}function Nj(e,t){var n=e-ia,i=t-ra,r=sr(n*n+i*i);jb+=r*(ia+e)/2,qb+=r*(ra+t)/2,hf+=r,r=ra*e-ia*t,qP+=r*(ia+e),KP+=r*(ra+t),km+=r*3,Od(ia=e,ra=t)}function $j(e){this._context=e}$j.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,rr);break}}},result:ci};var YP=new tr,GF,Bj,Gj,Tm,Mm,Iv={point:ci,lineStart:function(){Iv.point=aSe},lineEnd:function(){GF&&zj(Bj,Gj),Iv.point=ci},polygonStart:function(){GF=!0},polygonEnd:function(){GF=null},result:function(){var e=+YP;return YP=new tr,e}};function aSe(e,t){Iv.point=zj,Bj=Tm=e,Gj=Mm=t}function zj(e,t){Tm-=e,Mm-=t,YP.add(sr(Tm*Tm+Mm*Mm)),Tm=e,Mm=t}let Dz,Kb,Pz,kz;class Tz{constructor(t){this._append=t==null?Hj:lSe(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==Pz||this._append!==Kb){const i=this._radius,r=this._;this._="",this._append`m0,${i}a${i},${i} 0 1,1 0,${-2*i}a${i},${i} 0 1,1 0,${2*i}z`,Pz=i,Kb=this._append,kz=this._,this._=r}this._+=kz;break}}}result(){const t=this._;return this._="",t.length?t:null}}function Hj(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function lSe(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return Hj;if(t!==Dz){const n=10**t;Dz=t,Kb=function(r){let s=1;this._+=r[0];for(const o=r.length;s<o;++s)this._+=Math.round(arguments[s]*n)/n+r[s]}}return Kb}function Vj(e,t){let n=3,i=4.5,r,s;function o(a){return a&&(typeof i=="function"&&s.pointRadius(+i.apply(this,arguments)),al(a,r(s))),s.result()}return o.area=function(a){return al(a,r(ll)),ll.result()},o.measure=function(a){return al(a,r(Iv)),Iv.result()},o.bounds=function(a){return al(a,r(Ub)),Ub.result()},o.centroid=function(a){return al(a,r(ws)),ws.result()},o.projection=function(a){return arguments.length?(r=a==null?(e=null,Tv):(e=a).stream,o):e},o.context=function(a){return arguments.length?(s=a==null?(t=null,new Tz(n)):new $j(t=a),typeof i!="function"&&s.pointRadius(i),o):t},o.pointRadius=function(a){return arguments.length?(i=typeof a=="function"?a:(s.pointRadius(+a),+a),o):i},o.digits=function(a){if(!arguments.length)return n;if(a==null)n=null;else{const l=Math.floor(a);if(!(l>=0))throw new RangeError(`invalid digits: ${a}`);n=l}return t===null&&(s=new Tz(n)),o},o.projection(e).digits(n).context(t)}function tx(e){return function(t){var n=new XP;for(var i in e)n[i]=e[i];return n.stream=t,n}}function XP(){}XP.prototype={constructor:XP,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function F2(e,t,n){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),i!=null&&e.clipExtent(null),al(n,e.stream(Ub)),t(Ub.result()),i!=null&&e.clipExtent(i),e}function nx(e,t,n){return F2(e,function(i){var r=t[1][0]-t[0][0],s=t[1][1]-t[0][1],o=Math.min(r/(i[1][0]-i[0][0]),s/(i[1][1]-i[0][1])),a=+t[0][0]+(r-o*(i[1][0]+i[0][0]))/2,l=+t[0][1]+(s-o*(i[1][1]+i[0][1]))/2;e.scale(150*o).translate([a,l])},n)}function A2(e,t,n){return nx(e,[[0,0],t],n)}function D2(e,t,n){return F2(e,function(i){var r=+t,s=r/(i[1][0]-i[0][0]),o=(r-s*(i[1][0]+i[0][0]))/2,a=-s*i[0][1];e.scale(150*s).translate([o,a])},n)}function P2(e,t,n){return F2(e,function(i){var r=+t,s=r/(i[1][1]-i[0][1]),o=-s*i[0][0],a=(r-s*(i[1][1]+i[0][1]))/2;e.scale(150*s).translate([o,a])},n)}var Mz=16,uSe=Le(30*st);function Iz(e,t){return+t?dSe(e,t):cSe(e)}function cSe(e){return tx({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function dSe(e,t){function n(i,r,s,o,a,l,u,c,d,h,p,g,v,C){var y=u-i,b=c-r,S=y*y+b*b;if(S>4*t&&v--){var x=o+h,E=a+p,A=l+g,F=sr(x*x+E*E+A*A),k=Pr(A/=F),P=pt(pt(A)-1)<Be||pt(s-d)<Be?(s+d)/2:Ls(E,x),_=e(P,k),O=_[0],H=_[1],W=O-i,$=H-r,L=b*W-y*$;(L*L/S>t||pt((y*W+b*$)/S-.5)>.3||o*h+a*p+l*g<uSe)&&(n(i,r,s,o,a,l,O,H,P,x/=F,E/=F,A,v,C),C.point(O,H),n(O,H,P,x,E,A,u,c,d,h,p,g,v,C))}}return function(i){var r,s,o,a,l,u,c,d,h,p,g,v,C={point:y,lineStart:b,lineEnd:x,polygonStart:function(){i.polygonStart(),C.lineStart=E},polygonEnd:function(){i.polygonEnd(),C.lineStart=b}};function y(k,P){k=e(k,P),i.point(k[0],k[1])}function b(){d=NaN,C.point=S,i.lineStart()}function S(k,P){var _=_d([k,P]),O=e(k,P);n(d,h,c,p,g,v,d=O[0],h=O[1],c=k,p=_[0],g=_[1],v=_[2],Mz,i),i.point(d,h)}function x(){C.point=y,i.lineEnd()}function E(){b(),C.point=A,C.lineEnd=F}function A(k,P){S(r=k,P),s=d,o=h,a=p,l=g,u=v,C.point=S}function F(){n(d,h,c,p,g,v,s,o,r,a,l,u,Mz,i),C.lineEnd=x,x()}return C}}var hSe=tx({point:function(e,t){this.stream.point(e*st,t*st)}});function fSe(e){return tx({point:function(t,n){var i=e(t,n);return this.stream.point(i[0],i[1])}})}function pSe(e,t,n,i,r){function s(o,a){return o*=i,a*=r,[t+e*o,n-e*a]}return s.invert=function(o,a){return[(o-t)/e*i,(n-a)/e*r]},s}function _z(e,t,n,i,r,s){if(!s)return pSe(e,t,n,i,r);var o=Le(s),a=Oe(s),l=o*e,u=a*e,c=o/e,d=a/e,h=(a*n-o*t)/e,p=(a*t+o*n)/e;function g(v,C){return v*=i,C*=r,[l*v-u*C+t,n-u*v-l*C]}return g.invert=function(v,C){return[i*(c*v-d*C+h),r*(p-d*v-c*C)]},g}function Pa(e){return Wj(function(){return e})()}function Wj(e){var t,n=150,i=480,r=250,s=0,o=0,a=0,l=0,u=0,c,d=0,h=1,p=1,g=null,v=xz,C=null,y,b,S,x=Tv,E=.5,A,F,k,P,_;function O(L){return k(L[0]*st,L[1]*st)}function H(L){return L=k.invert(L[0],L[1]),L&&[L[0]*xn,L[1]*xn]}O.stream=function(L){return P&&_===L?P:P=hSe(fSe(c)(v(A(x(_=L)))))},O.preclip=function(L){return arguments.length?(v=L,g=void 0,$()):v},O.postclip=function(L){return arguments.length?(x=L,C=y=b=S=null,$()):x},O.clipAngle=function(L){return arguments.length?(v=+L?Ybe(g=L*st):(g=null,xz),$()):g*xn},O.clipExtent=function(L){return arguments.length?(x=L==null?(C=y=b=S=null,Tv):Tj(C=+L[0][0],y=+L[0][1],b=+L[1][0],S=+L[1][1]),$()):C==null?null:[[C,y],[b,S]]},O.scale=function(L){return arguments.length?(n=+L,W()):n},O.translate=function(L){return arguments.length?(i=+L[0],r=+L[1],W()):[i,r]},O.center=function(L){return arguments.length?(s=L[0]%360*st,o=L[1]%360*st,W()):[s*xn,o*xn]},O.rotate=function(L){return arguments.length?(a=L[0]%360*st,l=L[1]%360*st,u=L.length>2?L[2]%360*st:0,W()):[a*xn,l*xn,u*xn]},O.angle=function(L){return arguments.length?(d=L%360*st,W()):d*xn},O.reflectX=function(L){return arguments.length?(h=L?-1:1,W()):h<0},O.reflectY=function(L){return arguments.length?(p=L?-1:1,W()):p<0},O.precision=function(L){return arguments.length?(A=Iz(F,E=L*L),$()):sr(E)},O.fitExtent=function(L,G){return nx(O,L,G)},O.fitSize=function(L,G){return A2(O,L,G)},O.fitWidth=function(L,G){return D2(O,L,G)},O.fitHeight=function(L,G){return P2(O,L,G)};function W(){var L=_z(n,0,0,h,p,d).apply(null,t(s,o)),G=_z(n,i-L[0],r-L[1],h,p,d);return c=Aj(a,l,u),F=GP(t,G),k=GP(c,F),A=Iz(F,E),$()}function $(){return P=_=null,O}return function(){return t=e.apply(this,arguments),O.invert=t.invert&&H,W()}}function k2(e){var t=0,n=ot/3,i=Wj(e),r=i(t,n);return r.parallels=function(s){return arguments.length?i(t=s[0]*st,n=s[1]*st):[t*xn,n*xn]},r}function gSe(e){var t=Le(e);function n(i,r){return[i*t,Oe(r)/t]}return n.invert=function(i,r){return[i/t,Pr(r*t)]},n}function mSe(e,t){var n=Oe(e),i=(n+Oe(t))/2;if(pt(i)<Be)return gSe(e);var r=1+n*(2*i-n),s=sr(r)/i;function o(a,l){var u=sr(r-2*i*Oe(l))/i;return[u*Oe(a*=i),s-u*Le(a)]}return o.invert=function(a,l){var u=s-l,c=Ls(a,pt(u))*xs(u);return u*i<0&&(c-=ot*xs(a)*xs(u)),[c/i,Pr((r-(a*a+u*u)*i*i)/(2*i))]},o}function Yb(){return k2(mSe).scale(155.424).center([0,33.6442])}function Uj(){return Yb().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function vSe(e){var t=e.length;return{point:function(n,i){for(var r=-1;++r<t;)e[r].point(n,i)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function CSe(){var e,t,n=Uj(),i,r=Yb().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s,o=Yb().rotate([157,0]).center([-3,19.9]).parallels([8,18]),a,l,u={point:function(h,p){l=[h,p]}};function c(h){var p=h[0],g=h[1];return l=null,i.point(p,g),l||(s.point(p,g),l)||(a.point(p,g),l)}c.invert=function(h){var p=n.scale(),g=n.translate(),v=(h[0]-g[0])/p,C=(h[1]-g[1])/p;return(C>=.12&&C<.234&&v>=-.425&&v<-.214?r:C>=.166&&C<.234&&v>=-.214&&v<-.115?o:n).invert(h)},c.stream=function(h){return e&&t===h?e:e=vSe([n.stream(t=h),r.stream(h),o.stream(h)])},c.precision=function(h){return arguments.length?(n.precision(h),r.precision(h),o.precision(h),d()):n.precision()},c.scale=function(h){return arguments.length?(n.scale(h),r.scale(h*.35),o.scale(h),c.translate(n.translate())):n.scale()},c.translate=function(h){if(!arguments.length)return n.translate();var p=n.scale(),g=+h[0],v=+h[1];return i=n.translate(h).clipExtent([[g-.455*p,v-.238*p],[g+.455*p,v+.238*p]]).stream(u),s=r.translate([g-.307*p,v+.201*p]).clipExtent([[g-.425*p+Be,v+.12*p+Be],[g-.214*p-Be,v+.234*p-Be]]).stream(u),a=o.translate([g-.205*p,v+.212*p]).clipExtent([[g-.214*p+Be,v+.166*p+Be],[g-.115*p-Be,v+.234*p-Be]]).stream(u),d()},c.fitExtent=function(h,p){return nx(c,h,p)},c.fitSize=function(h,p){return A2(c,h,p)},c.fitWidth=function(h,p){return D2(c,h,p)},c.fitHeight=function(h,p){return P2(c,h,p)};function d(){return e=t=null,c}return c.scale(1070)}function jj(e){return function(t,n){var i=Le(t),r=Le(n),s=e(i*r);return s===1/0?[2,0]:[s*r*Oe(t),s*Oe(n)]}}function z0(e){return function(t,n){var i=sr(t*t+n*n),r=e(i),s=Oe(r),o=Le(r);return[Ls(t*s,i*o),Pr(i&&n*s/i)]}}var qj=jj(function(e){return sr(2/(1+e))});qj.invert=z0(function(e){return 2*Pr(e/2)});function ySe(){return Pa(qj).scale(124.75).clipAngle(180-.001)}var Kj=jj(function(e){return(e=mj(e))&&e/Oe(e)});Kj.invert=z0(function(e){return e});function wSe(){return Pa(Kj).scale(79.4188).clipAngle(180-.001)}function ix(e,t){return[e,kb(R2((vn+t)/2))]}ix.invert=function(e,t){return[e,2*Up(gj(t))-vn]};function bSe(){return Yj(ix).scale(961/rr)}function Yj(e){var t=Pa(e),n=t.center,i=t.scale,r=t.translate,s=t.clipExtent,o=null,a,l,u;t.scale=function(d){return arguments.length?(i(d),c()):i()},t.translate=function(d){return arguments.length?(r(d),c()):r()},t.center=function(d){return arguments.length?(n(d),c()):n()},t.clipExtent=function(d){return arguments.length?(d==null?o=a=l=u=null:(o=+d[0][0],a=+d[0][1],l=+d[1][0],u=+d[1][1]),c()):o==null?null:[[o,a],[l,u]]};function c(){var d=ot*i(),h=t(zbe(t.rotate()).invert([0,0]));return s(o==null?[[h[0]-d,h[1]-d],[h[0]+d,h[1]+d]]:e===ix?[[Math.max(h[0]-d,o),a],[Math.min(h[0]+d,l),u]]:[[o,Math.max(h[1]-d,a)],[l,Math.min(h[1]+d,u)]])}return c()}function _y(e){return R2((vn+e)/2)}function SSe(e,t){var n=Le(e),i=e===t?Oe(e):kb(n/Le(t))/kb(_y(t)/_y(e)),r=n*LF(_y(e),i)/i;if(!i)return ix;function s(o,a){r>0?a<-vn+Be&&(a=-vn+Be):a>vn-Be&&(a=vn-Be);var l=r/LF(_y(a),i);return[l*Oe(i*o),r-l*Le(i*o)]}return s.invert=function(o,a){var l=r-a,u=xs(i)*sr(o*o+l*l),c=Ls(o,pt(l))*xs(l);return l*i<0&&(c-=ot*xs(o)*xs(l)),[c/i,2*Up(LF(r/u,1/i))-vn]},s}function xSe(){return k2(SSe).scale(109.5).parallels([30,30])}function Xb(e,t){return[e,t]}Xb.invert=Xb;function RSe(){return Pa(Xb).scale(152.63)}function ESe(e,t){var n=Le(e),i=e===t?Oe(e):(n-Le(t))/(t-e),r=n/i+e;if(pt(i)<Be)return Xb;function s(o,a){var l=r-a,u=i*o;return[l*Oe(u),r-l*Le(u)]}return s.invert=function(o,a){var l=r-a,u=Ls(o,pt(l))*xs(l);return l*i<0&&(u-=ot*xs(o)*xs(l)),[u/i,r-xs(i)*sr(o*o+l*l)]},s}function FSe(){return k2(ESe).scale(131.154).center([0,13.9389])}var Xm=1.340264,Qm=-.081106,Jm=893e-6,Zm=.003796,Qb=sr(3)/2,ASe=12;function Xj(e,t){var n=Pr(Qb*Oe(t)),i=n*n,r=i*i*i;return[e*Le(n)/(Qb*(Xm+3*Qm*i+r*(7*Jm+9*Zm*i))),n*(Xm+Qm*i+r*(Jm+Zm*i))]}Xj.invert=function(e,t){for(var n=t,i=n*n,r=i*i*i,s=0,o,a,l;s<ASe&&(a=n*(Xm+Qm*i+r*(Jm+Zm*i))-t,l=Xm+3*Qm*i+r*(7*Jm+9*Zm*i),n-=o=a/l,i=n*n,r=i*i*i,!(pt(o)<kP));++s);return[Qb*e*(Xm+3*Qm*i+r*(7*Jm+9*Zm*i))/Le(n),Pr(Oe(n)/Qb)]};function DSe(){return Pa(Xj).scale(177.158)}function Qj(e,t){var n=Le(t),i=Le(e)*n;return[n*Oe(e)/i,Oe(t)/i]}Qj.invert=z0(Up);function PSe(){return Pa(Qj).scale(144.049).clipAngle(60)}function kSe(){var e=1,t=0,n=0,i=1,r=1,s=0,o,a,l=null,u,c,d,h=1,p=1,g=tx({point:function(x,E){var A=S([x,E]);this.stream.point(A[0],A[1])}}),v=Tv,C,y;function b(){return h=e*i,p=e*r,C=y=null,S}function S(x){var E=x[0]*h,A=x[1]*p;if(s){var F=A*o-E*a;E=E*o+A*a,A=F}return[E+t,A+n]}return S.invert=function(x){var E=x[0]-t,A=x[1]-n;if(s){var F=A*o+E*a;E=E*o-A*a,A=F}return[E/h,A/p]},S.stream=function(x){return C&&y===x?C:C=g(v(y=x))},S.postclip=function(x){return arguments.length?(v=x,l=u=c=d=null,b()):v},S.clipExtent=function(x){return arguments.length?(v=x==null?(l=u=c=d=null,Tv):Tj(l=+x[0][0],u=+x[0][1],c=+x[1][0],d=+x[1][1]),b()):l==null?null:[[l,u],[c,d]]},S.scale=function(x){return arguments.length?(e=+x,b()):e},S.translate=function(x){return arguments.length?(t=+x[0],n=+x[1],b()):[t,n]},S.angle=function(x){return arguments.length?(s=x%360*st,a=Oe(s),o=Le(s),b()):s*xn},S.reflectX=function(x){return arguments.length?(i=x?-1:1,b()):i<0},S.reflectY=function(x){return arguments.length?(r=x?-1:1,b()):r<0},S.fitExtent=function(x,E){return nx(S,x,E)},S.fitSize=function(x,E){return A2(S,x,E)},S.fitWidth=function(x,E){return D2(S,x,E)},S.fitHeight=function(x,E){return P2(S,x,E)},S}function Jj(e,t){var n=t*t,i=n*n;return[e*(.8707-.131979*n+i*(-.013791+i*(.003971*n-.001529*i))),t*(1.007226+n*(.015085+i*(-.044475+.028874*n-.005916*i)))]}Jj.invert=function(e,t){var n=t,i=25,r;do{var s=n*n,o=s*s;n-=r=(n*(1.007226+s*(.015085+o*(-.044475+.028874*s-.005916*o)))-t)/(1.007226+s*(.015085*3+o*(-.044475*7+.028874*9*s-.005916*11*o)))}while(pt(r)>Be&&--i>0);return[e/(.8707+(s=n*n)*(-.131979+s*(-.013791+s*s*s*(.003971-.001529*s)))),n]};function TSe(){return Pa(Jj).scale(175.295)}function Zj(e,t){return[Le(t)*Oe(e),Oe(t)]}Zj.invert=z0(Pr);function MSe(){return Pa(Zj).scale(249.5).clipAngle(90+Be)}function eq(e,t){var n=Le(t),i=1+Le(e)*n;return[n*Oe(e)/i,Oe(t)/i]}eq.invert=z0(function(e){return 2*Up(e)});function ISe(){return Pa(eq).scale(250).clipAngle(142)}function tq(e,t){return[kb(R2((vn+t)/2)),-e]}tq.invert=function(e,t){return[-t,2*Up(gj(e))-vn]};function _Se(){var e=Yj(tq),t=e.center,n=e.rotate;return e.center=function(i){return arguments.length?t([-i[1],i[0]]):(i=t(),[i[1],-i[0]])},e.rotate=function(i){return arguments.length?n([i[0],i[1],i.length>2?i[2]+90:90]):(i=n(),[i[0],i[1],i[2]-90])},n([0,0,90]).scale(159.155)}var OSe=Math.abs,QP=Math.cos,Jb=Math.sin,LSe=1e-6,nq=Math.PI,JP=nq/2,Oz=NSe(2);function Lz(e){return e>1?JP:e<-1?-JP:Math.asin(e)}function NSe(e){return e>0?Math.sqrt(e):0}function $Se(e,t){var n=e*Jb(t),i=30,r;do t-=r=(t+Jb(t)-n)/(1+QP(t));while(OSe(r)>LSe&&--i>0);return t/2}function BSe(e,t,n){function i(r,s){return[e*r*QP(s=$Se(n,s)),t*Jb(s)]}return i.invert=function(r,s){return s=Lz(s/t),[r/(e*QP(s)),Lz((2*s+Jb(2*s))/n)]},i}var GSe=BSe(Oz/JP,Oz,nq);function zSe(){return Pa(GSe).scale(169.529)}const HSe=Vj(),ZP=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function VSe(e,t){return function n(){const i=t();return i.type=e,i.path=Vj().projection(i),i.copy=i.copy||function(){const r=n();return ZP.forEach(s=>{i[s]&&r[s](i[s]())}),r.path.pointRadius(i.path.pointRadius()),r},v9(i)}}function T2(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(Zb[e]=VSe(e,t),this):Zb[e]||null}function iq(e){return e&&e.path||HSe}const Zb={albers:Uj,albersusa:CSe,azimuthalequalarea:ySe,azimuthalequidistant:wSe,conicconformal:xSe,conicequalarea:Yb,conicequidistant:FSe,equalEarth:DSe,equirectangular:RSe,gnomonic:PSe,identity:kSe,mercator:bSe,mollweide:zSe,naturalEarth1:TSe,orthographic:MSe,stereographic:ISe,transversemercator:_Se};for(const e in Zb)T2(e,Zb[e]);function WSe(){}const Ja=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function rq(){var e=1,t=1,n=a;function i(l,u){return u.map(c=>r(l,c))}function r(l,u){var c=[],d=[];return s(l,u,h=>{n(h,l,u),USe(h)>0?c.push([h]):d.push(h)}),d.forEach(h=>{for(var p=0,g=c.length,v;p<g;++p)if(jSe((v=c[p])[0],h)!==-1){v.push(h);return}}),{type:"MultiPolygon",value:u,coordinates:c}}function s(l,u,c){var d=[],h=[],p,g,v,C,y,b;for(p=g=-1,C=l[0]>=u,Ja[C<<1].forEach(S);++p<e-1;)v=C,C=l[p+1]>=u,Ja[v|C<<1].forEach(S);for(Ja[C<<0].forEach(S);++g<t-1;){for(p=-1,C=l[g*e+e]>=u,y=l[g*e]>=u,Ja[C<<1|y<<2].forEach(S);++p<e-1;)v=C,C=l[g*e+e+p+1]>=u,b=y,y=l[g*e+p+1]>=u,Ja[v|C<<1|y<<2|b<<3].forEach(S);Ja[C|y<<3].forEach(S)}for(p=-1,y=l[g*e]>=u,Ja[y<<2].forEach(S);++p<e-1;)b=y,y=l[g*e+p+1]>=u,Ja[y<<2|b<<3].forEach(S);Ja[y<<3].forEach(S);function S(x){var E=[x[0][0]+p,x[0][1]+g],A=[x[1][0]+p,x[1][1]+g],F=o(E),k=o(A),P,_;(P=h[F])?(_=d[k])?(delete h[P.end],delete d[_.start],P===_?(P.ring.push(A),c(P.ring)):d[P.start]=h[_.end]={start:P.start,end:_.end,ring:P.ring.concat(_.ring)}):(delete h[P.end],P.ring.push(A),h[P.end=k]=P):(P=d[k])?(_=h[F])?(delete d[P.start],delete h[_.end],P===_?(P.ring.push(A),c(P.ring)):d[_.start]=h[P.end]={start:_.start,end:P.end,ring:_.ring.concat(P.ring)}):(delete d[P.start],P.ring.unshift(E),d[P.start=F]=P):d[F]=h[k]={start:F,end:k,ring:[E,A]}}}function o(l){return l[0]*2+l[1]*(e+1)*4}function a(l,u,c){l.forEach(d=>{var h=d[0],p=d[1],g=h|0,v=p|0,C,y=u[v*e+g];h>0&&h<e&&g===h&&(C=u[v*e+g-1],d[0]=h+(c-C)/(y-C)-.5),p>0&&p<t&&v===p&&(C=u[(v-1)*e+g],d[1]=p+(c-C)/(y-C)-.5)})}return i.contour=r,i.size=function(l){if(!arguments.length)return[e,t];var u=Math.floor(l[0]),c=Math.floor(l[1]);return u>=0&&c>=0||Z("invalid size"),e=u,t=c,i},i.smooth=function(l){return arguments.length?(n=l?a:WSe,i):n===a},i}function USe(e){for(var t=0,n=e.length,i=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)i+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return i}function jSe(e,t){for(var n=-1,i=t.length,r;++n<i;)if(r=qSe(e,t[n]))return r;return 0}function qSe(e,t){for(var n=t[0],i=t[1],r=-1,s=0,o=e.length,a=o-1;s<o;a=s++){var l=e[s],u=l[0],c=l[1],d=e[a],h=d[0],p=d[1];if(KSe(l,d,t))return 0;c>i!=p>i&&n<(h-u)*(i-c)/(p-c)+u&&(r=-r)}return r}function KSe(e,t,n){var i;return YSe(e,t,n)&&XSe(e[i=+(e[0]===t[0])],n[i],t[i])}function YSe(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function XSe(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function sq(e,t,n){return function(i){var r=ma(i),s=n?Math.min(r[0],0):r[0],o=r[1],a=o-s,l=t?Wu(s,o,e):a/(e+1);return Sr(s+l,o,l)}}function M2(e){Y.call(this,null,e)}M2.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};pe(M2,Y,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=e.field||_i,s=rq().smooth(e.smooth!==!1),o=e.thresholds||QSe(i,r,e),a=e.as===null?null:e.as||"contour",l=[];return i.forEach(u=>{const c=r(u),d=s.size([c.width,c.height])(c.values,te(o)?o:o(c.values));JSe(d,c,u,e),d.forEach(h=>{l.push(y1(u,Dt(a!=null?{[a]:h}:h)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}});function QSe(e,t,n){const i=sq(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?i:i(e.map(r=>hd(t(r).values)))}function JSe(e,t,n,i){let r=i.scale||t.scale,s=i.translate||t.translate;if(nt(r)&&(r=r(n,i)),nt(s)&&(s=s(n,i)),(r===1||r==null)&&!s)return;const o=(xt(r)?r:r[0])||1,a=(xt(r)?r:r[1])||1,l=s&&s[0]||0,u=s&&s[1]||0;e.forEach(oq(t,o,a,l,u))}function oq(e,t,n,i,r){const s=e.x1||0,o=e.y1||0,a=t*n<0;function l(d){d.forEach(u)}function u(d){a&&d.reverse(),d.forEach(c)}function c(d){d[0]=(d[0]-s)*t+i,d[1]=(d[1]-o)*n+r}return function(d){return d.coordinates.forEach(l),d}}function Nz(e,t,n){const i=e>=0?e:FM(t,n);return Math.round((Math.sqrt(4*i*i+1)-1)/2)}function zF(e){return nt(e)?e:Oi(+e)}function aq(){var e=l=>l[0],t=l=>l[1],n=Tp,i=[-1,-1],r=960,s=500,o=2;function a(l,u){const c=Nz(i[0],l,e)>>o,d=Nz(i[1],l,t)>>o,h=c?c+2:0,p=d?d+2:0,g=2*h+(r>>o),v=2*p+(s>>o),C=new Float32Array(g*v),y=new Float32Array(g*v);let b=C;l.forEach(x=>{const E=h+(+e(x)>>o),A=p+(+t(x)>>o);E>=0&&E<g&&A>=0&&A<v&&(C[E+A*g]+=+n(x))}),c>0&&d>0?(Uh(g,v,C,y,c),jh(g,v,y,C,d),Uh(g,v,C,y,c),jh(g,v,y,C,d),Uh(g,v,C,y,c),jh(g,v,y,C,d)):c>0?(Uh(g,v,C,y,c),Uh(g,v,y,C,c),Uh(g,v,C,y,c),b=y):d>0&&(jh(g,v,C,y,d),jh(g,v,y,C,d),jh(g,v,C,y,d),b=y);const S=u?Math.pow(2,-2*o):1/w4(b);for(let x=0,E=g*v;x<E;++x)b[x]*=S;return{values:b,scale:1<<o,width:g,height:v,x1:h,y1:p,x2:h+(r>>o),y2:p+(s>>o)}}return a.x=function(l){return arguments.length?(e=zF(l),a):e},a.y=function(l){return arguments.length?(t=zF(l),a):t},a.weight=function(l){return arguments.length?(n=zF(l),a):n},a.size=function(l){if(!arguments.length)return[r,s];var u=+l[0],c=+l[1];return u>=0&&c>=0||Z("invalid size"),r=u,s=c,a},a.cellSize=function(l){return arguments.length?((l=+l)>=1||Z("invalid cell size"),o=Math.floor(Math.log(l)/Math.LN2),a):1<<o},a.bandwidth=function(l){return arguments.length?(l=we(l),l.length===1&&(l=[+l[0],+l[0]]),l.length!==2&&Z("invalid bandwidth"),i=l,a):i},a}function Uh(e,t,n,i,r){const s=(r<<1)+1;for(let o=0;o<t;++o)for(let a=0,l=0;a<e+r;++a)a<e&&(l+=n[a+o*e]),a>=r&&(a>=s&&(l-=n[a-s+o*e]),i[a-r+o*e]=l/Math.min(a+1,e-1+s-a,s))}function jh(e,t,n,i,r){const s=(r<<1)+1;for(let o=0;o<e;++o)for(let a=0,l=0;a<t+r;++a)a<t&&(l+=n[o+a*e]),a>=r&&(a>=s&&(l-=n[o+(a-s)*e]),i[o+(a-r)*e]=l/Math.min(a+1,t-1+s-a,s))}function I2(e){Y.call(this,null,e)}I2.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const ZSe=["x","y","weight","size","cellSize","bandwidth"];function lq(e,t){return ZSe.forEach(n=>t[n]!=null?e[n](t[n]):0),e}pe(I2,Y,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=e1e(i,e.groupby),s=(e.groupby||[]).map(yn),o=lq(aq(),e),a=e.as||"grid",l=[];function u(c,d){for(let h=0;h<s.length;++h)c[s[h]]=d[h];return c}return l=r.map(c=>Dt(u({[a]:o(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}});function e1e(e,t){var n=[],i=c=>c(a),r,s,o,a,l,u;if(t==null)n.push(e);else for(r={},s=0,o=e.length;s<o;++s)a=e[s],l=t.map(i),u=r[l],u||(r[l]=u=[],u.dims=l,n.push(u)),u.push(a);return n}function _2(e){Y.call(this,null,e)}_2.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};pe(_2,Y,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=rq().smooth(e.smooth!==!1),r=e.values,s=e.thresholds||sq(e.count||10,e.nice,!!r),o=e.size,a,l;return r||(r=t.materialize(t.SOURCE).source,a=lq(aq(),e)(r,!0),l=oq(a,a.scale||1,a.scale||1,0,0),o=[a.width,a.height],r=a.values),s=te(s)?s:s(r),r=i.size(o)(r,s),l&&r.forEach(l),this.value&&(n.rem=this.value),this.value=n.source=n.add=(r||[]).map(Dt),n}});const ek="Feature",O2="FeatureCollection",t1e="MultiPoint";function L2(e){Y.call(this,null,e)}L2.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};pe(L2,Y,{transform(e,t){var n=this._features,i=this._points,r=e.fields,s=r&&r[0],o=r&&r[1],a=e.geojson||!r&&_i,l=t.ADD,u;u=e.modified()||t.changed(t.REM)||t.modified(Pi(a))||s&&t.modified(Pi(s))||o&&t.modified(Pi(o)),(!this.value||u)&&(l=t.SOURCE,this._features=n=[],this._points=i=[]),a&&t.visit(l,c=>n.push(a(c))),s&&o&&(t.visit(l,c=>{var d=s(c),h=o(c);d!=null&&h!=null&&(d=+d)===d&&(h=+h)===h&&i.push([d,h])}),n=n.concat({type:ek,geometry:{type:t1e,coordinates:i}})),this.value={type:O2,features:n}}});function N2(e){Y.call(this,null,e)}N2.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};pe(N2,Y,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.field||_i,s=e.as||"path",o=n.SOURCE;!i||e.modified()?(this.value=i=iq(e.projection),n.materialize().reflow()):o=r===_i||t.modified(r.fields)?n.ADD_MOD:n.ADD;const a=n1e(i,e.pointRadius);return n.visit(o,l=>l[s]=i(r(l))),i.pointRadius(a),n.modifies(s)}});function n1e(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function $2(e){Y.call(this,null,e)}$2.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};pe($2,Y,{transform(e,t){var n=e.projection,i=e.fields[0],r=e.fields[1],s=e.as||["x","y"],o=s[0],a=s[1],l;function u(c){const d=n([i(c),r(c)]);d?(c[o]=d[0],c[a]=d[1]):(c[o]=void 0,c[a]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,u):(l=t.modified(i.fields)||t.modified(r.fields),t.visit(l?t.ADD_MOD:t.ADD,u)),t.modifies(s)}});function B2(e){Y.call(this,null,e)}B2.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};pe(B2,Y,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.as||"shape",s=n.ADD;return(!i||e.modified())&&(this.value=i=i1e(iq(e.projection),e.field||Ms("datum"),e.pointRadius),n.materialize().reflow(),s=n.SOURCE),n.visit(s,o=>o[r]=i),n.modifies(r)}});function i1e(e,t,n){const i=n==null?r=>e(t(r)):r=>{var s=e.pointRadius(),o=e.pointRadius(n)(t(r));return e.pointRadius(s),o};return i.context=r=>(e.context(r),i),i}function G2(e){Y.call(this,[],e),this.generator=Qbe()}G2.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};pe(G2,Y,{transform(e,t){var n=this.value,i=this.generator,r;if(!n.length||e.modified())for(const s in e)nt(i[s])&&i[s](e[s]);return r=i(),n.length?t.mod.push(g8(n[0],r)):t.add.push(Dt(r)),n[0]=r,t}});function z2(e){Y.call(this,null,e)}z2.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};pe(z2,Y,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,i=e.resolve==="shared",r=e.field||_i,s=s1e(e.opacity,e),o=r1e(e.color,e),a=e.as||"image",l={$x:0,$y:0,$value:0,$max:i?hd(n.map(u=>hd(r(u).values))):0};return n.forEach(u=>{const c=r(u),d=Ze({},u,l);i||(d.$max=hd(c.values||[])),u[a]=o1e(c,d,o.dep?o:Oi(o(d)),s.dep?s:Oi(s(d)))}),t.reflow(!0).modifies(a)}});function r1e(e,t){let n;return nt(e)?(n=i=>qu(e(i,t)),n.dep=uq(e)):n=Oi(qu(e||"#888")),n}function s1e(e,t){let n;return nt(e)?(n=i=>e(i,t),n.dep=uq(e)):e?n=Oi(e):(n=i=>i.$value/i.$max||0,n.dep=!0),n}function uq(e){if(!nt(e))return!1;const t=Co(Pi(e));return t.$x||t.$y||t.$value||t.$max}function o1e(e,t,n,i){const r=e.width,s=e.height,o=e.x1||0,a=e.y1||0,l=e.x2||r,u=e.y2||s,c=e.values,d=c?C=>c[C]:xu,h=$u(l-o,u-a),p=h.getContext("2d"),g=p.getImageData(0,0,l-o,u-a),v=g.data;for(let C=a,y=0;C<u;++C){t.$y=C-a;for(let b=o,S=C*r;b<l;++b,y+=4){t.$x=b-o,t.$value=d(b+S);const x=n(t);v[y+0]=x.r,v[y+1]=x.g,v[y+2]=x.b,v[y+3]=~~(255*i(t))}}return p.putImageData(g,0,0),h}function cq(e){Y.call(this,null,e),this.modified(!0)}pe(cq,Y,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=l1e(e.type),ZP.forEach(i=>{e[i]!=null&&$z(n,i,e[i])})):ZP.forEach(i=>{e.modified(i)&&$z(n,i,e[i])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&a1e(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function a1e(e,t){const n=u1e(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function l1e(e){const t=T2((e||"mercator").toLowerCase());return t||Z("Unrecognized projection type: "+e),t()}function $z(e,t,n){nt(e[t])&&e[t](n)}function u1e(e){return e=we(e),e.length===1?e[0]:{type:O2,features:e.reduce((t,n)=>t.concat(c1e(n)),[])}}function c1e(e){return e.type===O2?e.features:we(e).filter(t=>t!=null).map(t=>t.type===ek?t:{type:ek,geometry:t})}const d1e=Object.freeze(Object.defineProperty({__proto__:null,contour:_2,geojson:L2,geopath:N2,geopoint:$2,geoshape:B2,graticule:G2,heatmap:z2,isocontour:M2,kde2d:I2,projection:cq},Symbol.toStringTag,{value:"Module"}));function h1e(e,t){var n,i=1;e==null&&(e=0),t==null&&(t=0);function r(){var s,o=n.length,a,l=0,u=0;for(s=0;s<o;++s)a=n[s],l+=a.x,u+=a.y;for(l=(l/o-e)*i,u=(u/o-t)*i,s=0;s<o;++s)a=n[s],a.x-=l,a.y-=u}return r.initialize=function(s){n=s},r.x=function(s){return arguments.length?(e=+s,r):e},r.y=function(s){return arguments.length?(t=+s,r):t},r.strength=function(s){return arguments.length?(i=+s,r):i},r}function f1e(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return dq(this.cover(t,n),t,n,e)}function dq(e,t,n,i){if(isNaN(t)||isNaN(n))return e;var r,s=e._root,o={data:i},a=e._x0,l=e._y0,u=e._x1,c=e._y1,d,h,p,g,v,C,y,b;if(!s)return e._root=o,e;for(;s.length;)if((v=t>=(d=(a+u)/2))?a=d:u=d,(C=n>=(h=(l+c)/2))?l=h:c=h,r=s,!(s=s[y=C<<1|v]))return r[y]=o,e;if(p=+e._x.call(null,s.data),g=+e._y.call(null,s.data),t===p&&n===g)return o.next=s,r?r[y]=o:e._root=o,e;do r=r?r[y]=new Array(4):e._root=new Array(4),(v=t>=(d=(a+u)/2))?a=d:u=d,(C=n>=(h=(l+c)/2))?l=h:c=h;while((y=C<<1|v)===(b=(g>=h)<<1|p>=d));return r[b]=s,r[y]=o,e}function p1e(e){var t,n,i=e.length,r,s,o=new Array(i),a=new Array(i),l=1/0,u=1/0,c=-1/0,d=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(s=+this._y.call(null,t))||(o[n]=r,a[n]=s,r<l&&(l=r),r>c&&(c=r),s<u&&(u=s),s>d&&(d=s));if(l>c||u>d)return this;for(this.cover(l,u).cover(c,d),n=0;n<i;++n)dq(this,o[n],a[n],e[n]);return this}function g1e(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,i=this._y0,r=this._x1,s=this._y1;if(isNaN(n))r=(n=Math.floor(e))+1,s=(i=Math.floor(t))+1;else{for(var o=r-n||1,a=this._root,l,u;n>e||e>=r||i>t||t>=s;)switch(u=(t<i)<<1|e<n,l=new Array(4),l[u]=a,a=l,o*=2,u){case 0:r=n+o,s=i+o;break;case 1:n=r-o,s=i+o;break;case 2:r=n+o,i=s-o;break;case 3:n=r-o,i=s-o;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=i,this._x1=r,this._y1=s,this}function m1e(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function v1e(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Qi(e,t,n,i,r){this.node=e,this.x0=t,this.y0=n,this.x1=i,this.y1=r}function C1e(e,t,n){var i,r=this._x0,s=this._y0,o,a,l,u,c=this._x1,d=this._y1,h=[],p=this._root,g,v;for(p&&h.push(new Qi(p,r,s,c,d)),n==null?n=1/0:(r=e-n,s=t-n,c=e+n,d=t+n,n*=n);g=h.pop();)if(!(!(p=g.node)||(o=g.x0)>c||(a=g.y0)>d||(l=g.x1)<r||(u=g.y1)<s))if(p.length){var C=(o+l)/2,y=(a+u)/2;h.push(new Qi(p[3],C,y,l,u),new Qi(p[2],o,y,C,u),new Qi(p[1],C,a,l,y),new Qi(p[0],o,a,C,y)),(v=(t>=y)<<1|e>=C)&&(g=h[h.length-1],h[h.length-1]=h[h.length-1-v],h[h.length-1-v]=g)}else{var b=e-+this._x.call(null,p.data),S=t-+this._y.call(null,p.data),x=b*b+S*S;if(x<n){var E=Math.sqrt(n=x);r=e-E,s=t-E,c=e+E,d=t+E,i=p.data}}return i}function y1e(e){if(isNaN(c=+this._x.call(null,e))||isNaN(d=+this._y.call(null,e)))return this;var t,n=this._root,i,r,s,o=this._x0,a=this._y0,l=this._x1,u=this._y1,c,d,h,p,g,v,C,y;if(!n)return this;if(n.length)for(;;){if((g=c>=(h=(o+l)/2))?o=h:l=h,(v=d>=(p=(a+u)/2))?a=p:u=p,t=n,!(n=n[C=v<<1|g]))return this;if(!n.length)break;(t[C+1&3]||t[C+2&3]||t[C+3&3])&&(i=t,y=C)}for(;n.data!==e;)if(r=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,r?(s?r.next=s:delete r.next,this):t?(s?t[C]=s:delete t[C],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(i?i[y]=n:this._root=n),this):(this._root=s,this)}function w1e(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function b1e(){return this._root}function S1e(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function x1e(e){var t=[],n,i=this._root,r,s,o,a,l;for(i&&t.push(new Qi(i,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(i=n.node,s=n.x0,o=n.y0,a=n.x1,l=n.y1)&&i.length){var u=(s+a)/2,c=(o+l)/2;(r=i[3])&&t.push(new Qi(r,u,c,a,l)),(r=i[2])&&t.push(new Qi(r,s,c,u,l)),(r=i[1])&&t.push(new Qi(r,u,o,a,c)),(r=i[0])&&t.push(new Qi(r,s,o,u,c))}return this}function R1e(e){var t=[],n=[],i;for(this._root&&t.push(new Qi(this._root,this._x0,this._y0,this._x1,this._y1));i=t.pop();){var r=i.node;if(r.length){var s,o=i.x0,a=i.y0,l=i.x1,u=i.y1,c=(o+l)/2,d=(a+u)/2;(s=r[0])&&t.push(new Qi(s,o,a,c,d)),(s=r[1])&&t.push(new Qi(s,c,a,l,d)),(s=r[2])&&t.push(new Qi(s,o,d,c,u)),(s=r[3])&&t.push(new Qi(s,c,d,l,u))}n.push(i)}for(;i=n.pop();)e(i.node,i.x0,i.y0,i.x1,i.y1);return this}function E1e(e){return e[0]}function F1e(e){return arguments.length?(this._x=e,this):this._x}function A1e(e){return e[1]}function D1e(e){return arguments.length?(this._y=e,this):this._y}function H2(e,t,n){var i=new V2(t??E1e,n??A1e,NaN,NaN,NaN,NaN);return e==null?i:i.addAll(e)}function V2(e,t,n,i,r,s){this._x=e,this._y=t,this._x0=n,this._y0=i,this._x1=r,this._y1=s,this._root=void 0}function Bz(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var ar=H2.prototype=V2.prototype;ar.copy=function(){var e=new V2(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,i;if(!t)return e;if(!t.length)return e._root=Bz(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var r=0;r<4;++r)(i=t.source[r])&&(i.length?n.push({source:i,target:t.target[r]=new Array(4)}):t.target[r]=Bz(i));return e};ar.add=f1e;ar.addAll=p1e;ar.cover=g1e;ar.data=m1e;ar.extent=v1e;ar.find=C1e;ar.remove=y1e;ar.removeAll=w1e;ar.root=b1e;ar.size=S1e;ar.visit=x1e;ar.visitAfter=R1e;ar.x=F1e;ar.y=D1e;function Zi(e){return function(){return e}}function Tu(e){return(e()-.5)*1e-6}function P1e(e){return e.x+e.vx}function k1e(e){return e.y+e.vy}function T1e(e){var t,n,i,r=1,s=1;typeof e!="function"&&(e=Zi(e==null?1:+e));function o(){for(var u,c=t.length,d,h,p,g,v,C,y=0;y<s;++y)for(d=H2(t,P1e,k1e).visitAfter(a),u=0;u<c;++u)h=t[u],v=n[h.index],C=v*v,p=h.x+h.vx,g=h.y+h.vy,d.visit(b);function b(S,x,E,A,F){var k=S.data,P=S.r,_=v+P;if(k){if(k.index>h.index){var O=p-k.x-k.vx,H=g-k.y-k.vy,W=O*O+H*H;W<_*_&&(O===0&&(O=Tu(i),W+=O*O),H===0&&(H=Tu(i),W+=H*H),W=(_-(W=Math.sqrt(W)))/W*r,h.vx+=(O*=W)*(_=(P*=P)/(C+P)),h.vy+=(H*=W)*_,k.vx-=O*(_=1-_),k.vy-=H*_)}return}return x>p+_||A<p-_||E>g+_||F<g-_}}function a(u){if(u.data)return u.r=n[u.data.index];for(var c=u.r=0;c<4;++c)u[c]&&u[c].r>u.r&&(u.r=u[c].r)}function l(){if(t){var u,c=t.length,d;for(n=new Array(c),u=0;u<c;++u)d=t[u],n[d.index]=+e(d,u,t)}}return o.initialize=function(u,c){t=u,i=c,l()},o.iterations=function(u){return arguments.length?(s=+u,o):s},o.strength=function(u){return arguments.length?(r=+u,o):r},o.radius=function(u){return arguments.length?(e=typeof u=="function"?u:Zi(+u),l(),o):e},o}function M1e(e){return e.index}function Gz(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function I1e(e){var t=M1e,n=d,i,r=Zi(30),s,o,a,l,u,c=1;e==null&&(e=[]);function d(C){return 1/Math.min(a[C.source.index],a[C.target.index])}function h(C){for(var y=0,b=e.length;y<c;++y)for(var S=0,x,E,A,F,k,P,_;S<b;++S)x=e[S],E=x.source,A=x.target,F=A.x+A.vx-E.x-E.vx||Tu(u),k=A.y+A.vy-E.y-E.vy||Tu(u),P=Math.sqrt(F*F+k*k),P=(P-s[S])/P*C*i[S],F*=P,k*=P,A.vx-=F*(_=l[S]),A.vy-=k*_,E.vx+=F*(_=1-_),E.vy+=k*_}function p(){if(o){var C,y=o.length,b=e.length,S=new Map(o.map((E,A)=>[t(E,A,o),E])),x;for(C=0,a=new Array(y);C<b;++C)x=e[C],x.index=C,typeof x.source!="object"&&(x.source=Gz(S,x.source)),typeof x.target!="object"&&(x.target=Gz(S,x.target)),a[x.source.index]=(a[x.source.index]||0)+1,a[x.target.index]=(a[x.target.index]||0)+1;for(C=0,l=new Array(b);C<b;++C)x=e[C],l[C]=a[x.source.index]/(a[x.source.index]+a[x.target.index]);i=new Array(b),g(),s=new Array(b),v()}}function g(){if(o)for(var C=0,y=e.length;C<y;++C)i[C]=+n(e[C],C,e)}function v(){if(o)for(var C=0,y=e.length;C<y;++C)s[C]=+r(e[C],C,e)}return h.initialize=function(C,y){o=C,u=y,p()},h.links=function(C){return arguments.length?(e=C,p(),h):e},h.id=function(C){return arguments.length?(t=C,h):t},h.iterations=function(C){return arguments.length?(c=+C,h):c},h.strength=function(C){return arguments.length?(n=typeof C=="function"?C:Zi(+C),g(),h):n},h.distance=function(C){return arguments.length?(r=typeof C=="function"?C:Zi(+C),v(),h):r},h}var _1e={value:()=>{}};function hq(){for(var e=0,t=arguments.length,n={},i;e<t;++e){if(!(i=arguments[e]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new Pw(n)}function Pw(e){this._=e}function O1e(e,t){return e.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}Pw.prototype=hq.prototype={constructor:Pw,on:function(e,t){var n=this._,i=O1e(e+"",n),r,s=-1,o=i.length;if(arguments.length<2){for(;++s<o;)if((r=(e=i[s]).type)&&(r=L1e(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(r=(e=i[s]).type)n[r]=zz(n[r],e.name,t);else if(t==null)for(r in n)n[r]=zz(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Pw(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,s;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],i=0,r=s.length;i<r;++i)s[i].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],r=0,s=i.length;r<s;++r)i[r].value.apply(t,n)}};function L1e(e,t){for(var n=0,i=e.length,r;n<i;++n)if((r=e[n]).name===t)return r.value}function zz(e,t,n){for(var i=0,r=e.length;i<r;++i)if(e[i].name===t){e[i]=_1e,e=e.slice(0,i).concat(e.slice(i+1));break}return n!=null&&e.push({name:t,value:n}),e}var np=0,Im=0,Qg=0,fq=1e3,eS,_m,tS=0,Ld=0,rx=0,_v=typeof performance=="object"&&performance.now?performance:Date,pq=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function W2(){return Ld||(pq(N1e),Ld=_v.now()+rx)}function N1e(){Ld=0}function nS(){this._call=this._time=this._next=null}nS.prototype=gq.prototype={constructor:nS,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?W2():+n)+(t==null?0:+t),!this._next&&_m!==this&&(_m?_m._next=this:eS=this,_m=this),this._call=e,this._time=n,tk()},stop:function(){this._call&&(this._call=null,this._time=1/0,tk())}};function gq(e,t,n){var i=new nS;return i.restart(e,t,n),i}function $1e(){W2(),++np;for(var e=eS,t;e;)(t=Ld-e._time)>=0&&e._call.call(void 0,t),e=e._next;--np}function Hz(){Ld=(tS=_v.now())+rx,np=Im=0;try{$1e()}finally{np=0,G1e(),Ld=0}}function B1e(){var e=_v.now(),t=e-tS;t>fq&&(rx-=t,tS=e)}function G1e(){for(var e,t=eS,n,i=1/0;t;)t._call?(i>t._time&&(i=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:eS=n);_m=e,tk(i)}function tk(e){if(!np){Im&&(Im=clearTimeout(Im));var t=e-Ld;t>24?(e<1/0&&(Im=setTimeout(Hz,e-_v.now()-rx)),Qg&&(Qg=clearInterval(Qg))):(Qg||(tS=_v.now(),Qg=setInterval(B1e,fq)),np=1,pq(Hz))}}function z1e(e,t,n){var i=new nS,r=t;return t==null?(i.restart(e,t,n),i):(i._restart=i.restart,i.restart=function(s,o,a){o=+o,a=a==null?W2():+a,i._restart(function l(u){u+=r,i._restart(l,r+=o,a),s(u)},o,a)},i.restart(e,t,n),i)}const H1e=1664525,V1e=1013904223,Vz=4294967296;function W1e(){let e=1;return()=>(e=(H1e*e+V1e)%Vz)/Vz}function U1e(e){return e.x}function j1e(e){return e.y}var q1e=10,K1e=Math.PI*(3-Math.sqrt(5));function Y1e(e){var t,n=1,i=.001,r=1-Math.pow(i,1/300),s=0,o=.6,a=new Map,l=gq(d),u=hq("tick","end"),c=W1e();e==null&&(e=[]);function d(){h(),u.call("tick",t),n<i&&(l.stop(),u.call("end",t))}function h(v){var C,y=e.length,b;v===void 0&&(v=1);for(var S=0;S<v;++S)for(n+=(s-n)*r,a.forEach(function(x){x(n)}),C=0;C<y;++C)b=e[C],b.fx==null?b.x+=b.vx*=o:(b.x=b.fx,b.vx=0),b.fy==null?b.y+=b.vy*=o:(b.y=b.fy,b.vy=0);return t}function p(){for(var v=0,C=e.length,y;v<C;++v){if(y=e[v],y.index=v,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var b=q1e*Math.sqrt(.5+v),S=v*K1e;y.x=b*Math.cos(S),y.y=b*Math.sin(S)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function g(v){return v.initialize&&v.initialize(e,c),v}return p(),t={tick:h,restart:function(){return l.restart(d),t},stop:function(){return l.stop(),t},nodes:function(v){return arguments.length?(e=v,p(),a.forEach(g),t):e},alpha:function(v){return arguments.length?(n=+v,t):n},alphaMin:function(v){return arguments.length?(i=+v,t):i},alphaDecay:function(v){return arguments.length?(r=+v,t):+r},alphaTarget:function(v){return arguments.length?(s=+v,t):s},velocityDecay:function(v){return arguments.length?(o=1-v,t):1-o},randomSource:function(v){return arguments.length?(c=v,a.forEach(g),t):c},force:function(v,C){return arguments.length>1?(C==null?a.delete(v):a.set(v,g(C)),t):a.get(v)},find:function(v,C,y){var b=0,S=e.length,x,E,A,F,k;for(y==null?y=1/0:y*=y,b=0;b<S;++b)F=e[b],x=v-F.x,E=C-F.y,A=x*x+E*E,A<y&&(k=F,y=A);return k},on:function(v,C){return arguments.length>1?(u.on(v,C),t):u.on(v)}}}function X1e(){var e,t,n,i,r=Zi(-30),s,o=1,a=1/0,l=.81;function u(p){var g,v=e.length,C=H2(e,U1e,j1e).visitAfter(d);for(i=p,g=0;g<v;++g)t=e[g],C.visit(h)}function c(){if(e){var p,g=e.length,v;for(s=new Array(g),p=0;p<g;++p)v=e[p],s[v.index]=+r(v,p,e)}}function d(p){var g=0,v,C,y=0,b,S,x;if(p.length){for(b=S=x=0;x<4;++x)(v=p[x])&&(C=Math.abs(v.value))&&(g+=v.value,y+=C,b+=C*v.x,S+=C*v.y);p.x=b/y,p.y=S/y}else{v=p,v.x=v.data.x,v.y=v.data.y;do g+=s[v.data.index];while(v=v.next)}p.value=g}function h(p,g,v,C){if(!p.value)return!0;var y=p.x-t.x,b=p.y-t.y,S=C-g,x=y*y+b*b;if(S*S/l<x)return x<a&&(y===0&&(y=Tu(n),x+=y*y),b===0&&(b=Tu(n),x+=b*b),x<o&&(x=Math.sqrt(o*x)),t.vx+=y*p.value*i/x,t.vy+=b*p.value*i/x),!0;if(p.length||x>=a)return;(p.data!==t||p.next)&&(y===0&&(y=Tu(n),x+=y*y),b===0&&(b=Tu(n),x+=b*b),x<o&&(x=Math.sqrt(o*x)));do p.data!==t&&(S=s[p.data.index]*i/x,t.vx+=y*S,t.vy+=b*S);while(p=p.next)}return u.initialize=function(p,g){e=p,n=g,c()},u.strength=function(p){return arguments.length?(r=typeof p=="function"?p:Zi(+p),c(),u):r},u.distanceMin=function(p){return arguments.length?(o=p*p,u):Math.sqrt(o)},u.distanceMax=function(p){return arguments.length?(a=p*p,u):Math.sqrt(a)},u.theta=function(p){return arguments.length?(l=p*p,u):Math.sqrt(l)},u}function Q1e(e){var t=Zi(.1),n,i,r;typeof e!="function"&&(e=Zi(e==null?0:+e));function s(a){for(var l=0,u=n.length,c;l<u;++l)c=n[l],c.vx+=(r[l]-c.x)*i[l]*a}function o(){if(n){var a,l=n.length;for(i=new Array(l),r=new Array(l),a=0;a<l;++a)i[a]=isNaN(r[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return s.initialize=function(a){n=a,o()},s.strength=function(a){return arguments.length?(t=typeof a=="function"?a:Zi(+a),o(),s):t},s.x=function(a){return arguments.length?(e=typeof a=="function"?a:Zi(+a),o(),s):e},s}function J1e(e){var t=Zi(.1),n,i,r;typeof e!="function"&&(e=Zi(e==null?0:+e));function s(a){for(var l=0,u=n.length,c;l<u;++l)c=n[l],c.vy+=(r[l]-c.y)*i[l]*a}function o(){if(n){var a,l=n.length;for(i=new Array(l),r=new Array(l),a=0;a<l;++a)i[a]=isNaN(r[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return s.initialize=function(a){n=a,o()},s.strength=function(a){return arguments.length?(t=typeof a=="function"?a:Zi(+a),o(),s):t},s.y=function(a){return arguments.length?(e=typeof a=="function"?a:Zi(+a),o(),s):e},s}const Wz={center:h1e,collide:T1e,nbody:X1e,link:I1e,x:Q1e,y:J1e},Om="forces",nk=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],Z1e=["static","iterations"],mq=["x","y","vx","vy"];function U2(e){Y.call(this,null,e)}U2.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30,expr:!0},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:mq}]};pe(U2,Y,{transform(e,t){var n=this.value,i=t.changed(t.ADD_REM),r=e.modified(nk),s=e.iterations||300;if(n?(i&&(t.modifies("index"),n.nodes(t.source)),(r||t.changed(t.MOD))&&vq(n,e,0,t)):(this.value=n=txe(t.source,e),n.on("tick",exe(t.dataflow,this)),e.static||(i=!0,n.tick()),t.modifies("index")),r||i||e.modified(Z1e)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/s)),e.static)for(n.stop();--s>=0;)n.tick();else if(n.stopped()&&n.restart(),!i)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let a=this._argops,l=0,u=a.length,c;l<u;++l)if(c=a[l],!(c.name!==Om||c.op._argval.force!=="link")){for(var i=c.op._argops,r=0,s=i.length,o;r<s;++r)if(i[r].name==="links"&&(o=i[r].op.source)){n.pulse(o,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(mq)}});function exe(e,t){return()=>e.touch(t).run()}function txe(e,t){const n=Y1e(e),i=n.stop,r=n.restart;let s=!1;return n.stopped=()=>s,n.restart=()=>(s=!1,r()),n.stop=()=>(s=!0,i()),vq(n,t,!0).on("end",()=>s=!0)}function vq(e,t,n,i){var r=we(t.forces),s,o,a,l;for(s=0,o=nk.length;s<o;++s)a=nk[s],a!==Om&&t.modified(a)&&e[a](t[a]);for(s=0,o=r.length;s<o;++s)l=Om+s,a=n||t.modified(Om,s)?ixe(r[s]):i&&nxe(r[s],i)?e.force(l):null,a&&e.force(l,a);for(o=e.numForces||0;s<o;++s)e.force(Om+s,null);return e.numForces=r.length,e}function nxe(e,t){var n,i;for(n in e)if(nt(i=e[n])&&t.modified(Pi(i)))return 1;return 0}function ixe(e){var t,n;Ee(Wz,e.force)||Z("Unrecognized force: "+e.force),t=Wz[e.force]();for(n in e)nt(t[n])&&rxe(t[n],e[n],e);return t}function rxe(e,t,n){e(nt(t)?i=>t(i,n):t)}const sxe=Object.freeze(Object.defineProperty({__proto__:null,force:U2},Symbol.toStringTag,{value:"Module"}));function oxe(e,t){return e.parent===t.parent?1:2}function axe(e){return e.reduce(lxe,0)/e.length}function lxe(e,t){return e+t.x}function uxe(e){return 1+e.reduce(cxe,0)}function cxe(e,t){return Math.max(e,t.y)}function dxe(e){for(var t;t=e.children;)e=t[0];return e}function hxe(e){for(var t;t=e.children;)e=t[t.length-1];return e}function fxe(){var e=oxe,t=1,n=1,i=!1;function r(s){var o,a=0;s.eachAfter(function(h){var p=h.children;p?(h.x=axe(p),h.y=uxe(p)):(h.x=o?a+=e(h,o):0,h.y=0,o=h)});var l=dxe(s),u=hxe(s),c=l.x-e(l,u)/2,d=u.x+e(u,l)/2;return s.eachAfter(i?function(h){h.x=(h.x-s.x)*t,h.y=(s.y-h.y)*n}:function(h){h.x=(h.x-c)/(d-c)*t,h.y=(1-(s.y?h.y/s.y:1))*n})}return r.separation=function(s){return arguments.length?(e=s,r):e},r.size=function(s){return arguments.length?(i=!1,t=+s[0],n=+s[1],r):i?null:[t,n]},r.nodeSize=function(s){return arguments.length?(i=!0,t=+s[0],n=+s[1],r):i?[t,n]:null},r}function pxe(e){var t=0,n=e.children,i=n&&n.length;if(!i)t=1;else for(;--i>=0;)t+=n[i].value;e.value=t}function gxe(){return this.eachAfter(pxe)}function mxe(e,t){let n=-1;for(const i of this)e.call(t,i,++n,this);return this}function vxe(e,t){for(var n=this,i=[n],r,s,o=-1;n=i.pop();)if(e.call(t,n,++o,this),r=n.children)for(s=r.length-1;s>=0;--s)i.push(r[s]);return this}function Cxe(e,t){for(var n=this,i=[n],r=[],s,o,a,l=-1;n=i.pop();)if(r.push(n),s=n.children)for(o=0,a=s.length;o<a;++o)i.push(s[o]);for(;n=r.pop();)e.call(t,n,++l,this);return this}function yxe(e,t){let n=-1;for(const i of this)if(e.call(t,i,++n,this))return i}function wxe(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,i=t.children,r=i&&i.length;--r>=0;)n+=i[r].value;t.value=n})}function bxe(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function Sxe(e){for(var t=this,n=xxe(t,e),i=[t];t!==n;)t=t.parent,i.push(t);for(var r=i.length;e!==n;)i.splice(r,0,e),e=e.parent;return i}function xxe(e,t){if(e===t)return e;var n=e.ancestors(),i=t.ancestors(),r=null;for(e=n.pop(),t=i.pop();e===t;)r=e,e=n.pop(),t=i.pop();return r}function Rxe(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function Exe(){return Array.from(this)}function Fxe(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function Axe(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*Dxe(){var e=this,t,n=[e],i,r,s;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,i=e.children)for(r=0,s=i.length;r<s;++r)n.push(i[r]);while(n.length)}function j2(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=Txe)):t===void 0&&(t=kxe);for(var n=new ip(e),i,r=[n],s,o,a,l;i=r.pop();)if((o=t(i.data))&&(l=(o=Array.from(o)).length))for(i.children=o,a=l-1;a>=0;--a)r.push(s=o[a]=new ip(o[a])),s.parent=i,s.depth=i.depth+1;return n.eachBefore(Cq)}function Pxe(){return j2(this).eachBefore(Mxe)}function kxe(e){return e.children}function Txe(e){return Array.isArray(e)?e[1]:null}function Mxe(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function Cq(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function ip(e){this.data=e,this.depth=this.height=0,this.parent=null}ip.prototype=j2.prototype={constructor:ip,count:gxe,each:mxe,eachAfter:Cxe,eachBefore:vxe,find:yxe,sum:wxe,sort:bxe,path:Sxe,ancestors:Rxe,descendants:Exe,leaves:Fxe,links:Axe,copy:Pxe,[Symbol.iterator]:Dxe};function kw(e){return e==null?null:yq(e)}function yq(e){if(typeof e!="function")throw new Error;return e}function od(){return 0}function nf(e){return function(){return e}}const Ixe=1664525,_xe=1013904223,Uz=4294967296;function Oxe(){let e=1;return()=>(e=(Ixe*e+_xe)%Uz)/Uz}function Lxe(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Nxe(e,t){let n=e.length,i,r;for(;n;)r=t()*n--|0,i=e[n],e[n]=e[r],e[r]=i;return e}function $xe(e,t){for(var n=0,i=(e=Nxe(Array.from(e),t)).length,r=[],s,o;n<i;)s=e[n],o&&wq(o,s)?++n:(o=Gxe(r=Bxe(r,s)),n=0);return o}function Bxe(e,t){var n,i;if(HF(t,e))return[t];for(n=0;n<e.length;++n)if(Oy(t,e[n])&&HF(Lm(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(i=n+1;i<e.length;++i)if(Oy(Lm(e[n],e[i]),t)&&Oy(Lm(e[n],t),e[i])&&Oy(Lm(e[i],t),e[n])&&HF(bq(e[n],e[i],t),e))return[e[n],e[i],t];throw new Error}function Oy(e,t){var n=e.r-t.r,i=t.x-e.x,r=t.y-e.y;return n<0||n*n<i*i+r*r}function wq(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function HF(e,t){for(var n=0;n<t.length;++n)if(!wq(e,t[n]))return!1;return!0}function Gxe(e){switch(e.length){case 1:return zxe(e[0]);case 2:return Lm(e[0],e[1]);case 3:return bq(e[0],e[1],e[2])}}function zxe(e){return{x:e.x,y:e.y,r:e.r}}function Lm(e,t){var n=e.x,i=e.y,r=e.r,s=t.x,o=t.y,a=t.r,l=s-n,u=o-i,c=a-r,d=Math.sqrt(l*l+u*u);return{x:(n+s+l/d*c)/2,y:(i+o+u/d*c)/2,r:(d+r+a)/2}}function bq(e,t,n){var i=e.x,r=e.y,s=e.r,o=t.x,a=t.y,l=t.r,u=n.x,c=n.y,d=n.r,h=i-o,p=i-u,g=r-a,v=r-c,C=l-s,y=d-s,b=i*i+r*r-s*s,S=b-o*o-a*a+l*l,x=b-u*u-c*c+d*d,E=p*g-h*v,A=(g*x-v*S)/(E*2)-i,F=(v*C-g*y)/E,k=(p*S-h*x)/(E*2)-r,P=(h*y-p*C)/E,_=F*F+P*P-1,O=2*(s+A*F+k*P),H=A*A+k*k-s*s,W=-(Math.abs(_)>1e-6?(O+Math.sqrt(O*O-4*_*H))/(2*_):H/O);return{x:i+A+F*W,y:r+k+P*W,r:W}}function jz(e,t,n){var i=e.x-t.x,r,s,o=e.y-t.y,a,l,u=i*i+o*o;u?(s=t.r+n.r,s*=s,l=e.r+n.r,l*=l,s>l?(r=(u+l-s)/(2*u),a=Math.sqrt(Math.max(0,l/u-r*r)),n.x=e.x-r*i-a*o,n.y=e.y-r*o+a*i):(r=(u+s-l)/(2*u),a=Math.sqrt(Math.max(0,s/u-r*r)),n.x=t.x+r*i-a*o,n.y=t.y+r*o+a*i)):(n.x=t.x+n.r,n.y=t.y)}function qz(e,t){var n=e.r+t.r-1e-6,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function Kz(e){var t=e._,n=e.next._,i=t.r+n.r,r=(t.x*n.r+n.x*t.r)/i,s=(t.y*n.r+n.y*t.r)/i;return r*r+s*s}function Ly(e){this._=e,this.next=null,this.previous=null}function Hxe(e,t){if(!(s=(e=Lxe(e)).length))return 0;var n,i,r,s,o,a,l,u,c,d,h;if(n=e[0],n.x=0,n.y=0,!(s>1))return n.r;if(i=e[1],n.x=-i.r,i.x=n.r,i.y=0,!(s>2))return n.r+i.r;jz(i,n,r=e[2]),n=new Ly(n),i=new Ly(i),r=new Ly(r),n.next=r.previous=i,i.next=n.previous=r,r.next=i.previous=n;e:for(l=3;l<s;++l){jz(n._,i._,r=e[l]),r=new Ly(r),u=i.next,c=n.previous,d=i._.r,h=n._.r;do if(d<=h){if(qz(u._,r._)){i=u,n.next=i,i.previous=n,--l;continue e}d+=u._.r,u=u.next}else{if(qz(c._,r._)){n=c,n.next=i,i.previous=n,--l;continue e}h+=c._.r,c=c.previous}while(u!==c.next);for(r.previous=n,r.next=i,n.next=i.previous=i=r,o=Kz(n);(r=r.next)!==i;)(a=Kz(r))<o&&(n=r,o=a);i=n.next}for(n=[i._],r=i;(r=r.next)!==i;)n.push(r._);for(r=$xe(n,t),l=0;l<s;++l)n=e[l],n.x-=r.x,n.y-=r.y;return r.r}function Vxe(e){return Math.sqrt(e.value)}function Wxe(){var e=null,t=1,n=1,i=od;function r(s){const o=Oxe();return s.x=t/2,s.y=n/2,e?s.eachBefore(Yz(e)).eachAfter(VF(i,.5,o)).eachBefore(Xz(1)):s.eachBefore(Yz(Vxe)).eachAfter(VF(od,1,o)).eachAfter(VF(i,s.r/Math.min(t,n),o)).eachBefore(Xz(Math.min(t,n)/(2*s.r))),s}return r.radius=function(s){return arguments.length?(e=kw(s),r):e},r.size=function(s){return arguments.length?(t=+s[0],n=+s[1],r):[t,n]},r.padding=function(s){return arguments.length?(i=typeof s=="function"?s:nf(+s),r):i},r}function Yz(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function VF(e,t,n){return function(i){if(r=i.children){var r,s,o=r.length,a=e(i)*t||0,l;if(a)for(s=0;s<o;++s)r[s].r+=a;if(l=Hxe(r,n),a)for(s=0;s<o;++s)r[s].r-=a;i.r=l+a}}}function Xz(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function Sq(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function H0(e,t,n,i,r){for(var s=e.children,o,a=-1,l=s.length,u=e.value&&(i-t)/e.value;++a<l;)o=s[a],o.y0=n,o.y1=r,o.x0=t,o.x1=t+=o.value*u}function Uxe(){var e=1,t=1,n=0,i=!1;function r(o){var a=o.height+1;return o.x0=o.y0=n,o.x1=e,o.y1=t/a,o.eachBefore(s(t,a)),i&&o.eachBefore(Sq),o}function s(o,a){return function(l){l.children&&H0(l,l.x0,o*(l.depth+1)/a,l.x1,o*(l.depth+2)/a);var u=l.x0,c=l.y0,d=l.x1-n,h=l.y1-n;d<u&&(u=d=(u+d)/2),h<c&&(c=h=(c+h)/2),l.x0=u,l.y0=c,l.x1=d,l.y1=h}}return r.round=function(o){return arguments.length?(i=!!o,r):i},r.size=function(o){return arguments.length?(e=+o[0],t=+o[1],r):[e,t]},r.padding=function(o){return arguments.length?(n=+o,r):n},r}var jxe={depth:-1},Qz={},WF={};function qxe(e){return e.id}function Kxe(e){return e.parentId}function Jz(){var e=qxe,t=Kxe,n;function i(r){var s=Array.from(r),o=e,a=t,l,u,c,d,h,p,g,v,C=new Map;if(n!=null){const y=s.map((x,E)=>Yxe(n(x,E,r))),b=y.map(Zz),S=new Set(y).add("");for(const x of b)S.has(x)||(S.add(x),y.push(x),b.push(Zz(x)),s.push(WF));o=(x,E)=>y[E],a=(x,E)=>b[E]}for(c=0,l=s.length;c<l;++c)u=s[c],p=s[c]=new ip(u),(g=o(u,c,r))!=null&&(g+="")&&(v=p.id=g,C.set(v,C.has(v)?Qz:p)),(g=a(u,c,r))!=null&&(g+="")&&(p.parent=g);for(c=0;c<l;++c)if(p=s[c],g=p.parent){if(h=C.get(g),!h)throw new Error("missing: "+g);if(h===Qz)throw new Error("ambiguous: "+g);h.children?h.children.push(p):h.children=[p],p.parent=h}else{if(d)throw new Error("multiple roots");d=p}if(!d)throw new Error("no root");if(n!=null){for(;d.data===WF&&d.children.length===1;)d=d.children[0],--l;for(let y=s.length-1;y>=0&&(p=s[y],p.data===WF);--y)p.data=null}if(d.parent=jxe,d.eachBefore(function(y){y.depth=y.parent.depth+1,--l}).eachBefore(Cq),d.parent=null,l>0)throw new Error("cycle");return d}return i.id=function(r){return arguments.length?(e=kw(r),i):e},i.parentId=function(r){return arguments.length?(t=kw(r),i):t},i.path=function(r){return arguments.length?(n=kw(r),i):n},i}function Yxe(e){e=`${e}`;let t=e.length;return ik(e,t-1)&&!ik(e,t-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function Zz(e){let t=e.length;if(t<2)return"";for(;--t>1&&!ik(e,t););return e.slice(0,t)}function ik(e,t){if(e[t]==="/"){let n=0;for(;t>0&&e[--t]==="\\";)++n;if(!(n&1))return!0}return!1}function Xxe(e,t){return e.parent===t.parent?1:2}function UF(e){var t=e.children;return t?t[0]:e.t}function jF(e){var t=e.children;return t?t[t.length-1]:e.t}function Qxe(e,t,n){var i=n/(t.i-e.i);t.c-=i,t.s+=n,e.c+=i,t.z+=n,t.m+=n}function Jxe(e){for(var t=0,n=0,i=e.children,r=i.length,s;--r>=0;)s=i[r],s.z+=t,s.m+=t,t+=s.s+(n+=s.c)}function Zxe(e,t,n){return e.a.parent===t.parent?e.a:n}function Tw(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}Tw.prototype=Object.create(ip.prototype);function eRe(e){for(var t=new Tw(e,0),n,i=[t],r,s,o,a;n=i.pop();)if(s=n._.children)for(n.children=new Array(a=s.length),o=a-1;o>=0;--o)i.push(r=n.children[o]=new Tw(s[o],o)),r.parent=n;return(t.parent=new Tw(null,0)).children=[t],t}function tRe(){var e=Xxe,t=1,n=1,i=null;function r(u){var c=eRe(u);if(c.eachAfter(s),c.parent.m=-c.z,c.eachBefore(o),i)u.eachBefore(l);else{var d=u,h=u,p=u;u.eachBefore(function(b){b.x<d.x&&(d=b),b.x>h.x&&(h=b),b.depth>p.depth&&(p=b)});var g=d===h?1:e(d,h)/2,v=g-d.x,C=t/(h.x+g+v),y=n/(p.depth||1);u.eachBefore(function(b){b.x=(b.x+v)*C,b.y=b.depth*y})}return u}function s(u){var c=u.children,d=u.parent.children,h=u.i?d[u.i-1]:null;if(c){Jxe(u);var p=(c[0].z+c[c.length-1].z)/2;h?(u.z=h.z+e(u._,h._),u.m=u.z-p):u.z=p}else h&&(u.z=h.z+e(u._,h._));u.parent.A=a(u,h,u.parent.A||d[0])}function o(u){u._.x=u.z+u.parent.m,u.m+=u.parent.m}function a(u,c,d){if(c){for(var h=u,p=u,g=c,v=h.parent.children[0],C=h.m,y=p.m,b=g.m,S=v.m,x;g=jF(g),h=UF(h),g&&h;)v=UF(v),p=jF(p),p.a=u,x=g.z+b-h.z-C+e(g._,h._),x>0&&(Qxe(Zxe(g,u,d),u,x),C+=x,y+=x),b+=g.m,C+=h.m,S+=v.m,y+=p.m;g&&!jF(p)&&(p.t=g,p.m+=b-y),h&&!UF(v)&&(v.t=h,v.m+=C-S,d=u)}return d}function l(u){u.x*=t,u.y=u.depth*n}return r.separation=function(u){return arguments.length?(e=u,r):e},r.size=function(u){return arguments.length?(i=!1,t=+u[0],n=+u[1],r):i?null:[t,n]},r.nodeSize=function(u){return arguments.length?(i=!0,t=+u[0],n=+u[1],r):i?[t,n]:null},r}function sx(e,t,n,i,r){for(var s=e.children,o,a=-1,l=s.length,u=e.value&&(r-n)/e.value;++a<l;)o=s[a],o.x0=t,o.x1=i,o.y0=n,o.y1=n+=o.value*u}var xq=(1+Math.sqrt(5))/2;function Rq(e,t,n,i,r,s){for(var o=[],a=t.children,l,u,c=0,d=0,h=a.length,p,g,v=t.value,C,y,b,S,x,E,A;c<h;){p=r-n,g=s-i;do C=a[d++].value;while(!C&&d<h);for(y=b=C,E=Math.max(g/p,p/g)/(v*e),A=C*C*E,x=Math.max(b/A,A/y);d<h;++d){if(C+=u=a[d].value,u<y&&(y=u),u>b&&(b=u),A=C*C*E,S=Math.max(b/A,A/y),S>x){C-=u;break}x=S}o.push(l={value:C,dice:p<g,children:a.slice(c,d)}),l.dice?H0(l,n,i,r,v?i+=g*C/v:s):sx(l,n,i,v?n+=p*C/v:r,s),v-=C,c=d}return o}const Eq=function e(t){function n(i,r,s,o,a){Rq(t,i,r,s,o,a)}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(xq);function nRe(){var e=Eq,t=!1,n=1,i=1,r=[0],s=od,o=od,a=od,l=od,u=od;function c(h){return h.x0=h.y0=0,h.x1=n,h.y1=i,h.eachBefore(d),r=[0],t&&h.eachBefore(Sq),h}function d(h){var p=r[h.depth],g=h.x0+p,v=h.y0+p,C=h.x1-p,y=h.y1-p;C<g&&(g=C=(g+C)/2),y<v&&(v=y=(v+y)/2),h.x0=g,h.y0=v,h.x1=C,h.y1=y,h.children&&(p=r[h.depth+1]=s(h)/2,g+=u(h)-p,v+=o(h)-p,C-=a(h)-p,y-=l(h)-p,C<g&&(g=C=(g+C)/2),y<v&&(v=y=(v+y)/2),e(h,g,v,C,y))}return c.round=function(h){return arguments.length?(t=!!h,c):t},c.size=function(h){return arguments.length?(n=+h[0],i=+h[1],c):[n,i]},c.tile=function(h){return arguments.length?(e=yq(h),c):e},c.padding=function(h){return arguments.length?c.paddingInner(h).paddingOuter(h):c.paddingInner()},c.paddingInner=function(h){return arguments.length?(s=typeof h=="function"?h:nf(+h),c):s},c.paddingOuter=function(h){return arguments.length?c.paddingTop(h).paddingRight(h).paddingBottom(h).paddingLeft(h):c.paddingTop()},c.paddingTop=function(h){return arguments.length?(o=typeof h=="function"?h:nf(+h),c):o},c.paddingRight=function(h){return arguments.length?(a=typeof h=="function"?h:nf(+h),c):a},c.paddingBottom=function(h){return arguments.length?(l=typeof h=="function"?h:nf(+h),c):l},c.paddingLeft=function(h){return arguments.length?(u=typeof h=="function"?h:nf(+h),c):u},c}function iRe(e,t,n,i,r){var s=e.children,o,a=s.length,l,u=new Array(a+1);for(u[0]=l=o=0;o<a;++o)u[o+1]=l+=s[o].value;c(0,a,e.value,t,n,i,r);function c(d,h,p,g,v,C,y){if(d>=h-1){var b=s[d];b.x0=g,b.y0=v,b.x1=C,b.y1=y;return}for(var S=u[d],x=p/2+S,E=d+1,A=h-1;E<A;){var F=E+A>>>1;u[F]<x?E=F+1:A=F}x-u[E-1]<u[E]-x&&d+1<E&&--E;var k=u[E]-S,P=p-k;if(C-g>y-v){var _=p?(g*P+C*k)/p:C;c(d,E,k,g,v,_,y),c(E,h,P,_,v,C,y)}else{var O=p?(v*P+y*k)/p:y;c(d,E,k,g,v,C,O),c(E,h,P,g,O,C,y)}}}function rRe(e,t,n,i,r){(e.depth&1?sx:H0)(e,t,n,i,r)}const sRe=function e(t){function n(i,r,s,o,a){if((l=i._squarify)&&l.ratio===t)for(var l,u,c,d,h=-1,p,g=l.length,v=i.value;++h<g;){for(u=l[h],c=u.children,d=u.value=0,p=c.length;d<p;++d)u.value+=c[d].value;u.dice?H0(u,r,s,o,v?s+=(a-s)*u.value/v:a):sx(u,r,s,v?r+=(o-r)*u.value/v:o,a),v-=u.value}else i._squarify=l=Rq(t,i,r,s,o,a),l.ratio=t}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(xq);function rk(e,t,n){const i={};return e.each(r=>{const s=r.data;n(s)&&(i[t(s)]=r)}),e.lookup=i,e}function q2(e){Y.call(this,null,e)}q2.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const oRe=e=>e.values;pe(q2,Y,{transform(e,t){t.source||Z("Nest transform requires an upstream data source.");var n=e.generate,i=e.modified(),r=t.clone(),s=this.value;return(!s||i||t.changed())&&(s&&s.each(o=>{o.children&&C1(o.data)&&r.rem.push(o.data)}),this.value=s=j2({values:we(e.keys).reduce((o,a)=>(o.key(a),o),aRe()).entries(r.source)},oRe),n&&s.each(o=>{o.children&&(o=Dt(o.data),r.add.push(o),r.source.push(o))}),rk(s,_e,_e)),r.source.root=s,r}});function aRe(){const e=[],t={entries:r=>i(n(r,0),0),key:r=>(e.push(r),t)};function n(r,s){if(s>=e.length)return r;const o=r.length,a=e[s++],l={},u={};let c=-1,d,h,p;for(;++c<o;)d=a(h=r[c])+"",(p=l[d])?p.push(h):l[d]=[h];for(d in l)u[d]=n(l[d],s);return u}function i(r,s){if(++s>e.length)return r;const o=[];for(const a in r)o.push({key:a,values:i(r[a],s)});return o}return t}function Wl(e){Y.call(this,null,e)}const lRe=(e,t)=>e.parent===t.parent?1:2;pe(Wl,Y,{transform(e,t){(!t.source||!t.source.root)&&Z(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),i=this.fields,r=t.source.root,s=e.as||i;e.field?r.sum(e.field):r.count(),e.sort&&r.sort(ih(e.sort,o=>o.data)),uRe(n,this.params,e),n.separation&&n.separation(e.separation!==!1?lRe:Tp);try{this.value=n(r)}catch(o){Z(o)}return r.each(o=>cRe(o,i,s)),t.reflow(e.modified()).modifies(s).modifies("leaf")}});function uRe(e,t,n){for(let i,r=0,s=t.length;r<s;++r)i=t[r],i in n&&e[i](n[i])}function cRe(e,t,n){const i=e.data,r=t.length-1;for(let s=0;s<r;++s)i[n[s]]=e[t[s]];i[n[r]]=e.children?e.children.length:0}const sk=["x","y","r","depth","children"];function K2(e){Wl.call(this,e)}K2.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:sk.length,default:sk}]};pe(K2,Wl,{layout:Wxe,params:["radius","size","padding"],fields:sk});const ok=["x0","y0","x1","y1","depth","children"];function Y2(e){Wl.call(this,e)}Y2.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:ok.length,default:ok}]};pe(Y2,Wl,{layout:Uxe,params:["size","round","padding"],fields:ok});function X2(e){Y.call(this,null,e)}X2.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};pe(X2,Y,{transform(e,t){t.source||Z("Stratify transform requires an upstream data source.");let n=this.value;const i=e.modified(),r=t.fork(t.ALL).materialize(t.SOURCE),s=!n||i||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return r.source=r.source.slice(),s&&(n=r.source.length?rk(Jz().id(e.key).parentId(e.parentKey)(r.source),e.key,Is):rk(Jz()([{}]),e.key,e.key)),r.source.root=this.value=n,r}});const eH={tidy:tRe,cluster:fxe},ak=["x","y","depth","children"];function Q2(e){Wl.call(this,e)}Q2.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:ak.length,default:ak}]};pe(Q2,Wl,{layout(e){const t=e||"tidy";if(Ee(eH,t))return eH[t]();Z("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:ak});function J2(e){Y.call(this,[],e)}J2.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};pe(J2,Y,{transform(e,t){const n=this.value,i=t.source&&t.source.root,r=t.fork(t.NO_SOURCE),s={};return i||Z("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(r.rem=n,t.visit(t.SOURCE,o=>s[_e(o)]=1),i.each(o=>{const a=o.data,l=o.parent&&o.parent.data;l&&s[_e(a)]&&s[_e(l)]&&r.add.push(Dt({source:l,target:a}))}),this.value=r.add):t.changed(t.MOD)&&(t.visit(t.MOD,o=>s[_e(o)]=1),n.forEach(o=>{(s[_e(o.source)]||s[_e(o.target)])&&r.mod.push(o)})),r}});const tH={binary:iRe,dice:H0,slice:sx,slicedice:rRe,squarify:Eq,resquarify:sRe},lk=["x0","y0","x1","y1","depth","children"];function Z2(e){Wl.call(this,e)}Z2.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:lk.length,default:lk}]};pe(Z2,Wl,{layout(){const e=nRe();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{Ee(tH,t)?e.tile(tH[t]):Z("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:lk});const dRe=Object.freeze(Object.defineProperty({__proto__:null,nest:q2,pack:K2,partition:Y2,stratify:X2,tree:Q2,treelinks:J2,treemap:Z2},Symbol.toStringTag,{value:"Module"})),qF=4278190080;function hRe(e,t){const n=e.bitmap();return(t||[]).forEach(i=>n.set(e(i.boundary[0]),e(i.boundary[3]))),[n,void 0]}function fRe(e,t,n,i,r){const s=e.width,o=e.height,a=i||r,l=$u(s,o).getContext("2d"),u=$u(s,o).getContext("2d"),c=a&&$u(s,o).getContext("2d");n.forEach(k=>Mw(l,k,!1)),Mw(u,t,!1),a&&Mw(c,t,!0);const d=KF(l,s,o),h=KF(u,s,o),p=a&&KF(c,s,o),g=e.bitmap(),v=a&&e.bitmap();let C,y,b,S,x,E,A,F;for(y=0;y<o;++y)for(C=0;C<s;++C)x=y*s+C,E=d[x]&qF,F=h[x]&qF,A=a&&p[x]&qF,(E||A||F)&&(b=e(C),S=e(y),!r&&(E||F)&&g.set(b,S),a&&(E||A)&&v.set(b,S));return[g,v]}function KF(e,t,n){return new Uint32Array(e.getImageData(0,0,t,n).data.buffer)}function Mw(e,t,n){if(!t.length)return;const i=t[0].mark.marktype;i==="group"?t.forEach(r=>{r.items.forEach(s=>Mw(e,s.items,n))}):ts[i].draw(e,{items:n?t.map(pRe):t})}function pRe(e){const t=y1(e,{});return t.stroke&&t.strokeOpacity!==0||t.fill&&t.fillOpacity!==0?{...t,strokeOpacity:1,stroke:"#000",fillOpacity:0}:t}const Za=5,Bi=31,Ov=32,wu=new Uint32Array(Ov+1),ro=new Uint32Array(Ov+1);ro[0]=0;wu[0]=~ro[0];for(let e=1;e<=Ov;++e)ro[e]=ro[e-1]<<1|1,wu[e]=~ro[e];function gRe(e,t){const n=new Uint32Array(~~((e*t+Ov)/Ov));function i(s,o){n[s]|=o}function r(s,o){n[s]&=o}return{array:n,get:(s,o)=>{const a=o*e+s;return n[a>>>Za]&1<<(a&Bi)},set:(s,o)=>{const a=o*e+s;i(a>>>Za,1<<(a&Bi))},clear:(s,o)=>{const a=o*e+s;r(a>>>Za,~(1<<(a&Bi)))},getRange:(s,o,a,l)=>{let u=l,c,d,h,p;for(;u>=o;--u)if(c=u*e+s,d=u*e+a,h=c>>>Za,p=d>>>Za,h===p){if(n[h]&wu[c&Bi]&ro[(d&Bi)+1])return!0}else{if(n[h]&wu[c&Bi]||n[p]&ro[(d&Bi)+1])return!0;for(let g=h+1;g<p;++g)if(n[g])return!0}return!1},setRange:(s,o,a,l)=>{let u,c,d,h,p;for(;o<=l;++o)if(u=o*e+s,c=o*e+a,d=u>>>Za,h=c>>>Za,d===h)i(d,wu[u&Bi]&ro[(c&Bi)+1]);else for(i(d,wu[u&Bi]),i(h,ro[(c&Bi)+1]),p=d+1;p<h;++p)i(p,4294967295)},clearRange:(s,o,a,l)=>{let u,c,d,h,p;for(;o<=l;++o)if(u=o*e+s,c=o*e+a,d=u>>>Za,h=c>>>Za,d===h)r(d,ro[u&Bi]|wu[(c&Bi)+1]);else for(r(d,ro[u&Bi]),r(h,wu[(c&Bi)+1]),p=d+1;p<h;++p)r(p,0)},outOfBounds:(s,o,a,l)=>s<0||o<0||l>=t||a>=e}}function mRe(e,t,n){const i=Math.max(1,Math.sqrt(e*t/1e6)),r=~~((e+2*n+i)/i),s=~~((t+2*n+i)/i),o=a=>~~((a+n)/i);return o.invert=a=>a*i-n,o.bitmap=()=>gRe(r,s),o.ratio=i,o.padding=n,o.width=e,o.height=t,o}function vRe(e,t,n,i){const r=e.width,s=e.height;return function(o){const a=o.datum.datum.items[i].items,l=a.length,u=o.datum.fontSize,c=Yr.width(o.datum,o.datum.text);let d=0,h,p,g,v,C,y,b;for(let S=0;S<l;++S)h=a[S].x,g=a[S].y,p=a[S].x2===void 0?h:a[S].x2,v=a[S].y2===void 0?g:a[S].y2,C=(h+p)/2,y=(g+v)/2,b=Math.abs(p-h+v-g),b>=d&&(d=b,o.x=C,o.y=y);return C=c/2,y=u/2,h=o.x-C,p=o.x+C,g=o.y-y,v=o.y+y,o.align="center",h<0&&p<=r?o.align="left":0<=h&&r<p&&(o.align="right"),o.baseline="middle",g<0&&v<=s?o.baseline="top":0<=g&&s<v&&(o.baseline="bottom"),!0}}function iS(e,t,n,i,r,s){let o=n/2;return e-o<0||e+o>r||t-(o=i/2)<0||t+o>s}function Mu(e,t,n,i,r,s,o,a){const l=r*s/(i*2),u=e(t-l),c=e(t+l),d=e(n-(s=s/2)),h=e(n+s);return o.outOfBounds(u,d,c,h)||o.getRange(u,d,c,h)||a&&a.getRange(u,d,c,h)}function CRe(e,t,n,i){const r=e.width,s=e.height,o=t[0],a=t[1];function l(u,c,d,h,p){const g=e.invert(u),v=e.invert(c);let C=d,y=s,b;if(!iS(g,v,h,p,r,s)&&!Mu(e,g,v,p,h,C,o,a)&&!Mu(e,g,v,p,h,p,o,null)){for(;y-C>=1;)b=(C+y)/2,Mu(e,g,v,p,h,b,o,a)?y=b:C=b;if(C>d)return[g,v,C,!0]}}return function(u){const c=u.datum.datum.items[i].items,d=c.length,h=u.datum.fontSize,p=Yr.width(u.datum,u.datum.text);let g=n?h:0,v=!1,C=!1,y=0,b,S,x,E,A,F,k,P,_,O,H,W,$,L,G,j,ee;for(let q=0;q<d;++q){for(b=c[q].x,x=c[q].y,S=c[q].x2===void 0?b:c[q].x2,E=c[q].y2===void 0?x:c[q].y2,b>S&&(ee=b,b=S,S=ee),x>E&&(ee=x,x=E,E=ee),_=e(b),H=e(S),O=~~((_+H)/2),W=e(x),L=e(E),$=~~((W+L)/2),k=O;k>=_;--k)for(P=$;P>=W;--P)j=l(k,P,g,p,h),j&&([u.x,u.y,g,v]=j);for(k=O;k<=H;++k)for(P=$;P<=L;++P)j=l(k,P,g,p,h),j&&([u.x,u.y,g,v]=j);!v&&!n&&(G=Math.abs(S-b+E-x),A=(b+S)/2,F=(x+E)/2,G>=y&&!iS(A,F,p,h,r,s)&&!Mu(e,A,F,h,p,h,o,null)&&(y=G,u.x=A,u.y=F,C=!0))}return v||C?(A=p/2,F=h/2,o.setRange(e(u.x-A),e(u.y-F),e(u.x+A),e(u.y+F)),u.align="center",u.baseline="middle",!0):!1}}const yRe=[-1,-1,1,1],wRe=[-1,1,-1,1];function bRe(e,t,n,i){const r=e.width,s=e.height,o=t[0],a=t[1],l=e.bitmap();return function(u){const c=u.datum.datum.items[i].items,d=c.length,h=u.datum.fontSize,p=Yr.width(u.datum,u.datum.text),g=[];let v=n?h:0,C=!1,y=!1,b=0,S,x,E,A,F,k,P,_,O,H,W,$;for(let L=0;L<d;++L){for(S=c[L].x,E=c[L].y,x=c[L].x2===void 0?S:c[L].x2,A=c[L].y2===void 0?E:c[L].y2,g.push([e((S+x)/2),e((E+A)/2)]);g.length;)if([P,_]=g.pop(),!(o.get(P,_)||a.get(P,_)||l.get(P,_))){l.set(P,_);for(let G=0;G<4;++G)F=P+yRe[G],k=_+wRe[G],l.outOfBounds(F,k,F,k)||g.push([F,k]);if(F=e.invert(P),k=e.invert(_),O=v,H=s,!iS(F,k,p,h,r,s)&&!Mu(e,F,k,h,p,O,o,a)&&!Mu(e,F,k,h,p,h,o,null)){for(;H-O>=1;)W=(O+H)/2,Mu(e,F,k,h,p,W,o,a)?H=W:O=W;O>v&&(u.x=F,u.y=k,v=O,C=!0)}}!C&&!n&&($=Math.abs(x-S+A-E),F=(S+x)/2,k=(E+A)/2,$>=b&&!iS(F,k,p,h,r,s)&&!Mu(e,F,k,h,p,h,o,null)&&(b=$,u.x=F,u.y=k,y=!0))}return C||y?(F=p/2,k=h/2,o.setRange(e(u.x-F),e(u.y-k),e(u.x+F),e(u.y+k)),u.align="center",u.baseline="middle",!0):!1}}const SRe=["right","center","left"],xRe=["bottom","middle","top"];function RRe(e,t,n,i){const r=e.width,s=e.height,o=t[0],a=t[1],l=i.length;return function(u){const c=u.boundary,d=u.datum.fontSize;if(c[2]<0||c[5]<0||c[0]>r||c[3]>s)return!1;let h=u.textWidth??0,p,g,v,C,y,b,S,x,E,A,F,k,P,_,O;for(let H=0;H<l;++H){if(p=(n[H]&3)-1,g=(n[H]>>>2&3)-1,v=p===0&&g===0||i[H]<0,C=p&&g?Math.SQRT1_2:1,y=i[H]<0?-1:1,b=c[1+p]+i[H]*p*C,F=c[4+g]+y*d*g/2+i[H]*g*C,x=F-d/2,E=F+d/2,k=e(b),_=e(x),O=e(E),!h)if(nH(k,k,_,O,o,a,b,b,x,E,c,v))h=Yr.width(u.datum,u.datum.text);else continue;if(A=b+y*h*p/2,b=A-h/2,S=A+h/2,k=e(b),P=e(S),nH(k,P,_,O,o,a,b,S,x,E,c,v))return u.x=p?p*y<0?S:b:A,u.y=g?g*y<0?E:x:F,u.align=SRe[p*y+1],u.baseline=xRe[g*y+1],o.setRange(k,_,P,O),!0}return!1}}function nH(e,t,n,i,r,s,o,a,l,u,c,d){return!(r.outOfBounds(e,n,t,i)||(d&&s||r).getRange(e,n,t,i))}const YF=0,XF=4,QF=8,JF=0,ZF=1,eA=2,ERe={"top-left":YF+JF,top:YF+ZF,"top-right":YF+eA,left:XF+JF,middle:XF+ZF,right:XF+eA,"bottom-left":QF+JF,bottom:QF+ZF,"bottom-right":QF+eA},FRe={naive:vRe,"reduced-search":CRe,floodfill:bRe};function ARe(e,t,n,i,r,s,o,a,l,u,c){if(!e.length)return e;const d=Math.max(i.length,r.length),h=DRe(i,d),p=PRe(r,d),g=kRe(e[0].datum),v=g==="group"&&e[0].datum.items[l].marktype,C=v==="area",y=TRe(g,v,a,l),b=u===null||u===1/0,S=C&&c==="naive";let x=-1,E=-1;const A=e.map(_=>{const O=b?Yr.width(_,_.text):void 0;return x=Math.max(x,O),E=Math.max(E,_.fontSize),{datum:_,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y(_),textWidth:O}});u=u===null||u===1/0?Math.max(x,E)+Math.max(...i):u;const F=mRe(t[0],t[1],u);let k;if(!S){n&&A.sort((H,W)=>n(H.datum,W.datum));let _=!1;for(let H=0;H<p.length&&!_;++H)_=p[H]===5||h[H]<0;const O=(g&&o||C)&&e.map(H=>H.datum);k=s.length||O?fRe(F,O||[],s,_,C):hRe(F,o&&A)}const P=C?FRe[c](F,k,o,l):RRe(F,k,p,h);return A.forEach(_=>_.opacity=+P(_)),A}function DRe(e,t){const n=new Float64Array(t),i=e.length;for(let r=0;r<i;++r)n[r]=e[r]||0;for(let r=i;r<t;++r)n[r]=n[i-1];return n}function PRe(e,t){const n=new Int8Array(t),i=e.length;for(let r=0;r<i;++r)n[r]|=ERe[e[r]];for(let r=i;r<t;++r)n[r]=n[i-1];return n}function kRe(e){return e&&e.mark&&e.mark.marktype}function TRe(e,t,n,i){const r=s=>[s.x,s.x,s.x,s.y,s.y,s.y];return e?e==="line"||e==="area"?s=>r(s.datum):t==="line"?s=>{const o=s.datum.items[i].items;return r(o.length?o[n==="start"?0:o.length-1]:{x:NaN,y:NaN})}:s=>{const o=s.datum.bounds;return[o.x1,(o.x1+o.x2)/2,o.x2,o.y1,(o.y1+o.y2)/2,o.y2]}:r}const uk=["x","y","opacity","align","baseline"],Fq=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function e_(e){Y.call(this,null,e)}e_.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:Fq},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:uk.length,default:uk}]};pe(e_,Y,{transform(e,t){function n(s){const o=e[s];return nt(o)&&t.modified(o.fields)}const i=e.modified();if(!(i||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&Z("Size parameter should be specified as a [width, height] array.");const r=e.as||uk;return ARe(t.materialize(t.SOURCE).source||[],e.size,e.sort,we(e.offset==null?1:e.offset),we(e.anchor||Fq),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding===void 0?0:e.padding,e.method||"naive").forEach(s=>{const o=s.datum;o[r[0]]=s.x,o[r[1]]=s.y,o[r[2]]=s.opacity,o[r[3]]=s.align,o[r[4]]=s.baseline}),t.reflow(i).modifies(r)}});const MRe=Object.freeze(Object.defineProperty({__proto__:null,label:e_},Symbol.toStringTag,{value:"Module"}));function Aq(e,t){var n=[],i=function(c){return c(a)},r,s,o,a,l,u;if(t==null)n.push(e);else for(r={},s=0,o=e.length;s<o;++s)a=e[s],l=t.map(i),u=r[l],u||(r[l]=u=[],u.dims=l,n.push(u)),u.push(a);return n}function t_(e){Y.call(this,null,e)}t_.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};pe(t_,Y,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=Aq(i,e.groupby),s=(e.groupby||[]).map(yn),o=s.length,a=e.as||[yn(e.x),yn(e.y)],l=[];r.forEach(u=>{I8(u,e.x,e.y,e.bandwidth||.3).forEach(c=>{const d={};for(let h=0;h<o;++h)d[s[h]]=u.dims[h];d[a[0]]=c[0],d[a[1]]=c[1],l.push(Dt(d))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});const ck={constant:$M,linear:BM,log:P8,exp:k8,pow:T8,quad:GM,poly:M8},IRe=(e,t)=>e==="poly"?t:e==="quad"?2:1;function n_(e){Y.call(this,null,e)}n_.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(ck)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};pe(n_,Y,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=Aq(i,e.groupby),s=(e.groupby||[]).map(yn),o=e.method||"linear",a=e.order==null?3:e.order,l=IRe(o,a),u=e.as||[yn(e.x),yn(e.y)],c=ck[o],d=[];let h=e.extent;Ee(ck,o)||Z("Invalid regression method: "+o),h!=null&&o==="log"&&h[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),h=null),r.forEach(p=>{if(p.length<=l){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const v=c(p,e.x,e.y,a);if(e.params){d.push(Dt({keys:p.dims,coef:v.coef,rSquared:v.rSquared}));return}const C=h||ma(p,e.x),y=b=>{const S={};for(let x=0;x<s.length;++x)S[s[x]]=p.dims[x];S[u[0]]=b[0],S[u[1]]=b[1],d.push(Dt(S))};o==="linear"||o==="constant"?C.forEach(b=>y([b,v.predict(b)])):F1(v.predict,C,25,200).forEach(y)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=d}return n}});const _Re=Object.freeze(Object.defineProperty({__proto__:null,loess:t_,regression:n_},Symbol.toStringTag,{value:"Module"})),Cl=11102230246251565e-32,Si=134217729,ORe=(3+8*Cl)*Cl;function tA(e,t,n,i,r){let s,o,a,l,u=t[0],c=i[0],d=0,h=0;c>u==c>-u?(s=u,u=t[++d]):(s=c,c=i[++h]);let p=0;if(d<e&&h<n)for(c>u==c>-u?(o=u+s,a=s-(o-u),u=t[++d]):(o=c+s,a=s-(o-c),c=i[++h]),s=o,a!==0&&(r[p++]=a);d<e&&h<n;)c>u==c>-u?(o=s+u,l=o-s,a=s-(o-l)+(u-l),u=t[++d]):(o=s+c,l=o-s,a=s-(o-l)+(c-l),c=i[++h]),s=o,a!==0&&(r[p++]=a);for(;d<e;)o=s+u,l=o-s,a=s-(o-l)+(u-l),u=t[++d],s=o,a!==0&&(r[p++]=a);for(;h<n;)o=s+c,l=o-s,a=s-(o-l)+(c-l),c=i[++h],s=o,a!==0&&(r[p++]=a);return(s!==0||p===0)&&(r[p++]=s),p}function LRe(e,t){let n=t[0];for(let i=1;i<e;i++)n+=t[i];return n}function V0(e){return new Float64Array(e)}const NRe=(3+16*Cl)*Cl,$Re=(2+12*Cl)*Cl,BRe=(9+64*Cl)*Cl*Cl,qh=V0(4),iH=V0(8),rH=V0(12),sH=V0(16),Gi=V0(4);function GRe(e,t,n,i,r,s,o){let a,l,u,c,d,h,p,g,v,C,y,b,S,x,E,A,F,k;const P=e-r,_=n-r,O=t-s,H=i-s;x=P*H,h=Si*P,p=h-(h-P),g=P-p,h=Si*H,v=h-(h-H),C=H-v,E=g*C-(x-p*v-g*v-p*C),A=O*_,h=Si*O,p=h-(h-O),g=O-p,h=Si*_,v=h-(h-_),C=_-v,F=g*C-(A-p*v-g*v-p*C),y=E-F,d=E-y,qh[0]=E-(y+d)+(d-F),b=x+y,d=b-x,S=x-(b-d)+(y-d),y=S-A,d=S-y,qh[1]=S-(y+d)+(d-A),k=b+y,d=k-b,qh[2]=b-(k-d)+(y-d),qh[3]=k;let W=LRe(4,qh),$=$Re*o;if(W>=$||-W>=$||(d=e-P,a=e-(P+d)+(d-r),d=n-_,u=n-(_+d)+(d-r),d=t-O,l=t-(O+d)+(d-s),d=i-H,c=i-(H+d)+(d-s),a===0&&l===0&&u===0&&c===0)||($=BRe*o+ORe*Math.abs(W),W+=P*c+H*a-(O*u+_*l),W>=$||-W>=$))return W;x=a*H,h=Si*a,p=h-(h-a),g=a-p,h=Si*H,v=h-(h-H),C=H-v,E=g*C-(x-p*v-g*v-p*C),A=l*_,h=Si*l,p=h-(h-l),g=l-p,h=Si*_,v=h-(h-_),C=_-v,F=g*C-(A-p*v-g*v-p*C),y=E-F,d=E-y,Gi[0]=E-(y+d)+(d-F),b=x+y,d=b-x,S=x-(b-d)+(y-d),y=S-A,d=S-y,Gi[1]=S-(y+d)+(d-A),k=b+y,d=k-b,Gi[2]=b-(k-d)+(y-d),Gi[3]=k;const L=tA(4,qh,4,Gi,iH);x=P*c,h=Si*P,p=h-(h-P),g=P-p,h=Si*c,v=h-(h-c),C=c-v,E=g*C-(x-p*v-g*v-p*C),A=O*u,h=Si*O,p=h-(h-O),g=O-p,h=Si*u,v=h-(h-u),C=u-v,F=g*C-(A-p*v-g*v-p*C),y=E-F,d=E-y,Gi[0]=E-(y+d)+(d-F),b=x+y,d=b-x,S=x-(b-d)+(y-d),y=S-A,d=S-y,Gi[1]=S-(y+d)+(d-A),k=b+y,d=k-b,Gi[2]=b-(k-d)+(y-d),Gi[3]=k;const G=tA(L,iH,4,Gi,rH);x=a*c,h=Si*a,p=h-(h-a),g=a-p,h=Si*c,v=h-(h-c),C=c-v,E=g*C-(x-p*v-g*v-p*C),A=l*u,h=Si*l,p=h-(h-l),g=l-p,h=Si*u,v=h-(h-u),C=u-v,F=g*C-(A-p*v-g*v-p*C),y=E-F,d=E-y,Gi[0]=E-(y+d)+(d-F),b=x+y,d=b-x,S=x-(b-d)+(y-d),y=S-A,d=S-y,Gi[1]=S-(y+d)+(d-A),k=b+y,d=k-b,Gi[2]=b-(k-d)+(y-d),Gi[3]=k;const j=tA(G,rH,4,Gi,sH);return sH[j-1]}function Ny(e,t,n,i,r,s){const o=(t-s)*(n-r),a=(e-r)*(i-s),l=o-a,u=Math.abs(o+a);return Math.abs(l)>=NRe*u?l:-GRe(e,t,n,i,r,s,u)}const oH=Math.pow(2,-52),$y=new Uint32Array(512);class rS{static from(t,n=URe,i=jRe){const r=t.length,s=new Float64Array(r*2);for(let o=0;o<r;o++){const a=t[o];s[2*o]=n(a),s[2*o+1]=i(a)}return new rS(s)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const i=Math.max(2*n-5,0);this._triangles=new Uint32Array(i*3),this._halfedges=new Int32Array(i*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:i,_hullTri:r,_hullHash:s}=this,o=t.length>>1;let a=1/0,l=1/0,u=-1/0,c=-1/0;for(let P=0;P<o;P++){const _=t[2*P],O=t[2*P+1];_<a&&(a=_),O<l&&(l=O),_>u&&(u=_),O>c&&(c=O),this._ids[P]=P}const d=(a+u)/2,h=(l+c)/2;let p,g,v;for(let P=0,_=1/0;P<o;P++){const O=nA(d,h,t[2*P],t[2*P+1]);O<_&&(p=P,_=O)}const C=t[2*p],y=t[2*p+1];for(let P=0,_=1/0;P<o;P++){if(P===p)continue;const O=nA(C,y,t[2*P],t[2*P+1]);O<_&&O>0&&(g=P,_=O)}let b=t[2*g],S=t[2*g+1],x=1/0;for(let P=0;P<o;P++){if(P===p||P===g)continue;const _=VRe(C,y,b,S,t[2*P],t[2*P+1]);_<x&&(v=P,x=_)}let E=t[2*v],A=t[2*v+1];if(x===1/0){for(let O=0;O<o;O++)this._dists[O]=t[2*O]-t[0]||t[2*O+1]-t[1];ff(this._ids,this._dists,0,o-1);const P=new Uint32Array(o);let _=0;for(let O=0,H=-1/0;O<o;O++){const W=this._ids[O],$=this._dists[W];$>H&&(P[_++]=W,H=$)}this.hull=P.subarray(0,_),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(Ny(C,y,b,S,E,A)<0){const P=g,_=b,O=S;g=v,b=E,S=A,v=P,E=_,A=O}const F=WRe(C,y,b,S,E,A);this._cx=F.x,this._cy=F.y;for(let P=0;P<o;P++)this._dists[P]=nA(t[2*P],t[2*P+1],F.x,F.y);ff(this._ids,this._dists,0,o-1),this._hullStart=p;let k=3;i[p]=n[v]=g,i[g]=n[p]=v,i[v]=n[g]=p,r[p]=0,r[g]=1,r[v]=2,s.fill(-1),s[this._hashKey(C,y)]=p,s[this._hashKey(b,S)]=g,s[this._hashKey(E,A)]=v,this.trianglesLen=0,this._addTriangle(p,g,v,-1,-1,-1);for(let P=0,_,O;P<this._ids.length;P++){const H=this._ids[P],W=t[2*H],$=t[2*H+1];if(P>0&&Math.abs(W-_)<=oH&&Math.abs($-O)<=oH||(_=W,O=$,H===p||H===g||H===v))continue;let L=0;for(let fe=0,Re=this._hashKey(W,$);fe<this._hashSize&&(L=s[(Re+fe)%this._hashSize],!(L!==-1&&L!==i[L]));fe++);L=n[L];let G=L,j;for(;j=i[G],Ny(W,$,t[2*G],t[2*G+1],t[2*j],t[2*j+1])>=0;)if(G=j,G===L){G=-1;break}if(G===-1)continue;let ee=this._addTriangle(G,H,i[G],-1,-1,r[G]);r[H]=this._legalize(ee+2),r[G]=ee,k++;let q=i[G];for(;j=i[q],Ny(W,$,t[2*q],t[2*q+1],t[2*j],t[2*j+1])<0;)ee=this._addTriangle(q,H,j,r[H],-1,r[q]),r[H]=this._legalize(ee+2),i[q]=q,k--,q=j;if(G===L)for(;j=n[G],Ny(W,$,t[2*j],t[2*j+1],t[2*G],t[2*G+1])<0;)ee=this._addTriangle(j,H,G,-1,r[G],r[j]),this._legalize(ee+2),r[j]=ee,i[G]=G,k--,G=j;this._hullStart=n[H]=G,i[G]=n[q]=H,i[H]=q,s[this._hashKey(W,$)]=H,s[this._hashKey(t[2*G],t[2*G+1])]=G}this.hull=new Uint32Array(k);for(let P=0,_=this._hullStart;P<k;P++)this.hull[P]=_,_=i[_];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(zRe(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:i,coords:r}=this;let s=0,o=0;for(;;){const a=i[t],l=t-t%3;if(o=l+(t+2)%3,a===-1){if(s===0)break;t=$y[--s];continue}const u=a-a%3,c=l+(t+1)%3,d=u+(a+2)%3,h=n[o],p=n[t],g=n[c],v=n[d];if(HRe(r[2*h],r[2*h+1],r[2*p],r[2*p+1],r[2*g],r[2*g+1],r[2*v],r[2*v+1])){n[t]=v,n[a]=h;const y=i[d];if(y===-1){let S=this._hullStart;do{if(this._hullTri[S]===d){this._hullTri[S]=t;break}S=this._hullPrev[S]}while(S!==this._hullStart)}this._link(t,y),this._link(a,i[o]),this._link(o,d);const b=u+(a+1)%3;s<$y.length&&($y[s++]=b)}else{if(s===0)break;t=$y[--s]}}return o}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,i,r,s,o){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=n,this._triangles[a+2]=i,this._link(a,r),this._link(a+1,s),this._link(a+2,o),this.trianglesLen+=3,a}}function zRe(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function nA(e,t,n,i){const r=e-n,s=t-i;return r*r+s*s}function HRe(e,t,n,i,r,s,o,a){const l=e-o,u=t-a,c=n-o,d=i-a,h=r-o,p=s-a,g=l*l+u*u,v=c*c+d*d,C=h*h+p*p;return l*(d*C-v*p)-u*(c*C-v*h)+g*(c*p-d*h)<0}function VRe(e,t,n,i,r,s){const o=n-e,a=i-t,l=r-e,u=s-t,c=o*o+a*a,d=l*l+u*u,h=.5/(o*u-a*l),p=(u*c-a*d)*h,g=(o*d-l*c)*h;return p*p+g*g}function WRe(e,t,n,i,r,s){const o=n-e,a=i-t,l=r-e,u=s-t,c=o*o+a*a,d=l*l+u*u,h=.5/(o*u-a*l),p=e+(u*c-a*d)*h,g=t+(o*d-l*c)*h;return{x:p,y:g}}function ff(e,t,n,i){if(i-n<=20)for(let r=n+1;r<=i;r++){const s=e[r],o=t[s];let a=r-1;for(;a>=n&&t[e[a]]>o;)e[a+1]=e[a--];e[a+1]=s}else{const r=n+i>>1;let s=n+1,o=i;Jg(e,r,s),t[e[n]]>t[e[i]]&&Jg(e,n,i),t[e[s]]>t[e[i]]&&Jg(e,s,i),t[e[n]]>t[e[s]]&&Jg(e,n,s);const a=e[s],l=t[a];for(;;){do s++;while(t[e[s]]<l);do o--;while(t[e[o]]>l);if(o<s)break;Jg(e,s,o)}e[n+1]=e[o],e[o]=a,i-s+1>=o-n?(ff(e,t,s,i),ff(e,t,n,o-1)):(ff(e,t,n,o-1),ff(e,t,s,i))}}function Jg(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function URe(e){return e[0]}function jRe(e){return e[1]}const aH=1e-6;class cd{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,i){t=+t,n=+n,i=+i;const r=t+i,s=n;if(i<0)throw new Error("negative radius");this._x1===null?this._+=`M${r},${s}`:(Math.abs(this._x1-r)>aH||Math.abs(this._y1-s)>aH)&&(this._+="L"+r+","+s),i&&(this._+=`A${i},${i},0,1,1,${t-i},${n}A${i},${i},0,1,1,${this._x1=r},${this._y1=s}`)}rect(t,n,i,r){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+i}v${+r}h${-i}Z`}value(){return this._||null}}class dk{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}let qRe=class{constructor(t,[n,i,r,s]=[0,0,960,500]){if(!((r=+r)>=(n=+n))||!((s=+s)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=r,this.xmin=n,this.ymax=s,this.ymin=i,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:i},vectors:r}=this;let s,o;const a=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let v=0,C=0,y=i.length,b,S;v<y;v+=3,C+=2){const x=i[v]*2,E=i[v+1]*2,A=i[v+2]*2,F=t[x],k=t[x+1],P=t[E],_=t[E+1],O=t[A],H=t[A+1],W=P-F,$=_-k,L=O-F,G=H-k,j=(W*G-$*L)*2;if(Math.abs(j)<1e-9){if(s===void 0){s=o=0;for(const q of n)s+=t[q*2],o+=t[q*2+1];s/=n.length,o/=n.length}const ee=1e9*Math.sign((s-F)*G-(o-k)*L);b=(F+O)/2-ee*G,S=(k+H)/2+ee*L}else{const ee=1/j,q=W*W+$*$,fe=L*L+G*G;b=F+(G*q-$*fe)*ee,S=k+(W*fe-L*q)*ee}a[C]=b,a[C+1]=S}let l=n[n.length-1],u,c=l*4,d,h=t[2*l],p,g=t[2*l+1];r.fill(0);for(let v=0;v<n.length;++v)l=n[v],u=c,d=h,p=g,c=l*4,h=t[2*l],g=t[2*l+1],r[u+2]=r[c]=p-g,r[u+3]=r[c+1]=h-d}render(t){const n=t==null?t=new cd:void 0,{delaunay:{halfedges:i,inedges:r,hull:s},circumcenters:o,vectors:a}=this;if(s.length<=1)return null;for(let c=0,d=i.length;c<d;++c){const h=i[c];if(h<c)continue;const p=Math.floor(c/3)*2,g=Math.floor(h/3)*2,v=o[p],C=o[p+1],y=o[g],b=o[g+1];this._renderSegment(v,C,y,b,t)}let l,u=s[s.length-1];for(let c=0;c<s.length;++c){l=u,u=s[c];const d=Math.floor(r[u]/3)*2,h=o[d],p=o[d+1],g=l*4,v=this._project(h,p,a[g+2],a[g+3]);v&&this._renderSegment(h,p,v[0],v[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new cd:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const i=n==null?n=new cd:void 0,r=this._clip(t);if(r===null||!r.length)return;n.moveTo(r[0],r[1]);let s=r.length;for(;r[0]===r[s-2]&&r[1]===r[s-1]&&s>1;)s-=2;for(let o=2;o<s;o+=2)(r[o]!==r[o-2]||r[o+1]!==r[o-1])&&n.lineTo(r[o],r[o+1]);return n.closePath(),i&&i.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,i=t.length/2;n<i;++n){const r=this.cellPolygon(n);r&&(r.index=n,yield r)}}cellPolygon(t){const n=new dk;return this.renderCell(t,n),n.value()}_renderSegment(t,n,i,r,s){let o;const a=this._regioncode(t,n),l=this._regioncode(i,r);a===0&&l===0?(s.moveTo(t,n),s.lineTo(i,r)):(o=this._clipSegment(t,n,i,r,a,l))&&(s.moveTo(o[0],o[1]),s.lineTo(o[2],o[3]))}contains(t,n,i){return n=+n,n!==n||(i=+i,i!==i)?!1:this.delaunay._step(t,n,i)===t}*neighbors(t){const n=this._clip(t);if(n)for(const i of this.delaunay.neighbors(t)){const r=this._clip(i);if(r){e:for(let s=0,o=n.length;s<o;s+=2)for(let a=0,l=r.length;a<l;a+=2)if(n[s]===r[a]&&n[s+1]===r[a+1]&&n[(s+2)%o]===r[(a+l-2)%l]&&n[(s+3)%o]===r[(a+l-1)%l]){yield i;break e}}}}_cell(t){const{circumcenters:n,delaunay:{inedges:i,halfedges:r,triangles:s}}=this,o=i[t];if(o===-1)return null;const a=[];let l=o;do{const u=Math.floor(l/3);if(a.push(n[u*2],n[u*2+1]),l=l%3===2?l-2:l+1,s[l]!==t)break;l=r[l]}while(l!==o&&l!==-1);return a}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:i}=this,r=t*4;return this._simplify(i[r]||i[r+1]?this._clipInfinite(t,n,i[r],i[r+1],i[r+2],i[r+3]):this._clipFinite(t,n))}_clipFinite(t,n){const i=n.length;let r=null,s,o,a=n[i-2],l=n[i-1],u,c=this._regioncode(a,l),d,h=0;for(let p=0;p<i;p+=2)if(s=a,o=l,a=n[p],l=n[p+1],u=c,c=this._regioncode(a,l),u===0&&c===0)d=h,h=0,r?r.push(a,l):r=[a,l];else{let g,v,C,y,b;if(u===0){if((g=this._clipSegment(s,o,a,l,u,c))===null)continue;[v,C,y,b]=g}else{if((g=this._clipSegment(a,l,s,o,c,u))===null)continue;[y,b,v,C]=g,d=h,h=this._edgecode(v,C),d&&h&&this._edge(t,d,h,r,r.length),r?r.push(v,C):r=[v,C]}d=h,h=this._edgecode(y,b),d&&h&&this._edge(t,d,h,r,r.length),r?r.push(y,b):r=[y,b]}if(r)d=h,h=this._edgecode(r[0],r[1]),d&&h&&this._edge(t,d,h,r,r.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return r}_clipSegment(t,n,i,r,s,o){const a=s<o;for(a&&([t,n,i,r,s,o]=[i,r,t,n,o,s]);;){if(s===0&&o===0)return a?[i,r,t,n]:[t,n,i,r];if(s&o)return null;let l,u,c=s||o;c&8?(l=t+(i-t)*(this.ymax-n)/(r-n),u=this.ymax):c&4?(l=t+(i-t)*(this.ymin-n)/(r-n),u=this.ymin):c&2?(u=n+(r-n)*(this.xmax-t)/(i-t),l=this.xmax):(u=n+(r-n)*(this.xmin-t)/(i-t),l=this.xmin),s?(t=l,n=u,s=this._regioncode(t,n)):(i=l,r=u,o=this._regioncode(i,r))}}_clipInfinite(t,n,i,r,s,o){let a=Array.from(n),l;if((l=this._project(a[0],a[1],i,r))&&a.unshift(l[0],l[1]),(l=this._project(a[a.length-2],a[a.length-1],s,o))&&a.push(l[0],l[1]),a=this._clipFinite(t,a))for(let u=0,c=a.length,d,h=this._edgecode(a[c-2],a[c-1]);u<c;u+=2)d=h,h=this._edgecode(a[u],a[u+1]),d&&h&&(u=this._edge(t,d,h,a,u),c=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,n,i,r,s){for(;n!==i;){let o,a;switch(n){case 5:n=4;continue;case 4:n=6,o=this.xmax,a=this.ymin;break;case 6:n=2;continue;case 2:n=10,o=this.xmax,a=this.ymax;break;case 10:n=8;continue;case 8:n=9,o=this.xmin,a=this.ymax;break;case 9:n=1;continue;case 1:n=5,o=this.xmin,a=this.ymin;break}(r[s]!==o||r[s+1]!==a)&&this.contains(t,o,a)&&(r.splice(s,0,o,a),s+=2)}return s}_project(t,n,i,r){let s=1/0,o,a,l;if(r<0){if(n<=this.ymin)return null;(o=(this.ymin-n)/r)<s&&(l=this.ymin,a=t+(s=o)*i)}else if(r>0){if(n>=this.ymax)return null;(o=(this.ymax-n)/r)<s&&(l=this.ymax,a=t+(s=o)*i)}if(i>0){if(t>=this.xmax)return null;(o=(this.xmax-t)/i)<s&&(a=this.xmax,l=n+(s=o)*r)}else if(i<0){if(t<=this.xmin)return null;(o=(this.xmin-t)/i)<s&&(a=this.xmin,l=n+(s=o)*r)}return[a,l]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}_simplify(t){if(t&&t.length>4){for(let n=0;n<t.length;n+=2){const i=(n+2)%t.length,r=(n+4)%t.length;(t[n]===t[i]&&t[i]===t[r]||t[n+1]===t[i+1]&&t[i+1]===t[r+1])&&(t.splice(i,2),n-=2)}t.length||(t=null)}return t}};const KRe=2*Math.PI,Kh=Math.pow;function YRe(e){return e[0]}function XRe(e){return e[1]}function QRe(e){const{triangles:t,coords:n}=e;for(let i=0;i<t.length;i+=3){const r=2*t[i],s=2*t[i+1],o=2*t[i+2];if((n[o]-n[r])*(n[s+1]-n[r+1])-(n[s]-n[r])*(n[o+1]-n[r+1])>1e-10)return!1}return!0}function JRe(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class i_{static from(t,n=YRe,i=XRe,r){return new i_("length"in t?ZRe(t,n,i,r):Float64Array.from(eEe(t,n,i,r)))}constructor(t){this._delaunator=new rS(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&QRe(t)){this.collinear=Int32Array.from({length:n.length/2},(h,p)=>p).sort((h,p)=>n[2*h]-n[2*p]||n[2*h+1]-n[2*p+1]);const l=this.collinear[0],u=this.collinear[this.collinear.length-1],c=[n[2*l],n[2*l+1],n[2*u],n[2*u+1]],d=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let h=0,p=n.length/2;h<p;++h){const g=JRe(n[2*h],n[2*h+1],d);n[2*h]=g[0],n[2*h+1]=g[1]}this._delaunator=new rS(n)}else delete this.collinear;const i=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let l=0,u=i.length;l<u;++l){const c=s[l%3===2?l-2:l+1];(i[l]===-1||o[c]===-1)&&(o[c]=l)}for(let l=0,u=r.length;l<u;++l)a[r[l]]=l;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],o[r[0]]=1,r.length===2&&(o[r[1]]=0,this.triangles[1]=r[1],this.triangles[2]=r[1]))}voronoi(t){return new qRe(this,t)}*neighbors(t){const{inedges:n,hull:i,_hullIndex:r,halfedges:s,triangles:o,collinear:a}=this;if(a){const d=a.indexOf(t);d>0&&(yield a[d-1]),d<a.length-1&&(yield a[d+1]);return}const l=n[t];if(l===-1)return;let u=l,c=-1;do{if(yield c=o[u],u=u%3===2?u-2:u+1,o[u]!==t)return;if(u=s[u],u===-1){const d=i[(r[t]+1)%i.length];d!==c&&(yield d);return}}while(u!==l)}find(t,n,i=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const r=i;let s;for(;(s=this._step(i,t,n))>=0&&s!==i&&s!==r;)i=s;return s}_step(t,n,i){const{inedges:r,hull:s,_hullIndex:o,halfedges:a,triangles:l,points:u}=this;if(r[t]===-1||!u.length)return(t+1)%(u.length>>1);let c=t,d=Kh(n-u[t*2],2)+Kh(i-u[t*2+1],2);const h=r[t];let p=h;do{let g=l[p];const v=Kh(n-u[g*2],2)+Kh(i-u[g*2+1],2);if(v<d&&(d=v,c=g),p=p%3===2?p-2:p+1,l[p]!==t)break;if(p=a[p],p===-1){if(p=s[(o[t]+1)%s.length],p!==g&&Kh(n-u[p*2],2)+Kh(i-u[p*2+1],2)<d)return p;break}}while(p!==h);return c}render(t){const n=t==null?t=new cd:void 0,{points:i,halfedges:r,triangles:s}=this;for(let o=0,a=r.length;o<a;++o){const l=r[o];if(l<o)continue;const u=s[o]*2,c=s[l]*2;t.moveTo(i[u],i[u+1]),t.lineTo(i[c],i[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n){n===void 0&&(!t||typeof t.moveTo!="function")&&(n=t,t=null),n=n==null?2:+n;const i=t==null?t=new cd:void 0,{points:r}=this;for(let s=0,o=r.length;s<o;s+=2){const a=r[s],l=r[s+1];t.moveTo(a+n,l),t.arc(a,l,n,0,KRe)}return i&&i.value()}renderHull(t){const n=t==null?t=new cd:void 0,{hull:i,points:r}=this,s=i[0]*2,o=i.length;t.moveTo(r[s],r[s+1]);for(let a=1;a<o;++a){const l=2*i[a];t.lineTo(r[l],r[l+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new dk;return this.renderHull(t),t.value()}renderTriangle(t,n){const i=n==null?n=new cd:void 0,{points:r,triangles:s}=this,o=s[t*=3]*2,a=s[t+1]*2,l=s[t+2]*2;return n.moveTo(r[o],r[o+1]),n.lineTo(r[a],r[a+1]),n.lineTo(r[l],r[l+1]),n.closePath(),i&&i.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,i=t.length/3;n<i;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new dk;return this.renderTriangle(t,n),n.value()}}function ZRe(e,t,n,i){const r=e.length,s=new Float64Array(r*2);for(let o=0;o<r;++o){const a=e[o];s[o*2]=t.call(i,a,o,e),s[o*2+1]=n.call(i,a,o,e)}return s}function*eEe(e,t,n,i){let r=0;for(const s of e)yield t.call(i,s,r,e),yield n.call(i,s,r,e),++r}function r_(e){Y.call(this,null,e)}r_.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const tEe=[-1e5,-1e5,1e5,1e5];pe(r_,Y,{transform(e,t){const n=e.as||"path",i=t.source;if(!i||!i.length)return t;let r=e.size;r=r?[0,0,r[0],r[1]]:(r=e.extent)?[r[0][0],r[0][1],r[1][0],r[1][1]]:tEe;const s=this.value=i_.from(i,e.x,e.y).voronoi(r);for(let o=0,a=i.length;o<a;++o){const l=s.cellPolygon(o);i[o][n]=l&&!iEe(l)?nEe(l):null}return t.reflow(e.modified()).modifies(n)}});function nEe(e){const t=e[0][0],n=e[0][1];let i=e.length-1;for(;e[i][0]===t&&e[i][1]===n;--i);return"M"+e.slice(0,i+1).join("L")+"Z"}function iEe(e){return e.length===2&&e[0][0]===e[1][0]&&e[0][1]===e[1][1]}const rEe=Object.freeze(Object.defineProperty({__proto__:null,voronoi:r_},Symbol.toStringTag,{value:"Module"}));var iA=Math.PI/180,Nm=64,Iw=2048;function sEe(){var e=[256,256],t,n,i,r,s,o,a,l=Dq,u=[],c=Math.random,d={};d.layout=function(){for(var g=h($u()),v=dEe((e[0]>>5)*e[1]),C=null,y=u.length,b=-1,S=[],x=u.map(A=>({text:t(A),font:n(A),style:r(A),weight:s(A),rotate:o(A),size:~~(i(A)+1e-14),padding:a(A),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:A})).sort((A,F)=>F.size-A.size);++b<y;){var E=x[b];E.x=e[0]*(c()+.5)>>1,E.y=e[1]*(c()+.5)>>1,oEe(g,E,x,b),E.hasText&&p(v,E,C)&&(S.push(E),C?lEe(C,E):C=[{x:E.x+E.x0,y:E.y+E.y0},{x:E.x+E.x1,y:E.y+E.y1}],E.x-=e[0]>>1,E.y-=e[1]>>1)}return S};function h(g){g.width=g.height=1;var v=Math.sqrt(g.getContext("2d").getImageData(0,0,1,1).data.length>>2);g.width=(Nm<<5)/v,g.height=Iw/v;var C=g.getContext("2d");return C.fillStyle=C.strokeStyle="red",C.textAlign="center",{context:C,ratio:v}}function p(g,v,C){for(var y=v.x,b=v.y,S=Math.hypot(e[0],e[1]),x=l(e),E=c()<.5?1:-1,A=-E,F,k,P;(F=x(A+=E))&&(k=~~F[0],P=~~F[1],!(Math.min(Math.abs(k),Math.abs(P))>=S));)if(v.x=y+k,v.y=b+P,!(v.x+v.x0<0||v.y+v.y0<0||v.x+v.x1>e[0]||v.y+v.y1>e[1])&&(!C||!aEe(v,g,e[0]))&&(!C||uEe(v,C))){for(var _=v.sprite,O=v.width>>5,H=e[0]>>5,W=v.x-(O<<4),$=W&127,L=32-$,G=v.y1-v.y0,j=(v.y+v.y0)*H+(W>>5),ee,q=0;q<G;q++){ee=0;for(var fe=0;fe<=O;fe++)g[j+fe]|=ee<<L|(fe<O?(ee=_[q*O+fe])>>>$:0);j+=H}return v.sprite=null,!0}return!1}return d.words=function(g){return arguments.length?(u=g,d):u},d.size=function(g){return arguments.length?(e=[+g[0],+g[1]],d):e},d.font=function(g){return arguments.length?(n=Hc(g),d):n},d.fontStyle=function(g){return arguments.length?(r=Hc(g),d):r},d.fontWeight=function(g){return arguments.length?(s=Hc(g),d):s},d.rotate=function(g){return arguments.length?(o=Hc(g),d):o},d.text=function(g){return arguments.length?(t=Hc(g),d):t},d.spiral=function(g){return arguments.length?(l=hEe[g]||g,d):l},d.fontSize=function(g){return arguments.length?(i=Hc(g),d):i},d.padding=function(g){return arguments.length?(a=Hc(g),d):a},d.random=function(g){return arguments.length?(c=g,d):c},d}function oEe(e,t,n,i){if(!t.sprite){var r=e.context,s=e.ratio;r.clearRect(0,0,(Nm<<5)/s,Iw/s);var o=0,a=0,l=0,u=n.length,c,d,h,p,g;for(--i;++i<u;){if(t=n[i],r.save(),r.font=t.style+" "+t.weight+" "+~~((t.size+1)/s)+"px "+t.font,c=r.measureText(t.text+"m").width*s,h=t.size<<1,t.rotate){var v=Math.sin(t.rotate*iA),C=Math.cos(t.rotate*iA),y=c*C,b=c*v,S=h*C,x=h*v;c=Math.max(Math.abs(y+x),Math.abs(y-x))+31>>5<<5,h=~~Math.max(Math.abs(b+S),Math.abs(b-S))}else c=c+31>>5<<5;if(h>l&&(l=h),o+c>=Nm<<5&&(o=0,a+=l,l=0),a+h>=Iw)break;r.translate((o+(c>>1))/s,(a+(h>>1))/s),t.rotate&&r.rotate(t.rotate*iA),r.fillText(t.text,0,0),t.padding&&(r.lineWidth=2*t.padding,r.strokeText(t.text,0,0)),r.restore(),t.width=c,t.height=h,t.xoff=o,t.yoff=a,t.x1=c>>1,t.y1=h>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,o+=c}for(var E=r.getImageData(0,0,(Nm<<5)/s,Iw/s).data,A=[];--i>=0;)if(t=n[i],!!t.hasText){for(c=t.width,d=c>>5,h=t.y1-t.y0,p=0;p<h*d;p++)A[p]=0;if(o=t.xoff,o==null)return;a=t.yoff;var F=0,k=-1;for(g=0;g<h;g++){for(p=0;p<c;p++){var P=d*g+(p>>5),_=E[(a+g)*(Nm<<5)+(o+p)<<2]?1<<31-p%32:0;A[P]|=_,F|=_}F?k=g:(t.y0++,h--,g--,a++)}t.y1=t.y0+k,t.sprite=A.slice(0,(t.y1-t.y0)*d)}}}function aEe(e,t,n){n>>=5;for(var i=e.sprite,r=e.width>>5,s=e.x-(r<<4),o=s&127,a=32-o,l=e.y1-e.y0,u=(e.y+e.y0)*n+(s>>5),c,d=0;d<l;d++){c=0;for(var h=0;h<=r;h++)if((c<<a|(h<r?(c=i[d*r+h])>>>o:0))&t[u+h])return!0;u+=n}return!1}function lEe(e,t){var n=e[0],i=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>i.x&&(i.x=t.x+t.x1),t.y+t.y1>i.y&&(i.y=t.y+t.y1)}function uEe(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function Dq(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function cEe(e){var t=4,n=t*e[0]/e[1],i=0,r=0;return function(s){var o=s<0?-1:1;switch(Math.sqrt(1+4*o*s)-o&3){case 0:i+=n;break;case 1:r+=t;break;case 2:i-=n;break;default:r-=t;break}return[i,r]}}function dEe(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function Hc(e){return typeof e=="function"?e:function(){return e}}var hEe={archimedean:Dq,rectangular:cEe};const Pq=["x","y","font","fontSize","fontStyle","fontWeight","angle"],fEe=["text","font","rotate","fontSize","fontStyle","fontWeight"];function s_(e){Y.call(this,sEe(),e)}s_.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:Pq}]};pe(s_,Y,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&Z("Wordcloud size dimensions must be non-zero.");function n(g){const v=e[g];return nt(v)&&t.modified(v.fields)}const i=e.modified();if(!(i||t.changed(t.ADD_REM)||fEe.some(n)))return;const r=t.materialize(t.SOURCE).source,s=this.value,o=e.as||Pq;let a=e.fontSize||14,l;if(nt(a)?l=e.fontSizeRange:a=Oi(a),l){const g=a,v=Et("sqrt")().domain(ma(r,g)).range(l);a=C=>v(g(C))}r.forEach(g=>{g[o[0]]=NaN,g[o[1]]=NaN,g[o[3]]=0});const u=s.words(r).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(a).random(Os).layout(),c=s.size(),d=c[0]>>1,h=c[1]>>1,p=u.length;for(let g=0,v,C;g<p;++g)v=u[g],C=v.datum,C[o[0]]=v.x+d,C[o[1]]=v.y+h,C[o[2]]=v.font,C[o[3]]=v.size,C[o[4]]=v.style,C[o[5]]=v.weight,C[o[6]]=v.rotate;return t.reflow(i).modifies(o)}});const pEe=Object.freeze(Object.defineProperty({__proto__:null,wordcloud:s_},Symbol.toStringTag,{value:"Module"})),gEe=e=>new Uint8Array(e),mEe=e=>new Uint16Array(e),ev=e=>new Uint32Array(e);function vEe(){let e=8,t=[],n=ev(0),i=By(0,e),r=By(0,e);return{data:()=>t,seen:()=>n=CEe(n,t.length),add(s){for(let o=0,a=t.length,l=s.length,u;o<l;++o)u=s[o],u._index=a++,t.push(u)},remove(s,o){const a=t.length,l=Array(a-s),u=t;let c,d,h;for(d=0;!o[d]&&d<a;++d)l[d]=t[d],u[d]=d;for(h=d;d<a;++d)c=t[d],o[d]?u[d]=-1:(u[d]=h,i[h]=i[d],r[h]=r[d],l[h]=c,c._index=h++),i[d]=0;return t=l,u},size:()=>t.length,curr:()=>i,prev:()=>r,reset:s=>r[s]=i[s],all:()=>e<257?255:e<65537?65535:4294967295,set(s,o){i[s]|=o},clear(s,o){i[s]&=~o},resize(s,o){const a=i.length;(s>a||o>e)&&(e=Math.max(o,e),i=By(s,e,i),r=By(s,e))}}}function CEe(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function By(e,t,n){const i=(t<257?gEe:t<65537?mEe:ev)(e);return n&&i.set(n),i}function lH(e,t,n){const i=1<<t;return{one:i,zero:~i,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(r,s){const o=this,a=o.bisect(o.range,r.value),l=r.index,u=a[0],c=a[1],d=l.length;let h;for(h=0;h<u;++h)s[l[h]]|=i;for(h=c;h<d;++h)s[l[h]]|=i;return o}}}function uH(){let e=ev(0),t=[],n=0;function i(a,l,u){if(!l.length)return[];const c=n,d=l.length,h=ev(d);let p=Array(d),g,v,C;for(C=0;C<d;++C)p[C]=a(l[C]),h[C]=C;if(p=yEe(p,h),c)g=t,v=e,t=Array(c+d),e=ev(c+d),wEe(u,g,v,c,p,h,d,t,e);else{if(u>0)for(C=0;C<d;++C)h[C]+=u;t=p,e=h}return n=c+d,{index:h,value:p}}function r(a,l){const u=n;let c,d,h;for(d=0;!l[e[d]]&&d<u;++d);for(h=d;d<u;++d)l[c=e[d]]||(e[h]=c,t[h]=t[d],++h);n=u-a}function s(a){for(let l=0,u=n;l<u;++l)e[l]=a[e[l]]}function o(a,l){let u;return l?u=l.length:(l=t,u=n),[xhe(l,a[0],0,u),Vu(l,a[1],0,u)]}return{insert:i,remove:r,bisect:o,reindex:s,index:()=>e,size:()=>n}}function yEe(e,t){return e.sort.call(t,(n,i)=>{const r=e[n],s=e[i];return r<s?-1:r>s?1:0}),Fhe(e,t)}function wEe(e,t,n,i,r,s,o,a,l){let u=0,c=0,d;for(d=0;u<i&&c<o;++d)t[u]<r[c]?(a[d]=t[u],l[d]=n[u++]):(a[d]=r[c],l[d]=s[c++]+e);for(;u<i;++u,++d)a[d]=t[u],l[d]=n[u];for(;c<o;++c,++d)a[d]=r[c],l[d]=s[c]+e}function o_(e){Y.call(this,vEe(),e),this._indices=null,this._dims=null}o_.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};pe(o_,Y,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(i=>t.modified(i.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,i=e.query,r=this._indices={},s=this._dims=[],o=i.length;let a=0,l,u;for(;a<o;++a)l=n[a].fname,u=r[l]||(r[l]=uH()),s.push(lH(u,a,i[a]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),i=e.fields,r=e.query,s=this._indices,o=this._dims,a=this.value,l=a.curr(),u=a.prev(),c=a.all(),d=n.rem=n.add,h=n.mod,p=r.length,g={};let v,C,y,b,S,x,E,A,F;if(u.set(l),t.rem.length&&(S=this.remove(e,t,n)),t.add.length&&a.add(t.add),t.mod.length)for(x={},b=t.mod,E=0,A=b.length;E<A;++E)x[b[E]._index]=1;for(E=0;E<p;++E)F=i[E],(!o[E]||e.modified("fields",E)||t.modified(F.fields))&&(y=F.fname,(v=g[y])||(s[y]=C=uH(),g[y]=v=C.insert(F,t.source,0)),o[E]=lH(C,E,r[E]).onAdd(v,l));for(E=0,A=a.data().length;E<A;++E)S[E]||(u[E]!==l[E]?d.push(E):x[E]&&l[E]!==c&&h.push(E));return a.mask=(1<<p)-1,n},eval(e,t){const n=t.materialize().fork(),i=this._dims.length;let r=0;return t.rem.length&&(this.remove(e,t,n),r|=(1<<i)-1),e.modified("query")&&!e.modified("fields")&&(r|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),r|=(1<<i)-1),t.mod.length&&(this.modify(t,n),r|=(1<<i)-1),this.value.mask=r,n},insert(e,t,n){const i=t.add,r=this.value,s=this._dims,o=this._indices,a=e.fields,l={},u=n.add,c=r.size()+i.length,d=s.length;let h=r.size(),p,g,v;r.resize(c,d),r.add(i);const C=r.curr(),y=r.prev(),b=r.all();for(p=0;p<d;++p)g=a[p].fname,v=l[g]||(l[g]=o[g].insert(a[p],i,h)),s[p].onAdd(v,C);for(;h<c;++h)y[h]=b,C[h]!==b&&u.push(h)},modify(e,t){const n=t.mod,i=this.value,r=i.curr(),s=i.all(),o=e.mod;let a,l,u;for(a=0,l=o.length;a<l;++a)u=o[a]._index,r[u]!==s&&n.push(u)},remove(e,t,n){const i=this._indices,r=this.value,s=r.curr(),o=r.prev(),a=r.all(),l={},u=n.rem,c=t.rem;let d,h,p,g;for(d=0,h=c.length;d<h;++d)p=c[d]._index,l[p]=1,o[p]=g=s[p],s[p]=a,g!==a&&u.push(p);for(p in i)i[p].remove(h,l);return this.reindex(t,h,l),l},reindex(e,t,n){const i=this._indices,r=this.value;e.runAfter(()=>{const s=r.remove(t,n);for(const o in i)i[o].reindex(s)})},update(e,t,n){const i=this._dims,r=e.query,s=t.stamp,o=i.length;let a=0,l,u;for(n.filters=0,u=0;u<o;++u)e.modified("query",u)&&(l=u,++a);if(a===1)a=i[l].one,this.incrementOne(i[l],r[l],n.add,n.rem);else for(u=0,a=0;u<o;++u)e.modified("query",u)&&(a|=i[u].one,this.incrementAll(i[u],r[u],s,n.add),n.rem=n.add);return a},incrementAll(e,t,n,i){const r=this.value,s=r.seen(),o=r.curr(),a=r.prev(),l=e.index(),u=e.bisect(e.range),c=e.bisect(t),d=c[0],h=c[1],p=u[0],g=u[1],v=e.one;let C,y,b;if(d<p)for(C=d,y=Math.min(p,h);C<y;++C)b=l[C],s[b]!==n&&(a[b]=o[b],s[b]=n,i.push(b)),o[b]^=v;else if(d>p)for(C=p,y=Math.min(d,g);C<y;++C)b=l[C],s[b]!==n&&(a[b]=o[b],s[b]=n,i.push(b)),o[b]^=v;if(h>g)for(C=Math.max(d,g),y=h;C<y;++C)b=l[C],s[b]!==n&&(a[b]=o[b],s[b]=n,i.push(b)),o[b]^=v;else if(h<g)for(C=Math.max(p,h),y=g;C<y;++C)b=l[C],s[b]!==n&&(a[b]=o[b],s[b]=n,i.push(b)),o[b]^=v;e.range=t.slice()},incrementOne(e,t,n,i){const r=this.value,s=r.curr(),o=e.index(),a=e.bisect(e.range),l=e.bisect(t),u=l[0],c=l[1],d=a[0],h=a[1],p=e.one;let g,v,C;if(u<d)for(g=u,v=Math.min(d,c);g<v;++g)C=o[g],s[C]^=p,n.push(C);else if(u>d)for(g=d,v=Math.min(u,h);g<v;++g)C=o[g],s[C]^=p,i.push(C);if(c>h)for(g=Math.max(u,h),v=c;g<v;++g)C=o[g],s[C]^=p,n.push(C);else if(c<h)for(g=Math.max(d,c),v=h;g<v;++g)C=o[g],s[C]^=p,i.push(C);e.range=t.slice()}});function a_(e){Y.call(this,null,e)}a_.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};pe(a_,Y,{transform(e,t){const n=~(e.ignore||0),i=e.filter,r=i.mask;if(!(r&n))return t.StopPropagation;const s=t.fork(t.ALL),o=i.data(),a=i.curr(),l=i.prev(),u=c=>a[c]&n?null:o[c];return s.filter(s.MOD,u),r&r-1?(s.filter(s.ADD,c=>{const d=a[c]&n;return!d&&d^l[c]&n?o[c]:null}),s.filter(s.REM,c=>{const d=a[c]&n;return d&&!(d^(d^l[c]&n))?o[c]:null})):(s.filter(s.ADD,u),s.filter(s.REM,c=>(a[c]&n)===r?o[c]:null)),s.filter(s.SOURCE,c=>u(c._index))}});const bEe=Object.freeze(Object.defineProperty({__proto__:null,crossfilter:o_,resolvefilter:a_},Symbol.toStringTag,{value:"Module"})),SEe="RawCode",Nd="Literal",xEe="Property",REe="Identifier",EEe="ArrayExpression",FEe="BinaryExpression",kq="CallExpression",AEe="ConditionalExpression",DEe="LogicalExpression",PEe="MemberExpression",kEe="ObjectExpression",TEe="UnaryExpression";function ko(e){this.type=e}ko.prototype.visit=function(e){let t,n,i;if(e(this))return 1;for(t=MEe(this),n=0,i=t.length;n<i;++n)if(t[n].visit(e))return 1};function MEe(e){switch(e.type){case EEe:return e.elements;case FEe:case DEe:return[e.left,e.right];case kq:return[e.callee].concat(e.arguments);case AEe:return[e.test,e.consequent,e.alternate];case PEe:return[e.object,e.property];case kEe:return e.properties;case xEe:return[e.key,e.value];case TEe:return[e.argument];case REe:case Nd:case SEe:default:return[]}}var ka,Pe,Q,Ti,_t,ox=1,W0=2,$d=3,gc=4,ax=5,oh=6,yr=7,U0=8,IEe=9;ka={};ka[ox]="Boolean";ka[W0]="<end>";ka[$d]="Identifier";ka[gc]="Keyword";ka[ax]="Null";ka[oh]="Numeric";ka[yr]="Punctuator";ka[U0]="String";ka[IEe]="RegularExpression";var _Ee="ArrayExpression",OEe="BinaryExpression",LEe="CallExpression",NEe="ConditionalExpression",Tq="Identifier",$Ee="Literal",BEe="LogicalExpression",GEe="MemberExpression",zEe="ObjectExpression",HEe="Property",VEe="UnaryExpression",Xn="Unexpected token %0",WEe="Unexpected number",UEe="Unexpected string",jEe="Unexpected identifier",qEe="Unexpected reserved word",KEe="Unexpected end of input",hk="Invalid regular expression",rA="Invalid regular expression: missing /",Mq="Octal literals are not allowed in strict mode.",YEe="Duplicate data property in object literal not allowed in strict mode",di="ILLEGAL",Lv="Disabled.",XEe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),QEe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function lx(e,t){if(!e)throw new Error("ASSERT: "+t)}function rl(e){return e>=48&&e<=57}function l_(e){return"0123456789abcdefABCDEF".includes(e)}function tv(e){return"01234567".includes(e)}function JEe(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].includes(e)}function Nv(e){return e===10||e===13||e===8232||e===8233}function j0(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&XEe.test(String.fromCharCode(e))}function sS(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&QEe.test(String.fromCharCode(e))}const ZEe={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function Iq(){for(;Q<Ti;){const e=Pe.charCodeAt(Q);if(JEe(e)||Nv(e))++Q;else break}}function fk(e){var t,n,i,r=0;for(n=e==="u"?4:2,t=0;t<n;++t)Q<Ti&&l_(Pe[Q])?(i=Pe[Q++],r=r*16+"0123456789abcdef".indexOf(i.toLowerCase())):St({},Xn,di);return String.fromCharCode(r)}function eFe(){var e,t,n,i;for(e=Pe[Q],t=0,e==="}"&&St({},Xn,di);Q<Ti&&(e=Pe[Q++],!!l_(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&St({},Xn,di),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,i=(t-65536&1023)+56320,String.fromCharCode(n,i))}function _q(){var e,t;for(e=Pe.charCodeAt(Q++),t=String.fromCharCode(e),e===92&&(Pe.charCodeAt(Q)!==117&&St({},Xn,di),++Q,e=fk("u"),(!e||e==="\\"||!j0(e.charCodeAt(0)))&&St({},Xn,di),t=e);Q<Ti&&(e=Pe.charCodeAt(Q),!!sS(e));)++Q,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),Pe.charCodeAt(Q)!==117&&St({},Xn,di),++Q,e=fk("u"),(!e||e==="\\"||!sS(e.charCodeAt(0)))&&St({},Xn,di),t+=e);return t}function tFe(){var e,t;for(e=Q++;Q<Ti;){if(t=Pe.charCodeAt(Q),t===92)return Q=e,_q();if(sS(t))++Q;else break}return Pe.slice(e,Q)}function nFe(){var e,t,n;return e=Q,t=Pe.charCodeAt(Q)===92?_q():tFe(),t.length===1?n=$d:ZEe.hasOwnProperty(t)?n=gc:t==="null"?n=ax:t==="true"||t==="false"?n=ox:n=$d,{type:n,value:t,start:e,end:Q}}function sA(){var e=Q,t=Pe.charCodeAt(Q),n,i=Pe[Q],r,s,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++Q,{type:yr,value:String.fromCharCode(t),start:e,end:Q};default:if(n=Pe.charCodeAt(Q+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return Q+=2,{type:yr,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:Q};case 33:case 61:return Q+=2,Pe.charCodeAt(Q)===61&&++Q,{type:yr,value:Pe.slice(e,Q),start:e,end:Q}}}if(o=Pe.substr(Q,4),o===">>>=")return Q+=4,{type:yr,value:o,start:e,end:Q};if(s=o.substr(0,3),s===">>>"||s==="<<="||s===">>=")return Q+=3,{type:yr,value:s,start:e,end:Q};if(r=s.substr(0,2),i===r[1]&&"+-<>&|".includes(i)||r==="=>")return Q+=2,{type:yr,value:r,start:e,end:Q};if(r==="//"&&St({},Xn,di),"<>=!+-*%&|^/".includes(i))return++Q,{type:yr,value:i,start:e,end:Q};St({},Xn,di)}function iFe(e){let t="";for(;Q<Ti&&l_(Pe[Q]);)t+=Pe[Q++];return t.length===0&&St({},Xn,di),j0(Pe.charCodeAt(Q))&&St({},Xn,di),{type:oh,value:parseInt("0x"+t,16),start:e,end:Q}}function rFe(e){let t="0"+Pe[Q++];for(;Q<Ti&&tv(Pe[Q]);)t+=Pe[Q++];return(j0(Pe.charCodeAt(Q))||rl(Pe.charCodeAt(Q)))&&St({},Xn,di),{type:oh,value:parseInt(t,8),octal:!0,start:e,end:Q}}function cH(){var e,t,n;if(n=Pe[Q],lx(rl(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=Q,e="",n!=="."){if(e=Pe[Q++],n=Pe[Q],e==="0"){if(n==="x"||n==="X")return++Q,iFe(t);if(tv(n))return rFe(t);n&&rl(n.charCodeAt(0))&&St({},Xn,di)}for(;rl(Pe.charCodeAt(Q));)e+=Pe[Q++];n=Pe[Q]}if(n==="."){for(e+=Pe[Q++];rl(Pe.charCodeAt(Q));)e+=Pe[Q++];n=Pe[Q]}if(n==="e"||n==="E")if(e+=Pe[Q++],n=Pe[Q],(n==="+"||n==="-")&&(e+=Pe[Q++]),rl(Pe.charCodeAt(Q)))for(;rl(Pe.charCodeAt(Q));)e+=Pe[Q++];else St({},Xn,di);return j0(Pe.charCodeAt(Q))&&St({},Xn,di),{type:oh,value:parseFloat(e),start:t,end:Q}}function sFe(){var e="",t,n,i,r,s=!1;for(t=Pe[Q],lx(t==="'"||t==='"',"String literal must starts with a quote"),n=Q,++Q;Q<Ti;)if(i=Pe[Q++],i===t){t="";break}else if(i==="\\")if(i=Pe[Q++],!i||!Nv(i.charCodeAt(0)))switch(i){case"u":case"x":Pe[Q]==="{"?(++Q,e+=eFe()):e+=fk(i);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:tv(i)?(r="01234567".indexOf(i),r!==0&&(s=!0),Q<Ti&&tv(Pe[Q])&&(s=!0,r=r*8+"01234567".indexOf(Pe[Q++]),"0123".includes(i)&&Q<Ti&&tv(Pe[Q])&&(r=r*8+"01234567".indexOf(Pe[Q++]))),e+=String.fromCharCode(r)):e+=i;break}else i==="\r"&&Pe[Q]===`
`&&++Q;else{if(Nv(i.charCodeAt(0)))break;e+=i}return t!==""&&St({},Xn,di),{type:U0,value:e,octal:s,start:n,end:Q}}function oFe(e,t){let n=e;t.includes("u")&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(i,r)=>{if(parseInt(r,16)<=1114111)return"x";St({},hk)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{St({},hk)}try{return new RegExp(e,t)}catch{return null}}function aFe(){var e,t,n,i,r;for(e=Pe[Q],lx(e==="/","Regular expression literal must start with a slash"),t=Pe[Q++],n=!1,i=!1;Q<Ti;)if(e=Pe[Q++],t+=e,e==="\\")e=Pe[Q++],Nv(e.charCodeAt(0))&&St({},rA),t+=e;else if(Nv(e.charCodeAt(0)))St({},rA);else if(n)e==="]"&&(n=!1);else if(e==="/"){i=!0;break}else e==="["&&(n=!0);return i||St({},rA),r=t.substr(1,t.length-2),{value:r,literal:t}}function lFe(){var e,t,n;for(t="",n="";Q<Ti&&(e=Pe[Q],!!sS(e.charCodeAt(0)));)++Q,e==="\\"&&Q<Ti?St({},Xn,di):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&St({},hk,n),{value:n,literal:t}}function uFe(){var e,t,n,i;return _t=null,Iq(),e=Q,t=aFe(),n=lFe(),i=oFe(t.value,n.value),{literal:t.literal+n.literal,value:i,regex:{pattern:t.value,flags:n.value},start:e,end:Q}}function cFe(e){return e.type===$d||e.type===gc||e.type===ox||e.type===ax}function Oq(){if(Iq(),Q>=Ti)return{type:W0,start:Q,end:Q};const e=Pe.charCodeAt(Q);return j0(e)?nFe():e===40||e===41||e===59?sA():e===39||e===34?sFe():e===46?rl(Pe.charCodeAt(Q+1))?cH():sA():rl(e)?cH():sA()}function br(){const e=_t;return Q=e.end,_t=Oq(),Q=e.end,e}function Lq(){const e=Q;_t=Oq(),Q=e}function dFe(e){const t=new ko(_Ee);return t.elements=e,t}function dH(e,t,n){const i=new ko(e==="||"||e==="&&"?BEe:OEe);return i.operator=e,i.left=t,i.right=n,i}function hFe(e,t){const n=new ko(LEe);return n.callee=e,n.arguments=t,n}function fFe(e,t,n){const i=new ko(NEe);return i.test=e,i.consequent=t,i.alternate=n,i}function u_(e){const t=new ko(Tq);return t.name=e,t}function $m(e){const t=new ko($Ee);return t.value=e.value,t.raw=Pe.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function hH(e,t,n){const i=new ko(GEe);return i.computed=e==="[",i.object=t,i.property=n,i.computed||(n.member=!0),i}function pFe(e){const t=new ko(zEe);return t.properties=e,t}function fH(e,t,n){const i=new ko(HEe);return i.key=t,i.value=n,i.kind=e,i}function gFe(e,t){const n=new ko(VEe);return n.operator=e,n.argument=t,n.prefix=!0,n}function St(e,t){var n,i=Array.prototype.slice.call(arguments,2),r=t.replace(/%(\d)/g,(s,o)=>(lx(o<i.length,"Message reference must be in range"),i[o]));throw n=new Error(r),n.index=Q,n.description=r,n}function ux(e){e.type===W0&&St(e,KEe),e.type===oh&&St(e,WEe),e.type===U0&&St(e,UEe),e.type===$d&&St(e,jEe),e.type===gc&&St(e,qEe),St(e,Xn,e.value)}function Mi(e){const t=br();(t.type!==yr||t.value!==e)&&ux(t)}function qt(e){return _t.type===yr&&_t.value===e}function oA(e){return _t.type===gc&&_t.value===e}function mFe(){const e=[];for(Q=_t.start,Mi("[");!qt("]");)qt(",")?(br(),e.push(null)):(e.push(Bd()),qt("]")||Mi(","));return br(),dFe(e)}function pH(){Q=_t.start;const e=br();return e.type===U0||e.type===oh?(e.octal&&St(e,Mq),$m(e)):u_(e.value)}function vFe(){var e,t,n,i;if(Q=_t.start,e=_t,e.type===$d)return n=pH(),Mi(":"),i=Bd(),fH("init",n,i);if(e.type===W0||e.type===yr)ux(e);else return t=pH(),Mi(":"),i=Bd(),fH("init",t,i)}function CFe(){var e=[],t,n,i,r={},s=String;for(Q=_t.start,Mi("{");!qt("}");)t=vFe(),t.key.type===Tq?n=t.key.name:n=s(t.key.value),i="$"+n,Object.prototype.hasOwnProperty.call(r,i)?St({},YEe):r[i]=!0,e.push(t),qt("}")||Mi(",");return Mi("}"),pFe(e)}function yFe(){Mi("(");const e=c_();return Mi(")"),e}const wFe={if:1};function bFe(){var e,t,n;if(qt("("))return yFe();if(qt("["))return mFe();if(qt("{"))return CFe();if(e=_t.type,Q=_t.start,e===$d||wFe[_t.value])n=u_(br().value);else if(e===U0||e===oh)_t.octal&&St(_t,Mq),n=$m(br());else{if(e===gc)throw new Error(Lv);e===ox?(t=br(),t.value=t.value==="true",n=$m(t)):e===ax?(t=br(),t.value=null,n=$m(t)):qt("/")||qt("/=")?(n=$m(uFe()),Lq()):ux(br())}return n}function SFe(){const e=[];if(Mi("("),!qt(")"))for(;Q<Ti&&(e.push(Bd()),!qt(")"));)Mi(",");return Mi(")"),e}function xFe(){Q=_t.start;const e=br();return cFe(e)||ux(e),u_(e.value)}function RFe(){return Mi("."),xFe()}function EFe(){Mi("[");const e=c_();return Mi("]"),e}function FFe(){var e,t,n;for(e=bFe();;)if(qt("."))n=RFe(),e=hH(".",e,n);else if(qt("("))t=SFe(),e=hFe(e,t);else if(qt("["))n=EFe(),e=hH("[",e,n);else break;return e}function gH(){const e=FFe();if(_t.type===yr&&(qt("++")||qt("--")))throw new Error(Lv);return e}function _w(){var e,t;if(_t.type!==yr&&_t.type!==gc)t=gH();else{if(qt("++")||qt("--"))throw new Error(Lv);if(qt("+")||qt("-")||qt("~")||qt("!"))e=br(),t=_w(),t=gFe(e.value,t);else{if(oA("delete")||oA("void")||oA("typeof"))throw new Error(Lv);t=gH()}}return t}function mH(e){let t=0;if(e.type!==yr&&e.type!==gc)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function AFe(){var e,t,n,i,r,s,o,a,l,u;if(e=_t,l=_w(),i=_t,r=mH(i),r===0)return l;for(i.prec=r,br(),t=[e,_t],o=_w(),s=[l,i,o];(r=mH(_t))>0;){for(;s.length>2&&r<=s[s.length-2].prec;)o=s.pop(),a=s.pop().value,l=s.pop(),t.pop(),n=dH(a,l,o),s.push(n);i=br(),i.prec=r,s.push(i),t.push(_t),n=_w(),s.push(n)}for(u=s.length-1,n=s[u],t.pop();u>1;)t.pop(),n=dH(s[u-1].value,s[u-2],n),u-=2;return n}function Bd(){var e,t,n;return e=AFe(),qt("?")&&(br(),t=Bd(),Mi(":"),n=Bd(),e=fFe(e,t,n)),e}function c_(){const e=Bd();if(qt(","))throw new Error(Lv);return e}function d_(e){Pe=e,Q=0,Ti=Pe.length,_t=null,Lq();const t=c_();if(_t.type!==W0)throw new Error("Unexpect token after expression.");return t}var Nq={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function $q(e){function t(o,a,l,u){let c=e(a[0]);return l&&(c=l+"("+c+")",l.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+o+(u<0?"":u===0?"()":"("+a.slice(1).map(e).join(",")+")")}function n(o,a,l){return u=>t(o,u,a,l)}const i="new Date",r="String",s="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(o){o.length<3&&Z("Missing arguments to clamp function."),o.length>3&&Z("Too many arguments to clamp function.");const a=o.map(e);return"Math.max("+a[1]+", Math.min("+a[2]+","+a[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:i,date:n("getDate",i,0),day:n("getDay",i,0),year:n("getFullYear",i,0),month:n("getMonth",i,0),hours:n("getHours",i,0),minutes:n("getMinutes",i,0),seconds:n("getSeconds",i,0),milliseconds:n("getMilliseconds",i,0),time:n("getTime",i,0),timezoneoffset:n("getTimezoneOffset",i,0),utcdate:n("getUTCDate",i,0),utcday:n("getUTCDay",i,0),utcyear:n("getUTCFullYear",i,0),utcmonth:n("getUTCMonth",i,0),utchours:n("getUTCHours",i,0),utcminutes:n("getUTCMinutes",i,0),utcseconds:n("getUTCSeconds",i,0),utcmilliseconds:n("getUTCMilliseconds",i,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",r,0),lower:n("toLowerCase",r,0),substring:n("substring",r),split:n("split",r),trim:n("trim",r,0),regexp:s,test:n("test",s),if:function(o){o.length<3&&Z("Missing arguments to if function."),o.length>3&&Z("Too many arguments to if function.");const a=o.map(e);return"("+a[0]+"?"+a[1]+":"+a[2]+")"}}}function DFe(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function Bq(e){e=e||{};const t=e.allowed?Co(e.allowed):{},n=e.forbidden?Co(e.forbidden):{},i=e.constants||Nq,r=(e.functions||$q)(d),s=e.globalvar,o=e.fieldvar,a=nt(s)?s:g=>`${s}["${g}"]`;let l={},u={},c=0;function d(g){if(be(g))return g;const v=h[g.type];return v==null&&Z("Unsupported type: "+g.type),v(g)}const h={Literal:g=>g.raw,Identifier:g=>{const v=g.name;return c>0?v:Ee(n,v)?Z("Illegal identifier: "+v):Ee(i,v)?i[v]:Ee(t,v)?v:(l[v]=1,a(v))},MemberExpression:g=>{const v=!g.computed,C=d(g.object);v&&(c+=1);const y=d(g.property);return C===o&&(u[DFe(y)]=1),v&&(c-=1),C+(v?"."+y:"["+y+"]")},CallExpression:g=>{g.callee.type!=="Identifier"&&Z("Illegal callee type: "+g.callee.type);const v=g.callee.name,C=g.arguments,y=Ee(r,v)&&r[v];return y||Z("Unrecognized function: "+v),nt(y)?y(C):y+"("+C.map(d).join(",")+")"},ArrayExpression:g=>"["+g.elements.map(d).join(",")+"]",BinaryExpression:g=>"("+d(g.left)+" "+g.operator+" "+d(g.right)+")",UnaryExpression:g=>"("+g.operator+d(g.argument)+")",ConditionalExpression:g=>"("+d(g.test)+"?"+d(g.consequent)+":"+d(g.alternate)+")",LogicalExpression:g=>"("+d(g.left)+g.operator+d(g.right)+")",ObjectExpression:g=>"{"+g.properties.map(d).join(",")+"}",Property:g=>{c+=1;const v=d(g.key);return c-=1,v+":"+d(g.value)}};function p(g){const v={code:d(g),globals:Object.keys(l),fields:Object.keys(u)};return l={},u={},v}return p.functions=r,p.constants=i,p}const vH=Symbol("vega_selection_getter");function Gq(e){return(!e.getter||!e.getter[vH])&&(e.getter=Ms(e.field),e.getter[vH]=!0),e.getter}const h_="intersect",CH="union",PFe="vlMulti",kFe="vlPoint",yH="or",TFe="and",ta="_vgsid_",$v=Ms(ta),MFe="E",IFe="R",_Fe="R-E",OFe="R-LE",LFe="R-RE",NFe="E-LT",$Fe="E-LTE",BFe="E-GT",GFe="E-GTE",zFe="E-VALID",HFe="E-ONE",oS="index:unit";function wH(e,t){for(var n=t.fields,i=t.values,r=n.length,s=0,o,a;s<r;++s)if(a=n[s],o=Gq(a)(e),Ou(o)&&(o=Ai(o)),Ou(i[s])&&(i[s]=Ai(i[s])),te(i[s])&&Ou(i[s][0])&&(i[s]=i[s].map(Ai)),a.type===MFe){if(te(i[s])?!i[s].includes(o):o!==i[s])return!1}else if(a.type===IFe){if(!lf(o,i[s]))return!1}else if(a.type===LFe){if(!lf(o,i[s],!0,!1))return!1}else if(a.type===_Fe){if(!lf(o,i[s],!1,!1))return!1}else if(a.type===OFe){if(!lf(o,i[s],!1,!0))return!1}else if(a.type===NFe){if(o>=i[s])return!1}else if(a.type===$Fe){if(o>i[s])return!1}else if(a.type===BFe){if(o<=i[s])return!1}else if(a.type===GFe){if(o<i[s])return!1}else if(a.type===zFe){if(o===null||isNaN(o))return!1}else if(a.type===HFe&&i[s].indexOf(o)===-1)return!1;return!0}function VFe(e,t,n){for(var i=this.context.data[e],r=i?i.values.value:[],s=i?i[oS]&&i[oS].value:void 0,o=n===h_,a=r.length,l=0,u,c,d,h,p;l<a;++l)if(u=r[l],s&&o){if(c=c||{},d=c[h=u.unit]||0,d===-1)continue;if(p=wH(t,u),c[h]=p?-1:++d,p&&s.size===1)return!0;if(!p&&d===s.get(h).count)return!1}else if(p=wH(t,u),o^p)return p;return a&&o}const zq=Lp($v),WFe=zq.left,UFe=zq.right;function jFe(e,t,n){const i=this.context.data[e],r=i?i.values.value:[],s=i?i[oS]&&i[oS].value:void 0,o=n===h_,a=$v(t),l=WFe(r,a);if(l===r.length||$v(r[l])!==a)return!1;if(s&&o){if(s.size===1)return!0;if(UFe(r,a)-l<s.size)return!1}return!0}function qFe(e,t){return e.map(n=>Ze(t.fields?{values:t.fields.map(i=>Gq(i)(n.datum))}:{[ta]:$v(n.datum)},t))}function KFe(e,t,n,i){for(var r=this.context.data[e],s=r?r.values.value:[],o={},a={},l={},u,c,d,h,p,g,v,C,y,b,S=s.length,x=0,E,A;x<S;++x)if(u=s[x],h=u.unit,c=u.fields,d=u.values,c&&d){for(E=0,A=c.length;E<A;++E)p=c[E],v=o[p.field]||(o[p.field]={}),C=v[h]||(v[h]=[]),l[p.field]=y=p.type.charAt(0),b=aA[`${y}_union`],v[h]=b(C,we(d[E]));n&&(C=a[h]||(a[h]=[]),C.push(we(d).reduce((F,k,P)=>(F[c[P].field]=k,F),{})))}else p=ta,g=$v(u),v=o[p]||(o[p]={}),C=v[h]||(v[h]=[]),C.push(g),n&&(C=a[h]||(a[h]=[]),C.push({[ta]:g}));if(t=t||CH,o[ta]?o[ta]=aA[`${ta}_${t}`](...Object.values(o[ta])):Object.keys(o).forEach(F=>{o[F]=Object.keys(o[F]).map(k=>o[F][k]).reduce((k,P)=>k===void 0?P:aA[`${l[F]}_${t}`](k,P))}),s=Object.keys(a),n&&s.length){const F=i?kFe:PFe;o[F]=t===CH?{[yH]:s.reduce((k,P)=>(k.push(...a[P]),k),[])}:{[TFe]:s.map(k=>({[yH]:a[k]}))}}return o}var aA={[`${ta}_union`]:Ohe,[`${ta}_intersect`]:Ihe,E_union:function(e,t){if(!e.length)return t;for(var n=0,i=t.length;n<i;++n)e.includes(t[n])||e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.includes(n)):t},R_union:function(e,t){var n=Ai(t[0]),i=Ai(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<i&&(e[1]=i),e):[n,i]},R_intersect:function(e,t){var n=Ai(t[0]),i=Ai(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?i<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>i&&(e[1]=i),e):[n,i]}};const YFe=":",XFe="@";function f_(e,t,n,i){t[0].type!==Nd&&Z("First argument to selection functions must be a string literal.");const r=t[0].value,s=t.length>=2&&gt(t).value,o="unit",a=XFe+o,l=YFe+r;s===h_&&!Ee(i,a)&&(i[a]=n.getData(r).indataRef(n,o)),Ee(i,l)||(i[l]=n.getData(r).tuplesRef())}function Hq(e){const t=this.context.data[e];return t?t.values.value:[]}function QFe(e,t,n){const i=this.context.data[e]["index:"+t],r=i?i.value.get(n):void 0;return r&&r.count}function JFe(e,t){const n=this.context.dataflow,i=this.context.data[e],r=i.input;return n.pulse(r,n.changeset().remove(Is).insert(t)),1}function ZFe(e,t,n){if(e){const i=this.context.dataflow,r=e.mark.source;i.pulse(r,i.changeset().encode(e,t))}return n!==void 0?n:e}const q0=e=>function(t,n){const i=this.context.dataflow.locale();return t===null?"null":i[e](n)(t)},eAe=q0("format"),Vq=q0("timeFormat"),tAe=q0("utcFormat"),nAe=q0("timeParse"),iAe=q0("utcParse"),Gy=new Date(2e3,0,1);function cx(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(Gy.setYear(2e3),Gy.setMonth(e),Gy.setDate(t),Vq.call(this,Gy,n))}function rAe(e){return cx.call(this,e,1,"%B")}function sAe(e){return cx.call(this,e,1,"%b")}function oAe(e){return cx.call(this,0,2+e,"%A")}function aAe(e){return cx.call(this,0,2+e,"%a")}const lAe=":",uAe="@",pk="%",Wq="$";function p_(e,t,n,i){t[0].type!==Nd&&Z("First argument to data functions must be a string literal.");const r=t[0].value,s=lAe+r;if(!Ee(s,i))try{i[s]=n.getData(r).tuplesRef()}catch{}}function cAe(e,t,n,i){t[0].type!==Nd&&Z("First argument to indata must be a string literal."),t[1].type!==Nd&&Z("Second argument to indata must be a string literal.");const r=t[0].value,s=t[1].value,o=uAe+s;Ee(o,i)||(i[o]=n.getData(r).indataRef(n,s))}function nr(e,t,n,i){if(t[0].type===Nd)bH(n,i,t[0].value);else for(e in n.scales)bH(n,i,e)}function bH(e,t,n){const i=pk+n;if(!Ee(t,i))try{t[i]=e.scaleRef(n)}catch{}}function Ta(e,t){if(be(e)){const n=t.scales[e];return n&&g0e(n.value)?n.value:void 0}}function dAe(e,t,n){t.__bandwidth=r=>r&&r.bandwidth?r.bandwidth():0,n._bandwidth=nr,n._range=nr,n._scale=nr;const i=r=>"_["+(r.type===Nd?he(pk+r.value):he(pk)+"+"+e(r))+"]";return{_bandwidth:r=>`this.__bandwidth(${i(r[0])})`,_range:r=>`${i(r[0])}.range()`,_scale:r=>`${i(r[0])}(${e(r[1])})`}}function g_(e,t){return function(n,i,r){if(n){const s=Ta(n,(r||this).context);return s&&s.path[e](i)}else return t(i)}}const hAe=g_("area",kbe),fAe=g_("bounds",_be),pAe=g_("centroid",Gbe);function gAe(e,t){const n=Ta(e,(t||this).context);return n&&n.scale()}function mAe(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function m_(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(i){e.warn(i)}return n[n.length-1]}function vAe(){return m_(this.context.dataflow,"warn",arguments)}function CAe(){return m_(this.context.dataflow,"info",arguments)}function yAe(){return m_(this.context.dataflow,"debug",arguments)}function lA(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function gk(e){const t=qu(e),n=lA(t.r),i=lA(t.g),r=lA(t.b);return .2126*n+.7152*i+.0722*r}function wAe(e,t){const n=gk(e),i=gk(t),r=Math.max(n,i),s=Math.min(n,i);return(r+.05)/(s+.05)}function bAe(){const e=[].slice.call(arguments);return e.unshift({}),Ze(...e)}function Uq(e,t){return e===t||e!==e&&t!==t?!0:te(e)?te(t)&&e.length===t.length?SAe(e,t):!1:ye(e)&&ye(t)?jq(e,t):!1}function SAe(e,t){for(let n=0,i=e.length;n<i;++n)if(!Uq(e[n],t[n]))return!1;return!0}function jq(e,t){for(const n in e)if(!Uq(e[n],t[n]))return!1;return!0}function SH(e){return t=>jq(e,t)}function xAe(e,t,n,i,r,s){const o=this.context.dataflow,a=this.context.data[e],l=a.input,u=o.stamp();let c=a.changes,d,h;if(o._trigger===!1||!(l.value.length||t||i))return 0;if((!c||c.stamp<u)&&(a.changes=c=o.changeset(),c.stamp=u,o.runAfter(()=>{a.modified=!0,o.pulse(l,c).run()},!0,1)),n&&(d=n===!0?Is:te(n)||C1(n)?n:SH(n),c.remove(d)),t&&c.insert(t),i&&(d=SH(i),l.value.some(d)?c.remove(d):c.insert(i)),r)for(h in s)c.modify(r,h,s[h]);return 1}function RAe(e){const t=e.touches,n=t[0].clientX-t[1].clientX,i=t[0].clientY-t[1].clientY;return Math.hypot(n,i)}function EAe(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const xH={};function FAe(e,t){const n=xH[t]||(xH[t]=Ms(t));return te(e)?e.map(n):n(e)}function dx(e){return te(e)||ArrayBuffer.isView(e)?e:null}function v_(e){return dx(e)||(be(e)?e:null)}function AAe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return dx(e).join(...n)}function DAe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return v_(e).indexOf(...n)}function PAe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return v_(e).lastIndexOf(...n)}function kAe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return v_(e).slice(...n)}function TAe(e,t,n){return nt(n)&&Z("Function argument passed to replace."),String(e).replace(t,n)}function MAe(e){return dx(e).slice().reverse()}function IAe(e){return dx(e).slice().sort(_p)}function _Ae(e,t,n){return kI(e||0,t||0,n||0)}function OAe(e,t){const n=Ta(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function LAe(e,t){const n=Ta(e,(t||this).context);return n?n.copy():void 0}function NAe(e,t){const n=Ta(e,(t||this).context);return n?n.domain():[]}function $Ae(e,t,n){const i=Ta(e,(n||this).context);return i?te(t)?(i.invertRange||i.invert)(t):(i.invert||i.invertExtent)(t):void 0}function BAe(e,t){const n=Ta(e,(t||this).context);return n&&n.range?n.range():[]}function GAe(e,t,n){const i=Ta(e,(n||this).context);return i?i(t):void 0}function zAe(e,t,n,i,r){let s=typeof e=="string"?Ta(e,(r||this).context):e;const o=L9(t,n);let a=s.domain(),l=a[0],u=gt(a),c=_i;return u-l?c=R9(s,l,u):s=(s.interpolator?Et("sequential")().interpolator(s.interpolator()):Et("linear")().interpolate(s.interpolate()).range(s.range())).domain([l=0,u=1]),s.ticks&&(a=s.ticks(+i||15),l!==a[0]&&a.unshift(l),u!==gt(a)&&a.push(u)),a.forEach(d=>o.stop(c(d),s(d))),o}function HAe(e,t,n){const i=Ta(e,(n||this).context);return function(r){return i?i.path.context(r)(t):""}}function VAe(e){let t=null;return function(n){return n?Dv(n,t=t||Xf(e)):e}}const qq=e=>e.data;function Kq(e,t){const n=Hq.call(t,e);return n.root&&n.root.lookup||{}}function WAe(e,t,n){const i=Kq(e,this),r=i[t],s=i[n];return r&&s?r.path(s).map(qq):void 0}function UAe(e,t){const n=Kq(e,this)[t];return n?n.ancestors().map(qq):void 0}const Yq=()=>typeof window<"u"&&window||null;function jAe(){const e=Yq();return e?e.screen:{}}function qAe(){const e=Yq();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function KAe(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function Xq(e,t,n){if(!e)return[];const[i,r]=e,s=new Mn().set(i[0],i[1],r[0],r[1]),o=n||this.context.dataflow.scenegraph().root;return I7(o,s,YAe(t))}function YAe(e){let t=null;if(e){const n=we(e.marktype),i=we(e.markname);t=r=>(!n.length||n.some(s=>r.marktype===s))&&(!i.length||i.some(s=>r.name===s))}return t}function XAe(e,t,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5;e=we(e);const r=e[e.length-1];return r===void 0||Math.hypot(r[0]-t,r[1]-n)>i?[...e,[t,n]]:e}function QAe(e){return we(e).reduce((t,n,i)=>{let[r,s]=n;return t+=i==0?`M ${r},${s} `:i===e.length-1?" Z":`L ${r},${s} `},"")}function JAe(e,t,n){const{x:i,y:r,mark:s}=n,o=new Mn().set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[l,u]of t)l<o.x1&&(o.x1=l),l>o.x2&&(o.x2=l),u<o.y1&&(o.y1=u),u>o.y2&&(o.y2=u);return o.translate(i,r),Xq([[o.x1,o.y1],[o.x2,o.y2]],e,s).filter(l=>ZAe(l.x,l.y,t))}function ZAe(e,t,n){let i=0;for(let r=0,s=n.length-1;r<n.length;s=r++){const[o,a]=n[s],[l,u]=n[r];u>t!=a>t&&e<(o-l)*(t-u)/(a-u)+l&&i++}return i&1}const Bv={random(){return Os()},cumulativeNormal:x1,cumulativeLogNormal:MM,cumulativeUniform:LM,densityNormal:AM,densityLogNormal:TM,densityUniform:OM,quantileNormal:R1,quantileLogNormal:IM,quantileUniform:NM,sampleNormal:S1,sampleLogNormal:kM,sampleUniform:_M,isArray:te,isBoolean:uc,isDate:Ou,isDefined(e){return e!==void 0},isNumber:xt,isObject:ye,isRegExp:n4,isString:be,isTuple:C1,isValid(e){return e!=null&&e===e},toBoolean:oM,toDate(e){return aM(e)},toNumber:Ai,toString:lM,indexof:DAe,join:AAe,lastindexof:PAe,replace:TAe,reverse:MAe,sort:IAe,slice:kAe,flush:e4,lerp:i4,merge:bAe,pad:o4,peek:gt,pluck:FAe,span:y0,inrange:lf,truncate:a4,rgb:qu,lab:fb,hcl:pb,hsl:db,luminance:gk,contrast:wAe,sequence:Sr,format:eAe,utcFormat:tAe,utcParse:iAe,utcOffset:G4,utcSequence:V4,timeFormat:Vq,timeParse:nAe,timeOffset:B4,timeSequence:H4,timeUnitSpecifier:D4,monthFormat:rAe,monthAbbrevFormat:sAe,dayFormat:oAe,dayAbbrevFormat:aAe,quarter:XW,utcquarter:QW,week:k4,utcweek:I4,dayofyear:P4,utcdayofyear:M4,warn:vAe,info:CAe,debug:yAe,extent(e){return ma(e)},inScope:mAe,intersect:Xq,clampRange:JW,pinchDistance:RAe,pinchAngle:EAe,screen:jAe,containerSize:KAe,windowSize:qAe,bandspace:_Ae,setdata:JFe,pathShape:VAe,panLinear:jW,panLog:qW,panPow:KW,panSymlog:YW,zoomLinear:eM,zoomLog:tM,zoomPow:Jw,zoomSymlog:nM,encode:ZFe,modify:xAe,lassoAppend:XAe,lassoPath:QAe,intersectLasso:JAe},eDe=["view","item","group","xy","x","y"],tDe="event.vega.",Qq="this.",C_={},Jq={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${he(Wq+e)}]`,functions:nDe,constants:Nq,visitors:C_},mk=Bq(Jq);function nDe(e){const t=$q(e);eDe.forEach(n=>t[n]=tDe+n);for(const n in Bv)t[n]=Qq+n;return Ze(t,dAe(e,Bv,C_)),t}function An(e,t,n){return arguments.length===1?Bv[e]:(Bv[e]=t,n&&(C_[e]=n),mk&&(mk.functions[e]=Qq+e),this)}An("bandwidth",OAe,nr);An("copy",LAe,nr);An("domain",NAe,nr);An("range",BAe,nr);An("invert",$Ae,nr);An("scale",GAe,nr);An("gradient",zAe,nr);An("geoArea",hAe,nr);An("geoBounds",fAe,nr);An("geoCentroid",pAe,nr);An("geoShape",HAe,nr);An("geoScale",gAe,nr);An("indata",QFe,cAe);An("data",Hq,p_);An("treePath",WAe,p_);An("treeAncestors",UAe,p_);An("vlSelectionTest",VFe,f_);An("vlSelectionIdTest",jFe,f_);An("vlSelectionResolve",KFe,f_);An("vlSelectionTuples",qFe);function ba(e,t){const n={};let i;try{e=be(e)?e:he(e)+"",i=d_(e)}catch{Z("Expression parse error: "+e)}i.visit(s=>{if(s.type!==kq)return;const o=s.callee.name,a=Jq.visitors[o];a&&a(o,s.arguments,t,n)});const r=mk(i);return r.globals.forEach(s=>{const o=Wq+s;!Ee(n,o)&&t.getSignal(s)&&(n[o]=t.signalRef(s))}),{$expr:Ze({code:r.code},t.options.ast?{ast:i}:null),$fields:r.fields,$params:n}}function iDe(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(i=>t.parseOperator(i)),n.forEach(i=>t.parseOperatorParameters(i)),(e.streams||[]).forEach(i=>t.parseStream(i)),(e.updates||[]).forEach(i=>t.parseUpdate(i)),t.resolve()}const rDe=Co(["rule"]),RH=Co(["group","image","rect"]);function sDe(e,t){let n="";return rDe[t]||(e.x2&&(e.x?(RH[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(RH[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function y_(e){return(e+"").toLowerCase()}function oDe(e){return y_(e)==="operator"}function aDe(e){return y_(e)==="collect"}function Zg(e,t,n){n.endsWith(";")||(n="return("+n+");");const i=Function(...t.concat(n));return e&&e.functions?i.bind(e.functions):i}function lDe(e,t,n,i){return`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${n}
  : (u > v || v == null) && u != null ? ${i}
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}
  : v !== v && u === u ? ${i} : `}var uDe={operator:(e,t)=>Zg(e,["_"],t.code),parameter:(e,t)=>Zg(e,["datum","_"],t.code),event:(e,t)=>Zg(e,["event"],t.code),handler:(e,t)=>{const n=`var datum=event.item&&event.item.datum;return ${t.code};`;return Zg(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:i}=t;let r="var o=item,datum=o.datum,m=0,$;";for(const s in i){const o="o["+he(s)+"]";r+=`$=${i[s].code};if(${o}!==$)${o}=$,m=1;`}return r+=sDe(i,n),r+="return m;",Zg(e,["item","_"],r)},codegen:{get(e){const t=`[${e.map(he).join("][")}]`,n=Function("_",`return _${t};`);return n.path=t,n},comparator(e,t){let n;const i=(s,o)=>{const a=t[o];let l,u;return s.path?(l=`a${s.path}`,u=`b${s.path}`):((n=n||{})["f"+o]=s,l=`this.f${o}(a)`,u=`this.f${o}(b)`),lDe(l,u,-a,a)},r=Function("a","b","var u, v; return "+e.map(i).join("")+"0;");return n?r.bind(n):r}}};function cDe(e){const t=this;oDe(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function dDe(e){const t=this;if(e.params){const n=t.get(e.id);n||Z("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function hDe(e,t){t=t||{};const n=this;for(const i in e){const r=e[i];t[i]=te(r)?r.map(s=>EH(s,n,t)):EH(r,n,t)}return t}function EH(e,t,n){if(!e||!ye(e))return e;for(let i=0,r=FH.length,s;i<r;++i)if(s=FH[i],Ee(e,s.key))return s.parse(e,t,n);return e}var FH=[{key:"$ref",parse:fDe},{key:"$key",parse:gDe},{key:"$expr",parse:pDe},{key:"$field",parse:mDe},{key:"$encode",parse:CDe},{key:"$compare",parse:vDe},{key:"$context",parse:yDe},{key:"$subflow",parse:wDe},{key:"$tupleid",parse:bDe}];function fDe(e,t){return t.get(e.$ref)||Z("Operator not defined: "+e.$ref)}function pDe(e,t,n){e.$params&&t.parseParameters(e.$params,n);const i="e:"+e.$expr.code;return t.fn[i]||(t.fn[i]=Ir(t.parameterExpression(e.$expr),e.$fields))}function gDe(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=sM(e.$key,e.$flat,t.expr.codegen))}function mDe(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=Ms(e.$field,e.$name,t.expr.codegen))}function vDe(e,t){const n="c:"+e.$compare+"_"+e.$order,i=we(e.$compare).map(r=>r&&r.$tupleid?_e:r);return t.fn[n]||(t.fn[n]=iM(i,e.$order,t.expr.codegen))}function CDe(e,t){const n=e.$encode,i={};for(const r in n){const s=n[r];i[r]=Ir(t.encodeExpression(s.$expr),s.$fields),i[r].output=s.$output}return i}function yDe(e,t){return t}function wDe(e,t){const n=e.$subflow;return function(i,r,s){const o=t.fork().parse(n),a=o.get(n.operators[0].id),l=o.signals.parent;return l&&l.set(s),a.detachSubflow=()=>t.detach(o),a}}function bDe(){return _e}function SDe(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,i=e.stream!=null?t.get(e.stream):void 0,r;e.source?i=t.events(e.source,e.type,n):e.merge&&(r=e.merge.map(s=>t.get(s)),i=r[0].merge.apply(r[0],r.slice(1))),e.between&&(r=e.between.map(s=>t.get(s)),i=i.between(r[0],r[1])),e.filter&&(i=i.filter(n)),e.throttle!=null&&(i=i.throttle(+e.throttle)),e.debounce!=null&&(i=i.debounce(+e.debounce)),i==null&&Z("Invalid stream definition: "+JSON.stringify(e)),e.consume&&i.consume(!0),t.stream(e,i)}function xDe(e){var t=this,n=ye(n=e.source)?n.$ref:n,i=t.get(n),r=null,s=e.update,o=void 0;i||Z("Source not defined: "+e.source),r=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),s&&s.$expr&&(s.$params&&(o=t.parseParameters(s.$params)),s=t.handlerExpression(s.$expr)),t.update(e,i,r,s,o)}const RDe={skip:!0};function EDe(e){var t=this,n={};if(e.signals){var i=n.signals={};Object.keys(t.signals).forEach(s=>{const o=t.signals[s];e.signals(s,o)&&(i[s]=o.value)})}if(e.data){var r=n.data={};Object.keys(t.data).forEach(s=>{const o=t.data[s];e.data(s,o)&&(r[s]=o.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(s=>s.getState(e))),n}function FDe(e){var t=this,n=t.dataflow,i=e.data,r=e.signals;Object.keys(r||{}).forEach(s=>{n.update(t.signals[s],r[s],RDe)}),Object.keys(i||{}).forEach(s=>{n.pulse(t.data[s].input,n.changeset().remove(Is).insert(i[s]))}),(e.subcontext||[]).forEach((s,o)=>{const a=t.subcontext[o];a&&a.setState(s)})}function Zq(e,t,n,i){return new eK(e,t,n,i)}function eK(e,t,n,i){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=i||uDe,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function AH(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}eK.prototype=AH.prototype={fork(){const e=new AH(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,i=n.dataflow,r=e.value;if(n.set(e.id,t),aDe(e.type)&&r&&(r.$ingest?i.ingest(t,r.$ingest,r.$format):r.$request?i.preload(t,r.$request,r.$format):i.pulse(t,i.changeset().insert(r))),e.root&&(n.root=t),e.parent){let s=n.get(e.parent.$ref);s?(i.connect(s,[t]),t.targets().add(s)):(n.unresolved=n.unresolved||[]).push(()=>{s=n.get(e.parent.$ref),i.connect(s,[t]),t.targets().add(s)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const s in e.data){const o=n.data[s]||(n.data[s]={});e.data[s].forEach(a=>o[a]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[y_(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,i,r){this.dataflow.on(t,n,i,r,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:iDe,parseOperator:cDe,parseOperatorParameters:dDe,parseParameters:hDe,parseStream:SDe,parseUpdate:xDe,getState:EDe,setState:FDe};function ADe(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),tK(t,e.description()))}function tK(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function DDe(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const uA="default";function PDe(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:uA,item:null}));e.on(e.events("view","pointermove"),t,(n,i)=>{const r=t.value,s=r?be(r)?r:r.user:uA,o=i.item&&i.item.cursor||null;return r&&s===r.user&&o==r.item?r:{user:s,item:o}}),e.add(null,function(n){let i=n.cursor,r=this.value;return be(i)||(r=i.item,i=i.user),vk(e,i&&i!==uA?i:r||i),r},{cursor:t})}function vk(e,t){const n=e.globalCursor()?typeof document<"u"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function aS(e,t){var n=e._runtime.data;return Ee(n,t)||Z("Unrecognized data set: "+t),n[t]}function kDe(e,t){return arguments.length<2?aS(this,e).values.value:hx.call(this,e,cc().remove(Is).insert(t))}function hx(e,t){m8(t)||Z("Second argument to changes must be a changeset.");const n=aS(this,e);return n.modified=!0,this.pulse(n.input,t)}function TDe(e,t){return hx.call(this,e,cc().insert(t))}function MDe(e,t){return hx.call(this,e,cc().remove(t))}function nK(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function iK(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function fx(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function IDe(e){var t=fx(e),n=nK(e),i=iK(e);e._renderer.background(e.background()),e._renderer.resize(n,i,t),e._handler.origin(t),e._resizeListeners.forEach(r=>{try{r(n,i)}catch(s){e.error(s)}})}function _De(e,t,n){var i=e._renderer,r=i&&i.canvas(),s,o,a;return r&&(a=fx(e),o=t.changedTouches?t.changedTouches[0]:t,s=J1(o,r),s[0]-=a[0],s[1]-=a[1]),t.dataflow=e,t.item=n,t.vega=ODe(e,n,s),t}function ODe(e,t,n){const i=t?t.mark.marktype==="group"?t:t.mark.group:null;function r(o){var a=i,l;if(o){for(l=t;l;l=l.mark.group)if(l.mark.name===o){a=l;break}}return a&&a.mark&&a.mark.interactive?a:{}}function s(o){if(!o)return n;be(o)&&(o=r(o));const a=n.slice();for(;o;)a[0]-=o.x||0,a[1]-=o.y||0,o=o.mark&&o.mark.group;return a}return{view:Oi(e),item:Oi(t||{}),group:r,xy:s,x:o=>s(o)[0],y:o=>s(o)[1]}}const DH="view",LDe="timer",NDe="window",$De={trap:!1};function BDe(e){const t=Ze({defaults:{}},e),n=(i,r)=>{r.forEach(s=>{te(i[s])&&(i[s]=Co(i[s]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function rK(e,t,n,i){e._eventListeners.push({type:n,sources:we(t),handler:i})}function GDe(e,t){var n=e._eventConfig.defaults,i=n.prevent,r=n.allow;return i===!1||r===!0?!1:i===!0||r===!1?!0:i?i[t]:r?!r[t]:e.preventDefault()}function zy(e,t,n){const i=e._eventConfig&&e._eventConfig[t];return i===!1||ye(i)&&!i[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function zDe(e,t,n){var i=this,r=new b1(n),s=function(u,c){i.runAsync(null,()=>{e===DH&&GDe(i,t)&&u.preventDefault(),r.receive(_De(i,u,c))})},o;if(e===LDe)zy(i,"timer",t)&&i.timer(s,t);else if(e===DH)zy(i,"view",t)&&i.addEventListener(t,s,$De);else if(e===NDe?zy(i,"window",t)&&typeof window<"u"&&(o=[window]):typeof document<"u"&&zy(i,"selector",t)&&(o=Array.from(document.querySelectorAll(e))),!o)i.warn("Can not resolve event source: "+e);else{for(var a=0,l=o.length;a<l;++a)o[a].addEventListener(t,s);rK(i,o,t,s)}return r}function PH(e){return e.item}function kH(e){return e.item.mark.source}function TH(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function HDe(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","pointerover",PH),kH,TH(e)),this.on(this.events("view","pointerout",PH),kH,TH(t)),this}function VDe(){var e=this._tooltip,t=this._timers,n=this._handler.handlers(),i=this._eventListeners,r,s,o,a,l;for(r=t.length;--r>=0;)t[r].stop();for(r=i.length;--r>=0;)for(o=i[r],s=o.sources.length;--s>=0;)o.sources[s].removeEventListener(o.type,o.handler);for(e&&e.call(this,this._handler,null,null,null),r=n.length;--r>=0;)l=n[r].type,a=n[r].handler,this._handler.off(l,a);return this}function Xr(e,t,n){const i=document.createElement(e);for(const r in t)i.setAttribute(r,t[r]);return n!=null&&(i.textContent=n),i}const WDe="vega-bind",UDe="vega-bind-name",jDe="vega-bind-radio";function qDe(e,t,n){if(!t)return;const i=n.param;let r=n.state;return r||(r=n.state={elements:null,active:!1,set:null,update:o=>{o!=e.signal(i.signal)&&e.runAsync(null,()=>{r.source=!0,e.signal(i.signal,o)})}},i.debounce&&(r.update=rM(i.debounce,r.update))),(i.input==null&&i.element?KDe:XDe)(r,t,i,e),r.active||(e.on(e._signals[i.signal],null,()=>{r.source?r.source=!1:r.set(e.signal(i.signal))}),r.active=!0),r}function KDe(e,t,n,i){const r=n.event||"input",s=()=>e.update(t.value);i.signal(n.signal,t.value),t.addEventListener(r,s),rK(i,t,r,s),e.set=o=>{t.value=o,t.dispatchEvent(YDe(r))}}function YDe(e){return typeof Event<"u"?new Event(e):{type:e}}function XDe(e,t,n,i){const r=i.signal(n.signal),s=Xr("div",{class:WDe}),o=n.input==="radio"?s:s.appendChild(Xr("label"));o.appendChild(Xr("span",{class:UDe},n.name||n.signal)),t.appendChild(s);let a=QDe;switch(n.input){case"checkbox":a=JDe;break;case"select":a=ZDe;break;case"radio":a=ePe;break;case"range":a=tPe;break}a(e,o,n,r)}function QDe(e,t,n,i){const r=Xr("input");for(const s in n)s!=="signal"&&s!=="element"&&r.setAttribute(s==="input"?"type":s,n[s]);r.setAttribute("name",n.signal),r.value=i,t.appendChild(r),r.addEventListener("input",()=>e.update(r.value)),e.elements=[r],e.set=s=>r.value=s}function JDe(e,t,n,i){const r={type:"checkbox",name:n.signal};i&&(r.checked=!0);const s=Xr("input",r);t.appendChild(s),s.addEventListener("change",()=>e.update(s.checked)),e.elements=[s],e.set=o=>s.checked=!!o||null}function ZDe(e,t,n,i){const r=Xr("select",{name:n.signal}),s=n.labels||[];n.options.forEach((o,a)=>{const l={value:o};lS(o,i)&&(l.selected=!0),r.appendChild(Xr("option",l,(s[a]||o)+""))}),t.appendChild(r),r.addEventListener("change",()=>{e.update(n.options[r.selectedIndex])}),e.elements=[r],e.set=o=>{for(let a=0,l=n.options.length;a<l;++a)if(lS(n.options[a],o)){r.selectedIndex=a;return}}}function ePe(e,t,n,i){const r=Xr("span",{class:jDe}),s=n.labels||[];t.appendChild(r),e.elements=n.options.map((o,a)=>{const l={type:"radio",name:n.signal,value:o};lS(o,i)&&(l.checked=!0);const u=Xr("input",l);u.addEventListener("change",()=>e.update(o));const c=Xr("label",{},(s[a]||o)+"");return c.prepend(u),r.appendChild(c),u}),e.set=o=>{const a=e.elements,l=a.length;for(let u=0;u<l;++u)lS(a[u].value,o)&&(a[u].checked=!0)}}function tPe(e,t,n,i){i=i!==void 0?i:(+n.max+ +n.min)/2;const r=n.max!=null?n.max:Math.max(100,+i)||100,s=n.min||Math.min(0,r,+i)||0,o=n.step||Wu(s,r,100),a=Xr("input",{type:"range",name:n.signal,min:s,max:r,step:o});a.value=i;const l=Xr("span",{},+i);t.appendChild(a),t.appendChild(l);const u=()=>{l.textContent=a.value,e.update(+a.value)};a.addEventListener("input",u),a.addEventListener("change",u),e.elements=[a],e.set=c=>{a.value=c,l.textContent=c}}function lS(e,t){return e===t||e+""==t+""}function sK(e,t,n,i,r,s){return t=t||new i(e.loader()),t.initialize(n,nK(e),iK(e),fx(e),r,s).background(e.background())}function w_(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function nPe(e,t,n,i){const r=new i(e.loader(),w_(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,fx(e),e);return t&&t.handlers().forEach(s=>{r.on(s.type,s.handler)}),r}function iPe(e,t){const n=this,i=n._renderType,r=n._eventConfig.bind,s=Z1(i);e=n._el=e?cA(n,e,!0):null,ADe(n),s||n.error("Unrecognized renderer type: "+i);const o=s.handler||B0,a=e?s.renderer:s.headless;return n._renderer=a?sK(n,n._renderer,e,a):null,n._handler=nPe(n,n._handler,e,o),n._redraw=!0,e&&r!=="none"&&(t=t?n._elBind=cA(n,t,!0):e.appendChild(Xr("form",{class:"vega-bindings"})),n._bind.forEach(l=>{l.param.element&&r!=="container"&&(l.element=cA(n,l.param.element,!!l.param.input))}),n._bind.forEach(l=>{qDe(n,l.element||t,l)})),n}function cA(e,t,n){if(typeof t=="string")if(typeof document<"u"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.textContent=""}catch(i){t=null,e.error(i)}return t}const em=e=>+e||0,rPe=e=>({top:e,bottom:e,left:e,right:e});function MH(e){return ye(e)?{top:em(e.top),bottom:em(e.bottom),left:em(e.left),right:em(e.right)}:rPe(em(e))}async function b_(e,t,n,i){const r=Z1(t),s=r&&r.headless;return s||Z("Unrecognized renderer type: "+t),await e.runAsync(),sK(e,null,null,s,n,i).renderAsync(e._scenegraph.root)}async function sPe(e,t){e!==Du.Canvas&&e!==Du.SVG&&e!==Du.PNG&&Z("Unrecognized image type: "+e);const n=await b_(this,e,t);return e===Du.SVG?oPe(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function oPe(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function aPe(e,t){return(await b_(this,Du.Canvas,e,t)).canvas()}async function lPe(e){return(await b_(this,Du.SVG,e)).svg()}function uPe(e,t,n){return Zq(e,Wf,Bv,n).parse(t)}function cPe(e){var t=this._runtime.scales;return Ee(t,e)||Z("Unrecognized scale or projection: "+e),t[e].value}var oK="width",aK="height",S_="padding",IH={skip:!0};function lK(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===S_?i.left+i.right:0)}function uK(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===S_?i.top+i.bottom:0)}function dPe(e){var t=e._signals,n=t[oK],i=t[aK],r=t[S_];function s(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,a=>{e._width=a.size,e._viewWidth=lK(e,a.size),s()},{size:n}),e._resizeHeight=e.add(null,a=>{e._height=a.size,e._viewHeight=uK(e,a.size),s()},{size:i});const o=e.add(null,s,{pad:r});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=i.rank+1,o.rank=r.rank+1}function hPe(e,t,n,i,r,s){this.runAfter(o=>{let a=0;o._autosize=0,o.width()!==n&&(a=1,o.signal(oK,n,IH),o._resizeWidth.skip(!0)),o.height()!==i&&(a=1,o.signal(aK,i,IH),o._resizeHeight.skip(!0)),o._viewWidth!==e&&(o._resize=1,o._viewWidth=e),o._viewHeight!==t&&(o._resize=1,o._viewHeight=t),(o._origin[0]!==r[0]||o._origin[1]!==r[1])&&(o._resize=1,o._origin=r),a&&o.run("enter"),s&&o.runAfter(l=>l.resize())},!1,1)}function fPe(e){return this._runtime.getState(e||{data:pPe,signals:gPe,recurse:!0})}function pPe(e,t){return t.modified&&te(t.input.value)&&!e.startsWith("_:vega:_")}function gPe(e,t){return!(e==="parent"||t instanceof Wf.proxy)}function mPe(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function vPe(e,t){function n(i){e({timestamp:Date.now(),elapsed:i})}this._timers.push(z1e(n,t))}function CPe(e,t,n,i){const r=e.element();r&&r.setAttribute("title",yPe(i))}function yPe(e){return e==null?"":te(e)?cK(e):ye(e)&&!Ou(e)?wPe(e):e+""}function wPe(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(te(n)?cK(n):dK(n))}).join(`
`)}function cK(e){return"["+e.map(dK).join(", ")+"]"}function dK(e){return te(e)?"[…]":ye(e)&&!Ou(e)?"{…}":e}function bPe(){if(this.renderer()==="canvas"&&this._renderer._canvas){let e=null;const t=()=>{e?.();const n=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);n.addEventListener("change",t),e=()=>{n.removeEventListener("change",t)},this._renderer._canvas.getContext("2d").pixelRatio=window.devicePixelRatio||1,this._redraw=!0,this._resize=1,this.resize().runAsync()};t()}}function hK(e,t){const n=this;if(t=t||{},wf.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const s=Ze({},e.locale,t.locale);n.locale(o8(s.number,s.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||Du.Canvas,n._scenegraph=new o7;const i=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||CPe,n._redraw=!0,n._handler=new B0().scene(i),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=BDe(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const r=uPe(n,e,t.expr);n._runtime=r,n._signals=r.signals,n._bind=(e.bindings||[]).map(s=>({state:null,param:Ze({},s)})),r.root&&r.root.set(i),i.source=r.data.root.input,n.pulse(r.data.root.input,n.changeset().insert(i.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=lK(n,n._width),n._viewHeight=uK(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,dPe(n),DDe(n),PDe(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind),t.watchPixelRatio&&n._watchPixelRatio()}function Hy(e,t){return Ee(e._signals,t)?e._signals[t]:Z("Unrecognized signal name: "+he(t))}function fK(e,t){const n=(e._targets||[]).filter(i=>i._update&&i._update.handler===t);return n.length?n[0]:null}function _H(e,t,n,i){let r=fK(n,i);return r||(r=w_(e,()=>i(t,n.value)),r.handler=i,e.on(n,null,r)),e}function OH(e,t,n){const i=fK(t,n);return i&&t._targets.remove(i),e}pe(hK,wf,{async evaluate(e,t,n){if(await wf.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,IDe(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(i){this.error(i)}return n&&vw(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&tK(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const i=Hy(this,e);return arguments.length===1?i.value:this.update(i,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",MH(e)):MH(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(Z1(e)||Z("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(wf.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(Hy(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:hPe,addEventListener(e,t,n){let i=t;return n&&n.trap===!1||(i=w_(this,t),i.raw=t),this._handler.on(e,i),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),i=n.length,r,s;--i>=0;)if(s=n[i].type,r=n[i].handler,e===s&&(t===r||t===r.raw)){this._handler.off(s,r);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.includes(e)||t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return _H(this,e,Hy(this,e),t)},removeSignalListener(e,t){return OH(this,Hy(this,e),t)},addDataListener(e,t){return _H(this,e,aS(this,e).values,t)},removeDataListener(e,t){return OH(this,aS(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=vk(this,null);this._globalCursor=!!e,t&&vk(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:vPe,events:zDe,finalize:VDe,hover:HDe,data:kDe,change:hx,insert:TDe,remove:MDe,scale:cPe,initialize:iPe,toImageURL:sPe,toCanvas:aPe,toSVG:lPe,getState:fPe,setState:mPe,_watchPixelRatio:bPe});const SPe="view",uS="[",cS="]",pK="{",gK="}",xPe=":",mK=",",RPe="@",EPe=">",FPe=/[[\]{}]/,APe={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let vK,CK;function mc(e,t,n){return vK=t||SPe,CK=n||APe,yK(e.trim()).map(Ck)}function DPe(e){return CK[e]}function nv(e,t,n,i,r){const s=e.length;let o=0,a;for(;t<s;++t){if(a=e[t],!o&&a===n)return t;r&&r.indexOf(a)>=0?--o:i&&i.indexOf(a)>=0&&++o}return t}function yK(e){const t=[],n=e.length;let i=0,r=0;for(;r<n;)r=nv(e,r,mK,uS+pK,cS+gK),t.push(e.substring(i,r).trim()),i=++r;if(t.length===0)throw"Empty event selector: "+e;return t}function Ck(e){return e[0]==="["?PPe(e):kPe(e)}function PPe(e){const t=e.length;let n=1,i;if(n=nv(e,n,cS,uS,cS),n===t)throw"Empty between selector: "+e;if(i=yK(e.substring(1,n)),i.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==EPe)throw"Expected '>' after between selector: "+e;i=i.map(Ck);const r=Ck(e.slice(1).trim());return r.between?{between:i,stream:r}:(r.between=i,r)}function kPe(e){const t={source:vK},n=[];let i=[0,0],r=0,s=0,o=e.length,a=0,l,u;if(e[o-1]===gK){if(a=e.lastIndexOf(pK),a>=0){try{i=TPe(e.substring(a+1,o-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,a).trim(),o=e.length}else throw"Unmatched right brace: "+e;a=0}if(!o)throw e;if(e[0]===RPe&&(r=++a),l=nv(e,a,xPe),l<o&&(n.push(e.substring(s,l).trim()),s=a=++l),a=nv(e,a,uS),a===o)n.push(e.substring(s,o).trim());else if(n.push(e.substring(s,a).trim()),u=[],s=++a,s===o)throw"Unmatched left bracket: "+e;for(;a<o;){if(a=nv(e,a,cS),a===o)throw"Unmatched left bracket: "+e;if(u.push(e.substring(s,a).trim()),a<o-1&&e[++a]!==uS)throw"Expected left bracket: "+e;s=++a}if(!(o=n.length)||FPe.test(n[o-1]))throw"Invalid event selector: "+e;return o>1?(t.type=n[1],r?t.markname=n[0].slice(1):DPe(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),u!=null&&(t.filter=u),i[0]&&(t.throttle=i[0]),i[1]&&(t.debounce=i[1]),t}function TPe(e){const t=e.split(mK);if(!e.length||t.length>2)throw e;return t.map(n=>{const i=+n;if(i!==i)throw e;return i})}function MPe(e){return ye(e)?e:{type:e||"pad"}}const tm=e=>+e||0,IPe=e=>({top:e,bottom:e,left:e,right:e});function _Pe(e){return ye(e)?e.signal?e:{top:tm(e.top),bottom:tm(e.bottom),left:tm(e.left),right:tm(e.right)}:IPe(tm(e))}const Qn=e=>ye(e)&&!te(e)?Ze({},e):{value:e};function LH(e,t,n,i){return n!=null?(ye(n)&&!te(n)||te(n)&&n.length&&ye(n[0])?e.update[t]=n:e[i||"enter"][t]={value:n},1):0}function mi(e,t,n){for(const i in t)LH(e,i,t[i]);for(const i in n)LH(e,i,n[i],"update")}function jp(e,t,n){for(const i in t)n&&Ee(n,i)||(e[i]=Ze(e[i]||{},t[i]));return e}function rf(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const x_="mark",R_="frame",E_="scope",OPe="axis",LPe="axis-domain",NPe="axis-grid",$Pe="axis-label",BPe="axis-tick",GPe="axis-title",zPe="legend",HPe="legend-band",VPe="legend-entry",WPe="legend-gradient",wK="legend-label",UPe="legend-symbol",jPe="legend-title",qPe="title",KPe="title-text",YPe="title-subtitle";function XPe(e,t,n,i,r){const s={},o={};let a,l,u,c;l="lineBreak",t==="text"&&r[l]!=null&&!rf(l,e)&&dA(s,l,r[l]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),c=n===R_?r.group:n===x_?Ze({},r.mark,r[t]):null;for(l in c)u=rf(l,e)||(l==="fill"||l==="stroke")&&(rf("fill",e)||rf("stroke",e)),u||dA(s,l,c[l]);we(i).forEach(d=>{const h=r.style&&r.style[d];for(const p in h)rf(p,e)||dA(s,p,h[p])}),e=Ze({},e);for(l in s)c=s[l],c.signal?(a=a||{})[l]=c:o[l]=c;return e.enter=Ze(o,e.enter),a&&(e.update=Ze(a,e.update)),e}function dA(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const bK=e=>be(e)?he(e):e.signal?`(${e.signal})`:SK(e);function px(e){if(e.gradient!=null)return JPe(e);let t=e.signal?`(${e.signal})`:e.color?QPe(e.color):e.field!=null?SK(e.field):e.value!==void 0?he(e.value):void 0;return e.scale!=null&&(t=ZPe(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t=`pow(${t},${Ow(e.exponent)})`),e.mult!=null&&(t+=`*${Ow(e.mult)}`),e.offset!=null&&(t+=`+${Ow(e.offset)}`),e.round&&(t=`round(${t})`),t}const Vy=(e,t,n,i)=>`(${e}(${[t,n,i].map(px).join(",")})+'')`;function QPe(e){return e.c?Vy("hcl",e.h,e.c,e.l):e.h||e.s?Vy("hsl",e.h,e.s,e.l):e.l||e.a?Vy("lab",e.l,e.a,e.b):e.r||e.g||e.b?Vy("rgb",e.r,e.g,e.b):null}function JPe(e){const t=[e.start,e.stop,e.count].map(n=>n==null?null:he(n));for(;t.length&&gt(t)==null;)t.pop();return t.unshift(bK(e.gradient)),`gradient(${t.join(",")})`}function Ow(e){return ye(e)?"("+px(e)+")":e}function SK(e){return xK(ye(e)?e:{datum:e})}function xK(e){let t,n,i;if(e.signal)t="datum",i=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(i=e.parent,t+=".datum"):i=e.group}else e.datum?(t="datum",i=e.datum):Z("Invalid field reference: "+he(e));return e.signal||(i=be(i)?Aa(i).map(he).join("]["):xK(i)),t+"["+i+"]"}function ZPe(e,t){const n=bK(e.scale);return e.range!=null?t=`lerp(_range(${n}), ${+e.range})`:(t!==void 0&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(+e.band==1?"":"*"+Ow(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),t==null&&(t="0")),t}function eke(e){let t="";return e.forEach(n=>{const i=px(n);t+=n.test?`(${n.test})?${i}:`:i}),gt(t)===":"&&(t+="null"),t}function RK(e,t,n,i,r,s){const o={};s=s||{},s.encoders={$encode:o},e=XPe(e,t,n,i,r.config);for(const a in e)o[a]=tke(e[a],t,s,r);return s}function tke(e,t,n,i){const r={},s={};for(const o in e)e[o]!=null&&(r[o]=ike(nke(e[o]),i,n,s));return{$expr:{marktype:t,channels:r},$fields:Object.keys(s),$output:Object.keys(e)}}function nke(e){return te(e)?eke(e):px(e)}function ike(e,t,n,i){const r=ba(e,t);return r.$fields.forEach(s=>i[s]=1),Ze(n,r.$params),r.$expr}const rke="outer",ske=["value","update","init","react","bind"];function NH(e,t){Z(e+' for "outer" push: '+he(t))}function EK(e,t){const n=e.name;if(e.push===rke)t.signals[n]||NH("No prior signal definition",n),ske.forEach(i=>{e[i]!==void 0&&NH("Invalid property ",i)});else{const i=t.addSignal(n,e.value);e.react===!1&&(i.react=!1),e.bind&&t.addBinding(n,e.bind)}}function yk(e,t,n,i){this.id=-1,this.type=e,this.value=t,this.params=n,i&&(this.parent=i)}function gx(e,t,n,i){return new yk(e,t,n,i)}function dS(e,t){return gx("operator",e,t)}function Ie(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function Gv(e,t){return t?{$field:e,$name:t}:{$field:e}}const wk=Gv("key");function $H(e,t){return{$compare:e,$order:t}}function oke(e,t){const n={$key:e};return t&&(n.$flat=!0),n}const ake="ascending",lke="descending";function uke(e){return ye(e)?(e.order===lke?"-":"+")+mx(e.op,e.field):""}function mx(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const F_="scope",bk="view";function zn(e){return e&&e.signal}function cke(e){return e&&e.expr}function Lw(e){if(zn(e))return!0;if(ye(e)){for(const t in e)if(Lw(e[t]))return!0}return!1}function no(e,t){return e??t}function md(e){return e&&e.signal||e}const BH="timer";function zv(e,t){return(e.merge?hke:e.stream?fke:e.type?pke:Z("Invalid stream specification: "+he(e)))(e,t)}function dke(e){return e===F_?bk:e||bk}function hke(e,t){const n=e.merge.map(r=>zv(r,t)),i=A_({merge:n},e,t);return t.addStream(i).id}function fke(e,t){const n=zv(e.stream,t),i=A_({stream:n},e,t);return t.addStream(i).id}function pke(e,t){let n;e.type===BH?(n=t.event(BH,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(dke(e.source),e.type);const i=A_({stream:n},e,t);return Object.keys(i).length===1?n:t.addStream(i).id}function A_(e,t,n){let i=t.between;return i&&(i.length!==2&&Z('Stream "between" parameter must have 2 entries: '+he(t)),e.between=[zv(i[0],n),zv(i[1],n)]),i=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&i.push(gke(t.marktype,t.markname,t.markrole)),t.source===F_&&i.push("inScope(event.item)"),i.length&&(e.filter=ba("("+i.join(")&&(")+")",n).$expr),(i=t.throttle)!=null&&(e.throttle=+i),(i=t.debounce)!=null&&(e.debounce=+i),t.consume&&(e.consume=!0),e}function gke(e,t,n){const i="event.item";return i+(e&&e!=="*"?"&&"+i+".mark.marktype==='"+e+"'":"")+(n?"&&"+i+".mark.role==='"+n+"'":"")+(t?"&&"+i+".mark.name==='"+t+"'":"")}const mke={code:"_.$value",ast:{type:"Identifier",value:"value"}};function vke(e,t,n){const i=e.encode,r={target:n};let s=e.events,o=e.update,a=[];s||Z("Signal update missing events specification."),be(s)&&(s=mc(s,t.isSubscope()?F_:bk)),s=we(s).filter(l=>l.signal||l.scale?(a.push(l),0):1),a.length>1&&(a=[yke(a)]),s.length&&a.push(s.length>1?{merge:s}:s[0]),i!=null&&(o&&Z("Signal encode and update are mutually exclusive."),o="encode(item(),"+he(i)+")"),r.update=be(o)?ba(o,t):o.expr!=null?ba(o.expr,t):o.value!=null?o.value:o.signal!=null?{$expr:mke,$params:{$value:t.signalRef(o.signal)}}:Z("Invalid signal update specification."),e.force&&(r.options={force:!0}),a.forEach(l=>t.addUpdate(Ze(Cke(l,t),r)))}function Cke(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):zv(e,t)}}function yke(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function wke(e,t){const n=t.getSignal(e.name);let i=e.update;e.init&&(i?Z("Signals can not include both init and update expressions."):(i=e.init,n.initonly=!0)),i&&(i=ba(i,t),n.update=i.$expr,n.params=i.$params),e.on&&e.on.forEach(r=>vke(r,t,n.id))}const Bt=e=>(t,n,i)=>gx(e,n,t||void 0,i),FK=Bt("aggregate"),bke=Bt("axisticks"),AK=Bt("bound"),To=Bt("collect"),GH=Bt("compare"),Ske=Bt("datajoin"),DK=Bt("encode"),xke=Bt("expression"),Rke=Bt("facet"),Eke=Bt("field"),Fke=Bt("key"),Ake=Bt("legendentries"),Dke=Bt("load"),Pke=Bt("mark"),kke=Bt("multiextent"),Tke=Bt("multivalues"),Mke=Bt("overlap"),Ike=Bt("params"),PK=Bt("prefacet"),_ke=Bt("projection"),Oke=Bt("proxy"),Lke=Bt("relay"),kK=Bt("render"),Nke=Bt("scale"),ah=Bt("sieve"),$ke=Bt("sortitems"),TK=Bt("viewlayout"),Bke=Bt("values");let Gke=0;const MK={min:"min",max:"max",count:"sum"};function zke(e,t){const n=e.type||"linear";C9(n)||Z("Unrecognized scale type: "+he(n)),t.addScale(e.name,{type:n,domain:void 0})}function Hke(e,t){const n=t.getScale(e.name).params;let i;n.domain=IK(e.domain,e,t),e.range!=null&&(n.range=OK(e,t,n)),e.interpolate!=null&&Jke(e.interpolate,n),e.nice!=null&&(n.nice=Qke(e.nice,t)),e.bins!=null&&(n.bins=Xke(e.bins,t));for(i in e)Ee(n,i)||i==="name"||(n[i]=Rs(e[i],t))}function Rs(e,t){return ye(e)?e.signal?t.signalRef(e.signal):Z("Unsupported object: "+he(e)):e}function Nw(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>Rs(n,t))}function vx(e){Z("Can not find data set: "+he(e))}function IK(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&Z("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(te(e)?Vke:e.fields?Uke:Wke)(e,t,n)}function Vke(e,t,n){return e.map(i=>Rs(i,n))}function Wke(e,t,n){const i=n.getData(e.data);return i||vx(e.data),Yf(t.type)?i.valuesRef(n,e.field,_K(e.sort,!1)):b9(t.type)?i.domainRef(n,e.field):i.extentRef(n,e.field)}function Uke(e,t,n){const i=e.data,r=e.fields.reduce((s,o)=>(o=be(o)?{data:i,field:o}:te(o)||o.signal?jke(o,n):o,s.push(o),s),[]);return(Yf(t.type)?qke:b9(t.type)?Kke:Yke)(e,n,r)}function jke(e,t){const n="_:vega:_"+Gke++,i=To({});if(te(e))i.value={$ingest:e};else if(e.signal){const r="setdata("+he(n)+","+e.signal+")";i.params.input=t.signalRef(r)}return t.addDataPipeline(n,[i,ah({})]),{data:n,field:"data"}}function qke(e,t,n){const i=_K(e.sort,!0);let r,s;const o=n.map(u=>{const c=t.getData(u.data);return c||vx(u.data),c.countsRef(t,u.field,i)}),a={groupby:wk,pulse:o};i&&(r=i.op||"count",s=i.field?mx(r,i.field):"count",a.ops=[MK[r]],a.fields=[t.fieldRef(s)],a.as=[s]),r=t.add(FK(a));const l=t.add(To({pulse:Ie(r)}));return s=t.add(Bke({field:wk,sort:t.sortRef(i),pulse:Ie(l)})),Ie(s)}function _K(e,t){return e&&(!e.field&&!e.op?ye(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?Z("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!MK[e.op]&&Z("Multiple domain scales can not be sorted using "+e.op)),e}function Kke(e,t,n){const i=n.map(r=>{const s=t.getData(r.data);return s||vx(r.data),s.domainRef(t,r.field)});return Ie(t.add(Tke({values:i})))}function Yke(e,t,n){const i=n.map(r=>{const s=t.getData(r.data);return s||vx(r.data),s.extentRef(t,r.field)});return Ie(t.add(kke({extents:i})))}function Xke(e,t){return e.signal||te(e)?Nw(e,t):t.objectProperty(e)}function Qke(e,t){return e.signal?t.signalRef(e.signal):ye(e)?{interval:Rs(e.interval),step:Rs(e.step)}:Rs(e)}function Jke(e,t){t.interpolate=Rs(e.type||e),e.gamma!=null&&(t.interpolateGamma=Rs(e.gamma))}function OK(e,t,n){const i=t.config.range;let r=e.range;if(r.signal)return t.signalRef(r.signal);if(be(r)){if(i&&Ee(i,r))return e=Ze({},e,{range:i[r]}),OK(e,t,n);r==="width"?r=[0,{signal:"width"}]:r==="height"?r=Yf(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:Z("Unrecognized scale range value: "+he(r))}else if(r.scheme){n.scheme=te(r.scheme)?Nw(r.scheme,t):Rs(r.scheme,t),r.extent&&(n.schemeExtent=Nw(r.extent,t)),r.count&&(n.schemeCount=Rs(r.count,t));return}else if(r.step){n.rangeStep=Rs(r.step,t);return}else{if(Yf(e.type)&&!te(r))return IK(r,e,t);te(r)||Z("Unsupported range type: "+he(r))}return r.map(s=>(te(s)?Nw:Rs)(s,t))}function Zke(e,t){const n=t.config.projection||{},i={};for(const r in e)r!=="name"&&(i[r]=Sk(e[r],r,t));for(const r in n)i[r]==null&&(i[r]=Sk(n[r],r,t));t.addProjection(e.name,i)}function Sk(e,t,n){return te(e)?e.map(i=>Sk(i,t,n)):ye(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:Z("Unsupported parameter object: "+he(e)):e}const Mo="top",qp="left",Kp="right",Ju="bottom",LK="center",eTe="vertical",tTe="start",nTe="middle",iTe="end",xk="index",D_="label",rTe="offset",rp="perc",sTe="perc2",Ds="value",K0="guide-label",P_="guide-title",oTe="group-title",aTe="group-subtitle",zH="symbol",$w="gradient",Rk="discrete",Ek="size",lTe="shape",uTe="fill",cTe="stroke",dTe="strokeWidth",hTe="strokeDash",fTe="opacity",k_=[Ek,lTe,uTe,cTe,dTe,hTe,fTe],Y0={name:1,style:1,interactive:1},vt={value:0},Ps={value:1},Cx="group",NK="rect",T_="rule",pTe="symbol",lh="text";function Hv(e){return e.type=Cx,e.interactive=e.interactive||!1,e}function _r(e,t){const n=(i,r)=>no(e[i],no(t[i],r));return n.isVertical=i=>eTe===no(e.direction,t.direction||(i?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>no(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>no(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>no(e.columns,no(t.columns,+n.isVertical(!0))),n}function $K(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function gTe(e,t,n){const i=t.config.style[n];return i&&i[e]}function yx(e,t,n){return`item.anchor === '${tTe}' ? ${e} : item.anchor === '${iTe}' ? ${t} : ${n}`}const M_=yx(he(qp),he(Kp),he(LK));function mTe(e){const t=e("tickBand");let n=e("tickOffset"),i,r;return t?t.signal?(i={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},r={signal:`(${t.signal}) === 'extent'`},ye(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : ${n}`})):t==="extent"?(i=1,r=!0,n=0):(i=.5,r=!1):(i=e("bandPosition"),r=e("tickExtra")),{extra:r,band:i,offset:n}}function BK(e,t){return t?e?ye(e)?Object.assign({},e,{offset:BK(e.offset,t)}):{value:e,offset:t}:t:e}function ns(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=jp(e.encode,t,Y0)):e.interactive=!1,e}function vTe(e,t,n,i){const r=_r(e,n),s=r.isVertical(),o=r.gradientThickness(),a=r.gradientLength();let l,u,c,d,h;s?(u=[0,1],c=[0,0],d=o,h=a):(u=[0,0],c=[1,0],d=a,h=o);const p={enter:l={opacity:vt,x:vt,y:vt,width:Qn(d),height:Qn(h)},update:Ze({},l,{opacity:Ps,fill:{gradient:t,start:u,stop:c}}),exit:{opacity:vt}};return mi(p,{stroke:r("gradientStrokeColor"),strokeWidth:r("gradientStrokeWidth")},{opacity:r("gradientOpacity")}),ns({type:NK,role:WPe,encode:p},i)}function CTe(e,t,n,i,r){const s=_r(e,n),o=s.isVertical(),a=s.gradientThickness(),l=s.gradientLength();let u,c,d,h,p="";o?(u="y",d="y2",c="x",h="width",p="1-"):(u="x",d="x2",c="y",h="height");const g={opacity:vt,fill:{scale:t,field:Ds}};g[u]={signal:p+"datum."+rp,mult:l},g[c]=vt,g[d]={signal:p+"datum."+sTe,mult:l},g[h]=Qn(a);const v={enter:g,update:Ze({},g,{opacity:Ps}),exit:{opacity:vt}};return mi(v,{stroke:s("gradientStrokeColor"),strokeWidth:s("gradientStrokeWidth")},{opacity:s("gradientOpacity")}),ns({type:NK,role:HPe,key:Ds,from:r,encode:v},i)}const yTe=`datum.${rp}<=0?"${qp}":datum.${rp}>=1?"${Kp}":"${LK}"`,wTe=`datum.${rp}<=0?"${Ju}":datum.${rp}>=1?"${Mo}":"${nTe}"`;function HH(e,t,n,i){const r=_r(e,t),s=r.isVertical(),o=Qn(r.gradientThickness()),a=r.gradientLength();let l=r("labelOverlap"),u,c,d,h,p="";const g={enter:u={opacity:vt},update:c={opacity:Ps,text:{field:D_}},exit:{opacity:vt}};return mi(g,{fill:r("labelColor"),fillOpacity:r("labelOpacity"),font:r("labelFont"),fontSize:r("labelFontSize"),fontStyle:r("labelFontStyle"),fontWeight:r("labelFontWeight"),limit:no(e.labelLimit,t.gradientLabelLimit)}),s?(u.align={value:"left"},u.baseline=c.baseline={signal:wTe},d="y",h="x",p="1-"):(u.align=c.align={signal:yTe},u.baseline={value:"top"},d="x",h="y"),u[d]=c[d]={signal:p+"datum."+rp,mult:a},u[h]=c[h]=o,o.offset=no(e.labelOffset,t.gradientLabelOffset)||0,l=l?{separation:r("labelSeparation"),method:l,order:"datum."+xk}:void 0,ns({type:lh,role:wK,style:K0,key:Ds,from:i,encode:g,overlap:l},n)}function bTe(e,t,n,i,r){const s=_r(e,t),o=n.entries,a=!!(o&&o.interactive),l=o?o.name:void 0,u=s("clipHeight"),c=s("symbolOffset"),d={data:"value"},h=`(${r}) ? datum.${rTe} : datum.${Ek}`,p=u?Qn(u):{field:Ek},g=`datum.${xk}`,v=`max(1, ${r})`;let C,y,b,S,x;p.mult=.5,C={enter:y={opacity:vt,x:{signal:h,mult:.5,offset:c},y:p},update:b={opacity:Ps,x:y.x,y:y.y},exit:{opacity:vt}};let E=null,A=null;e.fill||(E=t.symbolBaseFillColor,A=t.symbolBaseStrokeColor),mi(C,{fill:s("symbolFillColor",E),shape:s("symbolType"),size:s("symbolSize"),stroke:s("symbolStrokeColor",A),strokeDash:s("symbolDash"),strokeDashOffset:s("symbolDashOffset"),strokeWidth:s("symbolStrokeWidth")},{opacity:s("symbolOpacity")}),k_.forEach(_=>{e[_]&&(b[_]=y[_]={scale:e[_],field:Ds})});const F=ns({type:pTe,role:UPe,key:Ds,from:d,clip:u?!0:void 0,encode:C},n.symbols),k=Qn(c);k.offset=s("labelOffset"),C={enter:y={opacity:vt,x:{signal:h,offset:k},y:p},update:b={opacity:Ps,text:{field:D_},x:y.x,y:y.y},exit:{opacity:vt}},mi(C,{align:s("labelAlign"),baseline:s("labelBaseline"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontStyle:s("labelFontStyle"),fontWeight:s("labelFontWeight"),limit:s("labelLimit")});const P=ns({type:lh,role:wK,style:K0,key:Ds,from:d,encode:C},n.labels);return C={enter:{noBound:{value:!u},width:vt,height:u?Qn(u):vt,opacity:vt},exit:{opacity:vt},update:b={opacity:Ps,row:{signal:null},column:{signal:null}}},s.isVertical(!0)?(S=`ceil(item.mark.items.length / ${v})`,b.row.signal=`${g}%${S}`,b.column.signal=`floor(${g} / ${S})`,x={field:["row",g]}):(b.row.signal=`floor(${g} / ${v})`,b.column.signal=`${g} % ${v}`,x={field:g}),b.column.signal=`(${r})?${b.column.signal}:${g}`,i={facet:{data:i,name:"value",groupby:xk}},Hv({role:E_,from:i,encode:jp(C,o,Y0),marks:[F,P],name:l,interactive:a,sort:x})}function STe(e,t){const n=_r(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const I_='item.orient === "left"',__='item.orient === "right"',wx=`(${I_} || ${__})`,xTe=`datum.vgrad && ${wx}`,RTe=yx('"top"','"bottom"','"middle"'),ETe=yx('"right"','"left"','"center"'),FTe=`datum.vgrad && ${__} ? (${ETe}) : (${wx} && !(datum.vgrad && ${I_})) ? "left" : ${M_}`,ATe=`item._anchor || (${wx} ? "middle" : "start")`,DTe=`${xTe} ? (${I_} ? -90 : 90) : 0`,PTe=`${wx} ? (datum.vgrad ? (${__} ? "bottom" : "top") : ${RTe}) : "top"`;function kTe(e,t,n,i){const r=_r(e,t),s={enter:{opacity:vt},update:{opacity:Ps,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:vt}};return mi(s,{orient:r("titleOrient"),_anchor:r("titleAnchor"),anchor:{signal:ATe},angle:{signal:DTe},align:{signal:FTe},baseline:{signal:PTe},text:e.title,fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),baseline:r("titleBaseline")}),ns({type:lh,role:jPe,style:P_,from:i,encode:s},n)}function TTe(e,t){let n;return ye(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+VH(e.path)+")":e.sphere&&(n="geoShape("+VH(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function VH(e){return ye(e)&&e.signal?e.signal:he(e)}function GK(e){const t=e.role||"";return t.startsWith("axis")||t.startsWith("legend")||t.startsWith("title")?t:e.type===Cx?E_:t||x_}function MTe(e){return{marktype:e.type,name:e.name||void 0,role:e.role||GK(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function ITe(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function O_(e,t){const n=y8(e.type);n||Z("Unrecognized transform type: "+he(e.type));const i=gx(n.type.toLowerCase(),null,zK(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(i)),i.metadata=n.metadata||{},i}function zK(e,t,n){const i={},r=e.params.length;for(let s=0;s<r;++s){const o=e.params[s];i[o.name]=_Te(o,t,n)}return i}function _Te(e,t,n){const i=e.type,r=t[e.name];if(i==="index")return OTe(e,t,n);if(r===void 0){e.required&&Z("Missing required "+he(t.type)+" parameter: "+he(e.name));return}else{if(i==="param")return LTe(e,t,n);if(i==="projection")return n.projectionRef(t[e.name])}return e.array&&!zn(r)?r.map(s=>WH(e,s,n)):WH(e,r,n)}function WH(e,t,n){const i=e.type;if(zn(t))return jH(i)?Z("Expression references can not be signals."):hA(i)?n.fieldRef(t):qH(i)?n.compareRef(t):n.signalRef(t.signal);{const r=e.expr||hA(i);return r&&NTe(t)?n.exprRef(t.expr,t.as):r&&$Te(t)?Gv(t.field,t.as):jH(i)?ba(t,n):BTe(i)?Ie(n.getData(t).values):hA(i)?Gv(t):qH(i)?n.compareRef(t):t}}function OTe(e,t,n){return be(t.from)||Z('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function LTe(e,t,n){const i=t[e.name];return e.array?(te(i)||Z("Expected an array of sub-parameters. Instead: "+he(i)),i.map(r=>UH(e,r,n))):UH(e,i,n)}function UH(e,t,n){const i=e.params.length;let r;for(let o=0;o<i;++o){r=e.params[o];for(const a in r.key)if(r.key[a]!==t[a]){r=null;break}if(r)break}r||Z("Unsupported parameter: "+he(t));const s=Ze(zK(r,t,n),r.key);return Ie(n.add(Ike(s)))}const NTe=e=>e&&e.expr,$Te=e=>e&&e.field,BTe=e=>e==="data",jH=e=>e==="expr",hA=e=>e==="field",qH=e=>e==="compare";function GTe(e,t,n){let i,r,s,o,a;return e?(i=e.facet)&&(t||Z("Only group marks can be faceted."),i.field!=null?o=a=Bw(i,n):(e.data?a=Ie(n.getData(e.data).aggregate):(s=O_(Ze({type:"aggregate",groupby:we(i.groupby)},i.aggregate),n),s.params.key=n.keyRef(i.groupby),s.params.pulse=Bw(i,n),o=a=Ie(n.add(s))),r=n.keyRef(i.groupby,!0))):o=Ie(n.add(To(null,[{}]))),o||(o=Bw(e,n)),{key:r,pulse:o,parent:a}}function Bw(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:Ie(t.getData(e.data).output)}function Gd(e,t,n,i,r){this.scope=e,this.input=t,this.output=n,this.values=i,this.aggregate=r,this.index={}}Gd.fromEntries=function(e,t){const n=t.length,i=t[n-1],r=t[n-2];let s=t[0],o=null,a=1;for(s&&s.type==="load"&&(s=t[1]),e.add(t[0]);a<n;++a)t[a].params.pulse=Ie(t[a-1]),e.add(t[a]),t[a].type==="aggregate"&&(o=t[a]);return new Gd(e,s,r,i,o)};function HK(e){return be(e)?e:null}function KH(e,t,n){const i=mx(n.op,n.field);let r;if(t.ops){for(let s=0,o=t.as.length;s<o;++s)if(t.as[s]===i)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((r=n.op.signal)?e.signalRef(r):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(i))}function nm(e,t,n,i,r,s,o){const a=t[n]||(t[n]={}),l=uke(s);let u=HK(r),c,d;if(u!=null&&(e=t.scope,u=u+(l?"|"+l:""),c=a[u]),!c){const h=s?{field:wk,pulse:t.countsRef(e,r,s)}:{field:e.fieldRef(r),pulse:Ie(t.output)};l&&(h.sort=e.sortRef(s)),d=e.add(gx(i,void 0,h)),o&&(t.index[r]=d),c=Ie(d),u!=null&&(a[u]=c)}return c}Gd.prototype={countsRef(e,t,n){const i=this,r=i.counts||(i.counts={}),s=HK(t);let o,a,l;return s!=null&&(e=i.scope,o=r[s]),o?n&&n.field&&KH(e,o.agg.params,n):(l={groupby:e.fieldRef(t,"key"),pulse:Ie(i.output)},n&&n.field&&KH(e,l,n),a=e.add(FK(l)),o=e.add(To({pulse:Ie(a)})),o={agg:a,ref:Ie(o)},s!=null&&(r[s]=o)),o.ref},tuplesRef(){return Ie(this.values)},extentRef(e,t){return nm(e,this,"extent","extent",t,!1)},domainRef(e,t){return nm(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return nm(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return nm(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return nm(e,this,"indata","tupleindex",t,!0,!0)}};function zTe(e,t,n){const i=e.from.facet,r=i.name,s=Bw(i,t);let o;i.name||Z("Facet must have a name: "+he(i)),i.data||Z("Facet must reference a data set: "+he(i)),i.field?o=t.add(PK({field:t.fieldRef(i.field),pulse:s})):i.groupby?o=t.add(Rke({key:t.keyRef(i.groupby),group:Ie(t.proxy(n.parent)),pulse:s})):Z("Facet must specify groupby or field: "+he(i));const a=t.fork(),l=a.add(To()),u=a.add(ah({pulse:Ie(l)}));a.addData(r,new Gd(a,l,l,u)),a.addSignal("parent",null),o.params.subflow={$subflow:a.parse(e).toRuntime()}}function HTe(e,t,n){const i=t.add(PK({pulse:n.pulse})),r=t.fork();r.add(ah()),r.addSignal("parent",null),i.params.subflow={$subflow:r.parse(e).toRuntime()}}function VK(e,t,n){const i=e.remove,r=e.insert,s=e.toggle,o=e.modify,a=e.values,l=t.add(dS()),u="if("+e.trigger+',modify("'+n+'",'+[r,i,s,o,a].map(d=>d??"null").join(",")+"),0)",c=ba(u,t);l.update=c.$expr,l.params=c.$params}function bx(e,t){const n=GK(e),i=e.type===Cx,r=e.from&&e.from.facet,s=e.overlap;let o=e.layout||n===E_||n===R_,a,l,u,c,d,h,p;const g=n===x_||o||r,v=GTe(e.from,i,t);l=t.add(Ske({key:v.key||(e.key?Gv(e.key):void 0),pulse:v.pulse,clean:!i}));const C=Ie(l);l=u=t.add(To({pulse:C})),l=t.add(Pke({markdef:MTe(e),interactive:ITe(e.interactive,t),clip:TTe(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:Ie(l)}));const y=Ie(l);l=c=t.add(DK(RK(e.encode,e.type,n,e.style,t,{mod:!1,pulse:y}))),l.params.parent=t.encode(),e.transform&&e.transform.forEach(A=>{const F=O_(A,t),k=F.metadata;(k.generates||k.changes)&&Z("Mark transforms should not generate new data."),k.nomod||(c.params.mod=!0),F.params.pulse=Ie(l),t.add(l=F)}),e.sort&&(l=t.add($ke({sort:t.compareRef(e.sort),pulse:Ie(l)})));const b=Ie(l);(r||o)&&(o=t.add(TK({layout:t.objectProperty(e.layout),legends:t.legends,mark:y,pulse:b})),h=Ie(o));const S=t.add(AK({mark:y,pulse:h||b}));p=Ie(S),i&&(g&&(a=t.operators,a.pop(),o&&a.pop()),t.pushState(b,h||p,C),r?zTe(e,t,v):g?HTe(e,t,v):t.parse(e),t.popState(),g&&(o&&a.push(o),a.push(S))),s&&(p=VTe(s,p,t));const x=t.add(kK({pulse:p})),E=t.add(ah({pulse:Ie(x)},void 0,t.parent()));e.name!=null&&(d=e.name,t.addData(d,new Gd(t,u,x,E)),e.on&&e.on.forEach(A=>{(A.insert||A.remove||A.toggle)&&Z("Marks only support modify triggers."),VK(A,t,d)}))}function VTe(e,t,n){const i=e.method,r=e.bound,s=e.separation,o={separation:zn(s)?n.signalRef(s.signal):s,method:zn(i)?n.signalRef(i.signal):i,pulse:t};if(e.order&&(o.sort=n.compareRef({field:e.order})),r){const a=r.tolerance;o.boundTolerance=zn(a)?n.signalRef(a.signal):+a,o.boundScale=n.scaleRef(r.scale),o.boundOrient=r.orient}return Ie(n.add(Mke(o)))}function WTe(e,t){const n=t.config.legend,i=e.encode||{},r=_r(e,n),s=i.legend||{},o=s.name||void 0,a=s.interactive,l=s.style,u={};let c=0,d,h,p;k_.forEach(S=>e[S]?(u[S]=e[S],c=c||e[S]):0),c||Z("Missing valid scale for legend.");const g=UTe(e,t.scaleType(c)),v={title:e.title!=null,scales:u,type:g,vgrad:g!=="symbol"&&r.isVertical()},C=Ie(t.add(To(null,[v]))),y={enter:{x:{value:0},y:{value:0}}},b=Ie(t.add(Ake(h={type:g,scale:t.scaleRef(c),count:t.objectProperty(r("tickCount")),limit:t.property(r("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return g===$w?(p=[vTe(e,c,n,i.gradient),HH(e,n,i.labels,b)],h.count=h.count||t.signalRef(`max(2,2*floor((${md(r.gradientLength())})/100))`)):g===Rk?p=[CTe(e,c,n,i.gradient,b),HH(e,n,i.labels,b)]:(d=STe(e,n),p=[bTe(e,n,i,b,md(d.columns))],h.size=KTe(e,t,p[0].marks)),p=[Hv({role:VPe,from:C,encode:y,marks:p,layout:d,interactive:a})],v.title&&p.push(kTe(e,n,i.title,C)),bx(Hv({role:zPe,from:C,encode:jp(qTe(r,e,n),s,Y0),marks:p,aria:r("aria"),description:r("description"),zindex:r("zindex"),name:o,interactive:a,style:l}),t)}function UTe(e,t){let n=e.type||zH;return!e.type&&jTe(e)===1&&(e.fill||e.stroke)&&(n=OI(t)?$w:gP(t)?Rk:zH),n!==$w?n:gP(t)?Rk:$w}function jTe(e){return k_.reduce((t,n)=>t+(e[n]?1:0),0)}function qTe(e,t,n){const i={enter:{},update:{}};return mi(i,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),i}function KTe(e,t,n){const i=md(YH("size",e,n)),r=md(YH("strokeWidth",e,n)),s=md(YTe(n[1].encode,t,K0));return ba(`max(ceil(sqrt(${i})+${r}),${s})`,t)}function YH(e,t,n){return t[e]?`scale("${t[e]}",datum)`:$K(e,n[0].encode)}function YTe(e,t,n){return $K("fontSize",e)||gTe("fontSize",t,n)}const XTe=`item.orient==="${qp}"?-90:item.orient==="${Kp}"?90:0`;function QTe(e,t){e=be(e)?{text:e}:e;const n=_r(e,t.config.title),i=e.encode||{},r=i.group||{},s=r.name||void 0,o=r.interactive,a=r.style,l=[],u={},c=Ie(t.add(To(null,[u])));return l.push(eMe(e,n,JTe(e),c)),e.subtitle&&l.push(tMe(e,n,i.subtitle,c)),bx(Hv({role:qPe,from:c,encode:ZTe(n,r),marks:l,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:s,interactive:o,style:a}),t)}function JTe(e){const t=e.encode;return t&&t.title||Ze({name:e.name,interactive:e.interactive,style:e.style},t)}function ZTe(e,t){const n={enter:{},update:{}};return mi(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:M_},angle:{signal:XTe},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),jp(n,t,Y0)}function eMe(e,t,n,i){const r={value:0},s=e.text,o={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return mi(o,{text:s,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),ns({type:lh,role:KPe,style:oTe,from:i,encode:o},n)}function tMe(e,t,n,i){const r={value:0},s=e.subtitle,o={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return mi(o,{text:s,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),ns({type:lh,role:YPe,style:aTe,from:i,encode:o},n)}function nMe(e,t){const n=[];e.transform&&e.transform.forEach(i=>{n.push(O_(i,t))}),e.on&&e.on.forEach(i=>{VK(i,t,e.name)}),t.addDataPipeline(e.name,iMe(e,t,n))}function iMe(e,t,n){const i=[];let r=null,s=!1,o=!1,a,l,u,c,d;for(e.values?zn(e.values)||Lw(e.format)?(i.push(XH(t,e)),i.push(r=Vc())):i.push(r=Vc({$ingest:e.values,$format:e.format})):e.url?Lw(e.url)||Lw(e.format)?(i.push(XH(t,e)),i.push(r=Vc())):i.push(r=Vc({$request:e.url,$format:e.format})):e.source&&(r=a=we(e.source).map(h=>Ie(t.getData(h).output)),i.push(null)),l=0,u=n.length;l<u;++l)c=n[l],d=c.metadata,!r&&!d.source&&i.push(r=Vc()),i.push(c),d.generates&&(o=!0),d.modifies&&!o&&(s=!0),d.source?r=c:d.changes&&(r=null);return a&&(u=a.length-1,i[0]=Lke({derive:s,pulse:u?a:a[0]}),(s||u)&&i.splice(1,0,Vc())),r||i.push(Vc()),i.push(ah({})),i}function Vc(e){const t=To({},e);return t.metadata={source:!0},t}function XH(e,t){return Dke({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const WK=e=>e===Ju||e===Mo,Sx=(e,t,n)=>zn(e)?aMe(e.signal,t,n):e===qp||e===Mo?t:n,Jn=(e,t,n)=>zn(e)?sMe(e.signal,t,n):WK(e)?t:n,go=(e,t,n)=>zn(e)?oMe(e.signal,t,n):WK(e)?n:t,UK=(e,t,n)=>zn(e)?lMe(e.signal,t,n):e===Mo?{value:t}:{value:n},rMe=(e,t,n)=>zn(e)?uMe(e.signal,t,n):e===Kp?{value:t}:{value:n},sMe=(e,t,n)=>jK(`${e} === '${Mo}' || ${e} === '${Ju}'`,t,n),oMe=(e,t,n)=>jK(`${e} !== '${Mo}' && ${e} !== '${Ju}'`,t,n),aMe=(e,t,n)=>L_(`${e} === '${qp}' || ${e} === '${Mo}'`,t,n),lMe=(e,t,n)=>L_(`${e} === '${Mo}'`,t,n),uMe=(e,t,n)=>L_(`${e} === '${Kp}'`,t,n),jK=(e,t,n)=>(t=t!=null?Qn(t):t,n=n!=null?Qn(n):n,QH(t)&&QH(n)?(t=t?t.signal||he(t.value):null,n=n?n.signal||he(n.value):null,{signal:`${e} ? (${t}) : (${n})`}):[Ze({test:e},t)].concat(n||[])),QH=e=>e==null||Object.keys(e).length===1,L_=(e,t,n)=>({signal:`${e} ? (${pf(t)}) : (${pf(n)})`}),cMe=(e,t,n,i,r)=>({signal:(i!=null?`${e} === '${qp}' ? (${pf(i)}) : `:"")+(n!=null?`${e} === '${Ju}' ? (${pf(n)}) : `:"")+(r!=null?`${e} === '${Kp}' ? (${pf(r)}) : `:"")+(t!=null?`${e} === '${Mo}' ? (${pf(t)}) : `:"")+"(null)"}),pf=e=>zn(e)?e.signal:e==null?null:he(e),dMe=(e,t)=>t===0?0:zn(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t},Rf=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function Yh(e,t,n,i){let r;if(t&&Ee(t,e))return t[e];if(Ee(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":r="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":r=e[5].toLowerCase()+e.slice(6)}return i[P_][r]}else if(e.startsWith("label")){switch(e){case"labelColor":r="fill";break;case"labelFont":case"labelFontSize":r=e[5].toLowerCase()+e.slice(6)}return i[K0][r]}return null}function JH(e){const t={};for(const n of e)if(n)for(const i in n)t[i]=1;return Object.keys(t)}function hMe(e,t){var n=t.config,i=n.style,r=n.axis,s=t.scaleType(e.scale)==="band"&&n.axisBand,o=e.orient,a,l,u;if(zn(o)){const d=JH([n.axisX,n.axisY]),h=JH([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);a={};for(u of d)a[u]=Jn(o,Yh(u,n.axisX,r,i),Yh(u,n.axisY,r,i));l={};for(u of h)l[u]=cMe(o.signal,Yh(u,n.axisTop,r,i),Yh(u,n.axisBottom,r,i),Yh(u,n.axisLeft,r,i),Yh(u,n.axisRight,r,i))}else a=o===Mo||o===Ju?n.axisX:n.axisY,l=n["axis"+o[0].toUpperCase()+o.slice(1)];return a||l||s?Ze({},r,a,l,s):r}function fMe(e,t,n,i){const r=_r(e,t),s=e.orient;let o,a;const l={enter:o={opacity:vt},update:a={opacity:Ps},exit:{opacity:vt}};mi(l,{stroke:r("domainColor"),strokeCap:r("domainCap"),strokeDash:r("domainDash"),strokeDashOffset:r("domainDashOffset"),strokeWidth:r("domainWidth"),strokeOpacity:r("domainOpacity")});const u=ZH(e,0),c=ZH(e,1);return o.x=a.x=Jn(s,u,vt),o.x2=a.x2=Jn(s,c),o.y=a.y=go(s,u,vt),o.y2=a.y2=go(s,c),ns({type:T_,role:LPe,from:i,encode:l},n)}function ZH(e,t){return{scale:e.scale,range:t}}function pMe(e,t,n,i,r){const s=_r(e,t),o=e.orient,a=e.gridScale,l=Sx(o,1,-1),u=gMe(e.offset,l);let c,d,h;const p={enter:c={opacity:vt},update:h={opacity:Ps},exit:d={opacity:vt}};mi(p,{stroke:s("gridColor"),strokeCap:s("gridCap"),strokeDash:s("gridDash"),strokeDashOffset:s("gridDashOffset"),strokeOpacity:s("gridOpacity"),strokeWidth:s("gridWidth")});const g={scale:e.scale,field:Ds,band:r.band,extra:r.extra,offset:r.offset,round:s("tickRound")},v=Jn(o,{signal:"height"},{signal:"width"}),C=a?{scale:a,range:0,mult:l,offset:u}:{value:0,offset:u},y=a?{scale:a,range:1,mult:l,offset:u}:Ze(v,{mult:l,offset:u});return c.x=h.x=Jn(o,g,C),c.y=h.y=go(o,g,C),c.x2=h.x2=go(o,y),c.y2=h.y2=Jn(o,y),d.x=Jn(o,g),d.y=go(o,g),ns({type:T_,role:NPe,key:Ds,from:i,encode:p},n)}function gMe(e,t){if(t!==1)if(!ye(e))e=zn(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);else{let n=e=Ze({},e);for(;n.mult!=null;)if(ye(n.mult))n=n.mult=Ze({},n.mult);else return n.mult=zn(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n.mult=t}return e}function mMe(e,t,n,i,r,s){const o=_r(e,t),a=e.orient,l=Sx(a,-1,1);let u,c,d;const h={enter:u={opacity:vt},update:d={opacity:Ps},exit:c={opacity:vt}};mi(h,{stroke:o("tickColor"),strokeCap:o("tickCap"),strokeDash:o("tickDash"),strokeDashOffset:o("tickDashOffset"),strokeOpacity:o("tickOpacity"),strokeWidth:o("tickWidth")});const p=Qn(r);p.mult=l;const g={scale:e.scale,field:Ds,band:s.band,extra:s.extra,offset:s.offset,round:o("tickRound")};return d.y=u.y=Jn(a,vt,g),d.y2=u.y2=Jn(a,p),c.x=Jn(a,g),d.x=u.x=go(a,vt,g),d.x2=u.x2=go(a,p),c.y=go(a,g),ns({type:T_,role:BPe,key:Ds,from:i,encode:h},n)}function fA(e,t,n,i,r){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+i+","+r+")"}}function vMe(e,t,n,i,r,s){const o=_r(e,t),a=e.orient,l=e.scale,u=Sx(a,-1,1),c=md(o("labelFlush")),d=md(o("labelFlushOffset")),h=o("labelAlign"),p=o("labelBaseline");let g=c===0||!!c,v;const C=Qn(r);C.mult=u,C.offset=Qn(o("labelPadding")||0),C.offset.mult=u;const y={scale:l,field:Ds,band:.5,offset:BK(s.offset,o("labelOffset"))},b=Jn(a,g?fA(l,c,'"left"','"right"','"center"'):{value:"center"},rMe(a,"left","right")),S=Jn(a,UK(a,"bottom","top"),g?fA(l,c,'"top"','"bottom"','"middle"'):{value:"middle"}),x=fA(l,c,`-(${d})`,d,0);g=g&&d;const E={opacity:vt,x:Jn(a,y,C),y:go(a,y,C)},A={enter:E,update:v={opacity:Ps,text:{field:D_},x:E.x,y:E.y,align:b,baseline:S},exit:{opacity:vt,x:E.x,y:E.y}};mi(A,{dx:!h&&g?Jn(a,x):null,dy:!p&&g?go(a,x):null}),mi(A,{angle:o("labelAngle"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontWeight:o("labelFontWeight"),fontStyle:o("labelFontStyle"),limit:o("labelLimit"),lineHeight:o("labelLineHeight")},{align:h,baseline:p});const F=o("labelBound");let k=o("labelOverlap");return k=k||F?{separation:o("labelSeparation"),method:k,order:"datum.index",bound:F?{scale:l,orient:a,tolerance:F}:null}:void 0,v.align!==b&&(v.align=Rf(v.align,b)),v.baseline!==S&&(v.baseline=Rf(v.baseline,S)),ns({type:lh,role:$Pe,style:K0,key:Ds,from:i,encode:A,overlap:k},n)}function CMe(e,t,n,i){const r=_r(e,t),s=e.orient,o=Sx(s,-1,1);let a,l;const u={enter:a={opacity:vt,anchor:Qn(r("titleAnchor",null)),align:{signal:M_}},update:l=Ze({},a,{opacity:Ps,text:Qn(e.title)}),exit:{opacity:vt}},c={signal:`lerp(range("${e.scale}"), ${yx(0,1,.5)})`};return l.x=Jn(s,c),l.y=go(s,c),a.angle=Jn(s,vt,dMe(o,90)),a.baseline=Jn(s,UK(s,Ju,Mo),{value:Ju}),l.angle=a.angle,l.baseline=a.baseline,mi(u,{fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),angle:r("titleAngle"),baseline:r("titleBaseline")}),yMe(r,s,u,n),u.update.align=Rf(u.update.align,a.align),u.update.angle=Rf(u.update.angle,a.angle),u.update.baseline=Rf(u.update.baseline,a.baseline),ns({type:lh,role:GPe,style:P_,from:i,encode:u},n)}function yMe(e,t,n,i){const r=(a,l)=>a!=null?(n.update[l]=Rf(Qn(a),n.update[l]),!1):!rf(l,i),s=r(e("titleX"),"x"),o=r(e("titleY"),"y");n.enter.auto=o===s?Qn(o):Jn(t,Qn(o),Qn(s))}function wMe(e,t){const n=hMe(e,t),i=e.encode||{},r=i.axis||{},s=r.name||void 0,o=r.interactive,a=r.style,l=_r(e,n),u=mTe(l),c={scale:e.scale,ticks:!!l("ticks"),labels:!!l("labels"),grid:!!l("grid"),domain:!!l("domain"),title:e.title!=null},d=Ie(t.add(To({},[c]))),h=Ie(t.add(bke({scale:t.scaleRef(e.scale),extra:t.property(u.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),p=[];let g;return c.grid&&p.push(pMe(e,n,i.grid,h,u)),c.ticks&&(g=l("tickSize"),p.push(mMe(e,n,i.ticks,h,g,u))),c.labels&&(g=c.ticks?g:0,p.push(vMe(e,n,i.labels,h,g,u))),c.domain&&p.push(fMe(e,n,i.domain,d)),c.title&&p.push(CMe(e,n,i.title,d)),bx(Hv({role:OPe,from:d,encode:jp(bMe(l,e),r,Y0),marks:p,aria:l("aria"),description:l("description"),zindex:l("zindex"),name:s,interactive:o,style:a}),t)}function bMe(e,t){const n={enter:{},update:{}};return mi(n,{orient:e("orient"),offset:e("offset")||0,position:no(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function qK(e,t,n){const i=we(e.signals),r=we(e.scales);return n||i.forEach(s=>EK(s,t)),we(e.projections).forEach(s=>Zke(s,t)),r.forEach(s=>zke(s,t)),we(e.data).forEach(s=>nMe(s,t)),r.forEach(s=>Hke(s,t)),(n||i).forEach(s=>wke(s,t)),we(e.axes).forEach(s=>wMe(s,t)),we(e.marks).forEach(s=>bx(s,t)),we(e.legends).forEach(s=>WTe(s,t)),e.title&&QTe(e.title,t),t.parseLambdas(),t}const SMe=e=>jp({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function xMe(e,t){const n=t.config,i=Ie(t.root=t.add(dS())),r=RMe(e,n);r.forEach(u=>EK(u,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const s=t.add(To()),o=t.add(DK(RK(SMe(e.encode),Cx,R_,e.style,t,{pulse:Ie(s)}))),a=t.add(TK({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:i,pulse:Ie(o)}));t.operators.pop(),t.pushState(Ie(o),Ie(a),null),qK(e,t,r),t.operators.push(a);let l=t.add(AK({mark:i,pulse:Ie(a)}));return l=t.add(kK({pulse:Ie(l)})),l=t.add(ah({pulse:Ie(l)})),t.addData("root",new Gd(t,s,s,l)),t}function im(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function RMe(e,t){const n=o=>no(e[o],t[o]),i=[im("background",n("background")),im("autosize",MPe(n("autosize"))),im("padding",_Pe(n("padding"))),im("width",n("width")||0),im("height",n("height")||0)],r=i.reduce((o,a)=>(o[a.name]=a,o),{}),s={};return we(e.signals).forEach(o=>{Ee(r,o.name)?o=Ze(r[o.name],o):i.push(o),s[o.name]=o}),we(t.signals).forEach(o=>{!Ee(s,o.name)&&!Ee(r,o.name)&&i.push(o)}),i}function KK(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function eV(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}KK.prototype=eV.prototype={parse(e){return qK(e,this)},fork(){return new eV(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof yk?Ie(e):e;return this.add(Oke({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(i,r,s){let o,a;i&&(o=i.data||(i.data={}),a=o[r]||(o[r]=[]),a.push(s))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const i in t.index)n(t.index[i],e,"index:"+i)}return this},pushState(e,t,n){this._encode.push(Ie(this.add(ah({pulse:e})))),this._parent.push(t),this._lookup.push(n?Ie(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return gt(this._parent)},encode(){return gt(this._encode)},lookup(){return gt(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(be(e))return Gv(e,t);e.signal||Z("Unsupported field reference: "+he(e));const n=e.signal;let i=this.field[n];if(!i){const r={name:this.signalRef(n)};t&&(r.as=t),this.field[n]=i=Ie(this.add(Eke(r)))}return i},compareRef(e){let t=!1;const n=s=>zn(s)?(t=!0,this.signalRef(s.signal)):cke(s)?(t=!0,this.exprRef(s.expr)):s,i=we(e.field).map(n),r=we(e.order).map(n);return t?Ie(this.add(GH({fields:i,orders:r}))):$H(i,r)},keyRef(e,t){let n=!1;const i=s=>zn(s)?(n=!0,Ie(r[s.signal])):s,r=this.signals;return e=we(e).map(i),n?Ie(this.add(Fke({fields:e,flat:t}))):oke(e,t)},sortRef(e){if(!e)return e;const t=mx(e.op,e.field),n=e.order||ake;return n.signal?Ie(this.add(GH({fields:t,orders:this.signalRef(n.signal)}))):$H(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const i=this.id();this.streams.push({id:i,source:e,type:t}),this.events[n]=i}return this.events[n]},hasOwnSignal(e){return Ee(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&Z("Duplicate signal name: "+he(e));const n=t instanceof yk?t:this.add(dS(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||Z("Unrecognized signal name: "+he(e)),this.signals[e]},signalRef(e){return this.signals[e]?Ie(this.signals[e]):(Ee(this.lambdas,e)||(this.lambdas[e]=this.add(dS(null))),Ie(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const i=e[t],r=ba(i,this),s=this.lambdas[i];s.params=r.$params,s.update=r.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!ye(e)?e:this.signalRef(e.signal||N_(e))},exprRef(e,t){const n={expr:ba(e,this)};return t&&(n.expr.$name=t),Ie(this.add(xke(n)))},addBinding(e,t){this.bindings||Z("Nested signals do not support binding: "+he(e)),this.bindings.push(Ze({signal:e},t))},addScaleProj(e,t){Ee(this.scales,e)&&Z("Duplicate scale or projection name: "+he(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,Nke(t))},addProjection(e,t){this.addScaleProj(e,_ke(t))},getScale(e){return this.scales[e]||Z("Unrecognized scale name: "+he(e)),this.scales[e]},scaleRef(e){return Ie(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return Ee(this.data,e)&&Z("Duplicate data set name: "+he(e)),this.data[e]=t},getData(e){return this.data[e]||Z("Undefined data set name: "+he(e)),this.data[e]},addDataPipeline(e,t){return Ee(this.data,e)&&Z("Duplicate data set name: "+he(e)),this.addData(e,Gd.fromEntries(this,t))}};function N_(e){return(te(e)?EMe:FMe)(e)}function EMe(e){const t=e.length;let n="[";for(let i=0;i<t;++i){const r=e[i];n+=(i>0?",":"")+(ye(r)?r.signal||N_(r):he(r))}return n+"]"}function FMe(e){let t="{",n=0,i,r;for(i in e)r=e[i],t+=(++n>1?",":"")+he(i)+":"+(ye(r)?r.signal||N_(r):he(r));return t+"}"}function AMe(){const e="sans-serif",i="#4c78a8",r="#000",s="#888",o="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:i},area:{fill:i},image:null,line:{stroke:i,strokeWidth:2},path:{stroke:i},rect:{fill:i},rule:{stroke:r},shape:{stroke:i},symbol:{fill:i,size:64},text:{fill:r,font:e,fontSize:11},trail:{fill:i,size:2},style:{"guide-label":{fill:r,font:e,fontSize:10},"guide-title":{fill:r,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:r,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:r,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:o},view:{fill:"transparent"}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:s,grid:!1,gridWidth:1,gridColor:o,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:s,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:o,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:s,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function DMe(e,t,n){return ye(e)||Z("Input Vega specification must be an object."),t=Mp(AMe(),t,e.config),xMe(e,new KK(t,n)).toRuntime()}var PMe="5.31.0";Ze(Wf,mme,Kwe,Fbe,d1e,sxe,MRe,dRe,_Re,rEe,pEe,bEe);const kMe=Object.freeze(Object.defineProperty({__proto__:null,Bounds:Mn,CanvasHandler:B0,CanvasRenderer:Fb,DATE:Dr,DAY:Fi,DAYOFYEAR:ya,Dataflow:wf,Debug:zW,Error:QT,EventStream:b1,Gradient:L9,GroupItem:U1,HOURS:Zr,Handler:o2,HybridHandler:A7,HybridRenderer:FP,Info:GW,Item:W1,MILLISECONDS:yo,MINUTES:es,MONTH:ki,Marks:ts,MultiPulse:SM,None:BW,Operator:zt,Parameters:w1,Pulse:Nu,QUARTER:Ar,RenderType:Du,Renderer:$0,ResourceLoader:V9,SECONDS:_s,SVGHandler:p7,SVGRenderer:h2,SVGStringRenderer:F7,Scenegraph:o7,TIME_UNITS:hM,Transform:Y,View:hK,WEEK:Bn,Warn:JT,YEAR:fi,accessor:Ir,accessorFields:Pi,accessorName:yn,array:we,ascending:_p,bandwidthNRD:FM,bin:S8,bootstrapCI:x8,boundClip:N7,boundContext:_0,boundItem:bP,boundMark:n7,boundStroke:Vl,changeset:cc,clampRange:JW,codegenExpression:Bq,compare:iM,constant:Oi,cumulativeLogNormal:MM,cumulativeNormal:x1,cumulativeUniform:LM,dayofyear:P4,debounce:rM,defaultLocale:vM,definition:y8,densityLogNormal:TM,densityNormal:AM,densityUniform:OM,domChild:Nn,domClear:Cs,domCreate:Fu,domFind:s2,dotbin:R8,error:Z,expressionFunction:An,extend:Ze,extent:ma,extentIndex:ZW,falsy:fu,fastmap:Op,field:Ms,flush:e4,font:X1,fontFamily:N0,fontSize:Da,format:mw,formatLocale:rb,formats:wM,hasOwnProperty:Ee,id:C0,identity:_i,inferType:l8,inferTypes:u8,ingest:Dt,inherits:pe,inrange:lf,interpolate:LI,interpolateColors:H1,interpolateRange:S9,intersect:I7,intersectBoxLine:cf,intersectPath:WI,intersectPoint:UI,intersectRule:U9,isArray:te,isBoolean:uc,isDate:Ou,isFunction:nt,isIterable:t4,isNumber:xt,isObject:ye,isRegExp:n4,isString:be,isTuple:C1,key:sM,lerp:i4,lineHeight:Yu,loader:m1,locale:o8,logger:ZT,lruCache:r4,markup:d2,merge:s4,mergeConfig:Mp,multiLineOffset:n2,one:Tp,pad:o4,panLinear:jW,panLog:qW,panPow:KW,panSymlog:YW,parse:DMe,parseExpression:d_,parseSelector:mc,path:D1,pathCurves:zI,pathEqual:$7,pathParse:Xf,pathRectangle:B9,pathRender:Dv,pathSymbols:$9,pathTrail:G9,peek:gt,point:J1,projection:T2,quantileLogNormal:IM,quantileNormal:R1,quantileUniform:NM,quantiles:RM,quantizeInterpolator:x9,quarter:XW,quartiles:EM,get random(){return Os},randomInteger:wge,randomKDE:PM,randomLCG:yge,randomLogNormal:F8,randomMixture:A8,randomNormal:DM,randomUniform:D8,read:h8,regressionConstant:$M,regressionExp:k8,regressionLinear:BM,regressionLoess:I8,regressionLog:P8,regressionPoly:M8,regressionPow:T8,regressionQuad:GM,renderModule:Z1,repeat:ym,resetDefaultLocale:mpe,resetSVGClipId:H9,resetSVGDefIds:hwe,responseType:d8,runtimeContext:Zq,sampleCurve:F1,sampleLogNormal:kM,sampleNormal:S1,sampleUniform:_M,scale:Et,sceneEqual:f2,sceneFromJSON:r7,scenePickVisit:Cb,sceneToJSON:i7,sceneVisit:wo,sceneZOrder:jI,scheme:NI,serializeXML:S7,setHybridRendererOptions:lwe,setRandom:vge,span:y0,splitAccessPath:Aa,stringValue:he,textMetrics:Yr,timeBin:j4,timeFloor:L4,timeFormatLocale:Sv,timeInterval:Bp,timeOffset:B4,timeSequence:H4,timeUnitSpecifier:D4,timeUnits:fM,toBoolean:oM,toDate:aM,toNumber:Ai,toSet:Co,toString:lM,transform:w8,transforms:Wf,truncate:a4,truthy:Is,tupleid:_e,typeParsers:nP,utcFloor:N4,utcInterval:Gp,utcOffset:G4,utcSequence:V4,utcdayofyear:M4,utcquarter:QW,utcweek:I4,version:PMe,visitArray:vu,week:k4,writeConfig:Ip,zero:xu,zoomLinear:eM,zoomLog:tM,zoomPow:Jw,zoomSymlog:nM},Symbol.toStringTag,{value:"Module"}));function TMe(e,t,n){let i;t.x2&&(t.x?(n&&e.x>e.x2&&(i=e.x,e.x=e.x2,e.x2=i),e.width=e.x2-e.x):e.x=e.x2-(e.width||0)),t.xc&&(e.x=e.xc-(e.width||0)/2),t.y2&&(t.y?(n&&e.y>e.y2&&(i=e.y,e.y=e.y2,e.y2=i),e.height=e.y2-e.y):e.y=e.y2-(e.height||0)),t.yc&&(e.y=e.yc-(e.height||0)/2)}var MMe={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},IMe={"*":(e,t)=>e*t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,">":(e,t)=>e>t,"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,">=":(e,t)=>e>=t,"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,"===":(e,t)=>e===t,"!==":(e,t)=>e!==t,"&":(e,t)=>e&t,"|":(e,t)=>e|t,"^":(e,t)=>e^t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t},_Me={"+":e=>+e,"-":e=>-e,"~":e=>~e,"!":e=>!e};const OMe=Array.prototype.slice,Wc=(e,t,n)=>{const i=n?n(t[0]):t[0];return i[e].apply(i,OMe.call(t,1))},LMe=(e,t,n,i,r,s,o)=>new Date(e,t||0,n??1,i||0,r||0,s||0,o||0);var NMe={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(e,t,n)=>Math.max(t,Math.min(n,e)),now:Date.now,utc:Date.UTC,datetime:LMe,date:e=>new Date(e).getDate(),day:e=>new Date(e).getDay(),year:e=>new Date(e).getFullYear(),month:e=>new Date(e).getMonth(),hours:e=>new Date(e).getHours(),minutes:e=>new Date(e).getMinutes(),seconds:e=>new Date(e).getSeconds(),milliseconds:e=>new Date(e).getMilliseconds(),time:e=>new Date(e).getTime(),timezoneoffset:e=>new Date(e).getTimezoneOffset(),utcdate:e=>new Date(e).getUTCDate(),utcday:e=>new Date(e).getUTCDay(),utcyear:e=>new Date(e).getUTCFullYear(),utcmonth:e=>new Date(e).getUTCMonth(),utchours:e=>new Date(e).getUTCHours(),utcminutes:e=>new Date(e).getUTCMinutes(),utcseconds:e=>new Date(e).getUTCSeconds(),utcmilliseconds:e=>new Date(e).getUTCMilliseconds(),length:e=>e.length,join:function(){return Wc("join",arguments)},indexof:function(){return Wc("indexOf",arguments)},lastindexof:function(){return Wc("lastIndexOf",arguments)},slice:function(){return Wc("slice",arguments)},reverse:e=>e.slice().reverse(),sort:e=>e.slice().sort(_p),parseFloat,parseInt,upper:e=>String(e).toUpperCase(),lower:e=>String(e).toLowerCase(),substring:function(){return Wc("substring",arguments,String)},split:function(){return Wc("split",arguments,String)},replace:function(){return Wc("replace",arguments,String)},trim:e=>String(e).trim(),regexp:RegExp,test:(e,t)=>RegExp(e).test(t)};const $Me=["view","item","group","xy","x","y"],Fk=new Set([Function,eval,setTimeout,setInterval]);typeof setImmediate=="function"&&Fk.add(setImmediate);const BMe={Literal:(e,t)=>t.value,Identifier:(e,t)=>{const n=t.name;return e.memberDepth>0?n:n==="datum"?e.datum:n==="event"?e.event:n==="item"?e.item:MMe[n]||e.params["$"+n]},MemberExpression:(e,t)=>{const n=!t.computed,i=e(t.object);n&&(e.memberDepth+=1);const r=e(t.property);if(n&&(e.memberDepth-=1),Fk.has(i[r])){console.error(`Prevented interpretation of member "${r}" which could lead to insecure code execution`);return}return i[r]},CallExpression:(e,t)=>{const n=t.arguments;let i=t.callee.name;return i.startsWith("_")&&(i=i.slice(1)),i==="if"?e(n[0])?e(n[1]):e(n[2]):(e.fn[i]||NMe[i]).apply(e.fn,n.map(e))},ArrayExpression:(e,t)=>t.elements.map(e),BinaryExpression:(e,t)=>IMe[t.operator](e(t.left),e(t.right)),UnaryExpression:(e,t)=>_Me[t.operator](e(t.argument)),ConditionalExpression:(e,t)=>e(t.test)?e(t.consequent):e(t.alternate),LogicalExpression:(e,t)=>t.operator==="&&"?e(t.left)&&e(t.right):e(t.left)||e(t.right),ObjectExpression:(e,t)=>t.properties.reduce((n,i)=>{e.memberDepth+=1;const r=e(i.key);return e.memberDepth-=1,Fk.has(e(i.value))?console.error(`Prevented interpretation of property "${r}" which could lead to insecure code execution`):n[r]=e(i.value),n},{})};function rm(e,t,n,i,r,s){const o=a=>BMe[a.type](o,a);return o.memberDepth=0,o.fn=Object.create(t),o.params=n,o.datum=i,o.event=r,o.item=s,$Me.forEach(a=>o.fn[a]=function(){return r.vega[a](...arguments)}),o(e)}var GMe={operator(e,t){const n=t.ast,i=e.functions;return r=>rm(n,i,r)},parameter(e,t){const n=t.ast,i=e.functions;return(r,s)=>rm(n,i,s,r)},event(e,t){const n=t.ast,i=e.functions;return r=>rm(n,i,void 0,void 0,r)},handler(e,t){const n=t.ast,i=e.functions;return(r,s)=>{const o=s.item&&s.item.datum;return rm(n,i,r,o,s)}},encode(e,t){const{marktype:n,channels:i}=t,r=e.functions,s=n==="group"||n==="image"||n==="rect";return(o,a)=>{const l=o.datum;let u=0,c;for(const d in i)c=rm(i[d].ast,r,a,l,void 0,o),o[d]!==c&&(o[d]=c,u=1);return n!=="rule"&&TMe(o,i,s),u}}};const zMe="5.23.0",HMe={version:zMe};function $_(e){return ae(e,"or")}function B_(e){return ae(e,"and")}function G_(e){return ae(e,"not")}function Gw(e,t){if(G_(e))Gw(e.not,t);else if(B_(e))for(const n of e.and)Gw(n,t);else if($_(e))for(const n of e.or)Gw(n,t);else t(e)}function Ef(e,t){return G_(e)?{not:Ef(e.not,t)}:B_(e)?{and:e.and.map(n=>Ef(n,t))}:$_(e)?{or:e.or.map(n=>Ef(n,t))}:t(e)}const Ue=structuredClone;function YK(e){throw new Error(e)}function sp(e,t){const n={};for(const i of t)Ee(e,i)&&(n[i]=e[i]);return n}function Er(e,t){const n={...e};for(const i of t)delete n[i];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>$t(e)).join(",")})`};function ct(e){if(xt(e))return e;const t=be(e)?e:$t(e);if(t.length<250)return t;let n=0;for(let i=0;i<t.length;i++){const r=t.charCodeAt(i);n=(n<<5)-n+r,n=n&n}return n}function Ak(e){return e===!1||e===null}function at(e,t){return e.includes(t)}function op(e,t){let n=0;for(const[i,r]of e.entries())if(t(r,i,n++))return!0;return!1}function z_(e,t){let n=0;for(const[i,r]of e.entries())if(!t(r,i,n++))return!1;return!0}function XK(e,...t){for(const n of t)VMe(e,n??{});return e}function VMe(e,t){for(const n of oe(t))Ip(e,n,t[n],!0)}function oa(e,t){const n=[],i={};let r;for(const s of e)r=t(s),!(r in i)&&(i[r]=1,n.push(s));return n}function WMe(e,t){const n=oe(e),i=oe(t);if(n.length!==i.length)return!1;for(const r of n)if(e[r]!==t[r])return!1;return!0}function QK(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function H_(e,t){for(const n of e)if(t.has(n))return!0;return!1}function Dk(e){const t=new Set;for(const n of e){const r=Aa(n).map((o,a)=>a===0?o:`[${o}]`),s=r.map((o,a)=>r.slice(0,a+1).join(""));for(const o of s)t.add(o)}return t}function V_(e,t){return e===void 0||t===void 0?!0:H_(Dk(e),Dk(t))}function Nt(e){return oe(e).length===0}const oe=Object.keys,pi=Object.values,Zu=Object.entries;function Vv(e){return e===!0||e===!1}function en(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function iv(e,t){return G_(e)?`!(${iv(e.not,t)})`:B_(e)?`(${e.and.map(n=>iv(n,t)).join(") && (")})`:$_(e)?`(${e.or.map(n=>iv(n,t)).join(") || (")})`:t(e)}function hS(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&hS(e[n],t)&&delete e[n],Nt(e)}function X0(e){return e.charAt(0).toUpperCase()+e.substr(1)}function W_(e,t="datum"){const n=Aa(e),i=[];for(let r=1;r<=n.length;r++){const s=`[${n.slice(0,r).map(he).join("][")}]`;i.push(`${t}${s}`)}return i.join(" && ")}function JK(e,t="datum"){return`${t}[${he(Aa(e).join("."))}]`}function It(e){return`datum['${e.replaceAll("'","\\'")}']`}function UMe(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function Ns(e){return`${Aa(e).map(UMe).join("\\.")}`}function zd(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function Yp(e){return`${Aa(e).join(".")}`}function ap(e){return e?Aa(e).length:0}function En(...e){return e.find(t=>t!==void 0)}let ZK=42;function eY(e){const t=++ZK;return e?String(e)+t:t}function jMe(){ZK=42}function tY(e){return nY(e)?e:`__${e}`}function nY(e){return e.startsWith("__")}function Wv(e){if(e!==void 0)return(e%360+360)%360}function xx(e){return xt(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}const tV=Object.getPrototypeOf(structuredClone({}));function qr(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor.name!==t.constructor.name)return!1;let n,i;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(i=n;i--!==0;)if(!qr(e[i],t[i]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const s of e.entries())if(!t.has(s[0]))return!1;for(const s of e.entries())if(!qr(s[1],t.get(s[0])))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const s of e.entries())if(!t.has(s[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(n=e.length,n!=t.length)return!1;for(i=n;i--!==0;)if(e[i]!==t[i])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&e.valueOf!==tV.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&e.toString!==tV.toString)return e.toString()===t.toString();const r=Object.keys(e);if(n=r.length,n!==Object.keys(t).length)return!1;for(i=n;i--!==0;)if(!Object.prototype.hasOwnProperty.call(t,r[i]))return!1;for(i=n;i--!==0;){const s=r[i];if(!qr(e[s],t[s]))return!1}return!0}return e!==e&&t!==t}function $t(e){const t=[];return function n(i){if(i&&i.toJSON&&typeof i.toJSON=="function"&&(i=i.toJSON()),i===void 0)return;if(typeof i=="number")return isFinite(i)?""+i:"null";if(typeof i!="object")return JSON.stringify(i);let r,s;if(Array.isArray(i)){for(s="[",r=0;r<i.length;r++)r&&(s+=","),s+=n(i[r])||"null";return s+"]"}if(i===null)return"null";if(t.includes(i))throw new TypeError("Converting circular structure to JSON");const o=t.push(i)-1,a=Object.keys(i).sort();for(s="",r=0;r<a.length;r++){const l=a[r],u=n(i[l]);u&&(s&&(s+=","),s+=JSON.stringify(l)+":"+u)}return t.splice(o,1),`{${s}}`}(e)}function ae(e,t){return ye(e)&&Ee(e,t)&&e[t]!==void 0}const yl="row",wl="column",Rx="facet",tn="x",ni="y",Io="x2",Ma="y2",vc="xOffset",Xp="yOffset",_o="radius",Ul="radius2",zs="theta",jl="theta2",Oo="latitude",Lo="longitude",No="latitude2",$s="longitude2",Cc="time",kr="color",Ia="fill",_a="stroke",Tr="shape",ql="size",uh="angle",Kl="opacity",yc="fillOpacity",wc="strokeOpacity",bc="strokeWidth",Sc="strokeDash",Q0="text",lp="order",J0="detail",Ex="key",Hd="tooltip",Fx="href",Ax="url",Dx="description",qMe={x:1,y:1,x2:1,y2:1},iY={theta:1,theta2:1,radius:1,radius2:1};function rY(e){return Ee(iY,e)}const U_={longitude:1,longitude2:1,latitude:1,latitude2:1};function sY(e){switch(e){case Oo:return"y";case No:return"y2";case Lo:return"x";case $s:return"x2"}}function oY(e){return Ee(U_,e)}const KMe=oe(U_),j_={...qMe,...iY,...U_,xOffset:1,yOffset:1,color:1,fill:1,stroke:1,time:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1};function Ff(e){return e===kr||e===Ia||e===_a}const aY={row:1,column:1,facet:1},Es=oe(aY),q_={...j_,...aY},YMe=oe(q_),{order:bst,detail:Sst,tooltip:xst,...XMe}=q_,{row:Rst,column:Est,facet:Fst,...QMe}=XMe;function JMe(e){return Ee(QMe,e)}function lY(e){return Ee(q_,e)}const ZMe=[Io,Ma,No,$s,jl,Ul];function uY(e){return ch(e)!==e}function ch(e){switch(e){case Io:return tn;case Ma:return ni;case No:return Oo;case $s:return Lo;case jl:return zs;case Ul:return _o}return e}function ec(e){if(rY(e))switch(e){case zs:return"startAngle";case jl:return"endAngle";case _o:return"outerRadius";case Ul:return"innerRadius"}return e}function Oa(e){switch(e){case tn:return Io;case ni:return Ma;case Oo:return No;case Lo:return $s;case zs:return jl;case _o:return Ul}}function Mr(e){switch(e){case tn:case Io:return"width";case ni:case Ma:return"height"}}function cY(e){switch(e){case tn:return"xOffset";case ni:return"yOffset";case Io:return"x2Offset";case Ma:return"y2Offset";case zs:return"thetaOffset";case _o:return"radiusOffset";case jl:return"theta2Offset";case Ul:return"radius2Offset"}}function K_(e){switch(e){case tn:return"xOffset";case ni:return"yOffset"}}function eIe(e){switch(e){case"xOffset":return"x";case"yOffset":return"y"}}const tIe=oe(j_),{x:Ast,y:Dst,x2:Pst,y2:kst,xOffset:Tst,yOffset:Mst,latitude:Ist,longitude:_st,latitude2:Ost,longitude2:Lst,theta:Nst,theta2:$st,radius:Bst,radius2:Gst,...Y_}=j_,nIe=oe(Y_),X_={x:1,y:1},Yl=oe(X_);function Fn(e){return Ee(X_,e)}const Q_={theta:1,radius:1},iIe=oe(Q_);function Px(e){return e==="width"?tn:ni}const dY={xOffset:1,yOffset:1};function Z0(e){return Ee(dY,e)}const rIe={time:1};function pA(e){return e in rIe}const{text:zst,tooltip:Hst,href:Vst,url:Wst,description:Ust,detail:jst,key:qst,order:Kst,...hY}=Y_,sIe=oe(hY);function oIe(e){return Ee(Y_,e)}function aIe(e){switch(e){case kr:case Ia:case _a:case ql:case Tr:case Kl:case bc:case Sc:return!0;case yc:case wc:case uh:case Cc:return!1}}const fY={...X_,...Q_,...dY,...hY},J_=oe(fY);function La(e){return Ee(fY,e)}function lIe(e,t){return cIe(e)[t]}const pY={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:Yst,...uIe}=pY;function cIe(e){switch(e){case kr:case Ia:case _a:case Dx:case J0:case Ex:case Hd:case Fx:case lp:case Kl:case yc:case wc:case bc:case Rx:case yl:case wl:return pY;case tn:case ni:case vc:case Xp:case Oo:case Lo:case Cc:return uIe;case Io:case Ma:case No:case $s:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case ql:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case Sc:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case Tr:return{point:"always",geoshape:"always"};case Q0:return{text:"always"};case uh:return{point:"always",square:"always",text:"always"};case Ax:return{image:"always"};case zs:return{text:"always",arc:"always"};case _o:return{text:"always",arc:"always"};case jl:case Ul:return{arc:"always"}}}function gA(e){switch(e){case tn:case ni:case zs:case _o:case vc:case Xp:case ql:case uh:case bc:case Kl:case yc:case wc:case Cc:case Io:case Ma:case jl:case Ul:return;case Rx:case yl:case wl:case Tr:case Sc:case Q0:case Hd:case Fx:case Ax:case Dx:return"discrete";case kr:case Ia:case _a:return"flexible";case Oo:case Lo:case No:case $s:case J0:case Ex:case lp:return}}const dIe={argmax:1,argmin:1,average:1,count:1,distinct:1,exponential:1,exponentialb:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},hIe={count:1,min:1,max:1};function Tl(e){return ae(e,"argmin")}function xc(e){return ae(e,"argmax")}function Z_(e){return be(e)&&Ee(dIe,e)}const fIe=new Set(["count","valid","missing","distinct"]);function kx(e){return be(e)&&fIe.has(e)}function pIe(e){return be(e)&&at(["min","max"],e)}const gIe=new Set(["count","sum","distinct","valid","missing"]),mIe=new Set(["mean","average","median","q1","q3","min","max"]);function gY(e){return uc(e)&&(e=Hx(e,void 0)),"bin"+oe(e).map(t=>Tx(e[t])?en(`_${t}_${Zu(e[t])}`):en(`_${t}_${e[t]}`)).join("")}function Ut(e){return e===!0||dh(e)&&!e.binned}function oi(e){return e==="binned"||dh(e)&&e.binned===!0}function dh(e){return ye(e)}function Tx(e){return ae(e,"param")}function nV(e){switch(e){case yl:case wl:case ql:case kr:case Ia:case _a:case bc:case Kl:case yc:case wc:case Tr:return 6;case Sc:return 4;default:return 10}}function eC(e){return ae(e,"expr")}function ai(e,{level:t}={level:0}){const n=oe(e||{}),i={};for(const r of n)i[r]=t===0?Wr(e[r]):ai(e[r],{level:t-1});return i}function mY(e){const{anchor:t,frame:n,offset:i,orient:r,angle:s,limit:o,color:a,subtitleColor:l,subtitleFont:u,subtitleFontSize:c,subtitleFontStyle:d,subtitleFontWeight:h,subtitleLineHeight:p,subtitlePadding:g,...v}=e,C={...v,...a?{fill:a}:{}},y={...t?{anchor:t}:{},...n?{frame:n}:{},...i?{offset:i}:{},...r?{orient:r}:{},...s!==void 0?{angle:s}:{},...o!==void 0?{limit:o}:{}},b={...l?{subtitleColor:l}:{},...u?{subtitleFont:u}:{},...c?{subtitleFontSize:c}:{},...d?{subtitleFontStyle:d}:{},...h?{subtitleFontWeight:h}:{},...p?{subtitleLineHeight:p}:{},...g?{subtitlePadding:g}:{}},S=sp(e,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:C,subtitleMarkConfig:S,nonMarkTitleProperties:y,subtitle:b}}function bu(e){return be(e)||te(e)&&be(e[0])}function ke(e){return ae(e,"signal")}function hh(e){return ae(e,"step")}function vIe(e){return te(e)?!1:ae(e,"fields")&&!ae(e,"data")}function CIe(e){return te(e)?!1:ae(e,"fields")&&ae(e,"data")}function pl(e){return te(e)?!1:ae(e,"field")&&ae(e,"data")}const yIe={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1},wIe=oe(yIe),bIe={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},Pk=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function vY(e){const t=te(e.condition)?e.condition.map(iV):iV(e.condition);return{...Wr(e),condition:t}}function Wr(e){if(eC(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function iV(e){if(eC(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function Kt(e){if(eC(e)){const{expr:t,...n}=e;return{signal:t,...n}}return ke(e)?e:e!==void 0?{value:e}:void 0}function SIe(e){return ke(e)?e.signal:he(e)}function rV(e){return ke(e)?e.signal:he(e.value)}function co(e){return ke(e)?e.signal:e==null?null:he(e)}function xIe(e,t,n){for(const i of n){const r=Sa(i,t.markDef,t.config);r!==void 0&&(e[i]=Kt(r))}return e}function CY(e){return[].concat(e.type,e.style??[])}function Lt(e,t,n,i={}){const{vgChannel:r,ignoreVgConfig:s}=i;return r&&ae(t,r)?t[r]:t[e]!==void 0?t[e]:s&&(!r||r===e)?void 0:Sa(e,t,n,i)}function Sa(e,t,n,{vgChannel:i}={}){const r=kk(e,t,n.style);return En(i?r:void 0,r,i?n[t.type][i]:void 0,n[t.type][e],i?n.mark[i]:n.mark[e])}function kk(e,t,n){return yY(e,CY(t),n)}function yY(e,t,n){t=we(t);let i;for(const r of t){const s=n[r];ae(s,e)&&(i=s[e])}return i}function wY(e,t){return we(e).reduce((n,i)=>(n.field.push(ve(i,t)),n.order.push(i.sort??"ascending"),n),{field:[],order:[]})}function bY(e,t){const n=[...e];return t.forEach(i=>{for(const r of n)if(qr(r,i))return;n.push(i)}),n}function SY(e,t){return qr(e,t)||!t?e:e?[...we(e),...we(t)].join(", "):t}function xY(e,t){const n=e.value,i=t.value;if(n==null||i===null)return{explicit:e.explicit,value:null};if((bu(n)||ke(n))&&(bu(i)||ke(i)))return{explicit:e.explicit,value:SY(n,i)};if(bu(n)||ke(n))return{explicit:e.explicit,value:n};if(bu(i)||ke(i))return{explicit:e.explicit,value:i};if(!bu(n)&&!ke(n)&&!bu(i)&&!ke(i))return{explicit:e.explicit,value:bY(n,i)};throw new Error("It should never reach here")}function eO(e){return`Invalid specification ${$t(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const RIe='Autosize "fit" only works for single views and layered views.';function sV(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function oV(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function aV(e){return e?`Dropping "fit-${e}" because spec has discrete ${Mr(e)}.`:'Dropping "fit" because spec has discrete size.'}function tO(e){return`Unknown field for ${e}. Cannot calculate view size.`}function lV(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function EIe(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function FIe(e){return`The "nearest" transform is not supported for ${e} marks.`}function RY(e){return`Selection not supported for ${e} yet.`}function AIe(e){return`Cannot find a selection named "${e}".`}const DIe="Scale bindings are currently only supported for scales with unbinned, continuous domains.",PIe="Sequntial scales are deprecated. The available quantitative scale type values are linear, log, pow, sqrt, symlog, time and utc",kIe="Legend bindings are only supported for selections over an individual field or encoding channel.";function TIe(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}function MIe(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}const IIe="The same selection must be used to override scale domains in a layered view.",_Ie='Interval selections should be initialized using "x", "y", "longitude", or "latitude" keys.';function OIe(e){return`Unknown repeated value "${e}".`}function uV(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const LIe="Multiple timer selections in one unit spec are not supported. Ignoring all but the first.",nO="Animation involving facet, layer, or concat is currently unsupported.";function NIe(e){return`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${he(e)}.`}function $Ie(e,t,n,i){return(e.length?"Multiple ":"No ")+`matching ${he(t)} encoding found for selection ${he(n.param)}. Using "field": ${he(i)}.`}const BIe="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function GIe(e){return`Unrecognized parse "${e}".`}function cV(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}const zIe="Attempt to add the same child twice.";function HIe(e){return`Ignoring an invalid transform: ${$t(e)}.`}const VIe='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function dV(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function WIe(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${$t(t)} is overridden by a child projection ${$t(n)}.`}const UIe="Arc marks uses theta channel rather than angle, replacing angle with theta.";function jIe(e){return`${e}Offset dropped because ${e} is continuous`}function qIe(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${$t(n)}}.`}function EY(e){return`Invalid field type "${e}".`}function KIe(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function YIe(e){return`Invalid aggregation operator "${e}".`}function FY(e,t){const{fill:n,stroke:i}=t;return`Dropping color ${e} as the plot also has ${n&&i?"fill and stroke":n?"fill":"stroke"}.`}function XIe(e){return`Position range does not support relative band size for ${e}.`}function Tk(e,t){return`Dropping ${$t(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const QIe="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function Mx(e,t,n){return`${e} dropped as it is incompatible with "${t}".`}function JIe(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function ZIe(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function e2e(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function t2e(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function mA(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function n2e(e){return`The ${e} for range marks cannot be an expression`}function i2e(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function r2e(e,t){return`Specified orient "${e}" overridden with "${t}".`}function s2e(e){return`Cannot use the scale property "${e}" with non-color channel.`}function o2e(e){return`Cannot use the relative band size with ${e} scale.`}function a2e(e){return`Using unaggregated domain with raw field has no effect (${$t(e)}).`}function l2e(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function u2e(e){return`Unaggregated domain is currently unsupported for log scale (${$t(e)}).`}function c2e(e){return`Cannot apply size to non-oriented mark "${e}".`}function d2e(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function h2e(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function AY(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function DY(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function f2e(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${$t(n)} and ${$t(i)}). Using ${$t(n)}.`}function p2e(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${$t(n)} and ${$t(i)}). Using the union of the two domains.`}function g2e(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function m2e(e){return`Dropping sort property ${$t(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const hV="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",v2e="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",C2e="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",y2e="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function w2e(e){return`Cannot stack "${e}" if there is already "${e}2".`}function b2e(e){return`Stack is applied to a non-linear scale (${e}).`}function S2e(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function fS(e,t){return`Invalid ${e}: ${$t(t)}.`}function x2e(e){return`Dropping day from datetime ${$t(e)} as day cannot be combined with other units.`}function R2e(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function E2e(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function F2e(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function fV(e){return`1D error band does not support ${e}.`}function PY(e){return`Channel ${e} is required for "binned" bin.`}function A2e(e){return`Channel ${e} should not be used with "binned" bin.`}function D2e(e){return`Domain for ${e} is required for threshold scale.`}const kY=ZT(JT);let Vd=kY;function P2e(e){return Vd=e,Vd}function k2e(){return Vd=kY,Vd}function iO(...e){Vd.error(...e)}function ce(...e){Vd.warn(...e)}function T2e(...e){Vd.debug(...e)}function fh(e){if(e&&ye(e)){for(const t of sO)if(ae(e,t))return!0}return!1}const TY=["january","february","march","april","may","june","july","august","september","october","november","december"],M2e=TY.map(e=>e.substr(0,3)),MY=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],I2e=MY.map(e=>e.substr(0,3));function _2e(e){if(xx(e)&&(e=+e),xt(e))return e>4&&ce(fS("quarter",e)),e-1;throw new Error(fS("quarter",e))}function O2e(e){if(xx(e)&&(e=+e),xt(e))return e-1;{const t=e.toLowerCase(),n=TY.indexOf(t);if(n!==-1)return n;const i=t.substr(0,3),r=M2e.indexOf(i);if(r!==-1)return r;throw new Error(fS("month",e))}}function L2e(e){if(xx(e)&&(e=+e),xt(e))return e%7;{const t=e.toLowerCase(),n=MY.indexOf(t);if(n!==-1)return n;const i=t.substr(0,3),r=I2e.indexOf(i);if(r!==-1)return r;throw new Error(fS("day",e))}}function rO(e,t){const n=[];if(t&&e.day!==void 0&&oe(e).length>1&&(ce(x2e(e)),e=Ue(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const i=t?O2e(e.month):e.month;n.push(i)}else if(e.quarter!==void 0){const i=t?_2e(e.quarter):e.quarter;n.push(xt(i)?i*3:`${i}*3`)}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const i=t?L2e(e.day):e.day;n.push(xt(i)?i+1:`${i}+1`)}else n.push(1);for(const i of["hours","minutes","seconds","milliseconds"]){const r=e[i];n.push(typeof r>"u"?0:r)}return n}function Wd(e){const n=rO(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function N2e(e){const n=rO(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function $2e(e){const t=rO(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}const IY={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},sO=oe(IY);function B2e(e){return Ee(IY,e)}function ph(e){return ye(e)?e.binned:_Y(e)}function _Y(e){return e&&e.startsWith("binned")}function oO(e){return e.startsWith("utc")}function G2e(e){return e.substring(3)}const z2e={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function Ix(e){return sO.filter(t=>LY(e,t))}function OY(e){const t=Ix(e);return t[t.length-1]}function LY(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function H2e(e,t,{end:n}={end:!1}){const i=W_(t),r=oO(e)?"utc":"";function s(l){return l==="quarter"?`(${r}quarter(${i})-1)`:`${r}${l}(${i})`}let o;const a={};for(const l of sO)LY(e,l)&&(a[l]=s(l),o=l);return n&&(a[o]+="+1"),N2e(a)}function NY(e){if(!e)return;const t=Ix(e);return`timeUnitSpecifier(${$t(t)}, ${$t(z2e)})`}function V2e(e,t,n){if(!e)return;const i=NY(e);return`${n||oO(e)?"utc":"time"}Format(${t}, ${i})`}function Zn(e){if(!e)return;let t;return be(e)?_Y(e)?t={unit:e.substring(6),binned:!0}:t={unit:e}:ye(e)&&(t={...e,...e.unit?{unit:e.unit}:{}}),oO(t.unit)&&(t.utc=!0,t.unit=G2e(t.unit)),t}function W2e(e){const{utc:t,...n}=Zn(e);return n.unit?(t?"utc":"")+oe(n).map(i=>en(`${i==="unit"?"":`_${i}_`}${n[i]}`)).join(""):(t?"utc":"")+"timeunit"+oe(n).map(i=>en(`_${i}_${n[i]}`)).join("")}function $Y(e,t=n=>n){const n=Zn(e),i=OY(n.unit);if(i&&i!=="day"){const r={year:2001,month:1,date:1,hours:0,minutes:0,seconds:0,milliseconds:0},{step:s,part:o}=BY(i,n.step),a={...r,[o]:+r[o]+s};return`${t(Wd(a))} - ${t(Wd(r))}`}}const U2e={year:1,month:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1};function j2e(e){return Ee(U2e,e)}function BY(e,t=1){if(j2e(e))return{part:e,step:t};switch(e){case"day":case"dayofyear":return{part:"date",step:t};case"quarter":return{part:"month",step:t*3};case"week":return{part:"date",step:t*7}}}function q2e(e){return ae(e,"param")}function aO(e){return!!e?.field&&e.equal!==void 0}function lO(e){return!!e?.field&&e.lt!==void 0}function uO(e){return!!e?.field&&e.lte!==void 0}function cO(e){return!!e?.field&&e.gt!==void 0}function dO(e){return!!e?.field&&e.gte!==void 0}function hO(e){if(e?.field){if(te(e.range)&&e.range.length===2)return!0;if(ke(e.range))return!0}return!1}function fO(e){return!!e?.field&&(te(e.oneOf)||te(e.in))}function K2e(e){return!!e?.field&&e.valid!==void 0}function GY(e){return fO(e)||aO(e)||hO(e)||lO(e)||cO(e)||uO(e)||dO(e)}function Ko(e,t){return Vx(e,{timeUnit:t,wrapTime:!0})}function Y2e(e,t){return e.map(n=>Ko(n,t))}function zY(e,t=!0){const{field:n}=e,i=Zn(e.timeUnit),{unit:r,binned:s}=i||{},o=ve(e,{expr:"datum"}),a=r?`time(${s?o:H2e(r,n)})`:o;if(aO(e))return`${a}===${Ko(e.equal,r)}`;if(lO(e)){const l=e.lt;return`${a}<${Ko(l,r)}`}else if(cO(e)){const l=e.gt;return`${a}>${Ko(l,r)}`}else if(uO(e)){const l=e.lte;return`${a}<=${Ko(l,r)}`}else if(dO(e)){const l=e.gte;return`${a}>=${Ko(l,r)}`}else{if(fO(e))return`indexof([${Y2e(e.oneOf,r).join(",")}], ${a}) !== -1`;if(K2e(e))return _x(a,e.valid);if(hO(e)){const{range:l}=ai(e),u=ke(l)?{signal:`${l.signal}[0]`}:l[0],c=ke(l)?{signal:`${l.signal}[1]`}:l[1];if(u!==null&&c!==null&&t)return"inrange("+a+", ["+Ko(u,r)+", "+Ko(c,r)+"])";const d=[];return u!==null&&d.push(`${a} >= ${Ko(u,r)}`),c!==null&&d.push(`${a} <= ${Ko(c,r)}`),d.length>0?d.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${$t(e)}`)}function _x(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function X2e(e){return GY(e)&&e.timeUnit?{...e,timeUnit:Zn(e.timeUnit)}:e}const tC={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};function Q2e(e){return e==="quantitative"||e==="temporal"}function HY(e){return e==="ordinal"||e==="nominal"}const Ud=tC.quantitative,pO=tC.ordinal,up=tC.temporal,gO=tC.nominal,Qp=tC.geojson;function J2e(e){if(e)switch(e=e.toLowerCase(),e){case"q":case Ud:return"quantitative";case"t":case up:return"temporal";case"o":case pO:return"ordinal";case"n":case gO:return"nominal";case Qp:return"geojson"}}const li={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",TIME:"time",UTC:"utc",POINT:"point",BAND:"band"},Mk={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function Z2e(e,t){const n=Mk[e],i=Mk[t];return n===i||n==="ordinal-position"&&i==="time"||i==="ordinal-position"&&n==="time"}const e_e={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function pV(e){return e_e[e]}const VY=new Set(["linear","log","pow","sqrt","symlog"]),WY=new Set([...VY,"time","utc"]);function UY(e){return VY.has(e)}const jY=new Set(["quantile","quantize","threshold"]),t_e=new Set([...WY,...jY,"sequential","identity"]),n_e=new Set(["ordinal","bin-ordinal","point","band"]);function ei(e){return n_e.has(e)}function bo(e){return t_e.has(e)}function aa(e){return WY.has(e)}function cp(e){return jY.has(e)}const i_e={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,tickBandPaddingInner:.25,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:4,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4,zero:!0,framesPerSecond:2,animationDuration:5};function r_e(e){return!be(e)&&ae(e,"name")}function qY(e){return ae(e,"param")}function s_e(e){return ae(e,"unionWith")}function o_e(e){return ye(e)&&"field"in e}const a_e={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,domainRaw:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},{type:Xst,domain:Qst,range:Jst,rangeMax:Zst,rangeMin:eot,scheme:tot,...l_e}=a_e,u_e=oe(l_e);function Ik(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return aa(e)||e==="band"||e==="point";case"padding":case"rangeMin":case"rangeMax":return aa(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return e==="band";case"domainMax":case"domainMid":case"domainMin":case"domainRaw":case"clamp":return aa(e);case"nice":return aa(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return bo(e)&&!at(["log","time","utc","threshold","quantile"],e)}}function KY(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return Ff(e)?void 0:s2e(t);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"domainRaw":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}function c_e(e,t){return at([pO,gO],t)?e===void 0||ei(e):t===up?at([li.TIME,li.UTC,void 0],e):t===Ud?UY(e)||cp(e)||e===void 0:!0}function d_e(e,t,n=!1){if(!La(e))return!1;switch(e){case tn:case ni:case vc:case Xp:case zs:case _o:return aa(t)||t==="band"?!0:t==="point"?!n:!1;case Cc:return at(["linear","band"],t);case ql:case bc:case Kl:case yc:case wc:case uh:return aa(t)||cp(t)||at(["band","point","ordinal"],t);case kr:case Ia:case _a:return t!=="band";case Sc:case Tr:return t==="ordinal"||cp(t)}}function h_e(e){return ye(e)&&"value"in e}const lr={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},YY=lr.arc,Ox=lr.area,Lx=lr.bar,f_e=lr.image,Nx=lr.line,$x=lr.point,p_e=lr.rect,pS=lr.rule,XY=lr.text,mO=lr.tick,g_e=lr.trail,vO=lr.circle,CO=lr.square,QY=lr.geoshape;function Rc(e){return["line","area","trail"].includes(e)}function Uv(e){return["rect","bar","image","arc","tick"].includes(e)}const m_e=new Set(oe(lr));function xa(e){return ae(e,"type")}const v_e=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],C_e=["fill","fillOpacity"],y_e=[...v_e,...C_e],w_e={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1},gV=oe(w_e),vA=["binSpacing","continuousBandSize","discreteBandSize","minBandSize"],b_e={area:["line","point"],bar:vA,rect:vA,line:["point"],tick:["bandSize","thickness",...vA]},S_e={color:"#4c78a8",invalid:"break-paths-show-path-domains",timeUnitBandSize:1},x_e={mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1},JY=oe(x_e);function jd(e){return ae(e,"band")}const R_e={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},E_e=5,yO={binSpacing:0,continuousBandSize:E_e,minBandSize:.25,timeUnitBandPosition:.5},F_e={...yO,binSpacing:1},A_e={...yO,thickness:1};function D_e(e){return xa(e)?e.type:e}function ZY(e,{isPath:t}){return e===void 0||e==="break-paths-show-path-domains"?t?"break-paths-show-domains":"filter":e===null?"show":e}function wO({markDef:e,config:t,scaleChannel:n,scaleType:i,isCountAggregate:r}){if(!i||!bo(i)||r)return"always-valid";const s=ZY(Lt("invalid",e,t),{isPath:Rc(e.type)});return t.scale?.invalid?.[n]!==void 0?"show":s}function P_e(e){return e==="break-paths-filter-domains"||e==="break-paths-show-domains"}function eX({scaleName:e,scale:t,mode:n}){const i=`domain('${e}')`;if(!t||!e)return;const r=`${i}[0]`,s=`peek(${i})`,o=t.domainHasZero();return o==="definitely"?{scale:e,value:0}:o==="maybe"?{signal:`scale('${e}', inrange(0, ${i}) ? 0 : ${n==="zeroOrMin"?r:s})`}:{signal:`scale('${e}', ${n==="zeroOrMin"?r:s})`}}function tX({scaleChannel:e,channelDef:t,scale:n,scaleName:i,markDef:r,config:s}){const o=n?.get("type"),a=xo(t),l=kx(a?.aggregate),u=wO({scaleChannel:e,markDef:r,config:s,scaleType:o,isCountAggregate:l});if(a&&u==="show"){const c=s.scale.invalid?.[e]??"zero-or-min";return{test:_x(ve(a,{expr:"datum"}),!1),...k_e(c,n,i)}}}function k_e(e,t,n){if(h_e(e)){const{value:i}=e;return ke(i)?{signal:i.signal}:{value:i}}return eX({scale:t,scaleName:n,mode:"zeroOrMin"})}function bO(e){const{channel:t,channelDef:n,markDef:i,scale:r,scaleName:s,config:o}=e,a=ch(t),l=SO(e),u=tX({scaleChannel:a,channelDef:n,scale:r,scaleName:s,markDef:i,config:o});return u!==void 0?[u,l]:l}function T_e(e){const{datum:t}=e;return fh(t)?Wd(t):`${$t(t)}`}function vd(e,t,n,i){const r={};if(t&&(r.scale=t),Na(e)){const{datum:s}=e;fh(s)?r.signal=Wd(s):ke(s)?r.signal=s.signal:eC(s)?r.signal=s.expr:r.value=s}else r.field=ve(e,n);if(i){const{offset:s,band:o}=i;s&&(r.offset=s),o&&(r.band=o)}return r}function gS({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:i,startSuffix:r,endSuffix:s="end",bandPosition:o=.5}){const a=!ke(o)&&0<o&&o<1?"datum":void 0,l=ve(t,{expr:a,suffix:r}),u=n!==void 0?ve(n,{expr:a}):ve(t,{suffix:s,expr:a}),c={};if(o===0||o===1){c.scale=e;const d=o===0?l:u;c.field=d}else{const d=ke(o)?`(1-${o.signal}) * ${l} + ${o.signal} * ${u}`:`${1-o} * ${l} + ${o} * ${u}`;c.signal=`scale("${e}", ${d})`}return i&&(c.offset=i),c}function M_e({scaleName:e,fieldDef:t}){const n=ve(t,{expr:"datum"}),i=ve(t,{expr:"datum",suffix:"end"});return`abs(scale("${e}", ${i}) - scale("${e}", ${n}))`}function SO({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:s,scale:o,stack:a,offset:l,defaultRef:u,bandPosition:c}){if(t){if(qe(t)){const d=o?.get("type");if(or(t)){c??(c=tc({fieldDef:t,fieldDef2:n,markDef:i,config:r}));const{bin:h,timeUnit:p,type:g}=t;if(Ut(h)||c&&p&&g===up)return a?.impute?vd(t,s,{binSuffix:"mid"},{offset:l}):c&&!ei(d)?gS({scaleName:s,fieldOrDatumDef:t,bandPosition:c,offset:l}):vd(t,s,oC(t,e)?{binSuffix:"range"}:{},{offset:l});if(oi(h)){if(de(n))return gS({scaleName:s,fieldOrDatumDef:t,fieldOrDatumDef2:n,bandPosition:c,offset:l});ce(PY(e===tn?Io:Ma))}}return vd(t,s,ei(d)?{binSuffix:"range"}:{},{offset:l,band:d==="band"?c??t.bandPosition??.5:void 0})}else if(So(t)){const d=t.value,h=l?{offset:l}:{};return{...rv(e,d),...h}}}return nt(u)&&(u=u()),u&&{...u,...l?{offset:l}:{}}}function rv(e,t){return at(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:at(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:Kt(t)}function qd(e){return e&&e!=="number"&&e!=="time"}function nX(e,t,n){return`${e}(${t}${n?`, ${$t(n)}`:""})`}const I_e=" – ";function xO({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:s}){if(qd(n))return ho({fieldOrDatumDef:e,format:t,formatType:n,expr:i,config:s});const o=iX(e,i,r),a=dp(e);if(t===void 0&&n===void 0&&s.customFormatTypes){if(a==="quantitative"){if(r&&s.normalizedNumberFormatType)return ho({fieldOrDatumDef:e,format:s.normalizedNumberFormat,formatType:s.normalizedNumberFormatType,expr:i,config:s});if(s.numberFormatType)return ho({fieldOrDatumDef:e,format:s.numberFormat,formatType:s.numberFormatType,expr:i,config:s})}if(a==="temporal"&&s.timeFormatType&&de(e)&&e.timeUnit===void 0)return ho({fieldOrDatumDef:e,format:s.timeFormat,formatType:s.timeFormatType,expr:i,config:s})}if(fp(e)){const l=O_e({field:o,timeUnit:de(e)?Zn(e.timeUnit)?.unit:void 0,format:t,formatType:s.timeFormatType,rawTimeFormat:s.timeFormat,isUTCScale:gh(e)&&e.scale?.type===li.UTC});return l?{signal:l}:void 0}if(t=_k({type:a,specifiedFormat:t,config:s,normalizeStack:r}),de(e)&&Ut(e.bin)){const l=ve(e,{expr:i,binSuffix:"end"});return{signal:nC(o,l,t,n,s)}}else return t||dp(e)==="quantitative"?{signal:`${oX(o,t)}`}:{signal:`isValid(${o}) ? ${o} : ""+${o}`}}function iX(e,t,n){return de(e)?n?`${ve(e,{expr:t,suffix:"end"})}-${ve(e,{expr:t,suffix:"start"})}`:ve(e,{expr:t}):T_e(e)}function ho({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:s,field:o}){if(o??(o=iX(e,i,r)),o!=="datum.value"&&de(e)&&Ut(e.bin)){const a=ve(e,{expr:i,binSuffix:"end"});return{signal:nC(o,a,t,n,s)}}return{signal:nX(n,o,t)}}function rX(e,t,n,i,r,s){if(!(be(i)&&qd(i))&&!(n===void 0&&i===void 0&&r.customFormatTypes&&dp(e)==="quantitative"&&(r.normalizedNumberFormatType&&hp(e)&&e.stack==="normalize"||r.numberFormatType))){if(hp(e)&&e.stack==="normalize"&&r.normalizedNumberFormat)return _k({type:"quantitative",config:r,normalizeStack:!0});if(fp(e)){const o=de(e)?Zn(e.timeUnit)?.unit:void 0;return o===void 0&&r.customFormatTypes&&r.timeFormatType?void 0:__e({specifiedFormat:n,timeUnit:o,config:r,omitTimeFormatConfig:s})}return _k({type:t,specifiedFormat:n,config:r})}}function sX(e,t,n){if(e&&(ke(e)||e==="number"||e==="time"))return e;if(fp(t)&&n!=="time"&&n!=="utc")return de(t)&&Zn(t?.timeUnit)?.utc?"utc":"time"}function _k({type:e,specifiedFormat:t,config:n,normalizeStack:i}){if(be(t))return t;if(e===Ud)return i?n.normalizedNumberFormat:n.numberFormat}function __e({specifiedFormat:e,timeUnit:t,config:n,omitTimeFormatConfig:i}){return e||(t?{signal:NY(t)}:i?void 0:n.timeFormat)}function oX(e,t){return`format(${e}, "${t||""}")`}function mV(e,t,n,i){return qd(n)?nX(n,e,t):oX(e,(be(t)?t:void 0)??i.numberFormat)}function nC(e,t,n,i,r){if(n===void 0&&i===void 0&&r.customFormatTypes&&r.numberFormatType)return nC(e,t,r.numberFormat,r.numberFormatType,r);const s=mV(e,n,i,r),o=mV(t,n,i,r);return`${_x(e,!1)} ? "null" : ${s} + "${I_e}" + ${o}`}function O_e({field:e,timeUnit:t,format:n,formatType:i,rawTimeFormat:r,isUTCScale:s}){return!t||n?!t&&i?`${i}(${e}, '${n}')`:(n=be(n)?n:r,`${s?"utc":"time"}Format(${e}, '${n}')`):V2e(t,e,s)}const Bx="min",L_e={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function vV(e){return Ee(L_e,e)}function N_e(e){return ae(e,"encoding")}function bl(e){return e&&(e.op==="count"||ae(e,"field"))}function aX(e){return e&&te(e)}function iC(e){return ae(e,"row")||ae(e,"column")}function RO(e){return ae(e,"header")}function Gx(e){return ae(e,"facet")}function $_e(e){return ae(e,"param")}function B_e(e){return!be(e)&&ae(e,"repeat")}function CV(e){const{field:t,timeUnit:n,bin:i,aggregate:r}=e;return{...n?{timeUnit:n}:{},...i?{bin:i}:{},...r?{aggregate:r}:{},field:t}}function EO(e){return ae(e,"sort")}function tc({fieldDef:e,fieldDef2:t,markDef:n,config:i}){if(qe(e)&&e.bandPosition!==void 0)return e.bandPosition;if(de(e)){const{timeUnit:r,bin:s}=e;if(r&&!t)return Sa("timeUnitBandPosition",n,i);if(Ut(s))return .5}}function lX({channel:e,fieldDef:t,fieldDef2:n,markDef:i,config:r,scaleType:s,useVlSizeChannel:o}){const a=Mr(e),l=Lt(o?"size":a,i,r,{vgChannel:a});if(l!==void 0)return l;if(de(t)){const{timeUnit:u,bin:c}=t;if(u&&!n)return{band:Sa("timeUnitBandSize",i,r)};if(Ut(c)&&!ei(s))return{band:1}}if(Uv(i.type))return s?ei(s)?r[i.type]?.discreteBandSize||{band:1}:r[i.type]?.continuousBandSize:r[i.type]?.discreteBandSize}function uX(e,t,n,i){return Ut(e.bin)||e.timeUnit&&or(e)&&e.type==="temporal"?tc({fieldDef:e,fieldDef2:t,markDef:n,config:i})!==void 0:!1}function cX(e){return ae(e,"sort")&&!ae(e,"field")}function rC(e){return ae(e,"condition")}function zx(e){const t=e?.condition;return!!t&&!te(t)&&de(t)}function sC(e){const t=e?.condition;return!!t&&!te(t)&&qe(t)}function G_e(e){const t=e?.condition;return!!t&&(te(t)||So(t))}function de(e){return ae(e,"field")||e?.aggregate==="count"}function dp(e){return e?.type}function Na(e){return ae(e,"datum")}function Iu(e){return or(e)&&!vS(e)||mS(e)}function yV(e){return or(e)&&e.type==="quantitative"&&!e.bin||mS(e)}function mS(e){return Na(e)&&xt(e.datum)}function qe(e){return de(e)||Na(e)}function or(e){return e&&(ae(e,"field")||e.aggregate==="count")&&ae(e,"type")}function So(e){return ae(e,"value")}function gh(e){return ae(e,"scale")||ae(e,"sort")}function hp(e){return ae(e,"axis")||ae(e,"stack")||ae(e,"impute")}function dX(e){return ae(e,"legend")}function hX(e){return ae(e,"format")||ae(e,"formatType")}function z_e(e){return Er(e,["legend","axis","header","scale"])}function H_e(e){return ae(e,"op")}function ve(e,t={}){let n=e.field;const i=t.prefix;let r=t.suffix,s="";if(W_e(e))n=tY("count");else{let o;if(!t.nofn)if(H_e(e))o=e.op;else{const{bin:a,aggregate:l,timeUnit:u}=e;Ut(a)?(o=gY(a),r=(t.binSuffix??"")+(t.suffix??"")):l?xc(l)?(s=`["${n}"]`,n=`argmax_${l.argmax}`):Tl(l)?(s=`["${n}"]`,n=`argmin_${l.argmin}`):o=String(l):u&&!ph(u)&&(o=W2e(u),r=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+(t.suffix??""))}o&&(n=n?`${o}_${n}`:o)}return r&&(n=`${n}_${r}`),i&&(n=`${i}_${n}`),t.forAs?Yp(n):t.expr?JK(n,t.expr)+s:Ns(n)+s}function vS(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return de(e)&&!!e.bin;case"temporal":return!1}throw new Error(EY(e.type))}function V_e(e){return gh(e)&&cp(e.scale?.type)}function W_e(e){return e.aggregate==="count"}function U_e(e,t){const{field:n,bin:i,timeUnit:r,aggregate:s}=e;if(s==="count")return t.countTitle;if(Ut(i))return`${n} (binned)`;if(r&&!ph(r)){const o=Zn(r)?.unit;if(o)return`${n} (${Ix(o).join("-")})`}else if(s)return xc(s)?`${n} for max ${s.argmax}`:Tl(s)?`${n} for min ${s.argmin}`:`${X0(s)} of ${n}`;return n}function j_e(e){const{aggregate:t,bin:n,timeUnit:i,field:r}=e;if(xc(t))return`${r} for argmax(${t.argmax})`;if(Tl(t))return`${r} for argmin(${t.argmin})`;const s=i&&!ph(i)?Zn(i):void 0,o=t||s?.unit||s?.maxbins&&"timeunit"||Ut(n)&&"bin";return o?`${o.toUpperCase()}(${r})`:r}const fX=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return j_e(e);default:return U_e(e,t)}};let pX=fX;function gX(e){pX=e}function q_e(){gX(fX)}function Af(e,t,{allowDisabling:n,includeDefault:i=!0}){const r=FO(e)?.title;if(!de(e))return r??e.title;const s=e,o=i?AO(s,t):void 0;return n?En(r,s.title,o):r??s.title??o}function FO(e){if(hp(e)&&e.axis)return e.axis;if(dX(e)&&e.legend)return e.legend;if(RO(e)&&e.header)return e.header}function AO(e,t){return pX(e,t)}function CS(e){if(hX(e)){const{format:t,formatType:n}=e;return{format:t,formatType:n}}else{const t=FO(e)??{},{format:n,formatType:i}=t;return{format:n,formatType:i}}}function K_e(e,t){switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(EO(e)&&te(e.sort))return"ordinal";const{aggregate:n,bin:i,timeUnit:r}=e;if(r)return"temporal";if(i||n&&!xc(n)&&!Tl(n))return"quantitative";if(gh(e)&&e.scale?.type)switch(Mk[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}function xo(e){if(de(e))return e;if(zx(e))return e.condition}function Gn(e){if(qe(e))return e;if(sC(e))return e.condition}function mX(e,t,n,i={}){if(be(e)||xt(e)||uc(e)){const r=be(e)?"string":xt(e)?"number":"boolean";return ce(qIe(t,r,e)),{value:e}}return qe(e)?yS(e,t,n,i):sC(e)?{...e,condition:yS(e.condition,t,n,i)}:e}function yS(e,t,n,i){if(hX(e)){const{format:r,formatType:s,...o}=e;if(qd(s)&&!n.customFormatTypes)return ce(dV(t)),yS(o,t,n,i)}else{const r=hp(e)?"axis":dX(e)?"legend":RO(e)?"header":null;if(r&&e[r]){const{format:s,formatType:o,...a}=e[r];if(qd(o)&&!n.customFormatTypes)return ce(dV(t)),yS({...e,[r]:a},t,n,i)}}return de(e)?DO(e,t,i):Y_e(e)}function Y_e(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=xt(n)?"quantitative":be(n)?"nominal":fh(n)?"temporal":void 0,{...e,type:t}}function DO(e,t,{compositeMark:n=!1}={}){const{aggregate:i,timeUnit:r,bin:s,field:o}=e,a={...e};if(!n&&i&&!Z_(i)&&!xc(i)&&!Tl(i)&&(ce(YIe(i)),delete a.aggregate),r&&(a.timeUnit=Zn(r)),o&&(a.field=`${o}`),Ut(s)&&(a.bin=Hx(s,t)),oi(s)&&!Fn(t)&&ce(A2e(t)),or(a)){const{type:l}=a,u=J2e(l);l!==u&&(a.type=u),l!=="quantitative"&&kx(i)&&(ce(KIe(l,i)),a.type="quantitative")}else if(!uY(t)){const l=K_e(a,t);a.type=l}if(or(a)){const{compatible:l,warning:u}=X_e(a,t)||{};l===!1&&ce(u)}if(EO(a)&&be(a.sort)){const{sort:l}=a;if(vV(l))return{...a,sort:{encoding:l}};const u=l.substring(1);if(l.charAt(0)==="-"&&vV(u))return{...a,sort:{encoding:u,order:"descending"}}}if(RO(a)){const{header:l}=a;if(l){const{orient:u,...c}=l;if(u)return{...a,header:{...c,labelOrient:l.labelOrient||u,titleOrient:l.titleOrient||u}}}}return a}function Hx(e,t){return uc(e)?{maxbins:nV(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?{...e,maxbins:nV(t)}:e}const Xh={compatible:!0};function X_e(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case yl:case wl:case Rx:return vS(e)?Xh:{compatible:!1,warning:ZIe(t)};case tn:case ni:case vc:case Xp:case kr:case Ia:case _a:case Q0:case J0:case Ex:case Hd:case Fx:case Ax:case uh:case zs:case _o:case Dx:return Xh;case Lo:case $s:case Oo:case No:return n!==Ud?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:Xh;case Kl:case yc:case wc:case bc:case ql:case jl:case Ul:case Io:case Ma:case Cc:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:Xh;case Tr:case Sc:return!vS(e)&&!V_e(e)?{compatible:!1,warning:e2e(t)}:Xh;case lp:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:Xh}}function fp(e){const{formatType:t}=CS(e);return t==="time"||!t&&Q_e(e)}function Q_e(e){return e&&(e.type==="temporal"||de(e)&&!!e.timeUnit)}function Vx(e,{timeUnit:t,type:n,wrapTime:i,undefinedIfExprNotRequired:r}){const s=t&&Zn(t)?.unit;let o=s||n==="temporal",a;return eC(e)?a=e.expr:ke(e)?a=e.signal:fh(e)?(o=!0,a=Wd(e)):(be(e)||xt(e))&&o&&(a=`datetime(${$t(e)})`,B2e(s)&&(xt(e)&&e<1e4||be(e)&&isNaN(Date.parse(e)))&&(a=Wd({[s]:e}))),a?i&&o?`time(${a})`:a:r?void 0:$t(e)}function vX(e,t){const{type:n}=e;return t.map(i=>{const r=de(e)&&!ph(e.timeUnit)?e.timeUnit:void 0,s=Vx(i,{timeUnit:r,type:n,undefinedIfExprNotRequired:!0});return s!==void 0?{signal:s}:i})}function oC(e,t){return Ut(e.bin)?La(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}const wV={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function aC(e){return e?.condition}const CX=["domain","grid","labels","ticks","title"],J_e={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},yX={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},Z_e={...yX,style:1,labelExpr:1,encoding:1};function bV(e){return Ee(Z_e,e)}const eOe={axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1},wX=oe(eOe);function Xl(e){return ae(e,"mark")}class Wx{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return Xl(t)?D_e(t.mark)===this.name:!1}}function Cd(e,t){const n=e&&e[t];return n?te(n)?op(n,i=>!!i.field):de(n)||zx(n):!1}function bX(e,t){const n=e&&e[t];return n?te(n)?op(n,i=>!!i.field):de(n)||Na(n)||sC(n):!1}function SX(e,t){if(Fn(t)){const n=e[t];if((de(n)||Na(n))&&(HY(n.type)||de(n)&&n.timeUnit)){const i=K_(t);return bX(e,i)}}return!1}function xX(e){return op(YMe,t=>{if(Cd(e,t)){const n=e[t];if(te(n))return op(n,i=>!!i.aggregate);{const i=xo(n);return i&&!!i.aggregate}}return!1})}function RX(e,t){const n=[],i=[],r=[],s=[],o={};return PO(e,(a,l)=>{if(de(a)){const{field:u,aggregate:c,bin:d,timeUnit:h,...p}=a;if(c||h||d){const v=FO(a)?.title;let C=ve(a,{forAs:!0});const y={...v?[]:{title:Af(a,t,{allowDisabling:!0})},...p,field:C};if(c){let b;if(xc(c)?(b="argmax",C=ve({op:"argmax",field:c.argmax},{forAs:!0}),y.field=`${C}.${u}`):Tl(c)?(b="argmin",C=ve({op:"argmin",field:c.argmin},{forAs:!0}),y.field=`${C}.${u}`):c!=="boxplot"&&c!=="errorbar"&&c!=="errorband"&&(b=c),b){const S={op:b,as:C};u&&(S.field=u),s.push(S)}}else if(n.push(C),or(a)&&Ut(d)){if(i.push({bin:d,field:u,as:C}),n.push(ve(a,{binSuffix:"end"})),oC(a,l)&&n.push(ve(a,{binSuffix:"range"})),Fn(l)){const b={field:`${C}_end`};o[`${l}2`]=b}y.bin="binned",uY(l)||(y.type=Ud)}else if(h&&!ph(h)){r.push({timeUnit:h,field:u,as:C});const b=or(a)&&a.type!==up&&"time";b&&(l===Q0||l===Hd?y.formatType=b:oIe(l)?y.legend={formatType:b,...y.legend}:Fn(l)&&(y.axis={formatType:b,...y.axis}))}o[l]=y}else n.push(u),o[l]=e[l]}else o[l]=e[l]}),{bins:i,timeUnits:r,aggregate:s,groupby:n,encoding:o}}function tOe(e,t,n){const i=lIe(t,n);if(i){if(i==="binned"){const r=e[t===Io?tn:ni];return!!(de(r)&&de(e[t])&&oi(r.bin))}}else return!1;return!0}function nOe(e,t,n,i){const r={};for(const s of oe(e))lY(s)||ce(JIe(s));for(let s of tIe){if(!e[s])continue;const o=e[s];if(Z0(s)){const a=eIe(s),l=r[a];if(de(l)&&Q2e(l.type)&&de(o)&&!l.timeUnit){ce(jIe(a));continue}}if(s==="angle"&&t==="arc"&&!e.theta&&(ce(UIe),s=zs),!tOe(e,s,t)){ce(Mx(s,t));continue}if(s===ql&&t==="line"&&xo(e[s])?.aggregate){ce(QIe);continue}if(s===kr&&(n?"fill"in e:"stroke"in e)){ce(FY("encoding",{fill:"fill"in e,stroke:"stroke"in e}));continue}if(s===J0||s===lp&&!te(o)&&!So(o)||s===Hd&&te(o)){if(o){if(s===lp){const a=e[s];if(cX(a)){r[s]=a;continue}}r[s]=we(o).reduce((a,l)=>(de(l)?a.push(DO(l,s)):ce(Tk(l,s)),a),[])}}else{if(s===Hd&&o===null)r[s]=null;else if(!de(o)&&!Na(o)&&!So(o)&&!rC(o)&&!ke(o)){ce(Tk(o,s));continue}r[s]=mX(o,s,i)}}return r}function Ux(e,t){const n={};for(const i of oe(e)){const r=mX(e[i],i,t,{compositeMark:!0});n[i]=r}return n}function iOe(e){const t=[];for(const n of oe(e))if(Cd(e,n)){const i=e[n],r=we(i);for(const s of r)de(s)?t.push(s):zx(s)&&t.push(s.condition)}return t}function PO(e,t,n){if(e)for(const i of oe(e)){const r=e[i];if(te(r))for(const s of r)t.call(n,s,i);else t.call(n,r,i)}}function rOe(e,t,n,i){return e?oe(e).reduce((r,s)=>{const o=e[s];return te(o)?o.reduce((a,l)=>t.call(i,a,l,s),r):t.call(i,r,o,s)},n):n}function EX(e,t){return oe(t).reduce((n,i)=>{switch(i){case tn:case ni:case Fx:case Dx:case Ax:case Io:case Ma:case vc:case Xp:case zs:case jl:case _o:case Ul:case Cc:case Oo:case Lo:case No:case $s:case Q0:case Tr:case uh:case Hd:return n;case lp:if(e==="line"||e==="trail")return n;case J0:case Ex:{const r=t[i];if(te(r)||de(r))for(const s of we(r))s.aggregate||n.push(ve(s,{}));return n}case ql:if(e==="trail")return n;case kr:case Ia:case _a:case Kl:case yc:case wc:case Sc:case bc:{const r=xo(t[i]);return r&&!r.aggregate&&n.push(ve(r,{})),n}}},[])}function sOe(e){const{tooltip:t,...n}=e;if(!t)return{filteredEncoding:n};let i,r;if(te(t)){for(const s of t)s.aggregate?(i||(i=[]),i.push(s)):(r||(r=[]),r.push(s));i&&(n.tooltip=i)}else t.aggregate?n.tooltip=t:r=t;return te(r)&&r.length===1&&(r=r[0]),{customTooltipWithoutAggregatedField:r,filteredEncoding:n}}function Ok(e,t,n,i=!0){if("tooltip"in n)return{tooltip:n.tooltip};const r=e.map(({fieldPrefix:o,titlePrefix:a})=>{const l=i?` of ${kO(t)}`:"";return{field:o+t.field,type:t.type,title:ke(a)?{signal:`${a}"${escape(l)}"`}:a+l}}),s=iOe(n).map(z_e);return{tooltip:[...r,...oa(s,ct)]}}function kO(e){const{title:t,field:n}=e;return En(t,n)}function TO(e,t,n,i,r){const{scale:s,axis:o}=n;return({partName:a,mark:l,positionPrefix:u,endPositionPrefix:c=void 0,extraEncoding:d={}})=>{const h=kO(n);return FX(e,a,r,{mark:l,encoding:{[t]:{field:`${u}_${n.field}`,type:n.type,...h!==void 0?{title:h}:{},...s!==void 0?{scale:s}:{},...o!==void 0?{axis:o}:{}},...be(c)?{[`${t}2`]:{field:`${c}_${n.field}`}}:{},...i,...d}})}}function FX(e,t,n,i){const{clip:r,color:s,opacity:o}=e,a=e.type;return e[t]||e[t]===void 0&&n[t]?[{...i,mark:{...n[t],...r?{clip:r}:{},...s?{color:s}:{},...o?{opacity:o}:{},...xa(i.mark)?i.mark:{type:i.mark},style:`${a}-${String(t)}`,...uc(e[t])?{}:e[t]}}]:[]}function AX(e,t,n){const{encoding:i}=e,r=t==="vertical"?"y":"x",s=i[r],o=i[`${r}2`],a=i[`${r}Error`],l=i[`${r}Error2`];return{continuousAxisChannelDef:Wy(s,n),continuousAxisChannelDef2:Wy(o,n),continuousAxisChannelDefError:Wy(a,n),continuousAxisChannelDefError2:Wy(l,n),continuousAxis:r}}function Wy(e,t){if(e?.aggregate){const{aggregate:n,...i}=e;return n!==t&&ce(F2e(n,t)),i}else return e}function DX(e,t){const{mark:n,encoding:i}=e,{x:r,y:s}=i;if(xa(n)&&n.orient)return n.orient;if(Iu(r)){if(Iu(s)){const o=de(r)&&r.aggregate,a=de(s)&&s.aggregate;if(!o&&a===t)return"vertical";if(!a&&o===t)return"horizontal";if(o===t&&a===t)throw new Error("Both x and y cannot have aggregate");return fp(s)&&!fp(r)?"horizontal":"vertical"}return"horizontal"}else{if(Iu(s))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}}const wS="boxplot",oOe=["box","median","outliers","rule","ticks"],aOe=new Wx(wS,kX);function PX(e){return xt(e)?"tukey":e}function kX(e,{config:t}){e={...e,encoding:Ux(e.encoding,t)};const{mark:n,encoding:i,params:r,projection:s,...o}=e,a=xa(n)?n:{type:n};r&&ce(RY("boxplot"));const l=a.extent??t.boxplot.extent,u=Lt("size",a,t),c=a.invalid,d=PX(l),{bins:h,timeUnits:p,transform:g,continuousAxisChannelDef:v,continuousAxis:C,groupby:y,aggregate:b,encodingWithoutContinuousAxis:S,ticksOrient:x,boxOrient:E,customTooltipWithoutAggregatedField:A}=lOe(e,l,t),F=Yp(v.field),{color:k,size:P,..._}=S,O=Tc=>TO(a,C,v,Tc,t.boxplot),H=O(_),W=O(S),$=(ye(t.boxplot.box)?t.boxplot.box.color:t.mark.color)||"#4c78a8",L=O({..._,...P?{size:P}:{},color:{condition:{test:`${It(`lower_box_${v.field}`)} >= ${It(`upper_box_${v.field}`)}`,...k||{value:$}}}}),G=Ok([{fieldPrefix:d==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:d==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],v,S),j={type:"tick",color:"black",opacity:1,orient:x,invalid:c,aria:!1},ee=d==="min-max"?G:Ok([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],v,S),q=[...H({partName:"rule",mark:{type:"rule",invalid:c,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:ee}),...H({partName:"rule",mark:{type:"rule",invalid:c,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:ee}),...H({partName:"ticks",mark:j,positionPrefix:"lower_whisker",extraEncoding:ee}),...H({partName:"ticks",mark:j,positionPrefix:"upper_whisker",extraEncoding:ee})],fe=[...d!=="tukey"?q:[],...W({partName:"box",mark:{type:"bar",...u?{size:u}:{},orient:E,invalid:c,ariaRoleDescription:"box"},positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:G}),...L({partName:"median",mark:{type:"tick",invalid:c,...ye(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{},...u?{size:u}:{},orient:x,aria:!1},positionPrefix:"mid_box",extraEncoding:G})];if(d==="min-max")return{...o,transform:(o.transform??[]).concat(g),layer:fe};const Re=It(`lower_box_${v.field}`),Fe=It(`upper_box_${v.field}`),ze=`(${Fe} - ${Re})`,Ft=`${Re} - ${l} * ${ze}`,$e=`${Fe} + ${l} * ${ze}`,nn=It(v.field),za={joinaggregate:TX(v.field),groupby:y},dr={transform:[{filter:`(${Ft} <= ${nn}) && (${nn} <= ${$e})`},{aggregate:[{op:"min",field:v.field,as:`lower_whisker_${F}`},{op:"max",field:v.field,as:`upper_whisker_${F}`},{op:"min",field:`lower_box_${v.field}`,as:`lower_box_${F}`},{op:"max",field:`upper_box_${v.field}`,as:`upper_box_${F}`},...b],groupby:y}],layer:q},{tooltip:xe,...Ye}=_,{scale:Xe,axis:le}=v,Pn=kO(v),et=Er(le,["title"]),cn=FX(a,"outliers",t.boxplot,{transform:[{filter:`(${nn} < ${Ft}) || (${nn} > ${$e})`}],mark:"point",encoding:{[C]:{field:v.field,type:v.type,...Pn!==void 0?{title:Pn}:{},...Xe!==void 0?{scale:Xe}:{},...Nt(et)?{}:{axis:et}},...Ye,...k?{color:k}:{},...A?{tooltip:A}:{}}})[0];let kn;const Tn=[...h,...p,za];return cn?kn={transform:Tn,layer:[cn,dr]}:(kn=dr,kn.transform.unshift(...Tn)),{...o,layer:[kn,{transform:g,layer:fe}]}}function TX(e){const t=Yp(e);return[{op:"q1",field:e,as:`lower_box_${t}`},{op:"q3",field:e,as:`upper_box_${t}`}]}function lOe(e,t,n){const i=DX(e,wS),{continuousAxisChannelDef:r,continuousAxis:s}=AX(e,i,wS),o=r.field,a=Yp(o),l=PX(t),u=[...TX(o),{op:"median",field:o,as:`mid_box_${a}`},{op:"min",field:o,as:(l==="min-max"?"lower_whisker_":"min_")+a},{op:"max",field:o,as:(l==="min-max"?"upper_whisker_":"max_")+a}],c=l==="min-max"||l==="tukey"?[]:[{calculate:`${It(`upper_box_${a}`)} - ${It(`lower_box_${a}`)}`,as:`iqr_${a}`},{calculate:`min(${It(`upper_box_${a}`)} + ${It(`iqr_${a}`)} * ${t}, ${It(`max_${a}`)})`,as:`upper_whisker_${a}`},{calculate:`max(${It(`lower_box_${a}`)} - ${It(`iqr_${a}`)} * ${t}, ${It(`min_${a}`)})`,as:`lower_whisker_${a}`}],{[s]:d,...h}=e.encoding,{customTooltipWithoutAggregatedField:p,filteredEncoding:g}=sOe(h),{bins:v,timeUnits:C,aggregate:y,groupby:b,encoding:S}=RX(g,n),x=i==="vertical"?"horizontal":"vertical",E=i,A=[...v,...C,{aggregate:[...y,...u],groupby:b},...c];return{bins:v,timeUnits:C,transform:A,groupby:b,aggregate:y,continuousAxisChannelDef:r,continuousAxis:s,encodingWithoutContinuousAxis:S,ticksOrient:x,boxOrient:E,customTooltipWithoutAggregatedField:p}}const MO="errorbar",uOe=["ticks","rule"],cOe=new Wx(MO,MX);function MX(e,{config:t}){e={...e,encoding:Ux(e.encoding,t)};const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:s,ticksOrient:o,markDef:a,outerSpec:l,tooltipEncoding:u}=IX(e,MO,t);delete s.size;const c=TO(a,r,i,s,t.errorbar),d=a.thickness,h=a.size,p={type:"tick",orient:o,aria:!1,...d!==void 0?{thickness:d}:{},...h!==void 0?{size:h}:{}},g=[...c({partName:"ticks",mark:p,positionPrefix:"lower",extraEncoding:u}),...c({partName:"ticks",mark:p,positionPrefix:"upper",extraEncoding:u}),...c({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar",...d!==void 0?{size:d}:{}},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u})];return{...l,transform:n,...g.length>1?{layer:g}:{...g[0]}}}function dOe(e,t){const{encoding:n}=e;if(hOe(n))return{orient:DX(e,t),inputType:"raw"};const i=fOe(n),r=pOe(n),s=n.x,o=n.y;if(i){if(r)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const a=n.x2,l=n.y2;if(qe(a)&&qe(l))throw new Error(`${t} cannot have both x2 and y2`);if(qe(a)){if(Iu(s))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(qe(l)){if(Iu(o))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const a=n.xError,l=n.xError2,u=n.yError,c=n.yError2;if(qe(l)&&!qe(a))throw new Error(`${t} cannot have xError2 without xError`);if(qe(c)&&!qe(u))throw new Error(`${t} cannot have yError2 without yError`);if(qe(a)&&qe(u))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(qe(a)){if(Iu(s))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(qe(u)){if(Iu(o))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function hOe(e){return(qe(e.x)||qe(e.y))&&!qe(e.x2)&&!qe(e.y2)&&!qe(e.xError)&&!qe(e.xError2)&&!qe(e.yError)&&!qe(e.yError2)}function fOe(e){return qe(e.x2)||qe(e.y2)}function pOe(e){return qe(e.xError)||qe(e.xError2)||qe(e.yError)||qe(e.yError2)}function IX(e,t,n){const{mark:i,encoding:r,params:s,projection:o,...a}=e,l=xa(i)?i:{type:i};s&&ce(RY(t));const{orient:u,inputType:c}=dOe(e,t),{continuousAxisChannelDef:d,continuousAxisChannelDef2:h,continuousAxisChannelDefError:p,continuousAxisChannelDefError2:g,continuousAxis:v}=AX(e,u,t),{errorBarSpecificAggregate:C,postAggregateCalculates:y,tooltipSummary:b,tooltipTitleWithFieldName:S}=gOe(l,d,h,p,g,c,t,n),{[v]:x,[v==="x"?"x2":"y2"]:E,[v==="x"?"xError":"yError"]:A,[v==="x"?"xError2":"yError2"]:F,...k}=r,{bins:P,timeUnits:_,aggregate:O,groupby:H,encoding:W}=RX(k,n),$=[...O,...C],L=c!=="raw"?[]:H,G=Ok(b,d,W,S);return{transform:[...a.transform??[],...P,..._,...$.length===0?[]:[{aggregate:$,groupby:L}],...y],groupby:L,continuousAxisChannelDef:d,continuousAxis:v,encodingWithoutContinuousAxis:W,ticksOrient:u==="vertical"?"horizontal":"vertical",markDef:l,outerSpec:a,tooltipEncoding:G}}function gOe(e,t,n,i,r,s,o,a){let l=[],u=[];const c=t.field;let d,h=!1;if(s==="raw"){const p=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":a.errorbar.center,g=e.extent?e.extent:p==="mean"?"stderr":"iqr";if(p==="median"!=(g==="iqr")&&ce(E2e(p,g,o)),g==="stderr"||g==="stdev")l=[{op:g,field:c,as:`extent_${c}`},{op:p,field:c,as:`center_${c}`}],u=[{calculate:`${It(`center_${c}`)} + ${It(`extent_${c}`)}`,as:`upper_${c}`},{calculate:`${It(`center_${c}`)} - ${It(`extent_${c}`)}`,as:`lower_${c}`}],d=[{fieldPrefix:"center_",titlePrefix:X0(p)},{fieldPrefix:"upper_",titlePrefix:SV(p,g,"+")},{fieldPrefix:"lower_",titlePrefix:SV(p,g,"-")}],h=!0;else{let v,C,y;g==="ci"?(v="mean",C="ci0",y="ci1"):(v="median",C="q1",y="q3"),l=[{op:C,field:c,as:`lower_${c}`},{op:y,field:c,as:`upper_${c}`},{op:v,field:c,as:`center_${c}`}],d=[{fieldPrefix:"upper_",titlePrefix:Af({field:c,aggregate:y,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:Af({field:c,aggregate:C,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:Af({field:c,aggregate:v,type:"quantitative"},a,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&ce(R2e(e.center,e.extent)),s==="aggregated-upper-lower"?(d=[],u=[{calculate:It(n.field),as:`upper_${c}`},{calculate:It(c),as:`lower_${c}`}]):s==="aggregated-error"&&(d=[{fieldPrefix:"",titlePrefix:c}],u=[{calculate:`${It(c)} + ${It(i.field)}`,as:`upper_${c}`}],r?u.push({calculate:`${It(c)} + ${It(r.field)}`,as:`lower_${c}`}):u.push({calculate:`${It(c)} - ${It(i.field)}`,as:`lower_${c}`}));for(const p of u)d.push({fieldPrefix:p.as.substring(0,6),titlePrefix:zd(zd(p.calculate,"datum['",""),"']","")})}return{postAggregateCalculates:u,errorBarSpecificAggregate:l,tooltipSummary:d,tooltipTitleWithFieldName:h}}function SV(e,t,n){return`${X0(e)} ${n} ${t}`}const IO="errorband",mOe=["band","borders"],vOe=new Wx(IO,_X);function _X(e,{config:t}){e={...e,encoding:Ux(e.encoding,t)};const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:s,markDef:o,outerSpec:a,tooltipEncoding:l}=IX(e,IO,t),u=o,c=TO(u,r,i,s,t.errorband),d=e.encoding.x!==void 0&&e.encoding.y!==void 0;let h={type:d?"area":"rect"},p={type:d?"line":"rule"};const g={...u.interpolate?{interpolate:u.interpolate}:{},...u.tension&&u.interpolate?{tension:u.tension}:{}};return d?(h={...h,...g,ariaRoleDescription:"errorband"},p={...p,...g,aria:!1}):u.interpolate?ce(fV("interpolate")):u.tension&&ce(fV("tension")),{...a,transform:n,layer:[...c({partName:"band",mark:h,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l}),...c({partName:"borders",mark:p,positionPrefix:"lower",extraEncoding:l}),...c({partName:"borders",mark:p,positionPrefix:"upper",extraEncoding:l})]}}const OX={};function _O(e,t,n){const i=new Wx(e,t);OX[e]={normalizer:i,parts:n}}function COe(){return oe(OX)}_O(wS,kX,oOe);_O(MO,MX,uOe);_O(IO,_X,mOe);const yOe=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],LX={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},NX={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},wOe=oe(LX),bOe=oe(NX),SOe={header:1,headerRow:1,headerColumn:1,headerFacet:1},$X=oe(SOe),BX=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],xOe={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},ROe={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},Ro="_vgsid_",EOe={point:{on:"click",fields:[Ro],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[pointerdown, window:pointerup] > window:pointermove!",encodings:["x","y"],translate:"[pointerdown, window:pointerup] > window:pointermove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function OO(e){return e==="legend"||!!e?.legend}function CA(e){return OO(e)&&ye(e)}function LO(e){return!!e?.select}function GX(e){const t=[];for(const n of e||[]){if(LO(n))continue;const{expr:i,bind:r,...s}=n;if(r&&i){const o={...s,bind:r,init:i};t.push(o)}else{const o={...s,...i?{update:i}:{},...r?{bind:r}:{}};t.push(o)}}return t}function FOe(e){return jx(e)||$O(e)||NO(e)}function NO(e){return ae(e,"concat")}function jx(e){return ae(e,"vconcat")}function $O(e){return ae(e,"hconcat")}function zX({step:e,offsetIsDiscrete:t}){return t?e.for??"offset":"position"}function Ra(e){return ae(e,"step")}function xV(e){return ae(e,"view")||ae(e,"width")||ae(e,"height")}const RV=20,AOe={align:1,bounds:1,center:1,columns:1,spacing:1},DOe=oe(AOe);function POe(e,t,n){const i=n[t],r={},{spacing:s,columns:o}=i;s!==void 0&&(r.spacing=s),o!==void 0&&(Gx(e)&&!iC(e.facet)||NO(e))&&(r.columns=o),jx(e)&&(r.columns=1);for(const a of DOe)if(e[a]!==void 0)if(a==="spacing"){const l=e[a];r[a]=xt(l)?l:{row:l.row??s,column:l.column??s}}else r[a]=e[a];return r}function Lk(e,t){return e[t]??e[t==="width"?"continuousWidth":"continuousHeight"]}function Nk(e,t){const n=bS(e,t);return Ra(n)?n.step:HX}function bS(e,t){const n=e[t]??e[t==="width"?"discreteWidth":"discreteHeight"];return En(n,{step:e.step})}const HX=20,kOe={continuousWidth:200,continuousHeight:200,step:HX},TOe={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:kOe,mark:S_e,arc:{},area:{},bar:F_e,circle:{},geoshape:{},image:{},line:{},point:{},rect:yO,rule:{color:"black"},square:{},text:{color:"black"},tick:A_e,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:i_e,projection:{},legend:xOe,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:EOe,style:{},title:{},facet:{spacing:RV},concat:{spacing:RV},normalizedNumberFormat:".0%"},el=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],EV={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},FV={blue:el[0],orange:el[1],red:el[2],teal:el[3],green:el[4],yellow:el[5],purple:el[6],pink:el[7],brown:el[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function MOe(e={}){return{signals:[{name:"color",value:ye(e)?{...FV,...e}:FV}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function IOe(e){return{signals:[{name:"fontSize",value:ye(e)?{...EV,...e}:EV}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function _Oe(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function VX(e){const t=oe(e||{}),n={};for(const i of t){const r=e[i];n[i]=aC(r)?vY(r):Wr(r)}return n}function OOe(e){const t=oe(e),n={};for(const i of t)n[i]=VX(e[i]);return n}const LOe=[...JY,...wX,...$X,"background","padding","legend","lineBreak","scale","style","title","view"];function WX(e={}){const{color:t,font:n,fontSize:i,selection:r,...s}=e,o=Mp({},Ue(TOe),n?_Oe(n):{},t?MOe(t):{},i?IOe(i):{},s||{});r&&Ip(o,"selection",r,!0);const a=Er(o,LOe);for(const l of["background","lineBreak","padding"])o[l]&&(a[l]=Wr(o[l]));for(const l of JY)o[l]&&(a[l]=ai(o[l]));for(const l of wX)o[l]&&(a[l]=VX(o[l]));for(const l of $X)o[l]&&(a[l]=ai(o[l]));if(o.legend&&(a.legend=ai(o.legend)),o.scale){const{invalid:l,...u}=o.scale,c=ai(l,{level:1});a.scale={...ai(u),...oe(c).length>0?{invalid:c}:{}}}return o.style&&(a.style=OOe(o.style)),o.title&&(a.title=ai(o.title)),o.view&&(a.view=ai(o.view)),a}const NOe=new Set(["view",...m_e]),$Oe=["color","fontSize","background","padding","facet","concat","numberFormat","numberFormatType","normalizedNumberFormat","normalizedNumberFormatType","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],BOe={view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"],...b_e};function GOe(e){e=Ue(e);for(const t of $Oe)delete e[t];if(e.axis)for(const t in e.axis)aC(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of yOe)delete e.legend[t];if(e.mark){for(const t of gV)delete e.mark[t];e.mark.tooltip&&ye(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(GX(e.params)),delete e.params);for(const t of NOe){for(const i of gV)delete e[t][i];const n=BOe[t];if(n)for(const i of n)delete e[t][i];HOe(e,t)}for(const t of COe())delete e[t];zOe(e);for(const t in e)ye(e[t])&&Nt(e[t])&&delete e[t];return Nt(e)?void 0:e}function zOe(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:i}=mY(e.title);Nt(t)||(e.style["group-title"]={...e.style["group-title"],...t}),Nt(n)||(e.style["group-subtitle"]={...e.style["group-subtitle"],...n}),Nt(i)?delete e.title:e.title=i}function HOe(e,t,n,i){const r=e[t];t==="view"&&(n="cell");const s={...r,...e.style[n??t]};Nt(s)||(e.style[n??t]=s),delete e[t]}function qx(e){return ae(e,"layer")}function VOe(e){return ae(e,"repeat")}function WOe(e){return!te(e.repeat)&&ae(e.repeat,"layer")}class BO{map(t,n){return Gx(t)?this.mapFacet(t,n):VOe(t)?this.mapRepeat(t,n):$O(t)?this.mapHConcat(t,n):jx(t)?this.mapVConcat(t,n):NO(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(qx(t))return this.mapLayer(t,n);if(Xl(t))return this.mapUnit(t,n);throw new Error(eO(t))}mapLayer(t,n){return{...t,layer:t.layer.map(i=>this.mapLayerOrUnit(i,n))}}mapHConcat(t,n){return{...t,hconcat:t.hconcat.map(i=>this.map(i,n))}}mapVConcat(t,n){return{...t,vconcat:t.vconcat.map(i=>this.map(i,n))}}mapConcat(t,n){const{concat:i,...r}=t;return{...r,concat:i.map(s=>this.map(s,n))}}mapFacet(t,n){return{...t,spec:this.map(t.spec,n)}}mapRepeat(t,n){return{...t,spec:this.map(t.spec,n)}}}const UOe={zero:1,center:1,normalize:1};function jOe(e){return Ee(UOe,e)}const qOe=new Set([YY,Lx,Ox,pS,$x,vO,CO,Nx,XY,mO]),KOe=new Set([Lx,Ox,YY]);function Qh(e){return de(e)&&dp(e)==="quantitative"&&!e.bin}function AV(e,t,{orient:n,type:i}){const r=t==="x"?"y":"radius",s=t==="x"&&["bar","area"].includes(i),o=e[t],a=e[r];if(de(o)&&de(a))if(Qh(o)&&Qh(a)){if(o.stack)return t;if(a.stack)return r;const l=de(o)&&!!o.aggregate,u=de(a)&&!!a.aggregate;if(l!==u)return l?t:r;if(s){if(n==="vertical")return r;if(n==="horizontal")return t}}else{if(Qh(o))return t;if(Qh(a))return r}else{if(Qh(o))return s&&n==="vertical"?void 0:t;if(Qh(a))return s&&n==="horizontal"?void 0:r}}function YOe(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function UX(e,t){const n=xa(e)?e:{type:e},i=n.type;if(!qOe.has(i))return null;const r=AV(t,"x",n)||AV(t,"theta",n);if(!r)return null;const s=t[r],o=de(s)?ve(s,{}):void 0,a=YOe(r),l=[],u=new Set;if(t[a]){const v=t[a],C=de(v)?ve(v,{}):void 0;C&&C!==o&&(l.push(a),u.add(C))}const c=a==="x"?"xOffset":"yOffset",d=t[c],h=de(d)?ve(d,{}):void 0;h&&h!==o&&(l.push(c),u.add(h));const p=nIe.reduce((v,C)=>{if(C!=="tooltip"&&Cd(t,C)){const y=t[C];for(const b of we(y)){const S=xo(b);if(S.aggregate)continue;const x=ve(S,{});(!x||!u.has(x))&&v.push({channel:C,fieldDef:S})}}return v},[]);let g;return s.stack!==void 0?uc(s.stack)?g=s.stack?"zero":null:g=s.stack:KOe.has(i)&&(g="zero"),!g||!jOe(g)||xX(t)&&p.length===0?null:(s?.scale?.type&&s?.scale?.type!==li.LINEAR&&s?.stack&&ce(b2e(s.scale.type)),qe(t[Oa(r)])?(s.stack!==void 0&&ce(w2e(r)),null):(de(s)&&s.aggregate&&!gIe.has(s.aggregate)&&ce(S2e(s.aggregate)),{groupbyChannels:l,groupbyFields:u,fieldChannel:r,impute:s.impute===null?!1:Rc(i),stackBy:p,offset:g}))}function jX(e,t,n){const i=ai(e),r=Lt("orient",i,n);if(i.orient=ZOe(i.type,t,r),r!==void 0&&r!==i.orient&&ce(r2e(i.orient,r)),i.type==="bar"&&i.orient){const l=Lt("cornerRadiusEnd",i,n);if(l!==void 0){const u=i.orient==="horizontal"&&t.x2||i.orient==="vertical"&&t.y2?["cornerRadius"]:R_e[i.orient];for(const c of u)i[c]=l;i.cornerRadiusEnd!==void 0&&delete i.cornerRadiusEnd}}const s=Lt("opacity",i,n),o=Lt("fillOpacity",i,n);return s===void 0&&o===void 0&&(i.opacity=QOe(i.type,t)),Lt("cursor",i,n)===void 0&&(i.cursor=XOe(i,t,n)),i}function XOe(e,t,n){return t.href||e.href||Lt("href",e,n)?"pointer":e.cursor}function QOe(e,t){if(at([$x,mO,vO,CO],e)&&!xX(t))return .7}function JOe(e,t,{graticule:n}){if(n)return!1;const i=Sa("filled",e,t),r=e.type;return En(i,r!==$x&&r!==Nx&&r!==pS)}function ZOe(e,t,n){switch(e){case $x:case vO:case CO:case XY:case p_e:case f_e:return}const{x:i,y:r,x2:s,y2:o}=t;switch(e){case Lx:if(de(i)&&(oi(i.bin)||de(r)&&r.aggregate&&!i.aggregate))return"vertical";if(de(r)&&(oi(r.bin)||de(i)&&i.aggregate&&!r.aggregate))return"horizontal";if(o||s){if(n)return n;if(!s)return(de(i)&&i.type===Ud&&!Ut(i.bin)||mS(i))&&de(r)&&oi(r.bin)?"horizontal":"vertical";if(!o)return(de(r)&&r.type===Ud&&!Ut(r.bin)||mS(r))&&de(i)&&oi(i.bin)?"vertical":"horizontal"}case pS:if(s&&!(de(i)&&oi(i.bin))&&o&&!(de(r)&&oi(r.bin)))return;case Ox:if(o)return de(r)&&oi(r.bin)?"horizontal":"vertical";if(s)return de(i)&&oi(i.bin)?"vertical":"horizontal";if(e===pS){if(i&&!r)return"vertical";if(r&&!i)return"horizontal"}case Nx:case mO:{const a=yV(i),l=yV(r);if(n)return n;if(a&&!l)return e!=="tick"?"horizontal":"vertical";if(!a&&l)return e!=="tick"?"vertical":"horizontal";if(a&&l)return"vertical";{const u=or(i)&&i.type===up,c=or(r)&&r.type===up;if(u&&!c)return"vertical";if(!u&&c)return"horizontal"}return}}return"vertical"}function eLe(e){const{point:t,line:n,...i}=e;return oe(i).length>1?i:i.type}function tLe(e){for(const t of["line","area","rule","trail"])e[t]&&(e={...e,[t]:Er(e[t],["point","line"])});return e}function yA(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?ye(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?ye(t.point)?t.point:{}:void 0}function DV(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class nLe{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(Xl(t)){const{mark:i,encoding:r}=t,s=xa(i)?i:{type:i};switch(s.type){case"line":case"rule":case"trail":return!!yA(s,n[s.type],r);case"area":return!!yA(s,n[s.type],r)||!!DV(s,n[s.type])}}return!1}run(t,n,i){const{config:r}=n,{params:s,projection:o,mark:a,name:l,encoding:u,...c}=t,d=Ux(u,r),h=xa(a)?a:{type:a},p=yA(h,r[h.type],d),g=h.type==="area"&&DV(h,r[h.type]),v=[{name:l,...s?{params:s}:{},mark:eLe({...h.type==="area"&&h.opacity===void 0&&h.fillOpacity===void 0?{opacity:.7}:{},...h}),encoding:Er(d,["shape"])}],C=UX(jX(h,d,r),d);let y=d;if(C){const{fieldChannel:b,offset:S}=C;y={...d,[b]:{...d[b],...S?{stack:S}:{}}}}return y=Er(y,["y2","x2"]),g&&v.push({...o?{projection:o}:{},mark:{type:"line",...sp(h,["clip","interpolate","tension","tooltip"]),...g},encoding:y}),p&&v.push({...o?{projection:o}:{},mark:{type:"point",opacity:1,filled:!0,...sp(h,["clip","tooltip"]),...p},encoding:y}),i({...c,layer:v},{...n,config:tLe(r)})}}function iLe(e,t){return t?iC(e)?KX(e,t):qX(e,t):e}function wA(e,t){return t?KX(e,t):e}function $k(e,t,n){const i=t[e];if(B_e(i)){if(i.repeat in n)return{...t,[e]:n[i.repeat]};ce(OIe(i.repeat));return}return t}function qX(e,t){if(e=$k("field",e,t),e!==void 0){if(e===null)return null;if(EO(e)&&bl(e.sort)){const n=$k("field",e.sort,t);e={...e,...n?{sort:n}:{}}}return e}}function PV(e,t){if(de(e))return qX(e,t);{const n=$k("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function kV(e,t){if(qe(e)){const n=PV(e,t);if(n)return n;if(rC(e))return{condition:e.condition}}else{if(sC(e)){const n=PV(e.condition,t);if(n)return{...e,condition:n};{const{condition:i,...r}=e;return r}}return e}}function KX(e,t){const n={};for(const i in e)if(ae(e,i)){const r=e[i];if(te(r))n[i]=r.map(s=>kV(s,t)).filter(s=>s);else{const s=kV(r,t);s!==void 0&&(n[i]=s)}}return n}class rLe{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(Xl(t)){const{encoding:n,mark:i}=t;if(i==="line"||xa(i)&&i.type==="line")for(const r of ZMe){const s=ch(r),o=n[s];if(n[r]&&(de(o)&&!oi(o.bin)||Na(o)))return!0}}return!1}run(t,n,i){const{encoding:r,mark:s}=t;return ce(i2e(!!r.x2,!!r.y2)),i({...t,mark:ye(s)?{...s,type:"rule"}:"rule"},n)}}class sLe extends BO{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[aOe,cOe,vOe,new nLe,new rLe]}map(t,n){if(Xl(t)){const i=Cd(t.encoding,yl),r=Cd(t.encoding,wl),s=Cd(t.encoding,Rx);if(i||r||s)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:i,parentProjection:r}=n,s=wA(t.encoding,n.repeater),o={...t,...t.name?{name:[n.repeaterPrefix,t.name].filter(l=>l).join("_")}:{},...s?{encoding:s}:{}};if(i||r)return this.mapUnitWithParentEncodingOrProjection(o,n);const a=this.mapLayerOrUnit.bind(this);for(const l of this.nonFacetUnitNormalizers)if(l.hasMatchingType(o,n.config))return l.run(o,n,a);return o}mapRepeat(t,n){return WOe(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:i,spec:r,...s}=t,{row:o,column:a,layer:l}=i,{repeater:u={},repeaterPrefix:c=""}=n;return o||a?this.mapRepeat({...t,repeat:{...o?{row:o}:{},...a?{column:a}:{}},spec:{repeat:{layer:l},spec:r}},n):{...s,layer:l.map(d=>{const h={...u,layer:d},p=`${(r.name?`${r.name}_`:"")+c}child__layer_${en(d)}`,g=this.mapLayerOrUnit(r,{...n,repeater:h,repeaterPrefix:p});return g.name=p,g})}}mapNonLayerRepeat(t,n){const{repeat:i,spec:r,data:s,...o}=t;!te(i)&&t.columns&&(t=Er(t,["columns"]),ce(uV("repeat")));const a=[],{repeater:l={},repeaterPrefix:u=""}=n,c=!te(i)&&i.row||[l?l.row:null],d=!te(i)&&i.column||[l?l.column:null],h=te(i)&&i||[l?l.repeat:null];for(const g of h)for(const v of c)for(const C of d){const y={repeat:g,row:v,column:C,layer:l.layer},b=(r.name?`${r.name}_`:"")+u+"child__"+(te(i)?`${en(g)}`:(i.row?`row_${en(v)}`:"")+(i.column?`column_${en(C)}`:"")),S=this.map(r,{...n,repeater:y,repeaterPrefix:b});S.name=b,a.push(Er(S,["data"]))}const p=te(i)?t.columns:i.column?i.column.length:1;return{data:r.data??s,align:"all",...o,columns:p,concat:a}}mapFacet(t,n){const{facet:i}=t;return iC(i)&&t.columns&&(t=Er(t,["columns"]),ce(uV("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:i,projection:r}=t,{parentEncoding:s,parentProjection:o,config:a}=n,l=MV({parentProjection:o,projection:r}),u=TV({parentEncoding:s,encoding:wA(i,n.repeater)});return this.mapUnit({...t,...l?{projection:l}:{},...u?{encoding:u}:{}},{config:a})}mapFacetedUnit(t,n){const{row:i,column:r,facet:s,...o}=t.encoding,{mark:a,width:l,projection:u,height:c,view:d,params:h,encoding:p,...g}=t,{facetMapping:v,layout:C}=this.getFacetMappingAndLayout({row:i,column:r,facet:s},n),y=wA(o,n.repeater);return this.mapFacet({...g,...C,facet:v,spec:{...l?{width:l}:{},...c?{height:c}:{},...d?{view:d}:{},...u?{projection:u}:{},mark:a,encoding:y,...h?{params:h}:{}}},n)}getFacetMappingAndLayout(t,n){const{row:i,column:r,facet:s}=t;if(i||r){s&&ce(t2e([...i?[yl]:[],...r?[wl]:[]]));const o={},a={};for(const l of[yl,wl]){const u=t[l];if(u){const{align:c,center:d,spacing:h,columns:p,...g}=u;o[l]=g;for(const v of["align","center","spacing"])u[v]!==void 0&&(a[v]??(a[v]={}),a[v][l]=u[v])}}return{facetMapping:o,layout:a}}else{const{align:o,center:a,spacing:l,columns:u,...c}=s;return{facetMapping:iLe(c,n.repeater),layout:{...o?{align:o}:{},...a?{center:a}:{},...l?{spacing:l}:{},...u?{columns:u}:{}}}}}mapLayer(t,{parentEncoding:n,parentProjection:i,...r}){const{encoding:s,projection:o,...a}=t,l={...r,parentEncoding:TV({parentEncoding:n,encoding:s,layer:!0}),parentProjection:MV({parentProjection:i,projection:o})};return super.mapLayer({...a,...t.name?{name:[l.repeaterPrefix,t.name].filter(u=>u).join("_")}:{}},l)}}function TV({parentEncoding:e,encoding:t={},layer:n}){let i={};if(e){const r=new Set([...oe(e),...oe(t)]);for(const s of r){const o=t[s],a=e[s];if(qe(o)){const l={...a,...o};i[s]=l}else sC(o)?i[s]={...o,condition:{...a,...o.condition}}:o||o===null?i[s]=o:(n||So(a)||ke(a)||qe(a)||te(a))&&(i[s]=a)}}else i=t;return!i||Nt(i)?void 0:i}function MV(e){const{parentProjection:t,projection:n}=e;return t&&n&&ce(WIe({parentProjection:t,projection:n})),n??t}function GO(e){return ae(e,"filter")}function oLe(e){return ae(e,"stop")}function YX(e){return ae(e,"lookup")}function aLe(e){return ae(e,"data")}function lLe(e){return ae(e,"param")}function uLe(e){return ae(e,"pivot")}function cLe(e){return ae(e,"density")}function dLe(e){return ae(e,"quantile")}function hLe(e){return ae(e,"regression")}function fLe(e){return ae(e,"loess")}function pLe(e){return ae(e,"sample")}function gLe(e){return ae(e,"window")}function mLe(e){return ae(e,"joinaggregate")}function vLe(e){return ae(e,"flatten")}function CLe(e){return ae(e,"calculate")}function XX(e){return ae(e,"bin")}function yLe(e){return ae(e,"impute")}function wLe(e){return ae(e,"timeUnit")}function bLe(e){return ae(e,"aggregate")}function SLe(e){return ae(e,"stack")}function xLe(e){return ae(e,"fold")}function RLe(e){return ae(e,"extent")&&!ae(e,"density")&&!ae(e,"regression")}function ELe(e){return e.map(t=>GO(t)?{filter:Ef(t.filter,X2e)}:t)}class FLe extends BO{map(t,n){return n.emptySelections??(n.emptySelections={}),n.selectionPredicates??(n.selectionPredicates={}),t=IV(t,n),super.map(t,n)}mapLayerOrUnit(t,n){if(t=IV(t,n),t.encoding){const i={};for(const[r,s]of Zu(t.encoding))i[r]=QX(s,n);t={...t,encoding:i}}return super.mapLayerOrUnit(t,n)}mapUnit(t,n){const{selection:i,...r}=t;return i?{...r,params:Zu(i).map(([s,o])=>{const{init:a,bind:l,empty:u,...c}=o;c.type==="single"?(c.type="point",c.toggle=!1):c.type==="multi"&&(c.type="point"),n.emptySelections[s]=u!=="none";for(const d of pi(n.selectionPredicates[s]??{}))d.empty=u!=="none";return{name:s,value:a,select:c,bind:l}})}:t}}function IV(e,t){const{transform:n,...i}=e;if(n){const r=n.map(s=>{if(GO(s))return{filter:Bk(s,t)};if(XX(s)&&dh(s.bin))return{...s,bin:JX(s.bin)};if(YX(s)){const{selection:o,...a}=s.from;return o?{...s,from:{param:o,...a}}:s}return s});return{...i,transform:r}}return e}function QX(e,t){const n=Ue(e);if(de(n)&&dh(n.bin)&&(n.bin=JX(n.bin)),gh(n)&&n.scale?.domain?.selection){const{selection:i,...r}=n.scale.domain;n.scale.domain={...r,...i?{param:i}:{}}}if(rC(n))if(te(n.condition))n.condition=n.condition.map(i=>{const{selection:r,param:s,test:o,...a}=i;return s?i:{...a,test:Bk(i,t)}});else{const{selection:i,param:r,test:s,...o}=QX(n.condition,t);n.condition=r?n.condition:{...o,test:Bk(n.condition,t)}}return n}function JX(e){const t=e.extent;if(t?.selection){const{selection:n,...i}=t;return{...e,extent:{...i,param:n}}}return e}function Bk(e,t){const n=i=>Ef(i,r=>{var s;const o=t.emptySelections[r]??!0,a={param:r,empty:o};return(s=t.selectionPredicates)[r]??(s[r]=[]),t.selectionPredicates[r].push(a),a});return e.selection?n(e.selection):Ef(e.test||e.filter,i=>i.selection?n(i.selection):i)}class Gk extends BO{map(t,n){const i=n.selections??[];if(t.params&&!Xl(t)){const r=[];for(const s of t.params)LO(s)?i.push(s):r.push(s);t.params=r}return n.selections=i,super.map(t,n)}mapUnit(t,n){const i=n.selections;if(!i||!i.length)return t;const r=(n.path??[]).concat(t.name),s=[];for(const o of i)if(!o.views||!o.views.length)s.push(o);else for(const a of o.views)(be(a)&&(a===t.name||r.includes(a))||te(a)&&a.map(l=>r.indexOf(l)).every((l,u,c)=>l!==-1&&(u===0||l>c[u-1])))&&s.push(o);return s.length&&(t.params=s),t}}for(const e of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=Gk.prototype[e];Gk.prototype[e]=function(n,i){return t.call(this,n,ALe(n,i))}}function ALe(e,t){return e.name?{...t,path:(t.path??[]).concat(e.name)}:t}function ZX(e,t){t===void 0&&(t=WX(e.config));const n=TLe(e,t),{width:i,height:r}=e,s=MLe(n,{width:i,height:r,autosize:e.autosize},t);return{...n,...s?{autosize:s}:{}}}const DLe=new sLe,PLe=new FLe,kLe=new Gk;function TLe(e,t={}){const n={config:t};return kLe.map(DLe.map(PLe.map(e,n),n),n)}function _V(e){return be(e)?{type:e}:e??{}}function MLe(e,t,n){let{width:i,height:r}=t;const s=Xl(e)||qx(e),o={};s?i=="container"&&r=="container"?(o.type="fit",o.contains="padding"):i=="container"?(o.type="fit-x",o.contains="padding"):r=="container"&&(o.type="fit-y",o.contains="padding"):(i=="container"&&(ce(sV("width")),i=void 0),r=="container"&&(ce(sV("height")),r=void 0));const a={type:"pad",...o,...n?_V(n.autosize):{},..._V(e.autosize)};if(a.type==="fit"&&!s&&(ce(RIe),a.type="pad"),i=="container"&&!(a.type=="fit"||a.type=="fit-x")&&ce(oV("width")),r=="container"&&!(a.type=="fit"||a.type=="fit-y")&&ce(oV("height")),!qr(a,{type:"pad"}))return a}function ILe(e){return["fit","fit-x","fit-y"].includes(e)}function _Le(e){return e?`fit-${Px(e)}`:"fit"}const OLe=["background","padding"];function OV(e,t){const n={};for(const i of OLe)e&&e[i]!==void 0&&(n[i]=Wr(e[i]));return t&&(n.params=e.params),n}class Ql{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new Ql(Ue(this.explicit),Ue(this.implicit))}combine(){return{...this.explicit,...this.implicit}}get(t){return En(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,{value:n,explicit:i}){n!==void 0&&this.set(t,n,i)}set(t,n,i){return delete this[i?"implicit":"explicit"][t],this[i?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,{explicit:n,implicit:i}){n[t]!==void 0?this.set(t,n[t],!0):i[t]!==void 0&&this.set(t,i[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of oe(t.combine())){const i=t.getWithExplicit(n);this.setWithExplicit(n,i)}}}function ea(e){return{explicit:!0,value:e}}function zr(e){return{explicit:!1,value:e}}function eQ(e){return(t,n,i,r)=>{const s=e(t.value,n.value);return s>0?t:s<0?n:Kx(t,n,i,r)}}function Kx(e,t,n,i){return e.explicit&&t.explicit&&ce(f2e(n,i,e.value,t.value)),e}function nc(e,t,n,i,r=Kx){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:qr(e.value,t.value)?e:r(e,t,n,i)}class LLe extends Ql{constructor(t={},n={},i=!1){super(t,n),this.explicit=t,this.implicit=n,this.parseNothing=i}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function pp(e){return ae(e,"url")}function jv(e){return ae(e,"values")}function tQ(e){return ae(e,"name")&&!pp(e)&&!jv(e)&&!Gu(e)}function Gu(e){return e&&(nQ(e)||iQ(e)||zO(e))}function nQ(e){return ae(e,"sequence")}function iQ(e){return ae(e,"sphere")}function zO(e){return ae(e,"graticule")}var ln;(function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup",e[e.PreFilterInvalid=5]="PreFilterInvalid",e[e.PostFilterInvalid=6]="PostFilterInvalid"})(ln||(ln={}));function rQ({invalid:e,isPath:t}){switch(ZY(e,{isPath:t})){case"filter":return{marks:"exclude-invalid-values",scales:"exclude-invalid-values"};case"break-paths-show-domains":return{marks:t?"include-invalid-values":"exclude-invalid-values",scales:"include-invalid-values"};case"break-paths-filter-domains":return{marks:t?"include-invalid-values":"exclude-invalid-values",scales:"exclude-invalid-values"};case"show":return{marks:"include-invalid-values",scales:"include-invalid-values"}}}function NLe(e){const{marks:t,scales:n}=rQ(e);return t===n?ln.Main:n==="include-invalid-values"?ln.PreFilterInvalid:ln.PostFilterInvalid}class Ot{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.includes(t)){ce(zIe);return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const r of this._children)r.parent=t;this._children=[],t.removeChild(this);const i=t.parent.removeChild(t);this._parent=n,n.addChild(this,i),t.parent=this}}class Fr extends Ot{clone(){const t=new this.constructor;return t.debugName=`clone_${this.debugName}`,t._source=this._source,t._name=`clone_${this._name}`,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}constructor(t,n,i,r){super(t,n),this.type=i,this.refCounts=r,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${eY()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}function bA(e){return e.as!==void 0}function LV(e){return`${e}_end`}class ha extends Ot{clone(){return new ha(null,Ue(this.timeUnits))}constructor(t,n){super(t),this.timeUnits=n}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,s,o)=>{const{field:a,timeUnit:l}=s;if(l){let u;if(ph(l)){if(an(n)){const{mark:c,markDef:d,config:h}=n,p=tc({fieldDef:s,markDef:d,config:h});(Uv(c)||p)&&(u={timeUnit:Zn(l),field:a})}}else u={as:ve(s,{forAs:!0}),field:a,timeUnit:l};if(an(n)){const{mark:c,markDef:d,config:h}=n,p=tc({fieldDef:s,markDef:d,config:h});Uv(c)&&Fn(o)&&p!==.5&&(u.rectBandPosition=p)}u&&(r[ct(u)]=u)}return r},{});return Nt(i)?null:new ha(t,i)}static makeFromTransform(t,n){const{timeUnit:i,...r}={...n},s=Zn(i),o={...r,timeUnit:s};return new ha(t,{[ct(o)]:o})}merge(t){this.timeUnits={...this.timeUnits};for(const n in t.timeUnits)this.timeUnits[n]||(this.timeUnits[n]=t.timeUnits[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}removeFormulas(t){const n={};for(const[i,r]of Zu(this.timeUnits)){const s=bA(r)?r.as:`${r.field}_end`;t.has(s)||(n[i]=r)}this.timeUnits=n}producedFields(){return new Set(pi(this.timeUnits).map(t=>bA(t)?t.as:LV(t.field)))}dependentFields(){return new Set(pi(this.timeUnits).map(t=>t.field))}hash(){return`TimeUnit ${ct(this.timeUnits)}`}assemble(){const t=[];for(const n of pi(this.timeUnits)){const{rectBandPosition:i}=n,r=Zn(n.timeUnit);if(bA(n)){const{field:s,as:o}=n,{unit:a,utc:l,...u}=r,c=[o,`${o}_end`];t.push({field:Ns(s),type:"timeunit",...a?{units:Ix(a)}:{},...l?{timezone:"utc"}:{},...u,as:c}),t.push(...NV(c,i,r))}else if(n){const{field:s}=n,o=s.replaceAll("\\.","."),a=sQ({timeUnit:r,field:o}),l=LV(o);t.push({type:"formula",expr:a,as:l}),t.push(...NV([o,l],i,r))}}return t}}const Yx="offsetted_rect_start",Xx="offsetted_rect_end";function sQ({timeUnit:e,field:t,reverse:n}){const{unit:i,utc:r}=e,s=OY(i),{part:o,step:a}=BY(s,e.step);return`${r?"utcOffset":"timeOffset"}('${o}', ${It(t)}, ${n?-a:a})`}function NV([e,t],n,i){if(n!==void 0&&n!==.5){const r=It(e),s=It(t);return[{type:"formula",expr:$V([sQ({timeUnit:i,field:e,reverse:!0}),r],n+.5),as:`${e}_${Yx}`},{type:"formula",expr:$V([r,s],n+.5),as:`${e}_${Xx}`}]}return[]}function $V([e,t],n){return`${1-n} * ${e} + ${n} * ${t}`}const lC="_tuple_fields";class $Le{constructor(...t){this.items=t,this.hasChannel={},this.hasField={},this.hasSelectionId=!1}}const BLe={defined:()=>!0,parse:(e,t,n)=>{const i=t.name,r=t.project??(t.project=new $Le),s={},o={},a=new Set,l=(g,v)=>{const C=v==="visual"?g.channel:g.field;let y=en(`${i}_${C}`);for(let b=1;a.has(y);b++)y=en(`${i}_${C}_${b}`);return a.add(y),{[v]:y}},u=t.type,c=e.config.selection[u],d=n.value!==void 0?we(n.value):null;let{fields:h,encodings:p}=ye(n.select)?n.select:{};if(!h&&!p&&d){for(const g of d)if(ye(g))for(const v of oe(g))JMe(v)?(p||(p=[])).push(v):u==="interval"?(ce(_Ie),p=c.encodings):(h??(h=[])).push(v)}!h&&!p&&(p=c.encodings,"fields"in c&&(h=c.fields));for(const g of p??[]){const v=e.fieldDef(g);if(v){let C=v.field;if(v.aggregate){ce(EIe(g,v.aggregate));continue}else if(!C){ce(lV(g));continue}if(v.timeUnit&&!ph(v.timeUnit)){C=e.vgField(g);const y={timeUnit:v.timeUnit,as:C,field:v.field};o[ct(y)]=y}if(!s[C]){const y=u==="interval"&&La(g)&&bo(e.getScaleComponent(g).get("type"))?"R":v.bin?"R-RE":"E",b={field:C,channel:g,type:y,index:r.items.length};b.signals={...l(b,"data"),...l(b,"visual")},r.items.push(s[C]=b),r.hasField[C]=s[C],r.hasSelectionId=r.hasSelectionId||C===Ro,oY(g)?(b.geoChannel=g,b.channel=sY(g),r.hasChannel[b.channel]=s[C]):r.hasChannel[g]=s[C]}}else ce(lV(g))}for(const g of h??[]){if(r.hasField[g])continue;const v={type:"E",field:g,index:r.items.length};v.signals={...l(v,"data")},r.items.push(v),r.hasField[g]=v,r.hasSelectionId=r.hasSelectionId||g===Ro}d&&(t.init=d.map(g=>r.items.map(v=>ye(g)?g[v.geoChannel||v.channel]!==void 0?g[v.geoChannel||v.channel]:g[v.field]:g))),Nt(o)||(r.timeUnit=new ha(null,o))},signals:(e,t,n)=>{const i=t.name+lC;return n.filter(s=>s.name===i).length>0||t.project.hasSelectionId?n:n.concat({name:i,value:t.project.items.map(uQ)})}},oQ="_curr",zw="anim_value",sf="anim_clock",zk="eased_anim_clock",aQ="min_extent",lQ="max_range_extent",SA="last_tick_at",xA="is_playing",GLe=1/60*1e3,zLe=(e,t)=>[{name:zk,update:sf},{name:`${e}_domain`,init:`domain('${t}')`},{name:aQ,init:`extent(${e}_domain)[0]`},{name:lQ,init:`extent(range('${t}'))[1]`},{name:zw,update:`invert('${t}', ${zk})`}],HLe={defined:e=>e.type==="point",topLevelSignals:(e,t,n)=>(fa(t)&&(n=n.concat([{name:sf,init:"0",on:[{events:{type:"timer",throttle:GLe},update:`${xA} ? (${sf} + (now() - ${SA}) > ${lQ} ? 0 : ${sf} + (now() - ${SA})) : ${sf}`}]},{name:SA,init:"now()",on:[{events:[{signal:sf},{signal:xA}],update:"now()"}]},{name:xA,init:"true"}])),n),signals:(e,t,n)=>{const i=t.name,r=i+lC,s=t.project,o="(item().isVoronoi ? datum.datum : datum)",a=pi(e.component.selection??{}).reduce((c,d)=>d.type==="interval"?c.concat(d.name+Df):c,[]).map(c=>`indexof(item().mark.name, '${c}') < 0`).join(" && "),l=`datum && item().mark.marktype !== 'group' && indexof(item().mark.role, 'legend') < 0${a?` && ${a}`:""}`;let u=`unit: ${yd(e)}, `;if(t.project.hasSelectionId)u+=`${Ro}: ${o}[${he(Ro)}]`;else if(fa(t))u+=`fields: ${r}, values: [${zw} ? ${zw} : ${aQ}]`;else{const c=s.items.map(d=>e.fieldDef(d.channel)?.bin?`[${o}[${he(e.vgField(d.channel,{}))}], ${o}[${he(e.vgField(d.channel,{binSuffix:"end"}))}]]`:`${o}[${he(d.field)}]`).join(", ");u+=`fields: ${r}, values: [${c}]`}if(fa(t))return n.concat(zLe(t.name,e.scaleName(Cc)),[{name:i+Il,on:[{events:[{signal:zk},{signal:zw}],update:`{${u}}`,force:!0}]}]);{const c=t.events;return n.concat([{name:i+Il,on:c?[{events:c,update:`${l} ? {${u}} : null`,force:!0}]:[]}])}}};function uQ(e){const{signals:t,hasLegend:n,index:i,...r}=e;return r.field=Ns(r.field),r}function Kd(e,t=!0,n=_i){if(te(e)){const i=e.map(r=>Kd(r,t,n));return t?`[${i.join(", ")}]`:i}else if(fh(e))return n(t?Wd(e):$2e(e));return t?n($t(e)):e}function VLe(e,t){for(const n of pi(e.component.selection??{})){const i=n.name;let r=`${i}${Il}, ${n.resolve==="global"?"true":`{unit: ${yd(e)}}`}`;for(const s of Jx)s.defined(n)&&(s.signals&&(t=s.signals(e,n,t)),s.modifyExpr&&(r=s.modifyExpr(e,n,r)));t.push({name:i+mNe,on:[{events:{signal:n.name+Il},update:`modify(${he(n.name+Yd)}, ${r})`}]})}return HO(t)}function WLe(e,t){if(e.component.selection&&oe(e.component.selection).length){const n=he(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:mc("pointermove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return HO(t)}function ULe(e,t){let n=!1;for(const i of pi(e.component.selection??{})){const r=i.name,s=he(r+Yd);if(t.filter(a=>a.name===r).length===0){const a=i.resolve==="global"?"union":i.resolve,l=i.type==="point"?", true, true)":")";t.push({name:i.name,update:`${FQ}(${s}, ${he(a)}${l}`})}n=!0;for(const a of Jx)a.defined(i)&&a.topLevelSignals&&(t=a.topLevelSignals(e,i,t))}return n&&t.filter(r=>r.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"pointermove",update:"isTuple(group()) ? group() : unit"}]}),HO(t)}function jLe(e,t){const n=[],i=[],r=yd(e,{escape:!1});for(const s of pi(e.component.selection??{})){const o={name:s.name+Yd};if(s.project.hasSelectionId&&(o.transform=[{type:"collect",sort:{field:Ro}}]),s.init){const l=s.project.items.map(uQ);o.values=s.project.hasSelectionId?s.init.map(u=>({unit:r,[Ro]:Kd(u,!1)[0]})):s.init.map(u=>({unit:r,fields:l,values:Kd(u,!1)}))}if([...n,...t].filter(l=>l.name===s.name+Yd).length||n.push(o),fa(s)&&t.length){const l=e.lookupDataSource(e.getDataName(ln.Main)),u=t.find(d=>d.name===l),c=u.transform.find(d=>d.type==="filter"&&d.expr.includes("vlSelectionTest"));if(c){u.transform=u.transform.filter(h=>h!==c);const d={name:u.name+oQ,source:u.name,transform:[c]};i.push(d)}}}return n.concat(t,i)}function cQ(e,t){for(const n of pi(e.component.selection??{}))for(const i of Jx)i.defined(n)&&i.marks&&(t=i.marks(e,n,t));return t}function qLe(e,t){for(const n of e.children)an(n)&&(t=cQ(n,t));return t}function KLe(e,t,n,i){const r=TQ(e,t.param,t);return{signal:bo(n.get("type"))&&te(i)&&i[0]>i[1]?`isValid(${r}) && reverse(${r})`:r}}function HO(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}const Sl={defined:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const i of t.project.items){const r=i.channel;if(!La(r))continue;const s=e.getScaleComponent(r),o=s?s.get("type"):void 0;if(o=="sequential"&&ce(PIe),!s||!bo(o)){ce(DIe);continue}s.set("selectionExtent",{param:t.name,field:i.field},!0),n.push(i)}},topLevelSignals:(e,t,n)=>{const i=t.scales.filter(o=>n.filter(a=>a.name===o.signals.data).length===0);if(!e.parent||Vk(e)||i.length===0)return n;const r=n.find(o=>o.name===t.name);let s=r.update;if(s.includes(FQ))r.update=`{${i.map(o=>`${he(Ns(o.field))}: ${o.signals.data}`).join(", ")}}`;else{for(const o of i){const a=`${he(Ns(o.field))}: ${o.signals.data}`;s.includes(a)||(s=`${s.substring(0,s.length-1)}, ${a}}`)}r.update=s}return n.concat(i.map(o=>({name:o.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!Vk(e))for(const i of t.scales){const r=n.find(s=>s.name===i.signals.data);r.push="outer",delete r.value,delete r.update}return n}};function Hk(e,t){return`domain(${he(e.scaleName(t))})`}function Vk(e){return e.parent&&ng(e.parent)&&(!e.parent.parent||Vk(e.parent.parent))}const Df="_brush",dQ="_scale_trigger",sm="geo_interval_init_tick",hQ="_init",YLe="_center",XLe={defined:e=>e.type==="interval",parse:(e,t,n)=>{var i;if(e.hasProjection){const r={...ye(n.select)?n.select:{}};r.fields=[Ro],r.encodings||(r.encodings=n.value?oe(n.value):[Lo,Oo]),n.select={type:"interval",...r}}if(t.translate&&!Sl.defined(t)){const r=`!event.item || event.item.mark.name !== ${he(t.name+Df)}`;for(const s of t.events){if(!s.between){ce(`${s} is not an ordered event stream for interval selections.`);continue}const o=we((i=s.between[0]).filter??(i.filter=[]));o.includes(r)||o.push(r)}}},signals:(e,t,n)=>{const i=t.name,r=i+Il,s=pi(t.project.hasChannel).filter(a=>a.channel===tn||a.channel===ni),o=t.init?t.init[0]:null;if(n.push(...s.reduce((a,l)=>a.concat(QLe(e,t,l,o&&o[l.index])),[])),e.hasProjection){const a=he(e.projectionName()),l=e.projectionName()+YLe,{x:u,y:c}=t.project.hasChannel,d=u&&u.signals.visual,h=c&&c.signals.visual,p=u?o&&o[u.index]:`${l}[0]`,g=c?o&&o[c.index]:`${l}[1]`,v=E=>e.getSizeSignalRef(E).signal,C=`[[${d?d+"[0]":"0"}, ${h?h+"[0]":"0"}],[${d?d+"[1]":v("width")}, ${h?h+"[1]":v("height")}]]`;o&&(n.unshift({name:i+hQ,init:`[scale(${a}, [${u?p[0]:p}, ${c?g[0]:g}]), scale(${a}, [${u?p[1]:p}, ${c?g[1]:g}])]`}),(!u||!c)&&(n.find(A=>A.name===l)||n.unshift({name:l,update:`invert(${a}, [${v("width")}/2, ${v("height")}/2])`})));const y=`intersect(${C}, {markname: ${he(e.getName("marks"))}}, unit.mark)`,b=`{unit: ${yd(e)}}`,S=`vlSelectionTuples(${y}, ${b})`,x=s.map(E=>E.signals.visual);return n.concat({name:r,on:[{events:[...x.length?[{signal:x.join(" || ")}]:[],...o?[{signal:sm}]:[]],update:S}]})}else{if(!Sl.defined(t)){const u=i+dQ,c=s.map(d=>{const h=d.channel,{data:p,visual:g}=d.signals,v=he(e.scaleName(h)),C=e.getScaleComponent(h).get("type"),y=bo(C)?"+":"";return`(!isArray(${p}) || (${y}invert(${v}, ${g})[0] === ${y}${p}[0] && ${y}invert(${v}, ${g})[1] === ${y}${p}[1]))`});c.length&&n.push({name:u,value:{},on:[{events:s.map(d=>({scale:e.scaleName(d.channel)})),update:c.join(" && ")+` ? ${u} : {}`}]})}const a=s.map(u=>u.signals.data),l=`unit: ${yd(e)}, fields: ${i+lC}, values`;return n.concat({name:r,...o?{init:`{${l}: ${Kd(o)}}`}:{},...a.length?{on:[{events:[{signal:a.join(" || ")}],update:`${a.join(" && ")} ? {${l}: [${a}]} : null`}]}:{}})}},topLevelSignals:(e,t,n)=>(an(e)&&e.hasProjection&&t.init&&(n.filter(r=>r.name===sm).length||n.unshift({name:sm,value:null,on:[{events:"timer{1}",update:`${sm} === null ? {} : ${sm}`}]})),n),marks:(e,t,n)=>{const i=t.name,{x:r,y:s}=t.project.hasChannel,o=r?.signals.visual,a=s?.signals.visual,l=`data(${he(t.name+Yd)})`;if(Sl.defined(t)||!r&&!s)return n;const u={x:r!==void 0?{signal:`${o}[0]`}:{value:0},y:s!==void 0?{signal:`${a}[0]`}:{value:0},x2:r!==void 0?{signal:`${o}[1]`}:{field:{group:"width"}},y2:s!==void 0?{signal:`${a}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const C of oe(u))u[C]=[{test:`${l}.length && ${l}[0].unit === ${yd(e)}`,...u[C]},{value:0}];const{fill:c,fillOpacity:d,cursor:h,...p}=t.mark,g=oe(p).reduce((C,y)=>(C[y]=[{test:[r!==void 0&&`${o}[0] !== ${o}[1]`,s!==void 0&&`${a}[0] !== ${a}[1]`].filter(b=>b).join(" && "),value:p[y]},{value:null}],C),{}),v=h??(t.translate?"move":null);return[{name:`${i+Df}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:c},fillOpacity:{value:d}},update:u}},...n,{name:i+Df,type:"rect",clip:!0,encode:{enter:{...v?{cursor:{value:v}}:{},fill:{value:"transparent"}},update:{...u,...g}}}]}};function QLe(e,t,n,i){const r=!e.hasProjection,s=n.channel,o=n.signals.visual,a=he(r?e.scaleName(s):e.projectionName()),l=h=>`scale(${a}, ${h})`,u=e.getSizeSignalRef(s===tn?"width":"height").signal,c=`${s}(unit)`,d=t.events.reduce((h,p)=>[...h,{events:p.between[0],update:`[${c}, ${c}]`},{events:p,update:`[${o}[0], clamp(${c}, 0, ${u})]`}],[]);if(r){const h=n.signals.data,p=Sl.defined(t),g=e.getScaleComponent(s),v=g?g.get("type"):void 0,C=i?{init:Kd(i,!0,l)}:{value:[]};return d.push({events:{signal:t.name+dQ},update:bo(v)?`[${l(`${h}[0]`)}, ${l(`${h}[1]`)}]`:"[0, 0]"}),p?[{name:h,on:[]}]:[{name:o,...C,on:d},{name:h,...i?{init:Kd(i)}:{},on:[{events:{signal:o},update:`${o}[0] === ${o}[1] ? null : invert(${a}, ${o})`}]}]}else{const h=s===tn?0:1,p=t.name+hQ,g=i?{init:`[${p}[0][${h}], ${p}[1][${h}]]`}:{value:[]};return[{name:o,...g,on:d}]}}function Jp({model:e,channelDef:t,vgChannel:n,invalidValueRef:i,mainRefFn:r}){const s=rC(t)&&t.condition;let o=[];s&&(o=we(s).map(u=>{const c=r(u);if($_e(u)){const{param:d,empty:h}=u;return{test:kQ(e,{param:d,empty:h}),...c}}else return{test:RS(e,u.test),...c}})),i!==void 0&&o.push(i);const a=r(t);return a!==void 0&&o.push(a),o.length>1||o.length===1&&o[0].test?{[n]:o}:o.length===1?{[n]:o[0]}:{}}function VO(e,t="text"){const n=e.encoding[t];return Jp({model:e,channelDef:n,vgChannel:t,mainRefFn:i=>Qx(i,e.config),invalidValueRef:void 0})}function Qx(e,t,n="datum"){if(e){if(So(e))return Kt(e.value);if(qe(e)){const{format:i,formatType:r}=CS(e);return xO({fieldOrDatumDef:e,format:i,formatType:r,expr:n,config:t})}}}function fQ(e,t={}){const{encoding:n,markDef:i,config:r,stack:s}=e,o=n.tooltip;if(te(o))return{tooltip:BV({tooltip:o},s,r,t)};{const a=t.reactiveGeom?"datum.datum":"datum";return Jp({model:e,channelDef:o,vgChannel:"tooltip",mainRefFn:u=>{const c=Qx(u,r,a);if(c)return c;if(u===null)return;let d=Lt("tooltip",i,r);if(d===!0&&(d={content:"encoding"}),be(d))return{value:d};if(ye(d))return ke(d)?d:d.content==="encoding"?BV(n,s,r,t):{signal:a}},invalidValueRef:void 0})}}function pQ(e,t,n,{reactiveGeom:i}={}){const r={...n,...n.tooltipFormat},s=new Set,o=i?"datum.datum":"datum",a=[];function l(c,d){const h=ch(d),p=or(c)?c:{...c,type:e[h].type},g=p.title||AO(p,r),v=we(g).join(", ").replaceAll(/"/g,'\\"');let C;if(Fn(d)){const y=d==="x"?"x2":"y2",b=xo(e[y]);if(oi(p.bin)&&b){const S=ve(p,{expr:o}),x=ve(b,{expr:o}),{format:E,formatType:A}=CS(p);C=nC(S,x,E,A,r),s.add(y)}}if((Fn(d)||d===zs||d===_o)&&t&&t.fieldChannel===d&&t.offset==="normalize"){const{format:y,formatType:b}=CS(p);C=xO({fieldOrDatumDef:p,format:y,formatType:b,expr:o,config:r,normalizeStack:!0}).signal}C??(C=Qx(p,r,o).signal),a.push({channel:d,key:v,value:C})}PO(e,(c,d)=>{de(c)?l(c,d):zx(c)&&l(c.condition,d)});const u={};for(const{channel:c,key:d,value:h}of a)!s.has(c)&&!u[d]&&(u[d]=h);return u}function BV(e,t,n,{reactiveGeom:i}={}){const r=pQ(e,t,n,{reactiveGeom:i}),s=Zu(r).map(([o,a])=>`"${o}": ${a}`);return s.length>0?{signal:`{${s.join(", ")}}`}:void 0}function JLe(e){const{markDef:t,config:n}=e,i=Lt("aria",t,n);return i===!1?{}:{...i?{aria:i}:{},...ZLe(e),...eNe(e)}}function ZLe(e){const{mark:t,markDef:n,config:i}=e;if(i.aria===!1)return{};const r=Lt("ariaRoleDescription",n,i);return r!=null?{ariaRoleDescription:{value:r}}:Ee(bIe,t)?{}:{ariaRoleDescription:{value:t}}}function eNe(e){const{encoding:t,markDef:n,config:i,stack:r}=e,s=t.description;if(s)return Jp({model:e,channelDef:s,vgChannel:"description",mainRefFn:l=>Qx(l,e.config),invalidValueRef:void 0});const o=Lt("description",n,i);if(o!=null)return{description:Kt(o)};if(i.aria===!1)return{};const a=pQ(t,r,i);if(!Nt(a))return{description:{signal:Zu(a).map(([l,u],c)=>`"${c>0?"; ":""}${l}: " + (${u})`).join(" + ")}}}function ui(e,t,n={}){const{markDef:i,encoding:r,config:s}=t,{vgChannel:o}=n;let{defaultRef:a,defaultValue:l}=n;const u=r[e];a===void 0&&(l??(l=Lt(e,i,s,{vgChannel:o,ignoreVgConfig:!rC(u)})),l!==void 0&&(a=Kt(l)));const c={markDef:i,config:s,scaleName:t.scaleName(e),scale:t.getScaleComponent(e)},d=tX({...c,scaleChannel:e,channelDef:u});return Jp({model:t,channelDef:u,vgChannel:o??e,invalidValueRef:d,mainRefFn:p=>SO({...c,channel:e,channelDef:p,stack:null,defaultRef:a})})}function gQ(e,t={filled:void 0}){const{markDef:n,encoding:i,config:r}=e,{type:s}=n,o=t.filled??Lt("filled",n,r),a=at(["bar","point","circle","square","geoshape"],s)?"transparent":void 0,l=Lt(o===!0?"color":void 0,n,r,{vgChannel:"fill"})??r.mark[o===!0&&"color"]??a,u=Lt(o===!1?"color":void 0,n,r,{vgChannel:"stroke"})??r.mark[o===!1&&"color"],c=o?"fill":"stroke",d={...l?{fill:Kt(l)}:{},...u?{stroke:Kt(u)}:{}};return n.color&&(o?n.fill:n.stroke)&&ce(FY("property",{fill:"fill"in n,stroke:"stroke"in n})),{...d,...ui("color",e,{vgChannel:c,defaultValue:o?l:u}),...ui("fill",e,{defaultValue:i.fill?l:void 0}),...ui("stroke",e,{defaultValue:i.stroke?u:void 0})}}function tNe(e){const{encoding:t,mark:n}=e,i=t.order;return!Rc(n)&&So(i)?Jp({model:e,channelDef:i,vgChannel:"zindex",mainRefFn:r=>Kt(r.value),invalidValueRef:void 0}):{}}function gp({channel:e,markDef:t,encoding:n={},model:i,bandPosition:r}){const s=`${e}Offset`,o=t[s],a=n[s];if((s==="xOffset"||s==="yOffset")&&a)return{offsetType:"encoding",offset:SO({channel:s,channelDef:a,markDef:t,config:i?.config,scaleName:i.scaleName(s),scale:i.getScaleComponent(s),stack:null,defaultRef:Kt(o),bandPosition:r})};const l=t[s];return l?{offsetType:"visual",offset:l}:{}}function er(e,t,{defaultPos:n,vgChannel:i}){const{encoding:r,markDef:s,config:o,stack:a}=t,l=r[e],u=r[Oa(e)],c=t.scaleName(e),d=t.getScaleComponent(e),{offset:h,offsetType:p}=gp({channel:e,markDef:s,encoding:r,model:t,bandPosition:.5}),g=WO({model:t,defaultPos:n,channel:e,scaleName:c,scale:d}),v=!l&&Fn(e)&&(r.latitude||r.longitude)?{field:t.getName(e)}:nNe({channel:e,channelDef:l,channel2Def:u,markDef:s,config:o,scaleName:c,scale:d,stack:a,offset:h,defaultRef:g,bandPosition:p==="encoding"?0:void 0});return v?{[i||e]:v}:void 0}function nNe(e){const{channel:t,channelDef:n,scaleName:i,stack:r,offset:s,markDef:o}=e;if(qe(n)&&r&&t===r.fieldChannel){if(de(n)){let a=n.bandPosition;if(a===void 0&&o.type==="text"&&(t==="radius"||t==="theta")&&(a=.5),a!==void 0)return gS({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",bandPosition:a,offset:s})}return vd(n,i,{suffix:"end"},{offset:s})}return bO(e)}function WO({model:e,defaultPos:t,channel:n,scaleName:i,scale:r}){const{markDef:s,config:o}=e;return()=>{const a=ch(n),l=ec(n),u=Lt(n,s,o,{vgChannel:l});if(u!==void 0)return rv(n,u);switch(t){case"zeroOrMin":return GV({scaleName:i,scale:r,mode:"zeroOrMin",mainChannel:a,config:o});case"zeroOrMax":return GV({scaleName:i,scale:r,mode:{zeroOrMax:{widthSignal:e.width.signal,heightSignal:e.height.signal}},mainChannel:a,config:o});case"mid":return{...e[Mr(n)],mult:.5}}}}function GV({mainChannel:e,config:t,...n}){const i=eX(n),{mode:r}=n;if(i)return i;switch(e){case"radius":{if(r==="zeroOrMin")return{value:0};const{widthSignal:s,heightSignal:o}=r.zeroOrMax;return{signal:`min(${s},${o})/2`}}case"theta":return r==="zeroOrMin"?{value:0}:{signal:"2*PI"};case"x":return r==="zeroOrMin"?{value:0}:{field:{group:"width"}};case"y":return r==="zeroOrMin"?{field:{group:"height"}}:{value:0}}}const iNe={left:"x",center:"xc",right:"x2"},rNe={top:"y",middle:"yc",bottom:"y2"};function mQ(e,t,n,i="middle"){if(e==="radius"||e==="theta")return ec(e);const r=e==="x"?"align":"baseline",s=Lt(r,t,n);let o;return ke(s)?(ce(n2e(r)),o=void 0):o=s,e==="x"?iNe[o||(i==="top"?"left":"center")]:rNe[o||i]}function SS(e,t,{defaultPos:n,defaultPos2:i,range:r}){return r?vQ(e,t,{defaultPos:n,defaultPos2:i}):er(e,t,{defaultPos:n})}function vQ(e,t,{defaultPos:n,defaultPos2:i}){const{markDef:r,config:s}=t,o=Oa(e),a=Mr(e),l=sNe(t,i,o),u=l[a]?mQ(e,r,s):ec(e);return{...er(e,t,{defaultPos:n,vgChannel:u}),...l}}function sNe(e,t,n){const{encoding:i,mark:r,markDef:s,stack:o,config:a}=e,l=ch(n),u=Mr(n),c=ec(n),d=i[l],h=e.scaleName(l),p=e.getScaleComponent(l),{offset:g}=n in i||n in s?gp({channel:n,markDef:s,encoding:i,model:e}):gp({channel:l,markDef:s,encoding:i,model:e});if(!d&&(n==="x2"||n==="y2")&&(i.latitude||i.longitude)){const C=Mr(n),y=e.markDef[C];return y!=null?{[C]:{value:y}}:{[c]:{field:e.getName(n)}}}const v=oNe({channel:n,channelDef:d,channel2Def:i[n],markDef:s,config:a,scaleName:h,scale:p,stack:o,offset:g,defaultRef:void 0});return v!==void 0?{[c]:v}:Uy(n,s)||Uy(n,{[n]:kk(n,s,a.style),[u]:kk(u,s,a.style)})||Uy(n,a[r])||Uy(n,a.mark)||{[c]:WO({model:e,defaultPos:t,channel:n,scaleName:h,scale:p})()}}function oNe({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:s,scale:o,stack:a,offset:l,defaultRef:u}){return qe(t)&&a&&e.charAt(0)===a.fieldChannel.charAt(0)?vd(t,s,{suffix:"start"},{offset:l}):bO({channel:e,channelDef:n,scaleName:s,scale:o,stack:a,markDef:i,config:r,offset:l,defaultRef:u})}function Uy(e,t){const n=Mr(e),i=ec(e);if(t[i]!==void 0)return{[i]:rv(e,t[i])};if(t[e]!==void 0)return{[i]:rv(e,t[e])};if(t[n]){const r=t[n];if(jd(r))ce(XIe(n));else return{[n]:rv(e,r)}}}function Ml(e,t){const{config:n,encoding:i,markDef:r}=e,s=r.type,o=Oa(t),a=Mr(t),l=i[t],u=i[o],c=e.getScaleComponent(t),d=c?c.get("type"):void 0,h=r.orient,p=i[a]??i.size??Lt("size",r,n,{vgChannel:a}),g=cY(t),v=s==="bar"&&(t==="x"?h==="vertical":h==="horizontal")||s==="tick"&&(t==="y"?h==="vertical":h==="horizontal");return de(l)&&(Ut(l.bin)||oi(l.bin)||l.timeUnit&&!u)&&!(p&&!jd(p))&&!i[g]&&!ei(d)?uNe({fieldDef:l,fieldDef2:u,channel:t,model:e}):(qe(l)&&ei(d)||v)&&!u?lNe(l,t,e):vQ(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function aNe(e,t,n,i,r,s,o){if(jd(r))if(n){const l=n.get("type");if(l==="band"){let u=`bandwidth('${t}')`;r.band!==1&&(u=`${r.band} * ${u}`);const c=Sa("minBandSize",{type:o},i);return{signal:c?`max(${co(c)}, ${u})`:u}}else r.band!==1&&(ce(o2e(l)),r=void 0)}else return{mult:r.band,field:{group:e}};else{if(ke(r))return r;if(r)return{value:r}}if(n){const l=n.get("range");if(hh(l)&&xt(l.step))return{value:l.step-2}}if(!s){const{bandPaddingInner:l,barBandPaddingInner:u,rectBandPaddingInner:c,tickBandPaddingInner:d}=i.scale,h=En(l,o==="tick"?d:o==="bar"?u:c);if(ke(h))return{signal:`(1 - (${h.signal})) * ${e}`};if(xt(h))return{signal:`${1-h} * ${e}`}}return{value:Nk(i.view,e)-2}}function lNe(e,t,n){const{markDef:i,encoding:r,config:s,stack:o}=n,a=i.orient,l=n.scaleName(t),u=n.getScaleComponent(t),c=Mr(t),d=Oa(t),h=cY(t),p=n.scaleName(h),g=n.getScaleComponent(K_(t)),v=i.type==="tick"||a==="horizontal"&&t==="y"||a==="vertical"&&t==="x";let C;(r.size||i.size)&&(v?C=ui("size",n,{vgChannel:c,defaultRef:Kt(i.size)}):ce(c2e(i.type)));const y=!!C,b=lX({channel:t,fieldDef:e,markDef:i,config:s,scaleType:(u||g)?.get("type"),useVlSizeChannel:v});C=C||{[c]:aNe(c,p||l,g||u,s,b,!!e,i.type)};const S=(u||g)?.get("type")==="band"&&jd(b)&&!y?"top":"middle",x=mQ(t,i,s,S),E=x==="xc"||x==="yc",{offset:A,offsetType:F}=gp({channel:t,markDef:i,encoding:r,model:n,bandPosition:E?.5:0}),k=bO({channel:t,channelDef:e,markDef:i,config:s,scaleName:l,scale:u,stack:o,offset:A,defaultRef:WO({model:n,defaultPos:"mid",channel:t,scaleName:l,scale:u}),bandPosition:E?F==="encoding"?0:.5:ke(b)?{signal:`(1-${b})/2`}:jd(b)?(1-b.band)/2:0});if(c)return{[x]:k,...C};{const P=ec(d),_=C[c],O=A?{..._,offset:A}:_;return{[x]:k,[P]:te(k)?[k[0],{...k[1],offset:O}]:{...k,offset:O}}}}function zV(e,t,n,i,r,s,o){if(rY(e))return 0;const a=e==="x"||e==="y2",l=a?-t/2:t/2;if(ke(n)||ke(r)||ke(i)||s){const u=co(n),c=co(r),d=co(i),h=co(s),g=s?`(${o} < ${h} ? ${a?"":"-"}0.5 * (${h} - (${o})) : ${l})`:l,v=d?`${d} + `:"",C=u?`(${u} ? -1 : 1) * `:"",y=c?`(${c} + ${g})`:g;return{signal:v+C+y}}else return r=r||0,i+(n?-r-l:+r+l)}function uNe({fieldDef:e,fieldDef2:t,channel:n,model:i}){const{config:r,markDef:s,encoding:o}=i,a=i.getScaleComponent(n),l=i.scaleName(n),u=a?a.get("type"):void 0,c=a.get("reverse"),d=lX({channel:n,fieldDef:e,markDef:s,config:r,scaleType:u}),p=i.component.axes[n]?.[0]?.get("translate")??.5,g=Fn(n)?Lt("binSpacing",s,r)??0:0,v=Oa(n),C=ec(n),y=ec(v),b=Sa("minBandSize",s,r),{offset:S}=gp({channel:n,markDef:s,encoding:o,model:i,bandPosition:0}),{offset:x}=gp({channel:v,markDef:s,encoding:o,model:i,bandPosition:0}),E=M_e({fieldDef:e,scaleName:l}),A=zV(n,g,c,p,S,b,E),F=zV(v,g,c,p,x??S,b,E),k=ke(d)?{signal:`(1-${d.signal})/2`}:jd(d)?(1-d.band)/2:.5,P=tc({fieldDef:e,fieldDef2:t,markDef:s,config:r});if(Ut(e.bin)||e.timeUnit){const _=e.timeUnit&&P!==.5;return{[y]:HV({fieldDef:e,scaleName:l,bandPosition:k,offset:F,useRectOffsetField:_}),[C]:HV({fieldDef:e,scaleName:l,bandPosition:ke(k)?{signal:`1-${k.signal}`}:1-k,offset:A,useRectOffsetField:_})}}else if(oi(e.bin)){const _=vd(e,l,{},{offset:F});if(de(t))return{[y]:_,[C]:vd(t,l,{},{offset:A})};if(dh(e.bin)&&e.bin.step)return{[y]:_,[C]:{signal:`scale("${l}", ${ve(e,{expr:"datum"})} + ${e.bin.step})`,offset:A}}}ce(PY(v))}function HV({fieldDef:e,scaleName:t,bandPosition:n,offset:i,useRectOffsetField:r}){return gS({scaleName:t,fieldOrDatumDef:e,bandPosition:n,offset:i,...r?{startSuffix:Yx,endSuffix:Xx}:{}})}const cNe=new Set(["aria","width","height"]);function Hs(e,t){const{fill:n=void 0,stroke:i=void 0}=t.color==="include"?gQ(e):{};return{...dNe(e.markDef,t),...VV("fill",n),...VV("stroke",i),...ui("opacity",e),...ui("fillOpacity",e),...ui("strokeOpacity",e),...ui("strokeWidth",e),...ui("strokeDash",e),...tNe(e),...fQ(e),...VO(e,"href"),...JLe(e)}}function VV(e,t){return t?{[e]:t}:{}}function dNe(e,t){return wIe.reduce((n,i)=>(!cNe.has(i)&&ae(e,i)&&t[i]!=="ignore"&&(n[i]=Kt(e[i])),n),{})}function UO(e){const{config:t,markDef:n}=e,i=new Set;if(e.forEachFieldDef((r,s)=>{let o;if(!La(s)||!(o=e.getScaleType(s)))return;const a=kx(r.aggregate),l=wO({scaleChannel:s,markDef:n,config:t,scaleType:o,isCountAggregate:a});if(P_e(l)){const u=e.vgField(s,{expr:"datum",binSuffix:e.stack?.impute?"mid":void 0});u&&i.add(u)}}),i.size>0)return{defined:{signal:[...i].map(s=>_x(s,!0)).join(" && ")}}}function WV(e,t){if(t!==void 0)return{[e]:Kt(t)}}const RA="voronoi",CQ={defined:e=>e.type==="point"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(RA)},marks:(e,t,n)=>{const{x:i,y:r}=t.project.hasChannel,s=e.mark;if(Rc(s))return ce(FIe(s)),n;const o={name:e.getName(RA),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0},...fQ(e,{reactiveGeom:!0})}},transform:[{type:"voronoi",x:{expr:i||!r?"datum.datum.x || 0":"0"},y:{expr:r||!i?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let a=0,l=!1;return n.forEach((u,c)=>{const d=u.name??"";d===e.component.mark[0].name?a=c:d.includes(RA)&&(l=!0)}),l||n.splice(a+1,0,o),n}},yQ={defined:e=>e.type==="point"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!OO(e.bind),parse:(e,t,n)=>AQ(t,n),topLevelSignals:(e,t,n)=>{const i=t.name,r=t.project,s=t.bind,o=t.init&&t.init[0],a=CQ.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return r.items.forEach((l,u)=>{const c=en(`${i}_${l.field}`);n.filter(h=>h.name===c).length||n.unshift({name:c,...o?{init:Kd(o[u])}:{value:null},on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${a}[${he(l.field)}] : null`}]:[],bind:s[l.field]??s[l.channel]??s})}),n},signals:(e,t,n)=>{const i=t.name,r=t.project,s=n.find(u=>u.name===i+Il),o=i+lC,a=r.items.map(u=>en(`${i}_${u.field}`)),l=a.map(u=>`${u} !== null`).join(" && ");return a.length&&(s.update=`${l} ? {fields: ${o}, values: [${a.join(", ")}]} : null`),delete s.value,delete s.on,n}},xS="_toggle",wQ={defined:e=>e.type==="point"&&!fa(e)&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+xS,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+Il,i=t.name+xS;return`${i} ? null : ${n}, `+(t.resolve==="global"?`${i} ? null : true, `:`${i} ? null : {unit: ${yd(e)}}, `)+`${i} ? ${n} : null`}},hNe={defined:e=>e.clear!==void 0&&e.clear!==!1&&!fa(e),parse:(e,t)=>{t.clear&&(t.clear=be(t.clear)?mc(t.clear,"view"):t.clear)},topLevelSignals:(e,t,n)=>{if(yQ.defined(t))for(const i of t.project.items){const r=n.findIndex(s=>s.name===en(`${t.name}_${i.field}`));r!==-1&&n[r].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function i(r,s){r!==-1&&n[r].on&&n[r].on.push({events:t.clear,update:s})}if(t.type==="interval")for(const r of t.project.items){const s=n.findIndex(o=>o.name===r.signals.visual);if(i(s,"[0, 0]"),s===-1){const o=n.findIndex(a=>a.name===r.signals.data);i(o,"null")}}else{let r=n.findIndex(s=>s.name===t.name+Il);i(r,"null"),wQ.defined(t)&&(r=n.findIndex(s=>s.name===t.name+xS),i(r,"false"))}return n}},bQ={defined:e=>{const t=e.resolve==="global"&&e.bind&&OO(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==Ro;return t&&!n&&ce(kIe),t&&n},parse:(e,t,n)=>{const i=Ue(n);if(i.select=be(i.select)?{type:i.select,toggle:t.toggle}:{...i.select,toggle:t.toggle},AQ(t,i),ye(n.select)&&(n.select.on||n.select.clear)){const o='event.item && indexof(event.item.mark.role, "legend") < 0';for(const a of t.events)a.filter=we(a.filter??[]),a.filter.includes(o)||a.filter.push(o)}const r=CA(t.bind)?t.bind.legend:"click",s=be(r)?mc(r,"view"):we(r);t.bind={legend:{merge:s}}},topLevelSignals:(e,t,n)=>{const i=t.name,r=CA(t.bind)&&t.bind.legend,s=o=>a=>{const l=Ue(a);return l.markname=o,l};for(const o of t.project.items){if(!o.hasLegend)continue;const a=`${en(o.field)}_legend`,l=`${i}_${a}`;if(n.filter(c=>c.name===l).length===0){const c=r.merge.map(s(`${a}_symbols`)).concat(r.merge.map(s(`${a}_labels`))).concat(r.merge.map(s(`${a}_entries`)));n.unshift({name:l,...t.init?{}:{value:null},on:[{events:c,update:"isDefined(datum.value) ? datum.value : item().items[0].items[0].datum.value",force:!0},{events:r.merge,update:`!event.item || !datum ? null : ${l}`,force:!0}]})}}return n},signals:(e,t,n)=>{const i=t.name,r=t.project,s=n.find(h=>h.name===i+Il),o=i+lC,a=r.items.filter(h=>h.hasLegend).map(h=>en(`${i}_${en(h.field)}_legend`)),u=`${a.map(h=>`${h} !== null`).join(" && ")} ? {fields: ${o}, values: [${a.join(", ")}]} : null`;t.events&&a.length>0?s.on.push({events:a.map(h=>({signal:h})),update:u}):a.length>0&&(s.update=u,delete s.value,delete s.on);const c=n.find(h=>h.name===i+xS),d=CA(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push({...c.on[0],events:d}):c.on[0].events=d),n}};function fNe(e,t,n){const i=e.fieldDef(t)?.field;for(const r of pi(e.component.selection??{})){const s=r.project.hasField[i]??r.project.hasChannel[t];if(s&&bQ.defined(r)){const o=n.get("selections")??[];o.push(r.name),n.set("selections",o,!1),s.hasLegend=!0}}}const SQ="_translate_anchor",xQ="_translate_delta",pNe={defined:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const i=t.name,r=Sl.defined(t),s=i+SQ,{x:o,y:a}=t.project.hasChannel;let l=mc(t.translate,"scope");return r||(l=l.map(u=>(u.between[0].markname=i+Df,u))),n.push({name:s,value:{},on:[{events:l.map(u=>u.between[0]),update:"{x: x(unit), y: y(unit)"+(o!==void 0?`, extent_x: ${r?Hk(e,tn):`slice(${o.signals.visual})`}`:"")+(a!==void 0?`, extent_y: ${r?Hk(e,ni):`slice(${a.signals.visual})`}`:"")+"}"}]},{name:i+xQ,value:{},on:[{events:l,update:`{x: ${s}.x - x(unit), y: ${s}.y - y(unit)}`}]}),o!==void 0&&UV(e,t,o,"width",n),a!==void 0&&UV(e,t,a,"height",n),n}};function UV(e,t,n,i,r){const s=t.name,o=s+SQ,a=s+xQ,l=n.channel,u=Sl.defined(t),c=r.find(E=>E.name===n.signals[u?"data":"visual"]),d=e.getSizeSignalRef(i).signal,h=e.getScaleComponent(l),p=h&&h.get("type"),g=h&&h.get("reverse"),v=u?l===tn?g?"":"-":g?"-":"":"",C=`${o}.extent_${l}`,y=`${v}${a}.${l} / ${u?`${d}`:`span(${C})`}`,b=!u||!h?"panLinear":p==="log"?"panLog":p==="symlog"?"panSymlog":p==="pow"?"panPow":"panLinear",S=u?p==="pow"?`, ${h.get("exponent")??1}`:p==="symlog"?`, ${h.get("constant")??1}`:"":"",x=`${b}(${C}, ${y}${S})`;c.on.push({events:{signal:a},update:u?x:`clampRange(${x}, 0, ${d})`})}const RQ="_zoom_anchor",EQ="_zoom_delta",gNe={defined:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const i=t.name,r=Sl.defined(t),s=i+EQ,{x:o,y:a}=t.project.hasChannel,l=he(e.scaleName(tn)),u=he(e.scaleName(ni));let c=mc(t.zoom,"scope");return r||(c=c.map(d=>(d.markname=i+Df,d))),n.push({name:i+RQ,on:[{events:c,update:r?"{"+[l?`x: invert(${l}, x(unit))`:"",u?`y: invert(${u}, y(unit))`:""].filter(d=>d).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:s,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),o!==void 0&&jV(e,t,o,"width",n),a!==void 0&&jV(e,t,a,"height",n),n}};function jV(e,t,n,i,r){const s=t.name,o=n.channel,a=Sl.defined(t),l=r.find(b=>b.name===n.signals[a?"data":"visual"]),u=e.getSizeSignalRef(i).signal,c=e.getScaleComponent(o),d=c&&c.get("type"),h=a?Hk(e,o):l.name,p=s+EQ,g=`${s}${RQ}.${o}`,v=!a||!c?"zoomLinear":d==="log"?"zoomLog":d==="symlog"?"zoomSymlog":d==="pow"?"zoomPow":"zoomLinear",C=a?d==="pow"?`, ${c.get("exponent")??1}`:d==="symlog"?`, ${c.get("constant")??1}`:"":"",y=`${v}(${h}, ${g}, ${p}${C})`;l.on.push({events:{signal:p},update:a?y:`clampRange(${y}, 0, ${u})`})}const Yd="_store",Il="_tuple",mNe="_modify",FQ="vlSelectionResolve",Jx=[HLe,XLe,BLe,wQ,yQ,Sl,bQ,hNe,pNe,gNe,CQ];function vNe(e){let t=e.parent;for(;t&&!Qr(t);)t=t.parent;return t}function yd(e,{escape:t}={escape:!0}){let n=t?he(e.name):e.name;const i=vNe(e);if(i){const{facet:r}=i;for(const s of Es)r[s]&&(n+=` + '__facet_${s}_' + (facet[${he(i.vgField(s))}])`)}return n}function jO(e){return pi(e.component.selection??{}).reduce((t,n)=>t||n.project.hasSelectionId,!1)}function AQ(e,t){(be(t.select)||!t.select.on)&&delete e.events,(be(t.select)||!t.select.clear)&&delete e.clear,(be(t.select)||!t.select.toggle)&&delete e.toggle}function fa(e){return e.events?.find(t=>"type"in t&&t.type==="timer")}function Wk(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...Wk(e.object)),t.push(...Wk(e.property))),t)}function DQ(e){return e.object.type==="MemberExpression"?DQ(e.object):e.object.name==="datum"}function PQ(e){const t=d_(e),n=new Set;return t.visit(i=>{i.type==="MemberExpression"&&DQ(i)&&n.add(Wk(i).slice(1).join("."))}),n}class Zp extends Ot{clone(){return new Zp(null,this.model,Ue(this.filter))}constructor(t,n,i){super(t),this.model=n,this.filter=i,this.expr=RS(this.model,this.filter,this),this._dependentFields=PQ(this.expr)}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function CNe(e,t){const n={},i=e.config.selection;if(!t||!t.length)return n;let r=0;for(const s of t){const o=en(s.name),a=s.select,l=be(a)?a:a.type,u=ye(a)?Ue(a):{type:l},c=i[l];for(const p in c)p==="fields"||p==="encodings"||(p==="mark"&&(u.mark={...c.mark,...u.mark}),(u[p]===void 0||u[p]===!0)&&(u[p]=Ue(c[p]??u[p])));const d=n[o]={...u,name:o,type:l,init:s.value,bind:s.bind,events:be(u.on)?mc(u.on,"scope"):we(Ue(u.on))};if(fa(d)&&(r++,r>1)){delete n[o];continue}const h=Ue(s);for(const p of Jx)p.defined(d)&&p.parse&&p.parse(e,d,h)}return r>1&&ce(LIe),n}function kQ(e,t,n,i="datum"){const r=be(t)?t:t.param,s=en(r),o=he(s+Yd);let a;try{a=e.getSelectionComponent(s,r)}catch{return`!!${s}`}if(a.project.timeUnit){const h=n??e.component.data.raw,p=a.project.timeUnit.clone();h.parent?p.insertAsParentOf(h):h.parent=p}const l=a.project.hasSelectionId?"vlSelectionIdTest(":"vlSelectionTest(",u=a.resolve==="global"?")":`, ${he(a.resolve)})`,c=`${l}${o}, ${i}${u}`,d=`length(data(${o}))`;return t.empty===!1?`${d} && ${c}`:`!${d} || ${c}`}function TQ(e,t,n){const i=en(t),r=n.encoding;let s=n.field,o;try{o=e.getSelectionComponent(i,t)}catch{return i}if(!r&&!s)s=o.project.items[0].field,o.project.items.length>1&&ce(NIe(s));else if(r&&!s){const a=o.project.items.filter(l=>l.channel===r);!a.length||a.length>1?(s=o.project.items[0].field,ce($Ie(a,r,n,s))):s=a[0].field}return`${o.name}[${he(Ns(s))}]`}function yNe(e,t){for(const[n,i]of Zu(e.component.selection??{})){const r=e.getName(`lookup_${n}`);e.component.data.outputNodes[r]=i.materialized=new Fr(new Zp(t,e,{param:n}),r,ln.Lookup,e.component.data.outputNodeRefCounts)}}function RS(e,t,n){return iv(t,i=>be(i)?i:q2e(i)?kQ(e,i,n):zY(i))}function wNe(e,t){if(e)return te(e)&&!bu(e)?e.map(n=>AO(n,t)).join(", "):e}function EA(e,t,n,i){var r,s;e.encode??(e.encode={}),(r=e.encode)[t]??(r[t]={}),(s=e.encode[t]).update??(s.update={}),e.encode[t].update[n]=i}function Bm(e,t,n,i={header:!1}){const{disable:r,orient:s,scale:o,labelExpr:a,title:l,zindex:u,...c}=e.combine();if(!r){for(const d in c){const h=d,p=J_e[h],g=c[h];if(p&&p!==t&&p!=="both")delete c[h];else if(aC(g)){const{condition:v,...C}=g,y=we(v),b=wV[h];if(b){const{vgProp:S,part:x}=b,E=[...y.map(A=>{const{test:F,...k}=A;return{test:RS(null,F),...k}}),C];EA(c,x,S,E),delete c[h]}else if(b===null){const S={signal:y.map(x=>{const{test:E,...A}=x;return`${RS(null,E)} ? ${rV(A)} : `}).join("")+rV(C)};c[h]=S}}else if(ke(g)){const v=wV[h];if(v){const{vgProp:C,part:y}=v;EA(c,y,C,g),delete c[h]}}at(["labelAlign","labelBaseline"],h)&&c[h]===null&&delete c[h]}if(t==="grid"){if(!c.grid)return;if(c.encode){const{grid:d}=c.encode;c.encode={...d?{grid:d}:{}},Nt(c.encode)&&delete c.encode}return{scale:o,orient:s,...c,domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:En(u,0)}}else{if(!i.header&&e.mainExtracted)return;if(a!==void 0){let h=a;c.encode?.labels?.update&&ke(c.encode.labels.update.text)&&(h=zd(a,"datum.label",c.encode.labels.update.text.signal)),EA(c,"labels","text",{signal:h})}if(c.labelAlign===null&&delete c.labelAlign,c.encode){for(const h of CX)e.hasAxisPart(h)||delete c.encode[h];Nt(c.encode)&&delete c.encode}const d=wNe(l,n);return{scale:o,orient:s,grid:!1,...d?{title:d}:{},...c,...n.aria===!1?{aria:!1}:{},zindex:En(u,0)}}}}function MQ(e){const{axes:t}=e.component,n=[];for(const i of Yl)if(t[i]){for(const r of t[i])if(!r.get("disable")&&!r.get("gridScale")){const s=i==="x"?"height":"width",o=e.getSizeSignalRef(s).signal;s!==o&&n.push({name:s,update:o})}}return n}function bNe(e,t){const{x:n=[],y:i=[]}=e;return[...n.map(r=>Bm(r,"grid",t)),...i.map(r=>Bm(r,"grid",t)),...n.map(r=>Bm(r,"main",t)),...i.map(r=>Bm(r,"main",t))].filter(r=>r)}function qV(e,t,n,i){return Object.assign.apply(null,[{},...e.map(r=>{if(r==="axisOrient"){const s=n==="x"?"bottom":"left",o=t[n==="x"?"axisBottom":"axisLeft"]||{},a=t[n==="x"?"axisTop":"axisRight"]||{},l=new Set([...oe(o),...oe(a)]),u={};for(const c of l.values())u[c]={signal:`${i.signal} === "${s}" ? ${co(o[c])} : ${co(a[c])}`};return u}return t[r]})])}function SNe(e,t,n,i){const r=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:UY(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],s=e==="x"?"axisX":"axisY",o=ke(n)?"axisOrient":`axis${X0(n)}`,a=[...r,...r.map(u=>s+u.substr(4))],l=["axis",o,s];return{vlOnlyAxisConfig:qV(a,i,e,n),vgAxisConfig:qV(l,i,e,n),axisConfigStyle:xNe([...l,...a],i)}}function xNe(e,t){const n=[{}];for(const i of e){let r=t[i]?.style;if(r){r=we(r);for(const s of r)n.push(t.style[s])}}return Object.assign.apply(null,n)}function Uk(e,t,n,i={}){const r=yY(e,n,t);if(r!==void 0)return{configFrom:"style",configValue:r};for(const s of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(i[s]?.[e]!==void 0)return{configFrom:s,configValue:i[s][e]};return{}}const KV={scale:({model:e,channel:t})=>e.scaleName(t),format:({format:e})=>e,formatType:({formatType:e})=>e,grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>t.grid??RNe(n,e),gridScale:({model:e,channel:t})=>ENe(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelAlign||_Q(t,n,i),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelBaseline||IQ(t,n,i),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>e.labelFlush??ANe(t.type,n),labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>e.labelOverlap??DNe(t.type,n,de(t)&&!!t.timeUnit,de(t)?t.sort:void 0),orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:i,scaleType:r})=>{const s=e==="x"?"width":e==="y"?"height":void 0,o=s?t.getSizeSignalRef(s):void 0;return n.tickCount??kNe({fieldOrDatumDef:i,scaleType:r,size:o,values:n.values})},tickMinStep:TNe,title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const i=OQ(t,n);if(i!==void 0)return i;const r=t.typedFieldDef(n),s=n==="x"?"x2":"y2",o=t.fieldDef(s);return bY(r?[CV(r)]:[],de(o)?[CV(o)]:[])},values:({axis:e,fieldOrDatumDef:t})=>MNe(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>e.zindex??INe(n,t)};function RNe(e,t){return!ei(e)&&de(t)&&!Ut(t?.bin)&&!oi(t?.bin)}function ENe(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function FNe(e,t,n,i,r){const s=t?.labelAngle;if(s!==void 0)return ke(s)?s:Wv(s);{const{configValue:o}=Uk("labelAngle",i,t?.style,r);return o!==void 0?Wv(o):n===tn&&at([gO,pO],e.type)&&!(de(e)&&e.timeUnit)?270:void 0}}function jk(e){return`(((${e.signal} % 360) + 360) % 360)`}function IQ(e,t,n,i){if(e!==void 0)if(n==="x"){if(ke(e)){const r=jk(e),s=ke(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${r} && ${r} < 135) || (225 < ${r} && ${r} < 315) ? "middle" :(${r} <= 45 || 315 <= ${r}) === ${s} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(ke(t)){const r=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${r} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(ke(e)){const r=jk(e),s=ke(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${r} <= 45 || 315 <= ${r} || (135 <= ${r} && ${r} <= 225) ? ${i?'"middle"':"null"} : (45 <= ${r} && ${r} <= 135) === ${s} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return i?"middle":null;if(ke(t)){const r=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${r} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function _Q(e,t,n){if(e===void 0)return;const i=n==="x",r=i?0:90,s=i?"bottom":"left";if(ke(e)){const o=jk(e),a=ke(t)?`(${t.signal} === "${s}")`:t===s;return{signal:`(${r?`(${o} + 90)`:o} % 180 === 0) ? ${i?null:'"center"'} :(${r} < ${o} && ${o} < ${180+r}) === ${a} ? "left" : "right"`}}if((e+r)%180===0)return i?null:"center";if(ke(t)){const o=r<e&&e<180+r?"===":"!==";return{signal:`${`${t.signal} ${o} "${s}"`} ? "left" : "right"`}}return(r<e&&e<180+r)==(t===s)?"left":"right"}function ANe(e,t){if(t==="x"&&at(["quantitative","temporal"],e))return!0}function DNe(e,t,n,i){if(n&&!ye(i)||e!=="nominal"&&e!=="ordinal")return t==="log"||t==="symlog"?"greedy":!0}function PNe(e){return e==="x"?"bottom":"left"}function kNe({fieldOrDatumDef:e,scaleType:t,size:n,values:i}){if(!i&&!ei(t)&&t!=="log"){if(de(e)){if(Ut(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&at(["month","hours","day","quarter"],Zn(e.timeUnit)?.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function TNe({format:e,fieldOrDatumDef:t}){if(e==="d")return 1;if(de(t)){const{timeUnit:n}=t;if(n){const i=$Y(n);if(i)return{signal:i}}}}function OQ(e,t){const n=t==="x"?"x2":"y2",i=e.fieldDef(t),r=e.fieldDef(n),s=i?i.title:void 0,o=r?r.title:void 0;if(s&&o)return SY(s,o);if(s)return s;if(o)return o;if(s!==void 0)return s;if(o!==void 0)return o}function MNe(e,t){const n=e.values;if(te(n))return vX(t,n);if(ke(n))return n}function INe(e,t){return e==="rect"&&vS(t)?1:0}class mp extends Ot{clone(){return new mp(null,Ue(this.transform))}constructor(t,n){super(t),this.transform=n,this._dependentFields=PQ(this.transform.calculate)}static parseAllForSortIndex(t,n){return n.forEachFieldDef((i,r)=>{if(gh(i)&&aX(i.sort)){const{field:s,timeUnit:o}=i,a=i.sort,l=a.map((u,c)=>`${zY({field:s,timeUnit:o,equal:u})} ? ${c} : `).join("")+a.length;t=new mp(t,{calculate:l,as:vp(i,r,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${ct(this.transform)}`}}function vp(e,t,n){return ve(e,{prefix:t,suffix:"sort_index",...n})}function Zx(e,t){return at(["top","bottom"],t)?"column":at(["left","right"],t)||e==="row"?"row":"column"}function Cp(e,t,n,i){const r=i==="row"?n.headerRow:i==="column"?n.headerColumn:n.headerFacet;return En((t||{})[e],r[e],n.header[e])}function eR(e,t,n,i){const r={};for(const s of e){const o=Cp(s,t||{},n,i);o!==void 0&&(r[s]=o)}return r}const qO=["row","column"],KO=["header","footer"];function _Ne(e,t){const n=e.component.layoutHeaders[t].title,i=e.config?e.config:void 0,r=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:s,titleAngle:o,titleOrient:a}=eR(["titleAnchor","titleAngle","titleOrient"],r.header,i,t),l=Zx(t,a),u=Wv(o);return{name:`${t}-title`,type:"group",role:`${l}-title`,title:{text:n,...t==="row"?{orient:"left"}:{},style:"guide-title",...NQ(u,l),...LQ(l,u,s),...$Q(i,r,t,wOe,LX)}}}function LQ(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const i=_Q(t,e==="row"?"left":"top",e==="row"?"y":"x");return i?{align:i}:{}}function NQ(e,t){const n=IQ(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function ONe(e,t){const n=e.component.layoutHeaders[t],i=[];for(const r of KO)if(n[r])for(const s of n[r]){const o=NNe(e,t,r,n,s);o!=null&&i.push(o)}return i}function LNe(e,t){const{sort:n}=e;return bl(n)?{field:ve(n,{expr:"datum"}),order:n.order??"ascending"}:te(n)?{field:vp(e,t,{expr:"datum"}),order:"ascending"}:{field:ve(e,{expr:"datum"}),order:n??"ascending"}}function qk(e,t,n){const{format:i,formatType:r,labelAngle:s,labelAnchor:o,labelOrient:a,labelExpr:l}=eR(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),u=xO({fieldOrDatumDef:e,format:i,formatType:r,expr:"parent",config:n}).signal,c=Zx(t,a);return{text:{signal:l?zd(zd(l,"datum.label",u),"datum.value",ve(e,{expr:"parent"})):u},...t==="row"?{orient:"left"}:{},style:"guide-label",frame:"group",...NQ(s,c),...LQ(c,s,o),...$Q(n,e,t,bOe,NX)}}function NNe(e,t,n,i,r){if(r){let s=null;const{facetFieldDef:o}=i,a=e.config?e.config:void 0;if(o&&r.labels){const{labelOrient:d}=eR(["labelOrient"],o.header,a,t);(t==="row"&&!at(["top","bottom"],d)||t==="column"&&!at(["left","right"],d))&&(s=qk(o,t,a))}const l=Qr(e)&&!iC(e.facet),u=r.axes,c=u?.length>0;if(s||c){const d=t==="row"?"height":"width";return{name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`,...i.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:LNe(o,t)}:{},...c&&l?{from:{data:e.getName(`facet_domain_${t}`)}}:{},...s?{title:s}:{},...r.sizeSignal?{encode:{update:{[d]:r.sizeSignal}}}:{},...c?{axes:u}:{}}}}return null}const $Ne={column:{start:0,end:1},row:{start:1,end:0}};function BNe(e,t){return $Ne[t][e]}function GNe(e,t){const n={};for(const i of Es){const r=e[i];if(r?.facetFieldDef){const{titleAnchor:s,titleOrient:o}=eR(["titleAnchor","titleOrient"],r.facetFieldDef.header,t,i),a=Zx(i,o),l=BNe(s,a);l!==void 0&&(n[a]=l)}}return Nt(n)?void 0:n}function $Q(e,t,n,i,r){const s={};for(const o of i){if(!r[o])continue;const a=Cp(o,t?.header,e,n);a!==void 0&&(s[r[o]]=a)}return s}function YO(e){return[...jy(e,"width"),...jy(e,"height"),...jy(e,"childWidth"),...jy(e,"childHeight")]}function jy(e,t){const n=t==="width"?"x":"y",i=e.component.layoutSize.get(t);if(!i||i==="merged")return[];const r=e.getSizeSignalRef(t).signal;if(i==="step"){const s=e.getScaleComponent(n);if(s){const o=s.get("type"),a=s.get("range");if(ei(o)&&hh(a)){const l=e.scaleName(n);return Qr(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[YV(l,a)]:[YV(l,a),{name:r,update:BQ(l,s,`domain('${l}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(i=="container"){const s=r.endsWith("width"),o=s?"containerSize()[0]":"containerSize()[1]",a=Lk(e.config.view,s?"width":"height"),l=`isFinite(${o}) ? ${o} : ${a}`;return[{name:r,init:l,on:[{update:l,events:"window:resize"}]}]}else return[{name:r,value:i}]}function YV(e,t){const n=`${e}_step`;return ke(t.step)?{name:n,update:t.step.signal}:{name:n,value:t.step}}function BQ(e,t,n){const i=t.get("type"),r=t.get("padding"),s=En(t.get("paddingOuter"),r);let o=t.get("paddingInner");return o=i==="band"?o!==void 0?o:r:1,`bandspace(${n}, ${co(o)}, ${co(s)}) * ${e}_step`}function GQ(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function zQ(e,t){return oe(e).reduce((n,i)=>({...n,...Jp({model:t,channelDef:e[i],vgChannel:i,mainRefFn:r=>Kt(r.value),invalidValueRef:void 0})}),{})}function HQ(e,t){if(Qr(t))return e==="theta"?"independent":"shared";if(ng(t))return"shared";if(nL(t))return Fn(e)||e==="theta"||e==="radius"?"independent":"shared";throw new Error("invalid model type for resolve")}function XO(e,t){const n=e.scale[t],i=Fn(t)?"axis":"legend";return n==="independent"?(e[i][t]==="shared"&&ce(g2e(t)),"independent"):e[i][t]||"shared"}const zNe={...ROe,disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1},VQ=oe(zNe);class HNe extends Ql{}const XV={symbols:VNe,gradient:WNe,labels:UNe,entries:jNe};function VNe(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r,legendType:s}){if(s!=="symbol")return;const{markDef:o,encoding:a,config:l,mark:u}=n,c=o.filled&&u!=="trail";let d={...xIe({},n,y_e),...gQ(n,{filled:c})};const h=r.get("symbolOpacity")??l.legend.symbolOpacity,p=r.get("symbolFillColor")??l.legend.symbolFillColor,g=r.get("symbolStrokeColor")??l.legend.symbolStrokeColor,v=h===void 0?WQ(a.opacity)??o.opacity:void 0;if(d.fill){if(i==="fill"||c&&i===kr)delete d.fill;else if(ae(d.fill,"field"))p?delete d.fill:(d.fill=Kt(l.legend.symbolBaseFillColor??"black"),d.fillOpacity=Kt(v??1));else if(te(d.fill)){const C=Kk(a.fill??a.color)??o.fill??(c&&o.color);C&&(d.fill=Kt(C))}}if(d.stroke){if(i==="stroke"||!c&&i===kr)delete d.stroke;else if(ae(d.stroke,"field")||g)delete d.stroke;else if(te(d.stroke)){const C=En(Kk(a.stroke||a.color),o.stroke,c?o.color:void 0);C&&(d.stroke={value:C})}}if(i!==Kl){const C=de(t)&&jQ(n,r,t);C?d.opacity=[{test:C,...Kt(v??1)},Kt(l.legend.unselectedOpacity)]:v&&(d.opacity=Kt(v))}return d={...d,...e},Nt(d)?void 0:d}function WNe(e,{model:t,legendType:n,legendCmpt:i}){if(n!=="gradient")return;const{config:r,markDef:s,encoding:o}=t;let a={};const u=(i.get("gradientOpacity")??r.legend.gradientOpacity)===void 0?WQ(o.opacity)||s.opacity:void 0;return u&&(a.opacity=Kt(u)),a={...a,...e},Nt(a)?void 0:a}function UNe(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r}){const s=n.legend(i)||{},o=n.config,a=de(t)?jQ(n,r,t):void 0,l=a?[{test:a,value:1},{value:o.legend.unselectedOpacity}]:void 0,{format:u,formatType:c}=s;let d;qd(c)?d=ho({fieldOrDatumDef:t,field:"datum.value",format:u,formatType:c,config:o}):u===void 0&&c===void 0&&o.customFormatTypes&&(t.type==="quantitative"&&o.numberFormatType?d=ho({fieldOrDatumDef:t,field:"datum.value",format:o.numberFormat,formatType:o.numberFormatType,config:o}):t.type==="temporal"&&o.timeFormatType&&de(t)&&t.timeUnit===void 0&&(d=ho({fieldOrDatumDef:t,field:"datum.value",format:o.timeFormat,formatType:o.timeFormatType,config:o})));const h={...l?{opacity:l}:{},...d?{text:d}:{},...e};return Nt(h)?void 0:h}function jNe(e,{legendCmpt:t}){return t.get("selections")?.length?{...e,fill:{value:"transparent"}}:e}function WQ(e){return UQ(e,(t,n)=>Math.max(t,n.value))}function Kk(e){return UQ(e,(t,n)=>En(t,n.value))}function UQ(e,t){if(G_e(e))return we(e.condition).reduce(t,e.value);if(So(e))return e.value}function jQ(e,t,n){const i=t.get("selections");if(!i?.length)return;const r=he(n.field);return i.map(s=>`(!length(data(${he(en(s)+Yd)})) || (${s}[${r}] && indexof(${s}[${r}], datum.value) >= 0))`).join(" || ")}const QV={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:i,formatType:r}=t;return rX(e,e.type,i,r,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return sX(i,t,n)},gradientLength:e=>{const{legend:t,legendConfig:n}=e;return t.gradientLength??n.gradientLength??ZNe(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>e.labelOverlap??t.labelOverlap??e$e(n),symbolType:({legend:e,markDef:t,channel:n,encoding:i})=>e.symbolType??KNe(t.type,n,i.shape,t.shape),title:({fieldOrDatumDef:e,config:t})=>Af(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(Ff(n)&&aa(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>qNe(t,e)};function qNe(e,t){const n=e.values;if(te(n))return vX(t,n);if(ke(n))return n}function KNe(e,t,n,i){if(t!=="shape"){const r=Kk(n)??i;if(r)return r}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function YNe(e){const{legend:t}=e;return En(t.type,XNe(e))}function XNe({channel:e,timeUnit:t,scaleType:n}){if(Ff(e)){if(at(["quarter","month","day"],t))return"symbol";if(aa(n))return"gradient"}return"symbol"}function QNe({legendConfig:e,legendType:t,orient:n,legend:i}){return i.direction??e[t?"gradientDirection":"symbolDirection"]??JNe(n,t)}function JNe(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function ZNe({legendConfig:e,model:t,direction:n,orient:i,scaleType:r}){const{gradientHorizontalMaxLength:s,gradientHorizontalMinLength:o,gradientVerticalMaxLength:a,gradientVerticalMinLength:l}=e;if(aa(r))return n==="horizontal"?i==="top"||i==="bottom"?JV(t,"width",o,s):o:JV(t,"height",l,a)}function JV(e,t,n,i){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${i})`}}function e$e(e){if(at(["quantile","threshold","log","symlog"],e))return"greedy"}function qQ(e){const t=an(e)?t$e(e):s$e(e);return e.component.legends=t,t}function t$e(e){const{encoding:t}=e,n={};for(const i of[kr,...BX]){const r=Gn(t[i]);!r||!e.getScaleComponent(i)||i===Tr&&de(r)&&r.type===Qp||(n[i]=r$e(e,i))}return n}function n$e(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function i$e(e,t,n,i){switch(t){case"disable":return n!==void 0;case"values":return!!n?.values;case"title":if(t==="title"&&e===i?.title)return!0}return e===(n||{})[t]}function r$e(e,t){let n=e.legend(t);const{markDef:i,encoding:r,config:s}=e,o=s.legend,a=new HNe({},n$e(e,t));fNe(e,t,a);const l=n!==void 0?!n:o.disable;if(a.set("disable",l,n!==void 0),l)return a;n=n||{};const u=e.getScaleComponent(t).get("type"),c=Gn(r[t]),d=de(c)?Zn(c.timeUnit)?.unit:void 0,h=n.orient||s.legend.orient||"right",p=YNe({legend:n,channel:t,timeUnit:d,scaleType:u}),g=QNe({legend:n,legendType:p,orient:h,legendConfig:o}),v={legend:n,channel:t,model:e,markDef:i,encoding:r,fieldOrDatumDef:c,legendConfig:o,config:s,scaleType:u,orient:h,legendType:p,direction:g};for(const x of VQ){if(p==="gradient"&&x.startsWith("symbol")||p==="symbol"&&x.startsWith("gradient"))continue;const E=x in QV?QV[x](v):n[x];if(E!==void 0){const A=i$e(E,x,n,e.fieldDef(t));(A||s.legend[x]===void 0)&&a.set(x,E,A)}}const C=n?.encoding??{},y=a.get("selections"),b={},S={fieldOrDatumDef:c,model:e,channel:t,legendCmpt:a,legendType:p};for(const x of["labels","legend","title","symbols","gradient","entries"]){const E=zQ(C[x]??{},e),A=x in XV?XV[x](E,S):E;A!==void 0&&!Nt(A)&&(b[x]={...y?.length&&de(c)?{name:`${en(c.field)}_legend_${x}`}:{},...y?.length?{interactive:!!y}:{},update:A})}return Nt(b)||a.set("encode",b,!!n?.encoding),a}function s$e(e){const{legends:t,resolve:n}=e.component;for(const i of e.children){qQ(i);for(const r of oe(i.component.legends))n.legend[r]=XO(e.component.resolve,r),n.legend[r]==="shared"&&(t[r]=KQ(t[r],i.component.legends[r]),t[r]||(n.legend[r]="independent",delete t[r]))}for(const i of oe(t))for(const r of e.children)r.component.legends[i]&&n.legend[i]==="shared"&&delete r.component.legends[i];return t}function KQ(e,t){if(!e)return t.clone();const n=e.getWithExplicit("orient"),i=t.getWithExplicit("orient");if(n.explicit&&i.explicit&&n.value!==i.value)return;let r=!1;for(const s of VQ){const o=nc(e.getWithExplicit(s),t.getWithExplicit(s),s,"legend",(a,l)=>{switch(s){case"symbolType":return o$e(a,l);case"title":return xY(a,l);case"type":return r=!0,zr("symbol")}return Kx(a,l,s,"legend")});e.setWithExplicit(s,o)}return r&&(e.implicit?.encode?.gradient&&hS(e.implicit,["encode","gradient"]),e.explicit?.encode?.gradient&&hS(e.explicit,["encode","gradient"])),e}function o$e(e,t){return t.value==="circle"?t:e}function a$e(e,t,n,i){var r,s;e.encode??(e.encode={}),(r=e.encode)[t]??(r[t]={}),(s=e.encode[t]).update??(s.update={}),e.encode[t].update[n]=i}function YQ(e){const t=e.component.legends,n={};for(const r of oe(t)){const s=e.getScaleComponent(r),o=$t(s.get("domains"));if(n[o])for(const a of n[o])KQ(a,t[r])||n[o].push(t[r]);else n[o]=[t[r].clone()]}return pi(n).flat().map(r=>l$e(r,e.config)).filter(r=>r!==void 0)}function l$e(e,t){const{disable:n,labelExpr:i,selections:r,...s}=e.combine();if(!n){if(t.aria===!1&&s.aria==null&&(s.aria=!1),s.encode?.symbols){const o=s.encode.symbols.update;o.fill&&o.fill.value!=="transparent"&&!o.stroke&&!s.stroke&&(o.stroke={value:"transparent"});for(const a of BX)s[a]&&delete o[a]}if(s.title||delete s.title,i!==void 0){let o=i;s.encode?.labels?.update&&ke(s.encode.labels.update.text)&&(o=zd(i,"datum.label",s.encode.labels.update.text.signal)),a$e(s,"labels","text",{signal:o})}return s}}function u$e(e){return ng(e)||nL(e)?c$e(e):XQ(e)}function c$e(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),XQ(e))}function XQ(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:i}=n;if(t.data){const r={signal:`[${t.size.map(o=>o.signal).join(", ")}]`},s=t.data.reduce((o,a)=>{const l=ke(a)?a.signal:`data('${e.lookupDataSource(a)}')`;return at(o,l)||o.push(l),o},[]);if(s.length<=0)throw new Error("Projection's fit didn't find any data sources");return[{name:i,size:r,fit:{signal:s.length>1?`[${s.join(", ")}]`:s[0]},...n}]}else return[{name:i,translate:{signal:"[width / 2, height / 2]"},...n}]}const d$e=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class QQ extends Ql{constructor(t,n,i,r){super({...n},{name:t}),this.specifiedProjection=n,this.size=i,this.data=r,this.merged=!1}get isFit(){return!!this.data}}function JQ(e){e.component.projection=an(e)?h$e(e):g$e(e)}function h$e(e){if(e.hasProjection){const t=ai(e.specifiedProjection),n=!(t&&(t.scale!=null||t.translate!=null)),i=n?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,r=n?f$e(e):void 0,s=new QQ(e.projectionName(!0),{...ai(e.config.projection),...t},i,r);return s.get("type")||s.set("type","equalEarth",!1),s}}function f$e(e){const t=[],{encoding:n}=e;for(const i of[[Lo,Oo],[$s,No]])(Gn(n[i[0]])||Gn(n[i[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(Tr)&&e.typedFieldDef(Tr).type===Qp&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(ln.Main)),t}function p$e(e,t){const n=z_(d$e,r=>!!(!Ee(e.explicit,r)&&!Ee(t.explicit,r)||Ee(e.explicit,r)&&Ee(t.explicit,r)&&qr(e.get(r),t.get(r))));if(qr(e.size,t.size)){if(n)return e;if(qr(e.explicit,{}))return t;if(qr(t.explicit,{}))return e}return null}function g$e(e){if(e.children.length===0)return;let t;for(const i of e.children)JQ(i);const n=z_(e.children,i=>{const r=i.component.projection;if(r)if(t){const s=p$e(t,r);return s&&(t=s),!!s}else return t=r,!0;else return!0});if(t&&n){const i=e.projectionName(!0),r=new QQ(i,t.specifiedProjection,t.size,Ue(t.data));for(const s of e.children){const o=s.component.projection;o&&(o.isFit&&r.data.push(...s.component.projection.data),s.renameProjection(o.get("name"),i),o.merged=!0)}return r}}function m$e(e,t,n,i){if(oC(t,n)){const r=an(e)?e.axis(n)??e.legend(n)??{}:{},s=ve(t,{expr:"datum"}),o=ve(t,{expr:"datum",binSuffix:"end"});return{formulaAs:ve(t,{binSuffix:"range",forAs:!0}),formula:nC(s,o,r.format,r.formatType,i)}}return{}}function ZQ(e,t){return`${gY(e)}_${t}`}function v$e(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function QO(e,t,n){const i=Hx(n,void 0)??{},r=ZQ(i,t);return e.getName(`${r}_bins`)}function C$e(e){return"as"in e}function ZV(e,t,n){let i,r;C$e(e)?i=be(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:i=[ve(e,{forAs:!0}),ve(e,{binSuffix:"end",forAs:!0})];const s={...Hx(t,void 0)},o=ZQ(s,e.field),{signal:a,extentSignal:l}=v$e(n,o);if(Tx(s.extent)){const c=s.extent;r=TQ(n,c.param,c),delete s.extent}const u={bin:s,field:e.field,as:[i],...a?{signal:a}:{},...l?{extentSignal:l}:{},...r?{span:r}:{}};return{key:o,binComponent:u}}class pa extends Ot{clone(){return new pa(null,Ue(this.bins))}constructor(t,n){super(t),this.bins=n}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,s,o)=>{if(or(s)&&Ut(s.bin)){const{key:a,binComponent:l}=ZV(s,s.bin,n);r[a]={...l,...r[a],...m$e(n,s,o,n.config)}}return r},{});return Nt(i)?null:new pa(t,i)}static makeFromTransform(t,n,i){const{key:r,binComponent:s}=ZV(n,n.bin,i);return new pa(t,{[r]:s})}merge(t,n){for(const i of oe(t.bins))i in this.bins?(n(t.bins[i].signal,this.bins[i].signal),this.bins[i].as=oa([...this.bins[i].as,...t.bins[i].as],ct)):this.bins[i]=t.bins[i];for(const i of t.children)t.removeChild(i),i.parent=this;t.remove()}producedFields(){return new Set(pi(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(pi(this.bins).map(t=>t.field))}hash(){return`Bin ${ct(this.bins)}`}assemble(){return pi(this.bins).flatMap(t=>{const n=[],[i,...r]=t.as,{extent:s,...o}=t.bin,a={type:"bin",field:Ns(t.field),as:i,signal:t.signal,...Tx(s)?{extent:null}:{extent:s},...t.span?{span:{signal:`span(${t.span})`}}:{},...o};!s&&t.extentSignal&&(n.push({type:"extent",field:Ns(t.field),signal:t.extentSignal}),a.extent={signal:t.extentSignal}),n.push(a);for(const l of r)for(let u=0;u<2;u++)n.push({type:"formula",expr:ve({field:i[u]},{expr:"datum"}),as:l[u]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}function y$e(e,t,n,i){const r=an(i)?i.encoding[Oa(t)]:void 0;if(or(n)&&an(i)&&uX(n,r,i.markDef,i.config)){e.add(ve(n,{})),e.add(ve(n,{suffix:"end"}));const{mark:s,markDef:o,config:a}=i,l=tc({fieldDef:n,markDef:o,config:a});Uv(s)&&l!==.5&&Fn(t)&&(e.add(ve(n,{suffix:Yx})),e.add(ve(n,{suffix:Xx}))),n.bin&&oC(n,t)&&e.add(ve(n,{binSuffix:"range"}))}else if(oY(t)){const s=sY(t);e.add(i.getName(s))}else e.add(ve(n));return gh(n)&&o_e(n.scale?.range)&&e.add(n.scale.range.field),e}function w$e(e,t){for(const n of oe(t)){const i=t[n];for(const r of oe(i))n in e?e[n][r]=new Set([...e[n][r]??[],...i[r]]):e[n]={[r]:i[r]}}}class mo extends Ot{clone(){return new mo(null,new Set(this.dimensions),Ue(this.measures))}constructor(t,n,i){super(t),this.dimensions=n,this.measures=i}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let i=!1;n.forEachFieldDef(o=>{o.aggregate&&(i=!0)});const r={},s=new Set;return!i||(n.forEachFieldDef((o,a)=>{const{aggregate:l,field:u}=o;if(l)if(l==="count")r["*"]??(r["*"]={}),r["*"].count=new Set([ve(o,{forAs:!0})]);else{if(Tl(l)||xc(l)){const c=Tl(l)?"argmin":"argmax",d=l[c];r[d]??(r[d]={}),r[d][c]=new Set([ve({op:c,field:d},{forAs:!0})])}else r[u]??(r[u]={}),r[u][l]=new Set([ve(o,{forAs:!0})]);La(a)&&n.scaleDomain(a)==="unaggregated"&&(r[u]??(r[u]={}),r[u].min=new Set([ve({field:u,aggregate:"min"},{forAs:!0})]),r[u].max=new Set([ve({field:u,aggregate:"max"},{forAs:!0})]))}else y$e(s,a,o,n)}),s.size+oe(r).length===0)?null:new mo(t,s,r)}static makeFromTransform(t,n){var i;const r=new Set,s={};for(const o of n.aggregate){const{op:a,field:l,as:u}=o;a&&(a==="count"?(s["*"]??(s["*"]={}),s["*"].count=new Set([u||ve(o,{forAs:!0})])):(s[l]??(s[l]={}),(i=s[l])[a]??(i[a]=new Set),s[l][a].add(u||ve(o,{forAs:!0}))))}for(const o of n.groupby??[])r.add(o);return r.size+oe(s).length===0?null:new mo(t,r,s)}merge(t){return QK(this.dimensions,t.dimensions)?(w$e(this.measures,t.measures),!0):(T2e("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...oe(this.measures)])}producedFields(){const t=new Set;for(const n of oe(this.measures))for(const i of oe(this.measures[n])){const r=this.measures[n][i];r.size===0?t.add(`${i}_${n}`):r.forEach(t.add,t)}return t}hash(){return`Aggregate ${ct({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],i=[];for(const s of oe(this.measures))for(const o of oe(this.measures[s]))for(const a of this.measures[s][o])i.push(a),t.push(o),n.push(s==="*"?null:Ns(s));return{type:"aggregate",groupby:[...this.dimensions].map(Ns),ops:t,fields:n,as:i}}}class eg extends Ot{constructor(t,n,i,r){super(t),this.model=n,this.name=i,this.data=r;for(const s of Es){const o=n.facet[s];if(o){const{bin:a,sort:l}=o;this[s]={name:n.getName(`${s}_domain`),fields:[ve(o),...Ut(a)?[ve(o,{binSuffix:"end"})]:[]],...bl(l)?{sortField:l}:te(l)?{sortIndexField:vp(o,s)}:{}}}}this.childModel=n.child}hash(){let t="Facet";for(const n of Es)this[n]&&(t+=` ${n.charAt(0)}:${ct(this[n])}`);return t}get fields(){const t=[];for(const n of Es)this[n]?.fields&&t.push(...this[n].fields);return t}dependentFields(){const t=new Set(this.fields);for(const n of Es)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of Yl){const i=this.childModel.component.scales[n];if(i&&!i.merged){const r=i.get("type"),s=i.get("range");if(ei(r)&&hh(s)){const o=tR(this.childModel,n),a=tL(o);a?t[n]=a:ce(tO(n))}}}return t}assembleRowColumnHeaderData(t,n,i){const r={row:"y",column:"x",facet:void 0}[t],s=[],o=[],a=[];r&&i&&i[r]&&(n?(s.push(`distinct_${i[r]}`),o.push("max")):(s.push(i[r]),o.push("distinct")),a.push(`distinct_${i[r]}`));const{sortField:l,sortIndexField:u}=this[t];if(l){const{op:c=Bx,field:d}=l;s.push(d),o.push(c),a.push(ve(l,{forAs:!0}))}else u&&(s.push(u),o.push("max"),a.push(u));return{name:this[t].name,source:n??this.data,transform:[{type:"aggregate",groupby:this[t].fields,...s.length?{fields:s,ops:o,as:a}:{}}]}}assembleFacetHeaderData(t){const{columns:n}=this.model.layout,{layoutHeaders:i}=this.model.component,r=[],s={};for(const l of qO){for(const u of KO){const c=(i[l]&&i[l][u])??[];for(const d of c)if(d.axes?.length>0){s[l]=!0;break}}if(s[l]){const u=`length(data("${this.facet.name}"))`,c=l==="row"?n?{signal:`ceil(${u} / ${n})`}:1:n?{signal:`min(${u}, ${n})`}:{signal:u};r.push({name:`${this.facet.name}_${l}`,transform:[{type:"sequence",start:0,stop:c}]})}}const{row:o,column:a}=s;return(o||a)&&r.unshift(this.assembleRowColumnHeaderData("facet",null,t)),r}assemble(){const t=[];let n=null;const i=this.getChildIndependentFieldsWithStep(),{column:r,row:s,facet:o}=this;if(r&&s&&(i.x||i.y)){n=`cross_${this.column.name}_${this.row.name}`;const a=[].concat(i.x??[],i.y??[]),l=a.map(()=>"distinct");t.push({name:n,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:a,ops:l}]})}for(const a of[wl,yl])this[a]&&t.push(this.assembleRowColumnHeaderData(a,n,i));if(o){const a=this.assembleFacetHeaderData(i);a&&t.push(...a)}return t}}function e5(e){return e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e}function b$e(e,t){const n=W_(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.startsWith("date:")){const i=e5(t.slice(5,t.length));return`timeParse(${n},'${i}')`}else if(t.startsWith("utc:")){const i=e5(t.slice(4,t.length));return`utcParse(${n},'${i}')`}else return ce(GIe(t)),null}function S$e(e){const t={};return Gw(e.filter,n=>{if(GY(n)){let i=null;aO(n)?i=Wr(n.equal):uO(n)?i=Wr(n.lte):lO(n)?i=Wr(n.lt):cO(n)?i=Wr(n.gt):dO(n)?i=Wr(n.gte):hO(n)?i=n.range[0]:fO(n)&&(i=(n.oneOf??n.in)[0]),i&&(fh(i)?t[n.field]="date":xt(i)?t[n.field]="number":be(i)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function x$e(e){const t={};function n(i){fp(i)?t[i.field]="date":i.type==="quantitative"&&pIe(i.aggregate)?t[i.field]="number":ap(i.field)>1?i.field in t||(t[i.field]="flatten"):gh(i)&&bl(i.sort)&&ap(i.sort.field)>1&&(i.sort.field in t||(t[i.sort.field]="flatten"))}if((an(e)||Qr(e))&&e.forEachFieldDef((i,r)=>{if(or(i))n(i);else{const s=ch(r),o=e.fieldDef(s);n({...i,type:o.type})}}),an(e)){const{mark:i,markDef:r,encoding:s}=e;if(Rc(i)&&!e.encoding.order){const o=r.orient==="horizontal"?"y":"x",a=s[o];de(a)&&a.type==="quantitative"&&!(a.field in t)&&(t[a.field]="number")}}return t}function R$e(e){const t={};if(an(e)&&e.component.selection)for(const n of oe(e.component.selection)){const i=e.component.selection[n];for(const r of i.project.items)!r.channel&&ap(r.field)>1&&(t[r.field]="flatten")}return t}class Di extends Ot{clone(){return new Di(null,Ue(this._parse))}constructor(t,n){super(t),this._parse=n}hash(){return`Parse ${ct(this._parse)}`}static makeExplicit(t,n,i){let r={};const s=n.data;return!Gu(s)&&s?.format?.parse&&(r=s.format.parse),this.makeWithAncestors(t,r,{},i)}static makeWithAncestors(t,n,i,r){for(const a of oe(i)){const l=r.getWithExplicit(a);l.value!==void 0&&(l.explicit||l.value===i[a]||l.value==="derived"||i[a]==="flatten"?delete i[a]:ce(cV(a,i[a],l.value)))}for(const a of oe(n)){const l=r.get(a);l!==void 0&&(l===n[a]?delete n[a]:ce(cV(a,n[a],l)))}const s=new Ql(n,i);r.copyAll(s);const o={};for(const a of oe(s.combine())){const l=s.get(a);l!==null&&(o[a]=l)}return oe(o).length===0||r.parseNothing?null:new Di(t,o)}get parse(){return this._parse}merge(t){this._parse={...this._parse,...t.parse},t.remove()}assembleFormatParse(){const t={};for(const n of oe(this._parse)){const i=this._parse[n];ap(n)===1&&(t[n]=i)}return t}producedFields(){return new Set(oe(this._parse))}dependentFields(){return new Set(oe(this._parse))}assembleTransforms(t=!1){return oe(this._parse).filter(n=>t?ap(n)>1:!0).map(n=>{const i=b$e(n,this._parse[n]);return i?{type:"formula",expr:i,as:Yp(n)}:null}).filter(n=>n!==null)}}class ic extends Ot{clone(){return new ic(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([Ro])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:Ro}}}class uC extends Ot{clone(){return new uC(null,this.params)}constructor(t,n){super(t),this.params=n}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${ct(this.params)}`}assemble(){return{type:"graticule",...this.params===!0?{}:this.params}}}class cC extends Ot{clone(){return new cC(null,this.params)}constructor(t,n){super(t),this.params=n}dependentFields(){return new Set}producedFields(){return new Set([this.params.as??"data"])}hash(){return`Hash ${ct(this.params)}`}assemble(){return{type:"sequence",...this.params}}}class Xd extends Ot{constructor(t){super(null),t??(t={name:"source"});let n;if(Gu(t)||(n=t.format?{...Er(t.format,["parse"])}:{}),jv(t))this._data={values:t.values};else if(pp(t)){if(this._data={url:t.url},!n.type){let i=/(?:\.([^.]+))?$/.exec(t.url)[1];at(["json","csv","tsv","dsv","topojson"],i)||(i="json"),n.type=i}}else iQ(t)?this._data={values:[{type:"Sphere"}]}:(tQ(t)||Gu(t))&&(this._data={});this._generator=Gu(t),t.name&&(this._name=t.name),n&&!Nt(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return{name:this._name,...this._data,transform:[]}}}var t5=function(e,t,n,i,r){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?r.call(e,n):r?r.value=n:t.set(e,n),n},E$e=function(e,t,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(e):i?i.value:t.get(e)},Gm;function JO(e){return e instanceof Xd||e instanceof uC||e instanceof cC}class ZO{constructor(){Gm.set(this,void 0),t5(this,Gm,!1,"f")}setModified(){t5(this,Gm,!0,"f")}get modifiedFlag(){return E$e(this,Gm,"f")}}Gm=new WeakMap;class mh extends ZO{getNodeDepths(t,n,i){i.set(t,n);for(const r of t.children)this.getNodeDepths(r,n+1,i);return i}optimize(t){const i=[...this.getNodeDepths(t,0,new Map).entries()].sort((r,s)=>s[1]-r[1]);for(const r of i)this.run(r[0]);return this.modifiedFlag}}class eL extends ZO{optimize(t){this.run(t);for(const n of t.children)this.optimize(n);return this.modifiedFlag}}class F$e extends eL{mergeNodes(t,n){const i=n.shift();for(const r of n)t.removeChild(r),r.parent=i,r.remove()}run(t){const n=t.children.map(r=>r.hash()),i={};for(let r=0;r<n.length;r++)i[n[r]]===void 0?i[n[r]]=[t.children[r]]:i[n[r]].push(t.children[r]);for(const r of oe(i))i[r].length>1&&(this.setModified(),this.mergeNodes(t,i[r]))}}class A$e extends eL{constructor(t){super(),this.requiresSelectionId=t&&jO(t)}run(t){t instanceof ic&&(this.requiresSelectionId&&(JO(t.parent)||t.parent instanceof mo||t.parent instanceof Di)||(this.setModified(),t.remove()))}}class D$e extends ZO{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,n){let i=new Set;t instanceof ha&&(i=t.producedFields(),H_(i,n)&&(this.setModified(),t.removeFormulas(n),t.producedFields.length===0&&t.remove()));for(const r of t.children)this.run(r,new Set([...n,...i]))}}class P$e extends eL{constructor(){super()}run(t){t instanceof Fr&&!t.isRequired()&&(this.setModified(),t.remove())}}class k$e extends mh{run(t){if(!JO(t)&&!(t.numChildren()>1)){for(const n of t.children)if(n instanceof Di)if(t instanceof Di)this.setModified(),t.merge(n);else{if(V_(t.producedFields(),n.dependentFields()))continue;this.setModified(),n.swapWithParent()}}}}class T$e extends mh{run(t){const n=[...t.children],i=t.children.filter(r=>r instanceof Di);if(t.numChildren()>1&&i.length>=1){const r={},s=new Set;for(const o of i){const a=o.parse;for(const l of oe(a))l in r?r[l]!==a[l]&&s.add(l):r[l]=a[l]}for(const o of s)delete r[o];if(!Nt(r)){this.setModified();const o=new Di(t,r);for(const a of n){if(a instanceof Di)for(const l of oe(r))delete a.parse[l];t.removeChild(a),a.parent=o,a instanceof Di&&oe(a.parse).length===0&&a.remove()}}}}}class M$e extends mh{run(t){t instanceof Fr||t.numChildren()>0||t instanceof eg||t instanceof Xd||(this.setModified(),t.remove())}}class I$e extends mh{run(t){const n=t.children.filter(r=>r instanceof ha),i=n.pop();for(const r of n)this.setModified(),i.merge(r)}}class _$e extends mh{run(t){const n=t.children.filter(r=>r instanceof mo),i={};for(const r of n){const s=ct(r.groupBy);s in i||(i[s]=[]),i[s].push(r)}for(const r of oe(i)){const s=i[r];if(s.length>1){const o=s.pop();for(const a of s)o.merge(a)&&(t.removeChild(a),a.parent=o,a.remove(),this.setModified())}}}}class O$e extends mh{constructor(t){super(),this.model=t}run(t){const n=!(JO(t)||t instanceof Zp||t instanceof Di||t instanceof ic),i=[],r=[];for(const s of t.children)s instanceof pa&&(n&&!V_(t.producedFields(),s.dependentFields())?i.push(s):r.push(s));if(i.length>0){const s=i.pop();for(const o of i)s.merge(o,this.model.renameSignal.bind(this.model));this.setModified(),t instanceof pa?t.merge(s,this.model.renameSignal.bind(this.model)):s.swapWithParent()}if(r.length>1){const s=r.pop();for(const o of r)s.merge(o,this.model.renameSignal.bind(this.model));this.setModified()}}}class L$e extends mh{run(t){const n=[...t.children];if(!op(n,o=>o instanceof Fr)||t.numChildren()<=1)return;const r=[];let s;for(const o of n)if(o instanceof Fr){let a=o;for(;a.numChildren()===1;){const[l]=a.children;if(l instanceof Fr)a=l;else break}r.push(...a.children),s?(t.removeChild(o),o.parent=s.parent,s.parent.removeChild(s),s.parent=a,this.setModified()):s=a}else r.push(o);if(r.length){this.setModified();for(const o of r)o.parent.removeChild(o),o.parent=s}}}class vh extends Ot{clone(){return new vh(null,Ue(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=oa(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){return t.as??ve(t)}hash(){return`JoinAggregateTransform ${ct(this.transform)}`}assemble(){const t=[],n=[],i=[];for(const s of this.transform.joinaggregate)n.push(s.op),i.push(this.getDefaultName(s)),t.push(s.field===void 0?null:s.field);const r=this.transform.groupby;return{type:"joinaggregate",as:i,ops:n,fields:t,...r!==void 0?{groupby:r}:{}}}}class yp extends Ot{clone(){return new yp(null,{...this.filter})}constructor(t,n){super(t),this.filter=n}static make(t,n,i){const{config:r,markDef:s}=n,{marks:o,scales:a}=i;if(o==="include-invalid-values"&&a==="include-invalid-values")return null;const l=n.reduceFieldDef((u,c,d)=>{const h=La(d)&&n.getScaleComponent(d);if(h){const p=h.get("type"),{aggregate:g}=c,v=wO({scaleChannel:d,markDef:s,config:r,scaleType:p,isCountAggregate:kx(g)});v!=="show"&&v!=="always-valid"&&(u[c.field]=c)}return u},{});return oe(l).length?new yp(t,l):null}dependentFields(){return new Set(oe(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${ct(this.filter)}`}assemble(){const t=oe(this.filter).reduce((n,i)=>{const r=this.filter[i],s=ve(r,{expr:"datum"});return r!==null&&(r.type==="temporal"?n.push(`(isDate(${s}) || (${Yk(s)}))`):r.type==="quantitative"&&n.push(Yk(s))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}function Yk(e){return`isValid(${e}) && isFinite(+${e})`}function N$e(e){return e.stack.stackBy.reduce((t,n)=>{const i=n.fieldDef,r=ve(i);return r&&t.push(r),t},[])}function $$e(e){return te(e)&&e.every(t=>be(t))&&e.length>1}class xl extends Ot{clone(){return new xl(null,Ue(this._stack))}constructor(t,n){super(t),this._stack=n}static makeFromTransform(t,n){const{stack:i,groupby:r,as:s,offset:o="zero"}=n,a=[],l=[];if(n.sort!==void 0)for(const d of n.sort)a.push(d.field),l.push(En(d.order,"ascending"));const u={field:a,order:l};let c;return $$e(s)?c=s:be(s)?c=[s,`${s}_end`]:c=[`${n.stack}_start`,`${n.stack}_end`],new xl(t,{dimensionFieldDefs:[],stackField:i,groupby:r,offset:o,sort:u,facetby:[],as:c})}static makeFromEncoding(t,n){const i=n.stack,{encoding:r}=n;if(!i)return null;const{groupbyChannels:s,fieldChannel:o,offset:a,impute:l}=i,u=s.map(p=>{const g=r[p];return xo(g)}).filter(p=>!!p),c=N$e(n),d=n.encoding.order;let h;if(te(d)||de(d))h=wY(d);else{const p=cX(d)?d.sort:o==="y"?"descending":"ascending";h=c.reduce((g,v)=>(g.field.includes(v)||(g.field.push(v),g.order.push(p)),g),{field:[],order:[]})}return new xl(t,{dimensionFieldDefs:u,stackField:n.vgField(o),facetby:[],stackby:c,sort:h,offset:a,impute:l,as:[n.vgField(o,{suffix:"start",forAs:!0}),n.vgField(o,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${ct(this._stack)}`}getGroupbyFields(){const{dimensionFieldDefs:t,impute:n,groupby:i}=this._stack;return t.length>0?t.map(r=>r.bin?n?[ve(r,{binSuffix:"mid"})]:[ve(r,{}),ve(r,{binSuffix:"end"})]:[ve(r)]).flat():i??[]}assemble(){const t=[],{facetby:n,dimensionFieldDefs:i,stackField:r,stackby:s,sort:o,offset:a,impute:l,as:u}=this._stack;if(l)for(const c of i){const{bandPosition:d=.5,bin:h}=c;if(h){const p=ve(c,{expr:"datum"}),g=ve(c,{expr:"datum",binSuffix:"end"});t.push({type:"formula",expr:`${Yk(p)} ? ${d}*${p}+${1-d}*${g} : ${p}`,as:ve(c,{binSuffix:"mid",forAs:!0})})}t.push({type:"impute",field:r,groupby:[...s,...n],key:ve(c,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:r,sort:o,as:u,offset:a}),t}}class tg extends Ot{clone(){return new tg(null,Ue(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=oa(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return(this.transform.groupby??[]).forEach(t.add,t),(this.transform.sort??[]).forEach(n=>t.add(n.field)),this.transform.window.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){return t.as??ve(t)}hash(){return`WindowTransform ${ct(this.transform)}`}assemble(){const t=[],n=[],i=[],r=[];for(const d of this.transform.window)n.push(d.op),i.push(this.getDefaultName(d)),r.push(d.param===void 0?null:d.param),t.push(d.field===void 0?null:d.field);const s=this.transform.frame,o=this.transform.groupby;if(s&&s[0]===null&&s[1]===null&&n.every(d=>Z_(d)))return{type:"joinaggregate",as:i,ops:n,fields:t,...o!==void 0?{groupby:o}:{}};const a=[],l=[];if(this.transform.sort!==void 0)for(const d of this.transform.sort)a.push(d.field),l.push(d.order??"ascending");const u={field:a,order:l},c=this.transform.ignorePeers;return{type:"window",params:r,as:i,ops:n,fields:t,sort:u,...c!==void 0?{ignorePeers:c}:{},...o!==void 0?{groupby:o}:{},...s!==void 0?{frame:s}:{}}}}function B$e(e){function t(n){if(!(n instanceof eg)){const i=n.clone();if(i instanceof Fr){const r=Qk+i.getSource();i.setSource(r),e.model.component.data.outputNodes[r]=i}else(i instanceof mo||i instanceof xl||i instanceof tg||i instanceof vh)&&i.addDimensions(e.fields);for(const r of n.children.flatMap(t))r.parent=i;return[i]}return n.children.flatMap(t)}return t}function Xk(e){if(e instanceof eg)if(e.numChildren()===1&&!(e.children[0]instanceof Fr)){const t=e.children[0];(t instanceof mo||t instanceof xl||t instanceof tg||t instanceof vh)&&t.addDimensions(e.fields),t.swapWithParent(),Xk(e)}else{const t=e.model.component.data.main;eJ(t);const n=B$e(e),i=e.children.map(n).flat();for(const r of i)r.parent=t}else e.children.map(Xk)}function eJ(e){if(e instanceof Fr&&e.type===ln.Main&&e.numChildren()===1){const t=e.children[0];t instanceof eg||(t.swapWithParent(),eJ(e))}}const Qk="scale_",qy=5;function Jk(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return!1;if(!Jk(t.children))return!1}return!0}function Qs(e,t){let n=!1;for(const i of t)n=e.optimize(i)||n;return n}function n5(e,t,n){let i=e.sources,r=!1;return r=Qs(new P$e,i)||r,r=Qs(new A$e(t),i)||r,i=i.filter(s=>s.numChildren()>0),r=Qs(new M$e,i)||r,i=i.filter(s=>s.numChildren()>0),n||(r=Qs(new k$e,i)||r,r=Qs(new O$e(t),i)||r,r=Qs(new D$e,i)||r,r=Qs(new T$e,i)||r,r=Qs(new _$e,i)||r,r=Qs(new I$e,i)||r,r=Qs(new F$e,i)||r,r=Qs(new L$e,i)||r),e.sources=i,r}function G$e(e,t){Jk(e.sources);let n=0,i=0;for(let r=0;r<qy&&n5(e,t,!0);r++)n++;e.sources.map(Xk);for(let r=0;r<qy&&n5(e,t,!1);r++)i++;Jk(e.sources),Math.max(n,i)===qy&&ce(`Maximum optimization runs(${qy}) reached.`)}class qn{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new qn(()=>t(n))}}function tJ(e){an(e)?z$e(e):H$e(e)}function z$e(e){const t=e.component.scales;for(const n of oe(t)){const i=W$e(e,n);if(t[n].setWithExplicit("domains",i),j$e(e,n),e.component.data.isFaceted){let s=e;for(;!Qr(s)&&s.parent;)s=s.parent;if(s.component.resolve.scale[n]==="shared")for(const a of i.value)pl(a)&&(a.data=Qk+a.data.replace(Qk,""))}}}function H$e(e){for(const n of e.children)tJ(n);const t=e.component.scales;for(const n of oe(t)){let i,r=null;for(const s of e.children){const o=s.component.scales[n];if(o){i===void 0?i=o.getWithExplicit("domains"):i=nc(i,o.getWithExplicit("domains"),"domains","scale",Zk);const a=o.get("selectionExtent");r&&a&&r.param!==a.param&&ce(IIe),r=a}}t[n].setWithExplicit("domains",i),r&&t[n].set("selectionExtent",r,!0)}}function V$e(e,t,n,i){if(e==="unaggregated"){const{valid:r,reason:s}=i5(t,n);if(!r){ce(s);return}}else if(e===void 0&&i.useUnaggregatedDomain){const{valid:r}=i5(t,n);if(r)return"unaggregated"}return e}function W$e(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:i}=e,r=V$e(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return r!==e.scaleDomain(t)&&(e.specifiedScales[t]={...e.specifiedScales[t],domain:r}),t==="x"&&Gn(i.x2)?Gn(i.x)?nc(gu(n,r,e,"x"),gu(n,r,e,"x2"),"domain","scale",Zk):gu(n,r,e,"x2"):t==="y"&&Gn(i.y2)?Gn(i.y)?nc(gu(n,r,e,"y"),gu(n,r,e,"y2"),"domain","scale",Zk):gu(n,r,e,"y2"):gu(n,r,e,t)}function U$e(e,t,n){return e.map(i=>({signal:`{data: ${Vx(i,{timeUnit:n,type:t})}}`}))}function FA(e,t,n){const i=Zn(n)?.unit;return t==="temporal"||i?U$e(e,t,i):[e]}function gu(e,t,n,i){const{encoding:r,markDef:s,mark:o,config:a,stack:l}=n,u=Gn(r[i]),{type:c}=u,d=u.timeUnit,h=NLe({invalid:Sa("invalid",s,a),isPath:Rc(o)});if(s_e(t)){const v=gu(e,void 0,n,i),C=FA(t.unionWith,c,d);return ea([...C,...v.value])}else{if(ke(t))return ea([t]);if(t&&t!=="unaggregated"&&!qY(t))return ea(FA(t,c,d))}if(l&&i===l.fieldChannel){if(l.offset==="normalize")return zr([[0,1]]);const v=n.requestDataName(h);return zr([{data:v,field:n.vgField(i,{suffix:"start"})},{data:v,field:n.vgField(i,{suffix:"end"})}])}const p=La(i)&&de(u)?q$e(n,i,e):void 0;if(Na(u)){const v=FA([u.datum],c,d);return zr(v)}const g=u;if(t==="unaggregated"){const{field:v}=u;return zr([{data:n.requestDataName(h),field:ve({field:v,aggregate:"min"})},{data:n.requestDataName(h),field:ve({field:v,aggregate:"max"})}])}else if(Ut(g.bin)){if(ei(e))return zr(e==="bin-ordinal"?[]:[{data:Vv(p)?n.requestDataName(h):n.requestDataName(ln.Raw),field:n.vgField(i,oC(g,i)?{binSuffix:"range"}:{}),sort:p===!0||!ye(p)?{field:n.vgField(i,{}),op:"min"}:p}]);{const{bin:v}=g;if(Ut(v)){const C=QO(n,g.field,v);return zr([new qn(()=>{const y=n.getSignalName(C);return`[${y}.start, ${y}.stop]`})])}else return zr([{data:n.requestDataName(h),field:n.vgField(i,{})}])}}else if(g.timeUnit&&at(["time","utc"],e)){const v=r[Oa(i)];if(uX(g,v,s,a)){const C=n.requestDataName(h),y=tc({fieldDef:g,fieldDef2:v,markDef:s,config:a}),b=Uv(o)&&y!==.5&&Fn(i);return zr([{data:C,field:n.vgField(i,b?{suffix:Yx}:{})},{data:C,field:n.vgField(i,{suffix:b?Xx:"end"})}])}}return zr(p?[{data:Vv(p)?n.requestDataName(h):n.requestDataName(ln.Raw),field:n.vgField(i),sort:p}]:[{data:n.requestDataName(h),field:n.vgField(i)}])}function AA(e,t){const{op:n,field:i,order:r}=e;return{op:n??(t?"sum":Bx),...i?{field:Ns(i)}:{},...r?{order:r}:{}}}function j$e(e,t){const n=e.component.scales[t],i=e.specifiedScales[t].domain,r=e.fieldDef(t)?.bin,s=qY(i)?i:void 0,o=dh(r)&&Tx(r.extent)?r.extent:void 0;(s||o)&&n.set("selectionExtent",s??o,!0)}function q$e(e,t,n){if(!ei(n))return;const i=e.fieldDef(t),r=i.sort;if(aX(r))return{op:"min",field:vp(i,t),order:"ascending"};const{stack:s}=e,o=s?new Set([...s.groupbyFields,...s.stackBy.map(a=>a.fieldDef.field)]):void 0;if(bl(r)){const a=s&&!o.has(r.field);return AA(r,a)}else if(N_e(r)){const{encoding:a,order:l}=r,u=e.fieldDef(a),{aggregate:c,field:d}=u,h=s&&!o.has(d);if(Tl(c)||xc(c))return AA({field:ve(u),order:l},h);if(Z_(c)||!c)return AA({op:c,field:d,order:l},h)}else{if(r==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(at(["ascending",void 0],r))return!0}}function i5(e,t){const{aggregate:n,type:i}=e;return n?be(n)&&!mIe.has(n)?{valid:!1,reason:l2e(n)}:i==="quantitative"&&t==="log"?{valid:!1,reason:u2e(e)}:{valid:!0}:{valid:!1,reason:a2e(e)}}function Zk(e,t,n,i){return e.explicit&&t.explicit&&ce(p2e(n,i,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function K$e(e){const t=oa(e.map(o=>{if(pl(o)){const{sort:a,...l}=o;return l}return o}),ct),n=oa(e.map(o=>{if(pl(o)){const a=o.sort;return a!==void 0&&!Vv(a)&&("op"in a&&a.op==="count"&&delete a.field,a.order==="ascending"&&delete a.order),a}}).filter(o=>o!==void 0),ct);if(t.length===0)return;if(t.length===1){const o=e[0];if(pl(o)&&n.length>0){let a=n[0];if(n.length>1){ce(hV);const l=n.filter(u=>ye(u)&&"op"in u&&u.op!=="min");n.every(u=>ye(u)&&"op"in u)&&l.length===1?a=l[0]:a=!0}else if(ye(a)&&"field"in a){const l=a.field;o.field===l&&(a=a.order?{order:a.order}:!0)}return{...o,sort:a}}return o}const i=oa(n.map(o=>Vv(o)||!("op"in o)||be(o.op)&&Ee(hIe,o.op)?o:(ce(m2e(o)),!0)),ct);let r;i.length===1?r=i[0]:i.length>1&&(ce(hV),r=!0);const s=oa(e.map(o=>pl(o)?o.data:null),o=>o);return s.length===1&&s[0]!==null?{data:s[0],fields:t.map(a=>a.field),...r?{sort:r}:{}}:{fields:t,...r?{sort:r}:{}}}function tL(e){if(pl(e)&&be(e.field))return e.field;if(vIe(e)){let t;for(const n of e.fields)if(pl(n)&&be(n.field)){if(!t)t=n.field;else if(t!==n.field)return ce(v2e),t}return ce(C2e),t}else if(CIe(e)){ce(y2e);const t=e.fields[0];return be(t)?t:void 0}}function tR(e,t){const i=e.component.scales[t].get("domains").map(r=>(pl(r)&&(r.data=e.lookupDataSource(r.data)),r));return K$e(i)}function nJ(e){return ng(e)||nL(e)?e.children.reduce((t,n)=>t.concat(nJ(n)),r5(e)):r5(e)}function r5(e){return oe(e.component.scales).reduce((t,n)=>{const i=e.component.scales[n];if(i.merged)return t;const r=i.combine(),{name:s,type:o,selectionExtent:a,domains:l,range:u,reverse:c,...d}=r,h=Y$e(r.range,s,n,e),p=tR(e,n),g=a?KLe(e,a,i,p):null;return t.push({name:s,type:o,...p?{domain:p}:{},...g?{domainRaw:g}:{},range:h,...c!==void 0?{reverse:c}:{},...d}),t},[])}function Y$e(e,t,n,i){if(Fn(n)){if(hh(e))return{step:{signal:`${t}_step`}}}else if(ye(e)&&pl(e))return{...e,data:i.lookupDataSource(e.data)};return e}class iJ extends Ql{constructor(t,n){super({},{name:t}),this.merged=!1,this.setWithExplicit("type",n)}domainHasZero(){const t=this.get("type");if(at([li.LOG,li.TIME,li.UTC],t))return"definitely-not";const n=this.get("zero");if(n===!0||n===void 0&&at([li.LINEAR,li.SQRT,li.POW],t))return"definitely";const i=this.get("domains");if(i.length>0){let r=!1,s=!1,o=!1;for(const a of i){if(te(a)){const l=a[0],u=a[a.length-1];if(xt(l)&&xt(u))if(l<=0&&u>=0){r=!0;continue}else{s=!0;continue}}o=!0}if(r)return"definitely";if(s&&!o)return"definitely-not"}return"maybe"}}const X$e=["range","scheme"];function Q$e(e){const t=e.component.scales;for(const n of J_){const i=t[n];if(!i)continue;const r=J$e(n,e);i.setWithExplicit("range",r)}}function s5(e,t){const n=e.fieldDef(t);if(n?.bin){const{bin:i,field:r}=n,s=Mr(t),o=e.getName(s);if(ye(i)&&i.binned&&i.step!==void 0)return new qn(()=>{const a=e.scaleName(t),l=`(domain("${a}")[1] - domain("${a}")[0]) / ${i.step}`;return`${e.getSignalName(o)} / (${l})`});if(Ut(i)){const a=QO(e,r,i);return new qn(()=>{const l=e.getSignalName(a),u=`(${l}.stop - ${l}.start) / ${l}.step`;return`${e.getSignalName(o)} / (${u})`})}}}function J$e(e,t){const n=t.specifiedScales[e],{size:i}=t,s=t.getScaleComponent(e).get("type");for(const d of X$e)if(n[d]!==void 0){const h=Ik(s,d),p=KY(e,d);if(!h)ce(AY(s,d,e));else if(p)ce(p);else switch(d){case"range":{const g=n.range;if(te(g)){if(Fn(e))return ea(g.map(v=>{if(v==="width"||v==="height"){const C=t.getName(v),y=t.getSignalName.bind(t);return qn.fromName(y,C)}return v}))}else if(ye(g))return ea({data:t.requestDataName(ln.Main),field:g.field,sort:{op:"min",field:t.vgField(e)}});return ea(g)}case"scheme":return ea(Z$e(n[d]))}}const o=e===tn||e==="xOffset"?"width":"height",a=i[o];if(Ra(a)){if(Fn(e))if(ei(s)){const d=sJ(a,t,e);if(d)return ea({step:d})}else ce(DY(o));else if(Z0(e)){const d=e===vc?"x":"y";if(t.getScaleComponent(d).get("type")==="band"){const g=oJ(a,s);if(g)return ea(g)}}}const{rangeMin:l,rangeMax:u}=n,c=eBe(e,t);return(l!==void 0||u!==void 0)&&Ik(s,"rangeMin")&&te(c)&&c.length===2?ea([l??c[0],u??c[1]]):zr(c)}function Z$e(e){return r_e(e)?{scheme:e.name,...Er(e,["name"])}:{scheme:e}}function rJ(e,t,n,{center:i}={}){const r=Mr(e),s=t.getName(r),o=t.getSignalName.bind(t);return e===ni&&bo(n)?i?[qn.fromName(a=>`${o(a)}/2`,s),qn.fromName(a=>`-${o(a)}/2`,s)]:[qn.fromName(o,s),0]:i?[qn.fromName(a=>`-${o(a)}/2`,s),qn.fromName(a=>`${o(a)}/2`,s)]:[0,qn.fromName(o,s)]}function eBe(e,t){const{size:n,config:i,mark:r,encoding:s}=t,{type:o}=Gn(s[e]),l=t.getScaleComponent(e).get("type"),{domain:u,domainMid:c}=t.specifiedScales[e];switch(e){case tn:case ni:{if(at(["point","band"],l)){const d=aJ(e,n,i.view);if(Ra(d))return{step:sJ(d,t,e)}}return rJ(e,t,l)}case vc:case Xp:return tBe(e,t,l);case ql:{const d=rBe(r,i),h=sBe(r,n,t,i);return cp(l)?iBe(d,h,nBe(l,i,u,e)):[d,h]}case zs:return[0,Math.PI*2];case uh:return[0,360];case _o:return[0,new qn(()=>{const d=t.getSignalName(Qr(t.parent)?"child_width":"width"),h=t.getSignalName(Qr(t.parent)?"child_height":"height");return`min(${d},${h})/2`})];case Cc:return{step:1e3/i.scale.framesPerSecond};case bc:return[i.scale.minStrokeWidth,i.scale.maxStrokeWidth];case Sc:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case Tr:return"symbol";case kr:case Ia:case _a:return l==="ordinal"?o==="nominal"?"category":"ordinal":c!==void 0?"diverging":r==="rect"||r==="geoshape"?"heatmap":"ramp";case Kl:case yc:case wc:return[i.scale.minOpacity,i.scale.maxOpacity]}}function sJ(e,t,n){const{encoding:i}=t,r=t.getScaleComponent(n),s=K_(n),o=i[s];if(zX({step:e,offsetIsDiscrete:qe(o)&&HY(o.type)})==="offset"&&bX(i,s)){const l=t.getScaleComponent(s);let c=`domain('${t.scaleName(s)}').length`;if(l.get("type")==="band"){const h=l.get("paddingInner")??l.get("padding")??0,p=l.get("paddingOuter")??l.get("padding")??0;c=`bandspace(${c}, ${h}, ${p})`}const d=r.get("paddingInner")??r.get("padding");return{signal:`${e.step} * ${c} / (1-${SIe(d)})`}}else return e.step}function oJ(e,t){if(zX({step:e,offsetIsDiscrete:ei(t)})==="offset")return{step:e.step}}function tBe(e,t,n){const i=e===vc?"x":"y",r=t.getScaleComponent(i);if(!r)return rJ(i,t,n,{center:!0});const s=r.get("type"),o=t.scaleName(i),{markDef:a,config:l}=t;if(s==="band"){const u=aJ(i,t.size,t.config.view);if(Ra(u)){const c=oJ(u,n);if(c)return c}return[0,{signal:`bandwidth('${o}')`}]}else{const u=t.encoding[i];if(de(u)&&u.timeUnit){const c=$Y(u.timeUnit,g=>`scale('${o}', ${g})`),d=t.config.scale.bandWithNestedOffsetPaddingInner,h=tc({fieldDef:u,markDef:a,config:l})-.5,p=h!==0?` + ${h}`:"";if(d){const g=ke(d)?`${d.signal}/2`+p:`${d/2+h}`,v=ke(d)?`(1 - ${d.signal}/2)`+p:`${1-d/2+h}`;return[{signal:`${g} * (${c})`},{signal:`${v} * (${c})`}]}return[0,{signal:c}]}return YK(`Cannot use ${e} scale if ${i} scale is not discrete.`)}}function aJ(e,t,n){const i=e===tn?"width":"height",r=t[i];return r||bS(n,i)}function nBe(e,t,n,i){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&te(n)?n.length+1:(ce(D2e(i)),3)}}function iBe(e,t,n){const i=()=>{const r=co(t),s=co(e),o=`(${r} - ${s}) / (${n} - 1)`;return`sequence(${s}, ${r} + ${o}, ${o})`};return ke(t)?new qn(i):{signal:i()}}function rBe(e,t){switch(e){case"bar":case"tick":return t.scale.minBandSize;case"line":case"trail":case"rule":return t.scale.minStrokeWidth;case"text":return t.scale.minFontSize;case"point":case"square":case"circle":return t.scale.minSize}throw new Error(Mx("size",e))}const o5=.95;function sBe(e,t,n,i){const r={x:s5(n,"x"),y:s5(n,"y")};switch(e){case"bar":case"tick":{if(i.scale.maxBandSize!==void 0)return i.scale.maxBandSize;const s=a5(t,r,i.view);return xt(s)?s-1:new qn(()=>`${s.signal} - 1`)}case"line":case"trail":case"rule":return i.scale.maxStrokeWidth;case"text":return i.scale.maxFontSize;case"point":case"square":case"circle":{if(i.scale.maxSize)return i.scale.maxSize;const s=a5(t,r,i.view);return xt(s)?Math.pow(o5*s,2):new qn(()=>`pow(${o5} * ${s.signal}, 2)`)}}throw new Error(Mx("size",e))}function a5(e,t,n){const i=Ra(e.width)?e.width.step:Nk(n,"width"),r=Ra(e.height)?e.height.step:Nk(n,"height");return t.x||t.y?new qn(()=>`min(${[t.x?t.x.signal:i,t.y?t.y.signal:r].join(", ")})`):Math.min(i,r)}function lJ(e,t){an(e)?oBe(e,t):cJ(e,t)}function oBe(e,t){const n=e.component.scales,{config:i,encoding:r,markDef:s,specifiedScales:o}=e;for(const a of oe(n)){const l=o[a],u=n[a],c=e.getScaleComponent(a),d=Gn(r[a]),h=l[t],p=c.get("type"),g=c.get("padding"),v=c.get("paddingInner"),C=Ik(p,t),y=KY(a,t);if(h!==void 0&&(C?y&&ce(y):ce(AY(p,t,a))),C&&y===void 0)if(h!==void 0){const b=d.timeUnit,S=d.type;switch(t){case"domainMax":case"domainMin":fh(l[t])||S==="temporal"||b?u.set(t,{signal:Vx(l[t],{type:S,timeUnit:b})},!0):u.set(t,l[t],!0);break;default:u.copyKeyFromObject(t,l)}}else{const b=ae(l5,t)?l5[t]({model:e,channel:a,fieldOrDatumDef:d,scaleType:p,scalePadding:g,scalePaddingInner:v,domain:l.domain,domainMin:l.domainMin,domainMax:l.domainMax,markDef:s,config:i,hasNestedOffsetScale:SX(r,a),hasSecondaryRangeChannel:!!r[Oa(a)]}):i.scale[t];b!==void 0&&u.set(t,b,!1)}}}const l5={bins:({model:e,fieldOrDatumDef:t})=>de(t)?aBe(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>lBe(e,t.type),nice:({scaleType:e,channel:t,domain:n,domainMin:i,domainMax:r,fieldOrDatumDef:s})=>uBe(e,t,n,i,r,s),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:i,config:r})=>cBe(e,t,r.scale,n,i,r.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,scaleType:i,config:r,hasNestedOffsetScale:s})=>dBe(e,t,n.type,i,r.scale,s),paddingOuter:({scalePadding:e,channel:t,scaleType:n,scalePaddingInner:i,config:r,hasNestedOffsetScale:s})=>hBe(e,t,n,i,r.scale,s),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:i})=>{const r=de(e)?e.sort:void 0;return fBe(t,r,n,i.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:i,scaleType:r,config:s,hasSecondaryRangeChannel:o})=>pBe(e,t,n,i,r,s.scale,o)};function uJ(e){an(e)?Q$e(e):cJ(e,"range")}function cJ(e,t){const n=e.component.scales;for(const i of e.children)t==="range"?uJ(i):lJ(i,t);for(const i of oe(n)){let r;for(const s of e.children){const o=s.component.scales[i];if(o){const a=o.getWithExplicit(t);r=nc(r,a,t,"scale",eQ((l,u)=>{switch(t){case"range":return l.step&&u.step?l.step-u.step:0}return 0}))}}n[i].setWithExplicit(t,r)}}function aBe(e,t){const n=t.bin;if(Ut(n)){const i=QO(e,t.field,n);return new qn(()=>e.getSignalName(i))}else if(oi(n)&&dh(n)&&n.step!==void 0)return{step:n.step}}function lBe(e,t){if(at([kr,Ia,_a],e)&&t!=="nominal")return"hcl"}function uBe(e,t,n,i,r,s){if(!(xo(s)?.bin||te(n)||r!=null||i!=null||at([li.TIME,li.UTC],e)))return Fn(t)?!0:void 0}function cBe(e,t,n,i,r,s){if(Fn(e)){if(aa(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:o,orient:a}=r;if(o==="bar"&&!(de(i)&&(i.bin||i.timeUnit))&&(a==="vertical"&&e==="x"||a==="horizontal"&&e==="y"))return s.continuousBandSize}if(t===li.POINT)return n.pointPadding}}function dBe(e,t,n,i,r,s=!1){if(e===void 0){if(Fn(t)){const{bandPaddingInner:o,barBandPaddingInner:a,rectBandPaddingInner:l,tickBandPaddingInner:u,bandWithNestedOffsetPaddingInner:c}=r;return s?c:En(o,n==="bar"?a:n==="tick"?u:l)}else if(Z0(t)&&i===li.BAND)return r.offsetBandPaddingInner}}function hBe(e,t,n,i,r,s=!1){if(e===void 0){if(Fn(t)){const{bandPaddingOuter:o,bandWithNestedOffsetPaddingOuter:a}=r;if(s)return a;if(n===li.BAND)return En(o,ke(i)?{signal:`${i.signal}/2`}:i/2)}else if(Z0(t)){if(n===li.POINT)return .5;if(n===li.BAND)return r.offsetBandPaddingOuter}}}function fBe(e,t,n,i){if(n==="x"&&i.xReverse!==void 0)return bo(e)&&t==="descending"?ke(i.xReverse)?{signal:`!${i.xReverse.signal}`}:!i.xReverse:i.xReverse;if(bo(e)&&t==="descending")return!0}function pBe(e,t,n,i,r,s,o){if(!!n&&n!=="unaggregated"&&bo(r)){if(te(n)){const l=n[0],u=n[n.length-1];if(xt(l)&&l<=0&&xt(u)&&u>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!cp(r))return!0;if(!(de(t)&&t.bin)&&at([...Yl,...iIe],e)){const{orient:l,type:u}=i;return at(["bar","area","line","trail"],u)&&(l==="horizontal"&&e==="y"||l==="vertical"&&e==="x")?!1:at(["bar","area"],u)&&!o?!0:s?.zero}return!1}function gBe(e,t,n,i,r=!1){const s=mBe(t,n,i,r),{type:o}=e;return La(t)?o!==void 0?d_e(t,o)?de(n)&&!c_e(o,n.type)?(ce(h2e(o,s)),s):o:(ce(d2e(t,o,s)),s):s:null}function mBe(e,t,n,i){switch(t.type){case"nominal":case"ordinal":{if(Ff(e)||gA(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&ce(mA(e,"ordinal")),"ordinal";if(pA(e))return"band";if(Fn(e)||Z0(e)){if(at(["rect","bar","image","rule","tick"],n.type)||i)return"band"}else if(n.type==="arc"&&e in Q_)return"band";const r=n[Mr(e)];return jd(r)||hp(t)&&t.axis?.tickBand?"band":"point"}case"temporal":return Ff(e)?"time":gA(e)==="discrete"?(ce(mA(e,"temporal")),"ordinal"):de(t)&&t.timeUnit&&Zn(t.timeUnit).utc?"utc":pA(e)?"band":"time";case"quantitative":return Ff(e)?de(t)&&Ut(t.bin)?"bin-ordinal":"linear":gA(e)==="discrete"?(ce(mA(e,"quantitative")),"ordinal"):pA(e)?"band":"linear";case"geojson":return}throw new Error(EY(t.type))}function vBe(e,{ignoreRange:t}={}){dJ(e),tJ(e);for(const n of u_e)lJ(e,n);t||uJ(e)}function dJ(e){an(e)?e.component.scales=CBe(e):e.component.scales=wBe(e)}function CBe(e){const{encoding:t,mark:n,markDef:i}=e,r={};for(const s of J_){const o=Gn(t[s]);if(o&&n===QY&&s===Tr&&o.type===Qp)continue;let a=o&&o.scale;if(o&&a!==null&&a!==!1){a??(a={});const l=SX(t,s),u=gBe(a,s,o,i,l);r[s]=new iJ(e.scaleName(`${s}`,!0),{value:u,explicit:a.type===u})}}return r}const yBe=eQ((e,t)=>pV(e)-pV(t));function wBe(e){var t;const n=e.component.scales={},i={},r=e.component.resolve;for(const s of e.children){dJ(s);for(const o of oe(s.component.scales))if((t=r.scale)[o]??(t[o]=HQ(o,e)),r.scale[o]==="shared"){const a=i[o],l=s.component.scales[o].getWithExplicit("type");a?Z2e(a.value,l.value)?i[o]=nc(a,l,"type","scale",yBe):(r.scale[o]="independent",delete i[o]):i[o]=l}}for(const s of oe(i)){const o=e.scaleName(s,!0),a=i[s];n[s]=new iJ(o,a);for(const l of e.children){const u=l.component.scales[s];u&&(l.renameScale(u.get("name"),o),u.merged=!0)}}return n}class DA{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function an(e){return e?.type==="unit"}function Qr(e){return e?.type==="facet"}function nL(e){return e?.type==="concat"}function ng(e){return e?.type==="layer"}class iL{constructor(t,n,i,r,s,o,a){this.type=n,this.parent=i,this.config=s,this.parent=i,this.config=s,this.view=ai(a),this.name=t.name??r,this.title=bu(t.title)?{text:t.title}:t.title?ai(t.title):void 0,this.scaleNameMap=i?i.scaleNameMap:new DA,this.projectionNameMap=i?i.projectionNameMap:new DA,this.signalNameMap=i?i.signalNameMap:new DA,this.data=t.data,this.description=t.description,this.transforms=ELe(t.transform??[]),this.layout=n==="layer"||n==="unit"?{}:POe(t,n,s),this.component={data:{sources:i?i.component.data.sources:[],outputNodes:i?i.component.data.outputNodes:{},outputNodeRefCounts:i?i.component.data.outputNodeRefCounts:{},isFaceted:Gx(t)||i?.component.data.isFaceted&&t.data===void 0},layoutSize:new Ql,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:{scale:{},axis:{},legend:{},...o?Ue(o):{}},selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){vBe(this)}parseProjection(){JQ(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){qQ(this)}assembleEncodeFromView(t){const{style:n,...i}=t,r={};for(const s of oe(i)){const o=i[s];o!==void 0&&(r[s]=Kt(o))}return r}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=Kt(this.description)),this.type==="unit"||this.type==="layer")?{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height"),...n}:Nt(n)?void 0:n}assembleLayout(){if(!this.layout)return;const{spacing:t,...n}=this.layout,{component:i,config:r}=this,s=GNe(i.layoutHeaders,r);return{padding:t,...this.assembleDefaultLayout(),...n,...s?{titleBand:s}:{}}}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const i of Es)t[i].title&&n.push(_Ne(this,i));for(const i of qO)n=n.concat(ONe(this,i));return n}assembleAxes(){return bNe(this.component.axes,this.config)}assembleLegends(){return YQ(this)}assembleProjections(){return u$e(this)}assembleTitle(){const{encoding:t,...n}=this.title??{},i={...mY(this.config.title).nonMarkTitleProperties,...n,...t?{encode:{update:t}}:{}};if(i.text)return at(["unit","layer"],this.type)?at(["middle",void 0],i.anchor)&&(i.frame??(i.frame="group")):i.anchor??(i.anchor="start"),Nt(i)?void 0:i}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const i=this.assembleLayout();i&&(n.layout=i),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const r=!this.parent||Qr(this.parent)?nJ(this):[];r.length>0&&(n.scales=r);const s=this.assembleAxes();s.length>0&&(n.axes=s);const o=this.assembleLegends();return o.length>0&&(n.legends=o),n}getName(t){return en((this.name?`${this.name}_`:"")+t)}getDataName(t){return this.getName(ln[t].toLowerCase())}requestDataName(t){const n=this.getDataName(t),i=this.component.data.outputNodeRefCounts;return i[n]=(i[n]||0)+1,n}getSizeSignalRef(t){if(Qr(this.parent)){const n=GQ(t),i=Px(n),r=this.component.scales[i];if(r&&!r.merged){const s=r.get("type"),o=r.get("range");if(ei(s)&&hh(o)){const a=r.get("name"),l=tR(this,i),u=tL(l);if(u){const c=ve({aggregate:"distinct",field:u},{expr:"datum"});return{signal:BQ(a,r,c)}}else return ce(tO(i)),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(lY(t)&&La(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getScaleType(t){const n=this.getScaleComponent(t);return n?n.get("type"):void 0}getSelectionComponent(t,n){let i=this.component.selection[t];if(!i&&this.parent&&(i=this.parent.getSelectionComponent(t,n)),!i)throw new Error(AIe(n));return i}hasAxisOrientSignalRef(){return this.component.axes.x?.some(t=>t.hasOrientSignalRef())||this.component.axes.y?.some(t=>t.hasOrientSignalRef())}}class hJ extends iL{vgField(t,n={}){const i=this.fieldDef(t);if(i)return ve(i,n)}reduceFieldDef(t,n){return rOe(this.getMapping(),(i,r,s)=>{const o=xo(r);return o?t(i,o,s):i},n)}forEachFieldDef(t,n){PO(this.getMapping(),(i,r)=>{const s=xo(i);s&&t(s,r)},n)}}class nR extends Ot{clone(){return new nR(null,Ue(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ue(n);const i=this.transform.as??[void 0,void 0];this.transform.as=[i[0]??"value",i[1]??"density"];const r=this.transform.resolve??"shared";this.transform.resolve=r}dependentFields(){return new Set([this.transform.density,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${ct(this.transform)}`}assemble(){const{density:t,...n}=this.transform,i={type:"kde",field:t,...n};return i.resolve=this.transform.resolve,i}}class iR extends Ot{clone(){return new iR(null,Ue(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ue(n)}dependentFields(){return new Set([this.transform.extent])}producedFields(){return new Set([])}hash(){return`ExtentTransform ${ct(this.transform)}`}assemble(){const{extent:t,param:n}=this.transform;return{type:"extent",field:t,signal:n}}}class rR extends Ot{clone(){return new rR(this.parent,Ue(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ue(n);const{flatten:i,as:r=[]}=this.transform;this.transform.as=i.map((s,o)=>r[o]??s)}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${ct(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class sR extends Ot{clone(){return new sR(null,Ue(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ue(n);const i=this.transform.as??[void 0,void 0];this.transform.as=[i[0]??"key",i[1]??"value"]}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${ct(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class Pf extends Ot{clone(){return new Pf(null,Ue(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let i=0;for(const r of[[Lo,Oo],[$s,No]]){const s=r.map(o=>{const a=Gn(n.encoding[o]);return de(a)?a.field:Na(a)?{expr:`${a.datum}`}:So(a)?{expr:`${a.value}`}:void 0});(s[0]||s[1])&&(t=new Pf(t,s,null,n.getName(`geojson_${i++}`)))}if(n.channelHasField(Tr)){const r=n.typedFieldDef(Tr);r.type===Qp&&(t=new Pf(t,null,r.field,n.getName(`geojson_${i++}`)))}return t}constructor(t,n,i,r){super(t),this.fields=n,this.geojson=i,this.signal=r}dependentFields(){const t=(this.fields??[]).filter(be);return new Set([...this.geojson?[this.geojson]:[],...t])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${ct(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],{type:"geojson",...this.fields?{fields:this.fields}:{},...this.geojson?{geojson:this.geojson}:{},signal:this.signal}]}}class qv extends Ot{clone(){return new qv(null,this.projection,Ue(this.fields),Ue(this.as))}constructor(t,n,i,r){super(t),this.projection=n,this.fields=i,this.as=r}static parseAll(t,n){if(!n.projectionName())return t;for(const i of[[Lo,Oo],[$s,No]]){const r=i.map(o=>{const a=Gn(n.encoding[o]);return de(a)?a.field:Na(a)?{expr:`${a.datum}`}:So(a)?{expr:`${a.value}`}:void 0}),s=i[0]===$s?"2":"";(r[0]||r[1])&&(t=new qv(t,n.projectionName(),r,[n.getName(`x${s}`),n.getName(`y${s}`)]))}return t}dependentFields(){return new Set(this.fields.filter(be))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${ct(this.fields)} ${ct(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class wd extends Ot{clone(){return new wd(null,Ue(this.transform))}constructor(t,n){super(t),this.transform=n}dependentFields(){return new Set([this.transform.impute,this.transform.key,...this.transform.groupby??[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:i,step:r}=t;return{signal:`sequence(${[n,i,...r?[r]:[]].join(",")})`}}static makeFromTransform(t,n){return new wd(t,n)}static makeFromEncoding(t,n){const i=n.encoding,r=i.x,s=i.y;if(de(r)&&de(s)){const o=r.impute?r:s.impute?s:void 0;if(o===void 0)return;const a=r.impute?s:s.impute?r:void 0,{method:l,value:u,frame:c,keyvals:d}=o.impute,h=EX(n.mark,i);return new wd(t,{impute:o.field,key:a.field,...l?{method:l}:{},...u!==void 0?{value:u}:{},...c?{frame:c}:{},...d!==void 0?{keyvals:d}:{},...h.length?{groupby:h}:{}})}return null}hash(){return`Impute ${ct(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:i,method:r,groupby:s,value:o,frame:a=[null,null]}=this.transform,l={type:"impute",field:t,key:n,...i?{keyvals:oLe(i)?this.processSequence(i):i}:{},method:"value",...s?{groupby:s}:{},value:!r||r==="value"?o:null};if(r&&r!=="value"){const u={type:"window",as:[`imputed_${t}_value`],ops:[r],fields:[t],frame:a,ignorePeers:!1,...s?{groupby:s}:{}},c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[l,u,c]}else return[l]}}class oR extends Ot{clone(){return new oR(null,Ue(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ue(n);const i=this.transform.as??[void 0,void 0];this.transform.as=[i[0]??n.on,i[1]??n.loess]}dependentFields(){return new Set([this.transform.loess,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${ct(this.transform)}`}assemble(){const{loess:t,on:n,...i}=this.transform;return{type:"loess",x:n,y:t,...i}}}class Kv extends Ot{clone(){return new Kv(null,Ue(this.transform),this.secondary)}constructor(t,n,i){super(t),this.transform=n,this.secondary=i}static make(t,n,i,r){const s=n.component.data.sources,{from:o}=i;let a=null;if(aLe(o)){let l=gJ(o.data,s);l||(l=new Xd(o.data),s.push(l));const u=n.getName(`lookup_${r}`);a=new Fr(l,u,ln.Lookup,n.component.data.outputNodeRefCounts),n.component.data.outputNodes[u]=a}else if(lLe(o)){const l=o.param;i={as:l,...i};let u;try{u=n.getSelectionComponent(en(l),l)}catch{throw new Error(TIe(l))}if(a=u.materialized,!a)throw new Error(MIe(l))}return new Kv(t,i,a.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?we(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${ct({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t={values:this.transform.from.fields,...this.transform.as?{as:we(this.transform.as)}:{}};else{let n=this.transform.as;be(n)||(ce(VIe),n="_lookup"),t={as:[n]}}return{type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup],...t,...this.transform.default?{default:this.transform.default}:{}}}}class aR extends Ot{clone(){return new aR(null,Ue(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ue(n);const i=this.transform.as??[void 0,void 0];this.transform.as=[i[0]??"prob",i[1]??"value"]}dependentFields(){return new Set([this.transform.quantile,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${ct(this.transform)}`}assemble(){const{quantile:t,...n}=this.transform;return{type:"quantile",field:t,...n}}}class lR extends Ot{clone(){return new lR(null,Ue(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ue(n);const i=this.transform.as??[void 0,void 0];this.transform.as=[i[0]??n.on,i[1]??n.regression]}dependentFields(){return new Set([this.transform.regression,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${ct(this.transform)}`}assemble(){const{regression:t,on:n,...i}=this.transform;return{type:"regression",x:n,y:t,...i}}}class uR extends Ot{clone(){return new uR(null,Ue(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=oa((this.transform.groupby??[]).concat(t),n=>n)}producedFields(){}dependentFields(){return new Set([this.transform.pivot,this.transform.value,...this.transform.groupby??[]])}hash(){return`PivotTransform ${ct(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:i,limit:r,op:s}=this.transform;return{type:"pivot",field:t,value:n,...r!==void 0?{limit:r}:{},...s!==void 0?{op:s}:{},...i!==void 0?{groupby:i}:{}}}}class cR extends Ot{clone(){return new cR(null,Ue(this.transform))}constructor(t,n){super(t),this.transform=n}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${ct(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function fJ(e){let t=0;function n(i,r){if(i instanceof Xd&&!i.isGenerator&&!pp(i.data)&&(e.push(r),r={name:null,source:r.name,transform:[]}),i instanceof Di&&(i.parent instanceof Xd&&!r.source?(r.format={...r.format,parse:i.assembleFormatParse()},r.transform.push(...i.assembleTransforms(!0))):r.transform.push(...i.assembleTransforms())),i instanceof eg){r.name||(r.name=`data_${t++}`),!r.source||r.transform.length>0?(e.push(r),i.data=r.name):i.data=r.source,e.push(...i.assemble());return}switch((i instanceof uC||i instanceof cC||i instanceof yp||i instanceof Zp||i instanceof mp||i instanceof qv||i instanceof mo||i instanceof Kv||i instanceof tg||i instanceof vh||i instanceof sR||i instanceof rR||i instanceof nR||i instanceof oR||i instanceof aR||i instanceof lR||i instanceof ic||i instanceof cR||i instanceof uR||i instanceof iR)&&r.transform.push(i.assemble()),(i instanceof pa||i instanceof ha||i instanceof wd||i instanceof xl||i instanceof Pf)&&r.transform.push(...i.assemble()),i instanceof Fr&&(r.source&&r.transform.length===0?i.setSource(r.source):i.parent instanceof Fr?i.setSource(r.name):(r.name||(r.name=`data_${t++}`),i.setSource(r.name),i.numChildren()===1&&(e.push(r),r={name:null,source:r.name,transform:[]}))),i.numChildren()){case 0:i instanceof Fr&&(!r.source||r.transform.length>0)&&e.push(r);break;case 1:n(i.children[0],r);break;default:{r.name||(r.name=`data_${t++}`);let s=r.name;!r.source||r.transform.length>0?e.push(r):s=r.source;for(const o of i.children)n(o,{name:null,source:s,transform:[]});break}}}return n}function bBe(e){const t=[],n=fJ(t);for(const i of e.children)n(i,{source:e.name,name:null,transform:[]});return t}function SBe(e,t){const n=[],i=fJ(n);let r=0;for(const o of e.sources){o.hasName()||(o.dataName=`source_${r++}`);const a=o.assemble();i(o,a)}for(const o of n)o.transform.length===0&&delete o.transform;let s=0;for(const[o,a]of n.entries())(a.transform??[]).length===0&&!a.source&&n.splice(s++,0,n.splice(o,1)[0]);for(const o of n)for(const a of o.transform??[])a.type==="lookup"&&(a.from=e.outputNodes[a.from].getSource());for(const o of n)o.name in t&&(o.values=t[o.name]);return n}function xBe(e){return e==="top"||e==="left"||ke(e)?"header":"footer"}function RBe(e){for(const t of Es)EBe(e,t);u5(e,"x"),u5(e,"y")}function EBe(e,t){const{facet:n,config:i,child:r,component:s}=e;if(e.channelHasField(t)){const o=n[t],a=Cp("title",null,i,t);let l=Af(o,i,{allowDisabling:!0,includeDefault:a===void 0||!!a});r.component.layoutHeaders[t].title&&(l=te(l)?l.join(", "):l,l+=` / ${r.component.layoutHeaders[t].title}`,r.component.layoutHeaders[t].title=null);const u=Cp("labelOrient",o.header,i,t),c=o.header!==null?En(o.header?.labels,i.header.labels,!0):!1,d=at(["bottom","right"],u)?"footer":"header";s.layoutHeaders[t]={title:o.header!==null?l:null,facetFieldDef:o,[d]:t==="facet"?[]:[pJ(e,t,c)]}}}function pJ(e,t,n){const i=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(i)?e.child.getSizeSignalRef(i):void 0,axes:[]}}function u5(e,t){const{child:n}=e;if(n.component.axes[t]){const{layoutHeaders:i,resolve:r}=e.component;if(r.axis[t]=XO(r,t),r.axis[t]==="shared"){const s=t==="x"?"column":"row",o=i[s];for(const a of n.component.axes[t]){const l=xBe(a.get("orient"));o[l]??(o[l]=[pJ(e,s,!1)]);const u=Bm(a,"main",e.config,{header:!0});u&&o[l][0].axes.push(u),a.mainExtracted=!0}}}}function FBe(e){rL(e),ES(e,"width"),ES(e,"height")}function ABe(e){rL(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";ES(e,t),ES(e,n)}function rL(e){for(const t of e.children)t.parseLayoutSize()}function ES(e,t){const n=GQ(t),i=Px(n),r=e.component.resolve,s=e.component.layoutSize;let o;for(const a of e.children){const l=a.component.layoutSize.getWithExplicit(n),u=r.scale[i]??HQ(i,e);if(u==="independent"&&l.value==="step"){o=void 0;break}if(o){if(u==="independent"&&o.value!==l.value){o=void 0;break}o=nc(o,l,n,"")}else o=l}if(o){for(const a of e.children)e.renameSignal(a.getName(n),e.getName(t)),a.component.layoutSize.set(n,"merged",!1);s.setWithExplicit(t,o)}else s.setWithExplicit(t,{explicit:!1,value:void 0})}function DBe(e){const{size:t,component:n}=e;for(const i of Yl){const r=Mr(i);if(t[r]){const s=t[r];n.layoutSize.set(r,Ra(s)?"step":s,!0)}else{const s=PBe(e,r);n.layoutSize.set(r,s,!1)}}}function PBe(e,t){const n=t==="width"?"x":"y",i=e.config,r=e.getScaleComponent(n);if(r){const s=r.get("type"),o=r.get("range");if(ei(s)){const a=bS(i.view,t);return hh(o)||Ra(a)?"step":a}else return Lk(i.view,t)}else{if(e.hasProjection||e.mark==="arc")return Lk(i.view,t);{const s=bS(i.view,t);return Ra(s)?s.step:s}}}function eT(e,t,n){return ve(t,{suffix:`by_${ve(e)}`,...n})}class sv extends hJ{constructor(t,n,i,r){super(t,"facet",n,i,r,t.resolve),this.child=uL(t.spec,this,this.getName("child"),void 0,r),this.children=[this.child],this.facet=this.initFacet(t.facet)}initFacet(t){if(!iC(t))return{facet:this.initFacetFieldDef(t,"facet")};const n=oe(t),i={};for(const r of n){if(![yl,wl].includes(r)){ce(Mx(r,"facet"));break}const s=t[r];if(s.field===void 0){ce(Tk(s,r));break}i[r]=this.initFacetFieldDef(s,r)}return i}initFacetFieldDef(t,n){const i=DO(t,n);return i.header?i.header=ai(i.header):i.header===null&&(i.header=null),i}channelHasField(t){return ae(this.facet,t)}fieldDef(t){return this.facet[t]}parseData(){this.component.data=dR(this),this.child.parseData()}parseLayoutSize(){rL(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection,Object.values(this.component.selection).some(t=>fa(t))&&iO(nO)}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),RBe(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){const t={};for(const n of Es)for(const i of KO){const r=this.component.layoutHeaders[n],s=r[i],{facetFieldDef:o}=r;if(o){const a=Cp("titleOrient",o.header,this.config,n);if(["right","bottom"].includes(a)){const l=Zx(n,a);t.titleAnchor??(t.titleAnchor={}),t.titleAnchor[l]="end"}}if(s?.[0]){const a=n==="row"?"height":"width",l=i==="header"?"headerBand":"footerBand";n!=="facet"&&!this.child.component.layoutSize.get(a)&&(t[l]??(t[l]={}),t[l][n]=.5),r.title&&(t.offset??(t.offset={}),t.offset[n==="row"?"rowTitle":"columnTitle"]=10)}}return t}assembleDefaultLayout(){const{column:t,row:n}=this.facet,i=t?this.columnDistinctSignal():n?1:void 0;let r="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(r="none"),{...this.getHeaderLayoutMixins(),...i?{columns:i}:{},bounds:"full",align:r}}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof sv))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroupStyle(){}assembleGroup(t){return this.parent&&this.parent instanceof sv?{...this.channelHasField("column")?{encode:{update:{columns:{field:ve(this.facet.column,{prefix:"distinct"})}}}}:{},...super.assembleGroup(t)}:super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],i=[];if(this.child instanceof sv){if(this.child.channelHasField("column")){const r=ve(this.child.facet.column);t.push(r),n.push("distinct"),i.push(`distinct_${r}`)}}else for(const r of Yl){const s=this.child.component.scales[r];if(s&&!s.merged){const o=s.get("type"),a=s.get("range");if(ei(o)&&hh(a)){const l=tR(this.child,r),u=tL(l);u?(t.push(u),n.push("distinct"),i.push(`distinct_${u}`)):ce(tO(r))}}}return{fields:t,ops:n,as:i}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:i,column:r}=this.facet,{fields:s,ops:o,as:a}=this.getCardinalityAggregateForChild(),l=[];for(const c of Es){const d=this.facet[c];if(d){l.push(ve(d));const{bin:h,sort:p}=d;if(Ut(h)&&l.push(ve(d,{binSuffix:"end"})),bl(p)){const{field:g,op:v=Bx}=p,C=eT(d,p);i&&r?(s.push(C),o.push("max"),a.push(C)):(s.push(g),o.push(v),a.push(C))}else if(te(p)){const g=vp(d,c);s.push(g),o.push("max"),a.push(g)}}}const u=!!i&&!!r;return{name:t,data:n,groupby:l,...u||s.length>0?{aggregate:{...u?{cross:u}:{},...s.length?{fields:s,ops:o,as:a}:{}}}:{}}}facetSortFields(t){const{facet:n}=this,i=n[t];return i?bl(i.sort)?[eT(i,i.sort,{expr:"datum"})]:te(i.sort)?[vp(i,t,{expr:"datum"})]:[ve(i,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,i=n[t];if(i){const{sort:r}=i;return[(bl(r)?r.order:!te(r)&&r)||"ascending"]}return[]}assembleLabelTitle(){const{facet:t,config:n}=this;if(t.facet)return qk(t.facet,"facet",n);const i={row:["top","bottom"],column:["left","right"]};for(const r of qO)if(t[r]){const s=Cp("labelOrient",t[r]?.header,n,r);if(i[r].includes(s))return qk(t[r],r,n)}}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,i=bBe(n),r=t.assembleGroupEncodeEntry(!1),s=this.assembleLabelTitle()||t.assembleTitle(),o=t.assembleGroupStyle();return[{name:this.getName("cell"),type:"group",...s?{title:s}:{},...o?{style:o}:{},from:{facet:this.assembleFacet()},sort:{field:Es.map(l=>this.facetSortFields(l)).flat(),order:Es.map(l=>this.facetSortOrder(l)).flat()},...i.length>0?{data:i}:{},...r?{encode:{update:r}}:{},...t.assembleGroup(WLe(this,[]))}]}getMapping(){return this.facet}}function kBe(e,t){const{row:n,column:i}=t;if(n&&i){let r=null;for(const s of[n,i])if(bl(s.sort)){const{field:o,op:a=Bx}=s.sort;e=r=new vh(e,{joinaggregate:[{op:a,field:o,as:eT(s,s.sort,{forAs:!0})}],groupby:[ve(s)]})}return r}return null}function gJ(e,t){for(const n of t){const i=n.data;if(e.name&&n.hasName()&&e.name!==n.dataName)continue;const r=e.format?.mesh,s=i.format?.feature;if(r&&s)continue;const o=e.format?.feature;if((o||s)&&o!==s)continue;const a=i.format?.mesh;if(!((r||a)&&r!==a)){if(jv(e)&&jv(i)){if(qr(e.values,i.values))return n}else if(pp(e)&&pp(i)){if(e.url===i.url)return n}else if(tQ(e)&&e.name===n.dataName)return n}}return null}function TBe(e,t){if(e.data||!e.parent){if(e.data===null){const i=new Xd({values:[]});return t.push(i),i}const n=gJ(e.data,t);if(n)return Gu(e.data)||(n.data.format=XK({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const i=new Xd(e.data);return t.push(i),i}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function MBe(e,t,n){let i=0;for(const r of t.transforms){let s,o;if(CLe(r))o=e=new mp(e,r),s="derived";else if(GO(r)){const a=S$e(r);o=e=Di.makeWithAncestors(e,{},a,n)??e,e=new Zp(e,t,r.filter)}else if(XX(r))o=e=pa.makeFromTransform(e,r,t),s="number";else if(wLe(r))s="date",n.getWithExplicit(r.field).value===void 0&&(e=new Di(e,{[r.field]:s}),n.set(r.field,s,!1)),o=e=ha.makeFromTransform(e,r);else if(bLe(r))o=e=mo.makeFromTransform(e,r),s="number",jO(t)&&(e=new ic(e));else if(YX(r))o=e=Kv.make(e,t,r,i++),s="derived";else if(gLe(r))o=e=new tg(e,r),s="number";else if(mLe(r))o=e=new vh(e,r),s="number";else if(SLe(r))o=e=xl.makeFromTransform(e,r),s="derived";else if(xLe(r))o=e=new sR(e,r),s="derived";else if(RLe(r))o=e=new iR(e,r),s="derived";else if(vLe(r))o=e=new rR(e,r),s="derived";else if(uLe(r))o=e=new uR(e,r),s="derived";else if(pLe(r))e=new cR(e,r);else if(yLe(r))o=e=wd.makeFromTransform(e,r),s="derived";else if(cLe(r))o=e=new nR(e,r),s="derived";else if(dLe(r))o=e=new aR(e,r),s="derived";else if(hLe(r))o=e=new lR(e,r),s="derived";else if(fLe(r))o=e=new oR(e,r),s="derived";else{ce(HIe(r));continue}if(o&&s!==void 0)for(const a of o.producedFields()??[])n.set(a,s,!1)}return e}function dR(e){let t=TBe(e,e.component.data.sources);const{outputNodes:n,outputNodeRefCounts:i}=e.component.data,r=e.data,o=!(r&&(Gu(r)||pp(r)||jv(r)))&&e.parent?e.parent.component.data.ancestorParse.clone():new LLe;Gu(r)?(nQ(r)?t=new cC(t,r.sequence):zO(r)&&(t=new uC(t,r.graticule)),o.parseNothing=!0):r?.format?.parse===null&&(o.parseNothing=!0),t=Di.makeExplicit(t,e,o)??t,t=new ic(t);const a=e.parent&&ng(e.parent);(an(e)||Qr(e))&&a&&(t=pa.makeFromEncoding(t,e)??t),e.transforms.length>0&&(t=MBe(t,e,o));const l=R$e(e),u=x$e(e);t=Di.makeWithAncestors(t,{},{...l,...u},o)??t,an(e)&&(t=Pf.parseAll(t,e),t=qv.parseAll(t,e)),(an(e)||Qr(e))&&(a||(t=pa.makeFromEncoding(t,e)??t),t=ha.makeFromEncoding(t,e)??t,t=mp.parseAllForSortIndex(t,e));const c=t=Ky(ln.Raw,e,t);if(an(e)){const C=mo.makeFromEncoding(t,e);C&&(t=C,jO(e)&&(t=new ic(t))),t=wd.makeFromEncoding(t,e)??t,t=xl.makeFromEncoding(t,e)??t}let d,h;if(an(e)){const{markDef:C,mark:y,config:b}=e,S=Lt("invalid",C,b),{marks:x,scales:E}=h=rQ({invalid:S,isPath:Rc(y)});x!==E&&E==="include-invalid-values"&&(d=t=Ky(ln.PreFilterInvalid,e,t)),x==="exclude-invalid-values"&&(t=yp.make(t,e,h)??t)}const p=t=Ky(ln.Main,e,t);let g;if(an(e)&&h){const{marks:C,scales:y}=h;C==="include-invalid-values"&&y==="exclude-invalid-values"&&(t=yp.make(t,e,h)??t,g=t=Ky(ln.PostFilterInvalid,e,t))}an(e)&&yNe(e,p);let v=null;if(Qr(e)){const C=e.getName("facet");t=kBe(t,e.facet)??t,v=new eg(t,e,C,p.getSource()),n[C]=v}return{...e.component.data,outputNodes:n,outputNodeRefCounts:i,raw:c,main:p,facetRoot:v,ancestorParse:o,preFilterInvalid:d,postFilterInvalid:g}}function Ky(e,t,n){const{outputNodes:i,outputNodeRefCounts:r}=t.component.data,s=t.getDataName(e),o=new Fr(n,s,e,r);return i[s]=o,o}class IBe extends iL{constructor(t,n,i,r){super(t,"concat",n,i,r,t.resolve),(t.resolve?.axis?.x==="shared"||t.resolve?.axis?.y==="shared")&&ce(BIe),this.children=this.getChildren(t).map((s,o)=>uL(s,this,this.getName(`concat_${o}`),void 0,r))}parseData(){this.component.data=dR(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of oe(t.component.selection))this.component.selection[n]=t.component.selection[n]}Object.values(this.component.selection).some(t=>fa(t))&&iO(nO)}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return jx(t)?t.vconcat:$O(t)?t.hconcat:t.concat}parseLayoutSize(){ABe(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=YO(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),i=t.assembleGroupStyle(),r=t.assembleGroupEncodeEntry(!1);return{type:"group",name:t.getName("group"),...n?{title:n}:{},...i?{style:i}:{},...r?{encode:{update:r}}:{},...t.assembleGroup()}})}assembleGroupStyle(){}assembleDefaultLayout(){const t=this.layout.columns;return{...t!=null?{columns:t}:{},bounds:"full",align:"each"}}}function _Be(e){return e===!1||e===null}const OBe={disable:1,gridScale:1,scale:1,...yX,labelExpr:1,encode:1},mJ=oe(OBe);class sL extends Ql{constructor(t={},n={},i=!1){super(),this.explicit=t,this.implicit=n,this.mainExtracted=i}clone(){return new sL(Ue(this.explicit),Ue(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!_Be(this.get(t))}hasOrientSignalRef(){return ke(this.explicit.orient)}}function LBe(e,t,n){const{encoding:i,config:r}=e,s=Gn(i[t])??Gn(i[Oa(t)]),o=e.axis(t)||{},{format:a,formatType:l}=o;if(qd(l))return{text:ho({fieldOrDatumDef:s,field:"datum.value",format:a,formatType:l,config:r}),...n};if(a===void 0&&l===void 0&&r.customFormatTypes){if(dp(s)==="quantitative"){if(hp(s)&&s.stack==="normalize"&&r.normalizedNumberFormatType)return{text:ho({fieldOrDatumDef:s,field:"datum.value",format:r.normalizedNumberFormat,formatType:r.normalizedNumberFormatType,config:r}),...n};if(r.numberFormatType)return{text:ho({fieldOrDatumDef:s,field:"datum.value",format:r.numberFormat,formatType:r.numberFormatType,config:r}),...n}}if(dp(s)==="temporal"&&r.timeFormatType&&de(s)&&!s.timeUnit)return{text:ho({fieldOrDatumDef:s,field:"datum.value",format:r.timeFormat,formatType:r.timeFormatType,config:r}),...n}}return n}function NBe(e){return Yl.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[WBe(n,e)]),t),{})}const $Be={bottom:"top",top:"bottom",left:"right",right:"left"};function BBe(e){const{axes:t,resolve:n}=e.component,i={top:0,bottom:0,right:0,left:0};for(const r of e.children){r.parseAxesAndHeaders();for(const s of oe(r.component.axes))n.axis[s]=XO(e.component.resolve,s),n.axis[s]==="shared"&&(t[s]=GBe(t[s],r.component.axes[s]),t[s]||(n.axis[s]="independent",delete t[s]))}for(const r of Yl){for(const s of e.children)if(s.component.axes[r]){if(n.axis[r]==="independent"){t[r]=(t[r]??[]).concat(s.component.axes[r]);for(const o of s.component.axes[r]){const{value:a,explicit:l}=o.getWithExplicit("orient");if(!ke(a)){if(i[a]>0&&!l){const u=$Be[a];i[a]>i[u]&&o.set("orient",u,!1)}i[a]++}}}delete s.component.axes[r]}if(n.axis[r]==="independent"&&t[r]&&t[r].length>1)for(const[s,o]of(t[r]||[]).entries())s>0&&o.get("grid")&&!o.explicit.grid&&(o.implicit.grid=!1)}}function GBe(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let i=0;i<n;i++){const r=e[i],s=t[i];if(!!r!=!!s)return;if(r&&s){const o=r.getWithExplicit("orient"),a=s.getWithExplicit("orient");if(o.explicit&&a.explicit&&o.value!==a.value)return;e[i]=zBe(r,s)}}}else return t.map(n=>n.clone());return e}function zBe(e,t){for(const n of mJ){const i=nc(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(r,s)=>{switch(n){case"title":return xY(r,s);case"gridScale":return{explicit:r.explicit,value:En(r.value,s.value)}}return Kx(r,s,n,"axis")});e.setWithExplicit(n,i)}return e}function HBe(e,t,n,i,r){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(ke(n.labelAngle)?n.labelAngle:Wv(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===OQ(i,r))return!0}return e===n[t]}const VBe=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function WBe(e,t){let n=t.axis(e);const i=new sL,r=Gn(t.encoding[e]),{mark:s,config:o}=t,a=n?.orient||o[e==="x"?"axisX":"axisY"]?.orient||o.axis?.orient||PNe(e),l=t.getScaleComponent(e).get("type"),u=SNe(e,l,a,t.config),c=n!==void 0?!n:Uk("disable",o.style,n?.style,u).configValue;if(i.set("disable",c,n!==void 0),c)return i;n=n||{};const d=FNe(r,n,e,o.style,u),h=sX(n.formatType,r,l),p=rX(r,r.type,n.format,n.formatType,o,!0),g={fieldOrDatumDef:r,axis:n,channel:e,model:t,scaleType:l,orient:a,labelAngle:d,format:p,formatType:h,mark:s,config:o};for(const y of mJ){const b=y in KV?KV[y](g):bV(y)?n[y]:void 0,S=b!==void 0,x=HBe(b,y,n,t,e);if(S&&x)i.set(y,b,x);else{const{configValue:E=void 0,configFrom:A=void 0}=bV(y)&&y!=="values"?Uk(y,o.style,n.style,u):{},F=E!==void 0;S&&!F?i.set(y,b,x):(A!=="vgAxisConfig"||VBe.has(y)&&F||aC(E)||ke(E))&&i.set(y,E,!1)}}const v=n.encoding??{},C=CX.reduce((y,b)=>{if(!i.hasAxisPart(b))return y;const S=zQ(v[b]??{},t),x=b==="labels"?LBe(t,e,S):S;return x!==void 0&&!Nt(x)&&(y[b]={update:x}),y},{});return Nt(C)||i.set("encode",C,!!n.encoding||n.labelAngle!==void 0),i}function UBe({encoding:e,size:t}){for(const n of Yl){const i=Mr(n);Ra(t[i])&&Iu(e[n])&&(delete t[i],ce(DY(i)))}return t}const jBe={vgMark:"arc",encodeEntry:e=>({...Hs(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...er("x",e,{defaultPos:"mid"}),...er("y",e,{defaultPos:"mid"}),...Ml(e,"radius"),...Ml(e,"theta")})},qBe={vgMark:"area",encodeEntry:e=>({...Hs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"}),...SS("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"}),...SS("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"}),...UO(e)})},KBe={vgMark:"rect",encodeEntry:e=>({...Hs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Ml(e,"x"),...Ml(e,"y")})},YBe={vgMark:"shape",encodeEntry:e=>({...Hs(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})}),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[{type:"geoshape",projection:e.projectionName(),...n&&de(n)&&n.type===Qp?{field:ve(n,{expr:"datum"})}:{}}]}},XBe={vgMark:"image",encodeEntry:e=>({...Hs(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"}),...Ml(e,"x"),...Ml(e,"y"),...VO(e,"url")})},QBe={vgMark:"line",encodeEntry:e=>({...Hs(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...er("x",e,{defaultPos:"mid"}),...er("y",e,{defaultPos:"mid"}),...ui("size",e,{vgChannel:"strokeWidth"}),...UO(e)})},JBe={vgMark:"trail",encodeEntry:e=>({...Hs(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...er("x",e,{defaultPos:"mid"}),...er("y",e,{defaultPos:"mid"}),...ui("size",e),...UO(e)})};function oL(e,t){const{config:n}=e;return{...Hs(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...er("x",e,{defaultPos:"mid"}),...er("y",e,{defaultPos:"mid"}),...ui("size",e),...ui("angle",e),...ZBe(e,n,t)}}function ZBe(e,t,n){return n?{shape:{value:n}}:ui("shape",e)}const eGe={vgMark:"symbol",encodeEntry:e=>oL(e)},tGe={vgMark:"symbol",encodeEntry:e=>oL(e,"circle")},nGe={vgMark:"symbol",encodeEntry:e=>oL(e,"square")},iGe={vgMark:"rect",encodeEntry:e=>({...Hs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Ml(e,"x"),...Ml(e,"y")})},rGe={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:{...Hs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...SS("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"}),...SS("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"}),...ui("size",e,{vgChannel:"strokeWidth"})}}},sGe={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return{...Hs(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"}),...er("x",e,{defaultPos:"mid"}),...er("y",e,{defaultPos:"mid"}),...VO(e),...ui("size",e,{vgChannel:"fontSize"}),...ui("angle",e),...WV("align",oGe(e.markDef,n,t)),...WV("baseline",aGe(e.markDef,n,t)),...er("radius",e,{defaultPos:null}),...er("theta",e,{defaultPos:null})}}};function oGe(e,t,n){if(Lt("align",e,n)===void 0)return"center"}function aGe(e,t,n){if(Lt("baseline",e,n)===void 0)return"middle"}const lGe={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,i=n.orient,r=i==="horizontal"?"x":"y",s=i==="horizontal"?"y":"x",o=i==="horizontal"?"height":"width";return{...Hs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Ml(e,r),...er(s,e,{defaultPos:"mid",vgChannel:s==="y"?"yc":"xc"}),[o]:Kt(Lt("thickness",n,t))}}},Yy={arc:jBe,area:qBe,bar:KBe,circle:tGe,geoshape:YBe,image:XBe,line:QBe,point:eGe,rect:iGe,rule:rGe,square:nGe,text:sGe,tick:lGe,trail:JBe};function uGe(e){if(at([Nx,Ox,g_e],e.mark)){const t=EX(e.mark,e.encoding);if(t.length>0)return cGe(e,t)}else if(e.mark===Lx){const t=Pk.some(n=>Lt(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t)return dGe(e)}return aL(e)}const c5="faceted_path_";function cGe(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:c5+e.requestDataName(ln.Main),data:e.requestDataName(ln.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:aL(e,{fromPrefix:c5})}]}const d5="stack_group_";function dGe(e){const[t]=aL(e,{fromPrefix:d5}),n=e.scaleName(e.stack.fieldChannel),i=(u={})=>e.vgField(e.stack.fieldChannel,u),r=(u,c)=>{const d=[i({prefix:"min",suffix:"start",expr:c}),i({prefix:"max",suffix:"start",expr:c}),i({prefix:"min",suffix:"end",expr:c}),i({prefix:"max",suffix:"end",expr:c})];return`${u}(${d.map(h=>`scale('${n}',${h})`).join(",")})`};let s,o;e.stack.fieldChannel==="x"?(s={...sp(t.encode.update,["y","yc","y2","height",...Pk]),x:{signal:r("min","datum")},x2:{signal:r("max","datum")},clip:{value:!0}},o={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},t.encode.update={...Er(t.encode.update,["y","yc","y2"]),height:{field:{group:"height"}}}):(s={...sp(t.encode.update,["x","xc","x2","width"]),y:{signal:r("min","datum")},y2:{signal:r("max","datum")},clip:{value:!0}},o={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},t.encode.update={...Er(t.encode.update,["x","xc","x2"]),width:{field:{group:"width"}}});for(const u of Pk){const c=Sa(u,e.markDef,e.config);t.encode.update[u]?(s[u]=t.encode.update[u],delete t.encode.update[u]):c&&(s[u]=Kt(c)),c&&(t.encode.update[u]={value:0})}const a=[];if(e.stack.groupbyChannels?.length>0)for(const u of e.stack.groupbyChannels){const c=e.fieldDef(u),d=ve(c);d&&a.push(d),(c?.bin||c?.timeUnit)&&a.push(ve(c,{binSuffix:"end"}))}return s=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((u,c)=>{if(t.encode.update[c])return{...u,[c]:t.encode.update[c]};{const d=Sa(c,e.markDef,e.config);return d!==void 0?{...u,[c]:Kt(d)}:u}},s),s.stroke&&(s.strokeForeground={value:!0},s.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(ln.Main),name:d5+e.requestDataName(ln.Main),groupby:a,aggregate:{fields:[i({suffix:"start"}),i({suffix:"start"}),i({suffix:"end"}),i({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:s},marks:[{type:"group",encode:{update:o},marks:[t]}]}]}function hGe(e){const{encoding:t,stack:n,mark:i,markDef:r,config:s}=e,o=t.order;if(!(!te(o)&&So(o)&&Ak(o.value)||!o&&Ak(Lt("order",r,s)))){if((te(o)||de(o))&&!n)return wY(o,{expr:"datum"});if(Rc(i)){const a=r.orient==="horizontal"?"y":"x",l=t[a];if(de(l))return{field:a}}}}function aL(e,t={fromPrefix:""}){const{mark:n,markDef:i,encoding:r,config:s}=e,o=En(i.clip,fGe(e),pGe(e)),a=CY(i),l=r.key,u=hGe(e),c=gGe(e),d=Lt("aria",i,s),h=Yy[n].postEncodingTransform?Yy[n].postEncodingTransform(e):null;return[{name:e.getName("marks"),type:Yy[n].vgMark,...o?{clip:o}:{},...a?{style:a}:{},...l?{key:l.field}:{},...u?{sort:u}:{},...c||{},...d===!1?{aria:d}:{},from:{data:t.fromPrefix+e.requestDataName(ln.Main)},encode:{update:Yy[n].encodeEntry(e)},...h?{transform:h}:{}}]}function fGe(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t?.get("selectionExtent")||n?.get("selectionExtent")?!0:void 0}function pGe(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function gGe(e){if(!e.component.selection)return null;const t=oe(e.component.selection).length;let n=t,i=e.parent;for(;i&&n===0;)n=oe(i.component.selection).length,i=i.parent;return n?{interactive:t>0||e.mark==="geoshape"||!!e.encoding.tooltip||!!e.markDef.tooltip}:null}class vJ extends hJ{constructor(t,n,i,r={},s){super(t,"unit",n,i,s,void 0,xV(t)?t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[],this.correctDataNames=u=>(u.from?.data&&(u.from.data=this.lookupDataSource(u.from.data),"time"in this.encoding&&(u.from.data=u.from.data+oQ)),u.from?.facet?.data&&(u.from.facet.data=this.lookupDataSource(u.from.facet.data)),u);const o=xa(t.mark)?{...t.mark}:{type:t.mark},a=o.type;o.filled===void 0&&(o.filled=JOe(o,s,{graticule:t.data&&zO(t.data)}));const l=this.encoding=nOe(t.encoding||{},a,o.filled,s);this.markDef=jX(o,l,s),this.size=UBe({encoding:l,size:xV(t)?{...r,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}}:r}),this.stack=UX(this.markDef,l),this.specifiedScales=this.initScales(a,l),this.specifiedAxes=this.initAxes(l),this.specifiedLegends=this.initLegends(l),this.specifiedProjection=t.projection,this.selection=(t.params??[]).filter(u=>LO(u))}get hasProjection(){const{encoding:t}=this,n=this.mark===QY,i=t&&KMe.some(r=>qe(t[r]));return n||i}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return J_.reduce((i,r)=>{const s=Gn(n[r]);return s&&(i[r]=this.initScale(s.scale??{})),i},{})}initScale(t){const{domain:n,range:i}=t,r=ai(t);return te(n)&&(r.domain=n.map(Wr)),te(i)&&(r.range=i.map(Wr)),r}initAxes(t){return Yl.reduce((n,i)=>{const r=t[i];if(qe(r)||i===tn&&qe(t.x2)||i===ni&&qe(t.y2)){const s=qe(r)?r.axis:void 0;n[i]=s&&this.initAxis({...s})}return n},{})}initAxis(t){const n=oe(t),i={};for(const r of n){const s=t[r];i[r]=aC(s)?vY(s):Wr(s)}return i}initLegends(t){return sIe.reduce((n,i)=>{const r=Gn(t[i]);if(r&&aIe(i)){const s=r.legend;n[i]=s&&ai(s)}return n},{})}parseData(){this.component.data=dR(this)}parseLayoutSize(){DBe(this)}parseSelections(){this.component.selection=CNe(this,this.selection)}parseMarkGroup(){this.component.mark=uGe(this)}parseAxesAndHeaders(){this.component.axes=NBe(this)}assembleSelectionTopLevelSignals(t){return ULe(this,t)}assembleSignals(){return[...MQ(this),...VLe(this,[])]}assembleSelectionData(t){return jLe(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return YO(this)}assembleMarks(){let t=this.component.mark??[];return(!this.parent||!ng(this.parent))&&(t=cQ(this,t)),t.map(this.correctDataNames)}assembleGroupStyle(){const{style:t}=this.view||{};return t!==void 0?t:this.encoding.x||this.encoding.y?"cell":"view"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return Cd(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return xo(n)}typedFieldDef(t){const n=this.fieldDef(t);return or(n)?n:null}}class lL extends iL{constructor(t,n,i,r,s){super(t,"layer",n,i,s,t.resolve,t.view);const o={...r,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}};this.children=t.layer.map((a,l)=>{if(qx(a))return new lL(a,this,this.getName(`layer_${l}`),o,s);if(Xl(a))return new vJ(a,this,this.getName(`layer_${l}`),o,s);throw new Error(eO(a))})}parseData(){this.component.data=dR(this);for(const t of this.children)t.parseData()}parseLayoutSize(){FBe(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of oe(t.component.selection))this.component.selection[n]=t.component.selection[n]}Object.values(this.component.selection).some(t=>fa(t))&&iO(nO)}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){BBe(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),MQ(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),YO(this))}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleGroupStyle(){const t=new Set;for(const i of this.children)for(const r of we(i.assembleGroupStyle()))t.add(r);const n=Array.from(t);return n.length>1?n:n.length===1?n[0]:void 0}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return qLe(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),YQ(this))}}function uL(e,t,n,i,r){if(Gx(e))return new sv(e,t,n,r);if(qx(e))return new lL(e,t,n,i,r);if(Xl(e))return new vJ(e,t,n,i,r);if(FOe(e))return new IBe(e,t,n,r);throw new Error(eO(e))}function mGe(e,t={}){t.logger&&P2e(t.logger),t.fieldTitle&&gX(t.fieldTitle);try{const n=WX(Mp(t.config,e.config)),i=ZX(e,n),r=uL(i,null,"",void 0,n);return r.parse(),G$e(r.component.data,r),{spec:CGe(r,vGe(e,i.autosize,n,r),e.datasets,e.usermeta),normalized:i}}finally{t.logger&&k2e(),t.fieldTitle&&q_e()}}function vGe(e,t,n,i){const r=i.component.layoutSize.get("width"),s=i.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},i.hasAxisOrientSignalRef()&&(t.resize=!0)):be(t)&&(t={type:t}),r&&s&&ILe(t.type)){if(r==="step"&&s==="step")ce(aV()),t.type="pad";else if(r==="step"||s==="step"){const o=r==="step"?"width":"height";ce(aV(Px(o)));const a=o==="width"?"height":"width";t.type=_Le(a)}}return{...oe(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t},...OV(n,!1),...OV(e,!0)}}function CGe(e,t,n={},i){const r=e.config?GOe(e.config):void 0,s=SBe(e.component.data,n),o=e.assembleSelectionData(s),a=e.assembleProjections(),l=e.assembleTitle(),u=e.assembleGroupStyle(),c=e.assembleGroupEncodeEntry(!0);let d=e.assembleLayoutSignals();d=d.filter(g=>(g.name==="width"||g.name==="height")&&g.value!==void 0?(t[g.name]=+g.value,!1):!0);const{params:h,...p}=t;return{$schema:"https://vega.github.io/schema/vega/v5.json",...e.description?{description:e.description}:{},...p,...l?{title:l}:{},...u?{style:u}:{},...c?{encode:{update:c}}:{},data:o,...a.length>0?{projections:a}:{},...e.assembleGroup([...d,...e.assembleSelectionTopLevelSignals([]),...GX(h)]),...r?{config:r}:{},...i?{usermeta:i}:{}}}const yGe=HMe.version,wGe=Object.freeze(Object.defineProperty({__proto__:null,accessPathDepth:ap,accessPathWithDatum:W_,accessWithDatumToUnescapedPath:It,compile:mGe,contains:at,deepEqual:qr,deleteNestedProperty:hS,duplicate:Ue,entries:Zu,every:z_,fieldIntersection:V_,flatAccessWithDatum:JK,getFirstDefined:En,hasIntersection:H_,hasProperty:ae,hash:ct,internalField:tY,isBoolean:Vv,isEmpty:Nt,isEqual:WMe,isInternalField:nY,isNullOrFalse:Ak,isNumeric:xx,keys:oe,logicalExpr:iv,mergeDeep:XK,never:YK,normalize:ZX,normalizeAngle:Wv,omit:Er,pick:sp,prefixGenerator:Dk,removePathFromField:Yp,replaceAll:zd,replacePathInField:Ns,resetIdCounter:jMe,setEqual:QK,some:op,stringify:$t,titleCase:X0,unique:oa,uniqueId:eY,vals:pi,varName:en,version:yGe},Symbol.toStringTag,{value:"Module"}));function CJ(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var bGe="2.15.0",SGe={version:bGe};const Jh="#fff",h5="#888",xGe={background:"#333",view:{stroke:h5},title:{color:Jh,subtitleColor:Jh},style:{"guide-label":{fill:Jh},"guide-title":{fill:Jh}},axis:{domainColor:Jh,gridColor:h5,tickColor:Jh}},Uc="#4572a7",RGe={background:"#fff",arc:{fill:Uc},area:{fill:Uc},line:{stroke:Uc,strokeWidth:2},path:{stroke:Uc},rect:{fill:Uc},shape:{stroke:Uc},symbol:{fill:Uc,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},jc="#30a2da",PA="#cbcbcb",EGe="#999",FGe="#333",f5="#f0f0f0",p5="#333",AGe={arc:{fill:jc},area:{fill:jc},axis:{domainColor:PA,grid:!0,gridColor:PA,gridWidth:1,labelColor:EGe,labelFontSize:10,titleColor:FGe,tickColor:PA,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:f5,group:{fill:f5},legend:{labelColor:p5,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:p5,titleFontSize:14,titlePadding:10},line:{stroke:jc,strokeWidth:2},path:{stroke:jc,strokeWidth:.5},rect:{fill:jc},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:jc},bar:{binSpacing:2,fill:jc,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},qc="#000",DGe={group:{fill:"#e5e5e5"},arc:{fill:qc},area:{fill:qc},line:{stroke:qc},path:{stroke:qc},rect:{fill:qc},shape:{stroke:qc},symbol:{fill:qc,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},PGe=22,kGe="normal",g5="Benton Gothic, sans-serif",m5=11.5,TGe="normal",Kc="#82c6df",kA="Benton Gothic Bold, sans-serif",v5="normal",C5=13,om={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"]},MGe={background:"#ffffff",title:{anchor:"start",color:"#000000",font:kA,fontSize:PGe,fontWeight:kGe},arc:{fill:Kc},area:{fill:Kc},line:{stroke:Kc,strokeWidth:2},path:{stroke:Kc},rect:{fill:Kc},shape:{stroke:Kc},symbol:{fill:Kc,size:30},axis:{labelFont:g5,labelFontSize:m5,labelFontWeight:TGe,titleFont:kA,titleFontSize:C5,titleFontWeight:v5},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:g5,labelFontSize:m5,symbolType:"square",titleFont:kA,titleFontSize:C5,titleFontWeight:v5},range:{category:om["category-6"],diverging:om["fireandice-6"],heatmap:om["fire-7"],ordinal:om["fire-7"],ramp:om["fire-7"]}},Yc="#ab5787",Xy="#979797",IGe={background:"#f9f9f9",arc:{fill:Yc},area:{fill:Yc},line:{stroke:Yc},path:{stroke:Yc},rect:{fill:Yc},shape:{stroke:Yc},symbol:{fill:Yc,size:30},axis:{domainColor:Xy,domainWidth:.5,gridWidth:.2,labelColor:Xy,tickColor:Xy,tickWidth:.2,titleColor:Xy},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},Xc="#3e5c69",_Ge={background:"#fff",arc:{fill:Xc},area:{fill:Xc},line:{stroke:Xc},path:{stroke:Xc},rect:{fill:Xc},shape:{stroke:Xc},symbol:{fill:Xc},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},ps="#1696d2",y5="#000000",OGe="#FFFFFF",Qy="Lato",TA="Lato",LGe="Lato",NGe="#DEDDDD",$Ge=18,am={"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},BGe={background:OGe,title:{anchor:"start",fontSize:$Ge,font:Qy},axisX:{domain:!0,domainColor:y5,domainWidth:1,grid:!1,labelFontSize:12,labelFont:TA,labelAngle:0,tickColor:y5,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:Qy},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:NGe,gridWidth:1,labelFontSize:12,labelFont:TA,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:Qy,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:TA,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:Qy,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:am["six-groups-cat-1"],diverging:am["diverging-colors"],heatmap:am["diverging-colors"],ordinal:am["six-groups-seq"],ramp:am["shades-blue"]},area:{fill:ps},rect:{fill:ps},line:{color:ps,stroke:ps,strokeWidth:5},trail:{color:ps,stroke:ps,strokeWidth:0,size:1},path:{stroke:ps,strokeWidth:.5},point:{filled:!0},text:{font:LGe,color:ps,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:ps,stroke:null}},arc:{fill:ps},shape:{stroke:ps},symbol:{fill:ps,size:30}},Qc="#3366CC",w5="#ccc",Jy="Arial, sans-serif",GGe={arc:{fill:Qc},area:{fill:Qc},path:{stroke:Qc},rect:{fill:Qc},shape:{stroke:Qc},symbol:{stroke:Qc},circle:{fill:Qc},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:Jy,fontSize:12},"guide-title":{font:Jy,fontSize:12},"group-title":{font:Jy,fontSize:12}},title:{font:Jy,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:w5,tickColor:w5,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},cL=e=>e*(1/3+1),b5=cL(9),S5=cL(10),x5=cL(12),lm="Segoe UI",R5="wf_standard-font, helvetica, arial, sans-serif",E5="#252423",um="#605E5C",F5="transparent",zGe="#C8C6C4",Zs="#118DFF",HGe="#12239E",VGe="#E66C37",WGe="#6B007B",UGe="#E044A7",jGe="#744EC2",qGe="#D9B300",KGe="#D64550",yJ=Zs,wJ="#DEEFFF",A5=[wJ,yJ],YGe=[wJ,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",yJ],XGe={view:{stroke:F5},background:F5,font:lm,header:{titleFont:R5,titleFontSize:x5,titleColor:E5,labelFont:lm,labelFontSize:S5,labelColor:um},axis:{ticks:!1,grid:!1,domain:!1,labelColor:um,labelFontSize:b5,titleFont:R5,titleColor:E5,titleFontSize:x5,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:zGe,gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:Zs},line:{stroke:Zs,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:lm,fontSize:b5,fill:um},arc:{fill:Zs},area:{fill:Zs,line:!0,opacity:.6},path:{stroke:Zs},rect:{fill:Zs},point:{fill:Zs,filled:!0,size:75},shape:{stroke:Zs},symbol:{fill:Zs,strokeWidth:1.5,size:50},legend:{titleFont:lm,titleFontWeight:"bold",titleColor:um,labelFont:lm,labelFontSize:S5,labelColor:um,symbolType:"circle",symbolSize:75},range:{category:[Zs,HGe,VGe,WGe,UGe,jGe,qGe,KGe],diverging:A5,heatmap:A5,ordinal:YGe}},MA='IBM Plex Sans,system-ui,-apple-system,BlinkMacSystemFont,".sfnstext-regular",sans-serif',QGe='IBM Plex Sans Condensed, system-ui, -apple-system, BlinkMacSystemFont, ".SFNSText-Regular", sans-serif',IA=400,Zy={textPrimary:{g90:"#f4f4f4",g100:"#f4f4f4",white:"#161616",g10:"#161616"},textSecondary:{g90:"#c6c6c6",g100:"#c6c6c6",white:"#525252",g10:"#525252"},layerAccent01:{white:"#e0e0e0",g10:"#e0e0e0",g90:"#525252",g100:"#393939"},gridBg:{white:"#ffffff",g10:"#ffffff",g90:"#161616",g100:"#161616"}},JGe=["#8a3ffc","#33b1ff","#007d79","#ff7eb6","#fa4d56","#fff1f1","#6fdc8c","#4589ff","#d12771","#d2a106","#08bdba","#bae6ff","#ba4e00","#d4bbff"],ZGe=["#6929c4","#1192e8","#005d5d","#9f1853","#fa4d56","#570408","#198038","#002d9c","#ee538b","#b28600","#009d9a","#012749","#8a3800","#a56eff"];function hR({theme:e,background:t}){const n=["white","g10"].includes(e)?"light":"dark",i=Zy.gridBg[e],r=Zy.textPrimary[e],s=Zy.textSecondary[e],o=n==="dark"?JGe:ZGe,a=n==="dark"?"#d4bbff":"#6929c4";return{background:t,arc:{fill:a},area:{fill:a},path:{stroke:a},rect:{fill:a},shape:{stroke:a},symbol:{stroke:a},circle:{fill:a},view:{fill:i,stroke:i},group:{fill:i},title:{color:r,anchor:"start",dy:-15,fontSize:16,font:MA,fontWeight:600},axis:{labelColor:s,labelFontSize:12,labelFont:QGe,labelFontWeight:IA,titleColor:r,titleFontWeight:600,titleFontSize:12,grid:!0,gridColor:Zy.layerAccent01[e],labelAngle:0},axisX:{titlePadding:10},axisY:{titlePadding:2.5},style:{"guide-label":{font:MA,fill:s,fontWeight:IA},"guide-title":{font:MA,fill:s,fontWeight:IA}},range:{category:o,diverging:["#750e13","#a2191f","#da1e28","#fa4d56","#ff8389","#ffb3b8","#ffd7d9","#fff1f1","#e5f6ff","#bae6ff","#82cfff","#33b1ff","#1192e8","#0072c3","#00539a","#003a6d"],heatmap:["#f6f2ff","#e8daff","#d4bbff","#be95ff","#a56eff","#8a3ffc","#6929c4","#491d8b","#31135e","#1c0f30"]}}}const e3e=hR({theme:"white",background:"#ffffff"}),t3e=hR({theme:"g10",background:"#f4f4f4"}),n3e=hR({theme:"g90",background:"#262626"}),i3e=hR({theme:"g100",background:"#161616"}),r3e=SGe.version,s3e=Object.freeze(Object.defineProperty({__proto__:null,carbong10:t3e,carbong100:i3e,carbong90:n3e,carbonwhite:e3e,dark:xGe,excel:RGe,fivethirtyeight:AGe,ggplot2:DGe,googlecharts:GGe,latimes:MGe,powerbi:XGe,quartz:IGe,urbaninstitute:BGe,version:r3e,vox:_Ge},Symbol.toStringTag,{value:"Module"}));function o3e(e,t,n,i){if(te(e))return`[${e.map(r=>t(be(r)?r:D5(r,n))).join(", ")}]`;if(ye(e)){let r="";const{title:s,image:o,...a}=e;s&&(r+=`<h2>${t(s)}</h2>`),o&&(r+=`<img src="${new URL(t(o),i||location.href).href}">`);const l=Object.keys(a);if(l.length>0){r+="<table>";for(const u of l){let c=a[u];c!==void 0&&(ye(c)&&(c=D5(c,n)),r+=`<tr><td class="key">${t(u)}</td><td class="value">${t(c)}</td></tr>`)}r+="</table>"}return r||"{}"}return t(e)}function a3e(e){const t=[];return function(n,i){if(typeof i!="object"||i===null)return i;const r=t.indexOf(this)+1;return t.length=r,t.length>e?"[Object]":t.indexOf(i)>=0?"[Circular]":(t.push(i),i)}}function D5(e,t){return JSON.stringify(e,a3e(t))}var l3e=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black;
}
#vg-tooltip-element.visible {
  visibility: visible;
}
#vg-tooltip-element h2 {
  margin-top: 0;
  margin-bottom: 10px;
  font-size: 13px;
}
#vg-tooltip-element table {
  border-spacing: 0;
}
#vg-tooltip-element table tr {
  border: none;
}
#vg-tooltip-element table tr td {
  overflow: hidden;
  text-overflow: ellipsis;
  padding-top: 2px;
  padding-bottom: 2px;
}
#vg-tooltip-element table tr td.key {
  color: #808080;
  max-width: 150px;
  text-align: right;
  padding-right: 4px;
}
#vg-tooltip-element table tr td.value {
  display: block;
  max-width: 300px;
  max-height: 7em;
  text-align: left;
}
#vg-tooltip-element.dark-theme {
  background-color: rgba(32, 32, 32, 0.9);
  border: 1px solid #f5f5f5;
  color: white;
}
#vg-tooltip-element.dark-theme td.key {
  color: #bfbfbf;
}
`;const bJ="vg-tooltip-element",u3e={offsetX:10,offsetY:10,id:bJ,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:c3e,maxDepth:2,formatTooltip:o3e,baseURL:"",anchor:"cursor",position:["top","bottom","left","right","top-left","top-right","bottom-left","bottom-right"]};function c3e(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function d3e(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return l3e.toString().replace(bJ,e)}function SJ(e,t,{offsetX:n,offsetY:i}){const r=xJ({x1:e.clientX,x2:e.clientX,y1:e.clientY,y2:e.clientY},t,n,i),s=["bottom-right","bottom-left","top-right","top-left"];for(const o of s)if(RJ(r[o],t))return r[o];return r["top-left"]}function h3e(e,t,n,i,r){const{position:s,offsetX:o,offsetY:a}=r,l=e._el.getBoundingClientRect(),u=e._origin,c=f3e(l,u,n),d=xJ(c,i,o,a),h=Array.isArray(s)?s:[s];for(const p of h)if(RJ(d[p],i)&&!p3e(t,d[p],i))return d[p];return SJ(t,i,r)}function f3e(e,t,n){const i=n.isVoronoi?n.datum.bounds:n.bounds;let r=e.left+t[0]+i.x1,s=e.top+t[1]+i.y1,o=n;for(;o.mark.group;)o=o.mark.group,r+=o.x??0,s+=o.y??0;const a=i.x2-i.x1,l=i.y2-i.y1;return{x1:r,x2:r+a,y1:s,y2:s+l}}function xJ(e,t,n,i){const r=(e.x1+e.x2)/2,s=(e.y1+e.y2)/2,o=e.x1-t.width-n,a=r-t.width/2,l=e.x2+n,u=e.y1-t.height-i,c=s-t.height/2,d=e.y2+i;return{top:{x:a,y:u},bottom:{x:a,y:d},left:{x:o,y:c},right:{x:l,y:c},"top-left":{x:o,y:u},"top-right":{x:l,y:u},"bottom-left":{x:o,y:d},"bottom-right":{x:l,y:d}}}function RJ(e,t){return e.x>=0&&e.y>=0&&e.x+t.width<=window.innerWidth&&e.y+t.height<=window.innerHeight}function p3e(e,t,n){return e.clientX>=t.x&&e.clientX<=t.x+n.width&&e.clientY>=t.y&&e.clientY<=t.y+n.height}class g3e{constructor(t){this.options={...u3e,...t};const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const i=document.createElement("style");i.setAttribute("id",this.options.styleId),i.innerHTML=d3e(n);const r=document.head;r.childNodes.length>0?r.insertBefore(i,r.childNodes[0]):r.appendChild(i)}}tooltipHandler(t,n,i,r){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),(document.fullscreenElement??document.body).appendChild(this.el)),r==null||r===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=this.options.formatTooltip(r,this.options.sanitize,this.options.maxDepth,this.options.baseURL),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:s,y:o}=this.options.anchor==="mark"?h3e(t,n,i,this.el.getBoundingClientRect(),this.options):SJ(n,this.el.getBoundingClientRect(),this.options);this.el.style.top=`${o}px`,this.el.style.left=`${s}px`}}var _A={};/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var m3e=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var s in r)r.hasOwnProperty(s)&&(i[s]=r[s])},e(t,n)};return function(t,n){e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),v3e=Object.prototype.hasOwnProperty;function tT(e,t){return v3e.call(e,t)}function nT(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var i=[];for(var r in e)tT(e,r)&&i.push(r);return i}function Kr(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function iT(e){for(var t=0,n=e.length,i;t<n;){if(i=e.charCodeAt(t),i>=48&&i<=57){t++;continue}return!1}return!0}function ed(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function EJ(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function rT(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(rT(e[t]))return!0}else if(typeof e=="object"){for(var i=nT(e),r=i.length,s=0;s<r;s++)if(rT(e[i[s]]))return!0}}return!1}function P5(e,t){var n=[e];for(var i in t){var r=typeof t[i]=="object"?JSON.stringify(t[i],null,2):t[i];typeof r<"u"&&n.push(i+": "+r)}return n.join(`
`)}var FJ=function(e){m3e(t,e);function t(n,i,r,s,o){var a=this.constructor,l=e.call(this,P5(n,{name:i,index:r,operation:s,tree:o}))||this;return l.name=i,l.index=r,l.operation=s,l.tree=o,Object.setPrototypeOf(l,a.prototype),l.message=P5(n,{name:i,index:r,operation:s,tree:o}),l}return t}(Error),fn=FJ,C3e=Kr,gf={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var i=e[t];return delete e[t],{newDocument:n,removed:i}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:function(e,t,n){var i=FS(n,this.path);i&&(i=Kr(i));var r=bd(n,{op:"remove",path:this.from}).removed;return bd(n,{op:"add",path:this.path,value:r}),{newDocument:n,removed:i}},copy:function(e,t,n){var i=FS(n,this.from);return bd(n,{op:"add",path:this.path,value:Kr(i)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:Yv(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},y3e={add:function(e,t,n){return iT(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var i=e.splice(t,1);return{newDocument:n,removed:i[0]}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:gf.move,copy:gf.copy,test:gf.test,_get:gf._get};function FS(e,t){if(t=="")return e;var n={op:"_get",path:t};return bd(e,n),n.value}function bd(e,t,n,i,r,s){if(n===void 0&&(n=!1),i===void 0&&(i=!0),r===void 0&&(r=!0),s===void 0&&(s=0),n&&(typeof n=="function"?n(t,0,e,t.path):AS(t,0)),t.path===""){var o={newDocument:e};if(t.op==="add")return o.newDocument=t.value,o;if(t.op==="replace")return o.newDocument=t.value,o.removed=e,o;if(t.op==="move"||t.op==="copy")return o.newDocument=FS(e,t.from),t.op==="move"&&(o.removed=e),o;if(t.op==="test"){if(o.test=Yv(e,t.value),o.test===!1)throw new fn("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o.newDocument=e,o}else{if(t.op==="remove")return o.removed=e,o.newDocument=null,o;if(t.op==="_get")return t.value=e,o;if(n)throw new fn("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,t,e);return o}}else{i||(e=Kr(e));var a=t.path||"",l=a.split("/"),u=e,c=1,d=l.length,h=void 0,p=void 0,g=void 0;for(typeof n=="function"?g=n:g=AS;;){if(p=l[c],p&&p.indexOf("~")!=-1&&(p=EJ(p)),r&&(p=="__proto__"||p=="prototype"&&c>0&&l[c-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&h===void 0&&(u[p]===void 0?h=l.slice(0,c).join("/"):c==d-1&&(h=t.path),h!==void 0&&g(t,0,e,h)),c++,Array.isArray(u)){if(p==="-")p=u.length;else{if(n&&!iT(p))throw new fn("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,t,e);iT(p)&&(p=~~p)}if(c>=d){if(n&&t.op==="add"&&p>u.length)throw new fn("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,t,e);var o=y3e[t.op].call(t,u,p,e);if(o.test===!1)throw new fn("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o}}else if(c>=d){var o=gf[t.op].call(t,u,p,e);if(o.test===!1)throw new fn("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o}if(u=u[p],n&&c<d&&(!u||typeof u!="object"))throw new fn("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",s,t,e)}}}function fR(e,t,n,i,r){if(i===void 0&&(i=!0),r===void 0&&(r=!0),n&&!Array.isArray(t))throw new fn("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");i||(e=Kr(e));for(var s=new Array(t.length),o=0,a=t.length;o<a;o++)s[o]=bd(e,t[o],n,!0,r,o),e=s[o].newDocument;return s.newDocument=e,s}function w3e(e,t,n){var i=bd(e,t);if(i.test===!1)throw new fn("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return i.newDocument}function AS(e,t,n,i){if(typeof e!="object"||e===null||Array.isArray(e))throw new fn("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(gf[e.op]){if(typeof e.path!="string")throw new fn("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new fn('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new fn("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new fn("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&rT(e.value))throw new fn("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var r=e.path.split("/").length,s=i.split("/").length;if(r!==s+1&&r!==s)throw new fn("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==i)throw new fn("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var o={op:"_get",path:e.from,value:void 0},a=AJ([o],n);if(a&&a.name==="OPERATION_PATH_UNRESOLVABLE")throw new fn("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new fn("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function AJ(e,t,n){try{if(!Array.isArray(e))throw new fn("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)fR(Kr(t),Kr(e),n||!0);else{n=n||AS;for(var i=0;i<e.length;i++)n(e[i],i,t,void 0)}}catch(r){if(r instanceof fn)return r;throw r}}function Yv(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),i=Array.isArray(t),r,s,o;if(n&&i){if(s=e.length,s!=t.length)return!1;for(r=s;r--!==0;)if(!Yv(e[r],t[r]))return!1;return!0}if(n!=i)return!1;var a=Object.keys(e);if(s=a.length,s!==Object.keys(t).length)return!1;for(r=s;r--!==0;)if(!t.hasOwnProperty(a[r]))return!1;for(r=s;r--!==0;)if(o=a[r],!Yv(e[o],t[o]))return!1;return!0}return e!==e&&t!==t}var b3e=Object.freeze({__proto__:null,JsonPatchError:fn,_areEquals:Yv,applyOperation:bd,applyPatch:fR,applyReducer:w3e,deepClone:C3e,getValueByPointer:FS,validate:AJ,validator:AS});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */var dL=new WeakMap,S3e=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),x3e=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function R3e(e){return dL.get(e)}function E3e(e,t){return e.observers.get(t)}function F3e(e,t){e.observers.delete(t.callback)}function A3e(e,t){t.unobserve()}function D3e(e,t){var n=[],i,r=R3e(e);if(!r)r=new S3e(e),dL.set(e,r);else{var s=E3e(r,t);i=s&&s.observer}if(i)return i;if(i={},r.value=Kr(e),t){i.callback=t,i.next=null;var o=function(){sT(i)},a=function(){clearTimeout(i.next),i.next=setTimeout(o)};typeof window<"u"&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return i.patches=n,i.object=e,i.unobserve=function(){sT(i),clearTimeout(i.next),F3e(r,i),typeof window<"u"&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},r.observers.set(t,new x3e(t,i)),i}function sT(e,t){t===void 0&&(t=!1);var n=dL.get(e.object);hL(n.value,e.object,e.patches,"",t),e.patches.length&&fR(n.value,e.patches);var i=e.patches;return i.length>0&&(e.patches=[],e.callback&&e.callback(i)),i}function hL(e,t,n,i,r){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var s=nT(t),o=nT(e),a=!1,l=o.length-1;l>=0;l--){var u=o[l],c=e[u];if(tT(t,u)&&!(t[u]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var d=t[u];typeof c=="object"&&c!=null&&typeof d=="object"&&d!=null&&Array.isArray(c)===Array.isArray(d)?hL(c,d,n,i+"/"+ed(u),r):c!==d&&(r&&n.push({op:"test",path:i+"/"+ed(u),value:Kr(c)}),n.push({op:"replace",path:i+"/"+ed(u),value:Kr(d)}))}else Array.isArray(e)===Array.isArray(t)?(r&&n.push({op:"test",path:i+"/"+ed(u),value:Kr(c)}),n.push({op:"remove",path:i+"/"+ed(u)}),a=!0):(r&&n.push({op:"test",path:i,value:e}),n.push({op:"replace",path:i,value:t}))}if(!(!a&&s.length==o.length))for(var l=0;l<s.length;l++){var u=s[l];!tT(e,u)&&t[u]!==void 0&&n.push({op:"add",path:i+"/"+ed(u),value:Kr(t[u])})}}}function P3e(e,t,n){n===void 0&&(n=!1);var i=[];return hL(e,t,i,"",n),i}var k3e=Object.freeze({__proto__:null,compare:P3e,generate:sT,observe:D3e,unobserve:A3e});Object.assign({},b3e,k3e,{JsonPatchError:FJ,deepClone:Kr,escapePathComponent:ed,unescapePathComponent:EJ});function T3e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var OA,k5;function M3e(){if(k5)return OA;k5=1;class e{constructor(){this.max=1e3,this.map=new Map}get(n){const i=this.map.get(n);if(i!==void 0)return this.map.delete(n),this.map.set(n,i),i}delete(n){return this.map.delete(n)}set(n,i){if(!this.delete(n)&&i!==void 0){if(this.map.size>=this.max){const s=this.map.keys().next().value;this.delete(s)}this.map.set(n,i)}return this}}return OA=e,OA}var LA,T5;function fL(){if(T5)return LA;T5=1;const e=Object.freeze({loose:!0}),t=Object.freeze({});return LA=i=>i?typeof i!="object"?e:i:t,LA}var ew={exports:{}},NA,M5;function pL(){if(M5)return NA;M5=1;const e="2.0.0",t=256,n=Number.MAX_SAFE_INTEGER||9007199254740991,i=16,r=t-6;return NA={MAX_LENGTH:t,MAX_SAFE_COMPONENT_LENGTH:i,MAX_SAFE_BUILD_LENGTH:r,MAX_SAFE_INTEGER:n,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:e,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},NA}var $A,I5;function pR(){return I5||(I5=1,$A=typeof process=="object"&&_A&&_A.NODE_DEBUG&&/\bsemver\b/i.test(_A.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{}),$A}var _5;function gL(){return _5||(_5=1,function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:r}=pL(),s=pR();t=e.exports={};const o=t.re=[],a=t.safeRe=[],l=t.src=[],u=t.t={};let c=0;const d="[a-zA-Z0-9-]",h=[["\\s",1],["\\d",r],[d,i]],p=v=>{for(const[C,y]of h)v=v.split(`${C}*`).join(`${C}{0,${y}}`).split(`${C}+`).join(`${C}{1,${y}}`);return v},g=(v,C,y)=>{const b=p(C),S=c++;s(v,S,C),u[v]=S,l[S]=C,o[S]=new RegExp(C,y?"g":void 0),a[S]=new RegExp(b,y?"g":void 0)};g("NUMERICIDENTIFIER","0|[1-9]\\d*"),g("NUMERICIDENTIFIERLOOSE","\\d+"),g("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${d}*`),g("MAINVERSION",`(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})`),g("MAINVERSIONLOOSE",`(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})`),g("PRERELEASEIDENTIFIER",`(?:${l[u.NUMERICIDENTIFIER]}|${l[u.NONNUMERICIDENTIFIER]})`),g("PRERELEASEIDENTIFIERLOOSE",`(?:${l[u.NUMERICIDENTIFIERLOOSE]}|${l[u.NONNUMERICIDENTIFIER]})`),g("PRERELEASE",`(?:-(${l[u.PRERELEASEIDENTIFIER]}(?:\\.${l[u.PRERELEASEIDENTIFIER]})*))`),g("PRERELEASELOOSE",`(?:-?(${l[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[u.PRERELEASEIDENTIFIERLOOSE]})*))`),g("BUILDIDENTIFIER",`${d}+`),g("BUILD",`(?:\\+(${l[u.BUILDIDENTIFIER]}(?:\\.${l[u.BUILDIDENTIFIER]})*))`),g("FULLPLAIN",`v?${l[u.MAINVERSION]}${l[u.PRERELEASE]}?${l[u.BUILD]}?`),g("FULL",`^${l[u.FULLPLAIN]}$`),g("LOOSEPLAIN",`[v=\\s]*${l[u.MAINVERSIONLOOSE]}${l[u.PRERELEASELOOSE]}?${l[u.BUILD]}?`),g("LOOSE",`^${l[u.LOOSEPLAIN]}$`),g("GTLT","((?:<|>)?=?)"),g("XRANGEIDENTIFIERLOOSE",`${l[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),g("XRANGEIDENTIFIER",`${l[u.NUMERICIDENTIFIER]}|x|X|\\*`),g("XRANGEPLAIN",`[v=\\s]*(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:${l[u.PRERELEASE]})?${l[u.BUILD]}?)?)?`),g("XRANGEPLAINLOOSE",`[v=\\s]*(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:${l[u.PRERELEASELOOSE]})?${l[u.BUILD]}?)?)?`),g("XRANGE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAIN]}$`),g("XRANGELOOSE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAINLOOSE]}$`),g("COERCEPLAIN",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?`),g("COERCE",`${l[u.COERCEPLAIN]}(?:$|[^\\d])`),g("COERCEFULL",l[u.COERCEPLAIN]+`(?:${l[u.PRERELEASE]})?(?:${l[u.BUILD]})?(?:$|[^\\d])`),g("COERCERTL",l[u.COERCE],!0),g("COERCERTLFULL",l[u.COERCEFULL],!0),g("LONETILDE","(?:~>?)"),g("TILDETRIM",`(\\s*)${l[u.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",g("TILDE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAIN]}$`),g("TILDELOOSE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAINLOOSE]}$`),g("LONECARET","(?:\\^)"),g("CARETTRIM",`(\\s*)${l[u.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",g("CARET",`^${l[u.LONECARET]}${l[u.XRANGEPLAIN]}$`),g("CARETLOOSE",`^${l[u.LONECARET]}${l[u.XRANGEPLAINLOOSE]}$`),g("COMPARATORLOOSE",`^${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]})$|^$`),g("COMPARATOR",`^${l[u.GTLT]}\\s*(${l[u.FULLPLAIN]})$|^$`),g("COMPARATORTRIM",`(\\s*)${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]}|${l[u.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",g("HYPHENRANGE",`^\\s*(${l[u.XRANGEPLAIN]})\\s+-\\s+(${l[u.XRANGEPLAIN]})\\s*$`),g("HYPHENRANGELOOSE",`^\\s*(${l[u.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[u.XRANGEPLAINLOOSE]})\\s*$`),g("STAR","(<|>)?=?\\s*\\*"),g("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),g("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(ew,ew.exports)),ew.exports}var BA,O5;function I3e(){if(O5)return BA;O5=1;const e=/^[0-9]+$/,t=(i,r)=>{const s=e.test(i),o=e.test(r);return s&&o&&(i=+i,r=+r),i===r?0:s&&!o?-1:o&&!s?1:i<r?-1:1};return BA={compareIdentifiers:t,rcompareIdentifiers:(i,r)=>t(r,i)},BA}var GA,L5;function mL(){if(L5)return GA;L5=1;const e=pR(),{MAX_LENGTH:t,MAX_SAFE_INTEGER:n}=pL(),{safeRe:i,t:r}=gL(),s=fL(),{compareIdentifiers:o}=I3e();class a{constructor(u,c){if(c=s(c),u instanceof a){if(u.loose===!!c.loose&&u.includePrerelease===!!c.includePrerelease)return u;u=u.version}else if(typeof u!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof u}".`);if(u.length>t)throw new TypeError(`version is longer than ${t} characters`);e("SemVer",u,c),this.options=c,this.loose=!!c.loose,this.includePrerelease=!!c.includePrerelease;const d=u.trim().match(c.loose?i[r.LOOSE]:i[r.FULL]);if(!d)throw new TypeError(`Invalid Version: ${u}`);if(this.raw=u,this.major=+d[1],this.minor=+d[2],this.patch=+d[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");d[4]?this.prerelease=d[4].split(".").map(h=>{if(/^[0-9]+$/.test(h)){const p=+h;if(p>=0&&p<n)return p}return h}):this.prerelease=[],this.build=d[5]?d[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(u){if(e("SemVer.compare",this.version,this.options,u),!(u instanceof a)){if(typeof u=="string"&&u===this.version)return 0;u=new a(u,this.options)}return u.version===this.version?0:this.compareMain(u)||this.comparePre(u)}compareMain(u){return u instanceof a||(u=new a(u,this.options)),o(this.major,u.major)||o(this.minor,u.minor)||o(this.patch,u.patch)}comparePre(u){if(u instanceof a||(u=new a(u,this.options)),this.prerelease.length&&!u.prerelease.length)return-1;if(!this.prerelease.length&&u.prerelease.length)return 1;if(!this.prerelease.length&&!u.prerelease.length)return 0;let c=0;do{const d=this.prerelease[c],h=u.prerelease[c];if(e("prerelease compare",c,d,h),d===void 0&&h===void 0)return 0;if(h===void 0)return 1;if(d===void 0)return-1;if(d===h)continue;return o(d,h)}while(++c)}compareBuild(u){u instanceof a||(u=new a(u,this.options));let c=0;do{const d=this.build[c],h=u.build[c];if(e("build compare",c,d,h),d===void 0&&h===void 0)return 0;if(h===void 0)return 1;if(d===void 0)return-1;if(d===h)continue;return o(d,h)}while(++c)}inc(u,c,d){switch(u){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",c,d);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",c,d);break;case"prepatch":this.prerelease.length=0,this.inc("patch",c,d),this.inc("pre",c,d);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",c,d),this.inc("pre",c,d);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const h=Number(d)?1:0;if(!c&&d===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[h];else{let p=this.prerelease.length;for(;--p>=0;)typeof this.prerelease[p]=="number"&&(this.prerelease[p]++,p=-2);if(p===-1){if(c===this.prerelease.join(".")&&d===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(h)}}if(c){let p=[c,h];d===!1&&(p=[c]),o(this.prerelease[0],c)===0?isNaN(this.prerelease[1])&&(this.prerelease=p):this.prerelease=p}break}default:throw new Error(`invalid increment argument: ${u}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return GA=a,GA}var zA,N5;function ig(){if(N5)return zA;N5=1;const e=mL();return zA=(n,i,r)=>new e(n,r).compare(new e(i,r)),zA}var HA,$5;function _3e(){if($5)return HA;$5=1;const e=ig();return HA=(n,i,r)=>e(n,i,r)===0,HA}var VA,B5;function O3e(){if(B5)return VA;B5=1;const e=ig();return VA=(n,i,r)=>e(n,i,r)!==0,VA}var WA,G5;function L3e(){if(G5)return WA;G5=1;const e=ig();return WA=(n,i,r)=>e(n,i,r)>0,WA}var UA,z5;function N3e(){if(z5)return UA;z5=1;const e=ig();return UA=(n,i,r)=>e(n,i,r)>=0,UA}var jA,H5;function $3e(){if(H5)return jA;H5=1;const e=ig();return jA=(n,i,r)=>e(n,i,r)<0,jA}var qA,V5;function B3e(){if(V5)return qA;V5=1;const e=ig();return qA=(n,i,r)=>e(n,i,r)<=0,qA}var KA,W5;function G3e(){if(W5)return KA;W5=1;const e=_3e(),t=O3e(),n=L3e(),i=N3e(),r=$3e(),s=B3e();return KA=(a,l,u,c)=>{switch(l){case"===":return typeof a=="object"&&(a=a.version),typeof u=="object"&&(u=u.version),a===u;case"!==":return typeof a=="object"&&(a=a.version),typeof u=="object"&&(u=u.version),a!==u;case"":case"=":case"==":return e(a,u,c);case"!=":return t(a,u,c);case">":return n(a,u,c);case">=":return i(a,u,c);case"<":return r(a,u,c);case"<=":return s(a,u,c);default:throw new TypeError(`Invalid operator: ${l}`)}},KA}var YA,U5;function z3e(){if(U5)return YA;U5=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(c,d){if(d=n(d),c instanceof t){if(c.loose===!!d.loose)return c;c=c.value}c=c.trim().split(/\s+/).join(" "),o("comparator",c,d),this.options=d,this.loose=!!d.loose,this.parse(c),this.semver===e?this.value="":this.value=this.operator+this.semver.version,o("comp",this)}parse(c){const d=this.options.loose?i[r.COMPARATORLOOSE]:i[r.COMPARATOR],h=c.match(d);if(!h)throw new TypeError(`Invalid comparator: ${c}`);this.operator=h[1]!==void 0?h[1]:"",this.operator==="="&&(this.operator=""),h[2]?this.semver=new a(h[2],this.options.loose):this.semver=e}toString(){return this.value}test(c){if(o("Comparator.test",c,this.options.loose),this.semver===e||c===e)return!0;if(typeof c=="string")try{c=new a(c,this.options)}catch{return!1}return s(c,this.operator,this.semver,this.options)}intersects(c,d){if(!(c instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new l(c.value,d).test(this.value):c.operator===""?c.value===""?!0:new l(this.value,d).test(c.semver):(d=n(d),d.includePrerelease&&(this.value==="<0.0.0-0"||c.value==="<0.0.0-0")||!d.includePrerelease&&(this.value.startsWith("<0.0.0")||c.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&c.operator.startsWith(">")||this.operator.startsWith("<")&&c.operator.startsWith("<")||this.semver.version===c.semver.version&&this.operator.includes("=")&&c.operator.includes("=")||s(this.semver,"<",c.semver,d)&&this.operator.startsWith(">")&&c.operator.startsWith("<")||s(this.semver,">",c.semver,d)&&this.operator.startsWith("<")&&c.operator.startsWith(">")))}}YA=t;const n=fL(),{safeRe:i,t:r}=gL(),s=G3e(),o=pR(),a=mL(),l=DJ();return YA}var XA,j5;function DJ(){if(j5)return XA;j5=1;const e=/\s+/g;class t{constructor(L,G){if(G=r(G),L instanceof t)return L.loose===!!G.loose&&L.includePrerelease===!!G.includePrerelease?L:new t(L.raw,G);if(L instanceof s)return this.raw=L.value,this.set=[[L]],this.formatted=void 0,this;if(this.options=G,this.loose=!!G.loose,this.includePrerelease=!!G.includePrerelease,this.raw=L.trim().replace(e," "),this.set=this.raw.split("||").map(j=>this.parseRange(j.trim())).filter(j=>j.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const j=this.set[0];if(this.set=this.set.filter(ee=>!v(ee[0])),this.set.length===0)this.set=[j];else if(this.set.length>1){for(const ee of this.set)if(ee.length===1&&C(ee[0])){this.set=[ee];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let L=0;L<this.set.length;L++){L>0&&(this.formatted+="||");const G=this.set[L];for(let j=0;j<G.length;j++)j>0&&(this.formatted+=" "),this.formatted+=G[j].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(L){const j=((this.options.includePrerelease&&p)|(this.options.loose&&g))+":"+L,ee=i.get(j);if(ee)return ee;const q=this.options.loose,fe=q?l[u.HYPHENRANGELOOSE]:l[u.HYPHENRANGE];L=L.replace(fe,H(this.options.includePrerelease)),o("hyphen replace",L),L=L.replace(l[u.COMPARATORTRIM],c),o("comparator trim",L),L=L.replace(l[u.TILDETRIM],d),o("tilde trim",L),L=L.replace(l[u.CARETTRIM],h),o("caret trim",L);let Re=L.split(" ").map($e=>b($e,this.options)).join(" ").split(/\s+/).map($e=>O($e,this.options));q&&(Re=Re.filter($e=>(o("loose invalid filter",$e,this.options),!!$e.match(l[u.COMPARATORLOOSE])))),o("range list",Re);const Fe=new Map,ze=Re.map($e=>new s($e,this.options));for(const $e of ze){if(v($e))return[$e];Fe.set($e.value,$e)}Fe.size>1&&Fe.has("")&&Fe.delete("");const Ft=[...Fe.values()];return i.set(j,Ft),Ft}intersects(L,G){if(!(L instanceof t))throw new TypeError("a Range is required");return this.set.some(j=>y(j,G)&&L.set.some(ee=>y(ee,G)&&j.every(q=>ee.every(fe=>q.intersects(fe,G)))))}test(L){if(!L)return!1;if(typeof L=="string")try{L=new a(L,this.options)}catch{return!1}for(let G=0;G<this.set.length;G++)if(W(this.set[G],L,this.options))return!0;return!1}}XA=t;const n=M3e(),i=new n,r=fL(),s=z3e(),o=pR(),a=mL(),{safeRe:l,t:u,comparatorTrimReplace:c,tildeTrimReplace:d,caretTrimReplace:h}=gL(),{FLAG_INCLUDE_PRERELEASE:p,FLAG_LOOSE:g}=pL(),v=$=>$.value==="<0.0.0-0",C=$=>$.value==="",y=($,L)=>{let G=!0;const j=$.slice();let ee=j.pop();for(;G&&j.length;)G=j.every(q=>ee.intersects(q,L)),ee=j.pop();return G},b=($,L)=>(o("comp",$,L),$=A($,L),o("caret",$),$=x($,L),o("tildes",$),$=k($,L),o("xrange",$),$=_($,L),o("stars",$),$),S=$=>!$||$.toLowerCase()==="x"||$==="*",x=($,L)=>$.trim().split(/\s+/).map(G=>E(G,L)).join(" "),E=($,L)=>{const G=L.loose?l[u.TILDELOOSE]:l[u.TILDE];return $.replace(G,(j,ee,q,fe,Re)=>{o("tilde",$,j,ee,q,fe,Re);let Fe;return S(ee)?Fe="":S(q)?Fe=`>=${ee}.0.0 <${+ee+1}.0.0-0`:S(fe)?Fe=`>=${ee}.${q}.0 <${ee}.${+q+1}.0-0`:Re?(o("replaceTilde pr",Re),Fe=`>=${ee}.${q}.${fe}-${Re} <${ee}.${+q+1}.0-0`):Fe=`>=${ee}.${q}.${fe} <${ee}.${+q+1}.0-0`,o("tilde return",Fe),Fe})},A=($,L)=>$.trim().split(/\s+/).map(G=>F(G,L)).join(" "),F=($,L)=>{o("caret",$,L);const G=L.loose?l[u.CARETLOOSE]:l[u.CARET],j=L.includePrerelease?"-0":"";return $.replace(G,(ee,q,fe,Re,Fe)=>{o("caret",$,ee,q,fe,Re,Fe);let ze;return S(q)?ze="":S(fe)?ze=`>=${q}.0.0${j} <${+q+1}.0.0-0`:S(Re)?q==="0"?ze=`>=${q}.${fe}.0${j} <${q}.${+fe+1}.0-0`:ze=`>=${q}.${fe}.0${j} <${+q+1}.0.0-0`:Fe?(o("replaceCaret pr",Fe),q==="0"?fe==="0"?ze=`>=${q}.${fe}.${Re}-${Fe} <${q}.${fe}.${+Re+1}-0`:ze=`>=${q}.${fe}.${Re}-${Fe} <${q}.${+fe+1}.0-0`:ze=`>=${q}.${fe}.${Re}-${Fe} <${+q+1}.0.0-0`):(o("no pr"),q==="0"?fe==="0"?ze=`>=${q}.${fe}.${Re}${j} <${q}.${fe}.${+Re+1}-0`:ze=`>=${q}.${fe}.${Re}${j} <${q}.${+fe+1}.0-0`:ze=`>=${q}.${fe}.${Re} <${+q+1}.0.0-0`),o("caret return",ze),ze})},k=($,L)=>(o("replaceXRanges",$,L),$.split(/\s+/).map(G=>P(G,L)).join(" ")),P=($,L)=>{$=$.trim();const G=L.loose?l[u.XRANGELOOSE]:l[u.XRANGE];return $.replace(G,(j,ee,q,fe,Re,Fe)=>{o("xRange",$,j,ee,q,fe,Re,Fe);const ze=S(q),Ft=ze||S(fe),$e=Ft||S(Re),nn=$e;return ee==="="&&nn&&(ee=""),Fe=L.includePrerelease?"-0":"",ze?ee===">"||ee==="<"?j="<0.0.0-0":j="*":ee&&nn?(Ft&&(fe=0),Re=0,ee===">"?(ee=">=",Ft?(q=+q+1,fe=0,Re=0):(fe=+fe+1,Re=0)):ee==="<="&&(ee="<",Ft?q=+q+1:fe=+fe+1),ee==="<"&&(Fe="-0"),j=`${ee+q}.${fe}.${Re}${Fe}`):Ft?j=`>=${q}.0.0${Fe} <${+q+1}.0.0-0`:$e&&(j=`>=${q}.${fe}.0${Fe} <${q}.${+fe+1}.0-0`),o("xRange return",j),j})},_=($,L)=>(o("replaceStars",$,L),$.trim().replace(l[u.STAR],"")),O=($,L)=>(o("replaceGTE0",$,L),$.trim().replace(l[L.includePrerelease?u.GTE0PRE:u.GTE0],"")),H=$=>(L,G,j,ee,q,fe,Re,Fe,ze,Ft,$e,nn)=>(S(j)?G="":S(ee)?G=`>=${j}.0.0${$?"-0":""}`:S(q)?G=`>=${j}.${ee}.0${$?"-0":""}`:fe?G=`>=${G}`:G=`>=${G}${$?"-0":""}`,S(ze)?Fe="":S(Ft)?Fe=`<${+ze+1}.0.0-0`:S($e)?Fe=`<${ze}.${+Ft+1}.0-0`:nn?Fe=`<=${ze}.${Ft}.${$e}-${nn}`:$?Fe=`<${ze}.${Ft}.${+$e+1}-0`:Fe=`<=${Fe}`,`${G} ${Fe}`.trim()),W=($,L,G)=>{for(let j=0;j<$.length;j++)if(!$[j].test(L))return!1;if(L.prerelease.length&&!G.includePrerelease){for(let j=0;j<$.length;j++)if(o($[j].semver),$[j].semver!==s.ANY&&$[j].semver.prerelease.length>0){const ee=$[j].semver;if(ee.major===L.major&&ee.minor===L.minor&&ee.patch===L.patch)return!0}return!1}return!0};return XA}var QA,q5;function H3e(){if(q5)return QA;q5=1;const e=DJ();return QA=(n,i,r)=>{try{i=new e(i,r)}catch{return!1}return i.test(n)},QA}var V3e=H3e(),PJ=T3e(V3e);function W3e(e,t,n){const i=e.open(t),r=250,{origin:s}=new URL(t);let o=40;function a(u){u.source===i&&(o=0,e.removeEventListener("message",a,!1))}e.addEventListener("message",a,!1);function l(){o<=0||(i.postMessage(n,s),setTimeout(l,r),o-=1)}setTimeout(l,r)}var U3e=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box;
}
.vega-embed.has-actions {
  padding-right: 38px;
}
.vega-embed details:not([open]) > :not(summary) {
  display: none !important;
}
.vega-embed summary {
  list-style: none;
  position: absolute;
  top: 0;
  right: 0;
  padding: 6px;
  z-index: 1000;
  background: white;
  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
  color: #1b1e23;
  border: 1px solid #aaa;
  border-radius: 999px;
  opacity: 0.2;
  transition: opacity 0.4s ease-in;
  cursor: pointer;
  line-height: 0px;
}
.vega-embed summary::-webkit-details-marker {
  display: none;
}
.vega-embed summary:active {
  box-shadow: #aaa 0px 0px 0px 1px inset;
}
.vega-embed summary svg {
  width: 14px;
  height: 14px;
}
.vega-embed details[open] summary {
  opacity: 0.7;
}
.vega-embed:hover summary, .vega-embed:focus-within summary {
  opacity: 1 !important;
  transition: opacity 0.2s ease;
}
.vega-embed .vega-actions {
  position: absolute;
  z-index: 1001;
  top: 35px;
  right: -9px;
  display: flex;
  flex-direction: column;
  padding-bottom: 8px;
  padding-top: 8px;
  border-radius: 4px;
  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
  border: 1px solid #d9d9d9;
  background: white;
  animation-duration: 0.15s;
  animation-name: scale-in;
  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
  text-align: left;
}
.vega-embed .vega-actions a {
  padding: 8px 16px;
  font-family: sans-serif;
  font-size: 14px;
  font-weight: 600;
  white-space: nowrap;
  color: #434a56;
  text-decoration: none;
}
.vega-embed .vega-actions a:hover, .vega-embed .vega-actions a:focus {
  background-color: #f7f7f9;
  color: black;
}
.vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
  content: "";
  display: inline-block;
  position: absolute;
}
.vega-embed .vega-actions::before {
  left: auto;
  right: 14px;
  top: -16px;
  border: 8px solid rgba(0, 0, 0, 0);
  border-bottom-color: #d9d9d9;
}
.vega-embed .vega-actions::after {
  left: auto;
  right: 15px;
  top: -14px;
  border: 7px solid rgba(0, 0, 0, 0);
  border-bottom-color: #fff;
}
.vega-embed .chart-wrapper.fit-x {
  width: 100%;
}
.vega-embed .chart-wrapper.fit-y {
  height: 100%;
}

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px;
}

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}
`;function kJ(e,...t){for(const n of t)j3e(e,n);return e}function j3e(e,t){for(const n of Object.keys(t))Ip(e,n,t[n],!0)}const Yo=kMe;let Xv=wGe;const K5=typeof window<"u"?window:void 0;Xv===void 0&&K5?.vl?.compile&&(Xv=K5.vl);const q3e={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},K3e={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},zm={vega:"Vega","vega-lite":"Vega-Lite"},DS={vega:Yo.version,"vega-lite":Xv?Xv.version:"not available"},Y3e={vega:e=>e,"vega-lite":(e,t)=>Xv.compile(e,{config:t}).spec},X3e=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,Q3e="chart-wrapper";function J3e(e){return typeof e=="function"}function Y5(e,t,n,i){const r=`<html><head>${t}</head><body><pre><code class="json">`,s=`</code></pre>${n}</body></html>`,o=window.open("");o.document.write(r+e+s),o.document.title=`${zm[i]} JSON Source`}function Z3e(e,t){if(e.$schema){const n=CJ(e.$schema);t&&t!==n.library&&console.warn(`The given visualization spec is written in ${zm[n.library]}, but mode argument sets ${zm[t]??t}.`);const i=n.library;return PJ(DS[i],`^${n.version.slice(1)}`)||console.warn(`The input spec uses ${zm[i]} ${n.version}, but the current version of ${zm[i]} is v${DS[i]}.`),i}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t??"vega"}function TJ(e){return!!(e&&"load"in e)}function X5(e){return TJ(e)?e:Yo.loader(e)}function eze(e){const t=e.usermeta?.embedOptions??{};return be(t.defaultStyle)&&(t.defaultStyle=!1),t}async function tze(e,t,n={}){let i,r;be(t)?(r=X5(n.loader),i=JSON.parse(await r.load(t))):i=t;const s=eze(i),o=s.loader;(!r||o)&&(r=X5(n.loader??o));const a=await Q5(s,r),l=await Q5(n,r),u={...kJ(l,a),config:Mp(l.config??{},a.config??{})};return await ize(e,i,u,r)}async function Q5(e,t){const n=be(e.config)?JSON.parse(await t.load(e.config)):e.config??{},i=be(e.patch)?JSON.parse(await t.load(e.patch)):e.patch;return{...e,...i?{patch:i}:{},...n?{config:n}:{}}}function nze(e){const t=e.getRootNode?e.getRootNode():document;return t instanceof ShadowRoot?{root:t,rootContainer:t}:{root:document,rootContainer:document.head??document.body}}async function ize(e,t,n={},i){const r=n.theme?Mp(s3e[n.theme],n.config??{}):n.config,s=uc(n.actions)?n.actions:kJ({},q3e,n.actions??{}),o={...K3e,...n.i18n},a=n.renderer??"canvas",l=n.logLevel??Yo.Warn,u=n.downloadFileName??"visualization",c=typeof e=="string"?document.querySelector(e):e;if(!c)throw new Error(`${e} does not exist`);if(n.defaultStyle!==!1){const E="vega-embed-style",{root:A,rootContainer:F}=nze(c);if(!A.getElementById(E)){const k=document.createElement("style");k.id=E,k.innerHTML=n.defaultStyle===void 0||n.defaultStyle===!0?U3e.toString():n.defaultStyle,F.appendChild(k)}}const d=Z3e(t,n.mode);let h=Y3e[d](t,r);if(d==="vega-lite"&&h.$schema){const E=CJ(h.$schema);PJ(DS.vega,`^${E.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${E.version}, but current version is v${DS.vega}.`)}c.classList.add("vega-embed"),s&&c.classList.add("has-actions"),c.innerHTML="";let p=c;if(s){const E=document.createElement("div");E.classList.add(Q3e),c.appendChild(E),p=E}const g=n.patch;if(g&&(h=g instanceof Function?g(h):fR(h,g,!0,!1).newDocument),n.formatLocale&&Yo.formatLocale(n.formatLocale),n.timeFormatLocale&&Yo.timeFormatLocale(n.timeFormatLocale),n.expressionFunctions)for(const E in n.expressionFunctions){const A=n.expressionFunctions[E];"fn"in A?Yo.expressionFunction(E,A.fn,A.visitor):A instanceof Function&&Yo.expressionFunction(E,A)}const{ast:v}=n,C=Yo.parse(h,d==="vega-lite"?{}:r,{ast:v}),y=new(n.viewClass||Yo.View)(C,{loader:i,logLevel:l,renderer:a,...v?{expr:Yo.expressionInterpreter??n.expr??GMe}:{}});if(y.addSignalListener("autosize",(E,A)=>{const{type:F}=A;F=="fit-x"?(p.classList.add("fit-x"),p.classList.remove("fit-y")):F=="fit-y"?(p.classList.remove("fit-x"),p.classList.add("fit-y")):F=="fit"?p.classList.add("fit-x","fit-y"):p.classList.remove("fit-x","fit-y")}),n.tooltip!==!1){const{loader:E,tooltip:A}=n,F=E&&!TJ(E)?E?.baseURL:void 0,k=J3e(A)?A:new g3e({baseURL:F,...A===!0?{}:A}).call;y.tooltip(k)}let{hover:b}=n;if(b===void 0&&(b=d==="vega"),b){const{hoverSet:E,updateSet:A}=typeof b=="boolean"?{}:b;y.hover(E,A)}n&&(n.width!=null&&y.width(n.width),n.height!=null&&y.height(n.height),n.padding!=null&&y.padding(n.padding)),await y.initialize(p,n.bind).runAsync();let S;if(s!==!1){let E=c;if(n.defaultStyle!==!1||n.forceActionsMenu){const F=document.createElement("details");F.title=o.CLICK_TO_VIEW_ACTIONS,c.append(F),E=F;const k=document.createElement("summary");k.innerHTML=X3e,F.append(k),S=P=>{F.contains(P.target)||F.removeAttribute("open")},document.addEventListener("click",S)}const A=document.createElement("div");if(E.append(A),A.classList.add("vega-actions"),s===!0||s.export!==!1){for(const F of["svg","png"])if(s===!0||s.export===!0||s.export[F]){const k=o[`${F.toUpperCase()}_ACTION`],P=document.createElement("a"),_=ye(n.scaleFactor)?n.scaleFactor[F]:n.scaleFactor;P.text=k,P.href="#",P.target="_blank",P.download=`${u}.${F}`,P.addEventListener("mousedown",async function(O){O.preventDefault();const H=await y.toImageURL(F,_);this.href=H}),A.append(P)}}if(s===!0||s.source!==!1){const F=document.createElement("a");F.text=o.SOURCE_ACTION,F.href="#",F.addEventListener("click",function(k){Y5(lF(t),n.sourceHeader??"",n.sourceFooter??"",d),k.preventDefault()}),A.append(F)}if(d==="vega-lite"&&(s===!0||s.compiled!==!1)){const F=document.createElement("a");F.text=o.COMPILED_ACTION,F.href="#",F.addEventListener("click",function(k){Y5(lF(h),n.sourceHeader??"",n.sourceFooter??"","vega"),k.preventDefault()}),A.append(F)}if(s===!0||s.editor!==!1){const F=n.editorUrl??"https://vega.github.io/editor/",k=document.createElement("a");k.text=o.EDITOR_ACTION,k.href="#",k.addEventListener("click",function(P){W3e(window,F,{config:r,mode:g?"vega":d,renderer:a,spec:lF(g?h:t)}),P.preventDefault()}),A.append(k)}}function x(){S&&document.removeEventListener("click",S),y.finalize()}return{view:y,spec:t,vgSpec:h,finalize:x,embedOptions:n}}function J5(e,t){return e==null?t:typeof e=="function"?e:n=>n[e]}function rze(e,t,n,i,r,s){const o=new Float64Array(s),a=(s-1)/(r-i);for(let l=0;l<e.length;++l){const u=e[l],c=t(u,l,e),d=n(u,l,e);if(!(Number.isFinite(c)&&Number.isFinite(d)))continue;const h=(c-i)*a,p=Math.floor(h),g=p+1;0<=p&&g<s?(o[p]+=(g-h)*d,o[g]+=(h-p)*d):p===-1?o[g]+=(h-p)*d:g===s&&(o[p]+=(g-h)*d)}return o}function Z5(e,t=!1){const n=new Float64Array(5),i=new Float64Array(4);sze(n,i,e);const r=Float64Array.of(0,i[1]-n[1]*i[0],i[2]-n[2]*i[0],i[3]-n[3]*i[0],-n[4]*i[0]),s=1+n[1]+n[2]+n[3]+n[4],o=(i[0]+i[1]+i[2]+i[3])/s,a=(r[1]+r[2]+r[3]+r[4])/s;return{sigma:e,negative:t,a:n,b_causal:i,b_anticausal:r,sum_causal:o,sum_anticausal:a}}function sze(e,t,n){const r=Float64Array.of(.84,1.8675,.84,-1.8675,-.34015,-.1299,-.34015,.1299),s=Math.exp(-1.783/n),o=Math.exp(-1.723/n),a=.6318/n,l=1.997/n,u=Float64Array.of(-s*Math.cos(a),s*Math.sin(a),-s*Math.cos(-a),s*Math.sin(-a),-o*Math.cos(l),o*Math.sin(l),-o*Math.cos(-l),o*Math.sin(-l)),c=n*2.5066282746310007,d=Float64Array.of(r[0],r[1],0,0,0,0,0,0),h=Float64Array.of(1,0,u[0],u[1],0,0,0,0,0,0);let p,g;for(g=2;g<8;g+=2){for(d[g]=u[g]*d[g-2]-u[g+1]*d[g-1],d[g+1]=u[g]*d[g-1]+u[g+1]*d[g-2],p=g-2;p>0;p-=2)d[p]+=u[g]*d[p-2]-u[g+1]*d[p-1],d[p+1]+=u[g]*d[p-1]+u[g+1]*d[p-2];for(p=0;p<=g;p+=2)d[p]+=r[g]*h[p]-r[g+1]*h[p+1],d[p+1]+=r[g]*h[p+1]+r[g+1]*h[p];for(h[g+2]=u[g]*h[g]-u[g+1]*h[g+1],h[g+3]=u[g]*h[g+1]+u[g+1]*h[g],p=g;p>0;p-=2)h[p]+=u[g]*h[p-2]-u[g+1]*h[p-1],h[p+1]+=u[g]*h[p-1]+u[g+1]*h[p-2]}for(g=0;g<4;++g)p=g<<1,t[g]=d[p]/c,e[g+1]=h[p+2]}function oze(e,t,n,i=1,r=new Float64Array(n),s=new Float64Array(n),o=new Float64Array(5),a=r,l=aze){const u=i*2,c=i*3,d=i*4,h=i*n;let p,g;for(l(r,t,n,i,e.b_causal,3,e.a,4,e.sum_causal,o,e.sigma),g=4,p=d;g<n;++g,p+=i)r[g]=e.b_causal[0]*t[p]+e.b_causal[1]*t[p-i]+e.b_causal[2]*t[p-u]+e.b_causal[3]*t[p-c]-e.a[1]*r[g-1]-e.a[2]*r[g-2]-e.a[3]*r[g-3]-e.a[4]*r[g-4];for(l(s,t,n,-i,e.b_anticausal,4,e.a,4,e.sum_anticausal,o,e.sigma),g=4,p=h-i*5;g<n;++g,p-=i)s[g]=e.b_anticausal[1]*t[p+i]+e.b_anticausal[2]*t[p+u]+e.b_anticausal[3]*t[p+c]+e.b_anticausal[4]*t[p+d]-e.a[1]*s[g-1]-e.a[2]*s[g-2]-e.a[3]*s[g-3]-e.a[4]*s[g-4];if(e.negative)for(g=0,p=0;g<n;++g,p+=i)a[p]=r[g]+s[n-g-1];else for(g=0,p=0;g<n;++g,p+=i)a[p]=Math.max(0,r[g]+s[n-g-1]);return a}function aze(e,t,n,i,r,s,o,a,l,u,c,d=.5){const h=Math.abs(i)*n,p=i<0?h+i:0;let g,v,C;for(v=0;v<a;++v)for(u[v]=v<=s?r[v]:0,C=1;C<=a&&C<=v;++C)u[v]-=o[C]*u[v-C];for(C=0;C<a;++C)for(e[C]=0,v=1;v<=C;++v)g=p+i*v,g>=0&&g<h&&(e[C]+=u[C-v]*t[g]);const y=t[p],b=Math.ceil(c*10);for(v=0;v<b;++v){for(C=0;C<a;++C)e[C]+=u[C]*y;if(l-=Math.abs(u[0]),l<=d)break;for(u[a]=v+a<=s?r[v+a]:0,C=1;C<=a;++C)u[a]-=o[C]*u[a-C];for(C=0;C<a;++C)u[C]=u[C+1]}}function lze(e,t,n=0){const i=e.length;let r,s;for(let o=0;o<i;++o){const a=t(e[o],o,e);a!=null&&(r===void 0?a>=a&&(r=s=a):(a<r&&(r=a),a>s&&(s=a)))}return[r-n,s+n]}function MJ(e,t){const n=e.map(t).filter(u=>u!=null&&u>=u);n.sort((u,c)=>u-c);const i=uze(n),r=e6(n,.25),s=e6(n,.75),o=n.length,a=(s-r)/1.34;return 1.06*(Math.min(i,a)||i||Math.abs(r)||1)*Math.pow(o,-.2)}function uze(e){const t=e.length;let n=0,i,r=0,s=0;for(let o=0;o<t;++o){const a=e[o];i=a-r,r+=i/++n,s+=i*(a-r)}return n>1?Math.sqrt(s/(n-1)):NaN}function e6(e,t){const n=e.length;if(!n)return NaN;if((t=+t)<=0||n<2)return e[0];if(t>=1)return e[n-1];const i=(n-1)*t,r=Math.floor(i),s=e[r];return s+(e[r+1]-s)*(i-r)}function cze(e,t={}){const{adjust:n=1,pad:i=3,bins:r=512}=t,s=J5(t.x,y=>y),o=J5(t.weight,()=>1/e.length);let a=t.bandwidth??n*MJ(e,s);const[l,u]=t.extent??lze(e,s,i*a),c=rze(e,s,o,l,u,r),d=(u-l)/(r-1),h=c.some(y=>y<0);let p=Z5(a/d,h),g;function*v(y="x",b="y"){const S=C.grid(),x=1/d;for(let E=0;E<r;++E)yield{[y]:l+E*d,[b]:S[E]*x}}const C={[Symbol.iterator]:v,points:v,grid:()=>g||(g=oze(p,c,r)),extent:()=>[l,u],bandwidth(y){return arguments.length?(y!==a&&(a=y,g=null,p=Z5(a/d,h)),C):a}};return C}var Hm={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var dze=Hm.exports,t6;function hze(){return t6||(t6=1,function(e,t){(function(){var n,i="4.17.21",r=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",a="Invalid `variable` option passed into `_.template`",l="__lodash_hash_undefined__",u=500,c="__lodash_placeholder__",d=1,h=2,p=4,g=1,v=2,C=1,y=2,b=4,S=8,x=16,E=32,A=64,F=128,k=256,P=512,_=30,O="...",H=800,W=16,$=1,L=2,G=3,j=1/0,ee=9007199254740991,q=17976931348623157e292,fe=NaN,Re=4294967295,Fe=Re-1,ze=Re>>>1,Ft=[["ary",F],["bind",C],["bindKey",y],["curry",S],["curryRight",x],["flip",P],["partial",E],["partialRight",A],["rearg",k]],$e="[object Arguments]",nn="[object Array]",za="[object AsyncFunction]",dr="[object Boolean]",xe="[object Date]",Ye="[object DOMException]",Xe="[object Error]",le="[object Function]",Pn="[object GeneratorFunction]",et="[object Map]",cn="[object Number]",kn="[object Null]",Tn="[object Object]",Tc="[object Promise]",Zie="[object Proxy]",yg="[object RegExp]",js="[object Set]",wg="[object String]",xC="[object Symbol]",ere="[object Undefined]",bg="[object WeakMap]",tre="[object WeakSet]",Sg="[object ArrayBuffer]",Eh="[object DataView]",zR="[object Float32Array]",HR="[object Float64Array]",VR="[object Int8Array]",WR="[object Int16Array]",UR="[object Int32Array]",jR="[object Uint8Array]",qR="[object Uint8ClampedArray]",KR="[object Uint16Array]",YR="[object Uint32Array]",nre=/\b__p \+= '';/g,ire=/\b(__p \+=) '' \+/g,rre=/(__e\(.*?\)|\b__t\)) \+\n'';/g,BN=/&(?:amp|lt|gt|quot|#39);/g,GN=/[&<>"']/g,sre=RegExp(BN.source),ore=RegExp(GN.source),are=/<%-([\s\S]+?)%>/g,lre=/<%([\s\S]+?)%>/g,zN=/<%=([\s\S]+?)%>/g,ure=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,cre=/^\w*$/,dre=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,XR=/[\\^$.*+?()[\]{}|]/g,hre=RegExp(XR.source),QR=/^\s+/,fre=/\s/,pre=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,gre=/\{\n\/\* \[wrapped with (.+)\] \*/,mre=/,? & /,vre=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Cre=/[()=,{}\[\]\/\s]/,yre=/\\(\\)?/g,wre=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,HN=/\w*$/,bre=/^[-+]0x[0-9a-f]+$/i,Sre=/^0b[01]+$/i,xre=/^\[object .+?Constructor\]$/,Rre=/^0o[0-7]+$/i,Ere=/^(?:0|[1-9]\d*)$/,Fre=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,RC=/($^)/,Are=/['\n\r\u2028\u2029\\]/g,EC="\\ud800-\\udfff",Dre="\\u0300-\\u036f",Pre="\\ufe20-\\ufe2f",kre="\\u20d0-\\u20ff",VN=Dre+Pre+kre,WN="\\u2700-\\u27bf",UN="a-z\\xdf-\\xf6\\xf8-\\xff",Tre="\\xac\\xb1\\xd7\\xf7",Mre="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Ire="\\u2000-\\u206f",_re=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",jN="A-Z\\xc0-\\xd6\\xd8-\\xde",qN="\\ufe0e\\ufe0f",KN=Tre+Mre+Ire+_re,JR="['’]",Ore="["+EC+"]",YN="["+KN+"]",FC="["+VN+"]",XN="\\d+",Lre="["+WN+"]",QN="["+UN+"]",JN="[^"+EC+KN+XN+WN+UN+jN+"]",ZR="\\ud83c[\\udffb-\\udfff]",Nre="(?:"+FC+"|"+ZR+")",ZN="[^"+EC+"]",eE="(?:\\ud83c[\\udde6-\\uddff]){2}",tE="[\\ud800-\\udbff][\\udc00-\\udfff]",Fh="["+jN+"]",e$="\\u200d",t$="(?:"+QN+"|"+JN+")",$re="(?:"+Fh+"|"+JN+")",n$="(?:"+JR+"(?:d|ll|m|re|s|t|ve))?",i$="(?:"+JR+"(?:D|LL|M|RE|S|T|VE))?",r$=Nre+"?",s$="["+qN+"]?",Bre="(?:"+e$+"(?:"+[ZN,eE,tE].join("|")+")"+s$+r$+")*",Gre="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",zre="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",o$=s$+r$+Bre,Hre="(?:"+[Lre,eE,tE].join("|")+")"+o$,Vre="(?:"+[ZN+FC+"?",FC,eE,tE,Ore].join("|")+")",Wre=RegExp(JR,"g"),Ure=RegExp(FC,"g"),nE=RegExp(ZR+"(?="+ZR+")|"+Vre+o$,"g"),jre=RegExp([Fh+"?"+QN+"+"+n$+"(?="+[YN,Fh,"$"].join("|")+")",$re+"+"+i$+"(?="+[YN,Fh+t$,"$"].join("|")+")",Fh+"?"+t$+"+"+n$,Fh+"+"+i$,zre,Gre,XN,Hre].join("|"),"g"),qre=RegExp("["+e$+EC+VN+qN+"]"),Kre=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Yre=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Xre=-1,jt={};jt[zR]=jt[HR]=jt[VR]=jt[WR]=jt[UR]=jt[jR]=jt[qR]=jt[KR]=jt[YR]=!0,jt[$e]=jt[nn]=jt[Sg]=jt[dr]=jt[Eh]=jt[xe]=jt[Xe]=jt[le]=jt[et]=jt[cn]=jt[Tn]=jt[yg]=jt[js]=jt[wg]=jt[bg]=!1;var Ht={};Ht[$e]=Ht[nn]=Ht[Sg]=Ht[Eh]=Ht[dr]=Ht[xe]=Ht[zR]=Ht[HR]=Ht[VR]=Ht[WR]=Ht[UR]=Ht[et]=Ht[cn]=Ht[Tn]=Ht[yg]=Ht[js]=Ht[wg]=Ht[xC]=Ht[jR]=Ht[qR]=Ht[KR]=Ht[YR]=!0,Ht[Xe]=Ht[le]=Ht[bg]=!1;var Qre={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Jre={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Zre={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},ese={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},tse=parseFloat,nse=parseInt,a$=typeof fy=="object"&&fy&&fy.Object===Object&&fy,ise=typeof self=="object"&&self&&self.Object===Object&&self,ii=a$||ise||Function("return this")(),iE=t&&!t.nodeType&&t,Mc=iE&&!0&&e&&!e.nodeType&&e,l$=Mc&&Mc.exports===iE,rE=l$&&a$.process,ss=function(){try{var z=Mc&&Mc.require&&Mc.require("util").types;return z||rE&&rE.binding&&rE.binding("util")}catch{}}(),u$=ss&&ss.isArrayBuffer,c$=ss&&ss.isDate,d$=ss&&ss.isMap,h$=ss&&ss.isRegExp,f$=ss&&ss.isSet,p$=ss&&ss.isTypedArray;function Or(z,J,U){switch(U.length){case 0:return z.call(J);case 1:return z.call(J,U[0]);case 2:return z.call(J,U[0],U[1]);case 3:return z.call(J,U[0],U[1],U[2])}return z.apply(J,U)}function rse(z,J,U,Ae){for(var Ke=-1,At=z==null?0:z.length;++Ke<At;){var In=z[Ke];J(Ae,In,U(In),z)}return Ae}function os(z,J){for(var U=-1,Ae=z==null?0:z.length;++U<Ae&&J(z[U],U,z)!==!1;);return z}function sse(z,J){for(var U=z==null?0:z.length;U--&&J(z[U],U,z)!==!1;);return z}function g$(z,J){for(var U=-1,Ae=z==null?0:z.length;++U<Ae;)if(!J(z[U],U,z))return!1;return!0}function tu(z,J){for(var U=-1,Ae=z==null?0:z.length,Ke=0,At=[];++U<Ae;){var In=z[U];J(In,U,z)&&(At[Ke++]=In)}return At}function AC(z,J){var U=z==null?0:z.length;return!!U&&Ah(z,J,0)>-1}function sE(z,J,U){for(var Ae=-1,Ke=z==null?0:z.length;++Ae<Ke;)if(U(J,z[Ae]))return!0;return!1}function Qt(z,J){for(var U=-1,Ae=z==null?0:z.length,Ke=Array(Ae);++U<Ae;)Ke[U]=J(z[U],U,z);return Ke}function nu(z,J){for(var U=-1,Ae=J.length,Ke=z.length;++U<Ae;)z[Ke+U]=J[U];return z}function oE(z,J,U,Ae){var Ke=-1,At=z==null?0:z.length;for(Ae&&At&&(U=z[++Ke]);++Ke<At;)U=J(U,z[Ke],Ke,z);return U}function ose(z,J,U,Ae){var Ke=z==null?0:z.length;for(Ae&&Ke&&(U=z[--Ke]);Ke--;)U=J(U,z[Ke],Ke,z);return U}function aE(z,J){for(var U=-1,Ae=z==null?0:z.length;++U<Ae;)if(J(z[U],U,z))return!0;return!1}var ase=lE("length");function lse(z){return z.split("")}function use(z){return z.match(vre)||[]}function m$(z,J,U){var Ae;return U(z,function(Ke,At,In){if(J(Ke,At,In))return Ae=At,!1}),Ae}function DC(z,J,U,Ae){for(var Ke=z.length,At=U+(Ae?1:-1);Ae?At--:++At<Ke;)if(J(z[At],At,z))return At;return-1}function Ah(z,J,U){return J===J?bse(z,J,U):DC(z,v$,U)}function cse(z,J,U,Ae){for(var Ke=U-1,At=z.length;++Ke<At;)if(Ae(z[Ke],J))return Ke;return-1}function v$(z){return z!==z}function C$(z,J){var U=z==null?0:z.length;return U?cE(z,J)/U:fe}function lE(z){return function(J){return J==null?n:J[z]}}function uE(z){return function(J){return z==null?n:z[J]}}function y$(z,J,U,Ae,Ke){return Ke(z,function(At,In,Gt){U=Ae?(Ae=!1,At):J(U,At,In,Gt)}),U}function dse(z,J){var U=z.length;for(z.sort(J);U--;)z[U]=z[U].value;return z}function cE(z,J){for(var U,Ae=-1,Ke=z.length;++Ae<Ke;){var At=J(z[Ae]);At!==n&&(U=U===n?At:U+At)}return U}function dE(z,J){for(var U=-1,Ae=Array(z);++U<z;)Ae[U]=J(U);return Ae}function hse(z,J){return Qt(J,function(U){return[U,z[U]]})}function w$(z){return z&&z.slice(0,R$(z)+1).replace(QR,"")}function Lr(z){return function(J){return z(J)}}function hE(z,J){return Qt(J,function(U){return z[U]})}function xg(z,J){return z.has(J)}function b$(z,J){for(var U=-1,Ae=z.length;++U<Ae&&Ah(J,z[U],0)>-1;);return U}function S$(z,J){for(var U=z.length;U--&&Ah(J,z[U],0)>-1;);return U}function fse(z,J){for(var U=z.length,Ae=0;U--;)z[U]===J&&++Ae;return Ae}var pse=uE(Qre),gse=uE(Jre);function mse(z){return"\\"+ese[z]}function vse(z,J){return z==null?n:z[J]}function Dh(z){return qre.test(z)}function Cse(z){return Kre.test(z)}function yse(z){for(var J,U=[];!(J=z.next()).done;)U.push(J.value);return U}function fE(z){var J=-1,U=Array(z.size);return z.forEach(function(Ae,Ke){U[++J]=[Ke,Ae]}),U}function x$(z,J){return function(U){return z(J(U))}}function iu(z,J){for(var U=-1,Ae=z.length,Ke=0,At=[];++U<Ae;){var In=z[U];(In===J||In===c)&&(z[U]=c,At[Ke++]=U)}return At}function PC(z){var J=-1,U=Array(z.size);return z.forEach(function(Ae){U[++J]=Ae}),U}function wse(z){var J=-1,U=Array(z.size);return z.forEach(function(Ae){U[++J]=[Ae,Ae]}),U}function bse(z,J,U){for(var Ae=U-1,Ke=z.length;++Ae<Ke;)if(z[Ae]===J)return Ae;return-1}function Sse(z,J,U){for(var Ae=U+1;Ae--;)if(z[Ae]===J)return Ae;return Ae}function Ph(z){return Dh(z)?Rse(z):ase(z)}function qs(z){return Dh(z)?Ese(z):lse(z)}function R$(z){for(var J=z.length;J--&&fre.test(z.charAt(J)););return J}var xse=uE(Zre);function Rse(z){for(var J=nE.lastIndex=0;nE.test(z);)++J;return J}function Ese(z){return z.match(nE)||[]}function Fse(z){return z.match(jre)||[]}var Ase=function z(J){J=J==null?ii:kh.defaults(ii.Object(),J,kh.pick(ii,Yre));var U=J.Array,Ae=J.Date,Ke=J.Error,At=J.Function,In=J.Math,Gt=J.Object,pE=J.RegExp,Dse=J.String,as=J.TypeError,kC=U.prototype,Pse=At.prototype,Th=Gt.prototype,TC=J["__core-js_shared__"],MC=Pse.toString,Mt=Th.hasOwnProperty,kse=0,E$=function(){var f=/[^.]+$/.exec(TC&&TC.keys&&TC.keys.IE_PROTO||"");return f?"Symbol(src)_1."+f:""}(),IC=Th.toString,Tse=MC.call(Gt),Mse=ii._,Ise=pE("^"+MC.call(Mt).replace(XR,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),_C=l$?J.Buffer:n,ru=J.Symbol,OC=J.Uint8Array,F$=_C?_C.allocUnsafe:n,LC=x$(Gt.getPrototypeOf,Gt),A$=Gt.create,D$=Th.propertyIsEnumerable,NC=kC.splice,P$=ru?ru.isConcatSpreadable:n,Rg=ru?ru.iterator:n,Ic=ru?ru.toStringTag:n,$C=function(){try{var f=$c(Gt,"defineProperty");return f({},"",{}),f}catch{}}(),_se=J.clearTimeout!==ii.clearTimeout&&J.clearTimeout,Ose=Ae&&Ae.now!==ii.Date.now&&Ae.now,Lse=J.setTimeout!==ii.setTimeout&&J.setTimeout,BC=In.ceil,GC=In.floor,gE=Gt.getOwnPropertySymbols,Nse=_C?_C.isBuffer:n,k$=J.isFinite,$se=kC.join,Bse=x$(Gt.keys,Gt),_n=In.max,yi=In.min,Gse=Ae.now,zse=J.parseInt,T$=In.random,Hse=kC.reverse,mE=$c(J,"DataView"),Eg=$c(J,"Map"),vE=$c(J,"Promise"),Mh=$c(J,"Set"),Fg=$c(J,"WeakMap"),Ag=$c(Gt,"create"),zC=Fg&&new Fg,Ih={},Vse=Bc(mE),Wse=Bc(Eg),Use=Bc(vE),jse=Bc(Mh),qse=Bc(Fg),HC=ru?ru.prototype:n,Dg=HC?HC.valueOf:n,M$=HC?HC.toString:n;function M(f){if(dn(f)&&!Qe(f)&&!(f instanceof ut)){if(f instanceof ls)return f;if(Mt.call(f,"__wrapped__"))return IB(f)}return new ls(f)}var _h=function(){function f(){}return function(m){if(!rn(m))return{};if(A$)return A$(m);f.prototype=m;var w=new f;return f.prototype=n,w}}();function VC(){}function ls(f,m){this.__wrapped__=f,this.__actions__=[],this.__chain__=!!m,this.__index__=0,this.__values__=n}M.templateSettings={escape:are,evaluate:lre,interpolate:zN,variable:"",imports:{_:M}},M.prototype=VC.prototype,M.prototype.constructor=M,ls.prototype=_h(VC.prototype),ls.prototype.constructor=ls;function ut(f){this.__wrapped__=f,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Re,this.__views__=[]}function Kse(){var f=new ut(this.__wrapped__);return f.__actions__=hr(this.__actions__),f.__dir__=this.__dir__,f.__filtered__=this.__filtered__,f.__iteratees__=hr(this.__iteratees__),f.__takeCount__=this.__takeCount__,f.__views__=hr(this.__views__),f}function Yse(){if(this.__filtered__){var f=new ut(this);f.__dir__=-1,f.__filtered__=!0}else f=this.clone(),f.__dir__*=-1;return f}function Xse(){var f=this.__wrapped__.value(),m=this.__dir__,w=Qe(f),R=m<0,D=w?f.length:0,I=lae(0,D,this.__views__),N=I.start,B=I.end,V=B-N,ne=R?B:N-1,ie=this.__iteratees__,se=ie.length,Se=0,Te=yi(V,this.__takeCount__);if(!w||!R&&D==V&&Te==V)return nB(f,this.__actions__);var He=[];e:for(;V--&&Se<Te;){ne+=m;for(var it=-1,Ve=f[ne];++it<se;){var lt=ie[it],ht=lt.iteratee,Br=lt.type,$i=ht(Ve);if(Br==L)Ve=$i;else if(!$i){if(Br==$)continue e;break e}}He[Se++]=Ve}return He}ut.prototype=_h(VC.prototype),ut.prototype.constructor=ut;function _c(f){var m=-1,w=f==null?0:f.length;for(this.clear();++m<w;){var R=f[m];this.set(R[0],R[1])}}function Qse(){this.__data__=Ag?Ag(null):{},this.size=0}function Jse(f){var m=this.has(f)&&delete this.__data__[f];return this.size-=m?1:0,m}function Zse(f){var m=this.__data__;if(Ag){var w=m[f];return w===l?n:w}return Mt.call(m,f)?m[f]:n}function eoe(f){var m=this.__data__;return Ag?m[f]!==n:Mt.call(m,f)}function toe(f,m){var w=this.__data__;return this.size+=this.has(f)?0:1,w[f]=Ag&&m===n?l:m,this}_c.prototype.clear=Qse,_c.prototype.delete=Jse,_c.prototype.get=Zse,_c.prototype.has=eoe,_c.prototype.set=toe;function Ha(f){var m=-1,w=f==null?0:f.length;for(this.clear();++m<w;){var R=f[m];this.set(R[0],R[1])}}function noe(){this.__data__=[],this.size=0}function ioe(f){var m=this.__data__,w=WC(m,f);if(w<0)return!1;var R=m.length-1;return w==R?m.pop():NC.call(m,w,1),--this.size,!0}function roe(f){var m=this.__data__,w=WC(m,f);return w<0?n:m[w][1]}function soe(f){return WC(this.__data__,f)>-1}function ooe(f,m){var w=this.__data__,R=WC(w,f);return R<0?(++this.size,w.push([f,m])):w[R][1]=m,this}Ha.prototype.clear=noe,Ha.prototype.delete=ioe,Ha.prototype.get=roe,Ha.prototype.has=soe,Ha.prototype.set=ooe;function Va(f){var m=-1,w=f==null?0:f.length;for(this.clear();++m<w;){var R=f[m];this.set(R[0],R[1])}}function aoe(){this.size=0,this.__data__={hash:new _c,map:new(Eg||Ha),string:new _c}}function loe(f){var m=ny(this,f).delete(f);return this.size-=m?1:0,m}function uoe(f){return ny(this,f).get(f)}function coe(f){return ny(this,f).has(f)}function doe(f,m){var w=ny(this,f),R=w.size;return w.set(f,m),this.size+=w.size==R?0:1,this}Va.prototype.clear=aoe,Va.prototype.delete=loe,Va.prototype.get=uoe,Va.prototype.has=coe,Va.prototype.set=doe;function Oc(f){var m=-1,w=f==null?0:f.length;for(this.__data__=new Va;++m<w;)this.add(f[m])}function hoe(f){return this.__data__.set(f,l),this}function foe(f){return this.__data__.has(f)}Oc.prototype.add=Oc.prototype.push=hoe,Oc.prototype.has=foe;function Ks(f){var m=this.__data__=new Ha(f);this.size=m.size}function poe(){this.__data__=new Ha,this.size=0}function goe(f){var m=this.__data__,w=m.delete(f);return this.size=m.size,w}function moe(f){return this.__data__.get(f)}function voe(f){return this.__data__.has(f)}function Coe(f,m){var w=this.__data__;if(w instanceof Ha){var R=w.__data__;if(!Eg||R.length<r-1)return R.push([f,m]),this.size=++w.size,this;w=this.__data__=new Va(R)}return w.set(f,m),this.size=w.size,this}Ks.prototype.clear=poe,Ks.prototype.delete=goe,Ks.prototype.get=moe,Ks.prototype.has=voe,Ks.prototype.set=Coe;function I$(f,m){var w=Qe(f),R=!w&&Gc(f),D=!w&&!R&&uu(f),I=!w&&!R&&!D&&$h(f),N=w||R||D||I,B=N?dE(f.length,Dse):[],V=B.length;for(var ne in f)(m||Mt.call(f,ne))&&!(N&&(ne=="length"||D&&(ne=="offset"||ne=="parent")||I&&(ne=="buffer"||ne=="byteLength"||ne=="byteOffset")||qa(ne,V)))&&B.push(ne);return B}function _$(f){var m=f.length;return m?f[DE(0,m-1)]:n}function yoe(f,m){return iy(hr(f),Lc(m,0,f.length))}function woe(f){return iy(hr(f))}function CE(f,m,w){(w!==n&&!Ys(f[m],w)||w===n&&!(m in f))&&Wa(f,m,w)}function Pg(f,m,w){var R=f[m];(!(Mt.call(f,m)&&Ys(R,w))||w===n&&!(m in f))&&Wa(f,m,w)}function WC(f,m){for(var w=f.length;w--;)if(Ys(f[w][0],m))return w;return-1}function boe(f,m,w,R){return su(f,function(D,I,N){m(R,D,w(D),N)}),R}function O$(f,m){return f&&zo(m,Un(m),f)}function Soe(f,m){return f&&zo(m,pr(m),f)}function Wa(f,m,w){m=="__proto__"&&$C?$C(f,m,{configurable:!0,enumerable:!0,value:w,writable:!0}):f[m]=w}function yE(f,m){for(var w=-1,R=m.length,D=U(R),I=f==null;++w<R;)D[w]=I?n:ZE(f,m[w]);return D}function Lc(f,m,w){return f===f&&(w!==n&&(f=f<=w?f:w),m!==n&&(f=f>=m?f:m)),f}function us(f,m,w,R,D,I){var N,B=m&d,V=m&h,ne=m&p;if(w&&(N=D?w(f,R,D,I):w(f)),N!==n)return N;if(!rn(f))return f;var ie=Qe(f);if(ie){if(N=cae(f),!B)return hr(f,N)}else{var se=wi(f),Se=se==le||se==Pn;if(uu(f))return sB(f,B);if(se==Tn||se==$e||Se&&!D){if(N=V||Se?{}:RB(f),!B)return V?Zoe(f,Soe(N,f)):Joe(f,O$(N,f))}else{if(!Ht[se])return D?f:{};N=dae(f,se,B)}}I||(I=new Ks);var Te=I.get(f);if(Te)return Te;I.set(f,N),ZB(f)?f.forEach(function(Ve){N.add(us(Ve,m,w,Ve,f,I))}):QB(f)&&f.forEach(function(Ve,lt){N.set(lt,us(Ve,m,w,lt,f,I))});var He=ne?V?BE:$E:V?pr:Un,it=ie?n:He(f);return os(it||f,function(Ve,lt){it&&(lt=Ve,Ve=f[lt]),Pg(N,lt,us(Ve,m,w,lt,f,I))}),N}function xoe(f){var m=Un(f);return function(w){return L$(w,f,m)}}function L$(f,m,w){var R=w.length;if(f==null)return!R;for(f=Gt(f);R--;){var D=w[R],I=m[D],N=f[D];if(N===n&&!(D in f)||!I(N))return!1}return!0}function N$(f,m,w){if(typeof f!="function")throw new as(o);return Lg(function(){f.apply(n,w)},m)}function kg(f,m,w,R){var D=-1,I=AC,N=!0,B=f.length,V=[],ne=m.length;if(!B)return V;w&&(m=Qt(m,Lr(w))),R?(I=sE,N=!1):m.length>=r&&(I=xg,N=!1,m=new Oc(m));e:for(;++D<B;){var ie=f[D],se=w==null?ie:w(ie);if(ie=R||ie!==0?ie:0,N&&se===se){for(var Se=ne;Se--;)if(m[Se]===se)continue e;V.push(ie)}else I(m,se,R)||V.push(ie)}return V}var su=cB(Go),$$=cB(bE,!0);function Roe(f,m){var w=!0;return su(f,function(R,D,I){return w=!!m(R,D,I),w}),w}function UC(f,m,w){for(var R=-1,D=f.length;++R<D;){var I=f[R],N=m(I);if(N!=null&&(B===n?N===N&&!$r(N):w(N,B)))var B=N,V=I}return V}function Eoe(f,m,w,R){var D=f.length;for(w=tt(w),w<0&&(w=-w>D?0:D+w),R=R===n||R>D?D:tt(R),R<0&&(R+=D),R=w>R?0:tG(R);w<R;)f[w++]=m;return f}function B$(f,m){var w=[];return su(f,function(R,D,I){m(R,D,I)&&w.push(R)}),w}function ri(f,m,w,R,D){var I=-1,N=f.length;for(w||(w=fae),D||(D=[]);++I<N;){var B=f[I];m>0&&w(B)?m>1?ri(B,m-1,w,R,D):nu(D,B):R||(D[D.length]=B)}return D}var wE=dB(),G$=dB(!0);function Go(f,m){return f&&wE(f,m,Un)}function bE(f,m){return f&&G$(f,m,Un)}function jC(f,m){return tu(m,function(w){return Ka(f[w])})}function Nc(f,m){m=au(m,f);for(var w=0,R=m.length;f!=null&&w<R;)f=f[Ho(m[w++])];return w&&w==R?f:n}function z$(f,m,w){var R=m(f);return Qe(f)?R:nu(R,w(f))}function Li(f){return f==null?f===n?ere:kn:Ic&&Ic in Gt(f)?aae(f):wae(f)}function SE(f,m){return f>m}function Foe(f,m){return f!=null&&Mt.call(f,m)}function Aoe(f,m){return f!=null&&m in Gt(f)}function Doe(f,m,w){return f>=yi(m,w)&&f<_n(m,w)}function xE(f,m,w){for(var R=w?sE:AC,D=f[0].length,I=f.length,N=I,B=U(I),V=1/0,ne=[];N--;){var ie=f[N];N&&m&&(ie=Qt(ie,Lr(m))),V=yi(ie.length,V),B[N]=!w&&(m||D>=120&&ie.length>=120)?new Oc(N&&ie):n}ie=f[0];var se=-1,Se=B[0];e:for(;++se<D&&ne.length<V;){var Te=ie[se],He=m?m(Te):Te;if(Te=w||Te!==0?Te:0,!(Se?xg(Se,He):R(ne,He,w))){for(N=I;--N;){var it=B[N];if(!(it?xg(it,He):R(f[N],He,w)))continue e}Se&&Se.push(He),ne.push(Te)}}return ne}function Poe(f,m,w,R){return Go(f,function(D,I,N){m(R,w(D),I,N)}),R}function Tg(f,m,w){m=au(m,f),f=DB(f,m);var R=f==null?f:f[Ho(ds(m))];return R==null?n:Or(R,f,w)}function H$(f){return dn(f)&&Li(f)==$e}function koe(f){return dn(f)&&Li(f)==Sg}function Toe(f){return dn(f)&&Li(f)==xe}function Mg(f,m,w,R,D){return f===m?!0:f==null||m==null||!dn(f)&&!dn(m)?f!==f&&m!==m:Moe(f,m,w,R,Mg,D)}function Moe(f,m,w,R,D,I){var N=Qe(f),B=Qe(m),V=N?nn:wi(f),ne=B?nn:wi(m);V=V==$e?Tn:V,ne=ne==$e?Tn:ne;var ie=V==Tn,se=ne==Tn,Se=V==ne;if(Se&&uu(f)){if(!uu(m))return!1;N=!0,ie=!1}if(Se&&!ie)return I||(I=new Ks),N||$h(f)?bB(f,m,w,R,D,I):sae(f,m,V,w,R,D,I);if(!(w&g)){var Te=ie&&Mt.call(f,"__wrapped__"),He=se&&Mt.call(m,"__wrapped__");if(Te||He){var it=Te?f.value():f,Ve=He?m.value():m;return I||(I=new Ks),D(it,Ve,w,R,I)}}return Se?(I||(I=new Ks),oae(f,m,w,R,D,I)):!1}function Ioe(f){return dn(f)&&wi(f)==et}function RE(f,m,w,R){var D=w.length,I=D,N=!R;if(f==null)return!I;for(f=Gt(f);D--;){var B=w[D];if(N&&B[2]?B[1]!==f[B[0]]:!(B[0]in f))return!1}for(;++D<I;){B=w[D];var V=B[0],ne=f[V],ie=B[1];if(N&&B[2]){if(ne===n&&!(V in f))return!1}else{var se=new Ks;if(R)var Se=R(ne,ie,V,f,m,se);if(!(Se===n?Mg(ie,ne,g|v,R,se):Se))return!1}}return!0}function V$(f){if(!rn(f)||gae(f))return!1;var m=Ka(f)?Ise:xre;return m.test(Bc(f))}function _oe(f){return dn(f)&&Li(f)==yg}function Ooe(f){return dn(f)&&wi(f)==js}function Loe(f){return dn(f)&&uy(f.length)&&!!jt[Li(f)]}function W$(f){return typeof f=="function"?f:f==null?gr:typeof f=="object"?Qe(f)?q$(f[0],f[1]):j$(f):hG(f)}function EE(f){if(!Og(f))return Bse(f);var m=[];for(var w in Gt(f))Mt.call(f,w)&&w!="constructor"&&m.push(w);return m}function Noe(f){if(!rn(f))return yae(f);var m=Og(f),w=[];for(var R in f)R=="constructor"&&(m||!Mt.call(f,R))||w.push(R);return w}function FE(f,m){return f<m}function U$(f,m){var w=-1,R=fr(f)?U(f.length):[];return su(f,function(D,I,N){R[++w]=m(D,I,N)}),R}function j$(f){var m=zE(f);return m.length==1&&m[0][2]?FB(m[0][0],m[0][1]):function(w){return w===f||RE(w,f,m)}}function q$(f,m){return VE(f)&&EB(m)?FB(Ho(f),m):function(w){var R=ZE(w,f);return R===n&&R===m?eF(w,f):Mg(m,R,g|v)}}function qC(f,m,w,R,D){f!==m&&wE(m,function(I,N){if(D||(D=new Ks),rn(I))$oe(f,m,N,w,qC,R,D);else{var B=R?R(UE(f,N),I,N+"",f,m,D):n;B===n&&(B=I),CE(f,N,B)}},pr)}function $oe(f,m,w,R,D,I,N){var B=UE(f,w),V=UE(m,w),ne=N.get(V);if(ne){CE(f,w,ne);return}var ie=I?I(B,V,w+"",f,m,N):n,se=ie===n;if(se){var Se=Qe(V),Te=!Se&&uu(V),He=!Se&&!Te&&$h(V);ie=V,Se||Te||He?Qe(B)?ie=B:bn(B)?ie=hr(B):Te?(se=!1,ie=sB(V,!0)):He?(se=!1,ie=oB(V,!0)):ie=[]:Ng(V)||Gc(V)?(ie=B,Gc(B)?ie=nG(B):(!rn(B)||Ka(B))&&(ie=RB(V))):se=!1}se&&(N.set(V,ie),D(ie,V,R,I,N),N.delete(V)),CE(f,w,ie)}function K$(f,m){var w=f.length;if(w)return m+=m<0?w:0,qa(m,w)?f[m]:n}function Y$(f,m,w){m.length?m=Qt(m,function(I){return Qe(I)?function(N){return Nc(N,I.length===1?I[0]:I)}:I}):m=[gr];var R=-1;m=Qt(m,Lr(Ge()));var D=U$(f,function(I,N,B){var V=Qt(m,function(ne){return ne(I)});return{criteria:V,index:++R,value:I}});return dse(D,function(I,N){return Qoe(I,N,w)})}function Boe(f,m){return X$(f,m,function(w,R){return eF(f,R)})}function X$(f,m,w){for(var R=-1,D=m.length,I={};++R<D;){var N=m[R],B=Nc(f,N);w(B,N)&&Ig(I,au(N,f),B)}return I}function Goe(f){return function(m){return Nc(m,f)}}function AE(f,m,w,R){var D=R?cse:Ah,I=-1,N=m.length,B=f;for(f===m&&(m=hr(m)),w&&(B=Qt(f,Lr(w)));++I<N;)for(var V=0,ne=m[I],ie=w?w(ne):ne;(V=D(B,ie,V,R))>-1;)B!==f&&NC.call(B,V,1),NC.call(f,V,1);return f}function Q$(f,m){for(var w=f?m.length:0,R=w-1;w--;){var D=m[w];if(w==R||D!==I){var I=D;qa(D)?NC.call(f,D,1):TE(f,D)}}return f}function DE(f,m){return f+GC(T$()*(m-f+1))}function zoe(f,m,w,R){for(var D=-1,I=_n(BC((m-f)/(w||1)),0),N=U(I);I--;)N[R?I:++D]=f,f+=w;return N}function PE(f,m){var w="";if(!f||m<1||m>ee)return w;do m%2&&(w+=f),m=GC(m/2),m&&(f+=f);while(m);return w}function rt(f,m){return jE(AB(f,m,gr),f+"")}function Hoe(f){return _$(Bh(f))}function Voe(f,m){var w=Bh(f);return iy(w,Lc(m,0,w.length))}function Ig(f,m,w,R){if(!rn(f))return f;m=au(m,f);for(var D=-1,I=m.length,N=I-1,B=f;B!=null&&++D<I;){var V=Ho(m[D]),ne=w;if(V==="__proto__"||V==="constructor"||V==="prototype")return f;if(D!=N){var ie=B[V];ne=R?R(ie,V,B):n,ne===n&&(ne=rn(ie)?ie:qa(m[D+1])?[]:{})}Pg(B,V,ne),B=B[V]}return f}var J$=zC?function(f,m){return zC.set(f,m),f}:gr,Woe=$C?function(f,m){return $C(f,"toString",{configurable:!0,enumerable:!1,value:nF(m),writable:!0})}:gr;function Uoe(f){return iy(Bh(f))}function cs(f,m,w){var R=-1,D=f.length;m<0&&(m=-m>D?0:D+m),w=w>D?D:w,w<0&&(w+=D),D=m>w?0:w-m>>>0,m>>>=0;for(var I=U(D);++R<D;)I[R]=f[R+m];return I}function joe(f,m){var w;return su(f,function(R,D,I){return w=m(R,D,I),!w}),!!w}function KC(f,m,w){var R=0,D=f==null?R:f.length;if(typeof m=="number"&&m===m&&D<=ze){for(;R<D;){var I=R+D>>>1,N=f[I];N!==null&&!$r(N)&&(w?N<=m:N<m)?R=I+1:D=I}return D}return kE(f,m,gr,w)}function kE(f,m,w,R){var D=0,I=f==null?0:f.length;if(I===0)return 0;m=w(m);for(var N=m!==m,B=m===null,V=$r(m),ne=m===n;D<I;){var ie=GC((D+I)/2),se=w(f[ie]),Se=se!==n,Te=se===null,He=se===se,it=$r(se);if(N)var Ve=R||He;else ne?Ve=He&&(R||Se):B?Ve=He&&Se&&(R||!Te):V?Ve=He&&Se&&!Te&&(R||!it):Te||it?Ve=!1:Ve=R?se<=m:se<m;Ve?D=ie+1:I=ie}return yi(I,Fe)}function Z$(f,m){for(var w=-1,R=f.length,D=0,I=[];++w<R;){var N=f[w],B=m?m(N):N;if(!w||!Ys(B,V)){var V=B;I[D++]=N===0?0:N}}return I}function eB(f){return typeof f=="number"?f:$r(f)?fe:+f}function Nr(f){if(typeof f=="string")return f;if(Qe(f))return Qt(f,Nr)+"";if($r(f))return M$?M$.call(f):"";var m=f+"";return m=="0"&&1/f==-1/0?"-0":m}function ou(f,m,w){var R=-1,D=AC,I=f.length,N=!0,B=[],V=B;if(w)N=!1,D=sE;else if(I>=r){var ne=m?null:iae(f);if(ne)return PC(ne);N=!1,D=xg,V=new Oc}else V=m?[]:B;e:for(;++R<I;){var ie=f[R],se=m?m(ie):ie;if(ie=w||ie!==0?ie:0,N&&se===se){for(var Se=V.length;Se--;)if(V[Se]===se)continue e;m&&V.push(se),B.push(ie)}else D(V,se,w)||(V!==B&&V.push(se),B.push(ie))}return B}function TE(f,m){return m=au(m,f),f=DB(f,m),f==null||delete f[Ho(ds(m))]}function tB(f,m,w,R){return Ig(f,m,w(Nc(f,m)),R)}function YC(f,m,w,R){for(var D=f.length,I=R?D:-1;(R?I--:++I<D)&&m(f[I],I,f););return w?cs(f,R?0:I,R?I+1:D):cs(f,R?I+1:0,R?D:I)}function nB(f,m){var w=f;return w instanceof ut&&(w=w.value()),oE(m,function(R,D){return D.func.apply(D.thisArg,nu([R],D.args))},w)}function ME(f,m,w){var R=f.length;if(R<2)return R?ou(f[0]):[];for(var D=-1,I=U(R);++D<R;)for(var N=f[D],B=-1;++B<R;)B!=D&&(I[D]=kg(I[D]||N,f[B],m,w));return ou(ri(I,1),m,w)}function iB(f,m,w){for(var R=-1,D=f.length,I=m.length,N={};++R<D;){var B=R<I?m[R]:n;w(N,f[R],B)}return N}function IE(f){return bn(f)?f:[]}function _E(f){return typeof f=="function"?f:gr}function au(f,m){return Qe(f)?f:VE(f,m)?[f]:MB(Pt(f))}var qoe=rt;function lu(f,m,w){var R=f.length;return w=w===n?R:w,!m&&w>=R?f:cs(f,m,w)}var rB=_se||function(f){return ii.clearTimeout(f)};function sB(f,m){if(m)return f.slice();var w=f.length,R=F$?F$(w):new f.constructor(w);return f.copy(R),R}function OE(f){var m=new f.constructor(f.byteLength);return new OC(m).set(new OC(f)),m}function Koe(f,m){var w=m?OE(f.buffer):f.buffer;return new f.constructor(w,f.byteOffset,f.byteLength)}function Yoe(f){var m=new f.constructor(f.source,HN.exec(f));return m.lastIndex=f.lastIndex,m}function Xoe(f){return Dg?Gt(Dg.call(f)):{}}function oB(f,m){var w=m?OE(f.buffer):f.buffer;return new f.constructor(w,f.byteOffset,f.length)}function aB(f,m){if(f!==m){var w=f!==n,R=f===null,D=f===f,I=$r(f),N=m!==n,B=m===null,V=m===m,ne=$r(m);if(!B&&!ne&&!I&&f>m||I&&N&&V&&!B&&!ne||R&&N&&V||!w&&V||!D)return 1;if(!R&&!I&&!ne&&f<m||ne&&w&&D&&!R&&!I||B&&w&&D||!N&&D||!V)return-1}return 0}function Qoe(f,m,w){for(var R=-1,D=f.criteria,I=m.criteria,N=D.length,B=w.length;++R<N;){var V=aB(D[R],I[R]);if(V){if(R>=B)return V;var ne=w[R];return V*(ne=="desc"?-1:1)}}return f.index-m.index}function lB(f,m,w,R){for(var D=-1,I=f.length,N=w.length,B=-1,V=m.length,ne=_n(I-N,0),ie=U(V+ne),se=!R;++B<V;)ie[B]=m[B];for(;++D<N;)(se||D<I)&&(ie[w[D]]=f[D]);for(;ne--;)ie[B++]=f[D++];return ie}function uB(f,m,w,R){for(var D=-1,I=f.length,N=-1,B=w.length,V=-1,ne=m.length,ie=_n(I-B,0),se=U(ie+ne),Se=!R;++D<ie;)se[D]=f[D];for(var Te=D;++V<ne;)se[Te+V]=m[V];for(;++N<B;)(Se||D<I)&&(se[Te+w[N]]=f[D++]);return se}function hr(f,m){var w=-1,R=f.length;for(m||(m=U(R));++w<R;)m[w]=f[w];return m}function zo(f,m,w,R){var D=!w;w||(w={});for(var I=-1,N=m.length;++I<N;){var B=m[I],V=R?R(w[B],f[B],B,w,f):n;V===n&&(V=f[B]),D?Wa(w,B,V):Pg(w,B,V)}return w}function Joe(f,m){return zo(f,HE(f),m)}function Zoe(f,m){return zo(f,SB(f),m)}function XC(f,m){return function(w,R){var D=Qe(w)?rse:boe,I=m?m():{};return D(w,f,Ge(R,2),I)}}function Oh(f){return rt(function(m,w){var R=-1,D=w.length,I=D>1?w[D-1]:n,N=D>2?w[2]:n;for(I=f.length>3&&typeof I=="function"?(D--,I):n,N&&Ni(w[0],w[1],N)&&(I=D<3?n:I,D=1),m=Gt(m);++R<D;){var B=w[R];B&&f(m,B,R,I)}return m})}function cB(f,m){return function(w,R){if(w==null)return w;if(!fr(w))return f(w,R);for(var D=w.length,I=m?D:-1,N=Gt(w);(m?I--:++I<D)&&R(N[I],I,N)!==!1;);return w}}function dB(f){return function(m,w,R){for(var D=-1,I=Gt(m),N=R(m),B=N.length;B--;){var V=N[f?B:++D];if(w(I[V],V,I)===!1)break}return m}}function eae(f,m,w){var R=m&C,D=_g(f);function I(){var N=this&&this!==ii&&this instanceof I?D:f;return N.apply(R?w:this,arguments)}return I}function hB(f){return function(m){m=Pt(m);var w=Dh(m)?qs(m):n,R=w?w[0]:m.charAt(0),D=w?lu(w,1).join(""):m.slice(1);return R[f]()+D}}function Lh(f){return function(m){return oE(cG(uG(m).replace(Wre,"")),f,"")}}function _g(f){return function(){var m=arguments;switch(m.length){case 0:return new f;case 1:return new f(m[0]);case 2:return new f(m[0],m[1]);case 3:return new f(m[0],m[1],m[2]);case 4:return new f(m[0],m[1],m[2],m[3]);case 5:return new f(m[0],m[1],m[2],m[3],m[4]);case 6:return new f(m[0],m[1],m[2],m[3],m[4],m[5]);case 7:return new f(m[0],m[1],m[2],m[3],m[4],m[5],m[6])}var w=_h(f.prototype),R=f.apply(w,m);return rn(R)?R:w}}function tae(f,m,w){var R=_g(f);function D(){for(var I=arguments.length,N=U(I),B=I,V=Nh(D);B--;)N[B]=arguments[B];var ne=I<3&&N[0]!==V&&N[I-1]!==V?[]:iu(N,V);if(I-=ne.length,I<w)return vB(f,m,QC,D.placeholder,n,N,ne,n,n,w-I);var ie=this&&this!==ii&&this instanceof D?R:f;return Or(ie,this,N)}return D}function fB(f){return function(m,w,R){var D=Gt(m);if(!fr(m)){var I=Ge(w,3);m=Un(m),w=function(B){return I(D[B],B,D)}}var N=f(m,w,R);return N>-1?D[I?m[N]:N]:n}}function pB(f){return ja(function(m){var w=m.length,R=w,D=ls.prototype.thru;for(f&&m.reverse();R--;){var I=m[R];if(typeof I!="function")throw new as(o);if(D&&!N&&ty(I)=="wrapper")var N=new ls([],!0)}for(R=N?R:w;++R<w;){I=m[R];var B=ty(I),V=B=="wrapper"?GE(I):n;V&&WE(V[0])&&V[1]==(F|S|E|k)&&!V[4].length&&V[9]==1?N=N[ty(V[0])].apply(N,V[3]):N=I.length==1&&WE(I)?N[B]():N.thru(I)}return function(){var ne=arguments,ie=ne[0];if(N&&ne.length==1&&Qe(ie))return N.plant(ie).value();for(var se=0,Se=w?m[se].apply(this,ne):ie;++se<w;)Se=m[se].call(this,Se);return Se}})}function QC(f,m,w,R,D,I,N,B,V,ne){var ie=m&F,se=m&C,Se=m&y,Te=m&(S|x),He=m&P,it=Se?n:_g(f);function Ve(){for(var lt=arguments.length,ht=U(lt),Br=lt;Br--;)ht[Br]=arguments[Br];if(Te)var $i=Nh(Ve),Gr=fse(ht,$i);if(R&&(ht=lB(ht,R,D,Te)),I&&(ht=uB(ht,I,N,Te)),lt-=Gr,Te&&lt<ne){var Sn=iu(ht,$i);return vB(f,m,QC,Ve.placeholder,w,ht,Sn,B,V,ne-lt)}var Xs=se?w:this,Xa=Se?Xs[f]:f;return lt=ht.length,B?ht=bae(ht,B):He&&lt>1&&ht.reverse(),ie&&V<lt&&(ht.length=V),this&&this!==ii&&this instanceof Ve&&(Xa=it||_g(Xa)),Xa.apply(Xs,ht)}return Ve}function gB(f,m){return function(w,R){return Poe(w,f,m(R),{})}}function JC(f,m){return function(w,R){var D;if(w===n&&R===n)return m;if(w!==n&&(D=w),R!==n){if(D===n)return R;typeof w=="string"||typeof R=="string"?(w=Nr(w),R=Nr(R)):(w=eB(w),R=eB(R)),D=f(w,R)}return D}}function LE(f){return ja(function(m){return m=Qt(m,Lr(Ge())),rt(function(w){var R=this;return f(m,function(D){return Or(D,R,w)})})})}function ZC(f,m){m=m===n?" ":Nr(m);var w=m.length;if(w<2)return w?PE(m,f):m;var R=PE(m,BC(f/Ph(m)));return Dh(m)?lu(qs(R),0,f).join(""):R.slice(0,f)}function nae(f,m,w,R){var D=m&C,I=_g(f);function N(){for(var B=-1,V=arguments.length,ne=-1,ie=R.length,se=U(ie+V),Se=this&&this!==ii&&this instanceof N?I:f;++ne<ie;)se[ne]=R[ne];for(;V--;)se[ne++]=arguments[++B];return Or(Se,D?w:this,se)}return N}function mB(f){return function(m,w,R){return R&&typeof R!="number"&&Ni(m,w,R)&&(w=R=n),m=Ya(m),w===n?(w=m,m=0):w=Ya(w),R=R===n?m<w?1:-1:Ya(R),zoe(m,w,R,f)}}function ey(f){return function(m,w){return typeof m=="string"&&typeof w=="string"||(m=hs(m),w=hs(w)),f(m,w)}}function vB(f,m,w,R,D,I,N,B,V,ne){var ie=m&S,se=ie?N:n,Se=ie?n:N,Te=ie?I:n,He=ie?n:I;m|=ie?E:A,m&=~(ie?A:E),m&b||(m&=-4);var it=[f,m,D,Te,se,He,Se,B,V,ne],Ve=w.apply(n,it);return WE(f)&&PB(Ve,it),Ve.placeholder=R,kB(Ve,f,m)}function NE(f){var m=In[f];return function(w,R){if(w=hs(w),R=R==null?0:yi(tt(R),292),R&&k$(w)){var D=(Pt(w)+"e").split("e"),I=m(D[0]+"e"+(+D[1]+R));return D=(Pt(I)+"e").split("e"),+(D[0]+"e"+(+D[1]-R))}return m(w)}}var iae=Mh&&1/PC(new Mh([,-0]))[1]==j?function(f){return new Mh(f)}:sF;function CB(f){return function(m){var w=wi(m);return w==et?fE(m):w==js?wse(m):hse(m,f(m))}}function Ua(f,m,w,R,D,I,N,B){var V=m&y;if(!V&&typeof f!="function")throw new as(o);var ne=R?R.length:0;if(ne||(m&=-97,R=D=n),N=N===n?N:_n(tt(N),0),B=B===n?B:tt(B),ne-=D?D.length:0,m&A){var ie=R,se=D;R=D=n}var Se=V?n:GE(f),Te=[f,m,w,R,D,ie,se,I,N,B];if(Se&&Cae(Te,Se),f=Te[0],m=Te[1],w=Te[2],R=Te[3],D=Te[4],B=Te[9]=Te[9]===n?V?0:f.length:_n(Te[9]-ne,0),!B&&m&(S|x)&&(m&=-25),!m||m==C)var He=eae(f,m,w);else m==S||m==x?He=tae(f,m,B):(m==E||m==(C|E))&&!D.length?He=nae(f,m,w,R):He=QC.apply(n,Te);var it=Se?J$:PB;return kB(it(He,Te),f,m)}function yB(f,m,w,R){return f===n||Ys(f,Th[w])&&!Mt.call(R,w)?m:f}function wB(f,m,w,R,D,I){return rn(f)&&rn(m)&&(I.set(m,f),qC(f,m,n,wB,I),I.delete(m)),f}function rae(f){return Ng(f)?n:f}function bB(f,m,w,R,D,I){var N=w&g,B=f.length,V=m.length;if(B!=V&&!(N&&V>B))return!1;var ne=I.get(f),ie=I.get(m);if(ne&&ie)return ne==m&&ie==f;var se=-1,Se=!0,Te=w&v?new Oc:n;for(I.set(f,m),I.set(m,f);++se<B;){var He=f[se],it=m[se];if(R)var Ve=N?R(it,He,se,m,f,I):R(He,it,se,f,m,I);if(Ve!==n){if(Ve)continue;Se=!1;break}if(Te){if(!aE(m,function(lt,ht){if(!xg(Te,ht)&&(He===lt||D(He,lt,w,R,I)))return Te.push(ht)})){Se=!1;break}}else if(!(He===it||D(He,it,w,R,I))){Se=!1;break}}return I.delete(f),I.delete(m),Se}function sae(f,m,w,R,D,I,N){switch(w){case Eh:if(f.byteLength!=m.byteLength||f.byteOffset!=m.byteOffset)return!1;f=f.buffer,m=m.buffer;case Sg:return!(f.byteLength!=m.byteLength||!I(new OC(f),new OC(m)));case dr:case xe:case cn:return Ys(+f,+m);case Xe:return f.name==m.name&&f.message==m.message;case yg:case wg:return f==m+"";case et:var B=fE;case js:var V=R&g;if(B||(B=PC),f.size!=m.size&&!V)return!1;var ne=N.get(f);if(ne)return ne==m;R|=v,N.set(f,m);var ie=bB(B(f),B(m),R,D,I,N);return N.delete(f),ie;case xC:if(Dg)return Dg.call(f)==Dg.call(m)}return!1}function oae(f,m,w,R,D,I){var N=w&g,B=$E(f),V=B.length,ne=$E(m),ie=ne.length;if(V!=ie&&!N)return!1;for(var se=V;se--;){var Se=B[se];if(!(N?Se in m:Mt.call(m,Se)))return!1}var Te=I.get(f),He=I.get(m);if(Te&&He)return Te==m&&He==f;var it=!0;I.set(f,m),I.set(m,f);for(var Ve=N;++se<V;){Se=B[se];var lt=f[Se],ht=m[Se];if(R)var Br=N?R(ht,lt,Se,m,f,I):R(lt,ht,Se,f,m,I);if(!(Br===n?lt===ht||D(lt,ht,w,R,I):Br)){it=!1;break}Ve||(Ve=Se=="constructor")}if(it&&!Ve){var $i=f.constructor,Gr=m.constructor;$i!=Gr&&"constructor"in f&&"constructor"in m&&!(typeof $i=="function"&&$i instanceof $i&&typeof Gr=="function"&&Gr instanceof Gr)&&(it=!1)}return I.delete(f),I.delete(m),it}function ja(f){return jE(AB(f,n,LB),f+"")}function $E(f){return z$(f,Un,HE)}function BE(f){return z$(f,pr,SB)}var GE=zC?function(f){return zC.get(f)}:sF;function ty(f){for(var m=f.name+"",w=Ih[m],R=Mt.call(Ih,m)?w.length:0;R--;){var D=w[R],I=D.func;if(I==null||I==f)return D.name}return m}function Nh(f){var m=Mt.call(M,"placeholder")?M:f;return m.placeholder}function Ge(){var f=M.iteratee||iF;return f=f===iF?W$:f,arguments.length?f(arguments[0],arguments[1]):f}function ny(f,m){var w=f.__data__;return pae(m)?w[typeof m=="string"?"string":"hash"]:w.map}function zE(f){for(var m=Un(f),w=m.length;w--;){var R=m[w],D=f[R];m[w]=[R,D,EB(D)]}return m}function $c(f,m){var w=vse(f,m);return V$(w)?w:n}function aae(f){var m=Mt.call(f,Ic),w=f[Ic];try{f[Ic]=n;var R=!0}catch{}var D=IC.call(f);return R&&(m?f[Ic]=w:delete f[Ic]),D}var HE=gE?function(f){return f==null?[]:(f=Gt(f),tu(gE(f),function(m){return D$.call(f,m)}))}:oF,SB=gE?function(f){for(var m=[];f;)nu(m,HE(f)),f=LC(f);return m}:oF,wi=Li;(mE&&wi(new mE(new ArrayBuffer(1)))!=Eh||Eg&&wi(new Eg)!=et||vE&&wi(vE.resolve())!=Tc||Mh&&wi(new Mh)!=js||Fg&&wi(new Fg)!=bg)&&(wi=function(f){var m=Li(f),w=m==Tn?f.constructor:n,R=w?Bc(w):"";if(R)switch(R){case Vse:return Eh;case Wse:return et;case Use:return Tc;case jse:return js;case qse:return bg}return m});function lae(f,m,w){for(var R=-1,D=w.length;++R<D;){var I=w[R],N=I.size;switch(I.type){case"drop":f+=N;break;case"dropRight":m-=N;break;case"take":m=yi(m,f+N);break;case"takeRight":f=_n(f,m-N);break}}return{start:f,end:m}}function uae(f){var m=f.match(gre);return m?m[1].split(mre):[]}function xB(f,m,w){m=au(m,f);for(var R=-1,D=m.length,I=!1;++R<D;){var N=Ho(m[R]);if(!(I=f!=null&&w(f,N)))break;f=f[N]}return I||++R!=D?I:(D=f==null?0:f.length,!!D&&uy(D)&&qa(N,D)&&(Qe(f)||Gc(f)))}function cae(f){var m=f.length,w=new f.constructor(m);return m&&typeof f[0]=="string"&&Mt.call(f,"index")&&(w.index=f.index,w.input=f.input),w}function RB(f){return typeof f.constructor=="function"&&!Og(f)?_h(LC(f)):{}}function dae(f,m,w){var R=f.constructor;switch(m){case Sg:return OE(f);case dr:case xe:return new R(+f);case Eh:return Koe(f,w);case zR:case HR:case VR:case WR:case UR:case jR:case qR:case KR:case YR:return oB(f,w);case et:return new R;case cn:case wg:return new R(f);case yg:return Yoe(f);case js:return new R;case xC:return Xoe(f)}}function hae(f,m){var w=m.length;if(!w)return f;var R=w-1;return m[R]=(w>1?"& ":"")+m[R],m=m.join(w>2?", ":" "),f.replace(pre,`{
/* [wrapped with `+m+`] */
`)}function fae(f){return Qe(f)||Gc(f)||!!(P$&&f&&f[P$])}function qa(f,m){var w=typeof f;return m=m??ee,!!m&&(w=="number"||w!="symbol"&&Ere.test(f))&&f>-1&&f%1==0&&f<m}function Ni(f,m,w){if(!rn(w))return!1;var R=typeof m;return(R=="number"?fr(w)&&qa(m,w.length):R=="string"&&m in w)?Ys(w[m],f):!1}function VE(f,m){if(Qe(f))return!1;var w=typeof f;return w=="number"||w=="symbol"||w=="boolean"||f==null||$r(f)?!0:cre.test(f)||!ure.test(f)||m!=null&&f in Gt(m)}function pae(f){var m=typeof f;return m=="string"||m=="number"||m=="symbol"||m=="boolean"?f!=="__proto__":f===null}function WE(f){var m=ty(f),w=M[m];if(typeof w!="function"||!(m in ut.prototype))return!1;if(f===w)return!0;var R=GE(w);return!!R&&f===R[0]}function gae(f){return!!E$&&E$ in f}var mae=TC?Ka:aF;function Og(f){var m=f&&f.constructor,w=typeof m=="function"&&m.prototype||Th;return f===w}function EB(f){return f===f&&!rn(f)}function FB(f,m){return function(w){return w==null?!1:w[f]===m&&(m!==n||f in Gt(w))}}function vae(f){var m=ay(f,function(R){return w.size===u&&w.clear(),R}),w=m.cache;return m}function Cae(f,m){var w=f[1],R=m[1],D=w|R,I=D<(C|y|F),N=R==F&&w==S||R==F&&w==k&&f[7].length<=m[8]||R==(F|k)&&m[7].length<=m[8]&&w==S;if(!(I||N))return f;R&C&&(f[2]=m[2],D|=w&C?0:b);var B=m[3];if(B){var V=f[3];f[3]=V?lB(V,B,m[4]):B,f[4]=V?iu(f[3],c):m[4]}return B=m[5],B&&(V=f[5],f[5]=V?uB(V,B,m[6]):B,f[6]=V?iu(f[5],c):m[6]),B=m[7],B&&(f[7]=B),R&F&&(f[8]=f[8]==null?m[8]:yi(f[8],m[8])),f[9]==null&&(f[9]=m[9]),f[0]=m[0],f[1]=D,f}function yae(f){var m=[];if(f!=null)for(var w in Gt(f))m.push(w);return m}function wae(f){return IC.call(f)}function AB(f,m,w){return m=_n(m===n?f.length-1:m,0),function(){for(var R=arguments,D=-1,I=_n(R.length-m,0),N=U(I);++D<I;)N[D]=R[m+D];D=-1;for(var B=U(m+1);++D<m;)B[D]=R[D];return B[m]=w(N),Or(f,this,B)}}function DB(f,m){return m.length<2?f:Nc(f,cs(m,0,-1))}function bae(f,m){for(var w=f.length,R=yi(m.length,w),D=hr(f);R--;){var I=m[R];f[R]=qa(I,w)?D[I]:n}return f}function UE(f,m){if(!(m==="constructor"&&typeof f[m]=="function")&&m!="__proto__")return f[m]}var PB=TB(J$),Lg=Lse||function(f,m){return ii.setTimeout(f,m)},jE=TB(Woe);function kB(f,m,w){var R=m+"";return jE(f,hae(R,Sae(uae(R),w)))}function TB(f){var m=0,w=0;return function(){var R=Gse(),D=W-(R-w);if(w=R,D>0){if(++m>=H)return arguments[0]}else m=0;return f.apply(n,arguments)}}function iy(f,m){var w=-1,R=f.length,D=R-1;for(m=m===n?R:m;++w<m;){var I=DE(w,D),N=f[I];f[I]=f[w],f[w]=N}return f.length=m,f}var MB=vae(function(f){var m=[];return f.charCodeAt(0)===46&&m.push(""),f.replace(dre,function(w,R,D,I){m.push(D?I.replace(yre,"$1"):R||w)}),m});function Ho(f){if(typeof f=="string"||$r(f))return f;var m=f+"";return m=="0"&&1/f==-1/0?"-0":m}function Bc(f){if(f!=null){try{return MC.call(f)}catch{}try{return f+""}catch{}}return""}function Sae(f,m){return os(Ft,function(w){var R="_."+w[0];m&w[1]&&!AC(f,R)&&f.push(R)}),f.sort()}function IB(f){if(f instanceof ut)return f.clone();var m=new ls(f.__wrapped__,f.__chain__);return m.__actions__=hr(f.__actions__),m.__index__=f.__index__,m.__values__=f.__values__,m}function xae(f,m,w){(w?Ni(f,m,w):m===n)?m=1:m=_n(tt(m),0);var R=f==null?0:f.length;if(!R||m<1)return[];for(var D=0,I=0,N=U(BC(R/m));D<R;)N[I++]=cs(f,D,D+=m);return N}function Rae(f){for(var m=-1,w=f==null?0:f.length,R=0,D=[];++m<w;){var I=f[m];I&&(D[R++]=I)}return D}function Eae(){var f=arguments.length;if(!f)return[];for(var m=U(f-1),w=arguments[0],R=f;R--;)m[R-1]=arguments[R];return nu(Qe(w)?hr(w):[w],ri(m,1))}var Fae=rt(function(f,m){return bn(f)?kg(f,ri(m,1,bn,!0)):[]}),Aae=rt(function(f,m){var w=ds(m);return bn(w)&&(w=n),bn(f)?kg(f,ri(m,1,bn,!0),Ge(w,2)):[]}),Dae=rt(function(f,m){var w=ds(m);return bn(w)&&(w=n),bn(f)?kg(f,ri(m,1,bn,!0),n,w):[]});function Pae(f,m,w){var R=f==null?0:f.length;return R?(m=w||m===n?1:tt(m),cs(f,m<0?0:m,R)):[]}function kae(f,m,w){var R=f==null?0:f.length;return R?(m=w||m===n?1:tt(m),m=R-m,cs(f,0,m<0?0:m)):[]}function Tae(f,m){return f&&f.length?YC(f,Ge(m,3),!0,!0):[]}function Mae(f,m){return f&&f.length?YC(f,Ge(m,3),!0):[]}function Iae(f,m,w,R){var D=f==null?0:f.length;return D?(w&&typeof w!="number"&&Ni(f,m,w)&&(w=0,R=D),Eoe(f,m,w,R)):[]}function _B(f,m,w){var R=f==null?0:f.length;if(!R)return-1;var D=w==null?0:tt(w);return D<0&&(D=_n(R+D,0)),DC(f,Ge(m,3),D)}function OB(f,m,w){var R=f==null?0:f.length;if(!R)return-1;var D=R-1;return w!==n&&(D=tt(w),D=w<0?_n(R+D,0):yi(D,R-1)),DC(f,Ge(m,3),D,!0)}function LB(f){var m=f==null?0:f.length;return m?ri(f,1):[]}function _ae(f){var m=f==null?0:f.length;return m?ri(f,j):[]}function Oae(f,m){var w=f==null?0:f.length;return w?(m=m===n?1:tt(m),ri(f,m)):[]}function Lae(f){for(var m=-1,w=f==null?0:f.length,R={};++m<w;){var D=f[m];R[D[0]]=D[1]}return R}function NB(f){return f&&f.length?f[0]:n}function Nae(f,m,w){var R=f==null?0:f.length;if(!R)return-1;var D=w==null?0:tt(w);return D<0&&(D=_n(R+D,0)),Ah(f,m,D)}function $ae(f){var m=f==null?0:f.length;return m?cs(f,0,-1):[]}var Bae=rt(function(f){var m=Qt(f,IE);return m.length&&m[0]===f[0]?xE(m):[]}),Gae=rt(function(f){var m=ds(f),w=Qt(f,IE);return m===ds(w)?m=n:w.pop(),w.length&&w[0]===f[0]?xE(w,Ge(m,2)):[]}),zae=rt(function(f){var m=ds(f),w=Qt(f,IE);return m=typeof m=="function"?m:n,m&&w.pop(),w.length&&w[0]===f[0]?xE(w,n,m):[]});function Hae(f,m){return f==null?"":$se.call(f,m)}function ds(f){var m=f==null?0:f.length;return m?f[m-1]:n}function Vae(f,m,w){var R=f==null?0:f.length;if(!R)return-1;var D=R;return w!==n&&(D=tt(w),D=D<0?_n(R+D,0):yi(D,R-1)),m===m?Sse(f,m,D):DC(f,v$,D,!0)}function Wae(f,m){return f&&f.length?K$(f,tt(m)):n}var Uae=rt($B);function $B(f,m){return f&&f.length&&m&&m.length?AE(f,m):f}function jae(f,m,w){return f&&f.length&&m&&m.length?AE(f,m,Ge(w,2)):f}function qae(f,m,w){return f&&f.length&&m&&m.length?AE(f,m,n,w):f}var Kae=ja(function(f,m){var w=f==null?0:f.length,R=yE(f,m);return Q$(f,Qt(m,function(D){return qa(D,w)?+D:D}).sort(aB)),R});function Yae(f,m){var w=[];if(!(f&&f.length))return w;var R=-1,D=[],I=f.length;for(m=Ge(m,3);++R<I;){var N=f[R];m(N,R,f)&&(w.push(N),D.push(R))}return Q$(f,D),w}function qE(f){return f==null?f:Hse.call(f)}function Xae(f,m,w){var R=f==null?0:f.length;return R?(w&&typeof w!="number"&&Ni(f,m,w)?(m=0,w=R):(m=m==null?0:tt(m),w=w===n?R:tt(w)),cs(f,m,w)):[]}function Qae(f,m){return KC(f,m)}function Jae(f,m,w){return kE(f,m,Ge(w,2))}function Zae(f,m){var w=f==null?0:f.length;if(w){var R=KC(f,m);if(R<w&&Ys(f[R],m))return R}return-1}function ele(f,m){return KC(f,m,!0)}function tle(f,m,w){return kE(f,m,Ge(w,2),!0)}function nle(f,m){var w=f==null?0:f.length;if(w){var R=KC(f,m,!0)-1;if(Ys(f[R],m))return R}return-1}function ile(f){return f&&f.length?Z$(f):[]}function rle(f,m){return f&&f.length?Z$(f,Ge(m,2)):[]}function sle(f){var m=f==null?0:f.length;return m?cs(f,1,m):[]}function ole(f,m,w){return f&&f.length?(m=w||m===n?1:tt(m),cs(f,0,m<0?0:m)):[]}function ale(f,m,w){var R=f==null?0:f.length;return R?(m=w||m===n?1:tt(m),m=R-m,cs(f,m<0?0:m,R)):[]}function lle(f,m){return f&&f.length?YC(f,Ge(m,3),!1,!0):[]}function ule(f,m){return f&&f.length?YC(f,Ge(m,3)):[]}var cle=rt(function(f){return ou(ri(f,1,bn,!0))}),dle=rt(function(f){var m=ds(f);return bn(m)&&(m=n),ou(ri(f,1,bn,!0),Ge(m,2))}),hle=rt(function(f){var m=ds(f);return m=typeof m=="function"?m:n,ou(ri(f,1,bn,!0),n,m)});function fle(f){return f&&f.length?ou(f):[]}function ple(f,m){return f&&f.length?ou(f,Ge(m,2)):[]}function gle(f,m){return m=typeof m=="function"?m:n,f&&f.length?ou(f,n,m):[]}function KE(f){if(!(f&&f.length))return[];var m=0;return f=tu(f,function(w){if(bn(w))return m=_n(w.length,m),!0}),dE(m,function(w){return Qt(f,lE(w))})}function BB(f,m){if(!(f&&f.length))return[];var w=KE(f);return m==null?w:Qt(w,function(R){return Or(m,n,R)})}var mle=rt(function(f,m){return bn(f)?kg(f,m):[]}),vle=rt(function(f){return ME(tu(f,bn))}),Cle=rt(function(f){var m=ds(f);return bn(m)&&(m=n),ME(tu(f,bn),Ge(m,2))}),yle=rt(function(f){var m=ds(f);return m=typeof m=="function"?m:n,ME(tu(f,bn),n,m)}),wle=rt(KE);function ble(f,m){return iB(f||[],m||[],Pg)}function Sle(f,m){return iB(f||[],m||[],Ig)}var xle=rt(function(f){var m=f.length,w=m>1?f[m-1]:n;return w=typeof w=="function"?(f.pop(),w):n,BB(f,w)});function GB(f){var m=M(f);return m.__chain__=!0,m}function Rle(f,m){return m(f),f}function ry(f,m){return m(f)}var Ele=ja(function(f){var m=f.length,w=m?f[0]:0,R=this.__wrapped__,D=function(I){return yE(I,f)};return m>1||this.__actions__.length||!(R instanceof ut)||!qa(w)?this.thru(D):(R=R.slice(w,+w+(m?1:0)),R.__actions__.push({func:ry,args:[D],thisArg:n}),new ls(R,this.__chain__).thru(function(I){return m&&!I.length&&I.push(n),I}))});function Fle(){return GB(this)}function Ale(){return new ls(this.value(),this.__chain__)}function Dle(){this.__values__===n&&(this.__values__=eG(this.value()));var f=this.__index__>=this.__values__.length,m=f?n:this.__values__[this.__index__++];return{done:f,value:m}}function Ple(){return this}function kle(f){for(var m,w=this;w instanceof VC;){var R=IB(w);R.__index__=0,R.__values__=n,m?D.__wrapped__=R:m=R;var D=R;w=w.__wrapped__}return D.__wrapped__=f,m}function Tle(){var f=this.__wrapped__;if(f instanceof ut){var m=f;return this.__actions__.length&&(m=new ut(this)),m=m.reverse(),m.__actions__.push({func:ry,args:[qE],thisArg:n}),new ls(m,this.__chain__)}return this.thru(qE)}function Mle(){return nB(this.__wrapped__,this.__actions__)}var Ile=XC(function(f,m,w){Mt.call(f,w)?++f[w]:Wa(f,w,1)});function _le(f,m,w){var R=Qe(f)?g$:Roe;return w&&Ni(f,m,w)&&(m=n),R(f,Ge(m,3))}function Ole(f,m){var w=Qe(f)?tu:B$;return w(f,Ge(m,3))}var Lle=fB(_B),Nle=fB(OB);function $le(f,m){return ri(sy(f,m),1)}function Ble(f,m){return ri(sy(f,m),j)}function Gle(f,m,w){return w=w===n?1:tt(w),ri(sy(f,m),w)}function zB(f,m){var w=Qe(f)?os:su;return w(f,Ge(m,3))}function HB(f,m){var w=Qe(f)?sse:$$;return w(f,Ge(m,3))}var zle=XC(function(f,m,w){Mt.call(f,w)?f[w].push(m):Wa(f,w,[m])});function Hle(f,m,w,R){f=fr(f)?f:Bh(f),w=w&&!R?tt(w):0;var D=f.length;return w<0&&(w=_n(D+w,0)),cy(f)?w<=D&&f.indexOf(m,w)>-1:!!D&&Ah(f,m,w)>-1}var Vle=rt(function(f,m,w){var R=-1,D=typeof m=="function",I=fr(f)?U(f.length):[];return su(f,function(N){I[++R]=D?Or(m,N,w):Tg(N,m,w)}),I}),Wle=XC(function(f,m,w){Wa(f,w,m)});function sy(f,m){var w=Qe(f)?Qt:U$;return w(f,Ge(m,3))}function Ule(f,m,w,R){return f==null?[]:(Qe(m)||(m=m==null?[]:[m]),w=R?n:w,Qe(w)||(w=w==null?[]:[w]),Y$(f,m,w))}var jle=XC(function(f,m,w){f[w?0:1].push(m)},function(){return[[],[]]});function qle(f,m,w){var R=Qe(f)?oE:y$,D=arguments.length<3;return R(f,Ge(m,4),w,D,su)}function Kle(f,m,w){var R=Qe(f)?ose:y$,D=arguments.length<3;return R(f,Ge(m,4),w,D,$$)}function Yle(f,m){var w=Qe(f)?tu:B$;return w(f,ly(Ge(m,3)))}function Xle(f){var m=Qe(f)?_$:Hoe;return m(f)}function Qle(f,m,w){(w?Ni(f,m,w):m===n)?m=1:m=tt(m);var R=Qe(f)?yoe:Voe;return R(f,m)}function Jle(f){var m=Qe(f)?woe:Uoe;return m(f)}function Zle(f){if(f==null)return 0;if(fr(f))return cy(f)?Ph(f):f.length;var m=wi(f);return m==et||m==js?f.size:EE(f).length}function eue(f,m,w){var R=Qe(f)?aE:joe;return w&&Ni(f,m,w)&&(m=n),R(f,Ge(m,3))}var tue=rt(function(f,m){if(f==null)return[];var w=m.length;return w>1&&Ni(f,m[0],m[1])?m=[]:w>2&&Ni(m[0],m[1],m[2])&&(m=[m[0]]),Y$(f,ri(m,1),[])}),oy=Ose||function(){return ii.Date.now()};function nue(f,m){if(typeof m!="function")throw new as(o);return f=tt(f),function(){if(--f<1)return m.apply(this,arguments)}}function VB(f,m,w){return m=w?n:m,m=f&&m==null?f.length:m,Ua(f,F,n,n,n,n,m)}function WB(f,m){var w;if(typeof m!="function")throw new as(o);return f=tt(f),function(){return--f>0&&(w=m.apply(this,arguments)),f<=1&&(m=n),w}}var YE=rt(function(f,m,w){var R=C;if(w.length){var D=iu(w,Nh(YE));R|=E}return Ua(f,R,m,w,D)}),UB=rt(function(f,m,w){var R=C|y;if(w.length){var D=iu(w,Nh(UB));R|=E}return Ua(m,R,f,w,D)});function jB(f,m,w){m=w?n:m;var R=Ua(f,S,n,n,n,n,n,m);return R.placeholder=jB.placeholder,R}function qB(f,m,w){m=w?n:m;var R=Ua(f,x,n,n,n,n,n,m);return R.placeholder=qB.placeholder,R}function KB(f,m,w){var R,D,I,N,B,V,ne=0,ie=!1,se=!1,Se=!0;if(typeof f!="function")throw new as(o);m=hs(m)||0,rn(w)&&(ie=!!w.leading,se="maxWait"in w,I=se?_n(hs(w.maxWait)||0,m):I,Se="trailing"in w?!!w.trailing:Se);function Te(Sn){var Xs=R,Xa=D;return R=D=n,ne=Sn,N=f.apply(Xa,Xs),N}function He(Sn){return ne=Sn,B=Lg(lt,m),ie?Te(Sn):N}function it(Sn){var Xs=Sn-V,Xa=Sn-ne,fG=m-Xs;return se?yi(fG,I-Xa):fG}function Ve(Sn){var Xs=Sn-V,Xa=Sn-ne;return V===n||Xs>=m||Xs<0||se&&Xa>=I}function lt(){var Sn=oy();if(Ve(Sn))return ht(Sn);B=Lg(lt,it(Sn))}function ht(Sn){return B=n,Se&&R?Te(Sn):(R=D=n,N)}function Br(){B!==n&&rB(B),ne=0,R=V=D=B=n}function $i(){return B===n?N:ht(oy())}function Gr(){var Sn=oy(),Xs=Ve(Sn);if(R=arguments,D=this,V=Sn,Xs){if(B===n)return He(V);if(se)return rB(B),B=Lg(lt,m),Te(V)}return B===n&&(B=Lg(lt,m)),N}return Gr.cancel=Br,Gr.flush=$i,Gr}var iue=rt(function(f,m){return N$(f,1,m)}),rue=rt(function(f,m,w){return N$(f,hs(m)||0,w)});function sue(f){return Ua(f,P)}function ay(f,m){if(typeof f!="function"||m!=null&&typeof m!="function")throw new as(o);var w=function(){var R=arguments,D=m?m.apply(this,R):R[0],I=w.cache;if(I.has(D))return I.get(D);var N=f.apply(this,R);return w.cache=I.set(D,N)||I,N};return w.cache=new(ay.Cache||Va),w}ay.Cache=Va;function ly(f){if(typeof f!="function")throw new as(o);return function(){var m=arguments;switch(m.length){case 0:return!f.call(this);case 1:return!f.call(this,m[0]);case 2:return!f.call(this,m[0],m[1]);case 3:return!f.call(this,m[0],m[1],m[2])}return!f.apply(this,m)}}function oue(f){return WB(2,f)}var aue=qoe(function(f,m){m=m.length==1&&Qe(m[0])?Qt(m[0],Lr(Ge())):Qt(ri(m,1),Lr(Ge()));var w=m.length;return rt(function(R){for(var D=-1,I=yi(R.length,w);++D<I;)R[D]=m[D].call(this,R[D]);return Or(f,this,R)})}),XE=rt(function(f,m){var w=iu(m,Nh(XE));return Ua(f,E,n,m,w)}),YB=rt(function(f,m){var w=iu(m,Nh(YB));return Ua(f,A,n,m,w)}),lue=ja(function(f,m){return Ua(f,k,n,n,n,m)});function uue(f,m){if(typeof f!="function")throw new as(o);return m=m===n?m:tt(m),rt(f,m)}function cue(f,m){if(typeof f!="function")throw new as(o);return m=m==null?0:_n(tt(m),0),rt(function(w){var R=w[m],D=lu(w,0,m);return R&&nu(D,R),Or(f,this,D)})}function due(f,m,w){var R=!0,D=!0;if(typeof f!="function")throw new as(o);return rn(w)&&(R="leading"in w?!!w.leading:R,D="trailing"in w?!!w.trailing:D),KB(f,m,{leading:R,maxWait:m,trailing:D})}function hue(f){return VB(f,1)}function fue(f,m){return XE(_E(m),f)}function pue(){if(!arguments.length)return[];var f=arguments[0];return Qe(f)?f:[f]}function gue(f){return us(f,p)}function mue(f,m){return m=typeof m=="function"?m:n,us(f,p,m)}function vue(f){return us(f,d|p)}function Cue(f,m){return m=typeof m=="function"?m:n,us(f,d|p,m)}function yue(f,m){return m==null||L$(f,m,Un(m))}function Ys(f,m){return f===m||f!==f&&m!==m}var wue=ey(SE),bue=ey(function(f,m){return f>=m}),Gc=H$(function(){return arguments}())?H$:function(f){return dn(f)&&Mt.call(f,"callee")&&!D$.call(f,"callee")},Qe=U.isArray,Sue=u$?Lr(u$):koe;function fr(f){return f!=null&&uy(f.length)&&!Ka(f)}function bn(f){return dn(f)&&fr(f)}function xue(f){return f===!0||f===!1||dn(f)&&Li(f)==dr}var uu=Nse||aF,Rue=c$?Lr(c$):Toe;function Eue(f){return dn(f)&&f.nodeType===1&&!Ng(f)}function Fue(f){if(f==null)return!0;if(fr(f)&&(Qe(f)||typeof f=="string"||typeof f.splice=="function"||uu(f)||$h(f)||Gc(f)))return!f.length;var m=wi(f);if(m==et||m==js)return!f.size;if(Og(f))return!EE(f).length;for(var w in f)if(Mt.call(f,w))return!1;return!0}function Aue(f,m){return Mg(f,m)}function Due(f,m,w){w=typeof w=="function"?w:n;var R=w?w(f,m):n;return R===n?Mg(f,m,n,w):!!R}function QE(f){if(!dn(f))return!1;var m=Li(f);return m==Xe||m==Ye||typeof f.message=="string"&&typeof f.name=="string"&&!Ng(f)}function Pue(f){return typeof f=="number"&&k$(f)}function Ka(f){if(!rn(f))return!1;var m=Li(f);return m==le||m==Pn||m==za||m==Zie}function XB(f){return typeof f=="number"&&f==tt(f)}function uy(f){return typeof f=="number"&&f>-1&&f%1==0&&f<=ee}function rn(f){var m=typeof f;return f!=null&&(m=="object"||m=="function")}function dn(f){return f!=null&&typeof f=="object"}var QB=d$?Lr(d$):Ioe;function kue(f,m){return f===m||RE(f,m,zE(m))}function Tue(f,m,w){return w=typeof w=="function"?w:n,RE(f,m,zE(m),w)}function Mue(f){return JB(f)&&f!=+f}function Iue(f){if(mae(f))throw new Ke(s);return V$(f)}function _ue(f){return f===null}function Oue(f){return f==null}function JB(f){return typeof f=="number"||dn(f)&&Li(f)==cn}function Ng(f){if(!dn(f)||Li(f)!=Tn)return!1;var m=LC(f);if(m===null)return!0;var w=Mt.call(m,"constructor")&&m.constructor;return typeof w=="function"&&w instanceof w&&MC.call(w)==Tse}var JE=h$?Lr(h$):_oe;function Lue(f){return XB(f)&&f>=-9007199254740991&&f<=ee}var ZB=f$?Lr(f$):Ooe;function cy(f){return typeof f=="string"||!Qe(f)&&dn(f)&&Li(f)==wg}function $r(f){return typeof f=="symbol"||dn(f)&&Li(f)==xC}var $h=p$?Lr(p$):Loe;function Nue(f){return f===n}function $ue(f){return dn(f)&&wi(f)==bg}function Bue(f){return dn(f)&&Li(f)==tre}var Gue=ey(FE),zue=ey(function(f,m){return f<=m});function eG(f){if(!f)return[];if(fr(f))return cy(f)?qs(f):hr(f);if(Rg&&f[Rg])return yse(f[Rg]());var m=wi(f),w=m==et?fE:m==js?PC:Bh;return w(f)}function Ya(f){if(!f)return f===0?f:0;if(f=hs(f),f===j||f===-1/0){var m=f<0?-1:1;return m*q}return f===f?f:0}function tt(f){var m=Ya(f),w=m%1;return m===m?w?m-w:m:0}function tG(f){return f?Lc(tt(f),0,Re):0}function hs(f){if(typeof f=="number")return f;if($r(f))return fe;if(rn(f)){var m=typeof f.valueOf=="function"?f.valueOf():f;f=rn(m)?m+"":m}if(typeof f!="string")return f===0?f:+f;f=w$(f);var w=Sre.test(f);return w||Rre.test(f)?nse(f.slice(2),w?2:8):bre.test(f)?fe:+f}function nG(f){return zo(f,pr(f))}function Hue(f){return f?Lc(tt(f),-9007199254740991,ee):f===0?f:0}function Pt(f){return f==null?"":Nr(f)}var Vue=Oh(function(f,m){if(Og(m)||fr(m)){zo(m,Un(m),f);return}for(var w in m)Mt.call(m,w)&&Pg(f,w,m[w])}),iG=Oh(function(f,m){zo(m,pr(m),f)}),dy=Oh(function(f,m,w,R){zo(m,pr(m),f,R)}),Wue=Oh(function(f,m,w,R){zo(m,Un(m),f,R)}),Uue=ja(yE);function jue(f,m){var w=_h(f);return m==null?w:O$(w,m)}var que=rt(function(f,m){f=Gt(f);var w=-1,R=m.length,D=R>2?m[2]:n;for(D&&Ni(m[0],m[1],D)&&(R=1);++w<R;)for(var I=m[w],N=pr(I),B=-1,V=N.length;++B<V;){var ne=N[B],ie=f[ne];(ie===n||Ys(ie,Th[ne])&&!Mt.call(f,ne))&&(f[ne]=I[ne])}return f}),Kue=rt(function(f){return f.push(n,wB),Or(rG,n,f)});function Yue(f,m){return m$(f,Ge(m,3),Go)}function Xue(f,m){return m$(f,Ge(m,3),bE)}function Que(f,m){return f==null?f:wE(f,Ge(m,3),pr)}function Jue(f,m){return f==null?f:G$(f,Ge(m,3),pr)}function Zue(f,m){return f&&Go(f,Ge(m,3))}function ece(f,m){return f&&bE(f,Ge(m,3))}function tce(f){return f==null?[]:jC(f,Un(f))}function nce(f){return f==null?[]:jC(f,pr(f))}function ZE(f,m,w){var R=f==null?n:Nc(f,m);return R===n?w:R}function ice(f,m){return f!=null&&xB(f,m,Foe)}function eF(f,m){return f!=null&&xB(f,m,Aoe)}var rce=gB(function(f,m,w){m!=null&&typeof m.toString!="function"&&(m=IC.call(m)),f[m]=w},nF(gr)),sce=gB(function(f,m,w){m!=null&&typeof m.toString!="function"&&(m=IC.call(m)),Mt.call(f,m)?f[m].push(w):f[m]=[w]},Ge),oce=rt(Tg);function Un(f){return fr(f)?I$(f):EE(f)}function pr(f){return fr(f)?I$(f,!0):Noe(f)}function ace(f,m){var w={};return m=Ge(m,3),Go(f,function(R,D,I){Wa(w,m(R,D,I),R)}),w}function lce(f,m){var w={};return m=Ge(m,3),Go(f,function(R,D,I){Wa(w,D,m(R,D,I))}),w}var uce=Oh(function(f,m,w){qC(f,m,w)}),rG=Oh(function(f,m,w,R){qC(f,m,w,R)}),cce=ja(function(f,m){var w={};if(f==null)return w;var R=!1;m=Qt(m,function(I){return I=au(I,f),R||(R=I.length>1),I}),zo(f,BE(f),w),R&&(w=us(w,d|h|p,rae));for(var D=m.length;D--;)TE(w,m[D]);return w});function dce(f,m){return sG(f,ly(Ge(m)))}var hce=ja(function(f,m){return f==null?{}:Boe(f,m)});function sG(f,m){if(f==null)return{};var w=Qt(BE(f),function(R){return[R]});return m=Ge(m),X$(f,w,function(R,D){return m(R,D[0])})}function fce(f,m,w){m=au(m,f);var R=-1,D=m.length;for(D||(D=1,f=n);++R<D;){var I=f==null?n:f[Ho(m[R])];I===n&&(R=D,I=w),f=Ka(I)?I.call(f):I}return f}function pce(f,m,w){return f==null?f:Ig(f,m,w)}function gce(f,m,w,R){return R=typeof R=="function"?R:n,f==null?f:Ig(f,m,w,R)}var oG=CB(Un),aG=CB(pr);function mce(f,m,w){var R=Qe(f),D=R||uu(f)||$h(f);if(m=Ge(m,4),w==null){var I=f&&f.constructor;D?w=R?new I:[]:rn(f)?w=Ka(I)?_h(LC(f)):{}:w={}}return(D?os:Go)(f,function(N,B,V){return m(w,N,B,V)}),w}function vce(f,m){return f==null?!0:TE(f,m)}function Cce(f,m,w){return f==null?f:tB(f,m,_E(w))}function yce(f,m,w,R){return R=typeof R=="function"?R:n,f==null?f:tB(f,m,_E(w),R)}function Bh(f){return f==null?[]:hE(f,Un(f))}function wce(f){return f==null?[]:hE(f,pr(f))}function bce(f,m,w){return w===n&&(w=m,m=n),w!==n&&(w=hs(w),w=w===w?w:0),m!==n&&(m=hs(m),m=m===m?m:0),Lc(hs(f),m,w)}function Sce(f,m,w){return m=Ya(m),w===n?(w=m,m=0):w=Ya(w),f=hs(f),Doe(f,m,w)}function xce(f,m,w){if(w&&typeof w!="boolean"&&Ni(f,m,w)&&(m=w=n),w===n&&(typeof m=="boolean"?(w=m,m=n):typeof f=="boolean"&&(w=f,f=n)),f===n&&m===n?(f=0,m=1):(f=Ya(f),m===n?(m=f,f=0):m=Ya(m)),f>m){var R=f;f=m,m=R}if(w||f%1||m%1){var D=T$();return yi(f+D*(m-f+tse("1e-"+((D+"").length-1))),m)}return DE(f,m)}var Rce=Lh(function(f,m,w){return m=m.toLowerCase(),f+(w?lG(m):m)});function lG(f){return tF(Pt(f).toLowerCase())}function uG(f){return f=Pt(f),f&&f.replace(Fre,pse).replace(Ure,"")}function Ece(f,m,w){f=Pt(f),m=Nr(m);var R=f.length;w=w===n?R:Lc(tt(w),0,R);var D=w;return w-=m.length,w>=0&&f.slice(w,D)==m}function Fce(f){return f=Pt(f),f&&ore.test(f)?f.replace(GN,gse):f}function Ace(f){return f=Pt(f),f&&hre.test(f)?f.replace(XR,"\\$&"):f}var Dce=Lh(function(f,m,w){return f+(w?"-":"")+m.toLowerCase()}),Pce=Lh(function(f,m,w){return f+(w?" ":"")+m.toLowerCase()}),kce=hB("toLowerCase");function Tce(f,m,w){f=Pt(f),m=tt(m);var R=m?Ph(f):0;if(!m||R>=m)return f;var D=(m-R)/2;return ZC(GC(D),w)+f+ZC(BC(D),w)}function Mce(f,m,w){f=Pt(f),m=tt(m);var R=m?Ph(f):0;return m&&R<m?f+ZC(m-R,w):f}function Ice(f,m,w){f=Pt(f),m=tt(m);var R=m?Ph(f):0;return m&&R<m?ZC(m-R,w)+f:f}function _ce(f,m,w){return w||m==null?m=0:m&&(m=+m),zse(Pt(f).replace(QR,""),m||0)}function Oce(f,m,w){return(w?Ni(f,m,w):m===n)?m=1:m=tt(m),PE(Pt(f),m)}function Lce(){var f=arguments,m=Pt(f[0]);return f.length<3?m:m.replace(f[1],f[2])}var Nce=Lh(function(f,m,w){return f+(w?"_":"")+m.toLowerCase()});function $ce(f,m,w){return w&&typeof w!="number"&&Ni(f,m,w)&&(m=w=n),w=w===n?Re:w>>>0,w?(f=Pt(f),f&&(typeof m=="string"||m!=null&&!JE(m))&&(m=Nr(m),!m&&Dh(f))?lu(qs(f),0,w):f.split(m,w)):[]}var Bce=Lh(function(f,m,w){return f+(w?" ":"")+tF(m)});function Gce(f,m,w){return f=Pt(f),w=w==null?0:Lc(tt(w),0,f.length),m=Nr(m),f.slice(w,w+m.length)==m}function zce(f,m,w){var R=M.templateSettings;w&&Ni(f,m,w)&&(m=n),f=Pt(f),m=dy({},m,R,yB);var D=dy({},m.imports,R.imports,yB),I=Un(D),N=hE(D,I),B,V,ne=0,ie=m.interpolate||RC,se="__p += '",Se=pE((m.escape||RC).source+"|"+ie.source+"|"+(ie===zN?wre:RC).source+"|"+(m.evaluate||RC).source+"|$","g"),Te="//# sourceURL="+(Mt.call(m,"sourceURL")?(m.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Xre+"]")+`
`;f.replace(Se,function(Ve,lt,ht,Br,$i,Gr){return ht||(ht=Br),se+=f.slice(ne,Gr).replace(Are,mse),lt&&(B=!0,se+=`' +
__e(`+lt+`) +
'`),$i&&(V=!0,se+=`';
`+$i+`;
__p += '`),ht&&(se+=`' +
((__t = (`+ht+`)) == null ? '' : __t) +
'`),ne=Gr+Ve.length,Ve}),se+=`';
`;var He=Mt.call(m,"variable")&&m.variable;if(!He)se=`with (obj) {
`+se+`
}
`;else if(Cre.test(He))throw new Ke(a);se=(V?se.replace(nre,""):se).replace(ire,"$1").replace(rre,"$1;"),se="function("+(He||"obj")+`) {
`+(He?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(B?", __e = _.escape":"")+(V?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+se+`return __p
}`;var it=dG(function(){return At(I,Te+"return "+se).apply(n,N)});if(it.source=se,QE(it))throw it;return it}function Hce(f){return Pt(f).toLowerCase()}function Vce(f){return Pt(f).toUpperCase()}function Wce(f,m,w){if(f=Pt(f),f&&(w||m===n))return w$(f);if(!f||!(m=Nr(m)))return f;var R=qs(f),D=qs(m),I=b$(R,D),N=S$(R,D)+1;return lu(R,I,N).join("")}function Uce(f,m,w){if(f=Pt(f),f&&(w||m===n))return f.slice(0,R$(f)+1);if(!f||!(m=Nr(m)))return f;var R=qs(f),D=S$(R,qs(m))+1;return lu(R,0,D).join("")}function jce(f,m,w){if(f=Pt(f),f&&(w||m===n))return f.replace(QR,"");if(!f||!(m=Nr(m)))return f;var R=qs(f),D=b$(R,qs(m));return lu(R,D).join("")}function qce(f,m){var w=_,R=O;if(rn(m)){var D="separator"in m?m.separator:D;w="length"in m?tt(m.length):w,R="omission"in m?Nr(m.omission):R}f=Pt(f);var I=f.length;if(Dh(f)){var N=qs(f);I=N.length}if(w>=I)return f;var B=w-Ph(R);if(B<1)return R;var V=N?lu(N,0,B).join(""):f.slice(0,B);if(D===n)return V+R;if(N&&(B+=V.length-B),JE(D)){if(f.slice(B).search(D)){var ne,ie=V;for(D.global||(D=pE(D.source,Pt(HN.exec(D))+"g")),D.lastIndex=0;ne=D.exec(ie);)var se=ne.index;V=V.slice(0,se===n?B:se)}}else if(f.indexOf(Nr(D),B)!=B){var Se=V.lastIndexOf(D);Se>-1&&(V=V.slice(0,Se))}return V+R}function Kce(f){return f=Pt(f),f&&sre.test(f)?f.replace(BN,xse):f}var Yce=Lh(function(f,m,w){return f+(w?" ":"")+m.toUpperCase()}),tF=hB("toUpperCase");function cG(f,m,w){return f=Pt(f),m=w?n:m,m===n?Cse(f)?Fse(f):use(f):f.match(m)||[]}var dG=rt(function(f,m){try{return Or(f,n,m)}catch(w){return QE(w)?w:new Ke(w)}}),Xce=ja(function(f,m){return os(m,function(w){w=Ho(w),Wa(f,w,YE(f[w],f))}),f});function Qce(f){var m=f==null?0:f.length,w=Ge();return f=m?Qt(f,function(R){if(typeof R[1]!="function")throw new as(o);return[w(R[0]),R[1]]}):[],rt(function(R){for(var D=-1;++D<m;){var I=f[D];if(Or(I[0],this,R))return Or(I[1],this,R)}})}function Jce(f){return xoe(us(f,d))}function nF(f){return function(){return f}}function Zce(f,m){return f==null||f!==f?m:f}var ede=pB(),tde=pB(!0);function gr(f){return f}function iF(f){return W$(typeof f=="function"?f:us(f,d))}function nde(f){return j$(us(f,d))}function ide(f,m){return q$(f,us(m,d))}var rde=rt(function(f,m){return function(w){return Tg(w,f,m)}}),sde=rt(function(f,m){return function(w){return Tg(f,w,m)}});function rF(f,m,w){var R=Un(m),D=jC(m,R);w==null&&!(rn(m)&&(D.length||!R.length))&&(w=m,m=f,f=this,D=jC(m,Un(m)));var I=!(rn(w)&&"chain"in w)||!!w.chain,N=Ka(f);return os(D,function(B){var V=m[B];f[B]=V,N&&(f.prototype[B]=function(){var ne=this.__chain__;if(I||ne){var ie=f(this.__wrapped__),se=ie.__actions__=hr(this.__actions__);return se.push({func:V,args:arguments,thisArg:f}),ie.__chain__=ne,ie}return V.apply(f,nu([this.value()],arguments))})}),f}function ode(){return ii._===this&&(ii._=Mse),this}function sF(){}function ade(f){return f=tt(f),rt(function(m){return K$(m,f)})}var lde=LE(Qt),ude=LE(g$),cde=LE(aE);function hG(f){return VE(f)?lE(Ho(f)):Goe(f)}function dde(f){return function(m){return f==null?n:Nc(f,m)}}var hde=mB(),fde=mB(!0);function oF(){return[]}function aF(){return!1}function pde(){return{}}function gde(){return""}function mde(){return!0}function vde(f,m){if(f=tt(f),f<1||f>ee)return[];var w=Re,R=yi(f,Re);m=Ge(m),f-=Re;for(var D=dE(R,m);++w<f;)m(w);return D}function Cde(f){return Qe(f)?Qt(f,Ho):$r(f)?[f]:hr(MB(Pt(f)))}function yde(f){var m=++kse;return Pt(f)+m}var wde=JC(function(f,m){return f+m},0),bde=NE("ceil"),Sde=JC(function(f,m){return f/m},1),xde=NE("floor");function Rde(f){return f&&f.length?UC(f,gr,SE):n}function Ede(f,m){return f&&f.length?UC(f,Ge(m,2),SE):n}function Fde(f){return C$(f,gr)}function Ade(f,m){return C$(f,Ge(m,2))}function Dde(f){return f&&f.length?UC(f,gr,FE):n}function Pde(f,m){return f&&f.length?UC(f,Ge(m,2),FE):n}var kde=JC(function(f,m){return f*m},1),Tde=NE("round"),Mde=JC(function(f,m){return f-m},0);function Ide(f){return f&&f.length?cE(f,gr):0}function _de(f,m){return f&&f.length?cE(f,Ge(m,2)):0}return M.after=nue,M.ary=VB,M.assign=Vue,M.assignIn=iG,M.assignInWith=dy,M.assignWith=Wue,M.at=Uue,M.before=WB,M.bind=YE,M.bindAll=Xce,M.bindKey=UB,M.castArray=pue,M.chain=GB,M.chunk=xae,M.compact=Rae,M.concat=Eae,M.cond=Qce,M.conforms=Jce,M.constant=nF,M.countBy=Ile,M.create=jue,M.curry=jB,M.curryRight=qB,M.debounce=KB,M.defaults=que,M.defaultsDeep=Kue,M.defer=iue,M.delay=rue,M.difference=Fae,M.differenceBy=Aae,M.differenceWith=Dae,M.drop=Pae,M.dropRight=kae,M.dropRightWhile=Tae,M.dropWhile=Mae,M.fill=Iae,M.filter=Ole,M.flatMap=$le,M.flatMapDeep=Ble,M.flatMapDepth=Gle,M.flatten=LB,M.flattenDeep=_ae,M.flattenDepth=Oae,M.flip=sue,M.flow=ede,M.flowRight=tde,M.fromPairs=Lae,M.functions=tce,M.functionsIn=nce,M.groupBy=zle,M.initial=$ae,M.intersection=Bae,M.intersectionBy=Gae,M.intersectionWith=zae,M.invert=rce,M.invertBy=sce,M.invokeMap=Vle,M.iteratee=iF,M.keyBy=Wle,M.keys=Un,M.keysIn=pr,M.map=sy,M.mapKeys=ace,M.mapValues=lce,M.matches=nde,M.matchesProperty=ide,M.memoize=ay,M.merge=uce,M.mergeWith=rG,M.method=rde,M.methodOf=sde,M.mixin=rF,M.negate=ly,M.nthArg=ade,M.omit=cce,M.omitBy=dce,M.once=oue,M.orderBy=Ule,M.over=lde,M.overArgs=aue,M.overEvery=ude,M.overSome=cde,M.partial=XE,M.partialRight=YB,M.partition=jle,M.pick=hce,M.pickBy=sG,M.property=hG,M.propertyOf=dde,M.pull=Uae,M.pullAll=$B,M.pullAllBy=jae,M.pullAllWith=qae,M.pullAt=Kae,M.range=hde,M.rangeRight=fde,M.rearg=lue,M.reject=Yle,M.remove=Yae,M.rest=uue,M.reverse=qE,M.sampleSize=Qle,M.set=pce,M.setWith=gce,M.shuffle=Jle,M.slice=Xae,M.sortBy=tue,M.sortedUniq=ile,M.sortedUniqBy=rle,M.split=$ce,M.spread=cue,M.tail=sle,M.take=ole,M.takeRight=ale,M.takeRightWhile=lle,M.takeWhile=ule,M.tap=Rle,M.throttle=due,M.thru=ry,M.toArray=eG,M.toPairs=oG,M.toPairsIn=aG,M.toPath=Cde,M.toPlainObject=nG,M.transform=mce,M.unary=hue,M.union=cle,M.unionBy=dle,M.unionWith=hle,M.uniq=fle,M.uniqBy=ple,M.uniqWith=gle,M.unset=vce,M.unzip=KE,M.unzipWith=BB,M.update=Cce,M.updateWith=yce,M.values=Bh,M.valuesIn=wce,M.without=mle,M.words=cG,M.wrap=fue,M.xor=vle,M.xorBy=Cle,M.xorWith=yle,M.zip=wle,M.zipObject=ble,M.zipObjectDeep=Sle,M.zipWith=xle,M.entries=oG,M.entriesIn=aG,M.extend=iG,M.extendWith=dy,rF(M,M),M.add=wde,M.attempt=dG,M.camelCase=Rce,M.capitalize=lG,M.ceil=bde,M.clamp=bce,M.clone=gue,M.cloneDeep=vue,M.cloneDeepWith=Cue,M.cloneWith=mue,M.conformsTo=yue,M.deburr=uG,M.defaultTo=Zce,M.divide=Sde,M.endsWith=Ece,M.eq=Ys,M.escape=Fce,M.escapeRegExp=Ace,M.every=_le,M.find=Lle,M.findIndex=_B,M.findKey=Yue,M.findLast=Nle,M.findLastIndex=OB,M.findLastKey=Xue,M.floor=xde,M.forEach=zB,M.forEachRight=HB,M.forIn=Que,M.forInRight=Jue,M.forOwn=Zue,M.forOwnRight=ece,M.get=ZE,M.gt=wue,M.gte=bue,M.has=ice,M.hasIn=eF,M.head=NB,M.identity=gr,M.includes=Hle,M.indexOf=Nae,M.inRange=Sce,M.invoke=oce,M.isArguments=Gc,M.isArray=Qe,M.isArrayBuffer=Sue,M.isArrayLike=fr,M.isArrayLikeObject=bn,M.isBoolean=xue,M.isBuffer=uu,M.isDate=Rue,M.isElement=Eue,M.isEmpty=Fue,M.isEqual=Aue,M.isEqualWith=Due,M.isError=QE,M.isFinite=Pue,M.isFunction=Ka,M.isInteger=XB,M.isLength=uy,M.isMap=QB,M.isMatch=kue,M.isMatchWith=Tue,M.isNaN=Mue,M.isNative=Iue,M.isNil=Oue,M.isNull=_ue,M.isNumber=JB,M.isObject=rn,M.isObjectLike=dn,M.isPlainObject=Ng,M.isRegExp=JE,M.isSafeInteger=Lue,M.isSet=ZB,M.isString=cy,M.isSymbol=$r,M.isTypedArray=$h,M.isUndefined=Nue,M.isWeakMap=$ue,M.isWeakSet=Bue,M.join=Hae,M.kebabCase=Dce,M.last=ds,M.lastIndexOf=Vae,M.lowerCase=Pce,M.lowerFirst=kce,M.lt=Gue,M.lte=zue,M.max=Rde,M.maxBy=Ede,M.mean=Fde,M.meanBy=Ade,M.min=Dde,M.minBy=Pde,M.stubArray=oF,M.stubFalse=aF,M.stubObject=pde,M.stubString=gde,M.stubTrue=mde,M.multiply=kde,M.nth=Wae,M.noConflict=ode,M.noop=sF,M.now=oy,M.pad=Tce,M.padEnd=Mce,M.padStart=Ice,M.parseInt=_ce,M.random=xce,M.reduce=qle,M.reduceRight=Kle,M.repeat=Oce,M.replace=Lce,M.result=fce,M.round=Tde,M.runInContext=z,M.sample=Xle,M.size=Zle,M.snakeCase=Nce,M.some=eue,M.sortedIndex=Qae,M.sortedIndexBy=Jae,M.sortedIndexOf=Zae,M.sortedLastIndex=ele,M.sortedLastIndexBy=tle,M.sortedLastIndexOf=nle,M.startCase=Bce,M.startsWith=Gce,M.subtract=Mde,M.sum=Ide,M.sumBy=_de,M.template=zce,M.times=vde,M.toFinite=Ya,M.toInteger=tt,M.toLength=tG,M.toLower=Hce,M.toNumber=hs,M.toSafeInteger=Hue,M.toString=Pt,M.toUpper=Vce,M.trim=Wce,M.trimEnd=Uce,M.trimStart=jce,M.truncate=qce,M.unescape=Kce,M.uniqueId=yde,M.upperCase=Yce,M.upperFirst=tF,M.each=zB,M.eachRight=HB,M.first=NB,rF(M,function(){var f={};return Go(M,function(m,w){Mt.call(M.prototype,w)||(f[w]=m)}),f}(),{chain:!1}),M.VERSION=i,os(["bind","bindKey","curry","curryRight","partial","partialRight"],function(f){M[f].placeholder=M}),os(["drop","take"],function(f,m){ut.prototype[f]=function(w){w=w===n?1:_n(tt(w),0);var R=this.__filtered__&&!m?new ut(this):this.clone();return R.__filtered__?R.__takeCount__=yi(w,R.__takeCount__):R.__views__.push({size:yi(w,Re),type:f+(R.__dir__<0?"Right":"")}),R},ut.prototype[f+"Right"]=function(w){return this.reverse()[f](w).reverse()}}),os(["filter","map","takeWhile"],function(f,m){var w=m+1,R=w==$||w==G;ut.prototype[f]=function(D){var I=this.clone();return I.__iteratees__.push({iteratee:Ge(D,3),type:w}),I.__filtered__=I.__filtered__||R,I}}),os(["head","last"],function(f,m){var w="take"+(m?"Right":"");ut.prototype[f]=function(){return this[w](1).value()[0]}}),os(["initial","tail"],function(f,m){var w="drop"+(m?"":"Right");ut.prototype[f]=function(){return this.__filtered__?new ut(this):this[w](1)}}),ut.prototype.compact=function(){return this.filter(gr)},ut.prototype.find=function(f){return this.filter(f).head()},ut.prototype.findLast=function(f){return this.reverse().find(f)},ut.prototype.invokeMap=rt(function(f,m){return typeof f=="function"?new ut(this):this.map(function(w){return Tg(w,f,m)})}),ut.prototype.reject=function(f){return this.filter(ly(Ge(f)))},ut.prototype.slice=function(f,m){f=tt(f);var w=this;return w.__filtered__&&(f>0||m<0)?new ut(w):(f<0?w=w.takeRight(-f):f&&(w=w.drop(f)),m!==n&&(m=tt(m),w=m<0?w.dropRight(-m):w.take(m-f)),w)},ut.prototype.takeRightWhile=function(f){return this.reverse().takeWhile(f).reverse()},ut.prototype.toArray=function(){return this.take(Re)},Go(ut.prototype,function(f,m){var w=/^(?:filter|find|map|reject)|While$/.test(m),R=/^(?:head|last)$/.test(m),D=M[R?"take"+(m=="last"?"Right":""):m],I=R||/^find/.test(m);D&&(M.prototype[m]=function(){var N=this.__wrapped__,B=R?[1]:arguments,V=N instanceof ut,ne=B[0],ie=V||Qe(N),se=function(lt){var ht=D.apply(M,nu([lt],B));return R&&Se?ht[0]:ht};ie&&w&&typeof ne=="function"&&ne.length!=1&&(V=ie=!1);var Se=this.__chain__,Te=!!this.__actions__.length,He=I&&!Se,it=V&&!Te;if(!I&&ie){N=it?N:new ut(this);var Ve=f.apply(N,B);return Ve.__actions__.push({func:ry,args:[se],thisArg:n}),new ls(Ve,Se)}return He&&it?f.apply(this,B):(Ve=this.thru(se),He?R?Ve.value()[0]:Ve.value():Ve)})}),os(["pop","push","shift","sort","splice","unshift"],function(f){var m=kC[f],w=/^(?:push|sort|unshift)$/.test(f)?"tap":"thru",R=/^(?:pop|shift)$/.test(f);M.prototype[f]=function(){var D=arguments;if(R&&!this.__chain__){var I=this.value();return m.apply(Qe(I)?I:[],D)}return this[w](function(N){return m.apply(Qe(N)?N:[],D)})}}),Go(ut.prototype,function(f,m){var w=M[m];if(w){var R=w.name+"";Mt.call(Ih,R)||(Ih[R]=[]),Ih[R].push({name:m,func:w})}}),Ih[QC(n,y).name]=[{name:"wrapper",func:n}],ut.prototype.clone=Kse,ut.prototype.reverse=Yse,ut.prototype.value=Xse,M.prototype.at=Ele,M.prototype.chain=Fle,M.prototype.commit=Ale,M.prototype.next=Dle,M.prototype.plant=kle,M.prototype.reverse=Tle,M.prototype.toJSON=M.prototype.valueOf=M.prototype.value=Mle,M.prototype.first=M.prototype.head,Rg&&(M.prototype[Rg]=Ple),M},kh=Ase();Mc?((Mc.exports=kh)._=kh,iE._=kh):ii._=kh}).call(dze)}(Hm,Hm.exports)),Hm.exports}var PS=hze();const tw=2147483648,fze=4294967295;class vL{constructor(t){this._size=t,this._bits=new Uint32Array(Math.ceil(t/32))}get length(){return this._size}count(){const t=this._bits.length;let n=0;for(let i=0;i<t;++i)for(let r=this._bits[i];r;++n)r&=r-1;return n}get(t){return this._bits[t>>5]&tw>>>t}set(t){this._bits[t>>5]|=tw>>>t}clear(t){this._bits[t>>5]&=~(tw>>>t)}scan(t){for(let n=this.next(0);n>=0;n=this.next(n+1))t(n)}next(t){const n=this._bits,i=n.length;let r=t>>5,s=n[r]&fze>>>t;for(;r<i;s=n[++r])if(s!==0)return(r<<5)+Math.clz32(s);return-1}nth(t){let n=this.next(0);for(;t--&&n>=0;)n=this.next(n+1);return n}not(){const t=this._bits,n=t.length;for(let r=0;r<n;++r)t[r]=~t[r];const i=this._size%32;return i&&(t[n-1]&=tw>>i-1),this}and(t){if(t){const n=this._bits,i=t._bits,r=n.length;for(let s=0;s<r;++s)n[s]&=i[s]}return this}or(t){if(t){const n=this._bits,i=t._bits,r=n.length;for(let s=0;s<r;++s)n[s]|=i[s]}return this}}function pze(e,t,n,i,r){return e==null?null:e<t?-1/0:e>n?1/0:(e=Math.max(t,Math.min(e,n)),t+i*Math.floor(1e-14+(e-t)/i+(r||0)))}function rc(e){return e instanceof Date}function kS(e){return e instanceof RegExp}function sc(e){return e===Object(e)}function CL(e,t){return e==null||t==null||e!==e||t!==t?!1:e===t?!0:rc(e)||rc(t)?+e==+t:kS(e)&&kS(t)?e+""==t+"":sc(e)&&sc(t)?gze(e,t):!1}function gze(e,t){if(Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;if(e.length||t.length)return n6(e,t);const n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length||(n.sort(),i.sort(),!n6(n,i,(s,o)=>s===o)))return!1;const r=n.length;for(let s=0;s<r;++s){const o=n[s];if(!CL(e[o],t[o]))return!1}return!0}function n6(e,t,n=CL){const i=e.length;if(i!==t.length)return!1;for(let r=0;r<i;++r)if(!n(e[r],t[r]))return!1;return!0}function mze(e,t,n){if(t instanceof Map){if(t.has(e))return t.get(e)}else{const i=`${e}`;if(Object.hasOwn(t,i))return t[i]}return n!==void 0?n:e}function vze(e,t,n){let i=arguments.length;e=+e,t=+t,n=i<2?(t=e,e=0,1):i<3?1:+n,i=Math.max(0,Math.ceil((t-e)/n))|0;const r=new Array(i);for(let s=0;s<i;++s)r[s]=e+s*n;return r}const yt=void 0;function ur(e){return Array.isArray(e)}const Cze=Object.getPrototypeOf(Int8Array);function gR(e){return e instanceof Cze}function Ec(e){return ur(e)||gR(e)}function $o(e){return typeof e=="string"}function fo(e){return e!=null&&e===e}const dC=e=>Ec(e)||$o(e);function yze(e){return Ec(e)?e.filter(t=>fo(t)):e}function wze(...e){return[].concat(...e)}function bze(e,t,n){return dC(e)?e.includes(t,n):!1}function Sze(e,t){return dC(e)?e.indexOf(t):-1}function xze(e,t){return Ec(e)?e.join(t):yt}function Rze(e,t){return dC(e)?e.lastIndexOf(t):-1}function Eze(e){return dC(e)?e.length:0}function Fze(e,t){return Ec(e)?e.map(n=>fo(n)?n[t]:yt):yt}function Aze(e){return Ec(e)?e.slice().reverse():$o(e)?e.split("").reverse().join(""):yt}function Dze(e,t,n){return dC(e)?e.slice(t,n):yt}const Pze=Object.freeze(Object.defineProperty({__proto__:null,compact:yze,concat:wze,includes:bze,indexof:Sze,join:xze,lastindexof:Rze,length:Eze,pluck:Fze,reverse:Aze,slice:Dze},Symbol.toStringTag,{value:"Module"}));function Hw(e,t,n="0"){const i=e+"",r=i.length;return r<t?Array(t-r+1).join(n)+i:i}const Uo=e=>(e<10?"0":"")+e,kze=e=>e<0?"-"+Hw(-e,6):e>9999?"+"+Hw(e,6):Hw(e,4);function IJ(e,t,n,i,r,s,o,a,l){const u=a?"Z":"";return kze(e)+"-"+Uo(t+1)+"-"+Uo(n)+(!l||o?"T"+Uo(i)+":"+Uo(r)+":"+Uo(s)+"."+Hw(o,3)+u:s?"T"+Uo(i)+":"+Uo(r)+":"+Uo(s)+u:r||i||!a?"T"+Uo(i)+":"+Uo(r)+u:"")}function _J(e,t){return isNaN(e)?"Invalid Date":IJ(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds(),!1,t)}function mR(e,t){return isNaN(e)?"Invalid Date":IJ(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds(),!0,t)}const Tze=/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/;function OJ(e){return e.match(Tze)&&!isNaN(Date.parse(e))}function Mze(e,t=Date.parse){return OJ(e)?t(e):e}const LJ=6e4,NJ=864e5,$J=6048e5,gn=new Date,mn=new Date,Dn=e=>(gn.setTime(typeof e=="string"?Mze(e):e),gn);function Ize(e,t){return _J(Dn(e),!t)}function _ze(e,t){return mR(Dn(e),!t)}function Oze(){return Date.now()}function Lze(e){return+Dn(e)}function Nze(e,t,n,i,r,s,o){return arguments.length?new Date(e,t||0,n??1,i||0,r||0,s||0,o||0):new Date(Date.now())}function $ze(e){return Dn(e).getFullYear()}function Bze(e){return Math.floor(Dn(e).getMonth()/3)}function Gze(e){return Dn(e).getMonth()}function zze(e,t){const n=t||0;mn.setTime(+e),mn.setDate(mn.getDate()-(mn.getDay()+7-n)%7),mn.setHours(0,0,0,0),gn.setTime(+e),gn.setMonth(0),gn.setDate(1),gn.setDate(1-(gn.getDay()+7-n)%7),gn.setHours(0,0,0,0);const i=(mn.getTimezoneOffset()-gn.getTimezoneOffset())*LJ;return Math.floor((1+(+mn-+gn)-i)/$J)}function Hze(e){return Dn(e).getDate()}function Vze(e){mn.setTime(+e),mn.setHours(0,0,0,0),gn.setTime(+mn),gn.setMonth(0),gn.setDate(1);const t=(mn.getTimezoneOffset()-gn.getTimezoneOffset())*LJ;return Math.floor(1+(+mn-+gn-t)/NJ)}function Wze(e){return Dn(e).getDay()}function Uze(e){return Dn(e).getHours()}function jze(e){return Dn(e).getMinutes()}function qze(e){return Dn(e).getSeconds()}function Kze(e){return Dn(e).getMilliseconds()}function Yze(e,t,n,i,r,s,o){return arguments.length?new Date(Date.UTC(e,t||0,n??1,i||0,r||0,s||0,o||0)):new Date(Date.now())}function Xze(e){return Dn(e).getUTCFullYear()}function Qze(e){return Math.floor(Dn(e).getUTCMonth()/3)}function Jze(e){return Dn(e).getUTCMonth()}function Zze(e,t){const n=t||0;return mn.setTime(+e),mn.setUTCDate(mn.getUTCDate()-(mn.getUTCDay()+7-n)%7),mn.setUTCHours(0,0,0,0),gn.setTime(+e),gn.setUTCMonth(0),gn.setUTCDate(1),gn.setUTCDate(1-(gn.getUTCDay()+7-n)%7),gn.setUTCHours(0,0,0,0),Math.floor((1+(+mn-+gn))/$J)}function eHe(e){return Dn(e).getUTCDate()}function tHe(e){mn.setTime(+e),mn.setUTCHours(0,0,0,0);const t=Date.UTC(mn.getUTCFullYear(),0,1);return Math.floor(1+(+mn-t)/NJ)}function nHe(e){return Dn(e).getUTCDay()}function iHe(e){return Dn(e).getUTCHours()}function rHe(e){return Dn(e).getUTCMinutes()}function sHe(e){return Dn(e).getUTCSeconds()}function oHe(e){return Dn(e).getUTCMilliseconds()}const aHe=Object.freeze(Object.defineProperty({__proto__:null,date:Hze,datetime:Nze,dayofweek:Wze,dayofyear:Vze,format_date:Ize,format_utcdate:_ze,hours:Uze,milliseconds:Kze,minutes:jze,month:Gze,now:Oze,quarter:Bze,seconds:qze,timestamp:Lze,utcdate:eHe,utcdatetime:Yze,utcdayofweek:nHe,utcdayofyear:tHe,utchours:iHe,utcmilliseconds:oHe,utcminutes:rHe,utcmonth:Jze,utcquarter:Qze,utcseconds:sHe,utcweek:Zze,utcyear:Xze,week:zze,year:$ze},Symbol.toStringTag,{value:"Module"}));function lHe(e){return JSON.parse(e)}function uHe(e){return JSON.stringify(e)}const cHe=Object.freeze(Object.defineProperty({__proto__:null,parse_json:lHe,to_json:uHe},Symbol.toStringTag,{value:"Module"}));let dHe=Math.random;function rg(){return dHe()}function hHe(){return rg()}function fHe(e){return Number.isNaN(e)}function pHe(e){return Number.isFinite(e)}function gHe(e){return Math.abs(e)}function mHe(e){return Math.cbrt(e)}function vHe(e){return Math.ceil(e)}function CHe(e){return Math.clz32(e)}function yHe(e){return Math.exp(e)}function wHe(e){return Math.expm1(e)}function bHe(e){return Math.floor(e)}function SHe(e){return Math.fround(e)}function xHe(...e){return Math.max(...e)}function RHe(...e){return Math.min(...e)}function EHe(e){return Math.log(e)}function FHe(e){return Math.log10(e)}function AHe(e){return Math.log1p(e)}function DHe(e){return Math.log2(e)}function PHe(e,t){return Math.pow(e,t)}function kHe(e){return Math.round(e)}function THe(e){return Math.sign(e)}function MHe(e){return Math.sqrt(e)}function IHe(e){return Math.trunc(e)}function _He(e){return 180*e/Math.PI}function OHe(e){return Math.PI*e/180}function LHe(e){return Math.acos(e)}function NHe(e){return Math.acosh(e)}function $He(e){return Math.asin(e)}function BHe(e){return Math.asinh(e)}function GHe(e){return Math.atan(e)}function zHe(e,t){return Math.atan2(e,t)}function HHe(e){return Math.atanh(e)}function VHe(e){return Math.cos(e)}function WHe(e){return Math.cosh(e)}function UHe(e){return Math.sin(e)}function jHe(e){return Math.sinh(e)}function qHe(e){return Math.tan(e)}function KHe(e){return Math.tanh(e)}const YHe=Object.freeze(Object.defineProperty({__proto__:null,abs:gHe,acos:LHe,acosh:NHe,asin:$He,asinh:BHe,atan:GHe,atan2:zHe,atanh:HHe,cbrt:mHe,ceil:vHe,clz32:CHe,cos:VHe,cosh:WHe,degrees:_He,exp:yHe,expm1:wHe,floor:bHe,fround:SHe,greatest:xHe,is_finite:pHe,is_nan:fHe,least:RHe,log:EHe,log10:FHe,log1p:AHe,log2:DHe,pow:PHe,radians:OHe,random:hHe,round:kHe,sign:THe,sin:UHe,sinh:jHe,sqrt:MHe,tan:qHe,tanh:KHe,trunc:IHe},Symbol.toStringTag,{value:"Module"}));function yL(e){return e instanceof Map}function XHe(e){return e instanceof Set}function vR(e){return yL(e)||XHe(e)}function wL(e){return Array.from(e)}function QHe(e,t){return vR(e)?e.has(t):e!=null?Object.hasOwn(e,`${t}`):!1}function JHe(e){return yL(e)?wL(e.keys()):e!=null?Object.keys(e):[]}function ZHe(e){return vR(e)?wL(e.values()):e!=null?Object.values(e):[]}function eVe(e){return vR(e)?wL(e.entries()):e!=null?Object.entries(e):[]}function tVe(e){return e?Object.fromEntries(e):yt}const nVe=Object.freeze(Object.defineProperty({__proto__:null,entries:eVe,has:QHe,keys:JHe,object:tVe,values:ZHe},Symbol.toStringTag,{value:"Module"}));function iVe(e){return e==null?e:new Date(e)}function rVe(e){return e==null?e:Number.parseFloat(e)}function sVe(e,t){return e==null?e:Number.parseInt(e,t)}function oVe(e,t,n){return e==null?!1:String(e).endsWith(t,n)}function aVe(e,t,n){const i=e==null?e:String(e).match(t);return n==null||i==null?i:typeof n=="number"?i[n]:i.groups?i.groups[n]:null}function lVe(e,t){return e==null?e:String(e).normalize(t)}function uVe(e,t,n){return e==null?e:String(e).padEnd(t,n)}function cVe(e,t,n){return e==null?e:String(e).padStart(t,n)}function dVe(e){return e==null?e:String(e).toUpperCase()}function hVe(e){return e==null?e:String(e).toLowerCase()}function fVe(e,t){return e==null?e:String(e).repeat(t)}function pVe(e,t,n){return e==null?e:String(e).replace(t,String(n))}function gVe(e,t,n){return e==null?[]:String(e).split(t,n)}function mVe(e,t,n){return e==null?!1:String(e).startsWith(t,n)}function vVe(e,t,n){return e==null?e:String(e).substring(t,n)}function CVe(e){return e==null?e:String(e).trim()}const yVe=Object.freeze(Object.defineProperty({__proto__:null,endswith:oVe,lower:hVe,match:aVe,normalize:lVe,padend:uVe,padstart:cVe,parse_date:iVe,parse_float:rVe,parse_int:sVe,repeat:fVe,replace:pVe,split:gVe,startswith:mVe,substring:vVe,trim:CVe,upper:dVe},Symbol.toStringTag,{value:"Module"})),mf={bin:pze,equal:CL,recode:mze,sequence:vze,...Pze,...aHe,...cHe,...YHe,...nVe,...yVe};function Ea(e){return e!=null?ur(e)?e:[e]:[]}function Qv(e){return typeof e=="bigint"}function _l(e){return e===void 0?e+"":Qv(e)?e+"n":JSON.stringify(e)}let wVe=class{constructor(t,n,i){this.name=t,this.fields=n,this.params=i}toString(){const t=[...this.fields.map(n=>`d[${_l(n)}]`),...this.params.map(_l)];return`d => op.${this.name}(${t})`}toObject(){return{expr:this.toString(),func:!0}}};function Je(e,t=[],n=[]){return new wVe(e,Ea(t),Ea(n))}const BJ=e=>Je("any",e),GJ=()=>Je("count"),zJ=e=>Je("array_agg",e),HJ=e=>Je("array_agg_distinct",e),VJ=(e,t)=>Je("map_agg",[e,t]),WJ=(e,t)=>Je("object_agg",[e,t]),UJ=(e,t)=>Je("entries_agg",[e,t]),jo={...mf,row_object:(...e)=>Je("row_object",null,e.flat()),count:GJ,any:BJ,array_agg:zJ,array_agg_distinct:HJ,object_agg:WJ,map_agg:VJ,entries_agg:UJ,valid:e=>Je("valid",e),invalid:e=>Je("invalid",e),distinct:e=>Je("distinct",e),mode:e=>Je("mode",e),sum:e=>Je("sum",e),product:e=>Je("product",e),mean:e=>Je("mean",e),average:e=>Je("average",e),variance:e=>Je("variance",e),variancep:e=>Je("variancep",e),stdev:e=>Je("stdev",e),stdevp:e=>Je("stdevp",e),min:e=>Je("min",e),max:e=>Je("max",e),quantile:(e,t)=>Je("quantile",e,t),median:e=>Je("median",e),covariance:(e,t)=>Je("covariance",[e,t]),covariancep:(e,t)=>Je("covariancep",[e,t]),corr:(e,t)=>Je("corr",[e,t]),bins:(e,t,n,i,r)=>Je("bins",e,[t,n,i,r]),row_number:()=>Je("row_number"),rank:()=>Je("rank"),avg_rank:()=>Je("avg_rank"),dense_rank:()=>Je("dense_rank"),percent_rank:()=>Je("percent_rank"),cume_dist:()=>Je("cume_dist"),ntile:e=>Je("ntile",null,e),lag:(e,t,n)=>Je("lag",e,[t,n]),lead:(e,t,n)=>Je("lead",e,[t,n]),first_value:e=>Je("first_value",e),last_value:e=>Je("last_value",e),nth_value:(e,t)=>Je("nth_value",e,t),fill_down:(e,t)=>Je("fill_down",e,t),fill_up:(e,t)=>Je("fill_up",e,t)};function un(e,t){throw Error(e,{cause:t})}function bVe(e,t){e=vR(e)?e:new Set(e);let n=t,i=0;for(;e.has(n);)n=t+ ++i;return n}function vi(e){return typeof e=="function"}function sg(e,t){const n=Array(e);if(vi(t))for(let i=0;i<e;++i)n[i]=t(i);else n.fill(t);return n}function SVe(e,t,n=15,i=!0,r=0,s){const a=Math.LN10;if(s==null){const l=Math.ceil(Math.log(n)/a),u=t-e||Math.abs(e)||1,c=[5,2];for(s=Math.max(r,Math.pow(10,Math.round(Math.log(u)/a)-l));Math.ceil(u/s)>n;)s*=10;const d=c.length;for(let h=0;h<d;++h){const p=s/c[h];p>=r&&u/p<=n&&(s=p)}}if(i){let l=Math.log(s);const u=l>=0?0:~~(-l/a)+1,c=Math.pow(10,-u-1);l=Math.floor(e/s+c)*s,e=e<l?l-s:l,t=Math.ceil(t/s)*s}return[e,t===e?e+s:t,s]}function wp(e){const t=typeof e;return t==="string"?`"${e}"`:t!=="object"||!e?e:rc(e)?+e:ur(e)||gR(e)?`[${e.map(wp)}]`:kS(e)?e+"":xVe(e)}function xVe(e){let t="{",n=-1;for(const i in e)++n>0&&(t+=","),t+=`"${i}":${wp(e[i])}`;return t+="}",t}function TS(e,t){const n=e.length;return n===1?(i,r)=>wp(e[0](i,r)):(i,r)=>{let s="";for(let o=0;o<n;++o){o>0&&(s+="|");const a=e[o](i,r);if(t&&(a==null||a!==a))return null;s+=wp(a)}return s}}function RVe(){const e=new Map;return{count(){return e.size},values(){return Array.from(e.values(),t=>t.v)},increment(t){const n=wp(t),i=e.get(n);i?++i.n:e.set(n,{v:t,n:1})},decrement(t){const n=wp(t),i=e.get(n);i.n===1?e.delete(n):--i.n},forEach(t){e.forEach(({v:n,n:i})=>t(n,i))}}}function sl(){}function EVe(e,t=0,n=e.length){let i=e[t++];for(let r=t;r<n;++r)i*=e[r];return i}function On(e){return e.init=e.init||sl,e.add=e.add||sl,e.rem=e.rem||sl,e}function i6(e,t){return e.product_v=!1,e.product=t}const jJ={count:{create:()=>On({value:e=>e.count}),param:[]},array_agg:{create:()=>On({init:e=>e.values=!0,value:e=>e.list.values(e.stream)}),param:[1]},object_agg:{create:()=>On({init:e=>e.values=!0,value:e=>Object.fromEntries(e.list.values())}),param:[2]},map_agg:{create:()=>On({init:e=>e.values=!0,value:e=>new Map(e.list.values())}),param:[2]},entries_agg:{create:()=>On({init:e=>e.values=!0,value:e=>e.list.values(e.stream)}),param:[2]},any:{create:()=>On({add:(e,t)=>{e.any==null&&(e.any=t)},value:e=>e.valid?e.any:yt}),param:[1]},valid:{create:()=>On({value:e=>e.valid}),param:[1]},invalid:{create:()=>On({value:e=>e.count-e.valid}),param:[1]},distinct:{create:()=>({init:e=>e.distinct=RVe(),value:e=>e.distinct.count()+(e.valid===e.count?0:1),add:(e,t)=>e.distinct.increment(t),rem:(e,t)=>e.distinct.decrement(t)}),param:[1]},array_agg_distinct:{create:()=>On({value:e=>e.distinct.values()}),param:[1],req:["distinct"]},mode:{create:()=>On({value:e=>{let t=yt,n=0;return e.distinct.forEach((i,r)=>{r>n&&(n=r,t=i)}),t}}),param:[1],req:["distinct"]},sum:{create:()=>({init:e=>e.sum=0,value:e=>e.valid?e.sum:yt,add:(e,t)=>Qv(t)?e.sum===0?e.sum=t:e.sum+=t:e.sum+=+t,rem:(e,t)=>e.sum-=t}),param:[1]},product:{create:()=>({init:e=>i6(e,1),value:e=>e.valid?e.product_v?i6(e,EVe(e.list.values())):e.product:void 0,add:(e,t)=>Qv(t)&&e.product===1?e.product=t:e.product*=t,rem:(e,t)=>t==0||t===1/0||t===-1/0?e.product_v=!0:e.product/=t}),param:[1],stream:["array_agg"]},mean:{create:()=>({init:e=>e.mean=0,value:e=>e.valid?e.mean:yt,add:(e,t)=>{e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid},rem:(e,t)=>{e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean}}),param:[1]},average:{create:()=>On({value:e=>e.valid?e.mean:yt}),param:[1],req:["mean"]},variance:{create:()=>({init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):yt,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean)}),param:[1],req:["mean"]},variancep:{create:()=>On({value:e=>e.valid>1?e.dev/e.valid:yt}),param:[1],req:["variance"]},stdev:{create:()=>On({value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):yt}),param:[1],req:["variance"]},stdevp:{create:()=>On({value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):yt}),param:[1],req:["variance"]},min:{create:()=>({init:e=>e.min=yt,value:e=>e.min=Number.isNaN(e.min)?e.list.min():e.min,add:(e,t)=>{(t<e.min||e.min===yt)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)}}),param:[1],stream:["array_agg"]},max:{create:()=>({init:e=>e.max=yt,value:e=>e.max=Number.isNaN(e.max)?e.list.max():e.max,add:(e,t)=>{(t>e.max||e.max===yt)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)}}),param:[1],stream:["array_agg"]},quantile:{create:e=>On({value:t=>t.list.quantile(e)}),param:[1,1],req:["array_agg"]},median:{create:()=>On({value:e=>e.list.quantile(.5)}),param:[1],req:["array_agg"]},covariance:{create:()=>({init:e=>{e.cov=e.mean_x=e.mean_y=e.dev_x=e.dev_y=0},value:e=>e.valid>1?e.cov/(e.valid-1):yt,add:(e,t,n)=>{const i=t-e.mean_x,r=n-e.mean_y;e.mean_x+=i/e.valid,e.mean_y+=r/e.valid;const s=n-e.mean_y;e.dev_x+=i*(t-e.mean_x),e.dev_y+=r*s,e.cov+=i*s},rem:(e,t,n)=>{const i=t-e.mean_x,r=n-e.mean_y;e.mean_x-=e.valid?i/e.valid:e.mean_x,e.mean_y-=e.valid?r/e.valid:e.mean_y;const s=n-e.mean_y;e.dev_x-=i*(t-e.mean_x),e.dev_y-=r*s,e.cov-=i*s}}),param:[2]},covariancep:{create:()=>On({value:e=>e.valid>1?e.cov/e.valid:yt}),param:[2],req:["covariance"]},corr:{create:()=>On({value:e=>e.valid>1?e.cov/(Math.sqrt(e.dev_x)*Math.sqrt(e.dev_y)):yt}),param:[2],req:["covariance"]},bins:{create:(e,t,n,i)=>On({value:r=>SVe(r.min,r.max,e,t,n,i)}),param:[1,4],req:["min","max"]}},r6={create(){let e;return{init:()=>e=1,value:t=>{const n=t.index;return n&&!t.peer(n)?e=n+1:e}}},param:[]},s6={create(){let e;return{init:()=>e=0,value:t=>{const{index:n,peer:i,size:r}=t;let s=n;if(e<s){for(;s+1<r&&i(s+1);)++s;e=s}return(1+e)/r}}},param:[]},qJ={row_number:{create(){return{init:sl,value:e=>e.index+1}},param:[]},rank:r6,avg_rank:{create(){let e,t;return{init:()=>(e=-1,t=1),value:n=>{const i=n.index;if(i>=e){for(t=e=i+1;n.peer(e);t+=++e);t/=e-i}return t}}},param:[]},dense_rank:{create(){let e;return{init:()=>e=1,value:t=>{const n=t.index;return n&&!t.peer(n)?++e:e}}},param:[]},percent_rank:{create(){const{init:e,value:t}=r6.create();return{init:e,value:n=>(t(n)-1)/(n.size-1)}},param:[]},cume_dist:s6,ntile:{create(e){e=+e,e>0||un("ntile num must be greater than zero.");const{init:t,value:n}=s6.create();return{init:t,value:i=>Math.ceil(e*n(i))}},param:[0,1]},lag:{create(e,t=yt){return e=+e||1,{init:sl,value:(n,i)=>{const r=n.index-e;return r>=0?n.value(r,i):t}}},param:[1,2]},lead:{create(e,t=yt){return e=+e||1,{init:sl,value:(n,i)=>{const r=n.index+e;return r<n.size?n.value(r,i):t}}},param:[1,2]},first_value:{create(){return{init:sl,value:(e,t)=>e.value(e.i0,t)}},param:[1]},last_value:{create(){return{init:sl,value:(e,t)=>e.value(e.i1-1,t)}},param:[1]},nth_value:{create(e){return e=+e,e>0||un("nth_value nth must be greater than zero."),{init:sl,value:(t,n)=>{const i=t.i0+(e-1);return i<t.i1?t.value(i,n):yt}}},param:[1,1]},fill_down:{create(e=yt){let t;return{init:()=>t=e,value:(n,i)=>{const r=n.value(n.index,i);return fo(r)?t=r:t}}},param:[1,1]},fill_up:{create(e=yt){let t,n;return{init:()=>(t=e,n=-1),value:(i,r)=>i.index<=n?t:(n=FVe(i,r,i.index))>=0?t=i.value(n,r):(n=i.size,t=e)}},param:[1,1]}};function FVe(e,t,n){for(const i=e.size;n<i;++n)if(fo(e.value(n,t)))return n;return-1}function bL(e){return Object.hasOwn(jJ,e)}function SL(e){return Object.hasOwn(qJ,e)}function KJ(e){return Object.hasOwn(mf,e)||e==="row_object"}function YJ(e){return bL(e)&&jJ[e]}function XJ(e){return SL(e)&&qJ[e]}function hC(e,t=(i,r)=>i,n=""){const i=e.length;if(!i)return"";let r=t(e[0],0);for(let s=1;s<i;++s)r+=n+t(e[s],s);return r}function og(e,t,...n){const i=["_","$"],r=i.slice(0,n.length);return r.push('"use strict"; const '+n.map((s,o)=>s.map((a,l)=>`${i[o]}${l} = ${i[o]}[${l}]`).join(", ")).join(", ")+`; return (${e}) => ${t};`),Function(...r)(...n)}function xL(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function AVe(e,t=0,n=e.length){let i=n?e[t++]:yt;for(let r=t;r<n;++r)i<e[r]&&(i=e[r]);return i}function DVe(e,t=0,n=e.length){let i=n?e[t++]:yt;for(let r=t;r<n;++r)i>e[r]&&(i=e[r]);return i}function nw(e){return Qv(e)?e:+e}function PVe(e,t){const n=e.length;if(!n)return yt;if((t=+t)<=0||n<2)return nw(e[0]);if(t>=1)return nw(e[n-1]);const i=(n-1)*t,r=Math.floor(i),s=nw(e[r]);return Qv(s)?s:s+(nw(e[r+1])-s)*(i-r)}class kVe{constructor(t){this._values=t||[],this._sorted=null,this._start=0}values(t){return this._start&&(this._values=this._values.slice(this._start),this._start=0),t?this._values.slice():this._values}add(t){this._values.push(t),this._sorted=null}rem(){this._start+=1,this._sorted=null}min(){return this._sorted&&this._sorted.length?this._sorted[0]:DVe(this._values,this._start)}max(){return this._sorted&&this._sorted.length?this._sorted[this._sorted.length-1]:AVe(this._values,this._start)}quantile(t){return this._sorted||(this._sorted=this.values(!0),this._sorted.sort(xL)),PVe(this._sorted,t)}}class TVe{constructor(t){this._outputs=t}size(){return this._outputs.length}outputs(){return this._outputs}init(t){return{}}add(t,n,i){}rem(t,n,i){}write(t,n,i){}}const MS=(e,t,n)=>og(t,"{"+hC(e,(i,r)=>`_${r}.${n}(${t});`)+"}",e);function MVe(e,t){const{ops:n,output:i}=IVe(e,t),r=e[0].fields,s=r.length,o=s===0?RL:s===1?_Ve:s===2?OVe:un("Unsupported field count: "+s);return new o(r,n,i,t)}function IVe(e,t){const n={},i=[];function r(o,a=[]){const l=o+":"+a;if(n[l])return n[l];const u=YJ(o),c=u.create(...a);return t<0&&u.stream&&u.stream.forEach(d=>r(d,[])),u.req&&u.req.forEach(d=>r(d,[])),n[l]=c,i.push(c),c}const s=e.map(o=>{const a=r(o.name,o.params);return a.output=o.id,a});return{ops:i,output:s}}class RL extends TVe{constructor(t,n,i,r){super(i),this._op=n,this._fields=t,this._stream=!!r}init(){const t={count:0,valid:0,stream:this._stream};return this._op.forEach(n=>n.init(t)),t.values&&(t.list=new kVe),t}write(t,n,i){const r=this._outputs,s=r.length;for(let o=0;o<s;++o)n[r[o].output][i]=r[o].value(t);return 1}_add(){}_rem(){}add(t){++t.count}rem(t){--t.count}}class _Ve extends RL{constructor(t,n,i,r){super(t,n,i,r);const s=["state","v1","v2"];this._add=MS(n,s,"add"),this._rem=MS(n,s,"rem")}add(t,n,i){const r=this._fields[0](n,i);++t.count,fo(r)&&(++t.valid,t.list&&t.list.add(r),this._add(t,r))}rem(t,n,i){const r=this._fields[0](n,i);--t.count,fo(r)&&(--t.valid,t.list&&t.list.rem(),this._rem(t,r))}}class OVe extends RL{constructor(t,n,i,r){super(t,n,i,r);const s=["state","v1","v2"];this._add=MS(n,s,"add"),this._rem=MS(n,s,"rem")}add(t,n,i){const r=this._fields[0](n,i),s=this._fields[1](n,i);++t.count,fo(r)&&fo(s)&&(++t.valid,t.list&&t.list.add([r,s]),this._add(t,r,s))}rem(t,n,i){const r=this._fields[0](n,i),s=this._fields[1](n,i);--t.count,fo(r)&&fo(s)&&(--t.valid,t.list&&t.list.rem(),this._rem(t,r,s))}}function Ch(e,t,n){if(t.length){const i=e.data(),{keys:r}=e.groups()||{},s=ag(e,t),o=r?(a,l)=>s[a][r[l]]:a=>s[a][0];n=n.map(a=>l=>a(l,i,o))}return n}function ag(e,t,n){if(!t.length)return n;const i=QJ(t),r=e.groups(),s=r?r.size:1;return n=n||sg(t.length,()=>Array(s)),s>1?i.forEach(o=>{const a=ZJ(e,o,r);for(let l=0;l<s;++l)o.write(a[l],n,l)}):i.forEach(o=>{const a=JJ(e,o);o.write(a,n,0)}),n}function QJ(e,t){const n=[],i={};for(const r of e){const s=r.fields.map(o=>o+"").join(",");(i[s]||(i[s]=[])).push(r)}for(const r in i)n.push(MVe(i[r],t));return n}function JJ(e,t){const n=t.init(),i=e.totalRows(),r=e.data(),s=e.mask();if(e.isOrdered()){const o=e.indices();for(let a=0;a<i;++a)t.add(n,o[a],r)}else if(s)for(let o=s.next(0);o>=0;o=s.next(o+1))t.add(n,o,r);else for(let o=0;o<i;++o)t.add(n,o,r);return n}function ZJ(e,t,n){const{keys:i,size:r}=n,s=sg(r,()=>t.init()),o=e.data();if(e.isOrdered()){const a=e.indices(),l=a.length;for(let u=0;u<l;++u){const c=a[u];t.add(s[i[c]],c,o)}}else if(e.isFiltered()){const a=e.mask();for(let l=a.next(0);l>=0;l=a.next(l+1))t.add(s[i[l]],l,o)}else{const a=e.totalRows();for(let l=0;l<a;++l)t.add(s[i[l]],l,o)}return s}function eZ(e,t){const{get:n,names:i,rows:r,size:s}=t,o=i.length;for(let a=0;a<o;++a){const l=e.add(i[a],Array(s)),u=n[a];for(let c=0;c<s;++c)l[c]=u(r[c])}}function EL(e){return ur(e)?e:yL(e)?e.entries():e?Object.entries(e):[]}const LVe="ArrayPattern",NVe="ArrowFunctionExpression",$Ve="FunctionExpression",zu="Identifier",lg="Literal",tZ="MemberExpression",BVe="ObjectExpression",nZ="ObjectPattern",iZ="Property",rZ="Column",GVe="Constant",zVe="Dictionary",HVe="Function",VVe="Parameter",sZ="Op";function mt(e,t,n,i){const r=n[e.type]||n.Default;if(r&&r(e,t,i)===!1)return;const s=WVe[e.type];s&&s(e,t,n)}const iw=(e,t,n)=>{mt(e.argument,t,n,e)},JA=(e,t,n)=>{mt(e.left,t,n,e),mt(e.right,t,n,e)},o6=(e,t,n)=>{mt(e.test,t,n,e),mt(e.consequent,t,n,e),e.alternate&&mt(e.alternate,t,n,e)},ZA=(e,t,n)=>{Xo(e.params,t,n,e),mt(e.body,t,n,e)},a6=(e,t,n)=>{mt(e.callee,t,n,e),Xo(e.arguments,t,n,e)},Xo=(e,t,n,i)=>{e.forEach(r=>mt(r,t,n,i))},WVe={TemplateLiteral:(e,t,n)=>{Xo(e.expressions,t,n,e),Xo(e.quasis,t,n,e)},MemberExpression:(e,t,n)=>{mt(e.object,t,n,e),mt(e.property,t,n,e)},CallExpression:a6,NewExpression:a6,ArrayExpression:(e,t,n)=>{Xo(e.elements,t,n,e)},AssignmentExpression:JA,AwaitExpression:iw,BinaryExpression:JA,LogicalExpression:JA,UnaryExpression:iw,UpdateExpression:iw,ConditionalExpression:o6,ObjectExpression:(e,t,n)=>{Xo(e.properties,t,n,e)},Property:(e,t,n)=>{mt(e.key,t,n,e),mt(e.value,t,n,e)},ArrowFunctionExpression:ZA,FunctionExpression:ZA,FunctionDeclaration:ZA,VariableDeclaration:(e,t,n)=>{Xo(e.declarations,t,n,e)},VariableDeclarator:(e,t,n)=>{mt(e.id,t,n,e),mt(e.init,t,n,e)},SpreadElement:(e,t,n)=>{mt(e.argument,t,n,e)},BlockStatement:(e,t,n)=>{Xo(e.body,t,n,e)},ExpressionStatement:(e,t,n)=>{mt(e.expression,t,n,e)},IfStatement:o6,ForStatement:(e,t,n)=>{mt(e.init,t,n,e),mt(e.test,t,n,e),mt(e.update,t,n,e),mt(e.body,t,n,e)},WhileStatement:(e,t,n)=>{mt(e.test,t,n,e),mt(e.body,t,n,e)},DoWhileStatement:(e,t,n)=>{mt(e.body,t,n,e),mt(e.test,t,n,e)},SwitchStatement:(e,t,n)=>{mt(e.discriminant,t,n,e),Xo(e.cases,t,n,e)},SwitchCase:(e,t,n)=>{e.test&&mt(e.test,t,n,e),Xo(e.consequent,t,n,e)},ReturnStatement:iw,Program:(e,t,n)=>{mt(e.body[0],t,n,e)}};function oZ(e){delete e.start,delete e.end,delete e.optional}function l6(e){oZ(e),delete e.object,delete e.property,delete e.computed,e.table||delete e.table}function UVe(e){return mt(e,null,{Column:l6,Constant:l6,Default:oZ}),e}function $n(e,t){return t&&t.type===e}function jVe(e){return $n($Ve,e)||$n(NVe,e)}const Vt=(e,t)=>{const n=KVe[e.type];return n?n(e,t):un(`Unsupported expression construct: ${e.type}`)},eD=(e,t)=>"("+Vt(e.left,t)+" "+e.operator+" "+Vt(e.right,t)+")",tD=(e,t)=>"("+Qo(e.params,t)+")=>"+Vt(e.body,t),u6=(e,t)=>Vt(e.callee,t)+"("+Qo(e.arguments,t)+")",Qo=(e,t,n=",")=>e.map(i=>Vt(i,t)).join(n),FL=e=>e.computed?`[${_l(e.name)}]`:`.${e.name}`,c6=(e,t,n)=>{const i=e.table||"";return`data${i}${FL(e)}.${n}(${t.index}${i})`},qVe=(e,t)=>{const n=e.table||"";return`data${n}${FL(e)}[${t.index}${n}]`},KVe={Constant:e=>e.raw,Column:(e,t)=>e.array?qVe(e,t):c6(e,t,"at"),Dictionary:(e,t)=>c6(e,t,"key"),Function:e=>`fn.${e.name}`,Parameter:e=>`$${FL(e)}`,Op:(e,t)=>`op(${_l(e.name)},${t.op||t.index})`,Literal:e=>e.raw,Identifier:e=>e.name,TemplateLiteral:(e,t)=>{const{quasis:n,expressions:i}=e,r=i.length;let s=n[0].value.raw;for(let o=0;o<r;)s+="${"+Vt(i[o],t)+"}"+n[++o].value.raw;return"`"+s+"`"},MemberExpression:(e,t)=>{const n=!e.computed,i=Vt(e.object,t),r=Vt(e.property,t);return i+(n?"."+r:"["+r+"]")},CallExpression:u6,NewExpression:(e,t)=>"new "+u6(e,t),ArrayExpression:(e,t)=>"["+Qo(e.elements,t)+"]",AssignmentExpression:eD,BinaryExpression:eD,LogicalExpression:eD,UnaryExpression:(e,t)=>"("+e.operator+Vt(e.argument,t)+")",ConditionalExpression:(e,t)=>"("+Vt(e.test,t)+"?"+Vt(e.consequent,t)+":"+Vt(e.alternate,t)+")",ObjectExpression:(e,t)=>"({"+Qo(e.properties,t)+"})",Property:(e,t)=>{const n=Vt(e.key,t);return(e.computed?`[${n}]`:n)+":"+Vt(e.value,t)},ArrowFunctionExpression:tD,FunctionExpression:tD,FunctionDeclaration:tD,ArrayPattern:(e,t)=>"["+Qo(e.elements,t)+"]",ObjectPattern:(e,t)=>"{"+Qo(e.properties,t)+"}",VariableDeclaration:(e,t)=>e.kind+" "+Qo(e.declarations,t,","),VariableDeclarator:(e,t)=>Vt(e.id,t)+"="+Vt(e.init,t),SpreadElement:(e,t)=>"..."+Vt(e.argument,t),BlockStatement:(e,t)=>"{"+Qo(e.body,t,";")+";}",BreakStatement:()=>"break",ExpressionStatement:(e,t)=>Vt(e.expression,t),IfStatement:(e,t)=>"if ("+Vt(e.test,t)+")"+Vt(e.consequent,t)+(e.alternate?" else "+Vt(e.alternate,t):""),SwitchStatement:(e,t)=>"switch ("+Vt(e.discriminant,t)+") {"+Qo(e.cases,t,"")+"}",SwitchCase:(e,t)=>(e.test?"case "+Vt(e.test,t):"default")+": "+Qo(e.consequent,t,";")+";",ReturnStatement:(e,t)=>"return "+Vt(e.argument,t),Program:(e,t)=>Vt(e.body[0],t)};function IS(e,t={index:"row"}){return Vt(e,t)}function cm(e,t,n){return e=`"use strict"; return ${e};`,Function("fn","$",e)(t,n)}const AL={escape:(e,t,n)=>cm(e,t,n),expr:(e,t)=>cm(`(row,data,op)=>${e}`,mf,t),expr2:(e,t)=>cm(`(row0,data0,row,data)=>${e}`,mf,t),join:(e,t)=>cm(`(row1,data1,row2,data2)=>${e}`,mf,t),param:(e,t)=>cm(e,mf,t)},YVe={"==":1,"!=":1,"===":1,"!==":1};function aZ(e,t,n=0,i=void 0,r=void 0){if(e.type=rZ,e.name=t,e.table=n,Ec(i)&&(e.array=!0),r&&i&&vi(i.keyFor)){const s=YVe[r.operator]?r.left===e?r.right:r.left:r.callee&&r.callee.name==="equal"?r.arguments[r.arguments[0]===e?1:0]:null;s&&s.type===lg&&XVe(r,e,s,i.keyFor(s.value))}return e}function XVe(e,t,n,i){return i<0?(e.type=lg,e.value=!1,e.raw="false"):(t.type=zVe,n.value=i,n.raw=i+""),!0}const lZ="row_object";function uZ(e,t,n=t.columnNames()){e.type=BVe;const i=e.properties=[];for(const r of EL(n)){const[s,o]=ur(r)?r:[r,r];i.push({type:iZ,key:{type:lg,raw:_l(o)},value:aZ({computed:!0},s,0,t.column(s))})}return e}function cZ(e,t){return IS(uZ({},e,t))}function dZ(e,t){return AL.expr(cZ(e,t))}function QVe(e){return vi(e)?e:()=>e}const JVe="Escaped functions are not valid as rollup or pivot values.";function ZVe(e,t,n){e.aggronly&&un(JVe);const i=`(row,data)=>fn(${cZ(e.table)},$)`;return{escape:AL.escape(i,QVe(t.expr),n)}}var e5e=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,7,9,32,4,318,1,80,3,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,68,8,2,0,3,0,2,3,2,4,2,0,15,1,83,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,7,19,58,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,343,9,54,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,10,5350,0,7,14,11465,27,2343,9,87,9,39,4,60,6,26,9,535,9,470,0,2,54,8,3,82,0,12,1,19628,1,4178,9,519,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,245,1,2,9,726,6,110,6,6,9,4759,9,787719,239],hZ=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,4,51,13,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,39,27,10,22,251,41,7,1,17,2,60,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,31,9,2,0,3,0,2,37,2,0,26,0,2,0,45,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,200,32,32,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,26,3994,6,582,6842,29,1763,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,433,44,212,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,42,9,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,229,29,3,0,496,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],t5e="‌‍·̀-ͯ·҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-٩ٰۖ-ۜ۟-۪ۤۧۨ-ۭ۰-۹ܑܰ-݊ަ-ް߀-߉߫-߽߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࢗ-࢟࣊-ࣣ࣡-ःऺ-़ा-ॏ॑-ॗॢॣ०-९ঁ-ঃ়া-ৄেৈো-্ৗৢৣ০-৯৾ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣ૦-૯ૺ-૿ଁ-ଃ଼ା-ୄେୈୋ-୍୕-ୗୢୣ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఀ-ఄ఼ా-ౄె-ైొ-్ౕౖౢౣ౦-౯ಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣ೦-೯ೳഀ-ഃ഻഼ാ-ൄെ-ൈൊ-്ൗൢൣ൦-൯ඁ-ඃ්ා-ුූෘ-ෟ෦-෯ෲෳัิ-ฺ็-๎๐-๙ັິ-ຼ່-໎໐-໙༘༙༠-༩༹༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှ၀-၉ၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟፩-፱ᜒ-᜕ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝០-៩᠋-᠍᠏-᠙ᢩᤠ-ᤫᤰ-᤻᥆-᥏᧐-᧚ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼-᪉᪐-᪙᪰-᪽ᪿ-ᫎᬀ-ᬄ᬴-᭄᭐-᭙᭫-᭳ᮀ-ᮂᮡ-ᮭ᮰-᮹᯦-᯳ᰤ-᰷᱀-᱉᱐-᱙᳐-᳔᳒-᳨᳭᳴᳷-᳹᷀-᷿‌‍‿⁀⁔⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯・꘠-꘩꙯ꙴ-꙽ꚞꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧ꠬ꢀꢁꢴ-ꣅ꣐-꣙꣠-꣱ꣿ-꤉ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀꧐-꧙ꧥ꧰-꧹ꨩ-ꨶꩃꩌꩍ꩐-꩙ꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭꯰-꯹ﬞ︀-️︠-︯︳︴﹍-﹏０-９＿･",fZ="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙՠ-ֈא-תׯ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࡠ-ࡪࡰ-ࢇࢉ-ࢎࢠ-ࣉऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱৼਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౝౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೝೞೠೡೱೲഄ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄຆ-ຊຌ-ຣລວ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜑᜟ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡸᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭌᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲊᲐ-ᲺᲽ-Ჿᳩ-ᳬᳮ-ᳳᳵᳶᳺᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖ゛-ゟァ-ヺー-ヿㄅ-ㄯㄱ-ㆎㆠ-ㆿㇰ-ㇿ㐀-䶿一-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꟍꟐꟑꟓꟕ-Ƛꟲ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꣾꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭩꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",nD={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},iD="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",n5e={5:iD,"5module":iD+" export import",6:iD+" const class extends export import super"},i5e=/^in(stanceof)?$/,r5e=new RegExp("["+fZ+"]"),s5e=new RegExp("["+fZ+t5e+"]");function oT(e,t){for(var n=65536,i=0;i<t.length;i+=2){if(n+=t[i],n>e)return!1;if(n+=t[i+1],n>=e)return!0}return!1}function Ol(e,t){return e<65?e===36:e<91?!0:e<97?e===95:e<123?!0:e<=65535?e>=170&&r5e.test(String.fromCharCode(e)):t===!1?!1:oT(e,hZ)}function bp(e,t){return e<48?e===36:e<58?!0:e<65?!1:e<91?!0:e<97?e===95:e<123?!0:e<=65535?e>=170&&s5e.test(String.fromCharCode(e)):t===!1?!1:oT(e,hZ)||oT(e,e5e)}var Ct=function(t,n){n===void 0&&(n={}),this.label=t,this.keyword=n.keyword,this.beforeExpr=!!n.beforeExpr,this.startsExpr=!!n.startsExpr,this.isLoop=!!n.isLoop,this.isAssign=!!n.isAssign,this.prefix=!!n.prefix,this.postfix=!!n.postfix,this.binop=n.binop||null,this.updateContext=null};function gs(e,t){return new Ct(e,{beforeExpr:!0,binop:t})}var ms={beforeExpr:!0},mr={startsExpr:!0},DL={};function ft(e,t){return t===void 0&&(t={}),t.keyword=e,DL[e]=new Ct(e,t)}var T={num:new Ct("num",mr),regexp:new Ct("regexp",mr),string:new Ct("string",mr),name:new Ct("name",mr),privateId:new Ct("privateId",mr),eof:new Ct("eof"),bracketL:new Ct("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new Ct("]"),braceL:new Ct("{",{beforeExpr:!0,startsExpr:!0}),braceR:new Ct("}"),parenL:new Ct("(",{beforeExpr:!0,startsExpr:!0}),parenR:new Ct(")"),comma:new Ct(",",ms),semi:new Ct(";",ms),colon:new Ct(":",ms),dot:new Ct("."),question:new Ct("?",ms),questionDot:new Ct("?."),arrow:new Ct("=>",ms),template:new Ct("template"),invalidTemplate:new Ct("invalidTemplate"),ellipsis:new Ct("...",ms),backQuote:new Ct("`",mr),dollarBraceL:new Ct("${",{beforeExpr:!0,startsExpr:!0}),eq:new Ct("=",{beforeExpr:!0,isAssign:!0}),assign:new Ct("_=",{beforeExpr:!0,isAssign:!0}),incDec:new Ct("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new Ct("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:gs("||",1),logicalAND:gs("&&",2),bitwiseOR:gs("|",3),bitwiseXOR:gs("^",4),bitwiseAND:gs("&",5),equality:gs("==/!=/===/!==",6),relational:gs("</>/<=/>=",7),bitShift:gs("<</>>/>>>",8),plusMin:new Ct("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:gs("%",10),star:gs("*",10),slash:gs("/",10),starstar:new Ct("**",{beforeExpr:!0}),coalesce:gs("??",1),_break:ft("break"),_case:ft("case",ms),_catch:ft("catch"),_continue:ft("continue"),_debugger:ft("debugger"),_default:ft("default",ms),_do:ft("do",{isLoop:!0,beforeExpr:!0}),_else:ft("else",ms),_finally:ft("finally"),_for:ft("for",{isLoop:!0}),_function:ft("function",mr),_if:ft("if"),_return:ft("return",ms),_switch:ft("switch"),_throw:ft("throw",ms),_try:ft("try"),_var:ft("var"),_const:ft("const"),_while:ft("while",{isLoop:!0}),_with:ft("with"),_new:ft("new",{beforeExpr:!0,startsExpr:!0}),_this:ft("this",mr),_super:ft("super",mr),_class:ft("class",mr),_extends:ft("extends",ms),_export:ft("export"),_import:ft("import",mr),_null:ft("null",mr),_true:ft("true",mr),_false:ft("false",mr),_in:ft("in",{beforeExpr:!0,binop:7}),_instanceof:ft("instanceof",{beforeExpr:!0,binop:7}),_typeof:ft("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:ft("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:ft("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},Vs=/\r\n?|\n|\u2028|\u2029/,o5e=new RegExp(Vs.source,"g");function ug(e){return e===10||e===13||e===8232||e===8233}function pZ(e,t,n){n===void 0&&(n=e.length);for(var i=t;i<n;i++){var r=e.charCodeAt(i);if(ug(r))return i<n-1&&r===13&&e.charCodeAt(i+1)===10?i+2:i+1}return-1}var gZ=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,ys=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,mZ=Object.prototype,a5e=mZ.hasOwnProperty,l5e=mZ.toString,cg=Object.hasOwn||function(e,t){return a5e.call(e,t)},d6=Array.isArray||function(e){return l5e.call(e)==="[object Array]"},h6=Object.create(null);function _u(e){return h6[e]||(h6[e]=new RegExp("^(?:"+e.replace(/ /g,"|")+")$"))}function Ll(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10)+55296,(e&1023)+56320))}var u5e=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,Jv=function(t,n){this.line=t,this.column=n};Jv.prototype.offset=function(t){return new Jv(this.line,this.column+t)};var CR=function(t,n,i){this.start=n,this.end=i,t.sourceFile!==null&&(this.source=t.sourceFile)};function vZ(e,t){for(var n=1,i=0;;){var r=pZ(e,i,t);if(r<0)return new Jv(n,t-i);++n,i=r}}var aT={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},f6=!1;function c5e(e){var t={};for(var n in aT)t[n]=e&&cg(e,n)?e[n]:aT[n];if(t.ecmaVersion==="latest"?t.ecmaVersion=1e8:t.ecmaVersion==null?(!f6&&typeof console=="object"&&console.warn&&(f6=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),t.ecmaVersion=11):t.ecmaVersion>=2015&&(t.ecmaVersion-=2009),t.allowReserved==null&&(t.allowReserved=t.ecmaVersion<5),(!e||e.allowHashBang==null)&&(t.allowHashBang=t.ecmaVersion>=14),d6(t.onToken)){var i=t.onToken;t.onToken=function(r){return i.push(r)}}return d6(t.onComment)&&(t.onComment=d5e(t,t.onComment)),t}function d5e(e,t){return function(n,i,r,s,o,a){var l={type:n?"Block":"Line",value:i,start:r,end:s};e.locations&&(l.loc=new CR(this,o,a)),e.ranges&&(l.range=[r,s]),t.push(l)}}var Zv=1,dg=2,PL=4,CZ=8,yZ=16,wZ=32,kL=64,bZ=128,fC=256,TL=Zv|dg|fC;function ML(e,t){return dg|(e?PL:0)|(t?CZ:0)}var _S=0,IL=1,Jl=2,SZ=3,xZ=4,RZ=5,Hn=function(t,n,i){this.options=t=c5e(t),this.sourceFile=t.sourceFile,this.keywords=_u(n5e[t.ecmaVersion>=6?6:t.sourceType==="module"?"5module":5]);var r="";t.allowReserved!==!0&&(r=nD[t.ecmaVersion>=6?6:t.ecmaVersion===5?5:3],t.sourceType==="module"&&(r+=" await")),this.reservedWords=_u(r);var s=(r?r+" ":"")+nD.strict;this.reservedWordsStrict=_u(s),this.reservedWordsStrictBind=_u(s+" "+nD.strictBind),this.input=String(n),this.containsEsc=!1,i?(this.pos=i,this.lineStart=this.input.lastIndexOf(`
`,i-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(Vs).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=T.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=t.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&t.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(Zv),this.regexpState=null,this.privateNameStack=[]},$a={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};Hn.prototype.parse=function(){var t=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(t)};$a.inFunction.get=function(){return(this.currentVarScope().flags&dg)>0};$a.inGenerator.get=function(){return(this.currentVarScope().flags&CZ)>0&&!this.currentVarScope().inClassFieldInit};$a.inAsync.get=function(){return(this.currentVarScope().flags&PL)>0&&!this.currentVarScope().inClassFieldInit};$a.canAwait.get=function(){for(var e=this.scopeStack.length-1;e>=0;e--){var t=this.scopeStack[e];if(t.inClassFieldInit||t.flags&fC)return!1;if(t.flags&dg)return(t.flags&PL)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction};$a.allowSuper.get=function(){var e=this.currentThisScope(),t=e.flags,n=e.inClassFieldInit;return(t&kL)>0||n||this.options.allowSuperOutsideMethod};$a.allowDirectSuper.get=function(){return(this.currentThisScope().flags&bZ)>0};$a.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())};$a.allowNewDotTarget.get=function(){var e=this.currentThisScope(),t=e.flags,n=e.inClassFieldInit;return(t&(dg|fC))>0||n};$a.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&fC)>0};Hn.extend=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];for(var i=this,r=0;r<t.length;r++)i=t[r](i);return i};Hn.parse=function(t,n){return new this(n,t).parse()};Hn.parseExpressionAt=function(t,n,i){var r=new this(i,t,n);return r.nextToken(),r.parseExpression()};Hn.tokenizer=function(t,n){return new this(n,t)};Object.defineProperties(Hn.prototype,$a);var cr=Hn.prototype,h5e=/^(?:'((?:\\[^]|[^'\\])*?)'|"((?:\\[^]|[^"\\])*?)")/;cr.strictDirective=function(e){if(this.options.ecmaVersion<5)return!1;for(;;){ys.lastIndex=e,e+=ys.exec(this.input)[0].length;var t=h5e.exec(this.input.slice(e));if(!t)return!1;if((t[1]||t[2])==="use strict"){ys.lastIndex=e+t[0].length;var n=ys.exec(this.input),i=n.index+n[0].length,r=this.input.charAt(i);return r===";"||r==="}"||Vs.test(n[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(r)||r==="!"&&this.input.charAt(i+1)==="=")}e+=t[0].length,ys.lastIndex=e,e+=ys.exec(this.input)[0].length,this.input[e]===";"&&e++}};cr.eat=function(e){return this.type===e?(this.next(),!0):!1};cr.isContextual=function(e){return this.type===T.name&&this.value===e&&!this.containsEsc};cr.eatContextual=function(e){return this.isContextual(e)?(this.next(),!0):!1};cr.expectContextual=function(e){this.eatContextual(e)||this.unexpected()};cr.canInsertSemicolon=function(){return this.type===T.eof||this.type===T.braceR||Vs.test(this.input.slice(this.lastTokEnd,this.start))};cr.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0};cr.semicolon=function(){!this.eat(T.semi)&&!this.insertSemicolon()&&this.unexpected()};cr.afterTrailingComma=function(e,t){if(this.type===e)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),t||this.next(),!0};cr.expect=function(e){this.eat(e)||this.unexpected()};cr.unexpected=function(e){this.raise(e??this.start,"Unexpected token")};var yR=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};cr.checkPatternErrors=function(e,t){if(e){e.trailingComma>-1&&this.raiseRecoverable(e.trailingComma,"Comma is not permitted after the rest element");var n=t?e.parenthesizedAssign:e.parenthesizedBind;n>-1&&this.raiseRecoverable(n,t?"Assigning to rvalue":"Parenthesized pattern")}};cr.checkExpressionErrors=function(e,t){if(!e)return!1;var n=e.shorthandAssign,i=e.doubleProto;if(!t)return n>=0||i>=0;n>=0&&this.raise(n,"Shorthand property assignments are valid only in destructuring patterns"),i>=0&&this.raiseRecoverable(i,"Redefinition of __proto__ property")};cr.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")};cr.isSimpleAssignTarget=function(e){return e.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(e.expression):e.type==="Identifier"||e.type==="MemberExpression"};var Me=Hn.prototype;Me.parseTopLevel=function(e){var t=Object.create(null);for(e.body||(e.body=[]);this.type!==T.eof;){var n=this.parseStatement(null,!0,t);e.body.push(n)}if(this.inModule)for(var i=0,r=Object.keys(this.undefinedExports);i<r.length;i+=1){var s=r[i];this.raiseRecoverable(this.undefinedExports[s].start,"Export '"+s+"' is not defined")}return this.adaptDirectivePrologue(e.body),this.next(),e.sourceType=this.options.sourceType,this.finishNode(e,"Program")};var _L={kind:"loop"},f5e={kind:"switch"};Me.isLet=function(e){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;ys.lastIndex=this.pos;var t=ys.exec(this.input),n=this.pos+t[0].length,i=this.input.charCodeAt(n);if(i===91||i===92)return!0;if(e)return!1;if(i===123||i>55295&&i<56320)return!0;if(Ol(i,!0)){for(var r=n+1;bp(i=this.input.charCodeAt(r),!0);)++r;if(i===92||i>55295&&i<56320)return!0;var s=this.input.slice(n,r);if(!i5e.test(s))return!0}return!1};Me.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;ys.lastIndex=this.pos;var e=ys.exec(this.input),t=this.pos+e[0].length,n;return!Vs.test(this.input.slice(this.pos,t))&&this.input.slice(t,t+8)==="function"&&(t+8===this.input.length||!(bp(n=this.input.charCodeAt(t+8))||n>55295&&n<56320))};Me.parseStatement=function(e,t,n){var i=this.type,r=this.startNode(),s;switch(this.isLet(e)&&(i=T._var,s="let"),i){case T._break:case T._continue:return this.parseBreakContinueStatement(r,i.keyword);case T._debugger:return this.parseDebuggerStatement(r);case T._do:return this.parseDoStatement(r);case T._for:return this.parseForStatement(r);case T._function:return e&&(this.strict||e!=="if"&&e!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(r,!1,!e);case T._class:return e&&this.unexpected(),this.parseClass(r,!0);case T._if:return this.parseIfStatement(r);case T._return:return this.parseReturnStatement(r);case T._switch:return this.parseSwitchStatement(r);case T._throw:return this.parseThrowStatement(r);case T._try:return this.parseTryStatement(r);case T._const:case T._var:return s=s||this.value,e&&s!=="var"&&this.unexpected(),this.parseVarStatement(r,s);case T._while:return this.parseWhileStatement(r);case T._with:return this.parseWithStatement(r);case T.braceL:return this.parseBlock(!0,r);case T.semi:return this.parseEmptyStatement(r);case T._export:case T._import:if(this.options.ecmaVersion>10&&i===T._import){ys.lastIndex=this.pos;var o=ys.exec(this.input),a=this.pos+o[0].length,l=this.input.charCodeAt(a);if(l===40||l===46)return this.parseExpressionStatement(r,this.parseExpression())}return this.options.allowImportExportEverywhere||(t||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),i===T._import?this.parseImport(r):this.parseExport(r,n);default:if(this.isAsyncFunction())return e&&this.unexpected(),this.next(),this.parseFunctionStatement(r,!0,!e);var u=this.value,c=this.parseExpression();return i===T.name&&c.type==="Identifier"&&this.eat(T.colon)?this.parseLabeledStatement(r,u,c,e):this.parseExpressionStatement(r,c)}};Me.parseBreakContinueStatement=function(e,t){var n=t==="break";this.next(),this.eat(T.semi)||this.insertSemicolon()?e.label=null:this.type!==T.name?this.unexpected():(e.label=this.parseIdent(),this.semicolon());for(var i=0;i<this.labels.length;++i){var r=this.labels[i];if((e.label==null||r.name===e.label.name)&&(r.kind!=null&&(n||r.kind==="loop")||e.label&&n))break}return i===this.labels.length&&this.raise(e.start,"Unsyntactic "+t),this.finishNode(e,n?"BreakStatement":"ContinueStatement")};Me.parseDebuggerStatement=function(e){return this.next(),this.semicolon(),this.finishNode(e,"DebuggerStatement")};Me.parseDoStatement=function(e){return this.next(),this.labels.push(_L),e.body=this.parseStatement("do"),this.labels.pop(),this.expect(T._while),e.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(T.semi):this.semicolon(),this.finishNode(e,"DoWhileStatement")};Me.parseForStatement=function(e){this.next();var t=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(_L),this.enterScope(0),this.expect(T.parenL),this.type===T.semi)return t>-1&&this.unexpected(t),this.parseFor(e,null);var n=this.isLet();if(this.type===T._var||this.type===T._const||n){var i=this.startNode(),r=n?"let":this.value;return this.next(),this.parseVar(i,!0,r),this.finishNode(i,"VariableDeclaration"),(this.type===T._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&i.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===T._in?t>-1&&this.unexpected(t):e.await=t>-1),this.parseForIn(e,i)):(t>-1&&this.unexpected(t),this.parseFor(e,i))}var s=this.isContextual("let"),o=!1,a=this.containsEsc,l=new yR,u=this.start,c=t>-1?this.parseExprSubscripts(l,"await"):this.parseExpression(!0,l);return this.type===T._in||(o=this.options.ecmaVersion>=6&&this.isContextual("of"))?(t>-1?(this.type===T._in&&this.unexpected(t),e.await=!0):o&&this.options.ecmaVersion>=8&&(c.start===u&&!a&&c.type==="Identifier"&&c.name==="async"?this.unexpected():this.options.ecmaVersion>=9&&(e.await=!1)),s&&o&&this.raise(c.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(c,!1,l),this.checkLValPattern(c),this.parseForIn(e,c)):(this.checkExpressionErrors(l,!0),t>-1&&this.unexpected(t),this.parseFor(e,c))};Me.parseFunctionStatement=function(e,t,n){return this.next(),this.parseFunction(e,ov|(n?0:lT),!1,t)};Me.parseIfStatement=function(e){return this.next(),e.test=this.parseParenExpression(),e.consequent=this.parseStatement("if"),e.alternate=this.eat(T._else)?this.parseStatement("if"):null,this.finishNode(e,"IfStatement")};Me.parseReturnStatement=function(e){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(T.semi)||this.insertSemicolon()?e.argument=null:(e.argument=this.parseExpression(),this.semicolon()),this.finishNode(e,"ReturnStatement")};Me.parseSwitchStatement=function(e){this.next(),e.discriminant=this.parseParenExpression(),e.cases=[],this.expect(T.braceL),this.labels.push(f5e),this.enterScope(0);for(var t,n=!1;this.type!==T.braceR;)if(this.type===T._case||this.type===T._default){var i=this.type===T._case;t&&this.finishNode(t,"SwitchCase"),e.cases.push(t=this.startNode()),t.consequent=[],this.next(),i?t.test=this.parseExpression():(n&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),n=!0,t.test=null),this.expect(T.colon)}else t||this.unexpected(),t.consequent.push(this.parseStatement(null));return this.exitScope(),t&&this.finishNode(t,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(e,"SwitchStatement")};Me.parseThrowStatement=function(e){return this.next(),Vs.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),e.argument=this.parseExpression(),this.semicolon(),this.finishNode(e,"ThrowStatement")};var p5e=[];Me.parseCatchClauseParam=function(){var e=this.parseBindingAtom(),t=e.type==="Identifier";return this.enterScope(t?wZ:0),this.checkLValPattern(e,t?xZ:Jl),this.expect(T.parenR),e};Me.parseTryStatement=function(e){if(this.next(),e.block=this.parseBlock(),e.handler=null,this.type===T._catch){var t=this.startNode();this.next(),this.eat(T.parenL)?t.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),t.param=null,this.enterScope(0)),t.body=this.parseBlock(!1),this.exitScope(),e.handler=this.finishNode(t,"CatchClause")}return e.finalizer=this.eat(T._finally)?this.parseBlock():null,!e.handler&&!e.finalizer&&this.raise(e.start,"Missing catch or finally clause"),this.finishNode(e,"TryStatement")};Me.parseVarStatement=function(e,t,n){return this.next(),this.parseVar(e,!1,t,n),this.semicolon(),this.finishNode(e,"VariableDeclaration")};Me.parseWhileStatement=function(e){return this.next(),e.test=this.parseParenExpression(),this.labels.push(_L),e.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(e,"WhileStatement")};Me.parseWithStatement=function(e){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),e.object=this.parseParenExpression(),e.body=this.parseStatement("with"),this.finishNode(e,"WithStatement")};Me.parseEmptyStatement=function(e){return this.next(),this.finishNode(e,"EmptyStatement")};Me.parseLabeledStatement=function(e,t,n,i){for(var r=0,s=this.labels;r<s.length;r+=1){var o=s[r];o.name===t&&this.raise(n.start,"Label '"+t+"' is already declared")}for(var a=this.type.isLoop?"loop":this.type===T._switch?"switch":null,l=this.labels.length-1;l>=0;l--){var u=this.labels[l];if(u.statementStart===e.start)u.statementStart=this.start,u.kind=a;else break}return this.labels.push({name:t,kind:a,statementStart:this.start}),e.body=this.parseStatement(i?i.indexOf("label")===-1?i+"label":i:"label"),this.labels.pop(),e.label=n,this.finishNode(e,"LabeledStatement")};Me.parseExpressionStatement=function(e,t){return e.expression=t,this.semicolon(),this.finishNode(e,"ExpressionStatement")};Me.parseBlock=function(e,t,n){for(e===void 0&&(e=!0),t===void 0&&(t=this.startNode()),t.body=[],this.expect(T.braceL),e&&this.enterScope(0);this.type!==T.braceR;){var i=this.parseStatement(null);t.body.push(i)}return n&&(this.strict=!1),this.next(),e&&this.exitScope(),this.finishNode(t,"BlockStatement")};Me.parseFor=function(e,t){return e.init=t,this.expect(T.semi),e.test=this.type===T.semi?null:this.parseExpression(),this.expect(T.semi),e.update=this.type===T.parenR?null:this.parseExpression(),this.expect(T.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,"ForStatement")};Me.parseForIn=function(e,t){var n=this.type===T._in;return this.next(),t.type==="VariableDeclaration"&&t.declarations[0].init!=null&&(!n||this.options.ecmaVersion<8||this.strict||t.kind!=="var"||t.declarations[0].id.type!=="Identifier")&&this.raise(t.start,(n?"for-in":"for-of")+" loop variable declaration may not have an initializer"),e.left=t,e.right=n?this.parseExpression():this.parseMaybeAssign(),this.expect(T.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,n?"ForInStatement":"ForOfStatement")};Me.parseVar=function(e,t,n,i){for(e.declarations=[],e.kind=n;;){var r=this.startNode();if(this.parseVarId(r,n),this.eat(T.eq)?r.init=this.parseMaybeAssign(t):!i&&n==="const"&&!(this.type===T._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!i&&r.id.type!=="Identifier"&&!(t&&(this.type===T._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):r.init=null,e.declarations.push(this.finishNode(r,"VariableDeclarator")),!this.eat(T.comma))break}return e};Me.parseVarId=function(e,t){e.id=this.parseBindingAtom(),this.checkLValPattern(e.id,t==="var"?IL:Jl,!1)};var ov=1,lT=2,EZ=4;Me.parseFunction=function(e,t,n,i,r){this.initFunction(e),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!i)&&(this.type===T.star&&t&lT&&this.unexpected(),e.generator=this.eat(T.star)),this.options.ecmaVersion>=8&&(e.async=!!i),t&ov&&(e.id=t&EZ&&this.type!==T.name?null:this.parseIdent(),e.id&&!(t&lT)&&this.checkLValSimple(e.id,this.strict||e.generator||e.async?this.treatFunctionsAsVar?IL:Jl:SZ));var s=this.yieldPos,o=this.awaitPos,a=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(ML(e.async,e.generator)),t&ov||(e.id=this.type===T.name?this.parseIdent():null),this.parseFunctionParams(e),this.parseFunctionBody(e,n,!1,r),this.yieldPos=s,this.awaitPos=o,this.awaitIdentPos=a,this.finishNode(e,t&ov?"FunctionDeclaration":"FunctionExpression")};Me.parseFunctionParams=function(e){this.expect(T.parenL),e.params=this.parseBindingList(T.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()};Me.parseClass=function(e,t){this.next();var n=this.strict;this.strict=!0,this.parseClassId(e,t),this.parseClassSuper(e);var i=this.enterClassBody(),r=this.startNode(),s=!1;for(r.body=[],this.expect(T.braceL);this.type!==T.braceR;){var o=this.parseClassElement(e.superClass!==null);o&&(r.body.push(o),o.type==="MethodDefinition"&&o.kind==="constructor"?(s&&this.raiseRecoverable(o.start,"Duplicate constructor in the same class"),s=!0):o.key&&o.key.type==="PrivateIdentifier"&&g5e(i,o)&&this.raiseRecoverable(o.key.start,"Identifier '#"+o.key.name+"' has already been declared"))}return this.strict=n,this.next(),e.body=this.finishNode(r,"ClassBody"),this.exitClassBody(),this.finishNode(e,t?"ClassDeclaration":"ClassExpression")};Me.parseClassElement=function(e){if(this.eat(T.semi))return null;var t=this.options.ecmaVersion,n=this.startNode(),i="",r=!1,s=!1,o="method",a=!1;if(this.eatContextual("static")){if(t>=13&&this.eat(T.braceL))return this.parseClassStaticBlock(n),n;this.isClassElementNameStart()||this.type===T.star?a=!0:i="static"}if(n.static=a,!i&&t>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===T.star)&&!this.canInsertSemicolon()?s=!0:i="async"),!i&&(t>=9||!s)&&this.eat(T.star)&&(r=!0),!i&&!s&&!r){var l=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?o=l:i=l)}if(i?(n.computed=!1,n.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),n.key.name=i,this.finishNode(n.key,"Identifier")):this.parseClassElementName(n),t<13||this.type===T.parenL||o!=="method"||r||s){var u=!n.static&&OS(n,"constructor"),c=u&&e;u&&o!=="method"&&this.raise(n.key.start,"Constructor can't have get/set modifier"),n.kind=u?"constructor":o,this.parseClassMethod(n,r,s,c)}else this.parseClassField(n);return n};Me.isClassElementNameStart=function(){return this.type===T.name||this.type===T.privateId||this.type===T.num||this.type===T.string||this.type===T.bracketL||this.type.keyword};Me.parseClassElementName=function(e){this.type===T.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),e.computed=!1,e.key=this.parsePrivateIdent()):this.parsePropertyName(e)};Me.parseClassMethod=function(e,t,n,i){var r=e.key;e.kind==="constructor"?(t&&this.raise(r.start,"Constructor can't be a generator"),n&&this.raise(r.start,"Constructor can't be an async method")):e.static&&OS(e,"prototype")&&this.raise(r.start,"Classes may not have a static property named prototype");var s=e.value=this.parseMethod(t,n,i);return e.kind==="get"&&s.params.length!==0&&this.raiseRecoverable(s.start,"getter should have no params"),e.kind==="set"&&s.params.length!==1&&this.raiseRecoverable(s.start,"setter should have exactly one param"),e.kind==="set"&&s.params[0].type==="RestElement"&&this.raiseRecoverable(s.params[0].start,"Setter cannot use rest params"),this.finishNode(e,"MethodDefinition")};Me.parseClassField=function(e){if(OS(e,"constructor")?this.raise(e.key.start,"Classes can't have a field named 'constructor'"):e.static&&OS(e,"prototype")&&this.raise(e.key.start,"Classes can't have a static field named 'prototype'"),this.eat(T.eq)){var t=this.currentThisScope(),n=t.inClassFieldInit;t.inClassFieldInit=!0,e.value=this.parseMaybeAssign(),t.inClassFieldInit=n}else e.value=null;return this.semicolon(),this.finishNode(e,"PropertyDefinition")};Me.parseClassStaticBlock=function(e){e.body=[];var t=this.labels;for(this.labels=[],this.enterScope(fC|kL);this.type!==T.braceR;){var n=this.parseStatement(null);e.body.push(n)}return this.next(),this.exitScope(),this.labels=t,this.finishNode(e,"StaticBlock")};Me.parseClassId=function(e,t){this.type===T.name?(e.id=this.parseIdent(),t&&this.checkLValSimple(e.id,Jl,!1)):(t===!0&&this.unexpected(),e.id=null)};Me.parseClassSuper=function(e){e.superClass=this.eat(T._extends)?this.parseExprSubscripts(null,!1):null};Me.enterClassBody=function(){var e={declared:Object.create(null),used:[]};return this.privateNameStack.push(e),e.declared};Me.exitClassBody=function(){var e=this.privateNameStack.pop(),t=e.declared,n=e.used;if(this.options.checkPrivateFields)for(var i=this.privateNameStack.length,r=i===0?null:this.privateNameStack[i-1],s=0;s<n.length;++s){var o=n[s];cg(t,o.name)||(r?r.used.push(o):this.raiseRecoverable(o.start,"Private field '#"+o.name+"' must be declared in an enclosing class"))}};function g5e(e,t){var n=t.key.name,i=e[n],r="true";return t.type==="MethodDefinition"&&(t.kind==="get"||t.kind==="set")&&(r=(t.static?"s":"i")+t.kind),i==="iget"&&r==="iset"||i==="iset"&&r==="iget"||i==="sget"&&r==="sset"||i==="sset"&&r==="sget"?(e[n]="true",!1):i?!0:(e[n]=r,!1)}function OS(e,t){var n=e.computed,i=e.key;return!n&&(i.type==="Identifier"&&i.name===t||i.type==="Literal"&&i.value===t)}Me.parseExportAllDeclaration=function(e,t){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(e.exported=this.parseModuleExportName(),this.checkExport(t,e.exported,this.lastTokStart)):e.exported=null),this.expectContextual("from"),this.type!==T.string&&this.unexpected(),e.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(e.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(e,"ExportAllDeclaration")};Me.parseExport=function(e,t){if(this.next(),this.eat(T.star))return this.parseExportAllDeclaration(e,t);if(this.eat(T._default))return this.checkExport(t,"default",this.lastTokStart),e.declaration=this.parseExportDefaultDeclaration(),this.finishNode(e,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())e.declaration=this.parseExportDeclaration(e),e.declaration.type==="VariableDeclaration"?this.checkVariableExport(t,e.declaration.declarations):this.checkExport(t,e.declaration.id,e.declaration.id.start),e.specifiers=[],e.source=null;else{if(e.declaration=null,e.specifiers=this.parseExportSpecifiers(t),this.eatContextual("from"))this.type!==T.string&&this.unexpected(),e.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(e.attributes=this.parseWithClause());else{for(var n=0,i=e.specifiers;n<i.length;n+=1){var r=i[n];this.checkUnreserved(r.local),this.checkLocalExport(r.local),r.local.type==="Literal"&&this.raise(r.local.start,"A string literal cannot be used as an exported binding without `from`.")}e.source=null}this.semicolon()}return this.finishNode(e,"ExportNamedDeclaration")};Me.parseExportDeclaration=function(e){return this.parseStatement(null)};Me.parseExportDefaultDeclaration=function(){var e;if(this.type===T._function||(e=this.isAsyncFunction())){var t=this.startNode();return this.next(),e&&this.next(),this.parseFunction(t,ov|EZ,!1,e)}else if(this.type===T._class){var n=this.startNode();return this.parseClass(n,"nullableID")}else{var i=this.parseMaybeAssign();return this.semicolon(),i}};Me.checkExport=function(e,t,n){e&&(typeof t!="string"&&(t=t.type==="Identifier"?t.name:t.value),cg(e,t)&&this.raiseRecoverable(n,"Duplicate export '"+t+"'"),e[t]=!0)};Me.checkPatternExport=function(e,t){var n=t.type;if(n==="Identifier")this.checkExport(e,t,t.start);else if(n==="ObjectPattern")for(var i=0,r=t.properties;i<r.length;i+=1){var s=r[i];this.checkPatternExport(e,s)}else if(n==="ArrayPattern")for(var o=0,a=t.elements;o<a.length;o+=1){var l=a[o];l&&this.checkPatternExport(e,l)}else n==="Property"?this.checkPatternExport(e,t.value):n==="AssignmentPattern"?this.checkPatternExport(e,t.left):n==="RestElement"&&this.checkPatternExport(e,t.argument)};Me.checkVariableExport=function(e,t){if(e)for(var n=0,i=t;n<i.length;n+=1){var r=i[n];this.checkPatternExport(e,r.id)}};Me.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()};Me.parseExportSpecifier=function(e){var t=this.startNode();return t.local=this.parseModuleExportName(),t.exported=this.eatContextual("as")?this.parseModuleExportName():t.local,this.checkExport(e,t.exported,t.exported.start),this.finishNode(t,"ExportSpecifier")};Me.parseExportSpecifiers=function(e){var t=[],n=!0;for(this.expect(T.braceL);!this.eat(T.braceR);){if(n)n=!1;else if(this.expect(T.comma),this.afterTrailingComma(T.braceR))break;t.push(this.parseExportSpecifier(e))}return t};Me.parseImport=function(e){return this.next(),this.type===T.string?(e.specifiers=p5e,e.source=this.parseExprAtom()):(e.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),e.source=this.type===T.string?this.parseExprAtom():this.unexpected()),this.options.ecmaVersion>=16&&(e.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(e,"ImportDeclaration")};Me.parseImportSpecifier=function(){var e=this.startNode();return e.imported=this.parseModuleExportName(),this.eatContextual("as")?e.local=this.parseIdent():(this.checkUnreserved(e.imported),e.local=e.imported),this.checkLValSimple(e.local,Jl),this.finishNode(e,"ImportSpecifier")};Me.parseImportDefaultSpecifier=function(){var e=this.startNode();return e.local=this.parseIdent(),this.checkLValSimple(e.local,Jl),this.finishNode(e,"ImportDefaultSpecifier")};Me.parseImportNamespaceSpecifier=function(){var e=this.startNode();return this.next(),this.expectContextual("as"),e.local=this.parseIdent(),this.checkLValSimple(e.local,Jl),this.finishNode(e,"ImportNamespaceSpecifier")};Me.parseImportSpecifiers=function(){var e=[],t=!0;if(this.type===T.name&&(e.push(this.parseImportDefaultSpecifier()),!this.eat(T.comma)))return e;if(this.type===T.star)return e.push(this.parseImportNamespaceSpecifier()),e;for(this.expect(T.braceL);!this.eat(T.braceR);){if(t)t=!1;else if(this.expect(T.comma),this.afterTrailingComma(T.braceR))break;e.push(this.parseImportSpecifier())}return e};Me.parseWithClause=function(){var e=[];if(!this.eat(T._with))return e;this.expect(T.braceL);for(var t={},n=!0;!this.eat(T.braceR);){if(n)n=!1;else if(this.expect(T.comma),this.afterTrailingComma(T.braceR))break;var i=this.parseImportAttribute(),r=i.key.type==="Identifier"?i.key.name:i.key.value;cg(t,r)&&this.raiseRecoverable(i.key.start,"Duplicate attribute key '"+r+"'"),t[r]=!0,e.push(i)}return e};Me.parseImportAttribute=function(){var e=this.startNode();return e.key=this.type===T.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never"),this.expect(T.colon),this.type!==T.string&&this.unexpected(),e.value=this.parseExprAtom(),this.finishNode(e,"ImportAttribute")};Me.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===T.string){var e=this.parseLiteral(this.value);return u5e.test(e.value)&&this.raise(e.start,"An export name cannot include a lone surrogate."),e}return this.parseIdent(!0)};Me.adaptDirectivePrologue=function(e){for(var t=0;t<e.length&&this.isDirectiveCandidate(e[t]);++t)e[t].directive=e[t].expression.raw.slice(1,-1)};Me.isDirectiveCandidate=function(e){return this.options.ecmaVersion>=5&&e.type==="ExpressionStatement"&&e.expression.type==="Literal"&&typeof e.expression.value=="string"&&(this.input[e.start]==='"'||this.input[e.start]==="'")};var Ws=Hn.prototype;Ws.toAssignable=function(e,t,n){if(this.options.ecmaVersion>=6&&e)switch(e.type){case"Identifier":this.inAsync&&e.name==="await"&&this.raise(e.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":e.type="ObjectPattern",n&&this.checkPatternErrors(n,!0);for(var i=0,r=e.properties;i<r.length;i+=1){var s=r[i];this.toAssignable(s,t),s.type==="RestElement"&&(s.argument.type==="ArrayPattern"||s.argument.type==="ObjectPattern")&&this.raise(s.argument.start,"Unexpected token")}break;case"Property":e.kind!=="init"&&this.raise(e.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(e.value,t);break;case"ArrayExpression":e.type="ArrayPattern",n&&this.checkPatternErrors(n,!0),this.toAssignableList(e.elements,t);break;case"SpreadElement":e.type="RestElement",this.toAssignable(e.argument,t),e.argument.type==="AssignmentPattern"&&this.raise(e.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":e.operator!=="="&&this.raise(e.left.end,"Only '=' operator can be used for specifying default value."),e.type="AssignmentPattern",delete e.operator,this.toAssignable(e.left,t);break;case"ParenthesizedExpression":this.toAssignable(e.expression,t,n);break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!t)break;default:this.raise(e.start,"Assigning to rvalue")}else n&&this.checkPatternErrors(n,!0);return e};Ws.toAssignableList=function(e,t){for(var n=e.length,i=0;i<n;i++){var r=e[i];r&&this.toAssignable(r,t)}if(n){var s=e[n-1];this.options.ecmaVersion===6&&t&&s&&s.type==="RestElement"&&s.argument.type!=="Identifier"&&this.unexpected(s.argument.start)}return e};Ws.parseSpread=function(e){var t=this.startNode();return this.next(),t.argument=this.parseMaybeAssign(!1,e),this.finishNode(t,"SpreadElement")};Ws.parseRestBinding=function(){var e=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==T.name&&this.unexpected(),e.argument=this.parseBindingAtom(),this.finishNode(e,"RestElement")};Ws.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case T.bracketL:var e=this.startNode();return this.next(),e.elements=this.parseBindingList(T.bracketR,!0,!0),this.finishNode(e,"ArrayPattern");case T.braceL:return this.parseObj(!0)}return this.parseIdent()};Ws.parseBindingList=function(e,t,n,i){for(var r=[],s=!0;!this.eat(e);)if(s?s=!1:this.expect(T.comma),t&&this.type===T.comma)r.push(null);else{if(n&&this.afterTrailingComma(e))break;if(this.type===T.ellipsis){var o=this.parseRestBinding();this.parseBindingListItem(o),r.push(o),this.type===T.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(e);break}else r.push(this.parseAssignableListItem(i))}return r};Ws.parseAssignableListItem=function(e){var t=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(t),t};Ws.parseBindingListItem=function(e){return e};Ws.parseMaybeDefault=function(e,t,n){if(n=n||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(T.eq))return n;var i=this.startNodeAt(e,t);return i.left=n,i.right=this.parseMaybeAssign(),this.finishNode(i,"AssignmentPattern")};Ws.checkLValSimple=function(e,t,n){t===void 0&&(t=_S);var i=t!==_S;switch(e.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(e.name)&&this.raiseRecoverable(e.start,(i?"Binding ":"Assigning to ")+e.name+" in strict mode"),i&&(t===Jl&&e.name==="let"&&this.raiseRecoverable(e.start,"let is disallowed as a lexically bound name"),n&&(cg(n,e.name)&&this.raiseRecoverable(e.start,"Argument name clash"),n[e.name]=!0),t!==RZ&&this.declareName(e.name,t,e.start));break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":i&&this.raiseRecoverable(e.start,"Binding member expression");break;case"ParenthesizedExpression":return i&&this.raiseRecoverable(e.start,"Binding parenthesized expression"),this.checkLValSimple(e.expression,t,n);default:this.raise(e.start,(i?"Binding":"Assigning to")+" rvalue")}};Ws.checkLValPattern=function(e,t,n){switch(t===void 0&&(t=_S),e.type){case"ObjectPattern":for(var i=0,r=e.properties;i<r.length;i+=1){var s=r[i];this.checkLValInnerPattern(s,t,n)}break;case"ArrayPattern":for(var o=0,a=e.elements;o<a.length;o+=1){var l=a[o];l&&this.checkLValInnerPattern(l,t,n)}break;default:this.checkLValSimple(e,t,n)}};Ws.checkLValInnerPattern=function(e,t,n){switch(t===void 0&&(t=_S),e.type){case"Property":this.checkLValInnerPattern(e.value,t,n);break;case"AssignmentPattern":this.checkLValPattern(e.left,t,n);break;case"RestElement":this.checkLValPattern(e.argument,t,n);break;default:this.checkLValPattern(e,t,n)}};var eo=function(t,n,i,r,s){this.token=t,this.isExpr=!!n,this.preserveSpace=!!i,this.override=r,this.generator=!!s},Zt={b_stat:new eo("{",!1),b_expr:new eo("{",!0),b_tmpl:new eo("${",!1),p_stat:new eo("(",!1),p_expr:new eo("(",!0),q_tmpl:new eo("`",!0,!0,function(e){return e.tryReadTemplateToken()}),f_stat:new eo("function",!1),f_expr:new eo("function",!0),f_expr_gen:new eo("function",!0,!1,null,!0),f_gen:new eo("function",!1,!1,null,!0)},hg=Hn.prototype;hg.initialContext=function(){return[Zt.b_stat]};hg.curContext=function(){return this.context[this.context.length-1]};hg.braceIsBlock=function(e){var t=this.curContext();return t===Zt.f_expr||t===Zt.f_stat?!0:e===T.colon&&(t===Zt.b_stat||t===Zt.b_expr)?!t.isExpr:e===T._return||e===T.name&&this.exprAllowed?Vs.test(this.input.slice(this.lastTokEnd,this.start)):e===T._else||e===T.semi||e===T.eof||e===T.parenR||e===T.arrow?!0:e===T.braceL?t===Zt.b_stat:e===T._var||e===T._const||e===T.name?!1:!this.exprAllowed};hg.inGeneratorContext=function(){for(var e=this.context.length-1;e>=1;e--){var t=this.context[e];if(t.token==="function")return t.generator}return!1};hg.updateContext=function(e){var t,n=this.type;n.keyword&&e===T.dot?this.exprAllowed=!1:(t=n.updateContext)?t.call(this,e):this.exprAllowed=n.beforeExpr};hg.overrideContext=function(e){this.curContext()!==e&&(this.context[this.context.length-1]=e)};T.parenR.updateContext=T.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var e=this.context.pop();e===Zt.b_stat&&this.curContext().token==="function"&&(e=this.context.pop()),this.exprAllowed=!e.isExpr};T.braceL.updateContext=function(e){this.context.push(this.braceIsBlock(e)?Zt.b_stat:Zt.b_expr),this.exprAllowed=!0};T.dollarBraceL.updateContext=function(){this.context.push(Zt.b_tmpl),this.exprAllowed=!0};T.parenL.updateContext=function(e){var t=e===T._if||e===T._for||e===T._with||e===T._while;this.context.push(t?Zt.p_stat:Zt.p_expr),this.exprAllowed=!0};T.incDec.updateContext=function(){};T._function.updateContext=T._class.updateContext=function(e){e.beforeExpr&&e!==T._else&&!(e===T.semi&&this.curContext()!==Zt.p_stat)&&!(e===T._return&&Vs.test(this.input.slice(this.lastTokEnd,this.start)))&&!((e===T.colon||e===T.braceL)&&this.curContext()===Zt.b_stat)?this.context.push(Zt.f_expr):this.context.push(Zt.f_stat),this.exprAllowed=!1};T.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0};T.backQuote.updateContext=function(){this.curContext()===Zt.q_tmpl?this.context.pop():this.context.push(Zt.q_tmpl),this.exprAllowed=!1};T.star.updateContext=function(e){if(e===T._function){var t=this.context.length-1;this.context[t]===Zt.f_expr?this.context[t]=Zt.f_expr_gen:this.context[t]=Zt.f_gen}this.exprAllowed=!0};T.name.updateContext=function(e){var t=!1;this.options.ecmaVersion>=6&&e!==T.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(t=!0),this.exprAllowed=t};var je=Hn.prototype;je.checkPropClash=function(e,t,n){if(!(this.options.ecmaVersion>=9&&e.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(e.computed||e.method||e.shorthand))){var i=e.key,r;switch(i.type){case"Identifier":r=i.name;break;case"Literal":r=String(i.value);break;default:return}var s=e.kind;if(this.options.ecmaVersion>=6){r==="__proto__"&&s==="init"&&(t.proto&&(n?n.doubleProto<0&&(n.doubleProto=i.start):this.raiseRecoverable(i.start,"Redefinition of __proto__ property")),t.proto=!0);return}r="$"+r;var o=t[r];if(o){var a;s==="init"?a=this.strict&&o.init||o.get||o.set:a=o.init||o[s],a&&this.raiseRecoverable(i.start,"Redefinition of property")}else o=t[r]={init:!1,get:!1,set:!1};o[s]=!0}};je.parseExpression=function(e,t){var n=this.start,i=this.startLoc,r=this.parseMaybeAssign(e,t);if(this.type===T.comma){var s=this.startNodeAt(n,i);for(s.expressions=[r];this.eat(T.comma);)s.expressions.push(this.parseMaybeAssign(e,t));return this.finishNode(s,"SequenceExpression")}return r};je.parseMaybeAssign=function(e,t,n){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(e);this.exprAllowed=!1}var i=!1,r=-1,s=-1,o=-1;t?(r=t.parenthesizedAssign,s=t.trailingComma,o=t.doubleProto,t.parenthesizedAssign=t.trailingComma=-1):(t=new yR,i=!0);var a=this.start,l=this.startLoc;(this.type===T.parenL||this.type===T.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=e==="await");var u=this.parseMaybeConditional(e,t);if(n&&(u=n.call(this,u,a,l)),this.type.isAssign){var c=this.startNodeAt(a,l);return c.operator=this.value,this.type===T.eq&&(u=this.toAssignable(u,!1,t)),i||(t.parenthesizedAssign=t.trailingComma=t.doubleProto=-1),t.shorthandAssign>=u.start&&(t.shorthandAssign=-1),this.type===T.eq?this.checkLValPattern(u):this.checkLValSimple(u),c.left=u,this.next(),c.right=this.parseMaybeAssign(e),o>-1&&(t.doubleProto=o),this.finishNode(c,"AssignmentExpression")}else i&&this.checkExpressionErrors(t,!0);return r>-1&&(t.parenthesizedAssign=r),s>-1&&(t.trailingComma=s),u};je.parseMaybeConditional=function(e,t){var n=this.start,i=this.startLoc,r=this.parseExprOps(e,t);if(this.checkExpressionErrors(t))return r;if(this.eat(T.question)){var s=this.startNodeAt(n,i);return s.test=r,s.consequent=this.parseMaybeAssign(),this.expect(T.colon),s.alternate=this.parseMaybeAssign(e),this.finishNode(s,"ConditionalExpression")}return r};je.parseExprOps=function(e,t){var n=this.start,i=this.startLoc,r=this.parseMaybeUnary(t,!1,!1,e);return this.checkExpressionErrors(t)||r.start===n&&r.type==="ArrowFunctionExpression"?r:this.parseExprOp(r,n,i,-1,e)};je.parseExprOp=function(e,t,n,i,r){var s=this.type.binop;if(s!=null&&(!r||this.type!==T._in)&&s>i){var o=this.type===T.logicalOR||this.type===T.logicalAND,a=this.type===T.coalesce;a&&(s=T.logicalAND.binop);var l=this.value;this.next();var u=this.start,c=this.startLoc,d=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,r),u,c,s,r),h=this.buildBinary(t,n,e,d,l,o||a);return(o&&this.type===T.coalesce||a&&(this.type===T.logicalOR||this.type===T.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(h,t,n,i,r)}return e};je.buildBinary=function(e,t,n,i,r,s){i.type==="PrivateIdentifier"&&this.raise(i.start,"Private identifier can only be left side of binary expression");var o=this.startNodeAt(e,t);return o.left=n,o.operator=r,o.right=i,this.finishNode(o,s?"LogicalExpression":"BinaryExpression")};je.parseMaybeUnary=function(e,t,n,i){var r=this.start,s=this.startLoc,o;if(this.isContextual("await")&&this.canAwait)o=this.parseAwait(i),t=!0;else if(this.type.prefix){var a=this.startNode(),l=this.type===T.incDec;a.operator=this.value,a.prefix=!0,this.next(),a.argument=this.parseMaybeUnary(null,!0,l,i),this.checkExpressionErrors(e,!0),l?this.checkLValSimple(a.argument):this.strict&&a.operator==="delete"&&FZ(a.argument)?this.raiseRecoverable(a.start,"Deleting local variable in strict mode"):a.operator==="delete"&&uT(a.argument)?this.raiseRecoverable(a.start,"Private fields can not be deleted"):t=!0,o=this.finishNode(a,l?"UpdateExpression":"UnaryExpression")}else if(!t&&this.type===T.privateId)(i||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),o=this.parsePrivateIdent(),this.type!==T._in&&this.unexpected();else{if(o=this.parseExprSubscripts(e,i),this.checkExpressionErrors(e))return o;for(;this.type.postfix&&!this.canInsertSemicolon();){var u=this.startNodeAt(r,s);u.operator=this.value,u.prefix=!1,u.argument=o,this.checkLValSimple(o),this.next(),o=this.finishNode(u,"UpdateExpression")}}if(!n&&this.eat(T.starstar))if(t)this.unexpected(this.lastTokStart);else return this.buildBinary(r,s,o,this.parseMaybeUnary(null,!1,!1,i),"**",!1);else return o};function FZ(e){return e.type==="Identifier"||e.type==="ParenthesizedExpression"&&FZ(e.expression)}function uT(e){return e.type==="MemberExpression"&&e.property.type==="PrivateIdentifier"||e.type==="ChainExpression"&&uT(e.expression)||e.type==="ParenthesizedExpression"&&uT(e.expression)}je.parseExprSubscripts=function(e,t){var n=this.start,i=this.startLoc,r=this.parseExprAtom(e,t);if(r.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return r;var s=this.parseSubscripts(r,n,i,!1,t);return e&&s.type==="MemberExpression"&&(e.parenthesizedAssign>=s.start&&(e.parenthesizedAssign=-1),e.parenthesizedBind>=s.start&&(e.parenthesizedBind=-1),e.trailingComma>=s.start&&(e.trailingComma=-1)),s};je.parseSubscripts=function(e,t,n,i,r){for(var s=this.options.ecmaVersion>=8&&e.type==="Identifier"&&e.name==="async"&&this.lastTokEnd===e.end&&!this.canInsertSemicolon()&&e.end-e.start===5&&this.potentialArrowAt===e.start,o=!1;;){var a=this.parseSubscript(e,t,n,i,s,o,r);if(a.optional&&(o=!0),a===e||a.type==="ArrowFunctionExpression"){if(o){var l=this.startNodeAt(t,n);l.expression=a,a=this.finishNode(l,"ChainExpression")}return a}e=a}};je.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(T.arrow)};je.parseSubscriptAsyncArrow=function(e,t,n,i){return this.parseArrowExpression(this.startNodeAt(e,t),n,!0,i)};je.parseSubscript=function(e,t,n,i,r,s,o){var a=this.options.ecmaVersion>=11,l=a&&this.eat(T.questionDot);i&&l&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var u=this.eat(T.bracketL);if(u||l&&this.type!==T.parenL&&this.type!==T.backQuote||this.eat(T.dot)){var c=this.startNodeAt(t,n);c.object=e,u?(c.property=this.parseExpression(),this.expect(T.bracketR)):this.type===T.privateId&&e.type!=="Super"?c.property=this.parsePrivateIdent():c.property=this.parseIdent(this.options.allowReserved!=="never"),c.computed=!!u,a&&(c.optional=l),e=this.finishNode(c,"MemberExpression")}else if(!i&&this.eat(T.parenL)){var d=new yR,h=this.yieldPos,p=this.awaitPos,g=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var v=this.parseExprList(T.parenR,this.options.ecmaVersion>=8,!1,d);if(r&&!l&&this.shouldParseAsyncArrow())return this.checkPatternErrors(d,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=h,this.awaitPos=p,this.awaitIdentPos=g,this.parseSubscriptAsyncArrow(t,n,v,o);this.checkExpressionErrors(d,!0),this.yieldPos=h||this.yieldPos,this.awaitPos=p||this.awaitPos,this.awaitIdentPos=g||this.awaitIdentPos;var C=this.startNodeAt(t,n);C.callee=e,C.arguments=v,a&&(C.optional=l),e=this.finishNode(C,"CallExpression")}else if(this.type===T.backQuote){(l||s)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var y=this.startNodeAt(t,n);y.tag=e,y.quasi=this.parseTemplate({isTagged:!0}),e=this.finishNode(y,"TaggedTemplateExpression")}return e};je.parseExprAtom=function(e,t,n){this.type===T.slash&&this.readRegexp();var i,r=this.potentialArrowAt===this.start;switch(this.type){case T._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),i=this.startNode(),this.next(),this.type===T.parenL&&!this.allowDirectSuper&&this.raise(i.start,"super() call outside constructor of a subclass"),this.type!==T.dot&&this.type!==T.bracketL&&this.type!==T.parenL&&this.unexpected(),this.finishNode(i,"Super");case T._this:return i=this.startNode(),this.next(),this.finishNode(i,"ThisExpression");case T.name:var s=this.start,o=this.startLoc,a=this.containsEsc,l=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!a&&l.name==="async"&&!this.canInsertSemicolon()&&this.eat(T._function))return this.overrideContext(Zt.f_expr),this.parseFunction(this.startNodeAt(s,o),0,!1,!0,t);if(r&&!this.canInsertSemicolon()){if(this.eat(T.arrow))return this.parseArrowExpression(this.startNodeAt(s,o),[l],!1,t);if(this.options.ecmaVersion>=8&&l.name==="async"&&this.type===T.name&&!a&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return l=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(T.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(s,o),[l],!0,t)}return l;case T.regexp:var u=this.value;return i=this.parseLiteral(u.value),i.regex={pattern:u.pattern,flags:u.flags},i;case T.num:case T.string:return this.parseLiteral(this.value);case T._null:case T._true:case T._false:return i=this.startNode(),i.value=this.type===T._null?null:this.type===T._true,i.raw=this.type.keyword,this.next(),this.finishNode(i,"Literal");case T.parenL:var c=this.start,d=this.parseParenAndDistinguishExpression(r,t);return e&&(e.parenthesizedAssign<0&&!this.isSimpleAssignTarget(d)&&(e.parenthesizedAssign=c),e.parenthesizedBind<0&&(e.parenthesizedBind=c)),d;case T.bracketL:return i=this.startNode(),this.next(),i.elements=this.parseExprList(T.bracketR,!0,!0,e),this.finishNode(i,"ArrayExpression");case T.braceL:return this.overrideContext(Zt.b_expr),this.parseObj(!1,e);case T._function:return i=this.startNode(),this.next(),this.parseFunction(i,0);case T._class:return this.parseClass(this.startNode(),!1);case T._new:return this.parseNew();case T.backQuote:return this.parseTemplate();case T._import:return this.options.ecmaVersion>=11?this.parseExprImport(n):this.unexpected();default:return this.parseExprAtomDefault()}};je.parseExprAtomDefault=function(){this.unexpected()};je.parseExprImport=function(e){var t=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===T.parenL&&!e)return this.parseDynamicImport(t);if(this.type===T.dot){var n=this.startNodeAt(t.start,t.loc&&t.loc.start);return n.name="import",t.meta=this.finishNode(n,"Identifier"),this.parseImportMeta(t)}else this.unexpected()};je.parseDynamicImport=function(e){if(this.next(),e.source=this.parseMaybeAssign(),this.options.ecmaVersion>=16)this.eat(T.parenR)?e.options=null:(this.expect(T.comma),this.afterTrailingComma(T.parenR)?e.options=null:(e.options=this.parseMaybeAssign(),this.eat(T.parenR)||(this.expect(T.comma),this.afterTrailingComma(T.parenR)||this.unexpected())));else if(!this.eat(T.parenR)){var t=this.start;this.eat(T.comma)&&this.eat(T.parenR)?this.raiseRecoverable(t,"Trailing comma is not allowed in import()"):this.unexpected(t)}return this.finishNode(e,"ImportExpression")};je.parseImportMeta=function(e){this.next();var t=this.containsEsc;return e.property=this.parseIdent(!0),e.property.name!=="meta"&&this.raiseRecoverable(e.property.start,"The only valid meta property for import is 'import.meta'"),t&&this.raiseRecoverable(e.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(e.start,"Cannot use 'import.meta' outside a module"),this.finishNode(e,"MetaProperty")};je.parseLiteral=function(e){var t=this.startNode();return t.value=e,t.raw=this.input.slice(this.start,this.end),t.raw.charCodeAt(t.raw.length-1)===110&&(t.bigint=t.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(t,"Literal")};je.parseParenExpression=function(){this.expect(T.parenL);var e=this.parseExpression();return this.expect(T.parenR),e};je.shouldParseArrow=function(e){return!this.canInsertSemicolon()};je.parseParenAndDistinguishExpression=function(e,t){var n=this.start,i=this.startLoc,r,s=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var o=this.start,a=this.startLoc,l=[],u=!0,c=!1,d=new yR,h=this.yieldPos,p=this.awaitPos,g;for(this.yieldPos=0,this.awaitPos=0;this.type!==T.parenR;)if(u?u=!1:this.expect(T.comma),s&&this.afterTrailingComma(T.parenR,!0)){c=!0;break}else if(this.type===T.ellipsis){g=this.start,l.push(this.parseParenItem(this.parseRestBinding())),this.type===T.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else l.push(this.parseMaybeAssign(!1,d,this.parseParenItem));var v=this.lastTokEnd,C=this.lastTokEndLoc;if(this.expect(T.parenR),e&&this.shouldParseArrow(l)&&this.eat(T.arrow))return this.checkPatternErrors(d,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=h,this.awaitPos=p,this.parseParenArrowList(n,i,l,t);(!l.length||c)&&this.unexpected(this.lastTokStart),g&&this.unexpected(g),this.checkExpressionErrors(d,!0),this.yieldPos=h||this.yieldPos,this.awaitPos=p||this.awaitPos,l.length>1?(r=this.startNodeAt(o,a),r.expressions=l,this.finishNodeAt(r,"SequenceExpression",v,C)):r=l[0]}else r=this.parseParenExpression();if(this.options.preserveParens){var y=this.startNodeAt(n,i);return y.expression=r,this.finishNode(y,"ParenthesizedExpression")}else return r};je.parseParenItem=function(e){return e};je.parseParenArrowList=function(e,t,n,i){return this.parseArrowExpression(this.startNodeAt(e,t),n,!1,i)};var m5e=[];je.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var e=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===T.dot){var t=this.startNodeAt(e.start,e.loc&&e.loc.start);t.name="new",e.meta=this.finishNode(t,"Identifier"),this.next();var n=this.containsEsc;return e.property=this.parseIdent(!0),e.property.name!=="target"&&this.raiseRecoverable(e.property.start,"The only valid meta property for new is 'new.target'"),n&&this.raiseRecoverable(e.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(e.start,"'new.target' can only be used in functions and class static block"),this.finishNode(e,"MetaProperty")}var i=this.start,r=this.startLoc;return e.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),i,r,!0,!1),this.eat(T.parenL)?e.arguments=this.parseExprList(T.parenR,this.options.ecmaVersion>=8,!1):e.arguments=m5e,this.finishNode(e,"NewExpression")};je.parseTemplateElement=function(e){var t=e.isTagged,n=this.startNode();return this.type===T.invalidTemplate?(t||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),n.value={raw:this.value.replace(/\r\n?/g,`
`),cooked:null}):n.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),n.tail=this.type===T.backQuote,this.finishNode(n,"TemplateElement")};je.parseTemplate=function(e){e===void 0&&(e={});var t=e.isTagged;t===void 0&&(t=!1);var n=this.startNode();this.next(),n.expressions=[];var i=this.parseTemplateElement({isTagged:t});for(n.quasis=[i];!i.tail;)this.type===T.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(T.dollarBraceL),n.expressions.push(this.parseExpression()),this.expect(T.braceR),n.quasis.push(i=this.parseTemplateElement({isTagged:t}));return this.next(),this.finishNode(n,"TemplateLiteral")};je.isAsyncProp=function(e){return!e.computed&&e.key.type==="Identifier"&&e.key.name==="async"&&(this.type===T.name||this.type===T.num||this.type===T.string||this.type===T.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===T.star)&&!Vs.test(this.input.slice(this.lastTokEnd,this.start))};je.parseObj=function(e,t){var n=this.startNode(),i=!0,r={};for(n.properties=[],this.next();!this.eat(T.braceR);){if(i)i=!1;else if(this.expect(T.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(T.braceR))break;var s=this.parseProperty(e,t);e||this.checkPropClash(s,r,t),n.properties.push(s)}return this.finishNode(n,e?"ObjectPattern":"ObjectExpression")};je.parseProperty=function(e,t){var n=this.startNode(),i,r,s,o;if(this.options.ecmaVersion>=9&&this.eat(T.ellipsis))return e?(n.argument=this.parseIdent(!1),this.type===T.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(n,"RestElement")):(n.argument=this.parseMaybeAssign(!1,t),this.type===T.comma&&t&&t.trailingComma<0&&(t.trailingComma=this.start),this.finishNode(n,"SpreadElement"));this.options.ecmaVersion>=6&&(n.method=!1,n.shorthand=!1,(e||t)&&(s=this.start,o=this.startLoc),e||(i=this.eat(T.star)));var a=this.containsEsc;return this.parsePropertyName(n),!e&&!a&&this.options.ecmaVersion>=8&&!i&&this.isAsyncProp(n)?(r=!0,i=this.options.ecmaVersion>=9&&this.eat(T.star),this.parsePropertyName(n)):r=!1,this.parsePropertyValue(n,e,i,r,s,o,t,a),this.finishNode(n,"Property")};je.parseGetterSetter=function(e){e.kind=e.key.name,this.parsePropertyName(e),e.value=this.parseMethod(!1);var t=e.kind==="get"?0:1;if(e.value.params.length!==t){var n=e.value.start;e.kind==="get"?this.raiseRecoverable(n,"getter should have no params"):this.raiseRecoverable(n,"setter should have exactly one param")}else e.kind==="set"&&e.value.params[0].type==="RestElement"&&this.raiseRecoverable(e.value.params[0].start,"Setter cannot use rest params")};je.parsePropertyValue=function(e,t,n,i,r,s,o,a){(n||i)&&this.type===T.colon&&this.unexpected(),this.eat(T.colon)?(e.value=t?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,o),e.kind="init"):this.options.ecmaVersion>=6&&this.type===T.parenL?(t&&this.unexpected(),e.kind="init",e.method=!0,e.value=this.parseMethod(n,i)):!t&&!a&&this.options.ecmaVersion>=5&&!e.computed&&e.key.type==="Identifier"&&(e.key.name==="get"||e.key.name==="set")&&this.type!==T.comma&&this.type!==T.braceR&&this.type!==T.eq?((n||i)&&this.unexpected(),this.parseGetterSetter(e)):this.options.ecmaVersion>=6&&!e.computed&&e.key.type==="Identifier"?((n||i)&&this.unexpected(),this.checkUnreserved(e.key),e.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=r),e.kind="init",t?e.value=this.parseMaybeDefault(r,s,this.copyNode(e.key)):this.type===T.eq&&o?(o.shorthandAssign<0&&(o.shorthandAssign=this.start),e.value=this.parseMaybeDefault(r,s,this.copyNode(e.key))):e.value=this.copyNode(e.key),e.shorthand=!0):this.unexpected()};je.parsePropertyName=function(e){if(this.options.ecmaVersion>=6){if(this.eat(T.bracketL))return e.computed=!0,e.key=this.parseMaybeAssign(),this.expect(T.bracketR),e.key;e.computed=!1}return e.key=this.type===T.num||this.type===T.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")};je.initFunction=function(e){e.id=null,this.options.ecmaVersion>=6&&(e.generator=e.expression=!1),this.options.ecmaVersion>=8&&(e.async=!1)};je.parseMethod=function(e,t,n){var i=this.startNode(),r=this.yieldPos,s=this.awaitPos,o=this.awaitIdentPos;return this.initFunction(i),this.options.ecmaVersion>=6&&(i.generator=e),this.options.ecmaVersion>=8&&(i.async=!!t),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(ML(t,i.generator)|kL|(n?bZ:0)),this.expect(T.parenL),i.params=this.parseBindingList(T.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(i,!1,!0,!1),this.yieldPos=r,this.awaitPos=s,this.awaitIdentPos=o,this.finishNode(i,"FunctionExpression")};je.parseArrowExpression=function(e,t,n,i){var r=this.yieldPos,s=this.awaitPos,o=this.awaitIdentPos;return this.enterScope(ML(n,!1)|yZ),this.initFunction(e),this.options.ecmaVersion>=8&&(e.async=!!n),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,e.params=this.toAssignableList(t,!0),this.parseFunctionBody(e,!0,!1,i),this.yieldPos=r,this.awaitPos=s,this.awaitIdentPos=o,this.finishNode(e,"ArrowFunctionExpression")};je.parseFunctionBody=function(e,t,n,i){var r=t&&this.type!==T.braceL,s=this.strict,o=!1;if(r)e.body=this.parseMaybeAssign(i),e.expression=!0,this.checkParams(e,!1);else{var a=this.options.ecmaVersion>=7&&!this.isSimpleParamList(e.params);(!s||a)&&(o=this.strictDirective(this.end),o&&a&&this.raiseRecoverable(e.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var l=this.labels;this.labels=[],o&&(this.strict=!0),this.checkParams(e,!s&&!o&&!t&&!n&&this.isSimpleParamList(e.params)),this.strict&&e.id&&this.checkLValSimple(e.id,RZ),e.body=this.parseBlock(!1,void 0,o&&!s),e.expression=!1,this.adaptDirectivePrologue(e.body.body),this.labels=l}this.exitScope()};je.isSimpleParamList=function(e){for(var t=0,n=e;t<n.length;t+=1){var i=n[t];if(i.type!=="Identifier")return!1}return!0};je.checkParams=function(e,t){for(var n=Object.create(null),i=0,r=e.params;i<r.length;i+=1){var s=r[i];this.checkLValInnerPattern(s,IL,t?null:n)}};je.parseExprList=function(e,t,n,i){for(var r=[],s=!0;!this.eat(e);){if(s)s=!1;else if(this.expect(T.comma),t&&this.afterTrailingComma(e))break;var o=void 0;n&&this.type===T.comma?o=null:this.type===T.ellipsis?(o=this.parseSpread(i),i&&this.type===T.comma&&i.trailingComma<0&&(i.trailingComma=this.start)):o=this.parseMaybeAssign(!1,i),r.push(o)}return r};je.checkUnreserved=function(e){var t=e.start,n=e.end,i=e.name;if(this.inGenerator&&i==="yield"&&this.raiseRecoverable(t,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&i==="await"&&this.raiseRecoverable(t,"Cannot use 'await' as identifier inside an async function"),this.currentThisScope().inClassFieldInit&&i==="arguments"&&this.raiseRecoverable(t,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(i==="arguments"||i==="await")&&this.raise(t,"Cannot use "+i+" in class static initialization block"),this.keywords.test(i)&&this.raise(t,"Unexpected keyword '"+i+"'"),!(this.options.ecmaVersion<6&&this.input.slice(t,n).indexOf("\\")!==-1)){var r=this.strict?this.reservedWordsStrict:this.reservedWords;r.test(i)&&(!this.inAsync&&i==="await"&&this.raiseRecoverable(t,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(t,"The keyword '"+i+"' is reserved"))}};je.parseIdent=function(e){var t=this.parseIdentNode();return this.next(!!e),this.finishNode(t,"Identifier"),e||(this.checkUnreserved(t),t.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=t.start)),t};je.parseIdentNode=function(){var e=this.startNode();return this.type===T.name?e.name=this.value:this.type.keyword?(e.name=this.type.keyword,(e.name==="class"||e.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=T.name):this.unexpected(),e};je.parsePrivateIdent=function(){var e=this.startNode();return this.type===T.privateId?e.name=this.value:this.unexpected(),this.next(),this.finishNode(e,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(e.start,"Private field '#"+e.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(e)),e};je.parseYield=function(e){this.yieldPos||(this.yieldPos=this.start);var t=this.startNode();return this.next(),this.type===T.semi||this.canInsertSemicolon()||this.type!==T.star&&!this.type.startsExpr?(t.delegate=!1,t.argument=null):(t.delegate=this.eat(T.star),t.argument=this.parseMaybeAssign(e)),this.finishNode(t,"YieldExpression")};je.parseAwait=function(e){this.awaitPos||(this.awaitPos=this.start);var t=this.startNode();return this.next(),t.argument=this.parseMaybeUnary(null,!0,!1,e),this.finishNode(t,"AwaitExpression")};var LS=Hn.prototype;LS.raise=function(e,t){var n=vZ(this.input,e);t+=" ("+n.line+":"+n.column+")";var i=new SyntaxError(t);throw i.pos=e,i.loc=n,i.raisedAt=this.pos,i};LS.raiseRecoverable=LS.raise;LS.curPosition=function(){if(this.options.locations)return new Jv(this.curLine,this.pos-this.lineStart)};var Fc=Hn.prototype,v5e=function(t){this.flags=t,this.var=[],this.lexical=[],this.functions=[],this.inClassFieldInit=!1};Fc.enterScope=function(e){this.scopeStack.push(new v5e(e))};Fc.exitScope=function(){this.scopeStack.pop()};Fc.treatFunctionsAsVarInScope=function(e){return e.flags&dg||!this.inModule&&e.flags&Zv};Fc.declareName=function(e,t,n){var i=!1;if(t===Jl){var r=this.currentScope();i=r.lexical.indexOf(e)>-1||r.functions.indexOf(e)>-1||r.var.indexOf(e)>-1,r.lexical.push(e),this.inModule&&r.flags&Zv&&delete this.undefinedExports[e]}else if(t===xZ){var s=this.currentScope();s.lexical.push(e)}else if(t===SZ){var o=this.currentScope();this.treatFunctionsAsVar?i=o.lexical.indexOf(e)>-1:i=o.lexical.indexOf(e)>-1||o.var.indexOf(e)>-1,o.functions.push(e)}else for(var a=this.scopeStack.length-1;a>=0;--a){var l=this.scopeStack[a];if(l.lexical.indexOf(e)>-1&&!(l.flags&wZ&&l.lexical[0]===e)||!this.treatFunctionsAsVarInScope(l)&&l.functions.indexOf(e)>-1){i=!0;break}if(l.var.push(e),this.inModule&&l.flags&Zv&&delete this.undefinedExports[e],l.flags&TL)break}i&&this.raiseRecoverable(n,"Identifier '"+e+"' has already been declared")};Fc.checkLocalExport=function(e){this.scopeStack[0].lexical.indexOf(e.name)===-1&&this.scopeStack[0].var.indexOf(e.name)===-1&&(this.undefinedExports[e.name]=e)};Fc.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]};Fc.currentVarScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(t.flags&TL)return t}};Fc.currentThisScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(t.flags&TL&&!(t.flags&yZ))return t}};var wR=function(t,n,i){this.type="",this.start=n,this.end=0,t.options.locations&&(this.loc=new CR(t,i)),t.options.directSourceFile&&(this.sourceFile=t.options.directSourceFile),t.options.ranges&&(this.range=[n,0])},pC=Hn.prototype;pC.startNode=function(){return new wR(this,this.start,this.startLoc)};pC.startNodeAt=function(e,t){return new wR(this,e,t)};function AZ(e,t,n,i){return e.type=t,e.end=n,this.options.locations&&(e.loc.end=i),this.options.ranges&&(e.range[1]=n),e}pC.finishNode=function(e,t){return AZ.call(this,e,t,this.lastTokEnd,this.lastTokEndLoc)};pC.finishNodeAt=function(e,t,n,i){return AZ.call(this,e,t,n,i)};pC.copyNode=function(e){var t=new wR(this,e.start,this.startLoc);for(var n in e)t[n]=e[n];return t};var C5e="Gara Garay Gukh Gurung_Khema Hrkt Katakana_Or_Hiragana Kawi Kirat_Rai Krai Nag_Mundari Nagm Ol_Onal Onao Sunu Sunuwar Todhri Todr Tulu_Tigalari Tutg Unknown Zzzz",DZ="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",PZ=DZ+" Extended_Pictographic",kZ=PZ,TZ=kZ+" EBase EComp EMod EPres ExtPict",MZ=TZ,y5e=MZ,w5e={9:DZ,10:PZ,11:kZ,12:TZ,13:MZ,14:y5e},b5e="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",S5e={9:"",10:"",11:"",12:"",13:"",14:b5e},p6="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",IZ="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",_Z=IZ+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",OZ=_Z+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",LZ=OZ+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",NZ=LZ+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",x5e=NZ+" "+C5e,R5e={9:IZ,10:_Z,11:OZ,12:LZ,13:NZ,14:x5e},$Z={};function E5e(e){var t=$Z[e]={binary:_u(w5e[e]+" "+p6),binaryOfStrings:_u(S5e[e]),nonBinary:{General_Category:_u(p6),Script:_u(R5e[e])}};t.nonBinary.Script_Extensions=t.nonBinary.Script,t.nonBinary.gc=t.nonBinary.General_Category,t.nonBinary.sc=t.nonBinary.Script,t.nonBinary.scx=t.nonBinary.Script_Extensions}for(var rD=0,g6=[9,10,11,12,13,14];rD<g6.length;rD+=1){var F5e=g6[rD];E5e(F5e)}var De=Hn.prototype,NS=function(t,n){this.parent=t,this.base=n||this};NS.prototype.separatedFrom=function(t){for(var n=this;n;n=n.parent)for(var i=t;i;i=i.parent)if(n.base===i.base&&n!==i)return!0;return!1};NS.prototype.sibling=function(){return new NS(this.parent,this.base)};var Ba=function(t){this.parser=t,this.validFlags="gim"+(t.options.ecmaVersion>=6?"uy":"")+(t.options.ecmaVersion>=9?"s":"")+(t.options.ecmaVersion>=13?"d":"")+(t.options.ecmaVersion>=15?"v":""),this.unicodeProperties=$Z[t.options.ecmaVersion>=14?14:t.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=Object.create(null),this.backReferenceNames=[],this.branchID=null};Ba.prototype.reset=function(t,n,i){var r=i.indexOf("v")!==-1,s=i.indexOf("u")!==-1;this.start=t|0,this.source=n+"",this.flags=i,r&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=s&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=s&&this.parser.options.ecmaVersion>=9)};Ba.prototype.raise=function(t){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+t)};Ba.prototype.at=function(t,n){n===void 0&&(n=!1);var i=this.source,r=i.length;if(t>=r)return-1;var s=i.charCodeAt(t);if(!(n||this.switchU)||s<=55295||s>=57344||t+1>=r)return s;var o=i.charCodeAt(t+1);return o>=56320&&o<=57343?(s<<10)+o-56613888:s};Ba.prototype.nextIndex=function(t,n){n===void 0&&(n=!1);var i=this.source,r=i.length;if(t>=r)return r;var s=i.charCodeAt(t),o;return!(n||this.switchU)||s<=55295||s>=57344||t+1>=r||(o=i.charCodeAt(t+1))<56320||o>57343?t+1:t+2};Ba.prototype.current=function(t){return t===void 0&&(t=!1),this.at(this.pos,t)};Ba.prototype.lookahead=function(t){return t===void 0&&(t=!1),this.at(this.nextIndex(this.pos,t),t)};Ba.prototype.advance=function(t){t===void 0&&(t=!1),this.pos=this.nextIndex(this.pos,t)};Ba.prototype.eat=function(t,n){return n===void 0&&(n=!1),this.current(n)===t?(this.advance(n),!0):!1};Ba.prototype.eatChars=function(t,n){n===void 0&&(n=!1);for(var i=this.pos,r=0,s=t;r<s.length;r+=1){var o=s[r],a=this.at(i,n);if(a===-1||a!==o)return!1;i=this.nextIndex(i,n)}return this.pos=i,!0};De.validateRegExpFlags=function(e){for(var t=e.validFlags,n=e.flags,i=!1,r=!1,s=0;s<n.length;s++){var o=n.charAt(s);t.indexOf(o)===-1&&this.raise(e.start,"Invalid regular expression flag"),n.indexOf(o,s+1)>-1&&this.raise(e.start,"Duplicate regular expression flag"),o==="u"&&(i=!0),o==="v"&&(r=!0)}this.options.ecmaVersion>=15&&i&&r&&this.raise(e.start,"Invalid regular expression flag")};function A5e(e){for(var t in e)return!0;return!1}De.validateRegExpPattern=function(e){this.regexp_pattern(e),!e.switchN&&this.options.ecmaVersion>=9&&A5e(e.groupNames)&&(e.switchN=!0,this.regexp_pattern(e))};De.regexp_pattern=function(e){e.pos=0,e.lastIntValue=0,e.lastStringValue="",e.lastAssertionIsQuantifiable=!1,e.numCapturingParens=0,e.maxBackReference=0,e.groupNames=Object.create(null),e.backReferenceNames.length=0,e.branchID=null,this.regexp_disjunction(e),e.pos!==e.source.length&&(e.eat(41)&&e.raise("Unmatched ')'"),(e.eat(93)||e.eat(125))&&e.raise("Lone quantifier brackets")),e.maxBackReference>e.numCapturingParens&&e.raise("Invalid escape");for(var t=0,n=e.backReferenceNames;t<n.length;t+=1){var i=n[t];e.groupNames[i]||e.raise("Invalid named capture referenced")}};De.regexp_disjunction=function(e){var t=this.options.ecmaVersion>=16;for(t&&(e.branchID=new NS(e.branchID,null)),this.regexp_alternative(e);e.eat(124);)t&&(e.branchID=e.branchID.sibling()),this.regexp_alternative(e);t&&(e.branchID=e.branchID.parent),this.regexp_eatQuantifier(e,!0)&&e.raise("Nothing to repeat"),e.eat(123)&&e.raise("Lone quantifier brackets")};De.regexp_alternative=function(e){for(;e.pos<e.source.length&&this.regexp_eatTerm(e););};De.regexp_eatTerm=function(e){return this.regexp_eatAssertion(e)?(e.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(e)&&e.switchU&&e.raise("Invalid quantifier"),!0):(e.switchU?this.regexp_eatAtom(e):this.regexp_eatExtendedAtom(e))?(this.regexp_eatQuantifier(e),!0):!1};De.regexp_eatAssertion=function(e){var t=e.pos;if(e.lastAssertionIsQuantifiable=!1,e.eat(94)||e.eat(36))return!0;if(e.eat(92)){if(e.eat(66)||e.eat(98))return!0;e.pos=t}if(e.eat(40)&&e.eat(63)){var n=!1;if(this.options.ecmaVersion>=9&&(n=e.eat(60)),e.eat(61)||e.eat(33))return this.regexp_disjunction(e),e.eat(41)||e.raise("Unterminated group"),e.lastAssertionIsQuantifiable=!n,!0}return e.pos=t,!1};De.regexp_eatQuantifier=function(e,t){return t===void 0&&(t=!1),this.regexp_eatQuantifierPrefix(e,t)?(e.eat(63),!0):!1};De.regexp_eatQuantifierPrefix=function(e,t){return e.eat(42)||e.eat(43)||e.eat(63)||this.regexp_eatBracedQuantifier(e,t)};De.regexp_eatBracedQuantifier=function(e,t){var n=e.pos;if(e.eat(123)){var i=0,r=-1;if(this.regexp_eatDecimalDigits(e)&&(i=e.lastIntValue,e.eat(44)&&this.regexp_eatDecimalDigits(e)&&(r=e.lastIntValue),e.eat(125)))return r!==-1&&r<i&&!t&&e.raise("numbers out of order in {} quantifier"),!0;e.switchU&&!t&&e.raise("Incomplete quantifier"),e.pos=n}return!1};De.regexp_eatAtom=function(e){return this.regexp_eatPatternCharacters(e)||e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)};De.regexp_eatReverseSolidusAtomEscape=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatAtomEscape(e))return!0;e.pos=t}return!1};De.regexp_eatUncapturingGroup=function(e){var t=e.pos;if(e.eat(40)){if(e.eat(63)){if(this.options.ecmaVersion>=16){var n=this.regexp_eatModifiers(e),i=e.eat(45);if(n||i){for(var r=0;r<n.length;r++){var s=n.charAt(r);n.indexOf(s,r+1)>-1&&e.raise("Duplicate regular expression modifiers")}if(i){var o=this.regexp_eatModifiers(e);!n&&!o&&e.current()===58&&e.raise("Invalid regular expression modifiers");for(var a=0;a<o.length;a++){var l=o.charAt(a);(o.indexOf(l,a+1)>-1||n.indexOf(l)>-1)&&e.raise("Duplicate regular expression modifiers")}}}}if(e.eat(58)){if(this.regexp_disjunction(e),e.eat(41))return!0;e.raise("Unterminated group")}}e.pos=t}return!1};De.regexp_eatCapturingGroup=function(e){if(e.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(e):e.current()===63&&e.raise("Invalid group"),this.regexp_disjunction(e),e.eat(41))return e.numCapturingParens+=1,!0;e.raise("Unterminated group")}return!1};De.regexp_eatModifiers=function(e){for(var t="",n=0;(n=e.current())!==-1&&D5e(n);)t+=Ll(n),e.advance();return t};function D5e(e){return e===105||e===109||e===115}De.regexp_eatExtendedAtom=function(e){return e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)||this.regexp_eatInvalidBracedQuantifier(e)||this.regexp_eatExtendedPatternCharacter(e)};De.regexp_eatInvalidBracedQuantifier=function(e){return this.regexp_eatBracedQuantifier(e,!0)&&e.raise("Nothing to repeat"),!1};De.regexp_eatSyntaxCharacter=function(e){var t=e.current();return BZ(t)?(e.lastIntValue=t,e.advance(),!0):!1};function BZ(e){return e===36||e>=40&&e<=43||e===46||e===63||e>=91&&e<=94||e>=123&&e<=125}De.regexp_eatPatternCharacters=function(e){for(var t=e.pos,n=0;(n=e.current())!==-1&&!BZ(n);)e.advance();return e.pos!==t};De.regexp_eatExtendedPatternCharacter=function(e){var t=e.current();return t!==-1&&t!==36&&!(t>=40&&t<=43)&&t!==46&&t!==63&&t!==91&&t!==94&&t!==124?(e.advance(),!0):!1};De.regexp_groupSpecifier=function(e){if(e.eat(63)){this.regexp_eatGroupName(e)||e.raise("Invalid group");var t=this.options.ecmaVersion>=16,n=e.groupNames[e.lastStringValue];if(n)if(t)for(var i=0,r=n;i<r.length;i+=1){var s=r[i];s.separatedFrom(e.branchID)||e.raise("Duplicate capture group name")}else e.raise("Duplicate capture group name");t?(n||(e.groupNames[e.lastStringValue]=[])).push(e.branchID):e.groupNames[e.lastStringValue]=!0}};De.regexp_eatGroupName=function(e){if(e.lastStringValue="",e.eat(60)){if(this.regexp_eatRegExpIdentifierName(e)&&e.eat(62))return!0;e.raise("Invalid capture group name")}return!1};De.regexp_eatRegExpIdentifierName=function(e){if(e.lastStringValue="",this.regexp_eatRegExpIdentifierStart(e)){for(e.lastStringValue+=Ll(e.lastIntValue);this.regexp_eatRegExpIdentifierPart(e);)e.lastStringValue+=Ll(e.lastIntValue);return!0}return!1};De.regexp_eatRegExpIdentifierStart=function(e){var t=e.pos,n=this.options.ecmaVersion>=11,i=e.current(n);return e.advance(n),i===92&&this.regexp_eatRegExpUnicodeEscapeSequence(e,n)&&(i=e.lastIntValue),P5e(i)?(e.lastIntValue=i,!0):(e.pos=t,!1)};function P5e(e){return Ol(e,!0)||e===36||e===95}De.regexp_eatRegExpIdentifierPart=function(e){var t=e.pos,n=this.options.ecmaVersion>=11,i=e.current(n);return e.advance(n),i===92&&this.regexp_eatRegExpUnicodeEscapeSequence(e,n)&&(i=e.lastIntValue),k5e(i)?(e.lastIntValue=i,!0):(e.pos=t,!1)};function k5e(e){return bp(e,!0)||e===36||e===95||e===8204||e===8205}De.regexp_eatAtomEscape=function(e){return this.regexp_eatBackReference(e)||this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)||e.switchN&&this.regexp_eatKGroupName(e)?!0:(e.switchU&&(e.current()===99&&e.raise("Invalid unicode escape"),e.raise("Invalid escape")),!1)};De.regexp_eatBackReference=function(e){var t=e.pos;if(this.regexp_eatDecimalEscape(e)){var n=e.lastIntValue;if(e.switchU)return n>e.maxBackReference&&(e.maxBackReference=n),!0;if(n<=e.numCapturingParens)return!0;e.pos=t}return!1};De.regexp_eatKGroupName=function(e){if(e.eat(107)){if(this.regexp_eatGroupName(e))return e.backReferenceNames.push(e.lastStringValue),!0;e.raise("Invalid named reference")}return!1};De.regexp_eatCharacterEscape=function(e){return this.regexp_eatControlEscape(e)||this.regexp_eatCControlLetter(e)||this.regexp_eatZero(e)||this.regexp_eatHexEscapeSequence(e)||this.regexp_eatRegExpUnicodeEscapeSequence(e,!1)||!e.switchU&&this.regexp_eatLegacyOctalEscapeSequence(e)||this.regexp_eatIdentityEscape(e)};De.regexp_eatCControlLetter=function(e){var t=e.pos;if(e.eat(99)){if(this.regexp_eatControlLetter(e))return!0;e.pos=t}return!1};De.regexp_eatZero=function(e){return e.current()===48&&!bR(e.lookahead())?(e.lastIntValue=0,e.advance(),!0):!1};De.regexp_eatControlEscape=function(e){var t=e.current();return t===116?(e.lastIntValue=9,e.advance(),!0):t===110?(e.lastIntValue=10,e.advance(),!0):t===118?(e.lastIntValue=11,e.advance(),!0):t===102?(e.lastIntValue=12,e.advance(),!0):t===114?(e.lastIntValue=13,e.advance(),!0):!1};De.regexp_eatControlLetter=function(e){var t=e.current();return GZ(t)?(e.lastIntValue=t%32,e.advance(),!0):!1};function GZ(e){return e>=65&&e<=90||e>=97&&e<=122}De.regexp_eatRegExpUnicodeEscapeSequence=function(e,t){t===void 0&&(t=!1);var n=e.pos,i=t||e.switchU;if(e.eat(117)){if(this.regexp_eatFixedHexDigits(e,4)){var r=e.lastIntValue;if(i&&r>=55296&&r<=56319){var s=e.pos;if(e.eat(92)&&e.eat(117)&&this.regexp_eatFixedHexDigits(e,4)){var o=e.lastIntValue;if(o>=56320&&o<=57343)return e.lastIntValue=(r-55296)*1024+(o-56320)+65536,!0}e.pos=s,e.lastIntValue=r}return!0}if(i&&e.eat(123)&&this.regexp_eatHexDigits(e)&&e.eat(125)&&T5e(e.lastIntValue))return!0;i&&e.raise("Invalid unicode escape"),e.pos=n}return!1};function T5e(e){return e>=0&&e<=1114111}De.regexp_eatIdentityEscape=function(e){if(e.switchU)return this.regexp_eatSyntaxCharacter(e)?!0:e.eat(47)?(e.lastIntValue=47,!0):!1;var t=e.current();return t!==99&&(!e.switchN||t!==107)?(e.lastIntValue=t,e.advance(),!0):!1};De.regexp_eatDecimalEscape=function(e){e.lastIntValue=0;var t=e.current();if(t>=49&&t<=57){do e.lastIntValue=10*e.lastIntValue+(t-48),e.advance();while((t=e.current())>=48&&t<=57);return!0}return!1};var zZ=0,Nl=1,bs=2;De.regexp_eatCharacterClassEscape=function(e){var t=e.current();if(M5e(t))return e.lastIntValue=-1,e.advance(),Nl;var n=!1;if(e.switchU&&this.options.ecmaVersion>=9&&((n=t===80)||t===112)){e.lastIntValue=-1,e.advance();var i;if(e.eat(123)&&(i=this.regexp_eatUnicodePropertyValueExpression(e))&&e.eat(125))return n&&i===bs&&e.raise("Invalid property name"),i;e.raise("Invalid property name")}return zZ};function M5e(e){return e===100||e===68||e===115||e===83||e===119||e===87}De.regexp_eatUnicodePropertyValueExpression=function(e){var t=e.pos;if(this.regexp_eatUnicodePropertyName(e)&&e.eat(61)){var n=e.lastStringValue;if(this.regexp_eatUnicodePropertyValue(e)){var i=e.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(e,n,i),Nl}}if(e.pos=t,this.regexp_eatLoneUnicodePropertyNameOrValue(e)){var r=e.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(e,r)}return zZ};De.regexp_validateUnicodePropertyNameAndValue=function(e,t,n){cg(e.unicodeProperties.nonBinary,t)||e.raise("Invalid property name"),e.unicodeProperties.nonBinary[t].test(n)||e.raise("Invalid property value")};De.regexp_validateUnicodePropertyNameOrValue=function(e,t){if(e.unicodeProperties.binary.test(t))return Nl;if(e.switchV&&e.unicodeProperties.binaryOfStrings.test(t))return bs;e.raise("Invalid property name")};De.regexp_eatUnicodePropertyName=function(e){var t=0;for(e.lastStringValue="";HZ(t=e.current());)e.lastStringValue+=Ll(t),e.advance();return e.lastStringValue!==""};function HZ(e){return GZ(e)||e===95}De.regexp_eatUnicodePropertyValue=function(e){var t=0;for(e.lastStringValue="";I5e(t=e.current());)e.lastStringValue+=Ll(t),e.advance();return e.lastStringValue!==""};function I5e(e){return HZ(e)||bR(e)}De.regexp_eatLoneUnicodePropertyNameOrValue=function(e){return this.regexp_eatUnicodePropertyValue(e)};De.regexp_eatCharacterClass=function(e){if(e.eat(91)){var t=e.eat(94),n=this.regexp_classContents(e);return e.eat(93)||e.raise("Unterminated character class"),t&&n===bs&&e.raise("Negated character class may contain strings"),!0}return!1};De.regexp_classContents=function(e){return e.current()===93?Nl:e.switchV?this.regexp_classSetExpression(e):(this.regexp_nonEmptyClassRanges(e),Nl)};De.regexp_nonEmptyClassRanges=function(e){for(;this.regexp_eatClassAtom(e);){var t=e.lastIntValue;if(e.eat(45)&&this.regexp_eatClassAtom(e)){var n=e.lastIntValue;e.switchU&&(t===-1||n===-1)&&e.raise("Invalid character class"),t!==-1&&n!==-1&&t>n&&e.raise("Range out of order in character class")}}};De.regexp_eatClassAtom=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatClassEscape(e))return!0;if(e.switchU){var n=e.current();(n===99||UZ(n))&&e.raise("Invalid class escape"),e.raise("Invalid escape")}e.pos=t}var i=e.current();return i!==93?(e.lastIntValue=i,e.advance(),!0):!1};De.regexp_eatClassEscape=function(e){var t=e.pos;if(e.eat(98))return e.lastIntValue=8,!0;if(e.switchU&&e.eat(45))return e.lastIntValue=45,!0;if(!e.switchU&&e.eat(99)){if(this.regexp_eatClassControlLetter(e))return!0;e.pos=t}return this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)};De.regexp_classSetExpression=function(e){var t=Nl,n;if(!this.regexp_eatClassSetRange(e))if(n=this.regexp_eatClassSetOperand(e)){n===bs&&(t=bs);for(var i=e.pos;e.eatChars([38,38]);){if(e.current()!==38&&(n=this.regexp_eatClassSetOperand(e))){n!==bs&&(t=Nl);continue}e.raise("Invalid character in character class")}if(i!==e.pos)return t;for(;e.eatChars([45,45]);)this.regexp_eatClassSetOperand(e)||e.raise("Invalid character in character class");if(i!==e.pos)return t}else e.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(e)){if(n=this.regexp_eatClassSetOperand(e),!n)return t;n===bs&&(t=bs)}};De.regexp_eatClassSetRange=function(e){var t=e.pos;if(this.regexp_eatClassSetCharacter(e)){var n=e.lastIntValue;if(e.eat(45)&&this.regexp_eatClassSetCharacter(e)){var i=e.lastIntValue;return n!==-1&&i!==-1&&n>i&&e.raise("Range out of order in character class"),!0}e.pos=t}return!1};De.regexp_eatClassSetOperand=function(e){return this.regexp_eatClassSetCharacter(e)?Nl:this.regexp_eatClassStringDisjunction(e)||this.regexp_eatNestedClass(e)};De.regexp_eatNestedClass=function(e){var t=e.pos;if(e.eat(91)){var n=e.eat(94),i=this.regexp_classContents(e);if(e.eat(93))return n&&i===bs&&e.raise("Negated character class may contain strings"),i;e.pos=t}if(e.eat(92)){var r=this.regexp_eatCharacterClassEscape(e);if(r)return r;e.pos=t}return null};De.regexp_eatClassStringDisjunction=function(e){var t=e.pos;if(e.eatChars([92,113])){if(e.eat(123)){var n=this.regexp_classStringDisjunctionContents(e);if(e.eat(125))return n}else e.raise("Invalid escape");e.pos=t}return null};De.regexp_classStringDisjunctionContents=function(e){for(var t=this.regexp_classString(e);e.eat(124);)this.regexp_classString(e)===bs&&(t=bs);return t};De.regexp_classString=function(e){for(var t=0;this.regexp_eatClassSetCharacter(e);)t++;return t===1?Nl:bs};De.regexp_eatClassSetCharacter=function(e){var t=e.pos;if(e.eat(92))return this.regexp_eatCharacterEscape(e)||this.regexp_eatClassSetReservedPunctuator(e)?!0:e.eat(98)?(e.lastIntValue=8,!0):(e.pos=t,!1);var n=e.current();return n<0||n===e.lookahead()&&_5e(n)||O5e(n)?!1:(e.advance(),e.lastIntValue=n,!0)};function _5e(e){return e===33||e>=35&&e<=38||e>=42&&e<=44||e===46||e>=58&&e<=64||e===94||e===96||e===126}function O5e(e){return e===40||e===41||e===45||e===47||e>=91&&e<=93||e>=123&&e<=125}De.regexp_eatClassSetReservedPunctuator=function(e){var t=e.current();return L5e(t)?(e.lastIntValue=t,e.advance(),!0):!1};function L5e(e){return e===33||e===35||e===37||e===38||e===44||e===45||e>=58&&e<=62||e===64||e===96||e===126}De.regexp_eatClassControlLetter=function(e){var t=e.current();return bR(t)||t===95?(e.lastIntValue=t%32,e.advance(),!0):!1};De.regexp_eatHexEscapeSequence=function(e){var t=e.pos;if(e.eat(120)){if(this.regexp_eatFixedHexDigits(e,2))return!0;e.switchU&&e.raise("Invalid escape"),e.pos=t}return!1};De.regexp_eatDecimalDigits=function(e){var t=e.pos,n=0;for(e.lastIntValue=0;bR(n=e.current());)e.lastIntValue=10*e.lastIntValue+(n-48),e.advance();return e.pos!==t};function bR(e){return e>=48&&e<=57}De.regexp_eatHexDigits=function(e){var t=e.pos,n=0;for(e.lastIntValue=0;VZ(n=e.current());)e.lastIntValue=16*e.lastIntValue+WZ(n),e.advance();return e.pos!==t};function VZ(e){return e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102}function WZ(e){return e>=65&&e<=70?10+(e-65):e>=97&&e<=102?10+(e-97):e-48}De.regexp_eatLegacyOctalEscapeSequence=function(e){if(this.regexp_eatOctalDigit(e)){var t=e.lastIntValue;if(this.regexp_eatOctalDigit(e)){var n=e.lastIntValue;t<=3&&this.regexp_eatOctalDigit(e)?e.lastIntValue=t*64+n*8+e.lastIntValue:e.lastIntValue=t*8+n}else e.lastIntValue=t;return!0}return!1};De.regexp_eatOctalDigit=function(e){var t=e.current();return UZ(t)?(e.lastIntValue=t-48,e.advance(),!0):(e.lastIntValue=0,!1)};function UZ(e){return e>=48&&e<=55}De.regexp_eatFixedHexDigits=function(e,t){var n=e.pos;e.lastIntValue=0;for(var i=0;i<t;++i){var r=e.current();if(!VZ(r))return e.pos=n,!1;e.lastIntValue=16*e.lastIntValue+WZ(r),e.advance()}return!0};var OL=function(t){this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new CR(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])},dt=Hn.prototype;dt.next=function(e){!e&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new OL(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()};dt.getToken=function(){return this.next(),new OL(this)};typeof Symbol<"u"&&(dt[Symbol.iterator]=function(){var e=this;return{next:function(){var t=e.getToken();return{done:t.type===T.eof,value:t}}}});dt.nextToken=function(){var e=this.curContext();if((!e||!e.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(T.eof);if(e.override)return e.override(this);this.readToken(this.fullCharCodeAtPos())};dt.readToken=function(e){return Ol(e,this.options.ecmaVersion>=6)||e===92?this.readWord():this.getTokenFromCode(e)};dt.fullCharCodeAtPos=function(){var e=this.input.charCodeAt(this.pos);if(e<=55295||e>=56320)return e;var t=this.input.charCodeAt(this.pos+1);return t<=56319||t>=57344?e:(e<<10)+t-56613888};dt.skipBlockComment=function(){var e=this.options.onComment&&this.curPosition(),t=this.pos,n=this.input.indexOf("*/",this.pos+=2);if(n===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=n+2,this.options.locations)for(var i=void 0,r=t;(i=pZ(this.input,r,this.pos))>-1;)++this.curLine,r=this.lineStart=i;this.options.onComment&&this.options.onComment(!0,this.input.slice(t+2,n),t,this.pos,e,this.curPosition())};dt.skipLineComment=function(e){for(var t=this.pos,n=this.options.onComment&&this.curPosition(),i=this.input.charCodeAt(this.pos+=e);this.pos<this.input.length&&!ug(i);)i=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(t+e,this.pos),t,this.pos,n,this.curPosition())};dt.skipSpace=function(){e:for(;this.pos<this.input.length;){var e=this.input.charCodeAt(this.pos);switch(e){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(e>8&&e<14||e>=5760&&gZ.test(String.fromCharCode(e)))++this.pos;else break e}}};dt.finishToken=function(e,t){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var n=this.type;this.type=e,this.value=t,this.updateContext(n)};dt.readToken_dot=function(){var e=this.input.charCodeAt(this.pos+1);if(e>=48&&e<=57)return this.readNumber(!0);var t=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&e===46&&t===46?(this.pos+=3,this.finishToken(T.ellipsis)):(++this.pos,this.finishToken(T.dot))};dt.readToken_slash=function(){var e=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):e===61?this.finishOp(T.assign,2):this.finishOp(T.slash,1)};dt.readToken_mult_modulo_exp=function(e){var t=this.input.charCodeAt(this.pos+1),n=1,i=e===42?T.star:T.modulo;return this.options.ecmaVersion>=7&&e===42&&t===42&&(++n,i=T.starstar,t=this.input.charCodeAt(this.pos+2)),t===61?this.finishOp(T.assign,n+1):this.finishOp(i,n)};dt.readToken_pipe_amp=function(e){var t=this.input.charCodeAt(this.pos+1);if(t===e){if(this.options.ecmaVersion>=12){var n=this.input.charCodeAt(this.pos+2);if(n===61)return this.finishOp(T.assign,3)}return this.finishOp(e===124?T.logicalOR:T.logicalAND,2)}return t===61?this.finishOp(T.assign,2):this.finishOp(e===124?T.bitwiseOR:T.bitwiseAND,1)};dt.readToken_caret=function(){var e=this.input.charCodeAt(this.pos+1);return e===61?this.finishOp(T.assign,2):this.finishOp(T.bitwiseXOR,1)};dt.readToken_plus_min=function(e){var t=this.input.charCodeAt(this.pos+1);return t===e?t===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||Vs.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(T.incDec,2):t===61?this.finishOp(T.assign,2):this.finishOp(T.plusMin,1)};dt.readToken_lt_gt=function(e){var t=this.input.charCodeAt(this.pos+1),n=1;return t===e?(n=e===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+n)===61?this.finishOp(T.assign,n+1):this.finishOp(T.bitShift,n)):t===33&&e===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(t===61&&(n=2),this.finishOp(T.relational,n))};dt.readToken_eq_excl=function(e){var t=this.input.charCodeAt(this.pos+1);return t===61?this.finishOp(T.equality,this.input.charCodeAt(this.pos+2)===61?3:2):e===61&&t===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(T.arrow)):this.finishOp(e===61?T.eq:T.prefix,1)};dt.readToken_question=function(){var e=this.options.ecmaVersion;if(e>=11){var t=this.input.charCodeAt(this.pos+1);if(t===46){var n=this.input.charCodeAt(this.pos+2);if(n<48||n>57)return this.finishOp(T.questionDot,2)}if(t===63){if(e>=12){var i=this.input.charCodeAt(this.pos+2);if(i===61)return this.finishOp(T.assign,3)}return this.finishOp(T.coalesce,2)}}return this.finishOp(T.question,1)};dt.readToken_numberSign=function(){var e=this.options.ecmaVersion,t=35;if(e>=13&&(++this.pos,t=this.fullCharCodeAtPos(),Ol(t,!0)||t===92))return this.finishToken(T.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+Ll(t)+"'")};dt.getTokenFromCode=function(e){switch(e){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(T.parenL);case 41:return++this.pos,this.finishToken(T.parenR);case 59:return++this.pos,this.finishToken(T.semi);case 44:return++this.pos,this.finishToken(T.comma);case 91:return++this.pos,this.finishToken(T.bracketL);case 93:return++this.pos,this.finishToken(T.bracketR);case 123:return++this.pos,this.finishToken(T.braceL);case 125:return++this.pos,this.finishToken(T.braceR);case 58:return++this.pos,this.finishToken(T.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(T.backQuote);case 48:var t=this.input.charCodeAt(this.pos+1);if(t===120||t===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(t===111||t===79)return this.readRadixNumber(8);if(t===98||t===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(e);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(e);case 124:case 38:return this.readToken_pipe_amp(e);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(e);case 60:case 62:return this.readToken_lt_gt(e);case 61:case 33:return this.readToken_eq_excl(e);case 63:return this.readToken_question();case 126:return this.finishOp(T.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+Ll(e)+"'")};dt.finishOp=function(e,t){var n=this.input.slice(this.pos,this.pos+t);return this.pos+=t,this.finishToken(e,n)};dt.readRegexp=function(){for(var e,t,n=this.pos;;){this.pos>=this.input.length&&this.raise(n,"Unterminated regular expression");var i=this.input.charAt(this.pos);if(Vs.test(i)&&this.raise(n,"Unterminated regular expression"),e)e=!1;else{if(i==="[")t=!0;else if(i==="]"&&t)t=!1;else if(i==="/"&&!t)break;e=i==="\\"}++this.pos}var r=this.input.slice(n,this.pos);++this.pos;var s=this.pos,o=this.readWord1();this.containsEsc&&this.unexpected(s);var a=this.regexpState||(this.regexpState=new Ba(this));a.reset(n,r,o),this.validateRegExpFlags(a),this.validateRegExpPattern(a);var l=null;try{l=new RegExp(r,o)}catch{}return this.finishToken(T.regexp,{pattern:r,flags:o,value:l})};dt.readInt=function(e,t,n){for(var i=this.options.ecmaVersion>=12&&t===void 0,r=n&&this.input.charCodeAt(this.pos)===48,s=this.pos,o=0,a=0,l=0,u=t??1/0;l<u;++l,++this.pos){var c=this.input.charCodeAt(this.pos),d=void 0;if(i&&c===95){r&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),a===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),l===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),a=c;continue}if(c>=97?d=c-97+10:c>=65?d=c-65+10:c>=48&&c<=57?d=c-48:d=1/0,d>=e)break;a=c,o=o*e+d}return i&&a===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===s||t!=null&&this.pos-s!==t?null:o};function N5e(e,t){return t?parseInt(e,8):parseFloat(e.replace(/_/g,""))}function jZ(e){return typeof BigInt!="function"?null:BigInt(e.replace(/_/g,""))}dt.readRadixNumber=function(e){var t=this.pos;this.pos+=2;var n=this.readInt(e);return n==null&&this.raise(this.start+2,"Expected number in radix "+e),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(n=jZ(this.input.slice(t,this.pos)),++this.pos):Ol(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(T.num,n)};dt.readNumber=function(e){var t=this.pos;!e&&this.readInt(10,void 0,!0)===null&&this.raise(t,"Invalid number");var n=this.pos-t>=2&&this.input.charCodeAt(t)===48;n&&this.strict&&this.raise(t,"Invalid number");var i=this.input.charCodeAt(this.pos);if(!n&&!e&&this.options.ecmaVersion>=11&&i===110){var r=jZ(this.input.slice(t,this.pos));return++this.pos,Ol(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(T.num,r)}n&&/[89]/.test(this.input.slice(t,this.pos))&&(n=!1),i===46&&!n&&(++this.pos,this.readInt(10),i=this.input.charCodeAt(this.pos)),(i===69||i===101)&&!n&&(i=this.input.charCodeAt(++this.pos),(i===43||i===45)&&++this.pos,this.readInt(10)===null&&this.raise(t,"Invalid number")),Ol(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var s=N5e(this.input.slice(t,this.pos),n);return this.finishToken(T.num,s)};dt.readCodePoint=function(){var e=this.input.charCodeAt(this.pos),t;if(e===123){this.options.ecmaVersion<6&&this.unexpected();var n=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,t>1114111&&this.invalidStringToken(n,"Code point out of bounds")}else t=this.readHexChar(4);return t};dt.readString=function(e){for(var t="",n=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var i=this.input.charCodeAt(this.pos);if(i===e)break;i===92?(t+=this.input.slice(n,this.pos),t+=this.readEscapedChar(!1),n=this.pos):i===8232||i===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(ug(i)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return t+=this.input.slice(n,this.pos++),this.finishToken(T.string,t)};var qZ={};dt.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(e){if(e===qZ)this.readInvalidTemplateToken();else throw e}this.inTemplateElement=!1};dt.invalidStringToken=function(e,t){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw qZ;this.raise(e,t)};dt.readTmplToken=function(){for(var e="",t=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var n=this.input.charCodeAt(this.pos);if(n===96||n===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===T.template||this.type===T.invalidTemplate)?n===36?(this.pos+=2,this.finishToken(T.dollarBraceL)):(++this.pos,this.finishToken(T.backQuote)):(e+=this.input.slice(t,this.pos),this.finishToken(T.template,e));if(n===92)e+=this.input.slice(t,this.pos),e+=this.readEscapedChar(!0),t=this.pos;else if(ug(n)){switch(e+=this.input.slice(t,this.pos),++this.pos,n){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:e+=`
`;break;default:e+=String.fromCharCode(n);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),t=this.pos}else++this.pos}};dt.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(T.invalidTemplate,this.input.slice(this.start,this.pos));case"\r":this.input[this.pos+1]===`
`&&++this.pos;case`
`:case"\u2028":case"\u2029":++this.curLine,this.lineStart=this.pos+1;break}this.raise(this.start,"Unterminated template")};dt.readEscapedChar=function(e){var t=this.input.charCodeAt(++this.pos);switch(++this.pos,t){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return Ll(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),e){var n=this.pos-1;this.invalidStringToken(n,"Invalid escape sequence in template string")}default:if(t>=48&&t<=55){var i=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],r=parseInt(i,8);return r>255&&(i=i.slice(0,-1),r=parseInt(i,8)),this.pos+=i.length-1,t=this.input.charCodeAt(this.pos),(i!=="0"||t===56||t===57)&&(this.strict||e)&&this.invalidStringToken(this.pos-1-i.length,e?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(r)}return ug(t)?(this.options.locations&&(this.lineStart=this.pos,++this.curLine),""):String.fromCharCode(t)}};dt.readHexChar=function(e){var t=this.pos,n=this.readInt(16,e);return n===null&&this.invalidStringToken(t,"Bad character escape sequence"),n};dt.readWord1=function(){this.containsEsc=!1;for(var e="",t=!0,n=this.pos,i=this.options.ecmaVersion>=6;this.pos<this.input.length;){var r=this.fullCharCodeAtPos();if(bp(r,i))this.pos+=r<=65535?1:2;else if(r===92){this.containsEsc=!0,e+=this.input.slice(n,this.pos);var s=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var o=this.readCodePoint();(t?Ol:bp)(o,i)||this.invalidStringToken(s,"Invalid Unicode escape"),e+=Ll(o),n=this.pos}else break;t=!1}return e+this.input.slice(n,this.pos)};dt.readWord=function(){var e=this.readWord1(),t=T.name;return this.keywords.test(e)&&(t=DL[e]),this.finishToken(t,e)};var $5e="8.14.0";Hn.acorn={Parser:Hn,version:$5e,defaultOptions:aT,Position:Jv,SourceLocation:CR,getLineInfo:vZ,Node:wR,TokenType:Ct,tokTypes:T,keywordTypes:DL,TokContext:eo,tokContexts:Zt,isIdentifierChar:bp,isIdentifierStart:Ol,Token:OL,isNewLine:ug,lineBreak:Vs,lineBreakG:o5e,nonASCIIwhitespace:gZ};function B5e(e,t){return Hn.parse(e,t)}const LL={undefined:"void(0)",Infinity:"Number.POSITIVE_INFINITY",NaN:"Number.NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2"};function Ac(e){return typeof e=="number"}const G5e={ecmaVersion:11},m6="$",z5e="d",H5e="d1",V5e="d2",si=e=>(t,n)=>n.error(t,e+" not allowed"),W5e=si("Aggregate function"),U5e=si("Window function"),j5e="Invalid argument",NL="Invalid column reference",q5e=NL+" (must be input to an aggregate function)",KZ="Invalid function call",K5e="Invalid member expression",Y5e="Invalid operator parameter",X5e="Invalid param reference",Q5e="Invalid variable reference",J5e="Variable not accessible in operator call",Z5e="Unsupported variable declaration",e6e="Unsupported destructuring pattern",YZ="Table expressions do not support closures",XZ="Use aq.escape(fn) to use a function as-is (including closures)",t6e="use table.params({ name: value }) to define dynamic parameters",n6e="use aq.addFunction(name, fn) to add new op functions",i6e=`
Note: ${YZ}. ${XZ}, or ${t6e}.`,QZ=`
Note: ${YZ}. ${XZ}, or ${n6e}.`,r6e=`The ${lZ} method is not valid in multi-table expressions.`;function s6e(e,t){const n=o6e(t);let i=e.root=n;return e.spec=t,e.tuple=null,e.tuple1=null,e.tuple2=null,e.$param=null,e.$op=0,e.scope=new Set,e.paramsRef=new Map,e.columnRef=new Map,jVe(i)?(l6e(i,e),i=i.body):e.join?(e.scope.add(e.tuple1=H5e),e.scope.add(e.tuple2=V5e),e.scope.add(e.$param=m6)):(e.scope.add(e.tuple=z5e),e.scope.add(e.$param=m6)),mt(i,e,$L),e.root}function o6e(e){try{const t=e.field?a6e(e):ur(e)?_l(e):e;return B5e(`expr=(${t})`,G5e).body[0].expression.right}catch{un(`Expression parse error: ${e+""}`)}}function a6e(e){const t=JSON.stringify(e+"");return e.table?`(a,b)=>b[${t}]`:`d=>d[${t}]`}const $L={FunctionDeclaration:si("Function definitions"),ForStatement:si("For loops"),ForOfStatement:si("For-of loops"),ForInStatement:si("For-in loops"),WhileStatement:si("While loops"),DoWhileStatement:si("Do-while loops"),AwaitExpression:si("Await expressions"),ArrowFunctionExpression:si("Function definitions"),AssignmentExpression:si("Assignments"),FunctionExpression:si("Function definitions"),NewExpression:si('Use of "new"'),UpdateExpression:si("Update expressions"),VariableDeclarator(e,t){hT(e.id,t)},Identifier(e,t,n){eee(e,t,n)&&!t.scope.has(e.name)&&t.error(e,Q5e,i6e)},CallExpression(e,t){const n=JZ(e.callee),i=YJ(n)||XJ(n);if(i){if((t.join||t.aggregate===!1)&&bL(n)&&W5e(e,t),(t.join||t.window===!1)&&SL(n)&&U5e(e,t),t.$op=1,t.ast)dT(e,n,t),e.arguments.forEach(r=>mt(r,t,cT));else{const r=t.op(u6e(t,i,n,e.arguments));Object.assign(e,{type:sZ,name:r.id})}return t.$op=0,!1}else KJ(n)?dT(e,n,t):t.error(e,KZ,QZ)},MemberExpression(e,t,n){const{object:i,property:r}=e;if(!$n(zu,i))return;const{name:s}=i;if(ZZ(e)&&$n(zu,r)&&Object.hasOwn(LL,r.name)){iee(e,r.name);return}const o=s===t.tuple?0:s===t.tuple1?1:s===t.tuple2?2:-1;if(o>=0)return v6(e,o,t,tee,n);if(s===t.$param)return v6(e,o,t,d6e);t.paramsRef.has(s)?e0(e,t.paramsRef.get(s)):t.columnRef.has(s)?nee(i,s,t,e):Object.hasOwn(t.params,s)&&e0(i,s)}};function v6(e,t,n,i,r){const{property:s,computed:o}=e;let a;if(!o)a=s.name;else if($n(lg,s))a=s.value;else try{mt(s,n,$L,e),a=n.param(s)}catch{n.error(e,K5e)}return i(e,a,t,n,r),!1}const cT={...$L,VariableDeclarator:si("Variable declaration in operator call"),Identifier(e,t,n){eee(e,t,n)&&t.error(e,J5e)},CallExpression(e,t){const n=JZ(e.callee);KJ(n)?dT(e,n,t):t.error(e,KZ,QZ)}};function l6e(e,t){e.generator&&si("Generator functions")(e,t),e.async&&si("Async functions")(e,t);const{params:n}=e,i=n.length,r=o=>(a,l)=>t.columnRef.set(a,[l,o]),s=(o,a)=>t.paramsRef.set(o,a);i&&(t.join?(dm(t,n[0],"tuple1",r(1)),i>1&&dm(t,n[1],"tuple2",r(2)),i>2&&dm(t,n[2],"$param",s)):(dm(t,n[0],"tuple",r(0)),i>1&&dm(t,n[1],"$param",s))),t.root=e.body}function dm(e,t,n,i){$n(zu,t)?(e.scope.add(t.name),e[n]=t.name):$n(nZ,t)&&t.properties.forEach(r=>{const s=$n(zu,r.key)?r.key.name:$n(lg,r.key)?r.key.value:e.error(r,j5e);$n(zu,r.value)||e.error(r.value,e6e),i(r.value.name,s)})}function u6e(e,t,n,i){const r=[],s=[],o=t.param[0]||0,a=o+(t.param[1]||0);return i.forEach((l,u)=>{u<o?(mt(l,e,cT),r.push(e.field(l))):u<a?(mt(l,e,cT),s.push(e.param(l))):e.error(l,Y5e)}),{name:n,fields:r,params:s,...e.spec.window||{}}}function JZ(e){return $n(zu,e)?e.name:$n(tZ,e)?ZZ(e)?c6e(e.property.name):e.property.name:null}function ZZ(e){return $n(zu,e.object)&&e.object.name==="Math"}function c6e(e){return e==="max"?"greatest":e==="min"?"least":e}function eee(e,t,n){const{name:i}=e;if(!($n(tZ,n)&&n.property===e)){if(!($n(iZ,n)&&n.key===e))if(t.paramsRef.has(i))e0(e,t.paramsRef.get(i));else if(t.columnRef.has(i))nee(e,i,t,n);else if(Object.hasOwn(t.params,i))e0(e,i);else if(Object.hasOwn(LL,i))iee(e,i);else return!0}}function tee(e,t,n,i,r){const s=n===0?i.table:n>0?i.join[n-1]:null,o=s&&s.column(t);s&&!o&&i.error(e,NL),i.aggronly&&!i.$op&&i.error(e,q5e),aZ(e,t,n,o,r)}function nee(e,t,n,i){const[r,s]=n.columnRef.get(t);tee(e,r,s,n,i)}function d6e(e,t,n,i){i.params&&!Object.hasOwn(i.params,t)&&i.error(e,X5e),e0(e,t)}function e0(e,t){e.type=VVe,e.name=t}function iee(e,t){e.type=GVe,e.name=t,e.raw=LL[t]}function dT(e,t,n){if(t===lZ){const i=n.table;i||n.error(e,r6e),uZ(e,i,e.arguments.length?e.arguments.map(r=>{const s=n.param(r),o=Ac(s)?i.columnName(s):s;return i.column(o)||n.error(r,NL),o}):i.columnNames())}else e.callee={type:HVe,name:t}}function hT(e,t){$n(zu,e)?t.scope.add(e.name):$n(LVe,e)?e.elements.forEach(n=>hT(n,t)):$n(nZ,e)?e.properties.forEach(n=>hT(n.value,t)):t.error(e.id,Z5e)}const h6e={[rZ]:1,[sZ]:1};function is(e,t={}){const n=t.generate||IS,i=t.compiler||AL,r=p6e(t),s={},o={},a=[],l=[];let u=0,c=-1;const d=t.join?i.join:t.index==1?i.expr2:i.expr,h={op(v){const C=f6e(v);return o[C]||(v.id=++c,o[C]=v)},field(v){const C=n(v);return s[C]||(s[C]=++u)},param(v){return $n(lg,v)?v.value:i.param(n(v),r)},value(v,C){a.push(v);const y=C.escape||(t.ast?UVe(C):d(n(C),r));l.push(y),h6e[C.type]&&y!==C&&sc(y)&&(y.field=C.name)},error(v,C,y=""){const b=v.start-6,S=v.end-6,x=String(h.spec).slice(b,S);un(`${C}: "${x}"${y}`)}};Object.assign(h,t,{params:r});for(const[v,C]of EL(e))h.value(v+"",C.escape?ZVe(h,C,r):s6e(h,C));if(t.ast)return{names:a,exprs:l};const p=[];for(const v in s)p[s[v]]=i.expr(v,r);const g=Object.values(o);return g.forEach(v=>v.fields=v.fields.map(C=>p[C])),{names:a,exprs:l,ops:g}}function f6e(e){let t=`${e.name}(${e.fields.concat(e.params).join(",")})`;if(e.frame){const n=e.frame.map(i=>Number.isFinite(i)?Math.abs(i):-1);t+=`[${n},${!!e.peers}]`}return t}function p6e(e){return(e.table?sD(e.table):e.join?{...sD(e.join[1]),...sD(e.join[0])}:{})||{}}function sD(e){return e&&vi(e.params)?e.params():{}}function SR(e,t){return e&&e.expr?new C6({...e,...t}):new C6(t,e)}class C6{constructor(t,n){this.expr=n,Object.assign(this,t)}toString(){return String(this.expr)}toObject(){return{...this,expr:this.toString(),...vi(this.expr)?{func:!0}:{}}}}function $S(e,t,n=0){const i=n?{field:!0,table:n}:{field:!0};return SR(e,t?{expr:t,...i}:i)}function ree(e,t){for(const[n,i]of EL(t))e.set(n,i);return e}function $l(e,t,n=new Map){return t=Ac(t)?e.columnName(t):t,$o(t)?n.set(t,t):ur(t)?t.forEach(i=>$l(e,i,n)):vi(t)?$l(e,t(e),n):sc(t)?ree(n,t):un(`Invalid column selection: ${_l(t)}`),n}function see(e,t){return e.toObject=t,e}function oee(e){return ur(e)?e.map(oee):e&&e.toObject?e.toObject():e}function t0(){return see(e=>e.columnNames(),()=>({all:[]}))}function aee(...e){return e=e.flat(),see(t=>{const n=$l(t,e);return t.columnNames(i=>!n.has(i))},()=>({not:oee(e)}))}function Eo(e,t,n,i={window:!1}){const r=new Map,s=o=>{o=Ac(o)?t.columnName(o):o,$o(o)?r.set(o,$S(o)):vi(o)?$l(t,o).forEach(s):sc(o)?ree(r,o):un(`Invalid ${e} value: ${o+""}`)};return Ea(n).forEach(s),i.preparse&&i.preparse(r),is(r,{table:t,...i})}function BL(e,...t){return g6e(e,Eo("groupby",e,t.flat()))}function g6e(e,t){return e.create({groups:m6e(e,t)})}function m6e(e,{names:t=[],exprs:n=[],ops:i=[]}){const r=t.length;if(r===0)return null;if(r===1&&!e.isFiltered()&&n[0].field){const p=e.column(n[0].field);if(p.groups)return p.groups(t)}let s=Ch(e,i,n);const o=TS(s),a=e.totalRows(),l=new Uint32Array(a),u={},c=[],d=e.data(),h=e.mask();if(h)for(let p=h.next(0);p>=0;p=h.next(p+1)){const g=o(p,d)+"";l[p]=u[g]??=c.push(p)-1}else for(let p=0;p<a;++p){const g=o(p,d)+"";l[p]=u[g]??=c.push(p)-1}return i.length||(s=s.map(p=>g=>p(g,d))),{keys:l,get:s,names:t,rows:c,size:c.length}}function rs(e){return e?new y6({...e.data()},e.columnNames()):new y6}class y6{constructor(t,n){this.data=t||{},this.names=n||[]}add(t,n){return this.has(t)||this.names.push(t+""),this.data[t]=n}has(t){return Object.hasOwn(this.data,t)}groupby(t){return this.groups=t,this}new(t){const{data:n,names:i,groups:r=null}=this;return t.create({data:n,names:i,groups:r,filter:null,order:null})}derive(t){return t.create(this)}}function n0(e,t){return GL(e,is(t,{table:e,aggronly:!0,window:!1}))}function GL(e,{names:t,exprs:n,ops:i=[]}){const r=rs(),s=e.groups();return s&&eZ(r,s),v6e(t,n,s,ag(e,i),r),r.new(e)}function v6e(e,t,n,i=[],r){if(!t.length)return;const s=n?n.size:1,o=(l,u)=>i[l][u],a=e.length;for(let l=0;l<a;++l){const u=t[l];if(u.field!=null)r.add(e[l],i[u.field]);else if(s>1){const c=r.add(e[l],Array(s));for(let d=0;d<s;++d)c[d]=u(d,null,o)}else r.add(e[l],[u(0,null,o)])}}function lee(e,...t){return zL(e,$l(e,t.flat()))}function zL(e,t){const n=rs();return t.forEach((i,r)=>{const s=$o(i)?i:r;if(s){const o=e.column(r)||un(`Unrecognized column: ${r}`);n.add(s,o)}}),n.derive(e)}function C6e(e,t){if(!e||!t)return e;const{keys:n,rows:i,size:r}=e,s=new Uint32Array(r);t.scan(c=>s[n[c]]=1);const o=s.reduce((c,d)=>c+d,0);if(o===r)return e;const a=Array(o);let l=0;for(let c=0;c<r;++c)s[c]&&(a[s[c]=l++]=i[c]);const u=new Uint32Array(n.length);return t.scan(c=>u[c]=s[n[c]]),{...e,keys:u,rows:a,size:l}}function y6e(e,t,n,i){const{keys:r,rows:s,size:o}=e;let a=s,l=o,u=null;if(n){u=new Int32Array(o),t(g=>u[r[g]]=1);const p=u.reduce((g,v)=>g+v,0);if(p!==o){a=Array(p),l=0;for(let g=0;g<o;++g)u[g]&&(a[u[g]=l++]=s[g])}}let c=-1;const d=new Uint32Array(i);return t(l!==o?p=>d[++c]=u[r[p]]:p=>d[++c]=r[p]),{...e,keys:d,rows:a,size:l}}function w6e(e,t,n,i){const r=i==="map"||i===!0?VJ:i==="entries"?UJ:i==="object"?WJ:un('groups option must be "map", "entries", or "object".'),{names:s}=e.groups(),o=bVe(e.columnNames(),"_");let a=lee(e,{}).reify(t).create({data:{[o]:n}});a=n0(a,{[o]:zJ(o)});for(let l=s.length;--l>=0;)a=n0(BL(a,s.slice(0,l)),{[o]:r(s[l],o)});return a.get(o)}function b6e(e){return gR(e)?e.constructor:Array}let fT=class{constructor(t,n,i,r,s,o){const a=Object.freeze({...t});n=n?.slice()??Object.keys(a);const l=n.length?a[n[0]].length:0;this._names=Object.freeze(n),this._data=a,this._total=l,this._nrows=i?.count()??l,this._mask=i??null,this._group=r??null,this._order=s??null,this._params=o,this._index=null,this._partitions=null}create({data:t=void 0,names:n=void 0,filter:i=void 0,groups:r=void 0,order:s=void 0}={}){const o=i!==void 0?i:this.mask();return new this.constructor(t||this._data,n||(t?null:this._names),o,r!==void 0?r:C6e(this._group,i&&o),s!==void 0?s:this._order,this._params)}params(t){return arguments.length?(t&&(this._params={...this._params,...t}),this):this._params}get[Symbol.toStringTag](){if(!this._names)return"Object";const t=this.numRows(),n=this.numCols(),i=r=>r!==1?"s":"";return`Table: ${n} col${i(n)} x ${t} row${i(t)}`+(this.isFiltered()?` (${this.totalRows()} backing)`:"")+(this.isGrouped()?`, ${this._group.size} groups`:"")+(this.isOrdered()?", ordered":"")}isFiltered(){return!!this._mask}isGrouped(){return!!this._group}isOrdered(){return!!this._order}data(){return this._data}mask(){return this._mask}groups(){return this._group}comparator(){return this._order}totalRows(){return this._total}numRows(){return this._nrows}get size(){return this._nrows}numCols(){return this._names.length}columnNames(t){return t?this._names.filter(t):this._names.slice()}columnName(t){return this._names[t]}columnIndex(t){return this._names.indexOf(t)}column(t){return this._data[t]}columnAt(t){return this._data[this._names[t]]}array(t,n=Array){const i=this.column(t),r=new n(this.numRows());let s=-1;return this.scan(o=>r[++s]=i.at(o),!0),r}get(t,n=0){const i=this.column(t);return this.isFiltered()||this.isOrdered()?i.at(this.indices()[n]):i.at(n)}getter(t){const n=this.column(t),i=this.isFiltered()||this.isOrdered()?this.indices():null;if(i)return r=>n.at(i[r]);if(n)return r=>n.at(r);un(`Unrecognized column: ${t}`)}object(t=0){return w6(this)(t)}objects(t={}){const{grouped:n,limit:i,offset:r}=t,s=$l(this,t.columns||t0()),o=dZ(this,s),a=[];if(this.scan((l,u)=>a.push(o(l,u)),!0,i,r),n&&this.isGrouped()){const l=[];return this.scan(u=>l.push(u),!0,i,r),w6e(this,l,a,n)}return a}*[Symbol.iterator](){const t=w6(this),n=this.numRows();for(let i=0;i<n;++i)yield t(i)}*values(t){const n=this.getter(t),i=this.numRows();for(let r=0;r<i;++r)yield n(r)}print(t={}){const n=Ac(t)?{limit:+t}:{...t,limit:10},i=this.objects({...n,grouped:!1}),r=`${this[Symbol.toStringTag]}. Showing ${i.length} rows.`;return console.log(r),console.table(i),this}indices(t=!0){if(this._index)return this._index;const n=this.numRows(),i=new Uint32Array(n),r=this.isOrdered(),s=this.mask();let o=-1;if(s)for(let a=s.next(0);a>=0;a=s.next(a+1))i[++o]=a;else for(let a=0;a<n;++a)i[++o]=a;if(t&&r){const{_order:a,_data:l}=this;i.sort((u,c)=>a(u,c,l))}return(t||!r)&&(this._index=i),i}partitions(t=!0){if(this._partitions)return this._partitions;if(!this.isGrouped())return[this.indices(t)];const{keys:n,size:i}=this._group,r=sg(i,()=>[]),s=this._index,o=this.mask(),a=this.numRows();if(s&&this.isOrdered())for(let l=0,u;l<a;++l)u=s[l],r[n[u]].push(u);else if(o)for(let l=o.next(0);l>=0;l=o.next(l+1))r[n[l]].push(l);else for(let l=0;l<a;++l)r[n[l]].push(l);if(t&&!s&&this.isOrdered()){const l=this._order,u=this._data;for(let c=0;c<i;++c)r[c].sort((d,h)=>l(d,h,u))}return(t||!this.isOrdered())&&(this._partitions=r),r}reify(t){const n=t?t.length:this.numRows(),i=this._names;let r,s;if(!t&&!this.isOrdered())if(this.isFiltered())n===this.totalRows()&&(r=this.data());else return this;if(!r){const o=t?l=>t.forEach(l):l=>this.scan(l,!0),a=i.length;r={};for(let l=0;l<a;++l){const u=i[l],c=this.column(u),d=r[u]=new(b6e(c))(n);let h=-1;Ec(c)?o(p=>d[++h]=c[p]):o(p=>d[++h]=c.at(p))}this.isGrouped()&&(s=y6e(this.groups(),o,!!t,n))}return this.create({data:r,names:i,groups:s,filter:null,order:null})}scan(t,n,i=1/0,r=0){const s=this._mask,o=this._nrows,a=this._data;let l=r||0;if(l>o)return;const u=Math.min(o,l+i),c=()=>l=this._total;if(n&&this.isOrdered()||s&&this._index){const d=this.indices(),h=this._data;for(;l<u;++l)t(d[l],h,c)}else if(s){let d=u-l+1;for(l=s.nth(l);--d&&l>-1;l=s.next(l+1))t(l,a,c)}else for(;l<u;++l)t(l,a,c)}};function w6(e){let t=e._builder;if(!t){const n=dZ(e),i=e.data();if(e.isOrdered()||e.isFiltered()){const r=e.indices();t=s=>n(r[s],i)}else t=r=>n(r,i);e._builder=t}return t}function S6e(e,...t){t=t.flat();const n=e.numRows(),i=e.reify(),r=rs(i).groupby(i.groups());return t.forEach(s=>{s=s instanceof fT?s:new fT(s),s.numRows()!==n&&un("Assign row counts do not match"),s=s.reify(),s.columnNames(o=>r.add(o,s.column(o)))}),r.new(e)}function uee(e,...t){t=t.flat();const n=e.numRows(),i=n+t.reduce((o,a)=>o+a.numRows(),0);if(n===i)return e;const r=[e,...t],s=rs();return e.columnNames().forEach(o=>{const a=Array(i);let l=0;r.forEach(u=>{const c=u.column(o)||{at:()=>yt};u.scan(d=>a[l++]=c.at(d))}),s.add(o,a)}),s.new(e)}function cee(e,t,{before:n=void 0,after:i=void 0}={}){const r=n!=null,s=i!=null;r||s||un("relocate requires a before or after option."),r&&s&&un("relocate accepts only one of the before or after options."),t=$l(e,t);const o=[...$l(e,r?n:i).keys()],a=r?o[0]:o.pop(),l=new Map;return e.columnNames().forEach(u=>{const c=!t.has(u);if(u===a){s&&c&&l.set(u,u);for(const[d,h]of t)l.set(d,h);if(s)return}c&&l.set(u,u)}),zL(e,l)}function dee(e){return{left(t,n,i,r){for(i==null&&(i=0),r==null&&(r=t.length);i<r;){const s=i+r>>>1;e(t[s],n)<0?i=s+1:r=s}return i},right(t,n,i,r){for(i==null&&(i=0),r==null&&(r=t.length);i<r;){const s=i+r>>>1;e(t[s],n)>0?r=s:i=s+1}return i}}}const b6=dee(xL);function x6e(e,t,n,i,r){let s,o,a,l,u;const c=v=>o[v-1]===o[v],d=i.length,h=r.length,p=i.length?og(["w","r","k"],"{"+hC(i,(v,C)=>`r[_${C}.id][k]=_${C}.value(w,_${C}.get);`)+"}",i):()=>{},g={i0:0,i1:0,index:0,size:0,peer:c,init(v,C,y,b){g.index=g.i0=g.i1=0,g.size=C.length,s=v,o=C,l=y,u=b,a=r?r.map(S=>S.init()):null;for(let S=0;S<d;++S)i[S].init();return g},value(v,C){return C(s[v],e)},step(v){const[C,y]=t,b=g.size,S=g.i0,x=g.i1;g.i0=C!=null?Math.max(0,v-Math.abs(C)):0,g.i1=y!=null?Math.min(b,v+Math.abs(y)+1):b,g.index=v,n&&(g.i0>0&&c(g.i0)&&(g.i0=b6.left(o,o[g.i0])),g.i1<b&&c(g.i1)&&(g.i1=b6.right(o,o[g.i1-1])));for(let E=0;E<h;++E){const A=r[E],F=a[E];for(let k=S;k<g.i0;++k)A.rem(F,s[k],e);for(let k=x;k<g.i1;++k)A.add(F,s[k],e);A.write(F,l,u)}return p(g,l,u),l}};return g}const R6e=e=>(e.frame||[null,null]).map(t=>Number.isFinite(t)?Math.abs(t):null),E6e=e=>!!e.peers;function F6e(e){const{id:t,name:n,fields:i=[],params:r=[]}=e;return{...XJ(n).create(...r),get:i.length?i[0]:null,id:t}}function A6e(e,t,n,i={},r){const s=e.data(),o=D6e(r,s),a=o.length,l=og(["r","d","op"],"{"+hC(t,(u,c)=>`_${c}[r] = $${c}(r, d, op);`)+"}",t,n);e.partitions().forEach((u,c)=>{const d=u.length,h=P6e(e,u);for(let g=0;g<a;++g)o[g].init(u,h,i,c);const p=g=>i[g][c];for(let g=0;g<d;++g){for(let v=0;v<a;++v)o[v].step(g);l(u[g],s,p)}})}function D6e(e,t){const n={};return e.forEach(i=>{const r=R6e(i),s=E6e(i),o=`${r},${s}`,{aggOps:a,winOps:l}=n[o]||(n[o]={frame:r,peers:s,aggOps:[],winOps:[]});bL(i.name)?a.push(i):l.push(F6e(i))}),Object.values(n).map(i=>x6e(t,i.frame,i.peers,i.winOps,QJ(i.aggOps,i.frame[0]!=null?-1:1)))}function P6e(e,t){if(e.isOrdered()){const n=e.comparator(),i=e.data(),r=t.length,s=new Uint32Array(r);for(let o=1,a=0;o<r;++o)s[o]=n(t[o-1],t[o],i)?++a:a;return s}else return t}function k6e(e){return SL(e.name)||e.frame&&(Number.isFinite(e.frame[0])||Number.isFinite(e.frame[1]))}function T6e(e,t,n={}){const i=HL(e,is(t,{table:e}),n);return n.drop||n.before==null&&n.after==null?i:cee(i,Object.keys(t).filter(r=>!e.column(r)),n)}function HL(e,{names:t,exprs:n,ops:i=[]},r={}){const s=e.totalRows(),o=rs(r.drop?null:e),a=t.map(h=>o.add(h,Array(s))),[l,u]=M6e(i),c=e.isGrouped()?e.groups().size:1,d=ag(e,l,sg(i.length,()=>Array(c)));return u.length?A6e(e,a,n,d,u):I6e(e,a,n,d),o.derive(e)}function M6e(e){const t=[],n=[],i=e.length;for(let r=0;r<i;++r){const s=e[r];s.id=r,(k6e(s)?n:t).push(s)}return[t,n]}function I6e(e,t,n,i){const r=e.mask(),s=e.data(),{keys:o}=e.groups()||{},a=o?(u,c)=>i[u][o[c]]:u=>i[u][0],l=t.length;for(let u=0;u<l;++u){const c=n[u],d=t[u];if(r)for(let h=r.next(0);h>=0;h=r.next(h+1))d[h]=c(h,s,a);else{const h=e.totalRows();for(let p=0;p<h;++p)d[p]=c(p,s,a)}}}function VL(e,t){const n=is({p:t},{table:e});let i=n.exprs[0];if(n.ops.length){const r=HL(e,n,{drop:!0}).column("p");i=s=>r.at(s)}return _6e(e,i)}function _6e(e,t){const n=e.totalRows(),i=e.mask(),r=e.data(),s=new vL(n);if(i)for(let o=i.next(0);o>=0;o=i.next(o+1))t(o,r)&&s.set(o);else for(let o=0;o<n;++o)t(o,r)&&s.set(o);return e.create({filter:s})}function xR(e,...t){t=t.flat();const n=BL(e,t.length?t:e.columnNames());return VL(n,"row_number() === 1").ungroup().reify()}function hee(e,t){const n=new Map;return e.scan((i,r)=>{const s=t(i,r);s!=null&&s===s&&n.set(s,i)}),n}function O6e(e,t,n){const i=new Map,r=e.length;for(let s=0;s<r;++s){const o=e[s],a=n(o,t);a!=null&&a===a&&(i.has(a)?i.get(a).push(s):i.set(a,[s]))}return i}function L6e(e,t){const n=new Set(t);return e.filter(i=>n.has(i))}function BS(e,t,n){const i=new Map;Ea(n).forEach((s,o)=>{s=Ac(s)?t.columnName(s):s,$o(s)?i.set(o,$S(s)):vi(s)||sc(s)&&s.expr?i.set(o,s):un(`Invalid ${e} key value: ${s+""}`)});const r=is(i,{table:t,aggregate:!1,window:!1});return TS(r.exprs,!0)}function WL(e,t,n){if(n)$o(n)?n=[n,n]:ur(n)&&n.length===1&&(n=[n[0],n[0]]);else{const i=L6e(e.columnNames(),t.columnNames());i.length||un("Natural join requires shared column names."),n=[i,i]}return n}function fee(e,t,n,i){return n.length!==i.length&&un("Mismatched number of join keys"),[BS("join",e,n),BS("join",t,i)]}function pee(e,t,n){return mee(e,t,n,{anti:!1})}function gee(e,t,n){return mee(e,t,n,{anti:!0})}function mee(e,t,n,i){n=WL(e,t,n);const r=ur(n)?fee(e,t,...n.map(Ea)):is({on:n},{join:[e,t]}).exprs[0];return N6e(e,t,r,i)}function N6e(e,t,n,i={}){const r=new vL(e.totalRows());return(ur(n)?$6e:B6e)(r,e,t,n),i.anti&&r.not().and(e.mask()),e.create({filter:r})}function $6e(e,t,n,[i,r]){const s=hee(n,r);t.scan((o,a)=>{s.get(i(o,a))>=0&&e.set(o)})}function B6e(e,t,n,i){const r=t.numRows(),s=n.numRows(),o=t.data(),a=n.data();if(t.isFiltered()||n.isFiltered()){const l=t.indices(!1),u=n.indices(!1);for(let c=0;c<r;++c){const d=l[c];for(let h=0;h<s;++h)if(i(d,o,u[h],a)){e.set(d);break}}}else for(let l=0;l<r;++l)for(let u=0;u<s;++u)if(i(l,o,u,a)){e.set(l);break}}function G6e(e,...t){if(t=t.flat(),t.length===0)return e;const n=e.columnNames();return xR(t.reduce((i,r)=>gee(i,r.select(n)),e))}function z6e(e,t,n){return vee(e,Eo("unroll",e,t),n&&n.drop?{...n,drop:Eo("unroll",e,n.drop).names}:n)}function vee(e,{names:t=[],exprs:n=[],ops:i=[]},r={}){if(!t.length)return e;const s=r.limit>0?+r.limit:1/0,o=r.index?r.index===!0?"index":r.index+"":null,a=new Set(r.drop),l=Ch(e,i,n),u=rs(),c=new Set(t),d=[],h=[],p=[];e.columnNames().forEach(x=>{if(!a.has(x)){const E=u.add(x,[]);c.has(x)||(d.push(e.column(x)),h.push(E))}}),t.forEach(x=>{a.has(x)||(u.has(x)||u.add(x,[]),p.push(u.data[x]))});const g=o?u.add(o,[]):null;let v=0;const C=d.length,y=p.length,b=(x,E)=>{for(let A=0;A<C;++A)h[A].length=v+E,h[A].fill(d[A].at(x),v,v+E)},S=g?(x,E)=>{for(let A=0;A<E;++A)g[x+A]=A}:()=>{};if(y===1){const x=l[0],E=p[0];e.scan((A,F)=>{const k=Ea(x(A,F)),P=Math.min(k.length,s);b(A,P);for(let _=0;_<P;++_)E[v+_]=k[_];S(v,P),v+=P})}else e.scan((x,E)=>{let A=0;const F=l.map(k=>{const P=Ea(k(x,E));return A=Math.min(Math.max(A,P.length),s),P});b(x,A);for(let k=0;k<y;++k){const P=p[k],_=F[k];for(let O=0;O<A;++O)P[v+O]=_[O]}S(v,A),v+=A});return u.new(e)}function H6e(e,t,n){return V6e(e,Eo("fold",e,t),n)}function V6e(e,{names:t=[],exprs:n=[],ops:i=[]},r={}){if(t.length===0)return e;const[s="key",o="value"]=r.as||[],a=Ch(e,i,n);return vee(e,{names:[s,o],exprs:[()=>t,(l,u)=>a.map(c=>c(l,u))]},{...r,drop:t})}function RR(e){return e.isGrouped()?e.create({groups:null}):e}function W6e(e,t,n={}){if(t=is(t,{table:e}),t.names.forEach(i=>e.column(i)?0:un(`Invalid impute column ${_l(i)}`)),n.expand){const i={preparse:U6e,window:!1,aggronly:!0},r=Eo("impute",e,n.expand,i),s=GL(RR(e),r);return S6(e,t,r.names,r.names.map(o=>s.get(o,0)))}else return S6(e,t)}function U6e(e){e.forEach((t,n)=>t.field?e.set(n,HJ(t+"")):0)}function S6(e,t,n,i){const r=n&&n.length;e=r?j6e(e,n,i):e;const{names:s,exprs:o,ops:a}=t,l=Ch(e,a,o),u=r?null:rs(e),c=e.totalRows();return s.forEach((d,h)=>{const p=e.column(d),g=r?p:u.add(d,Array(c)),v=l[h];e.scan(C=>{const y=p.at(C);g[C]=fo(y)?y:v(C)})}),r?e:e.create(u)}function j6e(e,t,n){const i=e.groups(),r=e.data(),s=(i?i.names:[]).concat(t),o=(i?i.get:[]).concat(t.map(g=>e.getter(g))),a=new Set,l=TS(o);e.scan((g,v)=>a.add(l(g,v)));const u=e.columnNames(),c=rs(),d=u.map(g=>c.add(g,[]));u.forEach((g,v)=>{const C=r[g],y=d[v];e.scan(b=>y.push(C.at(b)))});const h=TS(o.map((g,v)=>C=>C[v])),p=og("v","{"+d.map((g,v)=>`_${v}.push(v[$${v}]);`).join("")+"}",d,u.map(g=>s.indexOf(g)));if(i){let g=i.keys.length;const v=n.reduce((y,b)=>y*b.length,i.size),C=new Uint32Array(v+(g-a.size));C.set(i.keys),x6(i,n,(y,b)=>{a.has(h(y))||(p(y),C[g++]=b[0])}),c.groupby({...i,keys:C})}else x6(i,n,g=>{a.has(h(g))||p(g)});return c.new(e)}function x6(e,t,n){const i=e?e.get.length:0,r=e?1:0,s=r+t.length,o=new Int32Array(s),a=new Int32Array(s),l=[];if(e){const{get:c,rows:d,size:h}=e;o[0]=h,l.push((p,g)=>{const v=d[g];for(let C=0;C<i;++C)p[C]=c[C](v)})}t.forEach((c,d)=>{const h=d+i;o[d+r]=c.length,l.push((p,g)=>p[h]=c[g])});const u=Array(i+t.length);for(let c=0;c<s;++c)l[c](u,0);n(u,a);for(let c=s-1;c>=0;){const d=++a[c];d<o[c]?(l[c](u,d),n(u,a),c=s-1):(a[c]=0,l[c](u,0),--c)}}function q6e(e,...t){t=t.flat();const n=e.columnNames();return t.length?xR(t.reduce((i,r)=>pee(i,r.select(n)),e)):e.reify([])}const K6e={aggregate:!1,window:!1},Y6e={...K6e,index:1},R6=-1/0;function X6e(e,t,n,i){return Vm(e,t,()=>!0,n,{...i,left:!0,right:!0})}function Vm(e,t,n,i,r={}){n=WL(e,t,n);const s={join:[e,t]};let o;if(ur(n)){const[a,l]=n.map(Ea);o=fee(e,t,a,l),i||(i=Q6e(e,a,l,r))}else o=is({on:n},s).exprs[0],i||(i=[t0(),t0()]);return eWe(e,t,o,J6e(e,t,i,s,r&&r.suffix),r)}function Q6e(e,t,n,i){const r=[];t.forEach((o,a)=>$o(o)&&o===n[a]?r.push(o):0);const s=aee(r);if(i.left&&i.right){const o=new Set(r);return[e.columnNames().map(a=>{const l=`[${_l(a)}]`;return o.has(a)?{[a]:`(a, b) => a${l} == null ? b${l} : a${l}`}:a}),s]}return i.right?[s,t0()]:[t0(),s]}function J6e(e,t,n,i,r=[]){if(ur(n)){let s,o,a,l=n.length;s=o=a={names:[],exprs:[]},l--&&(s=Eo("join",e,n[0],i)),l--&&(o=Eo("join",t,n[1],Y6e)),l--&&(a=is(n[2],i));const u=new Set,c=new Set(s.names);return o.names.forEach(d=>{c.has(d)&&u.add(d)}),u.size&&(r[0]!==""&&E6(s.names,u,r[0]||"_1"),r[1]!==""&&E6(o.names,u,r[1]||"_2")),{names:s.names.concat(o.names,a.names),exprs:s.exprs.concat(o.exprs,a.exprs)}}else return is(n,i)}function E6(e,t,n){e.forEach((i,r)=>t.has(i)?e[r]=i+n:0)}function Z6e(e,t){const n=["i","a","j","b"];return og(n,"{"+hC(e,(i,r)=>`_${r}.push($${r}(${n}));`)+"}",e,t)}function eWe(e,t,n,{names:i,exprs:r},s={}){const o=e.data(),a=e.indices(!1),l=a.length,u=new Int32Array(l),c=t.data(),d=t.indices(!1),h=d.length,p=new Int32Array(h),g=i.length,v=rs(),C=Array(g),y=Array(g);for(let x=0;x<i.length;++x)C[x]=v.add(i[x],[]),y[x]=r[x];const b=Z6e(C,y);if((ur(n)?nWe:tWe)(b,n,o,c,a,d,u,p,l,h),s.left)for(let x=0;x<l;++x)u[x]||b(a[x],o,R6,c);if(s.right)for(let x=0;x<h;++x)p[x]||b(R6,o,d[x],c);return v.new(e)}function tWe(e,t,n,i,r,s,o,a,l,u){for(let c=0;c<l;++c){const d=r[c];for(let h=0;h<u;++h){const p=s[h];t(d,n,p,i)&&(e(d,n,p,i),o[c]=1,a[h]=1)}}}function nWe(e,[t,n],i,r,s,o,a,l,u,c){let d,h,p,g,v,C,y,b,S=e;u>=c?(d=i,h=t,p=a,g=s,v=r,C=n,y=l,b=o):(d=r,h=n,p=l,g=o,v=i,C=t,y=a,b=s,S=(A,F,k,P)=>e(k,P,A,F));const x=O6e(b,v,C),E=g.length;for(let A=0;A<E;++A){const F=g[A],k=x.get(h(F,d));if(k){const P=k.length;for(let _=0;_<P;++_){const O=k[_];S(F,d,b[O],v),y[O]=1}p[A]=1}}}function iWe(e,t,n,...i){return n=WL(e,t,n),i=i.length===0?[aee(e.columnNames())]:i.flat(),rWe(e,t,[BS("lookup",e,n[0]),BS("lookup",t,n[1])],Eo("lookup",t,i))}function rWe(e,t,[n,i],{names:r,exprs:s,ops:o=[]}){const a=rs(e),l=e.totalRows();r.forEach(h=>a.add(h,Array(l).fill(yt)));const u=hee(t,i),c=og(["lr","rr","data"],"{"+hC(r,(h,p)=>`_[${p}][lr] = $[${p}](rr, data);`)+"}",r.map(h=>a.data[h]),Ch(t,o,s)),d=t.data();return e.scan((h,p)=>{const g=u.get(n(h,p));g>=0&&c(h,g,d)}),a.derive(e)}const sWe=(e,t,n,i)=>`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${n} : (u > v || v == null) && u != null ? ${i} : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n} : v !== v && u === u ? ${i} : `,oWe=(e,t,n,i,r)=>`(v = ${t}, (u = ${e}) == null && v == null) ? 0 : v == null ? ${i} : u == null ? ${n} : (u = ${r}(u,v)) ? u : `;function aWe(e,t){const n=[],i=[],r=[];let s=null,o="0",a="0";e.isGrouped()&&(s=e.groups().keys,o="ka",a="kb");const{ops:l}=is(t,{table:e,value:(p,g)=>{if(n.push(p),g.escape){const v=C=>`fn[${r.length}](${C}, data)`;i.push([v("a"),v("b")]),r.push(g.escape)}else i.push([IS(g,{index:"a",op:o}),IS(g,{index:"b",op:a})])},window:!1}),u=ag(e,l),c=(p,g)=>u[p][g],d=n.length;let h="return (a, b) => {"+(c&&e.isGrouped()?"const ka = keys[a], kb = keys[b];":"")+"let u, v; return ";for(let p=0;p<d;++p){const g=t.get(n[p]),v=g.desc?-1:1,[C,y]=i[p];g.collate?(h+=oWe(C,y,-v,v,`${v<0?"-":""}fn[${r.length}]`),r.push(g.collate)):h+=sWe(C,y,-v,v)}return h+="0;};",Function("op","keys","fn","data",h)(c,s,r,e.data())}function lWe(e,...t){return cWe(e,uWe(e,t.flat()))}function uWe(e,t){let n=-1;const i=new Map,r=s=>i.set(++n+"",s);return t.forEach(s=>{const o=s.expr!=null?s.expr:s;if(sc(o)&&!vi(o))for(const a in o)r(o[a]);else r(Ac(o)?$S(s,e.columnName(o)):$o(o)?$S(s):vi(o)?s:un(`Invalid orderby field: ${s+""}`))}),aWe(e,i)}function cWe(e,t){return e.create({order:t})}function dWe(e,t,n,i){return fWe(e,Eo("fold",e,t),Eo("fold",e,n,{preparse:hWe,window:!1,aggronly:!0}),i)}function hWe(e){e.forEach((t,n)=>t.field?e.set(n,BJ(t+"")):0)}const pT=(e,t)=>e??t;function fWe(e,t,n,i={}){const{keys:r,keyColumn:s}=pWe(e,t,i),o=pT(i.valueSeparator,"_"),a=n.names.length>1?(u,c)=>c+o+r[u]:u=>r[u],l=r.map(u=>ag(e,n.ops.map(c=>{if(c.name==="count"){const h=p=>u===s[p]?1:NaN;return h.toString=()=>u+":1",{...c,name:"sum",fields:[h]}}const d=c.fields.map(h=>{const p=(g,v)=>u===s[g]?h(g,v):NaN;return p.toString=()=>u+":"+h,p});return{...c,fields:d}})));return gWe(n,a,e.groups(),l).new(e)}function pWe(e,t,n){const i=n.limit>0?+n.limit:1/0,r=pT(n.sort,!0),s=pT(n.keySeparator,"_"),o=Ch(e,t.ops,t.exprs),a=o.length===1?o[0]:(d,h)=>o.map(p=>p(d,h)).join(s),l=Array(e.totalRows());e.scan((d,h)=>l[d]=a(d,h));const u=ag(RR(e),[{id:0,name:"array_agg_distinct",fields:[d=>l[d]],params:[]}])[0][0],c=r?u.sort():u;return{keys:Number.isFinite(i)?c.slice(0,i):c,keyColumn:l}}function gWe({names:e,exprs:t},n,i,r){const s=i?i.size:1,o=rs(),a=r.length,l=e.length;let u;const c=(d,h)=>u[d][h];i&&eZ(o,i);for(let d=0;d<l;++d){const h=t[d];if(h.field!=null)for(let p=0;p<a;++p)o.add(n(p,e[d]),r[p][h.field]);else if(s>1)for(let p=0;p<a;++p){u=r[p];const g=o.add(n(p,e[d]),Array(s));for(let v=0;v<s;++v)g[v]=h(v,null,c)}else for(let p=0;p<a;++p)u=r[p],o.add(n(p,e[d]),[h(0,null,c)])}return o}function mWe(e,t){const n=rs(),i=e.groups(),{get:r,names:s=[],rows:o,size:a=1}=i||{},l=new Uint32Array(a+1);s.forEach(h=>n.add(h,null));const u=i?ZJ(e,t,i):[JJ(e,t)];t.outputs().map(h=>n.add(h,[]));const c=l.length-1;let d=0;for(let h=0;h<c;++h)d+=l[h+1]=t.write(u[h],n.data,l[h]);if(i){const h=e.data();s.forEach((p,g)=>{const v=n.data[p]=Array(d),C=r[g];for(let y=0,b=0;y<a;++y)v.fill(C(o[y],h),b,b+=l[y+1])})}return n.new(e)}function vWe(e,...t){const n=new Map;return e.columnNames(i=>(n.set(i,i),0)),zL(e,$l(e,t.flat(),n))}function CWe(e,t,n,i){return(t?i?wWe:yWe:i?SWe:bWe)(e.length,e,n,i)}function yWe(e,t,n){const i=n.length;for(let r=0;r<e;++r)t[r]=n[i*rg()|0];return t}function wWe(e,t,n,i){const r=n.length,s=new Float64Array(r);let o=0;for(let l=0;l<r;++l)s[l]=o+=i(n[l]);const a=dee(xL).right;for(let l=0;l<e;++l)t[l]=n[a(s,o*rg())];return t}function bWe(e,t,n){const i=n.length;if(e>=i)return n;for(let r=0;r<e;++r)t[r]=n[r];for(let r=e;r<i;++r){const s=r*rg();s<e&&(t[s|0]=n[r])}return t}function SWe(e,t,n,i){const r=n.length;if(e>=r)return n;const s=new Float32Array(r),o=new Uint32Array(r);for(let a=0;a<r;++a)o[a]=a,s[a]=-Math.log(rg())/i(n[a]);o.sort((a,l)=>s[a]-s[l]);for(let a=0;a<e;++a)t[a]=n[o[a]];return t}function xWe(e,t=0,n=e.length){let i=n-(t=+t);for(;i;){const r=rg()*i--|0,s=e[i+t];e[i+t]=e[r+t],e[r+t]=s}return e}function RWe(e,t,n={}){return AWe(e,EWe(e,t),FWe(e,n.weight),n)}const Cee=e=>t=>e.at(t)||0;function EWe(e,t){return Ac(t)?()=>t:Cee(GL(e,is({size:t},{table:e,window:!1})).column("size"))}function FWe(e,t){return t==null?null:(t=Ac(t)?e.columnName(t):t,Cee($o(t)?e.column(t):HL(e,is({w:t},{table:e}),{drop:!0}).column("w")))}function AWe(e,t,n,i={}){const{replace:r,shuffle:s}=i,o=e.partitions(!1);let a=0;t=o.map((c,d)=>{let h=t(d);return a+=h=r?h:Math.min(c.length,h),h});const l=new Uint32Array(a);let u=0;return o.forEach((c,d)=>{const h=t[d],p=l.subarray(u,u+=h);!r&&h===c.length?p.set(c):CWe(p,r,c,n)}),s!==!1&&(o.length>1||!r)&&xWe(l),e.reify(l)}function DWe(e=0,t=1/0){return`${F6(e)} < row_number() && row_number() <= ${F6(t)}`}function F6(e){return e<0?`count() + ${e}`:e}function PWe(e,t=0,n=1/0){if(e.isGrouped())return VL(e,DWe(t,n)).reify();const i=[],r=e.numRows();return t=Math.max(0,t+(t<0?r:0)),n=Math.min(r,Math.max(0,n+(n<0?r:0))),e.scan(s=>i.push(s),!0,n-t,t),e.reify(i)}function kWe(e,t,n){return TWe(e,Eo("spread",e,t),n)}function TWe(e,{names:t,exprs:n,ops:i=[]},r={}){if(t.length===0)return e;const s=t.length===1&&r.as||[],o=r.drop==null?!0:!!r.drop,a=r.limit==null?s.length||1/0:Math.max(1,+r.limit||1),l=Ch(e,i,n),u=rs(),c=t.reduce((h,p,g)=>h.set(p,g),new Map),d=(h,p)=>{const g=MWe(e,l[h],a),v=g.length;for(let C=0;C<v;++C)u.add(s[C]||`${p}_${C+1}`,g[C])};return e.columnNames().forEach(h=>{c.has(h)?(o||u.add(h,e.column(h)),d(c.get(h),h),c.delete(h)):u.add(h,e.column(h))}),c.forEach(d),u.derive(e)}function MWe(e,t,n){const i=e.totalRows(),r=[];return e.scan((s,o)=>{const a=Ea(t(s,o)),l=Math.min(a.length,n);for(;r.length<l;)r.push(Array(i).fill(yt));for(let u=0;u<l;++u)r[u][s]=a[u]}),r}function IWe(e,...t){return xR(uee(e,t.flat()))}function _We(e){return e.isOrdered()?e.create({order:null}):e}const yee=Uint8Array.of(65,82,82,79,87,49),OWe=Uint8Array.of(255,255,255,255,0,0,0,0),i0={V1:0,V5:4},LWe={Little:0},Vw={NONE:0,Schema:1,DictionaryBatch:2,RecordBatch:3},re={Dictionary:-1,NONE:0,Null:1,Int:2,Float:3,Binary:4,Utf8:5,Bool:6,Decimal:7,Date:8,Time:9,Timestamp:10,Interval:11,List:12,Struct:13,Union:14,FixedSizeBinary:15,FixedSizeList:16,Map:17,Duration:18,LargeBinary:19,LargeUtf8:20,LargeList:21,RunEndEncoded:22,BinaryView:23,Utf8View:24,ListView:25,LargeListView:26},ER={HALF:0,SINGLE:1,DOUBLE:2},r0={DAY:0,MILLISECOND:1},vo={SECOND:0,MILLISECOND:1,MICROSECOND:2,NANOSECOND:3},s0={YEAR_MONTH:0,DAY_TIME:1,MONTH_DAY_NANO:2},wee={Sparse:0,Dense:1},fg=Uint8Array,UL=Uint16Array,jL=Uint32Array,qL=BigUint64Array,KL=Int8Array,bee=Int16Array,pg=Int32Array,gg=BigInt64Array,See=Float32Array,gC=Float64Array;function NWe(e,t){const n=Math.log2(e)-3;return(t?[KL,bee,pg,gg]:[fg,UL,jL,qL])[n]}const $We=Object.getPrototypeOf(Int8Array);function xee(e){return e instanceof $We}function Ree(e){return Array.isArray(e)||xee(e)}function YL(e){return e===gg||e===qL}function XL(e,t){let n=0,i=e.length;if(i<=2147483648)do{const r=n+i>>>1;e[r]<=t?n=r+1:i=r}while(n<i);else do{const r=Math.trunc((n+i)/2);e[r]<=t?n=r+1:i=r}while(n<i);return n}function BWe(e,t=1){return(e*t+7&-8)/t}function GWe(e,t=e.length){const n=BWe(t,e.BYTES_PER_ELEMENT);return e.length>n?e.subarray(0,n):e.length<n?Eee(e,n):e}function Eee(e,t,n=0){const i=new e.constructor(t);return i.set(e,n),i}function Fee(e,t,n){for(;e.length<=t;)e=Eee(e,e.length<<1,n?e.length:0);return e}function zWe(e){return e instanceof Date}function HWe(e){return typeof e[Symbol.iterator]=="function"}function Aee(e,t,n){if(t(e))return e;throw new Error(n(e))}function mC(e,t,n){return t=Array.isArray(t)?t:Object.values(t),Aee(e,i=>t.includes(i),n??(()=>`${e} must be one of ${t}`))}function VWe(e,t){for(const[n,i]of Object.entries(e))if(i===t)return n;return"<Unknown>"}const FR=e=>`Unsupported data type: "${VWe(re,e)}" (id ${e})`,AR=(e,t,n=!0,i=null)=>({name:e,type:t,nullable:n,metadata:i});function Dee(e){return Object.hasOwn(e,"name")&&Pee(e.type)}function Pee(e){return typeof e?.typeId=="number"}function kee(e,t="",n=!0){return Dee(e)?e:AR(t,Aee(e,Pee,()=>"Data type expected."),n)}const Tee=e=>({typeId:e}),WWe=(e,t,n=!1,i=-1)=>({typeId:re.Dictionary,id:i,dictionary:e,indices:t||QL(),ordered:n}),UWe=()=>Tee(re.Null),Dc=(e=32,t=!0)=>({typeId:re.Int,bitWidth:mC(e,[8,16,32,64]),signed:t,values:NWe(e,t)}),Mee=()=>Dc(8),Iee=()=>Dc(16),QL=()=>Dc(32),_ee=()=>Dc(64),jWe=()=>Dc(8,!1),qWe=()=>Dc(16,!1),KWe=()=>Dc(32,!1),YWe=()=>Dc(64,!1),Oee=(e=2)=>({typeId:re.Float,precision:mC(e,ER),values:[UL,See,gC][e]}),XWe=()=>Oee(ER.SINGLE),JL=()=>Oee(ER.DOUBLE),QWe=()=>({typeId:re.Utf8,offsets:pg}),JWe=()=>Tee(re.Bool),ZWe=e=>({typeId:re.Date,unit:mC(e,r0),values:e===r0.DAY?pg:gg}),e4e=()=>ZWe(r0.DAY),t4e=(e=vo.MILLISECOND,t=null)=>({typeId:re.Timestamp,unit:mC(e,vo),timezone:t,values:gg}),n4e=e=>({typeId:re.List,children:[kee(e)],offsets:pg}),i4e=e=>({typeId:re.Struct,children:Array.isArray(e)&&Dee(e[0])?e:Object.entries(e).map(([t,n])=>AR(t,n))}),r4e=(e,t)=>({typeId:re.FixedSizeList,stride:t,children:[kee(e)]}),Lee=new gC(2),DR=Lee.buffer,s4e=new gg(DR),Zh=new jL(DR),A6=new pg(DR),o4e=new fg(DR);function a4e(e){return e}function gl(e){return BigInt(e)}function Nee(e){return YL(e)?gl:a4e}function l4e(e){return e/864e5|0}function u4e(e){return e===vo.SECOND?t=>gl(t/1e3):e===vo.MILLISECOND?gl:e===vo.MICROSECOND?t=>gl(t*1e3):t=>gl(t*1e6)}function c4e([e,t,n]){return A6[0]=e,A6[1]=t,s4e[1]=gl(n),o4e}function oc(e){if(e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER)throw Error(`BigInt exceeds integer number representation: ${e}`);return Number(e)}function ZL(e,t){return Number(e/t)+Number(e%t)/Number(t)}function d4e(e,t,n,i,r){const s=typeof e=="bigint"?e:gl(Math.trunc(e*r));t[n]=s,t[n+1]=s>>64n,i>2&&(t[n+2]=s>>128n,t[n+3]=s>>192n)}const vf=e=>BigInt.asUintN(64,e);function h4e(e,t){const n=t<<1;let i;return BigInt.asIntN(64,e[n+1])<0?(i=vf(~e[n])|vf(~e[n+1])<<64n,i=-(i+1n)):i=e[n]|e[n+1]<<64n,i}function f4e(e,t){const n=t<<2;let i;return BigInt.asIntN(64,e[n+3])<0?(i=vf(~e[n])|vf(~e[n+1])<<64n|vf(~e[n+2])<<128n|vf(~e[n+3])<<192n,i=-(i+1n)):i=e[n]|e[n+1]<<64n|e[n+2]<<128n|e[n+3]<<192n,i}function p4e(e){if(e!==e)return 32256;Lee[0]=e;const t=(Zh[1]&2147483648)>>16&65535;let n=Zh[1]&2146435072,i=0;return n>=1089470464?Zh[0]>0?n=31744:(n=(n&2080374784)>>16,i=(Zh[1]&1048575)>>10):n<=1056964608?(i=1048576+(Zh[1]&1048575),i=1048576+(i<<(n>>20)-998)>>21,n=0):(n=n-1056964608>>10,i=(Zh[1]&1048575)+512>>10),t|n|i&65535}const g4e=new TextDecoder("utf-8"),m4e=new TextEncoder;function eN(e){return g4e.decode(e)}function $ee(e){return m4e.encode(e)}function PR(e){return`${typeof e!="object"||!e?e??null:zWe(e)?+e:Ree(e)?`[${e.map(PR)}]`:v4e(e)}`}function v4e(e){let t="",n=-1;for(const i in e)++n>0&&(t+=","),t+=`"${i}":${PR(e[i])}`;return`{${t}}`}const of=4,oD=2;function Bee(e,t){return(e[t>>3]&1<<t%8)!==0}function aD(e,t){return C4e(e,t)<<16>>16}function C4e(e,t){return e[t]|e[t+1]<<8}function kf(e,t){return e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24}function D6(e,t){return kf(e,t)>>>0}function y4e(e,t){return oc(BigInt.asIntN(64,BigInt(D6(e,t))+(BigInt(D6(e,t+of))<<32n)))}const lD=Symbol("rowIndex");function gT(e,t){class n{constructor(s){this[lD]=s}toJSON(){return zee(e,t,this[lD])}}const i=n.prototype;for(let r=0;r<e.length;++r){if(Object.hasOwn(i,e[r]))continue;const s=t[r];Object.defineProperty(i,e[r],{get(){return s.at(this[lD])},enumerable:!0})}return r=>new n(r)}function Gee(e,t){return n=>zee(e,t,n)}function zee(e,t,n){const i={};for(let r=0;r<e.length;++r)i[e[r]]=t[r].at(n);return i}function w4e(e){return e instanceof av}class vC{constructor({length:t,nullCount:n,type:i,validity:r,values:s,offsets:o,sizes:a,children:l}){this.length=t,this.nullCount=n,this.type=i,this.validity=r,this.values=s,this.offsets=o,this.sizes=a,this.children=l,(!n||!this.validity)&&(this.at=u=>this.value(u))}get[Symbol.toStringTag](){return"Batch"}at(t){return this.isValid(t)?this.value(t):null}isValid(t){return Bee(this.validity,t)}value(t){return this.values[t]}slice(t,n){const i=n-t,r=Array(i);for(let s=0;s<i;++s)r[s]=this.at(t+s);return r}*[Symbol.iterator](){for(let t=0;t<this.length;++t)yield this.at(t)}}Gh(vC,"ArrayType",null);class av extends vC{constructor(t){super(t);const{length:n,values:i}=this;this.values=i.subarray(0,n)}slice(t,n){return this.nullCount?super.slice(t,n):this.values.subarray(t,n)}[Symbol.iterator](){return this.nullCount?super[Symbol.iterator]():this.values[Symbol.iterator]()}}class kR extends vC{}Gh(kR,"ArrayType",gC);class wn extends vC{}Gh(wn,"ArrayType",Array);class Hee extends wn{value(t){return null}}class yh extends kR{value(t){return oc(this.values[t])}}class b4e extends kR{value(t){const n=this.values[t],i=(n&31744)>>10,r=(n&1023)/1024,s=(-1)**((n&32768)>>15);switch(i){case 31:return s*(r?Number.NaN:1/0);case 0:return s*(r?6103515625e-14*r:0)}return s*2**(i-15)*(1+r)}}class S4e extends wn{value(t){return Bee(this.values,t)}}class Vee extends vC{constructor(t){super(t);const{bitWidth:n,scale:i}=this.type;this.decimal=n===128?h4e:f4e,this.scale=10n**BigInt(i)}}class Wee extends Vee{value(t){return ZL(this.decimal(this.values,t),this.scale)}}Gh(Wee,"ArrayType",gC);class Uee extends Vee{value(t){return this.decimal(this.values,t)}}Gh(Uee,"ArrayType",Array);class P6 extends wn{constructor(t){super(t),this.source=t}value(t){return new Date(this.source.value(t))}}class x4e extends kR{value(t){return 864e5*this.values[t]}}const R4e=yh;class E4e extends yh{value(t){return super.value(t)*1e3}}const F4e=yh;class A4e extends yh{value(t){return ZL(this.values[t],1000n)}}class D4e extends yh{value(t){return ZL(this.values[t],1000000n)}}class P4e extends wn{value(t){return this.values.subarray(t<<1,t+1<<1)}}class k4e extends wn{value(t){const n=this.values,i=t<<4;return Float64Array.of(kf(n,i),kf(n,i+4),y4e(n,i+8))}}const jee=({values:e,offsets:t},n)=>e.subarray(t[n],t[n+1]),qee=({values:e,offsets:t},n)=>e.subarray(oc(t[n]),oc(t[n+1]));class T4e extends wn{value(t){return jee(this,t)}}class M4e extends wn{value(t){return qee(this,t)}}class I4e extends wn{value(t){return eN(jee(this,t))}}class _4e extends wn{value(t){return eN(qee(this,t))}}class O4e extends wn{value(t){const n=this.offsets;return this.children[0].slice(n[t],n[t+1])}}class L4e extends wn{value(t){const n=this.offsets;return this.children[0].slice(oc(n[t]),oc(n[t+1]))}}class N4e extends wn{value(t){const n=this.offsets[t],i=n+this.sizes[t];return this.children[0].slice(n,i)}}class $4e extends wn{value(t){const n=this.offsets[t],i=n+this.sizes[t];return this.children[0].slice(oc(n),oc(i))}}class Kee extends wn{constructor(t){super(t),this.stride=this.type.stride}}class B4e extends Kee{value(t){const{stride:n,values:i}=this;return i.subarray(t*n,(t+1)*n)}}class G4e extends Kee{value(t){const{children:n,stride:i}=this;return n[0].slice(t*i,(t+1)*i)}}function Yee({children:e,offsets:t},n){const[i,r]=e[0].children,s=t[n],o=t[n+1],a=[];for(let l=s;l<o;++l)a.push([i.at(l),r.at(l)]);return a}class z4e extends wn{value(t){return Yee(this,t)}}class H4e extends wn{value(t){return new Map(Yee(this,t))}}class Xee extends wn{constructor({typeIds:t,...n}){super(n),this.typeIds=t,this.typeMap=this.type.typeMap}value(t,n=t){const{typeIds:i,children:r,typeMap:s}=this;return r[s[i[t]]].at(n)}}class V4e extends Xee{value(t){return super.value(t,this.offsets[t])}}class Qee extends wn{constructor(t,n=Gee){super(t),this.names=this.type.children.map(i=>i.name),this.factory=n(this.names,this.children)}value(t){return this.factory(t)}}class W4e extends Qee{constructor(t){super(t,gT)}}class U4e extends wn{value(t){const[{values:n},i]=this.children;return i.at(XL(n,t))}}class j4e extends wn{setDictionary(t){return this.dictionary=t,this.cache=t.cache(),this}value(t){return this.cache[this.key(t)]}key(t){return this.values[t]}}class Jee extends wn{constructor({data:t,...n}){super(n),this.data=t}view(t){const{values:n,data:i}=this,r=t<<4;let s=r+4,o=n;const a=kf(o,r);return a>12&&(s=kf(o,r+12),o=i[kf(o,r+8)]),o.subarray(s,s+a)}}class q4e extends Jee{value(t){return this.view(t)}}class K4e extends Jee{value(t){return eN(this.view(t))}}class tN{constructor(t,n=t[0]?.type){this.type=n,this.length=t.reduce((s,o)=>s+o.length,0),this.nullCount=t.reduce((s,o)=>s+o.nullCount,0),this.data=t;const i=t.length,r=new Int32Array(i+1);if(i===1){const[s]=t;r[1]=s.length,this.at=o=>s.at(o)}else for(let s=0,o=0;s<i;++s)r[s+1]=o+=t[s].length;this.offsets=r}get[Symbol.toStringTag](){return"Column"}[Symbol.iterator](){const t=this.data;return t.length===1?t[0][Symbol.iterator]():Y4e(t)}at(t){const{data:n,offsets:i}=this,r=XL(i,t)-1;return n[r]?.at(t-i[r])}get(t){return this.at(t)}toArray(){const{length:t,nullCount:n,data:i}=this,r=!n&&w4e(i[0]),s=i.length;if(r&&s===1)return i[0].values;const o=!s||n>0?Array:i[0].constructor.ArrayType??i[0].values.constructor,a=new o(t);return r?X4e(a,i):Q4e(a,i)}cache(){return this._cache??(this._cache=this.toArray())}}function*Y4e(e){for(let t=0;t<e.length;++t){const n=e[t][Symbol.iterator]();for(let i=n.next();!i.done;i=n.next())yield i.value}}function X4e(e,t){for(let n=0,i=0;n<t.length;++n){const{values:r}=t[n];e.set(r,i),i+=r.length}return e}function Q4e(e,t){let n=-1;for(let i=0;i<t.length;++i){const r=t[i];for(let s=0;s<r.length;++s)e[++n]=r.at(s)}return e}class nN{constructor(t,n,i=!1){const r=t.fields.map(o=>o.name);this.schema=t,this.names=r,this.children=n,this.factory=i?gT:Gee;const s=[];this.getFactory=o=>s[o]??(s[o]=this.factory(r,n.map(a=>a.data[o])))}get[Symbol.toStringTag](){return"Table"}get numCols(){return this.names.length}get numRows(){return this.children[0]?.length??0}getChildAt(t){return this.children[t]}getChild(t){const n=this.names.findIndex(i=>i===t);return n>-1?this.children[n]:void 0}selectAt(t,n=[]){const{children:i,factory:r,schema:s}=this,{fields:o}=s;return new nN({...s,fields:t.map((a,l)=>J4e(o[a],n[l]))},t.map(a=>i[a]),r===gT)}select(t,n){const i=this.names,r=t.map(s=>i.indexOf(s));return this.selectAt(r,n)}toColumns(){const{children:t,names:n}=this,i={};return n.forEach((r,s)=>i[r]=t[s]?.toArray()??[]),i}toArray(){const{children:t,getFactory:n,numRows:i}=this,r=t[0]?.data??[],s=Array(i);for(let o=0,a=-1;o<r.length;++o){const l=n(o);for(let u=0;u<r[o].length;++u)s[++a]=l(u)}return s}*[Symbol.iterator](){const{children:t,getFactory:n}=this,i=t[0]?.data??[];for(let r=0;r<i.length;++r){const s=n(r);for(let o=0;o<i[r].length;++o)yield s(o)}}at(t){const{children:n,getFactory:i,numRows:r}=this;if(t<0||t>=r)return null;const[{offsets:s}]=n,o=XL(s,t)-1;return i(o)(t-s[o])}get(t){return this.at(t)}}function J4e(e,t){return t!=null&&t!==e.name?{...e,name:t}:e}function Zee(e,t={}){const{typeId:n,bitWidth:i,precision:r,unit:s}=e,{useBigInt:o,useDate:a,useDecimalBigInt:l,useMap:u,useProxy:c}=t;switch(n){case re.Null:return Hee;case re.Bool:return S4e;case re.Int:case re.Time:case re.Duration:return o||i<64?av:yh;case re.Float:return r?av:b4e;case re.Date:return k6(s===r0.DAY?x4e:R4e,a&&P6);case re.Timestamp:return k6(s===vo.SECOND?E4e:s===vo.MILLISECOND?F4e:s===vo.MICROSECOND?A4e:D4e,a&&P6);case re.Decimal:return l?Uee:Wee;case re.Interval:return s===s0.DAY_TIME?P4e:s===s0.YEAR_MONTH?av:k4e;case re.FixedSizeBinary:return B4e;case re.Utf8:return I4e;case re.LargeUtf8:return _4e;case re.Binary:return T4e;case re.LargeBinary:return M4e;case re.BinaryView:return q4e;case re.Utf8View:return K4e;case re.List:return O4e;case re.LargeList:return L4e;case re.Map:return u?H4e:z4e;case re.ListView:return N4e;case re.LargeListView:return $4e;case re.FixedSizeList:return G4e;case re.Struct:return c?W4e:Qee;case re.RunEndEncoded:return U4e;case re.Dictionary:return j4e;case re.Union:return e.mode?V4e:Xee}throw new Error(FR(n))}function k6(e,t){return t?class extends t{constructor(i){super(new e(i))}}:e}function mT(e,t,n){e[t]=n,e[t+1]=n>>8,e[t+2]=n>>16,e[t+3]=n>>24}const rw=1024;class Z4e{constructor(t){this.sink=t,this.minalign=1,this.buf=new Uint8Array(rw),this.space=rw,this.vtables=[],this.outputBytes=0}offset(){return this.buf.length-this.space}writeInt8(t){this.buf[this.space-=1]=t}writeInt16(t){this.buf[this.space-=2]=t,this.buf[this.space+1]=t>>8}writeInt32(t){mT(this.buf,this.space-=4,t)}writeInt64(t){const n=BigInt(t);this.writeInt32(Number(BigInt.asIntN(32,n>>BigInt(32)))),this.writeInt32(Number(BigInt.asIntN(32,n)))}addInt8(t){tl(this,1,0),this.writeInt8(t)}addInt16(t){tl(this,2,0),this.writeInt16(t)}addInt32(t){tl(this,4,0),this.writeInt32(t)}addInt64(t){tl(this,8,0),this.writeInt64(t)}addOffset(t){tl(this,of,0),this.writeInt32(this.offset()-t+of)}addObject(t,n){const i=e8e(this,t);return n?.(i),i.finish()}addVector(t,n,i,r){const s=t?.length;if(!s)return 0;tl(this,of,n*s),tl(this,i,n*s);for(let o=s;--o>=0;)r(this,t[o]);return this.writeInt32(s),this.offset()}addOffsetVector(t){return this.addVector(t,4,4,(n,i)=>n.addOffset(i))}addString(t){if(t==null)return 0;const n=$ee(t),i=n.length;return this.addInt8(0),tl(this,of,i),this.buf.set(n,this.space-=i),this.writeInt32(i),this.offset()}finish(t){tl(this,this.minalign,of),this.addOffset(t)}flush(){const{buf:t,sink:n}=this,i=t.subarray(this.space,t.length);n.write(i),this.outputBytes+=i.byteLength,this.minalign=1,this.vtables=[],this.buf=new Uint8Array(rw),this.space=rw}addBuffer(t){const n=t.byteLength;if(!n)return 0;this.sink.write(t),this.outputBytes+=n;const i=(n+7&-8)-n;return this.addPadding(i),n+i}addPadding(t){t>0&&(this.sink.write(new Uint8Array(t)),this.outputBytes+=t)}}function tl(e,t,n){let{buf:i,space:r,minalign:s}=e;t>s&&(e.minalign=t);const o=i.length,a=o-r+n,l=~a+1&t-1;i=Fee(i,a+l+t-1,!0),r+=i.length-o;for(let u=0;u<l;++u)i[--r]=0;e.buf=i,e.space=r}function e8e(e,t){const n=Array(t).fill(0),i=e.offset();function r(s){n[s]=e.offset()}return{addInt8(s,o,a){o!=a&&(e.addInt8(o),r(s))},addInt16(s,o,a){o!=a&&(e.addInt16(o),r(s))},addInt32(s,o,a){o!=a&&(e.addInt32(o),r(s))},addInt64(s,o,a){o!=a&&(e.addInt64(o),r(s))},addOffset(s,o,a){o!=a&&(e.addOffset(o),r(s))},finish(){e.addInt32(0);const s=e.offset();let o=t;for(;--o>=0&&n[o]===0;);const a=o+1;for(;o>=0;--o)e.addInt16(n[o]?s-n[o]:0);const l=2;e.addInt16(s-i);const u=(a+l)*oD;e.addInt16(u);let c=0;const{buf:d,vtables:h,space:p}=e;e:for(o=0;o<h.length;++o){const g=d.length-h[o];if(u==aD(d,g)){for(let v=oD;v<u;v+=oD)if(aD(d,p+v)!=aD(d,g+v))continue e;c=h[o];break}}if(c)e.space=d.length-s,mT(d,e.space,c-s);else{const g=e.offset();h.push(g),mT(d,d.length-s,g-s)}return s}}}function ete(e,t){const{nodes:n,regions:i,variadic:r}=t,s=e.addVector(n,16,8,(l,u)=>(l.writeInt64(u.nullCount),l.writeInt64(u.length),l.offset())),o=e.addVector(i,16,8,(l,u)=>(l.writeInt64(u.length),l.writeInt64(u.offset),l.offset())),a=e.addVector(r,8,8,(l,u)=>l.addInt64(u));return e.addObject(5,l=>{l.addInt64(0,n[0].length,0),l.addOffset(1,s,0),l.addOffset(2,o,0),l.addOffset(4,a,0)})}function t8e(e,t){const n=ete(e,t.data);return e.addObject(3,i=>{i.addInt64(0,t.id,0),i.addOffset(1,n,0),i.addInt8(2,+t.isDelta,0)})}function iN(e,t){return t?.size>0?e.addOffsetVector(Array.from(t,([n,i])=>{const r=e.addString(`${n}`),s=e.addString(`${i}`);return e.addObject(2,o=>{o.addOffset(0,r,0),o.addOffset(1,s,0)})})):0}function Ww(e,t){switch(mC(t.typeId,re,FR)){case re.Dictionary:return f8e(e,t);case re.Int:return a8e(e,t);case re.Float:return o8e(e,t);case re.Decimal:return i8e(e,t);case re.Date:return n8e(e,t);case re.Time:return c8e(e,t);case re.Timestamp:return d8e(e,t);case re.Interval:return l8e(e,t);case re.Duration:return r8e(e,t);case re.FixedSizeBinary:case re.FixedSizeList:return s8e(e,t);case re.Map:return u8e(e,t);case re.Union:return h8e(e,t)}return e.addObject(0)}function n8e(e,t){return e.addObject(1,n=>{n.addInt16(0,t.unit,r0.MILLISECOND)})}function i8e(e,t){return e.addObject(3,n=>{n.addInt32(0,t.precision,0),n.addInt32(1,t.scale,0),n.addInt32(2,t.bitWidth,128)})}function r8e(e,t){return e.addObject(1,n=>{n.addInt16(0,t.unit,vo.MILLISECOND)})}function s8e(e,t){return e.addObject(1,n=>{n.addInt32(0,t.stride,0)})}function o8e(e,t){return e.addObject(1,n=>{n.addInt16(0,t.precision,ER.HALF)})}function a8e(e,t){return e.addObject(2,n=>{n.addInt32(0,t.bitWidth,0),n.addInt8(1,+t.signed,0)})}function l8e(e,t){return e.addObject(1,n=>{n.addInt16(0,t.unit,s0.YEAR_MONTH)})}function u8e(e,t){return e.addObject(1,n=>{n.addInt8(0,+t.keysSorted,0)})}function c8e(e,t){return e.addObject(2,n=>{n.addInt16(0,t.unit,vo.MILLISECOND),n.addInt32(1,t.bitWidth,32)})}function d8e(e,t){const n=e.addString(t.timezone);return e.addObject(2,i=>{i.addInt16(0,t.unit,vo.SECOND),i.addOffset(1,n,0)})}function h8e(e,t){const n=e.addVector(t.typeIds,4,4,(i,r)=>i.addInt32(r));return e.addObject(2,i=>{i.addInt16(0,t.mode,wee.Sparse),i.addOffset(1,n,0)})}function f8e(e,t){return e.addObject(4,n=>{n.addInt64(0,t.id,0),n.addOffset(1,Ww(e,t.indices),0),n.addInt8(2,+t.ordered,0)})}const p8e=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;function tte(e,t){const{fields:n,metadata:i}=t,r=n.map(a=>nte(e,a)),s=e.addOffsetVector(r),o=iN(e,i);return e.addObject(4,a=>{a.addInt16(0,+!p8e,0),a.addOffset(1,s,0),a.addOffset(2,o,0)})}function nte(e,t){const{name:n,nullable:i,type:r,metadata:s}=t;let{typeId:o}=r,a=0,l=0;if(o!==re.Dictionary)a=Ww(e,r);else{const p=r.dictionary;o=p.typeId,l=Ww(e,r),a=Ww(e,p)}const u=(r.children||[]).map(p=>nte(e,p)),c=e.addOffsetVector(u),d=iN(e,s),h=e.addString(n);return e.addObject(7,p=>{p.addOffset(0,h,0),p.addInt8(1,+i,0),p.addInt8(2,o,re.NONE),p.addOffset(3,a,0),p.addOffset(4,l,0),p.addOffset(5,c,0),p.addOffset(6,d,0)})}function g8e(e,t,n,i,r){const s=iN(e,r),o=e.addVector(i,24,8,T6),a=e.addVector(n,24,8,T6),l=tte(e,t);e.finish(e.addObject(5,c=>{c.addInt16(0,i0.V5,i0.V1),c.addOffset(1,l,0),c.addOffset(2,a,0),c.addOffset(3,o,0),c.addOffset(4,s,0)}));const u=e.offset();e.addInt32(0),e.addInt32(-1),e.flush(),e.sink.write(new Uint8Array(Int32Array.of(u).buffer)),e.sink.write(yee)}function T6(e,{offset:t,metadataLength:n,bodyLength:i}){return e.writeInt64(i),e.writeInt32(0),e.writeInt32(n),e.writeInt64(t),e.offset()}function uD(e,t,n,i,r){e.finish(e.addObject(5,l=>{l.addInt16(0,i0.V5,i0.V1),l.addInt8(1,t,Vw.NONE),l.addOffset(2,n,0),l.addInt64(3,i,0)}));const s=8,o=e.offset(),a=o+s+7&-8;r?.push({offset:e.outputBytes,metadataLength:a,bodyLength:i}),e.addInt32(a-s),e.addInt32(-1),e.flush(),e.addPadding(a-o-s)}class m8e{write(t){}pad(t){this.write(new Uint8Array(t))}finish(){return null}}class v8e extends m8e{constructor(){super(),this.buffers=[]}write(t){this.buffers.push(t)}finish(){const t=this.buffers,n=t.reduce((r,s)=>r+s.byteLength,0),i=new Uint8Array(n);for(let r=0,s=0;r<t.length;++r)i.set(t[r],s),s+=t[r].byteLength;return i}}const M6="stream",I6="file";function C8e(e,{sink:t,format:n=M6}={}){if(n!==M6&&n!==I6)throw new Error(`Unrecognized Arrow IPC format: ${n}`);const{schema:i,dictionaries:r=[],records:s=[],metadata:o}=e,a=new Z4e(t||new v8e),l=n===I6,u=[],c=[];l&&a.addBuffer(yee),i&&uD(a,Vw.Schema,tte(a,i),0);for(const d of r){const{data:h}=d;uD(a,Vw.DictionaryBatch,t8e(a,d),h.byteLength,u),_6(a,h.buffers)}for(const d of s)uD(a,Vw.RecordBatch,ete(a,d),d.byteLength,c),_6(a,d.buffers);return a.addBuffer(OWe),l&&g8e(a,i,u,c,o),a.sink}function _6(e,t){for(let n=0;n<t.length;++n)e.addBuffer(t[n])}function y8e(e,t){typeof t=="string"&&(t={format:t});const n=e.children;w8e(n);const{dictionaries:i,idMap:r}=S8e(n),s=R8e(n),a={schema:x8e(e.schema,r),dictionaries:i,records:s};return C8e(a,t).finish()}function w8e(e){const t=e[0]?.data.map(n=>n.length);e.forEach(({data:n})=>{if(n.length!==t.length||n.some((i,r)=>i.length!==t[r]))throw new Error("Columns have inconsistent batch sizes.")})}function b8e(){let e=0;const t=[],n=[],i=[],r=[];return{node(s,o){t.push({length:s,nullCount:o})},buffer(s){const o=s.byteLength,a=o+7&-8;n.push({offset:e,length:a}),e+=a,i.push(new Uint8Array(s.buffer,s.byteOffset,o))},variadic(s){r.push(s)},children(s,o){s.children.forEach((a,l)=>{rte(a.type,o.children[l],this)})},done(){return{byteLength:e,nodes:t,regions:n,variadic:r,buffers:i}}}}function S8e(e){const t=[],n=new Map,i=new Map;let r=-1;const s=o=>{if(n.has(o))i.set(o.type,n.get(o));else{n.set(o,++r);for(let a=0;a<o.data.length;++a)t.push({id:r,isDelta:a>0,data:ite([o],a)});i.set(o.type,r)}};return e.forEach(o=>vT(o.data[0],s)),{dictionaries:t,idMap:i}}function vT(e,t){if(e?.type.typeId===re.Dictionary){const n=e.dictionary;t(n),vT(n.data[0],t)}e?.children?.forEach(n=>vT(n,t))}function x8e(e,t){if(!t.size)return e;const n=s=>{s.typeId===re.Dictionary&&(s.id=t.get(s.dictionary),r(s)),s.children&&(s.children=s.children.slice()).forEach(i)},i=(s,o,a)=>{const l={...s.type};a[o]={...s,type:l},n(l)},r=s=>{const o={...s.dictionary};s.dictionary=o,n(o)};return e={...e,fields:e.fields.slice()},e.fields.forEach(i),e}function R8e(e){return(e[0]?.data||[]).map((t,n)=>ite(e,n))}function ite(e,t=0){const n=b8e();return e.forEach(i=>{rte(i.type,i.data[t],n)}),n.done()}function rte(e,t,n){const{typeId:i}=e;if(i!==re.Null)switch(n.node(t.length,t.nullCount),i){case re.Bool:case re.Int:case re.Time:case re.Duration:case re.Float:case re.Date:case re.Timestamp:case re.Decimal:case re.Interval:case re.FixedSizeBinary:case re.Dictionary:n.buffer(t.validity),n.buffer(t.values);return;case re.Utf8:case re.LargeUtf8:case re.Binary:case re.LargeBinary:n.buffer(t.validity),n.buffer(t.offsets),n.buffer(t.values);return;case re.BinaryView:case re.Utf8View:n.buffer(t.validity),n.buffer(t.values),n.variadic(t.data.length),t.data.forEach(r=>n.buffer(r));return;case re.List:case re.LargeList:case re.Map:n.buffer(t.validity),n.buffer(t.offsets),n.children(e,t);return;case re.ListView:case re.LargeListView:n.buffer(t.validity),n.buffer(t.offsets),n.buffer(t.sizes),n.children(e,t);return;case re.FixedSizeList:case re.Struct:n.buffer(t.validity),n.children(e,t);return;case re.RunEndEncoded:n.children(e,t);return;case re.Union:{n.buffer(t.typeIds),e.mode===wee.Dense&&n.buffer(t.offsets),n.children(e,t);return}default:throw new Error(FR(i))}}function Bs(e){return new ste(e)}let ste=class{constructor(t=fg){this.buf=new t(512)}array(t){return GWe(this.buf,t)}prep(t){t>=this.buf.length&&(this.buf=Fee(this.buf,t))}get(t){return this.buf[t]}set(t,n){this.prep(n),this.buf[n]=t}write(t,n){this.prep(n+t.length),this.buf.set(t,n)}};function ote(){return new E8e}class E8e extends ste{set(t){const n=t>>3;this.prep(n),this.buf[n]|=1<<t%8}}class rN{constructor(t,n){this.type=t,this.ctx=n,this.batchClass=n.batchType(t)}init(){return this.index=-1,this}set(t,n){return this.index=n,!1}done(){return null}batch(){const t=new this.batchClass(this.done());return this.init(),t}}class Bo extends rN{constructor(t,n){super(t,n)}init(){return this.nullCount=0,this.validity=ote(),super.init()}set(t,n){this.index=n;const i=t!=null;return i?this.validity.set(n):this.nullCount++,i}done(){const{index:t,nullCount:n,type:i,validity:r}=this;return{length:t+1,nullCount:n,type:i,validity:n?r.array((t>>3)+1):new fg(0)}}}function F8e(){const e=new Map,t=new Set;return{get(n,i){const r=n.id;if(r>=0&&e.has(r))return e.get(r);{const s=A8e(n,i);return r>=0&&e.set(r,s),t.add(s),s}},finish(n){t.forEach(i=>i.finish(n))}}}function A8e(e,t){const n=Object.create(null),i=t.builder(e.dictionary),r=[];i.init();let s=-1;return{type:e,values:i,add(o){return r.push(o),o},key(o){const a=PR(o);let l=n[a];return l===void 0&&(n[a]=l=++s,i.set(o,l)),l},finish(o){const a=e.dictionary,l=new(Zee(a,o))(i.done()),u=new tN([l]);r.forEach(c=>c.setDictionary(u))}}}class D8e extends Bo{constructor(t,n){super(t,n),this.dict=n.dictionary(t)}init(){return this.values=Bs(this.type.indices.values),super.init()}set(t,n){super.set(t,n)&&this.values.set(this.dict.key(t),n)}done(){return{...super.done(),values:this.values.array(this.index+1)}}batch(){return this.dict.add(super.batch())}}function P8e(e){const t=CT();return e(n=>t.add(n)),t.type()}function CT(){let e=0,t=0,n=0,i=0,r=0,s=0,o=0,a=0,l=0,u=0,c=0,d=1/0,h=-1/0,p=1/0,g=-1/0,v,C,y,b={};return{add(S){if(e++,S==null){t++;return}switch(typeof S){case"string":l++;break;case"number":i++,S<d&&(d=S),S>h&&(h=S),Number.isInteger(S)&&r++;break;case"bigint":s++,v===void 0?v=C=S:(S<v&&(v=S),S>C&&(C=S));break;case"boolean":n++;break;case"object":if(S instanceof Date)o++,+S%864e5===0&&a++;else if(Ree(S)){u++;const x=S.length;x<p&&(p=x),x>g&&(g=x),y??=CT(),S.forEach(y.add)}else{c++;for(const x in S)(b[x]??(b[x]=CT())).add(S[x])}}},type(){const S=e-t;return S===0?UWe():r===S?T8e(d,h):i===S?JL():s===S?M8e(v,C):n===S?JWe():a===S?e4e():o===S?t4e():l===S?WWe(QWe()):u===S?k8e(y.type(),p,g):c===S?i4e(Object.entries(b).map(x=>AR(x[0],x[1].type()))):I8e()}}}function k8e(e,t,n){return n===t?r4e(e,t):n4e(e)}function T8e(e,t){const n=Math.max(Math.abs(e)-1,t);return n<128?Mee():n<32768?Iee():n<2**31?QL():JL()}function M8e(e,t){const n=-e>t?-e-1n:t;if(n>=2**63)throw new Error(`BigInt exceeds 64 bits: ${n}`);return _ee()}function I8e(){throw new Error("Mixed types detected, please define a union type.")}class ate extends Bo{constructor(t,n){super(t,n),this.toOffset=Nee(t.offsets)}init(){return this.offsets=Bs(this.type.offsets),this.values=Bs(),this.pos=0,super.init()}set(t,n){const{offsets:i,values:r,toOffset:s}=this;super.set(t,n)&&(r.write(t,this.pos),this.pos+=t.length),i.set(s(this.pos),n+1)}done(){return{...super.done(),offsets:this.offsets.array(this.index+2),values:this.values.array(this.pos+1)}}}class _8e extends Bo{constructor(t,n){super(t,n)}init(){return this.values=ote(),super.init()}set(t,n){super.set(t,n),t&&this.values.set(n)}done(){return{...super.done(),values:this.values.array((this.index>>3)+1)}}}class O8e extends Bo{constructor(t,n){super(t,n),this.scale=10**t.scale,this.stride=t.bitWidth>>6}init(){return this.values=Bs(this.type.values),super.init()}set(t,n){const{scale:i,stride:r,values:s}=this;super.set(t,n)&&(s.prep((n+1)*r),d4e(t,s.buf,n*r,r,i))}done(){const{index:t,stride:n,values:i}=this;return{...super.done(),values:i.array((t+1)*n)}}}class L8e extends Bo{constructor(t,n){super(t,n),this.stride=t.stride}init(){return this.values=Bs(),super.init()}set(t,n){super.set(t,n)&&this.values.write(t,n*this.stride)}done(){const{stride:t,values:n}=this;return{...super.done(),values:n.array(t*(this.index+1))}}}class N8e extends Bo{constructor(t,n){super(t,n),this.child=n.builder(this.type.children[0].type),this.stride=t.stride}init(){return this.child.init(),super.init()}set(t,n){const{child:i,stride:r}=this,s=n*r;if(super.set(t,n))for(let o=0;o<r;++o)i.set(t[o],s+o);else i.index=s+r}done(){const{child:t}=this;return{...super.done(),children:[t.batch()]}}}class $8e extends Bo{init(){return this.values=Bs(this.type.values),super.init()}set(t,n){if(super.set(t,n)){const i=n<<1;this.values.set(t[0],i),this.values.set(t[1],i+1)}}done(){return{...super.done(),values:this.values.array(this.index+1<<1)}}}class B8e extends Bo{init(){return this.values=Bs(),super.init()}set(t,n){super.set(t,n)&&this.values.write(c4e(t),n<<4)}done(){return{...super.done(),values:this.values.array(this.index+1<<4)}}}class lte extends Bo{constructor(t,n,i){super(t,n),this.child=i}init(){this.child.init();const t=this.type.offsets;return this.offsets=Bs(t),this.toOffset=Nee(t),this.pos=0,super.init()}done(){return{...super.done(),offsets:this.offsets.array(this.index+2),children:[this.child.batch()]}}}class G8e extends lte{constructor(t,n){super(t,n,n.builder(t.children[0].type))}set(t,n){const{child:i,offsets:r,toOffset:s}=this;super.set(t,n)&&t.forEach(o=>i.set(o,this.pos++)),r.set(s(this.pos),n+1)}}class ute extends Bo{constructor(t,n){super(t,n),this.children=t.children.map(i=>n.builder(i.type))}init(){return this.children.forEach(t=>t.init()),super.init()}done(){const{children:t}=this;return t.forEach(n=>n.index=this.index),{...super.done(),children:t.map(n=>n.batch())}}}class z8e extends ute{constructor(t,n){super(t,n),this.setters=this.children.map((i,r)=>{const s=t.children[r].name;return(o,a)=>i.set(o?.[s],a)})}set(t,n){super.set(t,n);const i=this.setters;for(let r=0;r<i.length;++r)i[r](t,n)}}class H8e extends lte{constructor(t,n){super(t,n,new V8e(t.children[0].type,n))}set(t,n){const{child:i,offsets:r,toOffset:s}=this;if(super.set(t,n))for(const o of t)i.set(o,this.pos++);r.set(s(this.pos),n+1)}}class V8e extends ute{set(t,n){super.set(t,n);const[i,r]=this.children;i.set(t[0],n),r.set(t[1],n)}}const W8e={};class U8e extends rN{constructor(t,n){super(t,n),this.children=t.children.map(i=>n.builder(i.type))}init(){return this.pos=0,this.key=null,this.value=W8e,this.children.forEach(t=>t.init()),super.init()}next(){const[t,n]=this.children;t.set(this.index+1,this.pos),n.set(this.value,this.pos++)}set(t,n){if(t!==this.value){const i=PR(t);i!==this.key&&(this.key&&this.next(),this.key=i,this.value=t)}this.index=n}done(){this.next();const{children:t,index:n,type:i}=this;return{length:n+1,nullCount:0,type:i,children:t.map(r=>r.batch())}}}class cte extends rN{constructor(t,n){super(t,n),this.children=t.children.map(i=>n.builder(i.type)),this.typeMap=t.typeMap,this.lookup=t.typeIdForValue}init(){return this.nullCount=0,this.typeIds=Bs(KL),this.children.forEach(t=>t.init()),super.init()}set(t,n){const{children:i,lookup:r,typeMap:s,typeIds:o}=this;this.index=n;const a=r(t,n),l=i[s[a]];o.set(a,n),t==null&&++this.nullCount,this.update(t,n,l)}done(){const{children:t,nullCount:n,type:i,typeIds:r}=this,s=this.index+1;return{length:s,nullCount:n,type:i,typeIds:r.array(s),children:t.map(o=>o.batch())}}}class j8e extends cte{update(t,n,i){i.set(t,n),this.children.forEach(r=>{r!==i&&r.set(null,n)})}}class q8e extends cte{init(){return this.offsets=Bs(this.type.offsets),super.init()}update(t,n,i){const r=i.index+1;i.set(t,r),this.offsets.set(r,n)}done(){return{...super.done(),offsets:this.offsets.array(this.index+1)}}}class K8e extends ate{set(t,n){super.set(t&&$ee(t),n)}}class lv extends Bo{constructor(t,n){super(t,n),this.values=Bs(t.values)}init(){return this.values=Bs(this.type.values),super.init()}set(t,n){super.set(t,n)&&this.values.set(t,n)}done(){return{...super.done(),values:this.values.array(this.index+1)}}}class Y8e extends lv{set(t,n){super.set(t==null?t:gl(t),n)}}class cD extends lv{constructor(t,n,i){super(t,n),this.transform=i}set(t,n){super.set(t==null?t:this.transform(t),n)}}function dte(e={},t=F8e()){return{batchType:n=>Zee(n,e),builder(n){return hte(n,this)},dictionary(n){return t.get(n,this)},finish:()=>t.finish(e)}}function hte(e,t=dte()){const{typeId:n}=e;switch(n){case re.Int:case re.Time:case re.Duration:return YL(e.values)?new Y8e(e,t):new lv(e,t);case re.Float:return e.precision?new lv(e,t):new cD(e,t,p4e);case re.Binary:case re.LargeBinary:return new ate(e,t);case re.Utf8:case re.LargeUtf8:return new K8e(e,t);case re.Bool:return new _8e(e,t);case re.Decimal:return new O8e(e,t);case re.Date:return new cD(e,t,e.unit?gl:l4e);case re.Timestamp:return new cD(e,t,u4e(e.unit));case re.Interval:switch(e.unit){case s0.DAY_TIME:return new $8e(e,t);case s0.MONTH_DAY_NANO:return new B8e(e,t)}return new lv(e,t);case re.List:case re.LargeList:return new G8e(e,t);case re.Struct:return new z8e(e,t);case re.Union:return e.mode?new q8e(e,t):new j8e(e,t);case re.FixedSizeBinary:return new L8e(e,t);case re.FixedSizeList:return new N8e(e,t);case re.Map:return new H8e(e,t);case re.RunEndEncoded:return new U8e(e,t);case re.Dictionary:return new D8e(e,t)}throw new Error(FR(n))}function fte(e,t,n={},i){const r=HWe(e)?l=>{for(const u of e)l(u)}:e;t??=P8e(r);const{maxBatchRows:s=1/0,...o}=n;let a;if(t.typeId===re.Null){let l=0;r(()=>++l),a=X8e(t,l,s)}else{const l=dte(o,i),u=hte(t,l).init(),c=h=>a.push(h.batch());a=[];let d=0;r(h=>{u.set(h,d++),d>=s&&(c(u),d=0)}),d&&c(u),l.finish()}return new tN(a,t)}function X8e(e,t,n){const i=[],r=a=>new Hee({length:a,nullCount:a,type:e}),s=Math.floor(t/n);for(let a=0;a<s;++a)i.push(r(n));const o=t%n;return o&&i.push(r(o)),i}function Q8e(e,t,n={},i){return!t&&xee(e)?J8e(e,n):fte(r=>e.forEach(r),t,n,i)}function J8e(e,{maxBatchRows:t,useBigInt:n}){const i=e.constructor,r=Z8e(i),s=e.length,o=Math.min(t||1/0,s),a=Math.floor(s/o),l=[],u=YL(i)&&!n?yh:av,c=(h,p)=>l.push(new u({length:p-h,nullCount:0,type:r,validity:new fg(0),values:e.subarray(h,p)}));let d=0;for(let h=0;h<a;++h)c(d,d+=o);return d<s&&c(d,s),new tN(l)}function Z8e(e){switch(e){case See:return XWe();case gC:return JL();case KL:return Mee();case bee:return Iee();case pg:return QL();case gg:return _ee();case fg:return jWe();case UL:return qWe();case jL:return KWe();case qL:return YWe()}}function eUe(e,t){const n=[],i=Array.isArray(e)?e:Object.entries(e),r=i[0]?.[1].length,s=i.map(([a,l])=>{if(l.length!==r)throw new Error("All columns must have the same length.");return n.push(AR(a,l.type)),l}),o={version:i0.V5,endianness:LWe.Little,fields:n,metadata:null};return new nN(o,s,t)}function CC(e,t){return vi(t)?t(e):t||e.columnNames()}function pte(e,t={}){const{columns:n,limit:i=1/0,offset:r=0,types:s={},...o}=t,a=CC(e,n),l=e.data(),u=r===0&&e.numRows()<=i&&!e.isFiltered()&&!e.isOrdered();return eUe(a.map(c=>{const d=l[c],h=s[c],p=Ec(d);let g;if(u&&(p||vi(d.toArray)))g=Q8e(p?d:d.toArray(),h,o);else{const v=p?C=>d[C]:C=>d.at(C);g=fte(C=>e.scan(y=>C(v(y)),!0,i,r),h,o)}return[c,g]}))}function tUe(e,t={}){const{format:n="stream",...i}=t;return y8e(pte(e,i),{format:n})}function Qd(e){return e}function sN(e,t,n=100,i,r){const{start:s=Qd,cell:o,end:a=Qd}=r,l=e.data(),u=t.length;e.scan(c=>{s(c);for(let d=0;d<u;++d){const h=t[d];o(l[h].at(c),h,d)}a(c)},!0,n,i)}function nUe(e,t={}){const n=CC(e,t.columns),i=t.format||{},r=t.delimiter||",",s=t.header??!0,o=new RegExp(`["${r}
\r]`),a=c=>c==null?"":rc(c)?mR(c,!0):o.test(c+="")?'"'+c.replace(/"/g,'""')+'"':c,l=n.map(a);let u=s?l.join(r)+`
`:"";return sN(e,n,t.limit||1/0,t.offset,{cell(c,d,h){l[h]=a(i[d]?i[d](c):c)},end(){u+=l.join(r)+`
`}}),u}function iUe(e,t,n={}){for(const i in e)n[i]=t(e[i],i);return n}function rUe(e){return e.getUTCHours()===0&&e.getUTCMinutes()===0&&e.getUTCSeconds()===0&&e.getUTCMilliseconds()===0}function sUe(e,t={}){let n=0,i=0,r=0,s=0,o=0,a=0;return e(l=>{if(++n,l==null){++i;return}const u=typeof l;if(u==="object"&&rc(l))++r,rUe(l)&&++s;else if(u==="number"&&(++o,l===l&&(l|0)!==l)){const c=l+"",d=c.indexOf(".");if(d>=0){const h=c.indexOf("e"),p=h>0?h:c.length;a=Math.max(a,p-d-1)}}}),{align:(i+o+r)/n>.5?"r":"l",format:{utc:r===s,digits:Math.min(a,t.maxdigits||6)}}}function gte(e,t,n){const i=n.format||{},r=n.align||{},s={},o={};return t.forEach(a=>{const l=sUe(oUe(e,a),n);o[a]=r[a]||l.align,s[a]=i[a]||l.format}),{align:o,format:s}}function oUe(e,t){const n=e.column(t);return i=>e.scan(r=>i(n.at(r)))}function mte(e,t={}){if(vi(t))return t(e)+"";const n=typeof e;if(n==="object"){if(rc(e))return t.utc?mR(e):_J(e);{const i=JSON.stringify(e,(s,o)=>gR(o)?Array.from(o):o),r=t.maxlen||30;return i.length>r?i.slice(0,28)+"…"+(i[0]==="["?"]":"}"):i}}else if(n==="number"){const i=t.digits||0;let r;return e!==0&&((r=Math.abs(e))>=1e18||r<Math.pow(10,-i))?e.toExponential(i):e.toFixed(i)}else return e+""}function aUe(e,t={}){const n=CC(e,t.columns),{align:i,format:r}=gte(e,n,t),s=lUe(t),o=t.null,a=v=>v==="c"?"center":v==="r"?"right":"left",l=v=>v.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),u=(v,C)=>l(mte(v,C)),c=o?(v,C)=>v==null?o(v):u(v,C):u;let d=-1,h=-1;const p=(v,C,y)=>{const b=y?a(i[C]):"",S=s[v]&&s[v](C,h,d)||"",x=(b?`text-align: ${b};`+(S?" ":""):"")+S;return`<${v}${x?` style="${x}"`:""}>`};let g=p("table")+p("thead")+p("tr",d)+n.map(v=>`${p("th",v,1)}${v}</th>`).join("")+"</tr></thead>"+p("tbody");return sN(e,n,t.limit,t.offset,{start(v){d=v,++h,g+=p("tr")},cell(v,C){g+=p("td",C,1)+c(v,r[C])+"</td>"},end(){g+="</tr>"}}),g+"</tbody></table>"}function lUe(e){return iUe(e.style,t=>vi(t)?t:()=>t)}const O6={},ef={},sw=34,hm=10,L6=13,uUe="columns",cUe="ndjson",dUe=e=>rc(e)?mR(e,!0):e;function hUe(e,{type:t,columns:n,format:i={},limit:r,offset:s}={}){const o=CC(e,n),a=o.map(u=>i[u]||dUe),l=u=>e.scan(u,!0,r,s);return t===uUe?fUe(e,o,a,l):pUe(e,o,a,l,t===cUe)}function fUe(e,t,n,i){let r="{";return t.forEach((s,o)=>{r+=(o?",":"")+JSON.stringify(s)+":[";const a=e.column(s),l=n[o];let u=-1;i(c=>{const d=a.at(c);r+=(++u?",":"")+JSON.stringify(l(d))}),r+="]"}),r+"}"}function pUe(e,t,n,i,r=!1){const s=t.length,o=t.map(h=>`"${h}":`),a=t.map(h=>e.column(h)),l=r?h=>h.replaceAll(`
`,""):Qd,u=r?`
`:",";let c=r?"":"[",d=-1;return i(h=>{const p=[];for(let g=0;g<s;++g)p.push(o[g]+JSON.stringify(n[g](a[g].at(h))));c+=(++d?u:"")+l(`{${p.join(",")}}`)}),c+(r?"":"]")}function gUe(e,t={}){const n=CC(e,t.columns),{align:i,format:r}=gte(e,n,t),s=l=>l==="c"?":-:":l==="r"?"-:":":-",o=l=>l.replace(/\|/g,"\\|");let a="|"+n.map(o).join("|")+`|
|`+n.map(l=>s(i[l])).join("|")+`|
`;return sN(e,n,t.limit,t.offset,{start(){a+="|"},cell(l,u){a+=o(mte(l,r[u]))+"|"},end(){a+=`
`}}),a}class vte extends fT{assign(...t){return S6e(this,...t)}count(t={}){const{as:n="count"}=t;return n0(this,{[n]:GJ()})}derive(t,n){return T6e(this,t,n)}filter(t){return VL(this,t)}slice(t,n){return PWe(this,t,n)}groupby(...t){return BL(this,...t)}orderby(...t){return lWe(this,...t)}relocate(t,n){return cee(this,Ea(t),n)}rename(...t){return vWe(this,...t)}reduce(t){return mWe(this,t)}rollup(t){return n0(this,t)}sample(t,n){return RWe(this,t,n)}select(...t){return lee(this,...t)}ungroup(){return RR(this)}unorder(){return _We(this)}dedupe(...t){return xR(this,...t)}impute(t,n){return W6e(this,t,n)}fold(t,n){return H6e(this,t,n)}pivot(t,n,i){return dWe(this,t,n,i)}spread(t,n){return kWe(this,t,n)}unroll(t,n){return z6e(this,t,n)}lookup(t,n,...i){return iWe(this,t,n,...i)}join(t,n,i,r){return Vm(this,t,n,i,r)}join_left(t,n,i,r){const s={...r,left:!0,right:!1};return Vm(this,t,n,i,s)}join_right(t,n,i,r){const s={...r,left:!1,right:!0};return Vm(this,t,n,i,s)}join_full(t,n,i,r){const s={...r,left:!0,right:!0};return Vm(this,t,n,i,s)}cross(t,n,i){return X6e(this,t,n,i)}semijoin(t,n){return pee(this,t,n)}antijoin(t,n){return gee(this,t,n)}concat(...t){return uee(this,...t)}union(...t){return IWe(this,...t)}intersect(...t){return q6e(this,...t)}except(...t){return G6e(this,...t)}toArrow(t){return pte(this,t)}toArrowIPC(t){return tUe(this,t)}toCSV(t){return nUe(this,t)}toHTML(t){return aUe(this,t)}toJSON(t){return hUe(this,t)}toMarkdown(t){return gUe(this,t)}}function mUe(e){const t=e.slice(-3).toLowerCase();return t===".gz"?"gzip":t===".zz"?"deflate":null}async function vUe(e,{fetch:t=void 0,decompress:n=mUe(e)}={}){const i=await fetch(e,t).then(r=>r.body);return n?i.pipeThrough(new DecompressionStream(n)):i}function CUe(e){if(vi(e[Symbol.asyncIterator]))return e[Symbol.asyncIterator]();{const t=e.getReader();return{next(){return t.read()},[Symbol.asyncIterator](){return this}}}}function yUe(e){return e.slice(1,-1).replace(/""/g,'"')}function wUe(e=","){e.length!==1&&un(`Text delimiter should be a single character, found "${e}"`);const t=e.charCodeAt(0);let n=0,i=0,r=!1,s=!1,o=!1,a=!1,l=null,u=null,c=[];function d(p){u=u?u+p:p}function h(){if(r)return r=!1,O6;const p=n;let g;if(o||l.charCodeAt(p)===sw){let C=a&&l.charCodeAt(p)!==sw;if(a=!1,o=!0,!C){for(;++n<i;)if(l.charCodeAt(n)===sw)if(++n<i){if(l.charCodeAt(n)!==sw){C=!0;break}}else return d(l.slice(p,i)),a=!0,ef;if(!C)return d(l.slice(p,i)),ef}const y=yUe((u??"")+l.slice(p,n));return o=!1,u=null,n>=i?(u=y,ef):(g=l.charCodeAt(n++),g===hm?r=!0:g===L6&&(r=!0,n>=i?s=!0:l.charCodeAt(n)===hm&&++n),y)}let v;for(;n<i;){if(g=l.charCodeAt(v=n++),g===hm)r=!0;else if(g===L6)r=!0,n>=i?s=!0:l.charCodeAt(n)===hm&&++n;else if(g!==t)continue;return l.slice(p,v)}return d(l.slice(p,i)),ef}return{start(){},transform(p,g){l=p,i=l.length,n=0;const v=[];let C;if(s&&(l.charCodeAt(n)===hm&&++n,s=!1),u!=null)if((C=h())===ef){g.enqueue(v);return}else c.push((u??"")+C),u=null;for(;;)if((C=h())===ef){g.enqueue(v);return}else C===O6?(v.push(c),c=[]):c.push(C)},flush(p){(c.length||u)&&(u!=null&&c.push(u),p.enqueue([c]))}}}function bUe(e,t,n){return e>0?t?(i,r)=>r<e||n(i).startsWith(t):(i,r)=>r<e:t?i=>n(i).startsWith(t):null}function SUe(e,t,n=Qd){const i=bUe(e,t,n);if(!i)return null;let r=0;return{start(){},flush(){},transform(s,o){const a=s.length,l=new vL(a);for(let u=0;u<s.length;++u,++r)i(s[u],r)&&l.set(u);o.enqueue(l.count()?s.filter((u,c)=>!l.get(c)):s)}}}const xUe=[e=>e==="true"||e==="false",e=>e!=="false"],N6=[e=>e==="NaN"||(e=+e)===e,e=>+e],RUe=[OJ,e=>new Date(Date.parse(e))];function EUe(e){return e&&e!=="."?N6.map(t=>n=>t(n&&n.replace(e,"."))):N6}function FUe(e,t){const{decimal:n,limit:i=e.length}=t,r=[xUe,EUe(n),RUe],s=r.length;for(let o=0;o<s;++o){const[a,l]=r[o];if(AUe(e,a,i))return l}return Qd}function AUe(e,t,n){for(let i=0;i<n;++i){const r=e[i];if(r!=null&&!t(r))return!1}return!0}function DUe(e,t){let n=e;return t.forEach(i=>{i&&(n=n.pipeThrough(new TransformStream(i)))}),n}function PUe(e,t){const n={};return e.forEach((i,r)=>n[i]=t[r]),new vte(n,e)}async function kUe(e,t,n={}){const i=DUe(e,t),r=+n.autoMax||1e3,s=CUe(i),o=[];let a=0;for(;a<r;){const h=await s.next(),p=h.value;if(p?.length>0&&(o.push(p),a+=p.length),h.done)break}const{names:l,values:u,parsers:c}=TUe(o,n),d=l.length;for await(const h of s)for(let p=0;p<h.length;++p){const g=h[p];for(let v=0;v<d;++v)u[v].push(g[v]?c[v](g[v]):null)}return PUe(l,u)}function TUe(e,t){const[n]=e,i=n[0].length,r=+t.autoMax||1e3,s=sg(i,()=>[]);let o=t.header!==!1?n.shift():t.names;o=o?o.length<i?[...o,$6(i,o.length)]:o:$6(i);for(const l of e)for(let u=0;u<l.length;++u){const c=l[u];for(let d=0;d<i;++d)s[d].push(c[d]===""?null:c[d])}const a=MUe(o,s,{...t,limit:r});return a.forEach((l,u)=>{if(l===Qd)return;const c=s[u];for(let d=0;d<c.length;++d)c[d]!=null&&(c[d]=l(c[d]))}),{names:o,values:s,parsers:a}}function $6(e,t=0){return sg(e-t,n=>`col${n+t+1}`)}function MUe(e,t,n){const{parse:i={}}=n,r=n.autoType===!1;return e.map((s,o)=>vi(i[s])?i[s]:r?Qd:FUe(t[o],n))}async function IUe(e,t){return(await vUe(e,t)).pipeThrough(new TextDecoderStream)}async function _Ue(e,t){return kUe(e,LUe(t),t)}async function OUe(e,t){return _Ue(await IUe(e,t),t)}function LUe({delimiter:e=",",skip:t=0,comment:n=void 0}={}){return[wUe(e),SUe(t,n,i=>i[0])]}function B6(e,t={}){const n=`d[${JSON.stringify(e)}]`,{maxbins:i,nice:r,minstep:s,step:o,offset:a}=t,l=[i,r,s,o];let u=l.length;for(;u&&l[--u]==null;)l.pop();const c=l.length?", "+l.map(d=>d+"").join(", "):"";return`d => op.bin(${n}, ...op.bins(${n}${c}), ${a||0})`}function dD(e){return SR(e,{escape:!0,toString(){un("Escaped values can not be serialized.")}})}function NUe(e){return SR(e,{desc:!0})}function $Ue(e,t,n){return SR(e,{window:{frame:t||[-1/0,0],peers:!1}})}function G6(e,t){return n0(RR(e),{_:t}).get("_")}function BUe(e,t){const n=i=>un(`Illegal argument type: ${i||typeof e}`);return e instanceof Map?z6(e.entries(),t):rc(e)?n("Date"):kS(e)?n("RegExp"):$o(e)?n():ur(e)?GUe(e,t):vi(e[Symbol.iterator])?zUe(e,t):sc(e)?z6(Object.entries(e),t):n()}function z6(e,t=["key","value"]){const n=[],i=[];for(const[s,o]of e)n.push(s),i.push(o);const r={};return t[0]&&(r[t[0]]=n),t[1]&&(r[t[1]]=i),r}function GUe(e,t){const n=e.length,i={},r=s=>i[s]=Array(n);if(n){t=t||Object.keys(e[0]);const s=t.map(r),o=s.length;for(let a=0;a<n;++a){const l=e[a];for(let u=0;u<o;++u)s[u][a]=l[t[u]]}}else t&&t.forEach(r);return i}function zUe(e,t){const n={},i=o=>n[o]=[];let r,s;for(const o of e){r||(t=t||Object.keys(o),r=t.map(i),s=r.length);for(let a=0;a<s;++a)r[a].push(o[t[a]])}return!r&&t&&t.forEach(i),n}function H6(e,t){return new vte(BUe(e,t),t)}const Cte=Nde("DataSourcesStore",()=>{const e=pn({}),t=pn({});function n(g,v){return v in t.value?{alreadyExists:!0}:(t.value[v]={dataSourceKey:g,selection:null},{alreadyExists:!1})}function i(g,v){if(!(g in t.value))throw new Error(`Selection name ${g} not found`);t.value[g].selection=v,a.value=JSON.stringify(t.value)}function r(g){if(!(g in t.value))throw new Error(`Selection name ${g} not found`);return t.value[g].selection}function s(g){if(g===null)return null;const v=[];for(const[C,[y,b]]of Object.entries(g))y!=null&&b!=null?v.push(`d['${C}'] >= ${y} && d['${C}'] <= ${b}`):y!=null?v.push(`d['${C}'] >= ${y}`):b!=null&&v.push(`d['${C}'] <= ${b}`);return v.join(" && ")}const o=pn(!0),a=pn("");async function l(g){o.value=!0;const v=g.map(C=>u(C));await Promise.all(v),o.value=!1}async function u(g){const v=c(g.name);if(v&&PS.isEqual(v.source,g))return;let C=",";g.source.endsWith(".tsv")&&(C="	");const y=await OUe(g.source,{delimiter:C});e.value[g.name]={source:g,dest:y}}function c(g){return g in e.value?e.value[g]??null:null}function d(g,v){if(o.value)return null;const C=new Map;for(const b of g){const S=c(b);if(S===null)throw new Error(`key not found in data sources: [${b}]`);C.set(b,H6(S.dest.reify()))}return h(C,v??[]).objects()}function h(g,v){const C=g.keys().next().value??"",y=g.get(C);if(!y)throw new Error("table not found");const b={key:C,table:y},S=E=>{const A=E?g.get(E):b.table;if(!A)throw new Error("in table not found");return A},x=E=>{E.out?b.key=E.out:E.in&&!Array.isArray(E.in)&&(b.key=E.in),g.set(b.key,b.table)};for(const E of v){if("groupby"in E){const A=S(E.in);Array.isArray(E.groupby)?b.table=A.groupby(...E.groupby):b.table=A.groupby(E.groupby)}else if("binby"in E){const A=S(E.in),{field:F,bins:k=10,nice:P=!0}=E.binby,{bin_start:_="start",bin_end:O="end"}=E.binby.output??{bin_start:"start",bin_end:"end"},H={};H[_]=B6(F,{maxbins:k,nice:P}),H[O]=B6(F,{maxbins:k,nice:P,offset:1}),b.table=A.groupby(H)}else if("rollup"in E){const A=S(E.in),F={},k=[];for(const[P,_]of Object.entries(E.rollup))F[P]=p(_),_.op==="frequency"&&k.push(P);b.table=A.rollup(F);for(const P of k){const _={};_[P]=(O,H)=>O[H.freqKey]/jo.sum(O[H.freqKey]),b.table=b.table.params({freqKey:P}).derive(_)}}else if("orderby"in E){const A=S(E.in);let F;Array.isArray(E.orderby)?F=E.orderby:F=[E.orderby];const k=F.map(P=>{let _;if(typeof P!="string"){const O=P.order;_=P.field,O==="desc"&&(_=NUe(_))}else _=P;return _});b.table=A.orderby(k)}else if("derive"in E){const A=S(E.in),F=PS.cloneDeep(E.derive);for(const[k,P]of Object.entries(F))typeof P!="string"&&(F[k]=$Ue(P.rolling.expression,P.rolling.window));b.table=A.derive(F)}else if("filter"in E){const A=S(E.in);if(typeof E.filter=="string")b.table=A.filter(E.filter).reify();else{const F=s(t.value[E.filter.name]?.selection??null);F&&(b.table=A.filter(F).reify())}}else if("join"in E){const[A,F]=E.in,k=g.get(A),P=g.get(F);if(!k||!P)throw new Error("join table not found");if(typeof E.join.on=="string"||E.join.on.every(_=>typeof _=="string"))b.table=k.join(P,E.join.on);else{const[_,O]=E.join.on;if(_.length!==O.length)throw new Error("left and right multi keys must be the same length");b.table=k.params({leftMultiKeys:E.join.on[0]}).derive({udi_internal_multi_key_join:dD((H,W)=>W.leftMultiKeys.map($=>H[$]).join("¶"))}).join(P.params({rightMultiKeys:E.join.on[1]}).derive({udi_internal_multi_key_join:dD((H,W)=>W.rightMultiKeys.map($=>H[$]).join("¶"))}),"udi_internal_multi_key_join")}}else if("kde"in E){const A=S(E.in),{field:F,samples:k}=E.kde;let{bandwidth:P}=E.kde;P==null&&(P=MJ(A.array(F),G=>G)),P=P??1;const{sample:_="sample",density:O="density"}=E.kde.output??{sample:"sample",density:"density"};let H;const W=G6(A,jo.min(F)),$=G6(A,jo.max(F)),L=A.partitions();for(let G=0;G<L.length;G++){const j=L[G];if(!j)throw new Error("partition is undefined");const ee=j.map(Re=>A.get(F,Re)),q=cze(ee,{bandwidth:P,bins:k,extent:[W,$]}).points();let fe=H6(q);if(fe=fe.rename({x:_,y:O}),A.isGrouped()){const Re=A.groups();for(let Fe=0;Fe<Re.names.length;Fe++){const ze=Re.names[Fe];if(ze==null)throw new Error("name is undefined");const Ft=Re.get[Fe],$e=Re.rows[G];if($e==null)throw new Error("rowIndex is undefined");const nn=Ft($e);fe=fe.derive({[ze]:dD(nn)})}}H?H=H.concat(fe):H=fe}if(!H)throw new Error("kdeTable is undefined");b.table=H}x(E)}return b.table}function p(g){switch(g.op){case"count":return jo.count();case"sum":if(!g.field)throw new Error("Field is required for sum operation");return jo.sum(g.field);case"min":if(!g.field)throw new Error("Field is required for min operation");return jo.min(g.field);case"median":if(!g.field)throw new Error("Field is required for median operation");return jo.median(g.field);case"max":if(!g.field)throw new Error("Field is required for max operation");return jo.max(g.field);case"mean":return jo.mean(g.field);case"frequency":return jo.count();default:throw new Error("unsupported Aggregate Function"+JSON.stringify(g))}}return{dataSources:e,loading:o,selectionHash:a,initDataSources:l,getDataObject:d,watchDataSelection:n,getDataSelection:r,updateDataSelection:i,dataSelections:t}}),HUe={key:0,class:"vega-error-message"},VUe=kp({__name:"VegaLite",props:{spec:{type:String,required:!0},signalKeys:{type:Array,default:()=>[]}},setup(e){const t=Cte(),n=e,i=pn(),r=pn(null),s=pn();function o(){let u=null;try{u=JSON.parse(n.spec)}catch(c){return c instanceof Error?(console.error("Error parsing spec",c),s.value="Error parsing spec: "+c.message):(console.error("Error parsing spec: Non-error value",c),s.value="Error parsing spec: Unknown error"),i.value.innerHTML="",{success:!1,specObject:u}}return{success:!0,specObject:u}}function a(){const{success:u,specObject:c}=o();!u||!c||(c.data&&c.data.values&&delete c.data.values,tze(i.value,c).then(d=>{s.value=null;const h=d.view;r.value=h;for(const p of n.signalKeys){const g=p.replace(/-/g,"_");h.addSignalListener(g,(v,C)=>{t.updateDataSelection(p,C)})}l()}).catch(d=>{console.error("Error rendering chart",d),s.value="Error rendering chart: "+d.toString(),i.value.innerHTML=""}))}KT(()=>{a()});function l(){if(!r.value)return;const{success:u,specObject:c}=o();!u||PS.isEmpty(c)||r.value.change("udi_data",cc().remove(()=>!0).insert(c.data.values??[])).resize().runAsync()}return yv(()=>n.spec,l),(u,c)=>(jn(),Wi(Xw,null,[$de("div",{ref_key:"vegaContainer",ref:i,class:"vega-chart-container"},null,512),s.value?(jn(),Wi("div",HUe,YT(s.value),1)):zD("",!0)],64))}}),WUe=XT(VUe,[["__scopeId","data-v-6decd822"]]);function V6(e){const{column:t,field:n,type:i}=e;return`${t}¶${n}¶${i}`}const zi={quantitative:[0,1],unknownQuantitative:0,quantitativeColor:e=>a0e((e+.15)/1.15),unknownColor:"#EB10E0",nominalColor:h9},UUe={class:"cell-container"},jUe={key:0,class:"empty-cell pos-absolute"},qUe=kp({__name:"UDICellRenderer",props:{params:{}},setup(e){const t=e,n=mu(()=>{if(!t.params.udiColumnMapping)return[];const o=t.params.udiColumnMapping.map(c=>c.layer),l=[...new Set(o)].map(c=>{const h=t.params.udiColumnMapping.filter(g=>g.layer===c).filter(g=>{const v=t.params.data?.[g.field];return v!==null&&typeof v<"u"}).map(g=>g.mark),p=[...new Set(h)];return{layer:c,marks:p}}),u=[];for(const c of l)for(const d of c.marks)u.push({layer:c.layer,mark:d});return u}),i=mu(()=>{if(!t.params.udiColumnMapping)return{};const o=Object.groupBy(t.params.udiColumnMapping,l=>l.layer),a={};for(const l of Object.keys(o)){const u=o[l];if(!u)continue;const c=Object.groupBy(u,d=>d.mark);a[l]=c}return a});function r(o){if(!t.params.udiColumnMapping)return null;const a=i.value[o]?.text;if(!a)return null;const l=a.find(c=>c.encoding==="text");if(!l)return null;let u=t.params.data?.[l.field];return u instanceof Date&&(u=u.toLocaleDateString()),typeof u=="boolean"&&(u=u.toString()),u}function s(o,a){if(!t.params.udiColumnMapping)return null;const l=i.value[o]?.[a];if(!l)return null;const u={};let c=null,d=null;for(const h of l){let p=t.params.data?.[h.field];if(p instanceof Date&&(p=p.toLocaleDateString()),typeof p=="boolean"&&(p=p.toString()),typeof p!="number"&&typeof p!="string"&&p!==null&&typeof p<"u")throw new Error(`Invalid data type for field ${h.field}: ${typeof p}`);const g=h.domain;let v=[0,1],C=["unknown"];if("min"in g&&"max"in g)v=[g.min,g.max];else{if("numberFields"in g||"categoryFields"in g)throw new Error("numberFields is not supported");C=g}let y=null,b=null;if(h.range)if("min"in h.range&&"max"in h.range)y=[h.range.min,h.range.max];else{if("numberFields"in h.range||"categoryFields"in h.range)throw new Error("numberFields is not supported");b=h.range}switch(h.encoding){case"color":{let S;h.type==="quantitative"?S=N1(zi.quantitativeColor).domain(v).unknown(zi.unknownColor):S=x0(zi.nominalColor).domain(C).range(b??zi.nominalColor).unknown(zi.unknownColor);const x=S(p);h.mark==="text"?u.color=x:h.mark==="line"?u.borderColor=x:u.backgroundColor=x;break}case"x":{let x=uf().domain(v).range(y??zi.quantitative).unknown(zi.unknownQuantitative)(p)*100;c=x,x<0&&(x=0),h.mark==="text"?(u.left=`${x}%`,u.transform=`translate(-${x}%, -50%)`):h.mark==="bar"?d!==null?(u.left=`${Math.min(x,c)}%`,u.width=`${Math.abs(d-x)}%`):u.width=`${x}%`:h.mark==="point"?u.left=`${x}%`:h.mark==="line"&&(u.height="100%",u.left=`${x}%`,u.width=0,u.borderTopWidth=0,u.borderBottomWidth=0);break}case"x2":{let x=uf().domain(v).range(y??zi.quantitative).unknown(zi.unknownQuantitative)(p)*100;if(d=x,x<0&&(x=0),h.mark==="bar")if(c!==null)u.left=`${Math.min(x,c)}%`,u.width=`${Math.abs(c-x)}%`;else{const E=100-x;u.left=`${100-x}%`,u.width=`${100-E}%`}else h.mark;break}case"y":{const S=uf().domain(v).range(y??zi.quantitative).unknown(zi.unknownQuantitative)(p),x=S*100;h.mark==="text"?(u.top=`${100-x}%`,u.transform=`translateY(-${100-x}%)`):h.mark==="bar"?u.height=`${S*100}%`:h.mark==="point"?u.top=`${100-x}%`:h.mark==="line"&&(u.top=`${100-x}%`,u.borderLeftWidth=0,u.borderRightWidth=0);break}case"yOffset":{const S=aP().domain(C).range(y??zi.quantitative)(p)??0,x=1/C.length;h.mark==="bar"?(u.bottom=`${S*100}%`,u.height=`${x*100}%`):h.mark==="line"&&(u.top=`${100-(S+x/2)*100}%`,u.height=0,u.borderLeftWidth=0,u.borderRightWidth=0);break}case"xOffset":{const S=aP().domain(C).range(y??zi.quantitative)(p)??0,x=1/C.length;h.mark==="bar"?(u.left=`${S*100}%`,u.width=`${x*100}%`):h.mark==="line"&&(u.height="100%",u.left=`${(S+x/2)*100}%`,u.width=0,u.borderTopWidth=0,u.borderBottomWidth=0);break}case"size":{const S=uf().domain(v).range(y??zi.quantitative).unknown(zi.unknownQuantitative)(p);if(h.mark==="rect")u.width=`${S*100}%`,u.height=`${S*100}%`,u.left=`${(1-S)*50}%`,u.bottom=`${(1-S)*50}%`;else if(h.mark==="point"){let x=0;S>0&&(x=Math.sqrt(S));const E=16;u.width=`${x*E}px`,u.height=`${x*E}px`}break}}}return u}return(o,a)=>(jn(),Wi("div",UUe,[(jn(!0),Wi(Xw,null,Bde(n.value,({layer:l,mark:u})=>(jn(),Wi(Xw,{key:u},[u==="text"?(jn(),Wi("div",{key:0,style:$g(s(l,u)),class:"pos-absolute text"},YT(r(l)),5)):u==="bar"?(jn(),Wi("div",{key:1,style:$g(s(l,u)),class:"pos-absolute bar"},null,4)):u==="rect"?(jn(),Wi("div",{key:2,style:$g(s(l,u)),class:"pos-absolute rect"},null,4)):u==="point"?(jn(),Wi("div",{key:3,style:$g(s(l,u)),class:"pos-absolute point"},null,4)):u==="line"?(jn(),Wi("div",{key:4,style:$g(s(l,u)),class:"pos-absolute line"},null,4)):zD("",!0)],64))),128)),n.value.length===0?(jn(),Wi("div",jUe,"∅")):zD("",!0)]))}}),KUe=XT(qUe,[["__scopeId","data-v-f06c1d25"]]);var Jd=class{constructor(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}setFrameworkOverrides(e){this.frameworkOverrides=e}getListeners(e,t,n){const i=t?this.allAsyncListeners:this.allSyncListeners;let r=i.get(e);return!r&&n&&(r=new Set,i.set(e,r)),r}noRegisteredListenersExist(){return this.allSyncListeners.size===0&&this.allAsyncListeners.size===0&&this.globalSyncListeners.size===0&&this.globalAsyncListeners.size===0}addEventListener(e,t,n=!1){this.getListeners(e,n,!0).add(t)}removeEventListener(e,t,n=!1){const i=this.getListeners(e,n,!1);i&&(i.delete(t),i.size===0&&(n?this.allAsyncListeners:this.allSyncListeners).delete(e))}addGlobalListener(e,t=!1){(t?this.globalAsyncListeners:this.globalSyncListeners).add(e)}removeGlobalListener(e,t=!1){(t?this.globalAsyncListeners:this.globalSyncListeners).delete(e)}dispatchEvent(e){const t=e;this.dispatchToListeners(t,!0),this.dispatchToListeners(t,!1),this.firedEvents[t.type]=!0}dispatchEventOnce(e){this.firedEvents[e.type]||this.dispatchEvent(e)}dispatchToListeners(e,t){const n=e.type;if(t&&"event"in e){const a=e.event;a instanceof Event&&(e.eventPath=a.composedPath())}const i=(a,l)=>a.forEach(u=>{if(!l.has(u))return;const c=this.frameworkOverrides?()=>this.frameworkOverrides.wrapIncoming(()=>u(e)):()=>u(e);t?this.dispatchAsync(c):c()}),r=this.getListeners(n,t,!1)??new Set,s=new Set(r);s.size>0&&i(s,r),new Set(t?this.globalAsyncListeners:this.globalSyncListeners).forEach(a=>{const l=this.frameworkOverrides?()=>this.frameworkOverrides.wrapIncoming(()=>a(n,e)):()=>a(n,e);t?this.dispatchAsync(l):l()})}dispatchAsync(e){if(this.asyncFunctionsQueue.push(e),!this.scheduled){const t=()=>{window.setTimeout(this.flushAsyncQueue.bind(this),0)};this.frameworkOverrides?this.frameworkOverrides.wrapIncoming(t):t(),this.scheduled=!0}}flushAsyncQueue(){this.scheduled=!1;const e=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[],e.forEach(t=>t())}};function YUe(e,t){return t}function yte(e){return e?.getLocaleTextFunc()??YUe}function Zl(e,t,n){n==null||typeof n=="string"&&n==""?wte(e,t):Us(e,t,n)}function Us(e,t,n){e.setAttribute(bte(t),n.toString())}function wte(e,t){e.removeAttribute(bte(t))}function bte(e){return`aria-${e}`}function Bl(e,t){t?e.setAttribute("role",t):e.removeAttribute("role")}function XUe(e){let t;return e==="asc"?t="ascending":e==="desc"?t="descending":e==="mixed"?t="other":t="none",t}function QUe(e){return e.getAttribute("aria-label")}function TR(e,t){Zl(e,"label",t)}function yT(e,t){Zl(e,"labelledby",t)}function Ste(e,t){Zl(e,"live",t)}function JUe(e,t){Zl(e,"atomic",t)}function ZUe(e,t){Zl(e,"relevant",t)}function e9e(e,t){Zl(e,"disabled",t)}function xte(e,t){Zl(e,"hidden",t)}function wT(e,t){Us(e,"expanded",t)}function t9e(e,t){Us(e,"setsize",t)}function n9e(e,t){Us(e,"posinset",t)}function i9e(e,t){Us(e,"multiselectable",t)}function r9e(e,t){Us(e,"rowcount",t)}function oN(e,t){Us(e,"rowindex",t)}function s9e(e,t){Us(e,"rowspan",t)}function o9e(e,t){Us(e,"colcount",t)}function Rte(e,t){Us(e,"colindex",t)}function a9e(e,t){Us(e,"colspan",t)}function l9e(e,t){Us(e,"sort",t)}function u9e(e){wte(e,"sort")}function bT(e,t){Zl(e,"selected",t)}function c9e(e,t){Zl(e,"controls",t.id),yT(t,e.id)}function aN(e,t){return t===void 0?e("ariaIndeterminate","indeterminate"):t===!0?e("ariaChecked","checked"):e("ariaUnchecked","unchecked")}var hD,fD,pD,gD,ST,xT,mD;function wh(){return hD===void 0&&(hD=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),hD}function Ete(){return fD===void 0&&(fD=/(firefox)/i.test(navigator.userAgent)),fD}function Fte(){return pD===void 0&&(pD=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),pD}function Sd(){return gD===void 0&&(gD=/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1),gD}function RT(e){if(!e)return null;const t=e.tabIndex,n=e.getAttribute("tabIndex");return t===-1&&(n===null||n===""&&!Ete())?null:t.toString()}function d9e(){if(mD!==void 0)return mD;if(!document.body)return-1;let e=1e6;const t=Ete()?6e6:1e9,n=document.createElement("div");for(document.body.appendChild(n);;){const i=e*2;if(n.style.height=i+"px",i>t||n.clientHeight!==i)break;e=i}return document.body.removeChild(n),mD=e,e}function h9e(){return xT==null&&Ate(),xT}function Ate(){const e=document.body,t=document.createElement("div");t.style.width=t.style.height="100px",t.style.opacity="0",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",t.style.position="absolute",e.appendChild(t);let n=t.offsetWidth-t.clientWidth;n===0&&t.clientWidth===0&&(n=null),t.parentNode&&t.parentNode.removeChild(t),n!=null&&(xT=n,ST=n===0)}function Dte(){return ST==null&&Ate(),ST}var f9e="[tabindex], input, select, button, textarea, [href]",Pte="[disabled], .ag-disabled:not(.ag-button), .ag-disabled *";function lN(e){const t=Element.prototype.matches||Element.prototype.msMatchesSelector,i=t.call(e,"input, select, button, textarea"),r=t.call(e,Pte),s=Fo(e);return i&&!r&&s}function Yt(e,t,n={}){const{skipAriaHidden:i}=n;e.classList.toggle("ag-hidden",!t),i||xte(e,!t)}function p9e(e,t,n={}){const{skipAriaHidden:i}=n;e.classList.toggle("ag-invisible",!t),i||xte(e,!t)}function o0(e,t){const n="disabled",i=t?s=>s.setAttribute(n,""):s=>s.removeAttribute(n);i(e);const r=e.querySelectorAll("input")??[];for(const s of r)i(s)}function xd(e,t,n){let i=0;for(;e;){if(e.classList.contains(t))return!0;if(e=e.parentElement,typeof n=="number"){if(++i>n)break}else if(e===n)break}return!1}function bh(e){const{height:t,width:n,borderTopWidth:i,borderRightWidth:r,borderBottomWidth:s,borderLeftWidth:o,paddingTop:a,paddingRight:l,paddingBottom:u,paddingLeft:c,marginTop:d,marginRight:h,marginBottom:p,marginLeft:g,boxSizing:v}=window.getComputedStyle(e);return{height:parseFloat(t||"0"),width:parseFloat(n||"0"),borderTopWidth:parseFloat(i||"0"),borderRightWidth:parseFloat(r||"0"),borderBottomWidth:parseFloat(s||"0"),borderLeftWidth:parseFloat(o||"0"),paddingTop:parseFloat(a||"0"),paddingRight:parseFloat(l||"0"),paddingBottom:parseFloat(u||"0"),paddingLeft:parseFloat(c||"0"),marginTop:parseFloat(d||"0"),marginRight:parseFloat(h||"0"),marginBottom:parseFloat(p||"0"),marginLeft:parseFloat(g||"0"),boxSizing:v}}function uN(e){const t=bh(e);return t.boxSizing==="border-box"?t.height-t.paddingTop-t.paddingBottom:t.height}function a0(e){const t=bh(e);return t.boxSizing==="border-box"?t.width-t.paddingLeft-t.paddingRight:t.width}function kte(e){const{height:t,marginBottom:n,marginTop:i}=bh(e);return Math.floor(t+n+i)}function GS(e){const{width:t,marginLeft:n,marginRight:i}=bh(e);return Math.floor(t+n+i)}function Tte(e){const t=e.getBoundingClientRect(),{borderTopWidth:n,borderLeftWidth:i,borderRightWidth:r,borderBottomWidth:s}=bh(e);return{top:t.top+(n||0),left:t.left+(i||0),right:t.right+(r||0),bottom:t.bottom+(s||0)}}function zS(e,t){let n=e.scrollLeft;return t&&(n=Math.abs(n)),n}function HS(e,t,n){n&&(t*=-1),e.scrollLeft=t}function Ii(e){for(;e&&e.firstChild;)e.removeChild(e.firstChild)}function Fs(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function Mte(e){return!!e.offsetParent}function Fo(e){const t=e;return t.checkVisibility?t.checkVisibility({checkVisibilityCSS:!0}):!(!Mte(e)||window.getComputedStyle(e).visibility!=="visible")}function MR(e){const t=document.createElement("div");return t.innerHTML=(e||"").trim(),t.firstChild}function Ite(e,t,n){n&&n.nextSibling===t||(e.firstChild?n?n.nextSibling?e.insertBefore(t,n.nextSibling):e.appendChild(t):e.firstChild&&e.firstChild!==t&&e.insertAdjacentElement("afterbegin",t):e.appendChild(t))}function _te(e,t){for(let n=0;n<t.length;n++){const i=t[n],r=e.children[n];r!==i&&e.insertBefore(i,r)}}function g9e(e){return e.replace(/[A-Z]/g,t=>`-${t.toLocaleLowerCase()}`)}function yC(e,t){if(t)for(const n of Object.keys(t)){const i=t[n];if(!n||!n.length||i==null)continue;const r=g9e(n),s=i.toString(),o=s.replace(/\s*!important/g,""),a=o.length!=s.length?"important":void 0;e.style.setProperty(r,o,a)}}function m9e(e){return e.clientWidth<e.scrollWidth}function v9e(e){return e.clientHeight<e.scrollHeight}function VS(e,t){t==="flex"?(e.style.removeProperty("width"),e.style.removeProperty("minWidth"),e.style.removeProperty("maxWidth"),e.style.flex="1 1 auto"):ga(e,t)}function ga(e,t){t=cN(t),e.style.width=t,e.style.maxWidth=t,e.style.minWidth=t}function uv(e,t){t=cN(t),e.style.height=t,e.style.maxHeight=t,e.style.minHeight=t}function cN(e){return typeof e=="number"?`${e}px`:e}function dN(e){return e instanceof Node||e instanceof HTMLElement}function ks(e,t,n){n==null||n===""?e.removeAttribute(t):e.setAttribute(t,n.toString())}function Pc(e,t,n){const r=Ute(e).ResizeObserver,s=r?new r(n):null;return s?.observe(t),()=>s?.disconnect()}function eu(e,t){const n=Ute(e);n.requestAnimationFrame?n.requestAnimationFrame(t):n.webkitRequestAnimationFrame?n.webkitRequestAnimationFrame(t):n.setTimeout(t,0)}var Ote="data-ref",vD;function W6(){return vD??(vD=document.createTextNode(" ")),vD.cloneNode()}function Cn(e){const{attrs:t,children:n,cls:i,ref:r,role:s,tag:o}=e,a=document.createElement(o);if(i&&(a.className=i),r&&a.setAttribute(Ote,r),s&&a.setAttribute("role",s),t)for(const l of Object.keys(t))a.setAttribute(l,t[l]);if(n)if(typeof n=="string")a.textContent=n;else{let l=!0;for(const u of n)u&&(typeof u=="string"?(a.appendChild(document.createTextNode(u)),l=!1):(l&&(a.appendChild(W6()),l=!1),a.append(Cn(u)),a.appendChild(W6())))}return a}function Rl(e){return e==null||e===""?null:e}function me(e){return e!=null&&e!==""}function Wt(e){return!me(e)}function ET(e){return e!=null&&typeof e.toString=="function"?e.toString():null}function l0(e,t){const n=e?JSON.stringify(e):null,i=t?JSON.stringify(t):null;return n===i}function C9e(e,t,n=!1){const i=e==null,r=t==null;if(e&&e.toNumber&&(e=e.toNumber()),t&&t.toNumber&&(t=t.toNumber()),i&&r)return 0;if(i)return-1;if(r)return 1;function s(o,a){return o>a?1:o<a?-1:0}if(typeof e!="string"||!n)return s(e,t);try{return e.localeCompare(t)}catch{return s(e,t)}}var Lte="https://www.ag-grid.com",U6={};function Nte(e,t){U6[t]||(e(),U6[t]=!0)}function ac(e,t,...n){e.get("debug")&&console.log("AG Grid: "+t,...n)}function cv(e,...t){Nte(()=>console.warn("AG Grid: "+e,...t),e+t?.join(""))}function Tf(e,...t){Nte(()=>console.error("AG Grid: "+e,...t),e+t?.join(""))}var y9e={pending:!1,funcs:[]},w9e={pending:!1,funcs:[]};function FT(e,t="setTimeout",n){const i=t==="raf"?w9e:y9e;if(i.funcs.push(e),i.pending)return;i.pending=!0;const r=()=>{const s=i.funcs.slice();i.funcs.length=0,i.pending=!1,s.forEach(o=>o())};t==="raf"?eu(n,r):window.setTimeout(r,0)}function hi(e,t,n){let i;return function(...r){const s=this;window.clearTimeout(i),i=window.setTimeout(function(){e.isAlive()&&t.apply(s,r)},n)}}function j6(e,t){let n=0;return function(...i){const r=this,s=Date.now();s-n<t||(n=s,e.apply(r,i))}}function b9e(e,t,n=100,i){const r=Date.now();let s=null,o=!1;const a=()=>{const l=Date.now()-r>n;(e()||l)&&(t(),o=!0,s!=null&&(window.clearInterval(s),s=null))};a(),o||(s=window.setInterval(a,10))}var Ce="33.2.4",q6=2e3,K6=100,$te="_version_",Bte=null,Rd=`${Lte}/javascript-data-grid`;function S9e(e){Bte=e}function x9e(e){Rd=e}function Gte(e,t,n){return Bte?.getConsoleMessage(e,t)??[A9e(e,t,n)]}function hN(e,t,n,i){e(`error #${t}`,...Gte(t,n,i))}function R9e(e){if(!e)return String(e);const t={};for(const n of Object.keys(e))typeof e[n]!="object"&&typeof e[n]!="function"&&(t[n]=e[n]);return JSON.stringify(t)}function E9e(e){let t=e;return e instanceof Error?t=e.toString():typeof e=="object"&&(t=R9e(e)),t}function WS(e){return e===void 0?"undefined":e===null?"null":e}function AT(e,t){return`${e}?${t.toString()}`}function F9e(e,t,n){const i=Array.from(t.entries()).sort((s,o)=>o[1].length-s[1].length);let r=AT(e,t);for(const[s,o]of i){if(s===$te)continue;const a=r.length-n;if(a<=0)break;const l="...",u=a+l.length,c=o.length-u>K6?o.slice(0,o.length-u)+l:o.slice(0,K6)+l;t.set(s,c),r=AT(e,t)}return r}function zte(e,t){const n=new URLSearchParams;if(n.append($te,Ce),t)for(const s of Object.keys(t))n.append(s,E9e(t[s]));const i=`${Rd}/errors/${e}`,r=AT(i,n);return r.length<=q6?r:F9e(i,n,q6)}var A9e=(e,t,n)=>{const i=zte(e,t);return`${n?n+` 
`:""}Visit ${i}${n?"":` 
  Alternatively register the ValidationModule to see the full message in the console.`}`};function ue(...e){hN(cv,e[0],e[1])}function wt(...e){hN(Tf,e[0],e[1])}function DT(e,t,n){hN(Tf,e,t,n)}function D9e(e,t){const n=t[0];return`error #${n} `+Gte(n,t[1],e).join(" ")}function Hu(...e){return D9e(void 0,e)}function Hte(e,t){return e.get("rowModelType")===t}function Xi(e,t){return Hte(e,"clientSide")}function mg(e,t){return Hte(e,"serverSide")}function gi(e,t){return e.get("domLayout")===t}function Ed(e){return jS(e)!==void 0}function Vte(e){return typeof e.get("getRowHeight")=="function"}function P9e(e,t){return t?!e.get("enableStrictPivotColumnOrder"):e.get("maintainColumnOrder")}function Sp(e,t,n=!1,i){const{gos:r,environment:s}=e;if(i==null&&(i=s.getDefaultRowHeight()),Vte(r)){if(n)return{height:i,estimated:!0};const l={node:t,data:t.data},u=r.getCallback("getRowHeight")(l);if(PT(u))return u===0&&ue(23),{height:Math.max(1,u),estimated:!1}}if(t.detail&&r.get("masterDetail"))return k9e(r);const o=r.get("rowHeight");return{height:o&&PT(o)?o:i,estimated:!1}}function k9e(e){if(e.get("detailRowAutoHeight"))return{height:1,estimated:!1};const t=e.get("detailRowHeight");return PT(t)?{height:t,estimated:!1}:{height:300,estimated:!1}}function Fd(e){const{environment:t,gos:n}=e,i=n.get("rowHeight");if(!i||Wt(i))return t.getDefaultRowHeight();const r=t.refreshRowHeightVariable();return r!==-1?r:(ue(24),t.getDefaultRowHeight())}function PT(e){return!isNaN(e)&&typeof e=="number"&&isFinite(e)}function Wte(e,t,n){const i=t[e.getDomDataKey()];return i?i[n]:void 0}function Zd(e,t,n,i){const r=e.getDomDataKey();let s=t[r];Wt(s)&&(s={},t[r]=s),s[n]=i}function Rn(e){const{gos:t,eGridDiv:n}=e;let i=null;const r=t.get("getDocument");return r&&me(r)?i=r():n&&(i=n.ownerDocument),i&&me(i)?i:document}function Ute(e){return Rn(e).defaultView||window}function u0(e){return e.eGridDiv.getRootNode()}function Xt(e){return u0(e).activeElement}function fN(e){let t=null,n=null;try{t=Rn(e).fullscreenElement}catch{}finally{t||(t=u0(e));const i=t.querySelector("body");i?n=i:t instanceof ShadowRoot?n=t:t instanceof Document?n=t?.documentElement:n=t}return n}function T9e(e){return fN(e)?.clientWidth??(window.innerHeight||-1)}function M9e(e){return fN(e)?.clientHeight??(window.innerHeight||-1)}function I9e(e,t,n){const r=e.getBoundingClientRect().height,s=T9e(n)-2,o=M9e(n)-2;if(!e.offsetParent)return;const l=Tte(e.offsetParent),{clientY:u,clientX:c}=t;let d=u-l.top-r/2,h=c-l.left-10;const p=Rn(n),g=p.defaultView||window,v=g.pageYOffset||p.documentElement.scrollTop,C=g.pageXOffset||p.documentElement.scrollLeft;s>0&&h+e.clientWidth>s+C&&(h=s+C-e.clientWidth),h<0&&(h=0),o>0&&d+e.clientHeight>o+v&&(d=o+v-e.clientHeight),d<0&&(d=0),e.style.left=`${h}px`,e.style.top=`${d}px`}function jte(e){const t=Rn(e),n=Xt(e);return n===null||n===t.body}function Mf(e){return e.get("ensureDomOrder")?!1:e.get("animateRows")}function qte(e){return!(e.get("paginateChildRows")||e.get("groupHideOpenParents")||gi(e,"print"))}function sa(e){return!e.get("autoGroupColumnDef")?.comparator&&!e.get("treeData")}function kT(e){const t=e.get("groupAggFiltering");if(typeof t=="function")return e.getCallback("groupAggFiltering");if(t===!0)return()=>!0}function _9e(e){return e.get("groupHideOpenParents")?!0:e.get("groupDisplayType")==="multipleColumns"}function pN(e,t){return t?!1:e.get("groupDisplayType")==="groupRows"}function xp(e){const t=e.getCallback("getRowId");return t===void 0?t:n=>{let i=t(n);return typeof i!="string"&&(ue(25,{id:i}),i=String(i)),i}}function O9e(e,t){const n=e.get("groupHideParentOfSingleChild");return!!(n===!0||n==="leafGroupsOnly"&&t.leafGroup||e.get("groupRemoveSingleChildren")||e.get("groupRemoveLowestSingleChildren")&&t.leafGroup)}function L9e(e){const t=e.get("maxConcurrentDatasourceRequests");return t>0?t:void 0}function If(e){return e?.checkboxes??!0}function Uw(e){return e?.mode==="multiRow"&&(e.headerCheckbox??!0)}function US(e){if(typeof e=="object")return e.checkboxLocation??"selectionColumn"}function CD(e){return e?.hideDisabledCheckboxes??!1}function N9e(e){return typeof e.get("rowSelection")!="string"}function Gl(e){const t=e.get("cellSelection");return t!==void 0?!!t:e.get("enableRangeSelection")}function Kte(e){const t=e.get("rowSelection")??"single";if(typeof t=="string"){const n=e.get("suppressRowClickSelection"),i=e.get("suppressRowDeselection");return n&&i?!1:n?"enableDeselection":i?"enableSelection":!0}return t.mode==="singleRow"||t.mode==="multiRow"?t.enableClickSelection??!1:!1}function $9e(e){const t=Kte(e);return t===!0||t==="enableSelection"}function B9e(e){const t=Kte(e);return t===!0||t==="enableDeselection"}function TT(e){const t=e.get("rowSelection");return typeof t=="string"?e.get("isRowSelectable"):t?.isRowSelectable}function jS(e){const t="beanName"in e&&e.beanName==="gos"?e.get("rowSelection"):e.rowSelection;if(typeof t=="string")switch(t){case"multiple":return"multiRow";case"single":return"singleRow";default:return}switch(t?.mode){case"multiRow":case"singleRow":return t.mode;default:return}}function c0(e){return jS(e)==="multiRow"}function G9e(e){const t=e.get("rowSelection");return typeof t=="string"?e.get("rowMultiSelectWithClick"):t?.enableSelectionWithoutKeys??!1}function qS(e){const t=e.get("rowSelection");if(typeof t=="string"){const n=e.get("groupSelectsChildren"),i=e.get("groupSelectsFiltered");return n&&i?"filteredDescendants":n?"descendants":"self"}return t?.mode==="multiRow"?t.groupSelects:void 0}function Yte(e,t=!0){const n=e.get("rowSelection");return typeof n!="object"?t?"all":void 0:n.mode==="multiRow"?n.selectAll:"all"}function d0(e){const t=qS(e);return t==="descendants"||t==="filteredDescendants"}function Y6(e){const t=e.get("rowSelection");return typeof t=="object"&&t.masterSelects||"self"}function yD(e){return e.isModuleRegistered("SetFilter")&&!e.get("suppressSetFilterByDefault")}function Ur(e){return e.get("columnMenu")==="legacy"}function z9e(e){return!Ur(e)}function gN(e){return!e||e.length<2?e:"on"+e[0].toUpperCase()+e.substring(1)}function H9e(e,t,n){typeof e!="object"&&(e={});const i={...e};return n.forEach(r=>{const s=t[r];typeof s<"u"&&(i[r]=s)}),i}function V9e(e,t){if(!e)return;const n={};let i=!1;if(Object.keys(e).forEach(o=>{n[o]=e[o],i=!0}),!i)return;const r={type:"gridOptionsChanged",options:n};t.dispatchEvent(r);const s={type:"componentStateChanged",...n};t.dispatchEvent(s)}function Ne(e,t){return e.addGridCommonParams(t)}function W9e(e){return e.get("treeData")?e.get("treeDataParentIdField")?"treeSelfRef":e.get("treeDataChildrenField")?"treeNested":"treePath":"group"}var Xte="__ag_Grid_Stop_Propagation",U9e=["touchstart","touchend","touchmove","touchcancel","scroll"],j9e=["wheel"],wD={};function Rp(e){e[Xte]=!0}function El(e){return e[Xte]===!0}var Qte=(()=>{const e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return n=>{if(typeof wD[n]=="boolean")return wD[n];const i=document.createElement(e[n]||"div");return n="on"+n,wD[n]=n in i}})();function Jte(e,t,n){let i=t;for(;i;){const r=Wte(e,i,n);if(r)return r;i=i.parentElement}return null}function q9e(e,t){return!t||!e?!1:Y9e(t).indexOf(e)>=0}function K9e(e){const t=[];let n=e.target;for(;n;)t.push(n),n=n.parentElement;return t}function Y9e(e){const t=e;return t.path?t.path:t.composedPath?t.composedPath():K9e(t)}function X9e(e,t,n,i){const r=Zte(n);let s;r!=null&&(s={passive:r}),e&&e.addEventListener&&e.addEventListener(t,n,i,s)}var Zte=e=>{const t=U9e.includes(e),n=j9e.includes(e);if(t)return!0;if(n)return!1},X=class{constructor(){this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.propertyListenerId=0,this.lastChangeSetIdLookup={},this.isAlive=()=>!this.destroyed}preWireBeans(e){this.beans=e,this.stubContext=e.context,this.eventSvc=e.eventSvc,this.gos=e.gos}destroy(){const{destroyFunctions:e}=this;for(let t=0;t<e.length;t++)e[t]();e.length=0,this.destroyed=!0,this.dispatchLocalEvent({type:"destroyed"})}addEventListener(e,t,n){this.localEventService||(this.localEventService=new Jd),this.localEventService.addEventListener(e,t,n)}removeEventListener(e,t,n){this.localEventService?.removeEventListener(e,t,n)}dispatchLocalEvent(e){this.localEventService?.dispatchEvent(e)}addManagedElementListeners(e,t){return this._setupListeners(e,t)}addManagedEventListeners(e){return this._setupListeners(this.eventSvc,e)}addManagedListeners(e,t){return this._setupListeners(e,t)}_setupListeners(e,t){const n=[];for(const i of Object.keys(t)){const r=t[i];r&&n.push(this._setupListener(e,i,r))}return n}_setupListener(e,t,n){if(this.destroyed)return()=>null;let i;return Q9e(e)?(e.__addEventListener(t,n),i=()=>(e.__removeEventListener(t,n),null)):(e instanceof HTMLElement?X9e(this.beans.frameworkOverrides,e,t,n):e.addEventListener(t,n),i=()=>(e.removeEventListener(t,n),null)),this.destroyFunctions.push(i),()=>(i(),this.destroyFunctions=this.destroyFunctions.filter(r=>r!==i),null)}setupGridOptionListener(e,t){const{gos:n}=this;n.addPropertyEventListener(e,t);const i=()=>(n.removePropertyEventListener(e,t),null);return this.destroyFunctions.push(i),()=>(i(),this.destroyFunctions=this.destroyFunctions.filter(r=>r!==i),null)}addManagedPropertyListener(e,t){return this.destroyed?()=>null:this.setupGridOptionListener(e,t)}addManagedPropertyListeners(e,t){if(this.destroyed)return;const n=e.join("-")+this.propertyListenerId++,i=r=>{if(r.changeSet){if(r.changeSet&&r.changeSet.id===this.lastChangeSetIdLookup[n])return;this.lastChangeSetIdLookup[n]=r.changeSet.id}const s={type:"gridPropertyChanged",changeSet:r.changeSet,source:r.source};t(s)};e.forEach(r=>this.setupGridOptionListener(r,i))}getLocaleTextFunc(){return yte(this.beans.localeSvc)}addDestroyFunc(e){this.isAlive()?this.destroyFunctions.push(e):e()}createOptionalManagedBean(e,t){return e?this.createManagedBean(e,t):void 0}createManagedBean(e,t){const n=this.createBean(e,t);return this.addDestroyFunc(this.destroyBean.bind(this,e,t)),n}createBean(e,t,n){return(t||this.stubContext).createBean(e,n)}destroyBean(e,t){return(t||this.stubContext).destroyBean(e)}destroyBeans(e,t){return(t||this.stubContext).destroyBeans(e)}};function Q9e(e){return e.__addEventListener!==void 0}var ene=new Set(["__proto__","constructor","prototype"]);function J9e(e,t){if(e!=null){if(Array.isArray(e)){for(let n=0;n<e.length;n++)t(n.toString(),e[n]);return}for(const n of Object.keys(e))t(n,e[n])}}function ir(e,t,n=!0,i=!1){me(t)&&J9e(t,(r,s)=>{if(ene.has(r))return;let o=e[r];o!==s&&(i&&o==null&&s!=null&&typeof s=="object"&&s.constructor===Object&&(o={},e[r]=o),X6(s)&&X6(o)&&!Array.isArray(o)?ir(o,s,n,i):(n||s!==void 0)&&(e[r]=s))})}function dv(e,t,n){if(!t||!e)return;if(!n)return e[t];const i=t.split(".");let r=e;for(let s=0;s<i.length;s++){if(r==null)return;r=r[i[s]]}return r}function X6(e){return typeof e=="object"&&e!==null}var Z9e=/[&<>"']/g,e7e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Fl(e,t){if(e==null)return null;const n=e.toString().toString();return t?n:n.replace(Z9e,i=>e7e[i])}var t7e={resizable:!0,sortable:!0},n7e=0;function tne(){return n7e++}function lc(e){return e instanceof mN}var mN=class extends X{constructor(e,t,n,i){super(),this.colDef=e,this.userProvidedColDef=t,this.colId=n,this.primary=i,this.isColumn=!0,this.instanceId=tne(),this.autoHeaderHeight=null,this.moving=!1,this.menuVisible=!1,this.lastLeftPinned=!1,this.firstRightPinned=!1,this.filterActive=!1,this.colEventSvc=new Jd,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.flex=null,this.colIdSanitised=Fl(n)}destroy(){super.destroy(),this.beans.rowSpanSvc?.deregister(this)}getInstanceId(){return this.instanceId}setState(){const{colDef:e,beans:{sortSvc:t,pinnedCols:n,colFlex:i}}=this;t?.initCol(this);const r=e.hide;r!==void 0?this.visible=!r:this.visible=!e.initialHide,n?.initCol(this),i?.initCol(this)}setColDef(e,t,n){const i=e.spanRows!==this.colDef.spanRows;this.colDef=e,this.userProvidedColDef=t,this.initMinAndMaxWidths(),this.initDotNotation(),this.initTooltip(),i&&(this.beans.rowSpanSvc?.deregister(this),this.initRowSpan()),this.dispatchColEvent("colDefChanged",n)}getUserProvidedColDef(){return this.userProvidedColDef}getParent(){return this.parent}getOriginalParent(){return this.originalParent}postConstruct(){this.setState(),this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip(),this.initRowSpan()}initDotNotation(){const{gos:e,colDef:{field:t,tooltipField:n}}=this,i=e.get("suppressFieldDotNotation");this.fieldContainsDots=me(t)&&t.indexOf(".")>=0&&!i,this.tooltipFieldContainsDots=me(n)&&n.indexOf(".")>=0&&!i}initMinAndMaxWidths(){const e=this.colDef;this.minWidth=e.minWidth??this.beans.environment.getDefaultColumnMinWidth(),this.maxWidth=e.maxWidth??Number.MAX_SAFE_INTEGER}initTooltip(){this.beans.tooltipSvc?.initCol(this)}initRowSpan(){this.colDef.spanRows&&this.beans.rowSpanSvc?.register(this)}resetActualWidth(e){const t=this.calculateColInitialWidth(this.colDef);this.setActualWidth(t,e,!0)}calculateColInitialWidth(e){let t;const n=e.width,i=e.initialWidth;return n!=null?t=n:i!=null?t=i:t=200,Math.max(Math.min(t,this.maxWidth),this.minWidth)}isEmptyGroup(){return!1}isRowGroupDisplayed(e){return this.beans.showRowGroupCols?.isRowGroupDisplayed(this,e)??!1}isPrimary(){return this.primary}isFilterAllowed(){return!!this.colDef.filter}isFieldContainsDots(){return this.fieldContainsDots}isTooltipEnabled(){return this.tooltipEnabled}isTooltipFieldContainsDots(){return this.tooltipFieldContainsDots}getHighlighted(){return this.highlighted}__addEventListener(e,t){this.colEventSvc.addEventListener(e,t)}__removeEventListener(e,t){this.colEventSvc.removeEventListener(e,t)}addEventListener(e,t){this.frameworkEventListenerService=this.beans.frameworkOverrides.createLocalEventListenerWrapper?.(this.frameworkEventListenerService,this.colEventSvc);const n=this.frameworkEventListenerService?.wrap(t)??t;this.colEventSvc.addEventListener(e,n)}removeEventListener(e,t){const n=this.frameworkEventListenerService?.unwrap(t)??t;this.colEventSvc.removeEventListener(e,n)}createColumnFunctionCallbackParams(e){return Ne(this.gos,{node:e,data:e.data,column:this,colDef:this.colDef})}isSuppressNavigable(e){return this.beans.cellNavigation?.isSuppressNavigable(this,e)??!1}isCellEditable(e){return this.beans.editSvc?.isCellEditable(this,e)??!1}isSuppressFillHandle(){return!!this.colDef.suppressFillHandle}isAutoHeight(){return!!this.colDef.autoHeight}isAutoHeaderHeight(){return!!this.colDef.autoHeaderHeight}isRowDrag(e){return this.isColumnFunc(e,this.colDef.rowDrag)}isDndSource(e){return this.isColumnFunc(e,this.colDef.dndSource)}isCellCheckboxSelection(e){return this.beans.selectionSvc?.isCellCheckboxSelection(this,e)??!1}isSuppressPaste(e){return this.isColumnFunc(e,this.colDef?.suppressPaste??null)}isResizable(){return!!this.getColDefValue("resizable")}getColDefValue(e){return this.colDef[e]??t7e[e]}isColumnFunc(e,t){if(typeof t=="boolean")return t;if(typeof t=="function"){const n=this.createColumnFunctionCallbackParams(e);return t(n)}return!1}createColumnEvent(e,t){return Ne(this.gos,{type:e,column:this,columns:[this],source:t})}isMoving(){return this.moving}getSort(){return this.sort}isSortable(){return!!this.getColDefValue("sortable")}isSortAscending(){return this.sort==="asc"}isSortDescending(){return this.sort==="desc"}isSortNone(){return Wt(this.sort)}isSorting(){return me(this.sort)}getSortIndex(){return this.sortIndex}isMenuVisible(){return this.menuVisible}getAggFunc(){return this.aggFunc}getLeft(){return this.left}getOldLeft(){return this.oldLeft}getRight(){return this.left+this.actualWidth}setLeft(e,t){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchColEvent("leftChanged",t))}isFilterActive(){return this.filterActive}isHovered(){return ue(261),!!this.beans.colHover?.isHovered(this)}setFirstRightPinned(e,t){this.firstRightPinned!==e&&(this.firstRightPinned=e,this.dispatchColEvent("firstRightPinnedChanged",t))}setLastLeftPinned(e,t){this.lastLeftPinned!==e&&(this.lastLeftPinned=e,this.dispatchColEvent("lastLeftPinnedChanged",t))}isFirstRightPinned(){return this.firstRightPinned}isLastLeftPinned(){return this.lastLeftPinned}isPinned(){return this.pinned==="left"||this.pinned==="right"}isPinnedLeft(){return this.pinned==="left"}isPinnedRight(){return this.pinned==="right"}getPinned(){return this.pinned}setVisible(e,t){const n=e===!0;this.visible!==n&&(this.visible=n,this.dispatchColEvent("visibleChanged",t)),this.dispatchStateUpdatedEvent("hide")}isVisible(){return this.visible}isSpanHeaderHeight(){return!this.getColDef().suppressSpanHeaderHeight}getColumnGroupPaddingInfo(){let e=this.getParent();if(!e||!e.isPadding())return{numberOfParents:0,isSpanningTotal:!1};const t=e.getPaddingLevel()+1;let n=!0;for(;e;){if(!e.isPadding()){n=!1;break}e=e.getParent()}return{numberOfParents:t,isSpanningTotal:n}}getColDef(){return this.colDef}getDefinition(){return this.colDef}getColumnGroupShow(){return this.colDef.columnGroupShow}getColId(){return this.colId}getId(){return this.colId}getUniqueId(){return this.colId}getActualWidth(){return this.actualWidth}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){const t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}createBaseColDefParams(e){return Ne(this.gos,{node:e,data:e.data,colDef:this.colDef,column:this})}getColSpan(e){if(Wt(this.colDef.colSpan))return 1;const t=this.createBaseColDefParams(e),n=this.colDef.colSpan(t);return Math.max(n,1)}getRowSpan(e){if(Wt(this.colDef.rowSpan))return 1;const t=this.createBaseColDefParams(e),n=this.colDef.rowSpan(t);return Math.max(n,1)}setActualWidth(e,t,n=!1){e=Math.max(e,this.minWidth),e=Math.min(e,this.maxWidth),this.actualWidth!==e&&(this.actualWidth=e,this.flex!=null&&t!=="flex"&&t!=="gridInitializing"&&(this.flex=null),n||this.fireColumnWidthChangedEvent(t)),this.dispatchStateUpdatedEvent("width")}fireColumnWidthChangedEvent(e){this.dispatchColEvent("widthChanged",e)}isGreaterThanMax(e){return e>this.maxWidth}getMinWidth(){return this.minWidth}getMaxWidth(){return this.maxWidth}getFlex(){return this.flex}isRowGroupActive(){return this.rowGroupActive}isPivotActive(){return this.pivotActive}isAnyFunctionActive(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()}isAnyFunctionAllowed(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()}isValueActive(){return this.aggregationActive}isAllowPivot(){return this.colDef.enablePivot===!0}isAllowValue(){return this.colDef.enableValue===!0}isAllowRowGroup(){return this.colDef.enableRowGroup===!0}dispatchColEvent(e,t,n){const i=this.createColumnEvent(e,t);n&&ir(i,n),this.colEventSvc.dispatchEvent(i)}dispatchStateUpdatedEvent(e){this.colEventSvc.dispatchEvent({type:"columnStateUpdated",key:e})}};function Ui(e){return e instanceof jw}var jw=class extends X{constructor(e,t,n,i){super(),this.colGroupDef=e,this.groupId=t,this.padding=n,this.level=i,this.isColumn=!1,this.expandable=!1,this.instanceId=tne(),this.expandableListenerRemoveCallback=null,this.expanded=!!e?.openByDefault}destroy(){this.expandableListenerRemoveCallback&&this.reset(null,void 0),super.destroy()}reset(e,t){this.colGroupDef=e,this.level=t,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0}getInstanceId(){return this.instanceId}getOriginalParent(){return this.originalParent}getLevel(){return this.level}isVisible(){return this.children?this.children.some(e=>e.isVisible()):!1}isPadding(){return this.padding}setExpanded(e){this.expanded=e===void 0?!1:e,this.dispatchLocalEvent({type:"expandedChanged"})}isExpandable(){return this.expandable}isExpanded(){return this.expanded}getGroupId(){return this.groupId}getId(){return this.getGroupId()}setChildren(e){this.children=e}getChildren(){return this.children}getColGroupDef(){return this.colGroupDef}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}addLeafColumns(e){this.children&&this.children.forEach(t=>{lc(t)?e.push(t):Ui(t)&&t.addLeafColumns(e)})}getColumnGroupShow(){const e=this.colGroupDef;if(e)return e.columnGroupShow}setupExpandable(){this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();const e=this.onColumnVisibilityChanged.bind(this);this.getLeafColumns().forEach(t=>t.__addEventListener("visibleChanged",e)),this.expandableListenerRemoveCallback=()=>{this.getLeafColumns().forEach(t=>t.__removeEventListener("visibleChanged",e)),this.expandableListenerRemoveCallback=null}}setExpandable(){if(this.isPadding())return;let e=!1,t=!1,n=!1;const i=this.findChildrenRemovingPadding();for(let s=0,o=i.length;s<o;s++){const a=i[s];if(!a.isVisible())continue;const l=a.getColumnGroupShow();l==="open"?(e=!0,n=!0):l==="closed"?(t=!0,n=!0):(e=!0,t=!0)}const r=e&&t&&n;this.expandable!==r&&(this.expandable=r,this.dispatchLocalEvent({type:"expandableChanged"}))}findChildrenRemovingPadding(){const e=[],t=n=>{n.forEach(i=>{Ui(i)&&i.isPadding()?t(i.children):e.push(i)})};return t(this.children),e}onColumnVisibilityChanged(){this.setExpandable()}},i7e={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}},r7e=class{constructor(){this.existingKeys={}}addExistingKeys(e){for(let t=0;t<e.length;t++)this.existingKeys[e[t]]=!0}getUniqueKey(e,t){e=ET(e);let n=0;for(;;){let i=e??t;if(i?n!==0&&(i+="_"+n):i=n,!this.existingKeys[i])return this.existingKeys[i]=!0,String(i);n++}}},Q6=Object.freeze([]);function Tt(e){if(e?.length)return e[e.length-1]}function Sh(e,t,n){return e==null&&t==null?!0:e!=null&&t!=null&&e.length===t.length&&e.every((i,r)=>n?n(i,t[r]):t[r]===i)}function ow(e,t){if(e)for(const n of e)t(n)}function Ao(e,t){const n=e.indexOf(t);n>=0&&e.splice(n,1)}function J6(e,t,n){for(let i=0;i<t.length;i++)Ao(e,t[i]);for(let i=t.length-1;i>=0;i--)e.splice(n,0,t[i])}var IR="ag-Grid-AutoColumn",nne="ag-Grid-SelectionColumn",s7e="ag-Grid-RowNumbersColumn";function ine(e){const t=[],n=i=>{for(let r=0;r<i.length;r++){const s=i[r];lc(s)?t.push(s):Ui(s)&&n(s.getChildren())}};return n(e),t}function ol(e){return e.reduce((t,n)=>t+n.getActualWidth(),0)}function KS(e,t,n){const i={};if(!t)return;Al(null,t,s=>{i[s.getInstanceId()]=s}),n&&Al(null,n,s=>{i[s.getInstanceId()]=null});const r=Object.values(i).filter(s=>s!=null);e.context.destroyBeans(r)}function vN(e){return e.getId().startsWith(IR)}function zl(e){return(typeof e=="string"?e:"getColId"in e?e.getColId():e.colId)?.startsWith(nne)??!1}function Ep(e){return(typeof e=="string"?e:"getColId"in e?e.getColId():e.colId)?.startsWith(s7e)??!1}function YS(e){let t=[];return e instanceof Array?t=e:typeof e=="string"&&(t=e.split(",")),t}function o7e(e,t){return Sh(e,t,(n,i)=>n.getColId()===i.getColId())}function a7e(e){e.map={},e.list.forEach(t=>e.map[t.getId()]=t)}function _f(e){return e==="gridOptionsUpdated"?"gridOptionsChanged":e}function rne(e,t){const n=e===t,i=e.getColDef()===t,r=e.getColId()==t;return n||i||r}var l7e=(e,t)=>(n,i)=>{const r={value1:void 0,value2:void 0};let s=!1;return e&&(e[n]!==void 0&&(r.value1=e[n],s=!0),me(i)&&e[i]!==void 0&&(r.value2=e[i],s=!0)),!s&&t&&(t[n]!==void 0&&(r.value1=t[n]),me(i)&&t[i]!==void 0&&(r.value2=t[i])),r};function u7e(e,t=null,n,i,r){const s=new r7e,{existingCols:o,existingGroups:a,existingColKeys:l}=c7e(i);s.addExistingKeys(l);const u=sne(e,t,0,n,o,s,a,r),{colGroupSvc:c}=e,d=c?.findMaxDepth(u,0)??0,h=c?c.balanceColumnTree(u,0,d,s):u;return Al(null,h,(g,v)=>{Ui(g)&&g.setupExpandable(),g.originalParent=v}),{columnTree:h,treeDept:d}}function c7e(e){const t=[],n=[],i=[];return e&&Al(null,e,r=>{if(Ui(r)){const s=r;n.push(s)}else{const s=r;i.push(s.getId()),t.push(s)}}),{existingCols:t,existingGroups:n,existingColKeys:i}}function sne(e,t,n,i,r,s,o,a){if(!t)return[];const{colGroupSvc:l}=e,u=new Array(t.length);for(let c=0;c<u.length;c++){const d=t[c];l&&m7e(d)?u[c]=l.createProvidedColumnGroup(i,d,n,r,s,o,a):u[c]=d7e(e,i,d,r,s,a)}return u}function d7e(e,t,n,i,r,s){const o=f7e(n,i);o&&i?.splice(o.idx,1);let a=o?.column;if(a){const l=MT(e,n,a.getColId());a.setColDef(l,n,s),h7e(e,a,l,s)}else{const l=r.getUniqueKey(n.colId,n.field),u=MT(e,n,l);a=new mN(u,n,l,t),e.context.createBean(a)}return e.dataTypeSvc?.addColumnListeners(a),a}function one(e,t,n,i,r,s,o,a){const{sortSvc:l,pinnedCols:u,colFlex:c}=e;n!==void 0&&t.setVisible(!n,a),l&&(l.updateColSort(t,i,a),r!==void 0&&l.setColSortIndex(t,r)),s!==void 0&&u?.setColPinned(t,s),o!==void 0&&c?.setColFlex(t,o)}function h7e(e,t,n,i){one(e,t,n.hide,n.sort,n.sortIndex,n.pinned,n.flex,i);const r=t.getFlex();if(!(r!=null&&r>0))if(n.width!=null)t.setActualWidth(n.width,i);else{const s=t.getActualWidth();t.setActualWidth(s,i)}}function f7e(e,t){if(t)for(let n=0;n<t.length;n++){const i=t[n].getUserProvidedColDef();if(!i)continue;if(e.colId!=null){if(t[n].getId()===e.colId)return{idx:n,column:t[n]};continue}if(e.field!=null){if(i.field===e.field)return{idx:n,column:t[n]};continue}if(i===e)return{idx:n,column:t[n]}}}function MT(e,t,n,i){const{gos:r,dataTypeSvc:s,validation:o}=e,a={},l=r.get("defaultColDef");ir(a,l,!1,!0);const u=p7e(e,a,t,n);u&&g7e(e,u,a),ir(a,t,!1,!0);const c=r.get("autoGroupColumnDef"),d=sa(r);return t.rowGroup&&c&&d&&ir(a,{sort:c.sort,initialSort:c.initialSort},!1,!0),s?.validateColDef(a),o?.validateColDef(a,n,i),a}function p7e(e,t,n,i){const r=e.dataTypeSvc?.updateColDefAndGetColumnType(t,n,i),s=n.type??r??t.type;return t.type=s,s?YS(s):void 0}function g7e(e,t,n){if(!t.length)return;const i=Object.assign({},i7e),r=e.gos.get("columnTypes")||{};for(const s of Object.keys(r)){const o=r[s];s in i?ue(34,{key:s}):(o.type&&ue(35),i[s]=o)}t.forEach(s=>{const o=i[s.trim()];o?ir(n,o,!1,!0):ue(36,{t:s})})}function m7e(e){return e.children!==void 0}function Al(e,t,n){if(t)for(let i=0;i<t.length;i++){const r=t[i];Ui(r)&&Al(r,r.getChildren(),n),n(r,e)}}function ane(e,t){const n=[],i=[],r=[];return e.forEach(o=>{const a=o.getColDef().lockPosition;a==="right"?r.push(o):a==="left"||a===!0?n.push(o):i.push(o)}),t.get("enableRtl")?[...r,...i,...n]:[...n,...i,...r]}function lne(e,t){let n=!0;return Al(null,t,i=>{if(!Ui(i))return;const r=i,s=r.getColGroupDef();if(!(s&&s.marryChildren))return;const a=[];r.getLeafColumns().forEach(h=>{const p=e.indexOf(h);a.push(p)});const l=Math.max.apply(Math,a),u=Math.min.apply(Math,a),c=l-u,d=r.getLeafColumns().length-1;c>d&&(n=!1)}),n}function une(e,t){if(!e||e.length==0)return;const n=t(e[0]);for(let i=1;i<e.length;i++)if(n!==t(e[i]))return;return n}function cne(e,t,n){if(!t.length)return;const i=t.length===1?t[0]:null,r=une(t,s=>s.getPinned());e.dispatchEvent({type:"columnPinned",pinned:r??null,columns:t,column:i,source:n})}function v7e(e,t,n){if(!t.length)return;const i=t.length===1?t[0]:null,r=une(t,s=>s.isVisible());e.dispatchEvent({type:"columnVisible",visible:r,columns:t,column:i,source:n})}function C7e(e,t,n,i){e.dispatchEvent({type:t,columns:n,column:n&&n.length==1?n[0]:null,source:i})}function Fp(e,t,n,i,r=null){t?.length&&e.dispatchEvent({type:"columnResized",columns:t,column:t.length===1?t[0]:null,flexColumns:r,finished:n,source:i})}function Jr(e,t,n){const{colModel:i,rowGroupColsSvc:r,pivotColsSvc:s,autoColSvc:o,selectionColSvc:a,colAnimation:l,visibleCols:u,pivotResultCols:c,environment:d,valueColsSvc:h,eventSvc:p,gos:g}=e,v=i.getColDefCols()||[];if(!v?.length)return!1;if(t?.state&&!t.state.forEach)return ue(32),!1;const C=(x,E,A,F,k)=>{if(!x)return;const P=l7e(E,t.defaultState),_=P("flex").value1;if(one(e,x,P("hide").value1,P("sort").value1,P("sortIndex").value1,P("pinned").value1,_,n),_==null){const O=P("width").value1;if(O!=null){const H=x.getColDef().minWidth??d.getDefaultColumnMinWidth();H!=null&&O>=H&&x.setActualWidth(O,n)}}k||!x.isPrimary()||(h?.syncColumnWithState(x,n,P),r?.syncColumnWithState(x,n,P,A),s?.syncColumnWithState(x,n,P,F))},y=(x,E,A)=>{const F=dne(e,n),k=E.slice(),P={},_={},O=[],H=[],W=[];let $=0;const L=r?.columns.slice()??[],G=s?.columns.slice()??[];x.forEach(q=>{const fe=q.colId;if(fe.startsWith(IR)){O.push(q),W.push(q);return}if(zl(fe)){H.push(q),W.push(q);return}const Fe=A(fe);Fe?(C(Fe,q,P,_,!1),Ao(k,Fe)):(W.push(q),$+=1)});const j=q=>C(q,null,P,_,!1);k.forEach(j),r?.sortColumns(Z6.bind(r,P,L)),s?.sortColumns(Z6.bind(s,_,G)),i.refreshCols(!1);const ee=(q,fe,Re=[])=>{fe.forEach(Fe=>{const ze=q(Fe.colId);Ao(Re,ze),C(ze,Fe,null,null,!0)}),Re.forEach(j)};return ee(q=>o?.getColumn(q)??null,O,o?.getColumns()?.slice()),ee(q=>a?.getColumn(q)??null,H,a?.getColumns()?.slice()),w7e(t,i,g),u.refresh(n),p.dispatchEvent({type:"columnEverythingChanged",source:n}),F(),{unmatchedAndAutoStates:W,unmatchedCount:$}};l?.start();let{unmatchedAndAutoStates:b,unmatchedCount:S}=y(t.state||[],v,x=>i.getColDefCol(x));if(b.length>0||me(t.defaultState)){const x=c?.getPivotResultCols()?.list??[];S=y(b,x,E=>c?.getPivotResultCol(E)??null).unmatchedCount}return l?.finish(),S===0}function y7e(e,t){const{colModel:n,autoColSvc:i,selectionColSvc:r}=e,s=n.getColDefCols();if(!s?.length)return;const o=n.getColDefColTree(),a=ine(o),l=[];let u=1e3,c=1e3;const d=C=>{const y=hne(C);Wt(y.rowGroupIndex)&&y.rowGroup&&(y.rowGroupIndex=u++),Wt(y.pivotIndex)&&y.pivot&&(y.pivotIndex=c++),l.push(y)};i?.getColumns()?.forEach(d),r?.getColumns()?.forEach(d),a?.forEach(d),Jr(e,{state:l},t);const h=i?.getColumns()??[],v=[...r?.getColumns()??[],...h,...s].map(C=>({colId:C.colId}));Jr(e,{state:v,applyOrder:!0},t)}function dne(e,t){const{rowGroupColsSvc:n,pivotColsSvc:i,valueColsSvc:r,colModel:s,sortSvc:o,eventSvc:a}=e,l={rowGroupColumns:n?.columns.slice()??[],pivotColumns:i?.columns.slice()??[],valueColumns:r?.columns.slice()??[]},u=h0(e),c={};return u.forEach(d=>{c[d.colId]=d}),()=>{const d=(A,F,k,P)=>{const _=F.map(P),O=k.map(P);if(Sh(_,O))return;const W=new Set(F);k.forEach(L=>{W.delete(L)||W.add(L)});const $=[...W];a.dispatchEvent({type:A,columns:$,column:$.length===1?$[0]:null,source:t})},h=A=>{const F=[];return s.forAllCols(k=>{const P=c[k.getColId()];P&&A(P,k)&&F.push(k)}),F},p=A=>A.getColId();d("columnRowGroupChanged",l.rowGroupColumns,n?.columns??[],p),d("columnPivotChanged",l.pivotColumns,i?.columns??[],p);const v=h((A,F)=>{const k=A.aggFunc!=null,P=k!=F.isValueActive(),_=k&&A.aggFunc!=F.getAggFunc();return P||_});v.length>0&&C7e(a,"columnValueChanged",v,t),Fp(a,h((A,F)=>A.width!=F.getActualWidth()),!0,t),cne(a,h((A,F)=>A.pinned!=F.getPinned()),t),v7e(a,h((A,F)=>A.hide==F.isVisible()),t);const x=h((A,F)=>A.sort!=F.getSort()||A.sortIndex!=F.getSortIndex());x.length>0&&o?.dispatchSortChangedEvents(t,x);const E=h0(e);S7e(u,E,t,s,a)}}function h0(e){const{colModel:t,rowGroupColsSvc:n,pivotColsSvc:i}=e,r=t.getColDefCols();if(Wt(r)||!t.isAlive())return[];const s=n?.columns,o=i?.columns,a=[],l=c=>{const d=c.isRowGroupActive()&&s?s.indexOf(c):null,h=c.isPivotActive()&&o?o.indexOf(c):null,p=c.isValueActive()?c.getAggFunc():null,g=c.getSort()!=null?c.getSort():null,v=c.getSortIndex()!=null?c.getSortIndex():null;a.push({colId:c.getColId(),width:c.getActualWidth(),hide:!c.isVisible(),pinned:c.getPinned(),sort:g,sortIndex:v,aggFunc:p,rowGroup:c.isRowGroupActive(),rowGroupIndex:d,pivot:c.isPivotActive(),pivotIndex:h,flex:c.getFlex()??null})};t.forAllCols(c=>l(c));const u=new Map(t.getCols().map((c,d)=>[c.getColId(),d]));return a.sort((c,d)=>{const h=u.has(c.colId)?u.get(c.colId):-1,p=u.has(d.colId)?u.get(d.colId):-1;return h-p}),a}function hne(e){const t=(g,v)=>g??v??null,n=e.getColDef(),i=t(n.sort,n.initialSort),r=t(n.sortIndex,n.initialSortIndex),s=t(n.hide,n.initialHide),o=t(n.pinned,n.initialPinned),a=t(n.width,n.initialWidth),l=t(n.flex,n.initialFlex);let u=t(n.rowGroupIndex,n.initialRowGroupIndex),c=t(n.rowGroup,n.initialRowGroup);u==null&&(c==null||c==!1)&&(u=null,c=null);let d=t(n.pivotIndex,n.initialPivotIndex),h=t(n.pivot,n.initialPivot);d==null&&(h==null||h==!1)&&(d=null,h=null);const p=t(n.aggFunc,n.initialAggFunc);return{colId:e.getColId(),sort:i,sortIndex:r,hide:s,pinned:o,width:a,flex:l,rowGroup:c,rowGroupIndex:u,pivot:h,pivotIndex:d,aggFunc:p}}function w7e(e,t,n){if(!e.applyOrder||!e.state)return;const i=[];e.state.forEach(r=>{r.colId!=null&&i.push(r.colId)}),b7e(t.cols,i,t,n)}function b7e(e,t,n,i){if(e==null)return;let r=[];const s={};t.forEach(a=>{if(s[a])return;const l=e.map[a];l&&(r.push(l),s[a]=!0)});let o=0;if(e.list.forEach(a=>{const l=a.getColId();if(s[l]!=null)return;l.startsWith(IR)?r.splice(o++,0,a):r.push(a)}),r=ane(r,i),!lne(r,n.getColTree())){ue(39);return}e.list=r}function S7e(e,t,n,i,r){const s={};t.forEach(c=>s[c.colId]=c);const o={};e.forEach(c=>{s[c.colId]&&(o[c.colId]=!0)});const a=e.filter(c=>o[c.colId]),l=t.filter(c=>o[c.colId]),u=[];l.forEach((c,d)=>{const h=a&&a[d];if(h&&h.colId!==c.colId){const p=i.getCol(h.colId);p&&u.push(p)}}),u.length&&r.dispatchEvent({type:"columnMoved",columns:u,column:u.length===1?u[0]:null,finished:!0,source:n})}var Z6=(e,t,n,i)=>{const r=e[n.getId()],s=e[i.getId()],o=r!=null,a=s!=null;if(o&&a)return r-s;if(o)return-1;if(a)return 1;const l=t.indexOf(n),u=t.indexOf(i),c=l>=0,d=u>=0;return c&&d?l-u:c?-1:1},x7e=class extends X{constructor(){super(...arguments),this.beanName="colModel",this.pivotMode=!1,this.ready=!1,this.changeEventsDispatching=!1}postConstruct(){this.pivotMode=this.gos.get("pivotMode"),this.addManagedPropertyListeners(["groupDisplayType","treeData","treeDataDisplayType","groupHideOpenParents"],e=>this.refreshAll(_f(e.source))),this.addManagedPropertyListeners(["defaultColDef","defaultColGroupDef","columnTypes","suppressFieldDotNotation"],this.recreateColumnDefs.bind(this)),this.addManagedPropertyListener("pivotMode",e=>this.setPivotMode(this.gos.get("pivotMode"),_f(e.source)))}createColsFromColDefs(e){const{beans:t}=this,{valueCache:n,colAutosize:i,rowGroupColsSvc:r,pivotColsSvc:s,valueColsSvc:o,visibleCols:a,colViewport:l,eventSvc:u}=t,c=this.colDefs?dne(t,e):void 0;n?.expire();const d=this.colDefCols?.list,h=this.colDefCols?.tree,p=u7e(t,this.colDefs,!0,h,e);KS(t,this.colDefCols?.tree,p.columnTree);const g=p.columnTree,v=p.treeDept,C=ine(g),y={};C.forEach(b=>y[b.getId()]=b),this.colDefCols={tree:g,treeDepth:v,list:C,map:y},r?.extractCols(e,d),s?.extractCols(e,d),o?.extractCols(e,d),this.ready=!0,this.refreshCols(!0),a.refresh(e),l.checkViewportColumns(),u.dispatchEvent({type:"columnEverythingChanged",source:e}),c&&(this.changeEventsDispatching=!0,c(),this.changeEventsDispatching=!1),u.dispatchEvent({type:"newColumnsLoaded",source:e}),e==="gridInitializing"&&i?.applyAutosizeStrategy()}refreshCols(e){if(!this.colDefCols)return;const t=this.cols?.tree;this.saveColOrder();const{autoColSvc:n,selectionColSvc:i,rowNumbersSvc:r,quickFilter:s,pivotResultCols:o,showRowGroupCols:a,rowAutoHeight:l,visibleCols:u,colViewport:c,eventSvc:d}=this.beans,h=this.selectCols(o,this.colDefCols);this.createColumnsForService([n,i,r],h);const p=P9e(this.gos,this.showingPivotResult);(!e||p)&&this.restoreColOrder(h),this.positionLockedCols(h),a?.refresh(),s?.refreshCols(),this.setColSpanActive(),l?.setAutoHeightActive(h),u.clear(),c.clear(),!Sh(t,this.cols.tree)&&d.dispatchEvent({type:"gridColumnsChanged"})}createColumnsForService(e,t){for(const n of e)n&&(n.createColumns(t,i=>{this.lastOrder=i(this.lastOrder),this.lastPivotOrder=i(this.lastPivotOrder)}),n.addColumns(t))}selectCols(e,t){const n=e?.getPivotResultCols()??null;this.showingPivotResult=n!=null;const{map:i,list:r,tree:s,treeDepth:o}=n??t;return this.cols={list:r.slice(),map:{...i},tree:s.slice(),treeDepth:o},n&&(n.list.some(l=>this.cols?.map[l.getColId()]!==void 0)||(this.lastPivotOrder=null)),this.cols}getColsToShow(){if(!this.cols)return[];const e=this.isPivotMode()&&!this.showingPivotResult,t=this.beans.valueColsSvc?.columns;return this.cols.list.filter(i=>{const r=vN(i);if(e){const s=t?.includes(i);return r||s}else return r||i.isVisible()})}refreshAll(e){this.ready&&(this.refreshCols(!1),this.beans.visibleCols.refresh(e))}setColsVisible(e,t=!1,n){Jr(this.beans,{state:e.map(i=>({colId:typeof i=="string"?i:i.getColId(),hide:!t}))},n)}restoreColOrder(e){const t=this.showingPivotResult?this.lastPivotOrder:this.lastOrder;if(!t)return;const n=new Map(t.map((u,c)=>[u,c]));if(!e.list.some(u=>n.has(u)))return;const r=new Map(e.list.map(u=>[u,!0])),s=t.filter(u=>r.has(u)),o=new Map(s.map(u=>[u,!0])),a=e.list.filter(u=>!o.has(u)),l=s.slice();a.forEach(u=>{let c=u.getOriginalParent();if(!c){l.push(u);return}const d=[];for(;!d.length&&c;)c.getLeafColumns().forEach(v=>{const C=l.indexOf(v)>=0,y=d.indexOf(v)<0;C&&y&&d.push(v)}),c=c.getOriginalParent();if(!d.length){l.push(u);return}const h=d.map(g=>l.indexOf(g)),p=Math.max(...h);l.splice(p+1,0,u)}),e.list=l}positionLockedCols(e){e.list=ane(e.list,this.gos)}saveColOrder(){this.showingPivotResult?this.lastPivotOrder=this.cols?.list??null:this.lastOrder=this.cols?.list??null}getColumnDefs(){return this.colDefCols?this.beans.colDefFactory?.getColumnDefs(this.colDefCols.list,this.showingPivotResult,this.lastOrder,this.cols?.list??[]):void 0}setColSpanActive(){this.colSpanActive=!!this.cols?.list.some(e=>e.getColDef().colSpan!=null)}isPivotMode(){return this.pivotMode}setPivotMode(e,t){if(e===this.pivotMode||(this.pivotMode=e,!this.ready))return;this.refreshCols(!1);const{visibleCols:n,eventSvc:i}=this.beans;n.refresh(t),i.dispatchEvent({type:"columnPivotModeChanged"})}isPivotActive(){const e=this.beans.pivotColsSvc?.columns;return this.pivotMode&&!!e?.length}recreateColumnDefs(e){if(!this.cols)return;this.beans.autoColSvc?.updateColumns(e);const t=_f(e.source);this.createColsFromColDefs(t)}setColumnDefs(e,t){this.colDefs=e,this.createColsFromColDefs(t)}destroy(){KS(this.beans,this.colDefCols?.tree),super.destroy()}getColTree(){return this.cols?.tree??[]}getColDefColTree(){return this.colDefCols?.tree??[]}getColDefCols(){return this.colDefCols?.list??null}getCols(){return this.cols?.list??[]}forAllCols(e){const{pivotResultCols:t,autoColSvc:n,selectionColSvc:i}=this.beans;ow(this.colDefCols?.list,e),ow(n?.columns?.list,e),ow(i?.columns?.list,e),ow(t?.getPivotResultCols()?.list,e)}getColsForKeys(e){return e?e.map(t=>this.getCol(t)).filter(t=>t!=null):[]}getColDefCol(e){return this.colDefCols?.list?this.getColFromCollection(e,this.colDefCols):null}getCol(e){return e==null?null:this.getColFromCollection(e,this.cols)}getColFromCollection(e,t){if(t==null)return null;const{map:n,list:i}=t;if(typeof e=="string"&&n[e])return n[e];for(let r=0;r<i.length;r++)if(rne(i[r],e))return i[r];return this.beans.autoColSvc?.getColumn(e)??this.beans.selectionColSvc?.getColumn(e)??null}},fne=class{constructor(){this.existingIds={}}getInstanceIdForKey(e){const t=this.existingIds[e];let n;return typeof t!="number"?n=0:n=t+1,this.existingIds[e]=n,n}};function wC(e,t,n){return n&&e.addDestroyFunc(()=>t.destroyBean(n)),n??e}var pne=class{constructor(e){this.cssClassStates={},this.getGui=e}addCssClass(e){this.addOrRemoveCssClass(e,!0)}removeCssClass(e){this.addOrRemoveCssClass(e,!1)}containsCssClass(e){const t=this.getGui();return t?t.classList.contains(e):!1}addOrRemoveCssClass(e,t){if(!e)return;if(e.indexOf(" ")>=0){const i=(e||"").split(" ");if(i.length>1){i.forEach(r=>this.addOrRemoveCssClass(r,t));return}}if(this.cssClassStates[e]!==t&&e.length){const i=this.getGui();i&&i.classList.toggle(e,t),this.cssClassStates[e]=t}}},R7e=0,ge=null,bt=class extends X{constructor(e,t){super(),this.suppressDataRefValidation=!1,this.displayed=!0,this.visible=!0,this.compId=R7e++,this.cssClassManager=new pne(()=>this.eGui),this.componentSelectors=new Map((t??[]).map(n=>[n.selector,n])),e&&this.setTemplate(e)}preConstruct(){this.wireTemplate(this.getGui());const e="component-"+Object.getPrototypeOf(this)?.constructor?.name;this.css?.forEach(t=>this.beans.environment.addGlobalCSS(t,e))}wireTemplate(e,t){e&&this.gos&&(this.applyElementsToComponent(e),this.createChildComponentsFromTags(e,t))}getCompId(){return this.compId}getDataRefAttribute(e){return e.getAttribute?e.getAttribute(Ote):null}applyElementsToComponent(e,t,n,i=null){if(t===void 0&&(t=this.getDataRefAttribute(e)),t){const r=this[t];if(r===ge)this[t]=i??e;else{const s=n&&n[t];if(!this.suppressDataRefValidation&&!s)throw new Error(`data-ref: ${t} on ${this.constructor.name} with ${r}`)}}}createChildComponentsFromTags(e,t){const n=[];for(const i of e.childNodes??[])n.push(i);n.forEach(i=>{if(!(i instanceof HTMLElement))return;const r=this.createComponentFromElement(i,s=>{const o=s.getGui();if(o)for(const a of i.attributes??[])o.setAttribute(a.name,a.value)},t);if(r){if(r.addItems&&i.children.length){this.createChildComponentsFromTags(i,t);const s=Array.prototype.slice.call(i.children);r.addItems(s)}this.swapComponentForNode(r,e,i)}else i.childNodes&&this.createChildComponentsFromTags(i,t)})}createComponentFromElement(e,t,n){const i=e.nodeName,r=this.getDataRefAttribute(e),s=i.indexOf("AG-")===0,o=s?this.componentSelectors.get(i):null;let a=null;if(o){const l=n&&r?n[r]:void 0;a=new o.component(l),a.setParentComponent(this),this.createBean(a,null,t)}else if(s)throw new Error(`selector: ${i}`);return this.applyElementsToComponent(e,r,n,a),a}swapComponentForNode(e,t,n){const i=e.getGui();t.replaceChild(i,n),t.insertBefore(document.createComment(n.nodeName),i),this.addDestroyFunc(this.destroyBean.bind(this,e))}activateTabIndex(e){const t=this.gos.get("tabIndex");e||(e=[]),e.length||e.push(this.getGui()),e.forEach(n=>n.setAttribute("tabindex",t.toString()))}setTemplate(e,t,n){let i;typeof e=="string"||e==null?i=MR(e):i=Cn(e),this.setTemplateFromElement(i,t,n)}setTemplateFromElement(e,t,n,i=!1){if(this.eGui=e,this.suppressDataRefValidation=i,t)for(let r=0;r<t.length;r++){const s=t[r];this.componentSelectors.set(s.selector,s)}this.wireTemplate(e,n)}getGui(){return this.eGui}getFocusableElement(){return this.eGui}getAriaElement(){return this.getFocusableElement()}setParentComponent(e){this.parentComponent=e}getParentComponent(){return this.parentComponent}setGui(e){this.eGui=e}queryForHtmlElement(e){return this.eGui.querySelector(e)}getContainerAndElement(e,t){let n=t;return e==null?null:(n||(n=this.eGui),dN(e)?{element:e,parent:n}:{element:e.getGui(),parent:n})}prependChild(e,t){const{element:n,parent:i}=this.getContainerAndElement(e,t)||{};!n||!i||i.insertAdjacentElement("afterbegin",n)}appendChild(e,t){const{element:n,parent:i}=this.getContainerAndElement(e,t)||{};!n||!i||i.appendChild(n)}isDisplayed(){return this.displayed}setVisible(e,t={}){if(e!==this.visible){this.visible=e;const{skipAriaHidden:n}=t;p9e(this.eGui,e,{skipAriaHidden:n})}}setDisplayed(e,t={}){if(e!==this.displayed){this.displayed=e;const{skipAriaHidden:n}=t;Yt(this.eGui,e,{skipAriaHidden:n});const i={type:"displayChanged",visible:this.displayed};this.dispatchLocalEvent(i)}}destroy(){this.parentComponent&&(this.parentComponent=void 0),super.destroy()}addGuiEventListener(e,t,n){this.eGui.addEventListener(e,t,n),this.addDestroyFunc(()=>this.eGui.removeEventListener(e,t))}addCssClass(e){this.cssClassManager.addCssClass(e)}removeCssClass(e){this.cssClassManager.removeCssClass(e)}containsCssClass(e){return this.cssClassManager.containsCssClass(e)}addOrRemoveCssClass(e,t){this.cssClassManager.addOrRemoveCssClass(e,t)}registerCSS(e){this.css||(this.css=[]),this.css.push(e)}},Ji=class Wm{constructor(t){this.status=0,this.resolution=null,this.waiters=[],t(n=>this.onDone(n),n=>this.onReject(n))}static all(t){return t.length?new Wm(n=>{let i=t.length;const r=new Array(i);t.forEach((s,o)=>{s.then(a=>{r[o]=a,i--,i===0&&n(r)})})}):Wm.resolve()}static resolve(t=null){return new Wm(n=>n(t))}then(t){return new Wm(n=>{this.status===1?n(t(this.resolution)):this.waiters.push(i=>n(t(i)))})}onDone(t){this.status=1,this.resolution=t,this.waiters.forEach(n=>n(t))}onReject(t){}};function E7e(e){return e?e.prototype&&"getGui"in e.prototype:!1}function gne(e,t,n,i){const{name:r}=n;let s,o,a,l,u,c;if(t){const d=t,h=d[r+"Selector"],p=h?h(i):null,g=v=>{typeof v=="string"?s=v:v!=null&&v!==!0&&(e.isFrameworkComponent(v)?a=v:o=v)};p?(g(p.component),l=p.params,u=p.popup,c=p.popupPosition):g(d[r])}return{compName:s,jsComp:o,fwComp:a,paramsFromSelector:l,popupFromSelector:u,popupPositionFromSelector:c}}var F7e=class extends X{constructor(){super(...arguments),this.beanName="userCompFactory"}wireBeans(e){this.agCompUtils=e.agCompUtils,this.registry=e.registry,this.frameworkCompWrapper=e.frameworkCompWrapper,this.gridOptions=e.gridOptions}getCompDetailsFromGridOptions(e,t,n,i=!1){return this.getCompDetails(this.gridOptions,e,t,n,i)}getCompDetails(e,t,n,i,r=!1){const{name:s,cellRenderer:o}=t;let{compName:a,jsComp:l,fwComp:u,paramsFromSelector:c,popupFromSelector:d,popupPositionFromSelector:h}=gne(this.beans.frameworkOverrides,e,t,i),p;const g=b=>{const S=this.registry.getUserComponent(s,b);S&&(l=S.componentFromFramework?void 0:S.component,u=S.componentFromFramework?S.component:void 0,p=S.params)};if(a!=null&&g(a),l==null&&u==null&&n!=null&&g(n),l&&o&&!E7e(l)&&(l=this.agCompUtils?.adaptFunction(t,l)),!l&&!u){const{validation:b}=this.beans;r&&(a!==n||!n)?a?b?.isProvidedUserComp(a)||wt(50,{compName:a}):n?b||wt(260,{...this.gos.getModuleErrorParams(),propName:s,compName:n}):wt(216,{name:s}):n&&!b&&wt(146,{comp:n});return}const v=this.mergeParams(e,t,i,c,p),C=l==null,y=l??u;return{componentFromFramework:C,componentClass:y,params:v,type:t,popupFromSelector:d,popupPositionFromSelector:h,newAgStackInstance:()=>this.newAgStackInstance(y,C,v,t)}}newAgStackInstance(e,t,n,i){const r=!t;let s;r?s=new e:s=this.frameworkCompWrapper.wrap(e,i.mandatoryMethods,i.optionalMethods,i),this.createBean(s);const o=s.init?.(n);return o==null?Ji.resolve(s):o.then(()=>s)}mergeParams(e,t,n,i=null,r){const s={...n,...r},o=e,a=o&&o[t.name+"Params"];if(typeof a=="function"){const l=a(n);ir(s,l)}else typeof a=="object"&&ir(s,a);return ir(s,i),s}},A7e={name:"dateComponent",mandatoryMethods:["getDate","setDate"],optionalMethods:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled","refresh"]},D7e={name:"dragAndDropImageComponent",mandatoryMethods:["setIcon","setLabel"]},P7e={name:"headerComponent",optionalMethods:["refresh"]},k7e={name:"innerHeaderComponent"},T7e={name:"innerHeaderGroupComponent"},M7e={name:"headerGroupComponent"},I7e={name:"cellRenderer",optionalMethods:["refresh","afterGuiAttached"],cellRenderer:!0},_7e={name:"loadingCellRenderer",cellRenderer:!0},O7e={name:"cellEditor",mandatoryMethods:["getValue"],optionalMethods:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached","refresh"]},L7e={name:"loadingOverlayComponent",optionalMethods:["refresh"]},N7e={name:"noRowsOverlayComponent",optionalMethods:["refresh"]},$7e={name:"tooltipComponent"},CN={name:"filter",mandatoryMethods:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethods:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged","refresh"]},B7e={name:"floatingFilterComponent",mandatoryMethods:["onParentModelChanged"],optionalMethods:["afterGuiAttached","refresh"]},G7e={name:"fullWidthCellRenderer",optionalMethods:["refresh","afterGuiAttached"],cellRenderer:!0},z7e={name:"loadingCellRenderer",cellRenderer:!0},H7e={name:"groupRowRenderer",optionalMethods:["afterGuiAttached"],cellRenderer:!0},V7e={name:"detailCellRenderer",optionalMethods:["refresh"],cellRenderer:!0};function W7e(e,t){return e.getCompDetailsFromGridOptions(D7e,"agDragAndDropImage",t,!0)}function U7e(e,t,n){return e.getCompDetails(t,P7e,"agColumnHeader",n)}function j7e(e,t,n){return e.getCompDetails(t,k7e,void 0,n)}function q7e(e,t){const n=t.columnGroup.getColGroupDef();return e.getCompDetails(n,M7e,"agColumnGroupHeader",t)}function K7e(e,t,n){return e.getCompDetails(t,T7e,void 0,n)}function Y7e(e,t){return e.getCompDetailsFromGridOptions(G7e,void 0,t,!0)}function X7e(e,t){return e.getCompDetailsFromGridOptions(z7e,"agLoadingCellRenderer",t,!0)}function Q7e(e,t){return e.getCompDetailsFromGridOptions(H7e,"agGroupRowRenderer",t,!0)}function J7e(e,t){return e.getCompDetailsFromGridOptions(V7e,"agDetailCellRenderer",t,!0)}function eW(e,t,n){return e.getCompDetails(t,I7e,void 0,n)}function Z7e(e,t,n){return e.getCompDetails(t,_7e,"agSkeletonCellRenderer",n,!0)}function tW(e,t,n){return e.getCompDetails(t,O7e,"agCellEditor",n,!0)}function eje(e,t,n,i){return e.getCompDetails(t,CN,i,n,!0)}function tje(e,t,n){return e.getCompDetails(t,A7e,"agDateInput",n,!0)}function nje(e,t){return e.getCompDetailsFromGridOptions(L7e,"agLoadingOverlay",t,!0)}function ije(e,t){return e.getCompDetailsFromGridOptions(N7e,"agNoRowsOverlay",t,!0)}function rje(e,t){return e.getCompDetails(t.colDef,$7e,"agTooltipComponent",t,!0)}function sje(e,t,n,i){return e.getCompDetails(t,B7e,i,n)}function oje(e,t){return gne(e,t,CN)}function aje(e,t,n){return e.mergeParams(t,CN,n)}function f0(e){const t=e;return t!=null&&t.getFrameworkComponentInstance!=null?t.getFrameworkComponentInstance():e}var mne=new Set,XS={},Of={},qw,vne=!1,lje=!1;function uje(e){const[t,n]=e.version.split(".")||[],[i,r]=qw.split(".")||[];return t===i&&n===r}function cje(e){qw||(qw=e.version);const t=n=>`You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. ${n} Please update all modules to the same version.`;if(e.version?uje(e)||Tf(t(`'${e.moduleName}' is version ${e.version} but the other modules are version ${qw}.`)):Tf(t(`'${e.moduleName}' is incompatible.`)),e.validate){const n=e.validate();n.isValid||Tf(`${n.message}`)}}function p0(e,t){cje(e);const n=e.rowModels??["all"];mne.add(e);let i;t!==void 0?(vne=!0,Of[t]===void 0&&(Of[t]={}),i=Of[t]):i=XS,n.forEach(r=>{i[r]===void 0&&(i[r]={}),i[r][e.moduleName]=e}),e.dependsOn&&e.dependsOn.forEach(r=>p0(r,t))}function dje(e){delete Of[e]}function Cne(e,t,n){const i=r=>!!XS[r]?.[e]||!!Of[t]?.[r]?.[e];return i(n)||i("all")}function yN(){return vne}function hje(e,t){const n=Of[e]??{};return[...Object.values(XS.all??{}),...Object.values(n.all??{}),...Object.values(XS[t]??{}),...Object.values(n[t]??{})]}function fje(){return new Set(mne)}function pje(){return lje}var yne=class{static register(e){p0(e,void 0)}static registerModules(e){e.forEach(t=>p0(t,void 0))}},gje=class{constructor(e){this.beans={},this.createdBeans=[],this.destroyed=!1,!(!e||!e.beanClasses)&&(this.beanDestroyComparator=e.beanDestroyComparator,this.init(e))}init(e){for(const t of Object.keys(e.providedBeanInstances))this.beans[t]=e.providedBeanInstances[t];e.beanClasses.forEach(t=>{const n=new t;n.beanName?this.beans[n.beanName]=n:console.error(`Bean ${t.name} is missing beanName`),this.createdBeans.push(n)}),e.derivedBeans?.forEach(t=>{const{beanName:n,bean:i}=t(this);this.beans[n]=i,this.createdBeans.push(i)}),e.beanInitComparator&&this.createdBeans.sort(e.beanInitComparator),this.initBeans(this.createdBeans)}getBeanInstances(){return Object.values(this.beans)}createBean(e,t){if(!e)throw Error("null bean");return this.initBeans([e],t),e}initBeans(e,t){e.forEach(n=>{n.preWireBeans?.(this.beans),n.wireBeans?.(this.beans)}),e.forEach(n=>n.preConstruct?.()),t&&e.forEach(t),e.forEach(n=>n.postConstruct?.())}getBeans(){return this.beans}getBean(e){return this.beans[e]}destroy(){if(this.destroyed)return;this.destroyed=!0;const e=this.getBeanInstances();this.beanDestroyComparator&&e.sort(this.beanDestroyComparator),this.destroyBeans(e),this.beans={},this.createdBeans=[]}destroyBean(e){e?.destroy?.()}destroyBeans(e){if(e)for(let t=0;t<e.length;t++)this.destroyBean(e[t]);return[]}isDestroyed(){return this.destroyed}},mje=class extends gje{init(e){this.gridId=e.gridId,this.beans.context=this,this.destroyCallback=e.destroyCallback,super.init(e)}destroy(){super.destroy(),dje(this.gridId),this.destroyCallback?.()}getGridId(){return this.gridId}},vje="ag-column-first",Cje="ag-column-last";function wne(e,t,n,i){return Wt(e)?[]:wje(e.headerClass,e,t,n,i)}function bne(e,t,n){e.addOrRemoveCssClass(vje,n.isColAtEdge(t,"first")),e.addOrRemoveCssClass(Cje,n.isColAtEdge(t,"last"))}function yje(e,t,n,i){return Ne(t,{colDef:e,column:n,columnGroup:i})}function wje(e,t,n,i,r){if(Wt(e))return[];let s;if(typeof e=="function"){const o=yje(t,n,i,r);s=e(o)}else s=e;return typeof s=="string"?[s]:Array.isArray(s)?[...s]:[]}var K={BACKSPACE:"Backspace",TAB:"Tab",ENTER:"Enter",ESCAPE:"Escape",SPACE:" ",LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown",DELETE:"Delete",F2:"F2",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",PAGE_HOME:"Home",PAGE_END:"End",A:"KeyA",C:"KeyC",D:"KeyD",V:"KeyV",X:"KeyX",Y:"KeyY",Z:"KeyZ"},IT=!1,QS=0;function bje(e){QS>0||(e.addEventListener("keydown",JS),e.addEventListener("mousedown",JS))}function Sje(e){QS>0||(e.removeEventListener("keydown",JS),e.removeEventListener("mousedown",JS))}function JS(e){const t=IT,n=e.type==="keydown";n&&(e.ctrlKey||e.metaKey||e.altKey)||t!==n&&(IT=n)}function xje(e){const t=Rn(e);return bje(t),QS++,()=>{QS--,Sje(t)}}function Rje(){return IT}function Eje(e,t,n){t.addManagedElementListeners(n,{keydown:i=>{if(!i.defaultPrevented&&i.key===K.TAB){const r=i.shiftKey;xh(e,n,!1,r)||Ap(e,r)&&i.preventDefault()}}})}function Lf(e,t,n=!1){const i=f9e;let r=Pte;t&&(r+=", "+t),n&&(r+=', [tabindex="-1"]');const s=Array.prototype.slice.apply(e.querySelectorAll(i)).filter(l=>Fo(l)),o=Array.prototype.slice.apply(e.querySelectorAll(r));return o.length?((l,u)=>l.filter(c=>u.indexOf(c)===-1))(s,o):s}function eh(e,t=!1,n=!1,i=!1){const r=Lf(e,i?".ag-tab-guard":null,n),s=t?Tt(r):r[0];return s?(s.focus({preventScroll:!0}),!0):!1}function xh(e,t,n,i){const r=Lf(t,n?':not([tabindex="-1"])':null),s=Xt(e);let o;n?o=r.findIndex(l=>l.contains(s)):o=r.indexOf(s);const a=o+(i?-1:1);return a<0||a>=r.length?null:r[a]}function Sne(e,t=5){let n=0;for(;e&&RT(e)===null&&++n<=t;)e=e.parentElement;return RT(e)===null?null:e}function Fje(e,t){return e.ctrlsSvc.get("gridCtrl").focusInnerElement(t)}function Ad(e){return e.gos.get("suppressHeaderFocus")||!!e.overlays?.isExclusive()}function _R(e){return e.gos.get("suppressCellFocus")||!!e.overlays?.isExclusive()}function Ap(e,t,n=!1){const i=e.ctrlsSvc.get("gridCtrl");return!n&&i.focusNextInnerContainer(t)?!0:((n||!t&&!i.isDetailGrid())&&i.forceFocusOutOfContainer(t),!1)}function Aje(e,t=!1){return e===K.DELETE?!0:!t&&e===K.BACKSPACE?Fte():!1}var Dje=class extends X{constructor(e,t,n,i){super(),this.cellCtrl=e,this.rowNode=n,this.rowCtrl=i,this.beans=t}init(){this.eGui=this.cellCtrl.eGui}onKeyDown(e){const t=e.key;switch(t){case K.ENTER:this.onEnterKeyDown(e);break;case K.F2:this.onF2KeyDown(e);break;case K.ESCAPE:this.onEscapeKeyDown(e);break;case K.TAB:this.onTabKeyDown(e);break;case K.BACKSPACE:case K.DELETE:this.onBackspaceOrDeleteKeyDown(t,e);break;case K.DOWN:case K.UP:case K.RIGHT:case K.LEFT:this.onNavigationKeyDown(e,t);break}}onNavigationKeyDown(e,t){if(!this.cellCtrl.editing){if(e.shiftKey&&this.cellCtrl.isRangeSelectionEnabled())this.onShiftRangeSelect(e);else{const n=this.cellCtrl.getFocusedCellPosition();this.beans.navigation?.navigateToNextCell(e,t,n,!0)}e.preventDefault()}}onShiftRangeSelect(e){const{rangeSvc:t,navigation:n}=this.beans;if(!t)return;const i=t.extendLatestRangeInDirection(e);i&&n?.ensureCellVisible(i)}onTabKeyDown(e){this.beans.navigation?.onTabKeyDown(this.cellCtrl,e)}onBackspaceOrDeleteKeyDown(e,t){const{cellCtrl:n,beans:i,rowNode:r}=this,{gos:s,rangeSvc:o,eventSvc:a}=i;if(!n.editing){if(a.dispatchEvent({type:"keyShortcutChangedCellStart"}),Aje(e,s.get("enableCellEditingOnBackspace"))){if(o&&Gl(s))o.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"});else if(n.isCellEditable()){const{column:l}=n,u=this.beans.valueSvc.getDeleteValue(l,r);r.setDataValue(l,u,"cellClear")}}else i.editSvc?.startRowOrCellEdit(n,e,t);a.dispatchEvent({type:"keyShortcutChangedCellEnd"})}}onEnterKeyDown(e){const{cellCtrl:t,beans:n}=this;if(t.editing||this.rowCtrl.editing)this.beans.editSvc?.stopRowOrCellEdit(t,!1,!1,e.shiftKey);else if(n.gos.get("enterNavigatesVertically")){const i=e.shiftKey?K.UP:K.DOWN;n.navigation?.navigateToNextCell(null,i,t.cellPosition,!1)}else n.editSvc?.startRowOrCellEdit(t,K.ENTER,e),t.editing&&e.preventDefault()}onF2KeyDown(e){const{cellCtrl:t,beans:n}=this;t.editing||n.editSvc?.startRowOrCellEdit(t,K.F2,e)}onEscapeKeyDown(e){const{cellCtrl:t,beans:n}=this;t.editing&&n.editSvc?.stopRowOrCellEdit(t,!0)}processCharacter(e){if(e.target!==this.eGui||this.cellCtrl.editing)return;const i=e.key;i===K.SPACE?this.onSpaceKeyDown(e):this.beans.editSvc?.startRowOrCellEdit(this.cellCtrl,i,e)&&e.preventDefault()}onSpaceKeyDown(e){const{gos:t}=this.beans;!this.cellCtrl.editing&&Ed(t)&&this.beans.selectionSvc?.handleSelectionEvent(e,this.rowNode,"spaceKey"),e.preventDefault()}destroy(){super.destroy()}},Pje=class extends X{constructor(e,t,n){super(),this.cellCtrl=e,this.column=n,this.beans=t}onMouseEvent(e,t){if(!El(t))switch(e){case"click":this.onCellClicked(t);break;case"mousedown":case"touchstart":this.onMouseDown(t);break;case"dblclick":this.onCellDoubleClicked(t);break;case"mouseout":this.onMouseOut(t);break;case"mouseover":this.onMouseOver(t);break}}onCellClicked(e){if(this.beans.touchSvc?.handleCellDoubleClick(this,e))return;const{eventSvc:t,rangeSvc:n,gos:i,editSvc:r}=this.beans,s=e.ctrlKey||e.metaKey;n&&s&&n.getCellRangeCount(this.cellCtrl.cellPosition)>1&&n.intersectLastRange(!0);const o=this.cellCtrl.createEvent(e,"cellClicked");t.dispatchEvent(o);const a=this.column.getColDef();a.onCellClicked&&window.setTimeout(()=>{this.beans.frameworkOverrides.wrapOutgoing(()=>{a.onCellClicked(o)})},0),(i.get("singleClickEdit")||a.singleClickEdit)&&!i.get("suppressClickEdit")&&!(e.shiftKey&&n?.getCellRanges().length!=0)&&r?.startRowOrCellEdit(this.cellCtrl,void 0,e)}onCellDoubleClicked(e){const{column:t,beans:n,cellCtrl:i}=this,{eventSvc:r,frameworkOverrides:s,gos:o,editSvc:a}=n,l=t.getColDef(),u=i.createEvent(e,"cellDoubleClicked");r.dispatchEvent(u),typeof l.onCellDoubleClicked=="function"&&window.setTimeout(()=>{s.wrapOutgoing(()=>{l.onCellDoubleClicked(u)})},0),!o.get("singleClickEdit")&&!o.get("suppressClickEdit")&&a?.startRowOrCellEdit(i,null,e)}onMouseDown(e){const{ctrlKey:t,metaKey:n,shiftKey:i}=e,r=e.target,{cellCtrl:s,beans:o}=this,{eventSvc:a,rangeSvc:l,rowNumbersSvc:u,focusSvc:c,gos:d}=o;if(this.isRightClickInExistingRange(e))return;const h=l&&!l.isEmpty(),p=this.containsWidget(r),{cellPosition:g}=s,v=Ep(g.column);if(u&&v&&!u.handleMouseDownOnCell(g,e)){l&&e.preventDefault(),e.stopImmediatePropagation();return}if(!i||!h){const y=d.get("enableCellTextSelection")&&e.defaultPrevented,b=(wh()||y)&&!s.editing&&!lN(r)&&!p;s.focusCell(b)}if(i&&h&&!c.isCellFocused(g)){e.preventDefault();const C=c.getFocusedCell();if(C){const{column:y,rowIndex:b,rowPinned:S}=C,E=o.rowRenderer.getRowByPosition({rowIndex:b,rowPinned:S})?.getCellCtrl(y);E?.editing&&E.stopEditing(),c.setFocusedCell({column:y,rowIndex:b,rowPinned:S,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}}if(!p){if(l)if(v&&e.preventDefault(),i)l.extendLatestRangeToCell(g);else{const C=t||n;l.setRangeToCell(g,C)}a.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseDown"))}}isRightClickInExistingRange(e){const{rangeSvc:t}=this.beans;if(t){const n=t.isCellInAnyRange(this.cellCtrl.cellPosition),i=e.button===2||e.ctrlKey&&this.beans.gos.get("allowContextMenuWithControlKey");if(n&&i)return!0}return!1}containsWidget(e){return xd(e,"ag-selection-checkbox",3)||xd(e,"ag-drag-handle",3)}onMouseOut(e){if(this.mouseStayingInsideCell(e))return;const{eventSvc:t,colHover:n}=this.beans;t.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOut")),n?.clearMouseOver()}onMouseOver(e){if(this.mouseStayingInsideCell(e))return;const{eventSvc:t,colHover:n}=this.beans;t.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOver")),n?.setMouseOver([this.column])}mouseStayingInsideCell(e){if(!e.target||!e.relatedTarget)return!1;const t=this.cellCtrl.eGui,n=t.contains(e.target),i=t.contains(e.relatedTarget);return n&&i}destroy(){super.destroy()}},kje=class extends X{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.column=e.column,this.rowNode=e.rowNode}setupRowSpan(){this.rowSpan=this.column.getRowSpan(this.rowNode),this.addManagedListeners(this.beans.eventSvc,{newColumnsLoaded:()=>this.onNewColumnsLoaded()})}init(){this.eSetLeft=this.cellCtrl.getRootElement(),this.eContent=this.cellCtrl.eGui;const e=this.cellCtrl.getCellSpan();e||(this.setupColSpan(),this.setupRowSpan()),this.onLeftChanged(),this.onWidthChanged(),e||this._legacyApplyRowSpan(),e&&(this.refreshSpanHeight(e),this.addManagedListeners(this.beans.eventSvc,{paginationChanged:this.refreshSpanHeight.bind(this,e),recalculateRowBounds:this.refreshSpanHeight.bind(this,e)}))}refreshSpanHeight(e){const t=e.getCellHeight();t!=null&&(this.eContent.style.height=`${t}px`)}onNewColumnsLoaded(){const e=this.column.getRowSpan(this.rowNode);this.rowSpan!==e&&(this.rowSpan=e,this._legacyApplyRowSpan(!0))}onDisplayColumnsChanged(){const e=this.getColSpanningList();Sh(this.colsSpanning,e)||(this.colsSpanning=e,this.onWidthChanged(),this.onLeftChanged())}setupColSpan(){this.column.getColDef().colSpan!=null&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListeners(this.beans.eventSvc,{displayedColumnsChanged:this.onDisplayColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onWidthChanged.bind(this)}))}onWidthChanged(){if(!this.eContent)return;const e=this.getCellWidth();this.eContent.style.width=`${e}px`}getCellWidth(){return this.colsSpanning?this.colsSpanning.reduce((e,t)=>e+t.getActualWidth(),0):this.column.getActualWidth()}getColSpanningList(){const{column:e,rowNode:t}=this,n=e.getColSpan(t),i=[];if(n===1)i.push(e);else{let r=e;const s=e.getPinned();for(let o=0;r&&o<n&&(i.push(r),r=this.beans.visibleCols.getColAfter(r),!(!r||Wt(r)||s!==r.getPinned()));o++);}return i}onLeftChanged(){if(!this.eSetLeft)return;const e=this.modifyLeftForPrintLayout(this.getCellLeft());this.eSetLeft.style.left=e+"px"}getCellLeft(){let e;return this.beans.gos.get("enableRtl")&&this.colsSpanning?e=Tt(this.colsSpanning):e=this.column,e.getLeft()}modifyLeftForPrintLayout(e){if(!this.cellCtrl.printLayout||this.column.getPinned()==="left")return e;const{visibleCols:t}=this.beans,n=t.getColsLeftWidth();if(this.column.getPinned()==="right"){const i=t.bodyWidth;return n+i+(e||0)}return n+(e||0)}_legacyApplyRowSpan(e){if(this.rowSpan===1&&!e)return;const n=Fd(this.beans)*this.rowSpan;this.eContent.style.height=`${n}px`,this.eContent.style.zIndex="1"}destroy(){super.destroy()}},Tje="ag-cell",Mje="ag-cell-auto-height",Ije="ag-cell-normal-height",_je="ag-cell-focus",Oje="ag-cell-first-right-pinned",Lje="ag-cell-last-left-pinned",Nje="ag-cell-not-inline-editing",$je="ag-cell-wrap-text",ZS="cellCtrl";function xne(e,t){return Jte(e,t,ZS)}var Bje=0,hv=class extends X{constructor(e,t,n,i){super(),this.column=e,this.rowNode=t,this.rowCtrl=i,this.rangeFeature=void 0,this.positionFeature=void 0,this.customStyleFeature=void 0,this.tooltipFeature=void 0,this.mouseListener=void 0,this.keyboardListener=void 0,this.suppressRefreshCell=!1,this.onCompAttachedFuncs=[],this.onEditorAttachedFuncs=[],this.focusEventWhileNotReady=null,this.hasBeenFocused=!1,this.beans=n;const{colId:r,colIdSanitised:s}=e;this.instanceId=r+"-"+Bje++,this.colIdSanitised=s,this.createCellPosition(),this.updateAndFormatValue(!1)}addFeatures(){const{beans:e}=this;this.positionFeature=new kje(this,e),this.customStyleFeature=e.cellStyles?.createCellCustomStyleFeature(this,e),this.mouseListener=new Pje(this,e,this.column),this.keyboardListener=new Dje(this,e,this.rowNode,this.rowCtrl),this.column.isTooltipEnabled()&&this.enableTooltipFeature();const{rangeSvc:t}=e;t&&Gl(e.gos)&&(this.rangeFeature=t.createCellRangeFeature(e,this))}isCellSpanning(){return!1}getCellSpan(){}removeFeatures(){const e=this.beans.context;this.positionFeature=e.destroyBean(this.positionFeature),this.customStyleFeature=e.destroyBean(this.customStyleFeature),this.mouseListener=e.destroyBean(this.mouseListener),this.keyboardListener=e.destroyBean(this.keyboardListener),this.rangeFeature=e.destroyBean(this.rangeFeature),this.disableTooltipFeature()}enableTooltipFeature(e,t){this.tooltipFeature=this.beans.tooltipSvc?.enableCellTooltipFeature(this,e,t)}disableTooltipFeature(){this.tooltipFeature=this.beans.context.destroyBean(this.tooltipFeature)}setComp(e,t,n,i,r,s,o){this.comp=e,this.eGui=t,this.printLayout=r,o??(o=this),this.addDomData(o),this.addFeatures(),o.addDestroyFunc(()=>this.removeFeatures()),this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.setupFocus(),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),this.setupAutoHeight(i,o),this.refreshFirstAndLastStyles(),this.refreshAriaColIndex(),this.positionFeature?.init(),this.customStyleFeature?.setComp(e),this.tooltipFeature?.refreshTooltip(),this.keyboardListener?.init(),this.rangeFeature?.setComp(e),s&&this.isCellEditable()?this.beans.editSvc?.startEditing(this):this.showValue(!1,!0),this.onCompAttachedFuncs.length&&(this.onCompAttachedFuncs.forEach(a=>a()),this.onCompAttachedFuncs=[])}setupAutoHeight(e,t){this.isAutoHeight=this.beans.rowAutoHeight?.setupCellAutoHeight(this,e,t)??!1}getCellAriaRole(){return this.column.getColDef().cellAriaRole??"gridcell"}isCellRenderer(){const e=this.column.getColDef();return e.cellRenderer!=null||e.cellRendererSelector!=null}getValueToDisplay(){return this.valueFormatted??this.value}showValue(e,t){const{beans:n,column:i,rowNode:r,rangeFeature:s}=this,{userCompFactory:o}=n,a=this.getValueToDisplay();let l;const u=r.stub&&r.groupData?.[i.getId()]==null,c=i.getColDef();if(u||this.isCellRenderer()){const d=this.createCellRendererParams();!u||Ep(i)?l=eW(o,c,d):l=Z7e(o,c,d)}if(!l&&!u&&n.findSvc?.isMatch(r,i)){const d=this.createCellRendererParams();l=eW(o,{...i.getColDef(),cellRenderer:"agFindCellRenderer"},d)}this.comp.setRenderDetails(l,a,e),!t&&s&&eu(n,()=>s?.refreshHandle())}setupControlComps(){const e=this.column.getColDef();this.includeSelection=this.isIncludeControl(this.isCheckboxSelection(e)),this.includeRowDrag=this.isIncludeControl(e.rowDrag),this.includeDndSource=this.isIncludeControl(e.dndSource),this.comp.setIncludeSelection(this.includeSelection),this.comp.setIncludeDndSource(this.includeDndSource),this.comp.setIncludeRowDrag(this.includeRowDrag)}isForceWrapper(){return this.beans.gos.get("enableCellTextSelection")||this.column.isAutoHeight()}isIncludeControl(e){return this.rowNode.rowPinned!=null?!1:typeof e=="function"||e===!0}isCheckboxSelection(e){const{rowSelection:t,groupDisplayType:n}=this.beans.gridOptions,i=US(t),r=zl(this.column);return n==="custom"&&i!=="selectionColumn"&&r?!1:e.checkboxSelection||r&&typeof t=="object"&&If(t)}refreshShouldDestroy(){const e=this.column.getColDef(),t=this.includeSelection!=this.isIncludeControl(this.isCheckboxSelection(e)),n=this.includeRowDrag!=this.isIncludeControl(e.rowDrag),i=this.includeDndSource!=this.isIncludeControl(e.dndSource),r=this.isAutoHeight!=this.column.isAutoHeight();return t||n||i||r}onPopupEditorClosed(){this.editing&&this.beans.editSvc?.stopRowOrCellEdit(this)}stopEditing(e=!1){return this.beans.editSvc?.stopEditing(this,e)??!1}createCellRendererParams(){const{value:e,valueFormatted:t,column:n,rowNode:i,comp:r,eGui:s,beans:{valueSvc:o,gos:a}}=this;return Ne(a,{value:e,valueFormatted:t,getValue:()=>o.getValueForDisplay(n,i),setValue:u=>o.setValue(i,n,u),formatValue:this.formatValue.bind(this),data:i.data,node:i,pinned:n.getPinned(),colDef:n.getColDef(),column:n,refreshCell:this.refreshCell.bind(this),eGridCell:s,eParentOfValue:r.getParentOfValue(),registerRowDragger:(u,c,d,h)=>this.registerRowDragger(u,c,h),setTooltip:(u,c)=>{a.assertModuleRegistered("Tooltip",3),this.tooltipFeature&&this.disableTooltipFeature(),this.enableTooltipFeature(u,c),this.tooltipFeature?.refreshTooltip()}})}onCellChanged(e){e.column===this.column&&this.refreshCell({})}refreshOrDestroyCell(e){this.refreshShouldDestroy()?this.rowCtrl?.recreateCell(this):this.refreshCell(e)}refreshCell(e){if(this.suppressRefreshCell||this.editing)return;const t=this.column.getColDef(),n=e!=null&&!!e.newData,i=e!=null&&!!e.suppressFlash,r=t.field==null&&t.valueGetter==null&&t.showRowGroup==null,s=e&&e.forceRefresh||r||n,o=!!this.comp,a=this.updateAndFormatValue(o),l=s||a;if(o){if(l){this.showValue(n,!1);const u=this.beans.filterManager?.isSuppressFlashingCellsBecauseFiltering();!i&&!u&&t.enableCellChangeFlash&&this.beans.cellFlashSvc?.flashCell(this),this.customStyleFeature?.applyUserStyles(),this.customStyleFeature?.applyClassesFromColDef()}this.tooltipFeature?.refreshTooltip(),this.customStyleFeature?.applyCellClassRules()}}isCellEditable(){return this.column.isCellEditable(this.rowNode)}formatValue(e){return this.callValueFormatter(e)??e}callValueFormatter(e){return this.beans.valueSvc.formatValue(this.column,this.rowNode,e)}updateAndFormatValue(e){const t=this.value,n=this.valueFormatted;return this.value=this.beans.valueSvc.getValueForDisplay(this.column,this.rowNode),this.valueFormatted=this.callValueFormatter(this.value),e?!this.valuesAreEqual(t,this.value)||this.valueFormatted!=n:!0}valuesAreEqual(e,t){const n=this.column.getColDef();return n.equals?n.equals(e,t):e===t}addDomData(e){const t=this.eGui;Zd(this.beans.gos,t,ZS,this),e.addDestroyFunc(()=>Zd(this.beans.gos,t,ZS,null))}createEvent(e,t){const{rowNode:n,column:i,value:r,beans:s}=this;return Ne(s.gos,{type:t,node:n,data:n.data,value:r,column:i,colDef:i.getColDef(),rowPinned:n.rowPinned,event:e,rowIndex:n.rowIndex})}processCharacter(e){this.keyboardListener?.processCharacter(e)}onKeyDown(e){this.keyboardListener?.onKeyDown(e)}onMouseEvent(e,t){this.mouseListener?.onMouseEvent(e,t)}getColSpanningList(){return this.positionFeature.getColSpanningList()}onLeftChanged(){this.comp&&this.positionFeature?.onLeftChanged()}onDisplayedColumnsChanged(){this.eGui&&(this.refreshAriaColIndex(),this.refreshFirstAndLastStyles())}refreshFirstAndLastStyles(){const{comp:e,column:t,beans:n}=this;bne(e,t,n.visibleCols)}refreshAriaColIndex(){const e=this.beans.visibleCols.getAriaColIndex(this.column);Rte(this.eGui,e)}onWidthChanged(){return this.positionFeature?.onWidthChanged()}getRowPosition(){const{rowIndex:e,rowPinned:t}=this.cellPosition;return{rowIndex:e,rowPinned:t}}updateRangeBordersIfRangeCount(){this.comp&&this.rangeFeature?.updateRangeBordersIfRangeCount()}onCellSelectionChanged(){this.comp&&this.rangeFeature?.onCellSelectionChanged()}isRangeSelectionEnabled(){return this.rangeFeature!=null}focusCell(e=!1){this.beans.focusSvc.setFocusedCell({...this.getFocusedCellPosition(),forceBrowserFocus:e})}restoreFocus(e=!1){if(!this.comp||this.editing||!this.isCellFocused()||!this.beans.focusSvc.shouldTakeFocus())return;const t=()=>{if(!this.isAlive())return;const n=this.comp.getFocusableElement();this.isCellFocused()&&n.focus({preventScroll:!0})};if(e){setTimeout(t,0);return}t()}onRowIndexChanged(){this.createCellPosition(),this.onCellFocused(),this.restoreFocus(),this.rangeFeature?.onCellSelectionChanged()}onSuppressCellFocusChanged(e){const t=this.eGui;t&&(Ep(this.column)&&(e=!0),ks(t,"tabindex",e?void 0:-1))}onFirstRightPinnedChanged(){if(!this.comp)return;const e=this.column.isFirstRightPinned();this.comp.addOrRemoveCssClass(Oje,e)}onLastLeftPinnedChanged(){if(!this.comp)return;const e=this.column.isLastLeftPinned();this.comp.addOrRemoveCssClass(Lje,e)}checkCellFocused(){return this.beans.focusSvc.isCellFocused(this.cellPosition)}isCellFocused(){const e=this.checkCellFocused();return this.hasBeenFocused||(this.hasBeenFocused=e),e}setupFocus(){this.restoreFocus(!0),this.onCellFocused(this.focusEventWhileNotReady??void 0)}onCellFocused(e){const{beans:t}=this;if(_R(t))return;if(!this.comp){e&&(this.focusEventWhileNotReady=e);return}const n=this.isCellFocused();if(this.comp.addOrRemoveCssClass(_je,n),n&&e&&e.forceBrowserFocus){let r=this.comp.getFocusableElement();if(this.editing){const s=Lf(r,null,!0);s.length&&(r=s[0])}r.focus({preventScroll:!!e.preventScrollOnBrowserFocus})}const i=t.gos.get("editType")==="fullRow";!n&&!i&&this.editing&&t.editSvc?.stopRowOrCellEdit(this),n&&this.rowCtrl.announceDescription()}createCellPosition(){const{rowIndex:e,rowPinned:t}=this.rowNode;this.cellPosition={rowIndex:e,rowPinned:Rl(t),column:this.column}}setInlineEditingCss(){this.beans.editSvc?.setInlineEditingCss(this.rowCtrl)}applyStaticCssClasses(){const{comp:e}=this;e.addOrRemoveCssClass(Tje,!0),e.addOrRemoveCssClass(Nje,!0);const t=this.column.isAutoHeight()==!0;e.addOrRemoveCssClass(Mje,t),e.addOrRemoveCssClass(Ije,!t)}onColumnHover(){this.beans.colHover?.onCellColumnHover(this.column,this.comp)}onColDefChanged(){this.comp&&(this.column.isTooltipEnabled()?(this.disableTooltipFeature(),this.enableTooltipFeature()):this.disableTooltipFeature(),this.setWrapText(),this.editing?this.beans.editSvc?.handleColDefChanged(this):this.refreshOrDestroyCell({forceRefresh:!0,suppressFlash:!0}))}setWrapText(){const e=this.column.getColDef().wrapText==!0;this.comp.addOrRemoveCssClass($je,e)}dispatchCellContextMenuEvent(e){const t=this.column.getColDef(),n=this.createEvent(e,"cellContextMenu"),{beans:i}=this;i.eventSvc.dispatchEvent(n),t.onCellContextMenu&&window.setTimeout(()=>{i.frameworkOverrides.wrapOutgoing(()=>{t.onCellContextMenu(n)})},0)}getCellRenderer(){return this.comp?.getCellRenderer()??null}destroy(){this.onCompAttachedFuncs=[],this.onEditorAttachedFuncs=[],this.isCellFocused()&&this.hasBrowserFocus()&&this.beans.focusSvc.attemptToRecoverFocus(),super.destroy()}hasBrowserFocus(){return this.eGui?.contains(Xt(this.beans))??!1}createSelectionCheckbox(){const e=this.beans.selectionSvc?.createCheckboxSelectionComponent();if(e)return this.beans.context.createBean(e),e.init({rowNode:this.rowNode,column:this.column}),e}createDndSource(){const e=this.beans.registry.createDynamicBean("dndSourceComp",!1,this.rowNode,this.column,this.eGui);return e&&this.beans.context.createBean(e),e}registerRowDragger(e,t,n){if(this.customRowDragComp){this.customRowDragComp.setDragElement(e,t);return}const i=this.createRowDragComp(e,t,n);i&&(this.customRowDragComp=i,this.addDestroyFunc(()=>{this.beans.context.destroyBean(i),this.customRowDragComp=null}))}createRowDragComp(e,t,n){const i=this.beans.rowDragSvc?.createRowDragCompForCell(this.rowNode,this.column,()=>this.value,e,t,n);if(i)return this.beans.context.createBean(i),i}cellEditorAttached(){this.onEditorAttachedFuncs.forEach(e=>e()),this.onEditorAttachedFuncs=[]}setFocusedCellPosition(e){}getFocusedCellPosition(){return this.cellPosition}refreshAriaRowIndex(){}getRootElement(){return this.eGui}},Rne="__ag_grid_instance";function Ene(e,t){t[Rne]=e.gridInstanceId}function g0(e,t){return Fne(e,t.target)}function Fne(e,t){let n=t;for(;n;){const i=n[Rne];if(me(i))return i===e.gridInstanceId;n=n.parentElement}return!1}function Gje(e,t){return xne(e,t.target)?.getFocusedCellPosition()??null}function bD(e,t){const n=gi(e.gos,"normal"),i=t;let r,s;if(i.clientX!=null||i.clientY!=null?(r=i.clientX,s=i.clientY):(r=i.x,s=i.y),n){const o=e.ctrlsSvc.getScrollFeature(),a=o.getVScrollPosition(),l=o.getHScrollPosition();r+=l.left,s+=a.top}return{x:r,y:s}}var zje=class extends X{constructor(){super(...arguments),this.beanName="dragAndDrop",this.dragSourceAndParamsList=[],this.dropTargets=[]}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.dragSvc=e.dragSvc,this.environment=e.environment,this.userCompFactory=e.userCompFactory}addDragSource(e,t=!1){const n={eElement:e.eElement,dragStartPixels:e.dragStartPixels,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),onDragCancel:this.onDragCancel.bind(this),includeTouch:t};this.dragSourceAndParamsList.push({params:n,dragSource:e}),this.dragSvc.addDragSource(n)}getDragAndDropImageComponent(){const{dragAndDropImageComp:e}=this;return!e||!e.comp?null:e.comp}removeDragSource(e){const{dragSourceAndParamsList:t,dragSvc:n}=this,i=t.find(r=>r.dragSource===e);i&&(n.removeDragSource(i.params),Ao(t,i))}destroy(){const{dragSourceAndParamsList:e,dragSvc:t,dropTargets:n}=this;e.forEach(i=>t.removeDragSource(i.params)),e.length=0,n.length=0,this.clearDragAndDropProperties(),super.destroy()}nudge(){this.dragging&&this.onDragging(this.eventLastTime,!0)}onDragStart(e,t){this.dragging=!0,this.dragSource=e,this.eventLastTime=t,this.dragItem=e.getDragItem(),e.onDragStarted?.(),this.createDragAndDropImageComponent()}onDragStop(e){this.dragSource?.onDragStopped?.();const{lastDropTarget:t}=this;if(t?.onDragStop){const n=this.createDropTargetEvent(t,e,null,null,!1);t.onDragStop(n)}this.clearDragAndDropProperties()}onDragCancel(){const{dragSource:e,lastDropTarget:t}=this;e?.onDragCancelled?.(),t?.onDragCancel&&t.onDragCancel(this.createDropTargetEvent(t,this.eventLastTime,null,null,!1)),this.clearDragAndDropProperties()}clearDragAndDropProperties(){this.eventLastTime=null,this.dragging=!1,this.lastDropTarget=void 0,this.dragItem=null,this.dragSource=null,this.removeDragAndDropImageComponent()}onDragging(e,t=!1){const n=this.getHorizontalDirection(e),i=this.getVerticalDirection(e);this.eventLastTime=e,this.positionDragAndDropImageComp(e);const r=this.dropTargets.filter(c=>this.isMouseOnDropTarget(e,c)),s=this.findCurrentDropTarget(e,r),{lastDropTarget:o,dragSource:a,dragAndDropImageComp:l,dragItem:u}=this;if(s!==o){if(this.leaveLastTargetIfExists(e,n,i,t),o!==null&&s===null&&a?.onGridExit?.(u),o===null&&s!==null&&a?.onGridEnter?.(u),this.enterDragTargetIfExists(s,e,n,i,t),s&&l){const{comp:c,promise:d}=l;c?c.setIcon(s.getIconName?s.getIconName():null,!1):d.then(h=>{h&&h.setIcon(s.getIconName?s.getIconName():null,!1)})}this.lastDropTarget=s}else if(s&&s.onDragging){const c=this.createDropTargetEvent(s,e,n,i,t);s.onDragging(c)}}getAllContainersFromDropTarget(e){const t=e.getSecondaryContainers?e.getSecondaryContainers():null,n=[[e.getContainer()]];return t?n.concat(t):n}isMouseOnDropTarget(e,t){const n=this.getAllContainersFromDropTarget(t);let i=!1;const r=(a,l)=>{for(const u of l){const{width:c,height:d,left:h,right:p,top:g,bottom:v}=u.getBoundingClientRect();if(c===0||d===0)return!1;const C=a.clientX>=h&&a.clientX<p,y=a.clientY>=g&&a.clientY<v;if(!C||!y)return!1}return!0};for(const a of n)if(r(e,a)){i=!0;break}const{eElement:s,type:o}=this.dragSource;return t.targetContainsSource&&!t.getContainer().contains(s)?!1:i&&t.isInterestedIn(o,s)}findCurrentDropTarget(e,t){const n=t.length;if(n===0)return null;if(n===1)return t[0];const r=u0(this.beans).elementsFromPoint(e.clientX,e.clientY);for(const s of r)for(const o of t)if(this.getAllContainersFromDropTarget(o).flatMap(l=>l).indexOf(s)!==-1)return o;return null}enterDragTargetIfExists(e,t,n,i,r){if(e&&e.onDragEnter){const s=this.createDropTargetEvent(e,t,n,i,r);e.onDragEnter(s)}}leaveLastTargetIfExists(e,t,n,i){const{lastDropTarget:r}=this;if(!r)return;if(r.onDragLeave){const o=this.createDropTargetEvent(r,e,t,n,i);r.onDragLeave(o)}const s=this.getDragAndDropImageComponent();s&&s.setIcon(null,!1)}addDropTarget(e){this.dropTargets.push(e)}removeDropTarget(e){this.dropTargets=this.dropTargets.filter(t=>t.getContainer()!==e.getContainer())}hasExternalDropZones(){return this.dropTargets.some(e=>e.external)}findExternalZone(e){return this.dropTargets.filter(n=>n.external).find(n=>n.getContainer()===e.getContainer())||null}isDropZoneWithinThisGrid(e){const n=this.ctrlsSvc.getGridBodyCtrl().eGridBody,{dropZoneTarget:i}=e;return n.contains(i)}getHorizontalDirection(e){const t=this.eventLastTime?.clientX,n=e.clientX;return t===n?null:t>n?"left":"right"}getVerticalDirection(e){const t=this.eventLastTime?.clientY,n=e.clientY;return t===n?null:t>n?"up":"down"}createDropTargetEvent(e,t,n,i,r){const s=e.getContainer(),o=s.getBoundingClientRect(),{dragItem:a,dragSource:l,gos:u}=this,c=t.clientX-o.left,d=t.clientY-o.top;return Ne(u,{event:t,x:c,y:d,vDirection:i,hDirection:n,dragSource:l,fromNudge:r,dragItem:a,dropZoneTarget:s})}positionDragAndDropImageComp(e){const t=this.getDragAndDropImageComponent();t&&I9e(t.getGui(),e,this.beans)}removeDragAndDropImageComponent(){const{dragAndDropImageComp:e}=this;if(e){const{comp:t}=e;if(t){const n=t.getGui();this.dragAndDropImageParent?.removeChild(n),this.destroyBean(t)}}this.dragAndDropImageComp=null}createDragAndDropImageComponent(){const{dragSource:e,gos:t,userCompFactory:n}=this;if(!e)return;const i=W7e(n,Ne(t,{dragSource:e}));if(!i)return;const r=i.newAgStackInstance();this.dragAndDropImageComp={promise:r},r.then(s=>{!s||!this.isAlive()||(this.processDragAndDropImageComponent(s),this.dragAndDropImageComp.comp=s)})}processDragAndDropImageComponent(e){const{dragSource:t,environment:n}=this;if(!t)return;const i=e.getGui();i.style.setProperty("position","absolute"),i.style.setProperty("z-index","9999"),Ene(this.gos,i),n.applyThemeClasses(i),e.setIcon(null,!1);let{dragItemName:r}=t;typeof r=="function"&&(r=r()),e.setLabel(r||""),i.style.top="20px",i.style.left="20px";const s=fN(this.beans);this.dragAndDropImageParent=s,s?s.appendChild(i):ue(54)}registerGridDropTarget(e,t){const n={getContainer:e,isInterestedIn:i=>i===1||i===0,getIconName:()=>"notAllowed"};this.addDropTarget(n),t.addDestroyFunc(()=>this.removeDropTarget(n))}},Hje=class{constructor(e){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=e.scrollContainer,this.scrollHorizontally=e.scrollAxis.indexOf("x")!==-1,this.scrollVertically=e.scrollAxis.indexOf("y")!==-1,this.scrollByTick=e.scrollByTick!=null?e.scrollByTick:20,e.onScrollCallback&&(this.onScrollCallback=e.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=e.getVerticalPosition,this.setVerticalPosition=e.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=e.getHorizontalPosition,this.setHorizontalPosition=e.setHorizontalPosition),this.shouldSkipVerticalScroll=e.shouldSkipVerticalScroll||(()=>!1),this.shouldSkipHorizontalScroll=e.shouldSkipHorizontalScroll||(()=>!1)}check(e,t=!1){const n=t||this.shouldSkipVerticalScroll();if(n&&this.shouldSkipHorizontalScroll())return;const i=this.scrollContainer.getBoundingClientRect(),r=this.scrollByTick;this.tickLeft=e.clientX<i.left+r,this.tickRight=e.clientX>i.right-r,this.tickUp=e.clientY<i.top+r&&!n,this.tickDown=e.clientY>i.bottom-r&&!n,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}ensureTickingStarted(){this.tickingInterval===null&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)}doTick(){this.tickCount++;const e=this.tickCount>20?200:this.tickCount>10?80:40;if(this.scrollVertically){const t=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(t-e),this.tickDown&&this.setVerticalPosition(t+e)}if(this.scrollHorizontally){const t=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(t-e),this.tickRight&&this.setHorizontalPosition(t+e)}this.onScrollCallback&&this.onScrollCallback()}ensureCleared(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)}};function Vje(e){const{rowIndex:t,rowPinned:n,column:i}=e;return`${t}.${n??"null"}.${i.getId()}`}function Ane(e,t){const n=e.column===t.column,i=e.rowPinned===t.rowPinned,r=e.rowIndex===t.rowIndex;return n&&i&&r}function Wje(e,t){switch(e.rowPinned){case"top":if(t.rowPinned!=="top")return!0;break;case"bottom":if(t.rowPinned!=="bottom")return!1;break;default:if(me(t.rowPinned))return t.rowPinned!=="top";break}return e.rowIndex<t.rowIndex}function Uje(e,t){return!e&&!t?!0:e&&!t||!e&&t?!1:e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned}function jje(e){let t=0,n;const{pinnedRowModel:i,rowModel:r,pageBounds:s}=e;return i?.getPinnedTopRowCount()?n="top":r.getRowCount()?(n=null,t=s.getFirstRow()):i?.getPinnedBottomRowCount()&&(n="bottom"),n===void 0?null:{rowIndex:t,rowPinned:n}}function qje(e){let t,n=null;const{pinnedRowModel:i,pageBounds:r}=e,s=i?.getPinnedBottomRowCount(),o=i?.getPinnedTopRowCount();return s?(n="bottom",t=s-1):e.rowModel.getRowCount()?(n=null,t=r.getLastRow()):o&&(n="top",t=o-1),t===void 0?null:{rowIndex:t,rowPinned:n}}function e1(e,t){switch(t.rowPinned){case"top":return e.pinnedRowModel?.getPinnedTopRow(t.rowIndex);case"bottom":return e.pinnedRowModel?.getPinnedBottomRow(t.rowIndex);default:return e.rowModel.getRow(t.rowIndex)}}function Cf(e,t){const n=e.spannedRowRenderer?.getCellByPosition(t);if(n)return n;const i=e.rowRenderer.getRowByPosition(t);return i?i.getCellCtrl(t.column):null}function t1(e,t){const{rowIndex:n,rowPinned:i}=t,{pageBounds:r,pinnedRowModel:s,rowModel:o}=e;if(n===0)return i==="top"?null:i==="bottom"&&o.isRowsToRender()?{rowIndex:r.getLastRow(),rowPinned:null}:s?.isRowsToRender("top")?{rowIndex:s.getPinnedTopRowCount()-1,rowPinned:"top"}:null;const a=i?void 0:o.getRow(n);return Dne(e,a,!0)??{rowIndex:n-1,rowPinned:i}}function nW(e,t){const{rowIndex:n,rowPinned:i}=t,{pageBounds:r,pinnedRowModel:s,rowModel:o}=e;if(Kje(e,t))return i==="bottom"?null:i==="top"&&o.isRowsToRender()?{rowIndex:r.getFirstRow(),rowPinned:null}:s?.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;const a=i?void 0:o.getRow(n);return Dne(e,a)??{rowIndex:n+1,rowPinned:i}}function Dne(e,t,n){const{gos:i,rowRenderer:r}=e;if(!t?.sticky||!qte(i))return;const s=n?r.getStickyTopRowCtrls():r.getStickyBottomRowCtrls();let o;for(let a=0;a<s.length;a++)if(s[a].rowNode.rowIndex===t.rowIndex){o=s[a+(n?-1:1)];break}return o?{rowIndex:o.rowNode.rowIndex,rowPinned:null}:void 0}function Kje(e,t){const{rowPinned:n,rowIndex:i}=t,{pinnedRowModel:r,pageBounds:s}=e;return n==="top"?(r?.getPinnedTopRowCount()??0)-1<=i:n==="bottom"?(r?.getPinnedBottomRowCount()??0)-1<=i:s.getLastRow()<=i}var Yje=class extends X{constructor(e){super(),this.eContainer=e}postConstruct(){const{rowModel:e,gos:t,ctrlsSvc:n}=this.beans;Xi(t)&&(this.clientSideRowModel=e),n.whenReady(this,i=>{const r=i.gridBodyCtrl;this.autoScrollService=new Hje({scrollContainer:r.eBodyViewport,scrollAxis:"y",getVerticalPosition:()=>r.scrollFeature.getVScrollPosition().top,setVerticalPosition:s=>r.scrollFeature.setVerticalScrollPosition(s),onScrollCallback:()=>{this.onDragging(this.lastDraggingEvent)}})})}getContainer(){return this.eContainer}isInterestedIn(e){return e===2}getIconName(){return this.gos.get("rowDragManaged")&&this.shouldPreventRowMove()?"notAllowed":"move"}shouldPreventRowMove(){const{rowGroupColsSvc:e,filterManager:t,sortSvc:n}=this.beans;return!!((e?.columns??[]).length||t?.isAnyFilterPresent()||n?.isSortActive())}getRowNodes(e){if(!this.isFromThisGrid(e))return e.dragItem.rowNodes||[];const t=e.dragItem.rowNode;if(this.gos.get("rowDragMultiRow")){const i=[...this.beans.selectionSvc?.getSelectedNodes()??[]].sort((r,s)=>r.rowIndex==null||s.rowIndex==null?0:this.getRowIndexNumber(r)-this.getRowIndexNumber(s));if(i.indexOf(t)!==-1)return i}return[t]}onDragEnter(e){e.dragItem.rowNodes=this.getRowNodes(e),this.dispatchGridEvent("rowDragEnter",e),this.getRowNodes(e).forEach(t=>{this.setRowNodeDragging(t,!0)}),this.onEnterOrDragging(e)}onDragging(e){this.onEnterOrDragging(e)}isFromThisGrid(e){const{dragSourceDomDataKey:t}=e.dragSource;return t===this.gos.getDomDataKey()}onEnterOrDragging(e){this.dispatchGridEvent("rowDragMove",e),this.lastDraggingEvent=e;const t=bD(this.beans,e).y;this.gos.get("rowDragManaged")&&this.doManagedDrag(e,t),this.autoScrollService.check(e.event)}doManagedDrag(e,t){const{dragAndDrop:n,gos:i}=this.beans,r=this.isFromThisGrid(e),s=i.get("rowDragManaged"),o=e.dragItem.rowNodes;s&&this.shouldPreventRowMove()||(i.get("suppressMoveWhenRowDragging")||!r?n.isDropZoneWithinThisGrid(e)&&this.clientSideRowModel.highlightRowAtPixel(o[0],t):this.moveRows(o,t))}getRowIndexNumber(e){const t=e.getRowIndexString();return parseInt(Tt(t.split("-")),10)}moveRowAndClearHighlight(e){const t=this.clientSideRowModel,n=t.getLastHighlightedRowNode(),i=n&&n.highlighted==="Below",r=bD(this.beans,e).y,s=e.dragItem.rowNodes;let o=i?1:0;if(this.isFromThisGrid(e))s.forEach(a=>{a.rowTop<r&&(o-=1)}),this.moveRows(s,r,o);else{const a=xp(this.gos);let l=t.getRowIndexAtPixel(r)+1;t.getHighlightPosition(r)==="Above"&&l--,t.updateRowData({add:s.filter(u=>!t.getRowNode(a?.({data:u.data,level:0,rowPinned:u.rowPinned})??u.data.id)).map(u=>u.data),addIndex:l})}this.clearRowHighlight()}clearRowHighlight(){this.clientSideRowModel.highlightRowAtPixel(null)}moveRows(e,t,n=0){const i=this.beans.focusSvc,r=i.getFocusedCell(),s=r&&Cf(this.beans,r);this.clientSideRowModel.ensureRowsAtPixel(e,t,n)&&(s?s.focusCell():i.clearFocusedCell())}addRowDropZone(e){if(!e.getContainer()){ue(55);return}const t=this.beans.dragAndDrop;if(t.findExternalZone(e)){ue(56);return}let n={getContainer:e.getContainer};e.fromGrid?n=e:(e.onDragEnter&&(n.onDragEnter=r=>{e.onDragEnter(this.draggingToRowDragEvent("rowDragEnter",r))}),e.onDragLeave&&(n.onDragLeave=r=>{e.onDragLeave(this.draggingToRowDragEvent("rowDragLeave",r))}),e.onDragging&&(n.onDragging=r=>{e.onDragging(this.draggingToRowDragEvent("rowDragMove",r))}),e.onDragStop&&(n.onDragStop=r=>{e.onDragStop(this.draggingToRowDragEvent("rowDragEnd",r))}),e.onDragCancel&&(n.onDragCancel=r=>{e.onDragCancel(this.draggingToRowDragEvent("rowDragCancel",r))}));const i={isInterestedIn:r=>r===2,getIconName:()=>"move",external:!0,...n};t.addDropTarget(i),this.addDestroyFunc(()=>t.removeDropTarget(i))}getRowDropZone(e){const t=this.getContainer.bind(this),n=this.onDragEnter.bind(this),i=this.onDragLeave.bind(this),r=this.onDragging.bind(this),s=this.onDragStop.bind(this),o=this.onDragCancel.bind(this);let a;return e?a={getContainer:t,onDragEnter:e.onDragEnter?l=>{n(l),e.onDragEnter(this.draggingToRowDragEvent("rowDragEnter",l))}:n,onDragLeave:e.onDragLeave?l=>{i(l),e.onDragLeave(this.draggingToRowDragEvent("rowDragLeave",l))}:i,onDragging:e.onDragging?l=>{r(l),e.onDragging(this.draggingToRowDragEvent("rowDragMove",l))}:r,onDragStop:e.onDragStop?l=>{s(l),e.onDragStop(this.draggingToRowDragEvent("rowDragEnd",l))}:s,onDragCancel:e.onDragCancel?l=>{o(l),e.onDragCancel(this.draggingToRowDragEvent("rowDragCancel",l))}:o,fromGrid:!0}:a={getContainer:t,onDragEnter:n,onDragLeave:i,onDragging:r,onDragStop:s,onDragCancel:o,fromGrid:!0},a}draggingToRowDragEvent(e,t){const n=this.beans,{pageBounds:i,rowModel:r,gos:s}=n,o=bD(n,t).y,a=o>i.getCurrentPageHeight();let l=-1,u;return a||(l=r.getRowIndexAtPixel(o),u=r.getRow(l)),Ne(s,{type:e,event:t.event,node:t.dragItem.rowNode,nodes:t.dragItem.rowNodes,overIndex:l,overNode:u,y:o,vDirection:t.vDirection})}dispatchGridEvent(e,t){const n=this.draggingToRowDragEvent(e,t);this.eventSvc.dispatchEvent(n)}onDragLeave(e){this.dispatchGridEvent("rowDragLeave",e),this.stopDragging(e),this.gos.get("rowDragManaged")&&this.clearRowHighlight()}onDragStop(e){this.dispatchGridEvent("rowDragEnd",e),this.stopDragging(e);const{dragAndDrop:t,gos:n}=this.beans;n.get("rowDragManaged")&&(n.get("suppressMoveWhenRowDragging")||!this.isFromThisGrid(e))&&t.isDropZoneWithinThisGrid(e)&&this.moveRowAndClearHighlight(e)}onDragCancel(e){this.dispatchGridEvent("rowDragCancel",e),this.stopDragging(e);const{dragAndDrop:t,gos:n}=this.beans;n.get("rowDragManaged")&&(n.get("suppressMoveWhenRowDragging")||!this.isFromThisGrid(e))&&t.isDropZoneWithinThisGrid(e)&&this.clearRowHighlight()}stopDragging(e){this.autoScrollService.ensureCleared(),this.getRowNodes(e).forEach(t=>{this.setRowNodeDragging(t,!1)})}setRowNodeDragging(e,t){e.dragging!==t&&(e.dragging=t,e.dispatchRowEvent("draggingChanged"))}};function Pne(e,t,n){if(n===0)return!1;const i=Math.abs(e.clientX-t.clientX),r=Math.abs(e.clientY-t.clientY);return Math.max(i,r)<=n}var Xje=class extends X{constructor(){super(...arguments),this.beanName="dragSvc",this.dragEndFunctions=[],this.dragSources=[]}destroy(){const{dragSources:e}=this;e.forEach(this.removeListener.bind(this)),e.length=0,super.destroy()}removeListener(e){const t=e.dragSource.eElement,n=e.mouseDownListener;if(t.removeEventListener("mousedown",n),e.touchEnabled){const i=e.touchStartListener;t.removeEventListener("touchstart",i,{passive:!0})}}removeDragSource(e){const{dragSources:t}=this,n=t.find(i=>i.dragSource===e);n&&(this.removeListener(n),Ao(t,n))}addDragSource(e){const t=this.onMouseDown.bind(this,e),{eElement:n,includeTouch:i,stopPropagationForTouch:r}=e;n.addEventListener("mousedown",t);let s=null;const o=this.gos.get("suppressTouch");i&&!o&&(s=a=>{lN(a.target)||(r&&a.stopPropagation(),this.onTouchStart(e,a))},n.addEventListener("touchstart",s,{passive:!1})),this.dragSources.push({dragSource:e,mouseDownListener:t,touchStartListener:s,touchEnabled:!!i})}onTouchStart(e,t){this.currentDragParams=e,this.dragging=!1;const n=t.touches[0];this.touchLastTime=n,this.touchStart=n;const i=l=>this.onTouchMove(l,e.eElement),r=l=>this.onTouchUp(l,e.eElement),s=l=>{l.cancelable&&l.preventDefault()},o=t.target,a=[{target:u0(this.beans),type:"touchmove",listener:s,options:{passive:!1}},{target:o,type:"touchmove",listener:i,options:{passive:!0}},{target:o,type:"touchend",listener:r,options:{passive:!0}},{target:o,type:"touchcancel",listener:r,options:{passive:!0}}];this.addTemporaryEvents(a),e.dragStartPixels===0&&this.onCommonMove(n,this.touchStart,e.eElement)}onMouseDown(e,t){const n=t;if(e.skipMouseEvent&&e.skipMouseEvent(t)||n._alreadyProcessedByDragService||(n._alreadyProcessedByDragService=!0,t.button!==0))return;this.shouldPreventMouseEvent(t)&&t.preventDefault(),this.currentDragParams=e,this.dragging=!1,this.mouseStartEvent=t,this.startTarget=t.target;const i=u=>this.onMouseMove(u,e.eElement),r=u=>this.onMouseUp(u,e.eElement),s=u=>u.preventDefault(),o=u=>{u.key===K.ESCAPE&&this.cancelDrag(e.eElement)},a=u0(this.beans),l=[{target:a,type:"mousemove",listener:i},{target:a,type:"mouseup",listener:r},{target:a,type:"contextmenu",listener:s},{target:a,type:"keydown",listener:o}];this.addTemporaryEvents(l),e.dragStartPixels===0&&this.onMouseMove(t,e.eElement)}addTemporaryEvents(e){e.forEach(t=>{const{target:n,type:i,listener:r,options:s}=t;n.addEventListener(i,r,s)}),this.dragEndFunctions.push(()=>{e.forEach(t=>{const{target:n,type:i,listener:r,options:s}=t;n.removeEventListener(i,r,s)})})}isEventNearStartEvent(e,t){const{dragStartPixels:n}=this.currentDragParams,i=me(n)?n:4;return Pne(e,t,i)}getFirstActiveTouch(e){for(let t=0;t<e.length;t++)if(e[t].identifier===this.touchStart.identifier)return e[t];return null}onCommonMove(e,t,n){if(!this.dragging){if(this.isEventNearStartEvent(e,t))return;if(this.dragging=!0,this.eventSvc.dispatchEvent({type:"dragStarted",target:n}),this.currentDragParams.onDragStart(t),!this.currentDragParams){this.dragging=!1;return}this.currentDragParams.onDragging(t)}this.currentDragParams?.onDragging(e)}onTouchMove(e,t){const n=this.getFirstActiveTouch(e.touches);n&&this.onCommonMove(n,this.touchStart,t)}onMouseMove(e,t){wh()&&Rn(this.beans).getSelection()?.removeAllRanges(),this.shouldPreventMouseEvent(e)&&e.preventDefault(),this.onCommonMove(e,this.mouseStartEvent,t)}shouldPreventMouseEvent(e){const{gos:t}=this,n=t.get("enableCellTextSelection"),i=e.type==="mousemove",r=s=>!!s.target?.tagName.toLocaleLowerCase()?.match("^a$|textarea|input|select|button");return n&&i&&e.cancelable&&g0(t,e)&&!r(e)}onTouchUp(e,t){let n=this.getFirstActiveTouch(e.changedTouches);n||(n=this.touchLastTime),this.onUpCommon(n,t)}onMouseUp(e,t){this.onUpCommon(e,t)}onUpCommon(e,t){this.dragging&&(this.dragging=!1,this.currentDragParams.onDragStop(e),this.eventSvc.dispatchEvent({type:"dragStopped",target:t})),this.resetDragProperties()}cancelDrag(e){this.eventSvc.dispatchEvent({type:"dragCancelled",target:e}),this.currentDragParams?.onDragCancel?.(),this.resetDragProperties()}resetDragProperties(){this.mouseStartEvent=null,this.startTarget=null,this.touchStart=null,this.touchLastTime=null,this.currentDragParams=null;const{dragEndFunctions:e}=this;e.forEach(t=>t()),e.length=0}};function kne(e,t){return e+"_"+t}function on(e){return e instanceof Tne}var Tne=class extends X{constructor(e,t,n,i){super(),this.providedColumnGroup=e,this.groupId=t,this.partId=n,this.pinned=i,this.isColumn=!1,this.displayedChildren=[],this.autoHeaderHeight=null,this.parent=null}reset(){this.parent=null,this.children=null,this.displayedChildren=null}getParent(){return this.parent}getUniqueId(){return kne(this.groupId,this.partId)}isEmptyGroup(){return this.displayedChildren.length===0}isMoving(){const e=this.getProvidedColumnGroup().getLeafColumns();return!e||e.length===0?!1:e.every(t=>t.isMoving())}checkLeft(){if(this.displayedChildren.forEach(e=>{on(e)&&e.checkLeft()}),this.displayedChildren.length>0)if(this.gos.get("enableRtl")){const t=Tt(this.displayedChildren).getLeft();this.setLeft(t)}else{const e=this.displayedChildren[0].getLeft();this.setLeft(e)}else this.setLeft(null)}getLeft(){return this.left}getOldLeft(){return this.oldLeft}setLeft(e){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchLocalEvent({type:"leftChanged"}))}getPinned(){return this.pinned}getGroupId(){return this.groupId}getPartId(){return this.partId}getActualWidth(){let e=0;return this.displayedChildren?.forEach(t=>{e+=t.getActualWidth()}),e}isResizable(){if(!this.displayedChildren)return!1;let e=!1;return this.displayedChildren.forEach(t=>{t.isResizable()&&(e=!0)}),e}getMinWidth(){let e=0;return this.displayedChildren.forEach(t=>{e+=t.getMinWidth()}),e}addChild(e){this.children||(this.children=[]),this.children.push(e)}getDisplayedChildren(){return this.displayedChildren}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}getDisplayedLeafColumns(){const e=[];return this.addDisplayedLeafColumns(e),e}getDefinition(){return this.providedColumnGroup.getColGroupDef()}getColGroupDef(){return this.providedColumnGroup.getColGroupDef()}isPadding(){return this.providedColumnGroup.isPadding()}isExpandable(){return this.providedColumnGroup.isExpandable()}isExpanded(){return this.providedColumnGroup.isExpanded()}setExpanded(e){this.providedColumnGroup.setExpanded(e)}isAutoHeaderHeight(){return!!this.getColGroupDef()?.autoHeaderHeight}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){const t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}addDisplayedLeafColumns(e){this.displayedChildren.forEach(t=>{lc(t)?e.push(t):on(t)&&t.addDisplayedLeafColumns(e)})}addLeafColumns(e){this.children.forEach(t=>{lc(t)?e.push(t):on(t)&&t.addLeafColumns(e)})}getChildren(){return this.children}getColumnGroupShow(){return this.providedColumnGroup.getColumnGroupShow()}getProvidedColumnGroup(){return this.providedColumnGroup}getPaddingLevel(){const e=this.getParent();return!this.isPadding()||!e||!e.isPadding()?0:1+e.getPaddingLevel()}calculateDisplayedColumns(){this.displayedChildren=[];let e=this;for(;e!=null&&e.isPadding();)e=e.getParent();if(!(e?e.getProvidedColumnGroup().isExpandable():!1)){this.displayedChildren=this.children,this.dispatchLocalEvent({type:"displayedChildrenChanged"});return}this.children.forEach(n=>{if(on(n)&&(!n.displayedChildren||!n.displayedChildren.length))return;switch(n.getColumnGroupShow()){case"open":e.getProvidedColumnGroup().isExpanded()&&this.displayedChildren.push(n);break;case"closed":e.getProvidedColumnGroup().isExpanded()||this.displayedChildren.push(n);break;default:this.displayedChildren.push(n);break}}),this.dispatchLocalEvent({type:"displayedChildrenChanged"})}},_T="row-group-",Mne="t-",Ine="b-",Qje=0,Dp=class{constructor(e){this.master=!1,this.detail=void 0,this.rowIndex=null,this.key=null,this.sourceRowIndex=-1,this.childrenMapped={},this.treeNode=null,this.treeNodeFlags=0,this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=Qje++,this.alreadyRendered=!1,this.highlighted=null,this.hovered=!1,this.__selected=!1,this.beans=e}setData(e){this.setDataCommon(e,!1)}updateData(e){this.setDataCommon(e,!0)}setDataCommon(e,t){const{valueCache:n,selectionSvc:i,eventSvc:r}=this.beans,s=this.data;this.data=e,n?.onDataChanged(),this.updateDataOnDetailNode(),i?.updateRowSelectable(this),this.resetQuickFilterAggregateText();const o=this.createDataChangedEvent(e,s,t);this.__localEventService?.dispatchEvent(o),r.dispatchEvent({type:"rowNodeDataChanged",node:this})}updateDataOnDetailNode(){this.detailNode&&(this.detailNode.data=this.data)}createDataChangedEvent(e,t,n){return{type:"dataChanged",node:this,oldData:t,newData:e,update:n}}getRowIndexString(){return this.rowIndex==null?(wt(13),null):this.rowPinned==="top"?Mne+this.rowIndex:this.rowPinned==="bottom"?Ine+this.rowIndex:this.rowIndex.toString()}setDataAndId(e,t){const{selectionSvc:n}=this.beans,i=n?.createDaemonNode?.(this),r=this.data;this.data=e,this.updateDataOnDetailNode(),this.setId(t),n&&(n.updateRowSelectable(this),n.syncInRowNode(this,i));const s=this.createDataChangedEvent(e,r,!1);this.__localEventService?.dispatchEvent(s)}setId(e){const t=xp(this.beans.gos);if(t)if(this.data){const n=this.parent?.getRoute()??[];this.id=t({data:this.data,parentKeys:n.length>0?n:void 0,level:this.level,rowPinned:this.rowPinned}),this.id.startsWith(_T)&&wt(14,{groupPrefix:_T})}else this.id=void 0;else this.id=e}setRowTop(e){this.oldRowTop=this.rowTop,this.rowTop!==e&&(this.rowTop=e,this.dispatchRowEvent("topChanged"),this.setDisplayed(e!==null))}clearRowTopAndRowIndex(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)}setHovered(e){this.hovered=e}isHovered(){return this.hovered}setRowHeight(e,t=!1){this.rowHeight=e,this.rowHeightEstimated=t,this.dispatchRowEvent("heightChanged")}setExpanded(e,t,n){this.beans.expansionSvc?.setExpanded(this,e,t,n)}setDataValue(e,t,n){const{colModel:i,valueSvc:r,gos:s,selectionSvc:o}=this.beans,a=typeof e!="string"?e:i.getCol(e)??i.getColDefCol(e);if(!a)return!1;const l=r.getValueForDisplay(a,this);if(s.get("readOnlyEdit")){const{beans:{eventSvc:c},data:d,rowIndex:h,rowPinned:p}=this;return c.dispatchEvent({type:"cellEditRequest",event:null,rowIndex:h,rowPinned:p,column:a,colDef:a.colDef,data:d,node:this,oldValue:l,newValue:t,value:t,source:n}),!1}const u=r.setValue(this,a,t,n);return this.dispatchCellChangedEvent(a,t,l),o?.updateRowSelectable(this),u}updateHasChildren(){let e=this.group&&!this.footer||this.childrenAfterGroup&&this.childrenAfterGroup.length>0;const{rowChildrenSvc:t}=this.beans;t&&(e=t.getHasChildrenValue(this)),e!==this.__hasChildren&&(this.__hasChildren=!!e,this.dispatchRowEvent("hasChildrenChanged"))}hasChildren(){return this.__hasChildren==null&&this.updateHasChildren(),this.__hasChildren}dispatchCellChangedEvent(e,t,n){const i={type:"cellChanged",node:this,column:e,newValue:t,oldValue:n};this.__localEventService?.dispatchEvent(i)}resetQuickFilterAggregateText(){this.quickFilterAggregateText=null}isExpandable(){return this.beans.expansionSvc?.isExpandable(this)??!1}isSelected(){return this.footer?this.sibling.isSelected():this.__selected}depthFirstSearch(e){this.childrenAfterGroup?.forEach(t=>t.depthFirstSearch(e)),e(this)}dispatchRowEvent(e){this.__localEventService?.dispatchEvent({type:e,node:this})}setSelected(e,t=!1,n="api"){this.beans.selectionSvc?.setNodesSelected({nodes:[this],newValue:e,clearSelection:t,source:n})}isRowPinned(){return!!this.rowPinned}__addEventListener(e,t){this.__localEventService||(this.__localEventService=new Jd),this.__localEventService.addEventListener(e,t)}__removeEventListener(e,t){this.removeLocalListener(e,t)}addEventListener(e,t){this.beans.validation?.checkRowEvents(e),this.__localEventService||(this.__localEventService=new Jd),this.frameworkEventListenerService=this.beans.frameworkOverrides.createLocalEventListenerWrapper?.(this.frameworkEventListenerService,this.__localEventService);const n=this.frameworkEventListenerService?.wrap(t)??t;this.__localEventService.addEventListener(e,n)}removeEventListener(e,t){const n=this.frameworkEventListenerService?.unwrap(t)??t;this.removeLocalListener(e,n)}removeLocalListener(e,t){this.__localEventService?.removeEventListener(e,t),this.__localEventService?.noRegisteredListenersExist()&&(this.__localEventService=null)}isFullWidthCell(){if(ue(61),this.detail)return!0;const e=this.beans.gos.getCallback("isFullWidthRow");return e?e({rowNode:this}):!1}getRoute(){if(this.level===-1)return[];if(this.key==null)return;const e=[];let t=this;for(;t&&t.key!=null;)e.push(t.key),t=t.parent;return e.reverse()}setFirstChild(e){this.firstChild!==e&&(this.firstChild=e,this.dispatchRowEvent("firstChildChanged"))}setDisplayed(e){this.displayed!==e&&(this.displayed=e,this.dispatchRowEvent("displayedChanged"))}setRowIndex(e){this.rowIndex!==e&&(this.rowIndex=e,this.dispatchRowEvent("rowIndexChanged"))}setAllChildrenCount(e){this.allChildrenCount!==e&&(this.allChildrenCount=e,this.dispatchRowEvent("allChildrenCountChanged"))}setUiLevel(e){this.uiLevel!==e&&(this.uiLevel=e,this.dispatchRowEvent("uiLevelChanged"))}};function Jje(e,t,n){return Ne(t,{type:n,node:e,data:e.data,rowIndex:e.rowIndex,rowPinned:e.rowPinned})}var Zje={tag:"div",cls:"ag-filter"},eqe=class extends bt{constructor(e,t){super(Zje),this.column=e,this.source=t,this.filterWrapper=null}postConstruct(){this.createFilter(!0),this.addManagedEventListeners({filterDestroyed:this.onFilterDestroyed.bind(this)})}hasFilter(){return!!this.filterWrapper}getFilter(){return this.filterWrapper?.filterPromise??null}afterInit(){return this.filterWrapper?.filterPromise?.then(()=>{})??Ji.resolve()}afterGuiAttached(e){this.filterWrapper?.filterPromise?.then(t=>{t?.afterGuiAttached?.(e)})}afterGuiDetached(){this.filterWrapper?.filterPromise?.then(e=>{e?.afterGuiDetached?.()})}createFilter(e){const{column:t,source:n}=this;this.filterWrapper=this.beans.filterManager?.getOrCreateFilterWrapper(t)??null,this.filterWrapper?.filterPromise&&this.filterWrapper.filterPromise.then(i=>{const r=i.getGui();me(r)||ue(69,{guiFromFilter:r}),this.appendChild(r),e&&this.eventSvc.dispatchEvent({type:"filterOpened",column:t,source:n,eGui:this.getGui()})})}onFilterDestroyed(e){(e.source==="api"||e.source==="paramsUpdated")&&e.column.getId()===this.column.getId()&&this.beans.colModel.getColDefCol(this.column)&&(Ii(this.getGui()),this.createFilter())}destroy(){this.filterWrapper=null,super.destroy()}},_ne="ag-resizer-wrapper",du=(e,t)=>({tag:"div",ref:`${e}Resizer`,cls:`ag-resizer ag-resizer-${t}`}),tqe={tag:"div",cls:_ne,children:[du("eTopLeft","topLeft"),du("eTop","top"),du("eTopRight","topRight"),du("eRight","right"),du("eBottomRight","bottomRight"),du("eBottom","bottom"),du("eBottomLeft","bottomLeft"),du("eLeft","left")]},nqe=class extends X{constructor(e,t){super(),this.element=e,this.dragStartPosition={x:0,y:0},this.position={x:0,y:0},this.lastSize={width:-1,height:-1},this.positioned=!1,this.resizersAdded=!1,this.resizeListeners=[],this.boundaryEl=null,this.isResizing=!1,this.isMoving=!1,this.resizable={},this.movable=!1,this.currentResizer=null,this.config=Object.assign({},{popup:!1},t)}wireBeans(e){this.popupSvc=e.popupSvc,this.dragSvc=e.dragSvc}center(){const{clientHeight:e,clientWidth:t}=this.offsetParent,n=t/2-this.getWidth()/2,i=e/2-this.getHeight()/2;this.offsetElement(n,i)}initialisePosition(){if(this.positioned)return;const{centered:e,forcePopupParentAsOffsetParent:t,minWidth:n,width:i,minHeight:r,height:s,x:o,y:a}=this.config;this.offsetParent||this.setOffsetParent();let l=0,u=0;const c=Fo(this.element);if(c){const d=this.findBoundaryElement(),h=window.getComputedStyle(d);if(h.minWidth!=null){const p=d.offsetWidth-this.element.offsetWidth;u=parseInt(h.minWidth,10)-p}if(h.minHeight!=null){const p=d.offsetHeight-this.element.offsetHeight;l=parseInt(h.minHeight,10)-p}}if(this.minHeight=r||l,this.minWidth=n||u,i&&this.setWidth(i),s&&this.setHeight(s),(!i||!s)&&this.refreshSize(),e)this.center();else if(o||a)this.offsetElement(o,a);else if(c&&t){let d=this.boundaryEl,h=!0;if(d||(d=this.findBoundaryElement(),h=!1),d){const p=parseFloat(d.style.top),g=parseFloat(d.style.left);h?this.offsetElement(isNaN(g)?0:g,isNaN(p)?0:p):this.setPosition(g,p)}}this.positioned=!!this.offsetParent}isPositioned(){return this.positioned}getPosition(){return this.position}setMovable(e,t){if(!this.config.popup||e===this.movable)return;this.movable=e;const n=this.moveElementDragListener||{eElement:t,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};e?(this.dragSvc?.addDragSource(n),this.moveElementDragListener=n):(this.dragSvc?.removeDragSource(n),this.moveElementDragListener=void 0)}setResizable(e){if(this.clearResizeListeners(),e?this.addResizers():this.removeResizers(),typeof e=="boolean"){if(e===!1)return;e={topLeft:e,top:e,topRight:e,right:e,bottomRight:e,bottom:e,bottomLeft:e,left:e}}Object.keys(e).forEach(t=>{const i=!!e[t],r=this.getResizerElement(t),s={dragStartPixels:0,eElement:r,onDragStart:o=>this.onResizeStart(o,t),onDragging:this.onResize.bind(this),onDragStop:o=>this.onResizeEnd(o,t)};(i||!this.isAlive()&&!i)&&(i?(this.dragSvc?.addDragSource(s),this.resizeListeners.push(s),r.style.pointerEvents="all"):r.style.pointerEvents="none",this.resizable[t]=i)})}removeSizeFromEl(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")}restoreLastSize(){this.element.style.flex="0 0 auto";const{height:e,width:t}=this.lastSize;t!==-1&&(this.element.style.width=`${t}px`),e!==-1&&(this.element.style.height=`${e}px`)}getHeight(){return this.element.offsetHeight}setHeight(e){const{popup:t}=this.config,n=this.element;let i=!1;if(typeof e=="string"&&e.indexOf("%")!==-1)uv(n,e),e=kte(n),i=!0;else if(e=Math.max(this.minHeight,e),this.positioned){const r=this.getAvailableHeight();r&&e>r&&(e=r)}this.getHeight()!==e&&(i?(n.style.maxHeight="unset",n.style.minHeight="unset"):t?uv(n,e):(n.style.height=`${e}px`,n.style.flex="0 0 auto",this.lastSize.height=typeof e=="number"?e:parseFloat(e)))}getAvailableHeight(){const{popup:e,forcePopupParentAsOffsetParent:t}=this.config;this.positioned||this.initialisePosition();const{clientHeight:n}=this.offsetParent;if(!n)return null;const i=this.element.getBoundingClientRect(),r=this.offsetParent.getBoundingClientRect(),s=e?this.position.y:i.top,o=e?0:r.top;let a=0;if(t){const u=this.element.parentElement;if(u){const{bottom:c}=u.getBoundingClientRect();a=c-i.bottom}}return n+o-s-a}getWidth(){return this.element.offsetWidth}setWidth(e){const t=this.element,{popup:n}=this.config;let i=!1;if(typeof e=="string"&&e.indexOf("%")!==-1)ga(t,e),e=GS(t),i=!0;else if(this.positioned){e=Math.max(this.minWidth,e);const{clientWidth:r}=this.offsetParent,s=n?this.position.x:this.element.getBoundingClientRect().left;r&&e+s>r&&(e=r-s)}this.getWidth()!==e&&(i?(t.style.maxWidth="unset",t.style.minWidth="unset"):this.config.popup?ga(t,e):(t.style.width=`${e}px`,t.style.flex=" unset",this.lastSize.width=typeof e=="number"?e:parseFloat(e)))}offsetElement(e=0,t=0){const{forcePopupParentAsOffsetParent:n}=this.config,i=n?this.boundaryEl:this.element;i&&(this.popupSvc?.positionPopup({ePopup:i,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:()=>({x:e,y:t})}),this.setPosition(parseFloat(i.style.left),parseFloat(i.style.top)))}constrainSizeToAvailableHeight(e){if(!this.config.forcePopupParentAsOffsetParent)return;const t=()=>{const n=this.getAvailableHeight();this.element.style.setProperty("max-height",`${n}px`)};e&&this.popupSvc?this.resizeObserverSubscriber=Pc(this.beans,this.popupSvc?.getPopupParent(),t):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}setPosition(e,t){this.position.x=e,this.position.y=t}updateDragStartPosition(e,t){this.dragStartPosition={x:e,y:t}}calculateMouseMovement(e){const{e:t,isLeft:n,isTop:i,anywhereWithin:r,topBuffer:s}=e,o=t.clientX-this.dragStartPosition.x,a=t.clientY-this.dragStartPosition.y,l=this.shouldSkipX(t,!!n,!!r,o)?0:o,u=this.shouldSkipY(t,!!i,s,a)?0:a;return{movementX:l,movementY:u}}shouldSkipX(e,t,n,i){const r=this.element.getBoundingClientRect(),s=this.offsetParent.getBoundingClientRect(),o=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.x:r.left;let l=a<=0&&s.left>=e.clientX||s.right<=e.clientX&&s.right<=o.right;return l?!0:(t?l=i<0&&e.clientX>a+s.left||i>0&&e.clientX<a+s.left:n?l=i<0&&e.clientX>o.right||i>0&&e.clientX<a+s.left:l=i<0&&e.clientX>o.right||i>0&&e.clientX<o.right,l)}shouldSkipY(e,t,n=0,i){const r=this.element.getBoundingClientRect(),s=this.offsetParent.getBoundingClientRect(),o=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.y:r.top;let l=a<=0&&s.top>=e.clientY||s.bottom<=e.clientY&&s.bottom<=o.bottom;return l?!0:(t?l=i<0&&e.clientY>a+s.top+n||i>0&&e.clientY<a+s.top:l=i<0&&e.clientY>o.bottom||i>0&&e.clientY<o.bottom,l)}createResizeMap(){const e=t=>({element:this.element.querySelector(`[data-ref=${t}Resizer]`)});this.resizerMap={topLeft:e("eTopLeft"),top:e("eTop"),topRight:e("eTopRight"),right:e("eRight"),bottomRight:e("eBottomRight"),bottom:e("eBottom"),bottomLeft:e("eBottomLeft"),left:e("eLeft")}}addResizers(){if(this.resizersAdded)return;const e=this.element;e&&(e.appendChild(Cn(tqe)),this.createResizeMap(),this.resizersAdded=!0)}removeResizers(){this.resizerMap=void 0;const e=this.element.querySelector(`.${_ne}`);e&&this.element.removeChild(e),this.resizersAdded=!1}getResizerElement(e){return this.resizerMap[e].element}onResizeStart(e,t){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!t.match(/top/i),isRight:!!t.match(/right/i),isBottom:!!t.match(/bottom/i),isLeft:!!t.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[t].element.classList.add("ag-active");const{popup:n,forcePopupParentAsOffsetParent:i}=this.config;!n&&!i&&this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(e.clientX,e.clientY)}getSiblings(){const t=this.element.parentElement;return t?Array.prototype.slice.call(t.children).filter(n=>!n.classList.contains("ag-hidden")):null}getMinSizeOfSiblings(){const e=this.getSiblings()||[];let t=0,n=0;for(let i=0;i<e.length;i++){const r=e[i],s=!!r.style.flex&&r.style.flex!=="0 0 auto";if(r===this.element)continue;let o=this.minHeight||0,a=this.minWidth||0;if(s){const l=window.getComputedStyle(r);l.minHeight&&(o=parseInt(l.minHeight,10)),l.minWidth&&(a=parseInt(l.minWidth,10))}else o=r.offsetHeight,a=r.offsetWidth;t+=o,n+=a}return{height:t,width:n}}applySizeToSiblings(e){let t=null;const n=this.getSiblings();if(n){for(let i=0;i<n.length;i++){const r=n[i];r!==t&&(e?r.style.height=`${r.offsetHeight}px`:r.style.width=`${r.offsetWidth}px`,r.style.flex="0 0 auto",r===this.element&&(t=n[i+1]))}t&&(t.style.removeProperty("height"),t.style.removeProperty("min-height"),t.style.removeProperty("max-height"),t.style.flex="1 1 auto")}}isResizable(){return Object.values(this.resizable).some(e=>e)}onResize(e){if(!this.isResizing||!this.currentResizer)return;const{popup:t,forcePopupParentAsOffsetParent:n}=this.config,{isTop:i,isRight:r,isBottom:s,isLeft:o}=this.currentResizer,a=r||o,l=s||i,{movementX:u,movementY:c}=this.calculateMouseMovement({e,isLeft:o,isTop:i}),d=this.position.x,h=this.position.y;let p=0,g=0;if(a&&u){const v=o?-1:1,C=this.getWidth(),y=C+u*v;let b=!1;o&&(p=C-y,(d+p<=0||y<=this.minWidth)&&(b=!0,p=0)),b||this.setWidth(y)}if(l&&c){const v=i?-1:1,C=this.getHeight(),y=C+c*v;let b=!1;i?(g=C-y,(h+g<=0||y<=this.minHeight)&&(b=!0,g=0)):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&C<y&&this.getMinSizeOfSiblings().height+y>this.element.parentElement.offsetHeight&&(b=!0),b||this.setHeight(y)}this.updateDragStartPosition(e.clientX,e.clientY),((t||n)&&p||g)&&this.offsetElement(d+p,h+g)}onResizeEnd(e,t){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null,this.element.classList.remove("ag-resizing"),this.resizerMap[t].element.classList.remove("ag-active"),this.dispatchLocalEvent({type:"resize"})}refreshSize(){const e=this.element;this.config.popup&&(this.config.width||this.setWidth(e.offsetWidth),this.config.height||this.setHeight(e.offsetHeight))}onMoveStart(e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(e.clientX,e.clientY)}onMove(e){if(!this.isMoving)return;const{x:t,y:n}=this.position;let i;this.config.calculateTopBuffer&&(i=this.config.calculateTopBuffer());const{movementX:r,movementY:s}=this.calculateMouseMovement({e,isTop:!0,anywhereWithin:!0,topBuffer:i});this.offsetElement(t+r,n+s),this.updateDragStartPosition(e.clientX,e.clientY)}onMoveEnd(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")}setOffsetParent(){this.config.forcePopupParentAsOffsetParent&&this.popupSvc?this.offsetParent=this.popupSvc.getPopupParent():this.offsetParent=this.element.offsetParent}findBoundaryElement(){let e=this.element;for(;e;){if(window.getComputedStyle(e).position!=="static")return e;e=e.parentElement}return this.element}clearResizeListeners(){for(;this.resizeListeners.length;){const e=this.resizeListeners.pop();this.dragSvc?.removeDragSource(e)}}destroy(){super.destroy(),this.moveElementDragListener&&this.dragSvc?.removeDragSource(this.moveElementDragListener),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()}},iqe="ag-focus-managed",vg=class extends X{constructor(e,t={}){super(),this.eFocusable=e,this.callbacks=t,this.callbacks={shouldStopEventPropagation:()=>!1,onTabKeyDown:n=>{if(n.defaultPrevented)return;const i=xh(this.beans,this.eFocusable,!1,n.shiftKey);i&&(i.focus(),n.preventDefault())},...t}}postConstruct(){const{eFocusable:e,callbacks:{onFocusIn:t,onFocusOut:n}}=this;e.classList.add(iqe),this.addKeyDownListeners(e),t&&this.addManagedElementListeners(e,{focusin:t}),n&&this.addManagedElementListeners(e,{focusout:n})}addKeyDownListeners(e){this.addManagedElementListeners(e,{keydown:t=>{if(t.defaultPrevented||El(t))return;const{callbacks:n}=this;if(n.shouldStopEventPropagation(t)){Rp(t);return}t.key===K.TAB?n.onTabKeyDown(t):n.handleKeyDown&&n.handleKeyDown(t)}})}},One={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose one",equals:"Equals",notEqual:"Does not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"Between",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equal to",greaterThanOrEqual:"Greater than or equal to",contains:"Contains",notContains:"Does not contain",startsWith:"Begins with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",before:"Before",after:"After",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd"};function wN(e,t){const{debounceMs:n}=e;return n1(e)?(n!=null&&ue(71),0):n??t}function n1(e){return(e.buttons?.indexOf("apply")??-1)>=0}var rqe=class extends bt{constructor(e){super(),this.filterNameKey=e,this.applyActive=!1,this.hidePopup=null,this.debouncePending=!1,this.appliedModel=null,this.eFilterBody=ge,this.buttonListeners=[],this.defaultDebounceMs=0}postConstruct(){this.resetTemplate(),this.createManagedBean(new vg(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=new nqe(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}),this.createBean(this.positionableFeature)}handleKeyDown(e){}getFilterTitle(){return this.translate(this.filterNameKey)}isFilterActive(){return!!this.appliedModel}resetTemplate(e){let t=this.getGui();t?.removeEventListener("submit",this.onFormSubmit);const n={tag:"form",cls:"ag-filter-wrapper",children:[{tag:"div",ref:"eFilterBody",cls:`ag-filter-body-wrapper ag-${this.getCssIdentifier()}-body-wrapper`,children:[this.createBodyTemplate()]}]};this.setTemplate(n,this.getAgComponents(),e),t=this.getGui(),t?.addEventListener("submit",this.onFormSubmit)}isReadOnly(){return!!this.params.readOnly}init(e){this.setParams(e),this.resetUiToDefaults(!0).then(()=>{this.updateUiVisibility(),this.setupOnBtApplyDebounce()})}setParams(e){this.params=e,this.applyActive=n1(e),this.resetButtonsPanel(e)}updateParams(e){this.params=e,this.applyActive=n1(e),this.resetUiToActiveModel(this.getModel(),()=>{this.updateUiVisibility(),this.setupOnBtApplyDebounce()})}resetButtonsPanel(e,t){const{buttons:n,readOnly:i}=t??{},{buttons:r,readOnly:s}=e;if(i===s&&l0(n,r))return;const o=r&&r.length>0&&!this.isReadOnly();if(this.eButtonsPanel?(Ii(this.eButtonsPanel),this.buttonListeners.forEach(u=>u()),this.buttonListeners=[]):o&&(this.eButtonsPanel=Cn({tag:"div",cls:"ag-filter-apply-panel"})),!o){this.eButtonsPanel&&Fs(this.eButtonsPanel);return}const a=document.createDocumentFragment(),l=u=>{let c;const d=u?this.translate(`${u}Filter`):void 0;switch(u){case"apply":c=g=>this.onBtApply(!1,!1,g);break;case"clear":c=()=>this.onBtClear();break;case"reset":c=()=>this.onBtReset();break;case"cancel":c=g=>{this.onBtCancel(g)};break;default:ue(75);return}const p=MR(`<button
                    type="${u==="apply"?"submit":"button"}"
                    data-ref="${u}FilterButton"
                    class="ag-button ag-standard-button ag-filter-apply-panel-button"
                >${d}
                </button>`);this.buttonListeners.push(...this.addManagedElementListeners(p,{click:c})),a.append(p)};r.forEach(u=>l(u)),this.eButtonsPanel.append(a),this.getGui().appendChild(this.eButtonsPanel)}setupOnBtApplyDebounce(){const e=wN(this.params,this.defaultDebounceMs),t=hi(this,this.checkApplyDebounce.bind(this),e);this.onBtApplyDebounce=()=>{this.debouncePending=!0,t()}}checkApplyDebounce(){this.debouncePending&&(this.debouncePending=!1,this.onBtApply())}getModel(){return this.appliedModel??null}setModel(e){return(e!=null?this.setModelIntoUi(e):this.resetUiToDefaults()).then(()=>{this.updateUiVisibility(),this.applyModel("api")})}onBtCancel(e){this.resetUiToActiveModel(this.getModel(),()=>{this.handleCancelEnd(e)})}handleCancelEnd(e){this.params.closeOnApply&&this.close(e)}resetUiToActiveModel(e,t){const n=()=>{this.onUiChanged(!1,"prevent"),t?.()};e!=null?this.setModelIntoUi(e).then(n):this.resetUiToDefaults().then(n)}onBtClear(){this.resetUiToDefaults().then(()=>this.onUiChanged())}onBtReset(){this.onBtClear(),this.onBtApply()}applyModel(e="api"){const t=this.getModelFromUi();if(!this.isModelValid(t))return!1;const n=this.appliedModel;return this.appliedModel=t,!this.areModelsEqual(n,t)}isModelValid(e){return!0}onFormSubmit(e){e.preventDefault()}onBtApply(e=!1,t=!1,n){n&&n.preventDefault(),this.applyModel(t?"rowDataUpdated":"ui")&&this.params.filterChangedCallback({afterFloatingFilter:e,afterDataChange:t,source:"columnFilter"});const{closeOnApply:i}=this.params;i&&this.applyActive&&!e&&!t&&this.close(n)}onNewRowsLoaded(){}close(e){if(!this.hidePopup)return;const t=e,n=t&&t.key;let i;(n==="Enter"||n==="Space")&&(i={keyboardEvent:t}),this.hidePopup(i),this.hidePopup=null}onUiChanged(e=!1,t){if(this.updateUiVisibility(),this.params.filterModifiedCallback(),this.applyActive&&!this.isReadOnly()){const n=this.isModelValid(this.getModelFromUi()),i=this.queryForHtmlElement('[data-ref="applyFilterButton"]');i&&o0(i,!n)}e&&!t||t==="immediately"?this.onBtApply(e):(!this.applyActive&&!t||t==="debounce")&&this.onBtApplyDebounce()}afterGuiAttached(e){e&&(this.hidePopup=e.hidePopup),this.refreshFilterResizer(e?.container)}refreshFilterResizer(e){const{positionableFeature:t,gos:n}=this;if(!t||e==="toolPanel")return;e==="floatingFilter"||e==="columnFilter"?(t.restoreLastSize(),t.setResizable(n.get("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(t.removeSizeFromEl(),t.setResizable(!1)),t.constrainSizeToAvailableHeight(!0)}afterGuiDetached(){this.checkApplyDebounce(),this.positionableFeature?.constrainSizeToAvailableHeight(!1)}refresh(e){const t=this.params;return this.params=e,this.resetButtonsPanel(e,t),!0}destroy(){const e=this.getGui();e&&e.removeEventListener("submit",this.onFormSubmit),this.hidePopup=null,this.positionableFeature&&(this.positionableFeature=this.destroyBean(this.positionableFeature)),this.appliedModel=null,super.destroy()}translate(e){return this.getLocaleTextFunc()(e,One[e])}getCellValue(e){return this.params.getValue(e)}getPositionableElement(){return this.eFilterBody}};function sqe(e,t,n){if(t==null)return null;let i=null;const{compName:r,jsComp:s,fwComp:o}=oje(e,t);return r?i={agSetColumnFilter:"agSetColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"}[r]:s==null&&o==null&&t.filter===!0&&(i=n()),i}var so={AUTO_HEIGHT:"ag-layout-auto-height",NORMAL:"ag-layout-normal",PRINT:"ag-layout-print"},bN=class extends X{constructor(e){super(),this.view=e}postConstruct(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()}updateLayoutClasses(){const e=this.gos.get("domLayout"),t={autoHeight:e==="autoHeight",normal:e==="normal",print:e==="print"},n=t.autoHeight?so.AUTO_HEIGHT:t.print?so.PRINT:so.NORMAL;this.view.updateLayoutClasses(n,t)}},hu="Viewport",iW="fakeVScrollComp",rW=["fakeHScrollComp","centerHeader","topCenter","bottomCenter","stickyTopCenter","stickyBottomCenter"],sW=100,SD=150,oqe=class extends X{constructor(e){super(),this.lastScrollSource=[null,null],this.scrollLeft=-1,this.nextScrollTop=-1,this.scrollTop=-1,this.lastOffsetHeight=-1,this.lastScrollTop=-1,this.lastIsHorizontalScrollShowing=!1,this.scrollTimer=0,this.isVerticalPositionInvalidated=!0,this.isHorizontalPositionInvalidated=!0,this.eBodyViewport=e,this.resetLastHScrollDebounced=hi(this,()=>this.lastScrollSource[1]=null,SD),this.resetLastVScrollDebounced=hi(this,()=>this.lastScrollSource[0]=null,SD)}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.animationFrameSvc=e.animationFrameSvc,this.visibleCols=e.visibleCols}destroy(){super.destroy(),window.clearTimeout(this.scrollTimer)}postConstruct(){this.enableRtl=this.gos.get("enableRtl");const e=this.invalidateVerticalScroll.bind(this),t=this.invalidateHorizontalScroll.bind(this);this.addManagedEventListeners({displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this),gridSizeChanged:e,scrollGapChanged:t}),this.addManagedElementListeners(this.eBodyViewport,{scroll:e}),this.ctrlsSvc.whenReady(this,n=>{this.centerRowsCtrl=n.center,this.onDisplayedColumnsWidthChanged(),this.addScrollListener()})}invalidateHorizontalScroll(){this.isHorizontalPositionInvalidated=!0}invalidateVerticalScroll(){this.isVerticalPositionInvalidated=!0}addScrollListener(){this.addHorizontalScrollListeners(),this.addVerticalScrollListeners()}addHorizontalScrollListeners(){this.addManagedElementListeners(this.centerRowsCtrl.eViewport,{scroll:this.onHScroll.bind(this,hu)});for(const e of rW){const t=this.ctrlsSvc.get(e);this.registerScrollPartner(t,this.onHScroll.bind(this,e))}}addVerticalScrollListeners(){const e=this.ctrlsSvc.get("fakeVScrollComp"),t=this.gos.get("debounceVerticalScrollbar"),n=t?hi(this,this.onVScroll.bind(this,hu),sW):this.onVScroll.bind(this,hu),i=t?hi(this,this.onVScroll.bind(this,iW),sW):this.onVScroll.bind(this,iW);this.addManagedElementListeners(this.eBodyViewport,{scroll:n}),this.registerScrollPartner(e,i)}registerScrollPartner(e,t){e.onScrollCallback(t)}onDisplayedColumnsWidthChanged(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()}horizontallyScrollHeaderCenterAndFloatingCenter(e){this.centerRowsCtrl!=null&&(e===void 0&&(e=this.centerRowsCtrl.getCenterViewportScrollLeft()),this.setScrollLeftForAllContainersExceptCurrent(Math.abs(e)))}setScrollLeftForAllContainersExceptCurrent(e){for(const t of[...rW,hu]){if(this.lastScrollSource[1]===t)continue;const n=this.getViewportForSource(t);HS(n,e,this.enableRtl)}}getViewportForSource(e){return e===hu?this.centerRowsCtrl.eViewport:this.ctrlsSvc.get(e).eViewport}isControllingScroll(e,t){return this.lastScrollSource[t]==null?(t===0?this.lastScrollSource[0]=e:this.lastScrollSource[1]=e,!0):this.lastScrollSource[t]===e}onHScroll(e){if(!this.isControllingScroll(e,1))return;const t=this.centerRowsCtrl.eViewport,{scrollLeft:n}=t;if(this.shouldBlockScrollUpdate(1,n,!0))return;const i=zS(this.getViewportForSource(e),this.enableRtl);this.doHorizontalScroll(i),this.resetLastHScrollDebounced()}onVScroll(e){if(!this.isControllingScroll(e,0))return;let t;if(e===hu?t=this.eBodyViewport.scrollTop:t=this.ctrlsSvc.get("fakeVScrollComp").getScrollPosition(),this.shouldBlockScrollUpdate(0,t,!0))return;const{animationFrameSvc:n}=this;n?.setScrollTop(t),this.nextScrollTop=t,e===hu?this.ctrlsSvc.get("fakeVScrollComp").setScrollPosition(t):this.eBodyViewport.scrollTop=t,n?.active?n.schedule():this.scrollGridIfNeeded(!0),this.resetLastVScrollDebounced()}doHorizontalScroll(e){const t=this.ctrlsSvc.get("fakeHScrollComp").getScrollPosition();this.scrollLeft===e&&e===t||(this.scrollLeft=e,this.fireScrollEvent(1),this.horizontallyScrollHeaderCenterAndFloatingCenter(e),this.centerRowsCtrl.onHorizontalViewportChanged(!0))}fireScrollEvent(e){const t={type:"bodyScroll",direction:e===1?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.eventSvc.dispatchEvent(t),window.clearTimeout(this.scrollTimer),this.scrollTimer=window.setTimeout(()=>{this.scrollTimer=0,this.eventSvc.dispatchEvent({...t,type:"bodyScrollEnd"})},SD)}shouldBlockScrollUpdate(e,t,n=!1){return n&&!Sd()?!1:e===0?this.shouldBlockVerticalScroll(t):this.shouldBlockHorizontalScroll(t)}shouldBlockVerticalScroll(e){const t=uN(this.eBodyViewport),{scrollHeight:n}=this.eBodyViewport;return e<0||e+t>n}shouldBlockHorizontalScroll(e){const t=this.centerRowsCtrl.getCenterWidth(),{scrollWidth:n}=this.centerRowsCtrl.eViewport;if(this.enableRtl){if(e>0)return!0}else if(e<0)return!0;return Math.abs(e)+t>n}redrawRowsAfterScroll(){this.fireScrollEvent(0)}checkScrollLeft(){this.scrollLeft!==this.centerRowsCtrl.getCenterViewportScrollLeft()&&this.onHScroll(hu)}scrollGridIfNeeded(e=!1){const t=this.scrollTop!=this.nextScrollTop;return t&&(this.scrollTop=this.nextScrollTop,e&&this.invalidateVerticalScroll(),this.redrawRowsAfterScroll()),t}setHorizontalScrollPosition(e,t=!1){const i=this.centerRowsCtrl.eViewport.scrollWidth-this.centerRowsCtrl.getCenterWidth();!t&&this.shouldBlockScrollUpdate(1,e)&&(this.enableRtl?e=e>0?0:i:e=Math.min(Math.max(e,0),i)),HS(this.centerRowsCtrl.eViewport,Math.abs(e),this.enableRtl),this.doHorizontalScroll(e)}setVerticalScrollPosition(e){this.invalidateVerticalScroll(),this.eBodyViewport.scrollTop=e}getVScrollPosition(){if(!this.isVerticalPositionInvalidated){const{lastOffsetHeight:n,lastScrollTop:i}=this;return{top:i,bottom:i+n}}this.isVerticalPositionInvalidated=!1;const{scrollTop:e,offsetHeight:t}=this.eBodyViewport;return this.lastScrollTop=e,this.lastOffsetHeight=t,{top:e,bottom:e+t}}getApproximateVScollPosition(){return this.lastScrollTop>=0&&this.lastOffsetHeight>=0?{top:this.scrollTop,bottom:this.scrollTop+this.lastOffsetHeight}:this.getVScrollPosition()}getHScrollPosition(){return this.centerRowsCtrl.getHScrollPosition()}isHorizontalScrollShowing(){return this.isHorizontalPositionInvalidated&&(this.lastIsHorizontalScrollShowing=this.centerRowsCtrl.isHorizontalScrollShowing(),this.isHorizontalPositionInvalidated=!1),this.lastIsHorizontalScrollShowing}scrollHorizontally(e){const t=this.centerRowsCtrl.eViewport.scrollLeft;return this.setHorizontalScrollPosition(t+e),this.centerRowsCtrl.eViewport.scrollLeft-t}scrollToTop(){this.eBodyViewport.scrollTop=0}ensureNodeVisible(e,t=null){const{rowModel:n}=this.beans,i=n.getRowCount();let r=-1;for(let s=0;s<i;s++){const o=n.getRow(s);if(typeof e=="function"){if(o&&e(o)){r=s;break}}else if(e===o||e===o.data){r=s;break}}r>=0&&this.ensureIndexVisible(r,t)}ensureIndexVisible(e,t){if(gi(this.gos,"print"))return;const{rowModel:n}=this.beans,i=n.getRowCount();if(typeof e!="number"||e<0||e>=i){ue(88,{index:e});return}const{frameworkOverrides:r,pageBounds:s,rowContainerHeight:o,rowRenderer:a}=this.beans;r.wrapIncoming(()=>{const l=this.ctrlsSvc.getGridBodyCtrl(),u=n.getRow(e);let c,d,h=0;this.invalidateVerticalScroll();do{const{stickyTopHeight:p,stickyBottomHeight:g}=l,v=u.rowTop,C=u.rowHeight,y=s.getPixelOffset(),b=u.rowTop-y,S=b+u.rowHeight,x=this.getVScrollPosition(),E=o.divStretchOffset,A=x.top+E,F=x.bottom+E,k=F-A,P=o.getScrollPositionForPixel(b),_=o.getScrollPositionForPixel(S-k),O=Math.min((P+_)/2,b),H=A+p>b,W=F-g<S;let $=null;t==="top"?$=P-p:t==="bottom"?$=_+g:t==="middle"?$=O:H?$=P-p:W&&($=_+g),$!==null&&(this.setVerticalScrollPosition($),a.redraw({afterScroll:!0})),c=v!==u.rowTop||C!==u.rowHeight,d=p!==l.stickyTopHeight||g!==l.stickyBottomHeight,h++}while((c||d)&&h<10);this.animationFrameSvc?.flushAllFrames()})}ensureColumnVisible(e,t="auto"){const{colModel:n,frameworkOverrides:i}=this.beans,r=n.getCol(e);if(!r||r.isPinned()||!this.visibleCols.isColDisplayed(r))return;const s=this.getPositionedHorizontalScroll(r,t);i.wrapIncoming(()=>{s!==null&&this.centerRowsCtrl.setCenterViewportScrollLeft(s),this.centerRowsCtrl.onHorizontalViewportChanged(),this.animationFrameSvc?.flushAllFrames()})}getPositionedHorizontalScroll(e,t){const{columnBeforeStart:n,columnAfterEnd:i}=this.isColumnOutsideViewport(e),r=this.centerRowsCtrl.getCenterWidth()<e.getActualWidth(),s=this.centerRowsCtrl.getCenterWidth(),o=this.enableRtl;let a=(o?n:i)||r,l=o?i:n;t!=="auto"&&(a=t==="start",l=t==="end");const u=t==="middle";if(a||l||u){const{colLeft:c,colMiddle:d,colRight:h}=this.getColumnBounds(e);return u?d-s/2:a?o?h:c:o?c-s:h-s}return null}isColumnOutsideViewport(e){const{start:t,end:n}=this.getViewportBounds(),{colLeft:i,colRight:r}=this.getColumnBounds(e),s=this.enableRtl,o=s?t>r:n<r,a=s?n<i:t>i;return{columnBeforeStart:o,columnAfterEnd:a}}getColumnBounds(e){const t=this.enableRtl,n=this.visibleCols.bodyWidth,i=e.getActualWidth(),r=e.getLeft(),s=t?-1:1,o=t?n-r:r,a=o+i*s,l=o+i/2*s;return{colLeft:o,colMiddle:l,colRight:a}}getViewportBounds(){const e=this.centerRowsCtrl.getCenterWidth(),t=this.centerRowsCtrl.getCenterViewportScrollLeft(),n=t,i=e+t;return{start:n,end:i,width:e}}},SN=class extends X{constructor(e,t=!1){super(),this.callback=e,this.addSpacer=t}postConstruct(){const e=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",e),this.addManagedEventListeners({columnContainerWidthChanged:e,displayedColumnsChanged:e,leftPinnedWidthChanged:e}),this.addSpacer&&this.addManagedEventListeners({rightPinnedWidthChanged:e,scrollVisibilityChanged:e,scrollbarWidthChanged:e}),this.setWidth()}setWidth(){const e=gi(this.gos,"print"),{visibleCols:t,scrollVisibleSvc:n}=this.beans,i=t.bodyWidth,r=t.getColsLeftWidth(),s=t.getDisplayedColumnsRightWidth();let o;e?o=i+r+s:(o=i,this.addSpacer&&(this.gos.get("enableRtl")?r:s)===0&&n.verticalScrollShowing&&(o+=n.getScrollbarWidth())),this.callback(o)}},aqe=class extends X{constructor(e){super(),this.centerContainerCtrl=e}wireBeans(e){this.scrollVisibleSvc=e.scrollVisibleSvc}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.listenForResize()}),this.addManagedEventListeners({scrollbarWidthChanged:this.onScrollbarWidthChanged.bind(this)}),this.addManagedPropertyListeners(["alwaysShowHorizontalScroll","alwaysShowVerticalScroll"],()=>{this.checkViewportAndScrolls()})}listenForResize(){const{beans:e,centerContainerCtrl:t,gridBodyCtrl:n}=this,i=()=>{eu(e,()=>{this.onCenterViewportResized()})};t.registerViewportResizeListener(i),n.registerBodyViewportResizeListener(i)}onScrollbarWidthChanged(){this.checkViewportAndScrolls()}onCenterViewportResized(){if(this.scrollVisibleSvc.updateScrollGap(),this.centerContainerCtrl.isViewportInTheDOMTree()){const{pinnedCols:e,colFlex:t}=this.beans;e?.keepPinnedColumnsNarrowerThanViewport(),this.checkViewportAndScrolls();const n=this.centerContainerCtrl.getCenterWidth();n!==this.centerWidth&&(this.centerWidth=n,t?.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0}checkViewportAndScrolls(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.scrollFeature.checkScrollLeft()}getBodyHeight(){return this.bodyHeight}checkBodyHeight(){const e=this.gridBodyCtrl.eBodyViewport,t=uN(e);this.bodyHeight!==t&&(this.bodyHeight=t,this.eventSvc.dispatchEvent({type:"bodyHeightChanged"}))}updateScrollVisibleService(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)}updateScrollVisibleServiceImpl(){const e={horizontalScrollShowing:this.centerContainerCtrl.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleSvc.setScrollsVisible(e)}onHorizontalViewportChanged(){const e=this.centerContainerCtrl.getCenterWidth(),t=this.centerContainerCtrl.getViewportScrollLeft();this.beans.colViewport.setScrollPosition(e,t)}};function xN(e,t,n,i,r,s){if(n==null&&t==null)return;const o={},a={},l=(u,c)=>{u.split(" ").forEach(d=>{d.trim()!=""&&c(d)})};if(n){const u=Object.keys(n);for(let c=0;c<u.length;c++){const d=u[c],h=n[d];let p;typeof h=="string"?p=e?e.evaluate(h,i):!0:typeof h=="function"&&(p=h(i)),l(d,g=>{p?o[g]=!0:a[g]=!0})}}t&&s&&Object.keys(t).forEach(u=>l(u,c=>{o[c]||(a[c]=!0)})),s&&Object.keys(a).forEach(s),Object.keys(o).forEach(r)}function oW(e){if(e.group)return e.level;const t=e.parent;return t?t.level+1:0}var lqe=class extends X{constructor(){super(...arguments),this.beanName="rowStyleSvc"}processClassesFromGridOptions(e,t){const n=this.gos,i=o=>{typeof o=="string"?e.push(o):Array.isArray(o)&&o.forEach(a=>e.push(a))},r=n.get("rowClass");r&&i(r);const s=n.getCallback("getRowClass");if(s){const o={data:t.data,node:t,rowIndex:t.rowIndex},a=s(o);i(a)}}preProcessRowClassRules(e,t){this.processRowClassRules(t,n=>{e.push(n)},()=>{})}processRowClassRules(e,t,n){const{gos:i,expressionSvc:r}=this.beans,s=Ne(i,{data:e.data,node:e,rowIndex:e.rowIndex});xN(r,void 0,i.get("rowClassRules"),s,t,n)}processStylesFromGridOptions(e){const t=this.gos,n=t.get("rowStyle"),i=t.getCallback("getRowStyle");let r;if(i){const s={data:e.data,node:e,rowIndex:e.rowIndex};r=i(s)}if(r||n)return Object.assign({},n,r)}},uqe=0,i1="renderedRow",r1=class extends X{constructor(e,t,n,i,r){super(),this.rowNode=e,this.useAnimationFrameForCreate=i,this.printLayout=r,this.allRowGuis=[],this.active=!0,this.centerCellCtrls={list:[],map:{}},this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}},this.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.rowDragComps=[],this.lastMouseDownOnDragger=!1,this.emptyStyle={},this.updateColumnListsPending=!1,this.rowId=null,this.businessKey=null,this.beans=t,this.gos=t.gos,this.paginationPage=t.pagination?.getCurrentPage()??0,this.suppressRowTransform=this.gos.get("suppressRowTransform"),this.instanceId=e.id+"-"+uqe++,this.rowId=Fl(e.id),this.initRowBusinessKey(),this.rowFocused=t.focusSvc.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned),this.rowLevel=oW(this.rowNode),this.setRowType(),this.setAnimateFlags(n),this.rowStyles=this.processStylesFromGridOptions(),this.addListeners()}initRowBusinessKey(){this.businessKeyForNodeFunc=this.gos.get("getBusinessKeyForNode"),this.updateRowBusinessKey()}updateRowBusinessKey(){if(typeof this.businessKeyForNodeFunc!="function")return;const e=this.businessKeyForNodeFunc(this.rowNode);this.businessKey=Fl(e)}updateGui(e,t){e==="left"?this.leftGui=t:e==="right"?this.rightGui=t:e==="fullWidth"?this.fullWidthGui=t:this.centerGui=t}setComp(e,t,n,i){const{context:r,focusSvc:s}=this.beans;i=wC(this,r,i);const o={rowComp:e,element:t,containerType:n,compBean:i};this.allRowGuis.push(o),this.updateGui(n,o),this.initialiseRowComp(o);const a=this.rowNode,l=this.rowType==="FullWidthLoading"||a.stub,u=!a.data&&this.beans.rowModel.getType()==="infinite";!l&&!u&&!a.rowPinned&&this.beans.rowRenderer.dispatchFirstDataRenderedEvent();const c=this.fullWidthGui?.element;c&&!this.editing&&s.isRowFocused(a.rowIndex,a.rowPinned)&&s.shouldTakeFocus()&&setTimeout(()=>c.focus({preventScroll:!0}),0)}unsetComp(e){this.allRowGuis=this.allRowGuis.filter(t=>t.containerType!==e),this.updateGui(e,void 0)}isCacheable(){return this.rowType==="FullWidthDetail"&&this.gos.get("keepDetailRows")}setCached(e){const t=e?"none":"";this.allRowGuis.forEach(n=>n.element.style.display=t)}initialiseRowComp(e){const t=this.gos;this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.listenOnDomOrder(e),this.onRowHeightChanged(e),this.updateRowIndexes(e),this.setFocusedClasses(e),this.setStylesFromGridOptions(!1,e),Ed(t)&&this.rowNode.selectable&&this.onRowSelected(e),this.updateColumnLists(!this.useAnimationFrameForCreate);const n=e.rowComp;this.getInitialRowClasses(e.containerType).forEach(r=>n.addOrRemoveCssClass(r,!0)),this.executeSlideAndFadeAnimations(e),this.rowNode.group&&wT(e.element,this.rowNode.expanded==!0),this.setRowCompRowId(n),this.setRowCompRowBusinessKey(n),Zd(t,e.element,i1,this),e.compBean.addDestroyFunc(()=>Zd(t,e.element,i1,null)),this.useAnimationFrameForCreate?this.beans.animationFrameSvc.createTask(this.addHoverFunctionality.bind(this,e),this.rowNode.rowIndex,"p2",!1):this.addHoverFunctionality(e),this.isFullWidth()&&this.setupFullWidth(e),t.get("rowDragEntireRow")&&this.addRowDraggerToRow(e),this.useAnimationFrameForCreate&&this.beans.animationFrameSvc.addDestroyTask(()=>{this.isAlive()&&e.rowComp.addOrRemoveCssClass("ag-after-created",!0)}),this.executeProcessRowPostCreateFunc()}setRowCompRowBusinessKey(e){this.businessKey!=null&&e.setRowBusinessKey(this.businessKey)}setRowCompRowId(e){const t=Fl(this.rowNode.id);this.rowId=t,t!=null&&e.setRowId(t)}executeSlideAndFadeAnimations(e){const{containerType:t}=e;this.slideInAnimation[t]&&(FT(()=>{this.onTopChanged()}),this.slideInAnimation[t]=!1),this.fadeInAnimation[t]&&(FT(()=>{e.rowComp.addOrRemoveCssClass("ag-opacity-zero",!1)}),this.fadeInAnimation[t]=!1)}addRowDraggerToRow(e){const t=this.beans.rowDragSvc?.createRowDragCompForRow(this.rowNode,e.element);if(!t)return;const n=this.createBean(t,this.beans.context);this.rowDragComps.push(n),e.compBean.addDestroyFunc(()=>{this.rowDragComps=this.rowDragComps.filter(i=>i!==n),this.destroyBean(n,this.beans.context)})}setupFullWidth(e){const t=this.getPinnedForContainer(e.containerType),n=this.createFullWidthCompDetails(e.element,t);e.rowComp.showFullWidth(n)}getFullWidthCellRenderers(){return this.gos.get("embedFullWidthRows")?this.allRowGuis.map(e=>e?.rowComp?.getFullWidthCellRenderer()):[this.fullWidthGui?.rowComp?.getFullWidthCellRenderer()]}executeProcessRowPostCreateFunc(){const e=this.gos.getCallback("processRowPostCreate");if(!e||!this.areAllContainersReady())return;const t={eRow:this.centerGui.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)};e(t)}areAllContainersReady(){const{leftGui:e,centerGui:t,rightGui:n,beans:{visibleCols:i}}=this,r=!!e||!i.isPinningLeft(),s=!!t,o=!!n||!i.isPinningRight();return r&&s&&o}isNodeFullWidthCell(){if(this.rowNode.detail)return!0;const e=this.beans.gos.getCallback("isFullWidthRow");return e?e({rowNode:this.rowNode}):!1}setRowType(){const e=this.rowNode.stub&&!this.gos.get("suppressServerSideFullWidthLoadingRow")&&!this.gos.get("groupHideOpenParents"),t=this.isNodeFullWidthCell(),n=this.gos.get("masterDetail")&&this.rowNode.detail,i=this.beans.colModel.isPivotMode(),s=!!this.rowNode.group&&!this.rowNode.footer&&pN(this.gos,i);e?this.rowType="FullWidthLoading":n?this.rowType="FullWidthDetail":t?this.rowType="FullWidth":s?this.rowType="FullWidthGroup":this.rowType="Normal"}updateColumnLists(e=!1,t=!1){if(this.isFullWidth())return;const{animationFrameSvc:n}=this.beans;if(!n?.active||e||this.printLayout){this.updateColumnListsImpl(t);return}this.updateColumnListsPending||(n.createTask(()=>{this.active&&this.updateColumnListsImpl(!0)},this.rowNode.rowIndex,"p1",!1),this.updateColumnListsPending=!0)}getNewCellCtrl(e){if(!this.beans.rowSpanSvc?.isCellSpanning(e,this.rowNode))return new hv(e,this.rowNode,this.beans,this)}isCorrectCtrlForSpan(e){return!this.beans.rowSpanSvc?.isCellSpanning(e.column,this.rowNode)}createCellCtrls(e,t,n=null){const i={list:[],map:{}},r=(u,c,d)=>{d!=null?i.list.splice(d,0,c):i.list.push(c),i.map[u]=c},s=[];for(const u of t){const c=u.getInstanceId();let d=e.map[c];d&&!this.isCorrectCtrlForSpan(d)&&(d.destroy(),d=void 0),d||(d=this.getNewCellCtrl(u)),d&&r(c,d)}for(const u of e.list){const c=u.column.getInstanceId();if(i.map[c]!=null)continue;!this.isCellEligibleToBeRemoved(u,n)?s.push([c,u]):u.destroy()}if(s.length)for(const[u,c]of s){const d=i.list.findIndex(p=>p.column.getLeft()>c.column.getLeft()),h=d===-1?void 0:Math.max(d-1,0);r(u,c,h)}const{focusSvc:o,visibleCols:a}=this.beans,l=o.getFocusedCell();if(l&&l.column.getPinned()==n){const u=l.column.getInstanceId();if(!i.map[u]&&a.allCols.includes(l.column)){const d=this.createFocusedCellCtrl();if(d){const h=i.list.findIndex(g=>g.column.getLeft()>d.column.getLeft()),p=h===-1?void 0:Math.max(h-1,0);r(u,d,p)}}}return i}createFocusedCellCtrl(){const{focusSvc:e,rowSpanSvc:t}=this.beans,n=e.getFocusedCell();if(!n)return;const i=t?.getCellSpan(n.column,this.rowNode);if(i){if(i.firstNode!==this.rowNode||!i.doesSpanContain(n))return}else if(!e.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned))return;return this.getNewCellCtrl(n.column)}updateColumnListsImpl(e){this.updateColumnListsPending=!1,this.createAllCellCtrls(),this.setCellCtrls(e)}setCellCtrls(e){this.allRowGuis.forEach(t=>{const n=this.getCellCtrlsForContainer(t.containerType);t.rowComp.setCellCtrls(n,e)})}getCellCtrlsForContainer(e){switch(e){case"left":return this.leftCellCtrls.list;case"right":return this.rightCellCtrls.list;case"fullWidth":return[];case"center":return this.centerCellCtrls.list}}createAllCellCtrls(){const e=this.beans.colViewport,t=this.beans.visibleCols;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,t.allCols),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{const n=e.getColsWithinViewport(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,n);const i=t.getLeftColsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,i,"left");const r=t.getRightColsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,r,"right")}}isCellEligibleToBeRemoved(e,t){const{column:r}=e;if(r.getPinned()!=t||!this.isCorrectCtrlForSpan(e))return!0;const{editing:s}=e,{visibleCols:o}=this.beans,a=e.isCellFocused();return s||a?!(o.allCols.indexOf(r)>=0):!0}getDomOrder(){return this.gos.get("ensureDomOrder")||gi(this.gos,"print")}listenOnDomOrder(e){const t=()=>{e.rowComp.setDomOrder(this.getDomOrder())};e.compBean.addManagedPropertyListeners(["domLayout","ensureDomOrder"],t)}setAnimateFlags(e){if(this.rowNode.sticky||!e)return;const t=me(this.rowNode.oldRowTop),{visibleCols:n}=this.beans,i=n.isPinningLeft(),r=n.isPinningRight();if(t){const{slideInAnimation:s}=this;if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){s.fullWidth=!0;return}s.center=!0,s.left=i,s.right=r}else{const{fadeInAnimation:s}=this;if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){s.fullWidth=!0;return}s.center=!0,s.left=i,s.right=r}}isFullWidth(){return this.rowType!=="Normal"}refreshFullWidth(){const e=(o,a)=>o?o.rowComp.refreshFullWidth(()=>this.createFullWidthCompDetails(o.element,a).params):!0,t=e(this.fullWidthGui,null),n=e(this.centerGui,null),i=e(this.leftGui,"left"),r=e(this.rightGui,"right");return t&&n&&i&&r}addListeners(){this.addManagedListeners(this.rowNode,{heightChanged:()=>this.onRowHeightChanged(),rowSelected:()=>this.onRowSelected(),rowIndexChanged:this.onRowIndexChanged.bind(this),topChanged:this.onTopChanged.bind(this),...this.beans.expansionSvc?.getRowExpandedListeners(this)??{}}),this.rowNode.detail&&this.addManagedListeners(this.rowNode.parent,{dataChanged:this.onRowNodeDataChanged.bind(this)}),this.addManagedListeners(this.rowNode,{dataChanged:this.onRowNodeDataChanged.bind(this),cellChanged:this.postProcessCss.bind(this),rowHighlightChanged:this.onRowNodeHighlightChanged.bind(this),draggingChanged:this.postProcessRowDragging.bind(this),uiLevelChanged:this.onUiLevelChanged.bind(this)}),this.addManagedListeners(this.beans.eventSvc,{paginationPixelOffsetChanged:this.onPaginationPixelOffsetChanged.bind(this),heightScaleChanged:this.onTopChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),virtualColumnsChanged:this.onVirtualColumnsChanged.bind(this),cellFocused:this.onCellFocusChanged.bind(this),cellFocusCleared:this.onCellFocusChanged.bind(this),paginationChanged:this.onPaginationChanged.bind(this),modelUpdated:this.refreshFirstAndLastRowStyles.bind(this),columnMoved:()=>this.updateColumnLists()}),this.beans.rowSpanSvc&&this.addManagedListeners(this.beans.rowSpanSvc,{spannedCellsUpdated:({pinned:e})=>{e&&!this.rowNode.rowPinned||this.updateColumnLists()}}),this.addDestroyFunc(()=>{this.rowDragComps=this.destroyBeans(this.rowDragComps,this.beans.context),this.tooltipFeature=this.destroyBean(this.tooltipFeature,this.beans.context)}),this.addManagedPropertyListeners(["rowStyle","getRowStyle","rowClass","getRowClass","rowClassRules"],this.postProcessCss.bind(this)),this.addManagedPropertyListener("rowDragEntireRow",()=>{if(this.gos.get("rowDragEntireRow")){this.allRowGuis.forEach(t=>{this.addRowDraggerToRow(t)});return}this.rowDragComps=this.destroyBeans(this.rowDragComps,this.beans.context)}),this.addListenersForCellComps()}addListenersForCellComps(){this.addManagedListeners(this.rowNode,{rowIndexChanged:()=>{this.getAllCellCtrls().forEach(e=>e.onRowIndexChanged())},cellChanged:e=>{this.getAllCellCtrls().forEach(t=>t.onCellChanged(e))}})}onRowNodeDataChanged(e){if(this.isFullWidth()!==!!this.isNodeFullWidthCell()){this.beans.rowRenderer.redrawRow(this.rowNode);return}if(this.isFullWidth()){this.refreshFullWidth()||this.beans.rowRenderer.redrawRow(this.rowNode);return}this.getAllCellCtrls().forEach(n=>n.refreshCell({suppressFlash:!e.update,newData:!e.update})),this.allRowGuis.forEach(n=>{this.setRowCompRowId(n.rowComp),this.updateRowBusinessKey(),this.setRowCompRowBusinessKey(n.rowComp)}),this.onRowSelected(),this.postProcessCss()}postProcessCss(){this.setStylesFromGridOptions(!0),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.postProcessRowDragging()}onRowNodeHighlightChanged(){const e=this.rowNode.highlighted;this.allRowGuis.forEach(t=>{const n=e==="Above",i=e==="Below";t.rowComp.addOrRemoveCssClass("ag-row-highlight-above",n),t.rowComp.addOrRemoveCssClass("ag-row-highlight-below",i)})}postProcessRowDragging(){const e=this.rowNode.dragging;this.allRowGuis.forEach(t=>t.rowComp.addOrRemoveCssClass("ag-row-dragging",e))}onDisplayedColumnsChanged(){this.updateColumnLists(!0),this.beans.rowAutoHeight?.requestCheckAutoHeight()}onVirtualColumnsChanged(){this.updateColumnLists(!1,!0)}getRowPosition(){return{rowPinned:Rl(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}}onKeyboardNavigate(e){const t=this.findFullWidthInfoForEvent(e);if(!t)return;const{rowGui:n,column:i}=t;if(!(n.element===e.target))return;const o=this.rowNode,{focusSvc:a,navigation:l}=this.beans,u=a.getFocusedCell(),c={rowIndex:o.rowIndex,rowPinned:o.rowPinned,column:u?.column??i};l?.navigateToNextCell(e,e.key,c,!0),e.preventDefault()}onTabKeyDown(e){if(e.defaultPrevented||El(e))return;const t=this.allRowGuis.find(a=>a.element.contains(e.target)),n=t?t.element:null,i=n===e.target,r=Xt(this.beans);let s=!1;n&&r&&(s=n.contains(r)&&r.classList.contains("ag-cell"));let o=null;!i&&!s&&(o=xh(this.beans,n,!1,e.shiftKey)),(this.isFullWidth()&&i||!o)&&this.beans.navigation?.onTabKeyDown(this,e)}getFullWidthElement(){return this.fullWidthGui?this.fullWidthGui.element:null}getRowYPosition(){const e=this.allRowGuis.find(t=>Fo(t.element))?.element;return e?e.getBoundingClientRect().top:0}onSuppressCellFocusChanged(e){const t=this.isFullWidth()&&e?void 0:-1;this.allRowGuis.forEach(n=>{ks(n.element,"tabindex",t)})}onFullWidthRowFocused(e){const t=this.rowNode,n=e?this.isFullWidth()&&e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned:!1;let i;if(this.fullWidthGui)i=this.fullWidthGui.element;else{const s=this.beans.colModel.getCol(e?.column)?.pinned;s?i=s==="right"?this.rightGui?.element:this.leftGui?.element:i=this.centerGui?.element}i&&(i.classList.toggle("ag-full-width-focus",n),n&&e?.forceBrowserFocus&&i.focus({preventScroll:!0}))}recreateCell(e){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,e),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,e),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,e),e.destroy(),this.updateColumnLists()}removeCellCtrl(e,t){const n={list:[],map:{}};return e.list.forEach(i=>{i!==t&&(n.list.push(i),n.map[i.column.getInstanceId()]=i)}),n}onMouseEvent(e,t){switch(e){case"dblclick":this.onRowDblClick(t);break;case"click":this.onRowClick(t);break;case"touchstart":case"mousedown":this.onRowMouseDown(t);break}}createRowEvent(e,t){const{rowNode:n}=this;return Ne(this.gos,{type:e,node:n,data:n.data,rowIndex:n.rowIndex,rowPinned:n.rowPinned,event:t})}createRowEventWithSource(e,t){const n=this.createRowEvent(e,t);return n.source=this,n}onRowDblClick(e){El(e)||this.beans.eventSvc.dispatchEvent(this.createRowEventWithSource("rowDoubleClicked",e))}findFullWidthInfoForEvent(e){if(!e)return;const t=this.findFullWidthRowGui(e.target),n=this.getColumnForFullWidth(t);if(!(!t||!n))return{rowGui:t,column:n}}findFullWidthRowGui(e){return this.allRowGuis.find(t=>t.element.contains(e))}getColumnForFullWidth(e){const{visibleCols:t}=this.beans;switch(e?.containerType){case"center":return t.centerCols[0];case"left":return t.leftCols[0];case"right":return t.rightCols[0];default:return t.allCols[0]}}onRowMouseDown(e){if(this.lastMouseDownOnDragger=xd(e.target,"ag-row-drag",3),!this.isFullWidth())return;const t=this.rowNode,{rangeSvc:n,focusSvc:i}=this.beans;n?.removeAllCellRanges();const r=this.findFullWidthInfoForEvent(e);if(!r)return;const{rowGui:s,column:o}=r,a=s.element,l=e.target;let u=e.defaultPrevented||wh();a&&a.contains(l)&&lN(l)&&(u=!1),i.setFocusedCell({rowIndex:t.rowIndex,column:o,rowPinned:t.rowPinned,forceBrowserFocus:u})}onRowClick(e){if(El(e)||this.lastMouseDownOnDragger)return;const{eventSvc:n,selectionSvc:i}=this.beans;n.dispatchEvent(this.createRowEventWithSource("rowClicked",e)),i?.handleSelectionEvent(e,this.rowNode,"rowClicked")}setupDetailRowAutoHeight(e){this.rowType==="FullWidthDetail"&&this.beans.masterDetailSvc?.setupDetailRowAutoHeight(this,e)}createFullWidthCompDetails(e,t){const{gos:n,rowNode:i}=this,r=Ne(n,{fullWidth:!0,data:i.data,node:i,value:i.key,valueFormatted:i.key,eGridCell:e,eParentOfValue:e,pinned:t,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:(o,a,l,u)=>this.addFullWidthRowDragging(o,a,l,u),setTooltip:(o,a)=>{n.assertModuleRegistered("Tooltip",3),this.refreshRowTooltip(o,a)}}),s=this.beans.userCompFactory;switch(this.rowType){case"FullWidthDetail":return J7e(s,r);case"FullWidthGroup":return r.value=i.groupValue,r.valueFormatted=i.rowGroupColumn?this.beans.valueSvc.formatValue(i.rowGroupColumn,i,r.value):r.value,Q7e(s,r);case"FullWidthLoading":return X7e(s,r);default:return Y7e(s,r)}}refreshRowTooltip(e,t){this.fullWidthGui&&(this.tooltipFeature=this.beans.tooltipSvc?.refreshRowTooltip(this.tooltipFeature,this,e,t))}addFullWidthRowDragging(e,t,n="",i){const{rowDragSvc:r,context:s}=this.beans;if(!r||!this.isFullWidth())return;const o=r.createRowDragComp(()=>n,this.rowNode,void 0,e,t,i);this.createBean(o,s),this.addDestroyFunc(()=>{this.destroyBean(o,s)})}onUiLevelChanged(){const e=oW(this.rowNode);if(this.rowLevel!=e){const t="ag-row-level-"+e,n="ag-row-level-"+this.rowLevel;this.allRowGuis.forEach(i=>{i.rowComp.addOrRemoveCssClass(t,!0),i.rowComp.addOrRemoveCssClass(n,!1)})}this.rowLevel=e}isFirstRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBounds.getFirstRow()}isLastRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBounds.getLastRow()}refreshFirstAndLastRowStyles(){const e=this.isFirstRowOnPage(),t=this.isLastRowOnPage();this.firstRowOnPage!==e&&(this.firstRowOnPage=e,this.allRowGuis.forEach(n=>n.rowComp.addOrRemoveCssClass("ag-row-first",e))),this.lastRowOnPage!==t&&(this.lastRowOnPage=t,this.allRowGuis.forEach(n=>n.rowComp.addOrRemoveCssClass("ag-row-last",t)))}getAllCellCtrls(){return this.leftCellCtrls.list.length===0&&this.rightCellCtrls.list.length===0?this.centerCellCtrls.list:[...this.centerCellCtrls.list,...this.leftCellCtrls.list,...this.rightCellCtrls.list]}postProcessClassesFromGridOptions(){const e=[];this.beans.rowStyleSvc?.processClassesFromGridOptions(e,this.rowNode),e.length&&e.forEach(t=>{this.allRowGuis.forEach(n=>n.rowComp.addOrRemoveCssClass(t,!0))})}postProcessRowClassRules(){this.beans.rowStyleSvc?.processRowClassRules(this.rowNode,e=>{this.allRowGuis.forEach(t=>t.rowComp.addOrRemoveCssClass(e,!0))},e=>{this.allRowGuis.forEach(t=>t.rowComp.addOrRemoveCssClass(e,!1))})}setStylesFromGridOptions(e,t){e&&(this.rowStyles=this.processStylesFromGridOptions()),this.forEachGui(t,n=>n.rowComp.setUserStyles(this.rowStyles))}getPinnedForContainer(e){return e==="left"||e==="right"?e:null}getInitialRowClasses(e){const t=this.getPinnedForContainer(e),n=this.isFullWidth(),{rowNode:i,beans:r}=this,s=[];s.push("ag-row"),s.push(this.rowFocused?"ag-row-focus":"ag-row-no-focus"),this.fadeInAnimation[e]&&s.push("ag-opacity-zero"),s.push(i.rowIndex%2===0?"ag-row-even":"ag-row-odd"),i.isRowPinned()&&s.push("ag-row-pinned"),i.isSelected()&&s.push("ag-row-selected"),i.footer&&s.push("ag-row-footer"),s.push("ag-row-level-"+this.rowLevel),i.stub&&s.push("ag-row-loading"),n&&s.push("ag-full-width-row"),r.expansionSvc?.addExpandedCss(s,i),i.dragging&&s.push("ag-row-dragging");const{rowStyleSvc:o}=r;return o&&(o.processClassesFromGridOptions(s,i),o.preProcessRowClassRules(s,i)),s.push(this.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),this.isFirstRowOnPage()&&s.push("ag-row-first"),this.isLastRowOnPage()&&s.push("ag-row-last"),n&&(t==="left"&&s.push("ag-cell-last-left-pinned"),t==="right"&&s.push("ag-cell-first-right-pinned")),s}processStylesFromGridOptions(){return this.beans.rowStyleSvc?.processStylesFromGridOptions(this.rowNode)??this.emptyStyle}onRowSelected(e){this.beans.selectionSvc?.onRowCtrlSelected(this,t=>{(t===this.centerGui||t===this.fullWidthGui)&&this.announceDescription()},e)}announceDescription(){this.beans.selectionSvc?.announceAriaRowSelection(this.rowNode)}addHoverFunctionality(e){if(!this.active)return;const{element:t,compBean:n}=e,{rowNode:i,beans:r,gos:s}=this;n.addManagedListeners(t,{mouseenter:()=>i.dispatchRowEvent("mouseEnter"),mouseleave:()=>i.dispatchRowEvent("mouseLeave")}),n.addManagedListeners(i,{mouseEnter:()=>{!r.dragSvc?.dragging&&!s.get("suppressRowHoverHighlight")&&(t.classList.add("ag-row-hover"),i.setHovered(!0))},mouseLeave:()=>{this.resetHoveredStatus(t)}})}resetHoveredStatus(e){const t=e?[e]:this.allRowGuis.map(n=>n.element);for(const n of t)n.classList.remove("ag-row-hover");this.rowNode.setHovered(!1)}roundRowTopToBounds(e){const t=this.beans.ctrlsSvc.getScrollFeature().getApproximateVScollPosition(),n=this.applyPaginationOffset(t.top,!0)-100,i=this.applyPaginationOffset(t.bottom,!0)+100;return Math.min(Math.max(n,e),i)}forEachGui(e,t){e?t(e):this.allRowGuis.forEach(t)}isRowRendered(){return this.allRowGuis.length>0}onRowHeightChanged(e){if(this.rowNode.rowHeight==null)return;const t=this.rowNode.rowHeight,n=this.beans.environment.getDefaultRowHeight(),r=Vte(this.gos)?Sp(this.beans,this.rowNode).height:void 0,s=r?`${Math.min(n,r)-2}px`:void 0;this.forEachGui(e,o=>{o.element.style.height=`${t}px`,s&&o.element.style.setProperty("--ag-line-height",s)})}destroyFirstPass(e=!1){this.active=!1;const{rowNode:t}=this;if(!e&&Mf(this.gos)&&!t.sticky)if(t.rowTop!=null){const r=this.roundRowTopToBounds(t.rowTop);this.setRowTop(r)}else this.allRowGuis.forEach(r=>r.rowComp.addOrRemoveCssClass("ag-opacity-zero",!0));this.fullWidthGui?.element.contains(Xt(this.beans))&&this.beans.focusSvc.attemptToRecoverFocus(),t.setHovered(!1);const n=this.createRowEvent("virtualRowRemoved");this.dispatchLocalEvent(n),this.beans.eventSvc.dispatchEvent(n),super.destroy()}destroySecondPass(){this.allRowGuis.length=0,this.beans.editSvc?.stopRowEditing(this);const e=t=>(t.list.forEach(n=>n.destroy()),{list:[],map:{}});this.centerCellCtrls=e(this.centerCellCtrls),this.leftCellCtrls=e(this.leftCellCtrls),this.rightCellCtrls=e(this.rightCellCtrls)}setFocusedClasses(e){this.forEachGui(e,t=>{t.rowComp.addOrRemoveCssClass("ag-row-focus",this.rowFocused),t.rowComp.addOrRemoveCssClass("ag-row-no-focus",!this.rowFocused)})}onCellFocusChanged(){const{focusSvc:e,editSvc:t}=this.beans,n=e.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);n!==this.rowFocused&&(this.rowFocused=n,this.setFocusedClasses()),!n&&this.editing&&t?.stopRowEditing(this,!1)}onPaginationChanged(){const e=this.beans.pagination?.getCurrentPage()??0;this.paginationPage!==e&&(this.paginationPage=e,this.onTopChanged()),this.refreshFirstAndLastRowStyles()}onTopChanged(){this.setRowTop(this.rowNode.rowTop)}onPaginationPixelOffsetChanged(){this.onTopChanged()}applyPaginationOffset(e,t=!1){if(this.rowNode.isRowPinned()||this.rowNode.sticky)return e;const n=this.beans.pageBounds.getPixelOffset();return e+n*(t?1:-1)}setRowTop(e){if(!this.printLayout&&me(e)){const t=this.applyPaginationOffset(e),r=`${this.rowNode.isRowPinned()||this.rowNode.sticky?t:this.beans.rowContainerHeight.getRealPixelPosition(t)}px`;this.setRowTopStyle(r)}}getInitialRowTop(e){return this.suppressRowTransform?this.getInitialRowTopShared(e):void 0}getInitialTransform(e){return this.suppressRowTransform?void 0:`translateY(${this.getInitialRowTopShared(e)})`}getInitialRowTopShared(e){if(this.printLayout)return"";const t=this.rowNode;let n;if(t.sticky)n=t.stickyRowTop;else{const i=this.slideInAnimation[e]?this.roundRowTopToBounds(t.oldRowTop):t.rowTop,r=this.applyPaginationOffset(i);n=t.isRowPinned()?r:this.beans.rowContainerHeight.getRealPixelPosition(r)}return n+"px"}setRowTopStyle(e){this.allRowGuis.forEach(t=>this.suppressRowTransform?t.rowComp.setTop(e):t.rowComp.setTransform(`translateY(${e})`))}getCellCtrl(e,t=!1){let n=null;return this.getAllCellCtrls().forEach(i=>{i.column==e&&(n=i)}),n!=null||t||this.getAllCellCtrls().forEach(i=>{i.getColSpanningList().indexOf(e)>=0&&(n=i)}),n}onRowIndexChanged(){this.rowNode.rowIndex!=null&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())}updateRowIndexes(e){const t=this.rowNode.getRowIndexString();if(t===null)return;const n=(this.beans.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0)+(this.beans.filterManager?.getHeaderRowCount()??0),i=this.rowNode.rowIndex%2===0,r=n+this.rowNode.rowIndex+1;this.forEachGui(e,s=>{s.rowComp.setRowIndex(t),s.rowComp.addOrRemoveCssClass("ag-row-even",i),s.rowComp.addOrRemoveCssClass("ag-row-odd",!i),oN(s.element,r)})}};function Lne(e){return e.altKey||e.ctrlKey||e.metaKey?!1:e.key?.length===1}function OT(e,t,n,i,r){const s=i?i.getColDef().suppressKeyboardEvent:void 0;if(!s)return!1;const o=Ne(e,{event:t,editing:r,column:i,node:n,data:n.data,colDef:i.getColDef()});return!!(s&&s(o))}function cqe(e){const{pinnedRowModel:t,rowModel:n}=e,[i,r]=[t?.isEmpty("top")??!0,t?.isEmpty("bottom")??!0],s=i?null:"top";let o,a;r?(o=null,a=n.getRowCount()-1):(o="bottom",a=t?.getPinnedBottomRowCount()??-1);const{visibleCols:l,rangeSvc:u}=e,c=l.allCols;!u||!c?.length||u.setCellRange({rowStartIndex:0,rowStartPinned:s,rowEndIndex:a,rowEndPinned:o})}var dqe=65,hqe=67,fqe=86,pqe=68,gqe=90,mqe=89;function vqe(e){const{keyCode:t}=e;let n;switch(t){case dqe:n=K.A;break;case hqe:n=K.C;break;case fqe:n=K.V;break;case pqe:n=K.D;break;case gqe:n=K.Z;break;case mqe:n=K.Y;break;default:n=e.code}return n}var Cqe=class extends X{constructor(e){super(),this.element=e}postConstruct(){this.addKeyboardListeners(),this.addMouseListeners(),this.beans.touchSvc?.mockRowContextMenu(this)}addKeyboardListeners(){const e="keydown",t=this.processKeyboardEvent.bind(this,e);this.addManagedElementListeners(this.element,{[e]:t})}addMouseListeners(){["dblclick","contextmenu","mouseover","mouseout","click",Qte("touchstart")?"touchstart":"mousedown"].forEach(n=>{const i=this.processMouseEvent.bind(this,n);this.addManagedElementListeners(this.element,{[n]:i})})}processMouseEvent(e,t){if(!g0(this.gos,t)||El(t))return;const{cellCtrl:n,rowCtrl:i}=this.getControlsForEventTarget(t.target);e==="contextmenu"?(n?.column&&n.dispatchCellContextMenuEvent(t),this.beans.contextMenuSvc?.handleContextMenuMouseEvent(t,void 0,i,n)):(n&&n.onMouseEvent(e,t),i&&i.onMouseEvent(e,t))}getControlsForEventTarget(e){const{gos:t}=this;return{cellCtrl:xne(t,e),rowCtrl:Jte(t,e,i1)}}processKeyboardEvent(e,t){const{cellCtrl:n,rowCtrl:i}=this.getControlsForEventTarget(t.target);t.defaultPrevented||(n?this.processCellKeyboardEvent(n,e,t):i&&i.isFullWidth()&&this.processFullWidthRowKeyboardEvent(i,e,t))}processCellKeyboardEvent(e,t,n){const{rowNode:i,column:r,editing:s}=e;!OT(this.gos,n,i,r,s)&&t==="keydown"&&(!s&&this.beans.navigation?.handlePageScrollingKey(n)||e.onKeyDown(n),this.doGridOperations(n,e.editing),Lne(n)&&e.processCharacter(n)),t==="keydown"&&this.eventSvc.dispatchEvent(e.createEvent(n,"cellKeyDown"))}processFullWidthRowKeyboardEvent(e,t,n){const{rowNode:i}=e,{focusSvc:r,navigation:s}=this.beans,o=r.getFocusedCell(),a=o&&o.column;if(!OT(this.gos,n,i,a,!1)){const u=n.key;if(t==="keydown")switch(u){case K.PAGE_HOME:case K.PAGE_END:case K.PAGE_UP:case K.PAGE_DOWN:s?.handlePageScrollingKey(n,!0);break;case K.LEFT:case K.RIGHT:if(!this.gos.get("embedFullWidthRows"))break;case K.UP:case K.DOWN:e.onKeyboardNavigate(n);break;case K.TAB:e.onTabKeyDown(n);break}}t==="keydown"&&this.eventSvc.dispatchEvent(e.createRowEvent("cellKeyDown",n))}doGridOperations(e,t){if(!e.ctrlKey&&!e.metaKey||t||!g0(this.gos,e))return;const n=vqe(e),{clipboardSvc:i,undoRedo:r}=this.beans;if(n===K.A)return this.onCtrlAndA(e);if(n===K.C)return this.onCtrlAndC(i,e);if(n===K.D)return this.onCtrlAndD(i,e);if(n===K.V)return this.onCtrlAndV(i,e);if(n===K.X)return this.onCtrlAndX(i,e);if(n===K.Y)return this.onCtrlAndY(r);if(n===K.Z)return this.onCtrlAndZ(r,e)}onCtrlAndA(e){const{beans:{rowModel:t,rangeSvc:n,selectionSvc:i},gos:r}=this;n&&Gl(r)&&t.isRowsToRender()?cqe(this.beans):i&&i?.selectAllRowNodes({source:"keyboardSelectAll",selectAll:Yte(r)}),e.preventDefault()}onCtrlAndC(e,t){if(!e||this.gos.get("enableCellTextSelection"))return;const{cellCtrl:n,rowCtrl:i}=this.getControlsForEventTarget(t.target);n?.editing||i?.editing||(t.preventDefault(),e.copyToClipboard())}onCtrlAndX(e,t){if(!e||this.gos.get("enableCellTextSelection")||this.gos.get("suppressCutToClipboard"))return;const{cellCtrl:n,rowCtrl:i}=this.getControlsForEventTarget(t.target);n?.editing||i?.editing||(t.preventDefault(),e.cutToClipboard(void 0,"ui"))}onCtrlAndV(e,t){const{cellCtrl:n,rowCtrl:i}=this.getControlsForEventTarget(t.target);n?.editing||i?.editing||e&&!this.gos.get("suppressClipboardPaste")&&e.pasteFromClipboard()}onCtrlAndD(e,t){e&&!this.gos.get("suppressClipboardPaste")&&e.copyRangeDown(),t.preventDefault()}onCtrlAndZ(e,t){!this.gos.get("undoRedoCellEditing")||!e||(t.preventDefault(),t.shiftKey?e.redo("ui"):e.undo("ui"))}onCtrlAndY(e){e?.redo("ui")}},Nne=class extends X{constructor(e,t){super(),this.eContainer=e,this.eViewport=t}postConstruct(){this.addManagedEventListeners({rowContainerHeightChanged:this.onHeightChanged.bind(this,this.beans.rowContainerHeight)})}onHeightChanged(e){const t=e.uiContainerHeight,n=t!=null?`${t}px`:"";this.eContainer.style.height=n,this.eViewport&&(this.eViewport.style.height=n)}},aw=e=>e.topRowCtrls,lw=e=>e.getStickyTopRowCtrls(),uw=e=>e.getStickyBottomRowCtrls(),cw=e=>e.bottomRowCtrls,dw=e=>e.allRowCtrls,xD=e=>e.getCtrls("top"),RD=e=>e.getCtrls("center"),ED=e=>e.getCtrls("bottom"),yqe={center:{type:"center",name:"center-cols",getRowCtrls:dw,getSpannedRowCtrls:RD},left:{type:"left",name:"pinned-left-cols",pinnedType:"left",getRowCtrls:dw,getSpannedRowCtrls:RD},right:{type:"right",name:"pinned-right-cols",pinnedType:"right",getRowCtrls:dw,getSpannedRowCtrls:RD},fullWidth:{type:"fullWidth",name:"full-width",fullWidth:!0,getRowCtrls:dw},topCenter:{type:"center",name:"floating-top",getRowCtrls:aw,getSpannedRowCtrls:xD},topLeft:{type:"left",name:"pinned-left-floating",container:"ag-pinned-left-floating-top",pinnedType:"left",getRowCtrls:aw,getSpannedRowCtrls:xD},topRight:{type:"right",name:"pinned-right-floating",container:"ag-pinned-right-floating-top",pinnedType:"right",getRowCtrls:aw,getSpannedRowCtrls:xD},topFullWidth:{type:"fullWidth",name:"floating-top-full-width",fullWidth:!0,getRowCtrls:aw},stickyTopCenter:{type:"center",name:"sticky-top",getRowCtrls:lw},stickyTopLeft:{type:"left",name:"pinned-left-sticky-top",container:"ag-pinned-left-sticky-top",pinnedType:"left",getRowCtrls:lw},stickyTopRight:{type:"right",name:"pinned-right-sticky-top",container:"ag-pinned-right-sticky-top",pinnedType:"right",getRowCtrls:lw},stickyTopFullWidth:{type:"fullWidth",name:"sticky-top-full-width",fullWidth:!0,getRowCtrls:lw},stickyBottomCenter:{type:"center",name:"sticky-bottom",getRowCtrls:uw},stickyBottomLeft:{type:"left",name:"pinned-left-sticky-bottom",container:"ag-pinned-left-sticky-bottom",pinnedType:"left",getRowCtrls:uw},stickyBottomRight:{type:"right",name:"pinned-right-sticky-bottom",container:"ag-pinned-right-sticky-bottom",pinnedType:"right",getRowCtrls:uw},stickyBottomFullWidth:{type:"fullWidth",name:"sticky-bottom-full-width",fullWidth:!0,getRowCtrls:uw},bottomCenter:{type:"center",name:"floating-bottom",getRowCtrls:cw,getSpannedRowCtrls:ED},bottomLeft:{type:"left",name:"pinned-left-floating-bottom",container:"ag-pinned-left-floating-bottom",pinnedType:"left",getRowCtrls:cw,getSpannedRowCtrls:ED},bottomRight:{type:"right",name:"pinned-right-floating-bottom",container:"ag-pinned-right-floating-bottom",pinnedType:"right",getRowCtrls:cw,getSpannedRowCtrls:ED},bottomFullWidth:{type:"fullWidth",name:"floating-bottom-full-width",fullWidth:!0,getRowCtrls:cw}};function $ne(e){return`ag-${bC(e).name}-viewport`}function Kw(e){const t=bC(e);return t.container??`ag-${t.name}-container`}function wqe(e){return`ag-${bC(e).name}-spanned-cells-container`}function bC(e){return yqe[e]}var bqe=["topCenter","topLeft","topRight"],Sqe=["bottomCenter","bottomLeft","bottomRight"],xqe=["center","left","right"],Rqe=["center","left","right","fullWidth"],Eqe=["stickyTopCenter","stickyBottomCenter","center","topCenter","bottomCenter"],Fqe=["left","bottomLeft","topLeft","stickyTopLeft","stickyBottomLeft"],Aqe=["right","bottomRight","topRight","stickyTopRight","stickyBottomRight"],Bne=["stickyTopCenter","stickyTopLeft","stickyTopRight"],Gne=["stickyBottomCenter","stickyBottomLeft","stickyBottomRight"],Dqe=[...Bne,"stickyTopFullWidth",...Gne,"stickyBottomFullWidth"],Pqe=[...bqe,...Sqe,...xqe,...Bne,...Gne],kqe=class extends X{constructor(e){super(),this.name=e,this.visible=!0,this.EMPTY_CTRLS=[],this.options=bC(e)}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.forContainers(["center"],()=>{this.viewportSizeFeature=this.createManagedBean(new aqe(this)),this.addManagedEventListeners({stickyTopOffsetChanged:this.onStickyTopOffsetChanged.bind(this)})})}onStickyTopOffsetChanged(e){this.comp.setOffsetTop(`${e.offset}px`)}registerWithCtrlsService(){this.options.fullWidth||this.beans.ctrlsSvc.register(this.name,this)}forContainers(e,t){e.indexOf(this.name)>=0&&t()}setComp(e,t,n,i){this.comp=e,this.eContainer=t,this.eSpannedContainer=n,this.eViewport=i,this.createManagedBean(new Cqe(this.eViewport??this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder();const{pinnedCols:r,rangeSvc:s}=this.beans,o=()=>this.onPinnedWidthChanged();this.forContainers(Fqe,()=>{this.pinnedWidthFeature=this.createOptionalManagedBean(r?.createPinnedWidthFeature(!0,this.eContainer,this.eSpannedContainer)),this.addManagedEventListeners({leftPinnedWidthChanged:o})}),this.forContainers(Aqe,()=>{this.pinnedWidthFeature=this.createOptionalManagedBean(r?.createPinnedWidthFeature(!1,this.eContainer,this.eSpannedContainer)),this.addManagedEventListeners({rightPinnedWidthChanged:o})}),this.forContainers(Rqe,()=>this.createManagedBean(new Nne(this.eContainer,this.name==="center"?i:void 0))),s&&this.forContainers(Pqe,()=>this.createManagedBean(s.createDragListenerFeature(this.eContainer))),this.forContainers(Eqe,()=>this.createManagedBean(new SN(a=>this.comp.setContainerWidth(`${a}px`)))),this.visible=this.isContainerVisible(),this.addListeners(),this.registerWithCtrlsService()}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}addListeners(){const{spannedRowRenderer:e,gos:t}=this.beans;this.addManagedEventListeners({displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onDisplayedColumnsChanged.bind(this),displayedRowsChanged:n=>this.onDisplayedRowsChanged(n.afterScroll)}),this.onDisplayedColumnsChanged(),this.onDisplayedRowsChanged(),e&&this.options.getSpannedRowCtrls&&t.get("enableCellSpan")&&this.addManagedListeners(e,{spannedRowsUpdated:()=>{const n=this.options.getSpannedRowCtrls(e);n&&this.comp.setSpannedRowCtrls(n,!1)}})}listenOnDomOrder(){if(Dqe.indexOf(this.name)>=0){this.comp.setDomOrder(!0);return}const t=()=>{const n=this.gos.get("ensureDomOrder"),i=gi(this.gos,"print");this.comp.setDomOrder(n||i)};this.addManagedPropertyListener("domLayout",t),t()}onDisplayedColumnsChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}addPreventScrollWhileDragging(){const{dragSvc:e}=this.beans;if(!e)return;const t=n=>{e.dragging&&n.cancelable&&n.preventDefault()};this.eContainer.addEventListener("touchmove",t,{passive:!1}),this.addDestroyFunc(()=>this.eContainer.removeEventListener("touchmove",t))}onHorizontalViewportChanged(e=!1){const t=this.getCenterWidth(),n=this.getCenterViewportScrollLeft();this.beans.colViewport.setScrollPosition(t,n,e)}hasHorizontalScrollGap(){return this.eContainer.clientWidth-this.eViewport.clientWidth<0}hasVerticalScrollGap(){return this.eContainer.clientHeight-this.eViewport.clientHeight<0}getCenterWidth(){return a0(this.eViewport)}getCenterViewportScrollLeft(){return zS(this.eViewport,this.enableRtl)}registerViewportResizeListener(e){const t=Pc(this.beans,this.eViewport,e);this.addDestroyFunc(()=>t())}isViewportInTheDOMTree(){return Mte(this.eViewport)}getViewportScrollLeft(){return zS(this.eViewport,this.enableRtl)}isHorizontalScrollShowing(){return this.gos.get("alwaysShowHorizontalScroll")||m9e(this.eViewport)}setHorizontalScroll(e){this.comp.setHorizontalScroll(e)}getHScrollPosition(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}}setCenterViewportScrollLeft(e){HS(this.eViewport,e,this.enableRtl)}isContainerVisible(){return!(this.options.pinnedType!=null)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0}onPinnedWidthChanged(){const e=this.isContainerVisible();this.visible!=e&&(this.visible=e,this.onDisplayedRowsChanged())}onDisplayedRowsChanged(e=!1){const t=this.options.getRowCtrls(this.beans.rowRenderer);if(!this.visible||t.length===0){this.comp.setRowCtrls({rowCtrls:this.EMPTY_CTRLS});return}const n=gi(this.gos,"print"),r=this.gos.get("embedFullWidthRows")||n,s=t.filter(o=>{const a=o.isFullWidth();return this.options.fullWidth?!r&&a:r||!a});this.comp.setRowCtrls({rowCtrls:s,useFlushSync:e})}},zne="ag-force-vertical-scroll",Tqe="ag-selectable",Mqe="ag-column-moving",Iqe=class extends X{constructor(){super(...arguments),this.stickyTopHeight=0,this.stickyBottomHeight=0}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.colModel=e.colModel,this.scrollVisibleSvc=e.scrollVisibleSvc,this.pinnedRowModel=e.pinnedRowModel,this.filterManager=e.filterManager,this.rowGroupColsSvc=e.rowGroupColsSvc}setComp(e,t,n,i,r,s,o){this.comp=e,this.eGridBody=t,this.eBodyViewport=n,this.eTop=i,this.eBottom=r,this.eStickyTop=s,this.eStickyBottom=o,this.eCenterColsViewport=n.querySelector(`.${$ne("center")}`),this.eFullWidthContainer=n.querySelector(`.${Kw("fullWidth")}`),this.eStickyTopFullWidthContainer=s.querySelector(`.${Kw("stickyTopFullWidth")}`),this.eStickyBottomFullWidthContainer=o.querySelector(`.${Kw("stickyBottomFullWidth")}`),this.setCellTextSelection(this.gos.get("enableCellTextSelection")),this.addManagedPropertyListener("enableCellTextSelection",a=>this.setCellTextSelection(a.currentValue)),this.createManagedBean(new bN(this.comp)),this.scrollFeature=this.createManagedBean(new oqe(this.eBodyViewport)),this.beans.rowDragSvc?.setupRowDrag(this.eBodyViewport,this),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([i,n,r,s,o]),this.setGridRootRole(),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.updateScrollingClasses(),this.filterManager?.setupAdvFilterHeaderComp(i),this.ctrlsSvc.register("gridBodyCtrl",this)}addEventListeners(){const e=this.setFloatingHeights.bind(this),t=this.setGridRootRole.bind(this);this.addManagedEventListeners({gridColumnsChanged:this.onGridColumnsChanged.bind(this),scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this),scrollGapChanged:this.updateScrollingClasses.bind(this),pinnedRowDataChanged:e,pinnedHeightChanged:e,headerHeightChanged:this.setStickyTopOffsetTop.bind(this),columnRowGroupChanged:t,columnPivotChanged:t}),this.addManagedPropertyListener("treeData",t)}onGridColumnsChanged(){const e=this.beans.colModel.getCols();this.comp.setColumnCount(e.length)}onScrollVisibilityChanged(){const{scrollVisibleSvc:e}=this,t=e.verticalScrollShowing;this.setVerticalScrollPaddingVisible(t),this.setStickyWidth(t),this.setStickyBottomOffsetBottom();const n=t&&e.getScrollbarWidth()||0,i=Dte()?16:0,r=`calc(100% + ${n+i}px)`;eu(this.beans,()=>this.comp.setBodyViewportWidth(r)),this.updateScrollingClasses()}setGridRootRole(){const{rowGroupColsSvc:e,colModel:t}=this;let n=this.gos.get("treeData");if(!n){const i=t.isPivotMode();n=(e?e.columns.length:0)>=(i?2:1)}this.comp.setGridRootRole(n?"treegrid":"grid")}addFocusListeners(e){e.forEach(t=>{this.addManagedElementListeners(t,{focusin:n=>{const{target:i}=n,r=xd(i,"ag-root",t);t.classList.toggle("ag-has-focus",!r)},focusout:n=>{const{target:i,relatedTarget:r}=n,s=t.contains(r),o=xd(r,"ag-root",t);xd(i,"ag-root",t)||(!s||o)&&t.classList.remove("ag-has-focus")}})})}setColumnMovingCss(e){this.comp.setColumnMovingCss(Mqe,e)}setCellTextSelection(e=!1){this.comp.setCellSelectableCss(Tqe,e)}updateScrollingClasses(){const{eGridBody:{classList:e},scrollVisibleSvc:t}=this;e.toggle("ag-body-vertical-content-no-gap",!t.verticalScrollGap),e.toggle("ag-body-horizontal-content-no-gap",!t.horizontalScrollGap)}disableBrowserDragging(){this.addManagedElementListeners(this.eGridBody,{dragstart:e=>{if(e.target instanceof HTMLImageElement)return e.preventDefault(),!1}})}addStopEditingWhenGridLosesFocus(){this.beans.editSvc?.addStopEditingWhenGridLosesFocus([this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop,this.eStickyBottom])}updateRowCount(){const e=(this.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0)+(this.filterManager?.getHeaderRowCount()??0),{rowModel:t}=this.beans,n=t.isLastRowIndexKnown()?t.getRowCount():-1,i=n===-1?-1:e+n;this.comp.setRowCount(i)}registerBodyViewportResizeListener(e){this.comp.registerBodyViewportResizeListener(e)}setVerticalScrollPaddingVisible(e){const t=e?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(t)}isVerticalScrollShowing(){const e=this.gos.get("alwaysShowVerticalScroll"),t=e?zne:null,n=gi(this.gos,"normal");return this.comp.setAlwaysVerticalScrollClass(t,e),e||n&&v9e(this.eBodyViewport)}setupRowAnimationCssClass(){const{rowContainerHeight:e,environment:t}=this.beans;let n=t.sizesMeasured;const i=()=>{const r=n&&Mf(this.gos)&&!e.stretching,s=r?"ag-row-animation":"ag-row-no-animation";this.comp.setRowAnimationCssOnBodyViewport(s,r)};i(),this.addManagedEventListeners({heightScaleChanged:i}),this.addManagedPropertyListener("animateRows",i),this.addManagedEventListeners({gridStylesChanged:()=>{!n&&t.sizesMeasured&&(n=!0,i())}})}addBodyViewportListener(){const{popupSvc:e,touchSvc:t}=this.beans,n=this.onBodyViewportContextMenu.bind(this);this.addManagedElementListeners(this.eBodyViewport,{contextmenu:n}),t?.mockBodyContextMenu(this,n),this.addManagedElementListeners(this.eBodyViewport,{wheel:this.onBodyViewportWheel.bind(this,e)}),this.addManagedElementListeners(this.eStickyTop,{wheel:this.onStickyWheel.bind(this)}),this.addManagedElementListeners(this.eStickyBottom,{wheel:this.onStickyWheel.bind(this)}),this.addFullWidthContainerWheelListener()}addFullWidthContainerWheelListener(){this.addManagedElementListeners(this.eFullWidthContainer,{wheel:e=>this.onFullWidthContainerWheel(e)})}onFullWidthContainerWheel(e){const{deltaX:t,deltaY:n,shiftKey:i}=e;(i||Math.abs(t)>Math.abs(n))&&g0(this.gos,e)&&this.scrollGridBodyToMatchEvent(e)}onStickyWheel(e){const{deltaX:t,deltaY:n,shiftKey:i}=e,r=i||Math.abs(t)>Math.abs(n),s=e.target;r?(this.eStickyTopFullWidthContainer.contains(s)||this.eStickyBottomFullWidthContainer.contains(s))&&this.scrollGridBodyToMatchEvent(e):(e.preventDefault(),this.scrollVertically(n))}scrollGridBodyToMatchEvent(e){const{deltaX:t,deltaY:n}=e;e.preventDefault(),this.eCenterColsViewport.scrollBy({left:t||n})}onBodyViewportContextMenu(e,t,n){if(!e&&!n)return;this.gos.get("preventDefaultOnContextMenu")&&(e||n).preventDefault();const{target:i}=e||t;(i===this.eBodyViewport||i===this.ctrlsSvc.get("center").eViewport)&&this.beans.contextMenuSvc?.showContextMenu({mouseEvent:e,touchEvent:n,value:null,anchorToElement:this.eGridBody,source:"ui"})}onBodyViewportWheel(e,t){this.gos.get("suppressScrollWhenPopupsAreOpen")&&e?.hasAnchoredPopup()&&t.preventDefault()}scrollVertically(e){const t=this.eBodyViewport.scrollTop;return this.scrollFeature.setVerticalScrollPosition(t+e),this.eBodyViewport.scrollTop-t}setFloatingHeights(){const{pinnedRowModel:e}=this,t=e?.getPinnedTopTotalHeight()??0,n=e?.getPinnedBottomTotalHeight()??0;this.comp.setTopHeight(t),this.comp.setBottomHeight(n),this.comp.setTopInvisible(t<=0),this.comp.setBottomInvisible(n<=0),this.setStickyTopOffsetTop(),this.setStickyBottomOffsetBottom()}setStickyTopHeight(e=0){this.comp.setStickyTopHeight(`${e}px`),this.stickyTopHeight=e}setStickyBottomHeight(e=0){this.comp.setStickyBottomHeight(`${e}px`),this.stickyBottomHeight=e}setStickyWidth(e){if(!e)this.comp.setStickyTopWidth("100%"),this.comp.setStickyBottomWidth("100%");else{const t=this.scrollVisibleSvc.getScrollbarWidth();this.comp.setStickyTopWidth(`calc(100% - ${t}px)`),this.comp.setStickyBottomWidth(`calc(100% - ${t}px)`)}}setStickyTopOffsetTop(){const t=this.ctrlsSvc.get("gridHeaderCtrl").headerHeight+(this.filterManager?.getHeaderHeight()??0),n=this.pinnedRowModel?.getPinnedTopTotalHeight()??0;let i=0;t>0&&(i+=t),n>0&&(i+=n),i>0&&(i+=1),this.comp.setStickyTopTop(`${i}px`)}setStickyBottomOffsetBottom(){const{pinnedRowModel:e,scrollVisibleSvc:t,comp:n}=this,i=e?.getPinnedBottomTotalHeight()??0,s=t.horizontalScrollShowing&&t.getScrollbarWidth()||0,o=i+s;n.setStickyBottomBottom(`${o}px`)}},Hne=class extends bt{constructor(e,t){super(),this.direction=t,this.eViewport=ge,this.eContainer=ge,this.hideTimeout=0,this.setTemplate(e)}postConstruct(){this.addManagedEventListeners({scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this)}),this.onScrollVisibilityChanged(),this.addOrRemoveCssClass("ag-apple-scrollbar",Fte()||Sd())}destroy(){super.destroy(),window.clearTimeout(this.hideTimeout)}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.invisibleScrollbar=Dte(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))}addActiveListenerToggles(){const e=this.getGui(),t=()=>this.addOrRemoveCssClass("ag-scrollbar-active",!0),n=()=>this.addOrRemoveCssClass("ag-scrollbar-active",!1);this.addManagedListeners(e,{mouseenter:t,mousedown:t,touchstart:t,mouseleave:n,touchend:n})}onScrollVisibilityChanged(){this.invisibleScrollbar===void 0&&this.initialiseInvisibleScrollbar(),eu(this.beans,()=>this.setScrollVisible())}hideAndShowInvisibleScrollAsNeeded(){this.addManagedEventListeners({bodyScroll:e=>{e.direction===this.direction&&(this.hideTimeout&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=0),this.addOrRemoveCssClass("ag-scrollbar-scrolling",!0))},bodyScrollEnd:()=>{this.hideTimeout=window.setTimeout(()=>{this.addOrRemoveCssClass("ag-scrollbar-scrolling",!1),this.hideTimeout=0},400)}})}attemptSettingScrollPosition(e){const t=this.eViewport;b9e(()=>Fo(t),()=>this.setScrollPosition(e),100)}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}},_qe={tag:"div",cls:"ag-body-horizontal-scroll",attrs:{"aria-hidden":"true"},children:[{tag:"div",ref:"eLeftSpacer",cls:"ag-horizontal-left-spacer"},{tag:"div",ref:"eViewport",cls:"ag-body-horizontal-scroll-viewport",children:[{tag:"div",ref:"eContainer",cls:"ag-body-horizontal-scroll-container"}]},{tag:"div",ref:"eRightSpacer",cls:"ag-horizontal-right-spacer"}]},Oqe=class extends Hne{constructor(){super(_qe,"horizontal"),this.eLeftSpacer=ge,this.eRightSpacer=ge,this.setScrollVisibleDebounce=0}wireBeans(e){this.visibleCols=e.visibleCols,this.scrollVisibleSvc=e.scrollVisibleSvc}postConstruct(){super.postConstruct();const e=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e,pinnedRowDataChanged:this.refreshCompBottom.bind(this)}),this.addManagedPropertyListener("domLayout",e),this.beans.ctrlsSvc.register("fakeHScrollComp",this),this.createManagedBean(new SN(t=>this.eContainer.style.width=`${t}px`)),this.addManagedPropertyListeners(["suppressHorizontalScroll"],this.onScrollVisibilityChanged.bind(this))}destroy(){window.clearTimeout(this.setScrollVisibleDebounce),super.destroy()}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.enableRtl=this.gos.get("enableRtl"),super.initialiseInvisibleScrollbar(),this.invisibleScrollbar&&this.refreshCompBottom())}refreshCompBottom(){if(!this.invisibleScrollbar)return;const e=this.beans.pinnedRowModel?.getPinnedBottomTotalHeight()??0;this.getGui().style.bottom=`${e}px`}onScrollVisibilityChanged(){super.onScrollVisibilityChanged(),this.setFakeHScrollSpacerWidths()}setFakeHScrollSpacerWidths(){const e=this.scrollVisibleSvc.verticalScrollShowing;let t=this.visibleCols.getDisplayedColumnsRightWidth();const n=!this.enableRtl&&e,i=this.scrollVisibleSvc.getScrollbarWidth();n&&(t+=i),ga(this.eRightSpacer,t),this.eRightSpacer.classList.toggle("ag-scroller-corner",t<=i);let r=this.visibleCols.getColsLeftWidth();this.enableRtl&&e&&(r+=i),ga(this.eLeftSpacer,r),this.eLeftSpacer.classList.toggle("ag-scroller-corner",r<=i)}setScrollVisible(){const e=this.scrollVisibleSvc.horizontalScrollShowing,t=this.invisibleScrollbar,n=this.gos.get("suppressHorizontalScroll"),i=e&&this.scrollVisibleSvc.getScrollbarWidth()||0,s=n?0:i===0&&t?16:i,o=()=>{this.setScrollVisibleDebounce=0,this.addOrRemoveCssClass("ag-scrollbar-invisible",t),uv(this.getGui(),s),uv(this.eViewport,s),uv(this.eContainer,s),s||this.eContainer.style.setProperty("min-height","1px"),this.setVisible(e,{skipAriaHidden:!0})};window.clearTimeout(this.setScrollVisibleDebounce),e?this.setScrollVisibleDebounce=window.setTimeout(o,100):o()}getScrollPosition(){return zS(this.eViewport,this.enableRtl)}setScrollPosition(e){Fo(this.eViewport)||this.attemptSettingScrollPosition(e),HS(this.eViewport,e,this.enableRtl)}},Lqe={selector:"AG-FAKE-HORIZONTAL-SCROLL",component:Oqe},Nqe={tag:"div",cls:"ag-body-vertical-scroll",attrs:{"aria-hidden":"true"},children:[{tag:"div",ref:"eViewport",cls:"ag-body-vertical-scroll-viewport",children:[{tag:"div",ref:"eContainer",cls:"ag-body-vertical-scroll-container"}]}]},$qe=class extends Hne{constructor(){super(Nqe,"vertical")}postConstruct(){super.postConstruct(),this.createManagedBean(new Nne(this.eContainer));const{ctrlsSvc:e}=this.beans;e.register("fakeVScrollComp",this),this.addManagedEventListeners({rowContainerHeightChanged:this.onRowContainerHeightChanged.bind(this,e)})}setScrollVisible(){const{scrollVisibleSvc:e}=this.beans,t=e.verticalScrollShowing,n=this.invisibleScrollbar,i=t&&e.getScrollbarWidth()||0,r=i===0&&n?16:i;this.addOrRemoveCssClass("ag-scrollbar-invisible",n),ga(this.getGui(),r),ga(this.eViewport,r),ga(this.eContainer,r),this.setDisplayed(t,{skipAriaHidden:!0})}onRowContainerHeightChanged(e){const n=e.getGridBodyCtrl().eBodyViewport,i=this.getScrollPosition(),r=n.scrollTop;i!=r&&this.setScrollPosition(r,!0)}getScrollPosition(){return this.eViewport.scrollTop}setScrollPosition(e,t){!t&&!Fo(this.eViewport)&&this.attemptSettingScrollPosition(e),this.eViewport.scrollTop=e}},Bqe={selector:"AG-FAKE-VERTICAL-SCROLL",component:$qe};function Gqe(e){return e.cols?e.cols.treeDepth+1:-1}function la(e){return e.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0}function RN(e){const t=[],n=e.ctrlsSvc.getHeaderRowContainerCtrls();for(const i of n){if(!i)continue;const r=i.getGroupRowCount()||0;for(let s=0;s<r;s++){const o=i.getGroupRowCtrlAtIndex(s),a=t[s];if(o){const l=zqe(e,o);(a==null||l>a)&&(t[s]=l)}}}return t}function zqe(e,t){let i=e.colModel.isPivotMode()?Vqe(e):Wne(e);const r=t.getHeaderCellCtrls();for(const s of r){const{column:o}=s,a=o.getAutoHeaderHeight();a!=null&&a>i&&o.isAutoHeaderHeight()&&(i=a)}return i}function EN(e){let n=e.colModel.isPivotMode()?Hqe(e):SC(e);return e.colModel.forAllCols(i=>{const r=i.getAutoHeaderHeight();r!=null&&r>n&&i.isAutoHeaderHeight()&&(n=r)}),n}function SC(e){return e.gos.get("headerHeight")??e.environment.getDefaultHeaderHeight()}function Vne(e){return e.gos.get("floatingFiltersHeight")??SC(e)}function Wne(e){return e.gos.get("groupHeaderHeight")??SC(e)}function Hqe(e){return e.gos.get("pivotHeaderHeight")??SC(e)}function Vqe(e){return e.gos.get("pivotGroupHeaderHeight")??Wne(e)}var Wqe=class extends X{setComp(e,t,n){this.comp=e,this.eGui=t;const{beans:i}=this,{headerNavigation:r,touchSvc:s,ctrlsSvc:o}=i;r&&this.createManagedBean(new vg(n,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedEventListeners({columnPivotModeChanged:this.onPivotModeChanged.bind(this,i),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this,i)}),this.onPivotModeChanged(i),this.setupHeaderHeight();const a=this.onHeaderContextMenu.bind(this);this.addManagedElementListeners(this.eGui,{contextmenu:a}),s?.mockHeaderContextMenu(this,a),o.register("gridHeaderCtrl",this)}setupHeaderHeight(){const e=this.setHeaderHeight.bind(this);e(),this.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],e),this.addManagedEventListeners({displayedColumnsChanged:e,columnHeaderHeightChanged:e,columnGroupHeaderHeightChanged:()=>eu(this.beans,()=>e()),gridStylesChanged:e,advancedFilterEnabledChanged:e})}setHeaderHeight(){const{beans:e}=this;let t=0;const n=RN(e).reduce((s,o)=>s+o,0),i=EN(e);if(e.filterManager?.hasFloatingFilters()&&(t+=Vne(e)),t+=n,t+=i,this.headerHeight===t)return;this.headerHeight=t;const r=`${t+1}px`;this.comp.setHeightAndMinHeight(r),this.eventSvc.dispatchEvent({type:"headerHeightChanged"})}onPivotModeChanged(e){const t=e.colModel.isPivotMode();this.comp.addOrRemoveCssClass("ag-pivot-on",t),this.comp.addOrRemoveCssClass("ag-pivot-off",!t)}onDisplayedColumnsChanged(e){const n=e.visibleCols.allCols.some(i=>i.isSpanHeaderHeight());this.comp.addOrRemoveCssClass("ag-header-allow-overflow",n)}onTabKeyDown(e){const t=this.gos.get("enableRtl"),n=e.shiftKey,i=n!==t?"LEFT":"RIGHT",{beans:r}=this,{headerNavigation:s,focusSvc:o}=r;(s.navigateHorizontally(i,!0,e)||!n&&o.focusOverlay(!1)||Ap(r,n,!0))&&e.preventDefault()}handleKeyDown(e){let t=null;const{headerNavigation:n}=this.beans;switch(e.key){case K.LEFT:t="LEFT";case K.RIGHT:{me(t)||(t="RIGHT"),n.navigateHorizontally(t,!1,e)&&e.preventDefault();break}case K.UP:t="UP";case K.DOWN:{me(t)||(t="DOWN"),n.navigateVertically(t,null,e)&&e.preventDefault();break}default:return}}onFocusOut(e){const{relatedTarget:t}=e,{eGui:n,beans:i}=this;!t&&n.contains(Xt(i))||n.contains(t)||(i.focusSvc.focusedHeader=null)}onHeaderContextMenu(e,t,n){const{menuSvc:i,ctrlsSvc:r}=this.beans;if(!e&&!n||!i?.isHeaderContextMenuEnabled())return;const{target:s}=e??t;(s===this.eGui||s===r.getHeaderRowContainerCtrl()?.eViewport)&&i.showHeaderContextMenu(void 0,e,n)}},FN=class extends bt{constructor(e,t){super(e),this.ctrl=t}getCtrl(){return this.ctrl}},Uqe={tag:"div",cls:"ag-header-cell",role:"columnheader",children:[{tag:"div",ref:"eResize",cls:"ag-header-cell-resize",role:"presentation"},{tag:"div",ref:"eHeaderCompWrapper",cls:"ag-header-cell-comp-wrapper",role:"presentation"}]},jqe=class extends FN{constructor(e){super(Uqe,e),this.eResize=ge,this.eHeaderCompWrapper=ge,this.headerCompVersion=0}postConstruct(){const e=this.getGui();((r,s)=>{s!=null&&s!=""?e.setAttribute(r,s):e.removeAttribute(r)})("col-id",this.ctrl.column.getColId());const n={setWidth:r=>e.style.width=r,addOrRemoveCssClass:(r,s)=>this.addOrRemoveCssClass(r,s),setUserStyles:r=>yC(e,r),setAriaSort:r=>r?l9e(e,r):u9e(e),setUserCompDetails:r=>this.setUserCompDetails(r),getUserCompInstance:()=>this.headerComp};this.ctrl.setComp(n,this.getGui(),this.eResize,this.eHeaderCompWrapper,void 0);const i=this.ctrl.getSelectAllGui();i&&this.eResize.insertAdjacentElement("afterend",i)}destroy(){this.destroyHeaderComp(),super.destroy()}destroyHeaderComp(){this.headerComp&&(this.eHeaderCompWrapper.removeChild(this.headerCompGui),this.headerComp=this.destroyBean(this.headerComp),this.headerCompGui=void 0)}setUserCompDetails(e){this.headerCompVersion++;const t=this.headerCompVersion;e.newAgStackInstance().then(n=>this.afterCompCreated(t,n))}afterCompCreated(e,t){if(e!=this.headerCompVersion||!this.isAlive()){this.destroyBean(t);return}this.destroyHeaderComp(),this.headerComp=t,this.headerCompGui=t.getGui(),this.eHeaderCompWrapper.appendChild(this.headerCompGui),this.ctrl.setDragSource(this.getGui())}},qqe={tag:"div",cls:"ag-header-group-cell",role:"columnheader",children:[{tag:"div",ref:"eHeaderCompWrapper",cls:"ag-header-cell-comp-wrapper",role:"presentation"},{tag:"div",ref:"eResize",cls:"ag-header-cell-resize",role:"presentation"}]},Kqe=class extends FN{constructor(e){super(qqe,e),this.eResize=ge,this.eHeaderCompWrapper=ge}postConstruct(){const e=this.getGui(),t=(i,r)=>r!=null?e.setAttribute(i,r):e.removeAttribute(i);e.setAttribute("col-id",this.ctrl.column.getUniqueId());const n={addOrRemoveCssClass:(i,r)=>this.addOrRemoveCssClass(i,r),setUserStyles:i=>yC(e,i),setHeaderWrapperHidden:i=>{i?this.eHeaderCompWrapper.style.setProperty("display","none"):this.eHeaderCompWrapper.style.removeProperty("display")},setHeaderWrapperMaxHeight:i=>{i!=null?this.eHeaderCompWrapper.style.setProperty("max-height",`${i}px`):this.eHeaderCompWrapper.style.removeProperty("max-height"),this.eHeaderCompWrapper.classList.toggle("ag-header-cell-comp-wrapper-limited-height",i!=null)},setResizableDisplayed:i=>Yt(this.eResize,i),setWidth:i=>e.style.width=i,setAriaExpanded:i=>t("aria-expanded",i),setUserCompDetails:i=>this.setUserCompDetails(i),getUserCompInstance:()=>this.headerGroupComp};this.ctrl.setComp(n,e,this.eResize,this.eHeaderCompWrapper,void 0)}setUserCompDetails(e){e.newAgStackInstance().then(t=>this.afterHeaderCompCreated(t))}afterHeaderCompCreated(e){const t=()=>this.destroyBean(e);if(!this.isAlive()){t();return}const n=this.getGui(),i=e.getGui();this.eHeaderCompWrapper.appendChild(i),this.addDestroyFunc(t),this.headerGroupComp=e,this.ctrl.setDragSource(n)}addOrRemoveHeaderWrapperStyle(e,t){const{eHeaderCompWrapper:n}=this;t?n.style.setProperty(e,t):n.style.removeProperty(e)}},Yqe={tag:"div",cls:"ag-header-cell ag-floating-filter",role:"gridcell",children:[{tag:"div",ref:"eFloatingFilterBody",role:"presentation"},{tag:"div",ref:"eButtonWrapper",cls:"ag-floating-filter-button ag-hidden",role:"presentation",children:[{tag:"button",ref:"eButtonShowMainFilter",cls:"ag-button ag-floating-filter-button-button",attrs:{type:"button",tabindex:"-1"}}]}]},Xqe=class extends FN{constructor(e){super(Yqe,e),this.eFloatingFilterBody=ge,this.eButtonWrapper=ge,this.eButtonShowMainFilter=ge}postConstruct(){const e=this.getGui(),t={addOrRemoveCssClass:(n,i)=>this.addOrRemoveCssClass(n,i),setUserStyles:n=>yC(e,n),addOrRemoveBodyCssClass:(n,i)=>this.eFloatingFilterBody.classList.toggle(n,i),setButtonWrapperDisplayed:n=>Yt(this.eButtonWrapper,n),setCompDetails:n=>this.setCompDetails(n),getFloatingFilterComp:()=>this.compPromise,setWidth:n=>e.style.width=n,setMenuIcon:n=>this.eButtonShowMainFilter.appendChild(n)};this.ctrl.setComp(t,e,this.eButtonShowMainFilter,this.eFloatingFilterBody,void 0)}setCompDetails(e){if(!e){this.destroyFloatingFilterComp(),this.compPromise=null;return}this.compPromise=e.newAgStackInstance(),this.compPromise.then(t=>this.afterCompCreated(t))}destroy(){this.destroyFloatingFilterComp(),super.destroy()}destroyFloatingFilterComp(){this.floatingFilterComp&&(this.eFloatingFilterBody.removeChild(this.floatingFilterComp.getGui()),this.floatingFilterComp=this.destroyBean(this.floatingFilterComp))}afterCompCreated(e){if(e){if(!this.isAlive()){this.destroyBean(e);return}this.destroyFloatingFilterComp(),this.floatingFilterComp=e,this.eFloatingFilterBody.appendChild(e.getGui()),e.afterGuiAttached&&e.afterGuiAttached()}}},Qqe=class extends bt{constructor(e){super({tag:"div",cls:e.headerRowClass,role:"row"}),this.ctrl=e,this.headerComps={}}postConstruct(){oN(this.getGui(),this.ctrl.getAriaRowIndex());const e={setHeight:t=>this.getGui().style.height=t,setTop:t=>this.getGui().style.top=t,setHeaderCtrls:(t,n)=>this.setHeaderCtrls(t,n),setWidth:t=>this.getGui().style.width=t};this.ctrl.setComp(e,void 0)}destroy(){this.setHeaderCtrls([],!1),super.destroy()}setHeaderCtrls(e,t){if(!this.isAlive())return;const n=this.headerComps;if(this.headerComps={},e.forEach(i=>{const r=i.instanceId;let s=n[r];delete n[r],s==null&&(s=this.createHeaderComp(i),this.getGui().appendChild(s.getGui())),this.headerComps[r]=s}),Object.values(n).forEach(i=>{this.getGui().removeChild(i.getGui()),this.destroyBean(i)}),t){const i=Object.values(this.headerComps);i.sort((s,o)=>{const a=s.getCtrl().column.getLeft(),l=o.getCtrl().column.getLeft();return a-l});const r=i.map(s=>s.getGui());_te(this.getGui(),r)}}createHeaderComp(e){let t;switch(this.ctrl.type){case"group":t=new Kqe(e);break;case"filter":t=new Xqe(e);break;default:t=new jqe(e);break}return this.createBean(t),t.setParentComponent(this),t}},AN=class extends X{constructor(e,t,n,i){super(),this.columnOrGroup=e,this.eCell=t,this.colsSpanning=i,this.columnOrGroup=e,this.ariaEl=t.querySelector("[role=columnheader]")||t,this.beans=n}setColsSpanning(e){this.colsSpanning=e,this.onLeftChanged()}getColumnOrGroup(){const{beans:e,colsSpanning:t}=this;return e.gos.get("enableRtl")&&t?Tt(t):this.columnOrGroup}postConstruct(){const e=this.onLeftChanged.bind(this);this.addManagedListeners(this.columnOrGroup,{leftChanged:e}),this.setLeftFirstTime(),this.addManagedEventListeners({displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}setLeftFirstTime(){const{gos:e,colAnimation:t}=this.beans,n=e.get("suppressColumnMoveAnimation"),i=me(this.columnOrGroup.getOldLeft());t?.isActive()&&i&&!n?this.animateInLeft():this.onLeftChanged()}animateInLeft(){const e=this.getColumnOrGroup(),t=this.modifyLeftForPrintLayout(e,e.getOldLeft()),n=this.modifyLeftForPrintLayout(e,e.getLeft());this.setLeft(t),this.actualLeft=n,this.beans.colAnimation.executeNextVMTurn(()=>{this.actualLeft===n&&this.setLeft(n)})}onLeftChanged(){const e=this.getColumnOrGroup(),t=e.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(e,t),this.setLeft(this.actualLeft)}modifyLeftForPrintLayout(e,t){const{gos:n,visibleCols:i}=this.beans;if(!gi(n,"print")||e.getPinned()==="left")return t;const s=i.getColsLeftWidth();if(e.getPinned()==="right"){const o=i.bodyWidth;return s+o+t}return s+t}setLeft(e){if(me(e)&&(this.eCell.style.left=`${e}px`),on(this.columnOrGroup)){const t=this.columnOrGroup.getLeafColumns();if(!t.length)return;t.length>1&&a9e(this.ariaEl,t.length)}}},Jqe=0,Une="headerCtrl",DN=class extends X{constructor(e,t){super(),this.column=e,this.rowCtrl=t,this.resizeToggleTimeout=0,this.resizeMultiplier=1,this.resizeFeature=null,this.lastFocusEvent=null,this.dragSource=null,this.instanceId=e.getUniqueId()+"-"+Jqe++}postConstruct(){const e=this.refreshTabIndex.bind(this);this.addManagedPropertyListeners(["suppressHeaderFocus"],e),this.addManagedEventListeners({overlayExclusiveChanged:e})}shouldStopEventPropagation(e){const{headerRowIndex:t,column:n}=this.beans.focusSvc.focusedHeader,i=n.getDefinition(),r=i&&i.suppressHeaderKeyboardEvent;if(!me(r))return!1;const s=Ne(this.gos,{colDef:i,column:n,headerRowIndex:t,event:e});return!!r(s)}getWrapperHasFocus(){return Xt(this.beans)===this.eGui}setGui(e,t){this.eGui=e,this.addDomData(t),t.addManagedListeners(this.beans.eventSvc,{displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this)}),t.addManagedElementListeners(this.eGui,{focus:this.onGuiFocus.bind(this)}),this.onDisplayedColumnsChanged(),this.refreshTabIndex()}refreshHeaderStyles(){const e=this.column.getDefinition();if(!e)return;const{headerStyle:t}=e;let n;if(typeof t=="function"){const i=this.getHeaderClassParams();n=t(i)}else n=t;n&&this.comp.setUserStyles(n)}onGuiFocus(){this.eventSvc.dispatchEvent({type:"headerFocused",column:this.column})}setupAutoHeight(e){const{wrapperElement:t,checkMeasuringCallback:n,compBean:i}=e,{beans:r}=this,s=d=>{if(!this.isAlive()||!i.isAlive())return;const{paddingTop:h,paddingBottom:p,borderBottomWidth:g,borderTopWidth:v}=bh(this.eGui),C=h+p+g+v,b=t.offsetHeight+C;if(d<5){const S=Rn(r),x=!S||!S.contains(t),E=b==0;if(x||E){FT(()=>s(d+1),"raf",r);return}}this.setColHeaderHeight(this.column,b)};let o=!1,a;const l=()=>{const d=this.column.isAutoHeaderHeight();d&&!o&&u(),!d&&o&&c()},u=()=>{o=!0,s(0),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!0),a=Pc(this.beans,t,()=>s(0))},c=()=>{o=!1,a&&a(),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!1),a=void 0};l(),i.addDestroyFunc(()=>c()),i.addManagedListeners(this.column,{widthChanged:()=>o&&s(0)}),i.addManagedEventListeners({sortChanged:()=>{o&&window.setTimeout(()=>s(0))}}),n&&n(l)}onDisplayedColumnsChanged(){const{comp:e,column:t,beans:n,eGui:i}=this;!e||!t||!i||(bne(e,t,n.visibleCols),Rte(i,n.visibleCols.getAriaColIndex(t)))}addResizeAndMoveKeyboardListeners(e){e.addManagedListeners(this.eGui,{keydown:this.onGuiKeyDown.bind(this),keyup:this.onGuiKeyUp.bind(this)})}refreshTabIndex(){const e=Ad(this.beans);this.eGui&&ks(this.eGui,"tabindex",e?null:"-1")}onGuiKeyDown(e){const t=Xt(this.beans),n=e.key===K.LEFT||e.key===K.RIGHT;if(this.isResizing&&(e.preventDefault(),e.stopImmediatePropagation()),t!==this.eGui||!e.shiftKey&&!e.altKey||((this.isResizing||n)&&(e.preventDefault(),e.stopImmediatePropagation()),!n))return;const r=e.key===K.LEFT!==this.gos.get("enableRtl")?"left":"right";if(e.altKey){this.isResizing=!0,this.resizeMultiplier+=1;const s=this.getViewportAdjustedResizeDiff(e);this.resizeHeader(s,e.shiftKey),this.resizeFeature?.toggleColumnResizing(!0)}else this.moveHeader(r)}moveHeader(e){this.beans.colMoves?.moveHeader(e,this.eGui,this.column,this.rowCtrl.pinned,this)}getViewportAdjustedResizeDiff(e){const t=this.getResizeDiff(e),{pinnedCols:n}=this.beans;return n?n.getHeaderResizeDiff(t,this.column):t}getResizeDiff(e){const{gos:t,column:n}=this;let i=e.key===K.LEFT!==t.get("enableRtl");const r=n.getPinned(),s=t.get("enableRtl");return r&&s!==(r==="right")&&(i=!i),(i?-1:1)*this.resizeMultiplier}onGuiKeyUp(){this.isResizing&&(this.resizeToggleTimeout&&(window.clearTimeout(this.resizeToggleTimeout),this.resizeToggleTimeout=0),this.isResizing=!1,this.resizeMultiplier=1,this.resizeToggleTimeout=window.setTimeout(()=>{this.resizeFeature?.toggleColumnResizing(!1)},150))}handleKeyDown(e){const t=this.getWrapperHasFocus();switch(e.key){case K.PAGE_DOWN:case K.PAGE_UP:case K.PAGE_HOME:case K.PAGE_END:t&&e.preventDefault()}}addDomData(e){const t=Une,{eGui:n,gos:i}=this;Zd(i,n,t,this),e.addDestroyFunc(()=>Zd(i,n,t,null))}focus(e){const{eGui:t}=this;return t?(this.lastFocusEvent=e||null,t.focus(),!0):!1}focusThis(){this.beans.focusSvc.focusedHeader={headerRowIndex:this.rowCtrl.rowIndex,column:this.column}}removeDragSource(){this.dragSource&&(this.beans.dragAndDrop?.removeDragSource(this.dragSource),this.dragSource=null)}handleContextMenuMouseEvent(e,t,n){const i=e??t,{menuSvc:r,gos:s}=this.beans;s.get("preventDefaultOnContextMenu")&&i.preventDefault(),r?.isHeaderContextMenuEnabled(n)&&r.showHeaderContextMenu(n,e,t),this.dispatchColumnMouseEvent("columnHeaderContextMenu",n)}dispatchColumnMouseEvent(e,t){this.eventSvc.dispatchEvent({type:e,column:t})}setColHeaderHeight(e,t){if(!e.setAutoHeaderHeight(t))return;const{eventSvc:n}=this;e.isColumn?n.dispatchEvent({type:"columnHeaderHeightChanged",column:e,columns:[e],source:"autosizeColumnHeaderHeight"}):n.dispatchEvent({type:"columnGroupHeaderHeightChanged",columnGroup:e,source:"autosizeColumnGroupHeaderHeight"})}clearComponent(){this.removeDragSource(),this.resizeFeature=null,this.comp=null,this.eGui=null}destroy(){super.destroy(),this.column=null,this.lastFocusEvent=null,this.rowCtrl=null}},Zqe=class extends DN{constructor(){super(...arguments),this.refreshFunctions={},this.userHeaderClasses=new Set,this.ariaDescriptionProperties=new Map}setComp(e,t,n,i,r){this.comp=e;const{rowCtrl:s,column:o,beans:a}=this,{colResize:l,context:u,colHover:c,rangeSvc:d}=a,h=wC(this,u,r);this.setGui(t,h),this.updateState(),this.setupWidth(h),this.setupMovingCss(h),this.setupMenuClass(h),this.setupSortableClass(h),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight({wrapperElement:i,checkMeasuringCallback:g=>this.setRefreshFunction("measuring",g),compBean:h}),this.addColumnHoverListener(h),this.setupFilterClass(h),this.setupStylesFromColDef(),this.setupClassesFromColDef(),this.setupTooltip(),this.addActiveHeaderMouseListeners(h),this.setupSelectAll(h),this.setupUserComp(),this.refreshAria(),l?this.resizeFeature=h.createManagedBean(l.createResizeFeature(s.pinned,o,n,e,this)):Yt(n,!1),c?.createHoverFeature(h,[o],t),d?.createRangeHighlightFeature(h,o,e),h.createManagedBean(new AN(o,t,a)),h.createManagedBean(new vg(t,{shouldStopEventPropagation:g=>this.shouldStopEventPropagation(g),onTabKeyDown:()=>null,handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addResizeAndMoveKeyboardListeners(h),h.addManagedPropertyListeners(["suppressMovableColumns","suppressMenuHide","suppressAggFuncInHeader","enableAdvancedFilter"],()=>this.refresh()),h.addManagedListeners(o,{colDefChanged:()=>this.refresh()}),h.addManagedListeners(o,{headerHighlightChanged:this.onHeaderHighlightChanged.bind(this)});const p=()=>this.checkDisplayName();h.addManagedEventListeners({columnValueChanged:p,columnRowGroupChanged:p,columnPivotChanged:p,headerHeightChanged:this.onHeaderHeightChanged.bind(this)}),h.addDestroyFunc(()=>{this.refreshFunctions={},this.selectAllFeature=null,this.dragSourceElement=void 0,this.userCompDetails=null,this.userHeaderClasses.clear(),this.ariaDescriptionProperties.clear(),this.clearComponent()})}resizeHeader(e,t){this.beans.colResize?.resizeHeader(this.column,e,t)}getHeaderClassParams(){const{column:e,beans:t}=this,n=e.colDef;return Ne(t.gos,{colDef:n,column:e,floatingFilter:!1})}setupUserComp(){const e=this.lookupUserCompDetails();e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setUserCompDetails(e)}lookupUserCompDetails(){const e=this.createParams(),t=this.column.getColDef();return U7e(this.beans.userCompFactory,t,e)}createParams(){const{menuSvc:e,sortSvc:t,colFilter:n,gos:i}=this.beans;return Ne(i,{column:this.column,displayName:this.displayName,enableSorting:this.column.isSortable(),enableMenu:this.menuEnabled,enableFilterButton:this.openFilterEnabled&&!!e?.isHeaderFilterButtonEnabled(this.column),enableFilterIcon:!!n&&(!this.openFilterEnabled||Ur(this.gos)),showColumnMenu:(s,o)=>{e?.showColumnMenu({column:this.column,buttonElement:s,positionBy:"button",onClosedCallback:o})},showColumnMenuAfterMouseClick:(s,o)=>{e?.showColumnMenu({column:this.column,mouseEvent:s,positionBy:"mouse",onClosedCallback:o})},showFilter:s=>{e?.showFilterMenu({column:this.column,buttonElement:s,containerType:"columnFilter",positionBy:"button"})},progressSort:s=>{t?.progressSort(this.column,!!s,"uiColumnSorted")},setSort:(s,o)=>{t?.setSortForColumn(this.column,s,!!o,"uiColumnSorted")},eGridHeader:this.eGui,setTooltip:(s,o)=>{i.assertModuleRegistered("Tooltip",3),this.setupTooltip(s,o)}})}setupSelectAll(e){const{selectionSvc:t}=this.beans;t&&(this.selectAllFeature=e.createManagedBean(t.createSelectAllFeature(this.column)),this.selectAllFeature.setComp(this))}getSelectAllGui(){return this.selectAllFeature?.getCheckboxGui()}handleKeyDown(e){super.handleKeyDown(e),e.key===K.SPACE&&this.selectAllFeature?.onSpaceKeyDown(e),e.key===K.ENTER&&this.onEnterKeyDown(e),e.key===K.DOWN&&e.altKey&&this.showMenuOnKeyPress(e,!1)}onEnterKeyDown(e){e.ctrlKey||e.metaKey?this.showMenuOnKeyPress(e,!0):this.sortable&&this.beans.sortSvc?.progressSort(this.column,e.shiftKey,"uiColumnSorted")}showMenuOnKeyPress(e,t){const n=this.comp.getUserCompInstance();aW(n)&&n.onMenuKeyboardShortcut(t)&&e.preventDefault()}onFocusIn(e){this.eGui.contains(e.relatedTarget)||(this.focusThis(),this.announceAriaDescription()),Rje()&&this.setActiveHeader(!0)}onFocusOut(e){this.eGui.contains(e.relatedTarget)||this.setActiveHeader(!1)}setupTooltip(e,t){this.tooltipFeature=this.beans.tooltipSvc?.setupHeaderTooltip(this.tooltipFeature,this,e,t)}setupStylesFromColDef(){this.setRefreshFunction("headerStyles",this.refreshHeaderStyles.bind(this)),this.refreshHeaderStyles()}setupClassesFromColDef(){const e=()=>{const t=this.column.getColDef(),n=wne(t,this.gos,this.column,null),i=this.userHeaderClasses;this.userHeaderClasses=new Set(n),n.forEach(r=>{i.has(r)?i.delete(r):this.comp.addOrRemoveCssClass(r,!0)}),i.forEach(r=>this.comp.addOrRemoveCssClass(r,!1))};this.setRefreshFunction("headerClasses",e),e()}setDragSource(e){this.dragSourceElement=e,this.removeDragSource(),!(!e||!this.draggable)&&(this.dragSource=this.beans.colMoves?.setDragSourceForHeader(e,this.column,this.displayName)??null)}updateState(){const{menuSvc:e}=this.beans;this.menuEnabled=!!e?.isColumnMenuInHeaderEnabled(this.column),this.openFilterEnabled=!!e?.isFilterMenuInHeaderEnabled(this.column),this.sortable=this.column.isSortable(),this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()}setRefreshFunction(e,t){this.refreshFunctions[e]=t}refresh(){this.updateState(),this.refreshHeaderComp(),this.refreshAria(),Object.values(this.refreshFunctions).forEach(e=>e())}refreshHeaderComp(){const e=this.lookupUserCompDetails();if(!e)return;(this.comp.getUserCompInstance()!=null&&this.userCompDetails.componentClass==e.componentClass?this.attemptHeaderCompRefresh(e.params):!1)?this.setDragSource(this.dragSourceElement):this.setCompDetails(e)}attemptHeaderCompRefresh(e){const t=this.comp.getUserCompInstance();return!t||!t.refresh?!1:t.refresh(e)}calculateDisplayName(){return this.beans.colNames.getDisplayNameForColumn(this.column,"header",!0)}checkDisplayName(){this.displayName!==this.calculateDisplayName()&&this.refresh()}workOutDraggable(){const e=this.column.getColDef();return!!(!this.gos.get("suppressMovableColumns")&&!e.suppressMovable&&!e.lockPosition)||!!e.enableRowGroup||!!e.enablePivot}setupWidth(e){const t=()=>{const n=this.column.getActualWidth();this.comp.setWidth(`${n}px`)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupMovingCss(e){const t=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-moving",this.column.isMoving())};e.addManagedListeners(this.column,{movingChanged:t}),t()}setupMenuClass(e){const t=()=>{this.comp?.addOrRemoveCssClass("ag-column-menu-visible",this.column.isMenuVisible())};e.addManagedListeners(this.column,{menuVisibleChanged:t}),t()}setupSortableClass(e){const t=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-sortable",!!this.sortable)};t(),this.setRefreshFunction("updateSortable",t),e.addManagedEventListeners({sortChanged:this.refreshAriaSort.bind(this)})}setupFilterClass(e){const t=()=>{const n=this.column.isFilterActive();this.comp.addOrRemoveCssClass("ag-header-cell-filtered",n),this.refreshAria()};e.addManagedListeners(this.column,{filterActiveChanged:t}),t()}setupWrapTextClass(){const e=()=>{const t=!!this.column.getColDef().wrapHeaderText;this.comp.addOrRemoveCssClass("ag-header-cell-wrap-text",t)};e(),this.setRefreshFunction("wrapText",e)}onHeaderHighlightChanged(){const e=this.column.getHighlighted(),t=e===0,n=e===1;this.comp.addOrRemoveCssClass("ag-header-highlight-before",t),this.comp.addOrRemoveCssClass("ag-header-highlight-after",n)}onDisplayedColumnsChanged(){super.onDisplayedColumnsChanged(),this.isAlive()&&this.onHeaderHeightChanged()}onHeaderHeightChanged(){this.refreshSpanHeaderHeight()}refreshSpanHeaderHeight(){const{eGui:e,column:t,comp:n,beans:i}=this,r=RN(this.beans),s=r.reduce((c,d)=>c+=d,0)===0;if(n.addOrRemoveCssClass("ag-header-parent-hidden",s),!t.isSpanHeaderHeight()){e.style.removeProperty("top"),e.style.removeProperty("height"),n.addOrRemoveCssClass("ag-header-span-height",!1),n.addOrRemoveCssClass("ag-header-span-total",!1);return}const{numberOfParents:o,isSpanningTotal:a}=this.column.getColumnGroupPaddingInfo();n.addOrRemoveCssClass("ag-header-span-height",o>0);const l=EN(i);if(o===0){n.addOrRemoveCssClass("ag-header-span-total",!1),e.style.setProperty("top","0px"),e.style.setProperty("height",`${l}px`);return}n.addOrRemoveCssClass("ag-header-span-total",a);let u=0;for(let c=0;c<o;c++)u+=r[r.length-1-c];e.style.setProperty("top",`${-u}px`),e.style.setProperty("height",`${l+u}px`)}refreshAriaSort(){if(this.sortable){const e=this.getLocaleTextFunc(),t=this.beans.sortSvc?.getDisplaySortForColumn(this.column)||null;this.comp.setAriaSort(XUe(t)),this.setAriaDescriptionProperty("sort",e("ariaSortableColumn","Press ENTER to sort"))}else this.comp.setAriaSort(),this.setAriaDescriptionProperty("sort",null)}refreshAriaMenu(){if(this.menuEnabled){const e=this.getLocaleTextFunc();this.setAriaDescriptionProperty("menu",e("ariaMenuColumn","Press ALT DOWN to open column menu"))}else this.setAriaDescriptionProperty("menu",null)}refreshAriaFilterButton(){if(this.openFilterEnabled&&!Ur(this.gos)){const e=this.getLocaleTextFunc();this.setAriaDescriptionProperty("filterButton",e("ariaFilterColumn","Press CTRL ENTER to open filter"))}else this.setAriaDescriptionProperty("filterButton",null)}refreshAriaFiltered(){const e=this.getLocaleTextFunc();this.column.isFilterActive()?this.setAriaDescriptionProperty("filter",e("ariaColumnFiltered","Column Filtered")):this.setAriaDescriptionProperty("filter",null)}setAriaDescriptionProperty(e,t){t!=null?this.ariaDescriptionProperties.set(e,t):this.ariaDescriptionProperties.delete(e)}announceAriaDescription(){if(!this.eGui.contains(Xt(this.beans)))return;const e=Array.from(this.ariaDescriptionProperties.keys()).sort((t,n)=>t==="filter"?-1:n.charCodeAt(0)-t.charCodeAt(0)).map(t=>this.ariaDescriptionProperties.get(t)).join(". ");this.beans.ariaAnnounce?.announceValue(e,"columnHeader")}refreshAria(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaFilterButton(),this.refreshAriaFiltered()}addColumnHoverListener(e){this.beans.colHover?.addHeaderColumnHoverListener(e,this.comp,this.column)}addActiveHeaderMouseListeners(e){const t=r=>this.handleMouseOverChange(r.type==="mouseenter"),n=()=>{this.setActiveHeader(!0),this.dispatchColumnMouseEvent("columnHeaderClicked",this.column)},i=r=>this.handleContextMenuMouseEvent(r,void 0,this.column);e.addManagedListeners(this.eGui,{mouseenter:t,mouseleave:t,click:n,contextmenu:i})}handleMouseOverChange(e){this.setActiveHeader(e),this.eventSvc.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column})}setActiveHeader(e){this.comp.addOrRemoveCssClass("ag-header-active",e)}getAnchorElementForMenu(e){const t=this.comp.getUserCompInstance();return aW(t)?t.getAnchorElementForMenu(e):this.eGui}destroy(){this.tooltipFeature=this.destroyBean(this.tooltipFeature),super.destroy()}};function aW(e){return typeof e.getAnchorElementForMenu=="function"&&typeof e.onMenuKeyboardShortcut=="function"}var eKe=0,FD=class extends X{constructor(e,t,n){super(),this.rowIndex=e,this.pinned=t,this.type=n,this.instanceId=eKe++,this.allCtrls=[];const i=n=="group"?"ag-header-row-column-group":n=="filter"?"ag-header-row-column-filter":"ag-header-row-column";this.headerRowClass=`ag-header-row ${i}`}postConstruct(){this.isPrintLayout=gi(this.gos,"print"),this.isEnsureDomOrder=this.gos.get("ensureDomOrder")}areCellsRendered(){return this.comp?this.allCtrls.every(e=>e.eGui!=null):!1}setComp(e,t,n=!0){this.comp=e,t=wC(this,this.beans.context,t),n&&(this.onRowHeightChanged(),this.onVirtualColumnsChanged()),this.setWidth(),this.addEventListeners(t)}getAriaRowIndex(){return this.rowIndex+1}addEventListeners(e){const t=this.onRowHeightChanged.bind(this),n=this.onDisplayedColumnsChanged.bind(this);e.addManagedEventListeners({columnResized:this.setWidth.bind(this),displayedColumnsChanged:n,virtualColumnsChanged:i=>this.onVirtualColumnsChanged(i.afterScroll),columnGroupHeaderHeightChanged:t,columnHeaderHeightChanged:t,gridStylesChanged:t,advancedFilterEnabledChanged:t}),e.addManagedPropertyListener("domLayout",n),e.addManagedPropertyListener("ensureDomOrder",i=>this.isEnsureDomOrder=i.currentValue),e.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],t)}onDisplayedColumnsChanged(){this.isPrintLayout=gi(this.gos,"print"),this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()}setWidth(){const e=this.getWidthForRow();this.comp.setWidth(`${e}px`)}getWidthForRow(){const{visibleCols:e}=this.beans;return this.isPrintLayout?this.pinned!=null?0:e.getContainerWidth("right")+e.getContainerWidth("left")+e.getContainerWidth(null):e.getContainerWidth(this.pinned)}onRowHeightChanged(){const{topOffset:e,rowHeight:t}=this.getTopAndHeight();this.comp.setTop(e+"px"),this.comp.setHeight(t+"px")}getTopAndHeight(){const{filterManager:e}=this.beans,t=[],n=RN(this.beans),i=EN(this.beans);t.push(...n),t.push(i),e?.hasFloatingFilters()&&t.push(Vne(this.beans));let r=0;for(let o=0;o<this.rowIndex;o++)r+=t[o];const s=t[this.rowIndex];return{topOffset:r,rowHeight:s}}onVirtualColumnsChanged(e=!1){const t=this.getUpdatedHeaderCtrls(),n=this.isEnsureDomOrder||this.isPrintLayout;this.comp.setHeaderCtrls(t,n,e)}getUpdatedHeaderCtrls(){const e=this.ctrlsById;this.ctrlsById=new Map;const t=this.getColumnsInViewport();for(const i of t)this.recycleAndCreateHeaderCtrls(i,this.ctrlsById,e);const n=i=>{const{focusSvc:r,visibleCols:s}=this.beans;return r.isHeaderWrapperFocused(i)?s.isVisible(i.column):!1};if(e)for(const[i,r]of e)n(r)?this.ctrlsById.set(i,r):this.destroyBean(r);return this.allCtrls=Array.from(this.ctrlsById.values()),this.allCtrls}getHeaderCellCtrls(){return this.allCtrls}recycleAndCreateHeaderCtrls(e,t,n){if(e.isEmptyGroup())return;const i=e.getUniqueId();let r;if(n&&(r=n.get(i),n.delete(i)),r&&r.column!=e&&(this.destroyBean(r),r=void 0),r==null)switch(this.type){case"filter":{r=this.createBean(this.beans.registry.createDynamicBean("headerFilterCellCtrl",!0,e,this));break}case"group":r=this.createBean(this.beans.registry.createDynamicBean("headerGroupCellCtrl",!0,e,this));break;default:r=this.createBean(new Zqe(e,this));break}t.set(i,r)}getColumnsInViewport(){return this.isPrintLayout?this.getColumnsInViewportPrintLayout():this.getColumnsInViewportNormalLayout()}getColumnsInViewportPrintLayout(){if(this.pinned!=null)return[];let e=[];const t=this.getActualDepth(),{colViewport:n}=this.beans;return["left",null,"right"].forEach(i=>{const r=n.getHeadersToRender(i,t);e=e.concat(r)}),e}getActualDepth(){return this.type=="filter"?this.rowIndex-1:this.rowIndex}getColumnsInViewportNormalLayout(){return this.beans.colViewport.getHeadersToRender(this.pinned,this.getActualDepth())}focusHeader(e,t){const n=this.allCtrls.find(r=>r.column==e);return n?n.focus(t):!1}destroy(){this.allCtrls=this.destroyBeans(this.allCtrls),this.ctrlsById=void 0,super.destroy()}},tKe=class extends X{constructor(e){super(),this.pinned=e,this.hidden=!1,this.includeFloatingFilter=!1,this.groupsRowCtrls=[]}setComp(e,t){this.comp=e,this.eViewport=t;const{pinnedCols:n,ctrlsSvc:i,colModel:r,colMoves:s,filterManager:o}=this.beans;this.setupCenterWidth(),n?.setupHeaderPinnedWidth(this),this.setupDragAndDrop(s,this.eViewport);const a=this.onDisplayedColumnsChanged.bind(this,o);this.addManagedEventListeners({gridColumnsChanged:this.onGridColumnsChanged.bind(this),displayedColumnsChanged:a,advancedFilterEnabledChanged:a});const l=`${typeof this.pinned=="string"?this.pinned:"center"}Header`;i.register(l,this),r.ready&&this.refresh()}getAllCtrls(){const e=[...this.groupsRowCtrls];return this.columnsRowCtrl&&e.push(this.columnsRowCtrl),this.filtersRowCtrl&&e.push(this.filtersRowCtrl),e}refresh(e=!1){const{focusSvc:t,colModel:n,filterManager:i}=this.beans;let r=0;const s=t.getFocusHeaderToUseAfterRefresh(),o=()=>{const c=Gqe(n)-1;this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls);for(let d=0;d<c;d++){const h=this.createBean(new FD(r++,this.pinned,"group"));this.groupsRowCtrls.push(h)}},a=()=>{const c=r++,d=!this.hidden&&(this.columnsRowCtrl==null||!e||this.columnsRowCtrl.rowIndex!==c);(d||this.hidden)&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),d&&(this.columnsRowCtrl=this.createBean(new FD(c,this.pinned,"column")))},l=()=>{this.includeFloatingFilter=!!i?.hasFloatingFilters()&&!this.hidden;const c=()=>{this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)};if(!this.includeFloatingFilter){c();return}const d=r++;if(this.filtersRowCtrl){const h=this.filtersRowCtrl.rowIndex!==d;(!e||h)&&c()}this.filtersRowCtrl||(this.filtersRowCtrl=this.createBean(new FD(d,this.pinned,"filter")))};o(),a(),l();const u=this.getAllCtrls();this.comp.setCtrls(u),this.restoreFocusOnHeader(t,s)}getHeaderCtrlForColumn(e){const t=n=>n?.getHeaderCellCtrls().find(i=>i.column===e);if(lc(e))return t(this.columnsRowCtrl);if(this.groupsRowCtrls.length!==0)for(let n=0;n<this.groupsRowCtrls.length;n++){const i=t(this.groupsRowCtrls[n]);if(i)return i}}getHtmlElementForColumnHeader(e){return this.getHeaderCtrlForColumn(e)?.eGui??null}getRowType(e){return this.getAllCtrls()[e]?.type}focusHeader(e,t,n){const r=this.getAllCtrls()[e];return r?r.focusHeader(t,n):!1}getGroupRowCount(){return this.groupsRowCtrls.length}getGroupRowCtrlAtIndex(e){return this.groupsRowCtrls[e]}getRowCount(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)}setHorizontalScroll(e){this.comp.setViewportScrollLeft(e)}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}destroy(){this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl),this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl),this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls),super.destroy()}setupDragAndDrop(e,t){const n=e?.createBodyDropTarget(this.pinned,t);n&&this.createManagedBean(n)}restoreFocusOnHeader(e,t){if(!t)return;const{column:n}=t;n.getPinned()==this.pinned&&e.focusHeaderPosition({headerPosition:t})}onGridColumnsChanged(){this.refresh(!0)}onDisplayedColumnsChanged(e){const t=!!e?.hasFloatingFilters()&&!this.hidden;this.includeFloatingFilter!==t&&this.refresh(!0)}setupCenterWidth(){this.pinned==null&&this.createManagedBean(new SN(e=>this.comp.setCenterWidth(`${e}px`),!0))}},nKe=class extends X{constructor(){super(...arguments),this.beanName="menuSvc"}postConstruct(){const{enterpriseMenuFactory:e,filterMenuFactory:t}=this.beans;this.activeMenuFactory=e??t}showColumnMenu(e){this.showColumnMenuCommon(this.activeMenuFactory,e,"columnMenu")}showFilterMenu(e){const{enterpriseMenuFactory:t,filterMenuFactory:n}=this.beans,i=t&&Ur(this.gos)?t:n;this.showColumnMenuCommon(i,e,e.containerType,!0)}showHeaderContextMenu(e,t,n){this.activeMenuFactory?.showMenuAfterContextMenuEvent(e,t,n)}hidePopupMenu(){this.beans.contextMenuSvc?.hideActiveMenu(),this.activeMenuFactory?.hideActiveMenu()}isColumnMenuInHeaderEnabled(e){const{suppressHeaderMenuButton:t}=e.getColDef();return!t&&!!this.activeMenuFactory?.isMenuEnabled(e)&&(Ur(this.gos)||!!this.beans.enterpriseMenuFactory)}isFilterMenuInHeaderEnabled(e){return!e.getColDef().suppressHeaderFilterButton&&!!this.beans.filterManager?.isFilterAllowed(e)}isHeaderContextMenuEnabled(e){return!(e&&lc(e)?e.getColDef():e?.getColGroupDef())?.suppressHeaderContextMenu&&this.gos.get("columnMenu")==="new"}isHeaderMenuButtonAlwaysShowEnabled(){return this.isSuppressMenuHide()}isHeaderMenuButtonEnabled(){const e=!this.isSuppressMenuHide();return!(Sd()&&e)}isHeaderFilterButtonEnabled(e){return this.isFilterMenuInHeaderEnabled(e)&&!Ur(this.gos)&&!this.isFloatingFilterButtonDisplayed(e)}isFilterMenuItemEnabled(e){return!!this.beans.filterManager?.isFilterAllowed(e)&&!Ur(this.gos)&&!this.isFilterMenuInHeaderEnabled(e)&&!this.isFloatingFilterButtonDisplayed(e)}isFloatingFilterButtonEnabled(e){return!e.getColDef().suppressFloatingFilterButton}isFloatingFilterButtonDisplayed(e){return!!e.getColDef().floatingFilter&&this.isFloatingFilterButtonEnabled(e)}isSuppressMenuHide(){const e=this.gos,t=e.get("suppressMenuHide");return Ur(e)?e.exists("suppressMenuHide")?t:!1:t}showColumnMenuCommon(e,t,n,i){const{positionBy:r,onClosedCallback:s}=t,o=t.column;if(r==="button"){const{buttonElement:a}=t;e?.showMenuAfterButtonClick(o,a,n,s,i)}else if(r==="mouse"){const{mouseEvent:a}=t;e?.showMenuAfterMouseEvent(o,a,n,s,i)}else if(o){const a=this.beans,l=a.ctrlsSvc;l.getScrollFeature().ensureColumnVisible(o,"auto"),eu(a,()=>{const u=l.getHeaderRowContainerCtrl(o.getPinned())?.getHeaderCtrlForColumn(o);u&&e?.showMenuAfterButtonClick(o,u.getAnchorElementForMenu(i),n,s,!0)})}}};function lW(e,t,n){e.menuVisible!==t&&(e.menuVisible=t,e.dispatchColEvent("menuVisibleChanged",n))}var jne=class extends bt{constructor(){super()}},iKe={tag:"span",cls:"ag-overlay-loading-center",attrs:{"aria-live":"polite","aria-atomic":"true"}},rKe=class extends jne{init(){const e=Rl(this.gos.get("overlayLoadingTemplate")?.trim());if(this.setTemplate(e??iKe),!e){const t=this.getLocaleTextFunc();setTimeout(()=>{this.getGui().textContent=t("loadingOoo","Loading...")})}}},sKe={tag:"span",cls:"ag-overlay-no-rows-center"},oKe=class extends jne{init(){const e=Rl(this.gos.get("overlayNoRowsTemplate")?.trim());if(this.setTemplate(e??sKe),!e){const t=this.getLocaleTextFunc();setTimeout(()=>{this.getGui().textContent=t("noRowsToShow","No Rows To Show")})}}};function aKe(e,t,n){const i=As(e,t,n);if(i){const{className:s}=i;if(typeof s=="string"&&s.indexOf("ag-icon")>-1||typeof s=="object"&&s["ag-icon"])return i}const r=Cn({tag:"span"});return r.appendChild(i),r}function As(e,t,n){let i=null;e==="smallDown"?ue(262):e==="smallLeft"?ue(263):e==="smallRight"&&ue(264);const r=n&&n.getColDef().icons;if(r&&(i=r[e]),t.gos&&!i){const s=t.gos.get("icons");s&&(i=s[e])}if(i){let s;if(typeof i=="function")s=i();else if(typeof i=="string")s=i;else{ue(38,{iconName:e});return}if(typeof s=="string")return MR(s);if(dN(s))return s;ue(133,{iconName:e});return}else{const s=t.registry.getIcon(e);return s||t.validation?.validateIcon(e),Cn({tag:"span",cls:`ag-icon ag-icon-${s??e}`,role:"presentation",attrs:{unselectable:"on"}})}}var lKe=".ag-dnd-ghost{align-items:center;background-color:var(--ag-drag-and-drop-image-background-color);border:var(--ag-drag-and-drop-image-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-drag-and-drop-image-shadow);color:var(--ag-text-color);cursor:move;display:flex;font-weight:500;gap:var(--ag-cell-widget-spacing);height:var(--ag-header-height);overflow:hidden;padding-left:var(--ag-cell-horizontal-padding);padding-right:var(--ag-cell-horizontal-padding);text-overflow:ellipsis;transform:translateY(calc(var(--ag-spacing)*2));white-space:nowrap}",uKe={tag:"div",children:[{tag:"div",ref:"eGhost",cls:"ag-dnd-ghost ag-unselectable",children:[{tag:"span",ref:"eIcon",cls:"ag-dnd-ghost-icon ag-shake-left-to-right"},{tag:"div",ref:"eLabel",cls:"ag-dnd-ghost-label"}]}]},cKe=class extends bt{constructor(){super(),this.dragSource=null,this.eIcon=ge,this.eLabel=ge,this.eGhost=ge,this.registerCSS(lKe)}postConstruct(){const e=t=>aKe(t,this.beans,null);this.dropIconMap={pinned:e("columnMovePin"),hide:e("columnMoveHide"),move:e("columnMoveMove"),left:e("columnMoveLeft"),right:e("columnMoveRight"),group:e("columnMoveGroup"),aggregate:e("columnMoveValue"),pivot:e("columnMovePivot"),notAllowed:e("dropNotAllowed")}}init(e){this.dragSource=e.dragSource,this.setTemplate(uKe),this.beans.environment.applyThemeClasses(this.eGhost)}destroy(){this.dragSource=null,super.destroy()}setIcon(e,t){const{eIcon:n,dragSource:i,dropIconMap:r,gos:s}=this;Ii(n);let o=null;e||(e=i?.getDefaultIconName?i.getDefaultIconName():"notAllowed"),o=r[e],n.classList.toggle("ag-shake-left-to-right",t),!(o===r.hide&&s.get("suppressDragLeaveHidesColumns"))&&o&&n.appendChild(o)}setLabel(e){this.eLabel.textContent=e}},dKe=".ag-label{white-space:nowrap}:where(.ag-ltr) .ag-label{margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-label{margin-left:var(--ag-spacing)}:where(.ag-label-align-right) .ag-label{order:1}:where(.ag-ltr) :where(.ag-label-align-right) .ag-label{margin-left:var(--ag-spacing)}:where(.ag-rtl) :where(.ag-label-align-right) .ag-label{margin-right:var(--ag-spacing)}.ag-label-align-right>*{flex:none}.ag-label-align-top{align-items:flex-start;flex-direction:column;>*{align-self:stretch}}.ag-label-ellipsis{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:where(.ag-label-align-top) .ag-label{margin-bottom:calc(var(--ag-spacing)*.5)}",hKe=class extends bt{constructor(e,t,n){super(t,n),this.labelSeparator="",this.labelAlignment="left",this.disabled=!1,this.label="",this.config=e||{},this.registerCSS(dKe)}postConstruct(){this.addCssClass("ag-labeled"),this.eLabel.classList.add("ag-label");const{labelSeparator:e,label:t,labelWidth:n,labelAlignment:i,disabled:r}=this.config;r!=null&&this.setDisabled(r),e!=null&&this.setLabelSeparator(e),t!=null&&this.setLabel(t),n!=null&&this.setLabelWidth(n),this.setLabelAlignment(i||this.labelAlignment),this.refreshLabel()}refreshLabel(){const{label:e,eLabel:t}=this;Ii(t),typeof e=="string"?t.innerText=e+this.labelSeparator:e&&t.appendChild(e),e===""?(Yt(t,!1),Bl(t,"presentation")):(Yt(t,!0),Bl(t,null))}setLabelSeparator(e){return this.labelSeparator===e?this:(this.labelSeparator=e,this.label!=null&&this.refreshLabel(),this)}getLabelId(){const e=this.eLabel;return e.id=e.id||`ag-${this.getCompId()}-label`,e.id}getLabel(){return this.label}setLabel(e){return this.label===e?this:(this.label=e,this.refreshLabel(),this)}setLabelAlignment(e){const n=this.getGui().classList;return n.toggle("ag-label-align-left",e==="left"),n.toggle("ag-label-align-right",e==="right"),n.toggle("ag-label-align-top",e==="top"),this}setLabelEllipsis(e){return this.eLabel.classList.toggle("ag-label-ellipsis",e),this}setLabelWidth(e){return this.label==null?this:(VS(this.eLabel,e),this)}setDisabled(e){e=!!e;const t=this.getGui();return o0(t,e),t.classList.toggle("ag-disabled",e),this.disabled=e,this}isDisabled(){return!!this.disabled}},qne=class extends hKe{constructor(e,t,n,i){super(e,t,n),this.className=i}postConstruct(){super.postConstruct();const{width:e,value:t,onValueChange:n}=this.config;e!=null&&this.setWidth(e),t!=null&&this.setValue(t),n!=null&&this.onValueChange(n),this.className&&this.addCssClass(this.className),this.refreshAriaLabelledBy()}setLabel(e){return super.setLabel(e),this.refreshAriaLabelledBy(),this}refreshAriaLabelledBy(){const e=this.getAriaElement(),t=this.getLabelId(),n=this.getLabel();n==null||n==""||QUe(e)!==null?yT(e,""):yT(e,t??"")}setAriaLabel(e){return TR(this.getAriaElement(),e),this.refreshAriaLabelledBy(),this}onValueChange(e){return this.addManagedListeners(this,{fieldValueChanged:()=>e(this.getValue())}),this}getWidth(){return this.getGui().clientWidth}setWidth(e){return ga(this.getGui(),e),this}getPreviousValue(){return this.previousValue}getValue(){return this.value}setValue(e,t){return this.value===e?this:(this.previousValue=this.value,this.value=e,t||this.dispatchLocalEvent({type:"fieldValueChanged"}),this)}};function fKe(e){return{tag:"div",role:"presentation",children:[{tag:"div",ref:"eLabel",cls:"ag-input-field-label"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-input-wrapper",role:"presentation",children:[{tag:e,ref:"eInput",cls:"ag-input-field-input"}]}]}}var dd=class extends qne{constructor(e,t,n="text",i="input"){super(e,e?.template??fKe(i),[],t),this.inputType=n,this.displayFieldTag=i,this.eLabel=ge,this.eWrapper=ge,this.eInput=ge}postConstruct(){super.postConstruct(),this.setInputType();const{eLabel:e,eWrapper:t,eInput:n,className:i}=this;e.classList.add(`${i}-label`),t.classList.add(`${i}-input-wrapper`),n.classList.add(`${i}-input`),this.addCssClass("ag-input-field"),n.id=n.id||`ag-${this.getCompId()}-input`;const{inputName:r,inputWidth:s}=this.config;r!=null&&this.setInputName(r),s!=null&&this.setInputWidth(s),this.addInputListeners(),this.activateTabIndex([n])}addInputListeners(){this.addManagedElementListeners(this.eInput,{input:e=>this.setValue(e.target.value)})}setInputType(){this.displayFieldTag==="input"&&this.eInput.setAttribute("type",this.inputType)}getInputElement(){return this.eInput}setInputWidth(e){return VS(this.eWrapper,e),this}setInputName(e){return this.getInputElement().setAttribute("name",e),this}getFocusableElement(){return this.eInput}setMaxLength(e){const t=this.eInput;return t.maxLength=e,this}setInputPlaceholder(e){return ks(this.eInput,"placeholder",e),this}setInputAriaLabel(e){return TR(this.eInput,e),this.refreshAriaLabelledBy(),this}setDisabled(e){return o0(this.eInput,e),super.setDisabled(e)}setAutoComplete(e){if(e===!0)ks(this.eInput,"autocomplete",null);else{const t=typeof e=="string"?e:"off";ks(this.eInput,"autocomplete",t)}return this}},PN=class extends dd{constructor(e,t="ag-checkbox",n="checkbox"){super(e,t,n),this.labelAlignment="right",this.selected=!1,this.readOnly=!1,this.passive=!1}postConstruct(){super.postConstruct();const{readOnly:e,passive:t}=this.config;typeof e=="boolean"&&this.setReadOnly(e),typeof t=="boolean"&&this.setPassive(t)}addInputListeners(){this.addManagedElementListeners(this.eInput,{click:this.onCheckboxClick.bind(this)}),this.addManagedElementListeners(this.eLabel,{click:this.toggle.bind(this)})}getNextValue(){return this.selected===void 0?!0:!this.selected}setPassive(e){this.passive=e}isReadOnly(){return this.readOnly}setReadOnly(e){this.eWrapper.classList.toggle("ag-disabled",e),this.eInput.disabled=e,this.readOnly=e}setDisabled(e){return this.eWrapper.classList.toggle("ag-disabled",e),super.setDisabled(e)}toggle(){if(this.eInput.disabled)return;const e=this.isSelected(),t=this.getNextValue();this.passive?this.dispatchChange(t,e):this.setValue(t)}getValue(){return this.isSelected()}setValue(e,t){return this.refreshSelectedClass(e),this.setSelected(e,t),this}setName(e){const t=this.getInputElement();return t.name=e,this}isSelected(){return this.selected}setSelected(e,t){if(this.isSelected()===e)return;this.previousValue=this.isSelected(),e=this.selected=typeof e=="boolean"?e:void 0;const n=this.eInput;n.checked=e,n.indeterminate=e===void 0,t||this.dispatchChange(this.selected,this.previousValue)}dispatchChange(e,t,n){this.dispatchLocalEvent({type:"fieldValueChanged",selected:e,previousValue:t,event:n});const i=this.getInputElement();this.eventSvc.dispatchEvent({type:"checkboxChanged",id:i.id,name:i.name,selected:e,previousValue:t})}onCheckboxClick(e){if(this.passive||this.eInput.disabled)return;const t=this.isSelected(),n=this.selected=e.target.checked;this.refreshSelectedClass(n),this.dispatchChange(n,t,e)}refreshSelectedClass(e){const t=this.eWrapper.classList;t.toggle("ag-checked",e===!0),t.toggle("ag-indeterminate",e==null)}},kN={selector:"AG-CHECKBOX",component:PN},pKe=".ag-checkbox-cell{height:100%}",gKe={tag:"div",cls:"ag-cell-wrapper ag-checkbox-cell",role:"presentation",children:[{tag:"ag-checkbox",ref:"eCheckbox",role:"presentation"}]},mKe=class extends bt{constructor(){super(gKe,[kN]),this.eCheckbox=ge,this.registerCSS(pKe)}init(e){this.refresh(e);const{eCheckbox:t,beans:n}=this,i=t.getInputElement();i.setAttribute("tabindex","-1"),Ste(i,"polite"),this.addManagedListeners(i,{click:r=>{if(Rp(r),t.isDisabled())return;const s=t.getValue();this.onCheckboxChanged(s)},dblclick:r=>{Rp(r)}}),this.addManagedElementListeners(e.eGridCell,{keydown:r=>{if(r.key===K.SPACE&&!t.isDisabled()){e.eGridCell===Xt(n)&&t.toggle();const s=t.getValue();this.onCheckboxChanged(s),r.preventDefault()}}})}refresh(e){return this.params=e,this.updateCheckbox(e),!0}updateCheckbox(e){let t,n=!0;const{value:i,column:r,node:s}=e;if(s.group&&r)if(typeof i=="boolean")t=i;else{const d=r.getColId();d.startsWith(IR)?t=i==null||i===""?void 0:i==="true":s.aggData&&s.aggData[d]!==void 0?t=i??void 0:n=!1}else t=i??void 0;const{eCheckbox:o}=this;if(!n){o.setDisplayed(!1);return}o.setValue(t);const a=e.disabled??!r?.isCellEditable(s);o.setDisabled(a);const l=this.getLocaleTextFunc(),u=aN(l,t),c=a?u:`${l("ariaToggleCellValue","Press SPACE to toggle cell value")} (${u})`;o.setInputAriaLabel(c)}onCheckboxChanged(e){const{eventSvc:t,params:n}=this,{column:i,node:r,value:s}=n,o={column:i,colDef:i.getColDef(),data:r.data,node:r,rowIndex:r.rowIndex,rowPinned:r.rowPinned,value:s};t.dispatchEvent({type:"cellEditingStarted",...o});const a=r.setDataValue(i,e,"edit");t.dispatchEvent({type:"cellEditingStopped",...o,oldValue:s,newValue:e,valueChanged:a}),a||this.updateCheckbox(n)}},vKe="ROOT_NODE_ID",CKe=class extends X{constructor(){super(...arguments),this.nextId=0,this.allNodesMap={},this.rootNode=null}get treeData(){return!1}getRowNode(e){return this.allNodesMap[e]}extractRowData(){return this.rootNode?.allLeafChildren?.map(e=>e.data)}activate(e){this.rootNode=e,e.group=!0,e.level=-1,e.id=vKe,e.allLeafChildren=[],e.childrenAfterGroup=[],e.childrenAfterSort=[],e.childrenAfterAggFilter=[],e.childrenAfterFilter=[],this.updateRootSiblingArrays(e)}deactivate(){this.rootNode&&(this.allNodesMap={},this.rootNode=null)}destroy(){super.destroy(),this.allNodesMap={},this.rootNode=null}setNewRowData(e){const t=this.rootNode;t&&(this.dispatchRowDataUpdateStartedEvent(e),t.childrenAfterFilter=null,t.childrenAfterGroup=null,t.childrenAfterAggFilter=null,t.childrenAfterSort=null,t.childrenMapped=null,t.updateHasChildren(),this.allNodesMap={},this.nextId=0,this.loadNewRowData(e),this.updateRootSiblingArrays(t))}updateRootSiblingArrays(e){const t=e.sibling;t&&(t.childrenAfterFilter=e.childrenAfterFilter,t.childrenAfterGroup=e.childrenAfterGroup,t.childrenAfterAggFilter=e.childrenAfterAggFilter,t.childrenAfterSort=e.childrenAfterSort,t.childrenMapped=e.childrenMapped,t.allLeafChildren=e.allLeafChildren)}loadNewRowData(e){this.rootNode.allLeafChildren=e?.map((t,n)=>this.createRowNode(t,n))??[]}setImmutableRowData(e,t){const n=xp(this.gos),i=!this.gos.get("suppressMaintainUnsortedOrder"),r=e.changedRowNodes,s=new Set,o=this.rootNode,a=o.allLeafChildren,l=a.length;let u=!1,c=!1,d=!1,h=!1;for(let g=0,v=-1,C=t.length;g<C;g++){const y=t[g];let b=this.getRowNode(n({data:y,level:0}));if(!b)u=!0,b=this.createRowNode(y,-1),r.add(b);else{if(i){const S=b.sourceRowIndex;h||(h=S<=v||u),v=S}b.data!==y&&(d=!0,b.updateData(y),r.update(b))}s.add(b)}const p=[];for(let g=0;g<l;g++){const v=a[g];s.has(v)||(c=!0,v.isSelected()&&p.push(v),this.rowNodeDeleted(v),r.remove(v))}if(u||c||h){const g=new Array(s.size);let v=0;if(!i)for(let y=0;y<l;++y){const b=a[y];s.delete(b)&&(b.sourceRowIndex=v,g[v++]=b)}for(const y of s)y.sourceRowIndex=v,g[v++]=y;o.allLeafChildren=g;const C=o.sibling;C&&(C.allLeafChildren=g),e.rowNodesOrderChanged||(e.rowNodesOrderChanged=h)}(u||c||h||d)&&(this.deselectNodes(p),e.rowDataUpdated=!0)}rowNodeDeleted(e){e.clearRowTopAndRowIndex();const t=e.id,n=this.allNodesMap;n[t]===e&&delete n[t]}updateRowData(e,t){this.dispatchRowDataUpdateStartedEvent(e.add);const n={changedRowNodes:t,rowNodeTransaction:{remove:[],update:[],add:[]},rowsInserted:!1},i=[],r=xp(this.gos);return this.executeRemove(r,e,n,i),this.executeUpdate(r,e,n,i),this.executeAdd(e,n),this.deselectNodes(i),n}executeAdd(e,t){const n=e.add;if(!n?.length)return;let i=this.rootNode.allLeafChildren,r=i.length;if(typeof e.addIndex=="number"&&(r=this.sanitizeAddIndex(e.addIndex),r>0&&this.gos.get("treeData")&&this.gos.get("getDataPath"))){for(let d=0;d<i.length;d++)if(i[d]?.rowIndex==r-1){r=d+1;break}}const s=n.length,o=t.changedRowNodes,a=new Array(s);for(let c=0;c<s;c++){const d=this.createRowNode(n[c],r+c);o.add(d),a[c]=d}const l=this.rootNode;if(r<i.length){const c=i.slice(0,r),d=i.slice(r,i.length),h=c.length+a.length;for(let p=0,g=d.length;p<g;++p)d[p].sourceRowIndex=h+p;i=[...c,...a,...d],t.rowsInserted=!0}else i=i.concat(a);l.allLeafChildren=i;const u=l.sibling;u&&(u.allLeafChildren=i),t.rowNodeTransaction.add=a}executeRemove(e,t,{changedRowNodes:n,rowNodeTransaction:i},r){const{remove:s}=t;if(!s?.length)return;const o={};s.forEach(u=>{const c=this.lookupRowNode(e,u);c&&(c.isSelected()&&r.push(c),c.clearRowTopAndRowIndex(),o[c.id]=!0,delete this.allNodesMap[c.id],i.remove.push(c),n.remove(c))});const a=this.rootNode;a.allLeafChildren=a.allLeafChildren?.filter(u=>!o[u.id])??null,a.allLeafChildren?.forEach((u,c)=>{u.sourceRowIndex=c});const l=a.sibling;l&&(l.allLeafChildren=a.allLeafChildren)}executeUpdate(e,t,{changedRowNodes:n,rowNodeTransaction:i},r){const{update:s}=t;s?.length&&s.forEach(o=>{const a=this.lookupRowNode(e,o);a&&(a.updateData(o),!a.selectable&&a.isSelected()&&r.push(a),i.update.push(a),n.update(a))})}dispatchRowDataUpdateStartedEvent(e){this.eventSvc.dispatchEvent({type:"rowDataUpdateStarted",firstRowData:e?.length?e[0]:null})}deselectNodes(e){const t="rowDataChanged",n=this.beans.selectionSvc,i=e.length>0;i&&n?.setNodesSelected({newValue:!1,nodes:e,suppressFinishActions:!0,source:t}),n?.updateGroupsFromChildrenSelections?.(t),i&&this.eventSvc.dispatchEvent({type:"selectionChanged",source:t,selectedNodes:n?.getSelectedNodes()??null,serverSideState:null})}sanitizeAddIndex(e){const t=this.rootNode.allLeafChildren?.length??0;return e<0||e>=t||Number.isNaN(e)?t:Math.ceil(e)}createRowNode(e,t){const n=new Dp(this.beans);return n.parent=this.rootNode,n.level=0,n.group=!1,n.expanded=!1,n.sourceRowIndex=t,n.setDataAndId(e,String(this.nextId)),this.allNodesMap[n.id]&&ue(2,{nodeId:n.id}),this.allNodesMap[n.id]=n,this.nextId++,n}lookupRowNode(e,t){let n;if(e){const i=e({data:t,level:0});if(n=this.allNodesMap[i],!n)return wt(4,{id:i}),null}else if(n=this.rootNode?.allLeafChildren?.find(i=>i.data===t),!n)return wt(5,{data:t}),null;return n||null}},yKe={tag:"div",cls:"ag-selection-checkbox",role:"presentation",children:[{tag:"ag-checkbox",ref:"eCheckbox",role:"presentation"}]},wKe=class extends bt{constructor(){super(yKe,[kN]),this.eCheckbox=ge}postConstruct(){this.eCheckbox.setPassive(!0)}getCheckboxId(){return this.eCheckbox.getInputElement().id}onDataChanged(){this.onSelectionChanged()}onSelectableChanged(){this.showOrHideSelect()}onSelectionChanged(){const e=this.getLocaleTextFunc(),{rowNode:t,eCheckbox:n}=this,i=t.isSelected(),r=aN(e,i),[s,o]=t.selectable?["ariaRowToggleSelection","Press Space to toggle row selection"]:["ariaRowSelectionDisabled","Row Selection is disabled for this row"],a=e(s,o);n.setValue(i,!0),n.setInputAriaLabel(`${a} (${r})`)}init(e){if(this.rowNode=e.rowNode,this.column=e.column,this.overrides=e.overrides,this.onSelectionChanged(),this.addManagedListeners(this.eCheckbox.getInputElement(),{dblclick:Rp,click:i=>{Rp(i),this.beans.selectionSvc?.handleSelectionEvent(i,this.rowNode,"checkboxSelected")}}),this.addManagedListeners(this.rowNode,{rowSelected:this.onSelectionChanged.bind(this),dataChanged:this.onDataChanged.bind(this),selectableChanged:this.onSelectableChanged.bind(this)}),this.addManagedPropertyListener("rowSelection",({currentValue:i,previousValue:r})=>{const s=typeof i=="object"?CD(i):void 0,o=typeof r=="object"?CD(r):void 0;s!==o&&this.onSelectableChanged()}),TT(this.gos)||typeof this.getIsVisible()=="function"){const i=this.showOrHideSelect.bind(this);this.addManagedEventListeners({displayedColumnsChanged:i}),this.addManagedListeners(this.rowNode,{dataChanged:i,cellChanged:i}),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")}showOrHideSelect(){const{column:e,rowNode:t,overrides:n,gos:i}=this;let r=t.selectable;const s=this.getIsVisible();if(r)if(typeof s=="function"){const l=n?.callbackParams;if(!e)r=s({...l,node:t,data:t.data});else{const u=e.createColumnFunctionCallbackParams(t);r=s({...l,...u})}}else r=s??!1;const o=i.get("rowSelection");if(o&&typeof o!="string"?!CD(o):e?.getColDef().showDisabledCheckboxes){this.eCheckbox.setDisabled(!r),this.setVisible(!0),this.setDisplayed(!0);return}if(n?.removeHidden){this.setDisplayed(r);return}this.setVisible(r)}getIsVisible(){const e=this.overrides;if(e)return e.isVisible;const t=this.gos.get("rowSelection");return t&&typeof t!="string"?If(t):this.column?.getColDef()?.checkboxSelection}},bKe=class{constructor(e){this.rowModel=e,this.selectAll=!1,this.rootId=null,this.endId=null,this.cachedRange=[]}reset(){this.rootId=null,this.endId=null,this.cachedRange.length=0}setRoot(e){this.rootId=e.id,this.endId=null,this.cachedRange.length=0}setEndRange(e){this.endId=e.id,this.cachedRange.length=0}getRange(){if(this.cachedRange.length===0){const e=this.getRoot(),t=this.getEnd();if(e==null||t==null)return this.cachedRange;this.cachedRange=this.rowModel.getNodesInRangeForSelection(e,t)??[]}return this.cachedRange}isInRange(e){return this.rootId===null?!1:this.getRange().some(t=>t.id===e.id)}getRoot(e){return this.rootId?this.rowModel.getRowNode(this.rootId)??null:e?(this.setRoot(e),e):null}getEnd(){return this.endId?this.rowModel.getRowNode(this.endId)??null:null}truncate(e){const t=this.getRange();if(t.length===0)return{keep:[],discard:[]};const n=t[0].id===this.rootId,i=t.findIndex(r=>r.id===e.id);if(i>-1){const r=t.slice(0,i),s=t.slice(i+1);return this.setEndRange(e),n?{keep:r,discard:s}:{keep:s,discard:r}}else return{keep:t,discard:[]}}extend(e,t=!1){const n=this.getRoot();if(n==null){const r=this.getRange().slice();return t&&e.depthFirstSearch(s=>!s.group&&r.push(s)),r.push(e),this.setRoot(e),{keep:r,discard:[]}}const i=this.rowModel.getNodesInRangeForSelection(n,e);if(!i)return this.setRoot(e),{keep:[e],discard:[]};if(i.find(r=>r.id===this.endId))return this.setEndRange(e),{keep:this.getRange(),discard:[]};{const r=this.getRange().slice();return this.setEndRange(e),{keep:this.getRange(),discard:r}}}},SKe=class extends X{constructor(e){super(),this.column=e,this.cbSelectAllVisible=!1,this.processingEventFromCheckbox=!1}onSpaceKeyDown(e){const t=this.cbSelectAll;t.isDisplayed()&&!t.getGui().contains(Xt(this.beans))&&(e.preventDefault(),t.setValue(!t.getValue()))}getCheckboxGui(){return this.cbSelectAll.getGui()}setComp(e){this.headerCellCtrl=e;const t=this.createManagedBean(new PN);this.cbSelectAll=t,t.addCssClass("ag-header-select-all"),Bl(t.getGui(),"presentation"),this.showOrHideSelectAll(),this.addManagedEventListeners({newColumnsLoaded:()=>this.showOrHideSelectAll(),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),selectionChanged:this.onSelectionChanged.bind(this),paginationChanged:this.onSelectionChanged.bind(this),modelUpdated:this.onModelChanged.bind(this)}),this.addManagedPropertyListener("rowSelection",({currentValue:n,previousValue:i})=>{const r=s=>typeof s=="string"||!s||s.mode==="singleRow"?void 0:s.selectAll;r(n)!==r(i)&&this.showOrHideSelectAll()}),this.addManagedListeners(t,{fieldValueChanged:this.onCbSelectAll.bind(this)}),t.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()}onDisplayedColumnsChanged(e){this.isAlive()&&this.showOrHideSelectAll(e.source==="uiColumnMoved")}showOrHideSelectAll(e=!1){const t=this.isCheckboxSelection();this.cbSelectAllVisible=t,this.cbSelectAll.setDisplayed(t),t&&(this.checkRightRowModelType("selectAllCheckbox"),this.checkSelectionType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel(e)}onModelChanged(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}onSelectionChanged(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}updateStateOfCheckbox(){if(this.processingEventFromCheckbox)return;this.processingEventFromCheckbox=!0;const e=this.getSelectAllMode(),t=this.beans.selectionSvc,n=this.cbSelectAll,i=t.getSelectAllState(e);n.setValue(i);const r=t.hasNodesToSelect(e);n.setDisabled(!r),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}refreshSelectAllLabel(e=!1){const t=this.getLocaleTextFunc(),{headerCellCtrl:n,cbSelectAll:i,cbSelectAllVisible:r}=this,o=i.getValue()?t("ariaChecked","checked"):t("ariaUnchecked","unchecked"),a=t("ariaRowSelectAll","Press Space to toggle all rows selection");n.setAriaDescriptionProperty("selectAll",r?`${a} (${o})`:null),i.setInputAriaLabel(t("ariaHeaderSelection","Column with Header Selection")),e||n.announceAriaDescription()}checkSelectionType(e){return c0(this.gos)?!0:(ue(128,{feature:e}),!1)}checkRightRowModelType(e){const{gos:t,rowModel:n}=this.beans;return Xi(t)||mg(t)?!0:(ue(129,{feature:e,rowModel:n.getType()}),!1)}onCbSelectAll(){if(this.processingEventFromCheckbox||!this.cbSelectAllVisible)return;const e=this.cbSelectAll.getValue(),t=this.getSelectAllMode();let n="uiSelectAll";t==="currentPage"?n="uiSelectAllCurrentPage":t==="filtered"&&(n="uiSelectAllFiltered");const i={source:n,selectAll:t},r=this.beans.selectionSvc;e?r.selectAllRowNodes(i):r.deselectAllRowNodes(i)}isCheckboxSelection(){const{column:e,gos:t,beans:n}=this,i=t.get("rowSelection"),r=e.getColDef(),{headerCheckboxSelection:s}=r;let o=!1;const a=typeof i=="object";if(a){const u=zl(e),c=vN(e);(US(i)==="autoGroupColumn"&&c||u&&n.selectionColSvc?.isSelectionColumnEnabled())&&(o=Uw(i))}else typeof s=="function"?o=s(Ne(t,{column:e,colDef:r})):o=!!s;const l=a?"headerCheckbox":"headerCheckboxSelection";return o&&this.checkRightRowModelType(l)&&this.checkSelectionType(l)}getSelectAllMode(){const e=Yte(this.gos,!1);if(e)return e;const{headerCheckboxSelectionCurrentPageOnly:t,headerCheckboxSelectionFilteredOnly:n}=this.column.getColDef();return t?"currentPage":n?"filtered":"all"}},xKe=class extends X{postConstruct(){const{gos:e,beans:t}=this;this.selectionCtx=new bKe(t.rowModel),this.addManagedPropertyListeners(["isRowSelectable","rowSelection"],()=>{const n=TT(e);n!==this.isRowSelectable&&(this.isRowSelectable=n,this.updateSelectable())}),this.isRowSelectable=TT(e)}destroy(){super.destroy(),this.selectionCtx.reset()}createCheckboxSelectionComponent(){return new wKe}createSelectAllFeature(e){return new SKe(e)}isMultiSelect(){return c0(this.gos)}onRowCtrlSelected(e,t,n){const i=!!e.rowNode.isSelected();e.forEachGui(n,r=>{r.rowComp.addOrRemoveCssClass("ag-row-selected",i);const s=r.element;bT(s,i),s.contains(Xt(this.beans))&&t(r)})}announceAriaRowSelection(e){if(this.isRowSelectionBlocked(e))return;const t=e.isSelected();if(!e.selectable)return;const i=this.getLocaleTextFunc()(t?"ariaRowDeselect":"ariaRowSelect",`Press SPACE to ${t?"deselect":"select"} this row`);this.beans.ariaAnnounce?.announceValue(i,"rowSelection")}isRowSelectionBlocked(e){return!e.selectable||!!e.rowPinned||!Ed(this.gos)}updateRowSelectable(e,t){const n=this.isRowSelectable?.(e)??!0;return this.setRowSelectable(e,n,t),n}setRowSelectable(e,t,n){if(e.selectable!==t){if(e.selectable=t,e.dispatchRowEvent("selectableChanged"),n)return;if(d0(this.gos)){const r=this.calculateSelectedFromChildren(e);this.setNodesSelected({nodes:[e],newValue:r??!1,source:"selectableChanged"});return}e.isSelected()&&!e.selectable&&this.setNodesSelected({nodes:[e],newValue:!1,source:"selectableChanged"})}}calculateSelectedFromChildren(e){let t=!1,n=!1;if(!e.childrenAfterGroup?.length)return e.selectable?e.__selected:null;for(let i=0;i<e.childrenAfterGroup.length;i++){const r=e.childrenAfterGroup[i];let s=r.isSelected();if(!r.selectable){const o=this.calculateSelectedFromChildren(r);if(o===null)continue;s=o}switch(s){case!0:t=!0;break;case!1:n=!0;break;default:return}}if(!(t&&n))return t?!0:n?!1:e.selectable?e.__selected:null}selectRowNode(e,t,n,i="api"){const r=!e.selectable&&t,s=e.__selected===t;if(r||s)return!1;e.__selected=t,e.dispatchRowEvent("rowSelected");const o=e.sibling;return o&&o.footer&&o.__localEventService&&o.dispatchRowEvent("rowSelected"),this.eventSvc.dispatchEvent({...Jje(e,this.gos,"rowSelected"),event:n||null,source:i}),!0}isCellCheckboxSelection(e,t){const n=this.gos.get("rowSelection");if(n&&typeof n!="string"){const i=zl(e)&&If(n);return e.isColumnFunc(t,i)}else return e.isColumnFunc(t,e.colDef.checkboxSelection)}inferNodeSelections(e,t,n,i){const{gos:r,selectionCtx:s}=this,o=e.isSelected(),a=d0(r),l=$9e(r),u=B9e(r),c=this.isMultiSelect(),d=i==="rowClicked";if(d&&a&&e.group||d&&!(l||u))return null;if(t&&n&&c){const h=s.getRoot();if(h)if(h.isSelected()){const p=s.isInRange(e)?s.truncate(e):s.extend(e,a);return{deselect:p.discard,select:p.keep,reset:!1}}else{const p=s.extend(e,a);return{select:[],deselect:p.keep,reset:!1}}else return null}else if(t&&c){const h=s.selectAll?this.beans.rowModel.getRow(0):void 0,p=s.getRoot(h),g=s.isInRange(e)?s.truncate(e):s.extend(e,a);return{select:g.keep,deselect:g.discard,reset:s.selectAll||!!(p&&!p.isSelected())}}else{if(n)return s.setRoot(e),d&&o&&!u?null:{node:e,newValue:!o,clearSelection:!c};{s.setRoot(e);const h=G9e(r),p=qS(r)==="filteredDescendants",g=d&&(!h||!l);if(p&&o===void 0&&Xi(r))return{node:e,newValue:!1,clearSelection:!c||g};if(d){const v=o?!h:l;return v===o&&!g||v&&!l||!v&&!u?null:{node:e,newValue:v,clearSelection:!c||g}}return{node:e,newValue:!o,clearSelection:!c||g}}}}},RKe=class extends PN{constructor(e){super(e,"ag-radio-button","radio")}isSelected(){return this.eInput.checked}toggle(){this.eInput.disabled||this.isSelected()||this.setValue(!0)}addInputListeners(){super.addInputListeners(),this.addManagedEventListeners({checkboxChanged:this.onChange.bind(this)})}onChange(e){const t=this.eInput;e.selected&&e.name&&t.name&&t.name===e.name&&e.id&&t.id!==e.id&&this.setValue(!1,!0)}},Rh=class extends dd{constructor(e,t="ag-text-field",n="text"){super(e,t,n)}postConstruct(){super.postConstruct(),this.config.allowedCharPattern&&this.preventDisallowedCharacters()}setValue(e,t){const n=this.eInput;return n.value!==e&&(n.value=me(e)?e:""),super.setValue(e,t)}setStartValue(e){this.setValue(e,!0)}preventDisallowedCharacters(){const e=new RegExp(`[${this.config.allowedCharPattern}]`),t=n=>{Lne(n)&&n.key&&!e.test(n.key)&&n.preventDefault()};this.addManagedListeners(this.eInput,{keydown:t,paste:n=>{const i=n.clipboardData?.getData("text");i&&i.split("").some(r=>!e.test(r))&&n.preventDefault()}})}},OR={selector:"AG-INPUT-TEXT-FIELD",component:Rh},EKe=class extends dd{constructor(e){super(e,"ag-text-area",null,"textarea")}setValue(e,t){const n=super.setValue(e,t);return this.eInput.value=e,n}setCols(e){return this.eInput.cols=e,this}setRows(e){return this.eInput.rows=e,this}},FKe={selector:"AG-INPUT-TEXT-AREA",component:EKe},TN=class extends Rh{constructor(e){super(e,"ag-number-field","number")}postConstruct(){super.postConstruct();const e=this.eInput;this.addManagedListeners(e,{blur:()=>{const s=parseFloat(e.value),o=isNaN(s)?"":this.normalizeValue(s.toString());this.value!==o&&this.setValue(o)},wheel:this.onWheel.bind(this)}),e.step="any";const{precision:t,min:n,max:i,step:r}=this.config;typeof t=="number"&&this.setPrecision(t),typeof n=="number"&&this.setMin(n),typeof i=="number"&&this.setMax(i),typeof r=="number"&&this.setStep(r)}onWheel(e){Xt(this.beans)===this.eInput&&e.preventDefault()}normalizeValue(e){if(e==="")return"";this.precision!=null&&(e=this.adjustPrecision(e));const t=parseFloat(e),{min:n,max:i}=this;return n!=null&&t<n?e=n.toString():i!=null&&t>i&&(e=i.toString()),e}adjustPrecision(e,t){const n=this.precision;if(n==null)return e;if(t){const r=parseFloat(e).toFixed(n);return parseFloat(r).toString()}const i=String(e).split(".");if(i.length>1){if(i[1].length<=n)return e;if(n>0)return`${i[0]}.${i[1].slice(0,n)}`}return i[0]}setMin(e){return this.min===e?this:(this.min=e,ks(this.eInput,"min",e),this)}setMax(e){return this.max===e?this:(this.max=e,ks(this.eInput,"max",e),this)}setPrecision(e){return this.precision=e,this}setStep(e){return this.step===e?this:(this.step=e,ks(this.eInput,"step",e),this)}setValue(e,t){return this.setValueOrInputValue(n=>super.setValue(n,t),()=>this,e)}setStartValue(e){return this.setValueOrInputValue(t=>super.setValue(t,!0),t=>{this.eInput.value=t},e)}setValueOrInputValue(e,t,n){if(me(n)){let i=this.isScientificNotation(n);if(i&&this.eInput.validity.valid)return e(n);if(!i){n=this.adjustPrecision(n);const r=this.normalizeValue(n);i=n!=r}if(i)return t(n)}return e(n)}getValue(){const e=this.eInput;if(!e.validity.valid)return;const t=e.value;return this.isScientificNotation(t)?this.adjustPrecision(t,!0):super.getValue()}isScientificNotation(e){return typeof e=="string"&&e.includes("e")}},AKe={selector:"AG-INPUT-NUMBER-FIELD",component:TN};function fv(e,t){return e.toString().padStart(t,"0")}function Ts(e,t=!0,n="-"){if(!e)return null;let i=[e.getFullYear(),e.getMonth()+1,e.getDate()].map(r=>fv(r,2)).join(n);return t&&(i+=" "+[e.getHours(),e.getMinutes(),e.getSeconds()].map(r=>fv(r,2)).join(":")),i}var AD=e=>{if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"};function pv(e,t="YYYY-MM-DD"){const n=fv(e.getFullYear(),4),i=["January","February","March","April","May","June","July","August","September","October","November","December"],r=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],s={YYYY:()=>n.slice(n.length-4,n.length),YY:()=>n.slice(n.length-2,n.length),Y:()=>`${e.getFullYear()}`,MMMM:()=>i[e.getMonth()],MMM:()=>i[e.getMonth()].slice(0,3),MM:()=>fv(e.getMonth()+1,2),Mo:()=>`${e.getMonth()+1}${AD(e.getMonth()+1)}`,M:()=>`${e.getMonth()+1}`,Do:()=>`${e.getDate()}${AD(e.getDate())}`,DD:()=>fv(e.getDate(),2),D:()=>`${e.getDate()}`,dddd:()=>r[e.getDay()],ddd:()=>r[e.getDay()].slice(0,3),dd:()=>r[e.getDay()].slice(0,2),do:()=>`${e.getDay()}${AD(e.getDay())}`,d:()=>`${e.getDay()}`},o=new RegExp(Object.keys(s).join("|"),"g");return t.replace(o,a=>a in s?s[a]():a)}function Rr(e){if(!e)return null;const[t,n]=e.split(" ");if(!t)return null;const i=t.split("-").map(d=>parseInt(d,10));if(i.filter(d=>!isNaN(d)).length!==3)return null;const[r,s,o]=i,a=new Date(r,s-1,o);if(a.getFullYear()!==r||a.getMonth()!==s-1||a.getDate()!==o)return null;if(!n||n==="00:00:00")return a;const[l,u,c]=n.split(":").map(d=>parseInt(d,10));return l>=0&&l<24&&a.setHours(l),u>=0&&u<60&&a.setMinutes(u),c>=0&&c<60&&a.setSeconds(c),a}var DKe=class extends Rh{constructor(e){super(e,"ag-date-field","date")}postConstruct(){super.postConstruct();const e=wh();this.addManagedListeners(this.eInput,{wheel:this.onWheel.bind(this),mousedown:()=>{this.isDisabled()||e||this.eInput.focus()}}),this.eInput.step="any"}onWheel(e){Xt(this.beans)===this.eInput&&e.preventDefault()}setMin(e){const t=e instanceof Date?Ts(e??null,!1)??void 0:e;return this.min===t?this:(this.min=t,ks(this.eInput,"min",t),this)}setMax(e){const t=e instanceof Date?Ts(e??null,!1)??void 0:e;return this.max===t?this:(this.max=t,ks(this.eInput,"max",t),this)}setStep(e){return this.step===e?this:(this.step=e,ks(this.eInput,"step",e),this)}getDate(){if(this.eInput.validity.valid)return Rr(this.getValue())??void 0}setDate(e,t){this.setValue(Ts(e??null,!1),t)}},Kne={selector:"AG-INPUT-DATE-FIELD",component:DKe},PKe=1e3,kKe=1e3,uW=100,cW,hw=!1,TKe=class extends X{constructor(e,t){super(),this.tooltipCtrl=e,this.getTooltipValue=t,this.interactionEnabled=!1,this.isInteractingWithTooltip=!1,this.state=0,this.tooltipInstanceCount=0,this.tooltipMouseTrack=!1}wireBeans(e){this.popupSvc=e.popupSvc,this.userCompFactory=e.userCompFactory}postConstruct(){this.gos.get("tooltipInteraction")&&(this.interactionEnabled=!0),this.tooltipTrigger=this.getTooltipTrigger(),this.tooltipMouseTrack=this.gos.get("tooltipMouseTrack");const e=this.tooltipCtrl.getGui();this.tooltipTrigger===0&&this.addManagedListeners(e,{mouseenter:this.onMouseEnter.bind(this),mouseleave:this.onMouseLeave.bind(this)}),this.tooltipTrigger===1&&this.addManagedListeners(e,{focusin:this.onFocusIn.bind(this),focusout:this.onFocusOut.bind(this)}),this.addManagedListeners(e,{mousemove:this.onMouseMove.bind(this)}),this.interactionEnabled||this.addManagedListeners(e,{mousedown:this.onMouseDown.bind(this),keydown:this.onKeyDown.bind(this)})}getGridOptionsTooltipDelay(e){const t=this.gos.get(e);return Math.max(200,t)}getTooltipDelay(e){return e==="show"?this.tooltipCtrl.getTooltipShowDelayOverride?.()??this.getGridOptionsTooltipDelay("tooltipShowDelay"):this.tooltipCtrl.getTooltipHideDelayOverride?.()??this.getGridOptionsTooltipDelay("tooltipHideDelay")}destroy(){this.setToDoNothing(),super.destroy()}getTooltipTrigger(){const e=this.gos.get("tooltipTrigger");return!e||e==="hover"?0:1}onMouseEnter(e){this.interactionEnabled&&this.interactiveTooltipTimeoutId&&(this.unlockService(),this.startHideTimeout()),!Sd()&&(hw?this.showTooltipTimeoutId=window.setTimeout(()=>{this.prepareToShowTooltip(e)},uW):this.prepareToShowTooltip(e))}onMouseMove(e){this.lastMouseEvent&&(this.lastMouseEvent=e),this.tooltipMouseTrack&&this.state===2&&this.tooltipComp&&this.positionTooltip()}onMouseDown(){this.setToDoNothing()}onMouseLeave(){this.interactionEnabled?this.lockService():this.setToDoNothing()}onFocusIn(){this.prepareToShowTooltip()}onFocusOut(e){const t=e.relatedTarget,n=this.tooltipCtrl.getGui(),i=this.tooltipComp?.getGui();this.isInteractingWithTooltip||n.contains(t)||this.interactionEnabled&&i?.contains(t)||this.setToDoNothing()}onKeyDown(){this.isInteractingWithTooltip&&(this.isInteractingWithTooltip=!1),this.setToDoNothing()}prepareToShowTooltip(e){if(this.state!=0||hw)return;let t=0;e&&(t=this.isLastTooltipHiddenRecently()?200:this.getTooltipDelay("show")),this.lastMouseEvent=e||null,this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),t),this.state=1}isLastTooltipHiddenRecently(){return Date.now()-cW<PKe}setToDoNothing(e){!e&&this.state===2&&this.hideTooltip(),this.onBodyScrollEventCallback&&(this.onBodyScrollEventCallback(),this.onBodyScrollEventCallback=void 0),this.onColumnMovedEventCallback&&(this.onColumnMovedEventCallback(),this.onColumnMovedEventCallback=void 0),this.onDocumentKeyDownCallback&&(this.onDocumentKeyDownCallback(),this.onDocumentKeyDownCallback=void 0),this.clearTimeouts(),this.state=0,this.lastMouseEvent=null}showTooltip(){const e=this.getTooltipValue(),t=this.tooltipCtrl;if(!me(e)||t.shouldDisplayTooltip&&!t.shouldDisplayTooltip()){this.setToDoNothing();return}const n=t.getRowNode?.(),i=Ne(this.gos,{location:t.getLocation?.()??"UNKNOWN",colDef:t.getColDef?.(),column:t.getColumn?.(),rowIndex:t.getRowIndex?.(),node:n,data:n?.data,value:e,valueFormatted:t.getValueFormatted?.(),hideTooltipCallback:()=>this.hideTooltip(!0),...t.getAdditionalParams?.()??{}});this.state=2,this.tooltipInstanceCount++;const r=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);rje(this.userCompFactory,i)?.newAgStackInstance().then(r)}hideTooltip(e){!e&&this.isInteractingWithTooltip||(this.tooltipComp&&(this.destroyTooltipComp(),cW=Date.now()),this.eventSvc.dispatchEvent({type:"tooltipHide",parentGui:this.tooltipCtrl.getGui()}),e&&(this.isInteractingWithTooltip=!1),this.setToDoNothing(!0))}newTooltipComponentCallback(e,t){if(this.state!==2||this.tooltipInstanceCount!==e){this.destroyBean(t);return}const i=t.getGui();this.tooltipComp=t,i.classList.contains("ag-tooltip")||i.classList.add("ag-tooltip-custom"),this.tooltipTrigger===0&&i.classList.add("ag-tooltip-animate"),this.interactionEnabled&&i.classList.add("ag-tooltip-interactive");const r=this.getLocaleTextFunc(),s=this.popupSvc?.addPopup({eChild:i,ariaLabel:r("ariaLabelTooltip","Tooltip")});if(s&&(this.tooltipPopupDestroyFunc=s.hideFunc),this.positionTooltip(),this.tooltipTrigger===1){const o=()=>this.setToDoNothing();[this.onBodyScrollEventCallback,this.onColumnMovedEventCallback]=this.addManagedEventListeners({bodyScroll:o,columnMoved:o})}this.interactionEnabled&&([this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener]=this.addManagedElementListeners(i,{mouseenter:this.onTooltipMouseEnter.bind(this),mouseleave:this.onTooltipMouseLeave.bind(this)}),[this.onDocumentKeyDownCallback]=this.addManagedElementListeners(Rn(this.beans),{keydown:o=>{i.contains(o?.target)||this.onKeyDown()}}),this.tooltipTrigger===1&&([this.tooltipFocusInListener,this.tooltipFocusOutListener]=this.addManagedElementListeners(i,{focusin:this.onTooltipFocusIn.bind(this),focusout:this.onTooltipFocusOut.bind(this)}))),this.eventSvc.dispatchEvent({type:"tooltipShow",tooltipGui:i,parentGui:this.tooltipCtrl.getGui()}),this.startHideTimeout()}onTooltipMouseEnter(){this.isInteractingWithTooltip=!0,this.unlockService()}onTooltipMouseLeave(){this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,this.lockService())}onTooltipFocusIn(){this.isInteractingWithTooltip=!0}isTooltipFocused(){const e=this.tooltipComp?.getGui(),t=Xt(this.beans);return!!e&&e.contains(t)}onTooltipFocusOut(e){const t=this.tooltipCtrl.getGui();this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,t.contains(e.relatedTarget)?this.startHideTimeout():this.hideTooltip())}positionTooltip(){const e={type:"tooltip",ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack};this.lastMouseEvent?this.popupSvc?.positionPopupUnderMouseEvent({...e,mouseEvent:this.lastMouseEvent}):this.popupSvc?.positionPopupByComponent({...e,eventSource:this.tooltipCtrl.getGui(),position:"under",keepWithinBounds:!0,nudgeY:5})}destroyTooltipComp(){this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");const e=this.tooltipPopupDestroyFunc,t=this.tooltipComp,n=this.tooltipTrigger===0?kKe:0;window.setTimeout(()=>{e(),this.destroyBean(t)},n),this.clearTooltipListeners(),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0}clearTooltipListeners(){[this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener,this.tooltipFocusInListener,this.tooltipFocusOutListener].forEach(e=>{e&&e()}),this.tooltipMouseEnterListener=this.tooltipMouseLeaveListener=this.tooltipFocusInListener=this.tooltipFocusOutListener=null}lockService(){hw=!0,this.interactiveTooltipTimeoutId=window.setTimeout(()=>{this.unlockService(),this.setToDoNothing()},uW)}unlockService(){hw=!1,this.clearInteractiveTimeout()}startHideTimeout(){this.clearHideTimeout(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.getTooltipDelay("hide"))}clearShowTimeout(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0)}clearHideTimeout(){this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)}clearInteractiveTimeout(){this.interactiveTooltipTimeoutId&&(window.clearTimeout(this.interactiveTooltipTimeoutId),this.interactiveTooltipTimeoutId=void 0)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout(),this.clearInteractiveTimeout()}};function DD(e){return e.get("tooltipShowMode")==="whenTruncated"}function Yw(e){return()=>{const t=e();return t?t.scrollWidth>t.clientWidth:!0}}var MKe=class extends X{constructor(e,t){super(),this.ctrl=e,t&&(this.beans=t)}postConstruct(){this.refreshTooltip()}setBrowserTooltip(e){const t="title",n=this.ctrl.getGui();n&&(e!=null&&e!=""?n.setAttribute(t,e):n.removeAttribute(t))}updateTooltipText(){const{getTooltipValue:e}=this.ctrl;e&&(this.tooltip=e())}createTooltipFeatureIfNeeded(){this.tooltipManager==null&&(this.tooltipManager=this.createBean(new TKe(this.ctrl,()=>this.tooltip),this.beans.context))}setTooltipAndRefresh(e){this.tooltip=e,this.refreshTooltip()}refreshTooltip(){this.browserTooltips=this.beans.gos.get("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?(this.setBrowserTooltip(this.tooltip),this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context)):(this.setBrowserTooltip(null),this.createTooltipFeatureIfNeeded())}destroy(){this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context),super.destroy()}},IKe=class extends bt{constructor(e="default",t=!1){super({tag:"div",cls:`ag-list ag-${e}-list`}),this.cssIdentifier=e,this.unFocusable=t,this.activeClass="ag-active-item",this.options=[],this.itemEls=[]}postConstruct(){const e=this.getGui();this.addManagedElementListeners(e,{mouseleave:()=>this.clearHighlighted()}),!this.unFocusable&&this.addManagedElementListeners(e,{keydown:this.handleKeyDown.bind(this)})}handleKeyDown(e){const t=e.key;switch(t){case K.ENTER:if(!this.highlightedEl)this.setValue(this.getValue());else{const n=this.itemEls.indexOf(this.highlightedEl);this.setValueByIndex(n)}break;case K.DOWN:case K.UP:e.preventDefault(),this.navigate(t);break;case K.PAGE_DOWN:case K.PAGE_UP:case K.PAGE_HOME:case K.PAGE_END:e.preventDefault(),this.navigateToPage(t);break}}navigate(e){const t=e===K.DOWN;let n;const{itemEls:i,highlightedEl:r}=this;if(!r)n=i[t?0:i.length-1];else{let o=i.indexOf(r)+(t?1:-1);o=Math.min(Math.max(o,0),i.length-1),n=i[o]}this.highlightItem(n)}navigateToPage(e){const{itemEls:t,highlightedEl:n}=this;if(!n||t.length===0)return;const i=t.indexOf(n),r=this.options.length-1,s=t[0].clientHeight,o=Math.floor(this.getGui().clientHeight/s);let a=-1;e===K.PAGE_HOME?a=0:e===K.PAGE_END?a=r:e===K.PAGE_DOWN?a=Math.min(i+o,r):e===K.PAGE_UP&&(a=Math.max(i-o,0)),a!==-1&&this.highlightItem(t[a])}addOptions(e){return e.forEach(t=>this.addOption(t)),this}addOption(e){const{value:t,text:n}=e,i=n||t;return this.options.push({value:t,text:i}),this.renderOption(t,i),this.updateIndices(),this}clearOptions(){this.options=[],this.reset(!0),this.itemEls.forEach(e=>{Fs(e)}),this.itemEls=[],this.refreshAriaRole()}refreshAriaRole(){const e=this.getGui();Bl(e,this.options.length===0?"presentation":"listbox")}updateIndices(){const e=this.getGui().querySelectorAll(".ag-list-item");this.refreshAriaRole(),e.forEach((t,n)=>{n9e(t,n+1),t9e(t,e.length)})}renderOption(e,t){const n=Rn(this.beans),i=n.createElement("div");Bl(i,"option"),i.classList.add("ag-list-item",`ag-${this.cssIdentifier}-list-item`);const r=n.createElement("span");i.appendChild(r),r.textContent=t,this.unFocusable||(i.tabIndex=-1),this.itemEls.push(i),this.addManagedListeners(i,{mouseover:()=>this.highlightItem(i),mousedown:s=>{s.preventDefault(),s.stopPropagation(),this.setValue(e)}}),this.createOptionalManagedBean(this.beans.registry.createDynamicBean("tooltipFeature",!1,{getTooltipValue:()=>t,getGui:()=>i,getLocation:()=>"UNKNOWN",shouldDisplayTooltip:()=>r.scrollWidth>r.clientWidth})),this.getGui().appendChild(i)}setValue(e,t){if(this.value===e)return this.fireItemSelected(),this;if(e==null)return this.reset(t),this;const n=this.options.findIndex(i=>i.value===e);if(n!==-1){const i=this.options[n];this.value=i.value,this.displayValue=i.text,this.highlightItem(this.itemEls[n]),t||this.fireChangeEvent()}return this}setValueByIndex(e){return this.setValue(this.options[e].value)}getValue(){return this.value}getDisplayValue(){return this.displayValue}refreshHighlighted(){this.clearHighlighted();const e=this.options.findIndex(t=>t.value===this.value);e!==-1&&this.highlightItem(this.itemEls[e])}reset(e){this.value=null,this.displayValue=null,this.clearHighlighted(),e||this.fireChangeEvent()}highlightItem(e){if(!Fo(e))return;this.clearHighlighted(),this.highlightedEl=e,e.classList.add(this.activeClass),bT(e,!0);const t=this.getGui(),{scrollTop:n,clientHeight:i}=t,{offsetTop:r,offsetHeight:s}=e;(r+s>n+i||r<n)&&e.scrollIntoView({block:"nearest"}),this.unFocusable||e.focus()}clearHighlighted(){const e=this.highlightedEl;!e||!Fo(e)||(e.classList.remove(this.activeClass),bT(e,!1),this.highlightedEl=null)}fireChangeEvent(){this.dispatchLocalEvent({type:"fieldValueChanged"}),this.fireItemSelected()}fireItemSelected(){this.dispatchLocalEvent({type:"selectedItem"})}},_Ke=".ag-picker-field-display{flex:1 1 auto}.ag-picker-field{align-items:center;display:flex}.ag-picker-field-icon{border:0;cursor:pointer;display:flex;margin:0;padding:0}.ag-picker-field-wrapper{background-color:var(--ag-picker-button-background-color);border:var(--ag-picker-button-border);border-radius:5px;min-height:max(var(--ag-list-item-height),calc(var(--ag-spacing)*4));overflow:hidden;&:disabled{opacity:.5}&.ag-picker-has-focus,&:focus-within{background-color:var(--ag-picker-button-focus-background-color);border:var(--ag-picker-button-focus-border);box-shadow:var(--ag-focus-shadow)}}",OKe={tag:"div",cls:"ag-picker-field",role:"presentation",children:[{tag:"div",ref:"eLabel"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-picker-field-wrapper ag-picker-collapsed",children:[{tag:"div",ref:"eDisplayField",cls:"ag-picker-field-display"},{tag:"div",ref:"eIcon",cls:"ag-picker-field-icon",attrs:{"aria-hidden":"true"}}]}]},LKe=class extends qne{constructor(e){if(super(e,e?.template||OKe,e?.agComponents||[],e?.className),this.isPickerDisplayed=!1,this.skipClick=!1,this.pickerGap=4,this.hideCurrentPicker=null,this.eLabel=ge,this.eWrapper=ge,this.eDisplayField=ge,this.eIcon=ge,this.registerCSS(_Ke),this.ariaRole=e?.ariaRole,this.onPickerFocusIn=this.onPickerFocusIn.bind(this),this.onPickerFocusOut=this.onPickerFocusOut.bind(this),!e)return;const{pickerGap:t,maxPickerHeight:n,variableWidth:i,minPickerWidth:r,maxPickerWidth:s}=e;t!=null&&(this.pickerGap=t),this.variableWidth=!!i,n!=null&&this.setPickerMaxHeight(n),r!=null&&this.setPickerMinWidth(r),s!=null&&this.setPickerMaxWidth(s)}postConstruct(){super.postConstruct(),this.setupAria();const e=`ag-${this.getCompId()}-display`;this.eDisplayField.setAttribute("id",e);const t=this.getAriaElement();this.addManagedElementListeners(t,{keydown:this.onKeyDown.bind(this)}),this.addManagedElementListeners(this.eLabel,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)}),this.addManagedElementListeners(this.eWrapper,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)});const{pickerIcon:n,inputWidth:i}=this.config;if(n){const r=As(n,this.beans);r&&this.eIcon.appendChild(r)}i!=null&&this.setInputWidth(i)}setupAria(){const e=this.getAriaElement();e.setAttribute("tabindex",this.gos.get("tabIndex").toString()),wT(e,!1),this.ariaRole&&Bl(e,this.ariaRole)}onLabelOrWrapperMouseDown(e){if(e){const t=this.getFocusableElement();if(t!==this.eWrapper&&e?.target===t)return;e.preventDefault(),this.getFocusableElement().focus()}if(this.skipClick){this.skipClick=!1;return}this.isDisabled()||(this.isPickerDisplayed?this.hidePicker():this.showPicker())}onKeyDown(e){switch(e.key){case K.UP:case K.DOWN:case K.ENTER:case K.SPACE:e.preventDefault(),this.onLabelOrWrapperMouseDown();break;case K.ESCAPE:this.isPickerDisplayed&&(e.preventDefault(),e.stopPropagation(),this.hideCurrentPicker&&this.hideCurrentPicker());break}}showPicker(){this.isPickerDisplayed=!0,this.pickerComponent||(this.pickerComponent=this.createPickerComponent());const e=this.pickerComponent.getGui();e.addEventListener("focusin",this.onPickerFocusIn),e.addEventListener("focusout",this.onPickerFocusOut),this.hideCurrentPicker=this.renderAndPositionPicker(),this.toggleExpandedStyles(!0)}renderAndPositionPicker(){const e=this.pickerComponent.getGui();this.gos.get("suppressScrollWhenPopupsAreOpen")||([this.destroyMouseWheelFunc]=this.addManagedEventListeners({bodyScroll:()=>{this.hidePicker()}}));const t=this.getLocaleTextFunc(),{config:{pickerAriaLabelKey:n,pickerAriaLabelValue:i,modalPicker:r=!0},maxPickerHeight:s,minPickerWidth:o,maxPickerWidth:a,variableWidth:l,beans:u,eWrapper:c}=this,d={modal:r,eChild:e,closeOnEsc:!0,closedCallback:()=>{const v=jte(u);this.beforeHidePicker(),v&&this.isAlive()&&this.getFocusableElement().focus()},ariaLabel:t(n,i),anchorToElement:c};e.style.position="absolute";const h=u.popupSvc,p=h.addPopup(d);l?(o&&(e.style.minWidth=o),e.style.width=cN(GS(c)),a&&(e.style.maxWidth=a)):VS(e,a??GS(c));const g=s??`${uN(h.getPopupParent())}px`;return e.style.setProperty("max-height",g),this.alignPickerToComponent(),p.hideFunc}alignPickerToComponent(){if(!this.pickerComponent)return;const{pickerGap:e,config:{pickerType:t},beans:{popupSvc:n,gos:i},eWrapper:r,pickerComponent:s}=this,o=i.get("enableRtl")?"right":"left";n.positionPopupByComponent({type:t,eventSource:r,ePopup:s.getGui(),position:"under",alignSide:o,keepWithinBounds:!0,nudgeY:e})}beforeHidePicker(){this.destroyMouseWheelFunc&&(this.destroyMouseWheelFunc(),this.destroyMouseWheelFunc=void 0),this.toggleExpandedStyles(!1);const e=this.pickerComponent.getGui();e.removeEventListener("focusin",this.onPickerFocusIn),e.removeEventListener("focusout",this.onPickerFocusOut),this.isPickerDisplayed=!1,this.pickerComponent=void 0,this.hideCurrentPicker=null}toggleExpandedStyles(e){if(!this.isAlive())return;const t=this.getAriaElement();wT(t,e);const n=this.eWrapper.classList;n.toggle("ag-picker-expanded",e),n.toggle("ag-picker-collapsed",!e)}onPickerFocusIn(){this.togglePickerHasFocus(!0)}onPickerFocusOut(e){this.pickerComponent?.getGui().contains(e.relatedTarget)||this.togglePickerHasFocus(!1)}togglePickerHasFocus(e){this.pickerComponent&&this.eWrapper.classList.toggle("ag-picker-has-focus",e)}hidePicker(){this.hideCurrentPicker?.()}setInputWidth(e){return VS(this.eWrapper,e),this}getFocusableElement(){return this.eWrapper}setPickerGap(e){return this.pickerGap=e,this}setPickerMinWidth(e){return typeof e=="number"&&(e=`${e}px`),this.minPickerWidth=e??void 0,this}setPickerMaxWidth(e){return typeof e=="number"&&(e=`${e}px`),this.maxPickerWidth=e??void 0,this}setPickerMaxHeight(e){return typeof e=="number"&&(e=`${e}px`),this.maxPickerHeight=e??void 0,this}destroy(){this.hidePicker(),super.destroy()}},NKe=".ag-select{align-items:center;display:flex;&.ag-disabled{opacity:.5}}:where(.ag-select){.ag-picker-field-wrapper{cursor:default}&.ag-disabled .ag-picker-field-wrapper:focus{box-shadow:none}&:not(.ag-cell-editor,.ag-label-align-top){min-height:var(--ag-list-item-height)}.ag-picker-field-display{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ag-picker-field-icon{align-items:center;display:flex}}:where(.ag-ltr) :where(.ag-select){.ag-picker-field-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding)/2);padding-right:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-select){.ag-picker-field-wrapper{padding-left:var(--ag-spacing);padding-right:calc(var(--ag-cell-horizontal-padding)/2)}}",MN=class extends LKe{constructor(e){super({pickerAriaLabelKey:"ariaLabelSelectField",pickerAriaLabelValue:"Select Field",pickerType:"ag-list",className:"ag-select",pickerIcon:"selectOpen",ariaRole:"combobox",...e}),this.registerCSS(NKe)}postConstruct(){this.tooltipFeature=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("tooltipFeature",!1,{shouldDisplayTooltip:Yw(()=>this.eDisplayField),getGui:()=>this.getGui()})),super.postConstruct(),this.createListComponent(),this.eWrapper.tabIndex=this.gos.get("tabIndex");const{options:e,value:t,placeholder:n}=this.config;e!=null&&this.addOptions(e),t!=null&&this.setValue(t,!0),n&&t==null&&(this.eDisplayField.textContent=n),this.addManagedElementListeners(this.eWrapper,{focusout:this.onWrapperFocusOut.bind(this)})}onWrapperFocusOut(e){this.eWrapper.contains(e.relatedTarget)||this.hidePicker()}createListComponent(){const e=this.createBean(new IKe("select",!0));this.listComponent=e,e.setParentComponent(this);const t=e.getAriaElement(),n=`ag-select-list-${e.getCompId()}`;t.setAttribute("id",n),c9e(this.getAriaElement(),t),e.addManagedElementListeners(e.getGui(),{mousedown:i=>{i?.preventDefault()}}),e.addManagedListeners(e,{selectedItem:()=>{this.hidePicker(),this.dispatchLocalEvent({type:"selectedItem"})},fieldValueChanged:()=>{this.listComponent&&(this.setValue(this.listComponent.getValue(),!1,!0),this.hidePicker())}})}createPickerComponent(){return this.listComponent}onKeyDown(e){const{key:t}=e;switch(t===K.TAB&&this.hidePicker(),t){case K.ENTER:case K.UP:case K.DOWN:case K.PAGE_UP:case K.PAGE_DOWN:case K.PAGE_HOME:case K.PAGE_END:e.preventDefault(),this.isPickerDisplayed?this.listComponent?.handleKeyDown(e):super.onKeyDown(e);break;case K.ESCAPE:super.onKeyDown(e);break;case K.SPACE:this.isPickerDisplayed?e.preventDefault():super.onKeyDown(e);break}}showPicker(){const e=this.listComponent;e&&(super.showPicker(),e.refreshHighlighted())}addOptions(e){return e.forEach(t=>this.addOption(t)),this}addOption(e){return this.listComponent.addOption(e),this}clearOptions(){return this.listComponent?.clearOptions(),this.setValue(void 0,!0),this}setValue(e,t,n){const{listComponent:i,config:{placeholder:r},eDisplayField:s,tooltipFeature:o}=this;if(this.value===e||!i)return this;if(n||i.setValue(e,!0),i.getValue()===this.getValue())return this;let l=i.getDisplayValue();return l==null&&r&&(l=r),s.textContent=l,o?.setTooltipAndRefresh(l??null),super.setValue(e,t)}destroy(){this.listComponent=this.destroyBean(this.listComponent),super.destroy()}},$Ke={selector:"AG-SELECT",component:MN},PD={TAB_GUARD:"ag-tab-guard",TAB_GUARD_TOP:"ag-tab-guard-top",TAB_GUARD_BOTTOM:"ag-tab-guard-bottom"},BKe=class extends X{constructor(e){super(),this.skipTabGuardFocus=!1,this.forcingFocusOut=!1,this.allowFocus=!1;const{comp:t,eTopGuard:n,eBottomGuard:i,focusTrapActive:r,forceFocusOutWhenTabGuardsAreEmpty:s,isFocusableContainer:o,focusInnerElement:a,onFocusIn:l,onFocusOut:u,shouldStopEventPropagation:c,onTabKeyDown:d,handleKeyDown:h,isEmpty:p,eFocusableElement:g}=e;this.comp=t,this.eTopGuard=n,this.eBottomGuard=i,this.providedFocusInnerElement=a,this.eFocusableElement=g,this.focusTrapActive=!!r,this.forceFocusOutWhenTabGuardsAreEmpty=!!s,this.isFocusableContainer=!!o,this.providedFocusIn=l,this.providedFocusOut=u,this.providedShouldStopEventPropagation=c,this.providedOnTabKeyDown=d,this.providedHandleKeyDown=h,this.providedIsEmpty=p}postConstruct(){this.createManagedBean(new vg(this.eFocusableElement,{shouldStopEventPropagation:()=>this.shouldStopEventPropagation(),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e)})),this.activateTabGuards(),[this.eTopGuard,this.eBottomGuard].forEach(e=>this.addManagedElementListeners(e,{focus:this.onFocus.bind(this)}))}handleKeyDown(e){this.providedHandleKeyDown&&this.providedHandleKeyDown(e)}tabGuardsAreActive(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")}shouldStopEventPropagation(){return this.providedShouldStopEventPropagation?this.providedShouldStopEventPropagation():!1}activateTabGuards(){if(this.forcingFocusOut)return;const e=this.gos.get("tabIndex");this.comp.setTabIndex(e.toString())}deactivateTabGuards(){this.comp.setTabIndex()}onFocus(e){if(this.isFocusableContainer&&!this.eFocusableElement.contains(e.relatedTarget)&&!this.allowFocus){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}if(this.skipTabGuardFocus){this.skipTabGuardFocus=!1;return}if(this.forceFocusOutWhenTabGuardsAreEmpty&&(this.providedIsEmpty?this.providedIsEmpty():Lf(this.eFocusableElement,".ag-tab-guard").length===0)){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}if(this.isFocusableContainer&&this.eFocusableElement.contains(e.relatedTarget))return;const t=e.target===this.eBottomGuard;!(this.providedFocusInnerElement?this.providedFocusInnerElement(t):this.focusInnerElement(t))&&this.forceFocusOutWhenTabGuardsAreEmpty&&this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard)}findNextElementOutsideAndFocus(e){const t=Rn(this.beans),n=Lf(t.body,null,!0),i=n.indexOf(e?this.eTopGuard:this.eBottomGuard);if(i===-1)return;let r,s;e?(r=0,s=i):(r=i+1,s=n.length);const o=n.slice(r,s),a=this.gos.get("tabIndex");o.sort((l,u)=>{const c=parseInt(l.getAttribute("tabindex")||"0"),d=parseInt(u.getAttribute("tabindex")||"0");return d===a?1:c===a?-1:c===0?1:d===0?-1:c-d}),o[e?o.length-1:0]?.focus()}onFocusIn(e){this.focusTrapActive||this.forcingFocusOut||(this.providedFocusIn&&this.providedFocusIn(e),this.isFocusableContainer||this.deactivateTabGuards())}onFocusOut(e){this.focusTrapActive||(this.providedFocusOut&&this.providedFocusOut(e),this.eFocusableElement.contains(e.relatedTarget)||this.activateTabGuards())}onTabKeyDown(e){if(this.providedOnTabKeyDown){this.providedOnTabKeyDown(e);return}if(this.focusTrapActive||e.defaultPrevented)return;const t=this.tabGuardsAreActive();t&&this.deactivateTabGuards();const n=this.getNextFocusableElement(e.shiftKey);t&&setTimeout(()=>this.activateTabGuards(),0),n&&(n.focus(),e.preventDefault())}focusInnerElement(e=!1){const t=Lf(this.eFocusableElement);return this.tabGuardsAreActive()&&(t.splice(0,1),t.splice(t.length-1,1)),t.length?(t[e?t.length-1:0].focus({preventScroll:!0}),!0):!1}getNextFocusableElement(e){return xh(this.beans,this.eFocusableElement,!1,e)}forceFocusOutOfContainer(e=!1){if(this.forcingFocusOut)return;const t=e?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,this.forcingFocusOut=!0,t.focus(),window.setTimeout(()=>{this.forcingFocusOut=!1,this.activateTabGuards()})}isTabGuard(e,t){return e===this.eTopGuard&&!t||e===this.eBottomGuard&&(t??!0)}setAllowFocus(e){this.allowFocus=e}},GKe=class extends X{constructor(e){super(),this.comp=e}initialiseTabGuard(e){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.comp.getFocusableElement();const{eTopGuard:t,eBottomGuard:n,eFocusableElement:i}=this,r=[t,n],s={setTabIndex:C=>{r.forEach(y=>C!=null?y.setAttribute("tabindex",C):y.removeAttribute("tabindex"))}};this.addTabGuards(t,n);const{focusTrapActive:o=!1,onFocusIn:a,onFocusOut:l,focusInnerElement:u,handleKeyDown:c,onTabKeyDown:d,shouldStopEventPropagation:h,isEmpty:p,forceFocusOutWhenTabGuardsAreEmpty:g,isFocusableContainer:v}=e;this.tabGuardCtrl=this.createManagedBean(new BKe({comp:s,focusTrapActive:o,eTopGuard:t,eBottomGuard:n,eFocusableElement:i,onFocusIn:a,onFocusOut:l,focusInnerElement:u,handleKeyDown:c,onTabKeyDown:d,shouldStopEventPropagation:h,isEmpty:p,forceFocusOutWhenTabGuardsAreEmpty:g,isFocusableContainer:v}))}getTabGuardCtrl(){return this.tabGuardCtrl}createTabGuard(e){const t=Rn(this.beans).createElement("div"),n=e==="top"?PD.TAB_GUARD_TOP:PD.TAB_GUARD_BOTTOM;return t.classList.add(PD.TAB_GUARD,n),Bl(t,"presentation"),t}addTabGuards(e,t){const n=this.eFocusableElement;n.insertAdjacentElement("afterbegin",e),n.insertAdjacentElement("beforeend",t)}removeAllChildrenExceptTabGuards(){const e=[this.eTopGuard,this.eBottomGuard];Ii(this.comp.getFocusableElement()),this.addTabGuards(...e)}forceFocusOutOfContainer(e=!1){this.tabGuardCtrl.forceFocusOutOfContainer(e)}appendChild(e,t,n){dN(t)||(t=t.getGui());const{eBottomGuard:i}=this;i?i.insertAdjacentElement("beforebegin",t):e(t,n)}destroy(){const{eTopGuard:e,eBottomGuard:t}=this;Fs(e),Fs(t),super.destroy()}},Yne=class extends bt{initialiseTabGuard(e){this.tabGuardFeature=this.createManagedBean(new GKe(this)),this.tabGuardFeature.initialiseTabGuard(e)}forceFocusOutOfContainer(e=!1){this.tabGuardFeature.forceFocusOutOfContainer(e)}appendChild(e,t){this.tabGuardFeature.appendChild(super.appendChild.bind(this),e,t)}},Cg=class extends bt{isPopup(){return!0}setParentComponent(e){e.addCssClass("ag-has-popup"),super.setParentComponent(e)}destroy(){const e=this.parentComponent;e&&e.isAlive()&&e.getGui().classList.remove("ag-has-popup"),super.destroy()}},af=class{constructor(e,t=!1){this.DOUBLE_TAP_MILLIS=500,this.destroyFuncs=[],this.touching=!1,this.localEventService=new Jd,this.preventMouseClick=t;const n=this.onTouchStart.bind(this),i=this.onTouchMove.bind(this),r=this.onTouchEnd.bind(this);e.addEventListener("touchstart",n,{passive:!0}),e.addEventListener("touchmove",i,{passive:!0}),e.addEventListener("touchend",r,{passive:!1}),this.destroyFuncs.push(()=>{e.removeEventListener("touchstart",n,{passive:!0}),e.removeEventListener("touchmove",i,{passive:!0}),e.removeEventListener("touchend",r,{passive:!1})})}getActiveTouch(e){for(let t=0;t<e.length;t++)if(e[t].identifier===this.touchStart.identifier)return e[t];return null}addEventListener(e,t){this.localEventService.addEventListener(e,t)}removeEventListener(e,t){this.localEventService.removeEventListener(e,t)}onTouchStart(e){if(this.touching)return;this.touchStart=e.touches[0],this.touching=!0,this.moved=!1;const t=this.touchStart;window.setTimeout(()=>{const n=this.touchStart===t;if(this.touching&&n&&!this.moved){this.moved=!0;const i={type:"longTap",touchStart:this.touchStart,touchEvent:e};this.localEventService.dispatchEvent(i)}},500)}onTouchMove(e){if(!this.touching)return;const t=this.getActiveTouch(e.touches);if(!t)return;!Pne(t,this.touchStart,4)&&(this.moved=!0)}onTouchEnd(e){if(this.touching){if(!this.moved){const t={type:"tap",touchStart:this.touchStart};this.localEventService.dispatchEvent(t),this.checkForDoubleTap()}this.preventMouseClick&&e.cancelable&&e.preventDefault(),this.touching=!1}}checkForDoubleTap(){const e=Date.now();if(this.lastTapTime&&this.lastTapTime>0)if(e-this.lastTapTime>this.DOUBLE_TAP_MILLIS){const n={type:"doubleTap",touchStart:this.touchStart};this.localEventService.dispatchEvent(n),this.lastTapTime=null}else this.lastTapTime=e;else this.lastTapTime=e}destroy(){this.destroyFuncs.forEach(e=>e())}},Xne=class{constructor(e="javascript"){this.frameworkName=e,this.renderingEngine="vanilla",this.batchFrameworkComps=!1,this.wrapIncoming=t=>t(),this.wrapOutgoing=t=>t(),this.baseDocLink=`${Lte}/${this.frameworkName}-data-grid`,x9e(this.baseDocLink)}setInterval(e,t){return new Ji(n=>{n(window.setInterval(e,t))})}addEventListener(e,t,n,i){let r={};if(typeof i=="object"?r=i:typeof i=="boolean"&&(r={capture:i}),r.passive==null){const s=Zte(t);s!=null&&(r.passive=s)}e.addEventListener(t,n,r)}frameworkComponent(e){return null}isFrameworkComponent(e){return!1}getDocLink(e){return`${this.baseDocLink}${e?`/${e}`:""}`}};function zKe(e){return{beanName:"gridApi",bean:e.getBean("apiFunctionSvc").api}}var HKe=["licenseManager","environment","eventSvc","gos","paginationAutoPageSizeSvc","apiFunctionSvc","gridApi","registry","agCompUtils","userCompFactory","rowContainerHeight","horizontalResizeSvc","localeSvc","pinnedRowModel","dragSvc","colGroupSvc","visibleCols","popupSvc","selectionSvc","colFilter","quickFilter","filterManager","colModel","headerNavigation","pageBounds","pagination","pageBoundsListener","rowSpanSvc","stickyRowSvc","rowRenderer","expressionSvc","alignedGridsSvc","navigation","valueCache","valueSvc","autoWidthCalc","filterMenuFactory","dragAndDrop","focusSvc","cellNavigation","cellStyles","scrollVisibleSvc","sortSvc","colHover","colAnimation","autoColSvc","selectionColSvc","changeDetectionSvc","animationFrameSvc","undoRedo","colDefFactory","rowStyleSvc","rowNodeBlockLoader","rowNodeSorter","ctrlsSvc","pinnedCols","dataTypeSvc","syncSvc","overlays","stateSvc","expansionSvc","apiEventSvc","ariaAnnounce","menuSvc","colMoves","colAutosize","colFlex","colResize","pivotColsSvc","valueColsSvc","rowGroupColsSvc","funcColsSvc","colNames","colViewport","pivotResultCols","showRowGroupCols","validation"],dW=Object.fromEntries(HKe.map((e,t)=>[e,t]));function VKe(e,t){const n=(e.beanName?dW[e.beanName]:void 0)??Number.MAX_SAFE_INTEGER,i=(t.beanName?dW[t.beanName]:void 0)??Number.MAX_SAFE_INTEGER;return n-i}function WKe(e,t){return e?.beanName==="gridDestroySvc"?-1:0}var UKe={tag:"div",cls:"ag-pinned-left-header",role:"rowgroup"},jKe={tag:"div",cls:"ag-pinned-right-header",role:"rowgroup"},qKe={tag:"div",cls:"ag-header-viewport",role:"presentation",attrs:{tabindex:"-1"},children:[{tag:"div",ref:"eCenterContainer",cls:"ag-header-container",role:"rowgroup"}]},kD=class extends bt{constructor(e){super(),this.eCenterContainer=ge,this.headerRowComps={},this.rowCompsList=[],this.pinned=e}postConstruct(){this.selectAndSetTemplate();const e={setDisplayed:n=>this.setDisplayed(n),setCtrls:n=>this.setCtrls(n),setCenterWidth:n=>this.eCenterContainer.style.width=n,setViewportScrollLeft:n=>this.getGui().scrollLeft=n,setPinnedContainerWidth:n=>{const i=this.getGui();i.style.width=n,i.style.maxWidth=n,i.style.minWidth=n}};this.createManagedBean(new tKe(this.pinned)).setComp(e,this.getGui())}selectAndSetTemplate(){const e=this.pinned=="left",t=this.pinned=="right",n=e?UKe:t?jKe:qKe;this.setTemplate(n),this.eRowContainer=this.eCenterContainer!==ge?this.eCenterContainer:this.getGui()}destroy(){this.setCtrls([]),super.destroy()}destroyRowComp(e){this.destroyBean(e),this.eRowContainer.removeChild(e.getGui())}setCtrls(e){const t=this.headerRowComps;this.headerRowComps={},this.rowCompsList=[];let n;const i=r=>{const s=r.getGui();s.parentElement!=this.eRowContainer&&this.eRowContainer.appendChild(s),n&&Ite(this.eRowContainer,s,n),n=s};e.forEach(r=>{const s=r.instanceId,o=t[s];delete t[s];const a=o||this.createBean(new Qqe(r));this.headerRowComps[s]=a,this.rowCompsList.push(a),i(a)}),Object.values(t).forEach(r=>this.destroyRowComp(r))}},KKe={tag:"div",cls:"ag-header",role:"presentation"},YKe=class extends bt{constructor(){super(KKe)}postConstruct(){const e={addOrRemoveCssClass:(i,r)=>this.addOrRemoveCssClass(i,r),setHeightAndMinHeight:i=>{this.getGui().style.height=i,this.getGui().style.minHeight=i}};this.createManagedBean(new Wqe).setComp(e,this.getGui(),this.getFocusableElement());const n=i=>{this.createManagedBean(i),this.appendChild(i)};n(new kD("left")),n(new kD(null)),n(new kD("right"))}},XKe={selector:"AG-HEADER-ROOT",component:YKe},QKe=class extends bt{constructor(e,t,n,i,r){super(),this.cellCtrl=t,this.rendererVersion=0,this.editorVersion=0,this.beans=e,this.column=t.column,this.rowNode=t.rowNode,this.eRow=i;const s=Cn({tag:"div",role:t.getCellAriaRole(),attrs:{"comp-id":`${this.getCompId()}`,"col-id":t.colIdSanitised}});this.eCell=s;let o;t.isCellSpanning()?(o=Cn({tag:"div",cls:"ag-spanned-cell-wrapper",role:"presentation"}),o.appendChild(s),this.setTemplateFromElement(o)):this.setTemplateFromElement(s),this.cellCssClassManager=new pne(()=>s),this.forceWrapper=t.isForceWrapper(),this.refreshWrapper(!1);const a={addOrRemoveCssClass:(l,u)=>this.cellCssClassManager.addOrRemoveCssClass(l,u),setUserStyles:l=>yC(s,l),getFocusableElement:()=>s,setIncludeSelection:l=>this.includeSelection=l,setIncludeRowDrag:l=>this.includeRowDrag=l,setIncludeDndSource:l=>this.includeDndSource=l,setRenderDetails:(l,u,c)=>this.setRenderDetails(l,u,c),setEditDetails:(l,u,c)=>this.setEditDetails(l,u,c),getCellEditor:()=>this.cellEditor||null,getCellRenderer:()=>this.cellRenderer||null,getParentOfValue:()=>this.getParentOfValue()};t.setComp(a,s,o,this.eCellWrapper,n,r,void 0)}getParentOfValue(){return this.eCellValue??this.eCellWrapper??this.eCell}setRenderDetails(e,t,n){if(this.cellEditor&&!this.cellEditorPopupWrapper)return;this.firstRender=this.firstRender==null;const r=this.refreshWrapper(!1);this.refreshEditStyles(!1),e?!(n||r)&&this.refreshCellRenderer(e)||(this.destroyRenderer(),this.createCellRendererInstance(e)):(this.destroyRenderer(),this.insertValueWithoutCellRenderer(t))}setEditDetails(e,t,n){e?this.createCellEditorInstance(e,t,n):this.destroyEditor()}removeControls(){const e=this.beans.context;this.checkboxSelectionComp=e.destroyBean(this.checkboxSelectionComp),this.dndSourceComp=e.destroyBean(this.dndSourceComp),this.rowDraggingComp=e.destroyBean(this.rowDraggingComp)}refreshWrapper(e){const t=this.includeRowDrag||this.includeDndSource||this.includeSelection,n=t||this.forceWrapper,i=n&&this.eCellWrapper==null;i&&(this.eCellWrapper=Cn({tag:"div",cls:"ag-cell-wrapper",role:"presentation"}),this.eCell.appendChild(this.eCellWrapper));const r=!n&&this.eCellWrapper!=null;r&&(Fs(this.eCellWrapper),this.eCellWrapper=void 0),this.cellCssClassManager.addOrRemoveCssClass("ag-cell-value",!n);const s=!e&&n,o=s&&this.eCellValue==null;o&&(this.eCellValue=Cn({tag:"span",cls:"ag-cell-value",role:"presentation"}),this.eCellWrapper.appendChild(this.eCellValue));const a=!s&&this.eCellValue!=null;a&&(Fs(this.eCellValue),this.eCellValue=void 0);const l=i||r||o||a;return l&&this.removeControls(),!e&&t&&this.addControls(),l}addControls(){const{cellCtrl:e,eCellWrapper:t,eCellValue:n,includeRowDrag:i,includeDndSource:r,includeSelection:s}=this,o=a=>{a&&t.insertBefore(a.getGui(),n)};i&&this.rowDraggingComp==null&&(this.rowDraggingComp=e.createRowDragComp(),o(this.rowDraggingComp)),r&&this.dndSourceComp==null&&(this.dndSourceComp=e.createDndSource(),o(this.dndSourceComp)),s&&this.checkboxSelectionComp==null&&(this.checkboxSelectionComp=e.createSelectionCheckbox(),o(this.checkboxSelectionComp))}createCellEditorInstance(e,t,n){const i=this.editorVersion,r=e.newAgStackInstance(),{params:s}=e;r.then(a=>this.afterCellEditorCreated(i,a,s,t,n)),Wt(this.cellEditor)&&s.cellStartedEdit&&this.cellCtrl.focusCell(!0)}insertValueWithoutCellRenderer(e){const t=this.getParentOfValue();Ii(t);const n=e!=null?Fl(e,!0):null;n!=null&&(t.textContent=n)}destroyRenderer(){const{context:e}=this.beans;this.cellRenderer=e.destroyBean(this.cellRenderer),Fs(this.cellRendererGui),this.cellRendererGui=null,this.rendererVersion++}destroyEditor(){const{context:e}=this.beans;(this.cellEditorPopupWrapper?.getGui().contains(Xt(this.beans))||this.cellCtrl.hasBrowserFocus())&&this.eCell.focus({preventScroll:!0}),this.hideEditorPopup?.(),this.hideEditorPopup=void 0,this.cellEditor=e.destroyBean(this.cellEditor),this.cellEditorPopupWrapper=e.destroyBean(this.cellEditorPopupWrapper),Fs(this.cellEditorGui),this.cellEditorGui=null,this.editorVersion++}refreshCellRenderer(e){if(this.cellRenderer?.refresh==null||this.cellRendererClass!==e.componentClass)return!1;const t=this.cellRenderer.refresh(e.params);return t===!0||t===void 0}createCellRendererInstance(e){const t=this.rendererVersion,{componentClass:n}=e,i=()=>{if(this.rendererVersion!==t||!this.isAlive())return;const o=e.newAgStackInstance(),a=this.afterCellRendererCreated.bind(this,t,n);o?.then(a)},{animationFrameSvc:r}=this.beans;r?.active&&this.firstRender?r.createTask(i,this.rowNode.rowIndex,"p2",e.componentFromFramework):i()}afterCellRendererCreated(e,t,n){if(!this.isAlive()||e!==this.rendererVersion){this.beans.context.destroyBean(n);return}this.cellRenderer=n,this.cellRendererClass=t;const r=n.getGui();if(this.cellRendererGui=r,r!=null){const s=this.getParentOfValue();Ii(s),s.appendChild(r)}}afterCellEditorCreated(e,t,n,i,r){const s=e!==this.editorVersion,{context:o}=this.beans;if(s){o.destroyBean(t);return}if(t.isCancelBeforeStart&&t.isCancelBeforeStart()){o.destroyBean(t),this.cellCtrl.stopEditing(!0);return}if(!t.getGui){ue(97,{colId:this.column.getId()}),o.destroyBean(t);return}this.cellEditor=t,this.cellEditorGui=t.getGui();const l=i||t.isPopup!==void 0&&t.isPopup();l?this.addPopupCellEditor(n,r):this.addInCellEditor(),this.refreshEditStyles(!0,l),t.afterGuiAttached?.(),this.cellCtrl.cellEditorAttached()}refreshEditStyles(e,t){const{cellCssClassManager:n}=this;n.addOrRemoveCssClass("ag-cell-inline-editing",e&&!t),n.addOrRemoveCssClass("ag-cell-popup-editing",e&&!!t),n.addOrRemoveCssClass("ag-cell-not-inline-editing",!e||!!t),this.cellCtrl.setInlineEditingCss()}addInCellEditor(){const{eCell:e}=this;e.contains(Xt(this.beans))&&e.focus(),this.destroyRenderer(),this.refreshWrapper(!0),Ii(this.getParentOfValue()),this.cellEditorGui&&this.getParentOfValue().appendChild(this.cellEditorGui)}addPopupCellEditor(e,t){const{gos:n,context:i,editSvc:r,popupSvc:s,localeSvc:o}=this.beans;n.get("editType")==="fullRow"&&ue(98);const a=this.cellEditor;this.cellEditorPopupWrapper=i.createBean(r.createPopupEditorWrapper(e));const l=this.cellEditorPopupWrapper.getGui();this.cellEditorGui&&l.appendChild(this.cellEditorGui);const u=n.get("stopEditingWhenCellsLoseFocus"),c=t??a.getPopupPosition?.()??"over",d=n.get("enableRtl"),h={ePopup:l,column:this.column,rowNode:this.rowNode,type:"popupCellEditor",eventSource:this.eCell,position:c,alignSide:d?"right":"left",keepWithinBounds:!0},p=s.positionPopupByComponent.bind(s,h),g=yte(o),v=s.addPopup({modal:u,eChild:l,closeOnEsc:!0,closedCallback:()=>{this.cellCtrl.onPopupEditorClosed()},anchorToElement:this.eCell,positionCallback:p,ariaLabel:g("ariaLabelCellEditor","Cell Editor")});v&&(this.hideEditorPopup=v.hideFunc)}detach(){this.eRow.removeChild(this.getGui())}destroy(){this.cellCtrl.stopEditing(),this.destroyRenderer(),this.destroyEditor(),this.removeControls(),super.destroy()}},JKe=class extends bt{constructor(e,t,n){super(),this.cellComps=new Map,this.beans=t,this.rowCtrl=e;const i=Cn({tag:"div",role:"row",attrs:{"comp-id":`${this.getCompId()}`}});this.setInitialStyle(i,n),this.setTemplateFromElement(i);const r=i.style;this.domOrder=this.rowCtrl.getDomOrder();const s={setDomOrder:o=>this.domOrder=o,setCellCtrls:o=>this.setCellCtrls(o),showFullWidth:o=>this.showFullWidth(o),getFullWidthCellRenderer:()=>this.fullWidthCellRenderer,addOrRemoveCssClass:(o,a)=>this.addOrRemoveCssClass(o,a),setUserStyles:o=>yC(i,o),setTop:o=>r.top=o,setTransform:o=>r.transform=o,setRowIndex:o=>i.setAttribute("row-index",o),setRowId:o=>i.setAttribute("row-id",o),setRowBusinessKey:o=>i.setAttribute("row-business-key",o),refreshFullWidth:o=>this.fullWidthCellRenderer?.refresh?.(o())??!1};e.setComp(s,this.getGui(),n,void 0),this.addDestroyFunc(()=>{e.unsetComp(n)})}setInitialStyle(e,t){const n=this.rowCtrl.getInitialTransform(t);if(n)e.style.setProperty("transform",n);else{const i=this.rowCtrl.getInitialRowTop(t);i&&e.style.setProperty("top",i)}}showFullWidth(e){const t=i=>{if(this.isAlive()){const r=i.getGui();this.getGui().appendChild(r),this.rowCtrl.setupDetailRowAutoHeight(r),this.setFullWidthRowComp(i)}else this.beans.context.destroyBean(i)};e.newAgStackInstance().then(t)}setCellCtrls(e){const t=new Map(this.cellComps);for(const n of e){const i=n.instanceId;this.cellComps.has(i)?t.delete(i):this.newCellComp(n)}this.destroyCells(t),this.ensureDomOrder(e)}ensureDomOrder(e){if(!this.domOrder)return;const t=[];for(const n of e){const i=this.cellComps.get(n.instanceId);i&&t.push(i.getGui())}_te(this.getGui(),t)}newCellComp(e){const t=new QKe(this.beans,e,this.rowCtrl.printLayout,this.getGui(),this.rowCtrl.editing);this.cellComps.set(e.instanceId,t),this.getGui().appendChild(t.getGui())}destroy(){super.destroy(),this.destroyCells(this.cellComps)}setFullWidthRowComp(e){this.fullWidthCellRenderer=e,this.addDestroyFunc(()=>{this.fullWidthCellRenderer=this.beans.context.destroyBean(this.fullWidthCellRenderer)})}destroyCells(e){for(const t of e.values()){if(!t)return;const n=t.cellCtrl.instanceId;if(this.cellComps.get(n)!==t)return;t.detach(),t.destroy(),this.cellComps.delete(n)}}};function ZKe(e,t,n){const i=!!n.gos.get("enableCellSpan")&&!!t.getSpannedRowCtrls,r={tag:"div",ref:"eContainer",cls:Kw(e),role:"rowgroup"};if(t.type==="center"||i){const s={tag:"div",ref:"eSpannedContainer",cls:`ag-spanning-container ${wqe(e)}`,role:"rowgroup"};return{tag:"div",ref:"eViewport",cls:`ag-viewport ${$ne(e)}`,role:"presentation",children:[r,i?s:null]}}return r}var eYe=class extends bt{constructor(e){super(),this.eViewport=ge,this.eContainer=ge,this.eSpannedContainer=ge,this.rowCompsNoSpan={},this.rowCompsWithSpan={},this.name=e?.name,this.options=bC(this.name)}postConstruct(){this.setTemplate(ZKe(this.name,this.options,this.beans));const e={setHorizontalScroll:n=>this.eViewport.scrollLeft=n,setViewportHeight:n=>this.eViewport.style.height=n,setRowCtrls:({rowCtrls:n})=>this.setRowCtrls(n),setSpannedRowCtrls:n=>this.setRowCtrls(n,!0),setDomOrder:n=>{this.domOrder=n},setContainerWidth:n=>{this.eContainer.style.width=n,this.eSpannedContainer&&(this.eSpannedContainer.style.width=n)},setOffsetTop:n=>{const i=`translateY(${n})`;this.eContainer.style.transform=i,this.eSpannedContainer&&(this.eSpannedContainer.style.transform=i)}};this.createManagedBean(new kqe(this.name)).setComp(e,this.eContainer,this.eSpannedContainer,this.eViewport)}destroy(){this.setRowCtrls([]),this.setRowCtrls([],!0),super.destroy(),this.lastPlacedElement=null}setRowCtrls(e,t){const{beans:n,options:i}=this,r=t?this.eSpannedContainer:this.eContainer,s=t?{...this.rowCompsWithSpan}:{...this.rowCompsNoSpan},o={};t?this.rowCompsWithSpan=o:this.rowCompsNoSpan=o,this.lastPlacedElement=null;const a=[];for(const l of e){const u=l.instanceId,c=s[u];let d;if(c)d=c,delete s[u];else{if(!l.rowNode.displayed)continue;d=new JKe(l,n,i.type)}o[u]=d,a.push([d,!c])}this.removeOldRows(Object.values(s),r),this.addRowNodes(a,r)}addRowNodes(e,t){const{domOrder:n}=this;for(const[i,r]of e){const s=i.getGui();n?this.ensureDomOrder(s,t):r&&t.appendChild(s)}}removeOldRows(e,t){for(const n of e)t.removeChild(n.getGui()),n.destroy()}ensureDomOrder(e,t){Ite(t,e,this.lastPlacedElement),this.lastPlacedElement=e}},tYe={selector:"AG-ROW-CONTAINER",component:eYe};function fm(e,t){return t.map(n=>{const i=`e${n[0].toUpperCase()+n.substring(1)}RowContainer`;return e[i]={name:n},{tag:"ag-row-container",ref:i,attrs:{name:n}}})}function nYe(e){const t={},n={tag:"div",ref:"eGridRoot",cls:"ag-root ag-unselectable",children:[{tag:"ag-header-root"},{tag:"div",ref:"eTop",cls:"ag-floating-top",role:"presentation",children:fm(t,["topLeft","topCenter","topRight","topFullWidth"])},{tag:"div",ref:"eBody",cls:"ag-body",role:"presentation",children:[{tag:"div",ref:"eBodyViewport",cls:"ag-body-viewport",role:"presentation",children:fm(t,["left","center","right","fullWidth"])},{tag:"ag-fake-vertical-scroll"}]},{tag:"div",ref:"eStickyTop",cls:"ag-sticky-top",role:"presentation",children:fm(t,["stickyTopLeft","stickyTopCenter","stickyTopRight","stickyTopFullWidth"])},{tag:"div",ref:"eStickyBottom",cls:"ag-sticky-bottom",role:"presentation",children:fm(t,["stickyBottomLeft","stickyBottomCenter","stickyBottomRight","stickyBottomFullWidth"])},{tag:"div",ref:"eBottom",cls:"ag-floating-bottom",role:"presentation",children:fm(t,["bottomLeft","bottomCenter","bottomRight","bottomFullWidth"])},{tag:"ag-fake-horizontal-scroll"},e?{tag:"ag-overlay-wrapper"}:null]};return{paramsMap:t,elementParams:n}}var iYe=class extends bt{constructor(){super(...arguments),this.eGridRoot=ge,this.eBodyViewport=ge,this.eStickyTop=ge,this.eStickyBottom=ge,this.eTop=ge,this.eBottom=ge,this.eBody=ge}postConstruct(){const{overlays:e,rangeSvc:t}=this.beans,n=e?.getOverlayWrapperSelector(),{paramsMap:i,elementParams:r}=nYe(!!n);this.setTemplate(r,[...n?[n]:[],Lqe,Bqe,XKe,tYe],i);const s=(a,l)=>{const u=`${a}px`;l.style.minHeight=u,l.style.height=u},o={setRowAnimationCssOnBodyViewport:(a,l)=>this.setRowAnimationCssOnBodyViewport(a,l),setColumnCount:a=>o9e(this.getGui(),a),setRowCount:a=>r9e(this.getGui(),a),setTopHeight:a=>s(a,this.eTop),setBottomHeight:a=>s(a,this.eBottom),setTopInvisible:a=>this.eTop.classList.toggle("ag-invisible",a),setBottomInvisible:a=>this.eBottom.classList.toggle("ag-invisible",a),setStickyTopHeight:a=>this.eStickyTop.style.height=a,setStickyTopTop:a=>this.eStickyTop.style.top=a,setStickyTopWidth:a=>this.eStickyTop.style.width=a,setStickyBottomHeight:a=>{this.eStickyBottom.style.height=a,this.eStickyBottom.classList.toggle("ag-invisible",a==="0px")},setStickyBottomBottom:a=>this.eStickyBottom.style.bottom=a,setStickyBottomWidth:a=>this.eStickyBottom.style.width=a,setColumnMovingCss:(a,l)=>this.addOrRemoveCssClass(a,l),updateLayoutClasses:(a,l)=>{const u=[this.eBodyViewport.classList,this.eBody.classList];for(const c of u)c.toggle(so.AUTO_HEIGHT,l.autoHeight),c.toggle(so.NORMAL,l.normal),c.toggle(so.PRINT,l.print);this.addOrRemoveCssClass(so.AUTO_HEIGHT,l.autoHeight),this.addOrRemoveCssClass(so.NORMAL,l.normal),this.addOrRemoveCssClass(so.PRINT,l.print)},setAlwaysVerticalScrollClass:(a,l)=>this.eBodyViewport.classList.toggle(zne,l),registerBodyViewportResizeListener:a=>{const l=Pc(this.beans,this.eBodyViewport,a);this.addDestroyFunc(()=>l())},setPinnedTopBottomOverflowY:a=>this.eTop.style.overflowY=this.eBottom.style.overflowY=a,setCellSelectableCss:(a,l)=>{[this.eTop,this.eBodyViewport,this.eBottom].forEach(u=>u.classList.toggle(a,l))},setBodyViewportWidth:a=>this.eBodyViewport.style.width=a,setGridRootRole:a=>Bl(this.eGridRoot,a)};this.ctrl=this.createManagedBean(new Iqe),this.ctrl.setComp(o,this.getGui(),this.eBodyViewport,this.eTop,this.eBottom,this.eStickyTop,this.eStickyBottom),(t&&Gl(this.gos)||c0(this.gos))&&i9e(this.getGui(),!0)}setRowAnimationCssOnBodyViewport(e,t){const n=this.eBodyViewport.classList;n.toggle("ag-row-animation",t),n.toggle("ag-row-no-animation",!t)}},rYe={selector:"AG-GRID-BODY",component:iYe},sYe=class extends X{constructor(){super(...arguments),this.additionalFocusableContainers=new Set}setComp(e,t,n){this.view=e,this.eGridHostDiv=t,this.eGui=n,this.eGui.setAttribute("grid-id",this.beans.context.getGridId());const{dragAndDrop:i,ctrlsSvc:r}=this.beans;i?.registerGridDropTarget(()=>this.eGui,this),Ene(this.gos,t),this.createManagedBean(new bN(this.view)),this.view.setRtlClass(this.gos.get("enableRtl")?"ag-rtl":"ag-ltr");const s=Pc(this.beans,this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc(()=>s()),r.register("gridCtrl",this)}isDetailGrid(){return Sne(this.getGui())?.getAttribute("row-id")?.startsWith("detail")||!1}getOptionalSelectors(){const e=this.beans;return{paginationSelector:e.pagination?.getPaginationSelector(),gridHeaderDropZonesSelector:e.registry.getSelector("AG-GRID-HEADER-DROP-ZONES"),sideBarSelector:e.sideBar?.getSelector(),statusBarSelector:e.registry?.getSelector("AG-STATUS-BAR"),watermarkSelector:e.licenseManager?.getWatermarkSelector()}}onGridSizeChanged(){this.eventSvc.dispatchEvent({type:"gridSizeChanged",clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight})}destroyGridUi(){this.view.destroyGridUi()}getGui(){return this.eGui}setResizeCursor(e){this.view.setCursor(e?"ew-resize":null)}disableUserSelect(e){this.view.setUserSelect(e?"none":null)}focusNextInnerContainer(e){const t=this.getFocusableContainers(),{indexWithFocus:n,nextIndex:i}=this.getNextFocusableIndex(t,e);if(i<0||i>=t.length)return!1;if(i===0){if(n>0){const{visibleCols:r,focusSvc:s}=this.beans,o=r.allCols,a=Tt(o);if(s.focusGridView({column:a,backwards:!0}))return!0}return!1}return this.focusContainer(t[i],e)}focusInnerElement(e){const t=this.gos.getCallback("focusGridInnerElement");if(t&&t({fromBottom:!!e}))return!0;const n=this.getFocusableContainers(),{focusSvc:i,visibleCols:r}=this.beans,s=r.allCols;if(e){if(n.length>1)return this.focusContainer(Tt(n),e);const o=Tt(s);if(i.focusGridView({column:o,backwards:e}))return!0}if(this.gos.get("headerHeight")===0||Ad(this.beans)){if(i.focusGridView({column:s[0],backwards:e}))return!0;for(let o=1;o<n.length;o++)if(eh(n[o].getGui(),e))return!0;return!1}return i.focusFirstHeader()}forceFocusOutOfContainer(e=!1){this.view.forceFocusOutOfContainer(e)}addFocusableContainer(e){this.additionalFocusableContainers.add(e)}removeFocusableContainer(e){this.additionalFocusableContainers.delete(e)}allowFocusForNextCoreContainer(e){const t=this.view.getFocusableContainers(),{nextIndex:n,indexWithFocus:i}=this.getNextFocusableIndex(t,e);if(i===-1||n<0||n>=t.length)return;const r=t[n];r.setAllowFocus?.(!0),setTimeout(()=>{r.setAllowFocus?.(!1)})}isFocusable(){const e=this.beans;return!_R(e)||!Ad(e)||!!e.sideBar?.comp?.isDisplayed()}getNextFocusableIndex(e,t){const n=Xt(this.beans),i=e.findIndex(s=>s.getGui().contains(n)),r=i+(t?-1:1);return{indexWithFocus:i,nextIndex:r}}focusContainer(e,t){e.setAllowFocus?.(!0);const n=eh(e.getGui(),t,!1,!0);return e.setAllowFocus?.(!1),n}getFocusableContainers(){return[...this.view.getFocusableContainers(),...this.additionalFocusableContainers]}destroy(){this.additionalFocusableContainers.clear(),super.destroy()}},oYe=class extends Yne{constructor(e){super(),this.gridBody=ge,this.sideBar=ge,this.pagination=ge,this.rootWrapperBody=ge,this.eGridDiv=e}postConstruct(){const e={destroyGridUi:()=>this.destroyBean(this),setRtlClass:s=>this.addCssClass(s),forceFocusOutOfContainer:this.forceFocusOutOfContainer.bind(this),updateLayoutClasses:this.updateLayoutClasses.bind(this),getFocusableContainers:this.getFocusableContainers.bind(this),setUserSelect:s=>{this.getGui().style.userSelect=s??"",this.getGui().style.webkitUserSelect=s??""},setCursor:s=>{this.getGui().style.cursor=s??""}},t=this.createManagedBean(new sYe),n=t.getOptionalSelectors(),i=this.createTemplate(n),r=[rYe,...Object.values(n).filter(s=>!!s)];this.setTemplate(i,r),t.setComp(e,this.eGridDiv,this.getGui()),this.insertGridIntoDom(),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:s=>t.focusInnerElement(s),forceFocusOutWhenTabGuardsAreEmpty:!0,isEmpty:()=>!t.isFocusable()})}insertGridIntoDom(){const e=this.getGui();this.eGridDiv.appendChild(e),this.addDestroyFunc(()=>{this.eGridDiv.removeChild(e),ac(this.gos,"Grid removed from DOM")})}updateLayoutClasses(e,t){const n=this.rootWrapperBody.classList,{AUTO_HEIGHT:i,NORMAL:r,PRINT:s}=so,{autoHeight:o,normal:a,print:l}=t;n.toggle(i,o),n.toggle(r,a),n.toggle(s,l),this.addOrRemoveCssClass(i,o),this.addOrRemoveCssClass(r,a),this.addOrRemoveCssClass(s,l)}createTemplate(e){const t=e.gridHeaderDropZonesSelector?{tag:"ag-grid-header-drop-zones"}:null,n=e.sideBarSelector?{tag:"ag-side-bar",ref:"sideBar"}:null,i=e.statusBarSelector?{tag:"ag-status-bar"}:null,r=e.watermarkSelector?{tag:"ag-watermark"}:null,s=e.paginationSelector?{tag:"ag-pagination",ref:"pagination"}:null;return{tag:"div",cls:"ag-root-wrapper",role:"presentation",children:[t,{tag:"div",ref:"rootWrapperBody",cls:"ag-root-wrapper-body",role:"presentation",children:[{tag:"ag-grid-body",ref:"gridBody"},n]},i,s,r]}}getFocusableElement(){return this.rootWrapperBody}forceFocusOutOfContainer(e=!1){if(!e&&this.pagination?.isDisplayed()){this.pagination.forceFocusOutOfContainer(e);return}super.forceFocusOutOfContainer(e)}getFocusableContainers(){const e=[this.gridBody];return[this.sideBar,this.pagination].forEach(t=>{t&&e.push(t)}),e.filter(t=>Fo(t.getGui()))}},We=(e,t)=>{for(const n of Object.keys(t))t[n]=e;return t},hW={dispatchEvent:"CommunityCore",...We("CommunityCore",{destroy:0,getGridId:0,getGridOption:0,isDestroyed:0,setGridOption:0,updateGridOptions:0}),...We("GridState",{getState:0}),...We("SharedRowSelection",{setNodesSelected:0,selectAll:0,deselectAll:0,selectAllFiltered:0,deselectAllFiltered:0,selectAllOnCurrentPage:0,deselectAllOnCurrentPage:0,getSelectedNodes:0,getSelectedRows:0}),...We("RowApi",{redrawRows:0,setRowNodeExpanded:0,getRowNode:0,addRenderedRowListener:0,getRenderedNodes:0,forEachNode:0,getFirstDisplayedRowIndex:0,getLastDisplayedRowIndex:0,getDisplayedRowAtIndex:0,getDisplayedRowCount:0}),...We("ScrollApi",{getVerticalPixelRange:0,getHorizontalPixelRange:0,ensureColumnVisible:0,ensureIndexVisible:0,ensureNodeVisible:0}),...We("KeyboardNavigation",{getFocusedCell:0,clearFocusedCell:0,setFocusedCell:0,tabToNextCell:0,tabToPreviousCell:0,setFocusedHeader:0}),...We("EventApi",{addEventListener:0,addGlobalListener:0,removeEventListener:0,removeGlobalListener:0}),...We("ValueCache",{expireValueCache:0}),...We("CellApi",{getCellValue:0}),...We("SharedMenu",{showColumnMenu:0,hidePopupMenu:0}),...We("Sort",{onSortChanged:0}),...We("PinnedRow",{getPinnedTopRowCount:0,getPinnedBottomRowCount:0,getPinnedTopRow:0,getPinnedBottomRow:0}),...We("Overlay",{showLoadingOverlay:0,showNoRowsOverlay:0,hideOverlay:0}),...We("RenderApi",{setGridAriaProperty:0,refreshCells:0,refreshHeader:0,isAnimationFrameQueueEmpty:0,flushAllAnimationFrames:0,getSizesForCurrentTheme:0,getCellRendererInstances:0}),...We("HighlightChanges",{flashCells:0}),...We("RowDrag",{addRowDropZone:0,removeRowDropZone:0,getRowDropZoneParams:0}),...We("ColumnApi",{getColumnDefs:0,getColumnDef:0,getDisplayNameForColumn:0,getColumn:0,getColumns:0,applyColumnState:0,getColumnState:0,resetColumnState:0,isPinning:0,isPinningLeft:0,isPinningRight:0,getDisplayedColAfter:0,getDisplayedColBefore:0,setColumnsVisible:0,setColumnsPinned:0,getAllGridColumns:0,getDisplayedLeftColumns:0,getDisplayedCenterColumns:0,getDisplayedRightColumns:0,getAllDisplayedColumns:0,getAllDisplayedVirtualColumns:0}),...We("ColumnAutoSize",{sizeColumnsToFit:0,autoSizeColumns:0,autoSizeAllColumns:0}),...We("ColumnGroup",{setColumnGroupOpened:0,getColumnGroup:0,getProvidedColumnGroup:0,getDisplayNameForColumnGroup:0,getColumnGroupState:0,setColumnGroupState:0,resetColumnGroupState:0,getLeftDisplayedColumnGroups:0,getCenterDisplayedColumnGroups:0,getRightDisplayedColumnGroups:0,getAllDisplayedColumnGroups:0}),...We("ColumnMove",{moveColumnByIndex:0,moveColumns:0}),...We("ColumnResize",{setColumnWidths:0}),...We("ColumnHover",{isColumnHovered:0}),...We("EditCore",{getCellEditorInstances:0,getEditingCells:0,stopEditing:0,startEditingCell:0}),...We("UndoRedoEdit",{undoCellEditing:0,redoCellEditing:0,getCurrentUndoSize:0,getCurrentRedoSize:0}),...We("FilterCore",{isAnyFilterPresent:0,onFilterChanged:0}),...We("ColumnFilter",{isColumnFilterPresent:0,getColumnFilterInstance:0,destroyFilter:0,setFilterModel:0,getFilterModel:0,getColumnFilterModel:0,setColumnFilterModel:0,showColumnFilter:0}),...We("QuickFilter",{isQuickFilterPresent:0,getQuickFilter:0,resetQuickFilter:0}),...We("Find",{findGetActiveMatch:0,findGetTotalMatches:0,findGoTo:0,findNext:0,findPrevious:0,findGetNumMatches:0,findGetParts:0,findClearActive:0,findRefresh:0}),...We("Pagination",{paginationIsLastPageFound:0,paginationGetPageSize:0,paginationGetCurrentPage:0,paginationGetTotalPages:0,paginationGetRowCount:0,paginationGoToNextPage:0,paginationGoToPreviousPage:0,paginationGoToFirstPage:0,paginationGoToLastPage:0,paginationGoToPage:0}),...We("CsrmSsrmSharedApi",{expandAll:0,collapseAll:0,onRowHeightChanged:0}),...We("SsrmInfiniteSharedApi",{setRowCount:0,getCacheBlockState:0,isLastRowIndexKnown:0}),...We("ClientSideRowModelApi",{onGroupExpandedOrCollapsed:0,refreshClientSideRowModel:0,isRowDataEmpty:0,forEachLeafNode:0,forEachNodeAfterFilter:0,forEachNodeAfterFilterAndSort:0,resetRowHeights:0,applyTransaction:0,applyTransactionAsync:0,flushAsyncTransactions:0,getBestCostNodeSelection:0}),...We("CsvExport",{getDataAsCsv:0,exportDataAsCsv:0}),...We("InfiniteRowModel",{refreshInfiniteCache:0,purgeInfiniteCache:0,getInfiniteRowCount:0}),...We("AdvancedFilter",{getAdvancedFilterModel:0,setAdvancedFilterModel:0,showAdvancedFilterBuilder:0,hideAdvancedFilterBuilder:0}),...We("IntegratedCharts",{getChartModels:0,getChartRef:0,getChartImageDataURL:0,downloadChart:0,openChartToolPanel:0,closeChartToolPanel:0,createRangeChart:0,createPivotChart:0,createCrossFilterChart:0,updateChart:0,restoreChart:0}),...We("Clipboard",{copyToClipboard:0,cutToClipboard:0,copySelectedRowsToClipboard:0,copySelectedRangeToClipboard:0,copySelectedRangeDown:0,pasteFromClipboard:0}),...We("ExcelExport",{getDataAsExcel:0,exportDataAsExcel:0,getSheetDataForExcel:0,getMultipleSheetsAsExcel:0,exportMultipleSheetsAsExcel:0}),...We("SharedMasterDetail",{addDetailGridInfo:0,removeDetailGridInfo:0,getDetailGridInfo:0,forEachDetailGridInfo:0}),...We("ContextMenu",{showContextMenu:0}),...We("ColumnMenu",{showColumnChooser:0,hideColumnChooser:0}),...We("CellSelection",{getCellRanges:0,addCellRange:0,clearRangeSelection:0,clearCellSelection:0}),...We("SharedRowGrouping",{setRowGroupColumns:0,removeRowGroupColumns:0,addRowGroupColumns:0,getRowGroupColumns:0,moveRowGroupColumn:0}),...We("SharedAggregation",{addAggFuncs:0,clearAggFuncs:0,setColumnAggFunc:0}),...We("SharedPivot",{isPivotMode:0,getPivotResultColumn:0,setValueColumns:0,getValueColumns:0,removeValueColumns:0,addValueColumns:0,setPivotColumns:0,removePivotColumns:0,addPivotColumns:0,getPivotColumns:0,setPivotResultColumns:0,getPivotResultColumns:0}),...We("ServerSideRowModelApi",{getServerSideSelectionState:0,setServerSideSelectionState:0,applyServerSideTransaction:0,applyServerSideTransactionAsync:0,applyServerSideRowData:0,retryServerSideLoads:0,flushServerSideAsyncTransactions:0,refreshServerSide:0,getServerSideGroupLevelState:0}),...We("SideBar",{isSideBarVisible:0,setSideBarVisible:0,setSideBarPosition:0,openToolPanel:0,closeToolPanel:0,getOpenedToolPanel:0,refreshToolPanel:0,isToolPanelShowing:0,getToolPanelInstance:0,getSideBar:0}),...We("StatusBar",{getStatusPanel:0})},TD={isDestroyed:()=>!0,destroy(){},preConstruct(){},postConstruct(){},preWireBeans(){},wireBeans(){}},aYe=(e,t)=>e.eventSvc.dispatchEvent(t),Qne=class{};Reflect.defineProperty(Qne,"name",{value:"GridApi"});var lYe=class extends X{constructor(){super(),this.beanName="apiFunctionSvc",this.api=new Qne,this.fns={...TD,dispatchEvent:aYe},this.preDestroyLink="";const{api:e}=this;for(const t of Object.keys(hW))e[t]=this.makeApi(t)[t]}postConstruct(){this.preDestroyLink=this.beans.frameworkOverrides.getDocLink("grid-lifecycle/#grid-pre-destroyed")}addFunction(e,t){const{fns:n,beans:i}=this;n!==TD&&(n[e]=i?.validation?.validateApiFunction(e,t)??t)}makeApi(e){return{[e]:(...t)=>{const{beans:n,fns:{[e]:i}}=this;return i?i(n,...t):this.apiNotFound(e)}}}apiNotFound(e){const{beans:t,gos:n,preDestroyLink:i}=this;if(!t)ue(26,{fnName:e,preDestroyLink:i});else{const r=hW[e];n.assertModuleRegistered(r,`api.${e}`)&&ue(27,{fnName:e,module:r})}}destroy(){super.destroy(),this.fns=TD,this.beans=null}};function uYe(e){return e.context.getGridId()}function cYe(e){e.gridDestroySvc.destroy()}function dYe(e){return e.gridDestroySvc.destroyCalled}function hYe(e,t){return e.gos.get(t)}function fYe(e,t,n){Jne(e,{[t]:n})}function Jne(e,t){e.gos.updateGridOptions({options:t})}var pYe={tag:"div",cls:"ag-drag-handle ag-row-drag",attrs:{draggable:"true"}},gYe=class extends bt{constructor(e,t,n){super(pYe),this.rowNode=e,this.column=t,this.eCell=n}postConstruct(){this.getGui().appendChild(As("rowDrag",this.beans,null)),this.addGuiEventListener("mousedown",t=>{t.stopPropagation()}),this.addDragSource(),this.checkVisibility()}addDragSource(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))}onDragStart(e){const{rowNode:t,column:n,eCell:i,gos:r}=this,s=n.getColDef().dndSourceOnRowDrag,o=e.dataTransfer;if(o.setDragImage(i,0,0),s){const a=Ne(r,{rowNode:t,dragEvent:e});s(a)}else try{const a=JSON.stringify(t.data);o.setData("application/json",a),o.setData("text/plain",a)}catch{}}checkVisibility(){const e=this.column.isDndSource(this.rowNode);this.setDisplayed(e)}};function mYe(e,t){e.rowDragSvc?.rowDragFeature?.addRowDropZone(t)}function vYe(e,t){const n=e.dragAndDrop?.findExternalZone(t);n&&e.dragAndDrop?.removeDropTarget(n)}function CYe(e,t){return e.rowDragSvc?.rowDragFeature?.getRowDropZone(t)}var yYe=class extends X{constructor(){super(...arguments),this.beanName="horizontalResizeSvc"}addResizeBar(e){const t={dragStartPixels:e.dragStartPixels||0,eElement:e.eResizeBar,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this,e),onDragging:this.onDragging.bind(this,e),onDragCancel:this.onDragStop.bind(this,e),includeTouch:!0,stopPropagationForTouch:!0},{dragSvc:n}=this.beans;return n.addDragSource(t),()=>n.removeDragSource(t)}onDragStart(e,t){this.dragStartX=t.clientX,this.setResizeIcons();const n=t instanceof MouseEvent&&t.shiftKey===!0;e.onResizeStart(n)}setResizeIcons(){const e=this.beans.ctrlsSvc.get("gridCtrl");e.setResizeCursor(!0),e.disableUserSelect(!0)}onDragStop(e){e.onResizeEnd(this.resizeAmount),this.resetIcons()}resetIcons(){const e=this.beans.ctrlsSvc.get("gridCtrl");e.setResizeCursor(!1),e.disableUserSelect(!1)}onDragging(e,t){this.resizeAmount=t.clientX-this.dragStartX,e.onResizing(this.resizeAmount)}},wYe={tag:"div",cls:"ag-drag-handle ag-row-drag",attrs:{"aria-hidden":"true"}},bYe=class extends bt{constructor(e,t,n,i,r,s){super(),this.cellValueFn=e,this.rowNode=t,this.column=n,this.customGui=i,this.dragStartPixels=r,this.suppressVisibilityChange=s,this.dragSource=null}isCustomGui(){return this.customGui!=null}postConstruct(){const{beans:e,rowNode:t,column:n,gos:i}=this;if(this.customGui?this.setDragElement(this.customGui,this.dragStartPixels):(this.setTemplate(wYe),this.getGui().appendChild(As("rowDrag",e,null)),this.addDragSource()),!this.suppressVisibilityChange){const r=i.get("rowDragManaged")?new xYe(this,t,n):new SYe(this,t,n);this.createManagedBean(r,this.beans.context)}}setDragElement(e,t){this.setTemplateFromElement(e,void 0,void 0,!0),this.addDragSource(t)}getSelectedNodes(){const e=this.rowNode;if(!this.gos.get("rowDragMultiRow"))return[e];const n=this.beans.selectionSvc?.getSelectedNodes()??[];return n.indexOf(e)!==-1?n:[e]}getDragItem(){const{column:e,rowNode:t}=this;return{rowNode:t,rowNodes:this.getSelectedNodes(),columns:e?[e]:void 0,defaultTextValue:this.cellValueFn()}}getRowDragText(e){if(e){const t=e.getColDef();if(t.rowDragText)return t.rowDragText}return this.gos.get("rowDragText")}addDragSource(e=4){this.dragSource&&this.removeDragSource();const t=this.getGui();this.gos.get("enableCellTextSelection")&&(this.removeMouseDownListener(),this.mouseDownListener=this.addManagedElementListeners(t,{mousedown:i=>{i?.preventDefault()}})[0]);const n=this.getLocaleTextFunc();this.dragSource={type:2,eElement:t,dragItemName:()=>{const i=this.getDragItem(),r=i.rowNodes?.length||1,s=this.getRowDragText(this.column);return s?s(i,r):r===1?this.cellValueFn():`${r} ${n("rowDragRows","rows")}`},getDragItem:()=>this.getDragItem(),dragStartPixels:e,dragSourceDomDataKey:this.gos.getDomDataKey()},this.beans.dragAndDrop.addDragSource(this.dragSource,!0)}destroy(){this.removeDragSource(),this.removeMouseDownListener(),super.destroy()}removeDragSource(){this.dragSource&&(this.beans.dragAndDrop.removeDragSource(this.dragSource),this.dragSource=null)}removeMouseDownListener(){this.mouseDownListener&&(this.mouseDownListener(),this.mouseDownListener=void 0)}},Zne=class extends X{constructor(e,t,n){super(),this.parent=e,this.rowNode=t,this.column=n}setDisplayedOrVisible(e){const t={skipAriaHidden:!0};if(e)this.parent.setDisplayed(!1,t);else{let n=!0,i=!1;const{column:r,rowNode:s,parent:o}=this;r&&(n=r.isRowDrag(s)||o.isCustomGui(),i=typeof r.getColDef().rowDrag=="function"),i?(o.setDisplayed(!0,t),o.setVisible(n,t)):(o.setDisplayed(n,t),o.setVisible(!0,t))}}},SYe=class extends Zne{postConstruct(){this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this));const e=this.workOutVisibility.bind(this);this.addManagedListeners(this.rowNode,{dataChanged:e,cellChanged:e}),this.addManagedListeners(this.beans.eventSvc,{newColumnsLoaded:e}),this.workOutVisibility()}onSuppressRowDrag(){this.workOutVisibility()}workOutVisibility(){const e=this.gos.get("suppressRowDrag");this.setDisplayedOrVisible(e)}},xYe=class extends Zne{postConstruct(){const e=this.workOutVisibility.bind(this);this.addManagedListeners(this.beans.eventSvc,{sortChanged:e,filterChanged:e,columnRowGroupChanged:e,newColumnsLoaded:e}),this.addManagedListeners(this.rowNode,{dataChanged:e,cellChanged:e}),this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.workOutVisibility()}onSuppressRowDrag(){this.workOutVisibility()}workOutVisibility(){const{rowDragSvc:e,dragAndDrop:t,gos:n}=this.beans,i=e.rowDragFeature,r=i&&i.shouldPreventRowMove(),s=n.get("suppressRowDrag"),o=t.hasExternalDropZones(),a=r&&!o||s;this.setDisplayedOrVisible(a)}},RYe=class extends X{constructor(){super(...arguments),this.beanName="rowDragSvc"}setupRowDrag(e,t){const n=t.createManagedBean(new Yje(e)),i=this.beans.dragAndDrop;i.addDropTarget(n),t.addDestroyFunc(()=>i.removeDropTarget(n)),this.rowDragFeature=n}createRowDragComp(e,t,n,i,r,s){return new bYe(e,t,n,i,r,s)}createRowDragCompForRow(e,t){if(Gl(this.gos))return;const n=this.getLocaleTextFunc();return this.createRowDragComp(()=>`1 ${n("rowDragRow","row")}`,e,void 0,t,void 0,!0)}createRowDragCompForCell(e,t,n,i,r,s){const o=this.gos;return o.get("rowDragManaged")&&(!Xi(o)||o.get("pagination"))?void 0:this.createRowDragComp(n,e,t,i,r,s)}},eie={moduleName:"Drag",version:Ce,beans:[Xje]},EYe={moduleName:"DragAndDrop",version:Ce,dynamicBeans:{dndSourceComp:gYe},icons:{rowDrag:"grip"}},tie={moduleName:"SharedDragAndDrop",version:Ce,beans:[zje],dependsOn:[eie],userComponents:{agDragAndDropImage:cKe},icons:{columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",rowDrag:"grip"}},FYe={moduleName:"RowDrag",version:Ce,beans:[RYe],apiFunctions:{addRowDropZone:mYe,removeRowDropZone:vYe,getRowDropZoneParams:CYe},dependsOn:[tie]},AYe={moduleName:"HorizontalResize",version:Ce,beans:[yYe],dependsOn:[eie]},DYe=":where(.ag-ltr) :where(.ag-column-moving){.ag-cell,.ag-header-cell,.ag-spanned-cell-wrapper{transition:left .2s}.ag-header-group-cell{transition:left .2s,width .2s}}:where(.ag-rtl) :where(.ag-column-moving){.ag-cell,.ag-header-cell,.ag-spanned-cell-wrapper{transition:right .2s}.ag-header-group-cell{transition:right .2s,width .2s}}",PYe=class extends X{constructor(){super(...arguments),this.beanName="colAnimation",this.executeNextFuncs=[],this.executeLaterFuncs=[],this.active=!1,this.activeNext=!1,this.suppressAnimation=!1,this.animationThreadCount=0}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>this.gridBodyCtrl=e.gridBodyCtrl)}isActive(){return this.active&&!this.suppressAnimation}setSuppressAnimation(e){this.suppressAnimation=e}start(){if(this.active)return;const{gos:e}=this;e.get("suppressColumnMoveAnimation")||e.get("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0,this.activeNext=!0)}finish(){this.active&&this.flush(()=>this.activeNext=!1,()=>this.active=!1)}executeNextVMTurn(e){this.activeNext?this.executeNextFuncs.push(e):e()}executeLaterVMTurn(e){this.active?this.executeLaterFuncs.push(e):e()}ensureAnimationCssClassPresent(){this.animationThreadCount++;const e=this.animationThreadCount,{gridBodyCtrl:t}=this;t.setColumnMovingCss(!0),this.executeLaterFuncs.push(()=>{this.animationThreadCount===e&&t.setColumnMovingCss(!1)})}flush(e,t){const{executeNextFuncs:n,executeLaterFuncs:i}=this;if(n.length===0&&i.length===0){e(),t();return}const r=s=>{for(;s.length;){const o=s.pop();o&&o()}};this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e(),r(n)},0),window.setTimeout(()=>{t(),r(i)},200)})}};function kYe(e,t,n){e.colMoves?.moveColumnByIndex(t,n,"api")}function TYe(e,t,n){e.colMoves?.moveColumns(t,n,"api")}var MYe=class extends X{constructor(e){super(),this.pinned=e,this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[]}onDragEnter(e){if(this.clearColumnsList(),this.gos.get("functionsReadOnly"))return;const t=e.dragItem.columns;t&&t.forEach(n=>{n.isPrimary()&&(n.isAnyFunctionActive()||(n.isAllowValue()?this.columnsToAggregate.push(n):n.isAllowRowGroup()?this.columnsToGroup.push(n):n.isAllowPivot()&&this.columnsToPivot.push(n)))})}getIconName(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?"pinned":"move":null}onDragLeave(e){this.clearColumnsList()}clearColumnsList(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0}onDragging(e){}onDragStop(e){const{valueColsSvc:t,rowGroupColsSvc:n,pivotColsSvc:i}=this.beans;this.columnsToAggregate.length>0&&t?.addColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&n?.addColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&i?.addColumns(this.columnsToPivot,"toolPanelDragAndDrop")}onDragCancel(){this.clearColumnsList()}};function IYe(e,t){!t||t.length<=1||t.filter(i=>e.indexOf(i)<0).length>0||t.sort((i,r)=>{const s=e.indexOf(i),o=e.indexOf(r);return s-o})}function nie(e){const{isFromHeader:t,fromLeft:n,xPosition:i,fromEnter:r,fakeEvent:s,pinned:o,gos:a,colModel:l,colMoves:u,visibleCols:c}=e;let{allMovingColumns:d}=e;if(t){const E=[];d.forEach(A=>{let F=null,k=A.getParent();for(;k!=null&&k.getDisplayedLeafColumns().length===1;)F=k,k=k.getParent();F!=null?(!!F.getColGroupDef()?.marryChildren?F.getProvidedColumnGroup().getLeafColumns():F.getLeafColumns()).forEach(O=>{E.includes(O)||E.push(O)}):E.includes(A)||E.push(A)}),d=E}const h=d.slice();IYe(l.getCols(),h);const p=NYe({movingCols:h,draggingRight:n,xPosition:i,pinned:o,gos:a,colModel:l,visibleCols:c}),g=_Ye(h,l);if(p.length===0)return;const v=p[0];let C=g!==null&&!r;if(t&&(C=g!==null),C&&!s&&(!n&&v>=g||n&&v<=g))return;const y=c.allCols,b=[];let S=null;for(let E=0;E<p.length;E++){const A=p[E],F=u.getProposedColumnOrder(h,A);if(!u.doesOrderPassRules(F))continue;const k=F.filter(_=>y.includes(_));if(S===null)S=k;else if(!Sh(k,S))break;const P=OYe(F);b.push({move:A,fragCount:P})}if(b.length===0)return;b.sort((E,A)=>E.fragCount-A.fragCount);const x=b[0].move;if(!(x>l.getCols().length-d.length))return{columns:d,toIndex:x}}function iie(e){const{columns:t,toIndex:n}=nie(e)||{},{finished:i,colMoves:r}=e;return!t||n==null?null:(r.moveColumns(t,n,"uiColumnMoved",i),i?null:{columns:t,toIndex:n})}function _Ye(e,t){const n=t.getCols(),i=e.map(l=>n.indexOf(l)).sort((l,u)=>l-u),r=i[0];return Tt(i)-r!==i.length-1?null:r}function OYe(e){function t(i){const r=[];let s=i.getOriginalParent();for(;s!=null;)r.push(s),s=s.getOriginalParent();return r}let n=0;for(let i=0;i<e.length-1;i++){let r=t(e[i]),s=t(e[i+1]);[r,s]=r.length>s.length?[r,s]:[s,r],r.forEach(o=>{s.indexOf(o)===-1&&n++})}return n}function LYe(e,t){switch(t){case"left":return e.leftCols;case"right":return e.rightCols;default:return e.centerCols}}function NYe(e){const{movingCols:t,draggingRight:n,xPosition:i,pinned:r,gos:s,colModel:o,visibleCols:a}=e;if(s.get("suppressMovableColumns")||t.some(S=>S.getColDef().suppressMovable))return[];const u=LYe(a,r),c=o.getCols(),d=u.filter(S=>t.includes(S)),h=u.filter(S=>!t.includes(S)),p=c.filter(S=>!t.includes(S));let g=0,v=i;if(n){let S=0;d.forEach(x=>S+=x.getActualWidth()),v-=S}if(v>0){for(let S=0;S<h.length;S++){const x=h[S];if(v-=x.getActualWidth(),v<0)break;g++}n&&g++}let C;if(g>0){const S=h[g-1];C=p.indexOf(S)+1}else C=p.indexOf(h[0]),C===-1&&(C=0);const y=[C],b=(S,x)=>S-x;if(n){let S=C+1;const x=c.length-1;for(;S<=x;)y.push(S),S++;y.sort(b)}else{let S=C;const x=c.length-1;let E=c[S];for(;S<=x&&u.indexOf(E)<0;)S++,y.push(S),E=c[S];S=C-1;const A=0;for(;S>=A;)y.push(S),S--;y.sort(b).reverse()}return y}function LT(e){const{pinned:t,fromKeyboard:n,gos:i,ctrlsSvc:r,useHeaderRow:s,skipScrollPadding:o}=e;let a=r.getHeaderRowContainerCtrl(t)?.eViewport,{x:l}=e;return a?(n&&(l-=a.getBoundingClientRect().left),i.get("enableRtl")&&(s&&(a=a.querySelector(".ag-header-row")),l=a.clientWidth-l),t==null&&!o&&(l+=r.get("center").getCenterViewportScrollLeft()),l):0}function MD(e,t){for(const n of e)n.moving=t,n.dispatchColEvent("movingChanged","uiColumnMoved")}var fW=7,NT=100,fw=NT/2,$Ye=5,BYe=100,GYe=class extends X{constructor(e){super(),this.pinned=e,this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.isCenterContainer=!me(e)}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl})}getIconName(){const{pinned:e,lastDraggingEvent:t}=this,n=t?.dragItem.columns??[];for(const i of n){const r=i.getPinned();if(i.getColDef().lockPinned){if(r==e)return"move";continue}if(r===e||!e)return"move";if(!r&&e)return"pinned"}return"notAllowed"}onDragEnter(e){const t=e.dragItem,n=t.columns;if(e.dragSource.type===0)this.setColumnsVisible(n,!0,"uiColumnDragged");else{const r=t.visibleState,s=(n||[]).filter(o=>r[o.getId()]);this.setColumnsVisible(s,!0,"uiColumnDragged")}this.gos.get("suppressMoveWhenColumnDragging")||this.attemptToPinColumns(n,this.pinned),this.onDragging(e,!0,!0)}onDragging(e=this.lastDraggingEvent,t=!1,n=!1,i=!1){const{gos:r,ctrlsSvc:s}=this.beans,o=r.get("suppressMoveWhenColumnDragging");if(i&&!o){this.finishColumnMoving();return}if(this.lastDraggingEvent=e,!e||!i&&Wt(e.hDirection))return;const a=LT({x:e.x,pinned:this.pinned,gos:r,ctrlsSvc:s});t||this.checkCenterForScrolling(a),o?this.handleColumnDragWhileSuppressingMovement(e,t,n,a,i):this.handleColumnDragWhileAllowingMovement(e,t,n,a,i)}onDragLeave(){this.ensureIntervalCleared(),this.clearHighlighted(),this.lastMovedInfo=null}onDragStop(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null}onDragCancel(){this.clearHighlighted(),this.ensureIntervalCleared(),this.lastMovedInfo=null}setColumnsVisible(e,t,n){if(!e)return;const i=e.filter(r=>!r.getColDef().lockVisible);this.beans.colModel.setColsVisible(i,t,n)}finishColumnMoving(){this.clearHighlighted();const e=this.lastMovedInfo;if(!e)return;const{columns:t,toIndex:n}=e;this.beans.colMoves.moveColumns(t,n,"uiColumnMoved",!0)}handleColumnDragWhileSuppressingMovement(e,t,n,i,r){const s=this.getAllMovingColumns(e,!0);if(r){const o=this.isAttemptingToPin(s);o&&this.attemptToPinColumns(s,void 0,!0);const{fromLeft:a,xPosition:l}=this.getNormalisedXPositionInfo(s,o)||{};if(a==null||l==null){this.finishColumnMoving();return}this.moveColumnsAfterHighlight({allMovingColumns:s,xPosition:l,fromEnter:t,fakeEvent:n,fromLeft:a})}else{if(!this.beans.dragAndDrop.isDropZoneWithinThisGrid(e))return;this.highlightHoveredColumn(s,i)}}handleColumnDragWhileAllowingMovement(e,t,n,i,r){const s=this.getAllMovingColumns(e),o=this.normaliseDirection(e.hDirection)==="right",a=e.dragSource.type===1,l=this.getMoveColumnParams({allMovingColumns:s,isFromHeader:a,xPosition:i,fromLeft:o,fromEnter:t,fakeEvent:n}),u=iie({...l,finished:r});u&&(this.lastMovedInfo=u)}getAllMovingColumns(e,t=!1){const n=e.dragSource.getDragItem();let i=null;t?(i=n.columnsInSplit,i||(i=n.columns)):i=n.columns;const r=s=>s.getColDef().lockPinned?s.getPinned()==this.pinned:!0;return i?i.filter(r):[]}getMoveColumnParams(e){const{allMovingColumns:t,isFromHeader:n,xPosition:i,fromLeft:r,fromEnter:s,fakeEvent:o}=e,{gos:a,colModel:l,colMoves:u,visibleCols:c}=this.beans;return{allMovingColumns:t,isFromHeader:n,fromLeft:r,xPosition:i,pinned:this.pinned,fromEnter:s,fakeEvent:o,gos:a,colModel:l,colMoves:u,visibleCols:c}}highlightHoveredColumn(e,t){const{gos:n,colModel:i}=this.beans,r=n.get("enableRtl"),s=i.getCols().filter(c=>c.isVisible()&&c.getPinned()===this.pinned);let o=null,a=null,l=null;for(const c of s){if(a=c.getActualWidth(),o=this.getNormalisedColumnLeft(c,0,r),o!=null){const d=o+a;if(o<=t&&d>=t){l=c;break}}o=null,a=null}if(l)e.indexOf(l)!==-1&&(l=null);else{for(let c=s.length-1;c>=0;c--){const d=s[c],h=s[c].getParent();if(!h){l=d;break}const p=h?.getDisplayedLeafColumns();if(p.length){l=Tt(p);break}}if(!l)return;o=this.getNormalisedColumnLeft(l,0,r),a=l.getActualWidth()}if(this.lastHighlightedColumn?.column!==l&&this.clearHighlighted(),l==null||o==null||a==null)return;let u;t-o<a/2!==r?u=0:u=1,pW(l,u),this.lastHighlightedColumn={column:l,position:u}}getNormalisedXPositionInfo(e,t){const{gos:n,visibleCols:i}=this.beans,r=n.get("enableRtl"),{firstMovingCol:s,column:o,position:a}=this.getColumnMoveAndTargetInfo(e,t,r);if(!s||!o||a==null)return;const l=i.allCols,u=l.indexOf(s),c=l.indexOf(o),d=a===0!==r,h=u<c||u===c&&!d;let p=0;if(d?h&&(p-=1):h||(p+=1),c+p===u)return;const g=l[c+p];if(!g)return;const v=this.getNormalisedColumnLeft(g,20,r);return{fromLeft:h,xPosition:v}}getColumnMoveAndTargetInfo(e,t,n){const i=this.lastHighlightedColumn||{},{firstMovingCol:r,lastMovingCol:s}=zYe(e);if(!r||!s||i.column||!t)return{firstMovingCol:r,...i};const a=this.getPinDirection()==="left";return{firstMovingCol:r,position:a?1:0,column:a!==n?r:s}}normaliseDirection(e){if(this.gos.get("enableRtl"))switch(e){case"left":return"right";case"right":return"left"}return e}getNormalisedColumnLeft(e,t,n){const{gos:i,ctrlsSvc:r}=this.beans,s=e.getLeft();if(s==null)return null;const o=e.getActualWidth();return LT({x:n?s+o-t:s+t,pinned:e.getPinned(),useHeaderRow:n,skipScrollPadding:!0,gos:i,ctrlsSvc:r})}isAttemptingToPin(e){const t=this.needToMoveLeft||this.needToMoveRight,n=this.failedMoveAttempts>fW;return t&&n||e.some(i=>i.getPinned()!==this.pinned)}moveColumnsAfterHighlight(e){const{allMovingColumns:t,xPosition:n,fromEnter:i,fakeEvent:r,fromLeft:s}=e,o=this.getMoveColumnParams({allMovingColumns:t,isFromHeader:!0,xPosition:n,fromLeft:s,fromEnter:i,fakeEvent:r}),{columns:a,toIndex:l}=nie(o)||{};a&&l!=null&&(this.lastMovedInfo={columns:a,toIndex:l}),this.finishColumnMoving()}clearHighlighted(){const{lastHighlightedColumn:e}=this;e&&(pW(e.column,null),this.lastHighlightedColumn=null)}checkCenterForScrolling(e){if(!this.isCenterContainer)return;const t=this.beans.ctrlsSvc.get("center"),n=t.getCenterViewportScrollLeft(),i=n+t.getCenterWidth();let r,s;this.gos.get("enableRtl")?(r=e<n+fw,s=e>i-fw):(s=e<n+fw,r=e>i-fw),this.needToMoveRight=r,this.needToMoveLeft=s,s||r?this.ensureIntervalStarted():this.ensureIntervalCleared()}ensureIntervalStarted(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),BYe),this.beans.dragAndDrop.getDragAndDropImageComponent()?.setIcon(this.needToMoveLeft?"left":"right",!0))}ensureIntervalCleared(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.failedMoveAttempts=0,this.beans.dragAndDrop.getDragAndDropImageComponent()?.setIcon(this.getIconName(),!1))}moveInterval(){let e;this.intervalCount++,e=10+this.intervalCount*$Ye,e>NT&&(e=NT);let t=null;const n=this.gridBodyCon.scrollFeature;if(this.needToMoveLeft?t=n.scrollHorizontally(-e):this.needToMoveRight&&(t=n.scrollHorizontally(e)),t!==0)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;const{pinnedCols:i,dragAndDrop:r,gos:s}=this.beans;if(this.failedMoveAttempts<=fW+1||!i)return;if(r.getDragAndDropImageComponent()?.setIcon("pinned",!1),!s.get("suppressMoveWhenColumnDragging")){const o=this.lastDraggingEvent?.dragItem.columns;this.attemptToPinColumns(o,void 0,!0)}}}getPinDirection(){if(this.needToMoveLeft||this.pinned==="left")return"left";if(this.needToMoveRight||this.pinned==="right")return"right"}attemptToPinColumns(e,t,n=!1){const i=(e||[]).filter(o=>!o.getColDef().lockPinned);if(!i.length)return 0;n&&(t=this.getPinDirection());const{pinnedCols:r,dragAndDrop:s}=this.beans;return r?.setColsPinned(i,t,"uiColumnDragged"),n&&s.nudge(),i.length}destroy(){super.destroy(),this.lastDraggingEvent=null,this.clearHighlighted(),this.lastMovedInfo=null}};function pW(e,t){e.highlighted!==t&&(e.highlighted=t,e.dispatchColEvent("headerHighlightChanged","uiColumnMoved"))}function zYe(e){const t=e.length;let n,i;for(let r=0;r<t;r++){if(!n){const s=e[r];s.getLeft()!=null&&(n=s)}if(!i){const s=e[t-1-r];s.getLeft()!=null&&(i=s)}if(n&&i)break}return{firstMovingCol:n,lastMovingCol:i}}var HYe=class extends X{constructor(e,t){super(),this.pinned=e,this.eContainer=t}postConstruct(){const{ctrlsSvc:e,dragAndDrop:t}=this.beans,n=this.pinned;e.whenReady(this,i=>{let r;const s=i.gridBodyCtrl.eBodyViewport;switch(n){case"left":r=[[s,i.left.eContainer],[i.bottomLeft.eContainer],[i.topLeft.eContainer]];break;case"right":r=[[s,i.right.eContainer],[i.bottomRight.eContainer],[i.topRight.eContainer]];break;default:r=[[s,i.center.eViewport],[i.bottomCenter.eViewport],[i.topCenter.eViewport]];break}this.eSecondaryContainers=r}),this.moveColumnFeature=this.createManagedBean(new GYe(n)),this.bodyDropPivotTarget=this.createManagedBean(new MYe(n)),t.addDropTarget(this),this.addDestroyFunc(()=>t.removeDropTarget(this))}isInterestedIn(e){return e===1||e===0&&this.gos.get("allowDragFromColumnsToolPanel")}getSecondaryContainers(){return this.eSecondaryContainers}getContainer(){return this.eContainer}getIconName(){return this.currentDropListener.getIconName()}isDropColumnInPivotMode(e){return this.beans.colModel.isPivotMode()&&e.dragSource.type===0}onDragEnter(e){this.currentDropListener=this.isDropColumnInPivotMode(e)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(e)}onDragLeave(e){this.currentDropListener.onDragLeave(e)}onDragging(e){this.currentDropListener.onDragging(e)}onDragStop(e){this.currentDropListener.onDragStop(e)}onDragCancel(){this.currentDropListener.onDragCancel()}},VYe=class extends X{constructor(){super(...arguments),this.beanName="colMoves"}moveColumnByIndex(e,t,n){const i=this.beans.colModel.getCols();if(!i)return;const r=i[e];this.moveColumns([r],t,n)}moveColumns(e,t,n,i=!0){const{colModel:r,colAnimation:s,visibleCols:o,eventSvc:a}=this.beans,l=r.getCols();if(!l)return;if(t>l.length-e.length){ue(30,{toIndex:t});return}s?.start();const u=r.getColsForKeys(e);this.doesMovePassRules(u,t)&&(J6(r.getCols(),u,t),o.refresh(n),a.dispatchEvent({type:"columnMoved",columns:u,column:u.length===1?u[0]:null,toIndex:t,finished:i,source:n})),s?.finish()}doesMovePassRules(e,t){const n=this.getProposedColumnOrder(e,t);return this.doesOrderPassRules(n)}doesOrderPassRules(e){const{colModel:t,gos:n}=this.beans;return!(!lne(e,t.getColTree())||!(r=>{const s=u=>u?u==="left"||u===!0?-1:1:0,o=n.get("enableRtl");let a=o?1:-1,l=!0;return r.forEach(u=>{const c=s(u.getColDef().lockPosition);o?c>a&&(l=!1):c<a&&(l=!1),a=c}),l})(e))}getProposedColumnOrder(e,t){const i=this.beans.colModel.getCols().slice();return J6(i,e,t),i}createBodyDropTarget(e,t){return new HYe(e,t)}moveHeader(e,t,n,i,r){const{ctrlsSvc:s,gos:o,colModel:a,visibleCols:l,focusSvc:u}=this.beans,c=t.getBoundingClientRect(),d=c.left,h=on(n),p=h?c.width:n.getActualWidth(),g=e==="left"!==o.get("enableRtl"),v=LT({x:g?d-20:d+p+20,pinned:i,fromKeyboard:!0,gos:o,ctrlsSvc:s}),C=u.focusedHeader;iie({allMovingColumns:h?n.getLeafColumns():[n],isFromHeader:!0,fromLeft:e==="right",xPosition:v,pinned:i,fromEnter:!1,fakeEvent:!1,gos:o,colModel:a,colMoves:this,visibleCols:l,finished:!0});let y;if(h){const b=n.getDisplayedLeafColumns();y=g?b[0]:Tt(b)}else y=n;if(s.getScrollFeature().ensureColumnVisible(y,"auto"),(!r.isAlive()||o.get("ensureDomOrder"))&&C){let b;if(h){const S=n.getGroupId(),x=n.getLeafColumns();if(!x.length)return;const E=x[0].getParent();if(!E)return;b=WYe(E,S)}else b=n;b&&u.focusHeaderPosition({headerPosition:{...C,column:b}})}}setDragSourceForHeader(e,t,n){const{gos:i,colModel:r,dragAndDrop:s,visibleCols:o}=this.beans;let a=!i.get("suppressDragLeaveHidesColumns");const l=on(t),u=l?t.getProvidedColumnGroup().getLeafColumns():[t],d={type:1,eElement:e,getDefaultIconName:()=>a?"hide":"notAllowed",getDragItem:l?()=>jYe(t,o.allCols):()=>UYe(t),dragItemName:n,onDragStarted:()=>{a=!i.get("suppressDragLeaveHidesColumns"),MD(u,!0)},onDragStopped:()=>MD(u,!1),onDragCancelled:()=>MD(u,!1),onGridEnter:h=>{if(a){const{columns:p=[],visibleState:g}=h??{},v=l?y=>!g||g[y.getColId()]:()=>!0,C=p.filter(y=>!y.getColDef().lockVisible&&v(y));r.setColsVisible(C,!0,"uiColumnMoved")}},onGridExit:h=>{if(a){const p=h?.columns?.filter(g=>!g.getColDef().lockVisible)||[];r.setColsVisible(p,!1,"uiColumnMoved")}}};return s.addDragSource(d,!0),d}};function WYe(e,t){for(;e;){if(e.getGroupId()===t)return e;e=e.getParent()}}function UYe(e){const t={};return t[e.getId()]=e.isVisible(),{columns:[e],visibleState:t}}function jYe(e,t){const n=e.getProvidedColumnGroup().getLeafColumns(),i={};n.forEach(a=>i[a.getId()]=a.isVisible());const r=[];t.forEach(a=>{n.indexOf(a)>=0&&(r.push(a),Ao(n,a))}),n.forEach(a=>r.push(a));const s=[],o=e.getLeafColumns();for(const a of r)o.indexOf(a)!==-1&&s.push(a);return{columns:r,columnsInSplit:s,visibleState:i}}var qYe={moduleName:"ColumnMove",version:Ce,beans:[VYe,PYe],apiFunctions:{moveColumnByIndex:kYe,moveColumns:TYe},dependsOn:[tie],css:[DYe]},KYe=class extends X{constructor(){super(...arguments),this.beanName="autoWidthCalc"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.centerRowContainerCtrl=e.center})}getPreferredWidthForColumn(e,t){const n=this.getHeaderCellForColumn(e);if(!n)return-1;const i=this.beans.rowRenderer.getAllCellsNotSpanningForColumn(e);return t||i.push(n),this.getPreferredWidthForElements(i)}getPreferredWidthForColumnGroup(e){const t=this.getHeaderCellForColumn(e);return t?this.getPreferredWidthForElements([t]):-1}getPreferredWidthForElements(e,t){const n=document.createElement("form");n.style.position="fixed";const i=this.centerRowContainerCtrl.eContainer;e.forEach(s=>this.cloneItemIntoDummy(s,n)),i.appendChild(n);const r=n.offsetWidth;return i.removeChild(n),t=t??this.gos.get("autoSizePadding"),r+t}getHeaderCellForColumn(e){let t=null;return this.beans.ctrlsSvc.getHeaderRowContainerCtrls().forEach(n=>{const i=n.getHtmlElementForColumnHeader(e);i!=null&&(t=i)}),t}cloneItemIntoDummy(e,t){const n=e.cloneNode(!0);n.style.width="",n.style.position="static",n.style.left="";const i=document.createElement("div"),r=i.classList;["ag-header-cell","ag-header-group-cell"].some(a=>n.classList.contains(a))?(r.add("ag-header","ag-header-row"),i.style.position="static"):r.add("ag-row");let o=e.parentElement;for(;o;){if(["ag-header-row","ag-row"].some(l=>o.classList.contains(l))){for(let l=0;l<o.classList.length;l++){const u=o.classList[l];u!="ag-row-position-absolute"&&r.add(u)}break}o=o.parentElement}i.appendChild(n),t.appendChild(i)}},rie={moduleName:"AutoWidth",version:Ce,beans:[KYe]};function YYe(e,t,n=!0,i="api"){e.colResize?.setColumnWidths(t,!1,n,i)}var XYe=class extends X{constructor(e,t,n,i){super(),this.comp=e,this.eResize=t,this.pinned=n,this.columnGroup=i}postConstruct(){if(!this.columnGroup.isResizable()){this.comp.setResizableDisplayed(!1);return}const{horizontalResizeSvc:e,gos:t,colAutosize:n}=this.beans,i=e.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});this.addDestroyFunc(i),!t.get("suppressAutoSize")&&n&&this.addDestroyFunc(n.addColumnGroupResize(this.eResize,this.columnGroup,()=>this.resizeLeafColumnsToFit("uiColumnResized")))}onResizeStart(e){const{columnsToResize:t,resizeStartWidth:n,resizeRatios:i,groupAfterColumns:r,groupAfterStartWidth:s,groupAfterRatios:o}=this.getInitialValues(e);this.resizeCols=t,this.resizeStartWidth=n,this.resizeRatios=i,this.resizeTakeFromCols=r,this.resizeTakeFromStartWidth=s,this.resizeTakeFromRatios=o,this.toggleColumnResizing(!0)}onResizing(e,t,n="uiColumnResized"){const i=this.normaliseDragChange(t),r=this.resizeStartWidth+i;this.resizeColumnsFromLocalValues(r,n,e)}getInitialValues(e){const t=l=>l.reduce((u,c)=>u+c.getActualWidth(),0),n=(l,u)=>l.map(c=>c.getActualWidth()/u),i=this.getColumnsToResize(),r=t(i),s=n(i,r),o={columnsToResize:i,resizeStartWidth:r,resizeRatios:s};let a=null;if(e&&(a=this.beans.colGroupSvc?.getGroupAtDirection(this.columnGroup,"After")??null),a){const l=a.getDisplayedLeafColumns(),u=o.groupAfterColumns=l.filter(d=>d.isResizable()),c=o.groupAfterStartWidth=t(u);o.groupAfterRatios=n(u,c)}else o.groupAfterColumns=void 0,o.groupAfterStartWidth=void 0,o.groupAfterRatios=void 0;return o}resizeLeafColumnsToFit(e){const t=this.beans.autoWidthCalc.getPreferredWidthForColumnGroup(this.columnGroup),n=this.getInitialValues();t>n.resizeStartWidth&&this.resizeColumns(n,t,e,!0)}resizeColumnsFromLocalValues(e,t,n=!0){if(!this.resizeCols||!this.resizeRatios)return;const i={columnsToResize:this.resizeCols,resizeStartWidth:this.resizeStartWidth,resizeRatios:this.resizeRatios,groupAfterColumns:this.resizeTakeFromCols,groupAfterStartWidth:this.resizeTakeFromStartWidth,groupAfterRatios:this.resizeTakeFromRatios};this.resizeColumns(i,e,t,n)}resizeColumns(e,t,n,i=!0){const{columnsToResize:r,resizeStartWidth:s,resizeRatios:o,groupAfterColumns:a,groupAfterStartWidth:l,groupAfterRatios:u}=e,c=[];if(c.push({columns:r,ratios:o,width:t}),a){const d=t-s;c.push({columns:a,ratios:u,width:l-d})}this.beans.colResize?.resizeColumnSets({resizeSets:c,finished:i,source:n}),i&&this.toggleColumnResizing(!1)}toggleColumnResizing(e){this.comp.addOrRemoveCssClass("ag-column-resizing",e)}getColumnsToResize(){return this.columnGroup.getDisplayedLeafColumns().filter(t=>t.isResizable())}normaliseDragChange(e){let t=e;return this.gos.get("enableRtl")?this.pinned!=="left"&&(t*=-1):this.pinned==="right"&&(t*=-1),t}destroy(){super.destroy(),this.resizeCols=void 0,this.resizeRatios=void 0,this.resizeTakeFromCols=void 0,this.resizeTakeFromRatios=void 0}},QYe=class extends X{constructor(e,t,n,i,r){super(),this.pinned=e,this.column=t,this.eResize=n,this.comp=i,this.ctrl=r}postConstruct(){const e=[];let t,n;const i=()=>{if(Yt(this.eResize,t),!t)return;const{horizontalResizeSvc:o,colAutosize:a}=this.beans,l=o.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});e.push(l),n&&a&&e.push(a.addColumnAutosize(this.eResize,this.column))},r=()=>{e.forEach(o=>o()),e.length=0},s=()=>{const o=this.column.isResizable(),a=!this.gos.get("suppressAutoSize")&&!this.column.getColDef().suppressAutoSize;(o!==t||a!==n)&&(t=o,n=a,r(),i())};s(),this.addDestroyFunc(r),this.ctrl.setRefreshFunction("resize",s)}onResizing(e,t){const{column:n,lastResizeAmount:i,resizeStartWidth:r,beans:s}=this,o=this.normaliseResizeAmount(t),a=r+o,l=[{key:n,newWidth:a}],{pinnedCols:u,ctrlsSvc:c,colResize:d}=s;if(this.column.getPinned()){const h=u?.leftWidth??0,p=u?.rightWidth??0,g=a0(c.getGridBodyCtrl().eBodyViewport)-50;if(h+p+(o-i)>g)return}this.lastResizeAmount=o,d?.setColumnWidths(l,this.resizeWithShiftKey,e,"uiColumnResized"),e&&this.toggleColumnResizing(!1)}onResizeStart(e){this.resizeStartWidth=this.column.getActualWidth(),this.lastResizeAmount=0,this.resizeWithShiftKey=e,this.toggleColumnResizing(!0)}toggleColumnResizing(e){this.comp.addOrRemoveCssClass("ag-column-resizing",e)}normaliseResizeAmount(e){let t=e;const n=this.pinned!=="left",i=this.pinned==="right";return this.gos.get("enableRtl")?n&&(t*=-1):i&&(t*=-1),t}},JYe=class extends X{constructor(){super(...arguments),this.beanName="colResize"}setColumnWidths(e,t,n,i){const r=[],{colModel:s,gos:o,visibleCols:a}=this.beans;e.forEach(l=>{const u=s.getColDefCol(l.key)||s.getCol(l.key);if(!u)return;if(r.push({width:l.newWidth,ratios:[1],columns:[u]}),o.get("colResizeDefault")==="shift"&&(t=!t),t){const d=a.getColAfter(u);if(!d)return;const h=u.getActualWidth()-l.newWidth,p=d.getActualWidth()+h;r.push({width:p,ratios:[1],columns:[d]})}}),r.length!==0&&this.resizeColumnSets({resizeSets:r,finished:n,source:i})}resizeColumnSets(e){const{resizeSets:t,finished:n,source:i}=e;if(!(!t||t.every(c=>ZYe(c)))){if(n){const c=t&&t.length>0?t[0].columns:null;Fp(this.eventSvc,c,n,i)}return}const s=[],o=[];t.forEach(c=>{const{width:d,columns:h,ratios:p}=c,g={},v={};h.forEach(b=>o.push(b));let C=!0,y=0;for(;C;){if(y++,y>1e3){wt(31);break}C=!1;const b=[];let S=0,x=d;h.forEach((A,F)=>{if(v[A.getId()])x-=g[A.getId()];else{b.push(A);const P=p[F];S+=P}});const E=1/S;b.forEach((A,F)=>{const k=F===b.length-1;let P;k?P=x:(P=Math.round(p[F]*d*E),x-=P);const _=A.getMinWidth(),O=A.getMaxWidth();P<_?(P=_,v[A.getId()]=!0,C=!0):O>0&&P>O&&(P=O,v[A.getId()]=!0,C=!0),g[A.getId()]=P})}h.forEach(b=>{const S=g[b.getId()];b.getActualWidth()!==S&&(b.setActualWidth(S,i),s.push(b))})});const a=s.length>0;let l=[];if(a){const{colFlex:c,visibleCols:d,colViewport:h}=this.beans;l=c?.refreshFlexedColumns({resizingCols:o,skipSetLeft:!0})??[],d.setLeftValues(i),d.updateBodyWidths(),h.checkViewportColumns()}const u=o.concat(l);(a||n)&&Fp(this.eventSvc,u,n,i,l)}resizeHeader(e,t,n){if(!e.isResizable())return;const i=e.getActualWidth(),r=e.getMinWidth(),s=e.getMaxWidth(),o=Math.min(Math.max(i+t,r),s);this.setColumnWidths([{key:e,newWidth:o}],n,!0,"uiColumnResized")}createResizeFeature(e,t,n,i,r){return new QYe(e,t,n,i,r)}createGroupResizeFeature(e,t,n,i){return new XYe(e,t,n,i)}};function ZYe(e){const{columns:t,width:n}=e;let i=0,r=0,s=!0;t.forEach(l=>{const u=l.getMinWidth();i+=u||0;const c=l.getMaxWidth();c>0?r+=c:s=!1});const o=n>=i,a=!s||n<=r;return o&&a}var eXe={moduleName:"ColumnResize",version:Ce,beans:[JYe],apiFunctions:{setColumnWidths:YYe},dependsOn:[AYe,rie]},tXe=class extends X{constructor(e,t){super(),this.removeChildListenersFuncs=[],this.columnGroup=t,this.comp=e}postConstruct(){this.addListenersToChildrenColumns(),this.addManagedListeners(this.columnGroup,{displayedChildrenChanged:this.onDisplayedChildrenChanged.bind(this)}),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))}addListenersToChildrenColumns(){this.removeListenersOnChildrenColumns();const e=this.onWidthChanged.bind(this);this.columnGroup.getLeafColumns().forEach(t=>{t.__addEventListener("widthChanged",e),t.__addEventListener("visibleChanged",e),this.removeChildListenersFuncs.push(()=>{t.__removeEventListener("widthChanged",e),t.__removeEventListener("visibleChanged",e)})})}removeListenersOnChildrenColumns(){this.removeChildListenersFuncs.forEach(e=>e()),this.removeChildListenersFuncs=[]}onDisplayedChildrenChanged(){this.addListenersToChildrenColumns(),this.onWidthChanged()}onWidthChanged(){const e=this.columnGroup.getActualWidth();this.comp.setWidth(`${e}px`),this.comp.addOrRemoveCssClass("ag-hidden",e===0)}},nXe=class extends DN{constructor(){super(...arguments),this.onSuppressColMoveChange=()=>{!this.isAlive()||this.isSuppressMoving()?this.removeDragSource():this.dragSource||this.setDragSource(this.eGui)}}setComp(e,t,n,i,r){const{column:s,beans:o}=this,{context:a,colNames:l,colHover:u,rangeSvc:c,colResize:d}=o;this.comp=e,r=wC(this,a,r),this.setGui(t,r),this.displayName=l.getDisplayNameForColumnGroup(s,"header"),this.refreshHeaderStyles(),this.addClasses(),this.setupMovingCss(r),this.setupExpandable(r),this.setupTooltip(),this.setupAutoHeight({wrapperElement:i,compBean:r}),this.setupUserComp(),this.addHeaderMouseListeners(r),this.addManagedPropertyListener("groupHeaderHeight",this.refreshMaxHeaderHeight.bind(this)),this.refreshMaxHeaderHeight();const h=this.rowCtrl.pinned,p=s.getProvidedColumnGroup().getLeafColumns();u?.createHoverFeature(r,p,t),c?.createRangeHighlightFeature(r,s,e),r.createManagedBean(new AN(s,t,o)),r.createManagedBean(new tXe(e,s)),d?this.resizeFeature=r.createManagedBean(d.createGroupResizeFeature(e,n,h,s)):e.setResizableDisplayed(!1),r.createManagedBean(new vg(t,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:()=>{},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)})),this.addHighlightListeners(r,p),r.addManagedPropertyListener("suppressMovableColumns",this.onSuppressColMoveChange),this.addResizeAndMoveKeyboardListeners(r),r.addDestroyFunc(()=>this.clearComponent())}getHeaderClassParams(){const{column:e,beans:t}=this,n=e.getDefinition();return Ne(t.gos,{colDef:n,columnGroup:e,floatingFilter:!1})}refreshMaxHeaderHeight(){const{gos:e,comp:t}=this,n=e.get("groupHeaderHeight");n!=null?n===0?t.setHeaderWrapperHidden(!0):t.setHeaderWrapperMaxHeight(n):(t.setHeaderWrapperHidden(!1),t.setHeaderWrapperMaxHeight(null))}addHighlightListeners(e,t){if(this.beans.gos.get("suppressMoveWhenColumnDragging"))for(const n of t)e.addManagedListeners(n,{headerHighlightChanged:this.onLeafColumnHighlightChanged.bind(this,n)})}onLeafColumnHighlightChanged(e){const t=this.column.getDisplayedLeafColumns(),n=t[0]===e,i=Tt(t)===e;if(!n&&!i)return;const r=e.getHighlighted(),s=!!this.rowCtrl.getHeaderCellCtrls().find(l=>l.column.isMoving());let o=!1,a=!1;if(s){const l=this.beans.gos.get("enableRtl"),u=r===1,c=r===0;n&&(l?a=u:o=c),i&&(l?o=c:a=u)}this.comp.addOrRemoveCssClass("ag-header-highlight-before",o),this.comp.addOrRemoveCssClass("ag-header-highlight-after",a)}resizeHeader(e,t){const{resizeFeature:n}=this;if(!n)return;const i=n.getInitialValues(t);n.resizeColumns(i,i.resizeStartWidth+e,"uiColumnResized",!0)}resizeLeafColumnsToFit(e){this.resizeFeature?.resizeLeafColumnsToFit(e)}setupUserComp(){const{colGroupSvc:e,userCompFactory:t,gos:n}=this.beans,i=Ne(n,{displayName:this.displayName,columnGroup:this.column,setExpanded:s=>{e.setColumnGroupOpened(this.column.getProvidedColumnGroup(),s,"gridInitializing")},setTooltip:(s,o)=>{n.assertModuleRegistered("Tooltip",3),this.setupTooltip(s,o)}}),r=q7e(t,i);r&&this.comp.setUserCompDetails(r)}addHeaderMouseListeners(e){const t=r=>this.handleMouseOverChange(r.type==="mouseenter"),n=()=>this.dispatchColumnMouseEvent("columnHeaderClicked",this.column.getProvidedColumnGroup()),i=r=>this.handleContextMenuMouseEvent(r,void 0,this.column.getProvidedColumnGroup());e.addManagedListeners(this.eGui,{mouseenter:t,mouseleave:t,click:n,contextmenu:i})}handleMouseOverChange(e){this.eventSvc.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column.getProvidedColumnGroup()})}setupTooltip(e,t){this.tooltipFeature=this.beans.tooltipSvc?.setupHeaderGroupTooltip(this.tooltipFeature,this,e,t)}setupExpandable(e){const t=this.column.getProvidedColumnGroup();this.refreshExpanded();const n=this.refreshExpanded.bind(this);e.addManagedListeners(t,{expandedChanged:n,expandableChanged:n})}refreshExpanded(){const{column:e}=this;this.expandable=e.isExpandable();const t=e.isExpanded();this.expandable?this.comp.setAriaExpanded(t?"true":"false"):this.comp.setAriaExpanded(void 0),this.refreshHeaderStyles()}addClasses(){const{column:e}=this,t=e.getColGroupDef(),n=wne(t,this.gos,null,e);e.isPadding()?(n.push("ag-header-group-cell-no-group"),e.getLeafColumns().every(r=>r.isSpanHeaderHeight())&&n.push("ag-header-span-height")):(n.push("ag-header-group-cell-with-group"),t?.wrapHeaderText&&n.push("ag-header-cell-wrap-text")),n.forEach(i=>this.comp.addOrRemoveCssClass(i,!0))}setupMovingCss(e){const{column:t}=this,i=t.getProvidedColumnGroup().getLeafColumns(),r=()=>this.comp.addOrRemoveCssClass("ag-header-cell-moving",t.isMoving());i.forEach(s=>{e.addManagedListeners(s,{movingChanged:r})}),r()}onFocusIn(e){this.eGui.contains(e.relatedTarget)||this.focusThis()}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();if(!(!this.expandable||!t)&&e.key===K.ENTER){const n=this.column,i=!n.isExpanded();this.beans.colGroupSvc.setColumnGroupOpened(n.getProvidedColumnGroup(),i,"uiColumnExpanded")}}setDragSource(e){!this.isAlive()||this.isSuppressMoving()||(this.removeDragSource(),e&&(this.dragSource=this.beans.colMoves?.setDragSourceForHeader(e,this.column,this.displayName)??null))}isSuppressMoving(){return this.gos.get("suppressMovableColumns")||this.column.getLeafColumns().some(e=>e.getColDef().suppressMovable||e.getColDef().lockPosition)}destroy(){this.tooltipFeature=this.destroyBean(this.tooltipFeature),super.destroy()}};function iXe(e,t,n){e.colGroupSvc?.setColumnGroupOpened(t,n,"api")}function rXe(e,t,n){return e.colGroupSvc?.getColumnGroup(t,n)??null}function sXe(e,t){return e.colGroupSvc?.getProvidedColGroup(t)??null}function oXe(e,t,n){return e.colNames.getDisplayNameForColumnGroup(t,n)||""}function aXe(e){return e.colGroupSvc?.getColumnGroupState()??[]}function lXe(e,t){e.colGroupSvc?.setColumnGroupState(t,"api")}function uXe(e){e.colGroupSvc?.resetColumnGroupState("api")}function cXe(e){return e.visibleCols.treeLeft}function dXe(e){return e.visibleCols.treeCenter}function hXe(e){return e.visibleCols.treeRight}function fXe(e){return e.visibleCols.getAllTrees()}function pXe(e,t){for(let n=0;n<t.length;n++){const i=e.indexOf(t[n]);i>=0&&(e[i]=e[e.length-1],e.pop())}}var gXe=class extends X{constructor(){super(...arguments),this.beanName="visibleCols",this.colsAndGroupsMap={},this.leftCols=[],this.rightCols=[],this.centerCols=[],this.allCols=[],this.bodyWidth=0,this.leftWidth=0,this.rightWidth=0,this.isBodyWidthDirty=!0}refresh(e,t=!1){const{colModel:n,colGroupSvc:i,colViewport:r}=this.beans;t||this.buildTrees(n,i),i?.updateOpenClosedVisibility();const s=ID(this.treeLeft);this.leftCols=s,this.centerCols=ID(this.treeCenter);const o=ID(this.treeRight);this.rightCols=o,this.joinColsAriaOrder(n),this.joinCols(),this.setLeftValues(e),this.autoHeightCols=this.allCols.filter(a=>a.isAutoHeight()),this.beans.colFlex?.refreshFlexedColumns(),this.updateBodyWidths(),r.checkViewportColumns(!1),this.setFirstRightAndLastLeftPinned(n,s,o,e),this.eventSvc.dispatchEvent({type:"displayedColumnsChanged",source:e})}updateBodyWidths(){const e=ol(this.centerCols),t=ol(this.leftCols),n=ol(this.rightCols);this.isBodyWidthDirty=this.bodyWidth!==e,(this.bodyWidth!==e||this.leftWidth!==t||this.rightWidth!==n)&&(this.bodyWidth=e,this.leftWidth=t,this.rightWidth=n,this.eventSvc.dispatchEvent({type:"columnContainerWidthChanged"}),this.eventSvc.dispatchEvent({type:"displayedColumnsWidthChanged"}))}setLeftValues(e){this.setLeftValuesOfCols(e),this.setLeftValuesOfGroups()}setFirstRightAndLastLeftPinned(e,t,n,i){let r,s;this.gos.get("enableRtl")?(r=t?t[0]:null,s=n?Tt(n):null):(r=t?Tt(t):null,s=n?n[0]:null),e.getCols().forEach(o=>{o.setLastLeftPinned(o===r,i),o.setFirstRightPinned(o===s,i)})}buildTrees(e,t){const n=e.getColsToShow(),i=n.filter(l=>l.getPinned()=="left"),r=n.filter(l=>l.getPinned()=="right"),s=n.filter(l=>l.getPinned()!="left"&&l.getPinned()!="right"),o=new fne,a=l=>t?t.createColumnGroups(l):l.columns;this.treeLeft=a({columns:i,idCreator:o,pinned:"left",oldDisplayedGroups:this.treeLeft}),this.treeRight=a({columns:r,idCreator:o,pinned:"right",oldDisplayedGroups:this.treeRight}),this.treeCenter=a({columns:s,idCreator:o,pinned:null,oldDisplayedGroups:this.treeCenter}),this.updateColsAndGroupsMap()}clear(){this.leftCols=[],this.rightCols=[],this.centerCols=[],this.allCols=[],this.ariaOrderColumns=[]}joinColsAriaOrder(e){const t=e.getCols(),n=[],i=[],r=[];for(const s of t){const o=s.getPinned();o?o===!0||o==="left"?n.push(s):r.push(s):i.push(s)}this.ariaOrderColumns=n.concat(i).concat(r)}getAriaColIndex(e){let t;return on(e)?t=e.getLeafColumns()[0]:t=e,this.ariaOrderColumns.indexOf(t)+1}setLeftValuesOfGroups(){[this.treeLeft,this.treeRight,this.treeCenter].forEach(e=>{e.forEach(t=>{on(t)&&t.checkLeft()})})}setLeftValuesOfCols(e){const{colModel:t}=this.beans;if(!t.getColDefCols())return;const i=t.getCols().slice(0),r=this.gos.get("enableRtl");[this.leftCols,this.rightCols,this.centerCols].forEach(s=>{if(r){let o=ol(s);s.forEach(a=>{o-=a.getActualWidth(),a.setLeft(o,e)})}else{let o=0;s.forEach(a=>{a.setLeft(o,e),o+=a.getActualWidth()})}pXe(i,s)}),i.forEach(s=>{s.setLeft(null,e)})}joinCols(){this.gos.get("enableRtl")?this.allCols=this.rightCols.concat(this.centerCols).concat(this.leftCols):this.allCols=this.leftCols.concat(this.centerCols).concat(this.rightCols)}getAllTrees(){return this.treeLeft&&this.treeRight&&this.treeCenter?this.treeLeft.concat(this.treeCenter).concat(this.treeRight):null}isColDisplayed(e){return this.allCols.indexOf(e)>=0}getLeftColsForRow(e){const{leftCols:t,beans:{colModel:n}}=this;return n.colSpanActive?this.getColsForRow(e,t):t}getRightColsForRow(e){const{rightCols:t,beans:{colModel:n}}=this;return n.colSpanActive?this.getColsForRow(e,t):t}getColsForRow(e,t,n,i){const r=[];let s=null;for(let o=0;o<t.length;o++){const a=t[o],l=t.length-o,u=Math.min(a.getColSpan(e),l),c=[a];if(u>1){const h=u-1;for(let p=1;p<=h;p++)c.push(t[o+p]);o+=h}let d;n?(d=!1,c.forEach(h=>{n(h)&&(d=!0)})):d=!0,d&&(r.length===0&&s&&(i&&i(a))&&r.push(s),r.push(a)),s=a}return r}getContainerWidth(e){switch(e){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}}getColBefore(e){const t=this.allCols,n=t.indexOf(e);return n>0?t[n-1]:null}isPinningLeft(){return this.leftCols.length>0}isPinningRight(){return this.rightCols.length>0}updateColsAndGroupsMap(){this.colsAndGroupsMap={};const e=t=>{this.colsAndGroupsMap[t.getUniqueId()]=t};Dd(this.treeCenter,!1,e),Dd(this.treeLeft,!1,e),Dd(this.treeRight,!1,e)}isVisible(e){return this.colsAndGroupsMap[e.getUniqueId()]===e}getFirstColumn(){const e=this.gos.get("enableRtl"),t=["leftCols","centerCols","rightCols"];e&&t.reverse();for(let n=0;n<t.length;n++){const i=this[t[n]];if(i.length)return e?Tt(i):i[0]}return null}getColAfter(e){const t=this.allCols,n=t.indexOf(e);return n<t.length-1?t[n+1]:null}getColsLeftWidth(){return ol(this.leftCols)}getDisplayedColumnsRightWidth(){return ol(this.rightCols)}isColAtEdge(e,t){const n=this.allCols;if(!n.length)return!1;const i=t==="first";let r;if(on(e)){const s=e.getDisplayedLeafColumns();if(!s.length)return!1;r=i?s[0]:Tt(s)}else r=e;return(i?n[0]:Tt(n))===r}};function Dd(e,t,n){if(e)for(let i=0;i<e.length;i++){const r=e[i];if(on(r)){const s=t?r.getDisplayedChildren():r.getChildren();Dd(s,t,n)}n(r)}}function ID(e){const t=[];return Dd(e,!0,n=>{lc(n)&&t.push(n)}),t}var mXe=class extends X{constructor(){super(...arguments),this.beanName="colGroupSvc"}getColumnGroupState(){const e=[],t=this.beans.colModel.getColTree();return Al(null,t,n=>{Ui(n)&&e.push({groupId:n.getGroupId(),open:n.isExpanded()})}),e}resetColumnGroupState(e){const t=this.beans.colModel.getColDefColTree();if(!t)return;const n=[];Al(null,t,i=>{if(Ui(i)){const r=i.getColGroupDef(),s={groupId:i.getGroupId(),open:r?r.openByDefault:void 0};n.push(s)}}),this.setColumnGroupState(n,e)}setColumnGroupState(e,t){const{colModel:n,colAnimation:i,visibleCols:r,eventSvc:s}=this.beans;if(!n.getColTree().length)return;i?.start();const a=[];e.forEach(l=>{const u=l.groupId,c=l.open,d=this.getProvidedColGroup(u);d&&d.isExpanded()!==c&&(d.setExpanded(c),a.push(d))}),r.refresh(t,!0),a.length&&s.dispatchEvent({type:"columnGroupOpened",columnGroup:a.length===1?a[0]:void 0,columnGroups:a}),i?.finish()}setColumnGroupOpened(e,t,n){let i;Ui(e)?i=e.getId():i=e||"",this.setColumnGroupState([{groupId:i,open:t}],n)}getProvidedColGroup(e){let t=null;return Al(null,this.beans.colModel.getColTree(),n=>{Ui(n)&&n.getId()===e&&(t=n)}),t}getGroupAtDirection(e,t){const n=e.getProvidedColumnGroup().getLevel()+e.getPaddingLevel(),i=e.getDisplayedLeafColumns(),r=t==="After"?Tt(i):i[0],s=`getCol${t}`;for(;;){const o=this.beans.visibleCols[s](r);if(!o)return null;const a=this.getColGroupAtLevel(o,n);if(a!==e)return a}}getColGroupAtLevel(e,t){let n=e.getParent(),i,r;for(;i=n.getProvidedColumnGroup().getLevel(),r=n.getPaddingLevel(),!(i+r<=t);)n=n.getParent();return n}updateOpenClosedVisibility(){const e=this.beans.visibleCols.getAllTrees();Dd(e,!1,t=>{on(t)&&t.calculateDisplayedColumns()})}getColumnGroup(e,t){if(!e)return null;if(on(e))return e;const n=this.beans.visibleCols.getAllTrees(),i=typeof t=="number";let r=null;return Dd(n,!1,s=>{if(on(s)){const o=s;let a;i?a=e===o.getGroupId()&&t===o.getPartId():a=e===o.getGroupId(),a&&(r=o)}}),r}createColumnGroups(e){const{columns:t,idCreator:n,pinned:i,oldDisplayedGroups:r,isStandaloneStructure:s}=e,o=this.mapOldGroupsById(r),a=[];let l=t;for(;l.length;){const u=l;l=[];let c=0;const d=h=>{const p=c;c=h;const g=u[p],C=(on(g)?g.getProvidedColumnGroup():g).getOriginalParent();if(C==null){for(let b=p;b<h;b++)a.push(u[b]);return}const y=this.createColumnGroup(C,n,o,i,s);for(let b=p;b<h;b++)y.addChild(u[b]);l.push(y)};for(let h=1;h<u.length;h++){const p=u[h],v=(on(p)?p.getProvidedColumnGroup():p).getOriginalParent(),C=u[c],b=(on(C)?C.getProvidedColumnGroup():C).getOriginalParent();v!==b&&d(h)}c<u.length&&d(u.length)}return s||this.setupParentsIntoCols(a,null),a}createProvidedColumnGroup(e,t,n,i,r,s,o){const a=r.getUniqueKey(t.groupId||null,null),l=this.createMergedColGroupDef(t,a),u=new jw(l,a,!1,n);this.createBean(u);const c=this.findExistingGroup(t,s);c&&s.splice(c.idx,1);const d=c?.group;d&&u.setExpanded(d.isExpanded());const h=sne(this.beans,l.children,n+1,e,i,r,s,o);return u.setChildren(h),u}balanceColumnTree(e,t,n,i){const r=[];for(let s=0;s<e.length;s++){const o=e[s];if(Ui(o)){const a=o,l=this.balanceColumnTree(a.getChildren(),t+1,n,i);a.setChildren(l),r.push(a)}else{let a,l;for(let u=n-1;u>=t;u--){const c=i.getUniqueKey(null,null),d=this.createMergedColGroupDef(null,c),h=new jw(d,c,!0,t);this.createBean(h),l&&l.setChildren([h]),l=h,a||(a=l)}if(a&&l)if(r.push(a),e.some(c=>Ui(c))){l.setChildren([o]);continue}else{l.setChildren(e);break}r.push(o)}}return r}findDepth(e){let t=0,n=e;for(;n&&n[0]&&Ui(n[0]);)t++,n=n[0].getChildren();return t}findMaxDepth(e,t){let n=t;for(let i=0;i<e.length;i++){const r=e[i];if(Ui(r)){const s=r,o=this.findMaxDepth(s.getChildren(),t+1);n<o&&(n=o)}}return n}balanceTreeForAutoCols(e,t){const n=[];return e.forEach(i=>{let r=i;for(let s=t-1;s>=0;s--){const o=new jw(null,`FAKE_PATH_${i.getId()}}_${s}`,!0,s);this.createBean(o),o.setChildren([r]),r.originalParent=o,r=o}t===0&&(i.originalParent=null),n.push(r)}),n}createMergedColGroupDef(e,t){const n={},{gos:i,validation:r}=this.beans;return Object.assign(n,i.get("defaultColGroupDef")),Object.assign(n,e),r?.validateColDef(n,t),n}findExistingGroup(e,t){if(e.groupId!=null)for(let i=0;i<t.length;i++){const r=t[i];if(r.getColGroupDef()&&r.getId()===e.groupId)return{idx:i,group:r}}}createColumnGroup(e,t,n,i,r){const s=e.getGroupId(),o=t.getInstanceIdForKey(s),a=kne(s,o);let l=n[a];return l&&l.getProvidedColumnGroup()!==e&&(l=null),me(l)?l.reset():(l=new Tne(e,s,o,i),r||this.createBean(l)),l}mapOldGroupsById(e){const t={},n=i=>{i.forEach(r=>{if(on(r)){const s=r;t[r.getUniqueId()]=s,n(s.getChildren())}})};return e&&n(e),t}setupParentsIntoCols(e,t){e.forEach(n=>{if(n.parent=t,on(n)){const i=n;this.setupParentsIntoCols(i.getChildren(),i)}})}},vXe={moduleName:"ColumnGroup",version:Ce,dynamicBeans:{headerGroupCellCtrl:nXe},beans:[mXe],apiFunctions:{getAllDisplayedColumnGroups:fXe,getCenterDisplayedColumnGroups:dXe,getColumnGroup:rXe,getColumnGroupState:aXe,getDisplayNameForColumnGroup:oXe,getLeftDisplayedColumnGroups:cXe,getProvidedColumnGroup:sXe,getRightDisplayedColumnGroups:hXe,resetColumnGroupState:uXe,setColumnGroupOpened:iXe,setColumnGroupState:lXe}},CXe={moduleName:"CheckboxCellRenderer",version:Ce,userComponents:{agCheckboxCellRenderer:mKe}};function yXe(e,t){const n=e.colModel.getColDefCol(t);return n?n.getColDef():null}function wXe(e){return e.colModel.getColumnDefs()}function bXe(e,t,n){return e.colNames.getDisplayNameForColumn(t,n)||""}function SXe(e,t){return e.colModel.getColDefCol(t)}function xXe(e){return e.colModel.getColDefCols()}function RXe(e,t){return Jr(e,t,"api")}function EXe(e){return h0(e)}function FXe(e){y7e(e,"api")}function AXe(e){return e.visibleCols.isPinningLeft()||e.visibleCols.isPinningRight()}function DXe(e){return e.visibleCols.isPinningLeft()}function PXe(e){return e.visibleCols.isPinningRight()}function kXe(e,t){return e.visibleCols.getColAfter(t)}function TXe(e,t){return e.visibleCols.getColBefore(t)}function MXe(e,t,n){e.colModel.setColsVisible(t,n,"api")}function IXe(e,t,n){e.pinnedCols?.setColsPinned(t,n,"api")}function _Xe(e){return e.colModel.getCols()}function OXe(e){return e.visibleCols.leftCols}function LXe(e){return e.visibleCols.centerCols}function NXe(e){return e.visibleCols.rightCols}function $Xe(e){return e.visibleCols.allCols}function BXe(e){return e.colViewport.getViewportColumns()}function $T(e,t){if(!e)return;const n=e,i={};return Object.keys(n).forEach(r=>{if(t&&t.indexOf(r)>=0||ene.has(r))return;const s=n[r];typeof s=="object"&&s!==null&&s.constructor===Object?i[r]=$T(s):i[r]=s}),i}var GXe=class extends X{constructor(){super(...arguments),this.beanName="colDefFactory"}wireBeans(e){this.rowGroupColsSvc=e.rowGroupColsSvc,this.pivotColsSvc=e.pivotColsSvc}getColumnDefs(e,t,n,i){const r=e.slice();t?r.sort((a,l)=>n.indexOf(a)-n.indexOf(l)):n&&r.sort((a,l)=>i.indexOf(a)-i.indexOf(l));const s=this.rowGroupColsSvc?.columns,o=this.pivotColsSvc?.columns;return this.buildColumnDefs(r,s,o)}buildColumnDefs(e,t=[],n=[]){const i=[],r={};return e.forEach(s=>{const o=this.createDefFromColumn(s,t,n);let a=!0,l=o,u=s.getOriginalParent(),c=null;for(;u;){let d=null;if(u.isPadding()){u=u.getOriginalParent();continue}const h=r[u.getGroupId()];if(h){h.children.push(l),a=!1;break}if(d=this.createDefFromGroup(u),d&&(d.children=[l],r[d.groupId]=d,l=d,u=u.getOriginalParent()),u!=null&&c===u){a=!1;break}c=u}a&&i.push(l)}),i}createDefFromGroup(e){const t=$T(e.getColGroupDef(),["children"]);return t&&(t.groupId=e.getGroupId()),t}createDefFromColumn(e,t,n){const i=$T(e.getColDef());return i.colId=e.getColId(),i.width=e.getActualWidth(),i.rowGroup=e.isRowGroupActive(),i.rowGroupIndex=e.isRowGroupActive()?t.indexOf(e):null,i.pivot=e.isPivotActive(),i.pivotIndex=e.isPivotActive()?n.indexOf(e):null,i.aggFunc=e.isValueActive()?e.getAggFunc():null,i.hide=e.isVisible()?void 0:!0,i.pinned=e.isPinned()?e.getPinned():null,i.sort=e.getSort()?e.getSort():null,i.sortIndex=e.getSortIndex()!=null?e.getSortIndex():null,i}},zXe=class extends X{constructor(){super(...arguments),this.beanName="colFlex"}refreshFlexedColumns(e={}){const t=e.source??"flex";e.viewportWidth!=null&&(this.flexViewportWidth=e.viewportWidth);const n=this.flexViewportWidth;if(!n)return[];const{visibleCols:i}=this.beans,r=i.centerCols;let s=-1;if(e.resizingCols){const g=new Set(e.resizingCols);for(let v=r.length-1;v>=0;v--)if(g.has(r[v])){s=v;break}}let o=!1;const a=r.map((g,v)=>{const C=g.getFlex(),y=C!=null&&C>0&&v>s;return o||(o=y),{col:g,isFlex:y,flex:Math.max(0,C??0),initialSize:g.getActualWidth(),min:g.getMinWidth(),max:g.getMaxWidth(),targetSize:0}});if(!o)return[];let l=a.length,u=a.reduce((g,v)=>g+v.flex,0),c=n;const d=(g,v)=>{g.frozenSize=v,g.col.setActualWidth(v,t),c-=v,u-=g.flex,l-=1},h=g=>g.frozenSize!=null;for(const g of a)g.isFlex||d(g,g.initialSize);for(;l>0;){const g=Math.round(u<1?c*u:c);let v,C=0,y=0;for(const x of a){if(h(x))continue;v=x,y+=g*(x.flex/u);const E=y-C,A=Math.round(E);x.targetSize=A,C+=A}v&&(v.targetSize+=g-C);let b=0;for(const x of a){if(h(x))continue;const E=x.targetSize,A=Math.min(Math.max(E,x.min),x.max);b+=A-E,x.violationType=A===E?void 0:A<E?"max":"min",x.targetSize=A}const S=b===0?"all":b>0?"min":"max";for(const x of a)h(x)||(S==="all"||x.violationType===S)&&d(x,x.targetSize)}e.skipSetLeft||i.setLeftValues(t),e.updateBodyWidths&&i.updateBodyWidths();const p=a.filter(g=>g.isFlex&&!g.violationType).map(g=>g.col);if(e.fireResizedEvent){const g=a.filter(C=>C.initialSize!==C.frozenSize).map(C=>C.col),v=a.filter(C=>C.flex).map(C=>C.col);Fp(this.eventSvc,g,!0,t,v)}return p}initCol(e){const{flex:t,initialFlex:n}=e.colDef;t!==void 0?e.flex=t:n!==void 0&&(e.flex=n)}setColFlex(e,t){e.flex=t??null,e.dispatchStateUpdatedEvent("flex")}},HXe=class extends X{constructor(){super(...arguments),this.beanName="dataTypeSvc",this.dataTypeDefinitions={},this.isPendingInference=!1,this.isColumnTypeOverrideInDataTypeDefinitions=!1,this.columnStateUpdatesPendingInference={},this.columnStateUpdateListenerDestroyFuncs=[]}wireBeans(e){this.colModel=e.colModel}postConstruct(){this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",e=>{this.processDataTypeDefinitions(),this.colModel.recreateColumnDefs(e)})}processDataTypeDefinitions(){const e=this.getDefaultDataTypes(),t={};this.dataTypeDefinitions=t;const n={};this.formatValueFuncs=n;const i=o=>a=>{const{column:l,node:u,value:c}=a;let d=l.getColDef().valueFormatter;return d===o.groupSafeValueFormatter&&(d=o.valueFormatter),this.beans.valueSvc.formatValue(l,u,c,d)};for(const o of Object.keys(e)){const a=e[o],l={...a,groupSafeValueFormatter:vW(a,this.gos)};t[o]=l,n[o]=i(l)}const r=this.gos.get("dataTypeDefinitions")??{},s={};this.dataTypeMatchers=s;for(const o of Object.keys(r)){const a=r[o],l=this.processDataTypeDefinition(a,r,[o],e);l&&(t[o]=l,a.dataTypeMatcher&&(s[o]=a.dataTypeMatcher),n[o]=i(l))}this.checkObjectValueHandlers(e),["dateString","text","number","boolean","date"].forEach(o=>{const a=s[o];a&&delete s[o],s[o]=a??e[o].dataTypeMatcher})}processDataTypeDefinition(e,t,n,i){let r;const s=e.extendsDataType;if(e.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),e.extendsDataType===e.baseDataType){let o=i[s];const a=t[s];if(o&&a&&(o=a),!mW(e,o,s))return;r=gW(o,e)}else{if(n.includes(s)){ue(44);return}const o=t[s];if(!mW(e,o,s))return;const a=this.processDataTypeDefinition(o,t,[...n,s],i);if(!a)return;r=gW(a,e)}return{...r,groupSafeValueFormatter:vW(r,this.gos)}}updateColDefAndGetColumnType(e,t,n){let{cellDataType:i}=t;const{field:r}=t;if(i===void 0&&(i=e.cellDataType),(i==null||i===!0)&&(i=this.canInferCellDataType(e,t)?this.inferCellDataType(r,n):!1),!i){e.cellDataType=!1;return}const s=this.dataTypeDefinitions[i];if(!s){ue(47,{cellDataType:i});return}return e.cellDataType=i,s.groupSafeValueFormatter&&(e.valueFormatter=s.groupSafeValueFormatter),s.valueParser&&(e.valueParser=s.valueParser),s.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(e,i,s,n),s.columnTypes}addColumnListeners(e){if(!this.isPendingInference)return;const t=this.columnStateUpdatesPendingInference[e.getColId()];if(!t)return;const n=i=>{t.add(i.key)};e.__addEventListener("columnStateUpdated",n),this.columnStateUpdateListenerDestroyFuncs.push(()=>e.__removeEventListener("columnStateUpdated",n))}canInferCellDataType(e,t){const{gos:n}=this;if(!Xi(n))return!1;const i={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(_D(t,i))return!1;const r=t.type===null?e.type:t.type;if(r){const s=n.get("columnTypes")??{};if(YS(r).some(a=>{const l=s[a.trim()];return l&&_D(l,i)}))return!1}return!_D(e,i)}inferCellDataType(e,t){if(!e)return;let n;const i=this.getInitialData();if(i){const r=e.indexOf(".")>=0&&!this.gos.get("suppressFieldDotNotation");n=dv(i,e,r)}else this.initWaitForRowData(t);if(n!=null)return Object.keys(this.dataTypeMatchers).find(r=>this.dataTypeMatchers[r](n))??"object"}getInitialData(){const e=this.gos.get("rowData");if(e?.length)return e[0];if(this.initialData)return this.initialData;{const t=this.beans.rowModel.rootNode?.allLeafChildren;if(t?.length)return t[0].data}return null}initWaitForRowData(e){if(this.columnStateUpdatesPendingInference[e]=new Set,this.isPendingInference)return;this.isPendingInference=!0;const t=this.isColumnTypeOverrideInDataTypeDefinitions,{colAutosize:n,eventSvc:i}=this.beans;t&&n&&(n.shouldQueueResizeOperations=!0);const[r]=this.addManagedEventListeners({rowDataUpdateStarted:s=>{const{firstRowData:o}=s;o&&(r?.(),this.isPendingInference=!1,this.processColumnsPendingInference(o,t),this.columnStateUpdatesPendingInference={},t&&n?.processResizeOperations(),i.dispatchEvent({type:"dataTypesInferred"}))}})}processColumnsPendingInference(e,t){this.initialData=e;const n=[];this.destroyColumnStateUpdateListeners();const i={},r={};for(const s of Object.keys(this.columnStateUpdatesPendingInference)){const o=this.columnStateUpdatesPendingInference[s],a=this.colModel.getCol(s);if(!a)return;const l=a.getColDef();if(!this.resetColDefIntoCol(a,"cellDataTypeInferred"))return;const u=a.getColDef();if(t&&u.type&&u.type!==l.type){const c=WXe(a,o);c.rowGroup&&c.rowGroupIndex==null&&(i[s]=c),c.pivot&&c.pivotIndex==null&&(r[s]=c),n.push(c)}}t&&n.push(...this.generateColumnStateForRowGroupAndPivotIndexes(i,r)),n.length&&Jr(this.beans,{state:n},"cellDataTypeInferred"),this.initialData=null}generateColumnStateForRowGroupAndPivotIndexes(e,t){const n={},{rowGroupColsSvc:i,pivotColsSvc:r}=this.beans;return i?.restoreColumnOrder(n,e),r?.restoreColumnOrder(n,t),Object.values(n)}resetColDefIntoCol(e,t){const n=e.getUserProvidedColDef();if(!n)return!1;const i=MT(this.beans,n,e.getColId());return e.setColDef(i,n,t),!0}checkObjectValueHandlers(e){const t=this.dataTypeDefinitions.object,n=e.object;this.hasObjectValueParser=t.valueParser!==n.valueParser,this.hasObjectValueFormatter=t.valueFormatter!==n.valueFormatter}getDateStringTypeDefinition(e){const{dateString:t}=this.dataTypeDefinitions;return e?this.getDataTypeDefinition(e)??t:t}getDateParserFunction(e){return this.getDateStringTypeDefinition(e).dateParser}getDateFormatterFunction(e){return this.getDateStringTypeDefinition(e).dateFormatter}getDataTypeDefinition(e){const t=e.getColDef();if(t.cellDataType)return this.dataTypeDefinitions[t.cellDataType]}getBaseDataType(e){return this.getDataTypeDefinition(e)?.baseDataType}checkType(e,t){if(t==null)return!0;const n=this.getDataTypeDefinition(e)?.dataTypeMatcher;return n?n(t):!0}validateColDef(e){const t=n=>ue(48,{property:n});if(e.cellDataType==="object"){const{object:n}=this.dataTypeDefinitions;e.valueFormatter===n.groupSafeValueFormatter&&!this.hasObjectValueFormatter&&t("Formatter"),e.editable&&e.valueParser===n.valueParser&&!this.hasObjectValueParser&&t("Parser")}}getFormatValue(e){return this.formatValueFuncs[e]}isColPendingInference(e){return this.isPendingInference&&!!this.columnStateUpdatesPendingInference[e]}setColDefPropertiesForBaseDataType(e,t,n,i){const r=this.formatValueFuncs[t];switch(n.baseDataType){case"number":{e.cellEditor="agNumberCellEditor";break}case"boolean":{e.cellEditor="agCheckboxCellEditor",e.cellRenderer="agCheckboxCellRenderer",e.getFindText=()=>null,e.suppressKeyboardEvent=s=>!!s.colDef.editable&&s.event.key===K.SPACE;break}case"date":{e.cellEditor="agDateCellEditor",e.keyCreator=r;break}case"dateString":{e.cellEditor="agDateStringCellEditor",e.keyCreator=r;break}case"object":{e.cellEditorParams={useFormatter:!0},e.comparator=(s,o)=>{const a=this.colModel.getColDefCol(i),l=a?.getColDef();if(!a||!l)return 0;const u=s==null?"":r({column:a,node:null,value:s}),c=o==null?"":r({column:a,node:null,value:o});return u===c?0:u>c?1:-1},e.keyCreator=r;break}}this.beans.filterManager?.setColDefPropertiesForDataType(e,n,r)}getDefaultDataTypes(){const e=n=>!!n.match("^\\d{4}-\\d{2}-\\d{2}$"),t=this.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:n=>n.newValue?.trim?.()===""?null:Number(n.newValue),valueFormatter:n=>n.value==null?"":typeof n.value!="number"||isNaN(n.value)?t("invalidNumber","Invalid Number"):String(n.value),dataTypeMatcher:n=>typeof n=="number"},text:{baseDataType:"text",valueParser:n=>n.newValue===""?null:ET(n.newValue),dataTypeMatcher:n=>typeof n=="string"},boolean:{baseDataType:"boolean",valueParser:n=>n.newValue==null?n.newValue:n.newValue?.trim?.()===""?null:String(n.newValue).toLowerCase()==="true",valueFormatter:n=>n.value==null?"":String(n.value),dataTypeMatcher:n=>typeof n=="boolean"},date:{baseDataType:"date",valueParser:n=>Rr(n.newValue==null?null:String(n.newValue)),valueFormatter:n=>n.value==null?"":!(n.value instanceof Date)||isNaN(n.value.getTime())?t("invalidDate","Invalid Date"):Ts(n.value,!1)??"",dataTypeMatcher:n=>n instanceof Date},dateString:{baseDataType:"dateString",dateParser:n=>Rr(n)??void 0,dateFormatter:n=>Ts(n??null,!1)??void 0,valueParser:n=>e(String(n.newValue))?n.newValue:null,valueFormatter:n=>e(String(n.value))?n.value:"",dataTypeMatcher:n=>typeof n=="string"&&e(n)},object:{baseDataType:"object",valueParser:()=>null,valueFormatter:n=>ET(n.value)??""}}}destroyColumnStateUpdateListeners(){this.columnStateUpdateListenerDestroyFuncs.forEach(e=>e()),this.columnStateUpdateListenerDestroyFuncs=[]}destroy(){this.dataTypeDefinitions={},this.dataTypeMatchers={},this.formatValueFuncs={},this.columnStateUpdatesPendingInference={},this.destroyColumnStateUpdateListeners(),super.destroy()}};function gW(e,t){const n={...e,...t};return e.columnTypes&&t.columnTypes&&t.appendColumnTypes&&(n.columnTypes=[...YS(e.columnTypes),...YS(t.columnTypes)]),n}function mW(e,t,n){return t?t.baseDataType!==e.baseDataType?(ue(46),!1):!0:(ue(45,{parentCellDataType:n}),!1)}function vW(e,t){if(e.valueFormatter)return n=>{if(n.node?.group){const i=(n.colDef.pivotValueColumn??n.column).getAggFunc();if(i){if(i==="first"||i==="last")return e.valueFormatter(n);if(e.baseDataType==="number"&&i!=="count"){if(typeof n.value=="number")return e.valueFormatter(n);if(typeof n.value=="object"){if(!n.value)return;if("toNumber"in n.value)return e.valueFormatter({...n,value:n.value.toNumber()});if("value"in n.value)return e.valueFormatter({...n,value:n.value.value})}}return}if(t.get("groupDisplayType")==="groupRows"&&!t.get("treeData"))return}else if(t.get("groupHideOpenParents")&&n.column.isRowGroupActive()&&typeof n.value=="string"&&!e.dataTypeMatcher?.(n.value))return;return e.valueFormatter(n)}}function VXe(e,t,n,i){if(!t[n])return!1;const r=e[n];return r===null?(t[n]=!1,!1):i===void 0?!!r:r===i}function _D(e,t){return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some(([n,i])=>VXe(e,t,n,i))}function WXe(e,t){const n=hne(e);return t.forEach(i=>{delete n[i],i==="rowGroup"?delete n.rowGroupIndex:i==="pivot"&&delete n.pivotIndex}),n}var UXe={moduleName:"DataType",version:Ce,beans:[HXe],dependsOn:[CXe]},jXe={moduleName:"ColumnFlex",version:Ce,beans:[zXe]},qXe={moduleName:"ColumnApi",version:Ce,beans:[GXe],apiFunctions:{getColumnDef:yXe,getDisplayNameForColumn:bXe,getColumn:SXe,getColumns:xXe,applyColumnState:RXe,getColumnState:EXe,resetColumnState:FXe,isPinning:AXe,isPinningLeft:DXe,isPinningRight:PXe,getDisplayedColAfter:kXe,getDisplayedColBefore:TXe,setColumnsVisible:MXe,setColumnsPinned:IXe,getAllGridColumns:_Xe,getDisplayedLeftColumns:OXe,getDisplayedCenterColumns:LXe,getDisplayedRightColumns:NXe,getAllDisplayedColumns:$Xe,getAllDisplayedVirtualColumns:BXe,getColumnDefs:wXe}};function KXe(e){if(!e||e==null)return null;const t=/([a-z])([A-Z])/g,n=/([A-Z]+)([A-Z])([a-z])/g;return e.replace(t,"$1 $2").replace(n,"$1 $2$3").replace(/\./g," ").split(" ").map(r=>r.substring(0,1).toUpperCase()+(r.length>1?r.substring(1,r.length):"")).join(" ")}var YXe=class extends X{constructor(){super(...arguments),this.beanName="colNames"}getDisplayNameForColumn(e,t,n=!1){if(!e)return null;const i=this.getHeaderName(e.getColDef(),e,null,null,t),{aggColNameSvc:r}=this.beans;return n&&r?r.getHeaderName(e,i):i}getDisplayNameForProvidedColumnGroup(e,t,n){const i=t?.getColGroupDef();return i?this.getHeaderName(i,null,e,t,n):null}getDisplayNameForColumnGroup(e,t){return this.getDisplayNameForProvidedColumnGroup(e,e.getProvidedColumnGroup(),t)}getHeaderName(e,t,n,i,r){const s=e.headerValueGetter;if(s){const o=Ne(this.gos,{colDef:e,column:t,columnGroup:n,providedColumnGroup:i,location:r});return typeof s=="function"?s(o):typeof s=="string"?this.beans.expressionSvc?.evaluate(s,o)??null:""}else{if(e.headerName!=null)return e.headerName;if(e.field)return KXe(e.field)}return""}},XXe=class extends X{constructor(){super(...arguments),this.beanName="colViewport",this.colsWithinViewport=[],this.headerColsWithinViewport=[],this.colsWithinViewportHash="",this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={}}wireBeans(e){this.visibleCols=e.visibleCols,this.colModel=e.colModel}postConstruct(){this.suppressColumnVirtualisation=this.gos.get("suppressColumnVirtualisation")}setScrollPosition(e,t,n=!1){const{visibleCols:i}=this,r=i.isBodyWidthDirty;if(!(e===this.scrollWidth&&t===this.scrollPosition&&!r)){if(this.scrollWidth=e,this.scrollPosition=t,i.isBodyWidthDirty=!0,this.gos.get("enableRtl")){const o=i.bodyWidth;this.viewportLeft=o-t-e,this.viewportRight=o-t}else this.viewportLeft=t,this.viewportRight=e+t;this.colModel.ready&&this.checkViewportColumns(n)}}getHeadersToRender(e,t){let n;switch(e){case"left":n=this.rowsOfHeadersToRenderLeft[t];break;case"right":n=this.rowsOfHeadersToRenderRight[t];break;default:n=this.rowsOfHeadersToRenderCenter[t];break}return n||[]}extractViewportColumns(){const e=this.visibleCols.centerCols;this.isColumnVirtualisationSuppressed()?(this.colsWithinViewport=e,this.headerColsWithinViewport=e):(this.colsWithinViewport=e.filter(this.isColumnInRowViewport.bind(this)),this.headerColsWithinViewport=e.filter(this.isColumnInHeaderViewport.bind(this)))}isColumnVirtualisationSuppressed(){return this.suppressColumnVirtualisation||this.viewportRight===0}clear(e){this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},e||(this.colsWithinViewportHash="")}isColumnInHeaderViewport(e){return e.isAutoHeaderHeight()||QXe(e)?!0:this.isColumnInRowViewport(e)}isColumnInRowViewport(e){if(e.isAutoHeight())return!0;const t=e.getLeft()||0,n=t+e.getActualWidth(),i=this.viewportLeft-200,r=this.viewportRight+200,s=t<i&&n<i,o=t>r&&n>r;return!s&&!o}getViewportColumns(){const{leftCols:e,rightCols:t}=this.visibleCols;return this.colsWithinViewport.concat(e).concat(t)}getColsWithinViewport(e){if(!this.colModel.colSpanActive)return this.colsWithinViewport;const t=s=>{const o=s.getLeft();return me(o)&&o>this.viewportLeft},n=this.isColumnVirtualisationSuppressed()?void 0:this.isColumnInRowViewport.bind(this),{visibleCols:i}=this,r=i.centerCols;return i.getColsForRow(e,r,n,t)}checkViewportColumns(e=!1){this.extractViewport()&&this.eventSvc.dispatchEvent({type:"virtualColumnsChanged",afterScroll:e})}calculateHeaderRows(){this.clear(!0);const e={},{leftCols:t,rightCols:n,treeLeft:i,treeRight:r,treeCenter:s}=this.visibleCols;this.headerColsWithinViewport.concat(t).concat(n).forEach(l=>e[l.getId()]=!0);const a=(l,u,c)=>{let d=!1;for(let h=0;h<l.length;h++){const p=l[h];let g=!1;if(lc(p))g=e[p.getId()]===!0;else{const C=p.getDisplayedChildren();C&&(g=a(C,u,c+1))}g&&(d=!0,u[c]||(u[c]=[]),u[c].push(p))}return d};a(i,this.rowsOfHeadersToRenderLeft,0),a(r,this.rowsOfHeadersToRenderRight,0),a(s,this.rowsOfHeadersToRenderCenter,0)}extractViewport(){const e=i=>`${i.getId()}-${i.getPinned()||"normal"}`;this.extractViewportColumns();const t=this.getViewportColumns().map(e).join("#"),n=this.colsWithinViewportHash!==t;return n&&(this.colsWithinViewportHash=t,this.calculateHeaderRows()),n}};function QXe(e){for(;e;){if(e.isAutoHeaderHeight())return!0;e=e.getParent()}return!1}var JXe=class extends X{constructor(){super(...arguments),this.beanName="agCompUtils"}adaptFunction(e,t){if(!e.cellRenderer)return null;class n{refresh(){return!1}getGui(){return this.eGui}init(r){const s=t(r),o=typeof s;if(o==="string"||o==="number"||o==="boolean"){this.eGui=MR("<span>"+s+"</span>");return}if(s==null){this.eGui=Cn({tag:"span"});return}this.eGui=s}}return n}},ZXe={moduleName:"CellRendererFunction",version:Ce,beans:[JXe]},eQe=class extends X{constructor(){super(...arguments),this.beanName="registry",this.agGridDefaults={},this.agGridDefaultParams={},this.jsComps={},this.dynamicBeans={},this.selectors={},this.icons={}}postConstruct(){const e=this.gos.get("components");if(e!=null)for(const t of Object.keys(e))this.jsComps[t]=e[t]}registerModule(e){const{icons:t,userComponents:n,dynamicBeans:i,selectors:r}=e;if(n){const s=(o,a,l)=>{this.agGridDefaults[o]=a,l&&(this.agGridDefaultParams[o]=l)};for(const o of Object.keys(n)){const a=n[o];typeof a=="object"?s(o,a.classImp,a.params):s(o,a)}}if(i)for(const s of Object.keys(i))this.dynamicBeans[s]=i[s];if(r?.forEach(s=>{this.selectors[s.selector]=s}),t)for(const s of Object.keys(t))this.icons[s]=t[s]}getUserComponent(e,t){const n=(a,l,u)=>({componentFromFramework:l,component:a,params:u}),{frameworkOverrides:i}=this.beans,r=i.frameworkComponent(t,this.gos.get("components"));if(r!=null)return n(r,!0);const s=this.jsComps[t];if(s){const a=i.isFrameworkComponent(s);return n(s,a)}const o=this.agGridDefaults[t];return o?n(o,!1,this.agGridDefaultParams[t]):(this.beans.validation?.missingUserComponent(e,t,this.agGridDefaults,this.jsComps),null)}createDynamicBean(e,t,...n){const i=this.dynamicBeans[e];if(i==null){if(t)throw new Error(Hu(256));return}return new i(...n)}getSelector(e){return this.selectors[e]}getIcon(e){return this.icons[e]}},tQe=23,nQe=class extends X{constructor(){super(...arguments),this.beanName="ctrlsSvc",this.params={},this.ready=!1,this.readyCallbacks=[]}postConstruct(){this.addEventListener("ready",()=>{this.updateReady(),this.ready&&(this.readyCallbacks.forEach(e=>e(this.params)),this.readyCallbacks.length=0)},this.beans.frameworkOverrides.runWhenReadyAsync?.()??!1)}updateReady(){const e=Object.values(this.params);this.ready=e.length===tQe&&e.every(t=>t?.isAlive()??!1)}whenReady(e,t){this.ready?t(this.params):this.readyCallbacks.push(t),e.addDestroyFunc(()=>{const n=this.readyCallbacks.indexOf(t);n>=0&&this.readyCallbacks.splice(n,1)})}register(e,t){this.params[e]=t,this.updateReady(),this.ready&&this.dispatchLocalEvent({type:"ready"}),t.addDestroyFunc(()=>{this.updateReady()})}get(e){return this.params[e]}getGridBodyCtrl(){return this.params.gridBodyCtrl}getHeaderRowContainerCtrls(){const{leftHeader:e,centerHeader:t,rightHeader:n}=this.params;return[e,n,t]}getHeaderRowContainerCtrl(e){const t=this.params;switch(e){case"left":return t.leftHeader;case"right":return t.rightHeader;default:return t.centerHeader}}getScrollFeature(){return this.getGridBodyCtrl().scrollFeature}},iQe=':where(.ag-root-wrapper,.ag-popup,.ag-dnd-ghost,.ag-chart),:where(.ag-root-wrapper,.ag-popup,.ag-dnd-ghost,.ag-chart) :where([class^=ag-]){box-sizing:border-box;&:after,&:before{box-sizing:border-box}&:where(div,span,label):focus-visible{box-shadow:inset var(--ag-focus-shadow);outline:none}}:where(.ag-root-wrapper,.ag-popup,.ag-dnd-ghost,.ag-chart) :where([class^=ag-]) ::-ms-clear{display:none}.ag-aria-description-container{border:0;z-index:9999;clip:rect(1px,1px,1px,1px);height:1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px}.ag-hidden{display:none!important}.ag-invisible{visibility:hidden!important}.ag-unselectable{-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-selectable{-webkit-user-select:text;-moz-user-select:text;user-select:text}.ag-tab-guard{display:block;height:0;position:absolute;width:0}:where(.ag-virtual-list-viewport) .ag-tab-guard{position:sticky}.ag-tab-guard-top{top:1px}.ag-tab-guard-bottom{bottom:1px}.ag-shake-left-to-right{animation-direction:alternate;animation-duration:.2s;animation-iteration-count:infinite;animation-name:ag-shake-left-to-right}@keyframes ag-shake-left-to-right{0%{padding-left:6px;padding-right:2px}to{padding-left:2px;padding-right:6px}}.ag-body-horizontal-scroll-viewport,.ag-body-vertical-scroll-viewport,.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport,.ag-virtual-list-viewport{flex:1 1 auto;height:100%;min-width:0;overflow:hidden;position:relative}.ag-viewport{position:relative}.ag-spanning-container{position:absolute;top:0;z-index:1}.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport{overflow-x:auto;-ms-overflow-style:none!important;scrollbar-width:none!important;&::-webkit-scrollbar{display:none!important}}.ag-body-viewport{display:flex;overflow-x:hidden;&:where(.ag-layout-normal){overflow-y:auto;-webkit-overflow-scrolling:touch}}.ag-floating-bottom-container,.ag-floating-top-container,.ag-sticky-bottom-container,.ag-sticky-top-container{min-height:1px}.ag-center-cols-viewport{min-height:100%;width:100%}.ag-body-horizontal-scroll-viewport{overflow-x:scroll}.ag-body-vertical-scroll-viewport{overflow-y:scroll}.ag-virtual-list-viewport{overflow:auto;width:100%}.ag-body-container,.ag-body-horizontal-scroll-container,.ag-body-vertical-scroll-container,.ag-center-cols-container,.ag-floating-bottom-container,.ag-floating-bottom-full-width-container,.ag-floating-top-container,.ag-full-width-container,.ag-header-container,.ag-pinned-left-cols-container,.ag-pinned-right-cols-container,.ag-sticky-bottom-container,.ag-sticky-top-container,.ag-virtual-list-container{position:relative}.ag-floating-bottom-container,.ag-floating-top-container,.ag-header-container,.ag-pinned-left-floating-bottom,.ag-pinned-left-floating-top,.ag-pinned-right-floating-bottom,.ag-pinned-right-floating-top,.ag-sticky-bottom-container,.ag-sticky-top-container{height:100%;white-space:nowrap}.ag-center-cols-container,.ag-pinned-right-cols-container{display:block}.ag-body-horizontal-scroll-container{height:100%}.ag-body-vertical-scroll-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container,.ag-full-width-container,.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{pointer-events:none;position:absolute;top:0}:where(.ag-ltr) .ag-floating-bottom-full-width-container,:where(.ag-ltr) .ag-floating-top-full-width-container,:where(.ag-ltr) .ag-full-width-container,:where(.ag-ltr) .ag-sticky-bottom-full-width-container,:where(.ag-ltr) .ag-sticky-top-full-width-container{left:0}:where(.ag-rtl) .ag-floating-bottom-full-width-container,:where(.ag-rtl) .ag-floating-top-full-width-container,:where(.ag-rtl) .ag-full-width-container,:where(.ag-rtl) .ag-sticky-bottom-full-width-container,:where(.ag-rtl) .ag-sticky-top-full-width-container{right:0}.ag-full-width-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container{display:inline-block;height:100%;overflow:hidden;width:100%}.ag-virtual-list-container{overflow:hidden}.ag-body{display:flex;flex:1 1 auto;flex-direction:row!important;min-height:0;position:relative}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:flex;min-height:0;min-width:0;position:relative;&:where(.ag-scrollbar-invisible){bottom:0;position:absolute;&:where(.ag-apple-scrollbar){opacity:0;transition:opacity .4s;visibility:hidden;&:where(.ag-scrollbar-scrolling,.ag-scrollbar-active){opacity:1;visibility:visible}}}}.ag-body-horizontal-scroll{width:100%;&:where(.ag-scrollbar-invisible){left:0;right:0}}.ag-body-vertical-scroll{height:100%;&:where(.ag-scrollbar-invisible){top:0;z-index:10}}:where(.ag-ltr) .ag-body-vertical-scroll{&:where(.ag-scrollbar-invisible){right:0}}:where(.ag-rtl) .ag-body-vertical-scroll{&:where(.ag-scrollbar-invisible){left:0}}.ag-force-vertical-scroll{overflow-y:scroll!important}.ag-horizontal-left-spacer,.ag-horizontal-right-spacer{height:100%;min-width:0;overflow-x:scroll;&:where(.ag-scroller-corner){overflow-x:hidden}}:where(.ag-row-animation) .ag-row{transition:transform .4s,top .4s,opacity .2s;&:where(.ag-after-created){transition:transform .4s,top .4s,height .4s,opacity .2s}}:where(.ag-row-no-animation) .ag-row{transition:none}.ag-row-loading{align-items:center;display:flex}.ag-row-position-absolute{position:absolute}.ag-row-position-relative{position:relative}.ag-full-width-row{overflow:hidden;pointer-events:all}.ag-row-inline-editing{z-index:1}.ag-row-dragging{z-index:2}.ag-stub-cell{align-items:center;display:flex}.ag-cell{display:inline-block;height:100%;position:absolute;white-space:nowrap;&:focus-visible{box-shadow:none}}.ag-cell-value{flex:1 1 auto}.ag-cell-value,.ag-group-value{overflow:hidden;text-overflow:ellipsis}.ag-cell-wrap-text{white-space:normal;word-break:break-word}:where(.ag-cell) .ag-icon{display:inline-block;vertical-align:middle}.ag-floating-top{border-bottom:var(--ag-pinned-row-border)}.ag-floating-bottom,.ag-floating-top{display:flex;overflow:hidden;position:relative;white-space:nowrap;width:100%}.ag-floating-bottom{border-top:var(--ag-pinned-row-border)}.ag-sticky-bottom,.ag-sticky-top{background-color:var(--ag-background-color);display:flex;height:0;overflow:hidden;position:absolute;width:100%;z-index:1}.ag-opacity-zero{opacity:0!important}.ag-cell-label-container{align-items:center;display:flex;flex-direction:row-reverse;height:100%;justify-content:space-between;width:100%}:where(.ag-right-aligned-header){.ag-cell-label-container{flex-direction:row}.ag-header-cell-text{text-align:end}}.ag-column-group-icons{display:block;>*{cursor:pointer}}:where(.ag-ltr){direction:ltr;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row}}:where(.ag-rtl){direction:rtl;text-align:right;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row-reverse}.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{display:block}}:where(.ag-rtl){.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(180deg)}}:where(.ag-rtl){.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(-180deg)}}.ag-measurement-container{height:0;overflow:hidden;visibility:hidden;width:0}.ag-measurement-element-border{display:inline-block;&:before{border-left:var(--ag-internal-measurement-border);content:"";display:block}}.ag-group{position:relative;width:100%}.ag-group-title-bar{align-items:center;display:flex;padding:var(--ag-spacing)}.ag-group-title{display:inline;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:where(.ag-group-title-bar) .ag-group-title{cursor:default}.ag-group-toolbar{align-items:center;display:flex;padding:var(--ag-spacing)}.ag-group-container{display:flex}.ag-disabled .ag-group-container{pointer-events:none}.ag-disabled-group-container,.ag-disabled-group-title-bar{opacity:.5}.ag-group-container-horizontal{flex-flow:row wrap}.ag-group-container-vertical{flex-direction:column}.ag-group-title-bar-icon{cursor:pointer;flex:none}:where(.ag-ltr) .ag-group-title-bar-icon{margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-group-title-bar-icon{margin-left:var(--ag-spacing)}:where(.ag-group-item-alignment-stretch) .ag-group-item{align-items:stretch}:where(.ag-group-item-alignment-start) .ag-group-item{align-items:flex-start}:where(.ag-group-item-alignment-end) .ag-group-item{align-items:flex-end}.ag-popup-child{top:0;z-index:5;&:where(:not(.ag-tooltip-custom)){box-shadow:var(--ag-popup-shadow)}}.ag-popup-editor{position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-large-text-input{display:block}:where(.ag-ltr) .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-left:var(--ag-row-group-indent-size)}:where(.ag-rtl) .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-right:var(--ag-row-group-indent-size)}:where(.ag-ltr) .ag-row-group-leaf-indent{margin-left:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}:where(.ag-rtl) .ag-row-group-leaf-indent{margin-right:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}.ag-value-change-delta{padding:0 2px}.ag-value-change-delta-up{color:var(--ag-value-change-delta-up-color)}.ag-value-change-delta-down{color:var(--ag-value-change-delta-down-color)}.ag-value-change-value{background-color:transparent;border-radius:1px;padding-left:1px;padding-right:1px;transition:background-color 1s}.ag-value-change-value-highlight{background-color:var(--ag-value-change-value-highlight-background-color);transition:background-color .1s}.ag-cell-data-changed{background-color:var(--ag-value-change-value-highlight-background-color)!important}.ag-cell-data-changed-animation{background-color:transparent}.ag-cell-highlight{background-color:var(--ag-range-selection-highlight-color)!important}.ag-row,.ag-spanned-row{color:var(--ag-cell-text-color);font-family:var(--ag-cell-font-family);font-size:var(--ag-data-font-size);white-space:nowrap;--ag-internal-content-line-height:calc(min(var(--ag-row-height), var(--ag-line-height, 1000px)) - var(--ag-internal-row-border-width, 1px) - 2px)}.ag-row{background-color:var(--ag-background-color);border-bottom:var(--ag-row-border);height:var(--ag-row-height);width:100%}:where(.ag-body-vertical-content-no-gap>div>div>div,.ag-body-vertical-content-no-gap>div>div>div>div)>.ag-row-last{border-bottom-color:transparent}.ag-sticky-bottom{border-top:var(--ag-row-border);box-sizing:content-box!important}.ag-group-contracted,.ag-group-expanded{cursor:pointer}.ag-cell,.ag-full-width-row .ag-cell-wrapper.ag-row-group{border:1px solid transparent;line-height:var(--ag-internal-content-line-height);-webkit-font-smoothing:subpixel-antialiased}:where(.ag-ltr) .ag-cell{border-right:var(--ag-column-border)}:where(.ag-rtl) .ag-cell{border-left:var(--ag-column-border)}.ag-spanned-cell-wrapper{background-color:var(--ag-background-color);position:absolute}.ag-spanned-cell-wrapper>.ag-spanned-cell{display:block;position:relative}:where(.ag-ltr) :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-right-color:transparent}:where(.ag-rtl) :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-left-color:transparent}.ag-cell-wrapper{align-items:center;display:flex;>:where(:not(.ag-cell-value,.ag-group-value)){align-items:center;display:flex;height:var(--ag-internal-content-line-height)}&:where(.ag-row-group){align-items:flex-start}:where(.ag-full-width-row) &:where(.ag-row-group){align-items:center;height:100%}}:where(.ag-ltr) .ag-cell-wrapper{padding-left:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}:where(.ag-rtl) .ag-cell-wrapper{padding-right:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}:where(.ag-cell-wrap-text:not(.ag-cell-auto-height)) .ag-cell-wrapper{align-items:normal;height:100%;:where(.ag-cell-value){height:100%}}:where(.ag-ltr) .ag-row>.ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}:where(.ag-rtl) .ag-row>.ag-cell-wrapper.ag-row-group{padding-right:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-cell-focus:not(.ag-cell-range-selected):focus-within,.ag-cell-range-single-cell,.ag-cell-range-single-cell.ag-cell-range-handle,.ag-context-menu-open .ag-cell-focus:not(.ag-cell-range-selected),.ag-context-menu-open .ag-full-width-row.ag-row-focus .ag-cell-wrapper.ag-row-group,.ag-full-width-row.ag-row-focus:focus .ag-cell-wrapper.ag-row-group{border:1px solid;border-color:var(--ag-range-selection-border-color);border-style:var(--ag-range-selection-border-style);outline:initial}.ag-full-width-row.ag-row-focus:focus{box-shadow:none}:where(.ag-ltr) .ag-group-contracted,:where(.ag-ltr) .ag-group-expanded,:where(.ag-ltr) .ag-row-drag,:where(.ag-ltr) .ag-selection-checkbox{margin-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-group-contracted,:where(.ag-rtl) .ag-group-expanded,:where(.ag-rtl) .ag-row-drag,:where(.ag-rtl) .ag-selection-checkbox{margin-left:var(--ag-cell-widget-spacing)}:where(.ag-ltr) .ag-group-child-count{margin-left:3px}:where(.ag-rtl) .ag-group-child-count{margin-right:3px}.ag-row-highlight-above:after,.ag-row-highlight-below:after{background-color:var(--ag-range-selection-border-color);content:"";height:1px;position:absolute;width:calc(100% - 1px)}:where(.ag-ltr) .ag-row-highlight-above:after,:where(.ag-ltr) .ag-row-highlight-below:after{left:1px}:where(.ag-rtl) .ag-row-highlight-above:after,:where(.ag-rtl) .ag-row-highlight-below:after{right:1px}.ag-row-highlight-above:after{top:0}.ag-row-highlight-below:after{bottom:0}.ag-row-odd{background-color:var(--ag-odd-row-background-color)}.ag-row-selected:before{background-color:var(--ag-selected-row-background-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-full-width-row.ag-row-group:before,.ag-row-hover:not(.ag-full-width-row):before{background-color:var(--ag-row-hover-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-row-selected:before{background-color:var(--ag-row-hover-color);background-image:linear-gradient(var(--ag-selected-row-background-color),var(--ag-selected-row-background-color))}.ag-row.ag-full-width-row.ag-row-group>*{position:relative}.ag-column-hover{background-color:var(--ag-column-hover-color)}.ag-header-range-highlight{background-color:var(--ag-range-header-highlight-color)}.ag-right-aligned-cell{font-variant-numeric:tabular-nums}:where(.ag-ltr) .ag-right-aligned-cell{text-align:right}:where(.ag-rtl) .ag-right-aligned-cell{text-align:left}.ag-right-aligned-cell .ag-cell-value,.ag-right-aligned-cell .ag-group-value{margin-left:auto}:where(.ag-ltr) .ag-cell:not(.ag-cell-inline-editing),:where(.ag-ltr) .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level));padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}:where(.ag-rtl) .ag-cell:not(.ag-cell-inline-editing),:where(.ag-rtl) .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-row>.ag-cell-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}.ag-row-dragging{cursor:move;opacity:.5}.ag-details-row{background-color:var(--ag-background-color);padding:calc(var(--ag-spacing)*3.75)}.ag-layout-auto-height,.ag-layout-print{.ag-center-cols-container,.ag-center-cols-viewport{min-height:150px}}.ag-overlay-loading-wrapper{background-color:var(--ag-modal-overlay-background-color)}.ag-skeleton-container{align-content:center;height:100%;width:100%}.ag-skeleton-effect{animation:ag-skeleton-loading 1.5s ease-in-out .5s infinite;background-color:var(--ag-row-loading-skeleton-effect-color);border-radius:.25rem;height:1em;width:100%}:where(.ag-ltr) .ag-right-aligned-cell .ag-skeleton-effect{margin-left:auto}:where(.ag-rtl) .ag-right-aligned-cell .ag-skeleton-effect{margin-right:auto}@keyframes ag-skeleton-loading{0%{opacity:1}50%{opacity:.4}to{opacity:1}}.ag-loading{align-items:center;display:flex;height:100%}:where(.ag-ltr) .ag-loading{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-loading{padding-right:var(--ag-cell-horizontal-padding)}:where(.ag-ltr) .ag-loading-icon{padding-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-loading-icon{padding-left:var(--ag-cell-widget-spacing)}.ag-icon-loading{animation-duration:1s;animation-iteration-count:infinite;animation-name:spin;animation-timing-function:linear}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.ag-input-wrapper,.ag-picker-field-wrapper{align-items:center;display:flex;flex:1 1 auto;line-height:normal;position:relative}.ag-input-field{align-items:center;display:flex;flex-direction:row}.ag-input-field-input:where(:not([type=checkbox],[type=radio])){flex:1 1 auto;min-width:0;width:100%}.ag-header{background-color:var(--ag-header-background-color);border-bottom:var(--ag-header-row-border);color:var(--ag-header-text-color);display:flex;font-family:var(--ag-header-font-family);font-size:var(--ag-header-font-size);font-weight:var(--ag-header-font-weight);overflow:hidden;white-space:nowrap;width:100%}.ag-header-row{height:var(--ag-header-height);position:absolute}.ag-floating-filter-button-button,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,:where(.ag-header-cell-sortable) .ag-header-cell-label{cursor:pointer}:where(.ag-ltr) .ag-header-expand-icon{margin-left:4px}:where(.ag-rtl) .ag-header-expand-icon{margin-right:4px}.ag-header-row:where(:not(:first-child)){:where(.ag-header-cell:not(.ag-header-span-height.ag-header-span-total,.ag-header-parent-hidden),.ag-header-group-cell.ag-header-group-cell-with-group){border-top:var(--ag-header-row-border)}}.ag-header-row:where(:not(.ag-header-row-column-group)){overflow:hidden}:where(.ag-header.ag-header-allow-overflow) .ag-header-row{overflow:visible}.ag-header-cell{display:inline-flex;overflow:hidden}.ag-header-group-cell{contain:paint;display:flex}.ag-header-cell,.ag-header-group-cell{align-items:center;gap:var(--ag-cell-widget-spacing);height:100%;padding:0 var(--ag-cell-horizontal-padding);position:absolute}@property --ag-internal-moving-color{syntax:"<color>";inherits:false;initial-value:transparent}@property --ag-internal-hover-color{syntax:"<color>";inherits:false;initial-value:transparent}.ag-header-cell:where(:not(.ag-floating-filter)),.ag-header-group-cell{&:before{background-image:linear-gradient(var(--ag-internal-hover-color),var(--ag-internal-hover-color)),linear-gradient(var(--ag-internal-moving-color),var(--ag-internal-moving-color));content:"";inset:0;position:absolute;--ag-internal-moving-color:transparent;--ag-internal-hover-color:transparent;transition:--ag-internal-moving-color var(--ag-header-cell-background-transition-duration),--ag-internal-hover-color var(--ag-header-cell-background-transition-duration)}&:where(:hover):before{--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}&:where(.ag-header-cell-moving):before{--ag-internal-moving-color:var(--ag-header-cell-moving-background-color);--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}}:where(.ag-header-cell:not(.ag-floating-filter) *,.ag-header-group-cell *){position:relative;z-index:1}.ag-header-cell-menu-button:where(:not(.ag-header-menu-always-show)){opacity:0;transition:opacity .2s}.ag-header-cell-filter-button,:where(.ag-header-cell.ag-header-active) .ag-header-cell-menu-button{opacity:1}.ag-header-cell-label,.ag-header-group-cell-label{align-items:center;align-self:stretch;display:flex;flex:1 1 auto;overflow:hidden;padding:5px 0}:where(.ag-ltr) .ag-sort-indicator-icon{padding-left:var(--ag-spacing)}:where(.ag-rtl) .ag-sort-indicator-icon{padding-right:var(--ag-spacing)}.ag-header-cell-label{text-overflow:ellipsis}.ag-header-group-cell-label.ag-sticky-label{flex:none;max-width:100%;overflow:visible;position:sticky}:where(.ag-ltr) .ag-header-group-cell-label.ag-sticky-label{left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-header-group-cell-label.ag-sticky-label{right:var(--ag-cell-horizontal-padding)}.ag-header-cell-text,.ag-header-group-text{overflow:hidden;text-overflow:ellipsis}.ag-header-cell-text{word-break:break-word}.ag-header-cell-comp-wrapper{width:100%}:where(.ag-header-group-cell) .ag-header-cell-comp-wrapper{display:flex}:where(.ag-header-cell:not(.ag-header-cell-auto-height)) .ag-header-cell-comp-wrapper{align-items:center;display:flex;height:100%}.ag-header-cell-wrap-text .ag-header-cell-comp-wrapper{white-space:normal}.ag-header-cell-comp-wrapper-limited-height>*{overflow:hidden}:where(.ag-right-aligned-header) .ag-header-cell-label{flex-direction:row-reverse}:where(.ag-ltr) :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}:where(.ag-ltr) :where(.ag-header-cell.ag-right-aligned-header){.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-header-cell.ag-right-aligned-header){.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}.ag-header-cell:after,.ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{content:"";height:var(--ag-header-column-border-height);position:absolute;top:calc(50% - var(--ag-header-column-border-height)*.5);z-index:1}:where(.ag-ltr) .ag-header-cell:after,:where(.ag-ltr) .ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{border-right:var(--ag-header-column-border);right:0}:where(.ag-rtl) .ag-header-cell:after,:where(.ag-rtl) .ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{border-left:var(--ag-header-column-border);left:0}.ag-header-highlight-after:after,.ag-header-highlight-before:after{background-color:var(--ag-accent-color);content:"";height:100%;position:absolute;width:1px}:where(.ag-ltr) .ag-header-highlight-before:after{left:0}:where(.ag-rtl) .ag-header-highlight-before:after{right:0}:where(.ag-ltr) .ag-header-highlight-after:after{right:0;:where(.ag-pinned-left-header) &{right:1px}}:where(.ag-rtl) .ag-header-highlight-after:after{left:0;:where(.ag-pinned-left-header) &{left:1px}}.ag-header-cell-resize{align-items:center;cursor:ew-resize;display:flex;height:100%;position:absolute;top:0;width:8px;z-index:2;&:after{background-color:var(--ag-header-column-resize-handle-color);content:"";height:var(--ag-header-column-resize-handle-height);position:absolute;top:calc(50% - var(--ag-header-column-resize-handle-height)*.5);width:var(--ag-header-column-resize-handle-width);z-index:1}}:where(.ag-ltr) .ag-header-cell-resize{right:-3px;&:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}}:where(.ag-rtl) .ag-header-cell-resize{left:-3px;&:after{right:calc(50% - var(--ag-header-column-resize-handle-width))}}:where(.ag-header-cell.ag-header-span-height) .ag-header-cell-resize:after{height:calc(100% - var(--ag-spacing)*4);top:calc(var(--ag-spacing)*2)}.ag-header-group-cell-no-group:where(.ag-header-span-height){display:none}.ag-sort-indicator-container{display:flex;gap:var(--ag-spacing)}.ag-layout-print{&.ag-body{display:block;height:unset}&.ag-root-wrapper{display:inline-block}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:none}&.ag-force-vertical-scroll{overflow-y:visible!important}}@media print{.ag-root-wrapper.ag-layout-print{display:table;.ag-body-horizontal-scroll-viewport,.ag-body-viewport,.ag-center-cols-container,.ag-center-cols-viewport,.ag-root,.ag-root-wrapper-body,.ag-virtual-list-viewport{display:block!important;height:auto!important;overflow:hidden!important}.ag-cell,.ag-row{-moz-column-break-inside:avoid;break-inside:avoid}}}ag-grid,ag-grid-angular{display:block}.ag-chart,.ag-dnd-ghost,.ag-popup,.ag-root-wrapper{cursor:default;line-height:normal;white-space:normal;-webkit-font-smoothing:antialiased;background-color:var(--ag-background-color);color:var(--ag-text-color);color-scheme:var(--ag-browser-color-scheme);font-family:var(--ag-font-family);font-size:var(--ag-font-size);--ag-indentation-level:0}.ag-root-wrapper{border:var(--ag-wrapper-border);border-radius:var(--ag-wrapper-border-radius);display:flex;flex-direction:column;overflow:hidden;position:relative;&.ag-layout-normal{height:100%}}.ag-root-wrapper-body{display:flex;flex-direction:row;&.ag-layout-normal{flex:1 1 auto;height:0;min-height:0}}.ag-root{display:flex;flex-direction:column;position:relative;&.ag-layout-auto-height,&.ag-layout-normal{flex:1 1 auto;overflow:hidden;width:0}&.ag-layout-normal{height:100%}}.ag-drag-handle{color:var(--ag-drag-handle-color);cursor:grab}.ag-list-item,.ag-virtual-list-item{height:var(--ag-list-item-height)}.ag-virtual-list-item{position:absolute;width:100%}.ag-select-list{background-color:var(--ag-picker-list-background-color);border:var(--ag-picker-list-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);overflow:hidden auto}.ag-list-item{align-items:center;display:flex;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;&.ag-active-item{background-color:var(--ag-row-hover-color)}}.ag-select-list-item{cursor:default;-webkit-user-select:none;-moz-user-select:none;user-select:none;:where(span){overflow:hidden;text-overflow:ellipsis;white-space:nowrap}}:where(.ag-ltr) .ag-select-list-item{padding-left:calc(var(--ag-cell-horizontal-padding)/2)}:where(.ag-rtl) .ag-select-list-item{padding-right:calc(var(--ag-cell-horizontal-padding)/2)}.ag-list-item-hovered:after{background-color:var(--ag-accent-color);content:"";height:1px;left:0;position:absolute;right:0}.ag-item-highlight-top:after{top:0}.ag-item-highlight-bottom:after{bottom:0}:where(.ag-icon):before{align-items:center;background-color:currentcolor;color:inherit;content:"";display:flex;font-family:inherit;font-size:var(--ag-icon-size);font-style:normal;font-variant:normal;height:var(--ag-icon-size);justify-content:center;line-height:var(--ag-icon-size);-webkit-mask-size:contain;mask-size:contain;text-transform:none;width:var(--ag-icon-size)}.ag-icon{background-position:50%;background-repeat:no-repeat;background-size:contain;color:var(--ag-icon-color);display:block;height:var(--ag-icon-size);position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:var(--ag-icon-size)}.ag-column-select-column-group-readonly,.ag-column-select-column-readonly,.ag-disabled,[disabled]{.ag-icon{opacity:.5}&.ag-icon-grip{opacity:.35}}.ag-column-select-column-readonly{&.ag-icon-grip,.ag-icon-grip{opacity:.35}}.ag-chart-menu-icon,.ag-chart-settings-next,.ag-chart-settings-prev,.ag-column-group-icons,.ag-column-select-header-icon,.ag-filter-toolpanel-expand,.ag-floating-filter-button-button,.ag-group-title-bar-icon,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,.ag-panel-title-bar-button-icon,.ag-set-filter-group-icons,:where(.ag-group-contracted) .ag-icon,:where(.ag-group-expanded) .ag-icon{background-color:var(--ag-icon-button-background-color);border-radius:var(--ag-icon-button-border-radius);box-shadow:0 0 0 var(--ag-icon-button-background-spread) var(--ag-icon-button-background-color);color:var(--ag-icon-button-color);&:hover{background-color:var(--ag-icon-button-hover-background-color);box-shadow:0 0 0 var(--ag-icon-button-background-spread) var(--ag-icon-button-hover-background-color);color:var(--ag-icon-button-hover-color)}}.ag-filter-active{background-image:linear-gradient(var(--ag-icon-button-active-background-color),var(--ag-icon-button-active-background-color));border-radius:1px;outline:solid var(--ag-icon-button-background-spread) var(--ag-icon-button-active-background-color);position:relative;&:after{background-color:var(--ag-accent-color);border-radius:50%;content:"";height:6px;position:absolute;top:-1px;width:6px}:where(.ag-icon-filter){clip-path:path("M8,0C8,4.415 11.585,8 16,8L16,16L0,16L0,0L8,0Z");color:var(--ag-icon-button-active-color)}}:where(.ag-ltr) .ag-filter-active{&:after{right:-1px}}:where(.ag-rtl) .ag-filter-active{&:after{left:-1px}}.ag-menu{background-color:var(--ag-menu-background-color);border:var(--ag-menu-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-menu-shadow);color:var(--ag-menu-text-color);max-height:100%;overflow-y:auto}.ag-menu,.ag-resizer{position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-resizer{pointer-events:none;z-index:1}:where(.ag-resizer){&.ag-resizer-topLeft{cursor:nwse-resize;height:5px;left:0;top:0;width:5px}&.ag-resizer-top{cursor:ns-resize;height:5px;left:5px;right:5px;top:0}&.ag-resizer-topRight{cursor:nesw-resize;height:5px;right:0;top:0;width:5px}&.ag-resizer-right{bottom:5px;cursor:ew-resize;right:0;top:5px;width:5px}&.ag-resizer-bottomRight{bottom:0;cursor:nwse-resize;height:5px;right:0;width:5px}&.ag-resizer-bottom{bottom:0;cursor:ns-resize;height:5px;left:5px;right:5px}&.ag-resizer-bottomLeft{bottom:0;cursor:nesw-resize;height:5px;left:0;width:5px}&.ag-resizer-left{bottom:5px;cursor:ew-resize;left:0;top:5px;width:5px}}',IN=typeof window!="object"||!window?.document?.fonts?.forEach,BT=new WeakMap,Pp=(e,t,n,i,r,s)=>{if(IN)return;i&&(e=`@layer ${CSS.escape(i)} { ${e} }`);let o=BT.get(t);if(o||(o=[],BT.set(t,o)),o.find(c=>c.css===e))return;const a=document.createElement("style");s&&a.setAttribute("nonce",s),a.dataset.agGlobalCss=n,a.textContent=e;const l={css:e,el:a,priority:r};let u;for(const c of o){if(c.priority>r)break;u=c}if(u){u.el.insertAdjacentElement("afterend",a);const c=o.indexOf(u);o.splice(c+1,0,l)}else t.insertBefore(a,t.querySelector(":not(title, meta)")),o.push(l)},sie=(e,t,n)=>{Pp(iQe,e,"core",t,0,n),Array.from(fje()).sort((i,r)=>i.moduleName.localeCompare(r.moduleName)).forEach(i=>i.css?.forEach(r=>Pp(r,e,`module-${i.moduleName}`,t,0,n)))},GT=new Set,rQe=e=>{GT.add(e)},sQe=e=>{if(GT.delete(e),GT.size===0){BT=new WeakMap;for(const t of document.head.querySelectorAll("style[data-ag-global-css]"))t.remove()}},Hl=e=>new oie(e),Su="$default",oQe=0,oie=class{constructor({feature:e,params:t,modeParams:n={},css:i,cssImports:r}){this.feature=e,this.css=i,this.cssImports=r,this.modeParams={[Su]:{...n[Su]??{},...t??{}},...n}}use(e,t,n){let i=this._inject;if(i==null){let{css:r}=this;if(r){const s=`ag-theme-${this.feature??"part"}-${++oQe}`;typeof r=="function"&&(r=r()),r=`:where(.${s}) {
${r}
}
`;for(const o of this.cssImports??[])r=`@import url(${JSON.stringify(o)});
${r}`;i={css:r,class:s}}else i=!1;this._inject=i}return i&&e&&Pp(i.css,e,i.class,t,1,n),i?i.class:!1}},aQe=e=>e.replace(/[A-Z]/g,t=>`-${t}`).toLowerCase(),aie=e=>`--ag-${aQe(e)}`,Fa=e=>`var(${aie(e)})`,lQe=(e,t,n)=>Math.max(t,Math.min(n,e)),uQe=e=>{const t=new Map;return n=>{const i=n;return t.has(i)||t.set(i,e(n)),t.get(i)}},Jo=e=>({ref:"accentColor",mix:e}),vs=e=>({ref:"foregroundColor",mix:e}),po=e=>({ref:"foregroundColor",mix:e,onto:"backgroundColor"}),cQe=e=>({ref:"foregroundColor",mix:e,onto:"headerBackgroundColor"}),jr={ref:"backgroundColor"},pm={ref:"foregroundColor"},Ru={ref:"accentColor"},s1={backgroundColor:"#fff",foregroundColor:"#181d1f",borderColor:vs(.15),chromeBackgroundColor:po(.02),browserColorScheme:"light"},dQe={...s1,textColor:pm,accentColor:"#2196f3",invalidColor:"#e02525",wrapperBorder:!0,rowBorder:!0,headerRowBorder:!0,footerRowBorder:{ref:"rowBorder"},columnBorder:{style:"solid",width:1,color:"transparent"},headerColumnBorder:!1,headerColumnBorderHeight:"100%",pinnedColumnBorder:!0,pinnedRowBorder:!0,sidePanelBorder:!0,sideBarPanelWidth:250,sideBarBackgroundColor:{ref:"chromeBackgroundColor"},sideButtonBarBackgroundColor:{ref:"sideBarBackgroundColor"},sideButtonBarTopPadding:0,sideButtonSelectedUnderlineWidth:2,sideButtonSelectedUnderlineColor:"transparent",sideButtonSelectedUnderlineTransitionDuration:0,sideButtonBackgroundColor:"transparent",sideButtonTextColor:{ref:"textColor"},sideButtonHoverBackgroundColor:{ref:"sideButtonBackgroundColor"},sideButtonHoverTextColor:{ref:"sideButtonTextColor"},sideButtonSelectedBackgroundColor:jr,sideButtonSelectedTextColor:{ref:"sideButtonTextColor"},sideButtonBorder:"solid 1px transparent",sideButtonSelectedBorder:!0,sideButtonLeftPadding:{ref:"spacing"},sideButtonRightPadding:{ref:"spacing"},sideButtonVerticalPadding:{calc:"spacing * 3"},fontFamily:["-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu","Cantarell","Helvetica Neue","sans-serif"],headerBackgroundColor:{ref:"chromeBackgroundColor"},headerFontFamily:{ref:"fontFamily"},cellFontFamily:{ref:"fontFamily"},headerFontWeight:500,headerFontSize:{ref:"fontSize"},dataFontSize:{ref:"fontSize"},headerTextColor:{ref:"textColor"},headerCellHoverBackgroundColor:"transparent",headerCellMovingBackgroundColor:{ref:"headerCellHoverBackgroundColor"},headerCellBackgroundTransitionDuration:"0.2s",cellTextColor:{ref:"textColor"},subtleTextColor:{ref:"textColor",mix:.5},rangeSelectionBorderStyle:"solid",rangeSelectionBorderColor:Ru,rangeSelectionBackgroundColor:Jo(.2),rangeSelectionChartBackgroundColor:"#0058FF1A",rangeSelectionChartCategoryBackgroundColor:"#00FF841A",rangeSelectionHighlightColor:Jo(.5),rangeHeaderHighlightColor:cQe(.08),rowNumbersSelectedColor:Jo(.5),rowHoverColor:Jo(.08),columnHoverColor:Jo(.05),selectedRowBackgroundColor:Jo(.12),modalOverlayBackgroundColor:{ref:"backgroundColor",mix:.66},oddRowBackgroundColor:jr,borderRadius:4,wrapperBorderRadius:8,cellHorizontalPadding:{calc:"spacing * 2 * cellHorizontalPaddingScale"},cellWidgetSpacing:{calc:"spacing * 1.5"},cellHorizontalPaddingScale:1,rowGroupIndentSize:{calc:"cellWidgetSpacing + iconSize"},valueChangeDeltaUpColor:"#43a047",valueChangeDeltaDownColor:"#e53935",valueChangeValueHighlightBackgroundColor:"#16a08580",spacing:8,fontSize:14,rowHeight:{calc:"max(iconSize, dataFontSize) + spacing * 3.25 * rowVerticalPaddingScale"},rowVerticalPaddingScale:1,headerHeight:{calc:"max(iconSize, dataFontSize) + spacing * 4 * headerVerticalPaddingScale"},headerVerticalPaddingScale:1,popupShadow:"0 0 16px #00000026",cardShadow:"0 1px 4px 1px #00000018",dropdownShadow:{ref:"cardShadow"},dragAndDropImageBackgroundColor:jr,dragAndDropImageBorder:!0,dragAndDropImageShadow:{ref:"popupShadow"},dragHandleColor:vs(.7),focusShadow:{spread:3,color:Jo(.5)},headerColumnResizeHandleHeight:"30%",headerColumnResizeHandleWidth:2,headerColumnResizeHandleColor:{ref:"borderColor"},widgetContainerHorizontalPadding:{calc:"spacing * 1.5"},widgetContainerVerticalPadding:{calc:"spacing * 1.5"},widgetHorizontalSpacing:{calc:"spacing * 1.5"},widgetVerticalSpacing:{ref:"spacing"},listItemHeight:{calc:"max(iconSize, dataFontSize) + widgetVerticalSpacing"},iconSize:16,iconColor:"inherit",iconButtonColor:{ref:"iconColor"},iconButtonBackgroundColor:"transparent",iconButtonBackgroundSpread:4,iconButtonBorderRadius:1,iconButtonHoverColor:{ref:"iconButtonColor"},iconButtonHoverBackgroundColor:vs(.1),iconButtonActiveColor:Ru,iconButtonActiveBackgroundColor:Jo(.28),iconButtonActiveIndicatorColor:Ru,toggleButtonWidth:28,toggleButtonHeight:18,toggleButtonOnBackgroundColor:Ru,toggleButtonOffBackgroundColor:po(.3),toggleButtonSwitchBackgroundColor:jr,toggleButtonSwitchInset:2,menuBorder:{color:vs(.2)},menuBackgroundColor:po(.03),menuTextColor:po(.95),menuShadow:{ref:"popupShadow"},menuSeparatorColor:{ref:"borderColor"},setFilterIndentSize:{ref:"iconSize"},chartMenuPanelWidth:260,chartMenuLabelColor:vs(.8),dialogShadow:{ref:"popupShadow"},cellEditingBorder:{color:Ru},cellEditingShadow:{ref:"cardShadow"},dialogBorder:{color:vs(.2)},panelBackgroundColor:jr,panelTitleBarBackgroundColor:{ref:"headerBackgroundColor"},panelTitleBarIconColor:{ref:"headerTextColor"},panelTitleBarTextColor:{ref:"headerTextColor"},panelTitleBarFontWeight:{ref:"headerFontWeight"},panelTitleBarBorder:!0,columnSelectIndentSize:{ref:"iconSize"},toolPanelSeparatorBorder:!0,tooltipBackgroundColor:{ref:"chromeBackgroundColor"},tooltipTextColor:{ref:"textColor"},tooltipBorder:!0,columnDropCellBackgroundColor:vs(.07),columnDropCellTextColor:{ref:"textColor"},columnDropCellDragHandleColor:{ref:"textColor"},columnDropCellBorder:{color:vs(.13)},selectCellBackgroundColor:vs(.07),selectCellBorder:{color:vs(.13)},advancedFilterBuilderButtonBarBorder:!0,advancedFilterBuilderIndentSize:{calc:"spacing * 2 + iconSize"},advancedFilterBuilderJoinPillColor:"#f08e8d",advancedFilterBuilderColumnPillColor:"#a6e194",advancedFilterBuilderOptionPillColor:"#f3c08b",advancedFilterBuilderValuePillColor:"#85c0e4",findMatchColor:pm,findMatchBackgroundColor:"#ffff00",findActiveMatchColor:pm,findActiveMatchBackgroundColor:"#ffa500",filterToolPanelGroupIndent:{ref:"spacing"},rowLoadingSkeletonEffectColor:vs(.15),statusBarLabelColor:pm,statusBarLabelFontWeight:500,statusBarValueColor:pm,statusBarValueFontWeight:500},hQe=":where(.ag-button){background:none;border:none;color:inherit;cursor:pointer;font-family:inherit;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0;text-indent:inherit;text-shadow:inherit;text-transform:inherit;word-spacing:inherit;&:disabled{cursor:default}&:focus-visible{box-shadow:var(--ag-focus-shadow);outline:none}}.ag-standard-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:var(--ag-button-background-color);border:var(--ag-button-border);border-radius:var(--ag-button-border-radius);color:var(--ag-button-text-color);cursor:pointer;font-weight:var(--ag-button-font-weight);padding:var(--ag-button-vertical-padding) var(--ag-button-horizontal-padding);&:hover{background-color:var(--ag-button-hover-background-color);border:var(--ag-button-hover-border);color:var(--ag-button-hover-text-color)}&:active{background-color:var(--ag-button-active-background-color);border:var(--ag-button-active-border);color:var(--ag-button-active-text-color)}&:disabled{background-color:var(--ag-button-disabled-background-color);border:var(--ag-button-disabled-border);color:var(--ag-button-disabled-text-color)}}",fQe={buttonTextColor:"inherit",buttonFontWeight:"normal",buttonBackgroundColor:"transparent",buttonBorder:!1,buttonBorderRadius:{ref:"borderRadius"},buttonHorizontalPadding:{calc:"spacing * 2"},buttonVerticalPadding:{ref:"spacing"},buttonHoverTextColor:{ref:"buttonTextColor"},buttonHoverBackgroundColor:{ref:"buttonBackgroundColor"},buttonHoverBorder:{ref:"buttonBorder"},buttonActiveTextColor:{ref:"buttonHoverTextColor"},buttonActiveBackgroundColor:{ref:"buttonHoverBackgroundColor"},buttonActiveBorder:{ref:"buttonHoverBorder"},buttonDisabledTextColor:{ref:"inputDisabledTextColor"},buttonDisabledBackgroundColor:{ref:"inputDisabledBackgroundColor"},buttonDisabledBorder:{ref:"inputDisabledBorder"}},pQe=()=>Hl({feature:"buttonStyle",params:{...fQe,buttonBackgroundColor:jr,buttonBorder:!0,buttonHoverBackgroundColor:{ref:"rowHoverColor"},buttonActiveBorder:{color:Ru}},css:hQe}),gQe=pQe(),mQe=".ag-column-drop-vertical-empty-message{align-items:center;border:1px dashed;border-color:var(--ag-border-color);display:flex;inset:0;justify-content:center;margin:calc(var(--ag-spacing)*1.5) calc(var(--ag-spacing)*2);overflow:hidden;padding:calc(var(--ag-spacing)*2);position:absolute}",vQe=()=>Hl({feature:"columnDropStyle",css:mQe}),lie=vQe(),CQe=["colorScheme","color","length","scale","borderStyle","border","shadow","image","fontFamily","fontWeight","duration"],yQe=uQe(e=>(e=e.toLowerCase(),CQe.find(t=>e.endsWith(t.toLowerCase()))??"length")),LR=e=>typeof e=="object"&&e?.ref?Fa(e.ref):typeof e=="string"?e:typeof e=="number"?String(e):!1,_N=e=>{if(typeof e=="string")return e;if(e&&"ref"in e){const t=Fa(e.ref);return e.mix==null?t:`color-mix(in srgb, ${e.onto?Fa(e.onto):"transparent"}, ${t} ${lQe(e.mix*100,0,100)}%)`}return!1},wQe=LR,yf=e=>typeof e=="string"?e:typeof e=="number"?`${e}px`:e&&"calc"in e?`calc(${e.calc.replace(/ ?[*/+] ?/g," $& ").replace(/-?\b[a-z][a-z0-9]*\b(?![-(])/gi,n=>n[0]==="-"?n:` ${Fa(n)} `)})`:e&&"ref"in e?Fa(e.ref):!1,bQe=LR,SQe=(e,t)=>typeof e=="string"?e:e===!0?"solid 1px var(--ag-border-color)":e===!1?t==="columnBorder"?"solid 1px transparent":"none":e&&"ref"in e?Fa(e.ref):uie(e.style??"solid")+" "+yf(e.width??1)+" "+_N(e.color??{ref:"borderColor"}),xQe=e=>typeof e=="string"?e:e===!1?"none":e&&"ref"in e?Fa(e.ref):[yf(e.offsetX??0),yf(e.offsetY??0),yf(e.radius??0),yf(e.spread??0),_N(e.color??{ref:"foregroundColor"})].join(" "),uie=LR,cie=e=>typeof e=="string"?e.includes(",")?e:CW(e):e&&"googleFont"in e?cie(e.googleFont):e&&"ref"in e?Fa(e.ref):Array.isArray(e)?e.map(t=>(typeof t=="object"&&"googleFont"in t&&(t=t.googleFont),CW(t))).join(", "):!1,CW=e=>/^[\w-]+$|\w\(/.test(e)?e:JSON.stringify(e),RQe=LR,die=e=>typeof e=="string"?e:e&&"url"in e?`url(${JSON.stringify(e.url)})`:e&&"svg"in e?die({url:`data:image/svg+xml,${encodeURIComponent(e.svg)}`}):e&&"ref"in e?Fa(e.ref):!1,EQe=(e,t)=>typeof e=="string"?e:typeof e=="number"?(e>=10&&wt(104,{value:e,param:t}),`${e}s`):e&&"ref"in e?Fa(e.ref):!1,FQe={color:_N,colorScheme:wQe,length:yf,scale:bQe,border:SQe,borderStyle:uie,shadow:xQe,image:die,fontFamily:cie,fontWeight:RQe,duration:EQe},AQe=(e,t)=>{const n=yQe(e);return FQe[n](t,e)},DQe=()=>new hie().withPart(gQe).withPart(lie),hie=class fie{constructor(t=[]){this.parts=t}withPart(t){return typeof t=="function"&&(t=t()),t instanceof oie?new fie([...this.parts,t]):(DT(259,{part:t},"Invalid part"),this)}withoutPart(t){return this.withPart(Hl({feature:t}))}withParams(t,n=Su){return this.withPart(Hl({modeParams:{[n]:t}}))}_startUse({styleContainer:t,cssLayer:n,nonce:i,loadThemeGoogleFonts:r}){if(IN)return;kQe(),sie(t,n,i);const s=PQe(this);if(s.length>0)for(const o of s)r&&MQe(o,i);for(const o of this.parts)o.use(t,n,i)}_getCssClass(){return this._cssClassCache??(this._cssClassCache=yW(this.parts).map(t=>t.use(void 0,void 0,void 0)).filter(Boolean).join(" "))}_getModeParams(){let t=this._paramsCache;if(!t){const n={[Su]:{...dQe}};for(const i of yW(this.parts))for(const r of Object.keys(i.modeParams)){const s=i.modeParams[r];if(s){const o=n[r]??(n[r]={}),a=new Set;for(const l of Object.keys(s)){const u=s[l];u!==void 0&&(o[l]=u,a.add(l))}if(r===Su)for(const l of Object.keys(n)){const u=n[l];if(l!==Su)for(const c of a)delete u[c]}}}this._paramsCache=t=n}return t}_getPerGridCss(t){const n="##SELECTOR##";let i=this._paramsCssCache;if(!i){let r="",s="";const o=this._getModeParams();for(const l of Object.keys(o)){const u=o[l];if(l!==Su){const d=`:where([data-ag-theme-mode="${typeof CSS=="object"?CSS.escape(l):l}"]) & {
`;r+=d,s+=d}for(const c of Object.keys(u).sort()){const d=u[c],h=AQe(c,d);if(h===!1)wt(107,{key:c,value:d});else{const p=aie(c),g=p.replace("--ag-","--ag-inherited-");r+=`	${p}: var(${g}, ${h});
`,s+=`	${g}: var(${p});
`}}l!==Su&&(r+=`}
`,s+=`}
`)}let a=`${n} {
${r}}
`;a+=`:has(> ${n}):not(${n}) {
${s}}
`,this._paramsCssCache=i=a}return i.replaceAll(n,`:where(.${t})`)}},yW=e=>{const t=new Map;for(const i of e)t.set(i.feature,i);const n=[];for(const i of e)(!i.feature||t.get(i.feature)===i)&&n.push(i);return n},PQe=e=>{const t=new Set,n=s=>{if(Array.isArray(s))s.forEach(n);else{const o=s?.googleFont;typeof o=="string"&&t.add(o)}};return Object.values(e._getModeParams()).flatMap(s=>Object.values(s)).forEach(n),Array.from(t).sort()},wW=!1,kQe=()=>{if(!wW){wW=!0;for(const e of Array.from(document.head.querySelectorAll('style[data-ag-scope="legacy"]')))e.remove()}},TQe=new Set,MQe=async(e,t)=>{TQe.add(e);const n=`@import url('https://${IQe}/css2?family=${encodeURIComponent(e)}:wght@100;200;300;400;500;600;700;800;900&display=swap');
`;Pp(n,document.head,`googleFont:${e}`,void 0,0,t)},IQe="fonts.googleapis.com",_Qe='.ag-checkbox-input-wrapper,.ag-radio-button-input-wrapper{background-color:var(--ag-checkbox-unchecked-background-color);border:solid var(--ag-checkbox-border-width) var(--ag-checkbox-unchecked-border-color);flex:none;height:var(--ag-icon-size);position:relative;width:var(--ag-icon-size);:where(input){-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:block;height:var(--ag-icon-size);margin:0;opacity:0;width:var(--ag-icon-size)}&:after{content:"";display:block;inset:0;-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;pointer-events:none;position:absolute}&:where(.ag-checked){background-color:var(--ag-checkbox-checked-background-color);border-color:var(--ag-checkbox-checked-border-color);&:after{background-color:var(--ag-checkbox-checked-shape-color)}}&:where(:focus-within,:active){box-shadow:var(--ag-focus-shadow)}&:where(.ag-disabled){filter:grayscale();opacity:.5}}.ag-checkbox-input-wrapper{border-radius:var(--ag-checkbox-border-radius);&:where(.ag-checked):after{-webkit-mask-image:var(--ag-checkbox-checked-shape-image);mask-image:var(--ag-checkbox-checked-shape-image)}&:where(.ag-indeterminate){background-color:var(--ag-checkbox-indeterminate-background-color);border-color:var(--ag-checkbox-indeterminate-border-color);&:after{background-color:var(--ag-checkbox-indeterminate-shape-color);-webkit-mask-image:var(--ag-checkbox-indeterminate-shape-image);mask-image:var(--ag-checkbox-indeterminate-shape-image)}}}.ag-radio-button-input-wrapper{border-radius:100%;&:where(.ag-checked):after{-webkit-mask-image:var(--ag-radio-checked-shape-image);mask-image:var(--ag-radio-checked-shape-image)}}',OQe=()=>Hl({feature:"checkboxStyle",params:{checkboxBorderWidth:1,checkboxBorderRadius:{ref:"borderRadius"},checkboxUncheckedBackgroundColor:jr,checkboxUncheckedBorderColor:po(.3),checkboxCheckedBackgroundColor:Ru,checkboxCheckedBorderColor:{ref:"checkboxCheckedBackgroundColor"},checkboxCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="7" fill="none"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.75" d="M1 3.5 3.5 6l5-5"/></svg>'},checkboxCheckedShapeColor:jr,checkboxIndeterminateBackgroundColor:po(.3),checkboxIndeterminateBorderColor:{ref:"checkboxIndeterminateBackgroundColor"},checkboxIndeterminateShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="2" fill="none"><rect width="10" height="2" fill="#000" rx="1"/></svg>'},checkboxIndeterminateShapeColor:jr,radioCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="6" height="6" fill="none"><circle cx="3" cy="3" r="3" fill="#000"/></svg>'}},css:_Qe}),LQe=OQe(),pie=()=>({...s1,backgroundColor:"hsl(217, 0%, 17%)",foregroundColor:"#FFF",chromeBackgroundColor:po(.05),rowHoverColor:Jo(.15),selectedRowBackgroundColor:Jo(.2),menuBackgroundColor:po(.1),browserColorScheme:"dark",popupShadow:"0 0px 20px #000A",cardShadow:"0 1px 4px 1px #000A",advancedFilterBuilderJoinPillColor:"#7a3a37",advancedFilterBuilderColumnPillColor:"#355f2d",advancedFilterBuilderOptionPillColor:"#5a3168",advancedFilterBuilderValuePillColor:"#374c86",findMatchColor:jr,findActiveMatchColor:jr,checkboxUncheckedBorderColor:po(.4),toggleButtonOffBackgroundColor:po(.4)}),NQe=()=>({...pie(),backgroundColor:"#1f2836"}),$Qe=()=>Hl({feature:"colorScheme",params:s1,modeParams:{light:s1,dark:pie(),"dark-blue":NQe()}}),BQe=$Qe(),gie={aggregation:'<path d="M18 7V4H6l6 8-6 8h12v-3"/>',arrows:'<polyline points="5 9 2 12 5 15"/><polyline points="9 5 12 2 15 5"/><polyline points="15 19 12 22 9 19"/><polyline points="19 9 22 12 19 15"/><line x1="2" x2="22" y1="12" y2="12"/><line x1="12" x2="12" y1="2" y2="22"/>',asc:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>',cancel:'<path d="m18 6-12 12"/><path d="m6 6 12 12"/>',chart:'<line x1="18" x2="18" y1="20" y2="10"/><line x1="12" x2="12" y1="20" y2="4"/><line x1="6" x2="6" y1="20" y2="14"/>',"color-picker":'<path d="m19 11-8-8-8.6 8.6a2 2 0 0 0 0 2.8l5.2 5.2c.8.8 2 .8 2.8 0L19 11Z"/><path d="m5 2 5 5"/><path d="M2 13h15"/><path d="M22 20a2 2 0 1 1-4 0c0-1.6 1.7-2.4 2-4 .3 1.6 2 2.4 2 4Z"/>',columns:'<path d="M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18"/>',contracted:'<path d="m9 18 6-6-6-6"/>',copy:'<rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/>',cross:'<path d="M18 6 6 18"/><path d="m6 6 12 12"/>',csv:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',cut:'<circle cx="6" cy="6" r="3"/><path d="M8.12 8.12 12 12"/><path d="M20 4 8.12 15.88"/><circle cx="6" cy="18" r="3"/><path d="M14.8 14.8 20 20"/>',desc:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',down:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',excel:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',expanded:'<path d="m15 18-6-6 6-6"/>',"eye-slash":'<path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"/><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"/><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"/><line x1="2" x2="22" y1="2" y2="22"/>',eye:'<path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/>',filter:'<path d="M3 6h18"/><path d="M7 12h10"/><path d="M10 18h4"/>',first:'<path d="m17 18-6-6 6-6"/><path d="M7 6v12"/>',group:'<path d="M16 12H3"/><path d="M16 18H3"/><path d="M10 6H3"/><path d="M21 18V8a2 2 0 0 0-2-2h-5"/><path d="m16 8-2-2 2-2"/>',last:'<path d="m7 18 6-6-6-6"/><path d="M17 6v12"/>',left:'<path d="m12 19-7-7 7-7"/><path d="M19 12H5"/>',linked:'<path d="M9 17H7A5 5 0 0 1 7 7h2"/><path d="M15 7h2a5 5 0 1 1 0 10h-2"/><line x1="8" x2="16" y1="12" y2="12"/>',loading:'<line x1="12" x2="12" y1="2" y2="6"/><line x1="12" x2="12" y1="18" y2="22"/><line x1="4.93" x2="7.76" y1="4.93" y2="7.76"/><line x1="16.24" x2="19.07" y1="16.24" y2="19.07"/><line x1="2" x2="6" y1="12" y2="12"/><line x1="18" x2="22" y1="12" y2="12"/><line x1="4.93" x2="7.76" y1="19.07" y2="16.24"/><line x1="16.24" x2="19.07" y1="7.76" y2="4.93"/>',maximize:'<polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" x2="14" y1="3" y2="10"/><line x1="3" x2="10" y1="21" y2="14"/>',menu:'<line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/>',"menu-alt":'<circle cx="12" cy="5" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="12" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="19" r="0.75" fill="#D9D9D9"/>',minimize:'<polyline points="4 14 10 14 10 20"/><polyline points="20 10 14 10 14 4"/><line x1="14" x2="21" y1="10" y2="3"/><line x1="3" x2="10" y1="21" y2="14"/>',minus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/>',next:'<path d="m9 18 6-6-6-6"/>',none:'<path d="m7 15 5 5 5-5"/><path d="m7 9 5-5 5 5"/>',"not-allowed":'<circle cx="12" cy="12" r="10"/><path d="m4.9 4.9 14.2 14.2"/>',paste:'<path d="M15 2H9a1 1 0 0 0-1 1v2c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V3c0-.6-.4-1-1-1Z"/><path d="M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2M16 4h2a2 2 0 0 1 2 2v2M11 14h10"/><path d="m17 10 4 4-4 4"/>',pin:'<line x1="12" x2="12" y1="17" y2="22"/><path d="M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z"/>',pivot:'<path d="M15 3v18"/><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M21 9H3"/><path d="M21 15H3"/>',plus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/><path d="M12 8v8"/>',previous:'<path d="m15 18-6-6 6-6"/>',right:'<path d="M5 12h14"/><path d="m12 5 7 7-7 7"/>',save:'<path d="M12 17V3"/><path d="m6 11 6 6 6-6"/><path d="M19 21H5"/>',"small-left":'<path d="m15 18-6-6 6-6"/>',"small-right":'<path d="m9 18 6-6-6-6"/>',tick:'<path d="M20 6 9 17l-5-5"/>',"tree-closed":'<path d="m9 18 6-6-6-6"/>',"tree-indeterminate":'<path d="M5 12h14"/>',"tree-open":'<path d="m6 9 6 6 6-6"/>',unlinked:'<path d="M9 17H7A5 5 0 0 1 7 7"/><path d="M15 7h2a5 5 0 0 1 4 8"/><line x1="8" x2="12" y1="12" y2="12"/><line x1="2" x2="22" y1="2" y2="22"/>',up:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>',grip:'<circle cx="5" cy="8" r="0.5"/><circle cx="12" cy="8" r="0.5"/><circle cx="19" cy="8" r="0.5"/><circle cx="5" cy="16" r="0.5"/><circle cx="12" cy="16" r="0.5"/><circle cx="19" cy="16" r="0.5"/><g stroke="none" fill="currentColor"><circle cx="5" cy="8" r="1"/><circle cx="12" cy="8" r="1"/><circle cx="19" cy="8" r="1"/><circle cx="5" cy="16" r="1"/><circle cx="12" cy="16" r="1"/><circle cx="19" cy="16" r="1"/></g>',settings:'<path d="M20 7h-9"/><path d="M14 17H5"/><circle cx="17" cy="17" r="3"/><circle cx="7" cy="7" r="3"/>'},mie={"small-down":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="black" stroke="none" viewBox="0 0 32 32"><path d="M7.334 10.667 16 21.334l8.667-10.667H7.334Z"/></svg>',"small-up":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="black" stroke="none" viewBox="0 0 32 32"><path d="M7.334 21.333 16 10.666l8.667 10.667H7.334Z"/></svg>'},GQe=(e={})=>{let t="";for(const n of[...Object.keys(gie),...Object.keys(mie)]){const i=zQe(n,e.strokeWidth);t+=`.ag-icon-${n}::before { mask-image: url('data:image/svg+xml,${encodeURIComponent(i)}'); }
`}return t},zQe=(e,t=1.5)=>{const n=mie[e];if(n)return n;const i=gie[e];if(!i)throw new Error(`Missing icon data for ${e}`);return`<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="black" stroke-width="${t}" viewBox="0 0 24 24"><style>* { vector-effect: non-scaling-stroke; }</style>`+i+"</svg>"},HQe=(e={})=>Hl({feature:"iconSet",css:()=>GQe(e)}),VQe=HQe(),WQe=':where(.ag-input-field-input[type=number]:not(.ag-number-field-input-stepper)){-webkit-appearance:textfield;-moz-appearance:textfield;appearance:textfield;&::-webkit-inner-spin-button,&::-webkit-outer-spin-button{-webkit-appearance:none;appearance:none;margin:0}}:where(input.ag-input-field-input:not([type]),input.ag-input-field-input[type=text],input.ag-input-field-input[type=number],input.ag-input-field-input[type=tel],input.ag-input-field-input[type=date],input.ag-input-field-input[type=datetime-local],textarea.ag-input-field-input){background-color:var(--ag-input-background-color);border:var(--ag-input-border);border-radius:var(--ag-input-border-radius);color:var(--ag-input-text-color);font-family:inherit;font-size:inherit;line-height:inherit;margin:0;min-height:var(--ag-input-height);padding:0;&:where(:disabled){background-color:var(--ag-input-disabled-background-color);border:var(--ag-input-disabled-border);color:var(--ag-input-disabled-text-color)}&:where(:focus){background-color:var(--ag-input-focus-background-color);border:var(--ag-input-focus-border);box-shadow:var(--ag-input-focus-shadow);color:var(--ag-input-focus-text-color);outline:none}&:where(:invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&:where(.invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&::-moz-placeholder{color:var(--ag-input-placeholder-text-color)}&::placeholder{color:var(--ag-input-placeholder-text-color)}}:where(.ag-ltr) :where(input.ag-input-field-input:not([type]),input.ag-input-field-input[type=text],input.ag-input-field-input[type=number],input.ag-input-field-input[type=tel],input.ag-input-field-input[type=date],input.ag-input-field-input[type=datetime-local],textarea.ag-input-field-input){padding-left:var(--ag-input-padding-start)}:where(.ag-rtl) :where(input.ag-input-field-input:not([type]),input.ag-input-field-input[type=text],input.ag-input-field-input[type=number],input.ag-input-field-input[type=tel],input.ag-input-field-input[type=date],input.ag-input-field-input[type=datetime-local],textarea.ag-input-field-input){padding-right:var(--ag-input-padding-start)}:where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter){.ag-input-wrapper:before{background-color:currentcolor;color:var(--ag-input-icon-color);content:"";display:block;height:12px;-webkit-mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;opacity:.5;position:absolute;width:12px}}:where(.ag-ltr) :where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter){.ag-input-wrapper:before{margin-left:var(--ag-spacing)}.ag-number-field-input,.ag-text-field-input{padding-left:calc(var(--ag-spacing)*1.5 + 12px)}}:where(.ag-rtl) :where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter){.ag-input-wrapper:before{margin-right:var(--ag-spacing)}.ag-number-field-input,.ag-text-field-input{padding-right:calc(var(--ag-spacing)*1.5 + 12px)}}',UQe=":where(input.ag-input-field-input:not([type]),input.ag-input-field-input[type=text],input.ag-input-field-input[type=number],input.ag-input-field-input[type=tel],input.ag-input-field-input[type=date],input.ag-input-field-input[type=datetime-local],textarea.ag-input-field-input){&:focus{box-shadow:var(--ag-focus-shadow)}}",jQe={inputBackgroundColor:"transparent",inputBorder:!1,inputBorderRadius:0,inputTextColor:{ref:"textColor"},inputPlaceholderTextColor:{ref:"inputTextColor",mix:.5},inputPaddingStart:0,inputHeight:{calc:"max(iconSize, fontSize) + spacing * 2"},inputFocusBackgroundColor:{ref:"inputBackgroundColor"},inputFocusBorder:{ref:"inputBorder"},inputFocusShadow:"none",inputFocusTextColor:{ref:"inputTextColor"},inputDisabledBackgroundColor:{ref:"inputBackgroundColor"},inputDisabledBorder:{ref:"inputBorder"},inputDisabledTextColor:{ref:"inputTextColor"},inputInvalidBackgroundColor:{ref:"inputBackgroundColor"},inputInvalidBorder:{ref:"inputBorder"},inputInvalidTextColor:{ref:"inputTextColor"},inputIconColor:{ref:"inputTextColor"},pickerButtonBorder:!1,pickerButtonFocusBorder:{ref:"inputFocusBorder"},pickerButtonBackgroundColor:{ref:"backgroundColor"},pickerButtonFocusBackgroundColor:{ref:"backgroundColor"},pickerListBorder:!1,pickerListBackgroundColor:{ref:"backgroundColor"}},qQe=()=>Hl({feature:"inputStyle",params:{...jQe,inputBackgroundColor:jr,inputBorder:!0,inputBorderRadius:{ref:"borderRadius"},inputPaddingStart:{ref:"spacing"},inputFocusBorder:{color:Ru},inputFocusShadow:{ref:"focusShadow"},inputDisabledBackgroundColor:po(.06),inputDisabledTextColor:{ref:"textColor",mix:.5},inputInvalidBorder:{color:{ref:"invalidColor"}},pickerButtonBorder:!0,pickerListBorder:!0},css:()=>WQe+UQe}),KQe=qQe(),YQe='.ag-tabs-header{background-color:var(--ag-tab-bar-background-color);border-bottom:var(--ag-tab-bar-border);display:flex;flex:1;gap:var(--ag-tab-spacing);padding:var(--ag-tab-bar-top-padding) var(--ag-tab-bar-horizontal-padding) 0}.ag-tabs-header-wrapper{display:flex}.ag-tabs-close-button-wrapper{align-items:center;border:0;display:flex;padding:var(--ag-spacing)}:where(.ag-ltr) .ag-tabs-close-button-wrapper{border-right:1px solid var(--ag-border-color)}:where(.ag-rtl) .ag-tabs-close-button-wrapper{border-left:1px solid var(--ag-border-color)}.ag-tabs-close-button{background-color:unset;border:0;cursor:pointer;padding:0}.ag-tab{align-items:center;background-color:var(--ag-tab-background-color);border-left:var(--ag-tab-selected-border-width) solid transparent;border-right:var(--ag-tab-selected-border-width) solid transparent;color:var(--ag-tab-text-color);cursor:pointer;display:flex;flex:1;justify-content:center;padding:var(--ag-tab-top-padding) var(--ag-tab-horizontal-padding) var(--ag-tab-bottom-padding);position:relative;&:hover{background-color:var(--ag-tab-hover-background-color);color:var(--ag-tab-hover-text-color)}&.ag-tab-selected{background-color:var(--ag-tab-selected-background-color);color:var(--ag-tab-selected-text-color)}&:after{background-color:var(--ag-tab-selected-underline-color);bottom:0;content:"";display:block;height:var(--ag-tab-selected-underline-width);left:0;opacity:0;position:absolute;right:0;transition:opacity var(--ag-tab-selected-underline-transition-duration)}&.ag-tab-selected:after{opacity:1}}:where(.ag-ltr) .ag-tab{&.ag-tab-selected{&:where(:not(:first-of-type)){border-left-color:var(--ag-tab-selected-border-color)}&:where(:not(:last-of-type)){border-right-color:var(--ag-tab-selected-border-color)}}}:where(.ag-rtl) .ag-tab{&.ag-tab-selected{&:where(:not(:first-of-type)){border-right-color:var(--ag-tab-selected-border-color)}&:where(:not(:last-of-type)){border-left-color:var(--ag-tab-selected-border-color)}}}',XQe={tabBarBackgroundColor:"transparent",tabBarHorizontalPadding:0,tabBarTopPadding:0,tabBackgroundColor:"transparent",tabTextColor:{ref:"textColor"},tabHorizontalPadding:{ref:"spacing"},tabTopPadding:{ref:"spacing"},tabBottomPadding:{ref:"spacing"},tabSpacing:"0",tabHoverBackgroundColor:{ref:"tabBackgroundColor"},tabHoverTextColor:{ref:"tabTextColor"},tabSelectedBackgroundColor:{ref:"tabBackgroundColor"},tabSelectedTextColor:{ref:"tabTextColor"},tabSelectedBorderWidth:1,tabSelectedBorderColor:"transparent",tabSelectedUnderlineColor:"transparent",tabSelectedUnderlineWidth:0,tabSelectedUnderlineTransitionDuration:0,tabBarBorder:!1},QQe=()=>Hl({feature:"tabStyle",params:{...XQe,tabBarBorder:!0,tabBarBackgroundColor:vs(.05),tabTextColor:{ref:"textColor",mix:.7},tabSelectedTextColor:{ref:"textColor"},tabHoverTextColor:{ref:"textColor"},tabSelectedBorderColor:{ref:"borderColor"},tabSelectedBackgroundColor:jr},css:YQe}),JQe=QQe(),ZQe=()=>DQe().withPart(LQe).withPart(BQe).withPart(VQe).withPart(JQe).withPart(KQe).withPart(lie).withParams({fontFamily:[{googleFont:"IBM Plex Sans"},"-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu"]}),eJe=ZQe(),tJe={cssName:"--ag-cell-horizontal-padding",changeKey:"cellHorizontalPaddingChanged",defaultValue:16},nJe={cssName:"--ag-indentation-level",changeKey:"indentationLevelChanged",defaultValue:0,noWarn:!0,cacheDefault:!0},iJe={cssName:"--ag-row-group-indent-size",changeKey:"rowGroupIndentSizeChanged",defaultValue:0},bW={cssName:"--ag-row-height",changeKey:"rowHeightChanged",defaultValue:42},SW={cssName:"--ag-header-height",changeKey:"headerHeightChanged",defaultValue:48},xW={cssName:"--ag-list-item-height",changeKey:"listItemHeightChanged",defaultValue:24},OD={cssName:"--ag-row-border",changeKey:"rowBorderWidthChanged",defaultValue:1,border:!0},rJe=0,sJe=class extends X{constructor(){super(...arguments),this.beanName="environment",this.sizeEls=new Map,this.lastKnownValues=new Map,this.sizesMeasured=!1,this.paramsClass=`ag-theme-params-${++rJe}`,this.globalCSS=[]}wireBeans(e){const{eGridDiv:t,gridOptions:n}=e;this.eGridDiv=t,this.eStyleContainer=n.themeStyleContainer??(t.getRootNode()===document?document.head:t),this.cssLayer=n.themeCssLayer,this.styleNonce=n.styleNonce}postConstruct(){this.addManagedPropertyListener("theme",()=>this.handleThemeGridOptionChange()),this.handleThemeGridOptionChange(),this.addManagedPropertyListener("rowHeight",()=>this.refreshRowHeightVariable()),this.getSizeEl(bW),this.getSizeEl(SW),this.getSizeEl(xW),this.getSizeEl(OD),this.refreshRowBorderWidthVariable(),this.addDestroyFunc(()=>sQe(this)),this.mutationObserver=new MutationObserver(()=>{this.fireGridStylesChangedEvent("themeChanged")}),this.addDestroyFunc(()=>this.mutationObserver.disconnect())}getDefaultRowHeight(){return this.getCSSVariablePixelValue(bW)}getDefaultHeaderHeight(){return this.getCSSVariablePixelValue(SW)}getDefaultCellHorizontalPadding(){return this.getCSSVariablePixelValue(tJe)}getDefaultIndentation(){return this.getCSSVariablePixelValue(nJe)}getDefaultRowGroupIndentSize(){return this.getCSSVariablePixelValue(iJe)}getCellPaddingLeft(){const e=this.getDefaultCellHorizontalPadding(),t=this.getDefaultIndentation(),n=this.getDefaultRowGroupIndentSize();return e-1+n*t}getCellPaddingRight(){return this.getDefaultCellHorizontalPadding()-1}getCellPadding(){return this.getCellPaddingLeft()+this.getCellPaddingRight()}getDefaultColumnMinWidth(){return Math.min(36,this.getDefaultRowHeight())}getDefaultListItemHeight(){return this.getCSSVariablePixelValue(xW)}getRowBorderWidth(){return this.getCSSVariablePixelValue(OD)}applyThemeClasses(e){const{gridTheme:t}=this;let n="";if(t)n=`${this.paramsClass} ${t._getCssClass()}`;else{this.mutationObserver.disconnect();let i=this.eGridDiv;for(;i;){let r=!1;for(const s of Array.from(i.classList))s.startsWith("ag-theme-")&&(r=!0,n=n?`${n} ${s}`:s);r&&this.mutationObserver.observe(i,{attributes:!0,attributeFilter:["class"]}),i=i.parentElement}}for(const i of Array.from(e.classList))i.startsWith("ag-theme-")&&e.classList.remove(i);if(n){const i=e.className;e.className=i+(i?" ":"")+n}}refreshRowHeightVariable(){const{eGridDiv:e}=this,t=e.style.getPropertyValue("--ag-line-height").trim(),n=this.gos.get("rowHeight");if(n==null||isNaN(n)||!isFinite(n))return t!==null&&e.style.setProperty("--ag-line-height",null),-1;const i=`${n}px`;return t!=i?(e.style.setProperty("--ag-line-height",i),n):t!=""?parseFloat(t):-1}addGlobalCSS(e,t){this.gridTheme?Pp(e,this.eStyleContainer,t,this.cssLayer,0,this.styleNonce):this.globalCSS.push([e,t])}getCSSVariablePixelValue(e){const t=this.lastKnownValues.get(e);if(t!=null)return t;const n=this.measureSizeEl(e);return n==="detached"||n==="no-styles"?(e.cacheDefault&&this.lastKnownValues.set(e,e.defaultValue),e.defaultValue):(this.lastKnownValues.set(e,n),n)}measureSizeEl(e){const t=this.getSizeEl(e);if(t.offsetParent==null)return"detached";const n=t.offsetWidth;return n===LD?"no-styles":(this.sizesMeasured=!0,n)}getMeasurementContainer(){let e=this.eMeasurementContainer;return e||(e=this.eMeasurementContainer=Cn({tag:"div",cls:"ag-measurement-container"}),this.eGridDiv.appendChild(e)),e}getSizeEl(e){let t=this.sizeEls.get(e);if(t)return t;const n=this.getMeasurementContainer();t=Cn({tag:"div"});const{border:i,noWarn:r}=e;i?(t.className="ag-measurement-element-border",t.style.setProperty("--ag-internal-measurement-border",`var(${e.cssName}, solid ${LD}px)`)):t.style.width=`var(${e.cssName}, ${LD}px)`,n.appendChild(t),this.sizeEls.set(e,t);let s=this.measureSizeEl(e);s==="no-styles"&&!r&&ue(9,{variable:e});const o=Pc(this.beans,t,()=>{const a=this.measureSizeEl(e);a==="detached"||a==="no-styles"||(this.lastKnownValues.set(e,a),a!==s&&(s=a,this.fireGridStylesChangedEvent(e.changeKey)))});return this.addDestroyFunc(()=>o()),t}fireGridStylesChangedEvent(e){e==="rowBorderWidthChanged"&&this.refreshRowBorderWidthVariable(),this.eventSvc.dispatchEvent({type:"gridStylesChanged",[e]:!0})}refreshRowBorderWidthVariable(){const e=this.getCSSVariablePixelValue(OD);this.eGridDiv.style.setProperty("--ag-internal-row-border-width",`${e}px`)}handleThemeGridOptionChange(){const{gos:e,eGridDiv:t,globalCSS:n,gridTheme:i}=this,r=e.get("theme");let s;if(r==="legacy")s=void 0;else{const o=r??eJe;o instanceof hie?s=o:wt(240,{theme:o})}if(s!==i){if(s){rQe(this),sie(this.eStyleContainer,this.cssLayer,this.styleNonce);for(const[a,l]of n)Pp(a,this.eStyleContainer,l,this.cssLayer,0,this.styleNonce);n.length=0}this.gridTheme=s,s?._startUse({loadThemeGoogleFonts:e.get("loadThemeGoogleFonts"),styleContainer:this.eStyleContainer,cssLayer:this.cssLayer,nonce:this.styleNonce});let o=this.eParamsStyle;if(!o){o=this.eParamsStyle=Cn({tag:"style"});const a=this.gos.get("styleNonce");a&&o.setAttribute("nonce",a),t.appendChild(o)}IN||(o.textContent=s?._getPerGridCss(this.paramsClass)||""),this.applyThemeClasses(t),this.fireGridStylesChangedEvent("themeChanged")}s&&getComputedStyle(this.getMeasurementContainer()).getPropertyValue("--ag-legacy-styles-loaded")&&wt(r?106:239)}},LD=15538,oJe=class extends X{constructor(){super(...arguments),this.beanName="eventSvc",this.globalEventService=new Jd}postConstruct(){const{globalListener:e,globalSyncListener:t}=this.beans;e&&this.addGlobalListener(e,!0),t&&this.addGlobalListener(t,!1)}addEventListener(e,t,n){this.globalEventService.addEventListener(e,t,n)}removeEventListener(e,t,n){this.globalEventService.removeEventListener(e,t,n)}addGlobalListener(e,t=!1){this.globalEventService.addGlobalListener(e,t)}removeGlobalListener(e,t=!1){this.globalEventService.removeGlobalListener(e,t)}dispatchLocalEvent(){}dispatchEvent(e){this.globalEventService.dispatchEvent(Ne(this.gos,e))}dispatchEventOnce(e){this.globalEventService.dispatchEventOnce(Ne(this.gos,e))}};function vie(e){return e?e.getLeafColumns().some(t=>t.isSpanHeaderHeight()):!1}function zT(e,t){let n;if(on(e)&&vie(e)&&e.isPadding()){const i=e;n=i.getLeafColumns()[0];let r=n;for(;r!==i;)t++,r=r.getParent()}return{column:n||e,headerRowIndex:t}}var aJe=class extends X{constructor(){super(...arguments),this.beanName="headerNavigation",this.currentHeaderRowWithoutSpan=-1}postConstruct(){const e=this.beans;e.ctrlsSvc.whenReady(this,n=>{this.gridBodyCon=n.gridBodyCtrl});const t=Rn(e);this.addManagedElementListeners(t,{mousedown:()=>{this.currentHeaderRowWithoutSpan=-1}})}getHeaderPositionForColumn(e,t){let n;const{colModel:i,colGroupSvc:r,ctrlsSvc:s}=this.beans;if(typeof e=="string"?(n=i.getCol(e),n||(n=r?.getColumnGroup(e)??null)):n=e,!n)return null;const a=s.getHeaderRowContainerCtrl()?.getAllCtrls(),l=Tt(a||[]).type==="filter",u=la(this.beans)-1;let c=-1,d=n;for(;d;)c++,d=d.getParent();let h=c;return t&&l&&h===u-1&&h++,h===-1?null:{headerRowIndex:h,column:n}}navigateVertically(e,t,n){const i=this.beans.focusSvc;if(t||(t=i.focusedHeader),!t)return!1;const{headerRowIndex:r}=t,s=t.column,o=la(this.beans),a=e==="UP",l=this.getHeaderRowType(r);let{headerRowIndex:u,column:c,headerRowIndexWithoutSpan:d}=a?lJe(l,s,r):uJe(l,s,r),h=!1;return u<0&&(u=0,c=s,h=!0),u>=o?(u=-1,this.currentHeaderRowWithoutSpan=-1):d!==void 0&&(this.currentHeaderRowWithoutSpan=d),!h&&!c?!1:i.focusHeaderPosition({headerPosition:{headerRowIndex:u,column:c},allowUserOverride:!0,event:n})}navigateHorizontally(e,t=!1,n){const{focusSvc:i,gos:r}=this.beans,s=i.focusedHeader;let o,a;this.currentHeaderRowWithoutSpan!==-1?s.headerRowIndex=this.currentHeaderRowWithoutSpan:this.currentHeaderRowWithoutSpan=s.headerRowIndex,e==="LEFT"!==r.get("enableRtl")?(a="Before",o=this.findHeader(s,a)):(a="After",o=this.findHeader(s,a));const l=r.getCallback("tabToNextHeader");if(t&&l){const u=i.focusHeaderPositionFromUserFunc({userFunc:l,headerPosition:o,direction:a});if(u){const{headerRowIndex:c}=i.focusedHeader||{};c!=null&&c!=s.headerRowIndex&&(this.currentHeaderRowWithoutSpan=c)}return u}return o||!t?i.focusHeaderPosition({headerPosition:o,direction:a,fromTab:t,allowUserOverride:!0,event:n}):this.focusNextHeaderRow(s,a,n)}focusNextHeaderRow(e,t,n){const i=e.headerRowIndex;let r=null,s;const o=this.beans;if(t==="Before"?i>0&&(s=i-1,this.currentHeaderRowWithoutSpan-=1,r=this.findColAtEdgeForHeaderRow(s,"end")):(s=i+1,this.currentHeaderRowWithoutSpan<la(o)?this.currentHeaderRowWithoutSpan+=1:this.currentHeaderRowWithoutSpan=-1,r=this.findColAtEdgeForHeaderRow(s,"start")),!r)return!1;const{column:a,headerRowIndex:l}=zT(r.column,r?.headerRowIndex);return o.focusSvc.focusHeaderPosition({headerPosition:{column:a,headerRowIndex:l},direction:t,fromTab:!0,allowUserOverride:!0,event:n})}scrollToColumn(e,t="After"){if(e.getPinned())return;let n;if(on(e)){const i=e.getDisplayedLeafColumns();n=t==="Before"?Tt(i):i[0]}else n=e;this.gridBodyCon.scrollFeature.ensureColumnVisible(n)}findHeader(e,t){let n,i;const{colGroupSvc:r,visibleCols:s}=this.beans;if(on(e.column)?n=r?.getGroupAtDirection(e.column,t)??void 0:(i=`getCol${t}`,n=s[i](e.column)),!n)return;const{headerRowIndex:o}=e;if(this.getHeaderRowType(o)!=="filter"){const u=[n];for(;n.getParent();)n=n.getParent(),u.push(n);n=u[Math.max(0,u.length-1-o)]}const{column:a,headerRowIndex:l}=zT(n,o);return{column:a,headerRowIndex:l}}getHeaderRowType(e){const t=this.beans.ctrlsSvc.getHeaderRowContainerCtrl();if(t)return t.getRowType(e)}findColAtEdgeForHeaderRow(e,t){const{visibleCols:n,ctrlsSvc:i,colGroupSvc:r}=this.beans,s=n.allCols,o=s[t==="start"?0:s.length-1];if(!o)return;const l=i.getHeaderRowContainerCtrl(o.getPinned())?.getRowType(e);if(l=="group"){const u=r?.getColGroupAtLevel(o,e);return{headerRowIndex:e,column:u}}return{headerRowIndex:l==null?-1:e,column:o}}};function lJe(e,t,n){const i=e==="filter",r=e==="column";let s=i?t:t.getParent(),o=n-1,a=o;if(r&&vie(t.getParent())){for(;s&&s.isPadding();)s=s.getParent(),o--;a=o,o<0&&(s=t,o=n,a=void 0)}return{column:s,headerRowIndex:o,headerRowIndexWithoutSpan:a}}function uJe(e,t,n,i="After"){let r=t,s=n+1;const o=s;if(e==="group"){const a=t.getDisplayedLeafColumns(),l=i==="After"?a[0]:Tt(a),u=[];let c=l;for(;c.getParent()!==t;)c=c.getParent(),u.push(c);if(r=l,l.isSpanHeaderHeight())for(let d=u.length-1;d>=0;d--){const h=u[d];if(!h.isPadding()){r=h;break}s++}else r=Tt(u),r||(r=l)}return{column:r,headerRowIndex:s,headerRowIndexWithoutSpan:o}}var cJe=class extends X{constructor(){super(...arguments),this.beanName="focusSvc",this.focusFallbackTimeout=null,this.needsFocusRestored=!1}wireBeans(e){this.colModel=e.colModel,this.visibleCols=e.visibleCols,this.rowRenderer=e.rowRenderer,this.navigation=e.navigation,this.filterManager=e.filterManager,this.overlays=e.overlays}postConstruct(){const e=this.clearFocusedCell.bind(this);this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:this.onColumnEverythingChanged.bind(this),columnGroupOpened:e,columnRowGroupChanged:e}),this.addDestroyFunc(xje(this.beans))}attemptToRecoverFocus(){this.needsFocusRestored=!0,this.focusFallbackTimeout!=null&&clearTimeout(this.focusFallbackTimeout),this.focusFallbackTimeout=window.setTimeout(this.setFocusRecovered.bind(this),100)}setFocusRecovered(){this.needsFocusRestored=!1,this.focusFallbackTimeout!=null&&(clearTimeout(this.focusFallbackTimeout),this.focusFallbackTimeout=null)}shouldTakeFocus(){return this.gos.get("suppressFocusAfterRefresh")?(this.setFocusRecovered(),!1):this.needsFocusRestored?(this.setFocusRecovered(),!0):this.doesRowOrCellHaveBrowserFocus()}onColumnEverythingChanged(){if(!this.focusedCell)return;const e=this.focusedCell.column,t=this.colModel.getCol(e.getId());e!==t&&this.clearFocusedCell()}getFocusCellToUseAfterRefresh(){const{gos:e,focusedCell:t}=this;return e.get("suppressFocusAfterRefresh")||e.get("suppressCellFocus")||!t||!this.doesRowOrCellHaveBrowserFocus()?null:t}getFocusHeaderToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedHeader||!this.isDomDataPresentInHierarchy(Xt(this.beans),Une)?null:this.focusedHeader}doesRowOrCellHaveBrowserFocus(){const e=Xt(this.beans);return this.isDomDataPresentInHierarchy(e,ZS)?!0:this.isDomDataPresentInHierarchy(e,i1)}isDomDataPresentInHierarchy(e,t){let n=e;for(;n;){if(Wte(this.gos,n,t))return!0;n=n.parentNode}return!1}getFocusedCell(){return this.focusedCell}getFocusEventParams(e){const{rowIndex:t,rowPinned:n,column:i}=e,r={rowIndex:t,rowPinned:n,column:i,isFullWidthCell:!1},s=this.rowRenderer.getRowByPosition({rowIndex:t,rowPinned:n});return s&&(r.isFullWidthCell=s.isFullWidth()),r}clearFocusedCell(){if(this.focusedCell==null)return;const e=this.getFocusEventParams(this.focusedCell);this.focusedCell=null,this.eventSvc.dispatchEvent({type:"cellFocusCleared",...e})}setFocusedCell(e){this.setFocusRecovered();const{column:t,rowIndex:n,rowPinned:i,forceBrowserFocus:r=!1,preventScrollOnBrowserFocus:s=!1}=e,o=this.colModel.getCol(t);if(!o){this.focusedCell=null;return}this.focusedCell={rowIndex:n,rowPinned:Rl(i),column:o},this.eventSvc.dispatchEvent({type:"cellFocused",...this.getFocusEventParams(this.focusedCell),forceBrowserFocus:r,preventScrollOnBrowserFocus:s})}isCellFocused(e){return this.focusedCell==null?!1:Ane(e,this.focusedCell)}isHeaderWrapperFocused(e){if(this.focusedHeader==null)return!1;const{column:t,rowCtrl:{rowIndex:n,pinned:i}}=e,{column:r,headerRowIndex:s}=this.focusedHeader;return t===r&&n===s&&i==r.getPinned()}focusHeaderPosition(e){if(this.setFocusRecovered(),Ad(this.beans))return!1;const{direction:t,fromTab:n,allowUserOverride:i,event:r,fromCell:s,rowWithoutSpanValue:o}=e;let{headerPosition:a}=e;if(s&&this.filterManager?.isAdvFilterHeaderActive())return this.focusAdvancedFilter(a);if(i){const l=this.focusedHeader,u=la(this.beans);if(n){const c=this.gos.getCallback("tabToNextHeader");c&&(a=this.getHeaderPositionFromUserFunc({userFunc:c,direction:t,currentPosition:l,headerPosition:a,headerRowCount:u}))}else{const c=this.gos.getCallback("navigateToNextHeader");if(c&&r){const d={key:r.key,previousHeaderPosition:l,nextHeaderPosition:a,headerRowCount:u,event:r};a=c(d)}}}return a?this.focusProvidedHeaderPosition({headerPosition:a,direction:t,event:r,fromCell:s,rowWithoutSpanValue:o}):!1}focusHeaderPositionFromUserFunc(e){if(Ad(this.beans))return!1;const{userFunc:t,headerPosition:n,direction:i,event:r}=e,s=this.focusedHeader,o=la(this.beans),a=this.getHeaderPositionFromUserFunc({userFunc:t,direction:i,currentPosition:s,headerPosition:n,headerRowCount:o});return!!a&&this.focusProvidedHeaderPosition({headerPosition:a,direction:i,event:r})}getHeaderPositionFromUserFunc(e){const{userFunc:t,direction:n,currentPosition:i,headerPosition:r,headerRowCount:s}=e,a=t({backwards:n==="Before",previousHeaderPosition:i,nextHeaderPosition:r,headerRowCount:s});return a===!0?i:a===!1?null:a}focusProvidedHeaderPosition(e){const{headerPosition:t,direction:n,fromCell:i,rowWithoutSpanValue:r,event:s}=e,{column:o,headerRowIndex:a}=t,{filterManager:l,ctrlsSvc:u,headerNavigation:c}=this.beans;if(a===-1)return l?.isAdvFilterHeaderActive()?this.focusAdvancedFilter(t):this.focusGridView({column:o,event:s});c?.scrollToColumn(o,n);const h=u.getHeaderRowContainerCtrl(o.getPinned())?.focusHeader(t.headerRowIndex,o,s)||!1;return c&&h&&(r!=null||i)&&(c.currentHeaderRowWithoutSpan=r??-1),h}focusFirstHeader(){if(this.overlays?.isExclusive()&&this.focusOverlay())return!0;let e=this.visibleCols.allCols[0];if(!e)return!1;const{colGroupSvc:t}=this.beans;t&&e.getParent()&&(e=t.getColGroupAtLevel(e,0));const n=zT(e,0);return this.focusHeaderPosition({headerPosition:n,rowWithoutSpanValue:0})}focusLastHeader(e){if(this.overlays?.isExclusive()&&this.focusOverlay(!0))return!0;const t=la(this.beans)-1,n=Tt(this.visibleCols.allCols);return this.focusHeaderPosition({headerPosition:{headerRowIndex:t,column:n},rowWithoutSpanValue:-1,event:e})}focusPreviousFromFirstCell(e){return this.filterManager?.isAdvFilterHeaderActive()?this.focusAdvancedFilter(null):this.focusLastHeader(e)}isAnyCellFocused(){return!!this.focusedCell}isRowFocused(e,t){return this.focusedCell==null?!1:this.focusedCell.rowIndex===e&&this.focusedCell.rowPinned===Rl(t)}focusOverlay(e){const t=this.overlays?.isVisible()&&this.overlays.eWrapper?.getGui();return!!t&&eh(t,e)}focusGridView(e){const{backwards:t=!1,canFocusOverlay:n=!0,event:i}=e;if(this.overlays?.isExclusive())return n&&this.focusOverlay(t);if(_R(this.beans))return t&&!Ad(this.beans)?this.focusLastHeader():n&&this.focusOverlay(t)?!0:t?!1:Ap(this.beans,t);const r=t?qje(this.beans):jje(this.beans);if(r){const s=e.column??this.focusedHeader?.column,{rowIndex:o,rowPinned:a}=r,l=e1(this.beans,r);if(!s||!l||o==null)return!1;if(s.isSuppressNavigable(l)){const u=this.gos.get("enableRtl");let c;return!i||i.key===K.TAB?c=u?K.LEFT:K.RIGHT:c=i.key,this.beans.navigation?.navigateToNextCell(null,c,{rowIndex:o,column:s,rowPinned:a||null},!0),!0}return this.navigation?.ensureCellVisible({rowIndex:o,column:s,rowPinned:a}),t&&this.rowRenderer.getRowByPosition(r)?.isFullWidth()&&this.navigation?.tryToFocusFullWidthRow(r,t)||(this.setFocusedCell({rowIndex:o,column:s,rowPinned:Rl(a),forceBrowserFocus:!0}),this.beans.rangeSvc?.setRangeToCell({rowIndex:o,rowPinned:a,column:s})),!0}return!!(n&&this.focusOverlay(t)||t&&this.focusLastHeader())}focusAdvancedFilter(e){return this.advFilterFocusColumn=e?.column,this.beans.advancedFilter?.getCtrl().focusHeaderComp()??!1}focusNextFromAdvancedFilter(e,t){const n=(t?void 0:this.advFilterFocusColumn)??this.visibleCols.allCols?.[0];return e?this.focusHeaderPosition({headerPosition:{column:n,headerRowIndex:la(this.beans)-1}}):this.focusGridView({column:n})}clearAdvancedFilterColumn(){this.advFilterFocusColumn=void 0}},dJe=class extends X{constructor(){super(...arguments),this.beanName="scrollVisibleSvc"}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.colAnimation=e.colAnimation}postConstruct(){this.getScrollbarWidth(),this.addManagedEventListeners({displayedColumnsChanged:this.updateScrollVisible.bind(this),displayedColumnsWidthChanged:this.updateScrollVisible.bind(this)})}updateScrollVisible(){const{colAnimation:e}=this;e?.isActive()?e.executeLaterVMTurn(()=>{e.executeLaterVMTurn(()=>this.updateScrollVisibleImpl())}):this.updateScrollVisibleImpl()}updateScrollVisibleImpl(){const e=this.ctrlsSvc.get("center");if(!e||this.colAnimation?.isActive())return;const t={horizontalScrollShowing:e.isHorizontalScrollShowing(),verticalScrollShowing:this.verticalScrollShowing};this.setScrollsVisible(t),this.updateScrollGap()}updateScrollGap(){const e=this.ctrlsSvc.get("center"),t=e.hasHorizontalScrollGap(),n=e.hasVerticalScrollGap();(this.horizontalScrollGap!==t||this.verticalScrollGap!==n)&&(this.horizontalScrollGap=t,this.verticalScrollGap=n,this.eventSvc.dispatchEvent({type:"scrollGapChanged"}))}setScrollsVisible(e){(this.horizontalScrollShowing!==e.horizontalScrollShowing||this.verticalScrollShowing!==e.verticalScrollShowing)&&(this.horizontalScrollShowing=e.horizontalScrollShowing,this.verticalScrollShowing=e.verticalScrollShowing,this.eventSvc.dispatchEvent({type:"scrollVisibilityChanged"}))}getScrollbarWidth(){if(this.scrollbarWidth==null){const e=this.gos.get("scrollbarWidth"),n=typeof e=="number"&&e>=0?e:h9e();n!=null&&(this.scrollbarWidth=n,this.eventSvc.dispatchEvent({type:"scrollbarWidthChanged"}))}return this.scrollbarWidth}},hJe=class extends X{constructor(){super(...arguments),this.beanName="gridDestroySvc",this.destroyCalled=!1}destroy(){if(this.destroyCalled)return;const{stateSvc:e,ctrlsSvc:t,context:n}=this.beans;this.eventSvc.dispatchEvent({type:"gridPreDestroyed",state:e?.getState()??{}}),this.destroyCalled=!0,t.get("gridCtrl")?.destroyGridUi(),n.destroy(),super.destroy()}},gv=new Set(["gridPreDestroyed","fillStart","pasteStart"]),fJe={suppressContextMenu:!1,preventDefaultOnContextMenu:!1,allowContextMenuWithControlKey:!1,suppressMenuHide:!0,enableBrowserTooltips:!1,tooltipTrigger:"hover",tooltipShowDelay:2e3,tooltipHideDelay:1e4,tooltipMouseTrack:!1,tooltipShowMode:"standard",tooltipInteraction:!1,copyHeadersToClipboard:!1,copyGroupHeadersToClipboard:!1,clipboardDelimiter:"	",suppressCopyRowsToClipboard:!1,suppressCopySingleCellRanges:!1,suppressLastEmptyLineOnPaste:!1,suppressClipboardPaste:!1,suppressClipboardApi:!1,suppressCutToClipboard:!1,maintainColumnOrder:!1,enableStrictPivotColumnOrder:!1,suppressFieldDotNotation:!1,allowDragFromColumnsToolPanel:!1,suppressMovableColumns:!1,suppressColumnMoveAnimation:!1,suppressMoveWhenColumnDragging:!1,suppressDragLeaveHidesColumns:!1,suppressRowGroupHidesColumns:!1,suppressAutoSize:!1,autoSizePadding:20,skipHeaderOnAutoSize:!1,singleClickEdit:!1,suppressClickEdit:!1,readOnlyEdit:!1,stopEditingWhenCellsLoseFocus:!1,enterNavigatesVertically:!1,enterNavigatesVerticallyAfterEdit:!1,enableCellEditingOnBackspace:!1,undoRedoCellEditing:!1,undoRedoCellEditingLimit:10,suppressCsvExport:!1,suppressExcelExport:!1,cacheQuickFilter:!1,includeHiddenColumnsInQuickFilter:!1,excludeChildrenWhenTreeDataFiltering:!1,enableAdvancedFilter:!1,includeHiddenColumnsInAdvancedFilter:!1,enableCharts:!1,masterDetail:!1,keepDetailRows:!1,keepDetailRowsCount:10,detailRowAutoHeight:!1,tabIndex:0,rowBuffer:10,valueCache:!1,valueCacheNeverExpires:!1,enableCellExpressions:!1,suppressTouch:!1,suppressFocusAfterRefresh:!1,suppressBrowserResizeObserver:!1,suppressPropertyNamesCheck:!1,suppressChangeDetection:!1,debug:!1,suppressLoadingOverlay:!1,suppressNoRowsOverlay:!1,pagination:!1,paginationPageSize:100,paginationPageSizeSelector:!0,paginationAutoPageSize:!1,paginateChildRows:!1,suppressPaginationPanel:!1,pivotMode:!1,pivotPanelShow:"never",pivotDefaultExpanded:0,pivotSuppressAutoColumn:!1,suppressExpandablePivotGroups:!1,functionsReadOnly:!1,suppressAggFuncInHeader:!1,alwaysAggregateAtRootLevel:!1,aggregateOnlyChangedColumns:!1,suppressAggFilteredOnly:!1,removePivotHeaderRowWhenSingleValueColumn:!1,animateRows:!0,cellFlashDuration:500,cellFadeDuration:1e3,allowShowChangeAfterFilter:!1,domLayout:"normal",ensureDomOrder:!1,enableRtl:!1,suppressColumnVirtualisation:!1,suppressMaxRenderedRowRestriction:!1,suppressRowVirtualisation:!1,rowDragManaged:!1,suppressRowDrag:!1,suppressMoveWhenRowDragging:!1,rowDragEntireRow:!1,rowDragMultiRow:!1,embedFullWidthRows:!1,groupDisplayType:"singleColumn",groupDefaultExpanded:0,groupMaintainOrder:!1,groupSelectsChildren:!1,groupSuppressBlankHeader:!1,groupSelectsFiltered:!1,showOpenedGroup:!1,groupRemoveSingleChildren:!1,groupRemoveLowestSingleChildren:!1,groupHideOpenParents:!1,groupAllowUnbalanced:!1,rowGroupPanelShow:"never",suppressMakeColumnVisibleAfterUnGroup:!1,treeData:!1,rowGroupPanelSuppressSort:!1,suppressGroupRowsSticky:!1,rowModelType:"clientSide",asyncTransactionWaitMillis:50,suppressModelUpdateAfterUpdateTransaction:!1,cacheOverflowSize:1,infiniteInitialRowCount:1,serverSideInitialRowCount:1,cacheBlockSize:100,maxBlocksInCache:-1,maxConcurrentDatasourceRequests:2,blockLoadDebounceMillis:0,purgeClosedRowNodes:!1,serverSideSortAllLevels:!1,serverSideOnlyRefreshFilteredGroups:!1,serverSidePivotResultFieldSeparator:"_",viewportRowModelPageSize:5,viewportRowModelBufferSize:5,alwaysShowHorizontalScroll:!1,alwaysShowVerticalScroll:!1,debounceVerticalScrollbar:!1,suppressHorizontalScroll:!1,suppressScrollOnNewData:!1,suppressScrollWhenPopupsAreOpen:!1,suppressAnimationFrame:!1,suppressMiddleClickScrolls:!1,suppressPreventDefaultOnMouseWheel:!1,rowMultiSelectWithClick:!1,suppressRowDeselection:!1,suppressRowClickSelection:!1,suppressCellFocus:!1,suppressHeaderFocus:!1,suppressMultiRangeSelection:!1,enableCellTextSelection:!1,enableRangeSelection:!1,enableRangeHandle:!1,enableFillHandle:!1,fillHandleDirection:"xy",suppressClearOnFillReduction:!1,accentedSort:!1,unSortIcon:!1,suppressMultiSort:!1,alwaysMultiSort:!1,suppressMaintainUnsortedOrder:!1,suppressRowHoverHighlight:!1,suppressRowTransform:!1,columnHoverHighlight:!1,deltaSort:!1,enableGroupEdit:!1,groupLockGroupColumns:0,serverSideEnableClientSideSort:!1,suppressServerSideFullWidthLoadingRow:!1,pivotMaxGeneratedColumns:-1,columnMenu:"new",reactiveCustomComponents:!0,suppressSetFilterByDefault:!1,rowNumbers:!1},pJe=0,gJe=0,mJe=class extends X{constructor(){super(...arguments),this.beanName="gos",this.domDataKey="__AG_"+Math.random().toString(),this.gridInstanceId=gJe++,this.propEventSvc=new Jd,this.globalEventHandlerFactory=e=>(t,n)=>{if(!this.isAlive())return;const i=gv.has(t);if(i&&!e||!i&&e)return;const r=gN(t),s=this.gridOptions[r];typeof s=="function"&&this.beans.frameworkOverrides.wrapOutgoing(()=>{s(n)})}}wireBeans(e){this.gridOptions=e.gridOptions,this.validation=e.validation,this.api=e.gridApi,this.gridId=e.context.getGridId()}get gridOptionsContext(){return this.gridOptions.context}postConstruct(){this.eventSvc.addGlobalListener(this.globalEventHandlerFactory().bind(this),!0),this.eventSvc.addGlobalListener(this.globalEventHandlerFactory(!0).bind(this),!1),this.propEventSvc.setFrameworkOverrides(this.beans.frameworkOverrides),this.addManagedEventListeners({gridOptionsChanged:({options:e})=>{this.updateGridOptions({options:e,force:!0,source:"gridOptionsUpdated"})}})}get(e){return this.gridOptions[e]??fJe[e]}getCallback(e){return this.mergeGridCommonParams(this.gridOptions[e])}exists(e){return me(this.gridOptions[e])}mergeGridCommonParams(e){return e&&(n=>e(this.addGridCommonParams(n)))}updateGridOptions({options:e,force:t,source:n="api"}){const i={id:pJe++,properties:[]},r=[],{gridOptions:s,validation:o}=this;for(const a of Object.keys(e)){const l=e[a];o?.warnOnInitialPropertyUpdate(n,a);const u=t||typeof l=="object"&&n==="api",c=s[a];if(u||c!==l){s[a]=l;const d={type:a,currentValue:l,previousValue:c,changeSet:i,source:n};r.push(d)}}o?.processGridOptions(this.gridOptions),i.properties=r.map(a=>a.type),r.forEach(a=>{ac(this,`Updated property ${a.type} from`,a.previousValue," to ",a.currentValue),this.propEventSvc.dispatchEvent(a)})}addPropertyEventListener(e,t){this.propEventSvc.addEventListener(e,t)}removePropertyEventListener(e,t){this.propEventSvc.removeEventListener(e,t)}getDomDataKey(){return this.domDataKey}addGridCommonParams(e){return e.api=this.api,e.context=this.gridOptionsContext,e}assertModuleRegistered(e,t){const n=Array.isArray(e)?e.some(i=>this.isModuleRegistered(i)):this.isModuleRegistered(e);return n||wt(200,{...this.getModuleErrorParams(),moduleName:e,reasonOrId:t}),n}getModuleErrorParams(){return{gridId:this.gridId,gridScoped:yN(),rowModelType:this.get("rowModelType"),isUmd:pje()}}isModuleRegistered(e){return Cne(e,this.gridId,this.get("rowModelType"))}};function Cie(e){const t={"aria-hidden":"true"};return{tag:"div",cls:"ag-cell-label-container",role:"presentation",children:[{tag:"span",ref:"eMenu",cls:"ag-header-icon ag-header-cell-menu-button",attrs:t},{tag:"span",ref:"eFilterButton",cls:"ag-header-icon ag-header-cell-filter-button",attrs:t},{tag:"div",ref:"eLabel",cls:"ag-header-cell-label",role:"presentation",children:[{tag:"span",ref:"eText",cls:"ag-header-cell-text"},{tag:"span",ref:"eFilter",cls:"ag-header-icon ag-header-label-icon ag-filter-icon",attrs:t},e?{tag:"ag-sort-indicator",ref:"eSortIndicator"}:null]}]}}var vJe=Cie(!0),CJe=Cie(!1),yJe=class extends bt{constructor(){super(...arguments),this.eFilter=ge,this.eFilterButton=ge,this.eSortIndicator=ge,this.eMenu=ge,this.eLabel=ge,this.eText=ge,this.eSortOrder=ge,this.eSortAsc=ge,this.eSortDesc=ge,this.eSortMixed=ge,this.eSortNone=ge,this.isLoadingInnerComponent=!1}refresh(e){const t=this.params;if(this.params=e,this.workOutTemplate(e,!!this.beans?.sortSvc)!=this.currentTemplate||this.workOutShowMenu()!=this.currentShowMenu||e.enableSorting!=this.currentSort||this.currentSuppressMenuHide!=null&&this.shouldSuppressMenuHide()!=this.currentSuppressMenuHide||t.enableFilterButton!=e.enableFilterButton||t.enableFilterIcon!=e.enableFilterIcon)return!1;if(this.innerHeaderComponent){const n={...e};ir(n,e.innerHeaderComponentParams),this.innerHeaderComponent.refresh?.(n)}else this.setDisplayName(e);return!0}workOutTemplate(e,t){const n=e.template;return n?n?.trim?n.trim():n:t?vJe:CJe}init(e){this.params=e;const{sortSvc:t,touchSvc:n,rowNumbersSvc:i,userCompFactory:r}=this.beans,s=t?.getSortIndicatorSelector();this.currentTemplate=this.workOutTemplate(e,!!s),this.setTemplate(this.currentTemplate,s?[s]:void 0),n?.setupForHeader(this),this.setMenu(),this.setupSort(),i?.setupForHeader(this),this.setupFilterIcon(),this.setupFilterButton(),this.workOutInnerHeaderComponent(r,e),this.setDisplayName(e)}workOutInnerHeaderComponent(e,t){const n=j7e(e,t,t);n&&(this.isLoadingInnerComponent=!0,n.newAgStackInstance().then(i=>{this.isLoadingInnerComponent=!1,i&&(this.isAlive()?(this.innerHeaderComponent=i,this.eText.appendChild(i.getGui())):this.destroyBean(i))}))}setDisplayName(e){const{displayName:t}=e,n=this.currentDisplayName;if(this.currentDisplayName=t,n===t||this.innerHeaderComponent||this.isLoadingInnerComponent)return;const i=Fl(t,!0);this.eText.textContent=i}addInIcon(e,t,n){if(t==null)return;const i=As(e,this.beans,n);i&&t.appendChild(i)}workOutShowMenu(){return this.params.enableMenu&&!!this.beans.menuSvc?.isHeaderMenuButtonEnabled()}shouldSuppressMenuHide(){return!!this.beans.menuSvc?.isHeaderMenuButtonAlwaysShowEnabled()}setMenu(){if(!this.eMenu)return;if(this.currentShowMenu=this.workOutShowMenu(),!this.currentShowMenu){Fs(this.eMenu),this.eMenu=void 0;return}const{gos:e,eMenu:t,params:n}=this,i=Ur(e);this.addInIcon(i?"menu":"menuAlt",t,n.column),t.classList.toggle("ag-header-menu-icon",!i);const r=this.shouldSuppressMenuHide();this.currentSuppressMenuHide=r,this.addManagedElementListeners(t,{click:()=>this.showColumnMenu(this.eMenu)}),this.toggleMenuAlwaysShow(r)}toggleMenuAlwaysShow(e){this.eMenu?.classList.toggle("ag-header-menu-always-show",e)}showColumnMenu(e){const{currentSuppressMenuHide:t,params:n}=this;t||this.toggleMenuAlwaysShow(!0),n.showColumnMenu(e,()=>{t||this.toggleMenuAlwaysShow(!1)})}onMenuKeyboardShortcut(e){const{params:t,gos:n,beans:i,eMenu:r,eFilterButton:s}=this,o=t.column,a=Ur(n);if(e&&!a){if(i.menuSvc?.isFilterMenuInHeaderEnabled(o))return t.showFilter(s??r??this.getGui()),!0}else if(t.enableMenu)return this.showColumnMenu(r??s??this.getGui()),!0;return!1}setupSort(){const{sortSvc:e}=this.beans;if(!e)return;const{enableSorting:t,column:n}=this.params;if(this.currentSort=t,!this.eSortIndicator){this.eSortIndicator=this.createBean(e.createSortIndicator(!0));const{eSortIndicator:i,eSortOrder:r,eSortAsc:s,eSortDesc:o,eSortMixed:a,eSortNone:l}=this;i.attachCustomElements(r,s,o,a,l)}this.eSortIndicator.setupSort(n),this.currentSort&&e.setupHeader(this,n,this.eLabel)}setupFilterIcon(){const{eFilter:e,params:t}=this;e&&this.configureFilter(t.enableFilterIcon,e,this.onFilterChangedIcon.bind(this),"filterActive")}setupFilterButton(){const{eFilterButton:e,params:t}=this;if(!e)return;this.configureFilter(t.enableFilterButton,e,this.onFilterChangedButton.bind(this),"filter")?this.addManagedElementListeners(e,{click:()=>t.showFilter(e)}):this.eFilterButton=void 0}configureFilter(e,t,n,i){if(!e)return Fs(t),!1;const r=this.params.column;return this.addInIcon(i,t,r),this.addManagedListeners(r,{filterChanged:n}),n(),!0}onFilterChangedIcon(){const e=this.params.column.isFilterActive();Yt(this.eFilter,e,{skipAriaHidden:!0})}onFilterChangedButton(){const e=this.params.column.isFilterActive();this.eFilterButton.classList.toggle("ag-filter-active",e)}getAnchorElementForMenu(e){const{eFilterButton:t,eMenu:n}=this;return e?t??n??this.getGui():n??t??this.getGui()}destroy(){super.destroy(),this.innerHeaderComponent&&(this.destroyBean(this.innerHeaderComponent),this.innerHeaderComponent=void 0)}},wJe={tag:"div",cls:"ag-header-group-cell-label",role:"presentation",children:[{tag:"span",ref:"agLabel",cls:"ag-header-group-text",role:"presentation"},{tag:"span",ref:"agOpened",cls:"ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"},{tag:"span",ref:"agClosed",cls:"ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"}]},bJe=class extends bt{constructor(){super(wJe),this.agOpened=ge,this.agClosed=ge,this.agLabel=ge,this.isLoadingInnerComponent=!1}init(e){const{userCompFactory:t}=this.beans;this.params=e,this.checkWarnings(),this.workOutInnerHeaderGroupComponent(t,e),this.setupLabel(e),this.addGroupExpandIcon(e),this.setupExpandIcons()}checkWarnings(){this.params.template&&ue(89)}workOutInnerHeaderGroupComponent(e,t){const n=K7e(e,t,t);n&&(this.isLoadingInnerComponent=!0,n.newAgStackInstance().then(i=>{this.isLoadingInnerComponent=!1,i&&(this.isAlive()?(this.innerHeaderGroupComponent=i,this.agLabel.appendChild(i.getGui())):this.destroyBean(i))}))}setupExpandIcons(){const{agOpened:e,agClosed:t,params:{columnGroup:n},beans:i}=this;this.addInIcon("columnGroupOpened",e),this.addInIcon("columnGroupClosed",t);const r=l=>{if(El(l))return;const u=!n.isExpanded();i.colGroupSvc.setColumnGroupOpened(n.getProvidedColumnGroup(),u,"uiColumnExpanded")};this.addTouchAndClickListeners(i,t,r),this.addTouchAndClickListeners(i,e,r);const s=l=>{Rp(l)};this.addManagedElementListeners(t,{dblclick:s}),this.addManagedElementListeners(e,{dblclick:s}),this.addManagedElementListeners(this.getGui(),{dblclick:r}),this.updateIconVisibility();const o=n.getProvidedColumnGroup(),a=this.updateIconVisibility.bind(this);this.addManagedListeners(o,{expandedChanged:a,expandableChanged:a})}addTouchAndClickListeners(e,t,n){e.touchSvc?.setupForHeaderGroup(this,t,n),this.addManagedElementListeners(t,{click:n})}updateIconVisibility(){const{agOpened:e,agClosed:t,params:{columnGroup:n}}=this;if(n.isExpandable()){const i=n.isExpanded();Yt(e,i),Yt(t,!i)}else Yt(e,!1),Yt(t,!1)}addInIcon(e,t){const n=As(e,this.beans,null);n&&t.appendChild(n)}addGroupExpandIcon(e){if(!e.columnGroup.isExpandable()){const{agOpened:t,agClosed:n}=this;Yt(t,!1),Yt(n,!1);return}}setupLabel(e){const{displayName:t,columnGroup:n}=e,i=this.innerHeaderGroupComponent||this.isLoadingInnerComponent;if(me(t)&&!i){const r=Fl(t,!0);this.agLabel.textContent=r}this.addOrRemoveCssClass("ag-sticky-label",!n.getColGroupDef()?.suppressStickyLabel)}destroy(){super.destroy(),this.innerHeaderGroupComponent&&(this.destroyBean(this.innerHeaderGroupComponent),this.innerHeaderGroupComponent=void 0)}},SJe={moduleName:"ColumnHeaderComp",version:Ce,userComponents:{agColumnHeader:yJe},icons:{menu:"menu",menuAlt:"menu-alt"}},xJe={moduleName:"ColumnGroupHeaderComp",version:Ce,userComponents:{agColumnGroupHeader:bJe},icons:{columnGroupOpened:"expanded",columnGroupClosed:"contracted"}},RJe=class extends X{constructor(){super(...arguments),this.beanName="animationFrameSvc",this.p1={list:[],sorted:!1},this.p2={list:[],sorted:!1},this.f1={list:[],sorted:!1},this.destroyTasks=[],this.ticking=!1,this.scrollGoingDown=!0,this.lastScrollTop=0,this.taskCount=0}setScrollTop(e){this.scrollGoingDown=e>=this.lastScrollTop,e===0&&(this.scrollGoingDown=!0),this.lastScrollTop=e}postConstruct(){this.active=!this.gos.get("suppressAnimationFrame"),this.batchFrameworkComps=this.beans.frameworkOverrides.batchFrameworkComps}verify(){this.active===!1&&ue(92)}createTask(e,t,n,i){this.verify();let r=n;i&&this.batchFrameworkComps&&(r="f1");const s={task:e,index:t,createOrder:++this.taskCount};this.addTaskToList(this[r],s),this.schedule()}addTaskToList(e,t){e.list.push(t),e.sorted=!1}sortTaskList(e){if(e.sorted)return;const t=this.scrollGoingDown?1:-1;e.list.sort((n,i)=>n.index!==i.index?t*(i.index-n.index):i.createOrder-n.createOrder),e.sorted=!0}addDestroyTask(e){this.verify(),this.destroyTasks.push(e),this.schedule()}executeFrame(e){const{p1:t,p2:n,f1:i,destroyTasks:r,beans:s}=this,{ctrlsSvc:o,frameworkOverrides:a}=s,l=t.list,u=n.list,c=i.list,d=Date.now();let h=0;const p=e<=0,g=o.getScrollFeature();for(;p||h<e;){if(!g.scrollGridIfNeeded()){let C;if(l.length)this.sortTaskList(t),C=l.pop().task;else if(u.length)this.sortTaskList(n),C=u.pop().task;else if(c.length)a.wrapOutgoing(()=>{for(;(p||h<e)&&!g.scrollGridIfNeeded();){if(c.length)this.sortTaskList(i),C=c.pop().task,C();else break;h=Date.now()-d}}),C=()=>{};else if(r.length)C=r.pop();else break;C()}h=Date.now()-d}l.length||u.length||c.length||r.length?this.requestFrame():this.ticking=!1}flushAllFrames(){this.active&&this.executeFrame(-1)}schedule(){this.active&&(this.ticking||(this.ticking=!0,this.requestFrame()))}requestFrame(){const e=this.executeFrame.bind(this,60);eu(this.beans,e)}isQueueEmpty(){return!this.ticking}},EJe={moduleName:"AnimationFrame",version:Ce,beans:[RJe]},FJe=class extends X{constructor(){super(...arguments),this.beanName="touchSvc"}mockBodyContextMenu(e,t){this.mockContextMenu(e,e.eBodyViewport,t)}mockHeaderContextMenu(e,t){this.mockContextMenu(e,e.eGui,t)}mockRowContextMenu(e){if(!Sd())return;const t=(n,i,r)=>{const{rowCtrl:s,cellCtrl:o}=e.getControlsForEventTarget(r?.target??null);o?.column&&o.dispatchCellContextMenuEvent(r??null),this.beans.contextMenuSvc?.handleContextMenuMouseEvent(void 0,r,s,o)};this.mockContextMenu(e,e.element,t)}handleCellDoubleClick(e,t){return(()=>{if(!Sd()||Qte("dblclick"))return!1;const i=Date.now(),r=i-e.lastIPadMouseClickEvent<200;return e.lastIPadMouseClickEvent=i,r})()?(e.onCellDoubleClicked(t),t.preventDefault(),!0):!1}setupForHeader(e){const{gos:t,sortSvc:n}=this.beans;if(t.get("suppressTouch"))return;const{params:i,eMenu:r,eFilterButton:s}=e,o=new af(e.getGui(),!0),a=e.shouldSuppressMenuHide(),l=a&&me(r),u=l?new af(r,!0):o;if(i.enableMenu){const c=l?"tap":"longTap",d=h=>i.showColumnMenuAfterMouseClick(h.touchStart);e.addManagedListeners(u,{[c]:d})}if(i.enableSorting){const c=d=>{const h=d.touchStart.target;a&&(r?.contains(h)||s?.contains(h))||n?.progressSort(i.column,!1,"uiColumnSorted")};e.addManagedListeners(o,{tap:c})}if(i.enableFilterButton&&s){const c=new af(s,!0);e.addManagedListeners(c,{tap:()=>i.showFilter(s)}),e.addDestroyFunc(()=>c.destroy())}e.addDestroyFunc(()=>o.destroy()),l&&e.addDestroyFunc(()=>u.destroy())}setupForHeaderGroup(e,t,n){const i=new af(t,!0);e.addManagedListeners(i,{tap:n}),e.addDestroyFunc(()=>i.destroy())}mockContextMenu(e,t,n){if(!Sd())return;const i=new af(t),r=s=>{g0(this.gos,s.touchEvent)&&n(void 0,s.touchStart,s.touchEvent)};e.addManagedListeners(i,{longTap:r}),e.addDestroyFunc(()=>i.destroy())}},AJe={moduleName:"Touch",version:Ce,beans:[FJe]},DJe=class extends X{constructor(){super(...arguments),this.beanName="cellNavigation"}wireBeans(e){this.rowSpanSvc=e.rowSpanSvc}getNextCellToFocus(e,t,n=!1){return n?this.getNextCellToFocusWithCtrlPressed(e,t):this.getNextCellToFocusWithoutCtrlPressed(e,t)}getNextCellToFocusWithCtrlPressed(e,t){const n=e===K.UP,i=e===K.DOWN,r=e===K.LEFT;let s,o;const{pageBounds:a,gos:l,visibleCols:u}=this.beans;if(n||i)o=n?a.getFirstRow():a.getLastRow(),s=t.column;else{const c=l.get("enableRtl");o=t.rowIndex,s=(r!==c?u.allCols:[...u.allCols].reverse()).find(h=>this.isCellGoodToFocusOn({rowIndex:o,rowPinned:null,column:h}))}return s?{rowIndex:o,rowPinned:null,column:s}:null}getNextCellToFocusWithoutCtrlPressed(e,t){let n=t,i=!1;for(;!i;){switch(e){case K.UP:n=this.getCellAbove(n);break;case K.DOWN:n=this.getCellBelow(n);break;case K.RIGHT:n=this.gos.get("enableRtl")?this.getCellToLeft(n):this.getCellToRight(n);break;case K.LEFT:n=this.gos.get("enableRtl")?this.getCellToRight(n):this.getCellToLeft(n);break;default:n=null,ue(8,{key:e});break}n?i=this.isCellGoodToFocusOn(n):i=!0}return n}isCellGoodToFocusOn(e){const t=e.column;let n;const{pinnedRowModel:i,rowModel:r}=this.beans;switch(e.rowPinned){case"top":n=i?.getPinnedTopRow(e.rowIndex);break;case"bottom":n=i?.getPinnedBottomRow(e.rowIndex);break;default:n=r.getRow(e.rowIndex);break}return n?!this.isSuppressNavigable(t,n):!1}getCellToLeft(e){if(!e)return null;const t=this.beans.visibleCols.getColBefore(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellToRight(e){if(!e)return null;const t=this.beans.visibleCols.getColAfter(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellBelow(e){if(!e)return null;const t=this.rowSpanSvc?.getCellEnd(e)??e,n=nW(this.beans,t);return n?{rowIndex:n.rowIndex,column:e.column,rowPinned:n.rowPinned}:null}getCellAbove(e){if(!e)return null;const t=this.rowSpanSvc?.getCellStart(e)??e,n=t1(this.beans,{rowIndex:t.rowIndex,rowPinned:t.rowPinned});return n?{rowIndex:n.rowIndex,column:e.column,rowPinned:n.rowPinned}:null}getNextTabbedCell(e,t){return t?this.getNextTabbedCellBackwards(e):this.getNextTabbedCellForwards(e)}getNextTabbedCellForwards(e){const{visibleCols:t,pagination:n}=this.beans,i=t.allCols;let r=e.rowIndex,s=e.rowPinned,o=t.getColAfter(e.column);if(!o){o=i[0];const a=nW(this.beans,e);if(Wt(a)||!a.rowPinned&&!(n?.isRowInPage(a.rowIndex)??!0))return null;r=a?a.rowIndex:null,s=a?a.rowPinned:null}return{rowIndex:r,column:o,rowPinned:s}}getNextTabbedCellBackwards(e){const{beans:t}=this,{visibleCols:n,pagination:i}=t,r=n.allCols;let s=e.rowIndex,o=e.rowPinned,a=n.getColBefore(e.column);if(!a){a=Tt(r);const l=t1(t,{rowIndex:e.rowIndex,rowPinned:e.rowPinned});if(Wt(l)||!l.rowPinned&&!(i?.isRowInPage(l.rowIndex)??!0))return null;s=l?l.rowIndex:null,o=l?l.rowPinned:null}return{rowIndex:s,column:a,rowPinned:o}}isSuppressNavigable(e,t){const{suppressNavigable:n}=e.colDef;if(typeof n=="boolean")return n;if(typeof n=="function"){const i=e.createColumnFunctionCallbackParams(t);return n(i)}return!1}};function PJe(e){return e.focusSvc.getFocusedCell()}function kJe(e){return e.focusSvc.clearFocusedCell()}function TJe(e,t,n,i){e.focusSvc.setFocusedCell({rowIndex:t,column:n,rowPinned:i,forceBrowserFocus:!0})}function MJe(e,t){return e.navigation?.tabToNextCell(!1,t)??!1}function IJe(e,t){return e.navigation?.tabToNextCell(!0,t)??!1}function _Je(e,t,n=!1){const i=e.headerNavigation?.getHeaderPositionForColumn(t,n);i&&e.focusSvc.focusHeaderPosition({headerPosition:i})}var OJe=class extends X{constructor(){super(),this.beanName="navigation",this.onPageDown=j6(this.onPageDown,100),this.onPageUp=j6(this.onPageUp,100)}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl})}handlePageScrollingKey(e,t=!1){const n=e.key,i=e.altKey,r=e.ctrlKey||e.metaKey,s=!!this.beans.rangeSvc&&e.shiftKey,o=Gje(this.gos,e);let a=!1;switch(n){case K.PAGE_HOME:case K.PAGE_END:!r&&!i&&(this.onHomeOrEndKey(n),a=!0);break;case K.LEFT:case K.RIGHT:case K.UP:case K.DOWN:if(!o)return!1;r&&!i&&!s&&(this.onCtrlUpDownLeftRight(n,o),a=!0);break;case K.PAGE_DOWN:case K.PAGE_UP:!r&&!i&&(a=this.handlePageUpDown(n,o,t));break}return a&&e.preventDefault(),a}handlePageUpDown(e,t,n){return n&&(t=this.beans.focusSvc.getFocusedCell()),t?(e===K.PAGE_UP?this.onPageUp(t):this.onPageDown(t),!0):!1}navigateTo(e){const{scrollIndex:t,scrollType:n,scrollColumn:i,focusIndex:r,focusColumn:s}=e,{scrollFeature:o}=this.gridBodyCon;me(i)&&!i.isPinned()&&o.ensureColumnVisible(i),me(t)&&o.ensureIndexVisible(t,n),e.isAsync||o.ensureIndexVisible(r);const{focusSvc:a,rangeSvc:l}=this.beans;a.setFocusedCell({rowIndex:r,column:s,rowPinned:null,forceBrowserFocus:!0}),l?.setRangeToCell({rowIndex:r,rowPinned:null,column:s})}onPageDown(e){const t=this.beans,n=ND(t),i=this.getViewportHeight(),{pageBounds:r,rowModel:s,rowAutoHeight:o}=t,a=r.getPixelOffset(),l=n.top+i,u=s.getRowIndexAtPixel(l+a);o?.active?this.navigateToNextPageWithAutoHeight(e,u):this.navigateToNextPage(e,u)}onPageUp(e){const t=this.beans,n=ND(t),{pageBounds:i,rowModel:r,rowAutoHeight:s}=t,o=i.getPixelOffset(),a=n.top,l=r.getRowIndexAtPixel(a+o);s?.active?this.navigateToNextPageWithAutoHeight(e,l,!0):this.navigateToNextPage(e,l,!0)}navigateToNextPage(e,t,n=!1){const{pageBounds:i,rowModel:r}=this.beans,s=this.getViewportHeight(),o=i.getFirstRow(),a=i.getLastRow(),l=i.getPixelOffset(),u=r.getRow(e.rowIndex),c=n?u?.rowHeight-s-l:s-l,d=u?.rowTop+c;let h=r.getRowIndexAtPixel(d+l);if(h===e.rowIndex){const g=n?-1:1;t=h=e.rowIndex+g}let p;n?(p="bottom",h<o&&(h=o),t<o&&(t=o)):(p="top",h>a&&(h=a),t>a&&(t=a)),this.isRowTallerThanView(r.getRow(h))&&(t=h,p="top"),this.navigateTo({scrollIndex:t,scrollType:p,scrollColumn:null,focusIndex:h,focusColumn:e.column})}navigateToNextPageWithAutoHeight(e,t,n=!1){this.navigateTo({scrollIndex:t,scrollType:n?"bottom":"top",scrollColumn:null,focusIndex:t,focusColumn:e.column}),setTimeout(()=>{const i=this.getNextFocusIndexForAutoHeight(e,n);this.navigateTo({scrollIndex:t,scrollType:n?"bottom":"top",scrollColumn:null,focusIndex:i,focusColumn:e.column,isAsync:!0})},50)}getNextFocusIndexForAutoHeight(e,t=!1){const n=t?-1:1,i=this.getViewportHeight(),{pageBounds:r,rowModel:s}=this.beans,o=r.getLastRow();let a=0,l=e.rowIndex;for(;l>=0&&l<=o;){const u=s.getRow(l);if(u){const c=u.rowHeight??0;if(a+c>i)break;a+=c}l+=n}return Math.max(0,Math.min(l,o))}getViewportHeight(){const e=this.beans,t=ND(e),n=this.beans.scrollVisibleSvc.getScrollbarWidth();let i=t.bottom-t.top;return e.ctrlsSvc.get("center").isHorizontalScrollShowing()&&(i-=n),i}isRowTallerThanView(e){if(!e)return!1;const t=e.rowHeight;return typeof t!="number"?!1:t>this.getViewportHeight()}onCtrlUpDownLeftRight(e,t){const n=this.beans.cellNavigation.getNextCellToFocus(e,t,!0),{rowIndex:i}=n,r=n.column;this.navigateTo({scrollIndex:i,scrollType:null,scrollColumn:r,focusIndex:i,focusColumn:r})}onHomeOrEndKey(e){const t=e===K.PAGE_HOME,{visibleCols:n,pageBounds:i,rowModel:r}=this.beans,s=n.allCols,o=t?i.getFirstRow():i.getLastRow(),a=r.getRow(o);if(!a)return;const l=(t?s:[...s].reverse()).find(u=>!u.isSuppressNavigable(a));l&&this.navigateTo({scrollIndex:o,scrollType:null,scrollColumn:l,focusIndex:o,focusColumn:l})}onTabKeyDown(e,t){const n=t.shiftKey,i=this.tabToNextCellCommon(e,n,t),r=this.beans,{ctrlsSvc:s,pageBounds:o,focusSvc:a,gos:l}=r;if(i!==!1){i?t.preventDefault():i===null&&s.get("gridCtrl").allowFocusForNextCoreContainer(n);return}if(n){const{rowIndex:u,rowPinned:c}=e.getRowPosition();(c?u===0:u===o.getFirstRow())&&(l.get("headerHeight")===0||Ad(r)?Ap(r,!0,!0):(t.preventDefault(),a.focusPreviousFromFirstCell(t)))}else e instanceof hv&&e.focusCell(!0),(!n&&a.focusOverlay(!1)||Ap(r,n))&&t.preventDefault()}tabToNextCell(e,t){const n=this.beans,{focusSvc:i,rowRenderer:r}=n,s=i.getFocusedCell();if(!s)return!1;let o=Cf(n,s);return!o&&(o=r.getRowByPosition(s),!o||!o.isFullWidth())?!1:!!this.tabToNextCellCommon(o,e,t)}tabToNextCellCommon(e,t,n){let i=e.editing;if(!i&&e instanceof hv){const o=e.rowCtrl;o&&(i=o.editing)}let r;return i?this.gos.get("editType")==="fullRow"?r=this.moveToNextEditingRow(e,t,n):r=this.moveToNextEditingCell(e,t,n):r=this.moveToNextCellNotEditing(e,t,n),r===null?r:r||!!this.beans.focusSvc.focusedHeader}moveToNextEditingCell(e,t,n=null){const i=e.cellPosition;e.eGui.focus(),e.stopEditing();const r=this.findNextCellToFocusOn(i,t,!0);return r===!1?null:r==null?!1:(this.beans.editSvc?.startEditing(r,null,!0,n),r.focusCell(!1),!0)}moveToNextEditingRow(e,t,n=null){const i=e.cellPosition,r=this.findNextCellToFocusOn(i,t,!0);if(r===!1)return null;if(r==null)return!1;const s=r.cellPosition,o=this.isCellEditable(i),a=this.isCellEditable(s),l=s&&i.rowIndex===s.rowIndex&&i.rowPinned===s.rowPinned,{editSvc:u,rowEditSvc:c}=this.beans;if(o&&u?.setFocusOutOnEditor(e),!l){const d=e.rowCtrl;u?.stopRowEditing(d);const h=r.rowCtrl;c?.startEditing(h,void 0,void 0,n)}return a?(u?.setFocusInOnEditor(r),r.focusCell()):r.focusCell(!0),!0}moveToNextCellNotEditing(e,t,n){const i=this.beans.visibleCols.allCols;let r;if(e instanceof r1){if(r={...e.getRowPosition(),column:t?i[0]:Tt(i)},this.gos.get("embedFullWidthRows")&&n){const o=e.findFullWidthInfoForEvent(n);o&&(r.column=o.column)}}else r=e.getFocusedCellPosition();const s=this.findNextCellToFocusOn(r,t,!1);if(s===!1)return null;if(s instanceof hv)s.focusCell(!0);else if(s)return this.tryToFocusFullWidthRow(s,t);return me(s)}findNextCellToFocusOn(e,t,n){let i=e;const r=this.beans,{cellNavigation:s,gos:o,focusSvc:a,rowRenderer:l,rangeSvc:u}=r;for(;;){e!==i&&(e=i),t||(i=this.getLastCellOfColSpan(i)),i=s.getNextTabbedCell(i,t);const c=o.getCallback("tabToNextCell");if(me(c)){const g=c({backwards:t,editing:n,previousCellPosition:e,nextCellPosition:i||null});if(g===!0)i=e;else{if(g===!1)return!1;i={rowIndex:g.rowIndex,column:g.column,rowPinned:g.rowPinned}}}if(!i)return null;if(i.rowIndex<0){const p=la(r);return a.focusHeaderPosition({headerPosition:{headerRowIndex:p+i.rowIndex,column:i.column},fromCell:!0}),null}const d=o.get("editType")==="fullRow";if(n&&!d&&!this.isCellEditable(i))continue;this.ensureCellVisible(i);const h=Cf(r,i);if(!h){const p=l.getRowByPosition(i);if(!p||!p.isFullWidth()||n)continue;return{...p.getRowPosition(),column:i?.column}}if(!s.isSuppressNavigable(h.column,h.rowNode))return h.setFocusedCellPosition(i),u?.setRangeToCell(i),h}}isCellEditable(e){const t=this.lookupRowNodeForCell(e);return t?e.column.isCellEditable(t):!1}lookupRowNodeForCell({rowIndex:e,rowPinned:t}){const{pinnedRowModel:n,rowModel:i}=this.beans;return t==="top"?n?.getPinnedTopRow(e):t==="bottom"?n?.getPinnedBottomRow(e):i.getRow(e)}navigateToNextCell(e,t,n,i){let r=n,s=!1;const o=this.beans,{cellNavigation:a,focusSvc:l,gos:u}=o;for(;r&&(r===n||!this.isValidNavigateCell(r));)u.get("enableRtl")?t===K.LEFT&&(r=this.getLastCellOfColSpan(r)):t===K.RIGHT&&(r=this.getLastCellOfColSpan(r)),r=a.getNextCellToFocus(t,r),s=Wt(r);if(s&&e&&e.key===K.UP&&(r={rowIndex:-1,rowPinned:null,column:n.column}),i){const d=u.getCallback("navigateToNextCell");if(me(d)){const p=d({key:t,previousCellPosition:n,nextCellPosition:r||null,event:e});me(p)?r={rowPinned:p.rowPinned,rowIndex:p.rowIndex,column:p.column}:r=null}}if(!r)return;if(r.rowIndex<0){const d=la(o);l.focusHeaderPosition({headerPosition:{headerRowIndex:d+r.rowIndex,column:n.column},event:e||void 0,fromCell:!0});return}const c=this.getNormalisedPosition(r);c?this.focusPosition(c):this.tryToFocusFullWidthRow(r)}getNormalisedPosition(e){if(!!this.beans.spannedRowRenderer?.getCellByPosition(e))return e;this.ensureCellVisible(e);const n=Cf(this.beans,e);return n?(e=n.getFocusedCellPosition(),this.ensureCellVisible(e),e):null}tryToFocusFullWidthRow(e,t){const{visibleCols:n,rowRenderer:i,focusSvc:r,eventSvc:s}=this.beans,o=n.allCols,a=i.getRowByPosition(e);if(!a||!a.isFullWidth())return!1;const l=r.getFocusedCell(),u={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column||(t?Tt(o):o[0])};this.focusPosition(u);const c=t??(l!=null&&Wje(u,l));return s.dispatchEvent({type:"fullWidthRowFocused",rowIndex:u.rowIndex,rowPinned:u.rowPinned,column:u.column,isFullWidthCell:!0,fromBelow:c}),!0}focusPosition(e){const{focusSvc:t,rangeSvc:n}=this.beans;t.setFocusedCell({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0}),n?.setRangeToCell(e)}isValidNavigateCell(e){return!!e1(this.beans,e)}getLastCellOfColSpan(e){const t=Cf(this.beans,e);if(!t)return e;const n=t.getColSpanningList();return n.length===1?e:{rowIndex:e.rowIndex,column:Tt(n),rowPinned:e.rowPinned}}ensureCellVisible(e){const t=qte(this.gos),n=this.beans.rowModel.getRow(e.rowIndex),i=t&&n?.sticky,{scrollFeature:r}=this.gridBodyCon;!i&&Wt(e.rowPinned)&&r.ensureIndexVisible(e.rowIndex),e.column.isPinned()||r.ensureColumnVisible(e.column)}};function ND(e){return e.ctrlsSvc.getScrollFeature().getVScrollPosition()}var LJe={moduleName:"KeyboardNavigation",version:Ce,beans:[OJe,DJe,aJe],apiFunctions:{getFocusedCell:PJe,clearFocusedCell:kJe,setFocusedCell:TJe,setFocusedHeader:_Je,tabToNextCell:MJe,tabToPreviousCell:IJe}},NJe=class extends X{constructor(){super(...arguments),this.beanName="pageBoundsListener"}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this),recalculateRowBounds:this.calculatePages.bind(this)}),this.onModelUpdated()}onModelUpdated(e){this.calculatePages(),this.eventSvc.dispatchEvent({type:"paginationChanged",animate:e?.animate??!1,newData:e?.newData??!1,newPage:e?.newPage??!1,newPageSize:e?.newPageSize??!1,keepRenderedRows:e?.keepRenderedRows??!1})}calculatePages(){const{pageBounds:e,pagination:t,rowModel:n}=this.beans;t?t.calculatePages():e.calculateBounds(0,n.getRowCount()-1)}},$Je=class extends X{constructor(){super(...arguments),this.beanName="pageBounds",this.pixelOffset=0}getFirstRow(){return this.topRowBounds?.rowIndex??-1}getLastRow(){return this.bottomRowBounds?.rowIndex??-1}getCurrentPageHeight(){const{topRowBounds:e,bottomRowBounds:t}=this;return!e||!t?0:Math.max(t.rowTop+t.rowHeight-e.rowTop,0)}getCurrentPagePixelRange(){const{topRowBounds:e,bottomRowBounds:t}=this,n=e?.rowTop??0,i=t?t.rowTop+t.rowHeight:0;return{pageFirstPixel:n,pageLastPixel:i}}calculateBounds(e,t){const{rowModel:n}=this.beans,i=n.getRowBounds(e);i&&(i.rowIndex=e),this.topRowBounds=i;const r=n.getRowBounds(t);r&&(r.rowIndex=t),this.bottomRowBounds=r,this.calculatePixelOffset()}getPixelOffset(){return this.pixelOffset}calculatePixelOffset(){const e=this.topRowBounds?.rowTop??0;this.pixelOffset!==e&&(this.pixelOffset=e,this.eventSvc.dispatchEvent({type:"paginationPixelOffsetChanged"}))}},BJe=".ag-pinned-left-floating-bottom,.ag-pinned-left-floating-top,.ag-pinned-right-floating-bottom,.ag-pinned-right-floating-top{min-width:0;overflow:hidden;position:relative}.ag-pinned-left-sticky-top,.ag-pinned-right-sticky-top{height:100%;overflow:hidden;position:relative}.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{height:100%;overflow:hidden;width:100%}.ag-pinned-left-header,.ag-pinned-right-header{display:inline-block;height:100%;overflow:hidden;position:relative}.ag-body-horizontal-scroll:not(.ag-scrollbar-invisible){.ag-horizontal-left-spacer:not(.ag-scroller-corner){border-right:var(--ag-pinned-column-border)}.ag-horizontal-right-spacer:not(.ag-scroller-corner){border-left:var(--ag-pinned-column-border)}}.ag-pinned-right-header{border-left:var(--ag-pinned-column-border)}.ag-pinned-left-header{border-right:var(--ag-pinned-column-border)}.ag-cell.ag-cell-first-right-pinned:not(.ag-cell-range-left,.ag-cell-range-single-cell,.ag-cell-focus:not(.ag-cell-range-selected):focus-within){border-left:var(--ag-pinned-column-border)}.ag-cell.ag-cell-last-left-pinned:not(.ag-cell-range-right,.ag-cell-range-single-cell,.ag-cell-focus:not(.ag-cell-range-selected):focus-within){border-right:var(--ag-pinned-column-border)}.ag-pinned-left-header .ag-header-cell-resize:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}.ag-pinned-right-header .ag-header-cell-resize:after{left:50%}.ag-pinned-left-header .ag-header-cell-resize{right:-3px}.ag-pinned-right-header .ag-header-cell-resize{left:-3px}",GJe=class extends X{constructor(e,t){super(),this.isLeft=e,this.elements=t,this.getWidth=e?()=>this.beans.pinnedCols.leftWidth:()=>this.beans.pinnedCols.rightWidth}postConstruct(){this.addManagedEventListeners({[`${this.isLeft?"left":"right"}PinnedWidthChanged`]:this.onPinnedWidthChanged.bind(this)})}onPinnedWidthChanged(){const e=this.getWidth(),t=e>0;for(const n of this.elements)n&&(Yt(n,t),ga(n,e))}},zJe=class extends X{constructor(){super(...arguments),this.beanName="pinnedCols"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,t=>{this.gridBodyCtrl=t.gridBodyCtrl});const e=this.checkContainerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}checkContainerWidths(){const{gos:e,visibleCols:t,eventSvc:n}=this.beans,i=gi(e,"print"),r=i?0:t.getColsLeftWidth(),s=i?0:t.getDisplayedColumnsRightWidth();r!=this.leftWidth&&(this.leftWidth=r,n.dispatchEvent({type:"leftPinnedWidthChanged"})),s!=this.rightWidth&&(this.rightWidth=s,n.dispatchEvent({type:"rightPinnedWidthChanged"}))}keepPinnedColumnsNarrowerThanViewport(){const e=this.gridBodyCtrl.eBodyViewport,t=a0(e);if(t<=50)return;const n=this.getPinnedColumnsOverflowingViewport(t-50),i=this.gos.getCallback("processUnpinnedColumns"),{columns:r,hasLockedPinned:s}=n;let o=r;!o.length&&!s||(i&&(o=i({columns:o,viewportWidth:t})),!(!o||!o.length)&&(o=o.filter(a=>!Ep(a)),this.setColsPinned(o,null,"viewportSizeFeature")))}createPinnedWidthFeature(e,...t){return new GJe(e,t)}setColsPinned(e,t,n){const{colModel:i,colAnimation:r,visibleCols:s,gos:o}=this.beans;if(!i.cols||!e?.length)return;if(gi(o,"print")){ue(37);return}r?.start();let a;t===!0||t==="left"?a="left":t==="right"?a="right":a=null;const l=[];e.forEach(u=>{if(!u)return;const c=i.getCol(u);c&&c.getPinned()!==a&&(this.setColPinned(c,a),l.push(c))}),l.length&&(s.refresh(n),cne(this.eventSvc,l,n)),r?.finish()}initCol(e){const{pinned:t,initialPinned:n}=e.colDef;t!==void 0?this.setColPinned(e,t):this.setColPinned(e,n)}setColPinned(e,t){t===!0||t==="left"?e.pinned="left":t==="right"?e.pinned="right":e.pinned=null,e.dispatchStateUpdatedEvent("pinned")}setupHeaderPinnedWidth(e){const{scrollVisibleSvc:t}=this.beans;if(e.pinned==null)return;const n=e.pinned==="left",i=e.pinned==="right";e.hidden=!0;const r=()=>{const s=n?this.leftWidth:this.rightWidth;if(s==null)return;const o=s==0,a=e.hidden!==o,l=this.gos.get("enableRtl"),u=t.getScrollbarWidth(),d=t.verticalScrollShowing&&(l&&n||!l&&i)?s+u:s;e.comp.setPinnedContainerWidth(`${d}px`),e.comp.setDisplayed(!o),a&&(e.hidden=o,e.refresh())};e.addManagedEventListeners({leftPinnedWidthChanged:r,rightPinnedWidthChanged:r,scrollVisibilityChanged:r,scrollbarWidthChanged:r})}getHeaderResizeDiff(e,t){if(t.getPinned()){const{leftWidth:i,rightWidth:r}=this,s=a0(this.beans.ctrlsSvc.getGridBodyCtrl().eBodyViewport)-50;if(i+r+e>s)if(s>i+r)e=s-i-r;else return 0}return e}getPinnedColumnsOverflowingViewport(e){const t=this.rightWidth??0,n=this.leftWidth??0,i=t+n;let r=!1;if(i<e)return{columns:[],hasLockedPinned:r};const{visibleCols:s}=this.beans,o=[...s.leftCols],a=[...s.rightCols];let l=0,u=0;const c=0,d=[];let h=i-c-e;for(;(u<o.length||l<a.length)&&h>0;){if(l<a.length){const p=a[l++];if(p.colDef.lockPinned){r=!0;continue}h-=p.getActualWidth(),d.push(p)}if(u<o.length&&h>0){const p=o[u++];if(p.colDef.lockPinned){r=!0;continue}h-=p.getActualWidth(),d.push(p)}}return{columns:d,hasLockedPinned:r}}},HJe={moduleName:"PinnedColumn",version:Ce,beans:[zJe],css:[BJe]},VJe=class extends X{constructor(){super(),this.beanName="ariaAnnounce",this.descriptionContainer=null,this.pendingAnnouncements=new Map,this.lastAnnouncement="",this.updateAnnouncement=hi(this,this.updateAnnouncement.bind(this),200)}postConstruct(){const e=this.beans,t=Rn(e),n=this.descriptionContainer=t.createElement("div");n.classList.add("ag-aria-description-container"),Ste(n,"polite"),ZUe(n,"additions text"),JUe(n,!0),e.eGridDiv.appendChild(n)}announceValue(e,t){this.pendingAnnouncements.set(t,e),this.updateAnnouncement()}updateAnnouncement(){if(!this.descriptionContainer)return;const e=Array.from(this.pendingAnnouncements.values()).join(". ");this.pendingAnnouncements.clear(),this.descriptionContainer.textContent="",setTimeout(()=>{if(this.isAlive()&&this.descriptionContainer){let t=e;this.lastAnnouncement===t&&(t=`${t}.`),this.lastAnnouncement=t,this.descriptionContainer.textContent=t}},50)}destroy(){super.destroy();const{descriptionContainer:e}=this;e&&(Ii(e),e.parentElement?.removeChild(e)),this.descriptionContainer=null,this.pendingAnnouncements.clear()}},WJe={moduleName:"Aria",version:Ce,beans:[VJe]};function UJe(e){e.overlays?.showLoadingOverlay()}function jJe(e){e.overlays?.showNoRowsOverlay()}function qJe(e){e.overlays?.hideOverlay()}var KJe=".ag-overlay{inset:0;pointer-events:none;position:absolute;z-index:2}.ag-overlay-panel,.ag-overlay-wrapper{display:flex;height:100%;width:100%}.ag-overlay-wrapper{align-items:center;flex:none;justify-content:center;text-align:center}.ag-overlay-loading-wrapper{pointer-events:all}.ag-overlay-loading-center{background:var(--ag-background-color);border:1px solid var(--ag-border-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-popup-shadow);padding:var(--ag-spacing)}",YJe={tag:"div",cls:"ag-overlay",role:"presentation",children:[{tag:"div",cls:"ag-overlay-panel",role:"presentation",children:[{tag:"div",ref:"eOverlayWrapper",cls:"ag-overlay-wrapper",role:"presentation"}]}]},yie=class extends bt{constructor(){super(YJe),this.eOverlayWrapper=ge,this.activePromise=null,this.activeOverlay=null,this.updateListenerDestroyFunc=null,this.activeCssClass=null,this.elToFocusAfter=null,this.registerCSS(KJe)}handleKeyDown(e){if(e.key!==K.TAB||e.defaultPrevented||El(e))return;const t=this.beans;if(xh(t,this.eOverlayWrapper,!1,e.shiftKey))return;let i=!1;e.shiftKey?i=t.focusSvc.focusGridView({column:Tt(t.visibleCols.allCols),backwards:!0,canFocusOverlay:!1}):i=Ap(t,!1),i&&e.preventDefault()}updateLayoutClasses(e,t){const n=this.eOverlayWrapper.classList,{AUTO_HEIGHT:i,NORMAL:r,PRINT:s}=so;n.toggle(i,t.autoHeight),n.toggle(r,t.normal),n.toggle(s,t.print)}postConstruct(){this.createManagedBean(new bN(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.beans.overlays.setOverlayWrapperComp(this),this.addManagedElementListeners(this.getFocusableElement(),{keydown:this.handleKeyDown.bind(this)})}setWrapperTypeClass(e){const t=this.eOverlayWrapper.classList;this.activeCssClass&&t.toggle(this.activeCssClass,!1),this.activeCssClass=e,t.toggle(e,!0)}showOverlay(e,t,n,i){if(this.setWrapperTypeClass(t),this.destroyActiveOverlay(),this.elToFocusAfter=null,this.activePromise=e,!!e){if(this.setDisplayed(!0,{skipAriaHidden:!0}),n&&this.isGridFocused()){const r=Xt(this.beans);r&&!jte(this.beans)&&(this.elToFocusAfter=r)}e.then(r=>{if(this.activePromise!==e){this.activeOverlay!==r&&(this.destroyBean(r),r=null);return}if(this.activePromise=null,!!r){if(this.activeOverlay!==r&&(this.eOverlayWrapper.appendChild(r.getGui()),this.activeOverlay=r,i)){const s=r;this.updateListenerDestroyFunc=this.addManagedPropertyListener(i,({currentValue:o})=>{s.refresh?.(Ne(this.gos,{...o??{}}))})}n&&this.isGridFocused()&&eh(this.eOverlayWrapper)}})}}updateOverlayWrapperPaddingTop(e){this.eOverlayWrapper.style.setProperty("padding-top",`${e}px`)}destroyActiveOverlay(){this.activePromise=null;const e=this.activeOverlay;if(!e)return;let t=this.elToFocusAfter;this.activeOverlay=null,this.elToFocusAfter=null,t&&!this.isGridFocused()&&(t=null);const n=this.updateListenerDestroyFunc;n&&(n(),this.updateListenerDestroyFunc=null),this.destroyBean(e),Ii(this.eOverlayWrapper),t?.focus?.({preventScroll:!0})}hideOverlay(){this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})}isGridFocused(){const e=Xt(this.beans);return!!e&&this.beans.eGridDiv.contains(e)}destroy(){this.elToFocusAfter=null,this.destroyActiveOverlay(),this.beans.overlays.setOverlayWrapperComp(void 0),super.destroy()}},XJe={selector:"AG-OVERLAY-WRAPPER",component:yie},QJe=class extends X{constructor(){super(...arguments),this.beanName="overlays",this.state=0,this.showInitialOverlay=!0,this.wrapperPadding=0}postConstruct(){this.isClientSide=Xi(this.gos),this.isServerSide=!this.isClientSide&&mg(this.gos);const e=()=>this.updateOverlayVisibility();this.addManagedEventListeners({newColumnsLoaded:e,rowDataUpdated:e,gridSizeChanged:this.refreshWrapperPadding.bind(this),rowCountReady:()=>{this.showInitialOverlay=!1,this.updateOverlayVisibility()}}),this.addManagedPropertyListener("loading",e)}setOverlayWrapperComp(e){this.eWrapper=e,this.updateOverlayVisibility()}isVisible(){return this.state!==0&&!!this.eWrapper}isExclusive(){return this.state===1&&!!this.eWrapper}showLoadingOverlay(){this.showInitialOverlay=!1;const e=this.gos,t=e.get("loading");!t&&(t!==void 0||e.get("suppressLoadingOverlay"))||this.doShowLoadingOverlay()}showNoRowsOverlay(){this.showInitialOverlay=!1;const e=this.gos;e.get("loading")||e.get("suppressNoRowsOverlay")||this.doShowNoRowsOverlay()}hideOverlay(){if(this.showInitialOverlay=!1,this.gos.get("loading")){ue(99);return}this.doHideOverlay()}getOverlayWrapperSelector(){return XJe}getOverlayWrapperCompClass(){return yie}updateOverlayVisibility(){if(!this.eWrapper){this.state=0;return}const{state:e,isClientSide:t,isServerSide:n,beans:{gos:i,colModel:r,rowModel:s}}=this;let o=this.gos.get("loading");o!==void 0&&(this.showInitialOverlay=!1),this.showInitialOverlay&&o===void 0&&!i.get("suppressLoadingOverlay")&&(o=!i.get("columnDefs")||!r.ready||!i.get("rowData")&&t),o?e!==1&&this.doShowLoadingOverlay():(this.showInitialOverlay=!1,t&&s.isEmpty()&&!i.get("suppressNoRowsOverlay")?e!==2&&this.doShowNoRowsOverlay():(e===1||!n&&e!==0)&&this.doHideOverlay())}doShowLoadingOverlay(){this.eWrapper&&(this.state=1,this.showOverlay(nje(this.beans.userCompFactory,Ne(this.gos,{})),"ag-overlay-loading-wrapper","loadingOverlayComponentParams"),this.updateExclusive())}doShowNoRowsOverlay(){this.eWrapper&&(this.state=2,this.showOverlay(ije(this.beans.userCompFactory,Ne(this.gos,{})),"ag-overlay-no-rows-wrapper","noRowsOverlayComponentParams"),this.updateExclusive())}doHideOverlay(){this.eWrapper&&(this.state=0,this.eWrapper.hideOverlay(),this.updateExclusive())}showOverlay(e,t,n){const i=e?.newAgStackInstance()??null;this.eWrapper?.showOverlay(i,t,this.isExclusive(),n),this.refreshWrapperPadding()}updateExclusive(){const e=this.exclusive;this.exclusive=this.isExclusive(),this.exclusive!==e&&this.eventSvc.dispatchEvent({type:"overlayExclusiveChanged"})}refreshWrapperPadding(){const e=this.eWrapper;if(!e)return;let t=0;this.state===2?t=this.beans.ctrlsSvc.get("gridHeaderCtrl")?.headerHeight||0:this.wrapperPadding!==0&&(t=0),this.wrapperPadding!==t&&(this.wrapperPadding=t,e.updateOverlayWrapperPaddingTop(t))}},JJe={moduleName:"Overlay",version:Ce,userComponents:{agLoadingOverlay:rKe,agNoRowsOverlay:oKe},apiFunctions:{showLoadingOverlay:UJe,showNoRowsOverlay:jJe,hideOverlay:qJe},beans:[QJe]},ZJe=class extends X{constructor(){super(...arguments),this.beanName="rowContainerHeight",this.scrollY=0,this.uiBodyHeight=0}postConstruct(){this.addManagedEventListeners({bodyHeightChanged:this.updateOffset.bind(this)}),this.maxDivHeight=d9e(),ac(this.gos,"RowContainerHeightService - maxDivHeight = "+this.maxDivHeight)}updateOffset(){if(!this.stretching)return;const e=this.beans.ctrlsSvc.getScrollFeature().getVScrollPosition().top,t=this.getUiBodyHeight();(e!==this.scrollY||t!==this.uiBodyHeight)&&(this.scrollY=e,this.uiBodyHeight=t,this.calculateOffset())}calculateOffset(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;const e=this.scrollY/this.maxScrollY,t=e*this.pixelsToShave;ac(this.gos,`RowContainerHeightService - Div Stretch Offset = ${t} (${this.pixelsToShave} * ${e})`),this.setDivStretchOffset(t)}setUiContainerHeight(e){e!==this.uiContainerHeight&&(this.uiContainerHeight=e,this.eventSvc.dispatchEvent({type:"rowContainerHeightChanged"}))}clearOffset(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)}setDivStretchOffset(e){const t=typeof e=="number"?Math.floor(e):null;this.divStretchOffset!==t&&(this.divStretchOffset=t,this.eventSvc.dispatchEvent({type:"heightScaleChanged"}))}setModelHeight(e){this.modelHeight=e,this.stretching=e!=null&&this.maxDivHeight>0&&e>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()}getRealPixelPosition(e){return e-this.divStretchOffset}getUiBodyHeight(){const e=this.beans.ctrlsSvc.getScrollFeature().getVScrollPosition();return e.bottom-e.top}getScrollPositionForPixel(e){if(this.pixelsToShave<=0)return e;const t=this.modelHeight-this.getUiBodyHeight(),n=e/t;return this.maxScrollY*n}},eZe=400,tZe=class extends X{constructor(){super(...arguments),this.beanName="rowRenderer",this.destroyFuncsForColumnListeners=[],this.rowCtrlsByRowIndex={},this.zombieRowCtrls={},this.allRowCtrls=[],this.topRowCtrls=[],this.bottomRowCtrls=[],this.refreshInProgress=!1,this.dataFirstRenderedFired=!1,this.setupRangeSelectionListeners=()=>{const e=()=>{this.getAllCellCtrls().forEach(s=>s.onCellSelectionChanged())},t=()=>{this.getAllCellCtrls().forEach(s=>s.updateRangeBordersIfRangeCount())},n=()=>{this.eventSvc.addEventListener("cellSelectionChanged",e),this.eventSvc.addEventListener("columnMoved",t),this.eventSvc.addEventListener("columnPinned",t),this.eventSvc.addEventListener("columnVisible",t)},i=()=>{this.eventSvc.removeEventListener("cellSelectionChanged",e),this.eventSvc.removeEventListener("columnMoved",t),this.eventSvc.removeEventListener("columnPinned",t),this.eventSvc.removeEventListener("columnVisible",t)};this.addDestroyFunc(()=>i()),this.addManagedPropertyListeners(["enableRangeSelection","cellSelection"],()=>{Gl(this.gos)?n():i()}),Gl(this.gos)&&n()}}wireBeans(e){this.pageBounds=e.pageBounds,this.colModel=e.colModel,this.pinnedRowModel=e.pinnedRowModel,this.rowModel=e.rowModel,this.focusSvc=e.focusSvc,this.rowContainerHeight=e.rowContainerHeight,this.ctrlsSvc=e.ctrlsSvc}postConstruct(){this.ctrlsSvc.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.initialise()})}initialise(){this.addManagedEventListeners({paginationChanged:this.onPageLoaded.bind(this),pinnedRowDataChanged:this.onPinnedRowDataChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),bodyScroll:this.onBodyScroll.bind(this),bodyHeightChanged:this.redraw.bind(this,{})}),this.addManagedPropertyListeners(["domLayout","embedFullWidthRows"],()=>this.onDomLayoutChanged()),this.addManagedPropertyListeners(["suppressMaxRenderedRowRestriction","rowBuffer"],()=>this.redraw()),this.addManagedPropertyListener("suppressCellFocus",i=>this.onSuppressCellFocusChanged(i.currentValue)),this.addManagedPropertyListeners(["groupSuppressBlankHeader","getBusinessKeyForNode","fullWidthCellRenderer","fullWidthCellRendererParams","suppressStickyTotalRow","groupRowRenderer","groupRowRendererParams","loadingCellRenderer","loadingCellRendererParams","detailCellRenderer","detailCellRendererParams","enableRangeSelection","enableCellTextSelection"],()=>this.redrawRows()),this.addManagedPropertyListener("cellSelection",({currentValue:i,previousValue:r})=>{(!r&&i||r&&!i)&&this.redrawRows()});const{stickyRowSvc:e,gos:t,showRowGroupCols:n}=this.beans;if(n&&this.addManagedPropertyListener("showOpenedGroup",()=>{const i=n.getShowRowGroupCols();i.length&&this.refreshCells({columns:i,force:!0})}),e)this.stickyRowFeature=e.createStickyRowFeature(this,this.createRowCon.bind(this),this.destroyRowCtrls.bind(this));else{const i=this.gridBodyCtrl;i.setStickyTopHeight(0),i.setStickyBottomHeight(0)}this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=gi(t,"print"),this.embedFullWidthRows=this.printLayout||t.get("embedFullWidthRows"),this.redrawAfterModelUpdate()}initialiseCache(){if(this.gos.get("keepDetailRows")){const e=this.getKeepDetailRowsCount(),t=e??3;this.cachedRowCtrls=new nZe(t)}}getKeepDetailRowsCount(){return this.gos.get("keepDetailRowsCount")}getStickyTopRowCtrls(){return this.stickyRowFeature?.stickyTopRowCtrls??[]}getStickyBottomRowCtrls(){return this.stickyRowFeature?.stickyBottomRowCtrls??[]}updateAllRowCtrls(){const e=Object.values(this.rowCtrlsByRowIndex),t=Object.values(this.zombieRowCtrls),n=this.cachedRowCtrls?.getEntries()??[];t.length>0||n.length>0?this.allRowCtrls=[...e,...t,...n]:this.allRowCtrls=e}isCellBeingRendered(e,t){const n=this.rowCtrlsByRowIndex[e];return!t||!n?!!n:n.isFullWidth()?!0:!!this.beans.spannedRowRenderer?.getCellByPosition({rowIndex:e,column:t,rowPinned:null})||!!n.getCellCtrl(t)||!n.isRowRendered()}updateCellFocus(e){this.getAllCellCtrls().forEach(t=>t.onCellFocused(e)),this.getFullWidthRowCtrls().forEach(t=>t.onFullWidthRowFocused(e))}onCellFocusChanged(e){if(e&&e.rowIndex!=null&&!e.rowPinned){const t=this.beans.colModel.getCol(e.column)??void 0;this.isCellBeingRendered(e.rowIndex,t)||this.redraw()}this.updateCellFocus(e)}onSuppressCellFocusChanged(e){this.getAllCellCtrls().forEach(t=>t.onSuppressCellFocusChanged(e)),this.getFullWidthRowCtrls().forEach(t=>t.onSuppressCellFocusChanged(e))}registerCellEventListeners(){this.addManagedEventListeners({cellFocused:e=>this.onCellFocusChanged(e),cellFocusCleared:()=>this.updateCellFocus(),flashCells:e=>{const{cellFlashSvc:t}=this.beans;t&&this.getAllCellCtrls().forEach(n=>t.onFlashCells(n,e))},columnHoverChanged:()=>{this.getAllCellCtrls().forEach(e=>e.onColumnHover())},displayedColumnsChanged:()=>{this.getAllCellCtrls().forEach(e=>e.onDisplayedColumnsChanged())},displayedColumnsWidthChanged:()=>{this.printLayout&&this.getAllCellCtrls().forEach(e=>e.onLeftChanged())}}),this.setupRangeSelectionListeners(),this.refreshListenersToColumnsForCellComps(),this.addManagedEventListeners({gridColumnsChanged:this.refreshListenersToColumnsForCellComps.bind(this)}),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))}removeGridColumnListeners(){this.destroyFuncsForColumnListeners.forEach(e=>e()),this.destroyFuncsForColumnListeners.length=0}refreshListenersToColumnsForCellComps(){this.removeGridColumnListeners(),this.colModel.getCols().forEach(t=>{const n=l=>{this.getAllCellCtrls().forEach(u=>{u.column===t&&l(u)})},i=()=>{n(l=>l.onLeftChanged())},r=()=>{n(l=>l.onWidthChanged())},s=()=>{n(l=>l.onFirstRightPinnedChanged())},o=()=>{n(l=>l.onLastLeftPinnedChanged())},a=()=>{n(l=>l.onColDefChanged())};t.__addEventListener("leftChanged",i),t.__addEventListener("widthChanged",r),t.__addEventListener("firstRightPinnedChanged",s),t.__addEventListener("lastLeftPinnedChanged",o),t.__addEventListener("colDefChanged",a),this.destroyFuncsForColumnListeners.push(()=>{t.__removeEventListener("leftChanged",i),t.__removeEventListener("widthChanged",r),t.__removeEventListener("firstRightPinnedChanged",s),t.__removeEventListener("lastLeftPinnedChanged",o),t.__removeEventListener("colDefChanged",a)})})}onDomLayoutChanged(){const e=gi(this.gos,"print"),t=e||this.gos.get("embedFullWidthRows"),n=t!==this.embedFullWidthRows||this.printLayout!==e;this.printLayout=e,this.embedFullWidthRows=t,n&&this.redrawAfterModelUpdate({domLayoutChanged:!0})}datasourceChanged(){this.firstRenderedRow=0,this.lastRenderedRow=-1;const e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)}onPageLoaded(e){const t={recycleRows:e.keepRenderedRows,animate:e.animate,newData:e.newData,newPage:e.newPage,onlyBody:!0};this.redrawAfterModelUpdate(t)}getAllCellsNotSpanningForColumn(e){const t=[];return this.getAllRowCtrls().forEach(n=>{const i=n.getCellCtrl(e,!0)?.eGui;i&&t.push(i)}),t}refreshFloatingRowComps(){this.refreshFloatingRows(this.topRowCtrls,"top"),this.refreshFloatingRows(this.bottomRowCtrls,"bottom")}refreshFloatingRows(e,t){const{pinnedRowModel:n,beans:i,printLayout:r}=this,s=Object.fromEntries(e.map(a=>[a.rowNode.id,a]));n?.forEachPinnedRow(t,(a,l)=>{const u=e[l];u&&n.getPinnedRowById(u.rowNode.id,t)===void 0&&(u.destroyFirstPass(),u.destroySecondPass()),a.id in s?(e[l]=s[a.id],delete s[a.id]):e[l]=new r1(a,i,!1,!1,r)});const o=(t==="top"?n?.getPinnedTopRowCount():n?.getPinnedBottomRowCount())??0;e.length=o}onPinnedRowDataChanged(){const e={recycleRows:!0};this.redrawAfterModelUpdate(e)}redrawRow(e,t=!1){if(e.sticky)this.stickyRowFeature?.refreshStickyNode(e);else if(this.cachedRowCtrls?.has(e)){this.cachedRowCtrls.removeRow(e);return}else{const n=i=>{const r=i[e.rowIndex];r&&r.rowNode===e&&(r.destroyFirstPass(),r.destroySecondPass(),i[e.rowIndex]=this.createRowCon(e,!1,!1))};switch(e.rowPinned){case"top":n(this.topRowCtrls);break;case"bottom":n(this.bottomRowCtrls);break;default:n(this.rowCtrlsByRowIndex),this.updateAllRowCtrls()}}t||this.dispatchDisplayedRowsChanged(!1)}redrawRows(e){if(e!=null){e?.forEach(n=>this.redrawRow(n,!0)),this.dispatchDisplayedRowsChanged(!1);return}this.redrawAfterModelUpdate()}redrawAfterModelUpdate(e={}){this.getLockOnRefresh();const t=this.beans.focusSvc?.getFocusCellToUseAfterRefresh();this.updateContainerHeights(),this.scrollToTopIfNewData(e);const n=!e.domLayoutChanged&&!!e.recycleRows,i=e.animate&&Mf(this.gos),r=n?this.getRowsToRecycle():null;n||this.removeAllRowComps(),this.workOutFirstAndLastRowsToRender();const{stickyRowFeature:s}=this;if(s){s.checkStickyRows();const o=s.extraTopHeight+s.extraBottomHeight;o&&this.updateContainerHeights(o)}this.recycleRows(r,i),this.gridBodyCtrl.updateRowCount(),e.onlyBody||this.refreshFloatingRowComps(),this.dispatchDisplayedRowsChanged(),t!=null&&this.restoreFocusedCell(t),this.releaseLockOnRefresh()}scrollToTopIfNewData(e){const t=e.newData||e.newPage,n=this.gos.get("suppressScrollOnNewData");t&&!n&&(this.gridBodyCtrl.scrollFeature.scrollToTop(),this.stickyRowFeature?.resetOffsets())}updateContainerHeights(e=0){const{rowContainerHeight:t}=this;if(this.printLayout){t.setModelHeight(null);return}let n=this.pageBounds.getCurrentPageHeight();n===0&&(n=1),t.setModelHeight(n+e)}getLockOnRefresh(){if(this.refreshInProgress)throw new Error(Hu(252));this.refreshInProgress=!0,this.beans.frameworkOverrides.getLockOnRefresh?.()}releaseLockOnRefresh(){this.refreshInProgress=!1,this.beans.frameworkOverrides.releaseLockOnRefresh?.()}isRefreshInProgress(){return this.refreshInProgress}restoreFocusedCell(e){if(!e)return;const t=this.beans.focusSvc,n=this.findPositionToFocus(e);if(!n){t.focusHeaderPosition({headerPosition:{headerRowIndex:la(this.beans)-1,column:e.column}});return}if(e.rowIndex!==n.rowIndex||e.rowPinned!=n.rowPinned){t.setFocusedCell({...n,preventScrollOnBrowserFocus:!0,forceBrowserFocus:!0});return}t.doesRowOrCellHaveBrowserFocus()||this.updateCellFocus(Ne(this.gos,{...n,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,type:"cellFocused"}))}findPositionToFocus(e){const{pagination:t,pageBounds:n}=this.beans;let i=e;for(i.rowPinned==null&&t&&n&&!t.isRowInPage(i.rowIndex)&&(i={rowPinned:null,rowIndex:n.getFirstRow()});i;){if(i.rowPinned==null&&n)if(i.rowIndex<n.getFirstRow()){if(i=t1(this.beans,{rowPinned:null,rowIndex:0}),!i)return null}else i.rowIndex>n.getLastRow()&&(i={rowPinned:null,rowIndex:n.getLastRow()});const r=this.getRowByPosition(i);if(r?.isAlive())return{...r.getRowPosition(),column:e.column};i=t1(this.beans,i)}return null}getAllCellCtrls(){const e=[],t=this.getAllRowCtrls(),n=t.length;for(let i=0;i<n;i++){const r=t[i].getAllCellCtrls(),s=r.length;for(let o=0;o<s;o++)e.push(r[o])}return e}getAllRowCtrls(){const{spannedRowRenderer:e}=this.beans,t=this.getStickyTopRowCtrls(),n=this.getStickyBottomRowCtrls();return[...this.topRowCtrls,...this.bottomRowCtrls,...t,...n,...e?.getCtrls("top")??[],...e?.getCtrls("bottom")??[],...e?.getCtrls("center")??[],...Object.values(this.rowCtrlsByRowIndex)]}addRenderedRowListener(e,t,n){const i=this.rowCtrlsByRowIndex[t];i&&i.addEventListener(e,n)}refreshCells(e={}){const t={forceRefresh:e.force,newData:!1,suppressFlash:e.suppressFlash};for(const n of this.getCellCtrls(e.rowNodes,e.columns))n.refreshOrDestroyCell(t);this.refreshFullWidth(e.rowNodes)}refreshFullWidth(e){if(!e)return;let t=!1;for(const n of this.getRowCtrls(e)){if(!n.isFullWidth())continue;n.refreshFullWidth()||(t=!0,this.redrawRow(n.rowNode,!0))}t&&this.dispatchDisplayedRowsChanged(!1)}getRowCtrls(e){const t=HT(e),n=this.getAllRowCtrls();return!e||!t?n:n.filter(i=>{const r=i.rowNode;return VT(r,t)})}getCellCtrls(e,t){let n;me(t)&&(n={},t.forEach(r=>{const s=this.colModel.getCol(r);me(s)&&(n[s.getId()]=!0)}));const i=[];return this.getRowCtrls(e).forEach(r=>{r.getAllCellCtrls().forEach(s=>{const o=s.column.getId();n&&!n[o]||i.push(s)})}),i}destroy(){this.removeAllRowComps(!0),super.destroy()}removeAllRowComps(e=!1){const t=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(t,e),this.stickyRowFeature?.destroyStickyCtrls()}getRowsToRecycle(){const e=[];for(const n of Object.keys(this.rowCtrlsByRowIndex))this.rowCtrlsByRowIndex[n].rowNode.id==null&&e.push(n);this.removeRowCtrls(e);const t={};for(const n of Object.values(this.rowCtrlsByRowIndex)){const i=n.rowNode;t[i.id]=n}return this.rowCtrlsByRowIndex={},t}removeRowCtrls(e,t=!1){e.forEach(n=>{const i=this.rowCtrlsByRowIndex[n];i&&(i.destroyFirstPass(t),i.destroySecondPass()),delete this.rowCtrlsByRowIndex[n]})}onBodyScroll(e){e.direction==="vertical"&&this.redraw({afterScroll:!0})}redraw(e={}){const{focusSvc:t,animationFrameSvc:n}=this.beans,{afterScroll:i}=e;let r;const s=this.stickyRowFeature;s&&(r=t?.getFocusCellToUseAfterRefresh()||void 0);const o=this.firstRenderedRow,a=this.lastRenderedRow;this.workOutFirstAndLastRowsToRender();let l=!1;if(s){l=s.checkStickyRows();const c=s.extraTopHeight+s.extraBottomHeight;c&&this.updateContainerHeights(c)}const u=this.firstRenderedRow!==o||this.lastRenderedRow!==a;if(!(i&&!l&&!u)&&(this.getLockOnRefresh(),this.recycleRows(null,!1,i),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(i&&!l),r!=null)){const c=t?.getFocusCellToUseAfterRefresh();r!=null&&c==null&&(n?.flushAllFrames(),this.restoreFocusedCell(r))}}removeRowCompsNotToDraw(e,t){const n={};e.forEach(s=>n[s]=!0);const r=Object.keys(this.rowCtrlsByRowIndex).filter(s=>!n[s]);this.removeRowCtrls(r,t)}calculateIndexesToDraw(e){const t=[];for(let o=this.firstRenderedRow;o<=this.lastRenderedRow;o++)t.push(o);const n=this.beans.pagination,i=this.beans.focusSvc?.getFocusedCell()?.rowIndex;i!=null&&(i<this.firstRenderedRow||i>this.lastRenderedRow)&&(!n||n.isRowInPage(i))&&t.push(i);const r=o=>{const a=o.rowNode.rowIndex;a==null||a===i||(a<this.firstRenderedRow||a>this.lastRenderedRow)&&this.doNotUnVirtualiseRow(o)&&t.push(a)};for(const o of Object.values(this.rowCtrlsByRowIndex))r(o);if(e)for(const o of Object.values(e))r(o);t.sort((o,a)=>o-a);const s=[];for(let o=0;o<t.length;o++){const a=t[o],l=this.rowModel.getRow(a);l&&!l.sticky&&s.push(a)}return s}recycleRows(e,t=!1,n=!1){const i=this.calculateIndexesToDraw(e);if((this.printLayout||n)&&(t=!1),this.removeRowCompsNotToDraw(i,!t),i.forEach(r=>{this.createOrUpdateRowCtrl(r,e,t,n)}),e){const{animationFrameSvc:r}=this.beans;r?.active&&n&&!this.printLayout?r.addDestroyTask(()=>{this.destroyRowCtrls(e,t),this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}):this.destroyRowCtrls(e,t)}this.updateAllRowCtrls()}dispatchDisplayedRowsChanged(e=!1){this.eventSvc.dispatchEvent({type:"displayedRowsChanged",afterScroll:e})}onDisplayedColumnsChanged(){const{visibleCols:e}=this.beans,t=e.isPinningLeft(),n=e.isPinningRight();(this.pinningLeft!==t||n!==this.pinningRight)&&(this.pinningLeft=t,this.pinningRight=n,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())}redrawFullWidthEmbeddedRows(){const e=[];this.getFullWidthRowCtrls().forEach(t=>{const n=t.rowNode.rowIndex;e.push(n.toString())}),this.refreshFloatingRowComps(),this.removeRowCtrls(e),this.redraw({afterScroll:!0})}getFullWidthRowCtrls(e){const t=HT(e);return this.getAllRowCtrls().filter(n=>{if(!n.isFullWidth())return!1;const i=n.rowNode;return!(t!=null&&!VT(i,t))})}createOrUpdateRowCtrl(e,t,n,i){let r,s=this.rowCtrlsByRowIndex[e];if(s||(r=this.rowModel.getRow(e),me(r)&&me(t)&&t[r.id]&&r.alreadyRendered&&(s=t[r.id],t[r.id]=null)),!s)if(r||(r=this.rowModel.getRow(e)),me(r))s=this.createRowCon(r,n,i);else return;return r&&(r.alreadyRendered=!0),this.rowCtrlsByRowIndex[e]=s,s}destroyRowCtrls(e,t){const n=[];if(e){for(const i of Object.values(e))if(i){if(this.cachedRowCtrls&&i.isCacheable()){this.cachedRowCtrls.addRow(i);continue}if(i.destroyFirstPass(!t),t){const r=i.instanceId;this.zombieRowCtrls[r]=i,n.push(()=>{i.destroySecondPass(),delete this.zombieRowCtrls[r]})}else i.destroySecondPass()}}t&&(n.push(()=>{this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}),window.setTimeout(()=>n.forEach(i=>i()),eZe))}getRowBuffer(){return this.gos.get("rowBuffer")}getRowBufferInPixels(){const e=this.getRowBuffer(),t=Fd(this.beans);return e*t}workOutFirstAndLastRowsToRender(){const{rowContainerHeight:e,pageBounds:t,rowModel:n}=this;e.updateOffset();let i,r;if(!n.isRowsToRender())i=0,r=-1;else if(this.printLayout)this.beans.environment.refreshRowHeightVariable(),i=t.getFirstRow(),r=t.getLastRow();else{const c=this.getRowBufferInPixels(),d=this.ctrlsSvc.getScrollFeature(),h=this.gos.get("suppressRowVirtualisation");let p=!1,g,v;do{const x=t.getPixelOffset(),{pageFirstPixel:E,pageLastPixel:A}=t.getCurrentPagePixelRange(),F=e.divStretchOffset,k=d.getVScrollPosition(),P=k.top,_=k.bottom;h?(g=E+F,v=A+F):(g=Math.max(P+x-c,E)+F,v=Math.min(_+x+c,A)+F),this.firstVisibleVPixel=Math.max(P+x,E)+F,this.lastVisibleVPixel=Math.min(_+x,A)+F,p=this.ensureAllRowsInRangeHaveHeightsCalculated(g,v)}while(p);let C=n.getRowIndexAtPixel(g),y=n.getRowIndexAtPixel(v);const b=t.getFirstRow(),S=t.getLastRow();C<b&&(C=b),y>S&&(y=S),i=C,r=y}const s=gi(this.gos,"normal"),o=this.gos.get("suppressMaxRenderedRowRestriction"),a=Math.max(this.getRowBuffer(),500);s&&!o&&r-i>a&&(r=i+a);const l=i!==this.firstRenderedRow,u=r!==this.lastRenderedRow;(l||u)&&(this.firstRenderedRow=i,this.lastRenderedRow=r,this.eventSvc.dispatchEvent({type:"viewportChanged",firstRow:i,lastRow:r}))}dispatchFirstDataRenderedEvent(){this.dataFirstRenderedFired||(this.dataFirstRenderedFired=!0,eu(this.beans,()=>{this.beans.eventSvc.dispatchEvent({type:"firstDataRendered",firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow})}))}ensureAllRowsInRangeHaveHeightsCalculated(e,t){const n=this.pinnedRowModel?.ensureRowHeightsValid(),i=this.stickyRowFeature?.ensureRowHeightsValid(),{pageBounds:r,rowModel:s}=this,o=s.ensureRowHeightsValid(e,t,r.getFirstRow(),r.getLastRow());return(o||i)&&this.eventSvc.dispatchEvent({type:"recalculateRowBounds"}),i||o||n?(this.updateContainerHeights(),!0):!1}doNotUnVirtualiseRow(e){const i=e.rowNode,r=this.focusSvc.isRowFocused(i.rowIndex,i.rowPinned),s=e.editing,o=i.detail;return r||s||o?!!this.isRowPresent(i):!1}isRowPresent(e){return this.rowModel.isRowPresent(e)?this.beans.pagination?.isRowInPage(e.rowIndex)??!0:!1}createRowCon(e,t,n){const i=this.cachedRowCtrls?.getRow(e)??null;if(i)return i;const r=n&&!this.printLayout&&!!this.beans.animationFrameSvc?.active;return new r1(e,this.beans,t,r,this.printLayout)}getRenderedNodes(){const e=Object.values(this.rowCtrlsByRowIndex).map(i=>i.rowNode),t=this.getStickyTopRowCtrls().map(i=>i.rowNode),n=this.getStickyBottomRowCtrls().map(i=>i.rowNode);return[...t,...e,...n]}getRowByPosition(e){let t;const{rowIndex:n}=e;switch(e.rowPinned){case"top":t=this.topRowCtrls[n];break;case"bottom":t=this.bottomRowCtrls[n];break;default:t=this.rowCtrlsByRowIndex[n],t||(t=this.getStickyTopRowCtrls().find(i=>i.rowNode.rowIndex===n)||null,t||(t=this.getStickyBottomRowCtrls().find(i=>i.rowNode.rowIndex===n)||null));break}return t}isRangeInRenderedViewport(e,t){if(e==null||t==null)return!1;const i=e>this.lastRenderedRow;return!(t<this.firstRenderedRow)&&!i}},nZe=class{constructor(e){this.entriesMap={},this.entriesList=[],this.maxCount=e}addRow(e){if(this.entriesMap[e.rowNode.id]=e,this.entriesList.push(e),e.setCached(!0),this.entriesList.length>this.maxCount){const t=this.entriesList[0];t.destroyFirstPass(),t.destroySecondPass(),this.removeFromCache(t)}}getRow(e){if(e==null||e.id==null)return null;const t=this.entriesMap[e.id];return t?(this.removeFromCache(t),t.setCached(!1),t.rowNode!=e?null:t):null}has(e){return this.entriesMap[e.id]!=null}removeRow(e){const t=e.id,n=this.entriesMap[t];delete this.entriesMap[t],Ao(this.entriesList,n)}removeFromCache(e){const t=e.rowNode.id;delete this.entriesMap[t],Ao(this.entriesList,e)}getEntries(){return this.entriesList}};function HT(e){if(!e)return;const t={top:{},bottom:{},normal:{}};return e.forEach(n=>{const i=n.id;switch(n.rowPinned){case"top":t.top[i]=n;break;case"bottom":t.bottom[i]=n;break;default:t.normal[i]=n;break}}),t}function VT(e,t){const n=e.id;switch(e.rowPinned){case"top":return t.top[n]!=null;case"bottom":return t.bottom[n]!=null;default:return t.normal[n]!=null}}var iZe=class extends X{constructor(){super(...arguments),this.beanName="rowNodeSorter"}postConstruct(){const{gos:e}=this;this.isAccentedSort=e.get("accentedSort"),this.primaryColumnsSortGroups=sa(e),this.addManagedPropertyListener("accentedSort",t=>this.isAccentedSort=t.currentValue),this.addManagedPropertyListener("autoGroupColumnDef",()=>this.primaryColumnsSortGroups=sa(e))}doFullSort(e,t){const n=e.map((i,r)=>({currentPos:r,rowNode:i}));return n.sort(this.compareRowNodes.bind(this,t)),n.map(i=>i.rowNode)}compareRowNodes(e,t,n){const i=t.rowNode,r=n.rowNode;for(let s=0,o=e.length;s<o;s++){const a=e[s],l=a.sort==="desc",u=this.getValue(i,a.column),c=this.getValue(r,a.column);let d;const h=this.getComparator(a,i);if(h?d=h(u,c,i,r,l):d=C9e(u,c,this.isAccentedSort),!isNaN(d)&&d!==0)return a.sort==="asc"?d:d*-1}return t.currentPos-n.currentPos}getComparator(e,t){const n=e.column,i=n.getColDef().comparator;if(i!=null)return i;if(!n.getColDef().showRowGroup)return;const r=!t.group&&n.getColDef().field;if(!r)return;const s=this.beans.colModel.getColDefCol(r);if(s)return s.getColDef().comparator}getValue(e,t){const{valueSvc:n,colModel:i,showRowGroupCols:r,gos:s}=this.beans;if(!this.primaryColumnsSortGroups)return n.getValue(t,e,!1);if(e.rowGroupColumn===t){if(pN(s,i.isPivotActive())){const u=e.allLeafChildren?.[0];return u?n.getValue(t,u,!1):void 0}const l=r?.getShowRowGroupCol(t.getId());return l?e.groupData?.[l.getId()]:void 0}if(!(e.group&&t.getColDef().showRowGroup))return n.getValue(t,e,!1)}};function rZe(e){e.sortSvc?.onSortChanged("api")}var gm=(e,t)=>({tag:"span",ref:`eSort${e}`,cls:`ag-sort-indicator-icon ag-sort-${t} ag-hidden`,attrs:{"aria-hidden":"true"}}),sZe={tag:"span",cls:"ag-sort-indicator-container",children:[gm("Order","order"),gm("Asc","ascending-icon"),gm("Desc","descending-icon"),gm("Mixed","mixed-icon"),gm("None","none-icon")]},ON=class extends bt{constructor(e){super(),this.eSortOrder=ge,this.eSortAsc=ge,this.eSortDesc=ge,this.eSortMixed=ge,this.eSortNone=ge,e||this.setTemplate(sZe)}attachCustomElements(e,t,n,i,r){this.eSortOrder=e,this.eSortAsc=t,this.eSortDesc=n,this.eSortMixed=i,this.eSortNone=r}setupSort(e,t=!1){if(this.column=e,this.suppressOrder=t,this.setupMultiSortIndicator(),!e.isSortable()&&!e.getColDef().showRowGroup)return;this.addInIcon("sortAscending",this.eSortAsc,e),this.addInIcon("sortDescending",this.eSortDesc,e),this.addInIcon("sortUnSort",this.eSortNone,e);const n=this.updateIcons.bind(this),i=this.onSortChanged.bind(this);this.addManagedPropertyListener("unSortIcon",n),this.addManagedEventListeners({newColumnsLoaded:n,sortChanged:i,columnRowGroupChanged:i}),this.onSortChanged()}addInIcon(e,t,n){if(t==null)return;const i=As(e,this.beans,n);i&&t.appendChild(i)}onSortChanged(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()}updateIcons(){const{eSortAsc:e,eSortDesc:t,eSortNone:n,column:i,gos:r,beans:s}=this,o=s.sortSvc.getDisplaySortForColumn(i);if(e&&Yt(e,o==="asc",{skipAriaHidden:!0}),t&&Yt(t,o==="desc",{skipAriaHidden:!0}),n){const a=!i.getColDef().unSortIcon&&!r.get("unSortIcon"),l=o==null;Yt(n,!a&&l,{skipAriaHidden:!0})}}setupMultiSortIndicator(){const{eSortMixed:e,column:t,gos:n}=this;this.addInIcon("sortUnSort",e,t);const i=t.getColDef().showRowGroup;sa(n)&&i&&(this.addManagedEventListeners({sortChanged:this.updateMultiSortIndicator.bind(this),columnRowGroupChanged:this.updateMultiSortIndicator.bind(this)}),this.updateMultiSortIndicator())}updateMultiSortIndicator(){const{eSortMixed:e,beans:t,column:n}=this;if(e){const i=t.sortSvc.getDisplaySortForColumn(n)==="mixed";Yt(e,i,{skipAriaHidden:!0})}}updateSortOrder(){const{eSortOrder:e,column:t,beans:{sortSvc:n}}=this;if(!e)return;const i=n.getColumnsWithSortingOrdered(),r=n.getDisplaySortIndexForColumn(t)??-1,s=i.some(a=>n.getDisplaySortIndexForColumn(a)??!1),o=r>=0&&s;Yt(e,o,{skipAriaHidden:!0}),r>=0?e.textContent=(r+1).toString():Ii(e)}},oZe={selector:"AG-SORT-INDICATOR",component:ON},m0=["asc","desc",null],aZe=class extends X{constructor(){super(...arguments),this.beanName="sortSvc"}progressSort(e,t,n){const i=this.getNextSortDirection(e);this.setSortForColumn(e,i,t,n)}progressSortFromEvent(e,t){const i=this.gos.get("multiSortKey")==="ctrl"?t.ctrlKey||t.metaKey:t.shiftKey;this.progressSort(e,i,"uiColumnSorted")}setSortForColumn(e,t,n,i){t!=="asc"&&t!=="desc"&&(t=null);const{gos:r,showRowGroupCols:s}=this.beans,o=sa(r);let a=[e];if(o&&e.getColDef().showRowGroup){const d=s?.getSourceColumnsForGroupColumn?.(e)?.filter(h=>h.isSortable());d&&(a=[e,...d])}a.forEach(c=>this.setColSort(c,t,i));const l=(n||r.get("alwaysMultiSort"))&&!r.get("suppressMultiSort"),u=[];if(!l){const c=this.clearSortBarTheseColumns(a,i);u.push(...c)}this.updateSortIndex(e),u.push(...a),this.dispatchSortChangedEvents(i,u)}updateSortIndex(e){const{gos:t,colModel:n,showRowGroupCols:i}=this.beans,r=sa(t),s=i?.getShowRowGroupCol(e.getId()),o=r&&s||e,a=this.getColumnsWithSortingOrdered();n.forAllCols(c=>this.setColSortIndex(c,null));const l=a.filter(c=>r&&c.getColDef().showRowGroup?!1:c!==o);(o.getSort()?[...l,o]:l).forEach((c,d)=>this.setColSortIndex(c,d))}onSortChanged(e,t){this.dispatchSortChangedEvents(e,t)}isSortActive(){let e=!1;return this.beans.colModel.forAllCols(t=>{t.getSort()&&(e=!0)}),e}dispatchSortChangedEvents(e,t){const n={type:"sortChanged",source:e};t&&(n.columns=t),this.eventSvc.dispatchEvent(n)}clearSortBarTheseColumns(e,t){const n=[];return this.beans.colModel.forAllCols(i=>{e.includes(i)||(i.getSort()&&n.push(i),this.setColSort(i,void 0,t))}),n}getNextSortDirection(e){const t=e.getColDef().sortingOrder??this.gos.get("sortingOrder")??m0,n=t.indexOf(e.getSort()),i=n<0,r=n==t.length-1;return i||r?t[0]:t[n+1]}getIndexedSortMap(){const{gos:e,colModel:t,showRowGroupCols:n,rowGroupColsSvc:i}=this.beans;let r=[];if(t.forAllCols(u=>{u.getSort()&&r.push(u)}),t.isPivotMode()){const u=sa(e);r=r.filter(c=>{const d=!!c.getAggFunc(),h=!c.isPrimary(),p=u?n?.getShowRowGroupCol(c.getId()):c.getColDef().showRowGroup;return d||h||p})}const s=i?.columns.filter(u=>!!u.getSort())??[],o={};r.forEach((u,c)=>o[u.getId()]=c),r.sort((u,c)=>{const d=u.getSortIndex(),h=c.getSortIndex();if(d!=null&&h!=null)return d-h;if(d==null&&h==null){const p=o[u.getId()],g=o[c.getId()];return p>g?1:-1}else return h==null?-1:1});const a=sa(e)&&!!s.length;a&&(r=[...new Set(r.map(u=>n?.getShowRowGroupCol(u.getId())??u))]);const l=new Map;return r.forEach((u,c)=>l.set(u,c)),a&&s.forEach(u=>{const c=n.getShowRowGroupCol(u.getId());l.set(u,l.get(c))}),l}getColumnsWithSortingOrdered(){return[...this.getIndexedSortMap().entries()].sort(([,e],[,t])=>e-t).map(([e])=>e)}getSortModel(){return this.getColumnsWithSortingOrdered().filter(e=>e.getSort()).map(e=>({sort:e.getSort(),colId:e.getId()}))}getSortOptions(){return this.getColumnsWithSortingOrdered().filter(e=>e.getSort()).map(e=>({sort:e.getSort(),column:e}))}canColumnDisplayMixedSort(e){const t=sa(this.gos),n=!!e.getColDef().showRowGroup;return t&&n}getDisplaySortForColumn(e){const t=this.beans.showRowGroupCols?.getSourceColumnsForGroupColumn(e);if(!this.canColumnDisplayMixedSort(e)||!t?.length)return e.getSort();const i=e.getColDef().field!=null||!!e.getColDef().valueGetter?[e,...t]:t,r=i[0].getSort();return i.every(o=>o.getSort()==r)?r:"mixed"}getDisplaySortIndexForColumn(e){return this.getIndexedSortMap().get(e)}setupHeader(e,t,n){let i=0;e.addManagedListeners(t,{movingChanged:()=>{i=Date.now()}}),n&&e.addManagedElementListeners(n,{click:s=>{const o=t.isMoving(),l=Date.now()-i<50;o||l||this.progressSortFromEvent(t,s)}});const r=()=>{const s=t.getSort();if(e.addOrRemoveCssClass("ag-header-cell-sorted-asc",s==="asc"),e.addOrRemoveCssClass("ag-header-cell-sorted-desc",s==="desc"),e.addOrRemoveCssClass("ag-header-cell-sorted-none",!s),t.getColDef().showRowGroup){const l=!this.beans.showRowGroupCols?.getSourceColumnsForGroupColumn(t)?.every(u=>t.getSort()==u.getSort());e.addOrRemoveCssClass("ag-header-cell-sorted-mixed",l)}};e.addManagedEventListeners({sortChanged:r,columnRowGroupChanged:r})}initCol(e){const{sort:t,initialSort:n,sortIndex:i,initialSortIndex:r}=e.colDef;t!==void 0?(t==="asc"||t==="desc")&&(e.sort=t):(n==="asc"||n==="desc")&&(e.sort=n),i!==void 0?i!==null&&(e.sortIndex=i):r!==null&&(e.sortIndex=r)}updateColSort(e,t,n){t!==void 0&&(t==="desc"||t==="asc"?this.setColSort(e,t,n):this.setColSort(e,void 0,n))}setColSort(e,t,n){e.sort!==t&&(e.sort=t,e.dispatchColEvent("sortChanged",n)),e.dispatchStateUpdatedEvent("sort")}setColSortIndex(e,t){e.sortIndex=t,e.dispatchStateUpdatedEvent("sortIndex")}createSortIndicator(e){return new ON(e)}getSortIndicatorSelector(){return oZe}},wie={moduleName:"Sort",version:Ce,beans:[aZe,iZe],apiFunctions:{onSortChanged:rZe},userComponents:{agSortIndicator:ON},icons:{sortAscending:"asc",sortDescending:"desc",sortUnSort:"none"}},lZe=class extends X{constructor(){super(...arguments),this.beanName="syncSvc",this.waitingForColumns=!1}postConstruct(){this.addManagedPropertyListener("columnDefs",e=>this.setColumnDefs(e))}start(){this.beans.ctrlsSvc.whenReady(this,()=>{const e=this.gos.get("columnDefs");e?this.setColumnsAndData(e):this.waitingForColumns=!0,this.gridReady()})}setColumnsAndData(e){const{colModel:t,rowModel:n}=this.beans;t.setColumnDefs(e??[],"gridInitializing"),n.start()}gridReady(){const{eventSvc:e,gos:t}=this;e.dispatchEvent({type:"gridReady"}),ac(t,`initialised successfully, enterprise = ${t.isModuleRegistered("EnterpriseCore")}`)}setColumnDefs(e){const t=this.gos.get("columnDefs");if(t){if(this.waitingForColumns){this.waitingForColumns=!1,this.setColumnsAndData(t);return}this.beans.colModel.setColumnDefs(t,_f(e.source))}}};function uZe(e){e.valueCache?.expire()}function cZe(e,t){const{colKey:n,rowNode:i,useFormatter:r}=t,s=e.colModel.getColDefCol(n)??e.colModel.getCol(n);if(Wt(s))return null;const o=e.valueSvc.getValueForDisplay(s,i);return r?e.valueSvc.formatValue(s,i,o)??Fl(o,!0):o}var o1=class{constructor(e,t){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=e,this.pathRoot={rowNode:t,children:null},this.mapToItems[t.id]=this.pathRoot}depthFirstSearchChangedPath(e,t){const{rowNode:n,children:i}=e;if(i)for(let r=0;r<i.length;++r)this.depthFirstSearchChangedPath(i[r],t);t(n)}depthFirstSearchEverything(e,t,n){const i=e.childrenAfterGroup;if(i)for(let r=0,s=i.length;r<s;++r){const o=i[r];o.childrenAfterGroup?this.depthFirstSearchEverything(o,t,n):n&&t(o)}t(e)}forEachChangedNodeDepthFirst(e,t=!1,n=!1){this.active&&!n?this.depthFirstSearchChangedPath(this.pathRoot,e):this.depthFirstSearchEverything(this.pathRoot.rowNode,e,t)}executeFromRootNode(e){e(this.pathRoot.rowNode)}createPathItems(e){let t=e,n=0;for(;!this.mapToItems[t.id];){const i={rowNode:t,children:null};this.mapToItems[t.id]=i,n++,t=t.parent}return n}populateColumnsMap(e,t){if(!this.keepingColumns||!t)return;let n=e;for(;n;)this.nodeIdsToColumns[n.id]||(this.nodeIdsToColumns[n.id]={}),t.forEach(i=>this.nodeIdsToColumns[n.id][i.getId()]=!0),n=n.parent}linkPathItems(e,t){let n=e;for(let i=0;i<t;i++){const r=this.mapToItems[n.id],s=this.mapToItems[n.parent.id];s.children||(s.children=[]),s.children.push(r),n=n.parent}}addParentNode(e,t){if(!e||e.isRowPinned())return;const n=this.createPathItems(e);this.linkPathItems(e,n),this.populateColumnsMap(e,t)}canSkip(e){return this.active&&!this.mapToItems[e.id]}getValueColumnsForNode(e,t){if(!this.keepingColumns)return t;const n=this.nodeIdsToColumns[e.id];return t.filter(r=>n[r.getId()])}getNotValueColumnsForNode(e,t){if(!this.keepingColumns)return null;const n=this.nodeIdsToColumns[e.id];return t.filter(r=>!n[r.getId()])}},dZe="paste",hZe=class extends X{constructor(){super(...arguments),this.beanName="changeDetectionSvc",this.clientSideRowModel=null}postConstruct(){const{gos:e,rowModel:t}=this.beans;Xi(e)&&(this.clientSideRowModel=t),this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this)})}onCellValueChanged(e){const{gos:t,rowRenderer:n}=this.beans;if(e.source===dZe||t.get("suppressChangeDetection"))return;const i=e.node,r=[i],s=this.clientSideRowModel,o=s?.rootNode;if(o&&!i.isRowPinned()){const a=t.get("aggregateOnlyChangedColumns"),l=new o1(a,o);l.addParentNode(i.parent,[e.column]),s.doAggregate(l),l.forEachChangedNodeDepthFirst(u=>{r.push(u),u.sibling&&r.push(u.sibling)})}n.refreshCells({rowNodes:r})}},fZe=class extends X{constructor(){super(...arguments),this.beanName="expressionSvc",this.cache={}}evaluate(e,t){if(typeof e=="string")return this.evaluateExpression(e,t);wt(15,{expression:e})}evaluateExpression(e,t){try{return this.createExpressionFunction(e)(t.value,t.context,t.oldValue,t.newValue,t.value,t.node,t.data,t.colDef,t.rowIndex,t.api,t.getValue,t.column,t.columnGroup)}catch(n){return wt(16,{expression:e,params:t,e:n}),null}}createExpressionFunction(e){const t=this.cache;if(t[e])return t[e];const n=this.createFunctionBody(e),i=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, getValue, column, columnGroup",n);return t[e]=i,i}createFunctionBody(e){return e.indexOf("return")>=0?e:"return "+e+";"}},pZe=class extends X{constructor(){super(...arguments),this.beanName="valueCache",this.cacheVersion=0}postConstruct(){const e=this.gos;this.active=e.get("valueCache"),this.neverExpires=e.get("valueCacheNeverExpires")}onDataChanged(){this.neverExpires||this.expire()}expire(){this.cacheVersion++}setValue(e,t,n){if(this.active){const i=this.cacheVersion;e.__cacheVersion!==i&&(e.__cacheVersion=i,e.__cacheData={}),e.__cacheData[t]=n}}getValue(e,t){if(!(!this.active||e.__cacheVersion!==this.cacheVersion))return e.__cacheData[t]}},gZe={moduleName:"ValueCache",version:Ce,beans:[pZe],apiFunctions:{expireValueCache:uZe}},mZe={moduleName:"Expression",version:Ce,beans:[fZe]},vZe={moduleName:"ChangeDetection",version:Ce,beans:[hZe]},CZe={moduleName:"CellApi",version:Ce,apiFunctions:{getCellValue:cZe}},yZe=class extends X{constructor(){super(...arguments),this.beanName="valueSvc",this.initialised=!1,this.isSsrm=!1}wireBeans(e){this.expressionSvc=e.expressionSvc,this.colModel=e.colModel,this.valueCache=e.valueCache,this.dataTypeSvc=e.dataTypeSvc}postConstruct(){this.initialised||this.init()}init(){this.executeValueGetter=this.valueCache?this.executeValueGetterWithValueCache.bind(this):this.executeValueGetterWithoutValueCache.bind(this),this.isSsrm=mg(this.gos),this.cellExpressions=this.gos.get("enableCellExpressions"),this.isTreeData=this.gos.get("treeData"),this.initialised=!0;const e=t=>this.callColumnCellValueChangedHandler(t);this.eventSvc.addEventListener("cellValueChanged",e,!0),this.addDestroyFunc(()=>this.eventSvc.removeEventListener("cellValueChanged",e,!0)),this.addManagedPropertyListener("treeData",t=>this.isTreeData=t.currentValue)}getValueForDisplay(e,t){const n=e.getColDef().showRowGroup;if(n!=null){if(typeof n=="string"){const l=this.getDisplayedNode(t,e,!0);if(l)return this.getValue(e,l)}const a=this.getValue(e,t);if(a==null){const l=this.getDisplayedNode(t,e);if(l)return this.getValue(e,l)}return a}const i=t.leafGroup&&this.colModel.isPivotMode(),r=t.group&&t.expanded&&!t.footer&&!i,s=this.gos.get("groupSuppressBlankHeader")||!t.sibling,o=r&&!s;return this.getValue(e,t,o)}getValue(e,t,n=!1){if(this.initialised||this.init(),!t)return;const i=e.getColDef(),r=i.field,s=e.getColId(),o=t.data;let a;const l=i.showRowGroup;if(typeof l=="string"&&(this.beans.rowGroupColsSvc?.getColumnIndex(l)??-1)>t.level)return null;const u=t.groupData&&t.groupData[s]!==void 0,c=!n&&t.aggData&&t.aggData[s]!==void 0,d=this.isSsrm&&n&&!!e.getColDef().aggFunc,h=this.isSsrm&&t.footer&&t.field&&(e.getColDef().showRowGroup===!0||e.getColDef().showRowGroup===t.field);if(this.isTreeData&&c?a=t.aggData[s]:this.isTreeData&&i.valueGetter?a=this.executeValueGetter(i.valueGetter,o,e,t):this.isTreeData&&r&&o?a=dv(o,r,e.isFieldContainsDots()):u?a=t.groupData[s]:c?a=t.aggData[s]:i.valueGetter?a=this.executeValueGetter(i.valueGetter,o,e,t):h?a=dv(o,t.field,e.isFieldContainsDots()):r&&o&&!d&&(a=dv(o,r,e.isFieldContainsDots())),this.cellExpressions&&typeof a=="string"&&a.indexOf("=")===0){const p=a.substring(1);a=this.executeValueGetter(p,o,e,t)}return a}parseValue(e,t,n,i){const r=e.getColDef(),s=r.valueParser;if(me(s)){const o=Ne(this.gos,{node:t,data:t?.data,oldValue:i,newValue:n,colDef:r,column:e});return typeof s=="function"?s(o):this.expressionSvc?.evaluate(s,o)}return n}getDeleteValue(e,t){return me(e.getColDef().valueParser)?this.parseValue(e,t,"",this.getValueForDisplay(e,t))??null:null}formatValue(e,t,n,i,r=!0){let s=null,o;const a=e.getColDef();if(i?o=i:r&&(o=a.valueFormatter),o){const l=Ne(this.gos,{value:n,node:t,data:t?t.data:null,colDef:a,column:e});typeof o=="function"?s=o(l):s=this.expressionSvc?this.expressionSvc.evaluate(o,l):null}else if(a.refData)return a.refData[n]||"";return s==null&&Array.isArray(n)&&(s=n.join(", ")),s}getDisplayedNode(e,t,n=!1){const i=this.gos,r=i.get("groupHideOpenParents"),s=i.get("showOpenedGroup")&&!n;if(!r&&!s)return;const o=t.colDef.showRowGroup;if(o===!0)return e.group?void 0:e.parent??void 0;let a=e;for(;a&&a.rowGroupColumn?.getId()!=o;){const l=a===a.parent?.childrenAfterSort?.[0];if(!s&&!l)return;a=a.parent}if(a!==e)return a??void 0}setValue(e,t,n,i){const r=this.colModel.getColDefCol(t);if(!e||!r)return!1;Wt(e.data)&&(e.data={});const{field:s,valueSetter:o}=r.getColDef();if(Wt(s)&&Wt(o))return ue(17),!1;if(this.dataTypeSvc&&!this.dataTypeSvc.checkType(r,n))return ue(135),!1;const a=Ne(this.gos,{node:e,data:e.data,oldValue:this.getValue(r,e),newValue:n,colDef:r.getColDef(),column:r});a.newValue=n;let l;if(me(o)?typeof o=="function"?l=o(a):l=this.expressionSvc?.evaluate(o,a):l=this.setValueUsingField(e.data,s,n,r.isFieldContainsDots()),l===void 0&&(l=!0),!l)return!1;e.resetQuickFilterAggregateText(),this.valueCache?.onDataChanged();const u=this.getValue(r,e);return this.eventSvc.dispatchEvent({type:"cellValueChanged",event:null,rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:a.column,colDef:a.colDef,data:e.data,node:e,oldValue:a.oldValue,newValue:u,value:u,source:i}),!0}callColumnCellValueChangedHandler(e){const t=e.colDef.onCellValueChanged;typeof t=="function"&&this.beans.frameworkOverrides.wrapOutgoing(()=>{t({node:e.node,data:e.data,oldValue:e.oldValue,newValue:e.newValue,colDef:e.colDef,column:e.column,api:e.api,context:e.context})})}setValueUsingField(e,t,n,i){if(!t)return!1;let r=!1;if(!i)r=e[t]===n,r||(e[t]=n);else{const s=t.split(".");let o=e;for(;s.length>0&&o;){const a=s.shift();s.length===0?(r=o[a]===n,r||(o[a]=n)):o=o[a]}}return!r}executeValueGetterWithValueCache(e,t,n,i){const r=n.getColId(),s=this.valueCache.getValue(i,r);if(s!==void 0)return s;const o=this.executeValueGetterWithoutValueCache(e,t,n,i);return this.valueCache.setValue(i,r,o),o}executeValueGetterWithoutValueCache(e,t,n,i){const r=Ne(this.gos,{data:t,node:i,column:n,colDef:n.getColDef(),getValue:this.getValueCallback.bind(this,i)});let s;return typeof e=="function"?s=e(r):s=this.expressionSvc?.evaluate(e,r),s}getValueCallback(e,t){const n=this.colModel.getColDefCol(t);return n?this.getValue(n,e):null}getKeyForNode(e,t){const n=this.getValue(e,t),i=e.getColDef().keyCreator;let r=n;if(i){const s=Ne(this.gos,{value:n,colDef:e.getColDef(),column:e,node:t,data:t.data});r=i(s)}return typeof r=="string"||r==null||(r=String(r),r==="[object Object]"&&ue(121)),r}},wZe={moduleName:"CommunityCore",version:Ce,beans:[hJe,lYe,eQe,F7e,ZJe,gXe,oJe,mJe,x7e,$Je,NJe,tZe,yZe,cJe,sJe,dJe,nQe,lZe,YXe,XXe],icons:{selectOpen:"small-down",smallDown:"small-down",colorPicker:"color-picker",smallUp:"small-up",checkboxChecked:"small-up",checkboxIndeterminate:"checkbox-indeterminate",checkboxUnchecked:"checkbox-unchecked",radioButtonOn:"radio-button-on",radioButtonOff:"radio-button-off",smallLeft:"small-left",smallRight:"small-right"},apiFunctions:{getGridId:uYe,destroy:cYe,isDestroyed:dYe,getGridOption:hYe,setGridOption:fYe,updateGridOptions:Jne},dependsOn:[UXe,qYe,eXe,wie,SJe,vXe,xJe,JJe,vZe,EJe,LJe,HJe,WJe,AJe,ZXe,jXe,mZe]},LN=class td{static applyGlobalGridOptions(t){if(!td.gridOptions)return{...t};let n={};return ir(n,td.gridOptions,!0,!0),td.mergeStrategy==="deep"?ir(n,t,!0,!0):n={...n,...t},td.gridOptions.context&&(n.context=td.gridOptions.context),t.context&&(td.mergeStrategy==="deep"&&n.context&&ir(t.context,n.context,!0,!0),n.context=t.context),n}};LN.gridOptions=void 0;LN.mergeStrategy="shallow";var bZe=LN;function SZe(e,t,n){if(!t)return wt(11),{};const i=n;let r;if(!i?.setThemeOnGridDiv){const o=Cn({tag:"div"});o.style.height="100%",e.appendChild(o),e=o,r=()=>e.remove()}return new RZe().create(e,t,o=>{const a=new oYe(e);o.createBean(a)},void 0,n,r)}var xZe=1,RZe=class{create(e,t,n,i,r,s){const o=bZe.applyGlobalGridOptions(t),a=o.gridId??String(xZe++),l=o.rowModelType??"clientSide",u=this.getRegisteredModules(r,a,l),c=this.createBeansList(l,u,a),d=this.createProvidedBeans(e,o,r);if(!c)return;const h={providedBeanInstances:d,beanClasses:c,gridId:a,beanInitComparator:VKe,beanDestroyComparator:WKe,derivedBeans:[zKe],destroyCallback:s},p=new mje(h);return this.registerModuleFeatures(p,u),n(p),p.getBean("syncSvc").start(),i&&i(p),p.getBean("gridApi")}getRegisteredModules(e,t,n){return p0(wZe,void 0),e?.modules?.forEach(i=>p0(i,t)),hje(t,n)}registerModuleFeatures(e,t){const n=e.getBean("registry"),i=e.getBean("apiFunctionSvc");t.forEach(r=>{n.registerModule(r);const s=r.apiFunctions;s&&Object.keys(s).forEach(a=>{i?.addFunction(a,s[a])})})}createProvidedBeans(e,t,n){let i=n?n.frameworkOverrides:null;Wt(i)&&(i=new Xne);const r={gridOptions:t,eGridDiv:e,globalListener:n?n.globalListener:null,globalSyncListener:n?n.globalSyncListener:null,frameworkOverrides:i};return n&&n.providedBeanInstances&&Object.assign(r,n.providedBeanInstances),r}createBeansList(e,t,n){const r={clientSide:"ClientSideRowModel",infinite:"InfiniteRowModel",serverSide:"ServerSideRowModel",viewport:"ViewportRowModel"}[e];if(!r){DT(201,{rowModelType:e},`Unknown rowModelType ${e}.`);return}if(!Cne(r,n,e)){DT(200,{reasonOrId:`rowModelType = '${e}'`,moduleName:r,gridScoped:yN(),gridId:n,rowModelType:e},`Missing module ${r}Module for rowModelType ${e}. 
If upgrading from before v33, see ${Rd}/upgrading-to-ag-grid-33/#changes-to-modules/`);return}const s=new Set;return t.forEach(o=>o.beans?.forEach(a=>s.add(a))),Array.from(s)}};function Ga(e){const t=e.rowModel;return t.getType()==="clientSide"?t:void 0}function NR(e){const t=e.rowModel;return t.getType()==="infinite"?t:void 0}function bie(e){const t=e.rowModel;return t.getType()==="serverSide"?t:void 0}var EZe=["columnEverythingChanged","newColumnsLoaded","columnPivotModeChanged","pivotMaxColumnsExceeded","columnRowGroupChanged","expandOrCollapseAll","columnPivotChanged","gridColumnsChanged","columnValueChanged","columnMoved","columnVisible","columnPinned","columnGroupOpened","columnResized","displayedColumnsChanged","virtualColumnsChanged","columnHeaderMouseOver","columnHeaderMouseLeave","columnHeaderClicked","columnHeaderContextMenu","asyncTransactionsFlushed","rowGroupOpened","rowDataUpdated","pinnedRowDataChanged","rangeSelectionChanged","cellSelectionChanged","chartCreated","chartRangeSelectionChanged","chartOptionsChanged","chartDestroyed","toolPanelVisibleChanged","toolPanelSizeChanged","modelUpdated","cutStart","cutEnd","pasteStart","pasteEnd","fillStart","fillEnd","cellSelectionDeleteStart","cellSelectionDeleteEnd","rangeDeleteStart","rangeDeleteEnd","undoStarted","undoEnded","redoStarted","redoEnded","cellClicked","cellDoubleClicked","cellMouseDown","cellContextMenu","cellValueChanged","cellEditRequest","rowValueChanged","headerFocused","cellFocused","rowSelected","selectionChanged","tooltipShow","tooltipHide","cellKeyDown","cellMouseOver","cellMouseOut","filterChanged","filterModified","filterOpened","advancedFilterBuilderVisibleChanged","sortChanged","virtualRowRemoved","rowClicked","rowDoubleClicked","gridReady","gridPreDestroyed","gridSizeChanged","viewportChanged","firstDataRendered","dragStarted","dragStopped","dragCancelled","rowEditingStarted","rowEditingStopped","cellEditingStarted","cellEditingStopped","bodyScroll","bodyScrollEnd","paginationChanged","componentStateChanged","storeRefreshed","stateUpdated","columnMenuVisibleChanged","contextMenuVisibleChanged","rowDragEnter","rowDragMove","rowDragLeave","rowDragEnd","rowDragCancel","findChanged"],FZe=["scrollbarWidthChanged","keyShortcutChangedCellStart","keyShortcutChangedCellEnd","pinnedHeightChanged","cellFocusCleared","fullWidthRowFocused","checkboxChanged","heightScaleChanged","suppressMovableColumns","suppressMenuHide","suppressFieldDotNotation","columnPanelItemDragStart","columnPanelItemDragEnd","bodyHeightChanged","columnContainerWidthChanged","displayedColumnsWidthChanged","scrollVisibilityChanged","scrollGapChanged","columnHoverChanged","flashCells","paginationPixelOffsetChanged","displayedRowsChanged","leftPinnedWidthChanged","rightPinnedWidthChanged","rowContainerHeightChanged","headerHeightChanged","columnGroupHeaderHeightChanged","columnHeaderHeightChanged","gridStylesChanged","storeUpdated","filterDestroyed","rowDataUpdateStarted","rowCountReady","advancedFilterEnabledChanged","dataTypesInferred","fieldValueChanged","fieldPickerValueSelected","richSelectListRowSelected","sideBarUpdated","alignedGridScroll","alignedGridColumn","gridOptionsChanged","chartTitleEdit","recalculateRowBounds","stickyTopOffsetChanged","overlayExclusiveChanged","beforeRefreshModel","rowNodeDataChanged"],Sie=[...EZe,...FZe],AZe=class extends X{constructor(){super(...arguments),this.beanName="localeSvc"}getLocaleTextFunc(){const e=this.gos,t=e.getCallback("getLocaleText");if(t)return(i,r,s)=>t({key:i,defaultValue:r,variableValues:s});const n=e.get("localeText");return(i,r,s)=>{let o=n&&n[i];if(o&&s&&s.length){let a=0;for(;!(a>=s.length||o.indexOf("${variable}")===-1);)o=o.replace("${variable}",s[a++])}return o??r}}},DZe=["overlayLoadingTemplate","overlayNoRowsTemplate","gridId","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","groupDisplayType","treeDataDisplayType","treeDataChildrenField","treeDataParentIdField","colResizeDefault","tooltipTrigger","serverSidePivotResultFieldSeparator","columnMenu","tooltipShowMode","grandTotalRow","themeCssLayer","findSearchValue","styleNonce"],PZe=["components","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","dragAndDropImageComponentParams","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent","themeStyleContainer","statusBar","chartThemeOverrides","customChartThemes","chartToolPanelsDef","dataTypeDefinitions","advancedFilterParent","advancedFilterBuilderParams","initialState","autoSizeStrategy","selectionColumnDef","findOptions"],kZe=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass","paginationPageSizeSelector"],xie=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","groupLockGroupColumns","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","pivotDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDuration","cellFadeDuration","tabIndex","pivotMaxGeneratedColumns"],TZe=["theme","rowSelection"],MZe=["cellSelection","sideBar","rowNumbers","suppressGroupChangesColumnVisibility","groupAggFiltering","suppressStickyTotalRow","groupHideParentOfSingleChild"],Rie=["loadThemeGoogleFonts","suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellFocus","suppressHeaderFocus","suppressHorizontalScroll","groupSelectsChildren","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressColumnMoveAnimation","suppressMoveWhenColumnDragging","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","allowContextMenuWithControlKey","suppressContextMenu","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","alwaysAggregateAtRootLevel","suppressFocusAfterRefresh","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","enableCellSpan","suppressClickEdit","rowDragEntireRow","rowDragManaged","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","includeHiddenColumnsInQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","includeHiddenColumnsInAdvancedFilter","suppressMultiRangeSelection","enterNavigatesVerticallyAfterEdit","enterNavigatesVertically","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","tooltipInteraction","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideSortAllLevels","serverSideEnableClientSideSort","serverSideOnlyRefreshFilteredGroups","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","groupMaintainOrder","columnHoverHighlight","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","suppressGroupRowsSticky","suppressCutToClipboard","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","enableAdvancedFilter","masterDetail","treeData","reactiveCustomComponents","applyQuickFilterBeforePivotOrAgg","suppressServerSideFullWidthLoadingRow","suppressAdvancedFilterEval","loading","maintainColumnOrder","enableStrictPivotColumnOrder","suppressSetFilterByDefault"],IZe=["doesExternalFilterPass","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","rowDragText","groupRowRenderer","dragAndDropImageComponent","fullWidthCellRenderer","loadingCellRenderer","loadingOverlayComponent","noRowsOverlayComponent","detailCellRenderer","quickFilterParser","quickFilterMatcher","getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","isFullWidthRow","sendToClipboard","focusGridInnerElement","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processUnpinnedColumns","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","loadingCellRendererSelector","getRowId","chartMenuItems","groupTotalRow","alwaysPassFilter"],WT=[...kZe,...PZe,...DZe,...xie,...IZe,...Rie,...MZe,...TZe],_Ze=class{wrap(e,t,n,i){const r=this.createWrapper(e,i);return t?.forEach(s=>{this.createMethod(r,s,!0)}),n?.forEach(s=>{this.createMethod(r,s,!1)}),r}createMethod(e,t,n){e.addMethod(t,this.createMethodProxy(e,t,n))}createMethodProxy(e,t,n){return function(){return e.hasMethod(t)?e.callMethod(t,arguments):(n&&ue(49,{methodName:t}),null)}}},OZe={tag:"div",cls:"ag-tooltip"},LZe=class extends Cg{constructor(){super(OZe)}init(e){const{value:t}=e;this.getGui().textContent=Fl(t,!0)}};function Eie(e){const{inputValue:t,allSuggestions:n,hideIrrelevant:i,filterByPercentageOfBestMatch:r}=e;let s=n.map((l,u)=>({value:l,relevance:NZe(t,l),idx:u}));if(s.sort((l,u)=>u.relevance-l.relevance),i&&(s=s.filter(l=>l.relevance!==0)),s.length>0&&r&&r>0){const u=s[0].relevance*r;s=s.filter(c=>u-c.relevance<0)}const o=[],a=[];for(const l of s)o.push(l.value),a.push(l.idx);return{values:o,indices:a}}function NZe(e,t){if(e===t)return 1e3;const n=e.length,i=t.length;if(n===0||i===0)return 0;const r=e.toLocaleLowerCase(),s=t.toLocaleLowerCase(),o=s.indexOf(r);if(o!==-1)return 980-o*2;if([...r].filter(d=>s.includes(d)).length===0)return 0;let l=Array.from({length:i+1},(d,h)=>h);for(let d=0;d<n;d++){const h=[d+1];for(let p=0;p<i;p++){const g=l[p+1]+1,v=h[p]+1;let C=l[p]+(e[d]!==t[p]?1:0);i>10&&p>i/2&&(C+=1),d>0&&p>0&&e[d-1]===t[p-1]&&(C-=4),h.push(Math.min(g,v,C))}l=h}const u=Math.round(l[i]),c=Math.max(1,1e3-u*30);return Math.max(1,c)}function $Ze(e,t){if(typeof e!="number")return"";const n=t(),i=n("thousandSeparator",","),r=n("decimalSeparator",".");return e.toString().replace(".",r).replace(/(\d)(?=(\d{3})+(?!\d))/g,`$1${i}`)}var BZe=class extends X{getFileName(e){const t=this.getDefaultFileExtension();return(e==null||!e.length)&&(e=this.getDefaultFileName()),e.indexOf(".")===-1?`${e}.${t}`:e}getData(e){const t=this.createSerializingSession(e);return this.beans.gridSerializer.serialize(t,e)}getDefaultFileName(){return`export.${this.getDefaultFileExtension()}`}},GZe=class{constructor(e){this.groupColumns=[];const{colModel:t,rowGroupColsSvc:n,colNames:i,valueSvc:r,gos:s,processCellCallback:o,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:u}=e;this.colModel=t,this.rowGroupColsSvc=n,this.colNames=i,this.valueSvc=r,this.gos=s,this.processCellCallback=o,this.processHeaderCallback=a,this.processGroupHeaderCallback=l,this.processRowGroupCallback=u}prepare(e){this.groupColumns=e.filter(t=>!!t.getColDef().showRowGroup)}extractHeaderValue(e){return this.getHeaderName(this.processHeaderCallback,e)??""}extractRowCellValue(e,t,n,i,r){const o=(!this.gos.get("groupHideOpenParents")||r.footer)&&this.shouldRenderGroupSummaryCell(r,e,t)?this.createValueForGroupNode(e,r):this.valueSvc.getValueForDisplay(e,r);return this.processCell({accumulatedRowIndex:n,rowNode:r,column:e,value:o,processCellCallback:this.processCellCallback,type:i})}shouldRenderGroupSummaryCell(e,t,n){if(!(e.group&&!this.gos.get("treeData")))return!1;if(this.groupColumns.indexOf(t)!==-1){if(e.groupData?.[t.getId()]!==void 0||mg(this.gos)&&e.group)return!0;if(e.footer&&e.level===-1){const o=t.getColDef();return o==null||o.showRowGroup===!0||o.showRowGroup===this.rowGroupColsSvc?.columns[0].getId()}}const s=pN(this.gos,this.colModel.isPivotMode());return n===0&&s}getHeaderName(e,t){return e?e(Ne(this.gos,{column:t})):this.colNames.getDisplayNameForColumn(t,"csv",!0)}createValueForGroupNode(e,t){if(this.processRowGroupCallback)return this.processRowGroupCallback(Ne(this.gos,{column:e,node:t}));const n=this.gos.get("treeData"),i=a=>{if(n)return a.key;const l=a.groupData?.[e.getId()];return!l||!a.rowGroupColumn||a.rowGroupColumn.getColDef().useValueFormatterForExport===!1?l:this.valueSvc.formatValue(a.rowGroupColumn,a,l)??l},r=t.footer,s=[i(t)];if(!_9e(this.gos))for(;t.parent;)t=t.parent,s.push(i(t));const o=s.reverse().join(" -> ");return r?`Total ${o}`:o}processCell(e){const{accumulatedRowIndex:t,rowNode:n,column:i,value:r,processCellCallback:s,type:o}=e;return s?{value:s(Ne(this.gos,{accumulatedRowIndex:t,column:i,node:n,value:r,type:o,parseValue:a=>this.valueSvc.parseValue(i,n,a,this.valueSvc.getValue(i,n)),formatValue:a=>this.valueSvc.formatValue(i,n,a)??a}))??""}:i.getColDef().useValueFormatterForExport!==!1?{value:r??"",valueFormatted:this.valueSvc.formatValue(i,n,r)}:{value:r??""}}};function zZe(e,t){const n=document.defaultView||window;if(!n){ue(52);return}const i=document.createElement("a"),r=n.URL.createObjectURL(t);i.setAttribute("href",r),i.setAttribute("download",e),i.style.display="none",document.body.appendChild(i),i.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:n})),document.body.removeChild(i),n.setTimeout(()=>{n.URL.revokeObjectURL(r)},0)}var HZe={enableBrowserTooltips:!0,tooltipTrigger:!0,tooltipMouseTrack:!0,tooltipShowMode:!0,tooltipInteraction:!0,defaultColGroupDef:!0,suppressAutoSize:!0,skipHeaderOnAutoSize:!0,autoSizeStrategy:!0,components:!0,stopEditingWhenCellsLoseFocus:!0,undoRedoCellEditing:!0,undoRedoCellEditingLimit:!0,excelStyles:!0,cacheQuickFilter:!0,customChartThemes:!0,chartThemeOverrides:!0,chartToolPanelsDef:!0,loadingCellRendererSelector:!0,localeText:!0,keepDetailRows:!0,keepDetailRowsCount:!0,detailRowHeight:!0,detailRowAutoHeight:!0,tabIndex:!0,valueCache:!0,valueCacheNeverExpires:!0,enableCellExpressions:!0,suppressTouch:!0,suppressBrowserResizeObserver:!0,suppressPropertyNamesCheck:!0,debug:!0,dragAndDropImageComponent:!0,loadingOverlayComponent:!0,suppressLoadingOverlay:!0,noRowsOverlayComponent:!0,paginationPageSizeSelector:!0,paginateChildRows:!0,pivotPanelShow:!0,pivotSuppressAutoColumn:!0,suppressExpandablePivotGroups:!0,aggFuncs:!0,allowShowChangeAfterFilter:!0,ensureDomOrder:!0,enableRtl:!0,suppressColumnVirtualisation:!0,suppressMaxRenderedRowRestriction:!0,suppressRowVirtualisation:!0,rowDragText:!0,groupLockGroupColumns:!0,suppressGroupRowsSticky:!0,rowModelType:!0,cacheOverflowSize:!0,infiniteInitialRowCount:!0,serverSideInitialRowCount:!0,maxBlocksInCache:!0,maxConcurrentDatasourceRequests:!0,blockLoadDebounceMillis:!0,serverSideOnlyRefreshFilteredGroups:!0,serverSidePivotResultFieldSeparator:!0,viewportRowModelPageSize:!0,viewportRowModelBufferSize:!0,debounceVerticalScrollbar:!0,suppressAnimationFrame:!0,suppressPreventDefaultOnMouseWheel:!0,scrollbarWidth:!0,icons:!0,suppressRowTransform:!0,gridId:!0,enableGroupEdit:!0,initialState:!0,processUnpinnedColumns:!0,createChartContainer:!0,getLocaleText:!0,getRowId:!0,reactiveCustomComponents:!0,columnMenu:!0,suppressSetFilterByDefault:!0,getDataPath:!0,enableCellSpan:!0},vr="clientSide",Hi="serverSide",tf="infinite",VZe={onGroupExpandedOrCollapsed:[vr],refreshClientSideRowModel:[vr],isRowDataEmpty:[vr],forEachLeafNode:[vr],forEachNodeAfterFilter:[vr],forEachNodeAfterFilterAndSort:[vr],resetRowHeights:[vr],applyTransaction:[vr],applyTransactionAsync:[vr],flushAsyncTransactions:[vr],getBestCostNodeSelection:[vr],getServerSideSelectionState:[Hi],setServerSideSelectionState:[Hi],applyServerSideTransaction:[Hi],applyServerSideTransactionAsync:[Hi],applyServerSideRowData:[Hi],retryServerSideLoads:[Hi],flushServerSideAsyncTransactions:[Hi],refreshServerSide:[Hi],getServerSideGroupLevelState:[Hi],refreshInfiniteCache:[tf],purgeInfiniteCache:[tf],getInfiniteRowCount:[tf],isLastRowIndexKnown:[tf,Hi],expandAll:[vr,Hi],collapseAll:[vr,Hi],onRowHeightChanged:[vr,Hi],setRowCount:[tf,Hi],getCacheBlockState:[tf,Hi]},WZe={showLoadingOverlay:{version:"v32",message:'`showLoadingOverlay` is deprecated. Use the grid option "loading"=true instead or setGridOption("loading", true).'},clearRangeSelection:{version:"v32.2",message:"Use `clearCellSelection` instead."},getInfiniteRowCount:{version:"v32.2",old:"getInfiniteRowCount()",new:"getDisplayedRowCount()"},selectAllFiltered:{version:"v33",old:"selectAllFiltered()",new:'selectAll("filtered")'},deselectAllFiltered:{version:"v33",old:"deselectAllFiltered()",new:'deselectAll("filtered")'},selectAllOnCurrentPage:{version:"v33",old:"selectAllOnCurrentPage()",new:'selectAll("currentPage")'},deselectAllOnCurrentPage:{version:"v33",old:"deselectAllOnCurrentPage()",new:'deselectAll("currentPage")'}};function UZe(e,t,n){const i=WZe[e];if(i){const{version:s,new:o,old:a,message:l}=i,u=a??e;return(...c)=>{const d=o?`Please use ${o} instead. `:"";return cv(`Since ${s} api.${u} is deprecated. ${d}${l??""}`),t.apply(t,c)}}const r=VZe[e];return r?(...s)=>{const o=n.rowModel.getType();if(!r.includes(o)){Tf(`api.${e} can only be called when gridOptions.rowModelType is ${r.join(" or ")}`);return}return t.apply(t,s)}:t}var Fie={AdvancedFilter:1,AllEnterprise:1,CellSelection:1,Clipboard:1,ColumnMenu:1,ColumnsToolPanel:1,ContextMenu:1,ExcelExport:1,FiltersToolPanel:1,Find:1,GridCharts:1,IntegratedCharts:1,GroupFilter:1,MasterDetail:1,Menu:1,MultiFilter:1,Pivot:1,RangeSelection:1,RichSelect:1,RowNumbers:1,RowGrouping:1,RowGroupingPanel:1,ServerSideRowModelApi:1,ServerSideRowModel:1,SetFilter:1,SideBar:1,Sparklines:1,StatusBar:1,TreeData:1,ViewportRowModel:1},$D=["TextFilter","NumberFilter","DateFilter","SetFilter","MultiFilter","GroupFilter","CustomFilter"],jZe={EditCore:["TextEditor","NumberEditor","DateEditor","CheckboxEditor","LargeTextEditor","SelectEditor","RichSelect","CustomEditor"],CheckboxCellRenderer:["AllCommunity"],ClientSideRowModelHierarchy:["RowGrouping","Pivot","TreeData"],ColumnFilter:$D,ColumnGroupHeaderComp:["AllCommunity"],ColumnGroup:["AllCommunity"],ColumnHeaderComp:["AllCommunity"],ColumnMove:["AllCommunity"],ColumnResize:["AllCommunity"],CommunityCore:["AllCommunity"],CsrmSsrmSharedApi:["ClientSideRowModelApi","ServerSideRowModelApi"],EnterpriseCore:["AllEnterprise"],FilterCore:[...$D,"QuickFilter","ExternalFilter","AdvancedFilter"],GroupCellRenderer:["RowGrouping","Pivot","TreeData","MasterDetail","ServerSideRowModel"],KeyboardNavigation:["AllCommunity"],LoadingCellRenderer:["ServerSideRowModel"],MenuCore:["ColumnMenu","ContextMenu"],MenuItem:["ColumnMenu","ContextMenu","MultiFilter","IntegratedCharts","ColumnsToolPanel"],Overlay:["AllCommunity"],PinnedColumn:["AllCommunity"],SharedAggregation:["RowGrouping","Pivot","TreeData","ServerSideRowModel"],SharedDragAndDrop:["AllCommunity"],SharedMasterDetail:["MasterDetail","ServerSideRowModel"],SharedMenu:[...$D,"ColumnMenu","ContextMenu"],SharedPivot:["Pivot","ServerSideRowModel"],SharedRowGrouping:["RowGrouping","ServerSideRowModel"],SharedRowSelection:["RowSelection","ServerSideRowModel"],SkeletonCellRenderer:["ServerSideRowModel"],Sort:["AllCommunity"],SsrmInfiniteSharedApi:["InfiniteRowModel","ServerSideRowModelApi"],SharedTreeData:["TreeData","ServerSideRowModel"]},qZe={InfiniteRowModel:"infinite",ClientSideRowModelApi:"clientSide",ClientSideRowModel:"clientSide",ServerSideRowModelApi:"serverSide",ServerSideRowModel:"serverSide",ViewportRowModel:"viewport"};function KZe(e,t){const n=[];return(Array.isArray(e)?e:[e]).forEach(i=>{const r=jZe[i];r?r.forEach(s=>{const o=qZe[s];(!o||o===t)&&n.push(s)}):n.push(i)}),n}var Nf={agSetColumnFilter:"SetFilter",agSetColumnFloatingFilter:"SetFilter",agMultiColumnFilter:"MultiFilter",agMultiColumnFloatingFilter:"MultiFilter",agGroupColumnFilter:"GroupFilter",agGroupColumnFloatingFilter:"GroupFilter",agGroupCellRenderer:"GroupCellRenderer",agGroupRowRenderer:"GroupCellRenderer",agRichSelect:"RichSelect",agRichSelectCellEditor:"RichSelect",agDetailCellRenderer:"SharedMasterDetail",agSparklineCellRenderer:"Sparklines",agDragAndDropImage:"SharedDragAndDrop",agColumnHeader:"ColumnHeaderComp",agColumnGroupHeader:"ColumnGroupHeaderComp",agSortIndicator:"Sort",agAnimateShowChangeCellRenderer:"HighlightChanges",agAnimateSlideCellRenderer:"HighlightChanges",agLoadingCellRenderer:"LoadingCellRenderer",agSkeletonCellRenderer:"SkeletonCellRenderer",agCheckboxCellRenderer:"CheckboxCellRenderer",agLoadingOverlay:"Overlay",agNoRowsOverlay:"Overlay",agTooltipComponent:"Tooltip",agReadOnlyFloatingFilter:"CustomFilter",agTextColumnFilter:"TextFilter",agNumberColumnFilter:"NumberFilter",agDateColumnFilter:"DateFilter",agDateInput:"DateFilter",agTextColumnFloatingFilter:"TextFilter",agNumberColumnFloatingFilter:"NumberFilter",agDateColumnFloatingFilter:"DateFilter",agCellEditor:"TextEditor",agSelectCellEditor:"SelectEditor",agTextCellEditor:"TextEditor",agNumberCellEditor:"NumberEditor",agDateCellEditor:"DateEditor",agDateStringCellEditor:"DateEditor",agCheckboxCellEditor:"CheckboxEditor",agLargeTextCellEditor:"LargeTextEditor",agMenuItem:"MenuItem",agColumnsToolPanel:"ColumnsToolPanel",agFiltersToolPanel:"FiltersToolPanel",agAggregationComponent:"StatusBar",agSelectedRowCountComponent:"StatusBar",agTotalRowCountComponent:"StatusBar",agFilteredRowCountComponent:"StatusBar",agTotalAndFilteredRowCountComponent:"StatusBar",agFindCellRenderer:"Find"},YZe=e=>{const t=e.map(i=>`import { ${mv(i)} } from '${Fie[i]?"ag-grid-enterprise":"ag-grid-community"}';`);return e.some(i=>i==="IntegratedCharts"||i==="Sparklines")&&t.push("import { AgChartsEnterpriseModule } from 'ag-charts-enterprise';"),`import { ModuleRegistry } from 'ag-grid-community'; 
${t.join(` 
`)} 

ModuleRegistry.registerModules([ ${e.map(i=>mv(i,!0)).join(", ")} ]); 

For more info see: ${Rd}/modules/`};function mv(e,t=!1){return t&&(e==="IntegratedCharts"||e==="Sparklines")?`${e}Module.with(AgChartsEnterpriseModule)`:`${e}Module`}function XZe(e,t){const n=t.filter(s=>s==="IntegratedCharts"||s==="Sparklines");let i="";return!globalThis?.agCharts&&n.length>0?i=`Unable to use ${e} as either the ag-charts-community or ag-charts-enterprise script needs to be included alongside ag-grid-enterprise.
`:t.some(s=>Fie[s])&&(i=i+`Unable to use ${e} as that requires the ag-grid-enterprise script to be included.
`),i}var RW=({reasonOrId:e,moduleName:t,gridScoped:n,gridId:i,rowModelType:r,additionalText:s,isUmd:o})=>{const a=KZe(t,r),l=typeof e=="string"?e:eet[e];if(o)return XZe(l,a);const u=a.filter(h=>h==="IntegratedCharts"||h==="Sparklines"),c=u.length>0?`${u.map(h=>mv(h)).join()} must be initialised with an AG Charts module. One of 'AgChartsCommunityModule' / 'AgChartsEnterpriseModule'.`:"";return`${`Unable to use ${l} as ${a.length>1?"one of "+a.map(h=>mv(h)).join(", "):mv(a[0])} is not registered${n?" for gridId: "+i:""}. ${c} Check if you have registered the module:
`}
${YZe(a)}`+(s?` 

${s}`:"")},EW=e=>`${e} must be initialised with an AG Charts module. One of 'AgChartsCommunityModule' / 'AgChartsEnterpriseModule'.

import { AgChartsEnterpriseModule } from 'ag-charts-enterprise';
import { ModuleRegistry } from 'ag-grid-community';
import { ${e} } from 'ag-grid-enterprise';
    
ModuleRegistry.registerModules([${e}.with(AgChartsEnterpriseModule)]);
    `,QZe=e=>`AG Grid: Unable to use the Clipboard API (navigator.clipboard.${e}()). The reason why it could not be used has been logged in the previous line. For this reason the grid has defaulted to using a workaround which doesn't perform as well. Either fix why Clipboard API is blocked, OR stop this message from appearing by setting grid property suppressClipboardApi=true (which will default the grid to using the workaround rather than the API.`,JZe={1:()=>"`rowData` must be an array",2:({nodeId:e})=>`Duplicate node id '${e}' detected from getRowId callback, this could cause issues in your grid.`,3:()=>"Calling gridApi.resetRowHeights() makes no sense when using Auto Row Height.",4:({id:e})=>`Could not find row id=${e}, data item was not found for this id`,5:({data:e})=>["Could not find data item as object was not found.",e," Consider using getRowId to help the Grid find matching row data"],6:()=>"'groupHideOpenParents' only works when specifying specific columns for 'colDef.showRowGroup'",7:()=>"Pivoting is not supported with aligned grids as it may produce different columns in each grid.",8:({key:e})=>`Unknown key for navigation ${e}`,9:({variable:e})=>`No value for ${e?.cssName}. This usually means that the grid has been initialised before styles have been loaded. The default value of ${e?.defaultValue} will be used and updated when styles load.`,10:({eventType:e})=>`As of v33, the '${e}' event is deprecated. Use the global 'modelUpdated' event to determine when row children have changed.`,11:()=>"No gridOptions provided to createGrid",12:({colKey:e})=>["column ",e," not found"],13:()=>"Could not find rowIndex, this means tasks are being executed on a rowNode that has been removed from the grid.",14:({groupPrefix:e})=>`Row IDs cannot start with ${e}, this is a reserved prefix for AG Grid's row grouping feature.`,15:({expression:e})=>["value should be either a string or a function",e],16:({expression:e,params:t,e:n})=>["Processing of the expression failed","Expression = ",e,"Params = ",t,"Exception = ",n],17:()=>"you need either field or valueSetter set on colDef for editing to work",18:()=>"alignedGrids contains an undefined option.",19:()=>"alignedGrids - No api found on the linked grid.",20:()=>`You may want to configure via a callback to avoid setup race conditions:
                     "alignedGrids: () => [linkedGrid]"`,21:()=>"pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.",22:({key:e})=>`${e} is an initial property and cannot be updated.`,23:()=>"The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead.",24:()=>"row height must be a number if not using standard row model",25:({id:e})=>["The getRowId callback must return a string. The ID ",e," is being cast to a string."],26:({fnName:e,preDestroyLink:t})=>`Grid API function ${e}() cannot be called as the grid has been destroyed.
 Either clear local references to the grid api, when it is destroyed, or check gridApi.isDestroyed() to avoid calling methods against a destroyed grid.
 To run logic when the grid is about to be destroyed use the gridPreDestroy event. See: ${t}`,27:({fnName:e,module:t})=>`API function '${e}' not registered to module '${t}'`,28:()=>"setRowCount cannot be used while using row grouping.",29:()=>"tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?",30:({toIndex:e})=>["tried to insert columns in invalid location, toIndex = ",e,"remember that you should not count the moving columns when calculating the new index"],31:()=>"infinite loop in resizeColumnSets",32:()=>"applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state.",33:()=>"stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON.",34:({key:e})=>`the column type '${e}' is a default column type and cannot be overridden.`,35:()=>"Column type definitions 'columnTypes' with a 'type' attribute are not supported because a column type cannot refer to another column type. Only column definitions 'columnDefs' can use the 'type' attribute to refer to a column type.",36:({t:e})=>"colDef.type '"+e+"' does not correspond to defined gridOptions.columnTypes",37:()=>"Changing the column pinning status is not allowed with domLayout='print'",38:({iconName:e})=>`provided icon '${e}' needs to be a string or a function`,39:()=>"Applying column order broke a group where columns should be married together. Applying new order has been discarded.",40:({e,method:t})=>`${e}
${QZe(t)}`,41:()=>"Browser did not allow document.execCommand('copy'). Ensure 'api.copySelectedRowsToClipboard() is invoked via a user event, i.e. button click, otherwise the browser will prevent it for security reasons.",42:()=>"Browser does not support document.execCommand('copy') for clipboard operations",43:({iconName:e})=>`As of v33, icon '${e}' is deprecated. Use the icon CSS name instead.`,44:()=>'Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.',45:({parentCellDataType:e})=>`The data type definition ${e} does not exist.`,46:()=>'The "baseDataType" property of a data type definition must match that of its parent.',47:({cellDataType:e})=>`Missing data type definition - "${e}"`,48:({property:e})=>`Cell data type is "object" but no Value ${e} has been provided. Please either provide an object data type definition with a Value ${e}, or set "colDef.value${e}"`,49:({methodName:e})=>`Framework component is missing the method ${e}()`,50:({compName:e})=>`Could not find component ${e}, did you forget to configure this component?`,51:()=>"Export cancelled. Export is not allowed as per your configuration.",52:()=>"There is no `window` associated with the current `document`",53:()=>"unknown value type during csv conversion",54:()=>"Could not find document body, it is needed for drag and drop and context menu.",55:()=>"addRowDropZone - A container target needs to be provided",56:()=>"addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.",57:()=>"unable to show popup filter, filter instantiation failed",58:()=>"no values found for select cellEditor",59:()=>"cannot select pinned rows",60:()=>"cannot select node until it has finished loading",61:()=>"since version v32.2.0, rowNode.isFullWidthCell() has been deprecated. Instead check `rowNode.detail` followed by the user provided `isFullWidthRow` grid option.",62:({colId:e})=>`setFilterModel() - no column found for colId: ${e}`,63:({colId:e})=>`setFilterModel() - unable to fully apply model, filtering disabled for colId: ${e}`,64:({colId:e})=>`setFilterModel() - unable to fully apply model, unable to create filter for colId: ${e}`,65:()=>"filter missing setModel method, which is needed for setFilterModel",66:()=>"filter API missing getModel method, which is needed for getFilterModel",67:()=>"Filter is missing isFilterActive() method",68:()=>"Column Filter API methods have been disabled as Advanced Filters are enabled.",69:({guiFromFilter:e})=>`getGui method from filter returned ${e}; it should be a DOM element.`,70:({newFilter:e})=>`Grid option quickFilterText only supports string inputs, received: ${typeof e}`,71:()=>"debounceMs is ignored when apply button is present",72:({keys:e})=>["ignoring FilterOptionDef as it doesn't contain one of ",e],73:()=>"invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'",74:()=>"no filter options for filter",75:()=>"Unknown button type specified",76:({filterModelType:e})=>['Unexpected type of filter "',e,'", it looks like the filter was configured with incorrect Filter Options'],77:()=>"Filter model is missing 'conditions'",78:()=>'Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.',79:()=>'"filterParams.maxNumConditions" must be greater than or equal to zero.',80:()=>'"filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.',81:()=>'"filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".',82:({param:e})=>`DateFilter ${e} is not a number`,83:()=>"DateFilter minValidYear should be <= maxValidYear",84:()=>"DateFilter minValidDate should be <= maxValidDate",85:()=>"DateFilter should not have both minValidDate and minValidYear parameters set at the same time! minValidYear will be ignored.",86:()=>"DateFilter should not have both maxValidDate and maxValidYear parameters set at the same time! maxValidYear will be ignored.",87:()=>"DateFilter parameter minValidDate should always be lower than or equal to parameter maxValidDate.",88:({index:e})=>`Invalid row index for ensureIndexVisible: ${e}`,89:()=>"A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)",90:()=>"datasource is missing getRows method",91:()=>"Filter is missing method doesFilterPass",92:()=>"AnimationFrameService called but animation frames are off",93:()=>"cannot add multiple ranges when `cellSelection.suppressMultiRanges = true`",94:({paginationPageSizeOption:e,pageSizeSet:t,pageSizesSet:n,pageSizeOptions:i})=>`'paginationPageSize=${e}'${t?"":" (default value)"}, but ${e} is not included in${n?"":" the default"} paginationPageSizeSelector=[${i?.join(", ")}].`,95:({paginationPageSizeOption:e,paginationPageSizeSelector:t})=>`Either set '${t}' to an array that includes ${e} or to 'false' to disable the page size selector.`,96:({id:e,data:t})=>["Duplicate ID",e,"found for pinned row with data",t,"When `getRowId` is defined, it must return unique IDs for all pinned rows. Use the `rowPinned` parameter."],97:({colId:e})=>`cellEditor for column ${e} is missing getGui() method`,98:()=>"popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.",99:()=>"Since v32, `api.hideOverlay()` does not hide the loading overlay when `loading=true`. Set `loading=false` instead.",100:({rowModelType:e})=>`selectAll only available when rowModelType='clientSide', ie not ${e}`,101:({propertyName:e,componentName:t,agGridDefaults:n,jsComps:i})=>{const r=[],s=[...Object.keys(n??[]).filter(a=>!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(a)),...Object.keys(i??[])],o=Eie({inputValue:t,allSuggestions:s,hideIrrelevant:!0,filterByPercentageOfBestMatch:.8}).values;return r.push(`Could not find '${t}' component. It was configured as "${e}: '${t}'" but it wasn't found in the list of registered components.
`),o.length>0&&r.push(`         Did you mean: [${o.slice(0,3)}]?
`),r.push("If using a custom component check it has been registered correctly."),r},102:()=>"selectAll: 'filtered' only works when gridOptions.rowModelType='clientSide'",103:()=>"Invalid selection state. When using client-side row model, the state must conform to `string[]`.",104:({value:e,param:t})=>`Numeric value ${e} passed to ${t} param will be interpreted as ${e} seconds. If this is intentional use "${e}s" to silence this warning.`,105:({e})=>["chart rendering failed",e],106:()=>`Theming API and Legacy Themes are both used in the same page. A Theming API theme has been provided to the 'theme' grid option, but the file (ag-grid.css) is also included and will cause styling issues. Remove ag-grid.css from the page. See the migration guide: ${Rd}/theming-migration/`,107:({key:e,value:t})=>`Invalid value for theme param ${e} - ${t}`,108:({e})=>["chart update failed",e],109:({aggFuncOrString:e})=>`unrecognised aggregation function ${e}`,110:()=>"groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup",111:()=>"Invalid selection state. When `groupSelects` is enabled, the state must conform to `IServerSideGroupSelectionState`.",113:()=>"Set Filter cannot initialise because you are using a row model that does not contain all rows in the browser. Either use a different filter type, or configure Set Filter such that you provide it with values",114:({component:e})=>`Could not find component with name of ${e}. Is it in Vue.components?`,116:()=>"Invalid selection state. The state must conform to `IServerSideSelectionState`.",117:()=>"selectAll must be of boolean type.",118:()=>"Infinite scrolling must be enabled in order to set the row count.",119:()=>"Unable to instantiate filter",120:()=>"MultiFloatingFilterComp expects MultiFilter as its parent",121:()=>"a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (see AG Grid docs) or b) to toString() on the object to return a key",122:()=>"could not find the document, document is empty",123:()=>"Advanced Filter is only supported with the Client-Side Row Model or Server-Side Row Model.",124:()=>"No active charts to update.",125:({chartId:e})=>`Unable to update chart. No active chart found with ID: ${e}.`,126:()=>"unable to restore chart as no chart model is provided",127:({allRange:e})=>`unable to create chart as ${e?"there are no columns in the grid":"no range is selected"}.`,128:({feature:e})=>`${e} is only available if using 'multiRow' selection mode.`,129:({feature:e,rowModel:t})=>`${e} is only available if using 'clientSide' or 'serverSide' rowModelType, you are using ${t}.`,130:()=>'cannot multi select unless selection mode is "multiRow"',132:()=>"Row selection features are not available unless `rowSelection` is enabled.",133:({iconName:e})=>`icon '${e}' function should return back a string or a dom object`,134:({iconName:e})=>`Did not find icon '${e}'`,135:()=>"Data type of the new value does not match the cell data type of the column",136:()=>"Unable to update chart as the 'type' is missing. It must be either 'rangeChartUpdate', 'pivotChartUpdate', or 'crossFilterChartUpdate'.",137:({type:e,currentChartType:t})=>`Unable to update chart as a '${e}' update type is not permitted on a ${t}.`,138:({chartType:e})=>`invalid chart type supplied: ${e}`,139:({customThemeName:e})=>`a custom chart theme with the name ${e} has been supplied but not added to the 'chartThemes' list`,140:({name:e})=>`no stock theme exists with the name '${e}' and no custom chart theme with that name was supplied to 'customChartThemes'`,141:()=>"cross filtering with row grouping is not supported.",142:()=>"cross filtering is only supported in the client side row model.",143:({panel:e})=>`'${e}' is not a valid Chart Tool Panel name`,144:({type:e})=>`Invalid charts data panel group name supplied: '${e}'`,145:({group:e})=>`As of v32, only one charts customize panel group can be expanded at a time. '${e}' will not be expanded.`,146:({comp:e})=>`Unable to instantiate component '${e}' as its module hasn't been loaded. Add 'ValidationModule' to see which module is required.`,147:({group:e})=>`Invalid charts customize panel group name supplied: '${e}'`,148:({group:e})=>`invalid chartGroupsDef config '${e}'`,149:({group:e,chartType:t})=>`invalid chartGroupsDef config '${e}.${t}'`,150:()=>"'seriesChartTypes' are required when the 'customCombo' chart type is specified.",151:({chartType:e})=>`invalid chartType '${e}' supplied in 'seriesChartTypes', converting to 'line' instead.`,152:({colId:e})=>`no 'seriesChartType' found for colId = '${e}', defaulting to 'line'.`,153:({chartDataType:e})=>`unexpected chartDataType value '${e}' supplied, instead use 'category', 'series' or 'excluded'`,154:({colId:e})=>`cross filtering requires a 'agSetColumnFilter' or 'agMultiColumnFilter' to be defined on the column with id: ${e}`,155:({option:e})=>`'${e}' is not a valid Chart Toolbar Option`,156:({panel:e})=>`Invalid panel in chartToolPanelsDef.panels: '${e}'`,157:({unrecognisedGroupIds:e})=>["unable to find group(s) for supplied groupIds:",e],158:()=>"can not expand a column item that does not represent a column group header",159:()=>"Invalid params supplied to createExcelFileForExcel() - `ExcelExportParams.data` is empty.",160:()=>"Export cancelled. Export is not allowed as per your configuration.",161:()=>"The Excel Exporter is currently on Multi Sheet mode. End that operation by calling 'api.getMultipleSheetAsExcel()' or 'api.exportMultipleSheetsAsExcel()'",162:({id:e,dataType:t})=>`Unrecognized data type for excel export [${e}.dataType=${t}]`,163:({featureName:e})=>`Excel table export does not work with ${e}. The exported Excel file will not contain any Excel tables.
 Please turn off ${e} to enable Excel table exports.`,164:()=>"Unable to add data table to Excel sheet: A table already exists.",165:()=>"Unable to add data table to Excel sheet: Missing required parameters.",166:({unrecognisedGroupIds:e})=>["unable to find groups for these supplied groupIds:",e],167:({unrecognisedColIds:e})=>["unable to find columns for these supplied colIds:",e],168:()=>"detailCellRendererParams.template should be function or string",169:()=>'Reference to eDetailGrid was missing from the details template. Please add data-ref="eDetailGrid" to the template.',170:({providedStrategy:e})=>`invalid cellRendererParams.refreshStrategy = ${e} supplied, defaulting to refreshStrategy = 'rows'.`,171:()=>"could not find detail grid options for master detail, please set gridOptions.detailCellRendererParams.detailGridOptions",172:()=>"could not find getDetailRowData for master / detail, please set gridOptions.detailCellRendererParams.getDetailRowData",173:({group:e})=>`invalid chartGroupsDef config '${e}'`,174:({group:e,chartType:t})=>`invalid chartGroupsDef config '${e}.${t}'`,175:({menuTabName:e,itemsToConsider:t})=>[`Trying to render an invalid menu item '${e}'. Check that your 'menuTabs' contains one of `,t],176:({key:e})=>`unknown menu item type ${e}`,177:()=>"valid values for cellSelection.handle.direction are 'x', 'y' and 'xy'. Default to 'xy'.",178:({colId:e})=>`column ${e} is not visible`,179:()=>"totalValueGetter should be either a function or a string (expression)",180:()=>"agRichSelectCellEditor requires cellEditorParams.values to be set",181:()=>"agRichSelectCellEditor cannot have `multiSelect` and `allowTyping` set to `true`. AllowTyping has been turned off.",182:()=>'you cannot mix groupDisplayType = "multipleColumns" with treeData, only one column can be used to display groups when doing tree data',183:()=>"Group Column Filter only works on group columns. Please use a different filter.",184:({parentGroupData:e,childNodeData:t})=>["duplicate group keys for row data, keys should be unique",[e,t]],185:({data:e})=>["getDataPath() should not return an empty path",[e]],186:({rowId:e,rowData:t,duplicateRowsData:n})=>["duplicate group keys for row data, keys should be unique",e,t,...n??[]],187:({rowId:e,firstData:t,secondData:n})=>[`Duplicate node id ${e}. Row IDs are provided via the getRowId() callback. Please modify the getRowId() callback code to provide unique row id values.`,"first instance",t,"second instance",n],188:()=>"getRowId callback must be provided for Server Side Row Model selection to work correctly.",189:({startRow:e})=>`invalid value ${e} for startRow, the value should be >= 0`,190:({rowGroupId:e,data:t})=>["null and undefined values are not allowed for server side row model keys",e?`column = ${e}`:"","data is ",t],194:({method:e})=>`calling gridApi.${e}() is only possible when using rowModelType=\`clientSide\`.`,195:({justCurrentPage:e})=>`selecting just ${e?"current page":"filtered"} only works when gridOptions.rowModelType='clientSide'`,196:({key:e})=>`Provided ids must be of string type. Invalid id provided: ${e}`,197:()=>"`toggledNodes` must be an array of string ids.",199:()=>"getSelectedNodes and getSelectedRows functions cannot be used with select all functionality with the server-side row model. Use `api.getServerSideSelectionState()` instead.",200:RW,201:({rowModelType:e})=>`Could not find row model for rowModelType = ${e}`,202:()=>"`getSelectedNodes` and `getSelectedRows` functions cannot be used with `groupSelectsChildren` and the server-side row model. Use `api.getServerSideSelectionState()` instead.",203:()=>"Server Side Row Model does not support Dynamic Row Height and Cache Purging. Either a) remove getRowHeight() callback or b) remove maxBlocksInCache property. Purging has been disabled.",204:()=>"Server Side Row Model does not support Auto Row Height and Cache Purging. Either a) remove colDef.autoHeight or b) remove maxBlocksInCache property. Purging has been disabled.",205:({duplicateIdText:e})=>`Unable to display rows as duplicate row ids (${e}) were returned by the getRowId callback. Please modify the getRowId callback to provide unique ids.`,206:()=>"getRowId callback must be implemented for transactions to work. Transaction was ignored.",207:()=>'The Set Filter Parameter "defaultToNothingSelected" value was ignored because it does not work when "excelMode" is used.',208:()=>"Set Filter Value Formatter must return string values. Please ensure the Set Filter Value Formatter returns string values for complex objects.",209:()=>`Set Filter Key Creator is returning null for provided values and provided values are primitives. Please provide complex objects. See ${Rd}/filter-set-filter-list/#filter-value-types`,210:()=>"Set Filter has a Key Creator, but provided values are primitives. Did you mean to provide complex objects?",211:()=>"property treeList=true for Set Filter params, but you did not provide a treeListPathGetter or values of type Date.",212:()=>"please review all your toolPanel components, it seems like at least one of them doesn't have an id",213:()=>"Advanced Filter does not work with Filters Tool Panel. Filters Tool Panel has been disabled.",214:({key:e})=>`unable to lookup Tool Panel as invalid key supplied: ${e}`,215:({key:e,defaultByKey:t})=>`the key ${e} is not a valid key for specifying a tool panel, valid keys are: ${Object.keys(t??{}).join(",")}`,216:({name:e})=>`Missing component for '${e}'`,217:({invalidColIds:e})=>["unable to find grid columns for the supplied colDef(s):",e],218:({property:e,defaultOffset:t})=>`${e} must be a number, the value you provided is not a valid number. Using the default of ${t}px.`,219:({property:e})=>`Property ${e} does not exist on the target object.`,220:({lineDash:e})=>`'${e}' is not a valid 'lineDash' option.`,221:()=>"agAggregationComponent should only be used with the client and server side row model.",222:()=>"agFilteredRowCountComponent should only be used with the client side row model.",223:()=>"agSelectedRowCountComponent should only be used with the client and server side row model.",224:()=>"agTotalAndFilteredRowCountComponent should only be used with the client side row model.",225:()=>"agTotalRowCountComponent should only be used with the client side row model.",226:()=>"viewport is missing init method.",227:()=>"menu item icon must be DOM node or string",228:({menuItemOrString:e})=>`unrecognised menu item ${e}`,229:({index:e})=>["invalid row index for ensureIndexVisible: ",e],230:()=>"detailCellRendererParams.template is not supported by AG Grid React. To change the template, provide a Custom Detail Cell Renderer. See https://www.ag-grid.com/react-data-grid/master-detail-custom-detail/",231:()=>"As of v32, using custom components with `reactiveCustomComponents = false` is deprecated.",232:()=>"Using both rowData and v-model. rowData will be ignored.",233:({methodName:e})=>`Framework component is missing the method ${e}()`,234:()=>'Group Column Filter does not work with the colDef property "field". This property will be ignored.',235:()=>'Group Column Filter does not work with the colDef property "filterValueGetter". This property will be ignored.',236:()=>'Group Column Filter does not work with the colDef property "filterParams". This property will be ignored.',237:()=>"Group Column Filter does not work with Tree Data enabled. Please disable Tree Data, or use a different filter.",238:()=>"setRowCount can only accept a positive row count.",239:()=>'Theming API and CSS File Themes are both used in the same page. In v33 we released the Theming API as the new default method of styling the grid. See the migration docs https://www.ag-grid.com/react-data-grid/theming-migration/. Because no value was provided to the `theme` grid option it defaulted to themeQuartz. But the file (ag-grid.css) is also included and will cause styling issues. Either pass the string "legacy" to the theme grid option to use v32 style themes, or remove ag-grid.css from the page to use Theming API.',240:({theme:e})=>`theme grid option must be a Theming API theme object or the string "legacy", received: ${e}`,243:()=>"Failed to deserialize state - each provided state object must be an object.",244:()=>"Failed to deserialize state - `selectAllChildren` must be a boolean value or undefined.",245:()=>"Failed to deserialize state - `toggledNodes` must be an array.",246:()=>"Failed to deserialize state - Every `toggledNode` requires an associated string id.",247:()=>`Row selection state could not be parsed due to invalid data. Ensure all child state has toggledNodes or does not conform with the parent rule. 
Please rebuild the selection state and reapply it.`,248:()=>"SetFloatingFilter expects SetFilter as its parent",249:()=>"Must supply a Value Formatter in Set Filter params when using a Key Creator",250:()=>"Must supply a Key Creator in Set Filter params when `treeList = true` on a group column, and Tree Data or Row Grouping is enabled.",251:({chartType:e})=>`AG Grid: Unable to create chart as an invalid chartType = '${e}' was supplied.`,252:()=>`cannot get grid to draw rows when it is in the middle of drawing rows. 
Your code probably called a grid API method while the grid was in the render stage. 
To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). 
To see what part of your code that caused the refresh check this stacktrace.`,253:({version:e})=>["Illegal version string: ",e],254:()=>"Cannot create chart: no chart themes available.",255:({point:e})=>`Lone surrogate U+${e?.toString(16).toUpperCase()} is not a scalar value`,256:()=>"Unable to initialise. See validation error, or load ValidationModule if missing.",257:()=>EW("IntegratedChartsModule"),258:()=>EW("SparklinesModule"),259:({part:e})=>`the argument to theme.withPart must be a Theming API part object, received: ${e}`,260:({propName:e,compName:t,gridScoped:n,gridId:i,rowModelType:r})=>RW({reasonOrId:`AG Grid '${e}' component: ${t}`,moduleName:Nf[t],gridId:i,gridScoped:n,rowModelType:r}),261:()=>"As of v33, `column.isHovered()` is deprecated. Use `api.isColumnHovered(column)` instead.",262:()=>'As of v33, icon key "smallDown" is deprecated. Use "advancedFilterBuilderSelect" for Advanced Filter Builder dropdown, "selectOpen" for Select cell editor and dropdowns (e.g. Integrated Charts menu), "richSelectOpen" for Rich Select cell editor.',263:()=>'As of v33, icon key "smallLeft" is deprecated. Use "panelDelimiterRtl" for Row Group Panel / Pivot Panel, "subMenuOpenRtl" for sub-menus.',264:()=>'As of v33, icon key "smallRight" is deprecated. Use "panelDelimiter" for Row Group Panel / Pivot Panel, "subMenuOpen" for sub-menus.',265:({colId:e})=>`Unable to infer chart data type for column '${e}' if first data entry is null. Please specify "chartDataType", or a "cellDataType" in the column definition. For more information, see ${Rd}/integrated-charts-range-chart#coldefchartdatatype .`,266:()=>'As of v33.1, using "keyCreator" with the Rich Select Editor has been deprecated. It now requires the "formatValue" callback to convert complex data to strings.',267:()=>"Detail grids can not use a different theme to the master grid, the `theme` detail grid option will be ignored.",268:()=>"Transactions aren't supported with tree data when using treeDataChildrenField",269:()=>"When `masterSelects: 'detail'`, detail grids must be configured with multi-row selection",270:({id:e,parentId:t})=>`Cycle detected for row with id='${e}' and parent id='${t}'. Resetting the parent for row with id='${e}' and showing it as a root-level node.`,271:({id:e,parentId:t})=>`Parent row not found for row with id='${e}' and parent id='${t}'. Showing row with id='${e}' as a root-level node.`};function ZZe(e,t){const n=JZe[e];if(!n)return[`Missing error text for error id ${e}!`];const i=n(t),s=`
See ${zte(e,t)}`;return Array.isArray(i)?i.concat(s):[i,s]}var eet={1:"Charting Aggregation",2:"pivotResultFields",3:"setTooltip"},tet=()=>({checkboxSelection:{version:"32.2",message:"Use `rowSelection.checkboxes` in `GridOptions` instead."},headerCheckboxSelection:{version:"32.2",message:"Use `rowSelection.headerCheckbox = true` in `GridOptions` instead."},headerCheckboxSelectionFilteredOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "filtered"` in `GridOptions` instead.'},headerCheckboxSelectionCurrentPageOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "currentPage"` in `GridOptions` instead.'},showDisabledCheckboxes:{version:"32.2",message:"Use `rowSelection.hideDisabledCheckboxes = true` in `GridOptions` instead."}}),net=()=>({aggFunc:{module:"SharedAggregation"},autoHeight:{supportedRowModels:["clientSide","serverSide"],module:"RowAutoHeight"},cellClass:{module:"CellStyle"},cellClassRules:{module:"CellStyle"},cellEditor:({cellEditor:e,editable:t})=>{if(!t)return null;if(typeof e=="string"){const n=Nf[e];if(n)return{module:n}}return{module:"CustomEditor"}},cellRenderer:({cellRenderer:e})=>{if(typeof e!="string")return null;const t=Nf[e];return t?{module:t}:null},cellRendererParams:{validate:e=>(e.rowGroup!=null||e.rowGroupIndex!=null||e.cellRenderer==="agGroupCellRenderer")&&"checkbox"in e.cellRendererParams?'Since v33.0, `cellRendererParams.checkbox` has been deprecated. Use `rowSelection.checkboxLocation = "autoGroupColumn"` instead.':null},cellStyle:{module:"CellStyle"},children:()=>Aie(),columnChooserParams:{module:"ColumnMenu"},contextMenuItems:{module:"ContextMenu"},dndSource:{module:"DragAndDrop"},dndSourceOnRowDrag:{module:"DragAndDrop"},editable:({editable:e,cellEditor:t})=>e&&!t?{module:"TextEditor"}:null,enableCellChangeFlash:{module:"HighlightChanges"},enablePivot:{module:"SharedPivot"},enableRowGroup:{module:"SharedRowGrouping"},enableValue:{module:"SharedAggregation"},filter:({filter:e})=>{if(e&&typeof e!="string"&&typeof e!="boolean")return{module:"CustomFilter"};if(typeof e=="string"){const t=Nf[e];if(t)return{module:t}}return{module:"ColumnFilter"}},floatingFilter:{module:"ColumnFilter"},headerCheckboxSelection:{supportedRowModels:["clientSide","serverSide"],validate:(e,{rowSelection:t})=>t==="multiple"?null:"headerCheckboxSelection is only supported with rowSelection=multiple"},headerCheckboxSelectionCurrentPageOnly:{supportedRowModels:["clientSide"],validate:(e,{rowSelection:t})=>t==="multiple"?null:"headerCheckboxSelectionCurrentPageOnly is only supported with rowSelection=multiple"},headerCheckboxSelectionFilteredOnly:{supportedRowModels:["clientSide"],validate:(e,{rowSelection:t})=>t==="multiple"?null:"headerCheckboxSelectionFilteredOnly is only supported with rowSelection=multiple"},headerTooltip:{module:"Tooltip"},headerValueGetter:{validate:e=>{const t=e.headerValueGetter;return typeof t=="function"||typeof t=="string"?null:"headerValueGetter must be a function or a valid string expression"}},icons:{validate:({icons:e})=>{if(e){if(e.smallDown)return Hu(262);if(e.smallLeft)return Hu(263);if(e.smallRight)return Hu(264)}return null}},mainMenuItems:{module:"ColumnMenu"},menuTabs:e=>{const t=["columnsMenuTab","generalMenuTab"];return e.menuTabs?.some(n=>t.includes(n))?{module:"ColumnMenu"}:null},pivot:{module:"SharedPivot"},pivotIndex:{module:"SharedPivot"},rowDrag:{module:"RowDrag"},rowGroup:{module:"SharedRowGrouping"},rowGroupIndex:{module:"SharedRowGrouping"},sortingOrder:{validate:e=>{const t=e.sortingOrder;if(Array.isArray(t)&&t.length>0){const n=t.filter(i=>!m0.includes(i));if(n.length>0)return`sortingOrder must be an array with elements from [${m0.map(WS).join()}], currently it includes [${n.map(WS).join()}]`}else if(!Array.isArray(t)||t.length<=0)return`sortingOrder must be an array with at least one element, currently it's ${t}`;return null}},tooltipField:{module:"Tooltip"},tooltipValueGetter:{module:"Tooltip"},type:{validate:e=>{const t=e.type;return t instanceof Array?t.some(i=>typeof i!="string")?"if colDef.type is supplied an array it should be of type 'string[]'":null:typeof t=="string"?null:"colDef.type should be of type 'string' | 'string[]'"}},rowSpan:{validate:(e,{suppressRowTransform:t})=>t?null:"colDef.rowSpan requires suppressRowTransform to be enabled."},spanRows:{module:"CellSpan",dependencies:{editable:{required:[!1,void 0]},rowDrag:{required:[!1,void 0]},colSpan:{required:[!1,void 0]},rowSpan:{required:[!1,void 0]}},validate:(e,{rowSelection:t,cellSelection:n,suppressRowTransform:i,enableCellSpan:r,rowDragEntireRow:s,enableCellTextSelection:o})=>typeof t=="object"&&t?.mode==="singleRow"&&t?.enableClickSelection?"colDef.spanRows is not supported with rowSelection.clickSelection":n?"colDef.spanRows is not supported with cellSelection.":i?"colDef.spanRows is not supported with suppressRowTransform.":r?s?"colDef.spanRows is not supported with rowDragEntireRow.":o?"colDef.spanRows is not supported with enableCellTextSelection.":null:"colDef.spanRows requires enableCellSpan to be enabled."}}),iet={headerName:void 0,columnGroupShow:void 0,headerStyle:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,cellDataType:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellAriaRole:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellEditor:void 0,cellEditorParams:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,tooltipComponentParams:void 0,refData:void 0,columnChooserParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,suppressStickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressHeaderMenuButton:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,spanRows:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,suppressSpanHeaderHeight:void 0,useValueFormatterForExport:void 0,useValueParserForImport:void 0,mainMenuItems:void 0,contextMenuItems:void 0,suppressFloatingFilterButton:void 0,suppressHeaderFilterButton:void 0,suppressHeaderContextMenu:void 0,loadingCellRenderer:void 0,loadingCellRendererParams:void 0,loadingCellRendererSelector:void 0,context:void 0,dateComponent:void 0,dateComponentParams:void 0,getFindText:void 0},ret=()=>Object.keys(iet),Aie=()=>({objectName:"colDef",allProperties:ret(),docsUrl:"column-properties/",deprecations:tet(),validations:net()}),set=()=>({suppressLoadingOverlay:{version:"32",message:"Use `loading`=false instead."},enableFillHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeSelection:{version:"32.2",message:"Use `cellSelection = true` instead."},suppressMultiRangeSelection:{version:"32.2",message:"Use `cellSelection.suppressMultiRanges` instead."},suppressClearOnFillReduction:{version:"32.2",message:"Use `cellSelection.handle.suppressClearOnFillReduction` instead."},fillHandleDirection:{version:"32.2",message:"Use `cellSelection.handle.direction` instead."},fillOperation:{version:"32.2",message:"Use `cellSelection.handle.setFillValue` instead."},suppressRowClickSelection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},suppressRowDeselection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},rowMultiSelectWithClick:{version:"32.2",message:"Use `rowSelection.enableSelectionWithoutKeys` instead."},groupSelectsChildren:{version:"32.2",message:'Use `rowSelection.groupSelects = "descendants"` instead.'},groupSelectsFiltered:{version:"32.2",message:'Use `rowSelection.groupSelects = "filteredDescendants"` instead.'},isRowSelectable:{version:"32.2",message:"Use `selectionOptions.isRowSelectable` instead."},suppressCopySingleCellRanges:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},suppressCopyRowsToClipboard:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},onRangeSelectionChanged:{version:"32.2",message:"Use `onCellSelectionChanged` instead."},onRangeDeleteStart:{version:"32.2",message:"Use `onCellSelectionDeleteStart` instead."},onRangeDeleteEnd:{version:"32.2",message:"Use `onCellSelectionDeleteEnd` instead."},suppressBrowserResizeObserver:{version:"32.2",message:"The grid always uses the browser's ResizeObserver, this grid option has no effect."},onColumnEverythingChanged:{version:"32.2",message:"Either use `onDisplayedColumnsChanged` which is fired at the same time, or use one of the more specific column events."},groupRemoveSingleChildren:{version:"33",message:"Use `groupHideParentOfSingleChild` instead."},groupRemoveLowestSingleChildren:{version:"33",message:'Use `groupHideParentOfSingleChild: "leafGroupsOnly"` instead.'},suppressRowGroupHidesColumns:{version:"33",message:'Use `suppressGroupChangesColumnVisibility: "suppressHideOnGroup"` instead.'},suppressMakeColumnVisibleAfterUnGroup:{version:"33",message:'Use `suppressGroupChangesColumnVisibility: "suppressShowOnUngroup"` instead.'},unSortIcon:{version:"33",message:"Use `defaultColDef.unSortIcon` instead."},sortingOrder:{version:"33",message:"Use `defaultColDef.sortingOrder` instead."},suppressPropertyNamesCheck:{version:"33",message:"`gridOptions` and `columnDefs` both have a `context` property that should be used for arbitrary user data. This means that column definitions and gridOptions should only contain valid properties making this property redundant."}});function qo(e,t,n,i=Number.MAX_VALUE){return typeof t=="number"||t==null?t==null||t>=n&&t<=i?null:i===Number.MAX_VALUE?`${e}: value should be greater than or equal to ${n}`:`${e}: value should be between ${n} and ${i}`:`${e}: value should be a number`}var oet=()=>{const e={alignedGrids:{module:"AlignedGrids"},allowContextMenuWithControlKey:{module:"ContextMenu"},autoSizePadding:{validate({autoSizePadding:n}){return qo("autoSizePadding",n,0)}},autoSizeStrategy:{module:"ColumnAutoSize"},cacheBlockSize:{supportedRowModels:["serverSide","infinite"],validate({cacheBlockSize:n}){return qo("cacheBlockSize",n,1)}},cacheOverflowSize:{validate({cacheOverflowSize:n}){return qo("cacheOverflowSize",n,1)}},cellSelection:{module:"CellSelection"},columnHoverHighlight:{module:"ColumnHover"},datasource:{supportedRowModels:["infinite"],module:"InfiniteRowModel"},doesExternalFilterPass:{module:"ExternalFilter"},domLayout:{validate:n=>{const i=n.domLayout,r=["autoHeight","normal","print"];return i&&!r.includes(i)?`domLayout must be one of [${r.join()}], currently it's ${i}`:null}},editType:{module:"EditCore"},enableAdvancedFilter:{module:"AdvancedFilter"},enableCharts:{module:"IntegratedCharts"},enableFillHandle:{dependencies:{enableRangeSelection:{required:[!0]}}},enableRangeHandle:{dependencies:{enableRangeSelection:{required:[!0]}}},enableRangeSelection:{module:"CellSelection",dependencies:{rowDragEntireRow:{required:[!1,void 0]}}},findSearchValue:{module:"Find"},rowNumbers:{module:"RowNumbers"},getContextMenuItems:{module:"ContextMenu"},getLocaleText:{module:"Locale"},getMainMenuItems:{module:"ColumnMenu"},getRowClass:{module:"RowStyle"},getRowStyle:{module:"RowStyle"},grandTotalRow:{module:"SharedRowGrouping"},groupDefaultExpanded:{supportedRowModels:["clientSide"]},groupHideOpenParents:{supportedRowModels:["clientSide","serverSide"],dependencies:{groupTotalRow:{required:[void 0,"bottom"]},treeData:{required:[void 0,!1],reason:"Tree Data has values at the group level so it doesn't make sense to hide them."}}},groupHideParentOfSingleChild:{dependencies:{groupHideOpenParents:{required:[void 0,!1]}}},groupRemoveLowestSingleChildren:{dependencies:{groupHideOpenParents:{required:[void 0,!1]},groupRemoveSingleChildren:{required:[void 0,!1]}}},groupRemoveSingleChildren:{dependencies:{groupHideOpenParents:{required:[void 0,!1]},groupRemoveLowestSingleChildren:{required:[void 0,!1]}}},groupSelectsChildren:{dependencies:{rowSelection:{required:["multiple"]}}},icons:{validate:({icons:n})=>{if(n){if(n.smallDown)return Hu(262);if(n.smallLeft)return Hu(263);if(n.smallRight)return Hu(264)}return null}},infiniteInitialRowCount:{validate({infiniteInitialRowCount:n}){return qo("infiniteInitialRowCount",n,1)}},initialGroupOrderComparator:{supportedRowModels:["clientSide"]},initialState:{module:"GridState"},isExternalFilterPresent:{module:"ExternalFilter"},keepDetailRowsCount:{validate({keepDetailRowsCount:n}){return qo("keepDetailRowsCount",n,1)}},localeText:{module:"Locale"},masterDetail:{module:"SharedMasterDetail"},pagination:{module:"Pagination"},paginationPageSize:{validate({paginationPageSize:n}){return qo("paginationPageSize",n,1)}},paginationPageSizeSelector:{validate:n=>{const i=n.paginationPageSizeSelector;return typeof i=="boolean"||i==null||i.length?null:`'paginationPageSizeSelector' cannot be an empty array.
                    If you want to hide the page size selector, set paginationPageSizeSelector to false.`}},pinnedTopRowData:{module:"PinnedRow"},pinnedBottomRowData:{module:"PinnedRow"},pivotMode:{dependencies:{treeData:{required:[!1,void 0],reason:"Pivot Mode is not supported with Tree Data."}},module:"SharedPivot"},pivotPanelShow:{module:"RowGroupingPanel"},quickFilterText:{supportedRowModels:["clientSide"],module:"QuickFilter"},rowBuffer:{validate({rowBuffer:n}){return qo("rowBuffer",n,0)}},rowClass:{validate:n=>typeof n.rowClass=="function"?"rowClass should not be a function, please use getRowClass instead":null,module:"RowStyle"},rowClassRules:{module:"RowStyle"},rowData:{supportedRowModels:["clientSide"],module:"ClientSideRowModel"},rowDragManaged:{supportedRowModels:["clientSide"],dependencies:{treeData:{required:[!1,void 0]},pagination:{required:[!1,void 0]}},module:"RowDrag"},rowGroupPanelShow:{module:"RowGroupingPanel"},rowSelection:{validate({rowSelection:n}){return n&&typeof n=="string"?'As of version 32.2.1, using `rowSelection` with the values "single" or "multiple" has been deprecated. Use the object value instead.':n&&typeof n!="object"?"Expected `RowSelectionOptions` object for the `rowSelection` property.":n&&n.mode!=="multiRow"&&n.mode!=="singleRow"?`Selection mode "${n.mode}" is invalid. Use one of 'singleRow' or 'multiRow'.`:null},module:"SharedRowSelection"},rowStyle:{validate:n=>{const i=n.rowStyle;return i&&typeof i=="function"?"rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead":null},module:"RowStyle"},serverSideDatasource:{supportedRowModels:["serverSide"],module:"ServerSideRowModel"},serverSideInitialRowCount:{supportedRowModels:["serverSide"],validate({serverSideInitialRowCount:n}){return qo("serverSideInitialRowCount",n,1)}},serverSideOnlyRefreshFilteredGroups:{supportedRowModels:["serverSide"]},serverSideSortAllLevels:{supportedRowModels:["serverSide"]},sideBar:{module:"SideBar"},sortingOrder:{validate:n=>{const i=n.sortingOrder;if(Array.isArray(i)&&i.length>0){const r=i.filter(s=>!m0.includes(s));if(r.length>0)return`sortingOrder must be an array with elements from [${m0.map(WS).join()}], currently it includes [${r.map(WS).join()}]`}else if(!Array.isArray(i)||i.length<=0)return`sortingOrder must be an array with at least one element, currently it's ${i}`;return null}},statusBar:{module:"StatusBar"},tooltipHideDelay:{validate:n=>n.tooltipHideDelay&&n.tooltipHideDelay<0?"tooltipHideDelay should not be lower than 0":null},tooltipShowDelay:{validate:n=>n.tooltipShowDelay&&n.tooltipShowDelay<0?"tooltipShowDelay should not be lower than 0":null},treeData:{supportedRowModels:["clientSide","serverSide"],module:"SharedTreeData",validate:n=>{const i=n.rowModelType??"clientSide";switch(i){case"clientSide":{const{treeDataChildrenField:r,treeDataParentIdField:s,getDataPath:o,getRowId:a}=n;if(!r&&!s&&!o)return"treeData requires either 'treeDataChildrenField' or 'treeDataParentIdField' or 'getDataPath' in the clientSide row model.";if(r){if(o)return"Cannot use both 'treeDataChildrenField' and 'getDataPath' at the same time.";if(s)return"Cannot use both 'treeDataChildrenField' and 'treeDataParentIdField' at the same time."}if(s){if(!a)return"getRowId callback not provided, tree data with parent id cannot be built.";if(o)return"Cannot use both 'treeDataParentIdField' and 'getDataPath' at the same time."}return null}case"serverSide":{const r=`treeData requires 'isServerSideGroup' and 'getServerSideGroupKey' in the ${i} row model.`;return n.isServerSideGroup&&n.getServerSideGroupKey?null:r}}return null}},treeDataChildrenField:{module:"SharedTreeData"},treeDataParentIdField:{module:"SharedTreeData"},undoRedoCellEditing:{module:"UndoRedoEdit"},valueCache:{module:"ValueCache"},viewportDatasource:{supportedRowModels:["viewport"],module:"ViewportRowModel"},viewportRowModelBufferSize:{validate({viewportRowModelBufferSize:n}){return qo("viewportRowModelBufferSize",n,0)}},viewportRowModelPageSize:{validate({viewportRowModelPageSize:n}){return qo("viewportRowModelPageSize",n,1)}},rowDragEntireRow:{dependencies:{cellSelection:{required:[void 0]}}},enableCellSpan:{module:"CellSpan"},autoGroupColumnDef:{validate({autoGroupColumnDef:n,showOpenedGroup:i}){return n?.field&&i?"autoGroupColumnDef.field and showOpenedGroup are not supported when used together.":n?.valueGetter&&i?"autoGroupColumnDef.valueGetter and showOpenedGroup are not supported when used together.":null}}},t={};return Rie.forEach(n=>{t[n]={expectedType:"boolean"}}),xie.forEach(n=>{t[n]={expectedType:"number"}}),ir(t,e),t},aet=()=>({objectName:"gridOptions",allProperties:[...WT,...Sie.map(e=>gN(e))],propertyExceptions:["api"],docsUrl:"grid-options/",deprecations:set(),validations:oet()}),uet={expanded:1,contracted:1,"tree-closed":1,"tree-open":1,"tree-indeterminate":1,pin:1,"eye-slash":1,arrows:1,left:1,right:1,group:1,aggregation:1,pivot:1,"not-allowed":1,chart:1,cross:1,cancel:1,tick:1,first:1,previous:1,next:1,last:1,linked:1,unlinked:1,"color-picker":1,loading:1,menu:1,"menu-alt":1,filter:1,columns:1,maximize:1,minimize:1,copy:1,cut:1,paste:1,grip:1,save:1,csv:1,excel:1,"small-down":1,"small-left":1,"small-right":1,"small-up":1,asc:1,desc:1,none:1,up:1,down:1,plus:1,minus:1,settings:1,"checkbox-checked":1,"checkbox-indeterminate":1,"checkbox-unchecked":1,"radio-button-on":1,"radio-button-off":1,eye:1},cet={chart:"MenuCore",cancel:"EnterpriseCore",first:"Pagination",previous:"Pagination",next:"Pagination",last:"Pagination",linked:"IntegratedCharts",loadingMenuItems:"MenuCore",unlinked:"IntegratedCharts",menu:"ColumnHeaderComp",legacyMenu:"ColumnMenu",filter:"ColumnFilter",filterActive:"ColumnFilter",filterTab:"ColumnMenu",filtersToolPanel:"FiltersToolPanel",columns:["MenuCore"],columnsToolPanel:["ColumnsToolPanel"],maximize:"EnterpriseCore",minimize:"EnterpriseCore",save:"MenuCore",columnGroupOpened:"ColumnGroupHeaderComp",columnGroupClosed:"ColumnGroupHeaderComp",accordionOpen:"EnterpriseCore",accordionClosed:"EnterpriseCore",accordionIndeterminate:"EnterpriseCore",columnSelectClosed:["ColumnsToolPanel","ColumnMenu"],columnSelectOpen:["ColumnsToolPanel","ColumnMenu"],columnSelectIndeterminate:["ColumnsToolPanel","ColumnMenu"],columnMovePin:"SharedDragAndDrop",columnMoveHide:"SharedDragAndDrop",columnMoveMove:"SharedDragAndDrop",columnMoveLeft:"SharedDragAndDrop",columnMoveRight:"SharedDragAndDrop",columnMoveGroup:"SharedDragAndDrop",columnMoveValue:"SharedDragAndDrop",columnMovePivot:"SharedDragAndDrop",dropNotAllowed:"SharedDragAndDrop",groupContracted:"GroupCellRenderer",groupExpanded:"GroupCellRenderer",setFilterGroupClosed:"SetFilter",setFilterGroupOpen:"SetFilter",setFilterGroupIndeterminate:"SetFilter",setFilterLoading:"SetFilter",close:"EnterpriseCore",check:"MenuItem",colorPicker:"CommunityCore",groupLoading:"LoadingCellRenderer",menuAlt:"ColumnHeaderComp",menuPin:"MenuCore",menuValue:"MenuCore",menuAddRowGroup:["MenuCore","ColumnsToolPanel"],menuRemoveRowGroup:["MenuCore","ColumnsToolPanel"],clipboardCopy:"MenuCore",clipboardCut:"MenuCore",clipboardPaste:"MenuCore",pivotPanel:["ColumnsToolPanel","RowGroupingPanel"],rowGroupPanel:["ColumnsToolPanel","RowGroupingPanel"],valuePanel:"ColumnsToolPanel",columnDrag:"EnterpriseCore",rowDrag:["RowDrag","DragAndDrop"],csvExport:"MenuCore",excelExport:"MenuCore",smallDown:"CommunityCore",selectOpen:"CommunityCore",richSelectOpen:"RichSelect",richSelectRemove:"RichSelect",smallLeft:"CommunityCore",smallRight:"CommunityCore",subMenuOpen:"MenuItem",subMenuOpenRtl:"MenuItem",panelDelimiter:"RowGroupingPanel",panelDelimiterRtl:"RowGroupingPanel",smallUp:"CommunityCore",sortAscending:["MenuCore","Sort"],sortDescending:["MenuCore","Sort"],sortUnSort:["MenuCore","Sort"],advancedFilterBuilder:"AdvancedFilter",advancedFilterBuilderDrag:"AdvancedFilter",advancedFilterBuilderInvalid:"AdvancedFilter",advancedFilterBuilderMoveUp:"AdvancedFilter",advancedFilterBuilderMoveDown:"AdvancedFilter",advancedFilterBuilderAdd:"AdvancedFilter",advancedFilterBuilderRemove:"AdvancedFilter",advancedFilterBuilderSelectOpen:"AdvancedFilter",chartsMenu:"IntegratedCharts",chartsMenuEdit:"IntegratedCharts",chartsMenuAdvancedSettings:"IntegratedCharts",chartsMenuAdd:"IntegratedCharts",chartsColorPicker:"IntegratedCharts",chartsThemePrevious:"IntegratedCharts",chartsThemeNext:"IntegratedCharts",chartsDownload:"IntegratedCharts",checkboxChecked:"CommunityCore",checkboxIndeterminate:"CommunityCore",checkboxUnchecked:"CommunityCore",radioButtonOn:"CommunityCore",radioButtonOff:"CommunityCore"},det=new Set(["colorPicker","smallUp","checkboxChecked","checkboxIndeterminate","checkboxUnchecked","radioButtonOn","radioButtonOff","smallDown","smallLeft","smallRight"]),het={pinSubMenu:"PinnedColumn",pinLeft:"PinnedColumn",pinRight:"PinnedColumn",clearPinned:"PinnedColumn",valueAggSubMenu:"SharedAggregation",autoSizeThis:"ColumnAutoSize",autoSizeAll:"ColumnAutoSize",rowGroup:"SharedRowGrouping",rowUnGroup:"SharedRowGrouping",resetColumns:"CommunityCore",expandAll:["ClientSideRowModelHierarchy","ServerSideRowModel"],contractAll:["ClientSideRowModelHierarchy","ServerSideRowModel"],copy:"Clipboard",copyWithHeaders:"Clipboard",copyWithGroupHeaders:"Clipboard",cut:"Clipboard",paste:"Clipboard",export:["CsvExport","ExcelExport"],csvExport:"CsvExport",excelExport:"ExcelExport",separator:"CommunityCore",pivotChart:"IntegratedCharts",chartRange:"IntegratedCharts",columnFilter:"ColumnFilter",columnChooser:"ColumnMenu",sortAscending:"Sort",sortDescending:"Sort",sortUnSort:"Sort"},fet=class extends X{constructor(){super(...arguments),this.beanName="validation"}wireBeans(e){this.gridOptions=e.gridOptions,S9e(this)}postConstruct(){this.processGridOptions(this.gridOptions)}warnOnInitialPropertyUpdate(e,t){e==="api"&&HZe[t]&&ue(22,{key:t})}processGridOptions(e){this.processOptions(e,aet())}validateApiFunction(e,t){return UZe(e,t,this.beans)}missingUserComponent(e,t,n,i){const r=Nf[t];r?this.gos.assertModuleRegistered(r,`AG Grid '${e}' component: ${t}`):ue(101,{propertyName:e,componentName:t,agGridDefaults:n,jsComps:i})}checkRowEvents(e){get.has(e)&&ue(10,{eventType:e})}validateIcon(e){if(det.has(e)&&ue(43,{iconName:e}),uet[e])return;const t=cet[e];if(t){wt(200,{reasonOrId:`icon '${e}'`,moduleName:t,gridScoped:yN(),gridId:this.beans.context.getGridId(),rowModelType:this.gos.get("rowModelType"),additionalText:"Alternatively, use the CSS icon name directly."});return}ue(134,{iconName:e})}validateMenuItem(e){const t=het[e];t&&this.gos.assertModuleRegistered(t,`menu item '${e}'`)}isProvidedUserComp(e){return!!Nf[e]}validateColDef(e,t,n){(n||!this.beans.dataTypeSvc?.isColPendingInference(t))&&this.processOptions(e,Aie())}processOptions(e,t){const{validations:n,deprecations:i,allProperties:r,propertyExceptions:s,objectName:o,docsUrl:a}=t;r&&this.gridOptions.suppressPropertyNamesCheck!==!0&&this.checkProperties(e,[...s??[],...Object.keys(i)],r,o,a);const l=new Set,u=d=>{const h=n[d];if(h)if(typeof h=="function"){const p=h(e,this.gridOptions,this.beans);if(!p)return;if("objectName"in p){const g=e[d];if(Array.isArray(g)){g.forEach(v=>{this.processOptions(v,p)});return}this.processOptions(e[d],p);return}return p}else return h;else return};Object.keys(e).forEach(d=>{const h=i[d];if(h){const{message:x,version:E}=h;l.add(`As of v${E}, ${String(d)} is deprecated. ${x??""}`)}const p=e[d];if(p==null||p===!1)return;const g=u(d);if(!g)return;const{module:v,dependencies:C,validate:y,supportedRowModels:b,expectedType:S}=g;if(S){const x=typeof p;if(x!==S){l.add(`${String(d)} should be of type '${S}' but received '${x}' (${p}).`);return}}if(b){const x=this.gridOptions.rowModelType??"clientSide";if(!b.includes(x)){l.add(`${String(d)} is not supported with the '${x}' row model. It is only valid with: ${b.join(", ")}.`);return}}if(v){const x=Array.isArray(v)?v:[v];let E=!0;if(x.forEach(A=>{this.gos.assertModuleRegistered(A,String(d))||(E=!1)}),!E)return}if(C){const x=this.checkForRequiredDependencies(d,C,e);if(x){l.add(x);return}}if(y){const x=y(e,this.gridOptions,this.beans);if(x){l.add(x);return}}}),l.size>0&&l.forEach(d=>{cv(d)})}checkForRequiredDependencies(e,t,n){const r=Object.entries(t).filter(([s,o])=>{const a=n[s];return!o.required.includes(a)});return r.length===0?null:r.map(([s,o])=>`'${String(e)}' requires '${s}' to be one of [${o.required.map(a=>a===null?"null":a===void 0?"undefined":a).join(", ")}]. ${o.reason??""}`).join(`
           `)}checkProperties(e,t,n,i,r){const s=["__ob__","__v_skip","__metadata__"],o=pet(Object.getOwnPropertyNames(e),[...s,...t,...n],n),a=Object.keys(o);for(const l of a){const u=o[l];let c=`invalid ${i} property '${l}' did you mean any of these: ${u.slice(0,8).join(", ")}.`;n.includes("context")&&(c+=`
If you are trying to annotate ${i} with application data, use the '${i}.context' property instead.`),cv(c)}if(a.length>0&&r){const l=this.beans.frameworkOverrides.getDocLink(r);cv(`to see all the valid ${i} properties please check: ${l}`)}}getConsoleMessage(e,t){return ZZe(e,t)}};function pet(e,t,n){const i={},r=e.filter(s=>!t.some(o=>o===s));return r.length>0&&r.forEach(s=>i[s]=Eie({inputValue:s,allSuggestions:n}).values),i}var get=new Set(["firstChildChanged","lastChildChanged","childIndexChanged"]),met={moduleName:"Validation",version:Ce,beans:[fet]};function Die(e){e.sibling&&(e.sibling.childrenAfterFilter=e.childrenAfterFilter)}var vet=class extends X{constructor(){super(...arguments),this.beanName="filterStage",this.refreshProps=new Set(["excludeChildrenWhenTreeDataFiltering"]),this.step="filter"}wireBeans(e){this.filterManager=e.filterManager}execute(e){const{changedPath:t}=e;this.filter(t)}filter(e){const t=!!this.filterManager?.isChildFilterPresent();this.filterNodes(t,e)}filterNodes(e,t){const n=(i,r)=>{i.hasChildren()&&e&&!r?i.childrenAfterFilter=i.childrenAfterGroup.filter(s=>{const o=s.childrenAfterFilter&&s.childrenAfterFilter.length>0,a=s.data&&this.filterManager.doesRowPassFilter({rowNode:s});return o||a}):i.childrenAfterFilter=i.childrenAfterGroup,Die(i)};if(this.doingTreeDataFiltering()){const i=(s,o)=>{if(s.childrenAfterGroup)for(let a=0;a<s.childrenAfterGroup.length;a++){const l=s.childrenAfterGroup[a],u=o||this.filterManager.doesRowPassFilter({rowNode:l});l.childrenAfterGroup?i(s.childrenAfterGroup[a],u):n(l,u)}n(s,o)},r=s=>i(s,!1);t.executeFromRootNode(r)}else{const i=r=>n(r,!1);t.forEachChangedNodeDepthFirst(i,!0)}}doingTreeDataFiltering(){return this.gos.get("treeData")&&!this.gos.get("excludeChildrenWhenTreeDataFiltering")}},Cet=class extends DN{constructor(){super(...arguments),this.iconCreated=!1}setComp(e,t,n,i,r){this.comp=e;const s=wC(this,this.beans.context,r);this.eButtonShowMainFilter=n,this.eFloatingFilterBody=i,this.setGui(t,s),this.setupActive(),this.refreshHeaderStyles(),this.setupWidth(s),this.setupLeft(s),this.setupHover(s),this.setupFocus(s),this.setupAria(),this.setupFilterButton(),this.setupUserComp(),this.setupSyncWithFilter(s),this.setupUi(),s.addManagedElementListeners(this.eButtonShowMainFilter,{click:this.showParentFilter.bind(this)}),this.setupFilterChangedListener(s),s.addManagedListeners(this.column,{colDefChanged:()=>this.onColDefChanged(s)}),s.addDestroyFunc(()=>{this.eButtonShowMainFilter=null,this.eFloatingFilterBody=null,this.userCompDetails=null,this.clearComponent()})}resizeHeader(){}moveHeader(){}getHeaderClassParams(){const{column:e,beans:t}=this,n=e.colDef;return Ne(t.gos,{colDef:n,column:e,floatingFilter:!0})}setupActive(){const e=this.column.getColDef(),t=!!e.filter,n=!!e.floatingFilter;this.active=t&&n}setupUi(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton),!this.active||this.iconCreated)return;const e=As("filter",this.beans,this.column);e&&(this.iconCreated=!0,this.eButtonShowMainFilter.appendChild(e))}setupFocus(e){e.createManagedBean(new vg(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}setupAria(){const e=this.getLocaleTextFunc();TR(this.eButtonShowMainFilter,e("ariaFilterMenuOpen","Open Filter Menu"))}onTabKeyDown(e){const{beans:t}=this;if(Xt(t)===this.eGui)return;const r=xh(t,this.eGui,null,e.shiftKey);if(r){t.headerNavigation?.scrollToColumn(this.column),e.preventDefault(),r.focus();return}const s=this.findNextColumnWithFloatingFilter(e.shiftKey);s&&t.focusSvc.focusHeaderPosition({headerPosition:{headerRowIndex:this.rowCtrl.rowIndex,column:s},event:e})&&e.preventDefault()}findNextColumnWithFloatingFilter(e){const t=this.beans.visibleCols;let n=this.column;do if(n=e?t.getColBefore(n):t.getColAfter(n),!n)break;while(!n.getColDef().filter||!n.getColDef().floatingFilter);return n}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();switch(e.key){case K.UP:case K.DOWN:t||e.preventDefault();case K.LEFT:case K.RIGHT:if(t)return;e.stopPropagation();case K.ENTER:t&&eh(this.eGui)&&e.preventDefault();break;case K.ESCAPE:t||this.eGui.focus()}}onFocusIn(e){if(this.eGui.contains(e.relatedTarget))return;const n=!!e.relatedTarget&&!e.relatedTarget.classList.contains("ag-floating-filter"),i=!!e.relatedTarget&&xd(e.relatedTarget,"ag-floating-filter");if(n&&i&&e.target===this.eGui){const r=this.lastFocusEvent,s=!!(r&&r.key===K.TAB);if(r&&s){const o=r.shiftKey;eh(this.eGui,o)}}this.focusThis()}setupHover(e){this.beans.colHover?.addHeaderFilterColumnHoverListener(e,this.comp,this.column,this.eGui)}setupLeft(e){const t=new AN(this.column,this.eGui,this.beans);e.createManagedBean(t)}setupFilterButton(){this.suppressFilterButton=!this.beans.menuSvc?.isFloatingFilterButtonEnabled(this.column),this.highlightFilterButtonWhenActive=!Ur(this.gos)}setupUserComp(){if(!this.active)return;const e=this.beans.filterManager?.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter());e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setCompDetails(e)}showParentFilter(){const e=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;this.beans.menuSvc?.showFilterMenu({column:this.column,buttonElement:e,containerType:"floatingFilter",positionBy:"button"})}setupSyncWithFilter(e){if(!this.active)return;const{filterManager:t}=this.beans,n=i=>{if(i?.source==="filterDestroyed"&&!this.isAlive())return;const r=this.comp.getFloatingFilterComp();r&&r.then(s=>{if(s){const o=t?.getCurrentFloatingFilterParentModel(this.column),a=i?{...i,columns:i.columns??[],source:i.source==="api"?"api":"columnFilter"}:null;s.onParentModelChanged(o,a)}})};[this.destroySyncListener]=e.addManagedListeners(this.column,{filterChanged:n}),t?.isFilterActive(this.column)&&n(null)}setupWidth(e){const t=()=>{const n=`${this.column.getActualWidth()}px`;this.comp.setWidth(n)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupFilterChangedListener(e){this.active&&([this.destroyFilterChangedListener]=e.addManagedListeners(this.column,{filterChanged:this.updateFilterButton.bind(this)}),this.updateFilterButton())}updateFilterButton(){if(!this.suppressFilterButton&&this.comp){const e=!!this.beans.filterManager?.isFilterAllowed(this.column);this.comp.setButtonWrapperDisplayed(e),this.highlightFilterButtonWhenActive&&e&&this.eButtonShowMainFilter.classList.toggle("ag-filter-active",this.column.isFilterActive())}}onColDefChanged(e){const t=this.active;this.setupActive();const n=!t&&this.active;t&&!this.active&&(this.destroySyncListener(),this.destroyFilterChangedListener());const i=this.active?this.beans.filterManager?.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter()):null,r=this.comp.getFloatingFilterComp();!r||!i?this.updateCompDetails(e,i,n):r.then(s=>{!s||this.beans.filterManager?.areFilterCompsDifferent(this.userCompDetails??null,i)?this.updateCompDetails(e,i,n):this.updateFloatingFilterParams(i)})}updateCompDetails(e,t,n){this.isAlive()&&(this.setCompDetails(t),this.setupFilterButton(),this.setupUi(),n&&(this.setupSyncWithFilter(e),this.setupFilterChangedListener(e)))}updateFloatingFilterParams(e){if(!e)return;const t=e.params;this.comp.getFloatingFilterComp()?.then(n=>{n?.refresh&&typeof n.refresh=="function"&&n.refresh(t)})}addResizeAndMoveKeyboardListeners(){}destroy(){super.destroy(),this.destroySyncListener=null,this.destroyFilterChangedListener=null}};function yet(e,t){const n=e.colModel.getCol(t);if(!n){wt(12,{colKey:t});return}e.menuSvc?.showColumnMenu({column:n,positionBy:"auto"})}function wet(e){e.menuSvc?.hidePopupMenu()}var bet={moduleName:"SharedMenu",version:Ce,beans:[nKe],apiFunctions:{showColumnMenu:yet,hidePopupMenu:wet}},xet=0,Ret=200,Eet=class extends X{constructor(){super(...arguments),this.beanName="popupSvc",this.popupList=[]}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridCtrl=e.gridCtrl}),this.addManagedEventListeners({gridStylesChanged:this.handleThemeChange.bind(this)})}getPopupParent(){const e=this.gos.get("popupParent");return e||this.gridCtrl.getGui()}positionPopupForMenu(e){const{eventSource:t,ePopup:n,column:i,node:r,event:s}=e,o=t.getBoundingClientRect(),a=this.getParentRect();this.setAlignedTo(t,n);let l=!1;const u=()=>{const c=this.keepXYWithinBounds(n,o.top-a.top,0),d=n.clientWidth>0?n.clientWidth:200;l||(n.style.minWidth=`${d}px`,l=!0);const p=a.right-a.left-d;let g;return this.gos.get("enableRtl")?(g=C(),g<0&&(g=v(),this.setAlignedStyles(n,"left")),g>p&&(g=0,this.setAlignedStyles(n,"right"))):(g=v(),g>p&&(g=C(),this.setAlignedStyles(n,"right")),g<0&&(g=0,this.setAlignedStyles(n,"left"))),{x:g,y:c};function v(){return o.right-a.left-2}function C(){return o.left-a.left-d}};this.positionPopup({ePopup:n,keepWithinBounds:!0,updatePosition:u,postProcessCallback:()=>this.callPostProcessPopup("subMenu",n,t,s instanceof MouseEvent?s:void 0,i,r)})}positionPopupUnderMouseEvent(e){const{ePopup:t,nudgeX:n,nudgeY:i,skipObserver:r}=e;this.positionPopup({ePopup:t,nudgeX:n,nudgeY:i,keepWithinBounds:!0,skipObserver:r,updatePosition:()=>this.calculatePointerAlign(e.mouseEvent),postProcessCallback:()=>this.callPostProcessPopup(e.type,e.ePopup,null,e.mouseEvent,e.column,e.rowNode)})}calculatePointerAlign(e){const t=this.getParentRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}positionPopupByComponent(e){const{ePopup:t,nudgeX:n,nudgeY:i,keepWithinBounds:r,eventSource:s,alignSide:o="left",position:a="over",column:l,rowNode:u,type:c}=e,d=s.getBoundingClientRect(),h=this.getParentRect();this.setAlignedTo(s,t);const p=()=>{let g=d.left-h.left;o==="right"&&(g-=t.offsetWidth-d.width);let v;return a==="over"?(v=d.top-h.top,this.setAlignedStyles(t,"over")):(this.setAlignedStyles(t,"under"),this.shouldRenderUnderOrAbove(t,d,h,e.nudgeY||0)==="under"?v=d.top-h.top+d.height:v=d.top-t.offsetHeight-(i||0)*2-h.top),{x:g,y:v}};this.positionPopup({ePopup:t,nudgeX:n,nudgeY:i,keepWithinBounds:r,updatePosition:p,postProcessCallback:()=>this.callPostProcessPopup(c,t,s,null,l,u)})}shouldRenderUnderOrAbove(e,t,n,i){const r=n.bottom-t.bottom,s=t.top-n.top,o=e.offsetHeight+i;return r>o?"under":s>o||s>r?"above":"under"}setAlignedStyles(e,t){const n=this.getPopupIndex(e);if(n===-1)return;const i=this.popupList[n],{alignedToElement:r}=i;!r||(["right","left","over","above","under"].forEach(o=>{r.classList.remove(`ag-has-popup-positioned-${o}`),e.classList.remove(`ag-popup-positioned-${o}`)}),!t)||(r.classList.add(`ag-has-popup-positioned-${t}`),e.classList.add(`ag-popup-positioned-${t}`))}setAlignedTo(e,t){const n=this.getPopupIndex(t);if(n!==-1){const i=this.popupList[n];i.alignedToElement=e}}callPostProcessPopup(e,t,n,i,r,s){const o=this.gos.getCallback("postProcessPopup");o&&o({column:r,rowNode:s,ePopup:t,type:e,eventSource:n,mouseEvent:i})}positionPopup(e){const{ePopup:t,keepWithinBounds:n,nudgeX:i,nudgeY:r,skipObserver:s,updatePosition:o}=e,a={width:0,height:0},l=(u=!1)=>{let{x:c,y:d}=o();u&&t.clientWidth===a.width&&t.clientHeight===a.height||(a.width=t.clientWidth,a.height=t.clientHeight,i&&(c+=i),r&&(d+=r),n&&(c=this.keepXYWithinBounds(t,c,1),d=this.keepXYWithinBounds(t,d,0)),t.style.left=`${c}px`,t.style.top=`${d}px`,e.postProcessCallback&&e.postProcessCallback())};if(l(),!s){const u=Pc(this.beans,t,()=>l(!0));setTimeout(()=>u(),Ret)}}getActivePopups(){return this.popupList.map(e=>e.element)}getParentRect(){const e=Rn(this.beans);let t=this.getPopupParent();return t===e.body?t=e.documentElement:getComputedStyle(t).position==="static"&&(t=t.offsetParent),Tte(t)}keepXYWithinBounds(e,t,n){const i=n===0,r=i?"clientHeight":"clientWidth",s=i?"top":"left",o=i?"height":"width",a=i?"scrollTop":"scrollLeft",l=Rn(this.beans),u=l.documentElement,c=this.getPopupParent(),d=e.getBoundingClientRect(),h=c.getBoundingClientRect(),p=l.documentElement.getBoundingClientRect(),g=c===l.body,v=Math.ceil(d[o]);let y=g?(i?kte:GS)(u)+u[a]:c[r];g&&(y-=Math.abs(p[s]-h[s]));const b=y-v;return Math.min(Math.max(t,0),Math.abs(b))}addPopup(e){const t=Rn(this.beans),{eChild:n,ariaLabel:i,alwaysOnTop:r,positionCallback:s,anchorToElement:o}=e;if(!t)return ue(122),{hideFunc:()=>{}};const a=this.getPopupIndex(n);if(a!==-1)return{hideFunc:this.popupList[a].hideFunc};this.initialisePopupPosition(n);const l=this.createPopupWrapper(n,i,!!r),u=this.addEventListenersToPopup({...e,wrapperEl:l});return s&&s(),this.addPopupToPopupList(n,l,u,o),{hideFunc:u}}initialisePopupPosition(e){const n=this.getPopupParent().getBoundingClientRect();me(e.style.top)||(e.style.top=`${n.top*-1}px`),me(e.style.left)||(e.style.left=`${n.left*-1}px`)}createPopupWrapper(e,t,n){const i=this.getPopupParent(),{environment:r,gos:s}=this.beans,o=Cn({tag:"div"});return r.applyThemeClasses(o),o.classList.add("ag-popup"),e.classList.add(s.get("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),e.hasAttribute("role")||Bl(e,"dialog"),TR(e,t),o.appendChild(e),i.appendChild(o),n?this.setAlwaysOnTop(e,!0):this.bringPopupToFront(e),o}handleThemeChange(e){if(e.themeChanged){const t=this.beans.environment;for(const n of this.popupList)t.applyThemeClasses(n.wrapper)}}addEventListenersToPopup(e){const t=this.beans,n=Rn(t),i=this.getPopupParent(),{wrapperEl:r,eChild:s,closedCallback:o,afterGuiAttached:a,closeOnEsc:l,modal:u}=e;let c=!1;const d=v=>{if(!r.contains(Xt(t)))return;v.key===K.ESCAPE&&!El(v)&&g({keyboardEvent:v})},h=v=>g({mouseEvent:v}),p=v=>g({touchEvent:v}),g=(v={})=>{const{mouseEvent:C,touchEvent:y,keyboardEvent:b,forceHide:S}=v;!S&&(this.isEventFromCurrentPopup({mouseEvent:C,touchEvent:y},s)||c)||(c=!0,i.removeChild(r),n.removeEventListener("keydown",d),n.removeEventListener("mousedown",h),n.removeEventListener("touchstart",p),n.removeEventListener("contextmenu",h),this.eventSvc.removeEventListener("dragStarted",h),o&&o(C||y||b),this.removePopupFromPopupList(s))};return a&&a({hidePopup:g}),window.setTimeout(()=>{l&&n.addEventListener("keydown",d),u&&(n.addEventListener("mousedown",h),this.eventSvc.addEventListener("dragStarted",h),n.addEventListener("touchstart",p),n.addEventListener("contextmenu",h))},0),g}addPopupToPopupList(e,t,n,i){this.popupList.push({element:e,wrapper:t,hideFunc:n,instanceId:xet++,isAnchored:!!i}),i&&this.setPopupPositionRelatedToElement(e,i)}getPopupIndex(e){return this.popupList.findIndex(t=>t.element===e)}setPopupPositionRelatedToElement(e,t){const n=this.getPopupIndex(e);if(n===-1)return;const i=this.popupList[n];if(i.stopAnchoringPromise&&i.stopAnchoringPromise.then(s=>s&&s()),i.stopAnchoringPromise=void 0,i.isAnchored=!1,!t)return;const r=this.keepPopupPositionedRelativeTo({element:t,ePopup:e,hidePopup:i.hideFunc});return i.stopAnchoringPromise=r,i.isAnchored=!0,r}removePopupFromPopupList(e){this.setAlignedStyles(e,null),this.setPopupPositionRelatedToElement(e,null),this.popupList=this.popupList.filter(t=>t.element!==e)}keepPopupPositionedRelativeTo(e){const t=this.getPopupParent(),n=t.getBoundingClientRect(),{element:i,ePopup:r}=e,s=i.getBoundingClientRect(),o=d=>parseInt(d.substring(0,d.length-1),10),a=(d,h)=>{const p=n[d]-s[d],g=o(r.style[d]);return{initialDiff:p,lastDiff:p,initial:g,last:g,direction:h}},l=a("top",0),u=a("left",1),c=this.beans.frameworkOverrides;return new Ji(d=>{c.wrapIncoming(()=>{c.setInterval(()=>{const h=t.getBoundingClientRect(),p=i.getBoundingClientRect();if(p.top==0&&p.left==0&&p.height==0&&p.width==0){e.hidePopup();return}const v=(C,y)=>{const b=o(r.style[y]);C.last!==b&&(C.initial=b,C.last=b);const S=h[y]-p[y];if(S!=C.lastDiff){const x=this.keepXYWithinBounds(r,C.initial+C.initialDiff-S,C.direction);r.style[y]=`${x}px`,C.last=x}C.lastDiff=S};v(l,"top"),v(u,"left")},200).then(h=>{d(()=>{h!=null&&window.clearInterval(h)})})},"popupPositioning")})}hasAnchoredPopup(){return this.popupList.some(e=>e.isAnchored)}isEventFromCurrentPopup(e,t){const{mouseEvent:n,touchEvent:i}=e,r=n||i;if(!r)return!1;const s=this.getPopupIndex(t);if(s===-1)return!1;for(let o=s;o<this.popupList.length;o++){const a=this.popupList[o];if(q9e(a.element,r))return!0}return this.isElementWithinCustomPopup(r.target)}isElementWithinCustomPopup(e){const t=Rn(this.beans);for(;e&&e!==t.body;){if(e.classList.contains("ag-custom-component-popup")||e.parentElement===null)return!0;e=e.parentElement}return!1}getWrapper(e){for(;!e.classList.contains("ag-popup")&&e.parentElement;)e=e.parentElement;return e.classList.contains("ag-popup")?e:null}setAlwaysOnTop(e,t){const n=this.getWrapper(e);n&&(n.classList.toggle("ag-always-on-top",!!t),t&&this.bringPopupToFront(n))}bringPopupToFront(e){const t=this.getPopupParent(),n=Array.prototype.slice.call(t.querySelectorAll(".ag-popup")),i=n.length,r=this.getWrapper(e);if(!r||i<=1||!t.contains(e))return;const s=[],o=[];for(const h of n)h!==r&&(h.classList.contains("ag-always-on-top")?o.push(h):s.push(h));const a=[],l=o.length,d=r.classList.contains("ag-always-on-top")||!l?[...s,...o,r]:[...s,r,...o];for(let h=0;h<=i;h++){const p=d[h];if(n[h]===d[h]||p===r)continue;p.querySelectorAll("div").forEach(v=>{v.scrollTop!==0&&a.push([v,v.scrollTop])}),h===0?t.insertAdjacentElement("afterbegin",p):d[h-1].insertAdjacentElement("afterend",p)}for(;a.length;){const h=a.pop();h[0].scrollTop=h[1]}}},$R={moduleName:"Popup",version:Ce,beans:[Eet]},Fet=".ag-set-filter{--ag-indentation-level:0}.ag-set-filter-item{align-items:center;display:flex;height:100%}:where(.ag-ltr) .ag-set-filter-item{padding-left:calc(var(--ag-widget-container-horizontal-padding) + var(--ag-indentation-level)*var(--ag-set-filter-indent-size))}:where(.ag-rtl) .ag-set-filter-item{padding-right:calc(var(--ag-widget-container-horizontal-padding) + var(--ag-indentation-level)*var(--ag-set-filter-indent-size))}.ag-set-filter-item-checkbox{display:flex;height:100%;width:100%}.ag-set-filter-group-icons{display:block;>*{cursor:pointer}}:where(.ag-ltr) .ag-set-filter-group-icons{margin-right:var(--ag-widget-container-horizontal-padding)}:where(.ag-rtl) .ag-set-filter-group-icons{margin-left:var(--ag-widget-container-horizontal-padding)}.ag-filter-body-wrapper{display:flex;flex-direction:column}:where(.ag-menu:not(.ag-tabs) .ag-filter) .ag-filter-body-wrapper,:where(.ag-menu:not(.ag-tabs) .ag-filter)>:not(.ag-filter-wrapper){min-width:180px}.ag-filter-filter{flex:1 1 0px}.ag-filter-condition{display:flex;justify-content:center}.ag-floating-filter-body{display:flex;flex:1 1 auto;height:100%;position:relative}.ag-floating-filter-full-body{align-items:center;display:flex;flex:1 1 auto;height:100%;overflow:hidden;width:100%}:where(.ag-floating-filter-full-body)>div{flex:1 1 auto}.ag-floating-filter-input{align-items:center;display:flex;width:100%;>*{flex:1 1 auto}:where(.ag-input-field-input[type=date]){width:1px}}.ag-floating-filter-button{display:flex;flex:none}.ag-date-floating-filter-wrapper{display:flex}.ag-set-floating-filter-input [disabled]{pointer-events:none}.ag-floating-filter-button-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:none;height:var(--ag-icon-size);width:var(--ag-icon-size)}.ag-filter-loading{align-items:unset;background-color:var(--ag-chrome-background-color);height:100%;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);position:absolute;width:100%;z-index:1;:where(.ag-menu) &{background-color:var(--ag-menu-background-color)}}.ag-filter-separator{border-top:1px solid var(--menu-separator-color)}:where(.ag-filter-select) .ag-picker-field-wrapper{width:0}.ag-filter-condition-operator{height:17px}:where(.ag-ltr) .ag-filter-condition-operator-or{margin-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-filter-condition-operator-or{margin-right:calc(var(--ag-spacing)*2)}.ag-set-filter-select-all{padding-top:var(--ag-widget-container-vertical-padding)}.ag-filter-no-matches,.ag-set-filter-list{height:calc(var(--ag-list-item-height)*6)}.ag-filter-no-matches{padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}.ag-set-filter-tree-list{height:calc(var(--ag-list-item-height)*10)}.ag-set-filter-filter{margin-left:var(--ag-widget-container-horizontal-padding);margin-right:var(--ag-widget-container-horizontal-padding);margin-top:var(--ag-widget-container-vertical-padding)}.ag-filter-to{margin-top:var(--ag-widget-vertical-spacing)}.ag-mini-filter{margin:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}:where(.ag-ltr) .ag-set-filter-add-group-indent{margin-left:calc(var(--ag-icon-size) + var(--ag-widget-container-horizontal-padding))}:where(.ag-rtl) .ag-set-filter-add-group-indent{margin-right:calc(var(--ag-icon-size) + var(--ag-widget-container-horizontal-padding))}:where(.ag-filter-menu) .ag-set-filter-list{min-width:200px}.ag-filter-virtual-list-item:focus-visible{box-shadow:inset var(--ag-focus-shadow)}.ag-filter-apply-panel{display:flex;justify-content:flex-end;overflow:hidden;padding:var(--ag-widget-vertical-spacing) var(--ag-widget-container-horizontal-padding) var(--ag-widget-container-vertical-padding)}.ag-filter-apply-panel-button{line-height:1.5}:where(.ag-ltr) .ag-filter-apply-panel-button{margin-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-filter-apply-panel-button{margin-right:calc(var(--ag-spacing)*2)}.ag-simple-filter-body-wrapper{display:flex;flex-direction:column;min-height:calc(var(--ag-list-item-height) + var(--ag-widget-container-vertical-padding) + var(--ag-widget-vertical-spacing));overflow-y:auto;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);padding-bottom:calc(var(--ag-widget-container-vertical-padding) - var(--ag-widget-vertical-spacing));&>*{margin-bottom:var(--ag-widget-vertical-spacing)}:where(.ag-resizer-wrapper){margin:0}}.ag-multi-filter-menu-item{margin:var(--ag-spacing) 0}.ag-multi-filter-group-title-bar{background-color:transparent;color:var(--ag-header-text-color);font-weight:500;padding:calc(var(--ag-spacing)*1.5) var(--ag-spacing)}.ag-group-filter-field-select-wrapper{display:flex;flex-direction:column;gap:var(--ag-widget-vertical-spacing);padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}";function Aet(e){const t=e.filterManager;return!!t?.isColumnFilterPresent()||!!t?.isAggregateFilterPresent()}function Det(e,t){return e.filterManager?.getColumnFilterInstance(t)??Promise.resolve(void 0)}function Pet(e,t){const n=e.colModel.getColDefCol(t);if(n)return e.filterManager?.destroyFilter(n,"api")}function ket(e,t){e.frameworkOverrides.wrapIncoming(()=>e.filterManager?.setFilterModel(t))}function Tet(e){return e.filterManager?.getFilterModel()??{}}function Met(e,t){return e.filterManager?.getColumnFilterModel(t)??null}function Iet(e,t,n){return e.filterManager?.setColumnFilterModel(t,n)??Promise.resolve()}function _et(e,t){const n=e.colModel.getCol(t);if(!n){wt(12,{colKey:t});return}e.menuSvc?.showFilterMenu({column:n,containerType:"columnFilter",positionBy:"auto"})}var FW={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},AW=["january","february","march","april","may","june","july","august","september","october","november","december"];function Oet(e,t){return e==null?-1:t==null?1:parseFloat(e)-parseFloat(t)}var Let=class extends X{constructor(){super(...arguments),this.beanName="colFilter",this.allColumnFilters=new Map,this.allColumnListeners=new Map,this.activeAggregateFilters=[],this.activeColumnFilters=[],this.processingFilterChange=!1,this.filterModelUpdateQueue=[],this.columnFilterModelUpdateQueue=[]}postConstruct(){this.addManagedEventListeners({gridColumnsChanged:this.onColumnsChanged.bind(this),beforeRefreshModel:({params:e})=>{(e.rowDataUpdated||e.changedProps?.has("treeData"))&&this.onNewRowsLoaded("rowDataUpdated")},dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)}),this.initialFilterModel={...this.gos.get("initialState")?.filter?.filterModel??{}}}setFilterModel(e,t="api"){const{colModel:n,dataTypeSvc:i,filterManager:r}=this.beans;if(i?.isPendingInference){this.filterModelUpdateQueue.push({model:e,source:t});return}const s=[],o=this.getFilterModel(!0);if(e){const a=new Set(Object.keys(e));this.allColumnFilters.forEach((l,u)=>{const c=e[u];s.push(pw(l.filterPromise,c)),a.delete(u)}),a.forEach(l=>{const u=n.getColDefCol(l)||n.getCol(l);if(!u){ue(62,{colId:l});return}if(!u.isFilterAllowed()){ue(63,{colId:l});return}const c=this.getOrCreateFilterWrapper(u);if(!c){ue(64,{colId:l});return}s.push(pw(c.filterPromise,e[l]))})}else this.allColumnFilters.forEach(a=>{s.push(pw(a.filterPromise,null))});Ji.all(s).then(()=>{const a=this.getFilterModel(!0),l=[];this.allColumnFilters.forEach((u,c)=>{const d=o?o[c]:null,h=a?a[c]:null;l0(d,h)||l.push(u.column)}),l.length>0&&r?.onFilterChanged({columns:l,source:t})})}getFilterModel(e){const t={},{allColumnFilters:n,initialFilterModel:i,beans:{colModel:r}}=this;if(n.forEach((s,o)=>{const a=this.getModelFromFilterWrapper(s);me(a)&&(t[o]=a)}),!e)for(const s of Object.keys(i)){const o=i[s];me(o)&&!n.has(s)&&r.getCol(s)?.isFilterAllowed()&&(t[s]=o)}return t}getModelFromFilterWrapper(e){const{filter:t}=e;return t?typeof t.getModel!="function"?(ue(66),null):t.getModel():this.getModelFromInitialState(e.column)}getModelFromInitialState(e){return this.initialFilterModel[e.getColId()]??null}isColumnFilterPresent(){return this.activeColumnFilters.length>0}isAggregateFilterPresent(){return!!this.activeAggregateFilters.length}disableColumnFilters(){this.initialFilterModel={};const{allColumnFilters:e}=this;return e.size?(e.forEach(t=>this.disposeFilterWrapper(t,"advancedFilterEnabled")),!0):!1}doAggregateFiltersPass(e,t){return this.doColumnFiltersPass(e,t,!0)}updateActiveFilters(){const e=a=>a?a.isFilterActive?a.isFilterActive():(ue(67),!1):!1,{colModel:t,gos:n}=this.beans,i=!!kT(n),r=a=>{if(!a.isPrimary())return!0;const u=!t.isPivotActive();return!a.isValueActive()||!u?!1:t.isPivotMode()?!0:i},s=[],o=[];return this.forEachColumnFilter((a,l)=>{e(a)&&(r(l.column)?s.push(a):o.push(a))}).then(()=>{this.activeAggregateFilters=s,this.activeColumnFilters=o})}updateFilterFlagInColumns(e,t){return this.forEachColumnFilter((n,i)=>this.setColFilterActive(i.column,n.isFilterActive(),e,t))}forEachColumnFilter(e){const t=[];return this.allColumnFilters.forEach(n=>{const i=n.filterPromise;i&&t.push(i.then(r=>e(r,n)))}),Ji.all(t)}doColumnFiltersPass(e,t,n){const{data:i,aggData:r}=e,s=n?this.activeAggregateFilters:this.activeColumnFilters,o=n?r:i;for(let a=0;a<s.length;a++){const l=s[a];if(!(l==null||l===t)){if(typeof l.doesFilterPass!="function"){wt(91);continue}if(!l.doesFilterPass({node:e,data:o}))return!1}}return!0}callOnFilterChangedOutsideRenderCycle(e){const{rowRenderer:t,filterManager:n}=this.beans,i=()=>{this.isAlive()&&n?.onFilterChanged(e)};t.isRefreshInProgress()?setTimeout(i,0):i()}updateBeforeFilterChanged(e={}){const{filterInstance:t,additionalEventAttributes:n}=e;return this.updateDependentFilters(),this.updateActiveFilters().then(()=>this.updateFilterFlagInColumns("filterChanged",n).then(()=>{this.allColumnFilters.forEach(i=>{i.filterPromise&&i.filterPromise.then(r=>{r&&r!==t&&r.onAnyFilterChanged&&r.onAnyFilterChanged()})}),this.processingFilterChange=!0}))}updateAfterFilterChanged(){this.processingFilterChange=!1}isSuppressFlashingCellsBecauseFiltering(){return!(this.gos.get("allowShowChangeAfterFilter")??!1)&&this.processingFilterChange}onNewRowsLoaded(e){this.forEachColumnFilter(t=>{t.onNewRowsLoaded?.()}).then(()=>this.updateFilterFlagInColumns(e,{afterDataChange:!0})).then(()=>this.updateActiveFilters())}createGetValue(e){const{filterValueSvc:t,colModel:n}=this.beans;return(i,r)=>{const s=r?n.getCol(r):e;return s?t.getValue(s,i):void 0}}isFilterActive(e){const{filter:t}=this.cachedFilter(e)??{};return t?t.isFilterActive():this.getModelFromInitialState(e)!=null}getOrCreateFilterWrapper(e){if(!e.isFilterAllowed())return null;let t=this.cachedFilter(e);return t||(t=this.createFilterWrapper(e),this.setColumnFilterWrapper(e,t)),t}cachedFilter(e){return this.allColumnFilters.get(e.getColId())}getDefaultFilter(e){let t;const{gos:n,dataTypeSvc:i}=this.beans;if(yD(n))t="agSetColumnFilter";else{const r=i?.getBaseDataType(e);r==="number"?t="agNumberColumnFilter":r==="date"||r==="dateString"?t="agDateColumnFilter":t="agTextColumnFilter"}return t}getDefaultFloatingFilter(e){let t;const{gos:n,dataTypeSvc:i}=this.beans;if(yD(n))t="agSetColumnFloatingFilter";else{const r=i?.getBaseDataType(e);r==="number"?t="agNumberColumnFloatingFilter":r==="date"||r==="dateString"?t="agDateColumnFloatingFilter":t="agTextColumnFloatingFilter"}return t}createFilterInstance(e,t){const n=this.getDefaultFilter(e),i=e.getColDef();let r;const s={...this.createFilterParams(e,i),filterModifiedCallback:()=>this.filterModifiedCallbackFactory(r,e)(),filterChangedCallback:a=>this.filterChangedCallbackFactory(r,e)(a),doesRowPassOtherFilter:a=>this.beans.filterManager?.doesRowPassOtherFilters(r,a)??!0},o=eje(this.beans.userCompFactory,i,s,n);return o?{filterPromise:()=>{const a=o.newAgStackInstance();return a.then(l=>{r=l,t&&(t.filter=l??void 0)}),a},compDetails:o}:{filterPromise:null,compDetails:null}}createFilterParams(e,t){return Ne(this.gos,{column:e,colDef:t,rowModel:this.beans.rowModel,filterChangedCallback:()=>{},filterModifiedCallback:()=>{},getValue:this.createGetValue(e),doesRowPassOtherFilter:()=>!0})}createFilterWrapper(e){const t={column:e,filterPromise:null,compDetails:null},{filterPromise:n,compDetails:i}=this.createFilterInstance(e,t);return t.filterPromise=n?.()??null,t.compDetails=i,t}onColumnsChanged(){const e=[],{colModel:t,filterManager:n}=this.beans;this.allColumnFilters.forEach((r,s)=>{let o;r.column.isPrimary()?o=t.getColDefCol(s):o=t.getCol(s),!(o&&o===r.column)&&(e.push(r.column),this.disposeFilterWrapper(r,"columnChanged"),this.disposeColumnListener(s))});const i=e.every(DW);e.length>0&&!i?n?.onFilterChanged({columns:e,source:"api"}):this.updateDependentFilters()}updateDependentFilters(){this.beans.autoColSvc?.getColumns()?.forEach(e=>{DW(e)&&this.getOrCreateFilterWrapper(e)})}isFilterAllowed(e){if(!e.isFilterAllowed())return!1;const{filter:n}=this.allColumnFilters.get(e.getColId())??{};return n&&typeof n?.isFilterAllowed=="function"?n.isFilterAllowed():!0}getFloatingFilterCompDetails(e,t){const n=c=>{const d=this.getOrCreateFilterWrapper(e)?.filterPromise;d?.then(h=>{c(f0(h))})},i=e.getColDef(),r={...this.createFilterParams(e,i),filterChangedCallback:()=>n(c=>this.filterChangedCallbackFactory(c,e)())},{userCompFactory:s,frameworkOverrides:o}=this.beans,a=aje(s,i,r);let l=sqe(o,i,()=>this.getDefaultFloatingFilter(e));l==null&&(l="agReadOnlyFloatingFilter");const u=Ne(this.gos,{column:e,filterParams:a,currentParentModel:()=>this.getCurrentFloatingFilterParentModel(e),parentFilterInstance:n,showParentFilter:t});return sje(s,i,u,l)}getCurrentFloatingFilterParentModel(e){return this.getModelFromFilterWrapper(this.cachedFilter(e)??{column:e})}destroyFilter(e,t="api"){const n=e.getColId(),i=this.allColumnFilters.get(n);this.disposeColumnListener(n),delete this.initialFilterModel[n],i&&this.disposeFilterWrapper(i,t).then(r=>{r&&this.isAlive()&&this.beans.filterManager?.onFilterChanged({columns:[e],source:"api"})})}disposeColumnListener(e){const t=this.allColumnListeners.get(e);t&&(this.allColumnListeners.delete(e),t())}disposeFilterWrapper(e,t){return e.filterPromise?.then(n=>{const i=!!n?.isFilterActive();return this.destroyBean(n),this.setColFilterActive(e.column,!1,"filterDestroyed"),this.allColumnFilters.delete(e.column.getColId()),this.eventSvc.dispatchEvent({type:"filterDestroyed",source:t,column:e.column}),i})??Ji.resolve(!1)}filterModifiedCallbackFactory(e,t){return()=>{this.eventSvc.dispatchEvent({type:"filterModified",column:t,filterInstance:e})}}filterChangedCallbackFactory(e,t){return n=>{const i=n?.source??"columnFilter",r={filter:e,additionalEventAttributes:n,columns:[t],source:i};this.callOnFilterChangedOutsideRenderCycle(r)}}checkDestroyFilter(e){const t=this.allColumnFilters.get(e);if(!t)return;const n=t.column,{compDetails:i}=n.isFilterAllowed()?this.createFilterInstance(n):{compDetails:null};if(this.areFilterCompsDifferent(t.compDetails,i)){this.destroyFilter(n,"paramsUpdated");return}const r=n.getColDef().filterParams;if(!t.filterPromise){this.destroyFilter(n,"paramsUpdated");return}t.filterPromise.then(s=>{(s?.refresh?s.refresh({...this.createFilterParams(n,n.getColDef()),filterModifiedCallback:this.filterModifiedCallbackFactory(s,n),filterChangedCallback:this.filterChangedCallbackFactory(s,n),doesRowPassOtherFilter:a=>this.beans.filterManager?.doesRowPassOtherFilters(s,a)??!0,...r}):!0)===!1&&this.destroyFilter(n,"paramsUpdated")})}setColumnFilterWrapper(e,t){const n=e.getColId();this.allColumnFilters.set(n,t),this.allColumnListeners.set(n,this.addManagedListeners(e,{colDefChanged:()=>this.checkDestroyFilter(n)})[0])}areFilterCompsDifferent(e,t){if(!t||!e)return!0;const{componentClass:n}=e,{componentClass:i}=t;return!(n===i||n?.render&&i?.render&&n.render===i.render)}hasFloatingFilters(){return this.beans.colModel.getCols().some(t=>t.getColDef().floatingFilter)}getColumnFilterInstance(e){return new Promise(t=>{this.getFilterInstanceImpl(e).then(n=>{t(f0(n))})})}getFilterInstanceImpl(e){const t=this.beans.colModel.getColDefCol(e);return t?this.getOrCreateFilterWrapper(t)?.filterPromise??Ji.resolve(null):Ji.resolve(void 0)}processFilterModelUpdateQueue(){this.filterModelUpdateQueue.forEach(({model:e,source:t})=>this.setFilterModel(e,t)),this.filterModelUpdateQueue=[],this.columnFilterModelUpdateQueue.forEach(({key:e,model:t,resolve:n})=>{this.setColumnFilterModel(e,t).then(()=>n())}),this.columnFilterModelUpdateQueue=[]}getColumnFilterModel(e){const t=this.getFilterWrapper(e);return t?this.getModelFromFilterWrapper(t):null}setColumnFilterModel(e,t){const{colModel:n,dataTypeSvc:i}=this.beans;if(i?.isPendingInference){let a=()=>{};const l=new Promise(u=>{a=u});return this.columnFilterModelUpdateQueue.push({key:e,model:t,resolve:a}),l}const r=n.getColDefCol(e),s=r?this.getOrCreateFilterWrapper(r):null;return s?(a=>new Promise(l=>{a.then(u=>l(u))}))(pw(s.filterPromise,t)):Promise.resolve()}getFilterWrapper(e){const t=this.beans.colModel.getColDefCol(e);return t?this.cachedFilter(t)??null:null}setColDefPropertiesForDataType(e,t,n){const i=yD(this.gos),r=this.getLocaleTextFunc(),s=o=>{const{filterParams:a}=e;e.filterParams=typeof a=="object"?{...a,...o}:o};switch(t.baseDataType){case"number":{i&&s({comparator:Oet});break}case"boolean":{s(i?{valueFormatter:o=>me(o.value)?r(String(o.value),o.value?"True":"False"):r("blanks","(Blanks)")}:{maxNumConditions:1,debounceMs:0,filterOptions:["empty",{displayKey:"true",displayName:"True",predicate:(o,a)=>a,numberOfInputs:0},{displayKey:"false",displayName:"False",predicate:(o,a)=>a===!1,numberOfInputs:0}]});break}case"date":{s(i?{valueFormatter:o=>{const a=n(o);return me(a)?a:r("blanks","(Blanks)")},treeList:!0,treeListFormatter:(o,a)=>{if(o==="NaN")return r("invalidDate","Invalid Date");if(a===1&&o!=null){const l=AW[Number(o)-1];return r(l,FW[l])}return o??r("blanks","(Blanks)")}}:{isValidDate:PW});break}case"dateString":{const o=t.dateParser;s(i?{valueFormatter:a=>{const l=n(a);return me(l)?l:r("blanks","(Blanks)")},treeList:!0,treeListPathGetter:a=>{const l=o(a??void 0);return l?[String(l.getFullYear()),String(l.getMonth()+1),String(l.getDate())]:null},treeListFormatter:(a,l)=>{if(l===1&&a!=null){const u=AW[Number(a)-1];return r(u,FW[u])}return a??r("blanks","(Blanks)")}}:{comparator:(a,l)=>{const u=o(l);return l==null||u<a?-1:u>a?1:0},isValidDate:a=>typeof a=="string"&&PW(o(a))});break}case"object":{i?s({valueFormatter:o=>{const a=n(o);return me(a)?a:r("blanks","(Blanks)")}}):e.filterValueGetter=o=>n({column:o.column,node:o.node,value:this.beans.valueSvc.getValue(o.column,o.node)});break}}}setColFilterActive(e,t,n,i){e.filterActive!==t&&(e.filterActive=t,e.dispatchColEvent("filterActiveChanged",n)),e.dispatchColEvent("filterChanged",n,i)}destroy(){super.destroy(),this.allColumnFilters.forEach(e=>this.disposeFilterWrapper(e,"gridDestroyed")),this.allColumnListeners.clear()}};function pw(e,t){return e?new Ji(n=>{e.then(i=>{typeof i.setModel!="function"&&(ue(65),n()),(i.setModel(t)||Ji.resolve()).then(()=>n())})}):Ji.resolve()}function DW(e){return e.getColDef().filter==="agGroupColumnFilter"}function PW(e){return e instanceof Date&&!isNaN(e.getTime())}function Net(e){return!!e.filterManager?.isAnyFilterPresent()}function $et(e,t="api"){e.filterManager?.onFilterChanged({source:t})}var Bet=class extends X{constructor(){super(...arguments),this.beanName="filterManager",this.advFilterModelUpdateQueue=[]}wireBeans(e){this.quickFilter=e.quickFilter,this.advancedFilter=e.advancedFilter,this.colFilter=e.colFilter}postConstruct(){const e=this.refreshFiltersForAggregations.bind(this),t=this.updateAdvFilterColumns.bind(this);this.addManagedEventListeners({columnValueChanged:e,columnPivotChanged:e,columnPivotModeChanged:e,newColumnsLoaded:t,columnVisible:t,advancedFilterEnabledChanged:({enabled:i})=>this.onAdvFilterEnabledChanged(i),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)}),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.addManagedPropertyListeners(["isExternalFilterPresent","doesExternalFilterPass"],()=>{this.onFilterChanged({source:"api"})}),this.updateAggFiltering(),this.addManagedPropertyListener("groupAggFiltering",()=>{this.updateAggFiltering(),this.onFilterChanged()}),this.quickFilter&&this.addManagedListeners(this.quickFilter,{quickFilterChanged:()=>this.onFilterChanged({source:"quickFilter"})});const{gos:n}=this;this.alwaysPassFilter=n.get("alwaysPassFilter"),this.addManagedPropertyListener("alwaysPassFilter",()=>{this.alwaysPassFilter=n.get("alwaysPassFilter"),this.onFilterChanged({source:"api"})})}isExternalFilterPresentCallback(){const e=this.gos.getCallback("isExternalFilterPresent");return typeof e=="function"&&e({})}doesExternalFilterPass(e){const t=this.gos.get("doesExternalFilterPass");return typeof t=="function"&&t(e)}setFilterModel(e,t="api"){if(this.isAdvFilterEnabled()){this.warnAdvFilters();return}this.colFilter?.setFilterModel(e,t)}getFilterModel(){return this.colFilter?.getFilterModel()??{}}isColumnFilterPresent(){return!!this.colFilter?.isColumnFilterPresent()}isAggregateFilterPresent(){return!!this.colFilter?.isAggregateFilterPresent()}isChildFilterPresent(){return this.isColumnFilterPresent()||this.isQuickFilterPresent()||this.externalFilterPresent||this.isAdvFilterPresent()}isAnyFilterPresent(){return this.isChildFilterPresent()||this.isAggregateFilterPresent()}isAdvFilterPresent(){return this.isAdvFilterEnabled()&&this.advancedFilter.isFilterPresent()}onAdvFilterEnabledChanged(e){e?this.colFilter?.disableColumnFilters()&&this.onFilterChanged({source:"advancedFilter"}):this.advancedFilter?.isFilterPresent()&&(this.advancedFilter.setModel(null),this.onFilterChanged({source:"advancedFilter"}))}isAdvFilterEnabled(){return!!this.advancedFilter?.isEnabled()}isAdvFilterHeaderActive(){return this.isAdvFilterEnabled()&&this.advancedFilter.isHeaderActive()}refreshFiltersForAggregations(){kT(this.gos)&&this.onFilterChanged()}onFilterChanged(e={}){const{source:t,additionalEventAttributes:n,columns:i=[]}=e;this.externalFilterPresent=this.isExternalFilterPresentCallback(),(this.colFilter?this.colFilter.updateBeforeFilterChanged(e):Ji.resolve()).then(()=>{const r={source:t,type:"filterChanged",columns:i};n&&ir(r,n),this.eventSvc.dispatchEvent(r),this.colFilter?.updateAfterFilterChanged()})}isSuppressFlashingCellsBecauseFiltering(){return!!this.colFilter?.isSuppressFlashingCellsBecauseFiltering()}isQuickFilterPresent(){return!!this.quickFilter?.isFilterPresent()}updateAggFiltering(){this.aggFiltering=!!kT(this.gos)}isAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&this.shouldApplyQuickFilterAfterAgg()}isNonAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&!this.shouldApplyQuickFilterAfterAgg()}shouldApplyQuickFilterAfterAgg(){return(this.aggFiltering||this.beans.colModel.isPivotMode())&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")}doesRowPassOtherFilters(e,t){return this.doesRowPassFilter({rowNode:t,filterInstanceToSkip:e})}doesRowPassAggregateFilters(e){const{rowNode:t}=e;return this.alwaysPassFilter?.(t)?!0:!(this.isAggregateQuickFilterPresent()&&!this.quickFilter.doesRowPass(t)||this.isAggregateFilterPresent()&&!this.colFilter.doAggregateFiltersPass(t,e.filterInstanceToSkip))}doesRowPassFilter(e){const{rowNode:t}=e;return this.alwaysPassFilter?.(t)?!0:!(this.isNonAggregateQuickFilterPresent()&&!this.quickFilter.doesRowPass(t)||this.externalFilterPresent&&!this.doesExternalFilterPass(t)||this.isColumnFilterPresent()&&!this.colFilter.doColumnFiltersPass(t,e.filterInstanceToSkip)||this.isAdvFilterPresent()&&!this.advancedFilter.doesFilterPass(t))}isFilterActive(e){return!!this.colFilter?.isFilterActive(e)}getOrCreateFilterWrapper(e){return this.colFilter?.getOrCreateFilterWrapper(e)??null}getDefaultFloatingFilter(e){return this.colFilter.getDefaultFloatingFilter(e)}createFilterParams(e,t){return this.colFilter.createFilterParams(e,t)}isFilterAllowed(e){return this.isAdvFilterEnabled()?!1:!!this.colFilter?.isFilterAllowed(e)}getFloatingFilterCompDetails(e,t){return this.colFilter?.getFloatingFilterCompDetails(e,t)}getCurrentFloatingFilterParentModel(e){return this.colFilter?.getCurrentFloatingFilterParentModel(e)}destroyFilter(e,t="api"){this.colFilter?.destroyFilter(e,t)}areFilterCompsDifferent(e,t){return!!this.colFilter?.areFilterCompsDifferent(e,t)}getAdvFilterModel(){return this.isAdvFilterEnabled()?this.advancedFilter.getModel():null}setAdvFilterModel(e,t="api"){if(this.isAdvFilterEnabled()){if(this.beans.dataTypeSvc?.isPendingInference){this.advFilterModelUpdateQueue.push(e);return}this.advancedFilter.setModel(e??null),this.onFilterChanged({source:t})}}toggleAdvFilterBuilder(e,t){this.isAdvFilterEnabled()&&this.advancedFilter.getCtrl().toggleFilterBuilder({source:t,force:e})}updateAdvFilterColumns(){this.isAdvFilterEnabled()&&this.advancedFilter.updateValidity()&&this.onFilterChanged({source:"advancedFilter"})}hasFloatingFilters(){return this.isAdvFilterEnabled()?!1:!!this.colFilter?.hasFloatingFilters()}getColumnFilterInstance(e){return this.isAdvFilterEnabled()?(this.warnAdvFilters(),Promise.resolve(void 0)):this.colFilter?.getColumnFilterInstance(e)??Promise.resolve(void 0)}warnAdvFilters(){ue(68)}setupAdvFilterHeaderComp(e){this.advancedFilter?.getCtrl().setupHeaderComp(e)}getHeaderRowCount(){return this.isAdvFilterHeaderActive()?1:0}getHeaderHeight(){return this.isAdvFilterHeaderActive()?this.advancedFilter.getCtrl().getHeaderHeight():0}processFilterModelUpdateQueue(){this.advFilterModelUpdateQueue.forEach(e=>this.setAdvFilterModel(e)),this.advFilterModelUpdateQueue=[]}getColumnFilterModel(e){return this.colFilter?.getColumnFilterModel(e)}setColumnFilterModel(e,t){return this.isAdvFilterEnabled()?(this.warnAdvFilters(),Promise.resolve()):this.colFilter?.setColumnFilterModel(e,t)??Promise.resolve()}setColDefPropertiesForDataType(e,t,n){this.colFilter?.setColDefPropertiesForDataType(e,t,n)}},Get=class extends X{constructor(){super(...arguments),this.beanName="filterMenuFactory"}wireBeans(e){this.popupSvc=e.popupSvc}hideActiveMenu(){this.hidePopup?.()}showMenuAfterMouseEvent(e,t,n,i){this.showPopup(e,r=>{this.popupSvc?.positionPopupUnderMouseEvent({column:e,type:n,mouseEvent:t,ePopup:r})},n,t.target,Ur(this.gos),i)}showMenuAfterButtonClick(e,t,n,i){let r=-1,s="left";const o=Ur(this.gos);!o&&this.gos.get("enableRtl")&&(r=1,s="right");const a=o?void 0:4*r,l=o?void 0:4;this.showPopup(e,u=>{this.popupSvc?.positionPopupByComponent({type:n,eventSource:t,ePopup:u,nudgeX:a,nudgeY:l,alignSide:s,keepWithinBounds:!0,position:"under",column:e})},n,t,o,i)}showPopup(e,t,n,i,r,s){const o=e?this.createBean(new eqe(e,"COLUMN_MENU")):void 0;if(this.activeMenu=o,!o?.hasFilter()||!e){wt(57);return}const a=Cn({tag:"div",cls:`ag-menu${r?"":" ag-filter-menu"}`,role:"presentation"});[this.tabListener]=this.addManagedElementListeners(a,{keydown:v=>this.trapFocusWithin(v,a)}),a.appendChild(o?.getGui());let l;const u=()=>o?.afterGuiDetached(),c=z9e(this.gos)?i??this.beans.ctrlsSvc.getGridBodyCtrl().eGridBody:void 0,d=v=>{lW(e,!1,"contextMenu");const C=v instanceof KeyboardEvent;this.tabListener&&(this.tabListener=this.tabListener()),C&&i&&Fo(i)&&Sne(i)?.focus({preventScroll:!0}),u(),this.destroyBean(this.activeMenu),this.dispatchVisibleChangedEvent(!1,n,e),s?.()},h=this.getLocaleTextFunc(),p=r&&n!=="columnFilter"?h("ariaLabelColumnMenu","Column Menu"):h("ariaLabelColumnFilter","Column Filter"),g=this.popupSvc?.addPopup({modal:!0,eChild:a,closeOnEsc:!0,closedCallback:d,positionCallback:()=>t(a),anchorToElement:c,ariaLabel:p});g&&(this.hidePopup=l=g.hideFunc),o.afterInit().then(()=>{t(a),o.afterGuiAttached({container:n,hidePopup:l})}),lW(e,!0,"contextMenu"),this.dispatchVisibleChangedEvent(!0,n,e)}trapFocusWithin(e,t){e.key!==K.TAB||e.defaultPrevented||xh(this.beans,t,!1,e.shiftKey)||(e.preventDefault(),eh(t,e.shiftKey))}dispatchVisibleChangedEvent(e,t,n){this.eventSvc.dispatchEvent({type:"columnMenuVisibleChanged",visible:e,switchingTab:!1,key:t,column:n??null,columnGroup:null})}isMenuEnabled(e){return e.isFilterAllowed()&&(e.getColDef().menuTabs??["filterMenuTab"]).includes("filterMenuTab")}showMenuAfterContextMenuEvent(){}destroy(){this.destroyBean(this.activeMenu),super.destroy()}},zet=class extends X{constructor(){super(...arguments),this.beanName="filterValueSvc"}getValue(e,t){if(!t)return;const n=e.getColDef(),{filterValueGetter:i}=n;return i?this.executeFilterValueGetter(i,t.data,e,t,n):this.beans.valueSvc.getValue(e,t)}executeFilterValueGetter(e,t,n,i,r){const{expressionSvc:s,valueSvc:o}=this.beans,a=Ne(this.gos,{data:t,node:i,column:n,colDef:r,getValue:o.getValueCallback.bind(o,i)});return typeof e=="function"?e(a):s?.evaluate(e,a)}},Het={tag:"div",cls:"ag-floating-filter-input",role:"presentation",children:[{tag:"ag-input-text-field",ref:"eFloatingFilterText"}]},Vet=class extends bt{constructor(){super(Het,[OR]),this.eFloatingFilterText=ge}init(e){this.params=e;const t=this.beans.colNames.getDisplayNameForColumn(e.column,"header",!0);this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(`${t} ${this.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`)}onParentModelChanged(e){if(e==null){this.eFloatingFilterText.setValue("");return}this.params.parentFilterInstance(t=>{if(t.getModelAsString){const n=t.getModelAsString(e);this.eFloatingFilterText.setValue(n)}})}refresh(e){this.init(e)}},Pie=class{constructor(){this.customFilterOptions={}}init(e,t){this.filterOptions=e.filterOptions||t,this.mapCustomOptions(),this.selectDefaultItem(e)}mapCustomOptions(){const{filterOptions:e}=this;e&&e.forEach(t=>{if(typeof t=="string")return;const n=[["displayKey"],["displayName"],["predicate","test"]],i=r=>r.some(s=>t[s]!=null)?!0:(ue(72,{keys:r}),!1);if(!n.every(i)){this.filterOptions=e.filter(r=>r===t)||[];return}this.customFilterOptions[t.displayKey]=t})}selectDefaultItem(e){const{filterOptions:t}=this;if(e.defaultOption)this.defaultOption=e.defaultOption;else if(t.length>=1){const n=t[0];typeof n=="string"?this.defaultOption=n:n.displayKey?this.defaultOption=n.displayKey:ue(73)}else ue(74)}getCustomOption(e){return this.customFilterOptions[e]}};function vv(e,t,n){return n==null?e.splice(t):e.splice(t,n)}function a1(e){return e==null||typeof e=="string"&&e.trim().length===0}function Wet(e){return e==="AND"||e==="OR"?e:"AND"}function Uet(e,t,n){if(e==null)return;const{predicate:i}=e;if(i!=null&&!t.some(r=>r==null))return i(t,n)}function jet(e,t){let n=e.length;return n>t&&(e.splice(t),ue(78),n=t),n}var kie=class extends rqe{constructor(){super(...arguments),this.eTypes=[],this.eJoinOperatorPanels=[],this.eJoinOperatorsAnd=[],this.eJoinOperatorsOr=[],this.eConditionBodies=[],this.listener=()=>this.onUiChanged(),this.lastUiCompletePosition=null,this.joinOperatorId=0}getNumberOfInputs(e){const t=this.optionsFactory.getCustomOption(e);if(t){const{numberOfInputs:i}=t;return i??1}return e&&["empty","notBlank","blank"].indexOf(e)>=0?0:e==="inRange"?2:1}onFloatingFilterChanged(e,t){this.setTypeFromFloatingFilter(e),this.setValueFromFloatingFilter(t),this.onUiChanged(!0)}setTypeFromFloatingFilter(e){this.eTypes.forEach((t,n)=>{const i=n===0?e:this.optionsFactory.defaultOption;t.setValue(i,!0)})}getModelFromUi(){const e=this.getUiCompleteConditions();return e.length===0?null:this.maxNumConditions>1&&e.length>1?{filterType:this.filterType,operator:this.getJoinOperator(),conditions:e}:e[0]}getConditionTypes(){return this.eTypes.map(e=>e.getValue())}getConditionType(e){return this.eTypes[e].getValue()}getJoinOperator(){const{eJoinOperatorsOr:e,defaultJoinOperator:t}=this;return e.length===0?t:e[0].getValue()===!0?"OR":"AND"}areModelsEqual(e,t){if(!e&&!t)return!0;if(!e&&t||e&&!t)return!1;const n=!e.operator,i=!t.operator;if(!n&&i||n&&!i)return!1;let s;if(n){const o=e,a=t;s=this.areSimpleModelsEqual(o,a)}else{const o=e,a=t;s=o.operator===a.operator&&Sh(o.conditions,a.conditions,(l,u)=>this.areSimpleModelsEqual(l,u))}return s}shouldRefresh(e){const t=this.getModel(),n=t?t.conditions??[t]:null,i=e.filterOptions?.map(s=>typeof s=="string"?s:s.displayKey)??this.getDefaultFilterOptions();return!(!(!n||n.every(s=>i.find(o=>o===s.type)!==void 0))||typeof e.maxNumConditions=="number"&&n&&n.length>e.maxNumConditions)}refresh(e){return!this.shouldRefresh(e)||!super.refresh(e)?!1:(this.setParams(e),this.removeConditionsAndOperators(0),this.createOption(),this.setModel(this.getModel()),!0)}setModelIntoUi(e){if(e.operator){const n=e;let i=n.conditions;i==null&&(i=[],ue(77));const r=jet(i,this.maxNumConditions),s=this.getNumConditions();if(r<s)this.removeConditionsAndOperators(r);else if(r>s)for(let a=s;a<r;a++)this.createJoinOperatorPanel(),this.createOption();const o=n.operator==="OR";this.eJoinOperatorsAnd.forEach(a=>a.setValue(!o,!0)),this.eJoinOperatorsOr.forEach(a=>a.setValue(o,!0)),i.forEach((a,l)=>{this.eTypes[l].setValue(a.type,!0),this.setConditionIntoUi(a,l)})}else{const n=e;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(n.type,!0),this.setConditionIntoUi(n,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.onUiChanged(),Ji.resolve()}doesFilterPass(e){const t=this.getModel();if(t==null)return!0;const{operator:n}=t,i=[];if(n){const s=t;i.push(...s.conditions??[])}else i.push(t);return i[n&&n==="OR"?"some":"every"](s=>this.individualConditionPasses(e,s))}setParams(e){super.setParams(e),this.setNumConditions(e),this.defaultJoinOperator=Wet(e.defaultJoinOperator),this.filterPlaceholder=e.filterPlaceholder,this.optionsFactory=new Pie,this.optionsFactory.init(e,this.getDefaultFilterOptions()),this.createFilterListOptions(),this.createOption(),this.createMissingConditionsAndOperators(),this.isReadOnly()&&this.eFilterBody.setAttribute("tabindex","-1")}setNumConditions(e){let t=e.maxNumConditions??2;t<1&&(ue(79),t=1),this.maxNumConditions=t;let n=e.numAlwaysVisibleConditions??1;n<1&&(ue(80),n=1),n>t&&(ue(81),n=t),this.numAlwaysVisibleConditions=n}createOption(){const e=this.createManagedBean(new MN);this.eTypes.push(e),e.addCssClass("ag-filter-select"),this.eFilterBody.appendChild(e.getGui());const t=this.createValueElement();this.eConditionBodies.push(t),this.eFilterBody.appendChild(t),this.putOptionsIntoDropdown(e),this.resetType(e);const n=this.getNumConditions()-1;this.forEachPositionInput(n,i=>this.resetInput(i)),this.addChangedListeners(e,n)}createJoinOperatorPanel(){const e=Cn({tag:"div",cls:"ag-filter-condition"});this.eJoinOperatorPanels.push(e);const t=this.createJoinOperator(this.eJoinOperatorsAnd,e,"and"),n=this.createJoinOperator(this.eJoinOperatorsOr,e,"or");this.eFilterBody.appendChild(e);const i=this.eJoinOperatorPanels.length-1,r=this.joinOperatorId++;this.resetJoinOperatorAnd(t,i,r),this.resetJoinOperatorOr(n,i,r),this.isReadOnly()||(t.onValueChange(this.listener),n.onValueChange(this.listener))}createJoinOperator(e,t,n){const i=this.createManagedBean(new RKe);e.push(i);const r="ag-filter-condition-operator";return i.addCssClass(r),i.addCssClass(`${r}-${n}`),t.appendChild(i.getGui()),i}createFilterListOptions(){this.filterListOptions=this.optionsFactory.filterOptions.map(e=>typeof e=="string"?this.createBoilerplateListOption(e):this.createCustomListOption(e))}putOptionsIntoDropdown(e){const{filterListOptions:t}=this;t.forEach(n=>{e.addOption(n)}),e.setDisabled(t.length<=1)}createBoilerplateListOption(e){return{value:e,text:this.translate(e)}}createCustomListOption(e){const{displayKey:t}=e,n=this.optionsFactory.getCustomOption(e.displayKey);return{value:t,text:n?this.getLocaleTextFunc()(n.displayKey,n.displayName):this.translate(t)}}createBodyTemplate(){return null}getAgComponents(){return[]}getCssIdentifier(){return"simple-filter"}updateUiVisibility(){const e=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,e)}updateNumConditions(){let e=-1,t=!0;for(let n=0;n<this.getNumConditions();n++)this.isConditionUiComplete(n)?e=n:t=!1;if(this.shouldAddNewConditionAtEnd(t))this.createJoinOperatorPanel(),this.createOption();else{const n=this.lastUiCompletePosition??this.getNumConditions()-2;if(e<n){this.removeConditionsAndOperators(n+1);const i=e+1,r=n-i;r>0&&this.removeConditionsAndOperators(i,r),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=e}updateConditionStatusesAndValues(e,t){this.eTypes.forEach((i,r)=>{const s=this.isConditionDisabled(r,e);i.setDisabled(s||this.filterListOptions.length<=1),r===1&&(o0(this.eJoinOperatorPanels[0],s),this.eJoinOperatorsAnd[0].setDisabled(s),this.eJoinOperatorsOr[0].setDisabled(s))}),this.eConditionBodies.forEach((i,r)=>{Yt(i,this.isConditionBodyVisible(r))});const n=(t??this.getJoinOperator())==="OR";this.eJoinOperatorsAnd.forEach(i=>{i.setValue(!n,!0)}),this.eJoinOperatorsOr.forEach(i=>{i.setValue(n,!0)}),this.forEachInput((i,r,s,o)=>{this.setElementDisplayed(i,r<o),this.setElementDisabled(i,this.isConditionDisabled(s,e))}),this.resetPlaceholder()}shouldAddNewConditionAtEnd(e){return e&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()}removeConditionsAndOperators(e,t){if(e>=this.getNumConditions())return;const{eTypes:n,eConditionBodies:i,eJoinOperatorPanels:r,eJoinOperatorsAnd:s,eJoinOperatorsOr:o}=this;this.removeComponents(n,e,t),this.removeElements(i,e,t),this.removeValueElements(e,t);const a=Math.max(e-1,0);this.removeElements(r,a,t),this.removeComponents(s,a,t),this.removeComponents(o,a,t)}removeElements(e,t,n){vv(e,t,n).forEach(r=>Fs(r))}removeComponents(e,t,n){vv(e,t,n).forEach(r=>{Fs(r.getGui()),this.destroyBean(r)})}afterGuiAttached(e){if(super.afterGuiAttached(e),this.resetPlaceholder(),!e?.suppressFocus){const{eFilterBody:t,eTypes:n}=this;let i;if(!this.isReadOnly()){const r=this.getInputs(0)[0];r instanceof dd&&this.isConditionBodyVisible(0)?i=r.getInputElement():i=n[0]?.getFocusableElement()}(i??t).focus({preventScroll:!0})}}afterGuiDetached(){super.afterGuiDetached();const e=this.getModel();this.resetUiToActiveModel(e);let t=-1,n=-1,i=!1;const r=this.getJoinOperator();for(let o=this.getNumConditions()-1;o>=0;o--)if(this.isConditionUiComplete(o))t===-1&&(t=o,n=o);else{const a=o>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(o-1),l=o<t;(a||l)&&(this.removeConditionsAndOperators(o,1),i=!0,l&&n--)}let s=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),s=!0),this.shouldAddNewConditionAtEnd(n===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),s=!0),s&&this.updateConditionStatusesAndValues(n,r),i&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=n}getPlaceholderText(e,t){let n=this.translate(e);if(typeof this.filterPlaceholder=="function"){const i=this.eTypes[t].getValue(),r=this.translate(i);n=this.filterPlaceholder({filterOptionKey:i,filterOption:r,placeholder:n})}else typeof this.filterPlaceholder=="string"&&(n=this.filterPlaceholder);return n}resetPlaceholder(){const e=this.getLocaleTextFunc();this.forEachInput((t,n,i,r)=>{if(!(t instanceof dd))return;const s=n===0&&r>1?"inRangeStart":n===0?"filterOoo":"inRangeEnd",o=n===0&&r>1?e("ariaFilterFromValue","Filter from value"):n===0?e("ariaFilterValue","Filter Value"):e("ariaFilterToValue","Filter to Value");t.setInputPlaceholder(this.getPlaceholderText(s,i)),t.setInputAriaLabel(o)})}setElementValue(e,t,n){e instanceof dd&&e.setValue(t!=null?String(t):null,!0)}setElementDisplayed(e,t){e instanceof bt&&Yt(e.getGui(),t)}setElementDisabled(e,t){e instanceof bt&&o0(e.getGui(),t)}attachElementOnChange(e,t){e instanceof dd&&e.onValueChange(t)}forEachInput(e){this.getConditionTypes().forEach((t,n)=>{this.forEachPositionTypeInput(n,t,e)})}forEachPositionInput(e,t){const n=this.getConditionType(e);this.forEachPositionTypeInput(e,n,t)}forEachPositionTypeInput(e,t,n){const i=this.getNumberOfInputs(t),r=this.getInputs(e);for(let s=0;s<r.length;s++){const o=r[s];o!=null&&n(o,s,e,i)}}isConditionDisabled(e,t){return this.isReadOnly()?!0:e===0?!1:e>t+1}isConditionBodyVisible(e){const t=this.getConditionType(e);return this.getNumberOfInputs(t)>0}isConditionUiComplete(e){return!(e>=this.getNumConditions()||this.getConditionType(e)==="empty"||this.getValues(e).some(n=>n==null))}getNumConditions(){return this.eTypes.length}getUiCompleteConditions(){const e=[];for(let t=0;t<this.getNumConditions();t++)this.isConditionUiComplete(t)&&e.push(this.createCondition(t));return e}createMissingConditionsAndOperators(){if(!this.isReadOnly())for(let e=this.getNumConditions();e<this.numAlwaysVisibleConditions;e++)this.createJoinOperatorPanel(),this.createOption()}resetUiToDefaults(e){return this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach(t=>this.resetType(t)),this.eJoinOperatorsAnd.forEach((t,n)=>this.resetJoinOperatorAnd(t,n,this.joinOperatorId+n)),this.eJoinOperatorsOr.forEach((t,n)=>this.resetJoinOperatorOr(t,n,this.joinOperatorId+n)),this.joinOperatorId++,this.forEachInput(t=>this.resetInput(t)),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,e||this.onUiChanged(),Ji.resolve()}resetType(e){const n=this.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");e.setValue(this.optionsFactory.defaultOption,!0).setAriaLabel(n).setDisabled(this.isReadOnly()||this.filterListOptions.length<=1)}resetJoinOperatorAnd(e,t,n){this.resetJoinOperator(e,t,this.defaultJoinOperator==="AND",this.translate("andCondition"),n)}resetJoinOperatorOr(e,t,n){this.resetJoinOperator(e,t,this.defaultJoinOperator==="OR",this.translate("orCondition"),n)}resetJoinOperator(e,t,n,i,r){this.updateJoinOperatorDisabled(e.setValue(n,!0).setName(`ag-simple-filter-and-or-${this.getCompId()}-${r}`).setLabel(i),t)}updateJoinOperatorsDisabled(){const e=(t,n)=>this.updateJoinOperatorDisabled(t,n);this.eJoinOperatorsAnd.forEach(e),this.eJoinOperatorsOr.forEach(e)}updateJoinOperatorDisabled(e,t){e.setDisabled(this.isReadOnly()||t>0)}resetInput(e){this.setElementValue(e,null),this.setElementDisabled(e,this.isReadOnly())}setConditionIntoUi(e,t){const n=this.mapValuesFromModel(e);this.forEachInput((i,r,s)=>{s===t&&this.setElementValue(i,n[r]!=null?n[r]:null)})}setValueFromFloatingFilter(e){this.forEachInput((t,n,i)=>{this.setElementValue(t,n===0&&i===0?e:null,!0)})}addChangedListeners(e,t){this.isReadOnly()||(e.onValueChange(this.listener),this.forEachPositionInput(t,n=>{this.attachElementOnChange(n,this.listener)}))}individualConditionPasses(e,t){const n=this.getCellValue(e.node),i=this.mapValuesFromModel(t),r=this.optionsFactory.getCustomOption(t.type),s=Uet(r,i,n);return s??(n==null?this.evaluateNullValue(t.type):this.evaluateNonNullValue(i,n,t,e))}hasInvalidInputs(){return!1}},Tie=class extends kie{setParams(e){super.setParams(e),this.scalarFilterParams=e}evaluateNullValue(e){const{includeBlanksInEquals:t,includeBlanksInNotEqual:n,includeBlanksInGreaterThan:i,includeBlanksInLessThan:r,includeBlanksInRange:s}=this.scalarFilterParams;switch(e){case"equals":if(t)return!0;break;case"notEqual":if(n)return!0;break;case"greaterThan":case"greaterThanOrEqual":if(i)return!0;break;case"lessThan":case"lessThanOrEqual":if(r)return!0;break;case"inRange":if(s)return!0;break;case"blank":return!0;case"notBlank":return!1}return!1}evaluateNonNullValue(e,t,n){const i=n.type;if(!this.isValid(t))return i==="notEqual"||i==="notBlank";const r=this.comparator(),s=e[0]!=null?r(e[0],t):0;switch(i){case"equals":return s===0;case"notEqual":return s!==0;case"greaterThan":return s>0;case"greaterThanOrEqual":return s>=0;case"lessThan":return s<0;case"lessThanOrEqual":return s<=0;case"inRange":{const o=r(e[1],t);return this.scalarFilterParams.inRangeInclusive?s>=0&&o<=0:s>0&&o<0}case"blank":return a1(t);case"notBlank":return!a1(t);default:return ue(76,{filterModelType:i}),!0}}},Mie=class{constructor(e,t,n,i,r,s){this.alive=!0,this.context=e,this.eParent=r;const o=tje(t,n,i);o&&o.newAgStackInstance().then(a=>{if(!this.alive){e.destroyBean(a);return}if(this.dateComp=a,!a)return;r.appendChild(a.getGui()),a?.afterGuiAttached?.();const{tempValue:l,disabled:u}=this;l&&a.setDate(l),u!=null&&a.setDisabled?.(u),s?.(this)})}destroy(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)}getDate(){return this.dateComp?this.dateComp.getDate():this.tempValue}setDate(e){const t=this.dateComp;t?t.setDate(e):this.tempValue=e}setDisabled(e){const t=this.dateComp;t?t.setDisabled?.(e):this.disabled=e}setDisplayed(e){Yt(this.eParent,e)}setInputPlaceholder(e){this.dateComp?.setInputPlaceholder?.(e)}setInputAriaLabel(e){this.dateComp?.setInputAriaLabel?.(e)}afterGuiAttached(e){this.dateComp?.afterGuiAttached?.(e)}updateParams(e){this.dateComp?.refresh?.(e)}},Iie=["equals","notEqual","lessThan","greaterThan","inRange","blank","notBlank"],NN=class{constructor(e,t,n){this.getLocaleTextFunc=e,this.optionsFactory=t,this.valueFormatter=n}getModelAsString(e){if(!e)return null;const t=e.operator!=null,n=this.getLocaleTextFunc();if(t){const i=e,s=(i.conditions??[]).map(a=>this.getModelAsString(a)),o=i.operator==="AND"?"andCondition":"orCondition";return s.join(` ${n(o,One[o])} `)}else{if(e.type==="blank"||e.type==="notBlank")return n(e.type,e.type);{const i=e,r=this.optionsFactory.getCustomOption(i.type),{displayKey:s,displayName:o,numberOfInputs:a}=r||{};return s&&o&&a===0?(n(s,o),o):this.conditionToString(i,r)}}}updateParams(e){this.optionsFactory=e.optionsFactory}formatValue(e){const t=this.valueFormatter;return t?t(e??null)??"":String(e)}},_ie=class extends NN{constructor(e,t,n){super(t,n),this.dateFilterParams=e}conditionToString(e,t){const{type:n}=e,{numberOfInputs:i}=t||{},r=n=="inRange"||i===2,s=Rr(e.dateFrom),o=Rr(e.dateTo),a=this.dateFilterParams.inRangeFloatingFilterDateFormat;if(r){const l=s!==null?pv(s,a):"null",u=o!==null?pv(o,a):"null";return`${l}-${u}`}return s!=null?pv(s,a):`${n}`}updateParams(e){super.updateParams(e),this.dateFilterParams=e.dateFilterParams}},kW=1e3,TW=1/0,qet=class extends Tie{constructor(){super("dateFilter"),this.eConditionPanelsFrom=[],this.eConditionPanelsTo=[],this.dateConditionFromComps=[],this.dateConditionToComps=[],this.minValidYear=kW,this.maxValidYear=TW,this.minValidDate=null,this.maxValidDate=null,this.filterType="date"}afterGuiAttached(e){super.afterGuiAttached(e),this.dateConditionFromComps[0].afterGuiAttached(e)}mapValuesFromModel(e){const{dateFrom:t,dateTo:n,type:i}=e||{};return[t&&Rr(t)||null,n&&Rr(n)||null].slice(0,this.getNumberOfInputs(i))}comparator(){return this.dateFilterParams.comparator??Ket}isValid(e){const t=this.dateFilterParams.isValidDate;return!t||t(e)}setParams(e){this.dateFilterParams=e,super.setParams(e);const t=(n,i)=>{if(e[n]!=null)if(isNaN(e[n]))ue(82,{param:n});else return e[n]==null?i:Number(e[n]);return i};this.minValidYear=t("minValidYear",kW),this.maxValidYear=t("maxValidYear",TW),this.minValidYear>this.maxValidYear&&ue(83),this.minValidDate=e.minValidDate?e.minValidDate instanceof Date?e.minValidDate:Rr(e.minValidDate):null,this.maxValidDate=e.maxValidDate?e.maxValidDate instanceof Date?e.maxValidDate:Rr(e.maxValidDate):null,this.minValidDate&&this.maxValidDate&&this.minValidDate>this.maxValidDate&&ue(84),this.filterModelFormatter=new _ie(this.dateFilterParams,this.getLocaleTextFunc.bind(this),this.optionsFactory)}createDateCompWrapper(e){const{beans:{userCompFactory:t,context:n,gos:i},dateFilterParams:r}=this,s=new Mie(n,t,r.colDef,Ne(i,{onDateChanged:()=>this.onUiChanged(),filterParams:r,location:"filter"}),e);return this.addDestroyFunc(()=>s.destroy()),s}setElementValue(e,t){e.setDate(t)}setElementDisplayed(e,t){e.setDisplayed(t)}setElementDisabled(e,t){e.setDisabled(t)}getDefaultFilterOptions(){return Iie}createValueElement(){const t=Rn(this.beans).createElement("div");return t.classList.add("ag-filter-body"),this.createFromToElement(t,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(t,this.eConditionPanelsTo,this.dateConditionToComps,"to"),t}createFromToElement(e,t,n,i){const s=Rn(this.beans).createElement("div");s.classList.add(`ag-filter-${i}`),s.classList.add(`ag-filter-date-${i}`),t.push(s),e.appendChild(s),n.push(this.createDateCompWrapper(s))}removeValueElements(e,t){this.removeDateComps(this.dateConditionFromComps,e,t),this.removeDateComps(this.dateConditionToComps,e,t),vv(this.eConditionPanelsFrom,e,t),vv(this.eConditionPanelsTo,e,t)}removeDateComps(e,t,n){vv(e,t,n).forEach(r=>r.destroy())}isValidDateValue(e){if(e===null)return!1;const{minValidDate:t,maxValidDate:n,minValidYear:i,maxValidYear:r}=this;if(t){if(e<t)return!1}else if(e.getUTCFullYear()<i)return!1;if(n){if(e>n)return!1}else if(e.getUTCFullYear()>r)return!1;return!0}isConditionUiComplete(e){if(!super.isConditionUiComplete(e))return!1;let t=!0;return this.forEachInput((n,i,r,s)=>{r!==e||!t||i>=s||(t=t&&this.isValidDateValue(n.getDate()))}),t}areSimpleModelsEqual(e,t){return e.dateFrom===t.dateFrom&&e.dateTo===t.dateTo&&e.type===t.type}createCondition(e){const t=this.getConditionType(e),n={},i=this.getValues(e);return i.length>0&&(n.dateFrom=Ts(i[0])),i.length>1&&(n.dateTo=Ts(i[1])),{dateFrom:null,dateTo:null,filterType:this.filterType,type:t,...n}}resetPlaceholder(){const e=this.getLocaleTextFunc(),t=this.translate("dateFormatOoo"),n=e("ariaFilterValue","Filter Value");this.forEachInput(i=>{i.setInputPlaceholder(t),i.setInputAriaLabel(n)})}getInputs(e){const{dateConditionFromComps:t,dateConditionToComps:n}=this;return e>=t.length?[null,null]:[t[e],n[e]]}getValues(e){const t=[];return this.forEachPositionInput(e,(n,i,r,s)=>{i<s&&t.push(n.getDate())}),t}translate(e){return e==="lessThan"?super.translate("before"):e==="greaterThan"?super.translate("after"):super.translate(e)}getModelAsString(e){return this.filterModelFormatter.getModelAsString(e)??""}};function Ket(e,t){const n=t;return n<e?-1:n>e?1:0}var Oie=class extends bt{constructor(){super(...arguments),this.defaultDebounceMs=0}setLastTypeFromModel(e){if(!e){this.lastType=this.optionsFactory.defaultOption;return}const t=e.operator;let n;t?n=e.conditions[0]:n=e,this.lastType=n.type}canWeEditAfterModelFromParentFilter(e){if(!e)return this.isTypeEditable(this.lastType);if(e.operator)return!1;const n=e;return this.isTypeEditable(n.type)}init(e){this.setSimpleParams(e,!1)}setSimpleParams(e,t=!0){const n=new Pie;this.optionsFactory=n,n.init(e.filterParams,this.getDefaultOptions());const i=n.defaultOption;t||(this.lastType=i),this.readOnly=!!e.filterParams.readOnly;const r=this.isTypeEditable(i);this.setEditable(r)}refresh(e){this.setSimpleParams(e)}hasSingleInput(e){const t=this.optionsFactory.getCustomOption(e)?.numberOfInputs;return t==null||t==1}isTypeEditable(e){const t=["inRange","empty","blank","notBlank"];return!!e&&!this.readOnly&&this.hasSingleInput(e)&&t.indexOf(e)<0}getAriaLabel(e){return`${this.beans.colNames.getDisplayNameForColumn(e.column,"header",!0)} ${this.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`}},Yet={tag:"div",cls:"ag-floating-filter-input",role:"presentation",children:[{tag:"ag-input-text-field",ref:"eReadOnlyText"},{tag:"div",ref:"eDateWrapper",cls:"ag-date-floating-filter-wrapper"}]},Xet=class extends Oie{constructor(){super(Yet,[OR]),this.eReadOnlyText=ge,this.eDateWrapper=ge}getDefaultOptions(){return Iie}init(e){super.init(e),this.params=e,this.filterParams=e.filterParams,this.createDateComponent(),this.filterModelFormatter=new _ie(this.filterParams,this.getLocaleTextFunc.bind(this),this.optionsFactory);const t=this.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(t("ariaDateFilterInput","Date Filter Input"))}refresh(e){super.refresh(e),this.params=e,this.filterParams=e.filterParams,this.dateComp.updateParams(this.getDateComponentParams()),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory,dateFilterParams:this.filterParams}),this.updateCompOnModelChange(e.currentParentModel())}updateCompOnModelChange(e){const t=!this.readOnly&&this.canWeEditAfterModelFromParentFilter(e);if(this.setEditable(t),t){const n=e?Rr(e.dateFrom):null;this.dateComp.setDate(n),this.eReadOnlyText.setValue("")}else this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(e)),this.dateComp.setDate(null)}setEditable(e){Yt(this.eDateWrapper,e),Yt(this.eReadOnlyText.getGui(),!e)}onParentModelChanged(e,t){t?.afterFloatingFilter||t?.afterDataChange||(super.setLastTypeFromModel(e),this.updateCompOnModelChange(e))}onDateChanged(){const e=this.dateComp.getDate(),t=Ts(e);this.params.parentFilterInstance(n=>{if(n){const i=Rr(t);n.onFloatingFilterChanged(this.lastType||null,i)}})}getDateComponentParams(){const{filterParams:e,column:t}=this.params,n=wN(e,this.defaultDebounceMs);return Ne(this.gos,{onDateChanged:hi(this,this.onDateChanged.bind(this),n),filterParams:t.getColDef().filterParams,location:"floatingFilter"})}createDateComponent(){const{beans:{context:e,userCompFactory:t},eDateWrapper:n,params:i}=this;this.dateComp=new Mie(e,t,i.column.getColDef(),this.getDateComponentParams(),n,r=>{r.setInputAriaLabel(this.getAriaLabel(i))}),this.addDestroyFunc(()=>this.dateComp.destroy())}},Qet={tag:"div",cls:"ag-filter-filter",children:[{tag:"ag-input-text-field",ref:"eDateInput",cls:"ag-date-filter"}]},Jet=class extends bt{constructor(){super(Qet,[OR]),this.eDateInput=ge,this.isApply=!1,this.applyOnFocusOut=!1}init(e){this.params=e,this.setParams(e);const t=this.eDateInput.getInputElement();this.addManagedListeners(t,{mouseDown:()=>{this.eDateInput.isDisabled()||this.usingSafariDatePicker||t.focus({preventScroll:!0})},input:this.handleInput.bind(this,!1),change:this.handleInput.bind(this,!0),focusout:this.handleFocusOut.bind(this)})}handleInput(e){if(!this.eDateInput.isDisabled()){if(this.isApply){this.applyOnFocusOut=!e,e&&this.params.onDateChanged();return}e||this.params.onDateChanged()}}handleFocusOut(){this.applyOnFocusOut&&(this.applyOnFocusOut=!1,this.params.onDateChanged())}setParams(e){const t=this.eDateInput.getInputElement(),n=this.shouldUseBrowserDatePicker(e);this.usingSafariDatePicker=n&&wh(),t.type=n?"date":"text";const{minValidYear:i,maxValidYear:r,minValidDate:s,maxValidDate:o,buttons:a}=e.filterParams||{};if(s&&i&&ue(85),o&&r&&ue(86),s&&o){const[l,u]=[s,o].map(c=>c instanceof Date?c:Rr(c));l&&u&&l.getTime()>u.getTime()&&ue(87)}s?s instanceof Date?t.min=pv(s):t.min=s:i&&(t.min=`${i}-01-01`),o?o instanceof Date?t.max=pv(o):t.max=o:r&&(t.max=`${r}-12-31`),this.isApply=e.location==="floatingFilter"&&!!a?.includes("apply")}refresh(e){this.params=e,this.setParams(e)}getDate(){return Rr(this.eDateInput.getValue())}setDate(e){this.eDateInput.setValue(Ts(e,!1))}setInputPlaceholder(e){this.eDateInput.setInputPlaceholder(e)}setInputAriaLabel(e){this.eDateInput.setAriaLabel(e)}setDisabled(e){this.eDateInput.setDisabled(e)}afterGuiAttached(e){(!e||!e.suppressFocus)&&this.eDateInput.getInputElement().focus({preventScroll:!0})}shouldUseBrowserDatePicker(e){return e?.filterParams?.browserDatePicker??!0}},Lie=["equals","notEqual","greaterThan","greaterThanOrEqual","lessThan","lessThanOrEqual","inRange","blank","notBlank"],Nie=class extends NN{conditionToString(e,t){const{numberOfInputs:n}=t||{},{filter:i,filterTo:r,type:s}=e,o=s=="inRange"||n===2,a=this.formatValue.bind(this);return o?`${a(i)}-${a(r)}`:i!=null?a(i):`${s}`}};function UT(e){const{allowedCharPattern:t}=e??{};return t??null}var Zet=class extends Tie{constructor(){super("numberFilter"),this.eValuesFrom=[],this.eValuesTo=[],this.filterType="number",this.defaultDebounceMs=500}refresh(e){return this.numberFilterParams.allowedCharPattern!==e.allowedCharPattern?!1:super.refresh(e)}mapValuesFromModel(e){const{filter:t,filterTo:n,type:i}=e||{};return[this.processValue(t),this.processValue(n)].slice(0,this.getNumberOfInputs(i))}comparator(){return(e,t)=>e===t?0:e<t?1:-1}isValid(e){return!isNaN(e)}setParams(e){this.numberFilterParams=e,super.setParams(e),this.filterModelFormatter=new Nie(this.getLocaleTextFunc.bind(this),this.optionsFactory,this.numberFilterParams.numberFormatter)}getDefaultFilterOptions(){return Lie}setElementValue(e,t,n){const{numberFormatter:i}=this.numberFilterParams,r=!n&&i?i(t??null):t;super.setElementValue(e,r)}createValueElement(){const e=UT(this.numberFilterParams),t=Cn({tag:"div",cls:"ag-filter-body",role:"presentation"});return this.createFromToElement(t,this.eValuesFrom,"from",e),this.createFromToElement(t,this.eValuesTo,"to",e),t}createFromToElement(e,t,n,i){const r=this.createManagedBean(i?new Rh({allowedCharPattern:i}):new TN);r.addCssClass(`ag-filter-${n}`),r.addCssClass("ag-filter-filter"),t.push(r),e.appendChild(r.getGui())}removeValueElements(e,t){const n=i=>this.removeComponents(i,e,t);n(this.eValuesFrom),n(this.eValuesTo)}getValues(e){const t=[];return this.forEachPositionInput(e,(n,i,r,s)=>{i<s&&t.push(this.processValue(this.stringToFloat(n.getValue())))}),t}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}processValue(e){return e==null||isNaN(e)?null:e}stringToFloat(e){if(typeof e=="number")return e;let t=Rl(e);t!=null&&t.trim()===""&&(t=null);const n=this.numberFilterParams.numberParser;return n?n(t):t==null||t.trim()==="-"?null:parseFloat(t)}createCondition(e){const t=this.getConditionType(e),n={filterType:this.filterType,type:t},i=this.getValues(e);return i.length>0&&(n.filter=i[0]),i.length>1&&(n.filterTo=i[1]),n}getInputs(e){const{eValuesFrom:t,eValuesTo:n}=this;return e>=t.length?[null,null]:[t[e],n[e]]}getModelAsString(e){return this.filterModelFormatter.getModelAsString(e)??""}hasInvalidInputs(){let e=!1;return this.forEachInput(t=>{if(!t.getInputElement().validity.valid){e=!0;return}}),e}},$ie=class extends X{constructor(e){super(),this.params=e,this.eInput=ge,this.onValueChanged=()=>{}}setupGui(e){this.eInput=this.createManagedBean(new Rh(this.params?.config));const t=this.eInput.getGui();e.appendChild(t);const n=i=>this.onValueChanged(i);this.addManagedListeners(t,{input:n,keydown:n})}setEditable(e){this.eInput.setDisabled(!e)}getValue(){return this.eInput.getValue()}setValue(e,t){this.eInput.setValue(e,t)}setValueChangedListener(e){this.onValueChanged=e}setParams({ariaLabel:e,autoComplete:t}){const{eInput:n}=this;n.setInputAriaLabel(e),t!==void 0&&n.setAutoComplete(t)}};function Bie(e){const t=e?.trim();return t===""?e:t}var ett={tag:"div",ref:"eFloatingFilterInputContainer",cls:"ag-floating-filter-input",role:"presentation"},Gie=class extends Oie{constructor(){super(...arguments),this.eFloatingFilterInputContainer=ge,this.defaultDebounceMs=500}postConstruct(){this.setTemplate(ett)}onParentModelChanged(e,t){t?.afterFloatingFilter||t?.afterDataChange||(this.setLastTypeFromModel(e),this.setEditable(this.canWeEditAfterModelFromParentFilter(e)),this.inputSvc.setValue(this.filterModelFormatter.getModelAsString(e)))}init(e){this.setupFloatingFilterInputService(e),super.init(e),this.setTextInputParams(e)}setupFloatingFilterInputService(e){this.inputSvc=this.createFloatingFilterInputService(e),this.inputSvc.setupGui(this.eFloatingFilterInputContainer)}setTextInputParams(e){this.params=e;const t=e.browserAutoComplete??!1,{inputSvc:n,defaultDebounceMs:i,readOnly:r}=this;if(n.setParams({ariaLabel:this.getAriaLabel(e),autoComplete:t}),this.applyActive=n1(e.filterParams),!r){const s=wN(e.filterParams,i),o=hi(this,this.syncUpWithParentFilter.bind(this),s);n.setValueChangedListener(o)}}refresh(e){super.refresh(e),this.setTextInputParams(e)}recreateFloatingFilterInputService(e){const{inputSvc:t}=this,n=t.getValue();Ii(this.eFloatingFilterInputContainer),this.destroyBean(t),this.setupFloatingFilterInputService(e),t.setValue(n,!0)}syncUpWithParentFilter(e){const t=e.key===K.ENTER;if(this.applyActive&&!t)return;const{inputSvc:n,params:i}=this;let r=n.getValue();i.filterParams.trimInput&&(r=Bie(r),n.setValue(r,!0)),i.parentFilterInstance(s=>{s?.onFloatingFilterChanged(this.lastType||null,r||null)})}setEditable(e){this.inputSvc.setEditable(e)}},ttt=class extends X{constructor(){super(...arguments),this.onValueChanged=()=>{},this.numberInputActive=!0}setupGui(e){this.eNumberInput=this.createManagedBean(new TN),this.eTextInput=this.createManagedBean(new Rh),this.eTextInput.setDisabled(!0);const t=this.eNumberInput.getGui(),n=this.eTextInput.getGui();e.appendChild(t),e.appendChild(n),this.setupListeners(t,i=>this.onValueChanged(i)),this.setupListeners(n,i=>this.onValueChanged(i))}setEditable(e){this.numberInputActive=e,this.eNumberInput.setDisplayed(this.numberInputActive),this.eTextInput.setDisplayed(!this.numberInputActive)}setAutoComplete(e){this.eNumberInput.setAutoComplete(e),this.eTextInput.setAutoComplete(e)}getValue(){return this.getActiveInputElement().getValue()}setValue(e,t){this.getActiveInputElement().setValue(e,t)}getActiveInputElement(){return this.numberInputActive?this.eNumberInput:this.eTextInput}setValueChangedListener(e){this.onValueChanged=e}setupListeners(e,t){this.addManagedListeners(e,{input:t,keydown:t})}setParams(e){this.setAriaLabel(e.ariaLabel),e.autoComplete!==void 0&&this.setAutoComplete(e.autoComplete)}setAriaLabel(e){this.eNumberInput.setInputAriaLabel(e),this.eTextInput.setInputAriaLabel(e)}},ntt=class extends Gie{init(e){super.init(e),this.filterModelFormatter=new Nie(this.getLocaleTextFunc.bind(this),this.optionsFactory,e.filterParams?.numberFormatter)}refresh(e){UT(e.filterParams)!==this.allowedCharPattern&&this.recreateFloatingFilterInputService(e),super.refresh(e),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})}getDefaultOptions(){return Lie}createFloatingFilterInputService(e){return this.allowedCharPattern=UT(e.filterParams),this.allowedCharPattern?this.createManagedBean(new $ie({config:{allowedCharPattern:this.allowedCharPattern}})):this.createManagedBean(new ttt)}},zie=["contains","notContains","equals","notEqual","startsWith","endsWith","blank","notBlank"],Hie=class extends NN{conditionToString(e,t){const{numberOfInputs:n}=t||{},{filter:i,filterTo:r,type:s}=e;return s=="inRange"||n===2?`${i}-${r}`:i!=null?`${i}`:`${s}`}},itt=class extends kie{constructor(){super("textFilter"),this.filterType="text",this.defaultFormatter=e=>e,this.defaultLowercaseFormatter=e=>e==null?null:e.toString().toLowerCase(),this.defaultMatcher=({filterOption:e,value:t,filterText:n})=>{if(n==null)return!1;switch(e){case"contains":return t.indexOf(n)>=0;case"notContains":return t.indexOf(n)<0;case"equals":return t===n;case"notEqual":return t!=n;case"startsWith":return t.indexOf(n)===0;case"endsWith":{const i=t.lastIndexOf(n);return i>=0&&i===t.length-n.length}default:return!1}},this.eValuesFrom=[],this.eValuesTo=[],this.defaultDebounceMs=500}setParams(e){this.textFilterParams=e,super.setParams(e),this.matcher=e.textMatcher||this.defaultMatcher,this.formatter=e.textFormatter||(e.caseSensitive?this.defaultFormatter:this.defaultLowercaseFormatter),this.filterModelFormatter=new Hie(this.getLocaleTextFunc.bind(this),this.optionsFactory)}createCondition(e){const t=this.getConditionType(e),n={filterType:this.filterType,type:t},i=this.getValuesWithSideEffects(e,!0);return i.length>0&&(n.filter=i[0]),i.length>1&&(n.filterTo=i[1]),n}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}getInputs(e){const{eValuesFrom:t,eValuesTo:n}=this;return e>=t.length?[null,null]:[t[e],n[e]]}getValues(e){return this.getValuesWithSideEffects(e,!1)}getValuesWithSideEffects(e,t){const n=[];return this.forEachPositionInput(e,(i,r,s,o)=>{if(r<o){let a=Rl(i.getValue());t&&this.textFilterParams.trimInput&&(a=Bie(a)??null,i.setValue(a,!0)),n.push(a)}}),n}getDefaultFilterOptions(){return zie}createValueElement(){const e=Cn({tag:"div",cls:"ag-filter-body",role:"presentation"});return this.createFromToElement(e,this.eValuesFrom,"from"),this.createFromToElement(e,this.eValuesTo,"to"),e}createFromToElement(e,t,n){const i=this.createManagedBean(new Rh);i.addCssClass(`ag-filter-${n}`),i.addCssClass("ag-filter-filter"),t.push(i),e.appendChild(i.getGui())}removeValueElements(e,t){const n=i=>this.removeComponents(i,e,t);n(this.eValuesFrom),n(this.eValuesTo)}mapValuesFromModel(e){const{filter:t,filterTo:n,type:i}=e||{};return[t||null,n||null].slice(0,this.getNumberOfInputs(i))}evaluateNullValue(e){return e?["notEqual","notContains","blank"].indexOf(e)>=0:!1}evaluateNonNullValue(e,t,n,i){const r=e.map(h=>this.formatter(h))||[],s=this.formatter(t),{api:o,colDef:a,column:l,context:u,textFormatter:c}=this.textFilterParams;if(n.type==="blank")return a1(t);if(n.type==="notBlank")return!a1(t);const d={api:o,colDef:a,column:l,context:u,node:i.node,data:i.data,filterOption:n.type,value:s,textFormatter:c};return r.some(h=>this.matcher({...d,filterText:h}))}getModelAsString(e){return this.filterModelFormatter.getModelAsString(e)??""}},rtt=class extends Gie{init(e){super.init(e),this.filterModelFormatter=new Hie(this.getLocaleTextFunc.bind(this),this.optionsFactory)}refresh(e){super.refresh(e),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})}getDefaultOptions(){return zie}createFloatingFilterInputService(){return this.createManagedBean(new $ie)}};function stt(e){return!!e.quickFilter?.isFilterPresent()}function ott(e){return e.quickFilter?.getText()}function att(e){e.quickFilter?.resetCache()}var ltt=class extends X{constructor(){super(...arguments),this.beanName="quickFilter",this.quickFilter=null,this.quickFilterParts=null}postConstruct(){const e=this.resetCache.bind(this),t=this.gos;this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:e,columnRowGroupChanged:e,columnVisible:()=>{t.get("includeHiddenColumnsInQuickFilter")||this.resetCache()}}),this.addManagedPropertyListener("quickFilterText",n=>this.setFilter(n.currentValue)),this.addManagedPropertyListeners(["includeHiddenColumnsInQuickFilter","applyQuickFilterBeforePivotOrAgg"],()=>this.onColumnConfigChanged()),this.quickFilter=this.parseFilter(t.get("quickFilterText")),this.parser=t.get("quickFilterParser"),this.matcher=t.get("quickFilterMatcher"),this.setFilterParts(),this.addManagedPropertyListeners(["quickFilterMatcher","quickFilterParser"],()=>this.setParserAndMatcher())}refreshCols(){const{autoColSvc:e,colModel:t,gos:n,pivotResultCols:i}=this.beans,r=t.isPivotMode(),s=e?.getColumns(),o=t.getColDefCols();let a=(r&&!n.get("applyQuickFilterBeforePivotOrAgg")?i?.getPivotResultCols()?.list:o)??[];s&&(a=a.concat(s)),this.colsToUse=n.get("includeHiddenColumnsInQuickFilter")?a:a.filter(l=>l.isVisible()||l.isRowGroupActive())}isFilterPresent(){return this.quickFilter!==null}doesRowPass(e){const t=this.gos.get("cacheQuickFilter");return this.matcher?this.doesRowPassMatcher(t,e):this.quickFilterParts.every(n=>t?this.doesRowPassCache(e,n):this.doesRowPassNoCache(e,n))}resetCache(){this.beans.rowModel.forEachNode(e=>e.quickFilterAggregateText=null)}getText(){return this.gos.get("quickFilterText")}setFilterParts(){const{quickFilter:e,parser:t}=this;e?this.quickFilterParts=t?t(e):e.split(" "):this.quickFilterParts=null}parseFilter(e){return me(e)?e.toUpperCase():null}setFilter(e){if(e!=null&&typeof e!="string"){ue(70,{newFilter:e});return}const t=this.parseFilter(e);this.quickFilter!==t&&(this.quickFilter=t,this.setFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}setParserAndMatcher(){const e=this.gos.get("quickFilterParser"),t=this.gos.get("quickFilterMatcher"),n=e!==this.parser||t!==this.matcher;this.parser=e,this.matcher=t,n&&(this.setFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}onColumnConfigChanged(){this.refreshCols(),this.resetCache(),this.isFilterPresent()&&this.dispatchLocalEvent({type:"quickFilterChanged"})}doesRowPassNoCache(e,t){return this.colsToUse.some(n=>{const i=this.getTextForColumn(n,e);return me(i)&&i.indexOf(t)>=0})}doesRowPassCache(e,t){return this.checkGenerateAggText(e),e.quickFilterAggregateText.indexOf(t)>=0}doesRowPassMatcher(e,t){let n;e?(this.checkGenerateAggText(t),n=t.quickFilterAggregateText):n=this.getAggText(t);const{quickFilterParts:i,matcher:r}=this;return r(i,n)}checkGenerateAggText(e){e.quickFilterAggregateText||(e.quickFilterAggregateText=this.getAggText(e))}getTextForColumn(e,t){let n=this.beans.filterValueSvc.getValue(e,t);const i=e.getColDef();if(i.getQuickFilterText){const r=Ne(this.gos,{value:n,node:t,data:t.data,column:e,colDef:i});n=i.getQuickFilterText(r)}return me(n)?n.toString().toUpperCase():null}getAggText(e){const t=[];return this.colsToUse.forEach(n=>{const i=this.getTextForColumn(n,e);me(i)&&t.push(i)}),t.join(`
`)}},utt={moduleName:"ClientSideRowModelFilter",version:Ce,rowModels:["clientSide"],beans:[vet]},$N={moduleName:"FilterCore",version:Ce,beans:[Bet],apiFunctions:{isAnyFilterPresent:Net,onFilterChanged:$et},css:[Fet],dependsOn:[utt]},Vie={moduleName:"FilterValue",version:Ce,beans:[zet]},BR={moduleName:"ColumnFilter",version:Ce,beans:[Let,Get],dynamicBeans:{headerFilterCellCtrl:Cet},icons:{filter:"filter",filterActive:"filter"},apiFunctions:{isColumnFilterPresent:Aet,getColumnFilterInstance:Det,destroyFilter:Pet,setFilterModel:ket,getFilterModel:Tet,getColumnFilterModel:Met,setColumnFilterModel:Iet,showColumnFilter:_et},dependsOn:[$N,$R,Vie,bet]},ctt={moduleName:"CustomFilter",version:Ce,userComponents:{agReadOnlyFloatingFilter:Vet},dependsOn:[BR]},dtt={moduleName:"TextFilter",version:Ce,dependsOn:[BR],userComponents:{agTextColumnFilter:itt,agTextColumnFloatingFilter:rtt}},htt={moduleName:"NumberFilter",version:Ce,dependsOn:[BR],userComponents:{agNumberColumnFilter:Zet,agNumberColumnFloatingFilter:ntt}},ftt={moduleName:"DateFilter",version:Ce,dependsOn:[BR],userComponents:{agDateColumnFilter:qet,agDateInput:Jet,agDateColumnFloatingFilter:Xet}},ptt={moduleName:"QuickFilterCore",version:Ce,rowModels:["clientSide"],beans:[ltt],dependsOn:[$N,Vie]},gtt={moduleName:"QuickFilter",version:Ce,apiFunctions:{isQuickFilterPresent:stt,getQuickFilter:ott,resetQuickFilter:att},dependsOn:[ptt]},mtt={moduleName:"ExternalFilter",version:Ce,dependsOn:[$N]},Um=class{constructor(e){this.cellValueChanges=e}},BD=class extends Um{constructor(e,t,n,i){super(e),this.initialRange=t,this.finalRange=n,this.ranges=i}},vtt=10,MW=class{constructor(e){this.actionStack=[],this.maxStackSize=e||vtt,this.actionStack=new Array(this.maxStackSize)}pop(){return this.actionStack.pop()}push(e){e.cellValueChanges&&e.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(e))}clear(){this.actionStack=[]}getCurrentStackSize(){return this.actionStack.length}},Ctt=class extends X{constructor(){super(...arguments),this.beanName="undoRedo",this.cellValueChanges=[],this.activeCellEdit=null,this.activeRowEdit=null,this.isPasting=!1,this.isRangeInAction=!1,this.onCellValueChanged=e=>{const t={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned},n=this.activeCellEdit!==null&&Ane(this.activeCellEdit,t),i=this.activeRowEdit!==null&&Uje(this.activeRowEdit,t);if(!(n||i||this.isPasting||this.isRangeInAction))return;const{rowPinned:s,rowIndex:o,column:a,oldValue:l,value:u}=e,c={rowPinned:s,rowIndex:o,columnId:a.getColId(),newValue:u,oldValue:l};this.cellValueChanges.push(c)},this.clearStacks=()=>{this.undoStack.clear(),this.redoStack.clear()}}postConstruct(){const{gos:e,ctrlsSvc:t}=this.beans;if(!e.get("undoRedoCellEditing"))return;const n=e.get("undoRedoCellEditingLimit");if(n<=0)return;this.undoStack=new MW(n),this.redoStack=new MW(n),this.addListeners();const i=this.clearStacks.bind(this);this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this),modelUpdated:r=>{r.keepUndoRedoStack||this.clearStacks()},columnPivotModeChanged:i,newColumnsLoaded:i,columnGroupOpened:i,columnRowGroupChanged:i,columnMoved:i,columnPinned:i,columnVisible:i,rowDragEnd:i}),t.whenReady(this,r=>{this.gridBodyCtrl=r.gridBodyCtrl})}getCurrentUndoStackSize(){return this.undoStack?.getCurrentStackSize()??0}getCurrentRedoStackSize(){return this.redoStack?.getCurrentStackSize()??0}undo(e){const{eventSvc:t,undoStack:n,redoStack:i}=this;t.dispatchEvent({type:"undoStarted",source:e});const r=this.undoRedo(n,i,"initialRange","oldValue","undo");t.dispatchEvent({type:"undoEnded",source:e,operationPerformed:r})}redo(e){const{eventSvc:t,undoStack:n,redoStack:i}=this;t.dispatchEvent({type:"redoStarted",source:e});const r=this.undoRedo(i,n,"finalRange","newValue","redo");t.dispatchEvent({type:"redoEnded",source:e,operationPerformed:r})}undoRedo(e,t,n,i,r){if(!e)return!1;const s=e.pop();return!s||!s.cellValueChanges?!1:(this.processAction(s,o=>o[i],r),s instanceof BD?this.processRange(s.ranges||[s[n]]):this.processCell(s.cellValueChanges),t.push(s),!0)}processAction(e,t,n){e.cellValueChanges.forEach(i=>{const{rowIndex:r,rowPinned:s,columnId:o}=i,a={rowIndex:r,rowPinned:s},l=e1(this.beans,a);l.displayed&&l.setDataValue(o,t(i),n)})}processRange(e){let t;const n=this.beans.rangeSvc;n.removeAllCellRanges(!0),e.forEach((i,r)=>{if(!i)return;const s=i.startRow,o=i.endRow;r===e.length-1&&(t={rowPinned:s.rowPinned,rowIndex:s.rowIndex,columnId:i.startColumn.getColId()},this.setLastFocusedCell(t));const a={rowStartIndex:s.rowIndex,rowStartPinned:s.rowPinned,rowEndIndex:o.rowIndex,rowEndPinned:o.rowPinned,columnStart:i.startColumn,columns:i.columns};n.addCellRange(a)})}processCell(e){const t=e[0],{rowIndex:n,rowPinned:i}=t,r={rowIndex:n,rowPinned:i},s=e1(this.beans,r),o={rowPinned:t.rowPinned,rowIndex:s.rowIndex,columnId:t.columnId};this.setLastFocusedCell(o)}setLastFocusedCell(e){const{rowIndex:t,columnId:n,rowPinned:i}=e,{colModel:r,focusSvc:s,rangeSvc:o}=this.beans,a=r.getCol(n);if(!a)return;const{scrollFeature:l}=this.gridBodyCtrl;l.ensureIndexVisible(t),l.ensureColumnVisible(a);const u={rowIndex:t,column:a,rowPinned:i};s.setFocusedCell({...u,forceBrowserFocus:!0}),o?.setRangeToCell(u)}addListeners(){this.addManagedEventListeners({rowEditingStarted:e=>{this.activeRowEdit={rowIndex:e.rowIndex,rowPinned:e.rowPinned}},rowEditingStopped:()=>{const e=new Um(this.cellValueChanges);this.pushActionsToUndoStack(e),this.activeRowEdit=null},cellEditingStarted:e=>{this.activeCellEdit={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned}},cellEditingStopped:e=>{if(this.activeCellEdit=null,e.valueChanged&&!this.activeRowEdit&&!this.isPasting&&!this.isRangeInAction){const n=new Um(this.cellValueChanges);this.pushActionsToUndoStack(n)}},pasteStart:()=>{this.isPasting=!0},pasteEnd:()=>{const e=new Um(this.cellValueChanges);this.pushActionsToUndoStack(e),this.isPasting=!1},fillStart:()=>{this.isRangeInAction=!0},fillEnd:e=>{const t=new BD(this.cellValueChanges,e.initialRange,e.finalRange);this.pushActionsToUndoStack(t),this.isRangeInAction=!1},keyShortcutChangedCellStart:()=>{this.isRangeInAction=!0},keyShortcutChangedCellEnd:()=>{let e;const{rangeSvc:t,gos:n}=this.beans;t&&Gl(n)?e=new BD(this.cellValueChanges,void 0,void 0,[...t.getCellRanges()]):e=new Um(this.cellValueChanges),this.pushActionsToUndoStack(e),this.isRangeInAction=!1}})}pushActionsToUndoStack(e){this.undoStack.push(e),this.cellValueChanges=[],this.redoStack.clear()}},ytt=".ag-cell-inline-editing{border:var(--ag-cell-editing-border)!important;border-radius:var(--ag-border-radius);box-shadow:var(--ag-cell-editing-shadow);padding:0;z-index:1;.ag-cell-edit-wrapper,.ag-cell-editor,.ag-cell-wrapper,:where(.ag-cell-editor) .ag-input-field-input,:where(.ag-cell-editor) .ag-wrapper{height:100%;line-height:normal;width:100%}}:where(.ag-popup-editor) .ag-large-text{background-color:var(--ag-background-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);padding:0}.ag-large-text-input{height:auto;padding:var(--ag-cell-horizontal-padding)}:where(.ag-rtl .ag-large-text-input) textarea{resize:none}:where(.ag-ltr) .ag-checkbox-edit{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-checkbox-edit{padding-right:var(--ag-cell-horizontal-padding)}",wtt={tag:"div",cls:"ag-cell-wrapper ag-cell-edit-wrapper ag-checkbox-edit",children:[{tag:"ag-checkbox",ref:"eCheckbox",role:"presentation"}]},btt=class extends Cg{constructor(){super(wtt,[kN]),this.eCheckbox=ge}init(e){this.params=e;const t=e.value??void 0,n=this.eCheckbox;n.setValue(t),n.getInputElement().setAttribute("tabindex","-1"),this.setAriaLabel(t),this.addManagedListeners(n,{fieldValueChanged:r=>this.setAriaLabel(r.selected)})}getValue(){return this.eCheckbox.getValue()}focusIn(){this.eCheckbox.getFocusableElement().focus()}afterGuiAttached(){this.params.cellStartedEdit&&this.focusIn()}isPopup(){return!1}setAriaLabel(e){const t=this.getLocaleTextFunc(),n=aN(t,e),i=t("ariaToggleCellValue","Press SPACE to toggle cell value");this.eCheckbox.setInputAriaLabel(`${i} (${n})`)}},GR=class extends Cg{constructor(e){super({tag:"div",cls:"ag-cell-edit-wrapper",children:[e.getTemplate()]},e.getAgComponents()),this.cellEditorInput=e,this.eInput=ge}init(e){this.params=e;const{cellStartedEdit:t,eventKey:n,suppressPreventDefault:i}=e,r=this.eInput;this.cellEditorInput.init(r,e);let s,o=!0;t?(this.focusAfterAttached=!0,n===K.BACKSPACE||n===K.DELETE?s="":n&&n.length===1?i?o=!1:s=n:(s=this.cellEditorInput.getStartValue(),n!==K.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,s=this.cellEditorInput.getStartValue()),o&&s!=null&&r.setStartValue(s),this.addManagedElementListeners(r.getGui(),{keydown:a=>{const{key:l}=a;(l===K.PAGE_UP||l===K.PAGE_DOWN)&&a.preventDefault()}})}afterGuiAttached(){const e=this.getLocaleTextFunc(),t=this.eInput;if(t.setInputAriaLabel(e("ariaInputEditor","Input Editor")),!this.focusAfterAttached)return;wh()||t.getFocusableElement().focus();const n=t.getInputElement();this.highlightAllOnFocus?n.select():this.cellEditorInput.setCaret?.()}focusIn(){const e=this.eInput,t=e.getFocusableElement(),n=e.getInputElement();t.focus(),n.select()}getValue(){return this.cellEditorInput.getValue()}isPopup(){return!1}},Stt={tag:"ag-input-date-field",ref:"eInput",cls:"ag-cell-editor"},xtt=class{getTemplate(){return Stt}getAgComponents(){return[Kne]}init(e,t){this.eInput=e,this.params=t;const{min:n,max:i,step:r}=t;n!=null&&e.setMin(n),i!=null&&e.setMax(i),r!=null&&e.setStep(r)}getValue(){const{eInput:e,params:t}=this,n=e.getDate();return!me(n)&&!me(t.value)?t.value:n??null}getStartValue(){const{value:e}=this.params;if(e instanceof Date)return Ts(e,!1)}},Rtt=class extends GR{constructor(){super(new xtt)}},Ett={tag:"ag-input-date-field",ref:"eInput",cls:"ag-cell-editor"},Ftt=class{constructor(e){this.getDataTypeService=e}getTemplate(){return Ett}getAgComponents(){return[Kne]}init(e,t){this.eInput=e,this.params=t;const{min:n,max:i,step:r}=t;n!=null&&e.setMin(n),i!=null&&e.setMax(i),r!=null&&e.setStep(r)}getValue(){const{params:e,eInput:t}=this,n=this.formatDate(t.getDate());return!me(n)&&!me(e.value)?e.value:e.parseValue(n??"")}getStartValue(){return Ts(this.parseDate(this.params.value??void 0)??null,!1)}parseDate(e){const t=this.getDataTypeService();return t?t.getDateParserFunction(this.params.column)(e):Rr(e)??void 0}formatDate(e){const t=this.getDataTypeService();return t?t.getDateFormatterFunction(this.params.column)(e):Ts(e??null,!1)??void 0}},Att=class extends GR{constructor(){super(new Ftt(()=>this.beans.dataTypeSvc))}},Dtt={tag:"div",cls:"ag-large-text",children:[{tag:"ag-input-text-area",ref:"eTextArea",cls:"ag-large-text-input"}]},Ptt=class extends Cg{constructor(){super(Dtt,[FKe]),this.eTextArea=ge}init(e){this.params=e,this.focusAfterAttached=e.cellStartedEdit,this.eTextArea.setMaxLength(e.maxLength||200).setCols(e.cols||60).setRows(e.rows||10),e.value!=null&&this.eTextArea.setValue(e.value.toString(),!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.activateTabIndex()}onKeyDown(e){const t=e.key;(t===K.LEFT||t===K.UP||t===K.RIGHT||t===K.DOWN||e.shiftKey&&t===K.ENTER)&&e.stopPropagation()}afterGuiAttached(){const e=this.getLocaleTextFunc();this.eTextArea.setInputAriaLabel(e("ariaInputEditor","Input Editor")),this.focusAfterAttached&&this.eTextArea.getFocusableElement().focus()}getValue(){const e=this.eTextArea.getValue(),t=this.params;return!me(e)&&!me(t.value)?t.value:t.parseValue(e)}},ktt={tag:"ag-input-number-field",ref:"eInput",cls:"ag-cell-editor"},Ttt=class{getTemplate(){return ktt}getAgComponents(){return[AKe]}init(e,t){this.eInput=e,this.params=t;const{max:n,min:i,precision:r,step:s}=t;n!=null&&e.setMax(n),i!=null&&e.setMin(i),r!=null&&e.setPrecision(r),s!=null&&e.setStep(s);const o=e.getInputElement();t.preventStepping?e.addManagedElementListeners(o,{keydown:this.preventStepping}):t.showStepperButtons&&o.classList.add("ag-number-field-input-stepper")}preventStepping(e){(e.key===K.UP||e.key===K.DOWN)&&e.preventDefault()}getValue(){const{eInput:e,params:t}=this,n=e.getValue();if(!me(n)&&!me(t.value))return t.value;let i=t.parseValue(n);if(i==null)return i;if(typeof i=="string"){if(i==="")return null;i=Number(i)}return isNaN(i)?null:i}getStartValue(){return this.params.value}setCaret(){wh()&&this.eInput.getInputElement().focus({preventScroll:!0})}},Mtt=class extends GR{constructor(){super(new Ttt)}},Itt={tag:"div",cls:"ag-cell-edit-wrapper",children:[{tag:"ag-select",ref:"eSelect",cls:"ag-cell-editor"}]},_tt=class extends Cg{constructor(){super(Itt,[$Ke]),this.eSelect=ge,this.startedByEnter=!1}wireBeans(e){this.valueSvc=e.valueSvc}init(e){this.focusAfterAttached=e.cellStartedEdit;const{eSelect:t,valueSvc:n,gos:i}=this,{values:r,value:s,eventKey:o}=e;if(Wt(r)){ue(58);return}this.startedByEnter=o!=null?o===K.ENTER:!1;let a=!1;r.forEach(d=>{const h={value:d},p=n.formatValue(e.column,null,d),g=p!=null;h.text=g?p:d,t.addOption(h),a=a||s===d}),a?t.setValue(e.value,!0):e.values.length&&t.setValue(e.values[0],!0);const{valueListGap:l,valueListMaxWidth:u,valueListMaxHeight:c}=e;l!=null&&t.setPickerGap(l),c!=null&&t.setPickerMaxHeight(c),u!=null&&t.setPickerMaxWidth(u),i.get("editType")!=="fullRow"&&this.addManagedListeners(this.eSelect,{selectedItem:()=>e.stopEditing()})}afterGuiAttached(){this.focusAfterAttached&&this.eSelect.getFocusableElement().focus(),this.startedByEnter&&setTimeout(()=>{this.isAlive()&&this.eSelect.showPicker()})}focusIn(){this.eSelect.getFocusableElement().focus()}getValue(){return this.eSelect.getValue()}isPopup(){return!1}},Ott={tag:"ag-input-text-field",ref:"eInput",cls:"ag-cell-editor"},Ltt=class{getTemplate(){return Ott}getAgComponents(){return[OR]}init(e,t){this.eInput=e,this.params=t;const n=t.maxLength;n!=null&&e.setMaxLength(n)}getValue(){const{eInput:e,params:t}=this,n=e.getValue();return!me(n)&&!me(t.value)?t.value:t.parseValue(n)}getStartValue(){const e=this.params;return e.useFormatter||e.column.getColDef().refData?e.formatValue(e.value):e.value}setCaret(){const e=this.eInput,t=e.getValue(),n=me(t)&&t.length||0;n&&e.getInputElement().setSelectionRange(n,n)}},IW=class extends GR{constructor(){super(new Ltt)}};function Ntt(e){return e.ctrlsSvc.getScrollFeature().getVScrollPosition()}function $tt(e){return e.ctrlsSvc.getScrollFeature().getHScrollPosition()}function Wie(e,t,n="auto"){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureColumnVisible(t,n),"ensureVisible")}function Uie(e,t,n){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureIndexVisible(t,n),"ensureVisible")}function Btt(e,t,n=null){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureNodeVisible(t,n),"ensureVisible")}function Gtt(e){e.undoRedo?.undo("api")}function ztt(e){e.undoRedo?.redo("api")}function Htt(e,t={}){const n=[];return e.rowRenderer.getCellCtrls(t.rowNodes,t.columns).forEach(i=>{const r=i.comp?.getCellEditor();r&&n.push(f0(r))}),n}function Vtt(e){const t=[];return e.rowRenderer.getAllCellCtrls().forEach(n=>{if(n.editing){const{cellPosition:i}=n;t.push(i)}}),t}function Wtt(e,t=!1){e.editSvc?.stopAllEditing(t)}function Utt(e,t){const n=e.colModel.getCol(t.colKey);if(!n){ue(12,{colKey:t.colKey});return}const i={rowIndex:t.rowIndex,rowPinned:t.rowPinned||null,column:n};t.rowPinned==null&&Uie(e,t.rowIndex),Wie(e,t.colKey);const s=Cf(e,i);if(!s)return;const{focusSvc:o,gos:a,editSvc:l}=e,u=()=>{const d=Xt(e),h=s.eGui;return d!==h&&!!h?.contains(d)},c=a.get("stopEditingWhenCellsLoseFocus")&&u();(c||!o.isCellFocused(i))&&o.setFocusedCell({...i,forceBrowserFocus:c,preventScrollOnBrowserFocus:!0}),l?.startRowOrCellEdit(s,t.key)}function jtt(e){return e.undoRedo?.getCurrentUndoStackSize()??0}function qtt(e){return e.undoRedo?.getCurrentRedoStackSize()??0}var Ktt={tag:"div",cls:"ag-popup-editor",attrs:{tabindex:"-1"}},Ytt=class extends Cg{constructor(e){super(Ktt),this.params=e}postConstruct(){Zd(this.gos,this.getGui(),"popupEditorWrapper",!0),this.addKeyDownListener()}addKeyDownListener(){const e=this.getGui(),t=this.params,n=i=>{OT(this.gos,i,t.node,t.column,!0)||t.onKeyDown(i)};this.addManagedElementListeners(e,{keydown:n})}},Xtt=class extends X{constructor(){super(...arguments),this.beanName="editSvc"}startEditing(e,t=null,n=!1,i=null){if(!e.isCellEditable()||e.editing)return!1;if(!e.comp)return e.onCompAttachedFuncs.push(()=>{this.startEditing(e,t,n,i)}),!0;const r=this.createCellEditorParams(e,t,n),s=e.column.getColDef(),o=tW(this.beans.userCompFactory,s,r),a=o?.popupFromSelector!=null?o.popupFromSelector:!!s.cellEditorPopup,l=o?.popupPositionFromSelector!=null?o.popupPositionFromSelector:s.cellEditorPopupPosition;return _W(e,!0,o),e.comp.setEditDetails(o,a,l,this.gos.get("reactiveCustomComponents")),this.eventSvc.dispatchEvent(e.createEvent(i,"cellEditingStarted")),!o?.params?.suppressPreventDefault}stopEditing(e,t=!1){if(e.onEditorAttachedFuncs=[],!e.editing)return!1;const{comp:n,column:i,rowNode:r}=e,{newValue:s,newValueExists:o}=Qtt(t,n),a=this.beans.valueSvc.getValueForDisplay(i,r);let l=!1;return o&&(l=Jtt(e,a,s,r,i)),_W(e,!1,void 0),n.setEditDetails(),e.updateAndFormatValue(!1),e.refreshCell({forceRefresh:!0,suppressFlash:!0}),this.eventSvc.dispatchEvent({...e.createEvent(null,"cellEditingStopped"),oldValue:a,newValue:s,valueChanged:l}),l}handleColDefChanged(e){const t=e.comp?.getCellEditor();if(t?.refresh){const{eventKey:n,cellStartedEdit:i}=e.editCompDetails.params,r=this.createCellEditorParams(e,n,i),s=e.column.getColDef(),o=tW(this.beans.userCompFactory,s,r);t.refresh(o.params)}}setFocusOutOnEditor(e){if(!e.editing)return;const t=e.comp.getCellEditor();t&&t.focusOut&&t.focusOut()}setFocusInOnEditor(e){if(!e.editing)return;const t=e.comp,n=t.getCellEditor();n?.focusIn?n.focusIn():(e.focusCell(!0),e.onEditorAttachedFuncs.push(()=>t.getCellEditor()?.focusIn?.()))}createPopupEditorWrapper(e){return new Ytt(e)}stopAllEditing(e=!1){this.beans.rowRenderer.getAllRowCtrls().forEach(t=>this.stopRowEditing(t,e))}stopRowEditing(e,t=!1){if(e.stoppingRowEdit)return;const n=e.getAllCellCtrls(),i=e.editing;e.stoppingRowEdit=!0;let r=!1;for(const s of n){const o=s.stopEditing(t);i&&!t&&!r&&o&&(r=!0)}r&&this.eventSvc.dispatchEvent(e.createRowEvent("rowValueChanged")),i&&this.beans.rowEditSvc?.setEditing(e,!1),e.stoppingRowEdit=!1}addStopEditingWhenGridLosesFocus(e){if(!this.gos.get("stopEditingWhenCellsLoseFocus"))return;const t=n=>{const i=n.relatedTarget;if(RT(i)===null){this.stopAllEditing();return}let r=e.some(s=>s.contains(i))&&Fne(this.gos,i);if(!r){const s=this.beans.popupSvc;r=!!s&&(s.getActivePopups().some(o=>o.contains(i))||s.isElementWithinCustomPopup(i))}r||this.stopAllEditing()};e.forEach(n=>this.addManagedElementListeners(n,{focusout:t}))}setInlineEditingCss(e){const t=e.editing||e.getAllCellCtrls().some(n=>n.editing);e.forEachGui(void 0,n=>{n.rowComp.addOrRemoveCssClass("ag-row-inline-editing",t),n.rowComp.addOrRemoveCssClass("ag-row-not-inline-editing",!t)})}isCellEditable(e,t){if(t.group){if(this.gos.get("treeData")){if(!t.data&&!this.gos.get("enableGroupEdit"))return!1}else if(!this.gos.get("enableGroupEdit"))return!1}return e.isColumnFunc(t,e.colDef.editable)}startRowOrCellEdit(e,t,n=null){return e.comp?this.gos.get("editType")==="fullRow"?this.beans.rowEditSvc?.startEditing(e.rowCtrl,t,e)??!1:this.startEditing(e,t,!0,n):(e.onCompAttachedFuncs.push(()=>{this.startRowOrCellEdit(e,t,n)}),!0)}stopRowOrCellEdit(e,t=!1,n=!1,i=!1){this.gos.get("editType")==="fullRow"?this.stopRowEditing(e.rowCtrl,t):this.stopEditing(e,t),n||this.navigateAfterEdit(i,e.cellPosition)}createCellEditorParams(e,t,n){const{column:i,rowNode:r,cellPosition:{rowIndex:s}}=e,{valueSvc:o,gos:a}=this.beans;return Ne(a,{value:o.getValueForDisplay(i,r),eventKey:t,column:i,colDef:i.getColDef(),rowIndex:s,node:r,data:r.data,cellStartedEdit:n,onKeyDown:e.onKeyDown.bind(e),stopEditing:this.stopRowOrCellEdit.bind(this,e,!1),eGridCell:e.eGui,parseValue:l=>o.parseValue(i,r,l,e.value),formatValue:e.formatValue.bind(e)})}navigateAfterEdit(e,t){if(this.gos.get("enterNavigatesVerticallyAfterEdit")){const i=e?K.UP:K.DOWN;this.beans.navigation?.navigateToNextCell(null,i,t,!1)}}};function _W(e,t,n){e.editCompDetails=n,e.editing!==t&&(e.editing=t)}function Qtt(e,t){const n={newValueExists:!1};if(e)return n;const i=t.getCellEditor();return!i||i.isCancelAfterEnd&&i.isCancelAfterEnd()?n:{newValue:i.getValue(),newValueExists:!0}}function Jtt(e,t,n,i,r){if(n===t)return!1;e.suppressRefreshCell=!0;const s=i.setDataValue(r,n,"edit");return e.suppressRefreshCell=!1,s}var Ztt=class extends X{constructor(){super(...arguments),this.beanName="rowEditSvc"}startEditing(e,t=null,n=null,i=null){if(e.editing)return!1;let r=!0,s=!1;const{editSvc:o}=this.beans;return e.getAllCellCtrls().forEach(a=>{const l=a===n;l?r=o?.startEditing(a,t,l,i)??!1:o?.startEditing(a,null,l,i),s||(s=a.editing)}),s&&this.setEditing(e,!0),r}setEditing(e,t){e.editing=t,e.forEachGui(void 0,i=>i.rowComp.addOrRemoveCssClass("ag-row-editing",t));const n=t?e.createRowEvent("rowEditingStarted"):e.createRowEvent("rowEditingStopped");this.eventSvc.dispatchEvent(n)}},kc={moduleName:"EditCore",version:Ce,beans:[Xtt,Ztt],apiFunctions:{getCellEditorInstances:Htt,getEditingCells:Vtt,stopEditing:Wtt,startEditingCell:Utt},dependsOn:[$R],css:[ytt]},ent={moduleName:"UndoRedoEdit",version:Ce,beans:[Ctt],apiFunctions:{undoCellEditing:Gtt,redoCellEditing:ztt,getCurrentUndoSize:jtt,getCurrentRedoSize:qtt},dependsOn:[kc]},tnt={moduleName:"TextEditor",version:Ce,userComponents:{agCellEditor:IW,agTextCellEditor:IW},dependsOn:[kc]},nnt={moduleName:"NumberEditor",version:Ce,userComponents:{agNumberCellEditor:{classImp:Mtt,params:{suppressPreventDefault:!0}}},dependsOn:[kc]},int={moduleName:"DateEditor",version:Ce,userComponents:{agDateCellEditor:Rtt,agDateStringCellEditor:Att},dependsOn:[kc]},rnt={moduleName:"CheckboxEditor",version:Ce,userComponents:{agCheckboxCellEditor:btt},dependsOn:[kc]},snt={moduleName:"SelectEditor",version:Ce,userComponents:{agSelectCellEditor:_tt},dependsOn:[kc]},ont={moduleName:"LargeTextEditor",version:Ce,userComponents:{agLargeTextCellEditor:Ptt},dependsOn:[kc]},ant={moduleName:"CustomEditor",version:Ce,dependsOn:[kc]},lnt=class extends X{constructor(){super(...arguments),this.beanName="selectionColSvc"}postConstruct(){this.addManagedPropertyListener("rowSelection",e=>{this.onSelectionOptionsChanged(e.currentValue,e.previousValue,_f(e.source))}),this.addManagedPropertyListener("selectionColumnDef",this.updateColumns.bind(this))}addColumns(e){const t=this.columns;t!=null&&(e.list=t.list.concat(e.list),e.tree=t.tree.concat(e.tree),a7e(e))}createColumns(e,t){const n=()=>{KS(this.beans,this.columns?.tree),this.columns=null},i=e.treeDepth,s=(this.columns?.treeDepth??-1)==i,o=this.generateSelectionCols();if(o7e(o,this.columns?.list??[])&&s)return;n();const{colGroupSvc:l}=this.beans,u=l?.findDepth(e.tree)??0,c=l?.balanceTreeForAutoCols(o,u)??[];this.columns={list:o,tree:c,treeDepth:u,map:{}},t(h=>{if(!h)return null;const p=h.filter(g=>!zl(g));return[...o,...p]})}updateColumns(e){const t=_f(e.source),n=e.currentValue;this.columns?.list.forEach(i=>{const r=this.createSelectionColDef(n);i.setColDef(r,null,t),Jr(this.beans,{state:[{colId:i.getColId(),...r}]},t)})}getColumn(e){return this.columns?.list.find(t=>rne(t,e))??null}getColumns(){return this.columns?.list??null}isSelectionColumnEnabled(){const{gos:e,beans:t}=this,n=e.get("rowSelection");if(typeof n!="object"||!Ed(e))return!1;const i=(t.autoColSvc?.getColumns()?.length??0)>0;if(n.checkboxLocation==="autoGroupColumn"&&i)return!1;const r=!!If(n),s=Uw(n);return r||s}createSelectionColDef(e){const{gos:t}=this.beans,n=e??t.get("selectionColumnDef"),i=t.get("enableRtl"),{rowSpan:r,spanRows:s,...o}=n??{};return{width:50,resizable:!1,suppressHeaderMenuButton:!0,sortable:!1,suppressMovable:!0,lockPosition:i?"right":"left",comparator(a,l,u,c){const d=u.isSelected(),h=c.isSelected();return d===h?0:d?1:-1},editable:!1,suppressFillHandle:!0,pinned:null,...o,colId:nne}}generateSelectionCols(){if(!this.isSelectionColumnEnabled())return[];const e=this.createSelectionColDef(),t=e.colId;this.beans.validation?.validateColDef(e,t,!0);const n=new mN(e,null,t,!1);return this.createBean(n),[n]}onSelectionOptionsChanged(e,t,n){const i=t&&typeof t!="string"?If(t):void 0,r=e&&typeof e!="string"?If(e):void 0,s=i!==r,o=t&&typeof t!="string"?Uw(t):void 0,a=e&&typeof e!="string"?Uw(e):void 0,l=o!==a,u=US(e),c=US(t);(s||l||u!==c)&&this.beans.colModel.refreshAll(n)}destroy(){KS(this.beans,this.columns?.tree),super.destroy()}refreshVisibility(e){if(!this.isSelectionColumnEnabled())return;const t=this.beans,n=t.visibleCols.getAllTrees()??[];if(n.length!==0){if(!n.some(jie)){const i=h0(t).find(r=>zl(r.colId));i&&Jr(t,{state:[{colId:i.colId,hide:!i.hide}]},e)}if(n.length===1){const i=n[0],r=qie(i);if(!r)return;Jr(t,{state:[{colId:r.getColId(),hide:!0}]},e)}}}},jie=e=>e.isColumn?zl(e):e.getChildren()?.some(jie)??!1;function qie(e){if(e.isColumn)return zl(e)?e:null;const t=e.getChildren()??[];for(const n of t){const i=qie(n);if(i)return i}return null}function unt(e,t){if(!t.nodes.every(o=>o.rowPinned?(ue(59),!1):o.id===void 0?(ue(60),!1):!0))return;const{nodes:i,source:r,newValue:s}=t;e.selectionSvc?.setNodesSelected({nodes:i,source:r??"api",newValue:s})}function cnt(e,t,n="apiSelectAll"){e.selectionSvc?.selectAllRowNodes({source:n,selectAll:t})}function dnt(e,t,n="apiSelectAll"){e.selectionSvc?.deselectAllRowNodes({source:n,selectAll:t})}function hnt(e,t="apiSelectAllFiltered"){e.selectionSvc?.selectAllRowNodes({source:t,selectAll:"filtered"})}function fnt(e,t="apiSelectAllFiltered"){e.selectionSvc?.deselectAllRowNodes({source:t,selectAll:"filtered"})}function pnt(e,t="apiSelectAllCurrentPage"){e.selectionSvc?.selectAllRowNodes({source:t,selectAll:"currentPage"})}function gnt(e,t="apiSelectAllCurrentPage"){e.selectionSvc?.deselectAllRowNodes({source:t,selectAll:"currentPage"})}function mnt(e){return e.selectionSvc?.getSelectedNodes()??[]}function vnt(e){return e.selectionSvc?.getSelectedRows()??[]}var Cnt=class extends xKe{constructor(){super(...arguments),this.beanName="selectionSvc",this.selectedNodes=new Map,this.detailSelection=new Map,this.masterSelectsDetail=!1}postConstruct(){super.postConstruct();const{gos:e}=this;this.mode=jS(e),this.groupSelectsDescendants=d0(e),this.groupSelectsFiltered=qS(e)==="filteredDescendants",this.masterSelectsDetail=Y6(e)==="detail",this.addManagedPropertyListeners(["groupSelectsChildren","groupSelectsFiltered","rowSelection"],()=>{const t=d0(e),n=jS(e),i=qS(e)==="filteredDescendants";this.masterSelectsDetail=Y6(e)==="detail",(t!==this.groupSelectsDescendants||i!==this.groupSelectsFiltered||n!==this.mode)&&(this.deselectAllRowNodes({source:"api"}),this.groupSelectsDescendants=t,this.groupSelectsFiltered=i,this.mode=n)}),this.addManagedEventListeners({rowSelected:this.onRowSelected.bind(this)})}destroy(){super.destroy(),this.resetNodes()}handleSelectionEvent(e,t,n){if(this.isRowSelectionBlocked(t))return 0;const i=this.inferNodeSelections(t,e.shiftKey,e.metaKey||e.ctrlKey,n);return i==null?0:(this.selectionCtx.selectAll=!1,"select"in i?(i.reset?this.resetNodes():this.selectRange(i.deselect,!1,n),this.selectRange(i.select,!0,n)):this.setNodesSelected({nodes:[i.node],newValue:i.newValue,clearSelection:i.clearSelection,event:e,source:n}))}setNodesSelected({newValue:e,clearSelection:t,suppressFinishActions:n,nodes:i,event:r,source:s}){if(!Ed(this.gos)&&e)return ue(132),0;if(i.length===0)return 0;if(i.length>1&&!this.isMultiSelect())return ue(130),0;let o=0;for(let a=0;a<i.length;a++){const l=i[a],u=gw(l),c=this.groupSelectsFiltered&&u.group;if(u.rowPinned){ue(59);continue}if(u.id===void 0){ue(60);continue}c||this.selectRowNode(u,e,r,s)&&(this.detailSelection.delete(u.id),o++),this.groupSelectsDescendants&&u.childrenAfterGroup?.length&&(o+=this.selectChildren(u,e,s))}return n||(e&&(t||!this.isMultiSelect())&&(o+=this.clearOtherNodes(gw(i[0]),s)),o>0&&(this.updateGroupsFromChildrenSelections(s),this.dispatchSelectionChanged(s))),o}selectRange(e,t,n){let i=0;return e.forEach(r=>{if(r.group&&this.groupSelectsDescendants)return;this.selectRowNode(r,t,void 0,n)&&i++}),i>0&&(this.updateGroupsFromChildrenSelections(n),this.dispatchSelectionChanged(n)),i}selectChildren(e,t,n){const i=this.groupSelectsFiltered?e.childrenAfterAggFilter:e.childrenAfterGroup;return i?this.setNodesSelected({newValue:t,clearSelection:!1,suppressFinishActions:!0,source:n,nodes:i}):0}getSelectedNodes(){return Array.from(this.selectedNodes.values())}getSelectedRows(){const e=[];return this.selectedNodes.forEach(t=>e.push(t.data)),e}getSelectionCount(){return this.selectedNodes.size}filterFromSelection(e){const t=new Map;this.selectedNodes.forEach((n,i)=>{e(n)&&t.set(i,n)}),this.selectedNodes=t}updateGroupsFromChildrenSelections(e,t){if(!this.groupSelectsDescendants)return!1;const{gos:n,rowModel:i}=this.beans;if(!Xi(n))return!1;const r=i.rootNode;if(!r)return!1;t||(t=new o1(!0,r),t.active=!1);let s=!1;return t.forEachChangedNodeDepthFirst(o=>{if(o!==r){const a=this.calculateSelectedFromChildren(o);s=this.selectRowNode(o,a===null?!1:a,void 0,e)||s}}),s}clearOtherNodes(e,t){const n=new Map;let i=0;return this.selectedNodes.forEach(r=>{if(r&&r.id!==e.id){const s=this.selectedNodes.get(r.id);i+=this.setNodesSelected({nodes:[s],newValue:!1,clearSelection:!1,suppressFinishActions:!0,source:t}),this.groupSelectsDescendants&&r.parent&&n.set(r.parent.id,r.parent)}}),n.forEach(r=>{const s=this.calculateSelectedFromChildren(r);this.selectRowNode(r,s===null?!1:s,void 0,t)}),i}onRowSelected(e){const t=e.node;this.groupSelectsDescendants&&t.group||(t.isSelected()?this.selectedNodes.set(t.id,t):this.selectedNodes.delete(t.id))}syncInRowNode(e,t){this.syncInOldRowNode(e,t),this.syncInNewRowNode(e)}createDaemonNode(e){if(!e.id)return;const t=new Dp(this.beans);return t.id=e.id,t.data=e.data,t.__daemon=!0,t.__selected=e.__selected,t.level=e.level,t}syncInOldRowNode(e,t){t&&e.id!==t.id&&this.selectedNodes.get(t.id)==e&&this.selectedNodes.set(t.id,t)}syncInNewRowNode(e){this.selectedNodes.has(e.id)?(e.__selected=!0,this.selectedNodes.set(e.id,e)):e.__selected=!1}reset(e){const t=this.getSelectionCount();this.resetNodes(),t&&this.dispatchSelectionChanged(e)}resetNodes(){this.selectedNodes.forEach(e=>{this.selectRowNode(e,!1)}),this.selectedNodes.clear()}getBestCostNodeSelection(){const{gos:e,rowModel:t}=this.beans;if(!Xi(e))return;const n=t.getTopLevelNodes();if(n===null)return;const i=[];function r(s){for(let o=0,a=s.length;o<a;o++){const l=s[o];l.isSelected()?i.push(l):l.group&&l.childrenAfterGroup&&r(l.childrenAfterGroup)}}return r(n),i}isEmpty(){return this.getSelectionCount()===0}deselectAllRowNodes({source:e,selectAll:t}){const n=Xi(this.gos);let i=!1;const r=s=>{const o=this.selectRowNode(gw(s),!1,void 0,e);i||(i=o)};if(t==="currentPage"||t==="filtered"){if(!n){wt(102);return}this.getNodesToSelect(t).forEach(r)}else this.selectedNodes.forEach(r),this.reset(e);if(this.selectionCtx.selectAll=!1,n&&this.groupSelectsDescendants){const s=this.updateGroupsFromChildrenSelections(e);i||(i=s)}i&&this.dispatchSelectionChanged(e)}getSelectedCounts(e){let t=0,n=0;return this.getNodesToSelect(e).forEach(i=>{this.groupSelectsDescendants&&i.group||(i.isSelected()?t++:i.selectable&&n++)}),{selectedCount:t,notSelectedCount:n}}getSelectAllState(e){const{selectedCount:t,notSelectedCount:n}=this.getSelectedCounts(e);return Kie(t,n)??null}hasNodesToSelect(e){return this.getNodesToSelect(e).filter(t=>t.selectable).length>0}getNodesToSelect(e){if(!this.canSelectAll())return[];const t=[];if(e==="currentPage")return this.forEachNodeOnPage(i=>{if(!i.group){t.push(i);return}if(!i.expanded&&!i.footer){const r=s=>{t.push(s),s.childrenAfterFilter?.length&&s.childrenAfterFilter.forEach(r)};r(i);return}this.groupSelectsDescendants||t.push(i)}),t;const n=this.beans.rowModel;return e==="filtered"?(n.forEachNodeAfterFilter(i=>{t.push(i)}),t):(n.forEachNode(i=>{t.push(i)}),t)}forEachNodeOnPage(e){const{pageBounds:t,rowModel:n}=this.beans,i=t.getFirstRow(),r=t.getLastRow();for(let s=i;s<=r;s++){const o=n.getRow(s);o&&e(o)}}selectAllRowNodes(e){const{gos:t,selectionCtx:n}=this;if(!Ed(t)){ue(132);return}if(N9e(t)&&!c0(t)){ue(130);return}if(!this.canSelectAll())return;const{source:i,selectAll:r}=e;let s=!1;if(this.getNodesToSelect(r).forEach(o=>{const a=this.selectRowNode(gw(o),!0,void 0,i);s||(s=a)}),n.selectAll=!0,Xi(t)&&this.groupSelectsDescendants){const o=this.updateGroupsFromChildrenSelections(i);s||(s=o)}s&&this.dispatchSelectionChanged(i)}getSelectionState(){return this.isEmpty()?null:Array.from(this.selectedNodes.keys())}setSelectionState(e,t){if(!Array.isArray(e)){wt(103);return}const n=new Set(e),i=[];this.beans.rowModel.forEachNode(r=>{n.has(r.id)&&i.push(r)}),this.setNodesSelected({newValue:!0,nodes:i,source:t})}canSelectAll(){const{gos:e,rowModel:t}=this.beans;return Xi(e)?!0:(wt(100,{rowModelType:t.getType()}),!1)}updateSelectable(e){const{gos:t,rowModel:n}=this.beans;if(!Ed(t))return;const i="selectableChanged",r=e!==void 0,s=Xi(t)&&this.groupSelectsDescendants,o=[],a=l=>{if(r&&!l.group)return;if(s&&l.group){const c=l.childrenAfterGroup?.some(d=>d.selectable)??!1;this.setRowSelectable(l,c,!0);return}!this.updateRowSelectable(l,!0)&&l.isSelected()&&o.push(l)};if(s){if(e===void 0){const l=n.rootNode;e=l?new o1(!1,l):void 0}e?.forEachChangedNodeDepthFirst(a,!r,!r)}else n.forEachNode(a);o.length&&this.setNodesSelected({nodes:o,newValue:!1,source:i}),!r&&s&&this.updateGroupsFromChildrenSelections?.(i)}updateSelectableAfterGrouping(e){this.updateSelectable(e),this.groupSelectsDescendants&&this.updateGroupsFromChildrenSelections?.("rowGroupChanged",e)&&this.dispatchSelectionChanged("rowGroupChanged")}refreshMasterNodeState(e,t){if(!this.masterSelectsDetail)return;const n=e.detailNode?.detailGridInfo?.api;if(!n)return;const i=ynt(n);if(e.isSelected()!==i&&this.selectRowNode(e,i,t,"masterDetail")&&this.dispatchSelectionChanged("masterDetail"),!i){const s=this.detailSelection.get(e.id)??new Set;for(const o of n.getSelectedNodes())s.add(o.id);this.detailSelection.set(e.id,s)}}setDetailSelectionState(e,t,n){if(this.masterSelectsDetail){if(!c0(t)){ue(269);return}switch(e.isSelected()){case!0:{n.selectAll();break}case!1:{n.deselectAll();break}case void 0:{const i=this.detailSelection.get(e.id);if(i){const r=[];for(const s of i){const o=n.getRowNode(s);o&&r.push(o)}n.setNodesSelected({nodes:r,newValue:!0,source:"masterDetail"})}break}}}}dispatchSelectionChanged(e){this.eventSvc.dispatchEvent({type:"selectionChanged",source:e,selectedNodes:this.getSelectedNodes(),serverSideState:null})}};function gw(e){return e.footer?e.sibling:e}function ynt(e){let t=0,n=0;return e.forEachNode(i=>{i.isSelected()?t++:i.selectable&&n++}),Kie(t,n)}function Kie(e,t){if(e===0&&t===0)return!1;if(!(e>0&&t>0))return e>0}var wnt={moduleName:"SharedRowSelection",version:Ce,beans:[lnt],apiFunctions:{setNodesSelected:unt,selectAll:cnt,deselectAll:dnt,selectAllFiltered:hnt,deselectAllFiltered:fnt,selectAllOnCurrentPage:pnt,deselectAllOnCurrentPage:gnt,getSelectedNodes:mnt,getSelectedRows:vnt}},bnt={moduleName:"RowSelection",version:Ce,rowModels:["clientSide","infinite","viewport"],beans:[Cnt],dependsOn:[wnt]};function Snt(e){e.expansionSvc?.expandAll(!0)}function xnt(e){e.expansionSvc?.expandAll(!1)}function Rnt(e){const t=Ga(e),n=bie(e);t?t.onRowHeightChanged():n&&n.onRowHeightChanged()}function Ent(e,t,n){const i=bie(e);if(i){if(e.rowGroupColsSvc?.columns.length===0){if(t<0){wt(238);return}i.setRowCount(t,n);return}wt(28);return}const r=NR(e);if(r){r.setRowCount(t,n);return}}function Fnt(e){return mg(e.gos)?e.rowModel.getBlockStates():e.rowNodeBlockLoader?.getBlockState()??{}}function Ant(e){return e.rowModel.isLastRowIndexKnown()}var Dnt={moduleName:"CsrmSsrmSharedApi",version:Ce,apiFunctions:{expandAll:Snt,collapseAll:xnt,onRowHeightChanged:Rnt}},Pnt={moduleName:"SsrmInfiniteSharedApi",version:Ce,apiFunctions:{setRowCount:Ent,getCacheBlockState:Fnt,isLastRowIndexKnown:Ant}},knt=class extends X{constructor(){super(...arguments),this.beanName="alignedGridsSvc",this.consuming=!1}getAlignedGridApis(){let e=this.gos.get("alignedGrids")??[];const t=typeof e=="function";return typeof e=="function"&&(e=e()),e.map(i=>{if(!i){wt(18),t||wt(20);return}if(this.isGridApi(i))return i;const r=i;return"current"in r?r.current?.api:(r.api||wt(19),r.api)}).filter(i=>!!i&&!i.isDestroyed())}isGridApi(e){return!!e&&!!e.dispatchEvent}postConstruct(){const e=this.fireColumnEvent.bind(this);this.addManagedEventListeners({columnMoved:e,columnVisible:e,columnPinned:e,columnGroupOpened:e,columnResized:e,bodyScroll:this.fireScrollEvent.bind(this),alignedGridColumn:({event:t})=>this.onColumnEvent(t),alignedGridScroll:({event:t})=>this.onScrollEvent(t)})}fireEvent(e){this.consuming||this.getAlignedGridApis().forEach(t=>{t.isDestroyed()||t.dispatchEvent(e)})}onEvent(e){this.consuming=!0,e(),this.consuming=!1}fireColumnEvent(e){this.fireEvent({type:"alignedGridColumn",event:e})}fireScrollEvent(e){e.direction==="horizontal"&&this.fireEvent({type:"alignedGridScroll",event:e})}onScrollEvent(e){this.onEvent(()=>{this.beans.ctrlsSvc.getScrollFeature().setHorizontalScrollPosition(e.left,!0)})}extractDataFromEvent(e,t){const n=[];return e.columns?e.columns.forEach(i=>{n.push(t(i))}):e.column&&n.push(t(e.column)),n}getMasterColumns(e){return this.extractDataFromEvent(e,t=>t)}getColumnIds(e){return this.extractDataFromEvent(e,t=>t.getColId())}onColumnEvent(e){this.onEvent(()=>{switch(e.type){case"columnMoved":case"columnVisible":case"columnPinned":case"columnResized":{this.processColumnEvent(e);break}case"columnGroupOpened":{this.processGroupOpenedEvent(e);break}case"columnPivotChanged":ue(21);break}})}processGroupOpenedEvent(e){const{colGroupSvc:t}=this.beans;t&&e.columnGroups.forEach(n=>{let i=null;n&&(i=t.getProvidedColGroup(n.getGroupId())),!(n&&!i)&&t.setColumnGroupOpened(i,n.isExpanded(),"alignedGridChanged")})}processColumnEvent(e){const t=e.column;let n=null;const i=this.beans,{colResize:r,ctrlsSvc:s,colModel:o}=i;if(t&&(n=o.getColDefCol(t.getColId())),t&&!n)return;const a=this.getMasterColumns(e);switch(e.type){case"columnMoved":{const d=e.api.getColumnState().map(h=>({colId:h.colId}));Jr(i,{state:d,applyOrder:!0},"alignedGridChanged")}break;case"columnVisible":{const d=e.api.getColumnState().map(h=>({colId:h.colId,hide:h.hide}));Jr(i,{state:d},"alignedGridChanged")}break;case"columnPinned":{const d=e.api.getColumnState().map(h=>({colId:h.colId,pinned:h.pinned}));Jr(i,{state:d},"alignedGridChanged")}break;case"columnResized":{const c=e,d={};a.forEach(h=>{d[h.getId()]={key:h.getColId(),newWidth:h.getActualWidth()}}),c.flexColumns?.forEach(h=>{d[h.getId()]&&delete d[h.getId()]}),r?.setColumnWidths(Object.values(d),!1,c.finished,"alignedGridChanged");break}}const u=s.getGridBodyCtrl().isVerticalScrollShowing();this.getAlignedGridApis().forEach(c=>{c.setGridOption("alwaysShowVerticalScroll",u)})}},Tnt={moduleName:"AlignedGrids",version:Ce,beans:[knt]},Mnt=class extends CKe{constructor(){super(...arguments),this.beanName="csrmNodeSvc"}},GD=class{constructor(){this.removals=new Set,this.updates=new Set,this.adds=new Set}remove(e){this.adds.delete(e)||(this.updates.delete(e),this.removals.add(e))}update(e){this.adds.has(e)||this.updates.add(e)}add(e){this.adds.add(e)}};function Int(e){if(Wt(e.childrenAfterSort))return;const t=e.childrenAfterSort;for(let n=0;n<t.length;n++){const i=t[n],r=n===0,s=n===e.childrenAfterSort.length-1;i.setFirstChild(r),i.lastChild!==s&&(i.lastChild=s,i.dispatchRowEvent("lastChildChanged")),i.childIndex!==n&&(i.childIndex=n,i.dispatchRowEvent("childIndexChanged"))}}function Yie(e){e.sibling&&(e.sibling.childrenAfterSort=e.childrenAfterSort),Int(e)}var _nt=class extends X{constructor(){super(...arguments),this.beanName="sortStage",this.refreshProps=new Set(["postSortRows","groupDisplayType","accentedSort"]),this.step="sort"}execute(e){const t=this.beans,n=t.sortSvc.getSortOptions(),i=me(n)&&n.length>0,r=i&&!!e.changedRowNodes&&this.gos.get("deltaSort"),s=n.some(({column:o})=>sa(t.gos)?o.isPrimary()&&o.isRowGroupActive():!!o.getColDef().showRowGroup);this.sort(t,n,i,r,e.changedRowNodes,e.changedPath,s)}sort(e,t,n,i,r,s,o){const{gos:a,colModel:l,rowGroupColsSvc:u,rowNodeSorter:c,rowRenderer:d,showRowGroupCols:h}=e,p=a.get("groupMaintainOrder"),g=l.getCols().some(S=>S.isRowGroupActive()),v=l.isPivotMode(),C=a.getCallback("postSortRows");let y=!1;const b=S=>{const x=v&&S.leafGroup,E=p&&g&&!S.leafGroup&&!o;let A;if(E){const k=u?.columns?.[S.level+1]?.getSort()===null,P=S.childrenAfterAggFilter.slice(0);if(S.childrenAfterSort&&!k){const _={};S.childrenAfterSort.forEach((O,H)=>{_[O.id]=H}),P.sort((O,H)=>(_[O.id]??0)-(_[H.id]??0))}A=P}else!n||x?A=S.childrenAfterAggFilter.slice(0):i&&r?A=Ont(c,S,r,s,t):A=c.doFullSort(S.childrenAfterAggFilter,t);if(y||(y=S.childrenAfterSort?.[0]!==A[0]),S.childrenAfterSort=A,Yie(S),C){const F={nodes:S.childrenAfterSort};C(F)}};if(s?.forEachChangedNodeDepthFirst(b),y&&this.gos.get("groupHideOpenParents")){const S=h?.getShowRowGroupCols();S?.length&&d.refreshCells({columns:S,force:!0})}}};function Ont(e,t,n,i,r){const s=t.childrenAfterAggFilter,o=t.childrenAfterSort;if(!o)return e.doFullSort(s,r);const a=new Set,l=[],{updates:u,adds:c}=n;for(let h=0,p=s.length;h<p;++h){const g=s[h];u.has(g)||c.has(g)||i&&!i.canSkip(g)?l.push({currentPos:l.length,rowNode:g}):a.add(g.id)}const d=o.filter(h=>a.has(h.id)).map((h,p)=>({currentPos:p,rowNode:h}));return l.sort((h,p)=>e.compareRowNodes(r,h,p)),Lnt(e,r,l,d)}function Lnt(e,t,n,i){const r=[];let s=0,o=0;const a=n.length,l=i.length;for(;s<a&&o<l;){const u=n[s],c=i[o],d=e.compareRowNodes(t,u,c);let h;d<0?(h=u,++s):(h=c,++o),r.push(h.rowNode)}for(;s<a;)r.push(n[s++].rowNode);for(;o<l;)r.push(i[o++].rowNode);return r}var Nnt=class extends X{constructor(){super(...arguments),this.beanName="rowModel",this.rootNode=null,this.rowsToDisplay=[],this.started=!1,this.isRefreshingModel=!1,this.rowNodesCountReady=!1,this.rowCountReady=!1,this.onRowHeightChanged_debounced=hi(this,this.onRowHeightChanged.bind(this),100)}wireBeans(e){this.colModel=e.colModel,this.valueCache=e.valueCache,this.filterStage=e.filterStage,this.sortStage=e.sortStage,this.flattenStage=e.flattenStage,this.groupStage=e.groupStage,this.aggStage=e.aggStage,this.pivotStage=e.pivotStage,this.filterAggStage=e.filterAggStage}postConstruct(){this.orderedStages=[this.groupStage,this.filterStage,this.pivotStage,this.aggStage,this.sortStage,this.filterAggStage,this.flattenStage].filter(i=>!!i);const e=this.refreshModel.bind(this,{step:"group"}),t=this.refreshModel.bind(this,{step:"group",afterColumnsChanged:!0,keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame")});this.addManagedEventListeners({newColumnsLoaded:t,columnRowGroupChanged:e,columnValueChanged:this.onValueChanged.bind(this),columnPivotChanged:this.refreshModel.bind(this,{step:"pivot"}),filterChanged:this.onFilterChanged.bind(this),sortChanged:this.onSortChanged.bind(this),columnPivotModeChanged:e,gridStylesChanged:this.onGridStylesChanges.bind(this),gridReady:this.onGridReady.bind(this)}),this.addPropertyListeners(),this.rootNode=new Dp(this.beans);const n=this.getNewNodeManager();this.nodeManager=n,n.activate(this.rootNode)}getNewNodeManager(){const{gos:e,beans:t}=this;switch(W9e(e)){case"treeNested":return t.csrmChildrenTreeNodeSvc??t.csrmNodeSvc;case"treePath":return t.csrmPathTreeNodeSvc??t.csrmNodeSvc;default:return t.csrmNodeSvc}}addPropertyListeners(){const e=["treeData","treeDataChildrenField",...this.orderedStages.flatMap(({refreshProps:t})=>[...t])];this.addManagedPropertyListeners(e,t=>{const n=t.changeSet?.properties;n&&this.onPropChange(n)}),this.addManagedPropertyListener("rowData",()=>this.onPropChange(["rowData"])),this.addManagedPropertyListener("rowHeight",()=>this.resetRowHeights())}start(){this.started=!0,this.rowNodesCountReady?this.refreshModel({step:"group",rowDataUpdated:!0,newData:!0}):this.setInitialData()}setInitialData(){this.gos.get("rowData")&&this.onPropChange(["rowData"])}ensureRowHeightsValid(e,t,n,i){let r,s=!1;do{r=!1;const o=this.getRowIndexAtPixel(e),a=this.getRowIndexAtPixel(t),l=Math.max(o,n),u=Math.min(a,i);for(let c=l;c<=u;c++){const d=this.getRow(c);if(d.rowHeightEstimated){const h=Sp(this.beans,d);d.setRowHeight(h.height),r=!0,s=!0}}r&&this.setRowTopAndRowIndex()}while(r);return s}onPropChange(e){if(!this.rootNode)return;const t=this.gos,n=new Set(e),i={step:"nothing",changedProps:n},r=n.has("rowData"),s=this.nodeManager,o=this.getNewNodeManager(),a=s!==o||r&&n.has("treeData")&&t.get("treeData")||n.has("treeDataChildrenField")&&t.get("treeData");let l;if((a||r)&&(l=t.get("rowData"),l!=null&&!Array.isArray(l)&&(l=null,ue(1))),a&&(r||(l=s?.extractRowData()??l),s!==o&&(s?.deactivate(),this.nodeManager=o),o.activate(this.rootNode)),l&&(!a&&!this.isEmpty()&&l.length>0&&t.exists("getRowId")&&!t.get("resetRowDataOnUpdate")?(i.keepRenderedRows=!0,i.animate=!this.gos.get("suppressAnimationFrame"),i.changedRowNodes=new GD,o.setImmutableRowData(i,l)):(i.rowDataUpdated=!0,i.newData=!0,this.beans.selectionSvc?.reset("rowDataChanged"),this.rowNodesCountReady=!0,o.setNewRowData(l))),i.rowDataUpdated)i.step="group";else if(i.step==="nothing"){for(const{refreshProps:u,step:c}of this.orderedStages)if(e.some(d=>u.has(d))){i.step=c;break}}i.step!=="nothing"&&this.refreshModel(i)}setRowTopAndRowIndex(){const{beans:e}=this,t=e.environment.getDefaultRowHeight();let n=0;const i=new Set,r=gi(this.gos,"normal"),s=this.rowsToDisplay;for(let o=0,a=s.length;o<a;++o){const l=s[o];if(l.id!=null&&i.add(l.id),l.rowHeight==null){const u=Sp(e,l,r,t);l.setRowHeight(u.height,u.estimated)}l.setRowTop(n),l.setRowIndex(o),n+=l.rowHeight}return i}clearRowTopAndRowIndex(e,t){const n=e.active,i=s=>{s&&s.id!=null&&!t.has(s.id)&&s.clearRowTopAndRowIndex()},r=s=>{if(s!==null&&(i(s),i(s.detailNode),i(s.sibling),s.hasChildren()&&s.childrenAfterGroup)){const o=s.level==-1;n&&!o&&!s.expanded||s.childrenAfterGroup.forEach(r)}};r(this.rootNode)}ensureRowsAtPixel(e,t,n=0){const i=this.getRowIndexAtPixel(t),r=this.getRow(i),s=!this.gos.get("suppressAnimationFrame");if(r===e[0])return!1;const o=this.rootNode?.allLeafChildren;return o?(e.forEach(a=>{Ao(o,a)}),e.forEach((a,l)=>{o.splice(Math.max(i+n,0)+l,0,a)}),e.forEach((a,l)=>{a.sourceRowIndex=l}),this.refreshModel({step:"group",keepRenderedRows:!0,animate:s,rowNodesOrderChanged:!0}),!0):!1}highlightRowAtPixel(e,t){const n=t!=null?this.getRowIndexAtPixel(t):null,i=n!=null?this.getRow(n):null;if(!i||!e||t==null){this.clearHighlightedRow();return}const r=this.getHighlightPosition(t,i),s=this.isHighlightingCurrentPosition(e,i,r),o=this.lastHighlightedRow!=null&&this.lastHighlightedRow!==i;(s||o)&&(this.clearHighlightedRow(),s)||(this.setRowNodeHighlighted(i,r),this.lastHighlightedRow=i)}setRowNodeHighlighted(e,t){e.highlighted!==t&&(e.highlighted=t,e.dispatchRowEvent("rowHighlightChanged"))}getHighlightPosition(e,t){if(!t){const r=this.getRowIndexAtPixel(e);if(t=this.getRow(r||0),!t)return"Below"}const{rowTop:n,rowHeight:i}=t;return e-n<i/2?"Above":"Below"}getLastHighlightedRowNode(){return this.lastHighlightedRow}isHighlightingCurrentPosition(e,t,n){if(e===t)return!0;const i=n==="Above"?-1:1;return this.getRow(t.rowIndex+i)===e}clearHighlightedRow(){this.lastHighlightedRow&&(this.setRowNodeHighlighted(this.lastHighlightedRow,null),this.lastHighlightedRow=null)}isLastRowIndexKnown(){return!0}getRowCount(){return this.rowsToDisplay?this.rowsToDisplay.length:0}getTopLevelRowCount(){const e=this.rootNode;if(!e||this.rowsToDisplay.length===0)return 0;if(this.rowsToDisplay&&this.rowsToDisplay[0]===e)return 1;const n=e.childrenAfterAggFilter,i=e.sibling?1:0;return(n?n.length:0)+i}getTopLevelRowDisplayedIndex(e){const{rootNode:t,rowsToDisplay:n}=this;if(!t||!n.length||n[0]===t)return e;const{childrenAfterSort:r}=t,s=a=>{let l=r[a];if(this.gos.get("groupHideOpenParents"))for(;l.expanded&&l.childrenAfterSort&&l.childrenAfterSort.length>0;)l=l.childrenAfterSort[0];return l.rowIndex},{footerSvc:o}=this.beans;return o?o.getTopDisplayIndex(n,e,r,s):s(e)}getTopLevelIndexFromDisplayedIndex(e){const{rootNode:t,rowsToDisplay:n}=this;if(!t||!n.length||n[0]===t)return e;let r=this.getRow(e);for(r.footer&&(r=r.sibling);r.parent&&r.parent!==t;)r=r.parent;const s=t.childrenAfterSort?.findIndex(o=>o===r);return s===-1?e:s??e}getRowBounds(e){const t=this.rowsToDisplay[e];return t?{rowTop:t.rowTop,rowHeight:t.rowHeight}:null}onRowGroupOpened(){const e=Mf(this.gos);this.refreshModel({step:"map",keepRenderedRows:!0,animate:e})}onFilterChanged(e){if(e.afterDataChange)return;const t=Mf(this.gos),i=e.columns.length===0||e.columns.some(r=>r.isPrimary())?"filter":"filter_aggregates";this.refreshModel({step:i,keepRenderedRows:!0,animate:t})}onSortChanged(){const e=Mf(this.gos);this.refreshModel({step:"sort",keepRenderedRows:!0,animate:e})}getType(){return"clientSide"}onValueChanged(){this.refreshModel({step:this.colModel.isPivotActive()?"pivot":"aggregate"})}createChangePath(e){const t=new o1(!1,this.rootNode);return e||(t.active=!1),t}isSuppressModelUpdateAfterUpdateTransaction(e){if(!this.gos.get("suppressModelUpdateAfterUpdateTransaction"))return!1;const{changedRowNodes:t,newData:n,rowDataUpdated:i}=e;return!(!t||n||!i||t.removals.size||t.adds.size)}refreshModel(e){if(!this.rootNode)return;const t=e.changedPath??(e.changedPath=this.createChangePath(!e.newData&&!!e.rowDataUpdated));if(this.nodeManager.refreshModel?.(e,this.started),this.eventSvc.dispatchEvent({type:"beforeRefreshModel",params:e}),!this.started||(e.rowDataUpdated&&this.eventSvc.dispatchEvent({type:"rowDataUpdated"}),this.isRefreshingModel||this.colModel.changeEventsDispatching||this.isSuppressModelUpdateAfterUpdateTransaction(e)))return;switch(this.isRefreshingModel=!0,e.step){case"group":this.doRowGrouping(e.changedRowNodes,t,!!e.rowNodesOrderChanged,!!e.afterColumnsChanged);case"filter":this.doFilter(t);case"pivot":this.doPivot(t);case"aggregate":this.doAggregate(t);case"filter_aggregates":this.doFilterAggregates(t);case"sort":this.doSort(e.changedRowNodes,t);case"map":this.doRowsToDisplay()}const n=this.setRowTopAndRowIndex();this.clearRowTopAndRowIndex(t,n),this.isRefreshingModel=!1,this.eventSvc.dispatchEvent({type:"modelUpdated",animate:e.animate,keepRenderedRows:e.keepRenderedRows,newData:e.newData,newPage:!1,keepUndoRedoStack:e.keepUndoRedoStack})}isEmpty(){return!this.rootNode?.allLeafChildren?.length||!this.colModel?.ready}isRowsToRender(){return this.rowsToDisplay.length>0}getNodesInRangeForSelection(e,t){let n=!1,i=!1;const r=[],s=d0(this.gos);return this.forEachNodeAfterFilterAndSort(o=>{if(i)return;if(n&&(o===t||o===e)&&(i=!0,o.group&&s)){r.push(...o.allLeafChildren);return}if(!n){if(o!==t&&o!==e)return;n=!0}if(!o.group||!s){r.push(o);return}}),r}getTopLevelNodes(){return this.rootNode?.childrenAfterGroup??null}getRow(e){return this.rowsToDisplay[e]}isRowPresent(e){return this.rowsToDisplay.indexOf(e)>=0}getRowIndexAtPixel(e){const t=this.rowsToDisplay;if(this.isEmpty()||t.length===0)return-1;let n=0,i=t.length-1;if(e<=0)return 0;if(Tt(t).rowTop<=e)return t.length-1;let s=-1,o=-1;for(;;){const a=Math.floor((n+i)/2),l=t[a];if(this.isRowInPixel(l,e)||(l.rowTop<e?n=a+1:l.rowTop>e&&(i=a-1),s===n&&o===i))return a;s=n,o=i}}isRowInPixel(e,t){const n=e.rowTop,i=e.rowTop+e.rowHeight;return n<=t&&i>t}forEachLeafNode(e){this.rootNode?.allLeafChildren?.forEach((t,n)=>e(t,n))}forEachNode(e,t=!1){this.depthFirstSearchRowNodes(e,t)}forEachDisplayedNode(e){this.rowsToDisplay.forEach(e)}forEachNodeAfterFilter(e,t=!1){this.depthFirstSearchRowNodes(e,t,n=>n.childrenAfterAggFilter)}forEachNodeAfterFilterAndSort(e,t=!1){this.depthFirstSearchRowNodes(e,t,n=>n.childrenAfterSort)}forEachPivotNode(e,t=!1,n=!1){const i=n?"childrenAfterSort":"childrenAfterGroup";this.depthFirstSearchRowNodes(e,t,r=>r.leafGroup?null:r[i])}depthFirstSearchRowNodes(e,t=!1,n=s=>s.childrenAfterGroup,i=this.rootNode,r=0){let s=r;if(!i)return s;const o=i===this.rootNode;o||e(i,s++);const{footerSvc:a}=this.beans;if(i.hasChildren()&&!i.footer){const l=n(i);if(l){s=a?.addTotalRows(s,i,e,t,o,"top")??s;for(const u of l)s=this.depthFirstSearchRowNodes(e,t,n,u,s);return a?.addTotalRows(s,i,e,t,o,"bottom")??s}}return s}doAggregate(e){const t=this.rootNode;t&&this.aggStage?.execute({rowNode:t,changedPath:e})}doFilterAggregates(e){const t=this.rootNode;this.filterAggStage?this.filterAggStage.execute({rowNode:t,changedPath:e}):t.childrenAfterAggFilter=t.childrenAfterFilter}doSort(e,t){this.sortStage?this.sortStage.execute({rowNode:this.rootNode,changedRowNodes:e,changedPath:t}):t.forEachChangedNodeDepthFirst(n=>{n.childrenAfterSort=n.childrenAfterAggFilter.slice(0),Yie(n)})}doRowGrouping(e,t,n,i){const r=this.rootNode;if(!this.groupStage?.execute({rowNode:r,changedPath:t,changedRowNodes:e,rowNodesOrderChanged:n,afterColumnsChanged:i})&&!this.nodeManager.treeData){const o=r.sibling;r.childrenAfterGroup=r.allLeafChildren,o&&(o.childrenAfterGroup=r.childrenAfterGroup),r.updateHasChildren()}this.rowNodesCountReady&&(this.rowCountReady=!0,this.eventSvc.dispatchEventOnce({type:"rowCountReady"}))}doFilter(e){this.filterStage?this.filterStage.execute({rowNode:this.rootNode,changedPath:e}):e.forEachChangedNodeDepthFirst(t=>{t.childrenAfterFilter=t.childrenAfterGroup,Die(t)},!0)}doPivot(e){this.pivotStage?.execute({rowNode:this.rootNode,changedPath:e})}getRowNode(e){if(typeof e=="string"&&e.indexOf(_T)==0){let n;return this.forEachNode(i=>{i.id===e&&(n=i)}),n}return this.nodeManager.getRowNode(e)}batchUpdateRowData(e,t){if(this.applyAsyncTransactionsTimeout==null){this.rowDataTransactionBatch=[];const n=this.gos.get("asyncTransactionWaitMillis");this.applyAsyncTransactionsTimeout=window.setTimeout(()=>{this.isAlive()&&this.executeBatchUpdateRowData()},n)}this.rowDataTransactionBatch.push({rowDataTransaction:e,callback:t})}flushAsyncTransactions(){this.applyAsyncTransactionsTimeout!=null&&(clearTimeout(this.applyAsyncTransactionsTimeout),this.executeBatchUpdateRowData())}executeBatchUpdateRowData(){this.valueCache?.onDataChanged();const e=[],t=[],n=new GD;let i=!1;this.rowDataTransactionBatch?.forEach(r=>{this.rowNodesCountReady=!0;const{rowNodeTransaction:s,rowsInserted:o}=this.nodeManager.updateRowData(r.rowDataTransaction,n);o&&(i=!0),t.push(s),r.callback&&e.push(r.callback.bind(null,s))}),this.commitTransactions(i,n),e.length>0&&window.setTimeout(()=>{e.forEach(r=>r())},0),t.length>0&&this.eventSvc.dispatchEvent({type:"asyncTransactionsFlushed",results:t}),this.rowDataTransactionBatch=null,this.applyAsyncTransactionsTimeout=void 0}updateRowData(e){this.valueCache?.onDataChanged(),this.rowNodesCountReady=!0;const t=new GD,{rowNodeTransaction:n,rowsInserted:i}=this.nodeManager.updateRowData(e,t);return this.commitTransactions(i,t),n}commitTransactions(e,t){this.refreshModel({step:"group",rowDataUpdated:!0,rowNodesOrderChanged:e,keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame"),changedRowNodes:t,changedPath:this.createChangePath(!0)})}doRowsToDisplay(){const{flattenStage:e,rootNode:t}=this;let n;if(e)n=e.execute({rowNode:t});else{n=t?.childrenAfterSort??[];for(const i of n)i.setUiLevel(0)}this.rowsToDisplay=n}onRowHeightChanged(){this.refreshModel({step:"map",keepRenderedRows:!0,keepUndoRedoStack:!0})}resetRowHeights(){const e=this.rootNode;if(!e)return;const t=this.resetRowHeightsForAllRowNodes();e.setRowHeight(e.rowHeight,!0),e.sibling&&e.sibling.setRowHeight(e.sibling.rowHeight,!0),t&&this.onRowHeightChanged()}resetRowHeightsForAllRowNodes(){let e=!1;return this.forEachNode(t=>{t.setRowHeight(t.rowHeight,!0);const n=t.detailNode;n&&n.setRowHeight(n.rowHeight,!0),t.sibling&&t.sibling.setRowHeight(t.sibling.rowHeight,!0),e=!0}),e}onGridStylesChanges(e){if(e.rowHeightChanged){if(this.beans.rowAutoHeight?.active)return;this.resetRowHeights()}}onGridReady(){this.started||this.setInitialData()}isRowDataLoaded(){return this.rowCountReady}destroy(){super.destroy(),this.clearHighlightedRow(),this.started=!1,this.rootNode=null,this.nodeManager=null,this.rowDataTransactionBatch=null,this.lastHighlightedRow=null,this.orderedStages=Q6,this.rowsToDisplay=Q6}onRowHeightChangedDebounced(){this.onRowHeightChanged_debounced()}};function $nt(e){e.expansionSvc?.onGroupExpandedOrCollapsed()}function Bnt(e,t){const n=Ga(e);n&&((!t||t==="everything")&&(t="group"),n.refreshModel({step:t,keepRenderedRows:!0,animate:!e.gos.get("suppressAnimationFrame")}))}function Gnt(e){return Ga(e)?.isEmpty()??!0}function znt(e,t){Ga(e)?.forEachLeafNode(t)}function Hnt(e,t){Ga(e)?.forEachNodeAfterFilter(t)}function Vnt(e,t){Ga(e)?.forEachNodeAfterFilterAndSort(t)}function Wnt(e){if(e.rowAutoHeight?.active){ue(3);return}Ga(e)?.resetRowHeights()}function Unt(e,t){return e.frameworkOverrides.wrapIncoming(()=>Ga(e)?.updateRowData(t))}function jnt(e,t,n){e.frameworkOverrides.wrapIncoming(()=>Ga(e)?.batchUpdateRowData(t,n))}function qnt(e){e.frameworkOverrides.wrapIncoming(()=>Ga(e)?.flushAsyncTransactions())}function Knt(e){return e.selectionSvc?.getBestCostNodeSelection()}var Ynt={moduleName:"ClientSideRowModel",version:Ce,rowModels:["clientSide"],beans:[Mnt,Nnt,_nt],dependsOn:[wie]},Xnt={moduleName:"ClientSideRowModelApi",version:Ce,apiFunctions:{onGroupExpandedOrCollapsed:$nt,refreshClientSideRowModel:Bnt,isRowDataEmpty:Gnt,forEachLeafNode:znt,forEachNodeAfterFilter:Hnt,forEachNodeAfterFilterAndSort:Vnt,resetRowHeights:Wnt,applyTransaction:Unt,applyTransactionAsync:jnt,flushAsyncTransactions:qnt,getBestCostNodeSelection:Knt},dependsOn:[Dnt]},Qnt=class extends X{constructor(){super(...arguments),this.beanName="gridSerializer"}wireBeans(e){this.visibleCols=e.visibleCols,this.colModel=e.colModel,this.rowModel=e.rowModel,this.pinnedRowModel=e.pinnedRowModel}serialize(e,t={}){const{allColumns:n,columnKeys:i,skipRowGroups:r,exportRowNumbers:s}=t,o=this.getColumnsToExport({allColumns:n,skipRowGroups:r,columnKeys:i,exportRowNumbers:s});return[this.prepareSession(o),this.prependContent(t),this.exportColumnGroups(t,o),this.exportHeaders(t,o),this.processPinnedTopRows(t,o),this.processRows(t,o),this.processPinnedBottomRows(t,o),this.appendContent(t)].reduce((a,l)=>l(a),e).parse()}processRow(e,t,n,i){const r=t.shouldRowBeSkipped||(()=>!1),o=t.rowPositions!=null||!!t.onlySelected,a=this.gos.get("groupHideOpenParents")&&!o,l=this.colModel.isPivotMode()?i.leafGroup:!i.group,u=!!i.footer,c=i.allChildrenCount===1&&i.childrenAfterGroup?.length===1&&O9e(this.gos,i);if(!l&&!u&&(t.skipRowGroups||c||a)||t.onlySelected&&!i.isSelected()||t.skipPinnedTop&&i.rowPinned==="top"||t.skipPinnedBottom&&i.rowPinned==="bottom"||i.level===-1&&!l&&!u||r(Ne(this.gos,{node:i})))return;const p=e.onNewBodyRow(i);if(n.forEach((g,v)=>{p.onColumn(g,v,i)}),t.getCustomContentBelowRow){const g=t.getCustomContentBelowRow(Ne(this.gos,{node:i}));g&&e.addCustomContent(g)}}appendContent(e){return t=>{const n=e.appendContent;return n&&t.addCustomContent(n),t}}prependContent(e){return t=>{const n=e.prependContent;return n&&t.addCustomContent(n),t}}prepareSession(e){return t=>(t.prepare(e),t)}exportColumnGroups(e,t){return n=>{if(!e.skipColumnGroupHeaders){const i=new fne,{colGroupSvc:r}=this.beans,s=r?r.createColumnGroups({columns:t,idCreator:i,pinned:null,isStandaloneStructure:!0}):t;this.recursivelyAddHeaderGroups(s,n,e.processGroupHeaderCallback)}return n}}exportHeaders(e,t){return n=>{if(!e.skipColumnHeaders){const i=n.onNewHeaderRow();t.forEach((r,s)=>{i.onColumn(r,s,void 0)})}return n}}processPinnedTopRows(e,t){return n=>{const i=this.processRow.bind(this,n,e,t);return e.rowPositions?e.rowPositions.filter(r=>r.rowPinned==="top").sort((r,s)=>r.rowIndex-s.rowIndex).map(r=>this.pinnedRowModel?.getPinnedTopRow(r.rowIndex)).forEach(i):this.pinnedRowModel?.forEachPinnedRow("top",i),n}}processRows(e,t){return n=>{const i=this.rowModel,r=Xi(this.gos),s=mg(this.gos),o=!r&&e.onlySelected,a=this.processRow.bind(this,n,e,t),{exportedRows:l="filteredAndSorted"}=e;if(e.rowPositions)return e.rowPositions.filter(u=>u.rowPinned==null).sort((u,c)=>u.rowIndex-c.rowIndex).map(u=>i.getRow(u.rowIndex)).forEach(a),n;if(this.colModel.isPivotMode())return r?i.forEachPivotNode(a,!0,l==="filteredAndSorted"):s?i.forEachNodeAfterFilterAndSort(a,!0):i.forEachNode(a),n;if(e.onlySelectedAllPages||o){const u=this.beans.selectionSvc?.getSelectedNodes()??[];this.replicateSortedOrder(u),u.forEach(a)}else l==="all"?i.forEachNode(a):r||s?i.forEachNodeAfterFilterAndSort(a,!0):i.forEachNode(a);return n}}replicateSortedOrder(e){const{sortSvc:t,rowNodeSorter:n}=this.beans;if(!t||!n)return;const i=t.getSortOptions(),r=(s,o)=>s.rowIndex!=null&&o.rowIndex!=null?s.rowIndex-o.rowIndex:s.level===o.level?s.parent?.id===o.parent?.id?n.compareRowNodes(i,{rowNode:s,currentPos:s.rowIndex??-1},{rowNode:o,currentPos:o.rowIndex??-1}):r(s.parent,o.parent):s.level>o.level?r(s.parent,o):r(s,o.parent);e.sort(r)}processPinnedBottomRows(e,t){return n=>{const i=this.processRow.bind(this,n,e,t);return e.rowPositions?e.rowPositions.filter(r=>r.rowPinned==="bottom").sort((r,s)=>r.rowIndex-s.rowIndex).map(r=>this.pinnedRowModel?.getPinnedBottomRow(r.rowIndex)).forEach(i):this.pinnedRowModel?.forEachPinnedRow("bottom",i),n}}getColumnsToExport(e){const{allColumns:t=!1,skipRowGroups:n=!1,exportRowNumbers:i=!1,columnKeys:r}=e,{colModel:s,gos:o,visibleCols:a}=this,l=s.isPivotMode(),u=h=>zl(h)?!1:!Ep(h)||i;if(r&&r.length)return s.getColsForKeys(r).filter(u);const c=o.get("treeData");let d=[];return t&&!l?d=s.getCols():d=a.allCols,d=d.filter(h=>u(h)&&(n&&!c?!vN(h):!0)),d}recursivelyAddHeaderGroups(e,t,n){const i=[];e.forEach(r=>{const s=r;s.getChildren&&s.getChildren().forEach(o=>i.push(o))}),e.length>0&&on(e[0])&&this.doAddHeaderHeader(t,e,n),i&&i.length>0&&this.recursivelyAddHeaderGroups(i,t,n)}doAddHeaderHeader(e,t,n){const i=e.onNewHeaderGroupingRow();let r=0;t.forEach(s=>{const o=s;let a;n?a=n(Ne(this.gos,{columnGroup:o})):a=this.beans.colNames.getDisplayNameForColumnGroup(o,"header");const l=o.getLeafColumns().reduce((u,c,d,h)=>{let p=Tt(u);return c.getColumnGroupShow()==="open"?(!p||p[1]!=null)&&(p=[d],u.push(p)):p&&p[1]==null&&(p[1]=d-1),d===h.length-1&&p&&p[1]==null&&(p[1]=d),u},[]);i.onColumn(o,a||"",r++,o.getLeafColumns().length-1,l)})}},Jnt={moduleName:"SharedExport",version:Ce,beans:[Qnt]},OW=`\r
`,Znt=class extends GZe{constructor(e){super(e),this.isFirstLine=!0,this.result="";const{suppressQuotes:t,columnSeparator:n}=e;this.suppressQuotes=t,this.columnSeparator=n}addCustomContent(e){e&&(typeof e=="string"?(/^\s*\n/.test(e)||this.beginNewLine(),e=e.replace(/\r?\n/g,OW),this.result+=e):e.forEach(t=>{this.beginNewLine(),t.forEach((n,i)=>{i!==0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(n.data.value||""),n.mergeAcross&&this.appendEmptyCells(n.mergeAcross)})}))}onNewHeaderGroupingRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}}onNewHeaderGroupingRowColumn(e,t,n,i){n!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(t),this.appendEmptyCells(i)}appendEmptyCells(e){for(let t=1;t<=e;t++)this.result+=this.columnSeparator+this.putInQuotes("")}onNewHeaderRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}}onNewHeaderRowColumn(e,t){t!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(e))}onNewBodyRow(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}}onNewBodyRowColumn(e,t,n){t!=0&&(this.result+=this.columnSeparator);const i=this.extractRowCellValue(e,t,t,"csv",n);this.result+=this.putInQuotes(i.valueFormatted??i.value)}putInQuotes(e){if(this.suppressQuotes)return e;if(e==null)return'""';let t;return typeof e=="string"?t=e:typeof e.toString=="function"?t=e.toString():(ue(53),t=""),'"'+t.replace(/"/g,'""')+'"'}parse(){return this.result}beginNewLine(){this.isFirstLine||(this.result+=OW),this.isFirstLine=!1}},eit=class extends BZe{constructor(){super(...arguments),this.beanName="csvCreator"}wireBeans(e){this.colModel=e.colModel,this.colNames=e.colNames,this.rowGroupColsSvc=e.rowGroupColsSvc,this.valueSvc=e.valueSvc}getMergedParams(e){const t=this.gos.get("defaultCsvExportParams");return Object.assign({},t,e)}export(e){if(this.isExportSuppressed()){ue(51);return}const t=this.getMergedParams(e),n=this.getData(t),i=new Blob(["\uFEFF",n],{type:"text/plain"}),r=typeof t.fileName=="function"?t.fileName(Ne(this.gos,{})):t.fileName;zZe(this.getFileName(r),i)}exportDataAsCsv(e){this.export(e)}getDataAsCsv(e,t=!1){const n=t?Object.assign({},e):this.getMergedParams(e);return this.getData(n)}getDefaultFileExtension(){return"csv"}createSerializingSession(e){const{colModel:t,colNames:n,rowGroupColsSvc:i,valueSvc:r,gos:s}=this,{processCellCallback:o,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:u,suppressQuotes:c,columnSeparator:d}=e;return new Znt({colModel:t,colNames:n,valueSvc:r,gos:s,processCellCallback:o||void 0,processHeaderCallback:a||void 0,processGroupHeaderCallback:l||void 0,processRowGroupCallback:u||void 0,suppressQuotes:c||!1,columnSeparator:d||",",rowGroupColsSvc:i})}isExportSuppressed(){return this.gos.get("suppressCsvExport")}};function tit(e,t){return e.csvCreator?.getDataAsCsv(t)}function nit(e,t){e.csvCreator?.exportDataAsCsv(t)}var iit={moduleName:"CsvExport",version:Ce,beans:[eit],apiFunctions:{getDataAsCsv:tit,exportDataAsCsv:nit},dependsOn:[Jnt]},rit=class extends X{constructor(e,t,n){super(),this.id=e,this.parentCache=t,this.params=n,this.state="needsLoading",this.version=0,this.startRow=e*n.blockSize,this.endRow=this.startRow+n.blockSize}load(){this.state="loading",this.loadFromDatasource()}setStateWaitingToLoad(){this.version++,this.state="needsLoading"}pageLoadFailed(e){this.isRequestMostRecentAndLive(e)&&(this.state="failed"),this.dispatchLocalEvent({type:"loadComplete"})}pageLoaded(e,t,n){this.successCommon(e,{rowData:t,rowCount:n})}isRequestMostRecentAndLive(e){const t=e===this.version,n=this.isAlive();return t&&n}successCommon(e,t){this.dispatchLocalEvent({type:"loadComplete"}),this.isRequestMostRecentAndLive(e)&&(this.state="loaded",this.processServerResult(t))}postConstruct(){this.rowNodes=[];const{params:{blockSize:e,rowHeight:t},startRow:n,beans:i,rowNodes:r}=this;for(let s=0;s<e;s++){const o=n+s,a=new Dp(i);a.setRowHeight(t),a.uiLevel=0,a.setRowIndex(o),a.setRowTop(t*o),r.push(a)}}getBlockStateJson(){const{id:e,startRow:t,endRow:n,state:i}=this;return{id:""+e,state:{blockNumber:e,startRow:t,endRow:n,pageStatus:i}}}setDataAndId(e,t,n){me(t)?e.setDataAndId(t,n.toString()):e.setDataAndId(void 0,void 0)}loadFromDatasource(){const e=this.createLoadParams();if(Wt(this.params.datasource.getRows)){ue(90);return}window.setTimeout(()=>{this.params.datasource.getRows(e)},0)}createLoadParams(){const{startRow:e,endRow:t,version:n,params:{sortModel:i,filterModel:r},gos:s}=this;return{startRow:e,endRow:t,successCallback:this.pageLoaded.bind(this,n),failCallback:this.pageLoadFailed.bind(this,n),sortModel:i,filterModel:r,context:Ne(s,{}).context}}forEachNode(e,t,n){this.rowNodes.forEach((i,r)=>{this.startRow+r<n&&e(i,t.value++)})}getRow(e,t=!1){t||(this.lastAccessed=this.params.lastAccessedSequence.value++);const n=e-this.startRow;return this.rowNodes[n]}processServerResult(e){const{rowNodes:t,beans:n}=this;t.forEach((r,s)=>{const o=e.rowData?e.rowData[s]:void 0;!r.id&&r.alreadyRendered&&o&&(t[s]=new Dp(n),t[s].setRowIndex(r.rowIndex),t[s].setRowTop(r.rowTop),t[s].setRowHeight(r.rowHeight),r.clearRowTopAndRowIndex()),this.setDataAndId(t[s],o,this.startRow+s)});const i=e.rowCount!=null&&e.rowCount>=0?e.rowCount:void 0;this.parentCache.pageLoaded(this,i)}destroy(){this.rowNodes.forEach(e=>{e.clearRowTopAndRowIndex()}),super.destroy()}},sit=2,oit=class extends X{constructor(e){super(),this.params=e,this.lastRowIndexKnown=!1,this.blocks={},this.blockCount=0,this.rowCount=e.initialRowCount}getRow(e,t=!1){const n=Math.floor(e/this.params.blockSize);let i=this.blocks[n];if(!i){if(t)return;i=this.createBlock(n)}return i.getRow(e)}createBlock(e){const t=this.params,n=this.createBean(new rit(e,this,t));return this.blocks[n.id]=n,this.blockCount++,this.purgeBlocksIfNeeded(n),t.rowNodeBlockLoader.addBlock(n),n}refreshCache(){if(this.blockCount==0){this.purgeCache();return}this.getBlocksInOrder().forEach(t=>t.setStateWaitingToLoad()),this.params.rowNodeBlockLoader.checkBlockToLoad()}destroy(){this.getBlocksInOrder().forEach(e=>this.destroyBlock(e)),super.destroy()}getRowCount(){return this.rowCount}isLastRowIndexKnown(){return this.lastRowIndexKnown}pageLoaded(e,t){this.isAlive()&&(ac(this.gos,`InfiniteCache - onPageLoaded: page = ${e.id}, lastRow = ${t}`),this.checkRowCount(e,t),this.onCacheUpdated())}purgeBlocksIfNeeded(e){const t=this.getBlocksInOrder().filter(o=>o!=e),n=(o,a)=>a.lastAccessed-o.lastAccessed;t.sort(n);const i=this.params.maxBlocksInCache>0,r=i?this.params.maxBlocksInCache-1:null,s=sit-1;t.forEach((o,a)=>{const l=o.state==="needsLoading"&&a>=s,u=i?a>=r:!1;if(l||u){if(this.isBlockCurrentlyDisplayed(o)||this.isBlockFocused(o))return;this.removeBlockFromCache(o)}})}isBlockFocused(e){const t=this.beans.focusSvc.getFocusCellToUseAfterRefresh();if(!t||t.rowPinned!=null)return!1;const{startRow:n,endRow:i}=e;return t.rowIndex>=n&&t.rowIndex<i}isBlockCurrentlyDisplayed(e){const{startRow:t,endRow:n}=e;return this.beans.rowRenderer.isRangeInRenderedViewport(t,n-1)}removeBlockFromCache(e){e&&this.destroyBlock(e)}checkRowCount(e,t){if(typeof t=="number"&&t>=0)this.rowCount=t,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){const{blockSize:n,overflowSize:i}=this.params,s=(e.id+1)*n+i;this.rowCount<s&&(this.rowCount=s)}}setRowCount(e,t){this.rowCount=e,me(t)&&(this.lastRowIndexKnown=t),this.lastRowIndexKnown||this.rowCount%this.params.blockSize===0&&this.rowCount++,this.onCacheUpdated()}forEachNodeDeep(e){const t={value:0};this.getBlocksInOrder().forEach(n=>n.forEachNode(e,t,this.rowCount))}getBlocksInOrder(){const e=(n,i)=>n.id-i.id;return Object.values(this.blocks).sort(e)}destroyBlock(e){delete this.blocks[e.id],this.destroyBean(e),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(e)}onCacheUpdated(){this.isAlive()&&(this.destroyAllBlocksPastVirtualRowCount(),this.eventSvc.dispatchEvent({type:"storeUpdated"}))}destroyAllBlocksPastVirtualRowCount(){const e=[];this.getBlocksInOrder().forEach(t=>{t.id*this.params.blockSize>=this.rowCount&&e.push(t)}),e.length>0&&e.forEach(t=>this.destroyBlock(t))}purgeCache(){this.getBlocksInOrder().forEach(e=>this.removeBlockFromCache(e)),this.lastRowIndexKnown=!1,this.rowCount===0&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()}getRowNodesInRange(e,t){const n=[];let i=-1,r=!1;const s={value:0};let o=!1;return this.getBlocksInOrder().forEach(l=>{if(!o){if(r&&i+1!==l.id){o=!0;return}i=l.id,l.forEachNode(u=>{const c=u===e||u===t;(r||c)&&n.push(u),c&&(r=!r)},s,this.rowCount)}}),o||r?[]:n}},ait=class extends X{constructor(){super(...arguments),this.beanName="rowModel"}getRowBounds(e){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*e}}ensureRowHeightsValid(){return!1}postConstruct(){this.gos.get("rowModelType")==="infinite"&&(this.rowHeight=Fd(this.beans),this.addEventListeners(),this.addDestroyFunc(()=>this.destroyCache()))}start(){this.setDatasource(this.gos.get("datasource"))}destroy(){this.destroyDatasource(),super.destroy()}destroyDatasource(){this.datasource&&(this.destroyBean(this.datasource),this.beans.rowRenderer.datasourceChanged(),this.datasource=null)}addEventListeners(){this.addManagedEventListeners({filterChanged:this.reset.bind(this),sortChanged:this.reset.bind(this),newColumnsLoaded:this.onColumnEverything.bind(this),storeUpdated:this.dispatchModelUpdatedEvent.bind(this)}),this.addManagedPropertyListener("datasource",()=>this.setDatasource(this.gos.get("datasource"))),this.addManagedPropertyListener("cacheBlockSize",()=>this.resetCache()),this.addManagedPropertyListener("rowHeight",()=>{this.rowHeight=Fd(this.beans),this.cacheParams.rowHeight=this.rowHeight,this.updateRowHeights()})}onColumnEverything(){let e;this.cacheParams?e=!l0(this.cacheParams.sortModel,this.beans.sortSvc?.getSortModel()??[]):e=!0,e&&this.reset()}getType(){return"infinite"}setDatasource(e){this.destroyDatasource(),this.datasource=e,e&&this.reset()}isEmpty(){return!this.infiniteCache}isRowsToRender(){return!!this.infiniteCache}getNodesInRangeForSelection(e,t){return this.infiniteCache?.getRowNodesInRange(e,t)??[]}reset(){if(!this.datasource)return;xp(this.gos)!=null||this.beans.selectionSvc?.reset("rowDataChanged"),this.resetCache()}dispatchModelUpdatedEvent(){this.eventSvc.dispatchEvent({type:"modelUpdated",newPage:!1,newPageSize:!1,newData:!1,keepRenderedRows:!0,animate:!1})}resetCache(){this.destroyCache();const e=this.beans,{filterManager:t,sortSvc:n,rowNodeBlockLoader:i,eventSvc:r,gos:s}=e;this.cacheParams={datasource:this.datasource,filterModel:t?.getFilterModel()??{},sortModel:n?.getSortModel()??[],rowNodeBlockLoader:i,initialRowCount:s.get("infiniteInitialRowCount"),maxBlocksInCache:s.get("maxBlocksInCache"),rowHeight:Fd(e),overflowSize:s.get("cacheOverflowSize"),blockSize:s.get("cacheBlockSize"),lastAccessedSequence:{value:0}},this.infiniteCache=this.createBean(new oit(this.cacheParams)),r.dispatchEventOnce({type:"rowCountReady"}),this.dispatchModelUpdatedEvent()}updateRowHeights(){this.forEachNode(e=>{e.setRowHeight(this.rowHeight),e.setRowTop(this.rowHeight*e.rowIndex)}),this.dispatchModelUpdatedEvent()}destroyCache(){this.infiniteCache=this.destroyBean(this.infiniteCache)}getRow(e){const t=this.infiniteCache;if(t&&!(e>=t.getRowCount()))return t.getRow(e)}getRowNode(e){let t;return this.forEachNode(n=>{n.id===e&&(t=n)}),t}forEachNode(e){this.infiniteCache?.forEachNodeDeep(e)}getTopLevelRowCount(){return this.getRowCount()}getTopLevelRowDisplayedIndex(e){return e}getRowIndexAtPixel(e){if(this.rowHeight!==0){const t=Math.floor(e/this.rowHeight),n=this.getRowCount()-1;return t>n?n:t}return 0}getRowCount(){return this.infiniteCache?this.infiniteCache.getRowCount():0}isRowPresent(e){return!!this.getRowNode(e.id)}refreshCache(){this.infiniteCache?.refreshCache()}purgeCache(){this.infiniteCache?.purgeCache()}isLastRowIndexKnown(){return this.infiniteCache?.isLastRowIndexKnown()??!1}setRowCount(e,t){this.infiniteCache?.setRowCount(e,t)}};function lit(e){NR(e)?.refreshCache()}function uit(e){NR(e)?.purgeCache()}function cit(e){return NR(e)?.getRowCount()}var dit=class extends X{constructor(){super(...arguments),this.beanName="rowNodeBlockLoader",this.activeBlockLoadsCount=0,this.blocks=[],this.active=!0}postConstruct(){this.maxConcurrentRequests=L9e(this.gos);const e=this.gos.get("blockLoadDebounceMillis");e&&e>0&&(this.checkBlockToLoadDebounce=hi(this,this.performCheckBlocksToLoad.bind(this),e))}addBlock(e){this.blocks.push(e),e.addEventListener("loadComplete",this.loadComplete.bind(this)),this.checkBlockToLoad()}removeBlock(e){Ao(this.blocks,e)}destroy(){super.destroy(),this.active=!1}loadComplete(){this.activeBlockLoadsCount--,this.checkBlockToLoad()}checkBlockToLoad(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()}performCheckBlocksToLoad(){if(!this.active)return;if(this.printCacheStatus(),this.maxConcurrentRequests!=null&&this.activeBlockLoadsCount>=this.maxConcurrentRequests){ac(this.gos,"RowNodeBlockLoader - checkBlockToLoad: max loads exceeded");return}const e=this.maxConcurrentRequests!=null?this.maxConcurrentRequests-this.activeBlockLoadsCount:1,t=this.blocks.filter(n=>n.state==="needsLoading").slice(0,e);this.activeBlockLoadsCount+=t.length,t.forEach(n=>n.load()),this.printCacheStatus()}getBlockState(){const e={};return this.blocks.forEach(t=>{const{id:n,state:i}=t.getBlockStateJson();e[n]=i}),e}printCacheStatus(){ac(this.gos,`RowNodeBlockLoader - printCacheStatus: activePageLoadsCount = ${this.activeBlockLoadsCount}, blocks = ${JSON.stringify(this.getBlockState())}`)}},hit={moduleName:"InfiniteRowModelCore",version:Ce,rowModels:["infinite"],beans:[ait,dit]},fit={moduleName:"InfiniteRowModel",version:Ce,apiFunctions:{refreshInfiniteCache:lit,purgeInfiniteCache:uit,getInfiniteRowCount:cit},dependsOn:[hit,Pnt]},pit="↑",git="↓",mit={tag:"span",children:[{tag:"span",ref:"eDelta",cls:"ag-value-change-delta"},{tag:"span",ref:"eValue",cls:"ag-value-change-value"}]},vit=class extends bt{constructor(){super(mit),this.eValue=ge,this.eDelta=ge,this.refreshCount=0}init(e){this.refresh(e,!0)}showDelta(e,t){const n=Math.abs(t),i=e.formatValue(n),r=me(i)?i:n,s=t>=0,o=this.eDelta;s?o.textContent=pit+r:o.textContent=git+r,o.classList.toggle("ag-value-change-delta-up",s),o.classList.toggle("ag-value-change-delta-down",!s)}setTimerToRemoveDelta(){this.refreshCount++;const e=this.refreshCount;this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.hideDeltaValue()},2e3)})}hideDeltaValue(){this.eValue.classList.remove("ag-value-change-value-highlight"),Ii(this.eDelta)}refresh(e,t=!1){const{value:n,valueFormatted:i}=e,{eValue:r,lastValue:s,beans:o}=this;if(n===s||(me(i)?r.textContent=i:me(n)?r.textContent=n:Ii(r),o.filterManager?.isSuppressFlashingCellsBecauseFiltering()))return!1;if(typeof n=="number"&&typeof s=="number"){const a=n-s;this.showDelta(e,a)}return s&&r.classList.add("ag-value-change-value-highlight"),t||this.setTimerToRemoveDelta(),this.lastValue=n,!0}},Cit=".ag-value-slide-out{opacity:1}:where(.ag-ltr) .ag-value-slide-out{margin-right:5px;transition:opacity 3s,margin-right 3s}:where(.ag-rtl) .ag-value-slide-out{margin-left:5px;transition:opacity 3s,margin-left 3s}:where(.ag-ltr,.ag-rtl) .ag-value-slide-out{transition-timing-function:linear}.ag-value-slide-out-end{opacity:0}:where(.ag-ltr) .ag-value-slide-out-end{margin-right:10px}:where(.ag-rtl) .ag-value-slide-out-end{margin-left:10px}",yit={tag:"span",children:[{tag:"span",ref:"eCurrent",cls:"ag-value-slide-current"}]},wit=class extends bt{constructor(){super(yit),this.eCurrent=ge,this.refreshCount=0,this.registerCSS(Cit)}init(e){this.refresh(e,!0)}addSlideAnimation(){this.refreshCount++;const e=this.refreshCount;this.ePrevious&&this.getGui().removeChild(this.ePrevious);const{beans:t,eCurrent:n}=this,i=Cn({tag:"span",cls:"ag-value-slide-previous ag-value-slide-out"});this.ePrevious=i,i.textContent=n.textContent,this.getGui().insertBefore(i,n),t.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.ePrevious.classList.add("ag-value-slide-out-end")},50),window.setTimeout(()=>{e===this.refreshCount&&(this.getGui().removeChild(this.ePrevious),this.ePrevious=null)},3e3)})}refresh(e,t=!1){let n=e.value;if(Wt(n)&&(n=""),n===this.lastValue||this.beans.filterManager?.isSuppressFlashingCellsBecauseFiltering())return!1;t||this.addSlideAnimation(),this.lastValue=n;const i=this.eCurrent;return me(e.valueFormatted)?i.textContent=e.valueFormatted:me(e.value)?i.textContent=n:Ii(i),!0}},bit=class extends X{constructor(){super(...arguments),this.beanName="cellFlashSvc"}onFlashCells(e,t){if(!e.comp)return;const n=Vje(e.cellPosition);t.cells[n]&&this.animateCell(e,"highlight")}flashCell(e,t){this.animateCell(e,"data-changed",t?.flashDuration,t?.fadeDuration)}animateCell(e,t,n,i){const r=e.comp;if(!r)return;const{gos:s}=this;if(n||(n=s.get("cellFlashDuration")),n===0)return;me(i)||(i=s.get("cellFadeDuration"));const o=`ag-cell-${t}`,a=`ag-cell-${t}-animation`;r.addOrRemoveCssClass(o,!0),r.addOrRemoveCssClass(a,!1);const l=e.eGui;this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e.isAlive()&&(r.addOrRemoveCssClass(o,!1),r.addOrRemoveCssClass(a,!0),l.style.transition=`background-color ${i}ms`,window.setTimeout(()=>{e.isAlive()&&(r.addOrRemoveCssClass(a,!1),l.style.transition="")},i))},n)})}};function Sit(e,t={}){const{cellFlashSvc:n}=e;n&&e.frameworkOverrides.wrapIncoming(()=>{e.rowRenderer.getCellCtrls(t.rowNodes,t.columns).forEach(i=>n.flashCell(i,t))})}var xit={moduleName:"HighlightChanges",version:Ce,beans:[bit],userComponents:{agAnimateShowChangeCellRenderer:vit,agAnimateSlideCellRenderer:wit},apiFunctions:{flashCells:Sit}};function Rit(e){return e.stateSvc?.getState()??{}}function Eit(e){switch(e={...e},e.version||(e.version="32.1.0"),e.version){case"32.1.0":e=Fit(e)}return e}function Fit(e){return e.cellSelection=Ait(e,"rangeSelection"),e}function Ait(e,t){if(e&&typeof e=="object")return e[t]}var Dit=class extends X{constructor(){super(...arguments),this.beanName="stateSvc",this.updateRowGroupExpansionStateTimer=0,this.suppressEvents=!0,this.queuedUpdateSources=new Set,this.dispatchStateUpdateEventDebounced=hi(this,()=>this.dispatchQueuedStateUpdateEvents(),0),this.onRowGroupOpenedDebounced=hi(this,()=>{this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState())},0),this.onRowSelectedDebounced=hi(this,()=>{this.staleStateKeys.delete("rowSelection"),this.updateCachedState("rowSelection",this.getRowSelectionState())},0),this.staleStateKeys=new Set}postConstruct(){this.isClientSideRowModel=Xi(this.gos),this.cachedState=this.getInitialState(),this.setCachedStateValue("version",Ce);const e=this.suppressEventsAndDispatchInitEvent.bind(this);this.beans.ctrlsSvc.whenReady(this,()=>e(()=>this.setupStateOnGridReady()));const[t,n,i]=this.addManagedEventListeners({newColumnsLoaded:({source:r})=>{r==="gridInitializing"&&(t(),e(()=>this.setupStateOnColumnsInitialised()))},rowCountReady:()=>{n?.(),e(()=>this.setupStateOnRowCountReady())},firstDataRendered:()=>{i?.(),e(()=>this.setupStateOnFirstDataRendered())}})}destroy(){super.destroy(),clearTimeout(this.updateRowGroupExpansionStateTimer),this.queuedUpdateSources.clear()}getInitialState(){return Eit(this.gos.get("initialState")??{})}getState(){return this.staleStateKeys.size&&this.refreshStaleState(),this.cachedState}setupStateOnGridReady(){const e=()=>this.updateCachedState("sideBar",this.getSideBarState());e(),this.addManagedEventListeners({toolPanelVisibleChanged:e,sideBarUpdated:e})}setupStateOnColumnsInitialised(){const e=this.getInitialState();this.setColumnState(e),this.setColumnGroupState(e),this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","pivot","rowGroup","sort"]),this.updateCachedState("columnGroup",this.getColumnGroupState());const t=n=>()=>this.updateColumnState([n]);this.addManagedEventListeners({columnValueChanged:t("aggregation"),columnMoved:t("columnOrder"),columnPinned:t("columnPinning"),columnResized:t("columnSizing"),columnVisible:t("columnVisibility"),columnPivotChanged:t("pivot"),columnPivotModeChanged:t("pivot"),columnRowGroupChanged:t("rowGroup"),sortChanged:t("sort"),newColumnsLoaded:()=>this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","rowGroup","sort"]),columnGroupOpened:()=>this.updateCachedState("columnGroup",this.getColumnGroupState())})}setupStateOnRowCountReady(){const{filter:e,rowGroupExpansion:t,rowSelection:n,pagination:i}=this.getInitialState();e&&this.setFilterState(e),t&&this.setRowGroupExpansionState(t),n&&this.setRowSelectionState(n),i&&this.setPaginationState(i);const r=this.updateCachedState.bind(this);r("filter",this.getFilterState()),r("rowGroupExpansion",this.getRowGroupExpansionState()),r("rowSelection",this.getRowSelectionState()),r("pagination",this.getPaginationState());const s=()=>{this.updateRowGroupExpansionStateTimer=0,r("rowGroupExpansion",this.getRowGroupExpansionState())};this.addManagedEventListeners({filterChanged:()=>r("filter",this.getFilterState()),rowGroupOpened:()=>this.onRowGroupOpenedDebounced(),expandOrCollapseAll:s,columnRowGroupChanged:s,rowDataUpdated:()=>{this.gos.get("groupDefaultExpanded")!==0&&(this.updateRowGroupExpansionStateTimer||(this.updateRowGroupExpansionStateTimer=setTimeout(s)))},selectionChanged:()=>{this.staleStateKeys.add("rowSelection"),this.onRowSelectedDebounced()},paginationChanged:o=>{(o.newPage||o.newPageSize)&&r("pagination",this.getPaginationState())}})}setupStateOnFirstDataRendered(){const{scroll:e,cellSelection:t,focusedCell:n,columnOrder:i}=this.getInitialState();n&&this.setFocusedCellState(n),t&&this.setCellSelectionState(t),e&&this.setScrollState(e),this.setColumnPivotState(!!i?.orderedColIds);const r=this.updateCachedState.bind(this);r("sideBar",this.getSideBarState()),r("focusedCell",this.getFocusedCellState());const s=this.getRangeSelectionState();r("rangeSelection",s),r("cellSelection",s),r("scroll",this.getScrollState()),this.addManagedEventListeners({cellFocused:()=>r("focusedCell",this.getFocusedCellState()),cellSelectionChanged:o=>{if(o.finished){const a=this.getRangeSelectionState();r("rangeSelection",a),r("cellSelection",a)}},bodyScrollEnd:()=>r("scroll",this.getScrollState())})}getColumnState(){const e=this.beans,t=e.colModel.isPivotMode(),n=[],i=[],r=[],s=[],o=[],a=[],l=[],u=[],c=[];let d=0;const h=h0(e);for(let p=0;p<h.length;p++){const{colId:g,sort:v,sortIndex:C,rowGroup:y,rowGroupIndex:b,aggFunc:S,pivot:x,pivotIndex:E,pinned:A,hide:F,width:k,flex:P}=h[p];c.push(g),v&&(n[C??d++]={colId:g,sort:v}),y&&(i[b??0]=g),typeof S=="string"&&r.push({colId:g,aggFunc:S}),x&&(s[E??0]=g),A&&(A==="right"?a:o).push(g),F&&l.push(g),(P!=null||k)&&u.push({colId:g,flex:P??void 0,width:k})}return{sort:n.length?{sortModel:n}:void 0,rowGroup:i.length?{groupColIds:i}:void 0,aggregation:r.length?{aggregationModel:r}:void 0,pivot:s.length||t?{pivotMode:t,pivotColIds:s}:void 0,columnPinning:o.length||a.length?{leftColIds:o,rightColIds:a}:void 0,columnVisibility:l.length?{hiddenColIds:l}:void 0,columnSizing:u.length?{columnSizingModel:u}:void 0,columnOrder:c.length?{orderedColIds:c}:void 0}}setColumnState(e){const{sort:t,rowGroup:n,aggregation:i,pivot:r,columnPinning:s,columnVisibility:o,columnSizing:a,columnOrder:l,partialColumnState:u}=e,c={},d=C=>{let y=c[C];return y||(y={colId:C},c[C]=y,y)},h=u?{}:{sort:null,sortIndex:null,rowGroup:null,rowGroupIndex:null,aggFunc:null,pivot:null,pivotIndex:null,pinned:null,hide:null,flex:null};t&&(t.sortModel.forEach(({colId:C,sort:y},b)=>{const S=d(C);S.sort=y,S.sortIndex=b}),h.sort=null,h.sortIndex=null),n&&(n.groupColIds.forEach((C,y)=>{const b=d(C);b.rowGroup=!0,b.rowGroupIndex=y}),h.rowGroup=null,h.rowGroupIndex=null),i&&(i.aggregationModel.forEach(({colId:C,aggFunc:y})=>{d(C).aggFunc=y}),h.aggFunc=null),r&&(r.pivotColIds.forEach((C,y)=>{const b=d(C);b.pivot=!0,b.pivotIndex=y}),this.gos.updateGridOptions({options:{pivotMode:r.pivotMode},source:"gridInitializing"}),h.pivot=null,h.pivotIndex=null),s&&(s.leftColIds.forEach(C=>{d(C).pinned="left"}),s.rightColIds.forEach(C=>{d(C).pinned="right"}),h.pinned=null),o&&(o.hiddenColIds.forEach(C=>{d(C).hide=!0}),h.hide=null),a&&(a.columnSizingModel.forEach(({colId:C,flex:y,width:b})=>{const S=d(C);S.flex=y??null,S.width=b}),h.flex=null);const p=l?.orderedColIds,g=!!p?.length,v=g?p.map(C=>d(C)):Object.values(c);v.length&&(this.columnStates=v,Jr(this.beans,{state:v,applyOrder:g,defaultState:h},"gridInitializing"))}setColumnPivotState(e){const t=this.columnStates;this.columnStates=void 0;const n=this.columnGroupStates;this.columnGroupStates=void 0;const i=this.beans,{pivotResultCols:r,colGroupSvc:s}=i;if(r?.isPivotResultColsPresent()){if(t){const o=[];for(const a of t)r.getPivotResultCol(a.colId)&&o.push(a);Jr(i,{state:o,applyOrder:e},"gridInitializing")}n&&s?.setColumnGroupState(n,"gridInitializing")}}getColumnGroupState(){const e=this.beans.colGroupSvc;if(!e)return;const t=e.getColumnGroupState(),n=[];return t.forEach(({groupId:i,open:r})=>{r&&n.push(i)}),n.length?{openColumnGroupIds:n}:void 0}setColumnGroupState(e){const t=this.beans.colGroupSvc;if(!Object.prototype.hasOwnProperty.call(e,"columnGroup")||!t)return;const n=new Set(e.columnGroup?.openColumnGroupIds),r=t.getColumnGroupState().map(({groupId:s})=>{const o=n.has(s);return o&&n.delete(s),{groupId:s,open:o}});n.forEach(s=>{r.push({groupId:s,open:!0})}),r.length&&(this.columnGroupStates=r),t.setColumnGroupState(r,"gridInitializing")}getFilterState(){const e=this.beans.filterManager;let t=e?.getFilterModel();t&&Object.keys(t).length===0&&(t=void 0);const n=e?.getAdvFilterModel()??void 0;return t||n?{filterModel:t,advancedFilterModel:n}:void 0}setFilterState(e){const t=this.beans.filterManager,{filterModel:n,advancedFilterModel:i}=e??{};n&&t?.setFilterModel(n,"columnFilter"),i&&t?.setAdvFilterModel(i,"advancedFilter")}getRangeSelectionState(){const e=this.beans.rangeSvc?.getCellRanges().map(t=>{const{id:n,type:i,startRow:r,endRow:s,columns:o,startColumn:a}=t;return{id:n,type:i,startRow:r,endRow:s,colIds:o.map(l=>l.getColId()),startColId:a.getColId()}});return e?.length?{cellRanges:e}:void 0}setCellSelectionState(e){const{gos:t,rangeSvc:n,colModel:i,visibleCols:r}=this.beans;if(!Gl(t)||!n)return;const s=[];e.cellRanges.forEach(o=>{const a=[];if(o.colIds.forEach(u=>{const c=i.getCol(u);c&&a.push(c)}),!a.length)return;let l=i.getCol(o.startColId);if(!l){const u=r.allCols,c=new Set(a);l=u.find(d=>c.has(d))}s.push({...o,columns:a,startColumn:l})}),n.setCellRanges(s)}getScrollState(){if(!this.isClientSideRowModel)return;const e=this.beans.ctrlsSvc.getScrollFeature(),{left:t}=e?.getHScrollPosition()??{left:0},{top:n}=e?.getVScrollPosition()??{top:0};return n||t?{top:n,left:t}:void 0}setScrollState(e){if(!this.isClientSideRowModel)return;const{top:t,left:n}=e,{frameworkOverrides:i,rowRenderer:r,animationFrameSvc:s,ctrlsSvc:o}=this.beans;i.wrapIncoming(()=>{o.get("center").setCenterViewportScrollLeft(n),o.getScrollFeature()?.setVerticalScrollPosition(t),r.redraw({afterScroll:!0}),s?.flushAllFrames()})}getSideBarState(){return this.beans.sideBar?.comp?.getState()}getFocusedCellState(){if(!this.isClientSideRowModel)return;const e=this.beans.focusSvc.getFocusedCell();if(e){const{column:t,rowIndex:n,rowPinned:i}=e;return{colId:t.getColId(),rowIndex:n,rowPinned:i}}}setFocusedCellState(e){if(!this.isClientSideRowModel)return;const{colId:t,rowIndex:n,rowPinned:i}=e,{focusSvc:r,colModel:s}=this.beans;r.setFocusedCell({column:s.getCol(t),rowIndex:n,rowPinned:i,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}getPaginationState(){const{pagination:e,gos:t}=this.beans;if(!e)return;const n=e.getCurrentPage(),i=t.get("paginationAutoPageSize")?void 0:e.getPageSize();if(!(!n&&!i))return{page:n,pageSize:i}}setPaginationState(e){const{pagination:t,gos:n}=this.beans;t&&(e.pageSize&&!n.get("paginationAutoPageSize")&&t.setPageSize(e.pageSize,"initialState"),typeof e.page=="number"&&t.setPage(e.page))}getRowSelectionState(){const e=this.beans.selectionSvc;if(!e)return;const t=e.getSelectionState();return!t||!Array.isArray(t)&&(t.selectAll===!1||t.selectAllChildren===!1)&&!t?.toggledNodes?.length?void 0:t}setRowSelectionState(e){this.beans.selectionSvc?.setSelectionState(e,"gridInitializing")}getRowGroupExpansionState(){const{expansionSvc:e,rowModel:t}=this.beans;if(!e)return;const n=[];return t.forEachNode(({expanded:i,id:r})=>{i&&r&&n.push(r)}),n.length?{expandedRowGroupIds:n}:void 0}setRowGroupExpansionState(e){this.beans.expansionSvc?.expandRows(e.expandedRowGroupIds)}updateColumnState(e){const t=this.getColumnState();let n=!1;const i=this.cachedState;for(const r of Object.keys(t)){const s=t[r];l0(s,i[r])||(n=!0)}this.cachedState={...i,...t},n&&this.dispatchStateUpdateEvent(e)}updateCachedState(e,t){const n=this.cachedState[e];this.setCachedStateValue(e,t),l0(t,n)||this.dispatchStateUpdateEvent([e])}setCachedStateValue(e,t){this.cachedState={...this.cachedState,[e]:t}}refreshStaleState(){const e=this.staleStateKeys;e.forEach(t=>{switch(t){case"rowSelection":this.setCachedStateValue(t,this.getRowSelectionState());break}}),e.clear()}dispatchStateUpdateEvent(e){this.suppressEvents||(e.forEach(t=>this.queuedUpdateSources.add(t)),this.dispatchStateUpdateEventDebounced())}dispatchQueuedStateUpdateEvents(){const e=this.queuedUpdateSources,t=Array.from(e);e.clear(),this.eventSvc.dispatchEvent({type:"stateUpdated",sources:t,state:this.cachedState})}suppressEventsAndDispatchInitEvent(e){this.suppressEvents=!0;const t=this.beans.colAnimation;t?.setSuppressAnimation(!0),e(),setTimeout(()=>{this.suppressEvents=!1,this.queuedUpdateSources.clear(),this.isAlive()&&(t?.setSuppressAnimation(!1),this.dispatchStateUpdateEvent(["gridInitializing"]))})}},Pit={moduleName:"GridState",version:Ce,beans:[Dit],apiFunctions:{getState:Rit}};function kit(e){return e.rowModel.isLastRowIndexKnown()}function Tit(e){return e.pagination?.getPageSize()??100}function Mit(e){return e.pagination?.getCurrentPage()??0}function Iit(e){return e.pagination?.getTotalPages()??1}function _it(e){return e.pagination?e.pagination.getMasterRowCount():e.rowModel.getRowCount()}function Oit(e){e.pagination?.goToNextPage()}function Lit(e){e.pagination?.goToPreviousPage()}function Nit(e){e.pagination?.goToFirstPage()}function $it(e){e.pagination?.goToLastPage()}function Bit(e,t){e.pagination?.goToPage(t)}var Git=class extends X{constructor(){super(...arguments),this.beanName="paginationAutoPageSizeSvc"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.centerRowsCtrl=e.center;const t=this.checkPageSize.bind(this);this.addManagedEventListeners({bodyHeightChanged:t,scrollVisibilityChanged:t}),this.addManagedPropertyListener("paginationAutoPageSize",this.onPaginationAutoSizeChanged.bind(this)),this.checkPageSize()})}notActive(){return!this.gos.get("paginationAutoPageSize")||this.centerRowsCtrl==null}onPaginationAutoSizeChanged(){this.notActive()?this.beans.pagination.unsetAutoCalculatedPageSize():this.checkPageSize()}checkPageSize(){if(this.notActive())return;const e=this.centerRowsCtrl.viewportSizeFeature.getBodyHeight();if(e>0){const t=this.beans,n=()=>{const i=Math.max(Fd(t),1),r=Math.floor(e/i);t.pagination.setPageSize(r,"autoCalculated")};this.isBodyRendered?hi(this,n,50)():(n(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}},mm="paginationPageSizeSelector",zit={tag:"span",cls:"ag-paging-page-size"},Hit=class extends bt{constructor(){super(zit),this.hasEmptyOption=!1,this.handlePageSizeItemSelected=()=>{if(!this.selectPageSizeComp)return;const e=this.selectPageSizeComp.getValue();if(!e)return;const t=Number(e);isNaN(t)||t<1||t===this.pagination.getPageSize()||(this.pagination.setPageSize(t,"pageSizeSelector"),this.hasEmptyOption&&this.toggleSelectDisplay(!0),this.selectPageSizeComp.getFocusableElement().focus())}}wireBeans(e){this.pagination=e.pagination}postConstruct(){this.addManagedPropertyListener(mm,()=>{this.onPageSizeSelectorValuesChange()}),this.addManagedEventListeners({paginationChanged:e=>this.handlePaginationChanged(e)})}handlePaginationChanged(e){if(!this.selectPageSizeComp||!e?.newPageSize)return;const t=this.pagination.getPageSize();this.getPageSizeSelectorValues().includes(t)?this.selectPageSizeComp.setValue(t.toString()):this.hasEmptyOption?this.selectPageSizeComp.setValue(""):this.toggleSelectDisplay(!0)}toggleSelectDisplay(e){this.selectPageSizeComp&&!e&&this.reset(),e&&(this.reloadPageSizesSelector(),this.selectPageSizeComp)}reset(){Ii(this.getGui()),this.selectPageSizeComp&&(this.selectPageSizeComp=this.destroyBean(this.selectPageSizeComp))}onPageSizeSelectorValuesChange(){this.selectPageSizeComp&&this.shouldShowPageSizeSelector()&&this.reloadPageSizesSelector()}shouldShowPageSizeSelector(){return this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel")&&!this.gos.get("paginationAutoPageSize")&&this.gos.get(mm)!==!1}reloadPageSizesSelector(){const e=this.getPageSizeSelectorValues(),t=this.pagination.getPageSize(),n=!t||!e.includes(t);if(n){const r=this.gos.exists("paginationPageSize"),s=this.gos.get(mm)!==!0;ue(94,{pageSizeSet:r,pageSizesSet:s,pageSizeOptions:e,paginationPageSizeOption:t}),s||ue(95,{paginationPageSizeOption:t,paginationPageSizeSelector:mm}),e.unshift("")}const i=String(n?"":t);this.selectPageSizeComp?(Sh(this.pageSizeOptions,e)||(this.selectPageSizeComp.clearOptions().addOptions(this.createPageSizeSelectOptions(e)),this.pageSizeOptions=e),this.selectPageSizeComp.setValue(i,!0)):this.createPageSizeSelectorComp(e,i),this.hasEmptyOption=n}createPageSizeSelectOptions(e){return e.map(t=>({value:String(t)}))}createPageSizeSelectorComp(e,t){const n=this.getLocaleTextFunc(),i=n("pageSizeSelectorLabel","Page Size:"),r=n("ariaPageSizeSelectorLabel","Page Size");this.selectPageSizeComp=this.createManagedBean(new MN).addOptions(this.createPageSizeSelectOptions(e)).setValue(t).setAriaLabel(r).setLabel(i).onValueChange(()=>this.handlePageSizeItemSelected()),this.appendChild(this.selectPageSizeComp)}getPageSizeSelectorValues(){const e=[20,50,100],t=this.gos.get(mm);return!Array.isArray(t)||!t?.length?e:[...t].sort((n,i)=>n-i)}destroy(){this.toggleSelectDisplay(!1),super.destroy()}},Vit={selector:"AG-PAGE-SIZE-SELECTOR",component:Hit},Wit=".ag-paging-panel{align-items:center;border-top:var(--ag-footer-row-border);display:flex;gap:calc(var(--ag-spacing)*4);height:max(var(--ag-row-height),22px);justify-content:flex-end;padding:0 var(--ag-cell-horizontal-padding)}:where(.ag-paging-page-size) .ag-wrapper{min-width:50px}.ag-paging-page-summary-panel{align-items:center;display:flex;gap:var(--ag-cell-widget-spacing);.ag-disabled &{pointer-events:none}}.ag-paging-button{cursor:pointer;position:relative;&.ag-disabled{cursor:default;opacity:.5}}.ag-paging-number,.ag-paging-row-summary-panel-number{font-weight:500}",Uit=class extends Yne{constructor(){super(),this.btFirst=ge,this.btPrevious=ge,this.btNext=ge,this.btLast=ge,this.lbRecordCount=ge,this.lbFirstRowOnPage=ge,this.lbLastRowOnPage=ge,this.lbCurrent=ge,this.lbTotal=ge,this.pageSizeComp=ge,this.previousAndFirstButtonsDisabled=!1,this.nextButtonDisabled=!1,this.lastButtonDisabled=!1,this.areListenersSetup=!1,this.allowFocusInnerElement=!1,this.registerCSS(Wit)}wireBeans(e){this.rowModel=e.rowModel,this.pagination=e.pagination,this.ariaAnnounce=e.ariaAnnounce}postConstruct(){const e=this.gos.get("enableRtl");this.setTemplate(this.getTemplate(),[Vit]);const{btFirst:t,btPrevious:n,btNext:i,btLast:r}=this;this.activateTabIndex([t,n,i,r]),t.insertAdjacentElement("afterbegin",As(e?"last":"first",this.beans)),n.insertAdjacentElement("afterbegin",As(e?"next":"previous",this.beans)),i.insertAdjacentElement("afterbegin",As(e?"previous":"next",this.beans)),r.insertAdjacentElement("afterbegin",As(e?"first":"last",this.beans)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.addManagedPropertyListeners(["paginationPageSizeSelector","paginationAutoPageSize","suppressPaginationPanel"],()=>this.onPageSizeRelatedOptionsChange()),this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector()),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:s=>this.allowFocusInnerElement?this.tabGuardFeature.getTabGuardCtrl().focusInnerElement(s):Fje(this.beans,s),forceFocusOutWhenTabGuardsAreEmpty:!0}),this.onPaginationChanged()}setAllowFocus(e){this.allowFocusInnerElement=e}onPaginationChanged(){const t=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.setDisplayed(t),t&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateLabels(),this.onPageSizeRelatedOptionsChange())}onPageSizeRelatedOptionsChange(){this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector())}setupListeners(){this.areListenersSetup||(this.addManagedEventListeners({paginationChanged:this.onPaginationChanged.bind(this)}),[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}].forEach(e=>{const{el:t,fn:n}=e;this.addManagedListeners(t,{click:n,keydown:i=>{(i.key===K.ENTER||i.key===K.SPACE)&&(i.preventDefault(),n())}})}),Eje(this.beans,this,this.getGui()),this.areListenersSetup=!0)}onBtFirst(){this.previousAndFirstButtonsDisabled||this.pagination.goToFirstPage()}formatNumber(e){const t=this.gos.getCallback("paginationNumberFormatter");return t?t({value:e}):$Ze(e,this.getLocaleTextFunc.bind(this))}getTemplate(){const e=this.getLocaleTextFunc(),t=`ag-${this.getCompId()}`;return{tag:"div",cls:"ag-paging-panel ag-unselectable",attrs:{id:`${t}`},children:[{tag:"ag-page-size-selector",ref:"pageSizeComp"},{tag:"span",cls:"ag-paging-row-summary-panel",children:[{tag:"span",ref:"lbFirstRowOnPage",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-first-row`}},{tag:"span",attrs:{id:`${t}-to`},children:e("to","to")},{tag:"span",ref:"lbLastRowOnPage",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-last-row`}},{tag:"span",attrs:{id:`${t}-of`},children:e("of","of")},{tag:"span",ref:"lbRecordCount",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-row-count`}}]},{tag:"span",cls:"ag-paging-page-summary-panel",role:"presentation",children:[{tag:"div",ref:"btFirst",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("firstPage","First Page")}},{tag:"div",ref:"btPrevious",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("previousPage","Previous Page")}},{tag:"span",cls:"ag-paging-description",children:[{tag:"span",attrs:{id:`${t}-start-page`},children:e("page","Page")},{tag:"span",ref:"lbCurrent",cls:"ag-paging-number",attrs:{id:`${t}-start-page-number`}},{tag:"span",attrs:{id:`${t}-of-page`},children:e("of","of")},{tag:"span",ref:"lbTotal",cls:"ag-paging-number",attrs:{id:`${t}-of-page-number`}}]},{tag:"div",ref:"btNext",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("nextPage","Next Page")}},{tag:"div",ref:"btLast",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("lastPage","Last Page")}}]}]}}onBtNext(){this.nextButtonDisabled||this.pagination.goToNextPage()}onBtPrevious(){this.previousAndFirstButtonsDisabled||this.pagination.goToPreviousPage()}onBtLast(){this.lastButtonDisabled||this.pagination.goToLastPage()}enableOrDisableButtons(){const e=this.pagination.getCurrentPage(),t=this.rowModel.isLastRowIndexKnown(),n=this.pagination.getTotalPages();this.previousAndFirstButtonsDisabled=e===0,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);const i=this.isZeroPagesToDisplay(),r=e===n-1;this.nextButtonDisabled=r||i,this.lastButtonDisabled=!t||i||e===n-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)}toggleButtonDisabled(e,t){e9e(e,t),e.classList.toggle("ag-disabled",t)}isZeroPagesToDisplay(){const e=this.rowModel.isLastRowIndexKnown(),t=this.pagination.getTotalPages();return e&&t===0}updateLabels(){const e=this.rowModel.isLastRowIndexKnown(),t=this.pagination.getTotalPages(),n=this.pagination.getMasterRowCount(),i=e?n:null,r=this.pagination.getCurrentPage(),s=this.pagination.getPageSize();let o,a;this.isZeroPagesToDisplay()?o=a=0:(o=s*r+1,a=o+s-1,e&&a>i&&(a=i));const l=o+s-1,u=!e&&n<l,c=this.formatNumber(o);this.lbFirstRowOnPage.textContent=c;let d;const h=this.getLocaleTextFunc();u?d=h("pageLastRowUnknown","?"):d=this.formatNumber(a),this.lbLastRowOnPage.textContent=d;const g=t>0?r+1:0,v=this.formatNumber(g);this.lbCurrent.textContent=v;let C,y;if(e)C=this.formatNumber(t),y=this.formatNumber(i);else{const b=h("more","more");C=b,y=b}this.lbTotal.textContent=C,this.lbRecordCount.textContent=y,this.announceAriaStatus(c,d,y,v,C)}announceAriaStatus(e,t,n,i,r){const s=this.getLocaleTextFunc(),o=s("page","Page"),a=s("to","to"),l=s("of","of"),u=`${e} ${a} ${t} ${l} ${n}`,c=`${o} ${i} ${l} ${r}`;u!==this.ariaRowStatus&&(this.ariaRowStatus=u,this.ariaAnnounce?.announceValue(u,"paginationRow")),c!==this.ariaPageStatus&&(this.ariaPageStatus=c,this.ariaAnnounce?.announceValue(c,"paginationPage"))}setTotalLabelsToZero(){const e=this.formatNumber(0);this.lbFirstRowOnPage.textContent=e,this.lbCurrent.textContent=e,this.lbLastRowOnPage.textContent=e,this.lbTotal.textContent=e,this.lbRecordCount.textContent=e,this.announceAriaStatus(e,e,e,e,e)}},jit={selector:"AG-PAGINATION",component:Uit},qit=class extends X{constructor(){super(...arguments),this.beanName="pagination",this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=0,this.masterRowCount=0}postConstruct(){const e=this.gos;this.active=e.get("pagination"),this.pageSizeFromGridOptions=e.get("paginationPageSize"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedPropertyListener("pagination",this.onPaginationGridOptionChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPageSizeGridOptionChanged.bind(this))}getPaginationSelector(){return jit}isPaginateChildRows(){const e=this.gos;return e.get("groupHideParentOfSingleChild")||e.get("groupRemoveSingleChildren")||e.get("groupRemoveLowestSingleChildren")?!0:e.get("paginateChildRows")}onPaginationGridOptionChanged(){this.active=this.gos.get("pagination"),this.calculatePages(),this.dispatchPaginationChangedEvent({keepRenderedRows:!0})}onPageSizeGridOptionChanged(){this.setPageSize(this.gos.get("paginationPageSize"),"gridOptions")}goToPage(e){const t=this.currentPage;!this.active||t===e||typeof t!="number"||(this.currentPage=e,this.calculatePages(),this.dispatchPaginationChangedEvent({newPage:!0}))}goToPageWithIndex(e){if(!this.active)return;let t=e;this.paginateChildRows||(t=this.beans.rowModel.getTopLevelIndexFromDisplayedIndex?.(e)??e),this.goToPage(Math.floor(t/this.pageSize))}isRowInPage(e){return this.active?e>=this.topDisplayedRowIndex&&e<=this.bottomDisplayedRowIndex:!0}getCurrentPage(){return this.currentPage}goToNextPage(){this.goToPage(this.currentPage+1)}goToPreviousPage(){this.goToPage(this.currentPage-1)}goToFirstPage(){this.goToPage(0)}goToLastPage(){const e=this.beans.rowModel.getRowCount(),t=Math.floor(e/this.pageSize);this.goToPage(t)}getPageSize(){return this.pageSize}getTotalPages(){return this.totalPages}setPage(e){this.currentPage=e}get pageSize(){return me(this.pageSizeAutoCalculated)&&this.gos.get("paginationAutoPageSize")?this.pageSizeAutoCalculated:me(this.pageSizeFromPageSizeSelector)?this.pageSizeFromPageSizeSelector:me(this.pageSizeFromInitialState)?this.pageSizeFromInitialState:me(this.pageSizeFromGridOptions)?this.pageSizeFromGridOptions:this.defaultPageSize}calculatePages(){this.active?this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly():this.calculatedPagesNotActive(),this.beans.pageBounds.calculateBounds(this.topDisplayedRowIndex,this.bottomDisplayedRowIndex)}unsetAutoCalculatedPageSize(){if(this.pageSizeAutoCalculated===void 0)return;const e=this.pageSizeAutoCalculated;this.pageSizeAutoCalculated=void 0,this.pageSize!==e&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0}))}setPageSize(e,t){const n=this.pageSize;switch(t){case"autoCalculated":this.pageSizeAutoCalculated=e;break;case"pageSizeSelector":this.pageSizeFromPageSizeSelector=e,this.currentPage!==0&&this.goToFirstPage();break;case"initialState":this.pageSizeFromInitialState=e;break;case"gridOptions":this.pageSizeFromGridOptions=e,this.pageSizeFromInitialState=void 0,this.pageSizeFromPageSizeSelector=void 0,this.currentPage!==0&&this.goToFirstPage();break}n!==this.pageSize&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0,keepRenderedRows:!0}))}setZeroRows(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0}adjustCurrentPageIfInvalid(){const e=this.totalPages;this.currentPage>=e&&(this.currentPage=e-1);const t=this.currentPage;(!isFinite(t)||isNaN(t)||t<0)&&(this.currentPage=0)}calculatePagesMasterRowsOnly(){const e=this.beans.rowModel,t=e.getTopLevelRowCount();if(this.masterRowCount=t,t<=0){this.setZeroRows();return}const n=this.pageSize,i=t-1;this.totalPages=Math.floor(i/n)+1,this.adjustCurrentPageIfInvalid();const r=this.currentPage,s=n*r;let o=n*(r+1)-1;if(o>i&&(o=i),this.topDisplayedRowIndex=e.getTopLevelRowDisplayedIndex(s),o===i)this.bottomDisplayedRowIndex=e.getRowCount()-1;else{const a=e.getTopLevelRowDisplayedIndex(o+1);this.bottomDisplayedRowIndex=a-1}}getMasterRowCount(){return this.masterRowCount}calculatePagesAllRows(){const e=this.beans.rowModel.getRowCount();if(this.masterRowCount=e,e===0){this.setZeroRows();return}const{pageSize:t,currentPage:n}=this,i=e-1;this.totalPages=Math.floor(i/t)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=t*n,this.bottomDisplayedRowIndex=t*(n+1)-1,this.bottomDisplayedRowIndex>i&&(this.bottomDisplayedRowIndex=i)}calculatedPagesNotActive(){this.setPageSize(void 0,"autoCalculated"),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.beans.rowModel.getRowCount()-1}dispatchPaginationChangedEvent(e){const{keepRenderedRows:t=!1,newPage:n=!1,newPageSize:i=!1}=e;this.eventSvc.dispatchEvent({type:"paginationChanged",animate:!1,newData:!1,newPage:n,newPageSize:i,keepRenderedRows:t})}},Kit={moduleName:"Pagination",version:Ce,beans:[qit,Git],icons:{first:"first",previous:"previous",next:"next",last:"last"},apiFunctions:{paginationIsLastPageFound:kit,paginationGetPageSize:Tit,paginationGetCurrentPage:Mit,paginationGetTotalPages:Iit,paginationGetRowCount:_it,paginationGoToNextPage:Oit,paginationGoToPreviousPage:Lit,paginationGoToFirstPage:Nit,paginationGoToLastPage:$it,paginationGoToPage:Bit},dependsOn:[$R]};function Yit(e,t={}){const n=t?t.rowNodes:void 0;e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.redrawRows(n))}function Xie(e,t,n,i,r){t&&(i&&t.parent&&t.parent.level!==-1&&Xie(e,t.parent,n,i,r),t.setExpanded(n,void 0,r))}function Xit(e,t){return e.rowModel.getRowNode(t)}function Qit(e,t,n,i){e.rowRenderer.addRenderedRowListener(t,n,i)}function Jit(e){return e.rowRenderer.getRenderedNodes()}function Zit(e,t,n){e.rowModel.forEachNode(t,n)}function ert(e){return e.rowRenderer.firstRenderedRow}function trt(e){return e.rowRenderer.lastRenderedRow}function nrt(e,t){return e.rowModel.getRow(t)}function irt(e){return e.rowModel.getRowCount()}var Qie={moduleName:"RowApi",version:Ce,apiFunctions:{redrawRows:Yit,setRowNodeExpanded:Xie,getRowNode:Xit,addRenderedRowListener:Qit,getRenderedNodes:Jit,forEachNode:Zit,getFirstDisplayedRowIndex:ert,getLastDisplayedRowIndex:trt,getDisplayedRowAtIndex:nrt,getDisplayedRowCount:irt}},rrt={moduleName:"ScrollApi",version:Ce,apiFunctions:{getVerticalPixelRange:Ntt,getHorizontalPixelRange:$tt,ensureColumnVisible:Wie,ensureIndexVisible:Uie,ensureNodeVisible:Btt}};function srt(e,t,n){if(!t)return;const i=e.ctrlsSvc.getGridBodyCtrl().eGridBody,r=`aria-${t}`;n===null?i.removeAttribute(r):i.setAttribute(r,n)}function ort(e,t={}){e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.refreshCells(t))}function art(e){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getHeaderRowContainerCtrls().forEach(t=>t.refresh()))}function lrt(e){return e.animationFrameSvc?.isQueueEmpty()??!0}function urt(e){e.animationFrameSvc?.flushAllFrames()}function crt(e){return{rowHeight:Fd(e),headerHeight:SC(e)}}function drt(e,t={}){const n=[];if(e.rowRenderer.getCellCtrls(t.rowNodes,t.columns).forEach(s=>{const o=s.getCellRenderer();o!=null&&n.push(f0(o))}),t.columns?.length)return n;const i=[],r=HT(t.rowNodes);return e.rowRenderer.getAllRowCtrls().forEach(s=>{if(r&&!VT(s.rowNode,r)||!s.isFullWidth())return;const o=s.getFullWidthCellRenderers();for(let a=0;a<o.length;a++){const l=o[a];l!=null&&i.push(f0(l))}}),[...i,...n]}var hrt={moduleName:"RenderApi",version:Ce,apiFunctions:{setGridAriaProperty:srt,refreshCells:ort,refreshHeader:art,isAnimationFrameQueueEmpty:lrt,flushAllAnimationFrames:urt,getSizesForCurrentTheme:crt,getCellRendererInstances:drt}};function frt(e,t){typeof t=="number"?e.colAutosize?.sizeColumnsToFit(t,"api"):e.colAutosize?.sizeColumnsToFitGridBody(t)}function prt(e,t,n){e.colAutosize?.autoSizeCols({colKeys:t,skipHeader:n,source:"api"})}function grt(e,t){e.colAutosize?.autoSizeAllColumns("api",t)}var mrt=class extends X{constructor(){super(...arguments),this.beanName="colAutosize",this.timesDelayed=0,this.shouldQueueResizeOperations=!1,this.resizeOperationQueue=[]}postConstruct(){this.addManagedEventListeners({firstDataRendered:()=>this.onFirstDataRendered()})}autoSizeCols(e){if(this.shouldQueueResizeOperations){this.pushResizeOperation(()=>this.autoSizeCols(e));return}const{colKeys:t,skipHeader:n,skipHeaderGroups:i,stopAtGroup:r,source:s="api"}=e,{animationFrameSvc:o,renderStatus:a,colModel:l,autoWidthCalc:u,visibleCols:c}=this.beans;if(o?.flushAllFrames(),this.timesDelayed<5&&a&&!a.areHeaderCellsRendered()){this.timesDelayed++,setTimeout(()=>{this.isAlive()&&this.autoSizeCols(e)});return}this.timesDelayed=0;const d=[];let h=-1;const p=n??this.gos.get("skipHeaderOnAutoSize"),g=i??p;for(;h!==0;){h=0;const v=[];t.forEach(C=>{if(!C)return;const y=l.getCol(C);if(!y||Ep(y)||d.indexOf(y)>=0)return;const b=u.getPreferredWidthForColumn(y,p);if(b>0){const S=vrt(y,b);y.setActualWidth(S,s),d.push(y),h++}v.push(y)}),v.length&&c.refresh(s)}g||this.autoSizeColumnGroupsByColumns(t,s,r),Fp(this.eventSvc,d,!0,"autosizeColumns")}autoSizeColumn(e,t,n){e&&this.autoSizeCols({colKeys:[e],skipHeader:n,skipHeaderGroups:!0,source:t})}autoSizeColumnGroupsByColumns(e,t,n){const{colModel:i,ctrlsSvc:r}=this.beans,s=new Set;i.getColsForKeys(e).forEach(u=>{let c=u.getParent();for(;c&&c!=n;)c.isPadding()||s.add(c),c=c.getParent()});let a;const l=[];for(const u of s){for(const c of r.getHeaderRowContainerCtrls())if(a=c.getHeaderCtrlForColumn(u),a)break;a&&a.resizeLeafColumnsToFit(t)}return l}autoSizeAllColumns(e,t){if(this.shouldQueueResizeOperations){this.pushResizeOperation(()=>this.autoSizeAllColumns(e,t));return}const n=this.beans.visibleCols.allCols;this.autoSizeCols({colKeys:n,skipHeader:t,source:e})}addColumnAutosize(e,t){const n=this.gos.get("skipHeaderOnAutoSize"),i=()=>{this.autoSizeColumn(t,"uiColumnResized",n)};e.addEventListener("dblclick",i);const r=new af(e);return r.addEventListener("doubleTap",i),()=>{e.removeEventListener("dblclick",i),r.removeEventListener("doubleTap",i),r.destroy()}}addColumnGroupResize(e,t,n){const i=this.gos.get("skipHeaderOnAutoSize"),r=()=>{const s=[];t.getDisplayedLeafColumns().forEach(a=>{a.getColDef().suppressAutoSize||s.push(a.getColId())}),s.length>0&&this.autoSizeCols({colKeys:s,skipHeader:i,stopAtGroup:t,source:"uiColumnResized"}),n()};return e.addEventListener("dblclick",r),()=>e.removeEventListener("dblclick",r)}sizeColumnsToFitGridBody(e,t){if(!this.isAlive())return;const{ctrlsSvc:n,scrollVisibleSvc:i}=this.beans,r=n.getGridBodyCtrl(),o=r.isVerticalScrollShowing()?i.getScrollbarWidth():0,l=a0(r.eGridBody)-o;if(l>0){this.sizeColumnsToFit(l,"sizeColumnsToFit",!1,e);return}t===void 0?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,100)},0):t===100?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,500)},100):t===500?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,-1)},500):ue(29)}sizeColumnsToFit(e,t="sizeColumnsToFit",n,i){if(this.shouldQueueResizeOperations){this.pushResizeOperation(()=>this.sizeColumnsToFit(e,t,n,i));return}const r={};i&&i?.columnLimits?.forEach(({key:p,...g})=>{r[typeof p=="string"?p:p.getColId()]=g});const s=this.beans.visibleCols.allCols;if(e<=0||!s.length||e===ol(s)&&s.every(g=>{if(g.colDef.suppressSizeToFit)return!0;const v=r?.[g.getId()],C=v?.minWidth??i?.defaultMinWidth,y=v?.maxWidth??i?.defaultMaxWidth,b=g.getActualWidth();return(C==null||b>=C)&&(y==null||b<=y)}))return;const a=[],l=[];s.forEach(p=>{p.getColDef().suppressSizeToFit===!0?l.push(p):a.push(p)});const u=a.slice(0);let c=!1;const d=p=>{Ao(a,p),l.push(p)};for(a.forEach(p=>{p.resetActualWidth(t);const g=r?.[p.getId()],v=g?.minWidth??i?.defaultMinWidth,C=g?.maxWidth??i?.defaultMaxWidth,y=p.getActualWidth();typeof v=="number"&&y<v?p.setActualWidth(v,t,!0):typeof C=="number"&&y>C&&p.setActualWidth(C,t,!0)});!c;){c=!0;const p=e-ol(l);if(p<=0)a.forEach(g=>{const v=r?.[g.getId()]?.minWidth??i?.defaultMinWidth;if(typeof v=="number"){g.setActualWidth(v,t,!0);return}g.setActualWidth(g.minWidth,t)});else{const g=p/ol(a);let v=p;for(let C=a.length-1;C>=0;C--){const y=a[C],b=r?.[y.getId()],S=b?.minWidth??i?.defaultMinWidth,x=b?.maxWidth??i?.defaultMaxWidth,E=y.getMinWidth(),A=y.getMaxWidth(),F=typeof S=="number"&&S>E?S:E,k=typeof x=="number"&&x<A?x:A;let P=Math.round(y.getActualWidth()*g);P<F?(P=F,d(y),c=!1):P>k?(P=k,d(y),c=!1):C===0&&(P=v),y.setActualWidth(P,t,!0),v-=P}}}u.forEach(p=>{p.fireColumnWidthChangedEvent(t)});const h=this.beans.visibleCols;h.setLeftValues(t),h.updateBodyWidths(),!n&&Fp(this.eventSvc,u,!0,t)}applyAutosizeStrategy(){const e=this.gos.get("autoSizeStrategy");if(!e)return;const{type:t}=e;setTimeout(()=>{if(t==="fitGridWidth"){const{columnLimits:n,defaultMinWidth:i,defaultMaxWidth:r}=e,s=n?.map(({colId:o,minWidth:a,maxWidth:l})=>({key:o,minWidth:a,maxWidth:l}));this.sizeColumnsToFitGridBody({defaultMinWidth:i,defaultMaxWidth:r,columnLimits:s})}else t==="fitProvidedWidth"&&this.sizeColumnsToFit(e.width,"sizeColumnsToFit")})}onFirstDataRendered(){const e=this.gos.get("autoSizeStrategy");if(e?.type!=="fitCellContents")return;const{colIds:t,skipHeader:n}=e;setTimeout(()=>{t?this.autoSizeCols({colKeys:t,skipHeader:n,source:"autosizeColumns"}):this.autoSizeAllColumns("autosizeColumns",n)})}processResizeOperations(){this.shouldQueueResizeOperations=!1,this.resizeOperationQueue.forEach(e=>e()),this.resizeOperationQueue=[]}pushResizeOperation(e){this.resizeOperationQueue.push(e)}destroy(){this.resizeOperationQueue.length=0,super.destroy()}};function vrt(e,t){const n=e.getMinWidth();t<n&&(t=n);const i=e.getMaxWidth();return e.isGreaterThanMax(t)&&(t=i),t}var Crt={moduleName:"ColumnAutoSize",version:Ce,beans:[mrt],apiFunctions:{sizeColumnsToFit:frt,autoSizeColumns:prt,autoSizeAllColumns:grt},dependsOn:[rie]};function yrt(e){return e.pinnedRowModel?.getPinnedTopRowCount()??0}function wrt(e){return e.pinnedRowModel?.getPinnedBottomRowCount()??0}function brt(e,t){return e.pinnedRowModel?.getPinnedTopRow(t)}function Srt(e,t){return e.pinnedRowModel?.getPinnedBottomRow(t)}var xrt=class extends X{constructor(){super(...arguments),this.beanName="pinnedRowModel",this.nextId=0,this.pinnedTopRows={cache:{},order:[]},this.pinnedBottomRows={cache:{},order:[]}}postConstruct(){const e=this.gos;this.setPinnedRowData(e.get("pinnedTopRowData"),"top"),this.setPinnedRowData(e.get("pinnedBottomRowData"),"bottom"),this.addManagedPropertyListener("pinnedTopRowData",t=>this.setPinnedRowData(t.currentValue,"top")),this.addManagedPropertyListener("pinnedBottomRowData",t=>this.setPinnedRowData(t.currentValue,"bottom")),this.addManagedEventListeners({gridStylesChanged:this.onGridStylesChanges.bind(this)})}isEmpty(e){return this.getCache(e).order.length===0}isRowsToRender(e){return!this.isEmpty(e)}onGridStylesChanges(e){if(e.rowHeightChanged){const t=n=>{n.setRowHeight(n.rowHeight,!0)};vm(this.pinnedBottomRows,t),vm(this.pinnedTopRows,t)}}ensureRowHeightsValid(){let e=!1,t=0;const n=i=>{if(i.rowHeightEstimated){const r=Sp(this.beans,i);i.setRowTop(t),i.setRowHeight(r.height),t+=r.height,e=!0}};return vm(this.pinnedBottomRows,n),t=0,vm(this.pinnedTopRows,n),this.eventSvc.dispatchEvent({type:"pinnedHeightChanged"}),e}setPinnedRowData(e,t){this.updateNodesFromRowData(e,t),this.eventSvc.dispatchEvent({type:"pinnedRowDataChanged"})}updateNodesFromRowData(e,t){const n=this.getCache(t);if(e===void 0){n.order.length=0,n.cache={};return}const i=xp(this.gos),r=t==="top"?Mne:Ine,s=new Set(n.order),o=[],a=new Set;let l=0,u=-1;for(const c of e){const d=i?.({data:c,level:0,rowPinned:t})??r+this.nextId++;if(a.has(d)){ue(96,{id:d,data:c});continue}u++,a.add(d),o.push(d);const h=Cv(n,d);if(h!==void 0)h.data!==c&&h.setData(c),l+=this.setRowTopAndRowIndex(h,l,u),s.delete(d);else{const p=new Dp(this.beans);p.id=d,p.data=c,p.rowPinned=t,l+=this.setRowTopAndRowIndex(p,l,u),n.cache[d]=p,n.order.push(d)}}s.forEach(c=>{Cv(n,c)?.clearRowTopAndRowIndex(),delete n.cache[c]}),n.order=o}setRowTopAndRowIndex(e,t,n){return e.setRowTop(t),e.setRowHeight(Sp(this.beans,e).height),e.setRowIndex(n),e.rowHeight}getPinnedTopTotalHeight(){return LW(this.pinnedTopRows)}getPinnedBottomTotalHeight(){return LW(this.pinnedBottomRows)}getPinnedTopRowCount(){return qT(this.pinnedTopRows)}getPinnedBottomRowCount(){return qT(this.pinnedBottomRows)}getPinnedTopRow(e){return jT(this.pinnedTopRows,e)}getPinnedBottomRow(e){return jT(this.pinnedBottomRows,e)}getPinnedRowById(e,t){return Cv(this.getCache(t),e)}forEachPinnedRow(e,t){return vm(this.getCache(e),t)}getCache(e){return e==="top"?this.pinnedTopRows:this.pinnedBottomRows}};function LW(e){const t=qT(e);if(t===0)return 0;const n=jT(e,t-1);return n===void 0?0:n.rowTop+n.rowHeight}function Cv(e,t){return e.cache[t]}function jT(e,t){return Cv(e,e.order[t])}function vm(e,t){e.order.forEach((n,i)=>{const r=Cv(e,n);r&&t(r,i)})}function qT(e){return e.order.length}var Rrt={moduleName:"PinnedRow",version:Ce,beans:[xrt],apiFunctions:{getPinnedTopRowCount:yrt,getPinnedBottomRowCount:wrt,getPinnedTopRow:brt,getPinnedBottomRow:Srt}},Ert=class extends hv{constructor(e,t,n){super(e.col,e.firstNode,n,t),this.cellSpan=e,this.SPANNED_CELL_CSS_CLASS="ag-spanned-cell"}setComp(e,t,n,i,r,s,o){this.eWrapper=n,super.setComp(e,t,n,i,r,s,o),this.setAriaRowSpan(),this.refreshAriaRowIndex()}isCellSpanning(){return!0}getCellSpan(){return this.cellSpan}refreshAriaRowIndex(){this.rowNode.rowIndex!=null&&oN(this.eGui,this.rowNode.rowIndex)}setAriaRowSpan(){s9e(this.eGui,this.cellSpan.spannedNodes.size)}setFocusedCellPosition(e){this.focusedCellPosition=e}getFocusedCellPosition(){return this.focusedCellPosition??this.cellPosition}checkCellFocused(){const e=this.beans.focusSvc.getFocusedCell();return!!e&&this.cellSpan.doesSpanContain(e)}applyStaticCssClasses(){super.applyStaticCssClasses(),this.comp.addOrRemoveCssClass(this.SPANNED_CELL_CSS_CLASS,!0)}onCellFocused(e){const{beans:t}=this;if(_R(t)){this.focusedCellPosition=void 0;return}const n=this.isCellFocused();n||(this.focusedCellPosition=void 0),e&&n&&(this.focusedCellPosition={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column}),super.onCellFocused(e)}getRootElement(){return this.eWrapper}},Frt=class extends r1{onRowIndexChanged(){super.onRowIndexChanged(),this.getAllCellCtrls().forEach(e=>e.refreshAriaRowIndex())}getInitialRowClasses(e){return["ag-spanned-row"]}getNewCellCtrl(e){const t=this.beans.rowSpanSvc?.getCellSpan(e,this.rowNode);if(!(!t||t.firstNode!==this.rowNode))return new Ert(t,this,this.beans)}isCorrectCtrlForSpan(e){const t=this.beans.rowSpanSvc?.getCellSpan(e.column,this.rowNode);return!t||t.firstNode!==this.rowNode?!1:e.getCellSpan()===t}onRowHeightChanged(){}refreshFirstAndLastRowStyles(){}addHoverFunctionality(){}resetHoveredStatus(){}},Art=class extends X{constructor(){super(...arguments),this.beanName="spannedRowRenderer",this.topCtrls=new Map,this.bottomCtrls=new Map,this.centerCtrls=new Map}postConstruct(){this.addManagedEventListeners({displayedRowsChanged:this.createAllCtrls.bind(this)})}createAllCtrls(){this.createCtrls("top"),this.createCtrls("bottom"),this.createCtrls("center")}createCtrls(e){const{rowSpanSvc:t}=this.beans,n=`${e}Ctrls`,i=this[n],r=i.size,s=this.getAllRelevantRowControls(e),o=new Map;let a=!1;for(const u of s)u.isAlive()&&t?.forEachSpannedColumn(u.rowNode,(c,d)=>{if(o.has(d.firstNode))return;const h=i.get(d.firstNode);if(h){o.set(d.firstNode,h),i.delete(d.firstNode);return}a=!0;const p=new Frt(d.firstNode,this.beans,!1,!1,!1);o.set(d.firstNode,p)});this[n]=o;const l=o.size===r;if(!(!a&&l)){for(const u of i.values())u.destroyFirstPass(!0),u.destroySecondPass();this.dispatchLocalEvent({type:"spannedRowsUpdated",ctrlsKey:e})}}getAllRelevantRowControls(e){const{rowRenderer:t}=this.beans;switch(e){case"top":return t.topRowCtrls;case"bottom":return t.bottomRowCtrls;case"center":return t.allRowCtrls}}getCellByPosition(e){const{rowSpanSvc:t}=this.beans,n=t?.getCellSpanByPosition(e);if(!n)return;const i=`${Jie(e.rowPinned)}Ctrls`,r=this[i].get(n.firstNode);if(r)return r.getAllCellCtrls().find(s=>s.column===e.column)}getCtrls(e){const t=`${e}Ctrls`;return[...this[t].values()]}destroyRowCtrls(e){const t=`${e}Ctrls`;for(const n of this[t].values())n.destroyFirstPass(!0),n.destroySecondPass();this[t]=new Map}destroy(){super.destroy(),this.destroyRowCtrls("top"),this.destroyRowCtrls("bottom"),this.destroyRowCtrls("center")}},Jie=e=>e??"center",Drt=class{constructor(e,t){this.col=e,this.firstNode=t,this.cellSpan=!0,this.spannedNodes=new Set,this.addSpannedNode(t)}reset(){this.spannedNodes.clear(),this.addSpannedNode(this.firstNode)}addSpannedNode(e){this.spannedNodes.add(e),this.lastNode=e}getLastNode(){return this.lastNode}getCellHeight(){return this.lastNode.rowTop+this.lastNode.rowHeight-this.firstNode.rowTop-1}doesSpanContain(e){return e.column!==this.col||e.rowPinned!=this.firstNode.rowPinned?!1:this.firstNode.rowIndex<=e.rowIndex&&e.rowIndex<=this.lastNode.rowIndex}getLastNodeAutoHeight(){const e=this.firstNode.__autoHeights?.[this.col.getColId()];if(e==null)return;let t=0;return this.spannedNodes.forEach(n=>{n!==this.lastNode&&(t+=n.rowHeight)}),e-t}},Prt=class extends X{constructor(e){super(),this.column=e}buildCache(e){const{column:t,beans:{gos:n,pinnedRowModel:i,rowModel:r,valueSvc:s,pagination:o}}=this,{colDef:a}=t,l=this[`${e}ValueNodeMap`],u=new Map,c=n.getCallback("isFullWidthRow"),d=a.equals,h=a.spanRows,p=typeof h=="function";let g=null,v=null,C;const y=(S,x)=>{g=S,v=null,C=x},b=S=>{const x=!S.isExpandable()&&!S.group&&!S.detail&&(c?!c({rowNode:S}):!0);if(S.rowIndex==null||!x){y(null,null);return}if(g==null||S.level!==g.level||S.footer||v&&S.rowIndex-1!==v?.getLastNode().rowIndex){y(S,s.getValue(t,S));return}const E=s.getValue(t,S);if(p){const A=Ne(n,{valueA:C,nodeA:g,valueB:E,nodeB:S,column:t,colDef:a});if(!h(A)){y(S,E);return}}else if(d?!d(C,E):C!==E){y(S,E);return}if(!v){const A=l?.get(g);A?.firstNode===g?(A.reset(),v=A):v=new Drt(t,g),u.set(g,v)}v.addSpannedNode(S),u.set(S,v)};switch(e){case"center":r.forEachDisplayedNode?.(S=>{(!o||o.isRowInPage(S.rowIndex))&&b(S)});break;case"top":i?.forEachPinnedRow("top",b);break;case"bottom":i?.forEachPinnedRow("bottom",b);break}this[`${e}ValueNodeMap`]=u}isCellSpanning(e){return!!this.getCellSpan(e)}getCellSpan(e){return this[`${Jie(e.rowPinned)}ValueNodeMap`].get(e)}},krt=class extends X{constructor(){super(...arguments),this.beanName="rowSpanSvc",this.spanningColumns=new Map,this.debouncePinnedEvent=hi(this,this.dispatchCellsUpdatedEvent.bind(this,!0),0),this.debounceModelEvent=hi(this,this.dispatchCellsUpdatedEvent.bind(this,!1),0),this.pinnedTimeout=null,this.modelTimeout=null}postConstruct(){const e=this.onRowDataUpdated.bind(this);this.addManagedEventListeners({paginationChanged:this.buildModelCaches.bind(this),pinnedRowDataChanged:this.buildPinnedCaches.bind(this),rowNodeDataChanged:e,cellValueChanged:e})}register(e){const{gos:t}=this.beans;if(!t.get("enableCellSpan")||this.spanningColumns.has(e))return;const n=this.createManagedBean(new Prt(e));this.spanningColumns.set(e,n),n.buildCache("top"),n.buildCache("bottom"),n.buildCache("center"),this.debouncePinnedEvent(),this.debounceModelEvent()}dispatchCellsUpdatedEvent(e){this.dispatchLocalEvent({type:"spannedCellsUpdated",pinned:e})}deregister(e){this.spanningColumns.delete(e)}onRowDataUpdated({node:e}){const{spannedRowRenderer:t}=this.beans;if(e.rowPinned){if(this.pinnedTimeout!=null)return;this.pinnedTimeout=window.setTimeout(()=>{this.pinnedTimeout=null,this.buildPinnedCaches(),t?.createCtrls("top"),t?.createCtrls("bottom")},0);return}this.modelTimeout==null&&(this.modelTimeout=window.setTimeout(()=>{this.modelTimeout=null,this.buildModelCaches(),t?.createCtrls("center")},0))}buildModelCaches(){this.modelTimeout!=null&&clearTimeout(this.modelTimeout),this.spanningColumns.forEach(e=>e.buildCache("center")),this.debounceModelEvent()}buildPinnedCaches(){this.pinnedTimeout!=null&&clearTimeout(this.pinnedTimeout),this.spanningColumns.forEach(e=>{e.buildCache("top"),e.buildCache("bottom")}),this.debouncePinnedEvent()}isCellSpanning(e,t){const n=this.spanningColumns.get(e);return n?n.isCellSpanning(t):!1}getCellSpanByPosition(e){const{pinnedRowModel:t,rowModel:n}=this.beans,i=e.column,r=e.rowIndex,s=this.spanningColumns.get(i);if(!s)return;let o;switch(e.rowPinned){case"top":o=t?.getPinnedTopRow(r);break;case"bottom":o=t?.getPinnedBottomRow(r);break;default:o=n.getRow(r)}if(o)return s.getCellSpan(o)}getCellStart(e){const t=this.getCellSpanByPosition(e);return t?{...e,rowIndex:t.firstNode.rowIndex}:e}getCellEnd(e){const t=this.getCellSpanByPosition(e);return t?{...e,rowIndex:t.getLastNode().rowIndex}:e}getCellSpan(e,t){const n=this.spanningColumns.get(e);if(n)return n.getCellSpan(t)}forEachSpannedColumn(e,t){for(const[n,i]of this.spanningColumns)if(i.isCellSpanning(e)){const r=i.getCellSpan(e);t(n,r)}}destroy(){super.destroy(),this.spanningColumns.clear()}},Trt={moduleName:"CellSpan",version:Ce,beans:[krt,Art]},Mrt=class extends X{constructor(e,t){super(),this.cellCtrl=e,this.staticClasses=[],this.beans=t,this.column=e.column}setComp(e){this.cellComp=e,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()}applyCellClassRules(){const{column:e,cellComp:t}=this,n=e.colDef,i=n.cellClassRules,r=this.getCellClassParams(e,n);xN(this.beans.expressionSvc,i===this.cellClassRules?void 0:this.cellClassRules,i,r,s=>t.addOrRemoveCssClass(s,!0),s=>t.addOrRemoveCssClass(s,!1)),this.cellClassRules=i}applyUserStyles(){const e=this.column,t=e.colDef,n=t.cellStyle;if(!n)return;let i;if(typeof n=="function"){const r=this.getCellClassParams(e,t);i=n(r)}else i=n;i&&this.cellComp.setUserStyles(i)}applyClassesFromColDef(){const{column:e,cellComp:t}=this,n=e.colDef,i=this.getCellClassParams(e,n);this.staticClasses.forEach(s=>t.addOrRemoveCssClass(s,!1));const r=this.beans.cellStyles.getStaticCellClasses(n,i);this.staticClasses=r,r.forEach(s=>t.addOrRemoveCssClass(s,!0))}getCellClassParams(e,t){const{value:n,rowNode:i}=this.cellCtrl;return Ne(this.beans.gos,{value:n,data:i.data,node:i,colDef:t,column:e,rowIndex:i.rowIndex})}},Irt=class extends X{constructor(){super(...arguments),this.beanName="cellStyles"}processAllCellClasses(e,t,n,i){xN(this.beans.expressionSvc,void 0,e.cellClassRules,t,n,i),this.processStaticCellClasses(e,t,n)}getStaticCellClasses(e,t){const{cellClass:n}=e;if(!n)return[];let i;return typeof n=="function"?i=n(t):i=n,typeof i=="string"&&(i=[i]),i||[]}createCellCustomStyleFeature(e,t){return new Mrt(e,t)}processStaticCellClasses(e,t,n){this.getStaticCellClasses(e,t).forEach(r=>{n(r)})}},_rt={moduleName:"CellStyle",version:Ce,beans:[Irt]},Ort={moduleName:"RowStyle",version:Ce,beans:[lqe]};function Lrt(e,t){return!!e.colHover?.isHovered(t)}var Nrt=class extends X{constructor(e,t){super(),this.columns=e,this.element=t,this.destroyManagedListeners=[],this.enableFeature=n=>{const{beans:i,gos:r,element:s,columns:o}=this,a=i.colHover;n??!!r.get("columnHoverHighlight")?this.destroyManagedListeners=this.addManagedElementListeners(s,{mouseover:a.setMouseOver.bind(a,o),mouseout:a.clearMouseOver.bind(a)}):(this.destroyManagedListeners.forEach(u=>u()),this.destroyManagedListeners=[])}}postConstruct(){this.addManagedPropertyListener("columnHoverHighlight",({currentValue:e})=>{this.enableFeature(e)}),this.enableFeature()}destroy(){super.destroy(),this.destroyManagedListeners=null}},$rt="ag-column-hover",Brt=class extends X{constructor(){super(...arguments),this.beanName="colHover"}postConstruct(){this.addManagedPropertyListener("columnHoverHighlight",({currentValue:e})=>{e||this.clearMouseOver()})}setMouseOver(e){this.updateState(e)}clearMouseOver(){this.updateState(null)}isHovered(e){if(!this.gos.get("columnHoverHighlight"))return!1;const t=this.selectedColumns;return!!t&&t.indexOf(e)>=0}addHeaderColumnHoverListener(e,t,n){const i=()=>{const r=this.isHovered(n);t.addOrRemoveCssClass("ag-column-hover",r)};e.addManagedEventListeners({columnHoverChanged:i}),i()}onCellColumnHover(e,t){if(!t)return;const n=this.isHovered(e);t.addOrRemoveCssClass($rt,n)}addHeaderFilterColumnHoverListener(e,t,n,i){this.createHoverFeature(e,[n],i);const r=()=>{const s=this.isHovered(n);t.addOrRemoveCssClass("ag-column-hover",s)};e.addManagedEventListeners({columnHoverChanged:r}),r()}createHoverFeature(e,t,n){e.createManagedBean(new Nrt(t,n))}updateState(e){this.selectedColumns=e,this.eventSvc.dispatchEvent({type:"columnHoverChanged"})}},Grt={moduleName:"ColumnHover",version:Ce,beans:[Brt],apiFunctions:{isColumnHovered:Lrt}},zrt=class extends X{constructor(){super(...arguments),this.beanName="apiEventSvc",this.syncListeners=new Map,this.asyncListeners=new Map,this.syncGlobalListeners=new Set,this.globalListenerPairs=new Map}postConstruct(){this.wrapSvc=this.beans.frameworkOverrides.createGlobalEventListenerWrapper?.()}addEventListener(e,t){const n=this.wrapSvc?.wrap(t)??t,i=!gv.has(e),r=i?this.asyncListeners:this.syncListeners;r.has(e)||r.set(e,new Set),r.get(e).add(n),this.eventSvc.addEventListener(e,n,i)}removeEventListener(e,t){const n=this.wrapSvc?.unwrap(t)??t,r=!!this.asyncListeners.get(e)?.delete(n);r||this.syncListeners.get(e)?.delete(n),this.eventSvc.removeEventListener(e,n,r)}addGlobalListener(e){const t=this.wrapSvc?.wrapGlobal(e)??e,n=(s,o)=>{gv.has(s)&&t(s,o)},i=(s,o)=>{gv.has(s)||t(s,o)};this.globalListenerPairs.set(e,{syncListener:n,asyncListener:i});const r=this.eventSvc;r.addGlobalListener(n,!1),r.addGlobalListener(i,!0)}removeGlobalListener(e){const{eventSvc:t,wrapSvc:n,globalListenerPairs:i}=this,r=n?.unwrapGlobal(e)??e;if(i.has(r)){const{syncListener:o,asyncListener:a}=i.get(r);t.removeGlobalListener(o,!1),t.removeGlobalListener(a,!0),i.delete(e)}else this.syncGlobalListeners.delete(r),t.removeGlobalListener(r,!1)}destroyEventListeners(e,t){e.forEach((n,i)=>{n.forEach(r=>this.eventSvc.removeEventListener(i,r,t)),n.clear()}),e.clear()}destroyGlobalListeners(e,t){e.forEach(n=>this.eventSvc.removeGlobalListener(n,t)),e.clear()}destroy(){super.destroy(),this.destroyEventListeners(this.syncListeners,!1),this.destroyEventListeners(this.asyncListeners,!0),this.destroyGlobalListeners(this.syncGlobalListeners,!1);const{globalListenerPairs:e,eventSvc:t}=this;e.forEach(({syncListener:n,asyncListener:i})=>{t.removeGlobalListener(n,!1),t.removeGlobalListener(i,!0)}),e.clear()}};function Hrt(e,t,n){e.apiEventSvc?.addEventListener(t,n)}function Vrt(e,t,n){e.apiEventSvc?.removeEventListener(t,n)}function Wrt(e,t){e.apiEventSvc?.addGlobalListener(t)}function Urt(e,t){e.apiEventSvc?.removeGlobalListener(t)}var jrt={moduleName:"EventApi",version:Ce,apiFunctions:{addEventListener:Hrt,addGlobalListener:Wrt,removeEventListener:Vrt,removeGlobalListener:Urt},beans:[zrt]},qrt=".ag-tooltip{background-color:var(--ag-tooltip-background-color);border:var(--ag-tooltip-border);border-radius:var(--ag-border-radius);color:var(--ag-tooltip-text-color);padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);white-space:normal}.ag-tooltip,.ag-tooltip-custom{position:absolute;z-index:99999}.ag-tooltip-custom:where(:not(.ag-tooltip-interactive)),.ag-tooltip:where(:not(.ag-tooltip-interactive)){pointer-events:none}.ag-tooltip-animate{transition:opacity 1s;&:where(.ag-tooltip-hiding){opacity:0}}",Krt=class extends X{constructor(){super(...arguments),this.beanName="tooltipSvc"}setupHeaderTooltip(e,t,n,i){e&&t.destroyBean(e);const r=DD(this.gos),{column:s,eGui:o}=t,a=s.getColDef();!i&&r&&!a.headerComponent&&(i=Yw(()=>o.querySelector(".ag-header-cell-text")));const l={getColumn:()=>s,getColDef:()=>s.getColDef(),getGui:()=>o,getLocation:()=>"header",getTooltipValue:()=>n??s.getColDef().headerTooltip,shouldDisplayTooltip:i};let u=this.createTooltipFeature(l);return u&&(u=t.createBean(u),t.setRefreshFunction("tooltip",()=>u.refreshTooltip())),u}setupHeaderGroupTooltip(e,t,n,i){e&&t.destroyBean(e);const r=DD(this.gos),{column:s,eGui:o}=t,a=s.getColGroupDef();!i&&r&&!a?.headerGroupComponent&&(i=Yw(()=>o.querySelector(".ag-header-group-text")));const l={getColumn:()=>s,getGui:()=>o,getLocation:()=>"headerGroup",getTooltipValue:()=>n??(a&&a.headerTooltip),shouldDisplayTooltip:i};a&&(l.getColDef=()=>a);const u=this.createTooltipFeature(l);return u&&t.createBean(u)}enableCellTooltipFeature(e,t,n){const{column:i,rowNode:r}=e,s=()=>{const l=i.getColDef(),u=r.data;if(l.tooltipField&&me(u))return dv(u,l.tooltipField,i.isTooltipFieldContainsDots());const c=l.tooltipValueGetter;return c?c(Ne(this.gos,{location:"cell",colDef:i.getColDef(),column:i,rowIndex:e.cellPosition.rowIndex,node:r,data:r.data,value:e.value,valueFormatted:e.valueFormatted})):null},o=DD(this.gos);!n&&o&&!e.isCellRenderer()&&(n=Yw(()=>{const l=e.eGui;return l.children.length===0?l:l.querySelector(".ag-cell-value")}));const a={getColumn:()=>i,getColDef:()=>i.getColDef(),getRowIndex:()=>e.cellPosition.rowIndex,getRowNode:()=>r,getGui:()=>e.eGui,getLocation:()=>"cell",getTooltipValue:t!=null?()=>t:s,getValueFormatted:()=>e.valueFormatted,shouldDisplayTooltip:n};return this.createTooltipFeature(a,this.beans)}refreshRowTooltip(e,t,n,i){const r={getGui:()=>t.getFullWidthElement(),getTooltipValue:()=>n,getLocation:()=>"fullWidthRow",shouldDisplayTooltip:i},s=this.beans,o=s.context;e&&t.destroyBean(e,o);const a=this.createTooltipFeature(r,s);return t.createBean(a,o)}initCol(e){const{colDef:t}=e;e.tooltipEnabled=me(t.tooltipField)||me(t.tooltipValueGetter)||me(t.tooltipComponent)}createTooltipFeature(e,t){return this.beans.registry.createDynamicBean("tooltipFeature",!1,e,t)}},Yrt={moduleName:"Tooltip",version:Ce,beans:[Krt],dynamicBeans:{tooltipFeature:MKe},userComponents:{agTooltipComponent:LZe},dependsOn:[$R],css:[qrt]},Xrt={moduleName:"Locale",version:Ce,beans:[AZe]},Qrt=class extends X{constructor(){super(...arguments),this.beanName="rowAutoHeight",this.wasEverActive=!1,this._debouncedCalculateRowHeights=hi(this,this.calculateRowHeights.bind(this),1)}requestCheckAutoHeight(){this.wasEverActive&&this._debouncedCalculateRowHeights()}calculateRowHeights(){const{visibleCols:e,rowModel:t,rowSpanSvc:n,pinnedRowModel:i}=this.beans,r=e.autoHeightCols;let s=!1;const o=a=>{const l=a.__autoHeights;let u=Sp(this.beans,a).height;for(const c of r){let d=l?.[c.getColId()];const h=n?.getCellSpan(c,a);if(h){if(h.getLastNode()!==a)continue;if(d=n?.getCellSpan(c,a)?.getLastNodeAutoHeight(),!d)return}if(d==null){if(this.colSpanSkipCell(c,a))continue;return}u=Math.max(d,u)}u!==a.rowHeight&&(a.setRowHeight(u),s=!0)};i?.forEachPinnedRow?.("top",o),i?.forEachPinnedRow?.("bottom",o),t.forEachDisplayedNode?.(o),s&&t.onRowHeightChanged?.()}setRowAutoHeight(e,t,n){if(e.__autoHeights??(e.__autoHeights={}),t==null){delete e.__autoHeights[n.getId()];return}const i=e.__autoHeights[n.getId()];e.__autoHeights[n.getId()]=t,i!==t&&this.requestCheckAutoHeight()}colSpanSkipCell(e,t){const{colModel:n,colViewport:i,visibleCols:r}=this.beans;if(!n.colSpanActive)return!1;let s=[];switch(e.getPinned()){case"left":s=r.getLeftColsForRow(t);break;case"right":s=r.getRightColsForRow(t);break;case null:s=i.getColsWithinViewport(t);break}return!s.includes(e)}setupCellAutoHeight(e,t,n){if(!e.column.isAutoHeight()||!t)return!1;this.wasEverActive=!0;const i=t.parentElement,{rowNode:r,column:s}=e,o=this.beans,a=c=>{if(e.editing||!e.isAlive()||!n.isAlive())return;const{paddingTop:d,paddingBottom:h,borderBottomWidth:p,borderTopWidth:g}=bh(i),v=d+h+p+g,y=t.offsetHeight+v;if(c<5){const b=Rn(o),S=!b||!b.contains(t),x=y==0;if(S||x){window.setTimeout(()=>a(c+1),0);return}}this.setRowAutoHeight(r,y,s)},l=()=>a(0);l();const u=Pc(o,t,l);return n.addDestroyFunc(()=>{u(),this.setRowAutoHeight(r,void 0,s)}),!0}setAutoHeightActive(e){this.active=e.list.some(t=>t.isVisible()&&t.isAutoHeight())}},Jrt={moduleName:"RowAutoHeight",version:Ce,beans:[Qrt]},Zrt={moduleName:"AllCommunity",version:Ce,dependsOn:[Ynt,iit,fit,met,tnt,nnt,int,rnt,snt,ont,ant,ent,dtt,htt,ftt,ctt,gtt,mtt,Pit,Tnt,Kit,qXe,Qie,rrt,hrt,Crt,FYe,Rrt,bnt,gZe,_rt,Grt,Ort,jrt,CZe,xit,Yrt,Xrt,Jrt,EYe,Xnt,Trt]},est=Object.defineProperty,tst=(e,t,n)=>t in e?est(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,$f=(e,t,n)=>tst(e,typeof t!="symbol"?t+"":t,n);class v0{static getComponentDefinition(t,n){let i;return typeof t=="string"?i=this.searchForComponentInstance(n,t):i={extends:kp({...t})},i||wt(114,{component:t}),i.extends?(i.extends.setup&&(i.setup=i.extends.setup),i.extends.props=this.addParamsToProps(i.extends.props)):i.props=this.addParamsToProps(i.props),i}static addParamsToProps(t){return!t||Array.isArray(t)&&t.indexOf("params")===-1?t=["params",...t||[]]:typeof t=="object"&&!t.params&&(t.params={type:Object}),t}static createAndMountComponent(t,n,i,r){const s=v0.getComponentDefinition(t,i);if(!s)return;const{vNode:o,destroy:a,el:l}=this.mount(s,{params:Object.freeze(n)},i,r||{});return{componentInstance:o.component.proxy,element:l,destroy:a}}static mount(t,n,i,r){let s=Ude(t,n);s.appContext={...i.appContext,provides:r};let o=document.createElement("div");return mG(s,o),{vNode:s,destroy:()=>{o&&mG(null,o),o=null,s=null},el:o}}static searchForComponentInstance(t,n,i=10,r=!1){let s=null,o=0,a=t.parent;for(;!s&&a&&a.components&&++o<i;)a.components&&a.components[n]&&(s=a.components[n]),a=a.parent;for(o=0,a=t.parent;!s&&a&&a.$options&&++o<i;){const l=a;l.$options&&l.$options.components&&l.$options.components[n]?s=l.$options.components[n]:l[n]&&(s=l[n]),a=a.parent}for(o=0,a=t.parent;!s&&a&&++o<i;){if(a.exposed){const l=a;l.exposed&&l.exposed[n]?s=l.exposed[n]:l[n]&&(s=l[n])}a=a.parent}if(!s){const l=t.appContext.components;l&&l[n]&&(s=l[n])}return!s&&!r?(wt(114,{component:n}),null):s}}class nst extends _Ze{constructor(t,n){super(),$f(this,"parent"),$f(this,"provides"),this.parent=t,this.provides=n}createWrapper(t){const n=this;class i extends ist{init(o){super.init(o)}hasMethod(o){var a,l;const u=r.getFrameworkComponentInstance();return u[o]?!0:((a=u.$.exposed)==null?void 0:a[o])!=null||((l=u.exposed)==null?void 0:l[o])!=null||u.$.setupState[o]!=null}callMethod(o,a){var l,u;const c=this.getFrameworkComponentInstance(),d=r.getFrameworkComponentInstance();if(d[o])return d[o].apply(c,a);{const h=((l=c.$.exposed)==null?void 0:l[o])||((u=c.exposed)==null?void 0:u[o])||c.$.setupState[o];return h?.apply(c,a)}}addMethod(o,a){r[o]=a}processMethod(o,a){return o==="refresh"&&(this.getFrameworkComponentInstance().params=a[0]),this.hasMethod(o)?this.callMethod(o,a):o==="refresh"}createComponent(o){return n.createComponent(t,o)}}const r=new i;return r}createComponent(t,n){return v0.createAndMountComponent(t,n,this.parent,this.provides)}createMethodProxy(t,n,i){return function(){return t.hasMethod(n)?t.callMethod(n,arguments):(i&&ue(233,{methodName:n}),null)}}destroy(){this.parent=null}}class ist{constructor(){$f(this,"componentInstance"),$f(this,"element"),$f(this,"unmount")}getGui(){return this.element}destroy(){this.getFrameworkComponentInstance()&&typeof this.getFrameworkComponentInstance().destroy=="function"&&this.getFrameworkComponentInstance().destroy(),this.unmount()}getFrameworkComponentInstance(){return this.componentInstance}init(t){const{componentInstance:n,element:i,destroy:r}=this.createComponent(t);this.componentInstance=n,this.unmount=r,this.element=i.firstElementChild??i}}class rst extends Xne{constructor(t){super("vue"),$f(this,"parent"),this.parent=t}frameworkComponent(t,n){let i=v0.searchForComponentInstance(this.parent,t,10,!0)?t:null;if(!i&&n&&n[t]){const r=n[t];i=v0.searchForComponentInstance(this.parent,r,10,!0)?r:null}return i}isFrameworkComponent(t){return typeof t=="object"}}function sst(){return{gridOptions:{},modules:[],statusBar:void 0,sideBar:void 0,suppressContextMenu:void 0,preventDefaultOnContextMenu:void 0,allowContextMenuWithControlKey:void 0,columnMenu:void 0,suppressMenuHide:void 0,enableBrowserTooltips:void 0,tooltipTrigger:void 0,tooltipShowDelay:void 0,tooltipHideDelay:void 0,tooltipMouseTrack:void 0,tooltipShowMode:void 0,tooltipInteraction:void 0,popupParent:void 0,copyHeadersToClipboard:void 0,copyGroupHeadersToClipboard:void 0,clipboardDelimiter:void 0,suppressCopyRowsToClipboard:void 0,suppressCopySingleCellRanges:void 0,suppressLastEmptyLineOnPaste:void 0,suppressClipboardPaste:void 0,suppressClipboardApi:void 0,suppressCutToClipboard:void 0,columnDefs:void 0,defaultColDef:void 0,defaultColGroupDef:void 0,columnTypes:void 0,dataTypeDefinitions:void 0,maintainColumnOrder:void 0,enableStrictPivotColumnOrder:void 0,suppressFieldDotNotation:void 0,headerHeight:void 0,groupHeaderHeight:void 0,floatingFiltersHeight:void 0,pivotHeaderHeight:void 0,pivotGroupHeaderHeight:void 0,allowDragFromColumnsToolPanel:void 0,suppressMovableColumns:void 0,suppressColumnMoveAnimation:void 0,suppressMoveWhenColumnDragging:void 0,suppressDragLeaveHidesColumns:void 0,suppressGroupChangesColumnVisibility:void 0,suppressMakeColumnVisibleAfterUnGroup:void 0,suppressRowGroupHidesColumns:void 0,colResizeDefault:void 0,suppressAutoSize:void 0,autoSizePadding:void 0,skipHeaderOnAutoSize:void 0,autoSizeStrategy:void 0,components:void 0,editType:void 0,singleClickEdit:void 0,suppressClickEdit:void 0,readOnlyEdit:void 0,stopEditingWhenCellsLoseFocus:void 0,enterNavigatesVertically:void 0,enterNavigatesVerticallyAfterEdit:void 0,enableCellEditingOnBackspace:void 0,undoRedoCellEditing:void 0,undoRedoCellEditingLimit:void 0,defaultCsvExportParams:void 0,suppressCsvExport:void 0,defaultExcelExportParams:void 0,suppressExcelExport:void 0,excelStyles:void 0,findSearchValue:void 0,findOptions:void 0,quickFilterText:void 0,cacheQuickFilter:void 0,includeHiddenColumnsInQuickFilter:void 0,quickFilterParser:void 0,quickFilterMatcher:void 0,applyQuickFilterBeforePivotOrAgg:void 0,excludeChildrenWhenTreeDataFiltering:void 0,enableAdvancedFilter:void 0,alwaysPassFilter:void 0,includeHiddenColumnsInAdvancedFilter:void 0,advancedFilterParent:void 0,advancedFilterBuilderParams:void 0,suppressAdvancedFilterEval:void 0,suppressSetFilterByDefault:void 0,enableCharts:void 0,chartThemes:void 0,customChartThemes:void 0,chartThemeOverrides:void 0,chartToolPanelsDef:void 0,chartMenuItems:void 0,loadingCellRenderer:void 0,loadingCellRendererParams:void 0,loadingCellRendererSelector:void 0,localeText:void 0,masterDetail:void 0,keepDetailRows:void 0,keepDetailRowsCount:void 0,detailCellRenderer:void 0,detailCellRendererParams:void 0,detailRowHeight:void 0,detailRowAutoHeight:void 0,context:void 0,dragAndDropImageComponent:void 0,dragAndDropImageComponentParams:void 0,alignedGrids:void 0,tabIndex:void 0,rowBuffer:void 0,valueCache:void 0,valueCacheNeverExpires:void 0,enableCellExpressions:void 0,suppressTouch:void 0,suppressFocusAfterRefresh:void 0,suppressBrowserResizeObserver:void 0,suppressPropertyNamesCheck:void 0,suppressChangeDetection:void 0,debug:void 0,loading:void 0,overlayLoadingTemplate:void 0,loadingOverlayComponent:void 0,loadingOverlayComponentParams:void 0,suppressLoadingOverlay:void 0,overlayNoRowsTemplate:void 0,noRowsOverlayComponent:void 0,noRowsOverlayComponentParams:void 0,suppressNoRowsOverlay:void 0,pagination:void 0,paginationPageSize:void 0,paginationPageSizeSelector:void 0,paginationAutoPageSize:void 0,paginateChildRows:void 0,suppressPaginationPanel:void 0,pivotMode:void 0,pivotPanelShow:void 0,pivotMaxGeneratedColumns:void 0,pivotDefaultExpanded:void 0,pivotColumnGroupTotals:void 0,pivotRowTotals:void 0,pivotSuppressAutoColumn:void 0,suppressExpandablePivotGroups:void 0,functionsReadOnly:void 0,aggFuncs:void 0,suppressAggFuncInHeader:void 0,alwaysAggregateAtRootLevel:void 0,aggregateOnlyChangedColumns:void 0,suppressAggFilteredOnly:void 0,removePivotHeaderRowWhenSingleValueColumn:void 0,animateRows:void 0,cellFlashDuration:void 0,cellFadeDuration:void 0,allowShowChangeAfterFilter:void 0,domLayout:void 0,ensureDomOrder:void 0,enableCellSpan:void 0,enableRtl:void 0,suppressColumnVirtualisation:void 0,suppressMaxRenderedRowRestriction:void 0,suppressRowVirtualisation:void 0,rowDragManaged:void 0,suppressRowDrag:void 0,suppressMoveWhenRowDragging:void 0,rowDragEntireRow:void 0,rowDragMultiRow:void 0,rowDragText:void 0,fullWidthCellRenderer:void 0,fullWidthCellRendererParams:void 0,embedFullWidthRows:void 0,groupDisplayType:void 0,groupDefaultExpanded:void 0,autoGroupColumnDef:void 0,groupMaintainOrder:void 0,groupSelectsChildren:void 0,groupLockGroupColumns:void 0,groupAggFiltering:void 0,groupTotalRow:void 0,grandTotalRow:void 0,suppressStickyTotalRow:void 0,groupSuppressBlankHeader:void 0,groupSelectsFiltered:void 0,showOpenedGroup:void 0,groupHideParentOfSingleChild:void 0,groupRemoveSingleChildren:void 0,groupRemoveLowestSingleChildren:void 0,groupHideOpenParents:void 0,groupAllowUnbalanced:void 0,rowGroupPanelShow:void 0,groupRowRenderer:void 0,groupRowRendererParams:void 0,treeData:void 0,treeDataChildrenField:void 0,treeDataParentIdField:void 0,rowGroupPanelSuppressSort:void 0,suppressGroupRowsSticky:void 0,pinnedTopRowData:void 0,pinnedBottomRowData:void 0,rowModelType:void 0,rowData:void 0,asyncTransactionWaitMillis:void 0,suppressModelUpdateAfterUpdateTransaction:void 0,datasource:void 0,cacheOverflowSize:void 0,infiniteInitialRowCount:void 0,serverSideInitialRowCount:void 0,suppressServerSideFullWidthLoadingRow:void 0,cacheBlockSize:void 0,maxBlocksInCache:void 0,maxConcurrentDatasourceRequests:void 0,blockLoadDebounceMillis:void 0,purgeClosedRowNodes:void 0,serverSideDatasource:void 0,serverSideSortAllLevels:void 0,serverSideEnableClientSideSort:void 0,serverSideOnlyRefreshFilteredGroups:void 0,serverSidePivotResultFieldSeparator:void 0,viewportDatasource:void 0,viewportRowModelPageSize:void 0,viewportRowModelBufferSize:void 0,alwaysShowHorizontalScroll:void 0,alwaysShowVerticalScroll:void 0,debounceVerticalScrollbar:void 0,suppressHorizontalScroll:void 0,suppressScrollOnNewData:void 0,suppressScrollWhenPopupsAreOpen:void 0,suppressAnimationFrame:void 0,suppressMiddleClickScrolls:void 0,suppressPreventDefaultOnMouseWheel:void 0,scrollbarWidth:void 0,rowSelection:void 0,cellSelection:void 0,rowMultiSelectWithClick:void 0,suppressRowDeselection:void 0,suppressRowClickSelection:void 0,suppressCellFocus:void 0,suppressHeaderFocus:void 0,selectionColumnDef:void 0,rowNumbers:void 0,suppressMultiRangeSelection:void 0,enableCellTextSelection:void 0,enableRangeSelection:void 0,enableRangeHandle:void 0,enableFillHandle:void 0,fillHandleDirection:void 0,suppressClearOnFillReduction:void 0,sortingOrder:void 0,accentedSort:void 0,unSortIcon:void 0,suppressMultiSort:void 0,alwaysMultiSort:void 0,multiSortKey:void 0,suppressMaintainUnsortedOrder:void 0,icons:void 0,rowHeight:void 0,rowStyle:void 0,rowClass:void 0,rowClassRules:void 0,suppressRowHoverHighlight:void 0,suppressRowTransform:void 0,columnHoverHighlight:void 0,gridId:void 0,deltaSort:void 0,treeDataDisplayType:void 0,enableGroupEdit:void 0,initialState:void 0,theme:void 0,loadThemeGoogleFonts:void 0,themeCssLayer:void 0,styleNonce:void 0,themeStyleContainer:void 0,getContextMenuItems:void 0,getMainMenuItems:void 0,postProcessPopup:void 0,processUnpinnedColumns:void 0,processCellForClipboard:void 0,processHeaderForClipboard:void 0,processGroupHeaderForClipboard:void 0,processCellFromClipboard:void 0,sendToClipboard:void 0,processDataFromClipboard:void 0,isExternalFilterPresent:void 0,doesExternalFilterPass:void 0,getChartToolbarItems:void 0,createChartContainer:void 0,focusGridInnerElement:void 0,navigateToNextHeader:void 0,tabToNextHeader:void 0,navigateToNextCell:void 0,tabToNextCell:void 0,getLocaleText:void 0,getDocument:void 0,paginationNumberFormatter:void 0,getGroupRowAgg:void 0,isGroupOpenByDefault:void 0,initialGroupOrderComparator:void 0,processPivotResultColDef:void 0,processPivotResultColGroupDef:void 0,getDataPath:void 0,getChildCount:void 0,getServerSideGroupLevelParams:void 0,isServerSideGroupOpenByDefault:void 0,isApplyServerSideTransaction:void 0,isServerSideGroup:void 0,getServerSideGroupKey:void 0,getBusinessKeyForNode:void 0,getRowId:void 0,resetRowDataOnUpdate:void 0,processRowPostCreate:void 0,isRowSelectable:void 0,isRowMaster:void 0,fillOperation:void 0,postSortRows:void 0,getRowStyle:void 0,getRowClass:void 0,getRowHeight:void 0,isFullWidthRow:void 0,"onColumn-everything-changed":void 0,"onNew-columns-loaded":void 0,"onColumn-pivot-mode-changed":void 0,"onPivot-max-columns-exceeded":void 0,"onColumn-row-group-changed":void 0,"onExpand-or-collapse-all":void 0,"onColumn-pivot-changed":void 0,"onGrid-columns-changed":void 0,"onColumn-value-changed":void 0,"onColumn-moved":void 0,"onColumn-visible":void 0,"onColumn-pinned":void 0,"onColumn-group-opened":void 0,"onColumn-resized":void 0,"onDisplayed-columns-changed":void 0,"onVirtual-columns-changed":void 0,"onColumn-header-mouse-over":void 0,"onColumn-header-mouse-leave":void 0,"onColumn-header-clicked":void 0,"onColumn-header-context-menu":void 0,"onAsync-transactions-flushed":void 0,"onRow-group-opened":void 0,"onRow-data-updated":void 0,"onPinned-row-data-changed":void 0,"onRange-selection-changed":void 0,"onCell-selection-changed":void 0,"onChart-created":void 0,"onChart-range-selection-changed":void 0,"onChart-options-changed":void 0,"onChart-destroyed":void 0,"onTool-panel-visible-changed":void 0,"onTool-panel-size-changed":void 0,"onModel-updated":void 0,"onCut-start":void 0,"onCut-end":void 0,"onPaste-start":void 0,"onPaste-end":void 0,"onFill-start":void 0,"onFill-end":void 0,"onCell-selection-delete-start":void 0,"onCell-selection-delete-end":void 0,"onRange-delete-start":void 0,"onRange-delete-end":void 0,"onUndo-started":void 0,"onUndo-ended":void 0,"onRedo-started":void 0,"onRedo-ended":void 0,"onCell-clicked":void 0,"onCell-double-clicked":void 0,"onCell-mouse-down":void 0,"onCell-context-menu":void 0,"onCell-value-changed":void 0,"onCell-edit-request":void 0,"onRow-value-changed":void 0,"onHeader-focused":void 0,"onCell-focused":void 0,"onRow-selected":void 0,"onSelection-changed":void 0,"onTooltip-show":void 0,"onTooltip-hide":void 0,"onCell-key-down":void 0,"onCell-mouse-over":void 0,"onCell-mouse-out":void 0,"onFilter-changed":void 0,"onFilter-modified":void 0,"onFilter-opened":void 0,"onAdvanced-filter-builder-visible-changed":void 0,"onSort-changed":void 0,"onVirtual-row-removed":void 0,"onRow-clicked":void 0,"onRow-double-clicked":void 0,"onGrid-ready":void 0,"onGrid-pre-destroyed":void 0,"onGrid-size-changed":void 0,"onViewport-changed":void 0,"onFirst-data-rendered":void 0,"onDrag-started":void 0,"onDrag-stopped":void 0,"onDrag-cancelled":void 0,"onRow-editing-started":void 0,"onRow-editing-stopped":void 0,"onCell-editing-started":void 0,"onCell-editing-stopped":void 0,"onBody-scroll":void 0,"onBody-scroll-end":void 0,"onPagination-changed":void 0,"onComponent-state-changed":void 0,"onStore-refreshed":void 0,"onState-updated":void 0,"onColumn-menu-visible-changed":void 0,"onContext-menu-visible-changed":void 0,"onRow-drag-enter":void 0,"onRow-drag-move":void 0,"onRow-drag-leave":void 0,"onRow-drag-end":void 0,"onRow-drag-cancel":void 0,"onFind-changed":void 0}}const ost=(e,t)=>{let n;return()=>{const i=function(){e()};window.clearTimeout(n),n=window.setTimeout(i,t)}};function ast(e){return e&&e.constructor&&e.constructor.toString().substring(0,5)==="class"}function Cm(e){const t=n=>ast(n)?gG(n):Array.isArray(n)?n.map(i=>t(i)):jde(n)||qde(n)||Kde(n)?t(gG(n)):n;return t(e)}const lst={ref:"root"},ust=kp({__name:"AgGridVue",props:pG(Yde({gridOptions:{},modules:{},statusBar:{},sideBar:{type:[Object,String,Array,Boolean,null]},suppressContextMenu:{type:Boolean},preventDefaultOnContextMenu:{type:Boolean},allowContextMenuWithControlKey:{type:Boolean},columnMenu:{},suppressMenuHide:{type:Boolean},enableBrowserTooltips:{type:Boolean},tooltipTrigger:{},tooltipShowDelay:{},tooltipHideDelay:{},tooltipMouseTrack:{type:Boolean},tooltipShowMode:{},tooltipInteraction:{type:Boolean},popupParent:{},copyHeadersToClipboard:{type:Boolean},copyGroupHeadersToClipboard:{type:Boolean},clipboardDelimiter:{},suppressCopyRowsToClipboard:{type:Boolean},suppressCopySingleCellRanges:{type:Boolean},suppressLastEmptyLineOnPaste:{type:Boolean},suppressClipboardPaste:{type:Boolean},suppressClipboardApi:{type:Boolean},suppressCutToClipboard:{type:Boolean},columnDefs:{},defaultColDef:{},defaultColGroupDef:{},columnTypes:{},dataTypeDefinitions:{},maintainColumnOrder:{type:Boolean},enableStrictPivotColumnOrder:{type:Boolean},suppressFieldDotNotation:{type:Boolean},headerHeight:{},groupHeaderHeight:{},floatingFiltersHeight:{},pivotHeaderHeight:{},pivotGroupHeaderHeight:{},allowDragFromColumnsToolPanel:{type:Boolean},suppressMovableColumns:{type:Boolean},suppressColumnMoveAnimation:{type:Boolean},suppressMoveWhenColumnDragging:{type:Boolean},suppressDragLeaveHidesColumns:{type:Boolean},suppressGroupChangesColumnVisibility:{type:[Boolean,String]},suppressMakeColumnVisibleAfterUnGroup:{type:Boolean},suppressRowGroupHidesColumns:{type:Boolean},colResizeDefault:{},suppressAutoSize:{type:Boolean},autoSizePadding:{},skipHeaderOnAutoSize:{type:Boolean},autoSizeStrategy:{},components:{},editType:{},singleClickEdit:{type:Boolean},suppressClickEdit:{type:Boolean},readOnlyEdit:{type:Boolean},stopEditingWhenCellsLoseFocus:{type:Boolean},enterNavigatesVertically:{type:Boolean},enterNavigatesVerticallyAfterEdit:{type:Boolean},enableCellEditingOnBackspace:{type:Boolean},undoRedoCellEditing:{type:Boolean},undoRedoCellEditingLimit:{},defaultCsvExportParams:{},suppressCsvExport:{type:Boolean},defaultExcelExportParams:{},suppressExcelExport:{type:Boolean},excelStyles:{},findSearchValue:{},findOptions:{},quickFilterText:{},cacheQuickFilter:{type:Boolean},includeHiddenColumnsInQuickFilter:{type:Boolean},quickFilterParser:{type:Function},quickFilterMatcher:{type:Function},applyQuickFilterBeforePivotOrAgg:{type:Boolean},excludeChildrenWhenTreeDataFiltering:{type:Boolean},enableAdvancedFilter:{type:Boolean},alwaysPassFilter:{type:Function},includeHiddenColumnsInAdvancedFilter:{type:Boolean},advancedFilterParent:{},advancedFilterBuilderParams:{},suppressAdvancedFilterEval:{type:Boolean},suppressSetFilterByDefault:{type:Boolean},enableCharts:{type:Boolean},chartThemes:{},customChartThemes:{},chartThemeOverrides:{},chartToolPanelsDef:{},chartMenuItems:{type:[Array,Function]},loadingCellRenderer:{},loadingCellRendererParams:{},loadingCellRendererSelector:{type:Function},localeText:{},masterDetail:{type:Boolean},keepDetailRows:{type:Boolean},keepDetailRowsCount:{},detailCellRenderer:{},detailCellRendererParams:{},detailRowHeight:{},detailRowAutoHeight:{type:Boolean},context:{},dragAndDropImageComponent:{},dragAndDropImageComponentParams:{},alignedGrids:{type:[Array,Function]},tabIndex:{},rowBuffer:{},valueCache:{type:Boolean},valueCacheNeverExpires:{type:Boolean},enableCellExpressions:{type:Boolean},suppressTouch:{type:Boolean},suppressFocusAfterRefresh:{type:Boolean},suppressBrowserResizeObserver:{type:Boolean},suppressPropertyNamesCheck:{type:Boolean},suppressChangeDetection:{type:Boolean},debug:{type:Boolean},loading:{type:Boolean},overlayLoadingTemplate:{},loadingOverlayComponent:{},loadingOverlayComponentParams:{},suppressLoadingOverlay:{type:Boolean},overlayNoRowsTemplate:{},noRowsOverlayComponent:{},noRowsOverlayComponentParams:{},suppressNoRowsOverlay:{type:Boolean},pagination:{type:Boolean},paginationPageSize:{},paginationPageSizeSelector:{type:[Array,Boolean]},paginationAutoPageSize:{type:Boolean},paginateChildRows:{type:Boolean},suppressPaginationPanel:{type:Boolean},pivotMode:{type:Boolean},pivotPanelShow:{},pivotMaxGeneratedColumns:{},pivotDefaultExpanded:{},pivotColumnGroupTotals:{},pivotRowTotals:{},pivotSuppressAutoColumn:{type:Boolean},suppressExpandablePivotGroups:{type:Boolean},functionsReadOnly:{type:Boolean},aggFuncs:{},suppressAggFuncInHeader:{type:Boolean},alwaysAggregateAtRootLevel:{type:Boolean},aggregateOnlyChangedColumns:{type:Boolean},suppressAggFilteredOnly:{type:Boolean},removePivotHeaderRowWhenSingleValueColumn:{type:Boolean},animateRows:{type:Boolean},cellFlashDuration:{},cellFadeDuration:{},allowShowChangeAfterFilter:{type:Boolean},domLayout:{},ensureDomOrder:{type:Boolean},enableCellSpan:{type:Boolean},enableRtl:{type:Boolean},suppressColumnVirtualisation:{type:Boolean},suppressMaxRenderedRowRestriction:{type:Boolean},suppressRowVirtualisation:{type:Boolean},rowDragManaged:{type:Boolean},suppressRowDrag:{type:Boolean},suppressMoveWhenRowDragging:{type:Boolean},rowDragEntireRow:{type:Boolean},rowDragMultiRow:{type:Boolean},rowDragText:{type:Function},fullWidthCellRenderer:{},fullWidthCellRendererParams:{},embedFullWidthRows:{type:Boolean},groupDisplayType:{},groupDefaultExpanded:{},autoGroupColumnDef:{},groupMaintainOrder:{type:Boolean},groupSelectsChildren:{type:Boolean},groupLockGroupColumns:{},groupAggFiltering:{type:[Boolean,Function]},groupTotalRow:{type:[String,Function]},grandTotalRow:{},suppressStickyTotalRow:{type:[Boolean,String]},groupSuppressBlankHeader:{type:Boolean},groupSelectsFiltered:{type:Boolean},showOpenedGroup:{type:Boolean},groupHideParentOfSingleChild:{type:[Boolean,String]},groupRemoveSingleChildren:{type:Boolean},groupRemoveLowestSingleChildren:{type:Boolean},groupHideOpenParents:{type:Boolean},groupAllowUnbalanced:{type:Boolean},rowGroupPanelShow:{},groupRowRenderer:{},groupRowRendererParams:{},treeData:{type:Boolean},treeDataChildrenField:{},treeDataParentIdField:{},rowGroupPanelSuppressSort:{type:Boolean},suppressGroupRowsSticky:{type:Boolean},pinnedTopRowData:{},pinnedBottomRowData:{},rowModelType:{},rowData:{},asyncTransactionWaitMillis:{},suppressModelUpdateAfterUpdateTransaction:{type:Boolean},datasource:{},cacheOverflowSize:{},infiniteInitialRowCount:{},serverSideInitialRowCount:{},suppressServerSideFullWidthLoadingRow:{type:Boolean},cacheBlockSize:{},maxBlocksInCache:{},maxConcurrentDatasourceRequests:{},blockLoadDebounceMillis:{},purgeClosedRowNodes:{type:Boolean},serverSideDatasource:{},serverSideSortAllLevels:{type:Boolean},serverSideEnableClientSideSort:{type:Boolean},serverSideOnlyRefreshFilteredGroups:{type:Boolean},serverSidePivotResultFieldSeparator:{},viewportDatasource:{},viewportRowModelPageSize:{},viewportRowModelBufferSize:{},alwaysShowHorizontalScroll:{type:Boolean},alwaysShowVerticalScroll:{type:Boolean},debounceVerticalScrollbar:{type:Boolean},suppressHorizontalScroll:{type:Boolean},suppressScrollOnNewData:{type:Boolean},suppressScrollWhenPopupsAreOpen:{type:Boolean},suppressAnimationFrame:{type:Boolean},suppressMiddleClickScrolls:{type:Boolean},suppressPreventDefaultOnMouseWheel:{type:Boolean},scrollbarWidth:{},rowSelection:{},cellSelection:{type:[Boolean,Object]},rowMultiSelectWithClick:{type:Boolean},suppressRowDeselection:{type:Boolean},suppressRowClickSelection:{type:Boolean},suppressCellFocus:{type:Boolean},suppressHeaderFocus:{type:Boolean},selectionColumnDef:{},rowNumbers:{type:[Boolean,Object]},suppressMultiRangeSelection:{type:Boolean},enableCellTextSelection:{type:Boolean},enableRangeSelection:{type:Boolean},enableRangeHandle:{type:Boolean},enableFillHandle:{type:Boolean},fillHandleDirection:{},suppressClearOnFillReduction:{type:Boolean},sortingOrder:{},accentedSort:{type:Boolean},unSortIcon:{type:Boolean},suppressMultiSort:{type:Boolean},alwaysMultiSort:{type:Boolean},multiSortKey:{},suppressMaintainUnsortedOrder:{type:Boolean},icons:{},rowHeight:{},rowStyle:{},rowClass:{},rowClassRules:{},suppressRowHoverHighlight:{type:Boolean},suppressRowTransform:{type:Boolean},columnHoverHighlight:{type:Boolean},gridId:{},deltaSort:{type:Boolean},treeDataDisplayType:{},enableGroupEdit:{type:Boolean},initialState:{},theme:{},loadThemeGoogleFonts:{type:Boolean},themeCssLayer:{},styleNonce:{},themeStyleContainer:{},getContextMenuItems:{type:Function},getMainMenuItems:{type:Function},postProcessPopup:{type:Function},processUnpinnedColumns:{type:Function},processCellForClipboard:{type:Function},processHeaderForClipboard:{type:Function},processGroupHeaderForClipboard:{type:Function},processCellFromClipboard:{type:Function},sendToClipboard:{type:Function},processDataFromClipboard:{type:Function},isExternalFilterPresent:{type:Function},doesExternalFilterPass:{type:Function},getChartToolbarItems:{type:Function},createChartContainer:{type:Function},focusGridInnerElement:{type:Function},navigateToNextHeader:{type:Function},tabToNextHeader:{type:Function},navigateToNextCell:{type:Function},tabToNextCell:{type:Function},getLocaleText:{type:Function},getDocument:{type:Function},paginationNumberFormatter:{type:Function},getGroupRowAgg:{type:Function},isGroupOpenByDefault:{type:Function},initialGroupOrderComparator:{type:Function},processPivotResultColDef:{type:Function},processPivotResultColGroupDef:{type:Function},getDataPath:{type:Function},getChildCount:{type:Function},getServerSideGroupLevelParams:{type:Function},isServerSideGroupOpenByDefault:{type:Function},isApplyServerSideTransaction:{type:Function},isServerSideGroup:{type:Function},getServerSideGroupKey:{type:Function},getBusinessKeyForNode:{type:Function},getRowId:{type:Function},resetRowDataOnUpdate:{type:Boolean},processRowPostCreate:{type:Function},isRowSelectable:{type:Function},isRowMaster:{type:Function},fillOperation:{type:Function},postSortRows:{type:Function},getRowStyle:{type:Function},getRowClass:{type:Function},getRowHeight:{type:Function},isFullWidthRow:{type:Function},"onTool-panel-visible-changed":{},"onTool-panel-size-changed":{},"onColumn-menu-visible-changed":{},"onContext-menu-visible-changed":{},"onCut-start":{},"onCut-end":{},"onPaste-start":{},"onPaste-end":{},"onColumn-visible":{},"onColumn-pinned":{},"onColumn-resized":{},"onColumn-moved":{},"onColumn-value-changed":{},"onColumn-pivot-mode-changed":{},"onColumn-pivot-changed":{},"onColumn-group-opened":{},"onNew-columns-loaded":{},"onGrid-columns-changed":{},"onDisplayed-columns-changed":{},"onVirtual-columns-changed":{},"onColumn-everything-changed":{},"onColumn-header-mouse-over":{},"onColumn-header-mouse-leave":{},"onColumn-header-clicked":{},"onColumn-header-context-menu":{},"onComponent-state-changed":{},"onCell-value-changed":{},"onCell-edit-request":{},"onRow-value-changed":{},"onCell-editing-started":{},"onCell-editing-stopped":{},"onRow-editing-started":{},"onRow-editing-stopped":{},"onUndo-started":{},"onUndo-ended":{},"onRedo-started":{},"onRedo-ended":{},"onCell-selection-delete-start":{},"onCell-selection-delete-end":{},"onRange-delete-start":{},"onRange-delete-end":{},"onFill-start":{},"onFill-end":{},"onFilter-opened":{},"onFilter-changed":{},"onFilter-modified":{},"onAdvanced-filter-builder-visible-changed":{},"onFind-changed":{},"onChart-created":{},"onChart-range-selection-changed":{},"onChart-options-changed":{},"onChart-destroyed":{},"onCell-key-down":{},"onGrid-ready":{},"onGrid-pre-destroyed":{},"onFirst-data-rendered":{},"onGrid-size-changed":{},"onModel-updated":{},"onVirtual-row-removed":{},"onViewport-changed":{},"onBody-scroll":{},"onBody-scroll-end":{},"onDrag-started":{},"onDrag-stopped":{},"onDrag-cancelled":{},"onState-updated":{},"onPagination-changed":{},"onRow-drag-enter":{},"onRow-drag-move":{},"onRow-drag-leave":{},"onRow-drag-end":{},"onRow-drag-cancel":{},"onColumn-row-group-changed":{},"onRow-group-opened":{},"onExpand-or-collapse-all":{},"onPivot-max-columns-exceeded":{},"onPinned-row-data-changed":{},"onRow-data-updated":{},"onAsync-transactions-flushed":{},"onStore-refreshed":{},"onHeader-focused":{},"onCell-clicked":{},"onCell-double-clicked":{},"onCell-focused":{},"onCell-mouse-over":{},"onCell-mouse-out":{},"onCell-mouse-down":{},"onRow-clicked":{},"onRow-double-clicked":{},"onRow-selected":{},"onSelection-changed":{},"onCell-context-menu":{},"onRange-selection-changed":{},"onCell-selection-changed":{},"onTooltip-show":{},"onTooltip-hide":{},"onSort-changed":{}},sst()),{modelValue:{},modelModifiers:{}}),emits:pG(["update:modelValue"],["update:modelValue"]),setup(e,{expose:t,emit:n}){const i=e,r=Gde("root"),s=pn(void 0),o=pn(!1),a=pn(!1),l=pn(!1),u=pn({}),c=pn(null),d=zde(i);WT.filter(P=>P!="gridOptions").forEach(P=>{yv(()=>d[P],(_,O)=>{(P==="rowData"&&!v.value||P!=="rowData")&&F(P,_),v.value=!1},{deep:!0})});const h=new Set(["rowDataUpdated","cellValueChanged","rowValueChanged"]),p=Hde(e,"modelValue"),g=pn(!1),v=pn(!1),C=n;yv(p,(P,_)=>{o.value&&(v.value||(g.value=!0,F("rowData",Cm(P),Cm(_))),v.value=!1)},{deep:!0});const y=ost(()=>{v.value=!0,C("update:modelValue",E())},10),b=hy(),S=P=>{var _,O;l.value&&h.has(P)&&(O=(_=b?.vnode)==null?void 0:_.props)!=null&&O["onUpdate:modelValue"]&&y()},x=()=>p.value||i.rowData||i.gridOptions.rowData,E=()=>{const P=[];return s?.value.forEachLeafNode(_=>{P.push(_.data)}),P},A=P=>_=>{if(a.value)return;_==="gridReady"&&(l.value=!0);const O=gv.has(_);O&&!P||!O&&P||h.has(_)&&(g.value||S(_),g.value=!1)},F=(P,_,O)=>{if(o.value){let H=_.value||_;P==="rowData"&&H!=null&&(H=Cm(H)),u.value[P]=H,c.value==null&&(c.value=window.setTimeout(()=>{c.value=null,V9e(u.value,s.value),u.value={}},0))}},k=()=>Object.create(hy().provides);return KT(()=>{yne.registerModules([Qie]);const P=new nst(hy(),k()),_={globalListener:A(),globalSyncListener:A(!0),frameworkOverrides:new rst(hy()),providedBeanInstances:{frameworkCompWrapper:P},modules:i.modules},O=Vde(H9e(Cm(i.gridOptions),i,[...WT,...Sie.map(W=>gN(W))])),H=x();H!==void 0&&(O.rowData=Cm(H)),s.value=SZe(r.value,O,_),o.value=!0}),Wde(()=>{var P;o.value&&((P=s?.value)==null||P.destroy(),a.value=!0)}),t({api:s}),(P,_)=>(jn(),Wi("div",lst,null,512))}}),cst=kp({__name:"TableComponent",props:{spec:{},data:{}},setup(e,{expose:t}){t({UDICellRenderer:KUe}),yne.registerModules([Zrt]);const n=e,i=mu(()=>{if(!n.spec||n.spec.representation.length===0)return null;for(const d of n.spec.representation)if(d.mark!=="row")throw new Error("The representation must be a row layer in the table component for every layer");return n.spec.representation}),r=mu(()=>n.data?n.data.length===0?[]:Object.keys(n.data[0]??[]):[]),s=mu(()=>{if(!i.value)return[];const d=[];for(const h of i.value){const p=[];if(!h.mapping)throw new Error("Mapping is required for the table component");let g=PS.cloneDeep(h.mapping);Array.isArray(g)||(g=[g]);for(const v of g)if(v.field==="*")for(const C of r.value)p.push({...v,field:C,column:C});else v.column||(v.column=v.field),p.push(v);d.push(p)}return d}),o=mu(()=>{if(s.value.length===0)return[];const d=[];for(let h=0;h<s.value.length;h++){const p=s.value[h];for(const g of p)d.push({layer:h.toString(),...g})}return d});function a(d,h){let p=h;if(typeof h=="string"&&(p=[h]),p.length===0)throw new Error("Field list is empty");let g=1/0,v=-1/0;for(const C of p)for(const y of d){const b=y[C];if(b==null)continue;let S=0;typeof b!="number"?(S=+b,console.warn(`Value for field ${C} is not a number: ${b}. Converting to number.`)):S=b,S<g&&(g=S),S>v&&(v=S)}return{min:g,max:v}}function l(d,h){let p=h;if(typeof h=="string"&&(p=[h]),p.length===0)throw new Error("Field list is empty");const g=new Set;for(const v of p){const C=d.filter(y=>y[v]!==null&&typeof y[v]<"u").map(y=>y[v]);for(const y of C)g.add(y)}return Array.from(g)}const u=mu(()=>{const d=new Map;if(!o.value||!n.data)return d;for(const h of o.value){const p=h.field,g=h.type,v=V6(h);if(!d.has(v)){if(h.domain){if("numberFields"in h.domain){const C=a(n.data,h.domain.numberFields);d.set(v,C);continue}else if("categoryFields"in h.domain){const C=l(n.data,h.domain.categoryFields);d.set(v,C);continue}else if(d.set(v,h.domain),Array.isArray(h.domain)||"min"in h.domain&&"max"in h.domain)continue}if(g==="quantitative"){const C=a(n.data,p),y=d.get(v)??{};d.set(v,{...C,...y})}else if(g==="nominal"||g==="ordinal"){const C=l(n.data,p);d.set(v,C)}}}return d}),c=mu(()=>{if(o.value.length===0)return[];const d=o.value.map(g=>{const v=V6(g);if(u.value.has(v)){const C=u.value.get(v);return{...g,domain:C}}throw new Error(`Domain not found for mapping ${JSON.stringify(g)}`)}),h=Object.groupBy(d,g=>g.column);return[...Object.keys(h).map(g=>({headerName:g,field:g,cellRenderer:"UDICellRenderer",cellRendererParams:{udiColumnMapping:h[g]},valueGetter:v=>{const C=h[g];if(!C||C.length===0)return null;const y=C[0]?.orderby??C[0]?.field??null;return y?v.data[y]:null}}))]});return(d,h)=>(jn(),HD(NW(ust),{rowData:n.data,columnDefs:c.value,style:{height:"500px"},rowHeight:20},null,8,["rowData","columnDefs"]))}});function dst(e){let{source:t,representation:n}=e;const{transformation:i}=e;return Array.isArray(t)||(t=[t]),n||(n={mark:"row",mapping:[{mark:"text",encoding:"text",field:"*",type:"nominal"}]}),Array.isArray(n)||(n=[n]),i?{source:t,transformation:i,representation:n}:{source:t,representation:n}}const hst={key:0,class:"error-message"},fst={key:1},pst=kp({__name:"UDIVis",props:{spec:{}},setup(e){const t=Cte(),{loading:n,selectionHash:i}=Xde(t),r=e,s=pn(null),o=pn(!1),a=pn("");KT(()=>{l()});async function l(){s.value=dst(r.spec),await t.initDataSources(s.value.source),u()}yv(()=>r.spec,()=>{l()}),yv([n,i],()=>u());function u(){s.value&&(p(s.value),h.value!=null&&(c(s.value)?(a.value=g(s.value),o.value=!0):o.value=!1))}function c(y){return!y.representation.map(b=>b.mark).includes("row")}const d=pn(),h=pn(null);function p(y){h.value=null;try{d.value=null,h.value=t.getDataObject(y.source.map(b=>b.name),y.transformation)}catch(b){console.error("Failed to complete data transformation",b),d.value=b}}function g(y){const b={$schema:"https://vega.github.io/schema/vega-lite/v5.json",width:"container",data:{name:"udi_data",values:[]}};try{d.value=null,b.data.values=h.value}catch(E){console.error("Failed to complete data transformation",E),d.value=E}C.value=b.data.values;const S=y.representation;if(!Array.isArray(S))throw new Error("invalid spec passed to vega conversion");const x=S.map(E=>{const A=Array.isArray(E.mapping)?E.mapping:[E.mapping],F={};for(const _ of A){const{encoding:O}=_;if("value"in _)F[O]={value:_.value};else{const H=_.field.replace(/\./g,"\\.");F[O]={field:H,type:_.type}}(O==="x"||O==="y"||O==="size")&&(F[O].scale==null&&(F[O].scale={}),F[O].scale.zero=!1),E.mark==="area"&&O==="y"&&(F[O].stack=!1),"domain"in _&&(F[O].scale==null&&(F[O].scale={}),F[O].scale.domain=_.domain),"range"in _&&(F[O].scale==null&&(F[O].scale={}),F[O].scale.range=_.range),"omitLegend"in _&&_.omitLegend&&(F[O].legend=null)}let k=null;E.select&&(k={name:E.select.name,select:{type:E.select.how.type}},E.select.how.type==="interval"&&(k.select.encodings=E.select.how.on.split("")),t.watchDataSelection("donors",E.select.name),v.value=[E.select.name]);const P={mark:E.mark,encoding:F};return k&&(P.params=[k]),P});return b.layer=x,JSON.stringify(b)}const v=pn([]),C=pn();return(y,b)=>NW(t).loading?(jn(),Wi("p",fst,"Loading...")):(jn(),Wi(Xw,{key:0},[d.value?(jn(),Wi("div",hst,YT(d.value.message),1)):o.value?(jn(),HD(WUe,{key:1,spec:a.value,"signal-keys":v.value},null,8,["spec","signal-keys"])):(jn(),HD(cst,{key:2,data:h.value,spec:s.value},null,8,["data","spec"]))],64))}}),oot=XT(pst,[["__scopeId","data-v-075b9c8a"]]);export{oot as U};
