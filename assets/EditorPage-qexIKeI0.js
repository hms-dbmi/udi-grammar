var Zne=Object.defineProperty;var eie=(e,t,n)=>t in e?Zne(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var lf=(e,t,n)=>eie(e,typeof t!="symbol"?t+"":t,n);import{P as tie,Q as nie,R as F_,S as Dd,U as M_,v as iie,V as Tm,W as BE,X as rR,Y as N_,Z as rie,m as sie,q as aie,g as oie,r as dr,c as ao,w as Zp,h as Om,n as uie,d as jv,a as RL,L as Yf,N as IL,J as lie,$ as cie,O as DL,H as ca,a0 as fie,a1 as hie,a2 as die,E as Z1,a3 as pie,s as gie,F as R_,I as sR,G as mie}from"./index-GNPbUQmn.js";import{u as yie,a as vie,l as xie}from"./lz-string-Pi-BvCXY.js";import{a as I_,c as bie,h as _ie}from"./render-mL9T_Cwh.js";import{Q as wie}from"./QPage-Ca21cJXF.js";import{_ as PL}from"./_plugin-vue_export-helper-DlAUqK2U.js";var Fm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};const mC={left:!0,right:!0,up:!0,down:!0,horizontal:!0,vertical:!0},Eie=Object.keys(mC);mC.all=!0;function aR(e){const t={};for(const n of Eie)e[n]===!0&&(t[n]=!0);return Object.keys(t).length===0?mC:(t.horizontal===!0?t.left=t.right=!0:t.left===!0&&t.right===!0&&(t.horizontal=!0),t.vertical===!0?t.up=t.down=!0:t.up===!0&&t.down===!0&&(t.vertical=!0),t.horizontal===!0&&t.vertical===!0&&(t.all=!0),t)}const Sie=["INPUT","TEXTAREA"];function oR(e,t){return t.event===void 0&&e.target!==void 0&&e.target.draggable!==!0&&typeof t.handler=="function"&&Sie.includes(e.target.nodeName.toUpperCase())===!1&&(e.qClonedBy===void 0||e.qClonedBy.indexOf(t.uid)===-1)}function Aie(){if(window.getSelection!==void 0){const e=window.getSelection();e.empty!==void 0?e.empty():e.removeAllRanges!==void 0&&(e.removeAllRanges(),tie.is.mobile!==!0&&e.addRange(document.createRange()))}else document.selection!==void 0&&document.selection.empty()}function D_(e,t,n){const i=BE(e);let r,s=i.left-t.event.x,a=i.top-t.event.y,o=Math.abs(s),u=Math.abs(a);const l=t.direction;l.horizontal===!0&&l.vertical!==!0?r=s<0?"left":"right":l.horizontal!==!0&&l.vertical===!0?r=a<0?"up":"down":l.up===!0&&a<0?(r="up",o>u&&(l.left===!0&&s<0?r="left":l.right===!0&&s>0&&(r="right"))):l.down===!0&&a>0?(r="down",o>u&&(l.left===!0&&s<0?r="left":l.right===!0&&s>0&&(r="right"))):l.left===!0&&s<0?(r="left",o<u&&(l.up===!0&&a<0?r="up":l.down===!0&&a>0&&(r="down"))):l.right===!0&&s>0&&(r="right",o<u&&(l.up===!0&&a<0?r="up":l.down===!0&&a>0&&(r="down")));let c=!1;if(r===void 0&&n===!1){if(t.event.isFirst===!0||t.event.lastDir===void 0)return{};r=t.event.lastDir,c=!0,r==="left"||r==="right"?(i.left-=s,o=0,s=0):(i.top-=a,u=0,a=0)}return{synthetic:c,payload:{evt:e,touch:t.event.mouse!==!0,mouse:t.event.mouse===!0,position:i,direction:r,isFirst:t.event.isFirst,isFinal:n===!0,duration:Date.now()-t.event.time,distance:{x:o,y:u},offset:{x:s,y:a},delta:{x:i.left-t.event.lastX,y:i.top-t.event.lastY}}}}let Cie=0;const kie=nie({name:"touch-pan",beforeMount(e,{value:t,modifiers:n}){if(n.mouse!==!0&&Dd.has.touch!==!0)return;function i(s,a){n.mouse===!0&&a===!0?sie(s):(n.stop===!0&&N_(s),n.prevent===!0&&rR(s))}const r={uid:"qvtp_"+Cie++,handler:t,modifiers:n,direction:aR(n),noop:iie,mouseStart(s){oR(s,r)&&rie(s)&&(Tm(r,"temp",[[document,"mousemove","move","notPassiveCapture"],[document,"mouseup","end","passiveCapture"]]),r.start(s,!0))},touchStart(s){if(oR(s,r)){const a=s.target;Tm(r,"temp",[[a,"touchmove","move","notPassiveCapture"],[a,"touchcancel","end","passiveCapture"],[a,"touchend","end","passiveCapture"]]),r.start(s)}},start(s,a){if(Dd.is.firefox===!0&&M_(e,!0),r.lastEvt=s,a===!0||n.stop===!0){if(r.direction.all!==!0&&(a!==!0||r.modifiers.mouseAllDir!==!0&&r.modifiers.mousealldir!==!0)){const l=s.type.indexOf("mouse")!==-1?new MouseEvent(s.type,s):new TouchEvent(s.type,s);s.defaultPrevented===!0&&rR(l),s.cancelBubble===!0&&N_(l),Object.assign(l,{qKeyEvent:s.qKeyEvent,qClickOutside:s.qClickOutside,qAnchorHandled:s.qAnchorHandled,qClonedBy:s.qClonedBy===void 0?[r.uid]:s.qClonedBy.concat(r.uid)}),r.initialEvent={target:s.target,event:l}}N_(s)}const{left:o,top:u}=BE(s);r.event={x:o,y:u,time:Date.now(),mouse:a===!0,detected:!1,isFirst:!0,isFinal:!1,lastX:o,lastY:u}},move(s){if(r.event===void 0)return;const a=BE(s),o=a.left-r.event.x,u=a.top-r.event.y;if(o===0&&u===0)return;r.lastEvt=s;const l=r.event.mouse===!0,c=()=>{i(s,l);let p;n.preserveCursor!==!0&&n.preservecursor!==!0&&(p=document.documentElement.style.cursor||"",document.documentElement.style.cursor="grabbing"),l===!0&&document.body.classList.add("no-pointer-events--children"),document.body.classList.add("non-selectable"),Aie(),r.styleCleanup=m=>{if(r.styleCleanup=void 0,p!==void 0&&(document.documentElement.style.cursor=p),document.body.classList.remove("non-selectable"),l===!0){const y=()=>{document.body.classList.remove("no-pointer-events--children")};m!==void 0?setTimeout(()=>{y(),m()},50):y()}else m!==void 0&&m()}};if(r.event.detected===!0){r.event.isFirst!==!0&&i(s,r.event.mouse);const{payload:p,synthetic:m}=D_(s,r,!1);p!==void 0&&(r.handler(p)===!1?r.end(s):(r.styleCleanup===void 0&&r.event.isFirst===!0&&c(),r.event.lastX=p.position.left,r.event.lastY=p.position.top,r.event.lastDir=m===!0?void 0:p.direction,r.event.isFirst=!1));return}if(r.direction.all===!0||l===!0&&(r.modifiers.mouseAllDir===!0||r.modifiers.mousealldir===!0)){c(),r.event.detected=!0,r.move(s);return}const f=Math.abs(o),d=Math.abs(u);f!==d&&(r.direction.horizontal===!0&&f>d||r.direction.vertical===!0&&f<d||r.direction.up===!0&&f<d&&u<0||r.direction.down===!0&&f<d&&u>0||r.direction.left===!0&&f>d&&o<0||r.direction.right===!0&&f>d&&o>0?(r.event.detected=!0,r.move(s)):r.end(s,!0))},end(s,a){if(r.event!==void 0){if(F_(r,"temp"),Dd.is.firefox===!0&&M_(e,!1),a===!0)r.styleCleanup!==void 0&&r.styleCleanup(),r.event.detected!==!0&&r.initialEvent!==void 0&&r.initialEvent.target.dispatchEvent(r.initialEvent.event);else if(r.event.detected===!0){r.event.isFirst===!0&&r.handler(D_(s===void 0?r.lastEvt:s,r).payload);const{payload:o}=D_(s===void 0?r.lastEvt:s,r,!0),u=()=>{r.handler(o)};r.styleCleanup!==void 0?r.styleCleanup(u):u()}r.event=void 0,r.initialEvent=void 0,r.lastEvt=void 0}}};if(e.__qtouchpan=r,n.mouse===!0){const s=n.mouseCapture===!0||n.mousecapture===!0?"Capture":"";Tm(r,"main",[[e,"mousedown","mouseStart",`passive${s}`]])}Dd.has.touch===!0&&Tm(r,"main",[[e,"touchstart","touchStart",`passive${n.capture===!0?"Capture":""}`],[e,"touchmove","noop","notPassiveCapture"]])},updated(e,t){const n=e.__qtouchpan;n!==void 0&&(t.oldValue!==t.value&&(typeof value!="function"&&n.end(),n.handler=t.value),n.direction=aR(t.modifiers))},beforeUnmount(e){const t=e.__qtouchpan;t!==void 0&&(t.event!==void 0&&t.end(),F_(t,"main"),F_(t,"temp"),Dd.is.firefox===!0&&M_(e,!1),t.styleCleanup!==void 0&&t.styleCleanup(),delete e.__qtouchpan)}}),$ie=aie({name:"QSplitter",props:{...yie,modelValue:{type:Number,required:!0},reverse:Boolean,unit:{type:String,default:"%",validator:e=>["%","px"].includes(e)},limits:{type:Array,validator:e=>e.length!==2||typeof e[0]!="number"||typeof e[1]!="number"?!1:e[0]>=0&&e[0]<=e[1]},emitImmediately:Boolean,horizontal:Boolean,disable:Boolean,beforeClass:[Array,String,Object],afterClass:[Array,String,Object],separatorClass:[Array,String,Object],separatorStyle:[Array,String,Object]},emits:["update:modelValue"],setup(e,{slots:t,emit:n}){const{proxy:{$q:i}}=oie(),r=vie(e,i),s=dr(null),a={before:dr(null),after:dr(null)},o=ao(()=>`q-splitter no-wrap ${e.horizontal===!0?"q-splitter--horizontal column":"q-splitter--vertical row"} q-splitter--${e.disable===!0?"disabled":"workable"}`+(r.value===!0?" q-splitter--dark":"")),u=ao(()=>e.horizontal===!0?"height":"width"),l=ao(()=>e.reverse!==!0?"before":"after"),c=ao(()=>e.limits!==void 0?e.limits:e.unit==="%"?[10,90]:[50,1/0]);function f(A){return(e.unit==="%"?A:Math.round(A))+e.unit}const d=ao(()=>({[l.value]:{[u.value]:f(e.modelValue)}}));let p,m,y,v,b;function _(A){if(A.isFirst===!0){const C=s.value.getBoundingClientRect()[u.value];p=e.horizontal===!0?"up":"left",m=e.unit==="%"?100:C,y=Math.min(m,c.value[1],Math.max(c.value[0],e.modelValue)),v=(e.reverse!==!0?1:-1)*(e.horizontal===!0?1:i.lang.rtl===!0?-1:1)*(e.unit==="%"?C===0?0:100/C:1),s.value.classList.add("q-splitter--active");return}if(A.isFinal===!0){b!==e.modelValue&&n("update:modelValue",b),s.value.classList.remove("q-splitter--active");return}const $=y+v*(A.direction===p?-1:1)*A.distance[e.horizontal===!0?"y":"x"];b=Math.min(m,c.value[1],Math.max(c.value[0],$)),a[l.value].value.style[u.value]=f(b),e.emitImmediately===!0&&e.modelValue!==b&&n("update:modelValue",b)}const E=ao(()=>[[kie,_,void 0,{[e.horizontal===!0?"vertical":"horizontal"]:!0,prevent:!0,stop:!0,mouse:!0,mouseAllDir:!0}]]);function S(A,$){A<$[0]?n("update:modelValue",$[0]):A>$[1]&&n("update:modelValue",$[1])}return Zp(()=>e.modelValue,A=>{S(A,c.value)}),Zp(()=>e.limits,()=>{uie(()=>{S(e.modelValue,c.value)})}),()=>{const A=[Om("div",{ref:a.before,class:["q-splitter__panel q-splitter__before"+(e.reverse===!0?" col":""),e.beforeClass],style:d.value.before},I_(t.before)),Om("div",{class:["q-splitter__separator",e.separatorClass],style:e.separatorStyle,"aria-disabled":e.disable===!0?"true":void 0},[bie("div",{class:"q-splitter__separator-area absolute-full"},I_(t.separator),"sep",e.disable!==!0,()=>E.value)]),Om("div",{ref:a.after,class:["q-splitter__panel q-splitter__after"+(e.reverse===!0?"":" col"),e.afterClass],style:d.value.after},I_(t.after))];return Om("div",{class:o.value,ref:s},_ie(t.default,A))}}}),Tie=/("(?:[^\\"]|\\.)*")|[:,]/g;function P_(e,t={}){const n=JSON.stringify([1],void 0,t.indent===void 0?2:t.indent).slice(2,-3),i=n===""?1/0:t.maxLength===void 0?80:t.maxLength;let{replacer:r}=t;return function s(a,o,u){a&&typeof a.toJSON=="function"&&(a=a.toJSON());const l=JSON.stringify(a,r);if(l===void 0)return l;const c=i-o.length-u;if(l.length<=c){const f=l.replace(Tie,(d,p)=>p||`${d} `);if(f.length<=c)return f}if(r!=null&&(a=JSON.parse(l),r=void 0),typeof a=="object"&&a!==null){const f=o+n,d=[];let p=0,m,y;if(Array.isArray(a)){m="[",y="]";const{length:v}=a;for(;p<v;p++)d.push(s(a[p],f,p===v-1?0:1)||"null")}else{m="{",y="}";const v=Object.keys(a),{length:b}=v;for(;p<b;p++){const _=v[p],E=`${JSON.stringify(_)}: `,S=s(a[_],f,E.length+(p===b-1?0:1));S!==void 0&&d.push(E+S)}}if(d.length>0)return[m,n+d.join(`,
${f}`),y].join(`
${o}`)}return l}(e,"",0)}function tr(e,t,n){return e.fields=t||[],e.fname=n,e}function en(e){return e==null?null:e.fname}function ui(e){return e==null?null:e.fields}function LL(e){return e.length===1?Oie(e[0]):Fie(e)}const Oie=e=>function(t){return t[e]},Fie=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function K(e){throw Error(e)}function Ta(e){const t=[],n=e.length;let i=null,r=0,s="",a,o,u;e=e+"";function l(){t.push(s+e.substring(a,o)),s="",a=o+1}for(a=o=0;o<n;++o)if(u=e[o],u==="\\")s+=e.substring(a,o++),a=o;else if(u===i)l(),i=null,r=-1;else{if(i)continue;a===r&&u==='"'||a===r&&u==="'"?(a=o+1,i=u):u==="."&&!r?o>a?l():a=o+1:u==="["?(o>a&&l(),r=a=o+1):u==="]"&&(r||K("Access path missing open bracket: "+e),r>0&&l(),r=0,a=o+1)}return r&&K("Access path missing closing bracket: "+e),i&&K("Access path missing closing quote: "+e),o>a&&(o++,l()),t}function Yr(e,t,n){const i=Ta(e);return e=i.length===1?i[0]:e,tr((n&&n.get||LL)(i),[e],t||e)}const Bg=Yr("id"),hi=tr(e=>e,[],"identity"),pu=tr(()=>0,[],"zero"),Mh=tr(()=>1,[],"one"),Xr=tr(()=>!0,[],"true"),au=tr(()=>!1,[],"false");function Mie(e,t,n){const i=[t].concat([].slice.call(n));console[e].apply(console,i)}const zL=0,yC=1,vC=2,BL=3,UL=4;function xC(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Mie,i=e||zL;return{level(r){return arguments.length?(i=+r,this):i},error(){return i>=yC&&n(t||"error","ERROR",arguments),this},warn(){return i>=vC&&n(t||"warn","WARN",arguments),this},info(){return i>=BL&&n(t||"log","INFO",arguments),this},debug(){return i>=UL&&n(t||"log","DEBUG",arguments),this}}}var Q=Array.isArray;function de(e){return e===Object(e)}const uR=e=>e!=="__proto__";function Nh(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((i,r)=>{for(const s in r)if(s==="signals")i.signals=Nie(i.signals,r.signals);else{const a=s==="legend"?{layout:1}:s==="style"?!0:null;Rh(i,s,r[s],a)}return i},{})}function Rh(e,t,n,i){if(!uR(t))return;let r,s;if(de(n)&&!Q(n)){s=de(e[t])?e[t]:e[t]={};for(r in n)i&&(i===!0||i[r])?Rh(s,r,n[r]):uR(r)&&(s[r]=n[r])}else e[t]=n}function Nie(e,t){if(e==null)return t;const n={},i=[];function r(s){n[s.name]||(n[s.name]=1,i.push(s))}return t.forEach(r),e.forEach(r),i}function ot(e){return e[e.length-1]}function ai(e){return e==null||e===""?null:+e}const jL=e=>t=>e*Math.exp(t),qL=e=>t=>Math.log(e*t),VL=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),WL=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,ey=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function qv(e,t,n,i){const r=n(e[0]),s=n(ot(e)),a=(s-r)*t;return[i(r-a),i(s-a)]}function GL(e,t){return qv(e,t,ai,hi)}function HL(e,t){var n=Math.sign(e[0]);return qv(e,t,qL(n),jL(n))}function YL(e,t,n){return qv(e,t,ey(n),ey(1/n))}function XL(e,t,n){return qv(e,t,VL(n),WL(n))}function Vv(e,t,n,i,r){const s=i(e[0]),a=i(ot(e)),o=t!=null?i(t):(s+a)/2;return[r(o+(s-o)*n),r(o+(a-o)*n)]}function bC(e,t,n){return Vv(e,t,n,ai,hi)}function _C(e,t,n){const i=Math.sign(e[0]);return Vv(e,t,n,qL(i),jL(i))}function ty(e,t,n,i){return Vv(e,t,n,ey(i),ey(1/i))}function wC(e,t,n,i){return Vv(e,t,n,VL(i),WL(i))}function KL(e){return 1+~~(new Date(e).getMonth()/3)}function JL(e){return 1+~~(new Date(e).getUTCMonth()/3)}function pe(e){return e!=null?Q(e)?e:[e]:[]}function QL(e,t,n){let i=e[0],r=e[1],s;return r<i&&(s=r,r=i,i=s),s=r-i,s>=n-t?[t,n]:[i=Math.min(Math.max(i,t),n-s),i+s]}function Ye(e){return typeof e=="function"}const Rie="descending";function EC(e,t,n){n=n||{},t=pe(t)||[];const i=[],r=[],s={},a=n.comparator||Iie;return pe(e).forEach((o,u)=>{o!=null&&(i.push(t[u]===Rie?-1:1),r.push(o=Ye(o)?o:Yr(o,null,n)),(ui(o)||[]).forEach(l=>s[l]=1))}),r.length===0?null:tr(a(r,i),Object.keys(s))}const Ih=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),Iie=(e,t)=>e.length===1?Die(e[0],t[0]):Pie(e,t,e.length),Die=(e,t)=>function(n,i){return Ih(e(n),e(i))*t},Pie=(e,t,n)=>(t.push(0),function(i,r){let s,a=0,o=-1;for(;a===0&&++o<n;)s=e[o],a=Ih(s(i),s(r));return a*t[o]});function di(e){return Ye(e)?e:()=>e}function SC(e,t){let n;return i=>{n&&clearTimeout(n),n=setTimeout(()=>(t(i),n=null),e)}}function We(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}function xa(e,t){let n=0,i,r,s,a;if(e&&(i=e.length))if(t==null){for(r=e[n];n<i&&(r==null||r!==r);r=e[++n]);for(s=a=r;n<i;++n)r=e[n],r!=null&&(r<s&&(s=r),r>a&&(a=r))}else{for(r=t(e[n]);n<i&&(r==null||r!==r);r=t(e[++n]));for(s=a=r;n<i;++n)r=t(e[n]),r!=null&&(r<s&&(s=r),r>a&&(a=r))}return[s,a]}function ZL(e,t){const n=e.length;let i=-1,r,s,a,o,u;if(t==null){for(;++i<n;)if(s=e[i],s!=null&&s>=s){r=a=s;break}if(i===n)return[-1,-1];for(o=u=i;++i<n;)s=e[i],s!=null&&(r>s&&(r=s,o=i),a<s&&(a=s,u=i))}else{for(;++i<n;)if(s=t(e[i],i,e),s!=null&&s>=s){r=a=s;break}if(i===n)return[-1,-1];for(o=u=i;++i<n;)s=t(e[i],i,e),s!=null&&(r>s&&(r=s,o=i),a<s&&(a=s,u=i))}return[o,u]}function ve(e,t){return Object.hasOwn(e,t)}const Mm={};function Dh(e){let t={},n;function i(s){return ve(t,s)&&t[s]!==Mm}const r={size:0,empty:0,object:t,has:i,get(s){return i(s)?t[s]:void 0},set(s,a){return i(s)||(++r.size,t[s]===Mm&&--r.empty),t[s]=a,this},delete(s){return i(s)&&(--r.size,++r.empty,t[s]=Mm),this},clear(){r.size=r.empty=0,r.object=t={}},test(s){return arguments.length?(n=s,r):n},clean(){const s={};let a=0;for(const o in t){const u=t[o];u!==Mm&&(!n||!n(u))&&(s[o]=u,++a)}r.size=a,r.empty=0,r.object=t=s}};return e&&Object.keys(e).forEach(s=>{r.set(s,e[s])}),r}function e4(e,t,n,i,r,s){if(!n&&n!==0)return s;const a=+n;let o=e[0],u=ot(e),l;u<o&&(l=o,o=u,u=l),l=Math.abs(t-o);const c=Math.abs(u-t);return l<c&&l<=a?i:c<=a?r:s}function ce(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),We(i,n)}function $f(e,t,n,i){let r=t[0],s=t[t.length-1],a;return r>s&&(a=r,r=s,s=a),n=n===void 0||n,i=i===void 0||i,(n?r<=e:r<e)&&(i?e<=s:e<s)}function Ku(e){return typeof e=="boolean"}function Au(e){return Object.prototype.toString.call(e)==="[object Date]"}function t4(e){return e&&Ye(e[Symbol.iterator])}function dt(e){return typeof e=="number"}function n4(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function ge(e){return typeof e=="string"}function AC(e,t,n){e&&(e=t?pe(e).map(o=>o.replace(/\\(.)/g,"$1")):pe(e));const i=e&&e.length,r=n&&n.get||LL,s=o=>r(t?[o]:Ta(o));let a;if(!i)a=function(){return""};else if(i===1){const o=s(e[0]);a=function(u){return""+o(u)}}else{const o=e.map(s);a=function(u){let l=""+o[0](u),c=0;for(;++c<i;)l+="|"+o[c](u);return l}}return tr(a,e,"key")}function i4(e,t){const n=e[0],i=ot(e),r=+t;return r?r===1?i:n+r*(i-n):n}const Lie=1e4;function r4(e){e=+e||Lie;let t,n,i;const r=()=>{t={},n={},i=0},s=(a,o)=>(++i>e&&(n=t,t={},i=1),t[a]=o);return r(),{clear:r,has:a=>ve(t,a)||ve(n,a),get:a=>ve(t,a)?t[a]:ve(n,a)?s(a,n[a]):void 0,set:(a,o)=>ve(t,a)?t[a]=o:s(a,o)}}function s4(e,t,n,i){const r=t.length,s=n.length;if(!s)return t;if(!r)return n;const a=i||new t.constructor(r+s);let o=0,u=0,l=0;for(;o<r&&u<s;++l)a[l]=e(t[o],n[u])>0?n[u++]:t[o++];for(;o<r;++o,++l)a[l]=t[o];for(;u<s;++u,++l)a[l]=n[u];return a}function fp(e,t){let n="";for(;--t>=0;)n+=e;return n}function a4(e,t,n,i){const r=n||" ",s=e+"",a=t-s.length;return a<=0?s:i==="left"?fp(r,a)+s:i==="center"?fp(r,~~(a/2))+s+fp(r,Math.ceil(a/2)):s+fp(r,a)}function Ug(e){return e&&ot(e)-e[0]||0}function le(e){return Q(e)?"["+e.map(le)+"]":de(e)||ge(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function CC(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const zie=e=>dt(e)||Au(e)?e:Date.parse(e);function kC(e,t){return t=t||zie,e==null||e===""?null:t(e)}function $C(e){return e==null||e===""?null:e+""}function Os(e){const t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t}function o4(e,t,n,i){const r=i??"…",s=e+"",a=s.length,o=Math.max(0,t-r.length);return a<=t?s:n==="left"?r+s.slice(a-o):n==="center"?s.slice(0,Math.ceil(o/2))+r+s.slice(a-~~(o/2)):s.slice(0,o)+r}function lu(e,t,n){if(e)if(t){const i=e.length;for(let r=0;r<i;++r){const s=t(e[r]);s&&n(s,r,e)}}else e.forEach(n)}var lR={},L_={},z_=34,Pd=10,B_=13;function u4(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function Bie(e,t){var n=u4(e);return function(i,r){return t(n(i),r,e)}}function cR(e){var t=Object.create(null),n=[];return e.forEach(function(i){for(var r in i)r in t||n.push(t[r]=r)}),n}function ji(e,t){var n=e+"",i=n.length;return i<t?new Array(t-i+1).join(0)+n:n}function Uie(e){return e<0?"-"+ji(-e,6):e>9999?"+"+ji(e,6):ji(e,4)}function jie(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),i=e.getUTCSeconds(),r=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":Uie(e.getUTCFullYear())+"-"+ji(e.getUTCMonth()+1,2)+"-"+ji(e.getUTCDate(),2)+(r?"T"+ji(t,2)+":"+ji(n,2)+":"+ji(i,2)+"."+ji(r,3)+"Z":i?"T"+ji(t,2)+":"+ji(n,2)+":"+ji(i,2)+"Z":n||t?"T"+ji(t,2)+":"+ji(n,2)+"Z":"")}function qie(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function i(f,d){var p,m,y=r(f,function(v,b){if(p)return p(v,b-1);m=v,p=d?Bie(v,d):u4(v)});return y.columns=m||[],y}function r(f,d){var p=[],m=f.length,y=0,v=0,b,_=m<=0,E=!1;f.charCodeAt(m-1)===Pd&&--m,f.charCodeAt(m-1)===B_&&--m;function S(){if(_)return L_;if(E)return E=!1,lR;var $,C=y,M;if(f.charCodeAt(C)===z_){for(;y++<m&&f.charCodeAt(y)!==z_||f.charCodeAt(++y)===z_;);return($=y)>=m?_=!0:(M=f.charCodeAt(y++))===Pd?E=!0:M===B_&&(E=!0,f.charCodeAt(y)===Pd&&++y),f.slice(C+1,$-1).replace(/""/g,'"')}for(;y<m;){if((M=f.charCodeAt($=y++))===Pd)E=!0;else if(M===B_)E=!0,f.charCodeAt(y)===Pd&&++y;else if(M!==n)continue;return f.slice(C,$)}return _=!0,f.slice(C,m)}for(;(b=S())!==L_;){for(var A=[];b!==lR&&b!==L_;)A.push(b),b=S();d&&(A=d(A,v++))==null||p.push(A)}return p}function s(f,d){return f.map(function(p){return d.map(function(m){return c(p[m])}).join(e)})}function a(f,d){return d==null&&(d=cR(f)),[d.map(c).join(e)].concat(s(f,d)).join(`
`)}function o(f,d){return d==null&&(d=cR(f)),s(f,d).join(`
`)}function u(f){return f.map(l).join(`
`)}function l(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?jie(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:i,parseRows:r,format:a,formatBody:o,formatRows:u,formatRow:l,formatValue:c}}function Vie(e){return e}function Wie(e){if(e==null)return Vie;var t,n,i=e.scale[0],r=e.scale[1],s=e.translate[0],a=e.translate[1];return function(o,u){u||(t=n=0);var l=2,c=o.length,f=new Array(c);for(f[0]=(t+=o[0])*i+s,f[1]=(n+=o[1])*r+a;l<c;)f[l]=o[l],++l;return f}}function Gie(e,t){for(var n,i=e.length,r=i-t;r<--i;)n=e[r],e[r++]=e[i],e[i]=n}function Hie(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return fR(e,n)})}:fR(e,t)}function fR(e,t){var n=t.id,i=t.bbox,r=t.properties==null?{}:t.properties,s=l4(e,t);return n==null&&i==null?{type:"Feature",properties:r,geometry:s}:i==null?{type:"Feature",id:n,properties:r,geometry:s}:{type:"Feature",id:n,bbox:i,properties:r,geometry:s}}function l4(e,t){var n=Wie(e.transform),i=e.arcs;function r(c,f){f.length&&f.pop();for(var d=i[c<0?~c:c],p=0,m=d.length;p<m;++p)f.push(n(d[p],p));c<0&&Gie(f,m)}function s(c){return n(c)}function a(c){for(var f=[],d=0,p=c.length;d<p;++d)r(c[d],f);return f.length<2&&f.push(f[0]),f}function o(c){for(var f=a(c);f.length<4;)f.push(f[0]);return f}function u(c){return c.map(o)}function l(c){var f=c.type,d;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(l)};case"Point":d=s(c.coordinates);break;case"MultiPoint":d=c.coordinates.map(s);break;case"LineString":d=a(c.arcs);break;case"MultiLineString":d=c.arcs.map(a);break;case"Polygon":d=u(c.arcs);break;case"MultiPolygon":d=c.arcs.map(u);break;default:return null}return{type:f,coordinates:d}}return l(t)}function Yie(e,t){var n={},i={},r={},s=[],a=-1;t.forEach(function(l,c){var f=e.arcs[l<0?~l:l],d;f.length<3&&!f[1][0]&&!f[1][1]&&(d=t[++a],t[a]=l,t[c]=d)}),t.forEach(function(l){var c=o(l),f=c[0],d=c[1],p,m;if(p=r[f])if(delete r[p.end],p.push(l),p.end=d,m=i[d]){delete i[m.start];var y=m===p?p:p.concat(m);i[y.start=p.start]=r[y.end=m.end]=y}else i[p.start]=r[p.end]=p;else if(p=i[d])if(delete i[p.start],p.unshift(l),p.start=f,m=r[f]){delete r[m.end];var v=m===p?p:m.concat(p);i[v.start=m.start]=r[v.end=p.end]=v}else i[p.start]=r[p.end]=p;else p=[l],i[p.start=f]=r[p.end=d]=p});function o(l){var c=e.arcs[l<0?~l:l],f=c[0],d;return e.transform?(d=[0,0],c.forEach(function(p){d[0]+=p[0],d[1]+=p[1]})):d=c[c.length-1],l<0?[d,f]:[f,d]}function u(l,c){for(var f in l){var d=l[f];delete c[d.start],delete d.start,delete d.end,d.forEach(function(p){n[p<0?~p:p]=1}),s.push(d)}}return u(r,i),u(i,r),t.forEach(function(l){n[l<0?~l:l]||s.push([l])}),s}function Xie(e){return l4(e,Kie.apply(this,arguments))}function Kie(e,t,n){var i,r,s;if(arguments.length>1)i=Jie(e,t,n);else for(r=0,i=new Array(s=e.arcs.length);r<s;++r)i[r]=r;return{type:"MultiLineString",arcs:Yie(e,i)}}function Jie(e,t,n){var i=[],r=[],s;function a(f){var d=f<0?~f:f;(r[d]||(r[d]=[])).push({i:f,g:s})}function o(f){f.forEach(a)}function u(f){f.forEach(o)}function l(f){f.forEach(u)}function c(f){switch(s=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":o(f.arcs);break;case"MultiLineString":case"Polygon":u(f.arcs);break;case"MultiPolygon":l(f.arcs);break}}return c(t),r.forEach(n==null?function(f){i.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&i.push(f[0].i)}),i}function bo(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Qie(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Ph(e){let t,n,i;e.length!==2?(t=bo,n=(o,u)=>bo(e(o),u),i=(o,u)=>e(o)-u):(t=e===bo||e===Qie?e:Zie,n=e,i=e);function r(o,u,l=0,c=o.length){if(l<c){if(t(u,u)!==0)return c;do{const f=l+c>>>1;n(o[f],u)<0?l=f+1:c=f}while(l<c)}return l}function s(o,u,l=0,c=o.length){if(l<c){if(t(u,u)!==0)return c;do{const f=l+c>>>1;n(o[f],u)<=0?l=f+1:c=f}while(l<c)}return l}function a(o,u,l=0,c=o.length){const f=r(o,u,l,c-1);return f>l&&i(o[f-1],u)>-i(o[f],u)?f-1:f}return{left:r,center:a,right:s}}function Zie(){return 0}function c4(e){return e===null?NaN:+e}function*ere(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)(i=t(i,++n,e))!=null&&(i=+i)>=i&&(yield i)}}const f4=Ph(bo),Mu=f4.right,tre=f4.left;Ph(c4).center;function nre(e,t){let n=0,i,r=0,s=0;if(t===void 0)for(let a of e)a!=null&&(a=+a)>=a&&(i=a-r,r+=i/++n,s+=i*(a-r));else{let a=-1;for(let o of e)(o=t(o,++a,e))!=null&&(o=+o)>=o&&(i=o-r,r+=i/++n,s+=i*(o-r))}if(n>1)return s/(n-1)}function ire(e,t){const n=nre(e,t);return n&&Math.sqrt(n)}class ki{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const s=n[r],a=t+s,o=Math.abs(t)<Math.abs(s)?t-(a-s):s-(a-t);o&&(n[i++]=o),t=a}return n[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let n=this._n,i,r,s,a=0;if(n>0){for(a=t[--n];n>0&&(i=a,r=t[--n],a=i+r,s=r-(a-i),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(r=s*2,i=a+r,r==i-a&&(a=i))}return a}}class hR extends Map{constructor(t,n=p4){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[i,r]of t)this.set(i,r)}get(t){return super.get(UE(this,t))}has(t){return super.has(UE(this,t))}set(t,n){return super.set(h4(this,t),n)}delete(t){return super.delete(d4(this,t))}}class ny extends Set{constructor(t,n=p4){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const i of t)this.add(i)}has(t){return super.has(UE(this,t))}add(t){return super.add(h4(this,t))}delete(t){return super.delete(d4(this,t))}}function UE({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):n}function h4({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):(e.set(i,n),n)}function d4({_intern:e,_key:t},n){const i=t(n);return e.has(i)&&(n=e.get(i),e.delete(i)),n}function p4(e){return e!==null&&typeof e=="object"?e.valueOf():e}function rre(e,t){return Array.from(t,n=>e[n])}function sre(e=bo){if(e===bo)return g4;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const i=e(t,n);return i||i===0?i:(e(n,n)===0)-(e(t,t)===0)}}function g4(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const are=Math.sqrt(50),ore=Math.sqrt(10),ure=Math.sqrt(2);function iy(e,t,n){const i=(t-e)/Math.max(0,n),r=Math.floor(Math.log10(i)),s=i/Math.pow(10,r),a=s>=are?10:s>=ore?5:s>=ure?2:1;let o,u,l;return r<0?(l=Math.pow(10,-r)/a,o=Math.round(e*l),u=Math.round(t*l),o/l<e&&++o,u/l>t&&--u,l=-l):(l=Math.pow(10,r)*a,o=Math.round(e/l),u=Math.round(t/l),o*l<e&&++o,u*l>t&&--u),u<o&&.5<=n&&n<2?iy(e,t,n*2):[o,u,l]}function jE(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const i=t<e,[r,s,a]=i?iy(t,e,n):iy(e,t,n);if(!(s>=r))return[];const o=s-r+1,u=new Array(o);if(i)if(a<0)for(let l=0;l<o;++l)u[l]=(s-l)/-a;else for(let l=0;l<o;++l)u[l]=(s-l)*a;else if(a<0)for(let l=0;l<o;++l)u[l]=(r+l)/-a;else for(let l=0;l<o;++l)u[l]=(r+l)*a;return u}function qE(e,t,n){return t=+t,e=+e,n=+n,iy(e,t,n)[2]}function Nu(e,t,n){t=+t,e=+e,n=+n;const i=t<e,r=i?qE(t,e,n):qE(e,t,n);return(i?-1:1)*(r<0?1/-r:r)}function Yl(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n<r||n===void 0&&r>=r)&&(n=r)}return n}function VE(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n>r||n===void 0&&r>=r)&&(n=r)}return n}function m4(e,t,n=0,i=1/0,r){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),i=Math.floor(Math.min(e.length-1,i)),!(n<=t&&t<=i))return e;for(r=r===void 0?g4:sre(r);i>n;){if(i-n>600){const u=i-n+1,l=t-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1),p=Math.max(n,Math.floor(t-l*f/u+d)),m=Math.min(i,Math.floor(t+(u-l)*f/u+d));m4(e,t,p,m,r)}const s=e[t];let a=n,o=i;for(Ld(e,n,t),r(e[i],s)>0&&Ld(e,n,i);a<o;){for(Ld(e,a,o),++a,--o;r(e[a],s)<0;)++a;for(;r(e[o],s)>0;)--o}r(e[n],s)===0?Ld(e,n,o):(++o,Ld(e,o,i)),o<=t&&(n=o+1),t<=o&&(i=o-1)}return e}function Ld(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function WE(e,t,n){if(e=Float64Array.from(ere(e,n)),!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return VE(e);if(t>=1)return Yl(e);var i,r=(i-1)*t,s=Math.floor(r),a=Yl(m4(e,s).subarray(0,s+1)),o=VE(e.subarray(s+1));return a+(o-a)*(r-s)}}function y4(e,t,n=c4){if(!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return+n(e[0],0,e);if(t>=1)return+n(e[i-1],i-1,e);var i,r=(i-1)*t,s=Math.floor(r),a=+n(e[s],s,e),o=+n(e[s+1],s+1,e);return a+(o-a)*(r-s)}}function lre(e,t){let n=0,i=0;if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(++n,i+=r);else{let r=-1;for(let s of e)(s=t(s,++r,e))!=null&&(s=+s)>=s&&(++n,i+=s)}if(n)return i/n}function v4(e,t){return WE(e,.5,t)}function*cre(e){for(const t of e)yield*t}function x4(e){return Array.from(cre(e))}function pr(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(r);++i<r;)s[i]=e+i*n;return s}function b4(e,t){let n=0;for(let i of e)(i=+i)&&(n+=i);return n}function fre(e,...t){e=new ny(e),t=t.map(hre);e:for(const n of e)for(const i of t)if(!i.has(n)){e.delete(n);continue e}return e}function hre(e){return e instanceof ny?e:new ny(e)}function dre(...e){const t=new ny;for(const n of e)for(const i of n)t.add(i);return t}function pre(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function ry(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function Xf(e){return e=ry(Math.abs(e)),e?e[1]:NaN}function gre(e,t){return function(n,i){for(var r=n.length,s=[],a=0,o=e[0],u=0;r>0&&o>0&&(u+o+1>i&&(o=Math.max(1,i-u)),s.push(n.substring(r-=o,r+o)),!((u+=o+1)>i));)o=e[a=(a+1)%e.length];return s.reverse().join(t)}}function mre(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var yre=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function rc(e){if(!(t=yre.exec(e)))throw new Error("invalid format: "+e);var t;return new TC({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}rc.prototype=TC.prototype;function TC(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}TC.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function vre(e){e:for(var t=e.length,n=1,i=-1,r;n<t;++n)switch(e[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+e[n])break e;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(r+1):e}var _4;function xre(e,t){var n=ry(e,t);if(!n)return e+"";var i=n[0],r=n[1],s=r-(_4=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,a=i.length;return s===a?i:s>a?i+new Array(s-a+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+ry(e,Math.max(0,t+s-1))[0]}function dR(e,t){var n=ry(e,t);if(!n)return e+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const pR={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:pre,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>dR(e*100,t),r:dR,s:xre,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function gR(e){return e}var mR=Array.prototype.map,yR=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function w4(e){var t=e.grouping===void 0||e.thousands===void 0?gR:gre(mR.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",r=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?gR:mre(mR.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"−":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=rc(f);var d=f.fill,p=f.align,m=f.sign,y=f.symbol,v=f.zero,b=f.width,_=f.comma,E=f.precision,S=f.trim,A=f.type;A==="n"?(_=!0,A="g"):pR[A]||(E===void 0&&(E=12),S=!0,A="g"),(v||d==="0"&&p==="=")&&(v=!0,d="0",p="=");var $=y==="$"?n:y==="#"&&/[boxX]/.test(A)?"0"+A.toLowerCase():"",C=y==="$"?i:/[%p]/.test(A)?a:"",M=pR[A],N=/[defgprs%]/.test(A);E=E===void 0?6:/[gprs]/.test(A)?Math.max(1,Math.min(21,E)):Math.max(0,Math.min(20,E));function P(D){var W=$,q=C,z,R,U;if(A==="c")q=M(D)+q,D="";else{D=+D;var G=D<0||1/D<0;if(D=isNaN(D)?u:M(Math.abs(D),E),S&&(D=vre(D)),G&&+D==0&&m!=="+"&&(G=!1),W=(G?m==="("?m:o:m==="-"||m==="("?"":m)+W,q=(A==="s"?yR[8+_4/3]:"")+q+(G&&m==="("?")":""),N){for(z=-1,R=D.length;++z<R;)if(U=D.charCodeAt(z),48>U||U>57){q=(U===46?r+D.slice(z+1):D.slice(z))+q,D=D.slice(0,z);break}}}_&&!v&&(D=t(D,1/0));var Z=W.length+D.length+q.length,J=Z<b?new Array(b-Z+1).join(d):"";switch(_&&v&&(D=t(J+D,J.length?b-q.length:1/0),J=""),p){case"<":D=W+D+q+J;break;case"=":D=W+J+D+q;break;case"^":D=J.slice(0,Z=J.length>>1)+W+D+q+J.slice(Z);break;default:D=J+W+D+q;break}return s(D)}return P.toString=function(){return f+""},P}function c(f,d){var p=l((f=rc(f),f.type="f",f)),m=Math.max(-8,Math.min(8,Math.floor(Xf(d)/3)))*3,y=Math.pow(10,-m),v=yR[8+m/3];return function(b){return p(y*b)+v}}return{format:l,formatPrefix:c}}var Nm,Wv,OC;bre({thousands:",",grouping:[3],currency:["$",""]});function bre(e){return Nm=w4(e),Wv=Nm.format,OC=Nm.formatPrefix,Nm}function E4(e){return Math.max(0,-Xf(Math.abs(e)))}function S4(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Xf(t)/3)))*3-Xf(Math.abs(e)))}function A4(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Xf(t)-Xf(e))+1}const U_=new Date,j_=new Date;function An(e,t,n,i){function r(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return r.floor=s=>(e(s=new Date(+s)),s),r.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),r.round=s=>{const a=r(s),o=r.ceil(s);return s-a<o-s?a:o},r.offset=(s,a)=>(t(s=new Date(+s),a==null?1:Math.floor(a)),s),r.range=(s,a,o)=>{const u=[];if(s=r.ceil(s),o=o==null?1:Math.floor(o),!(s<a)||!(o>0))return u;let l;do u.push(l=new Date(+s)),t(s,o),e(s);while(l<s&&s<a);return u},r.filter=s=>An(a=>{if(a>=a)for(;e(a),!s(a);)a.setTime(a-1)},(a,o)=>{if(a>=a)if(o<0)for(;++o<=0;)for(;t(a,-1),!s(a););else for(;--o>=0;)for(;t(a,1),!s(a););}),n&&(r.count=(s,a)=>(U_.setTime(+s),j_.setTime(+a),e(U_),e(j_),Math.floor(n(U_,j_))),r.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?r.filter(i?a=>i(a)%s===0:a=>r.count(0,a)%s===0):r)),r}const Kf=An(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Kf.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?An(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):Kf);Kf.range;const ho=1e3,jr=ho*60,po=jr*60,$o=po*24,FC=$o*7,vR=$o*30,q_=$o*365,go=An(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*ho)},(e,t)=>(t-e)/ho,e=>e.getUTCSeconds());go.range;const Gv=An(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ho)},(e,t)=>{e.setTime(+e+t*jr)},(e,t)=>(t-e)/jr,e=>e.getMinutes());Gv.range;const Hv=An(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*jr)},(e,t)=>(t-e)/jr,e=>e.getUTCMinutes());Hv.range;const Yv=An(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ho-e.getMinutes()*jr)},(e,t)=>{e.setTime(+e+t*po)},(e,t)=>(t-e)/po,e=>e.getHours());Yv.range;const Xv=An(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*po)},(e,t)=>(t-e)/po,e=>e.getUTCHours());Xv.range;const _o=An(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*jr)/$o,e=>e.getDate()-1);_o.range;const Cu=An(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/$o,e=>e.getUTCDate()-1);Cu.range;const C4=An(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/$o,e=>Math.floor(e/$o));C4.range;function kc(e){return An(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*jr)/FC)}const Lh=kc(0),sy=kc(1),_re=kc(2),wre=kc(3),Jf=kc(4),Ere=kc(5),Sre=kc(6);Lh.range;sy.range;_re.range;wre.range;Jf.range;Ere.range;Sre.range;function $c(e){return An(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/FC)}const zh=$c(0),ay=$c(1),Are=$c(2),Cre=$c(3),Qf=$c(4),kre=$c(5),$re=$c(6);zh.range;ay.range;Are.range;Cre.range;Qf.range;kre.range;$re.range;const eg=An(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());eg.range;const tg=An(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());tg.range;const ba=An(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());ba.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:An(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});ba.range;const _a=An(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());_a.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:An(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});_a.range;function k4(e,t,n,i,r,s){const a=[[go,1,ho],[go,5,5*ho],[go,15,15*ho],[go,30,30*ho],[s,1,jr],[s,5,5*jr],[s,15,15*jr],[s,30,30*jr],[r,1,po],[r,3,3*po],[r,6,6*po],[r,12,12*po],[i,1,$o],[i,2,2*$o],[n,1,FC],[t,1,vR],[t,3,3*vR],[e,1,q_]];function o(l,c,f){const d=c<l;d&&([l,c]=[c,l]);const p=f&&typeof f.range=="function"?f:u(l,c,f),m=p?p.range(l,+c+1):[];return d?m.reverse():m}function u(l,c,f){const d=Math.abs(c-l)/f,p=Ph(([,,v])=>v).right(a,d);if(p===a.length)return e.every(Nu(l/q_,c/q_,f));if(p===0)return Kf.every(Math.max(Nu(l,c,f),1));const[m,y]=a[d/a[p-1][2]<a[p][2]/d?p-1:p];return m.every(y)}return[o,u]}const[Tre,Ore]=k4(_a,tg,zh,C4,Xv,Hv),[Fre,Mre]=k4(ba,eg,Lh,_o,Yv,Gv),Hn="year",Xi="quarter",li="month",_n="week",Ki="date",si="day",wa="dayofyear",br="hours",_r="minutes",Kr="seconds",Fs="milliseconds",MC=[Hn,Xi,li,_n,Ki,si,wa,br,_r,Kr,Fs],V_=MC.reduce((e,t,n)=>(e[t]=1+n,e),{});function NC(e){const t=pe(e).slice(),n={};return t.length||K("Missing time unit."),t.forEach(r=>{ve(V_,r)?n[r]=1:K(`Invalid time unit: ${r}.`)}),(n[_n]||n[si]?1:0)+(n[Xi]||n[li]||n[Ki]?1:0)+(n[wa]?1:0)>1&&K(`Incompatible time units: ${e}`),t.sort((r,s)=>V_[r]-V_[s]),t}const Nre={[Hn]:"%Y ",[Xi]:"Q%q ",[li]:"%b ",[Ki]:"%d ",[_n]:"W%U ",[si]:"%a ",[wa]:"%j ",[br]:"%H:00",[_r]:"00:%M",[Kr]:":%S",[Fs]:".%L",[`${Hn}-${li}`]:"%Y-%m ",[`${Hn}-${li}-${Ki}`]:"%Y-%m-%d ",[`${br}-${_r}`]:"%H:%M"};function $4(e,t){const n=We({},Nre,t),i=NC(e),r=i.length;let s="",a=0,o,u;for(a=0;a<r;)for(o=i.length;o>a;--o)if(u=i.slice(a,o).join("-"),n[u]!=null){s+=n[u],a=o;break}return s.trim()}const zl=new Date;function RC(e){return zl.setFullYear(e),zl.setMonth(0),zl.setDate(1),zl.setHours(0,0,0,0),zl}function T4(e){return F4(new Date(e))}function O4(e){return GE(new Date(e))}function F4(e){return _o.count(RC(e.getFullYear())-1,e)}function GE(e){return Lh.count(RC(e.getFullYear())-1,e)}function HE(e){return RC(e).getDay()}function Rre(e,t,n,i,r,s,a){if(0<=e&&e<100){const o=new Date(-1,t,n,i,r,s,a);return o.setFullYear(e),o}return new Date(e,t,n,i,r,s,a)}function M4(e){return R4(new Date(e))}function N4(e){return YE(new Date(e))}function R4(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Cu.count(t-1,e)}function YE(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return zh.count(t-1,e)}function XE(e){return zl.setTime(Date.UTC(e,0,1)),zl.getUTCDay()}function Ire(e,t,n,i,r,s,a){if(0<=e&&e<100){const o=new Date(Date.UTC(-1,t,n,i,r,s,a));return o.setUTCFullYear(n.y),o}return new Date(Date.UTC(e,t,n,i,r,s,a))}function I4(e,t,n,i,r){const s=t||1,a=ot(e),o=(b,_,E)=>(E=E||b,Dre(n[E],i[E],b===a&&s,_)),u=new Date,l=Os(e),c=l[Hn]?o(Hn):di(2012),f=l[li]?o(li):l[Xi]?o(Xi):pu,d=l[_n]&&l[si]?o(si,1,_n+si):l[_n]?o(_n,1):l[si]?o(si,1):l[Ki]?o(Ki,1):l[wa]?o(wa,1):Mh,p=l[br]?o(br):pu,m=l[_r]?o(_r):pu,y=l[Kr]?o(Kr):pu,v=l[Fs]?o(Fs):pu;return function(b){u.setTime(+b);const _=c(u);return r(_,f(u),d(u,_),p(u),m(u),y(u),v(u))}}function Dre(e,t,n,i){const r=n<=1?e:i?(s,a)=>i+n*Math.floor((e(s,a)-i)/n):(s,a)=>n*Math.floor(e(s,a)/n);return t?(s,a)=>t(r(s,a),a):r}function Zf(e,t,n){return t+e*7-(n+6)%7}const Pre={[Hn]:e=>e.getFullYear(),[Xi]:e=>Math.floor(e.getMonth()/3),[li]:e=>e.getMonth(),[Ki]:e=>e.getDate(),[br]:e=>e.getHours(),[_r]:e=>e.getMinutes(),[Kr]:e=>e.getSeconds(),[Fs]:e=>e.getMilliseconds(),[wa]:e=>F4(e),[_n]:e=>GE(e),[_n+si]:(e,t)=>Zf(GE(e),e.getDay(),HE(t)),[si]:(e,t)=>Zf(1,e.getDay(),HE(t))},Lre={[Xi]:e=>3*e,[_n]:(e,t)=>Zf(e,0,HE(t))};function D4(e,t){return I4(e,t||1,Pre,Lre,Rre)}const zre={[Hn]:e=>e.getUTCFullYear(),[Xi]:e=>Math.floor(e.getUTCMonth()/3),[li]:e=>e.getUTCMonth(),[Ki]:e=>e.getUTCDate(),[br]:e=>e.getUTCHours(),[_r]:e=>e.getUTCMinutes(),[Kr]:e=>e.getUTCSeconds(),[Fs]:e=>e.getUTCMilliseconds(),[wa]:e=>R4(e),[_n]:e=>YE(e),[si]:(e,t)=>Zf(1,e.getUTCDay(),XE(t)),[_n+si]:(e,t)=>Zf(YE(e),e.getUTCDay(),XE(t))},Bre={[Xi]:e=>3*e,[_n]:(e,t)=>Zf(e,0,XE(t))};function P4(e,t){return I4(e,t||1,zre,Bre,Ire)}const Ure={[Hn]:ba,[Xi]:eg.every(3),[li]:eg,[_n]:Lh,[Ki]:_o,[si]:_o,[wa]:_o,[br]:Yv,[_r]:Gv,[Kr]:go,[Fs]:Kf},jre={[Hn]:_a,[Xi]:tg.every(3),[li]:tg,[_n]:zh,[Ki]:Cu,[si]:Cu,[wa]:Cu,[br]:Xv,[_r]:Hv,[Kr]:go,[Fs]:Kf};function Bh(e){return Ure[e]}function Uh(e){return jre[e]}function L4(e,t,n){return e?e.offset(t,n):void 0}function z4(e,t,n){return L4(Bh(e),t,n)}function B4(e,t,n){return L4(Uh(e),t,n)}function U4(e,t,n,i){return e?e.range(t,n,i):void 0}function j4(e,t,n,i){return U4(Bh(e),t,n,i)}function q4(e,t,n,i){return U4(Uh(e),t,n,i)}const hp=1e3,dp=hp*60,pp=dp*60,Kv=pp*24,qre=Kv*7,xR=Kv*30,KE=Kv*365,V4=[Hn,li,Ki,br,_r,Kr,Fs],gp=V4.slice(0,-1),mp=gp.slice(0,-1),yp=mp.slice(0,-1),Vre=yp.slice(0,-1),Wre=[Hn,_n],bR=[Hn,li],W4=[Hn],zd=[[gp,1,hp],[gp,5,5*hp],[gp,15,15*hp],[gp,30,30*hp],[mp,1,dp],[mp,5,5*dp],[mp,15,15*dp],[mp,30,30*dp],[yp,1,pp],[yp,3,3*pp],[yp,6,6*pp],[yp,12,12*pp],[Vre,1,Kv],[Wre,1,qre],[bR,1,xR],[bR,3,3*xR],[W4,1,KE]];function G4(e){const t=e.extent,n=e.maxbins||40,i=Math.abs(Ug(t))/n;let r=Ph(o=>o[2]).right(zd,i),s,a;return r===zd.length?(s=W4,a=Nu(t[0]/KE,t[1]/KE,n)):r?(r=zd[i/zd[r-1][2]<zd[r][2]/i?r-1:r],s=r[0],a=r[1]):(s=V4,a=Math.max(Nu(t[0],t[1],n),1)),{units:s,step:a}}function W_(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function G_(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Bd(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function H4(e){var t=e.dateTime,n=e.date,i=e.time,r=e.periods,s=e.days,a=e.shortDays,o=e.months,u=e.shortMonths,l=Ud(r),c=jd(r),f=Ud(s),d=jd(s),p=Ud(a),m=jd(a),y=Ud(o),v=jd(o),b=Ud(u),_=jd(u),E={a:G,A:Z,b:J,B:he,c:null,d:CR,e:CR,f:pse,g:Sse,G:Cse,H:fse,I:hse,j:dse,L:Y4,m:gse,M:mse,p:we,q:Ce,Q:TR,s:OR,S:yse,u:vse,U:xse,V:bse,w:_se,W:wse,x:null,X:null,y:Ese,Y:Ase,Z:kse,"%":$R},S={a:ze,A:bt,b:Ie,B:nn,c:null,d:kR,e:kR,f:Fse,g:Use,G:qse,H:$se,I:Tse,j:Ose,L:K4,m:Mse,M:Nse,p:Va,q:Di,Q:TR,s:OR,S:Rse,u:Ise,U:Dse,V:Pse,w:Lse,W:zse,x:null,X:null,y:Bse,Y:jse,Z:Vse,"%":$R},A={a:P,A:D,b:W,B:q,c:z,d:SR,e:SR,f:ose,g:ER,G:wR,H:AR,I:AR,j:ise,L:ase,m:nse,M:rse,p:N,q:tse,Q:lse,s:cse,S:sse,u:Kre,U:Jre,V:Qre,w:Xre,W:Zre,x:R,X:U,y:ER,Y:wR,Z:ese,"%":use};E.x=$(n,E),E.X=$(i,E),E.c=$(t,E),S.x=$(n,S),S.X=$(i,S),S.c=$(t,S);function $(ye,Ue){return function(je){var ae=[],fn=-1,Ge=0,Ht=ye.length,hn,dn,gl;for(je instanceof Date||(je=new Date(+je));++fn<Ht;)ye.charCodeAt(fn)===37&&(ae.push(ye.slice(Ge,fn)),(dn=_R[hn=ye.charAt(++fn)])!=null?hn=ye.charAt(++fn):dn=hn==="e"?" ":"0",(gl=Ue[hn])&&(hn=gl(je,dn)),ae.push(hn),Ge=fn+1);return ae.push(ye.slice(Ge,fn)),ae.join("")}}function C(ye,Ue){return function(je){var ae=Bd(1900,void 0,1),fn=M(ae,ye,je+="",0),Ge,Ht;if(fn!=je.length)return null;if("Q"in ae)return new Date(ae.Q);if("s"in ae)return new Date(ae.s*1e3+("L"in ae?ae.L:0));if(Ue&&!("Z"in ae)&&(ae.Z=0),"p"in ae&&(ae.H=ae.H%12+ae.p*12),ae.m===void 0&&(ae.m="q"in ae?ae.q:0),"V"in ae){if(ae.V<1||ae.V>53)return null;"w"in ae||(ae.w=1),"Z"in ae?(Ge=G_(Bd(ae.y,0,1)),Ht=Ge.getUTCDay(),Ge=Ht>4||Ht===0?ay.ceil(Ge):ay(Ge),Ge=Cu.offset(Ge,(ae.V-1)*7),ae.y=Ge.getUTCFullYear(),ae.m=Ge.getUTCMonth(),ae.d=Ge.getUTCDate()+(ae.w+6)%7):(Ge=W_(Bd(ae.y,0,1)),Ht=Ge.getDay(),Ge=Ht>4||Ht===0?sy.ceil(Ge):sy(Ge),Ge=_o.offset(Ge,(ae.V-1)*7),ae.y=Ge.getFullYear(),ae.m=Ge.getMonth(),ae.d=Ge.getDate()+(ae.w+6)%7)}else("W"in ae||"U"in ae)&&("w"in ae||(ae.w="u"in ae?ae.u%7:"W"in ae?1:0),Ht="Z"in ae?G_(Bd(ae.y,0,1)).getUTCDay():W_(Bd(ae.y,0,1)).getDay(),ae.m=0,ae.d="W"in ae?(ae.w+6)%7+ae.W*7-(Ht+5)%7:ae.w+ae.U*7-(Ht+6)%7);return"Z"in ae?(ae.H+=ae.Z/100|0,ae.M+=ae.Z%100,G_(ae)):W_(ae)}}function M(ye,Ue,je,ae){for(var fn=0,Ge=Ue.length,Ht=je.length,hn,dn;fn<Ge;){if(ae>=Ht)return-1;if(hn=Ue.charCodeAt(fn++),hn===37){if(hn=Ue.charAt(fn++),dn=A[hn in _R?Ue.charAt(fn++):hn],!dn||(ae=dn(ye,je,ae))<0)return-1}else if(hn!=je.charCodeAt(ae++))return-1}return ae}function N(ye,Ue,je){var ae=l.exec(Ue.slice(je));return ae?(ye.p=c.get(ae[0].toLowerCase()),je+ae[0].length):-1}function P(ye,Ue,je){var ae=p.exec(Ue.slice(je));return ae?(ye.w=m.get(ae[0].toLowerCase()),je+ae[0].length):-1}function D(ye,Ue,je){var ae=f.exec(Ue.slice(je));return ae?(ye.w=d.get(ae[0].toLowerCase()),je+ae[0].length):-1}function W(ye,Ue,je){var ae=b.exec(Ue.slice(je));return ae?(ye.m=_.get(ae[0].toLowerCase()),je+ae[0].length):-1}function q(ye,Ue,je){var ae=y.exec(Ue.slice(je));return ae?(ye.m=v.get(ae[0].toLowerCase()),je+ae[0].length):-1}function z(ye,Ue,je){return M(ye,t,Ue,je)}function R(ye,Ue,je){return M(ye,n,Ue,je)}function U(ye,Ue,je){return M(ye,i,Ue,je)}function G(ye){return a[ye.getDay()]}function Z(ye){return s[ye.getDay()]}function J(ye){return u[ye.getMonth()]}function he(ye){return o[ye.getMonth()]}function we(ye){return r[+(ye.getHours()>=12)]}function Ce(ye){return 1+~~(ye.getMonth()/3)}function ze(ye){return a[ye.getUTCDay()]}function bt(ye){return s[ye.getUTCDay()]}function Ie(ye){return u[ye.getUTCMonth()]}function nn(ye){return o[ye.getUTCMonth()]}function Va(ye){return r[+(ye.getUTCHours()>=12)]}function Di(ye){return 1+~~(ye.getUTCMonth()/3)}return{format:function(ye){var Ue=$(ye+="",E);return Ue.toString=function(){return ye},Ue},parse:function(ye){var Ue=C(ye+="",!1);return Ue.toString=function(){return ye},Ue},utcFormat:function(ye){var Ue=$(ye+="",S);return Ue.toString=function(){return ye},Ue},utcParse:function(ye){var Ue=C(ye+="",!0);return Ue.toString=function(){return ye},Ue}}}var _R={"-":"",_:" ",0:"0"},Dn=/^\s*\d+/,Gre=/^%/,Hre=/[\\^$*+?|[\]().{}]/g;function pt(e,t,n){var i=e<0?"-":"",r=(i?-e:e)+"",s=r.length;return i+(s<n?new Array(n-s+1).join(t)+r:r)}function Yre(e){return e.replace(Hre,"\\$&")}function Ud(e){return new RegExp("^(?:"+e.map(Yre).join("|")+")","i")}function jd(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function Xre(e,t,n){var i=Dn.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function Kre(e,t,n){var i=Dn.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function Jre(e,t,n){var i=Dn.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function Qre(e,t,n){var i=Dn.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function Zre(e,t,n){var i=Dn.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function wR(e,t,n){var i=Dn.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function ER(e,t,n){var i=Dn.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function ese(e,t,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function tse(e,t,n){var i=Dn.exec(t.slice(n,n+1));return i?(e.q=i[0]*3-3,n+i[0].length):-1}function nse(e,t,n){var i=Dn.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function SR(e,t,n){var i=Dn.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function ise(e,t,n){var i=Dn.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function AR(e,t,n){var i=Dn.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function rse(e,t,n){var i=Dn.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function sse(e,t,n){var i=Dn.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function ase(e,t,n){var i=Dn.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function ose(e,t,n){var i=Dn.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function use(e,t,n){var i=Gre.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function lse(e,t,n){var i=Dn.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function cse(e,t,n){var i=Dn.exec(t.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function CR(e,t){return pt(e.getDate(),t,2)}function fse(e,t){return pt(e.getHours(),t,2)}function hse(e,t){return pt(e.getHours()%12||12,t,2)}function dse(e,t){return pt(1+_o.count(ba(e),e),t,3)}function Y4(e,t){return pt(e.getMilliseconds(),t,3)}function pse(e,t){return Y4(e,t)+"000"}function gse(e,t){return pt(e.getMonth()+1,t,2)}function mse(e,t){return pt(e.getMinutes(),t,2)}function yse(e,t){return pt(e.getSeconds(),t,2)}function vse(e){var t=e.getDay();return t===0?7:t}function xse(e,t){return pt(Lh.count(ba(e)-1,e),t,2)}function X4(e){var t=e.getDay();return t>=4||t===0?Jf(e):Jf.ceil(e)}function bse(e,t){return e=X4(e),pt(Jf.count(ba(e),e)+(ba(e).getDay()===4),t,2)}function _se(e){return e.getDay()}function wse(e,t){return pt(sy.count(ba(e)-1,e),t,2)}function Ese(e,t){return pt(e.getFullYear()%100,t,2)}function Sse(e,t){return e=X4(e),pt(e.getFullYear()%100,t,2)}function Ase(e,t){return pt(e.getFullYear()%1e4,t,4)}function Cse(e,t){var n=e.getDay();return e=n>=4||n===0?Jf(e):Jf.ceil(e),pt(e.getFullYear()%1e4,t,4)}function kse(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+pt(t/60|0,"0",2)+pt(t%60,"0",2)}function kR(e,t){return pt(e.getUTCDate(),t,2)}function $se(e,t){return pt(e.getUTCHours(),t,2)}function Tse(e,t){return pt(e.getUTCHours()%12||12,t,2)}function Ose(e,t){return pt(1+Cu.count(_a(e),e),t,3)}function K4(e,t){return pt(e.getUTCMilliseconds(),t,3)}function Fse(e,t){return K4(e,t)+"000"}function Mse(e,t){return pt(e.getUTCMonth()+1,t,2)}function Nse(e,t){return pt(e.getUTCMinutes(),t,2)}function Rse(e,t){return pt(e.getUTCSeconds(),t,2)}function Ise(e){var t=e.getUTCDay();return t===0?7:t}function Dse(e,t){return pt(zh.count(_a(e)-1,e),t,2)}function J4(e){var t=e.getUTCDay();return t>=4||t===0?Qf(e):Qf.ceil(e)}function Pse(e,t){return e=J4(e),pt(Qf.count(_a(e),e)+(_a(e).getUTCDay()===4),t,2)}function Lse(e){return e.getUTCDay()}function zse(e,t){return pt(ay.count(_a(e)-1,e),t,2)}function Bse(e,t){return pt(e.getUTCFullYear()%100,t,2)}function Use(e,t){return e=J4(e),pt(e.getUTCFullYear()%100,t,2)}function jse(e,t){return pt(e.getUTCFullYear()%1e4,t,4)}function qse(e,t){var n=e.getUTCDay();return e=n>=4||n===0?Qf(e):Qf.ceil(e),pt(e.getUTCFullYear()%1e4,t,4)}function Vse(){return"+0000"}function $R(){return"%"}function TR(e){return+e}function OR(e){return Math.floor(+e/1e3)}var cf,IC,Q4,DC,Z4;Wse({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Wse(e){return cf=H4(e),IC=cf.format,Q4=cf.parse,DC=cf.utcFormat,Z4=cf.utcParse,cf}function vp(e){const t={};return n=>t[n]||(t[n]=e(n))}function Gse(e,t){return n=>{const i=e(n),r=i.indexOf(t);if(r<0)return i;let s=Hse(i,r);const a=s<i.length?i.slice(s):"";for(;--s>r;)if(i[s]!=="0"){++s;break}return i.slice(0,s)+a}}function Hse(e,t){let n=e.lastIndexOf("e"),i;if(n>0)return n;for(n=e.length;--n>t;)if(i=e.charCodeAt(n),i>=48&&i<=57)return n+1}function e8(e){const t=vp(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(i){const r=rc(i||",");if(r.precision==null){switch(r.precision=12,r.type){case"%":r.precision-=2;break;case"e":r.precision-=1;break}return Gse(t(r),t(".1f")(1)[1])}else return t(r)},formatSpan(i,r,s,a){a=rc(a??",f");const o=Nu(i,r,s),u=Math.max(Math.abs(i),Math.abs(r));let l;if(a.precision==null)switch(a.type){case"s":return isNaN(l=S4(o,u))||(a.precision=l),n(a,u);case"":case"e":case"g":case"p":case"r":{isNaN(l=A4(o,u))||(a.precision=l-(a.type==="e"));break}case"f":case"%":{isNaN(l=E4(o))||(a.precision=l-(a.type==="%")*2);break}}return t(a)}}}let JE;t8();function t8(){return JE=e8({format:Wv,formatPrefix:OC})}function n8(e){return e8(w4(e))}function oy(e){return arguments.length?JE=n8(e):JE}function FR(e,t,n){n=n||{},de(n)||K(`Invalid time multi-format specifier: ${n}`);const i=t(Kr),r=t(_r),s=t(br),a=t(Ki),o=t(_n),u=t(li),l=t(Xi),c=t(Hn),f=e(n[Fs]||".%L"),d=e(n[Kr]||":%S"),p=e(n[_r]||"%I:%M"),m=e(n[br]||"%I %p"),y=e(n[Ki]||n[si]||"%a %d"),v=e(n[_n]||"%b %d"),b=e(n[li]||"%B"),_=e(n[Xi]||"%B"),E=e(n[Hn]||"%Y");return S=>(i(S)<S?f:r(S)<S?d:s(S)<S?p:a(S)<S?m:u(S)<S?o(S)<S?y:v:c(S)<S?l(S)<S?b:_:E)(S)}function i8(e){const t=vp(e.format),n=vp(e.utcFormat);return{timeFormat:i=>ge(i)?t(i):FR(t,Bh,i),utcFormat:i=>ge(i)?n(i):FR(n,Uh,i),timeParse:vp(e.parse),utcParse:vp(e.utcParse)}}let QE;r8();function r8(){return QE=i8({format:IC,parse:Q4,utcFormat:DC,utcParse:Z4})}function s8(e){return i8(H4(e))}function ng(e){return arguments.length?QE=s8(e):QE}const ZE=(e,t)=>We({},e,t);function a8(e,t){const n=e?n8(e):oy(),i=t?s8(t):ng();return ZE(n,i)}function PC(e,t){const n=arguments.length;return n&&n!==2&&K("defaultLocale expects either zero or two arguments."),n?ZE(oy(e),ng(t)):ZE(oy(),ng())}function Yse(){return t8(),r8(),PC()}const Xse=/^(data:|([A-Za-z]+:)?\/\/)/,Kse=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Jse=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,MR="file://";function Qse(e,t){return n=>({options:n||{},sanitize:eae,load:Zse,fileAccess:!1,file:tae(t),http:iae(e)})}async function Zse(e,t){const n=await this.sanitize(e,t),i=n.href;return n.localFile?this.file(i):this.http(i,t)}async function eae(e,t){t=We({},this.options,t);const n=this.fileAccess,i={href:null};let r,s,a;const o=Kse.test(e.replace(Jse,""));(e==null||typeof e!="string"||!o)&&K("Sanitize failure, invalid URI: "+le(e));const u=Xse.test(e);return(a=t.baseURL)&&!u&&(!e.startsWith("/")&&!a.endsWith("/")&&(e="/"+e),e=a+e),s=(r=e.startsWith(MR))||t.mode==="file"||t.mode!=="http"&&!u&&n,r?e=e.slice(MR.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),s=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(i,"localFile",{value:!!s}),i.href=e,t.target&&(i.target=t.target+""),t.rel&&(i.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(i.crossOrigin=t.crossOrigin+""),i}function tae(e){return e?t=>new Promise((n,i)=>{e.readFile(t,(r,s)=>{r?i(r):n(s)})}):nae}async function nae(){K("No file system access.")}function iae(e){return e?async function(t,n){const i=We({},this.options.http,n),r=n&&n.response,s=await e(t,i);return s.ok?Ye(s[r])?s[r]():s.text():K(s.status+""+s.statusText)}:rae}async function rae(){K("No HTTP fetch method available.")}const sae=e=>e!=null&&e===e,aae=e=>e==="true"||e==="false"||e===!0||e===!1,oae=e=>!Number.isNaN(Date.parse(e)),o8=e=>!Number.isNaN(+e)&&!(e instanceof Date),uae=e=>o8(e)&&Number.isInteger(+e),eS={boolean:CC,integer:ai,number:ai,date:kC,string:$C,unknown:hi},Rm=[aae,uae,o8,oae],lae=["boolean","integer","number","date"];function u8(e,t){if(!e||!e.length)return"unknown";const n=e.length,i=Rm.length,r=Rm.map((s,a)=>a+1);for(let s=0,a=0,o,u;s<n;++s)for(u=t?e[s][t]:e[s],o=0;o<i;++o)if(r[o]&&sae(u)&&!Rm[o](u)&&(r[o]=0,++a,a===Rm.length))return"string";return lae[r.reduce((s,a)=>s===0?a:s,0)-1]}function l8(e,t){return t.reduce((n,i)=>(n[i]=u8(e,i),n),{})}function NR(e){const t=function(n,i){const r={delimiter:e};return LC(n,i?We(i,r):r)};return t.responseType="text",t}function LC(e,t){return t.header&&(e=t.header.map(le).join(t.delimiter)+`
`+e),qie(t.delimiter).parse(e+"")}LC.responseType="text";function cae(e){return typeof Buffer=="function"&&Ye(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function zC(e,t){const n=t&&t.property?Yr(t.property):hi;return de(e)&&!cae(e)?fae(n(e),t):n(JSON.parse(e))}zC.responseType="json";function fae(e,t){return!Q(e)&&t4(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}const hae={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function c8(e,t){let n,i,r,s;return e=zC(e,t),t&&t.feature?(n=Hie,r=t.feature):t&&t.mesh?(n=Xie,r=t.mesh,s=hae[t.filter]):K("Missing TopoJSON feature or mesh parameter."),i=(i=e.objects[r])?n(e,i,s):K("Invalid TopoJSON object: "+r),i&&i.features||[i]}c8.responseType="json";const S1={dsv:LC,csv:NR(","),tsv:NR("	"),json:zC,topojson:c8};function BC(e,t){return arguments.length>1?(S1[e]=t,this):ve(S1,e)?S1[e]:null}function f8(e){const t=BC(e);return t&&t.responseType||"text"}function h8(e,t,n,i){t=t||{};const r=BC(t.type||"json");return r||K("Unknown data format type: "+t.type),e=r(e,t),t.parse&&dae(e,t.parse,n,i),ve(e,"columns")&&delete e.columns,e}function dae(e,t,n,i){if(!e.length)return;const r=ng();n=n||r.timeParse,i=i||r.utcParse;let s=e.columns||Object.keys(e[0]),a,o,u,l,c,f;t==="auto"&&(t=l8(e,s)),s=Object.keys(t);const d=s.map(p=>{const m=t[p];let y,v;if(m&&(m.startsWith("date:")||m.startsWith("utc:")))return y=m.split(/:(.+)?/,2),v=y[1],(v[0]==="'"&&v[v.length-1]==="'"||v[0]==='"'&&v[v.length-1]==='"')&&(v=v.slice(1,-1)),(y[0]==="utc"?i:n)(v);if(!eS[m])throw Error("Illegal format pattern: "+p+":"+m);return eS[m]});for(u=0,c=e.length,f=s.length;u<c;++u)for(a=e[u],l=0;l<f;++l)o=s[l],a[o]=d[l](a[o])}const Jv=Qse(typeof fetch<"u"&&fetch,null);function Qv(e){const t=e||hi,n=[],i={};return n.add=r=>{const s=t(r);return i[s]||(i[s]=1,n.push(r)),n},n.remove=r=>{const s=t(r);if(i[s]){i[s]=0;const a=n.indexOf(r);a>=0&&n.splice(a,1)}return n},n}async function A1(e,t){try{await t(e)}catch(n){e.error(n)}}const d8=Symbol("vega_id");let pae=1;function Zv(e){return!!(e&&$e(e))}function $e(e){return e[d8]}function p8(e,t){return e[d8]=t,e}function yt(e){const t=e===Object(e)?e:{data:e};return $e(t)?t:p8(t,pae++)}function UC(e){return ex(e,yt({}))}function ex(e,t){for(const n in e)t[n]=e[n];return t}function g8(e,t){return p8(t,$e(e))}function Tc(e,t){return e?t?(n,i)=>e(n,i)||$e(t(n))-$e(t(i)):(n,i)=>e(n,i)||$e(n)-$e(i):null}function m8(e){return e&&e.constructor===Oc}function Oc(){const e=[],t=[],n=[],i=[],r=[];let s=null,a=!1;return{constructor:Oc,insert(o){const u=pe(o),l=u.length;for(let c=0;c<l;++c)e.push(u[c]);return this},remove(o){const u=Ye(o)?i:t,l=pe(o),c=l.length;for(let f=0;f<c;++f)u.push(l[f]);return this},modify(o,u,l){const c={field:u,value:di(l)};return Ye(o)?(c.filter=o,r.push(c)):(c.tuple=o,n.push(c)),this},encode(o,u){return Ye(o)?r.push({filter:o,field:u}):n.push({tuple:o,field:u}),this},clean(o){return s=o,this},reflow(){return a=!0,this},pulse(o,u){const l={},c={};let f,d,p,m,y,v;for(f=0,d=u.length;f<d;++f)l[$e(u[f])]=1;for(f=0,d=t.length;f<d;++f)y=t[f],l[$e(y)]=-1;for(f=0,d=i.length;f<d;++f)m=i[f],u.forEach(_=>{m(_)&&(l[$e(_)]=-1)});for(f=0,d=e.length;f<d;++f)y=e[f],v=$e(y),l[v]?l[v]=1:o.add.push(yt(e[f]));for(f=0,d=u.length;f<d;++f)y=u[f],l[$e(y)]<0&&o.rem.push(y);function b(_,E,S){S?_[E]=S(_):o.encode=E,a||(c[$e(_)]=_)}for(f=0,d=n.length;f<d;++f)p=n[f],y=p.tuple,m=p.field,v=l[$e(y)],v>0&&(b(y,m,p.value),o.modifies(m));for(f=0,d=r.length;f<d;++f)p=r[f],m=p.filter,u.forEach(_=>{m(_)&&l[$e(_)]>0&&b(_,p.field,p.value)}),o.modifies(p.field);if(a)o.mod=t.length||i.length?u.filter(_=>l[$e(_)]>0):u.slice();else for(v in c)o.mod.push(c[v]);return(s||s==null&&(t.length||i.length))&&o.clean(!0),o}}}const C1="_:mod:_";function tx(){Object.defineProperty(this,C1,{writable:!0,value:{}})}tx.prototype={set(e,t,n,i){const r=this,s=r[e],a=r[C1];return t!=null&&t>=0?(s[t]!==n||i)&&(s[t]=n,a[t+":"+e]=-1,a[e]=-1):(s!==n||i)&&(r[e]=n,a[e]=Q(n)?1+n.length:-1),r},modified(e,t){const n=this[C1];if(arguments.length){if(Q(e)){for(let i=0;i<e.length;++i)if(n[e[i]])return!0;return!1}}else{for(const i in n)if(n[i])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[C1]={},this}};let gae=0;const mae="pulse",yae=new tx,vae=1,xae=2;function Ot(e,t,n,i){this.id=++gae,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,i)}function RR(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}Ot.prototype={targets(){return this._targets||(this._targets=Qv(Bg))},set(e){return this.value!==e?(this.value=e,1):0},skip:RR(vae),modified:RR(xae),parameters(e,t,n){t=t!==!1;const i=this._argval=this._argval||new tx,r=this._argops=this._argops||[],s=[];let a,o,u,l;const c=(f,d,p)=>{p instanceof Ot?(p!==this&&(t&&p.targets().add(this),s.push(p)),r.push({op:p,name:f,index:d})):i.set(f,d,p)};for(a in e)if(o=e[a],a===mae)pe(o).forEach(f=>{f instanceof Ot?f!==this&&(f.targets().add(this),s.push(f)):K("Pulse parameters must be operator instances.")}),this.source=o;else if(Q(o))for(i.set(a,-1,Array(u=o.length)),l=0;l<u;++l)c(a,l,o[l]);else c(a,-1,o);return this.marshall().clear(),n&&(r.initonly=!0),s},marshall(e){const t=this._argval||yae,n=this._argops;let i,r,s,a;if(n){const o=n.length;for(r=0;r<o;++r)i=n[r],s=i.op,a=s.modified()&&s.stamp===e,t.set(i.name,i.index,s.value,a);if(n.initonly){for(r=0;r<o;++r)i=n[r],i.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,i,r;if(e)for(t=0,n=e.length;t<n;++t)i=e[t],r=i.op,r._targets&&r._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),i=t.call(this,n,e);if(n.clear(),i!==this.value)this.value=i;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function bae(e,t,n,i){let r=1,s;return e instanceof Ot?s=e:e&&e.prototype instanceof Ot?s=new e:Ye(e)?s=new Ot(null,e):(r=0,s=new Ot(e,t)),this.rank(s),r&&(i=n,n=t),n&&this.connect(s,s.parameters(n,i)),this.touch(s),s}function _ae(e,t){const n=e.rank,i=t.length;for(let r=0;r<i;++r)if(n<t[r].rank){this.rerank(e);return}}let wae=0;function nx(e,t,n){this.id=++wae,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function ou(e,t,n){return new nx(e,t,n)}nx.prototype={_filter:Xr,_apply:hi,targets(){return this._targets||(this._targets=Qv(Bg))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,i=n?n.length:0;for(let r=0;r<i;++r)n[r].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=ou(e);return this.targets().add(t),t},apply(e){const t=ou(null,e);return this.targets().add(t),t},merge(){const e=ou();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=ou();return this.targets().add(ou(null,null,SC(e,n=>{const i=n.dataflow;t.receive(n),i&&i.run&&i.run()}))),t},between(e,t){let n=!1;return e.targets().add(ou(null,null,()=>n=!0)),t.targets().add(ou(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=Xr,this._targets=null}};function Eae(e,t,n,i){const r=this,s=ou(n,i),a=function(l){l.dataflow=r;try{s.receive(l)}catch(c){r.error(c)}finally{r.run()}};let o;typeof e=="string"&&typeof document<"u"?o=document.querySelectorAll(e):o=pe(e);const u=o.length;for(let l=0;l<u;++l)o[l].addEventListener(t,a);return s}function Sae(e,t){const n=this.locale();return h8(e,t,n.timeParse,n.utcParse)}function Aae(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function Cae(e,t){const n=this;let i=0,r;try{r=await n.loader().load(e,{context:"dataflow",response:f8(t&&t.type)});try{r=n.parse(r,t)}catch(s){i=-2,n.warn("Data ingestion failed",e,s)}}catch(s){i=-1,n.warn("Loading failed",e,s)}return{data:r,status:i}}async function kae(e,t,n){const i=this,r=i._pending||$ae(i);r.requests+=1;const s=await i.request(t,n);return i.pulse(e,i.changeset().remove(Xr).insert(s.data||[])),r.done(),s}function $ae(e){let t;const n=new Promise(i=>t=i);return n.requests=0,n.done=()=>{--n.requests===0&&(e._pending=null,t(e))},e._pending=n}const Tae={skip:!0};function Oae(e,t,n,i,r){return(e instanceof Ot?Mae:Fae)(this,e,t,n,i,r),this}function Fae(e,t,n,i,r,s){const a=We({},s,Tae);let o,u;Ye(n)||(n=di(n)),i===void 0?o=l=>e.touch(n(l)):Ye(i)?(u=new Ot(null,i,r,!1),o=l=>{u.evaluate(l);const c=n(l),f=u.value;m8(f)?e.pulse(c,f,s):e.update(c,f,a)}):o=l=>e.update(n(l),i,a),t.apply(o)}function Mae(e,t,n,i,r,s){if(i===void 0)t.targets().add(n);else{const a=s||{},o=new Ot(null,Nae(n,i),r,!1);o.modified(a.force),o.rank=t.rank,t.targets().add(o),n&&(o.skip(!0),o.value=n.value,o.targets().add(n),e.connect(n,[o]))}}function Nae(e,t){return t=Ye(t)?t:di(t),e?function(n,i){const r=t(n,i);return e.skip()||(e.skip(r!==this.value).value=r),r}:t}function Rae(e){e.rank=++this._rank}function Iae(e){const t=[e];let n,i,r;for(;t.length;)if(this.rank(n=t.pop()),i=n._targets)for(r=i.length;--r>=0;)t.push(n=i[r]),n===e&&K("Cycle detected in dataflow graph.")}const uy={},ra=1,cu=2,so=4,Dae=ra|cu,IR=ra|so,ff=ra|cu|so,DR=8,qd=16,PR=32,LR=64;function ku(e,t,n){this.dataflow=e,this.stamp=t??-1,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function H_(e,t){const n=[];return lu(e,t,i=>n.push(i)),n}function zR(e,t){const n={};return e.visit(t,i=>{n[$e(i)]=1}),i=>n[$e(i)]?null:i}function Im(e,t){return e?(n,i)=>e(n,i)&&t(n,i):t}ku.prototype={StopPropagation:uy,ADD:ra,REM:cu,MOD:so,ADD_REM:Dae,ADD_MOD:IR,ALL:ff,REFLOW:DR,SOURCE:qd,NO_SOURCE:PR,NO_FIELDS:LR,fork(e){return new ku(this.dataflow).init(this,e)},clone(){const e=this.fork(ff);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(ff|qd)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new ku(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&LR)&&(n.fields=e.fields),t&ra?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&cu?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&so?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&PR?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||ff;return t&ra&&this.add.length||t&cu&&this.rem.length||t&so&&this.mod.length},reflow(e){if(e)return this.fork(ff).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(so,zR(this,ra))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return Q(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?Q(e)?e.some(i=>n[i]):n[e]:!!n:!1},filter(e,t){const n=this;return e&ra&&(n.addF=Im(n.addF,t)),e&cu&&(n.remF=Im(n.remF,t)),e&so&&(n.modF=Im(n.modF,t)),e&qd&&(n.srcF=Im(n.srcF,t)),n},materialize(e){e=e||ff;const t=this;return e&ra&&t.addF&&(t.add=H_(t.add,t.addF),t.addF=null),e&cu&&t.remF&&(t.rem=H_(t.rem,t.remF),t.remF=null),e&so&&t.modF&&(t.mod=H_(t.mod,t.modF),t.modF=null),e&qd&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,i=t;if(e&qd)return lu(n.source,n.srcF,i),n;e&ra&&lu(n.add,n.addF,i),e&cu&&lu(n.rem,n.remF,i),e&so&&lu(n.mod,n.modF,i);const r=n.source;if(e&DR&&r){const s=n.add.length+n.mod.length;s===r.length||(s?lu(r,zR(n,IR),i):lu(r,n.srcF,i))}return n}};function jC(e,t,n,i){const r=this;let s=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=i||null,this.pulses=n;for(const a of n)if(a.stamp===t){if(a.fields){const o=r.fields||(r.fields={});for(const u in a.fields)o[u]=1}a.changed(r.ADD)&&(s|=r.ADD),a.changed(r.REM)&&(s|=r.REM),a.changed(r.MOD)&&(s|=r.MOD)}this.changes=s}ce(jC,ku,{fork(e){const t=new ku(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?Q(e)?e.some(i=>n[i]):n[e]:0},filter(){K("MultiPulse does not support filtering.")},materialize(){K("MultiPulse does not support materialization.")},visit(e,t){const n=this,i=n.pulses,r=i.length;let s=0;if(e&n.SOURCE)for(;s<r;++s)i[s].visit(e,t);else for(;s<r;++s)i[s].stamp===n.stamp&&i[s].visit(e,t);return n}});async function Pae(e,t,n){const i=this,r=[];if(i._pulse)return y8(i);if(i._pending&&await i._pending,t&&await A1(i,t),!i._touched.length)return i.debug("Dataflow invoked, but nothing to do."),i;const s=++i._clock;i._pulse=new ku(i,s,e),i._touched.forEach(c=>i._enqueue(c,!0)),i._touched=Qv(Bg);let a=0,o,u,l;try{for(;i._heap.size()>0;){if(o=i._heap.pop(),o.rank!==o.qrank){i._enqueue(o,!0);continue}u=o.run(i._getPulse(o,e)),u.then?u=await u:u.async&&(r.push(u.async),u=uy),u!==uy&&o._targets&&o._targets.forEach(c=>i._enqueue(c)),++a}}catch(c){i._heap.clear(),l=c}if(i._input={},i._pulse=null,i.debug(`Pulse ${s}: ${a} operators`),l&&(i._postrun=[],i.error(l)),i._postrun.length){const c=i._postrun.sort((f,d)=>d.priority-f.priority);i._postrun=[];for(let f=0;f<c.length;++f)await A1(i,c[f].callback)}return n&&await A1(i,n),r.length&&Promise.all(r).then(c=>i.runAsync(null,()=>{c.forEach(f=>{try{f(i)}catch(d){i.error(d)}})})),i}async function Lae(e,t,n){for(;this._running;)await this._running;const i=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(i,i),this._running}function zae(e,t,n){return this._pulse?y8(this):(this.evaluate(e,t,n),this)}function Bae(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(i){this.error(i)}}function y8(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function Uae(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function jae(e,t){const n=e.source,i=this._clock;return n&&Q(n)?new jC(this,i,n.map(r=>r.pulse),t):this._input[e.id]||qae(this._pulse,n&&n.pulse)}function qae(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==uy&&(e.source=t.source),e)}const qC={skip:!1,force:!1};function Vae(e,t){const n=t||qC;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function Wae(e,t,n){const i=n||qC;return(e.set(t)||i.force)&&this.touch(e,i),this}function Gae(e,t,n){this.touch(e,n||qC);const i=new ku(this,this._clock+(this._pulse?0:1)),r=e.pulse&&e.pulse.source||[];return i.target=e,this._input[e.id]=t.pulse(i,r),this}function Hae(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),v8(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let i;return t.length?(i=t[0],t[0]=n,Yae(t,0,e)):i=n,i}}}function v8(e,t,n,i){let r,s;const a=e[n];for(;n>t;){if(s=n-1>>1,r=e[s],i(a,r)<0){e[n]=r,n=s;continue}break}return e[n]=a}function Yae(e,t,n){const i=t,r=e.length,s=e[t];let a=(t<<1)+1,o;for(;a<r;)o=a+1,o<r&&n(e[a],e[o])>=0&&(a=o),e[t]=e[a],t=a,a=(t<<1)+1;return e[t]=s,v8(e,i,t,n)}function Pf(){this.logger(xC()),this.logLevel(yC),this._clock=0,this._rank=0,this._locale=PC();try{this._loader=Jv()}catch{}this._touched=Qv(Bg),this._input={},this._pulse=null,this._heap=Hae((e,t)=>e.qrank-t.qrank),this._postrun=[]}function Vd(e){return function(){return this._log[e].apply(this,arguments)}}Pf.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:Vd("error"),warn:Vd("warn"),info:Vd("info"),debug:Vd("debug"),logLevel:Vd("level"),cleanThreshold:1e4,add:bae,connect:_ae,rank:Rae,rerank:Iae,pulse:Gae,touch:Vae,update:Wae,changeset:Oc,ingest:Aae,parse:Sae,preload:kae,request:Cae,events:Eae,on:Oae,evaluate:Pae,run:zae,runAsync:Lae,runAfter:Bae,_enqueue:Uae,_getPulse:jae};function H(e,t){Ot.call(this,e,null,t)}ce(H,Ot,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const eh={};function x8(e){const t=b8(e);return t&&t.Definition||null}function b8(e){return e=e&&e.toLowerCase(),ve(eh,e)?eh[e]:null}function*_8(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)i=t(i,++n,e),i!=null&&i!==""&&(i=+i)>=i&&(yield i)}}function VC(e,t,n){const i=Float64Array.from(_8(e,n));return i.sort(bo),t.map(r=>y4(i,r))}function WC(e,t){return VC(e,[.25,.5,.75],t)}function GC(e,t){const n=e.length,i=ire(e,t),r=WC(e,t),s=(r[2]-r[0])/1.34;return 1.06*(Math.min(i,s)||i||Math.abs(r[0])||1)*Math.pow(n,-.2)}function w8(e){const t=e.maxbins||20,n=e.base||10,i=Math.log(n),r=e.divide||[5,2];let s=e.extent[0],a=e.extent[1],o,u,l,c,f,d;const p=e.span||a-s||Math.abs(s)||1;if(e.step)o=e.step;else if(e.steps){for(c=p/t,f=0,d=e.steps.length;f<d&&e.steps[f]<c;++f);o=e.steps[Math.max(0,f-1)]}else{for(u=Math.ceil(Math.log(t)/i),l=e.minstep||0,o=Math.max(l,Math.pow(n,Math.round(Math.log(p)/i)-u));Math.ceil(p/o)>t;)o*=n;for(f=0,d=r.length;f<d;++f)c=o/r[f],c>=l&&p/c<=t&&(o=c)}c=Math.log(o);const m=c>=0?0:~~(-c/i)+1,y=Math.pow(n,-m-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(s/o+y)*o,s=s<c?c-o:c,a=Math.ceil(a/o)*o),{start:s,stop:a===s?s+o:a,step:o}}var Jr=Math.random;function Xae(e){Jr=e}function E8(e,t,n,i){if(!e.length)return[void 0,void 0];const r=Float64Array.from(_8(e,i)),s=r.length,a=t;let o,u,l,c;for(l=0,c=Array(a);l<a;++l){for(o=0,u=0;u<s;++u)o+=r[~~(Jr()*s)];c[l]=o/s}return c.sort(bo),[WE(c,n/2),WE(c,1-n/2)]}function S8(e,t,n,i){i=i||(d=>d);const r=e.length,s=new Float64Array(r);let a=0,o=1,u=i(e[0]),l=u,c=u+t,f;for(;o<r;++o){if(f=i(e[o]),f>=c){for(l=(u+l)/2;a<o;++a)s[a]=l;c=f+t,u=f}l=f}for(l=(u+l)/2;a<o;++a)s[a]=l;return n?Kae(s,t+t/4):s}function Kae(e,t){const n=e.length;let i=0,r=1,s,a;for(;e[i]===e[r];)++r;for(;r<n;){for(s=r+1;e[r]===e[s];)++s;if(e[r]-e[r-1]<t){for(a=r+(i+s-r-r>>1);a<r;)e[a++]=e[r];for(;a>r;)e[a--]=e[i]}i=r,r=s}return e}function Jae(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function Qae(e,t){t==null&&(t=e,e=0);let n,i,r;const s={min(a){return arguments.length?(n=a||0,r=i-n,s):n},max(a){return arguments.length?(i=a||0,r=i-n,s):i},sample(){return n+Math.floor(r*Jr())},pdf(a){return a===Math.floor(a)&&a>=n&&a<i?1/r:0},cdf(a){const o=Math.floor(a);return o<n?0:o>=i?1:(o-n+1)/r},icdf(a){return a>=0&&a<=1?n-1+Math.floor(a*r):NaN}};return s.min(e).max(t)}const A8=Math.sqrt(2*Math.PI),Zae=Math.SQRT2;let Wd=NaN;function ix(e,t){e=e||0,t=t??1;let n=0,i=0,r,s;if(Wd===Wd)n=Wd,Wd=NaN;else{do n=Jr()*2-1,i=Jr()*2-1,r=n*n+i*i;while(r===0||r>1);s=Math.sqrt(-2*Math.log(r)/r),n*=s,Wd=i*s}return e+n*t}function HC(e,t,n){n=n??1;const i=(e-(t||0))/n;return Math.exp(-.5*i*i)/(n*A8)}function rx(e,t,n){t=t||0,n=n??1;const i=(e-t)/n,r=Math.abs(i);let s;if(r>37)s=0;else{const a=Math.exp(-r*r/2);let o;r<7.07106781186547?(o=.0352624965998911*r+.700383064443688,o=o*r+6.37396220353165,o=o*r+33.912866078383,o=o*r+112.079291497871,o=o*r+221.213596169931,o=o*r+220.206867912376,s=a*o,o=.0883883476483184*r+1.75566716318264,o=o*r+16.064177579207,o=o*r+86.7807322029461,o=o*r+296.564248779674,o=o*r+637.333633378831,o=o*r+793.826512519948,o=o*r+440.413735824752,s=s/o):(o=r+.65,o=r+4/o,o=r+3/o,o=r+2/o,o=r+1/o,s=a/o/2.506628274631)}return i>0?1-s:s}function sx(e,t,n){return e<0||e>1?NaN:(t||0)+(n??1)*Zae*eoe(2*e-1)}function eoe(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function YC(e,t){let n,i;const r={mean(s){return arguments.length?(n=s||0,r):n},stdev(s){return arguments.length?(i=s??1,r):i},sample:()=>ix(n,i),pdf:s=>HC(s,n,i),cdf:s=>rx(s,n,i),icdf:s=>sx(s,n,i)};return r.mean(e).stdev(t)}function XC(e,t){const n=YC();let i=0;const r={data(s){return arguments.length?(e=s,i=s?s.length:0,r.bandwidth(t)):e},bandwidth(s){return arguments.length?(t=s,!t&&e&&(t=GC(e)),r):t},sample(){return e[~~(Jr()*i)]+t*n.sample()},pdf(s){let a=0,o=0;for(;o<i;++o)a+=n.pdf((s-e[o])/t);return a/t/i},cdf(s){let a=0,o=0;for(;o<i;++o)a+=n.cdf((s-e[o])/t);return a/i},icdf(){throw Error("KDE icdf not supported.")}};return r.data(e)}function KC(e,t){return e=e||0,t=t??1,Math.exp(e+ix()*t)}function JC(e,t,n){if(e<=0)return 0;t=t||0,n=n??1;const i=(Math.log(e)-t)/n;return Math.exp(-.5*i*i)/(n*A8*e)}function QC(e,t,n){return rx(Math.log(e),t,n)}function ZC(e,t,n){return Math.exp(sx(e,t,n))}function C8(e,t){let n,i;const r={mean(s){return arguments.length?(n=s||0,r):n},stdev(s){return arguments.length?(i=s??1,r):i},sample:()=>KC(n,i),pdf:s=>JC(s,n,i),cdf:s=>QC(s,n,i),icdf:s=>ZC(s,n,i)};return r.mean(e).stdev(t)}function k8(e,t){let n=0,i;function r(a){const o=[];let u=0,l;for(l=0;l<n;++l)u+=o[l]=a[l]==null?1:+a[l];for(l=0;l<n;++l)o[l]/=u;return o}const s={weights(a){return arguments.length?(i=r(t=a||[]),s):t},distributions(a){return arguments.length?(a?(n=a.length,e=a):(n=0,e=[]),s.weights(t)):e},sample(){const a=Jr();let o=e[n-1],u=i[0],l=0;for(;l<n-1;u+=i[++l])if(a<u){o=e[l];break}return o.sample()},pdf(a){let o=0,u=0;for(;u<n;++u)o+=i[u]*e[u].pdf(a);return o},cdf(a){let o=0,u=0;for(;u<n;++u)o+=i[u]*e[u].cdf(a);return o},icdf(){throw Error("Mixture icdf not supported.")}};return s.distributions(e).weights(t)}function ek(e,t){return t==null&&(t=e??1,e=0),e+(t-e)*Jr()}function tk(e,t,n){return n==null&&(n=t??1,t=0),e>=t&&e<=n?1/(n-t):0}function nk(e,t,n){return n==null&&(n=t??1,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function ik(e,t,n){return n==null&&(n=t??1,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function $8(e,t){let n,i;const r={min(s){return arguments.length?(n=s||0,r):n},max(s){return arguments.length?(i=s??1,r):i},sample:()=>ek(n,i),pdf:s=>tk(s,n,i),cdf:s=>nk(s,n,i),icdf:s=>ik(s,n,i)};return t==null&&(t=e??1,e=0),r.min(e).max(t)}function rk(e,t,n){let i=0,r=0;for(const s of e){const a=n(s);t(s)==null||a==null||isNaN(a)||(i+=(a-i)/++r)}return{coef:[i],predict:()=>i,rSquared:0}}function jg(e,t,n,i){const r=i-e*e,s=Math.abs(r)<1e-24?0:(n-e*t)/r;return[t-s*e,s]}function ax(e,t,n,i){e=e.filter(p=>{let m=t(p),y=n(p);return m!=null&&(m=+m)>=m&&y!=null&&(y=+y)>=y}),i&&e.sort((p,m)=>t(p)-t(m));const r=e.length,s=new Float64Array(r),a=new Float64Array(r);let o=0,u=0,l=0,c,f,d;for(d of e)s[o]=c=+t(d),a[o]=f=+n(d),++o,u+=(c-u)/o,l+=(f-l)/o;for(o=0;o<r;++o)s[o]-=u,a[o]-=l;return[s,a,u,l]}function qg(e,t,n,i){let r=-1,s,a;for(const o of e)s=t(o),a=n(o),s!=null&&(s=+s)>=s&&a!=null&&(a=+a)>=a&&i(s,a,++r)}function jh(e,t,n,i,r){let s=0,a=0;return qg(e,t,n,(o,u)=>{const l=u-r(o),c=u-i;s+=l*l,a+=c*c}),1-s/a}function sk(e,t,n){let i=0,r=0,s=0,a=0,o=0;qg(e,t,n,(c,f)=>{++o,i+=(c-i)/o,r+=(f-r)/o,s+=(c*f-s)/o,a+=(c*c-a)/o});const u=jg(i,r,s,a),l=c=>u[0]+u[1]*c;return{coef:u,predict:l,rSquared:jh(e,t,n,r,l)}}function T8(e,t,n){let i=0,r=0,s=0,a=0,o=0;qg(e,t,n,(c,f)=>{++o,c=Math.log(c),i+=(c-i)/o,r+=(f-r)/o,s+=(c*f-s)/o,a+=(c*c-a)/o});const u=jg(i,r,s,a),l=c=>u[0]+u[1]*Math.log(c);return{coef:u,predict:l,rSquared:jh(e,t,n,r,l)}}function O8(e,t,n){const[i,r,s,a]=ax(e,t,n);let o=0,u=0,l=0,c=0,f=0,d,p,m;qg(e,t,n,(_,E)=>{d=i[f++],p=Math.log(E),m=d*E,o+=(E*p-o)/f,u+=(m-u)/f,l+=(m*p-l)/f,c+=(d*m-c)/f});const[y,v]=jg(u/a,o/a,l/a,c/a),b=_=>Math.exp(y+v*(_-s));return{coef:[Math.exp(y-v*s),v],predict:b,rSquared:jh(e,t,n,a,b)}}function F8(e,t,n){let i=0,r=0,s=0,a=0,o=0,u=0;qg(e,t,n,(f,d)=>{const p=Math.log(f),m=Math.log(d);++u,i+=(p-i)/u,r+=(m-r)/u,s+=(p*m-s)/u,a+=(p*p-a)/u,o+=(d-o)/u});const l=jg(i,r,s,a),c=f=>l[0]*Math.pow(f,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:jh(e,t,n,o,c)}}function ak(e,t,n){const[i,r,s,a]=ax(e,t,n),o=i.length;let u=0,l=0,c=0,f=0,d=0,p,m,y,v;for(p=0;p<o;)m=i[p],y=r[p++],v=m*m,u+=(v-u)/p,l+=(v*m-l)/p,c+=(v*v-c)/p,f+=(m*y-f)/p,d+=(v*y-d)/p;const b=c-u*u,_=u*b-l*l,E=(d*u-f*l)/_,S=(f*b-d*l)/_,A=-E*u,$=C=>(C=C-s,E*C*C+S*C+A+a);return{coef:[A-S*s+E*s*s+a,S-2*E*s,E],predict:$,rSquared:jh(e,t,n,a,$)}}function M8(e,t,n,i){if(i===0)return rk(e,t,n);if(i===1)return sk(e,t,n);if(i===2)return ak(e,t,n);const[r,s,a,o]=ax(e,t,n),u=r.length,l=[],c=[],f=i+1;let d,p,m,y,v;for(d=0;d<f;++d){for(m=0,y=0;m<u;++m)y+=Math.pow(r[m],d)*s[m];for(l.push(y),v=new Float64Array(f),p=0;p<f;++p){for(m=0,y=0;m<u;++m)y+=Math.pow(r[m],d+p);v[p]=y}c.push(v)}c.push(l);const b=noe(c),_=E=>{E-=a;let S=o+b[0]+b[1]*E+b[2]*E*E;for(d=3;d<f;++d)S+=b[d]*Math.pow(E,d);return S};return{coef:toe(f,b,-a,o),predict:_,rSquared:jh(e,t,n,o,_)}}function toe(e,t,n,i){const r=Array(e);let s,a,o,u;for(s=0;s<e;++s)r[s]=0;for(s=e-1;s>=0;--s)for(o=t[s],u=1,r[s]+=o,a=1;a<=s;++a)u*=(s+1-a)/a,r[s-a]+=o*Math.pow(n,a)*u;return r[0]+=i,r}function noe(e){const t=e.length-1,n=[];let i,r,s,a,o;for(i=0;i<t;++i){for(a=i,r=i+1;r<t;++r)Math.abs(e[i][r])>Math.abs(e[i][a])&&(a=r);for(s=i;s<t+1;++s)o=e[s][i],e[s][i]=e[s][a],e[s][a]=o;for(r=i+1;r<t;++r)for(s=t;s>=i;s--)e[s][r]-=e[s][i]*e[i][r]/e[i][i]}for(r=t-1;r>=0;--r){for(o=0,s=r+1;s<t;++s)o+=e[s][r]*n[s];n[r]=(e[t][r]-o)/e[r][r]}return n}const BR=2,UR=1e-12;function N8(e,t,n,i){const[r,s,a,o]=ax(e,t,n,!0),u=r.length,l=Math.max(2,~~(i*u)),c=new Float64Array(u),f=new Float64Array(u),d=new Float64Array(u).fill(1);for(let p=-1;++p<=BR;){const m=[0,l-1];for(let v=0;v<u;++v){const b=r[v],_=m[0],E=m[1],S=b-r[_]>r[E]-b?_:E;let A=0,$=0,C=0,M=0,N=0;const P=1/Math.abs(r[S]-b||1);for(let q=_;q<=E;++q){const z=r[q],R=s[q],U=ioe(Math.abs(b-z)*P)*d[q],G=z*U;A+=U,$+=G,C+=R*U,M+=R*G,N+=z*G}const[D,W]=jg($/A,C/A,M/A,N/A);c[v]=D+W*b,f[v]=Math.abs(s[v]-c[v]),roe(r,v+1,m)}if(p===BR)break;const y=v4(f);if(Math.abs(y)<UR)break;for(let v=0,b,_;v<u;++v)b=f[v]/(6*y),d[v]=b>=1?UR:(_=1-b*b)*_}return soe(r,c,a,o)}function ioe(e){return(e=1-e*e*e)*e*e}function roe(e,t,n){const i=e[t];let r=n[0],s=n[1]+1;if(!(s>=e.length))for(;t>r&&e[s]-i<=i-e[r];)n[0]=++r,n[1]=s,++s}function soe(e,t,n,i){const r=e.length,s=[];let a=0,o=0,u=[],l;for(;a<r;++a)l=e[a]+n,u[0]===l?u[1]+=(t[a]-u[1])/++o:(o=0,u[1]+=i,u=[l,t[a]],s.push(u));return u[1]+=i,s}const aoe=.5*Math.PI/180;function ox(e,t,n,i){n=n||25,i=Math.max(n,i||200);const r=y=>[y,e(y)],s=t[0],a=t[1],o=a-s,u=o/i,l=[r(s)],c=[];if(n===i){for(let y=1;y<i;++y)l.push(r(s+y/n*o));return l.push(r(a)),l}else{c.push(r(a));for(let y=n;--y>0;)c.push(r(s+y/n*o))}let f=l[0],d=c[c.length-1];const p=1/o,m=ooe(f[1],c);for(;d;){const y=r((f[0]+d[0])/2);y[0]-f[0]>=u&&uoe(f,y,d,p,m)>aoe?c.push(y):(f=d,l.push(d),c.pop()),d=c[c.length-1]}return l}function ooe(e,t){let n=e,i=e;const r=t.length;for(let s=0;s<r;++s){const a=t[s][1];a<n&&(n=a),a>i&&(i=a)}return 1/(i-n)}function uoe(e,t,n,i,r){const s=Math.atan2(r*(n[1]-e[1]),i*(n[0]-e[0])),a=Math.atan2(r*(t[1]-e[1]),i*(t[0]-e[0]));return Math.abs(s-a)}function loe(e){return t=>{const n=e.length;let i=1,r=String(e[0](t));for(;i<n;++i)r+="|"+e[i](t);return r}}function tS(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:loe(e)}function R8(e,t,n){return n||e+(t?"_"+t:"")}const Y_=()=>{},coe={init:Y_,add:Y_,rem:Y_,idx:0},ig={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.valid?e.sum:void 0,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3},exponential:{init:(e,t)=>{e.exp=0,e.exp_r=t},value:e=>e.valid?e.exp*(1-e.exp_r)/(1-e.exp_r**e.valid):void 0,add:(e,t)=>e.exp=e.exp_r*e.exp+t,rem:(e,t)=>e.exp=(e.exp-t/e.exp_r**(e.valid-1))/e.exp_r},exponentialb:{value:e=>e.valid?e.exp*(1-e.exp_r):void 0,req:["exponential"],idx:1}},Vg=Object.keys(ig).filter(e=>e!=="__count__");function foe(e,t){return(n,i)=>We({name:e,aggregate_param:i,out:n||e},coe,t)}[...Vg,"__count__"].forEach(e=>{ig[e]=foe(e,ig[e])});function I8(e,t,n){return ig[e](n,t)}function D8(e,t){return e.idx-t.idx}function hoe(e){const t={};e.forEach(i=>t[i.name]=i);const n=i=>{i.req&&i.req.forEach(r=>{t[r]||n(t[r]=ig[r]())})};return e.forEach(n),Object.values(t).sort(D8)}function doe(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.aggregate_param==null?e.init(this):e.init(this,e.aggregate_param))}function poe(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function goe(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function moe(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function P8(e,t){const n=t||hi,i=hoe(e),r=e.slice().sort(D8);function s(a){this._ops=i,this._out=r,this.cell=a,this.init()}return s.prototype.init=doe,s.prototype.add=poe,s.prototype.rem=goe,s.prototype.set=moe,s.prototype.get=n,s.fields=e.map(a=>a.out),s}function ok(e){this._key=e?Yr(e):$e,this.reset()}const Jn=ok.prototype;Jn.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};Jn.add=function(e){this._add.push(e)};Jn.rem=function(e){this._rem.push(e)};Jn.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,i=e.length,r=t.length,s=Array(i-r),a={};let o,u,l;for(o=0;o<r;++o)a[n(t[o])]=1;for(o=0,u=0;o<i;++o)a[n(l=e[o])]?a[n(l)]=0:s[u++]=l;return this._rem=[],this._add=s};Jn.distinct=function(e){const t=this.values(),n={};let i=t.length,r=0,s;for(;--i>=0;)s=e(t[i])+"",ve(n,s)||(n[s]=1,++r);return r};Jn.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=ZL(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext};Jn.argmin=function(e){return this.extent(e)[0]||{}};Jn.argmax=function(e){return this.extent(e)[1]||{}};Jn.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0};Jn.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0};Jn.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=WC(this.values(),e),this._get=e),this._q};Jn.q1=function(e){return this.quartile(e)[0]};Jn.q2=function(e){return this.quartile(e)[1]};Jn.q3=function(e){return this.quartile(e)[2]};Jn.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=E8(this.values(),1e3,.05,e),this._get=e),this._ci};Jn.ci0=function(e){return this.ci(e)[0]};Jn.ci1=function(e){return this.ci(e)[1]};function Ru(e){H.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Ru.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Vg},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};ce(Ru,H,{transform(e,t){const n=this,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.modified();return n.stamp=i.stamp,n.value&&(r||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=r?n.init(e):Object.create(null),t.visit(t.SOURCE,s=>n.add(s))):(n.value=n.value||n.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),i.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&i.clean(!0).runAfter(()=>this.clean()),n.changes(i)},cross(){const e=this,t=e.value,n=e._dnames,i=n.map(()=>({})),r=n.length;function s(o){let u,l,c,f;for(u in o)for(c=o[u].tuple,l=0;l<r;++l)i[l][f=c[n[l]]]=f}s(e._prev),s(t);function a(o,u,l){const c=n[l],f=i[l++];for(const d in f){const p=o?o+"|"+d:d;u[c]=f[d],l<r?a(p,u,l):t[p]||e.cell(p,u)}}a("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],i={};function r(_){const E=pe(ui(_)),S=E.length;let A=0,$;for(;A<S;++A)i[$=E[A]]||(i[$]=1,t.push($))}this._dims=pe(e.groupby),this._dnames=this._dims.map(_=>{const E=en(_);return r(_),n.push(E),E}),this.cellkey=e.key?e.key:tS(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const s=e.fields||[null],a=e.ops||["count"],o=e.aggregate_params||[null],u=e.as||[],l=s.length,c={};let f,d,p,m,y,v,b;for(l!==a.length&&K("Unmatched number of fields and aggregate ops."),b=0;b<l;++b){if(f=s[b],d=a[b],p=o[b]||null,f==null&&d!=="count"&&K("Null aggregate field specified."),y=en(f),v=R8(d,y,u[b]),n.push(v),d==="count"){this._counts.push(v);continue}m=c[y],m||(r(f),m=c[y]=[],m.field=f,this._measures.push(m)),d!=="count"&&(this._countOnly=!1),m.push(I8(d,p,v))}return this._measures=this._measures.map(_=>P8(_,_.field)),Object.create(null)},cellkey:tS(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const i=this._measures,r=i.length;n.agg=Array(r);for(let s=0;s<r;++s)n.agg[s]=new i[s](n)}return n.store&&(n.data=new ok),n},newtuple(e,t){const n=this._dnames,i=this._dims,r=i.length,s={};for(let a=0;a<r;++a)s[n[a]]=i[a](e);return t?g8(t.tuple,s):yt(s)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const i=n.agg;for(let r=0,s=i.length;r<s;++r)i[r].add(i[r].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const i=n.agg;for(let r=0,s=i.length;r<s;++r)i[r].rem(i[r].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let i=0,r=n.length;i<r;++i)t[n[i]]=e.num;if(!this._countOnly){const i=e.agg;for(let r=0,s=i.length;r<s;++r)i[r].set(t)}return t},changes(e){const t=this._adds,n=this._mods,i=this._prev,r=this._drop,s=e.add,a=e.rem,o=e.mod;let u,l,c,f;if(i)for(l in i)u=i[l],(!r||u.num)&&a.push(u.tuple);for(c=0,f=this._alen;c<f;++c)s.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)u=n[c],(u.num===0&&r?a:o).push(this.celltuple(u)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});const yoe=1e-14;function uk(e){H.call(this,null,e)}uk.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};ce(uk,H,{transform(e,t){const n=e.interval!==!1,i=this._bins(e),r=i.start,s=i.step,a=e.as||["bin0","bin1"],o=a[0],u=a[1];let l;return e.modified()?(t=t.reflow(!0),l=t.SOURCE):l=t.modified(ui(e.field))?t.ADD_MOD:t.ADD,t.visit(l,n?c=>{const f=i(c);c[o]=f,c[u]=f==null?null:r+s*(1+(f-r)/s)}:c=>c[o]=i(c)),t.modifies(n?a:o)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=w8(e),i=n.step;let r=n.start,s=r+Math.ceil((n.stop-r)/i)*i,a,o;(a=e.anchor)!=null&&(o=a-(r+i*Math.floor((a-r)/i)),r+=o,s+=o);const u=function(l){let c=ai(t(l));return c==null?null:c<r?-1/0:c>s?1/0:(c=Math.max(r,Math.min(c,s-i)),r+i*Math.floor(yoe+(c-r)/i))};return u.start=r,u.stop=n.stop,u.step=i,this.value=tr(u,ui(t),e.name||"bin_"+en(t))}});function L8(e,t,n){const i=e;let r=t||[],s=n||[],a={},o=0;return{add:u=>s.push(u),remove:u=>a[i(u)]=++o,size:()=>r.length,data:(u,l)=>(o&&(r=r.filter(c=>!a[i(c)]),a={},o=0),l&&u&&r.sort(u),s.length&&(r=u?s4(u,r,s.sort(u)):r.concat(s),s=[]),r)}}function lk(e){H.call(this,[],e)}lk.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};ce(lk,H,{transform(e,t){const n=t.fork(t.ALL),i=L8($e,this.value,n.materialize(n.ADD).add),r=e.sort,s=t.changed()||r&&(e.modified("sort")||t.modified(r.fields));return n.visit(n.REM,i.remove),this.modified(s),this.value=n.source=i.data(Tc(r),s),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function z8(e){Ot.call(this,null,voe,e)}ce(z8,Ot);function voe(e){return this.value&&!e.modified()?this.value:EC(e.fields,e.orders)}function ck(e){H.call(this,null,e)}ck.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function xoe(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}ce(ck,H,{transform(e,t){const n=f=>d=>{for(var p=xoe(o(d),e.case,s)||[],m,y=0,v=p.length;y<v;++y)a.test(m=p[y])||f(m)},i=this._parameterCheck(e,t),r=this._counts,s=this._match,a=this._stop,o=e.field,u=e.as||["text","count"],l=n(f=>r[f]=1+(r[f]||0)),c=n(f=>r[f]-=1);return i?t.visit(t.SOURCE,l):(t.visit(t.ADD,l),t.visit(t.REM,c)),this._finish(t,u)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,i=this._tuples||(this._tuples={}),r=t[0],s=t[1],a=e.fork(e.NO_SOURCE|e.NO_FIELDS);let o,u,l;for(o in n)u=i[o],l=n[o]||0,!u&&l?(i[o]=u=yt({}),u[r]=o,u[s]=l,a.add.push(u)):l===0?(u&&a.rem.push(u),n[o]=null,i[o]=null):u[s]!==l&&(u[s]=l,a.mod.push(u));return a.modifies(t)}});function fk(e){H.call(this,null,e)}fk.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};ce(fk,H,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.as||["a","b"],r=i[0],s=i[1],a=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let o=this.value;return a?(o&&(n.rem=o),o=t.materialize(t.SOURCE).source,n.add=this.value=boe(o,r,s,e.filter||Xr)):n.mod=o,n.source=this.value,n.modifies(i)}});function boe(e,t,n,i){for(var r=[],s={},a=e.length,o=0,u,l;o<a;++o)for(s[t]=l=e[o],u=0;u<a;++u)s[n]=e[u],i(s)&&(r.push(yt(s)),s={},s[t]=l);return r}const jR={kde:XC,mixture:k8,normal:YC,lognormal:C8,uniform:$8},_oe="distributions",qR="function",woe="field";function B8(e,t){const n=e[qR];ve(jR,n)||K("Unknown distribution function: "+n);const i=jR[n]();for(const r in e)r===woe?i.data((e.from||t()).map(e[r])):r===_oe?i[r](e[r].map(s=>B8(s,t))):typeof i[r]===qR&&i[r](e[r]);return i}function hk(e){H.call(this,null,e)}const U8=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],Eoe={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:U8},{name:"weights",type:"number",array:!0}]};hk.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:U8.concat(Eoe)},{name:"as",type:"string",array:!0,default:["value","density"]}]};ce(hk,H,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=B8(e.distribution,Soe(t)),r=e.steps||e.minsteps||25,s=e.steps||e.maxsteps||200;let a=e.method||"pdf";a!=="pdf"&&a!=="cdf"&&K("Invalid density method: "+a),!e.extent&&!i.data&&K("Missing density extent parameter."),a=i[a];const o=e.as||["value","density"],u=e.extent||xa(i.data()),l=ox(a,u,r,s).map(c=>{const f={};return f[o[0]]=c[0],f[o[1]]=c[1],yt(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function Soe(e){return()=>e.materialize(e.SOURCE).source}function j8(e,t){return e?e.map((n,i)=>t[i]||en(n)):null}function dk(e,t,n){const i=[],r=f=>f(u);let s,a,o,u,l,c;if(t==null)i.push(e.map(n));else for(s={},a=0,o=e.length;a<o;++a)u=e[a],l=t.map(r),c=s[l],c||(s[l]=c=[],c.dims=l,i.push(c)),c.push(n(u));return i}const q8="bin";function pk(e){H.call(this,null,e)}pk.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:q8}]};const Aoe=(e,t)=>Ug(xa(e,t))/30;ce(pk,H,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,i=dk(t.source,e.groupby,hi),r=e.smooth||!1,s=e.field,a=e.step||Aoe(n,s),o=Tc((m,y)=>s(m)-s(y)),u=e.as||q8,l=i.length;let c=1/0,f=-1/0,d=0,p;for(;d<l;++d){const m=i[d].sort(o);p=-1;for(const y of S8(m,a,r,s))y<c&&(c=y),y>f&&(f=y),m[++p][u]=y}return this.value={start:c,stop:f,step:a},t.reflow(!0).modifies(u)}});function V8(e){Ot.call(this,null,Coe,e),this.modified(!0)}ce(V8,Ot);function Coe(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:tr(n=>t(n,e),ui(t),en(t))}function gk(e){H.call(this,[void 0,void 0],e)}gk.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};ce(gk,H,{transform(e,t){const n=this.value,i=e.field,r=t.changed()||t.modified(i.fields)||e.modified("field");let s=n[0],a=n[1];if((r||s==null)&&(s=1/0,a=-1/0),t.visit(r?t.SOURCE:t.ADD,o=>{const u=ai(i(o));u!=null&&(u<s&&(s=u),u>a&&(a=u))}),!Number.isFinite(s)||!Number.isFinite(a)){let o=en(i);o&&(o=` for field "${o}"`),t.dataflow.warn(`Infinite extent${o}: [${s}, ${a}]`),s=a=void 0}this.value=[s,a]}});function mk(e,t){Ot.call(this,e),this.parent=t,this.count=0}ce(mk,Ot,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function ux(e){H.call(this,{},e),this._keys=Dh();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let i=0,r=t.active;i<r;++i)n(t[i],i,t)}}ce(ux,H,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,i){const r=this.value;let s=ve(r,e)&&r[e],a,o;return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(o=i||(o=this._group[e])&&o.tuple,a=n.dataflow,s=new mk(n.fork(n.NO_SOURCE),this),a.add(s).connect(t(a,e,o)),r[e]=s,this.activate(s)),s},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const i=e[n].detachSubflow;i&&i(),delete e[n],++t}if(t){const n=this._targets.filter(i=>i&&i.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,i=e?e.length:0;let r=0;for(;r<i;++r)t[r]=e[r];for(;r<n&&t[r]!=null;++r)t[r]=null;t.active=i},transform(e,t){const n=t.dataflow,i=e.key,r=e.subflow,s=this._keys,a=e.modified("key"),o=u=>this.subflow(u,r,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,u=>{const l=$e(u),c=s.get(l);c!==void 0&&(s.delete(l),o(c).rem(u))}),t.visit(t.ADD,u=>{const l=i(u);s.set($e(u),l),o(l).add(u)}),a||t.modified(i.fields)?t.visit(t.MOD,u=>{const l=$e(u),c=s.get(l),f=i(u);c===f?o(f).mod(u):(s.set(l,f),o(c).rem(u),o(f).add(u))}):t.changed(t.MOD)&&t.visit(t.MOD,u=>{o(s.get($e(u))).mod(u)}),a&&t.visit(t.REFLOW,u=>{const l=$e(u),c=s.get(l),f=i(u);c!==f&&(s.set(l,f),o(c).rem(u),o(f).add(u))}),t.clean()?n.runAfter(()=>{this.clean(),s.clean()}):s.empty>n.cleanThreshold&&n.runAfter(s.clean),t}});function W8(e){Ot.call(this,null,koe,e)}ce(W8,Ot);function koe(e){return this.value&&!e.modified()?this.value:Q(e.name)?pe(e.name).map(t=>Yr(t)):Yr(e.name,e.as)}function yk(e){H.call(this,Dh(),e)}yk.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};ce(yk,H,{transform(e,t){const n=t.dataflow,i=this.value,r=t.fork(),s=r.add,a=r.rem,o=r.mod,u=e.expr;let l=!0;t.visit(t.REM,f=>{const d=$e(f);i.has(d)?i.delete(d):a.push(f)}),t.visit(t.ADD,f=>{u(f,e)?s.push(f):i.set($e(f),1)});function c(f){const d=$e(f),p=u(f,e),m=i.get(d);p&&m?(i.delete(d),s.push(f)):!p&&!m?(i.set(d,1),a.push(f)):l&&p&&!m&&o.push(f)}return t.visit(t.MOD,c),e.modified()&&(l=!1,t.visit(t.REFLOW,c)),i.empty>n.cleanThreshold&&n.runAfter(i.clean),r}});function vk(e){H.call(this,[],e)}vk.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};ce(vk,H,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=j8(i,e.as||[]),s=e.index||null,a=r.length;return n.rem=this.value,t.visit(t.SOURCE,o=>{const u=i.map(m=>m(o)),l=u.reduce((m,y)=>Math.max(m,y.length),0);let c=0,f,d,p;for(;c<l;++c){for(d=UC(o),f=0;f<a;++f)d[r[f]]=(p=u[f][c])==null?null:p;s&&(d[s]=c),n.add.push(d)}}),this.value=n.source=n.add,s&&n.modifies(s),n.modifies(r)}});function xk(e){H.call(this,[],e)}xk.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};ce(xk,H,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=i.map(en),s=e.as||["key","value"],a=s[0],o=s[1],u=i.length;return n.rem=this.value,t.visit(t.SOURCE,l=>{for(let c=0,f;c<u;++c)f=UC(l),f[a]=r[c],f[o]=i[c](l),n.add.push(f)}),this.value=n.source=n.add,n.modifies(s)}});function bk(e){H.call(this,null,e)}bk.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};ce(bk,H,{transform(e,t){const n=e.expr,i=e.as,r=e.modified(),s=e.initonly?t.ADD:r?t.SOURCE:t.modified(n.fields)||t.modified(i)?t.ADD_MOD:t.ADD;return r&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(i),t.visit(s,a=>a[i]=n(a,e))}});function G8(e){H.call(this,[],e)}ce(G8,H,{transform(e,t){const n=t.fork(t.ALL),i=e.generator;let r=this.value,s=e.size-r.length,a,o,u;if(s>0){for(a=[];--s>=0;)a.push(u=yt(i(e))),r.push(u);n.add=n.add.length?n.materialize(n.ADD).add.concat(a):a}else o=r.slice(0,-s),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(o):o,r=r.slice(-s);return n.source=this.value=r,n}});const Dm={value:"value",median:v4,mean:lre,min:VE,max:Yl},$oe=[];function _k(e){H.call(this,[],e)}_k.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function Toe(e){var t=e.method||Dm.value,n;if(Dm[t]==null)K("Unrecognized imputation method: "+t);else return t===Dm.value?(n=e.value!==void 0?e.value:0,()=>n):Dm[t]}function Ooe(e){const t=e.field;return n=>n?t(n):NaN}ce(_k,H,{transform(e,t){var n=t.fork(t.ALL),i=Toe(e),r=Ooe(e),s=en(e.field),a=en(e.key),o=(e.groupby||[]).map(en),u=Foe(t.source,e.groupby,e.key,e.keyvals),l=[],c=this.value,f=u.domain.length,d,p,m,y,v,b,_,E,S,A;for(v=0,E=u.length;v<E;++v)for(d=u[v],m=d.values,p=NaN,_=0;_<f;++_)if(d[_]==null){for(y=u.domain[_],A={_impute:!0},b=0,S=m.length;b<S;++b)A[o[b]]=m[b];A[a]=y,A[s]=Number.isNaN(p)?p=i(d,r):p,l.push(yt(A))}return l.length&&(n.add=n.materialize(n.ADD).add.concat(l)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=l,n}});function Foe(e,t,n,i){var r=b=>b(v),s=[],a=i?i.slice():[],o={},u={},l,c,f,d,p,m,y,v;for(a.forEach((b,_)=>o[b]=_+1),d=0,y=e.length;d<y;++d)v=e[d],m=n(v),p=o[m]||(o[m]=a.push(m)),c=(l=t?t.map(r):$oe)+"",(f=u[c])||(f=u[c]=[],s.push(f),f.values=l),f[p-1]=v;return s.domain=a,s}function wk(e){Ru.call(this,e)}wk.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:Vg},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};ce(wk,Ru,{transform(e,t){const n=this,i=e.modified();let r;return n.value&&(i||t.modified(n._inputs,!0))?(r=n.value=i?n.init(e):{},t.visit(t.SOURCE,s=>n.add(s))):(r=n.value=n.value||this.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),n.changes(),t.visit(t.SOURCE,s=>{We(s,r[n.cellkey(s)].tuple)}),t.reflow(i).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,i;for(n=0,i=this._alen;n<i;++n)this.celltuple(e[n]),e[n]=null;for(n=0,i=this._mlen;n<i;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function Ek(e){H.call(this,null,e)}Ek.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};ce(Ek,H,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=dk(i,e.groupby,e.field),s=(e.groupby||[]).map(en),a=e.bandwidth,o=e.cumulative?"cdf":"pdf",u=e.as||["value","density"],l=[];let c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;o!=="pdf"&&o!=="cdf"&&K("Invalid density method: "+o),e.resolve==="shared"&&(c||(c=xa(i,e.field)),f=d=e.steps||d),r.forEach(p=>{const m=XC(p,a)[o],y=e.counts?p.length:1,v=c||xa(p);ox(m,v,f,d).forEach(b=>{const _={};for(let E=0;E<s.length;++E)_[s[E]]=p.dims[E];_[u[0]]=b[0],_[u[1]]=b[1]*y,l.push(yt(_))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function H8(e){Ot.call(this,null,Moe,e)}ce(H8,Ot);function Moe(e){return this.value&&!e.modified()?this.value:AC(e.fields,e.flat)}function Y8(e){H.call(this,[],e),this._pending=null}ce(Y8,H,{transform(e,t){const n=t.dataflow;return this._pending?X_(this,t,this._pending):Noe(e)?t.StopPropagation:e.values?X_(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(r=>(this._pending=pe(r.data),s=>s.touch(this)))}:n.request(e.url,e.format).then(i=>X_(this,t,pe(i.data)))}});function Noe(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function X_(e,t,n){n.forEach(yt);const i=t.fork(t.NO_FIELDS&t.NO_SOURCE);return i.rem=e.value,e.value=i.source=i.add=n,e._pending=null,i.rem.length&&i.clean(!0),i}function Sk(e){H.call(this,{},e)}Sk.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};ce(Sk,H,{transform(e,t){const n=e.fields,i=e.index,r=e.values,s=e.default==null?null:e.default,a=e.modified(),o=n.length;let u=a?t.SOURCE:t.ADD,l=t,c=e.as,f,d,p;return r?(d=r.length,o>1&&!c&&K('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==o*d&&K('The "as" parameter has too few output field names.'),c=c||r.map(en),f=function(m){for(var y=0,v=0,b,_;y<o;++y)if(_=i.get(n[y](m)),_==null)for(b=0;b<d;++b,++v)m[c[v]]=s;else for(b=0;b<d;++b,++v)m[c[v]]=r[b](_)}):(c||K("Missing output field names."),f=function(m){for(var y=0,v;y<o;++y)v=i.get(n[y](m)),m[c[y]]=v??s}),a?l=t.reflow(!0):(p=n.some(m=>t.modified(m.fields)),u|=p?t.MOD:0),t.visit(u,f),l.modifies(c)}});function X8(e){Ot.call(this,null,Roe,e)}ce(X8,Ot);function Roe(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let i=1/0,r=-1/0,s,a;for(s=0;s<n;++s)a=t[s],a[0]<i&&(i=a[0]),a[1]>r&&(r=a[1]);return[i,r]}function K8(e){Ot.call(this,null,Ioe,e)}ce(K8,Ot);function Ioe(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function J8(e){H.call(this,null,e)}ce(J8,H,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Ak(e){Ru.call(this,e)}Ak.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:Vg,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};ce(Ak,Ru,{_transform:Ru.prototype.transform,transform(e,t){return this._transform(Doe(e,t),t)}});function Doe(e,t){const n=e.field,i=e.value,r=(e.op==="count"?"__count__":e.op)||"sum",s=ui(n).concat(ui(i)),a=Loe(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:a.map(()=>r),fields:a.map(o=>Poe(o,n,i,s)),as:a.map(o=>o+""),modified:e.modified.bind(e)}}function Poe(e,t,n,i){return tr(r=>t(r)===e?n(r):NaN,i,e+"")}function Loe(e,t,n){const i={},r=[];return n.visit(n.SOURCE,s=>{const a=e(s);i[a]||(i[a]=1,r.push(a))}),r.sort(Ih),t?r.slice(0,t):r}function Q8(e){ux.call(this,e)}ce(Q8,ux,{transform(e,t){const n=e.subflow,i=e.field,r=s=>this.subflow($e(s),n,t,s);return(e.modified("field")||i&&t.modified(ui(i)))&&K("PreFacet does not support field modification."),this.initTargets(),i?(t.visit(t.MOD,s=>{const a=r(s);i(s).forEach(o=>a.mod(o))}),t.visit(t.ADD,s=>{const a=r(s);i(s).forEach(o=>a.add(yt(o)))}),t.visit(t.REM,s=>{const a=r(s);i(s).forEach(o=>a.rem(o))})):(t.visit(t.MOD,s=>r(s).mod(s)),t.visit(t.ADD,s=>r(s).add(s)),t.visit(t.REM,s=>r(s).rem(s))),t.clean()&&t.runAfter(()=>this.clean()),t}});function Ck(e){H.call(this,null,e)}Ck.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};ce(Ck,H,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=j8(e.fields,e.as||[]),s=i?(o,u)=>zoe(o,u,i,r):ex;let a;return this.value?a=this.value:(t=t.addAll(),a=this.value={}),t.visit(t.REM,o=>{const u=$e(o);n.rem.push(a[u]),a[u]=null}),t.visit(t.ADD,o=>{const u=s(o,yt({}));a[$e(o)]=u,n.add.push(u)}),t.visit(t.MOD,o=>{n.mod.push(s(o,a[$e(o)]))}),n}});function zoe(e,t,n,i){for(let r=0,s=n.length;r<s;++r)t[i[r]]=n[r](e);return t}function Z8(e){H.call(this,null,e)}ce(Z8,H,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function kk(e){H.call(this,null,e)}kk.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const Boe=1e-14;ce(kk,H,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const r=t.materialize(t.SOURCE).source,s=dk(r,e.groupby,e.field),a=(e.groupby||[]).map(en),o=[],u=e.step||.01,l=e.probs||pr(u/2,1-Boe,u),c=l.length;return s.forEach(f=>{const d=VC(f,l);for(let p=0;p<c;++p){const m={};for(let y=0;y<a.length;++y)m[a[y]]=f.dims[y];m[i[0]]=l[p],m[i[1]]=d[p],o.push(yt(m))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=o,n}});function e9(e){H.call(this,null,e)}ce(e9,H,{transform(e,t){let n,i;return this.value?i=this.value:(n=t=t.addAll(),i=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,r=>{const s=$e(r);n.rem.push(i[s]),i[s]=null}),t.visit(t.ADD,r=>{const s=UC(r);i[$e(r)]=s,n.add.push(s)}),t.visit(t.MOD,r=>{const s=i[$e(r)];for(const a in r)s[a]=r[a],n.modifies(a);n.mod.push(s)})),n}});function $k(e){H.call(this,[],e),this.count=0}$k.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};ce($k,H,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.modified("size"),r=e.size,s=this.value.reduce((c,f)=>(c[$e(f)]=1,c),{});let a=this.value,o=this.count,u=0;function l(c){let f,d;a.length<r?a.push(c):(d=~~((o+1)*Jr()),d<a.length&&d>=u&&(f=a[d],s[$e(f)]&&n.rem.push(f),a[d]=c)),++o}if(t.rem.length&&(t.visit(t.REM,c=>{const f=$e(c);s[f]&&(s[f]=-1,n.rem.push(c)),--o}),a=a.filter(c=>s[$e(c)]!==-1)),(t.rem.length||i)&&a.length<r&&t.source&&(u=o=a.length,t.visit(t.SOURCE,c=>{s[$e(c)]||l(c)}),u=-1),i&&a.length>r){const c=a.length-r;for(let f=0;f<c;++f)s[$e(a[f])]=-1,n.rem.push(a[f]);a=a.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{s[$e(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,l),(t.add.length||u<0)&&(n.add=a.filter(c=>!s[$e(c)])),this.count=o,this.value=n.source=a,n}});function Tk(e){H.call(this,null,e)}Tk.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};ce(Tk,H,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),i=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=pr(e.start,e.stop,e.step||1).map(r=>{const s={};return s[i]=r,yt(s)}),n.add=t.add.concat(this.value),n}});function t9(e){H.call(this,null,e),this.modified(!0)}ce(t9,H,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function Ok(e){H.call(this,null,e)}const n9=["unit0","unit1"];Ok.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:MC,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:n9}]};ce(Ok,H,{transform(e,t){const n=e.field,i=e.interval!==!1,r=e.timezone==="utc",s=this._floor(e,t),a=(r?Uh:Bh)(s.unit).offset,o=e.as||n9,u=o[0],l=o[1],c=s.step;let f=s.start||1/0,d=s.stop||-1/0,p=t.ADD;return(e.modified()||t.changed(t.REM)||t.modified(ui(n)))&&(t=t.reflow(!0),p=t.SOURCE,f=1/0,d=-1/0),t.visit(p,m=>{const y=n(m);let v,b;y==null?(m[u]=null,i&&(m[l]=null)):(m[u]=v=b=s(y),i&&(m[l]=b=a(v,c)),v<f&&(f=v),b>d&&(d=b))}),s.start=f,s.stop=d,t.modifies(i?o:u)},_floor(e,t){const n=e.timezone==="utc",{units:i,step:r}=e.units?{units:e.units,step:e.step||1}:G4({extent:e.extent||xa(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),s=NC(i),a=this.value||{},o=(n?P4:D4)(s,r);return o.unit=ot(s),o.units=s,o.step=r,o.start=a.start,o.stop=a.stop,this.value=o}});function i9(e){H.call(this,Dh(),e)}ce(i9,H,{transform(e,t){const n=t.dataflow,i=e.field,r=this.value,s=o=>r.set(i(o),o);let a=!0;return e.modified("field")||t.modified(i.fields)?(r.clear(),t.visit(t.SOURCE,s)):t.changed()?(t.visit(t.REM,o=>r.delete(i(o))),t.visit(t.ADD,s)):a=!1,this.modified(a),r.empty>n.cleanThreshold&&n.runAfter(r.clean),t.fork()}});function r9(e){H.call(this,null,e)}ce(r9,H,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(Tc(e.sort)):t.source).map(e.field))}});function Uoe(e,t,n,i){const r=rg[e](t,n);return{init:r.init||pu,update:function(s,a){a[i]=r.next(s)}}}const rg={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?++e:e}}},percent_rank:function(){const e=rg.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,i=t.compare;let r=t.index;if(e<r){for(;r+1<n.length&&!i(n[r],n[r+1]);)++r;e=r}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||K("ntile num must be greater than zero.");const n=rg.cume_dist(),i=n.next;return{init:n.init,next:r=>Math.ceil(t*i(r))}},lag:function(e,t){return t=+t||1,{next:n=>{const i=n.index-t;return i>=0?e(n.data[i]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const i=n.index+t,r=n.data;return i<r.length?e(r[i]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||K("nth_value nth must be greater than zero."),{next:n=>{const i=n.i0+(t-1);return i<n.i1?e(n.data[i]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const i=e(n.data[n.index]);return i!=null?t=i:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:i=>{const r=i.data;return i.index<=n?t:(n=joe(e,r,i.index))<0?(n=r.length,t=null):t=e(r[n])}}}};function joe(e,t,n){for(let i=t.length;n<i;++n)if(e(t[n])!=null)return n;return-1}const qoe=Object.keys(rg);function s9(e){const t=pe(e.ops),n=pe(e.fields),i=pe(e.params),r=pe(e.aggregate_params),s=pe(e.as),a=this.outputs=[],o=this.windows=[],u={},l={},c=[],f=[];let d=!0;function p(m){pe(ui(m)).forEach(y=>u[y]=1)}p(e.sort),t.forEach((m,y)=>{const v=n[y],b=i[y],_=r[y]||null,E=en(v),S=R8(m,E,s[y]);if(p(v),a.push(S),ve(rg,m))o.push(Uoe(m,v,b,S));else{if(v==null&&m!=="count"&&K("Null aggregate field specified."),m==="count"){c.push(S);return}d=!1;let A=l[E];A||(A=l[E]=[],A.field=v,f.push(A)),A.push(I8(m,_,S))}}),(c.length||f.length)&&(this.cell=Voe(f,c,d)),this.inputs=Object.keys(u)}const a9=s9.prototype;a9.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()};a9.update=function(e,t){const n=this.cell,i=this.windows,r=e.data,s=i&&i.length;let a;if(n){for(a=e.p0;a<e.i0;++a)n.rem(r[a]);for(a=e.p1;a<e.i1;++a)n.add(r[a]);n.set(t)}for(a=0;a<s;++a)i[a].update(e,t)};function Voe(e,t,n){e=e.map(u=>P8(u,u.field));const i={num:0,agg:null,store:!1,count:t};if(!n)for(var r=e.length,s=i.agg=Array(r),a=0;a<r;++a)s[a]=new e[a](i);if(i.store)var o=i.data=new ok;return i.add=function(u){if(i.num+=1,!n){o&&o.add(u);for(let l=0;l<r;++l)s[l].add(s[l].get(u),u)}},i.rem=function(u){if(i.num-=1,!n){o&&o.rem(u);for(let l=0;l<r;++l)s[l].rem(s[l].get(u),u)}},i.set=function(u){let l,c;for(o&&o.values(),l=0,c=t.length;l<c;++l)u[t[l]]=i.num;if(!n)for(l=0,c=s.length;l<c;++l)s[l].set(u)},i.init=function(){i.num=0,o&&o.reset();for(let u=0;u<r;++u)s[u].init()},i}function Fk(e){H.call(this,{},e),this._mlen=0,this._mods=[]}Fk.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:qoe.concat(Vg)},{name:"params",type:"number",null:!0,array:!0},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};ce(Fk,H,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),i=Tc(e.sort),r=tS(e.groupby),s=o=>this.group(r(o));let a=this.state;(!a||n)&&(a=this.state=new s9(e)),n||t.modified(a.inputs)?(this.value={},t.visit(t.SOURCE,o=>s(o).add(o))):(t.visit(t.REM,o=>s(o).remove(o)),t.visit(t.ADD,o=>s(o).add(o)));for(let o=0,u=this._mlen;o<u;++o)Woe(this._mods[o],a,i,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(a.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=L8($e),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function Woe(e,t,n,i){const r=i.sort,s=r&&!i.ignorePeers,a=i.frame||[null,0],o=e.data(n),u=o.length,l=s?Ph(r):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:o,compare:r||di(-1)};t.init();for(let f=0;f<u;++f)Goe(c,a,f,u),s&&Hoe(c,l),t.update(c,o[f])}function Goe(e,t,n,i){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?i:Math.min(i,n+Math.abs(t[1])+1),e.index=n}function Hoe(e,t){const n=e.i0,i=e.i1-1,r=e.compare,s=e.data,a=s.length-1;n>0&&!r(s[n],s[n-1])&&(e.i0=t.left(s,s[n])),i<a&&!r(s[i],s[i+1])&&(e.i1=t.right(s,s[i]))}const Yoe=Object.freeze(Object.defineProperty({__proto__:null,aggregate:Ru,bin:uk,collect:lk,compare:z8,countpattern:ck,cross:fk,density:hk,dotbin:pk,expression:V8,extent:gk,facet:ux,field:W8,filter:yk,flatten:vk,fold:xk,formula:bk,generate:G8,impute:_k,joinaggregate:wk,kde:Ek,key:H8,load:Y8,lookup:Sk,multiextent:X8,multivalues:K8,params:J8,pivot:Ak,prefacet:Q8,project:Ck,proxy:Z8,quantile:kk,relay:e9,sample:$k,sequence:Tk,sieve:t9,subflow:mk,timeunit:Ok,tupleindex:i9,values:r9,window:Fk},Symbol.toStringTag,{value:"Module"}));function xt(e){return function(){return e}}const VR=Math.abs,ei=Math.atan2,Al=Math.cos,Xoe=Math.max,K_=Math.min,Js=Math.sin,Vl=Math.sqrt,ni=1e-12,th=Math.PI,ly=th/2,o9=2*th;function Koe(e){return e>1?0:e<-1?th:Math.acos(e)}function WR(e){return e>=1?ly:e<=-1?-ly:Math.asin(e)}const nS=Math.PI,iS=2*nS,Dl=1e-6,Joe=iS-Dl;function u9(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function Qoe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return u9;const n=10**t;return function(i){this._+=i[0];for(let r=1,s=i.length;r<s;++r)this._+=Math.round(arguments[r]*n)/n+i[r]}}let Mk=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?u9:Qoe(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,i,r){this._append`Q${+t},${+n},${this._x1=+i},${this._y1=+r}`}bezierCurveTo(t,n,i,r,s,a){this._append`C${+t},${+n},${+i},${+r},${this._x1=+s},${this._y1=+a}`}arcTo(t,n,i,r,s){if(t=+t,n=+n,i=+i,r=+r,s=+s,s<0)throw new Error(`negative radius: ${s}`);let a=this._x1,o=this._y1,u=i-t,l=r-n,c=a-t,f=o-n,d=c*c+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(d>Dl)if(!(Math.abs(f*u-l*c)>Dl)||!s)this._append`L${this._x1=t},${this._y1=n}`;else{let p=i-a,m=r-o,y=u*u+l*l,v=p*p+m*m,b=Math.sqrt(y),_=Math.sqrt(d),E=s*Math.tan((nS-Math.acos((y+d-v)/(2*b*_)))/2),S=E/_,A=E/b;Math.abs(S-1)>Dl&&this._append`L${t+S*c},${n+S*f}`,this._append`A${s},${s},0,0,${+(f*p>c*m)},${this._x1=t+A*u},${this._y1=n+A*l}`}}arc(t,n,i,r,s,a){if(t=+t,n=+n,i=+i,a=!!a,i<0)throw new Error(`negative radius: ${i}`);let o=i*Math.cos(r),u=i*Math.sin(r),l=t+o,c=n+u,f=1^a,d=a?r-s:s-r;this._x1===null?this._append`M${l},${c}`:(Math.abs(this._x1-l)>Dl||Math.abs(this._y1-c)>Dl)&&this._append`L${l},${c}`,i&&(d<0&&(d=d%iS+iS),d>Joe?this._append`A${i},${i},0,1,${f},${t-o},${n-u}A${i},${i},0,1,${f},${this._x1=l},${this._y1=c}`:d>Dl&&this._append`A${i},${i},0,${+(d>=nS)},${f},${this._x1=t+i*Math.cos(s)},${this._y1=n+i*Math.sin(s)}`)}rect(t,n,i,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${i=+i}v${+r}h${-i}Z`}toString(){return this._}};function lx(){return new Mk}lx.prototype=Mk.prototype;function cx(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const i=Math.floor(n);if(!(i>=0))throw new RangeError(`invalid digits: ${n}`);t=i}return e},()=>new Mk(t)}function Zoe(e){return e.innerRadius}function eue(e){return e.outerRadius}function tue(e){return e.startAngle}function nue(e){return e.endAngle}function iue(e){return e&&e.padAngle}function rue(e,t,n,i,r,s,a,o){var u=n-e,l=i-t,c=a-r,f=o-s,d=f*u-c*l;if(!(d*d<ni))return d=(c*(t-s)-f*(e-r))/d,[e+d*u,t+d*l]}function Pm(e,t,n,i,r,s,a){var o=e-n,u=t-i,l=(a?s:-s)/Vl(o*o+u*u),c=l*u,f=-l*o,d=e+c,p=t+f,m=n+c,y=i+f,v=(d+m)/2,b=(p+y)/2,_=m-d,E=y-p,S=_*_+E*E,A=r-s,$=d*y-m*p,C=(E<0?-1:1)*Vl(Xoe(0,A*A*S-$*$)),M=($*E-_*C)/S,N=(-$*_-E*C)/S,P=($*E+_*C)/S,D=(-$*_+E*C)/S,W=M-v,q=N-b,z=P-v,R=D-b;return W*W+q*q>z*z+R*R&&(M=P,N=D),{cx:M,cy:N,x01:-c,y01:-f,x11:M*(r/A-1),y11:N*(r/A-1)}}function sue(){var e=Zoe,t=eue,n=xt(0),i=null,r=tue,s=nue,a=iue,o=null,u=cx(l);function l(){var c,f,d=+e.apply(this,arguments),p=+t.apply(this,arguments),m=r.apply(this,arguments)-ly,y=s.apply(this,arguments)-ly,v=VR(y-m),b=y>m;if(o||(o=c=u()),p<d&&(f=p,p=d,d=f),!(p>ni))o.moveTo(0,0);else if(v>o9-ni)o.moveTo(p*Al(m),p*Js(m)),o.arc(0,0,p,m,y,!b),d>ni&&(o.moveTo(d*Al(y),d*Js(y)),o.arc(0,0,d,y,m,b));else{var _=m,E=y,S=m,A=y,$=v,C=v,M=a.apply(this,arguments)/2,N=M>ni&&(i?+i.apply(this,arguments):Vl(d*d+p*p)),P=K_(VR(p-d)/2,+n.apply(this,arguments)),D=P,W=P,q,z;if(N>ni){var R=WR(N/d*Js(M)),U=WR(N/p*Js(M));($-=R*2)>ni?(R*=b?1:-1,S+=R,A-=R):($=0,S=A=(m+y)/2),(C-=U*2)>ni?(U*=b?1:-1,_+=U,E-=U):(C=0,_=E=(m+y)/2)}var G=p*Al(_),Z=p*Js(_),J=d*Al(A),he=d*Js(A);if(P>ni){var we=p*Al(E),Ce=p*Js(E),ze=d*Al(S),bt=d*Js(S),Ie;if(v<th)if(Ie=rue(G,Z,ze,bt,we,Ce,J,he)){var nn=G-Ie[0],Va=Z-Ie[1],Di=we-Ie[0],ye=Ce-Ie[1],Ue=1/Js(Koe((nn*Di+Va*ye)/(Vl(nn*nn+Va*Va)*Vl(Di*Di+ye*ye)))/2),je=Vl(Ie[0]*Ie[0]+Ie[1]*Ie[1]);D=K_(P,(d-je)/(Ue-1)),W=K_(P,(p-je)/(Ue+1))}else D=W=0}C>ni?W>ni?(q=Pm(ze,bt,G,Z,p,W,b),z=Pm(we,Ce,J,he,p,W,b),o.moveTo(q.cx+q.x01,q.cy+q.y01),W<P?o.arc(q.cx,q.cy,W,ei(q.y01,q.x01),ei(z.y01,z.x01),!b):(o.arc(q.cx,q.cy,W,ei(q.y01,q.x01),ei(q.y11,q.x11),!b),o.arc(0,0,p,ei(q.cy+q.y11,q.cx+q.x11),ei(z.cy+z.y11,z.cx+z.x11),!b),o.arc(z.cx,z.cy,W,ei(z.y11,z.x11),ei(z.y01,z.x01),!b))):(o.moveTo(G,Z),o.arc(0,0,p,_,E,!b)):o.moveTo(G,Z),!(d>ni)||!($>ni)?o.lineTo(J,he):D>ni?(q=Pm(J,he,we,Ce,d,-D,b),z=Pm(G,Z,ze,bt,d,-D,b),o.lineTo(q.cx+q.x01,q.cy+q.y01),D<P?o.arc(q.cx,q.cy,D,ei(q.y01,q.x01),ei(z.y01,z.x01),!b):(o.arc(q.cx,q.cy,D,ei(q.y01,q.x01),ei(q.y11,q.x11),!b),o.arc(0,0,d,ei(q.cy+q.y11,q.cx+q.x11),ei(z.cy+z.y11,z.cx+z.x11),b),o.arc(z.cx,z.cy,D,ei(z.y11,z.x11),ei(z.y01,z.x01),!b))):o.arc(0,0,d,A,S,b)}if(o.closePath(),c)return o=null,c+""||null}return l.centroid=function(){var c=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,f=(+r.apply(this,arguments)+ +s.apply(this,arguments))/2-th/2;return[Al(f)*c,Js(f)*c]},l.innerRadius=function(c){return arguments.length?(e=typeof c=="function"?c:xt(+c),l):e},l.outerRadius=function(c){return arguments.length?(t=typeof c=="function"?c:xt(+c),l):t},l.cornerRadius=function(c){return arguments.length?(n=typeof c=="function"?c:xt(+c),l):n},l.padRadius=function(c){return arguments.length?(i=c==null?null:typeof c=="function"?c:xt(+c),l):i},l.startAngle=function(c){return arguments.length?(r=typeof c=="function"?c:xt(+c),l):r},l.endAngle=function(c){return arguments.length?(s=typeof c=="function"?c:xt(+c),l):s},l.padAngle=function(c){return arguments.length?(a=typeof c=="function"?c:xt(+c),l):a},l.context=function(c){return arguments.length?(o=c??null,l):o},l}function l9(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function c9(e){this._context=e}c9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Nk(e){return new c9(e)}function f9(e){return e[0]}function h9(e){return e[1]}function d9(e,t){var n=xt(!0),i=null,r=Nk,s=null,a=cx(o);e=typeof e=="function"?e:e===void 0?f9:xt(e),t=typeof t=="function"?t:t===void 0?h9:xt(t);function o(u){var l,c=(u=l9(u)).length,f,d=!1,p;for(i==null&&(s=r(p=a())),l=0;l<=c;++l)!(l<c&&n(f=u[l],l,u))===d&&((d=!d)?s.lineStart():s.lineEnd()),d&&s.point(+e(f,l,u),+t(f,l,u));if(p)return s=null,p+""||null}return o.x=function(u){return arguments.length?(e=typeof u=="function"?u:xt(+u),o):e},o.y=function(u){return arguments.length?(t=typeof u=="function"?u:xt(+u),o):t},o.defined=function(u){return arguments.length?(n=typeof u=="function"?u:xt(!!u),o):n},o.curve=function(u){return arguments.length?(r=u,i!=null&&(s=r(i)),o):r},o.context=function(u){return arguments.length?(u==null?i=s=null:s=r(i=u),o):i},o}function p9(e,t,n){var i=null,r=xt(!0),s=null,a=Nk,o=null,u=cx(l);e=typeof e=="function"?e:e===void 0?f9:xt(+e),t=typeof t=="function"?t:xt(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?h9:xt(+n);function l(f){var d,p,m,y=(f=l9(f)).length,v,b=!1,_,E=new Array(y),S=new Array(y);for(s==null&&(o=a(_=u())),d=0;d<=y;++d){if(!(d<y&&r(v=f[d],d,f))===b)if(b=!b)p=d,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),m=d-1;m>=p;--m)o.point(E[m],S[m]);o.lineEnd(),o.areaEnd()}b&&(E[d]=+e(v,d,f),S[d]=+t(v,d,f),o.point(i?+i(v,d,f):E[d],n?+n(v,d,f):S[d]))}if(_)return o=null,_+""||null}function c(){return d9().defined(r).curve(a).context(s)}return l.x=function(f){return arguments.length?(e=typeof f=="function"?f:xt(+f),i=null,l):e},l.x0=function(f){return arguments.length?(e=typeof f=="function"?f:xt(+f),l):e},l.x1=function(f){return arguments.length?(i=f==null?null:typeof f=="function"?f:xt(+f),l):i},l.y=function(f){return arguments.length?(t=typeof f=="function"?f:xt(+f),n=null,l):t},l.y0=function(f){return arguments.length?(t=typeof f=="function"?f:xt(+f),l):t},l.y1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:xt(+f),l):n},l.lineX0=l.lineY0=function(){return c().x(e).y(t)},l.lineY1=function(){return c().x(e).y(n)},l.lineX1=function(){return c().x(i).y(t)},l.defined=function(f){return arguments.length?(r=typeof f=="function"?f:xt(!!f),l):r},l.curve=function(f){return arguments.length?(a=f,s!=null&&(o=a(s)),l):a},l.context=function(f){return arguments.length?(f==null?s=o=null:o=a(s=f),l):s},l}const aue={draw(e,t){const n=Vl(t/th);e.moveTo(n,0),e.arc(0,0,n,0,o9)}};function oue(e,t){let n=null,i=cx(r);e=typeof e=="function"?e:xt(e||aue),t=typeof t=="function"?t:xt(t===void 0?64:+t);function r(){let s;if(n||(n=s=i()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),s)return n=null,s+""||null}return r.type=function(s){return arguments.length?(e=typeof s=="function"?s:xt(s),r):e},r.size=function(s){return arguments.length?(t=typeof s=="function"?s:xt(+s),r):t},r.context=function(s){return arguments.length?(n=s??null,r):n},r}function Iu(){}function cy(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function fx(e){this._context=e}fx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:cy(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:cy(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function uue(e){return new fx(e)}function g9(e){this._context=e}g9.prototype={areaStart:Iu,areaEnd:Iu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:cy(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function lue(e){return new g9(e)}function m9(e){this._context=e}m9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:cy(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function cue(e){return new m9(e)}function y9(e,t){this._basis=new fx(e),this._beta=t}y9.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var i=e[0],r=t[0],s=e[n]-i,a=t[n]-r,o=-1,u;++o<=n;)u=o/n,this._basis.point(this._beta*e[o]+(1-this._beta)*(i+u*s),this._beta*t[o]+(1-this._beta)*(r+u*a));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const fue=function e(t){function n(i){return t===1?new fx(i):new y9(i,t)}return n.beta=function(i){return e(+i)},n}(.85);function fy(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function Rk(e,t){this._context=e,this._k=(1-t)/6}Rk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:fy(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:fy(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const hue=function e(t){function n(i){return new Rk(i,t)}return n.tension=function(i){return e(+i)},n}(0);function Ik(e,t){this._context=e,this._k=(1-t)/6}Ik.prototype={areaStart:Iu,areaEnd:Iu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:fy(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const due=function e(t){function n(i){return new Ik(i,t)}return n.tension=function(i){return e(+i)},n}(0);function Dk(e,t){this._context=e,this._k=(1-t)/6}Dk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:fy(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const pue=function e(t){function n(i){return new Dk(i,t)}return n.tension=function(i){return e(+i)},n}(0);function Pk(e,t,n){var i=e._x1,r=e._y1,s=e._x2,a=e._y2;if(e._l01_a>ni){var o=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);i=(i*o-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,r=(r*o-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>ni){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);s=(s*l+e._x1*e._l23_2a-t*e._l12_2a)/c,a=(a*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(i,r,s,a,e._x2,e._y2)}function v9(e,t){this._context=e,this._alpha=t}v9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Pk(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const gue=function e(t){function n(i){return t?new v9(i,t):new Rk(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function x9(e,t){this._context=e,this._alpha=t}x9.prototype={areaStart:Iu,areaEnd:Iu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Pk(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const mue=function e(t){function n(i){return t?new x9(i,t):new Ik(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function b9(e,t){this._context=e,this._alpha=t}b9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Pk(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const yue=function e(t){function n(i){return t?new b9(i,t):new Dk(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function _9(e){this._context=e}_9.prototype={areaStart:Iu,areaEnd:Iu,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function vue(e){return new _9(e)}function GR(e){return e<0?-1:1}function HR(e,t,n){var i=e._x1-e._x0,r=t-e._x1,s=(e._y1-e._y0)/(i||r<0&&-0),a=(n-e._y1)/(r||i<0&&-0),o=(s*r+a*i)/(i+r);return(GR(s)+GR(a))*Math.min(Math.abs(s),Math.abs(a),.5*Math.abs(o))||0}function YR(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function J_(e,t,n){var i=e._x0,r=e._y0,s=e._x1,a=e._y1,o=(s-i)/3;e._context.bezierCurveTo(i+o,r+o*t,s-o,a-o*n,s,a)}function hy(e){this._context=e}hy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:J_(this,this._t0,YR(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,J_(this,YR(this,n=HR(this,e,t)),n);break;default:J_(this,this._t0,n=HR(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function w9(e){this._context=new E9(e)}(w9.prototype=Object.create(hy.prototype)).point=function(e,t){hy.prototype.point.call(this,t,e)};function E9(e){this._context=e}E9.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,i,r,s){this._context.bezierCurveTo(t,e,i,n,s,r)}};function xue(e){return new hy(e)}function bue(e){return new w9(e)}function S9(e){this._context=e}S9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var i=XR(e),r=XR(t),s=0,a=1;a<n;++s,++a)this._context.bezierCurveTo(i[0][s],r[0][s],i[1][s],r[1][s],e[a],t[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function XR(e){var t,n=e.length-1,i,r=new Array(n),s=new Array(n),a=new Array(n);for(r[0]=0,s[0]=2,a[0]=e[0]+2*e[1],t=1;t<n-1;++t)r[t]=1,s[t]=4,a[t]=4*e[t]+2*e[t+1];for(r[n-1]=2,s[n-1]=7,a[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)i=r[t]/s[t-1],s[t]-=i,a[t]-=i*a[t-1];for(r[n-1]=a[n-1]/s[n-1],t=n-2;t>=0;--t)r[t]=(a[t]-r[t+1])/s[t];for(s[n-1]=(e[n]+r[n-1])/2,t=0;t<n-1;++t)s[t]=2*e[t+1]-r[t+1];return[r,s]}function _ue(e){return new S9(e)}function hx(e,t){this._context=e,this._t=t}hx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function wue(e){return new hx(e,.5)}function Eue(e){return new hx(e,0)}function Sue(e){return new hx(e,1)}function $u(e,t){if(typeof document<"u"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const Aue=()=>typeof Image<"u"?Image:null;function Oa(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Ju(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const rS=Symbol("implicit");function Lk(){var e=new hR,t=[],n=[],i=rS;function r(s){let a=e.get(s);if(a===void 0){if(i!==rS)return i;e.set(s,a=t.push(s)-1)}return n[a%n.length]}return r.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new hR;for(const a of s)e.has(a)||e.set(a,t.push(a)-1);return r},r.range=function(s){return arguments.length?(n=Array.from(s),r):n.slice()},r.unknown=function(s){return arguments.length?(i=s,r):i},r.copy=function(){return Lk(t,n).unknown(i)},Oa.apply(r,arguments),r}function qh(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Wg(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function Qu(){}var sc=.7,nh=1/sc,Lf="\\s*([+-]?\\d+)\\s*",sg="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",da="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Cue=/^#([0-9a-f]{3,8})$/,kue=new RegExp(`^rgb\\(${Lf},${Lf},${Lf}\\)$`),$ue=new RegExp(`^rgb\\(${da},${da},${da}\\)$`),Tue=new RegExp(`^rgba\\(${Lf},${Lf},${Lf},${sg}\\)$`),Oue=new RegExp(`^rgba\\(${da},${da},${da},${sg}\\)$`),Fue=new RegExp(`^hsl\\(${sg},${da},${da}\\)$`),Mue=new RegExp(`^hsla\\(${sg},${da},${da},${sg}\\)$`),KR={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};qh(Qu,ag,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:JR,formatHex:JR,formatHex8:Nue,formatHsl:Rue,formatRgb:QR,toString:QR});function JR(){return this.rgb().formatHex()}function Nue(){return this.rgb().formatHex8()}function Rue(){return A9(this).formatHsl()}function QR(){return this.rgb().formatRgb()}function ag(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Cue.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?ZR(t):n===3?new Tn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Lm(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Lm(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=kue.exec(e))?new Tn(t[1],t[2],t[3],1):(t=$ue.exec(e))?new Tn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Tue.exec(e))?Lm(t[1],t[2],t[3],t[4]):(t=Oue.exec(e))?Lm(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Fue.exec(e))?nI(t[1],t[2]/100,t[3]/100,1):(t=Mue.exec(e))?nI(t[1],t[2]/100,t[3]/100,t[4]):KR.hasOwnProperty(e)?ZR(KR[e]):e==="transparent"?new Tn(NaN,NaN,NaN,0):null}function ZR(e){return new Tn(e>>16&255,e>>8&255,e&255,1)}function Lm(e,t,n,i){return i<=0&&(e=t=n=NaN),new Tn(e,t,n,i)}function zk(e){return e instanceof Qu||(e=ag(e)),e?(e=e.rgb(),new Tn(e.r,e.g,e.b,e.opacity)):new Tn}function Du(e,t,n,i){return arguments.length===1?zk(e):new Tn(e,t,n,i??1)}function Tn(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}qh(Tn,Du,Wg(Qu,{brighter(e){return e=e==null?nh:Math.pow(nh,e),new Tn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?sc:Math.pow(sc,e),new Tn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Tn(Xl(this.r),Xl(this.g),Xl(this.b),dy(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:eI,formatHex:eI,formatHex8:Iue,formatRgb:tI,toString:tI}));function eI(){return`#${Wl(this.r)}${Wl(this.g)}${Wl(this.b)}`}function Iue(){return`#${Wl(this.r)}${Wl(this.g)}${Wl(this.b)}${Wl((isNaN(this.opacity)?1:this.opacity)*255)}`}function tI(){const e=dy(this.opacity);return`${e===1?"rgb(":"rgba("}${Xl(this.r)}, ${Xl(this.g)}, ${Xl(this.b)}${e===1?")":`, ${e})`}`}function dy(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Xl(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Wl(e){return e=Xl(e),(e<16?"0":"")+e.toString(16)}function nI(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new bs(e,t,n,i)}function A9(e){if(e instanceof bs)return new bs(e.h,e.s,e.l,e.opacity);if(e instanceof Qu||(e=ag(e)),!e)return new bs;if(e instanceof bs)return e;e=e.rgb();var t=e.r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),s=Math.max(t,n,i),a=NaN,o=s-r,u=(s+r)/2;return o?(t===s?a=(n-i)/o+(n<i)*6:n===s?a=(i-t)/o+2:a=(t-n)/o+4,o/=u<.5?s+r:2-s-r,a*=60):o=u>0&&u<1?0:a,new bs(a,o,u,e.opacity)}function py(e,t,n,i){return arguments.length===1?A9(e):new bs(e,t,n,i??1)}function bs(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}qh(bs,py,Wg(Qu,{brighter(e){return e=e==null?nh:Math.pow(nh,e),new bs(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?sc:Math.pow(sc,e),new bs(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new Tn(Q_(e>=240?e-240:e+120,r,i),Q_(e,r,i),Q_(e<120?e+240:e-120,r,i),this.opacity)},clamp(){return new bs(iI(this.h),zm(this.s),zm(this.l),dy(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=dy(this.opacity);return`${e===1?"hsl(":"hsla("}${iI(this.h)}, ${zm(this.s)*100}%, ${zm(this.l)*100}%${e===1?")":`, ${e})`}`}}));function iI(e){return e=(e||0)%360,e<0?e+360:e}function zm(e){return Math.max(0,Math.min(1,e||0))}function Q_(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const C9=Math.PI/180,k9=180/Math.PI,gy=18,$9=.96422,T9=1,O9=.82521,F9=4/29,zf=6/29,M9=3*zf*zf,Due=zf*zf*zf;function N9(e){if(e instanceof pa)return new pa(e.l,e.a,e.b,e.opacity);if(e instanceof mo)return R9(e);e instanceof Tn||(e=zk(e));var t=nw(e.r),n=nw(e.g),i=nw(e.b),r=Z_((.2225045*t+.7168786*n+.0606169*i)/T9),s,a;return t===n&&n===i?s=a=r:(s=Z_((.4360747*t+.3850649*n+.1430804*i)/$9),a=Z_((.0139322*t+.0971045*n+.7141733*i)/O9)),new pa(116*r-16,500*(s-r),200*(r-a),e.opacity)}function my(e,t,n,i){return arguments.length===1?N9(e):new pa(e,t,n,i??1)}function pa(e,t,n,i){this.l=+e,this.a=+t,this.b=+n,this.opacity=+i}qh(pa,my,Wg(Qu,{brighter(e){return new pa(this.l+gy*(e??1),this.a,this.b,this.opacity)},darker(e){return new pa(this.l-gy*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=$9*ew(t),e=T9*ew(e),n=O9*ew(n),new Tn(tw(3.1338561*t-1.6168667*e-.4906146*n),tw(-.9787684*t+1.9161415*e+.033454*n),tw(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function Z_(e){return e>Due?Math.pow(e,1/3):e/M9+F9}function ew(e){return e>zf?e*e*e:M9*(e-F9)}function tw(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function nw(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Pue(e){if(e instanceof mo)return new mo(e.h,e.c,e.l,e.opacity);if(e instanceof pa||(e=N9(e)),e.a===0&&e.b===0)return new mo(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*k9;return new mo(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function yy(e,t,n,i){return arguments.length===1?Pue(e):new mo(e,t,n,i??1)}function mo(e,t,n,i){this.h=+e,this.c=+t,this.l=+n,this.opacity=+i}function R9(e){if(isNaN(e.h))return new pa(e.l,0,0,e.opacity);var t=e.h*C9;return new pa(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}qh(mo,yy,Wg(Qu,{brighter(e){return new mo(this.h,this.c,this.l+gy*(e??1),this.opacity)},darker(e){return new mo(this.h,this.c,this.l-gy*(e??1),this.opacity)},rgb(){return R9(this).rgb()}}));var I9=-.14861,Bk=1.78277,Uk=-.29227,dx=-.90649,og=1.97294,rI=og*dx,sI=og*Bk,aI=Bk*Uk-dx*I9;function Lue(e){if(e instanceof Kl)return new Kl(e.h,e.s,e.l,e.opacity);e instanceof Tn||(e=zk(e));var t=e.r/255,n=e.g/255,i=e.b/255,r=(aI*i+rI*t-sI*n)/(aI+rI-sI),s=i-r,a=(og*(n-r)-Uk*s)/dx,o=Math.sqrt(a*a+s*s)/(og*r*(1-r)),u=o?Math.atan2(a,s)*k9-120:NaN;return new Kl(u<0?u+360:u,o,r,e.opacity)}function sS(e,t,n,i){return arguments.length===1?Lue(e):new Kl(e,t,n,i??1)}function Kl(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}qh(Kl,sS,Wg(Qu,{brighter(e){return e=e==null?nh:Math.pow(nh,e),new Kl(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?sc:Math.pow(sc,e),new Kl(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*C9,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),i=Math.cos(e),r=Math.sin(e);return new Tn(255*(t+n*(I9*i+Bk*r)),255*(t+n*(Uk*i+dx*r)),255*(t+n*(og*i)),this.opacity)}}));function D9(e,t,n,i,r){var s=e*e,a=s*e;return((1-3*e+3*s-a)*t+(4-6*s+3*a)*n+(1+3*e+3*s-3*a)*i+a*r)/6}function P9(e){var t=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[i],s=e[i+1],a=i>0?e[i-1]:2*r-s,o=i<t-1?e[i+2]:2*s-r;return D9((n-i/t)*t,a,r,s,o)}}function L9(e){var t=e.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*t),r=e[(i+t-1)%t],s=e[i%t],a=e[(i+1)%t],o=e[(i+2)%t];return D9((n-i/t)*t,r,s,a,o)}}const px=e=>()=>e;function z9(e,t){return function(n){return e+n*t}}function zue(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}function gx(e,t){var n=t-e;return n?z9(e,n>180||n<-180?n-360*Math.round(n/360):n):px(isNaN(e)?t:e)}function Bue(e){return(e=+e)==1?On:function(t,n){return n-t?zue(t,n,e):px(isNaN(t)?n:t)}}function On(e,t){var n=t-e;return n?z9(e,n):px(isNaN(e)?t:e)}const aS=function e(t){var n=Bue(t);function i(r,s){var a=n((r=Du(r)).r,(s=Du(s)).r),o=n(r.g,s.g),u=n(r.b,s.b),l=On(r.opacity,s.opacity);return function(c){return r.r=a(c),r.g=o(c),r.b=u(c),r.opacity=l(c),r+""}}return i.gamma=e,i}(1);function B9(e){return function(t){var n=t.length,i=new Array(n),r=new Array(n),s=new Array(n),a,o;for(a=0;a<n;++a)o=Du(t[a]),i[a]=o.r||0,r[a]=o.g||0,s[a]=o.b||0;return i=e(i),r=e(r),s=e(s),o.opacity=1,function(u){return o.r=i(u),o.g=r(u),o.b=s(u),o+""}}}var Uue=B9(P9),jue=B9(L9);function jk(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,i=t.slice(),r;return function(s){for(r=0;r<n;++r)i[r]=e[r]*(1-s)+t[r]*s;return i}}function U9(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function que(e,t){return(U9(t)?jk:j9)(e,t)}function j9(e,t){var n=t?t.length:0,i=e?Math.min(n,e.length):0,r=new Array(i),s=new Array(n),a;for(a=0;a<i;++a)r[a]=Zu(e[a],t[a]);for(;a<n;++a)s[a]=t[a];return function(o){for(a=0;a<i;++a)s[a]=r[a](o);return s}}function q9(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}function vs(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function V9(e,t){var n={},i={},r;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in e?n[r]=Zu(e[r],t[r]):i[r]=t[r];return function(s){for(r in n)i[r]=n[r](s);return i}}var oS=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,iw=new RegExp(oS.source,"g");function Vue(e){return function(){return e}}function Wue(e){return function(t){return e(t)+""}}function W9(e,t){var n=oS.lastIndex=iw.lastIndex=0,i,r,s,a=-1,o=[],u=[];for(e=e+"",t=t+"";(i=oS.exec(e))&&(r=iw.exec(t));)(s=r.index)>n&&(s=t.slice(n,s),o[a]?o[a]+=s:o[++a]=s),(i=i[0])===(r=r[0])?o[a]?o[a]+=r:o[++a]=r:(o[++a]=null,u.push({i:a,x:vs(i,r)})),n=iw.lastIndex;return n<t.length&&(s=t.slice(n),o[a]?o[a]+=s:o[++a]=s),o.length<2?u[0]?Wue(u[0].x):Vue(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)o[(f=u[c]).i]=f.x(l);return o.join("")})}function Zu(e,t){var n=typeof t,i;return t==null||n==="boolean"?px(t):(n==="number"?vs:n==="string"?(i=ag(t))?(t=i,aS):W9:t instanceof ag?aS:t instanceof Date?q9:U9(t)?jk:Array.isArray(t)?j9:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?V9:vs)(e,t)}function Gue(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function Hue(e,t){var n=gx(+e,+t);return function(i){var r=n(i);return r-360*Math.floor(r/360)}}function Gg(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var oI=180/Math.PI,uS={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function G9(e,t,n,i,r,s){var a,o,u;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(u=e*n+t*i)&&(n-=e*u,i-=t*u),(o=Math.sqrt(n*n+i*i))&&(n/=o,i/=o,u/=o),e*i<t*n&&(e=-e,t=-t,u=-u,a=-a),{translateX:r,translateY:s,rotate:Math.atan2(t,e)*oI,skewX:Math.atan(u)*oI,scaleX:a,scaleY:o}}var Bm;function Yue(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?uS:G9(t.a,t.b,t.c,t.d,t.e,t.f)}function Xue(e){return e==null||(Bm||(Bm=document.createElementNS("http://www.w3.org/2000/svg","g")),Bm.setAttribute("transform",e),!(e=Bm.transform.baseVal.consolidate()))?uS:(e=e.matrix,G9(e.a,e.b,e.c,e.d,e.e,e.f))}function H9(e,t,n,i){function r(l){return l.length?l.pop()+" ":""}function s(l,c,f,d,p,m){if(l!==f||c!==d){var y=p.push("translate(",null,t,null,n);m.push({i:y-4,x:vs(l,f)},{i:y-2,x:vs(c,d)})}else(f||d)&&p.push("translate("+f+t+d+n)}function a(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(r(f)+"rotate(",null,i)-2,x:vs(l,c)})):c&&f.push(r(f)+"rotate("+c+i)}function o(l,c,f,d){l!==c?d.push({i:f.push(r(f)+"skewX(",null,i)-2,x:vs(l,c)}):c&&f.push(r(f)+"skewX("+c+i)}function u(l,c,f,d,p,m){if(l!==f||c!==d){var y=p.push(r(p)+"scale(",null,",",null,")");m.push({i:y-4,x:vs(l,f)},{i:y-2,x:vs(c,d)})}else(f!==1||d!==1)&&p.push(r(p)+"scale("+f+","+d+")")}return function(l,c){var f=[],d=[];return l=e(l),c=e(c),s(l.translateX,l.translateY,c.translateX,c.translateY,f,d),a(l.rotate,c.rotate,f,d),o(l.skewX,c.skewX,f,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(p){for(var m=-1,y=d.length,v;++m<y;)f[(v=d[m]).i]=v.x(p);return f.join("")}}}var Kue=H9(Yue,"px, ","px)","deg)"),Jue=H9(Xue,", ",")",")"),Que=1e-12;function uI(e){return((e=Math.exp(e))+1/e)/2}function Zue(e){return((e=Math.exp(e))-1/e)/2}function ele(e){return((e=Math.exp(2*e))-1)/(e+1)}const tle=function e(t,n,i){function r(s,a){var o=s[0],u=s[1],l=s[2],c=a[0],f=a[1],d=a[2],p=c-o,m=f-u,y=p*p+m*m,v,b;if(y<Que)b=Math.log(d/l)/t,v=function(C){return[o+C*p,u+C*m,l*Math.exp(t*C*b)]};else{var _=Math.sqrt(y),E=(d*d-l*l+i*y)/(2*l*n*_),S=(d*d-l*l-i*y)/(2*d*n*_),A=Math.log(Math.sqrt(E*E+1)-E),$=Math.log(Math.sqrt(S*S+1)-S);b=($-A)/t,v=function(C){var M=C*b,N=uI(A),P=l/(n*_)*(N*ele(t*M+A)-Zue(A));return[o+P*p,u+P*m,l*N/uI(t*M+A)]}}return v.duration=b*1e3*t/Math.SQRT2,v}return r.rho=function(s){var a=Math.max(.001,+s),o=a*a,u=o*o;return e(a,o,u)},r}(Math.SQRT2,2,4);function Y9(e){return function(t,n){var i=e((t=py(t)).h,(n=py(n)).h),r=On(t.s,n.s),s=On(t.l,n.l),a=On(t.opacity,n.opacity);return function(o){return t.h=i(o),t.s=r(o),t.l=s(o),t.opacity=a(o),t+""}}}const nle=Y9(gx);var ile=Y9(On);function rle(e,t){var n=On((e=my(e)).l,(t=my(t)).l),i=On(e.a,t.a),r=On(e.b,t.b),s=On(e.opacity,t.opacity);return function(a){return e.l=n(a),e.a=i(a),e.b=r(a),e.opacity=s(a),e+""}}function X9(e){return function(t,n){var i=e((t=yy(t)).h,(n=yy(n)).h),r=On(t.c,n.c),s=On(t.l,n.l),a=On(t.opacity,n.opacity);return function(o){return t.h=i(o),t.c=r(o),t.l=s(o),t.opacity=a(o),t+""}}}const sle=X9(gx);var ale=X9(On);function K9(e){return function t(n){n=+n;function i(r,s){var a=e((r=sS(r)).h,(s=sS(s)).h),o=On(r.s,s.s),u=On(r.l,s.l),l=On(r.opacity,s.opacity);return function(c){return r.h=a(c),r.s=o(c),r.l=u(Math.pow(c,n)),r.opacity=l(c),r+""}}return i.gamma=t,i}(1)}const ole=K9(gx);var ule=K9(On);function qk(e,t){t===void 0&&(t=e,e=Zu);for(var n=0,i=t.length-1,r=t[0],s=new Array(i<0?0:i);n<i;)s[n]=e(r,r=t[++n]);return function(a){var o=Math.max(0,Math.min(i-1,Math.floor(a*=i)));return s[o](a-o)}}function lle(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e(i/(t-1));return n}const cle=Object.freeze(Object.defineProperty({__proto__:null,interpolate:Zu,interpolateArray:que,interpolateBasis:P9,interpolateBasisClosed:L9,interpolateCubehelix:ole,interpolateCubehelixLong:ule,interpolateDate:q9,interpolateDiscrete:Gue,interpolateHcl:sle,interpolateHclLong:ale,interpolateHsl:nle,interpolateHslLong:ile,interpolateHue:Hue,interpolateLab:rle,interpolateNumber:vs,interpolateNumberArray:jk,interpolateObject:V9,interpolateRgb:aS,interpolateRgbBasis:Uue,interpolateRgbBasisClosed:jue,interpolateRound:Gg,interpolateString:W9,interpolateTransformCss:Kue,interpolateTransformSvg:Jue,interpolateZoom:tle,piecewise:qk,quantize:lle},Symbol.toStringTag,{value:"Module"}));function fle(e){return function(){return e}}function lS(e){return+e}var lI=[0,1];function Gi(e){return e}function cS(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:fle(isNaN(t)?NaN:.5)}function hle(e,t){var n;return e>t&&(n=e,e=t,t=n),function(i){return Math.max(e,Math.min(t,i))}}function dle(e,t,n){var i=e[0],r=e[1],s=t[0],a=t[1];return r<i?(i=cS(r,i),s=n(a,s)):(i=cS(i,r),s=n(s,a)),function(o){return s(i(o))}}function ple(e,t,n){var i=Math.min(e.length,t.length)-1,r=new Array(i),s=new Array(i),a=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<i;)r[a]=cS(e[a],e[a+1]),s[a]=n(t[a],t[a+1]);return function(o){var u=Mu(e,o,1,i)-1;return s[u](r[u](o))}}function Hg(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function mx(){var e=lI,t=lI,n=Zu,i,r,s,a=Gi,o,u,l;function c(){var d=Math.min(e.length,t.length);return a!==Gi&&(a=hle(e[0],e[d-1])),o=d>2?ple:dle,u=l=null,f}function f(d){return d==null||isNaN(d=+d)?s:(u||(u=o(e.map(i),t,n)))(i(a(d)))}return f.invert=function(d){return a(r((l||(l=o(t,e.map(i),vs)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,lS),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=Gg,c()},f.clamp=function(d){return arguments.length?(a=d?!0:Gi,c()):a!==Gi},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(s=d,f):s},function(d,p){return i=d,r=p,c()}}function J9(){return mx()(Gi,Gi)}function Q9(e,t,n,i){var r=Nu(e,t,n),s;switch(i=rc(i??",f"),i.type){case"s":{var a=Math.max(Math.abs(e),Math.abs(t));return i.precision==null&&!isNaN(s=S4(r,a))&&(i.precision=s),OC(i,a)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(s=A4(r,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=s-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(s=E4(r))&&(i.precision=s-(i.type==="%")*2);break}}return Wv(i)}function Fc(e){var t=e.domain;return e.ticks=function(n){var i=t();return jE(i[0],i[i.length-1],n??10)},e.tickFormat=function(n,i){var r=t();return Q9(r[0],r[r.length-1],n??10,i)},e.nice=function(n){n==null&&(n=10);var i=t(),r=0,s=i.length-1,a=i[r],o=i[s],u,l,c=10;for(o<a&&(l=a,a=o,o=l,l=r,r=s,s=l);c-- >0;){if(l=qE(a,o,n),l===u)return i[r]=a,i[s]=o,t(i);if(l>0)a=Math.floor(a/l)*l,o=Math.ceil(o/l)*l;else if(l<0)a=Math.ceil(a*l)/l,o=Math.floor(o*l)/l;else break;u=l}return e},e}function Z9(){var e=J9();return e.copy=function(){return Hg(e,Z9())},Oa.apply(e,arguments),Fc(e)}function e7(e){var t;function n(i){return i==null||isNaN(i=+i)?t:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(e=Array.from(i,lS),n):e.slice()},n.unknown=function(i){return arguments.length?(t=i,n):t},n.copy=function(){return e7(e).unknown(t)},e=arguments.length?Array.from(e,lS):[0,1],Fc(n)}function t7(e,t){e=e.slice();var n=0,i=e.length-1,r=e[n],s=e[i],a;return s<r&&(a=n,n=i,i=a,a=r,r=s,s=a),e[n]=t.floor(r),e[i]=t.ceil(s),e}function cI(e){return Math.log(e)}function fI(e){return Math.exp(e)}function gle(e){return-Math.log(-e)}function mle(e){return-Math.exp(-e)}function yle(e){return isFinite(e)?+("1e"+e):e<0?0:e}function vle(e){return e===10?yle:e===Math.E?Math.exp:t=>Math.pow(e,t)}function xle(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function hI(e){return(t,n)=>-e(-t,n)}function Vk(e){const t=e(cI,fI),n=t.domain;let i=10,r,s;function a(){return r=xle(i),s=vle(i),n()[0]<0?(r=hI(r),s=hI(s),e(gle,mle)):e(cI,fI),t}return t.base=function(o){return arguments.length?(i=+o,a()):i},t.domain=function(o){return arguments.length?(n(o),a()):n()},t.ticks=o=>{const u=n();let l=u[0],c=u[u.length-1];const f=c<l;f&&([l,c]=[c,l]);let d=r(l),p=r(c),m,y;const v=o==null?10:+o;let b=[];if(!(i%1)&&p-d<v){if(d=Math.floor(d),p=Math.ceil(p),l>0){for(;d<=p;++d)for(m=1;m<i;++m)if(y=d<0?m/s(-d):m*s(d),!(y<l)){if(y>c)break;b.push(y)}}else for(;d<=p;++d)for(m=i-1;m>=1;--m)if(y=d>0?m/s(-d):m*s(d),!(y<l)){if(y>c)break;b.push(y)}b.length*2<v&&(b=jE(l,c,v))}else b=jE(d,p,Math.min(p-d,v)).map(s);return f?b.reverse():b},t.tickFormat=(o,u)=>{if(o==null&&(o=10),u==null&&(u=i===10?"s":","),typeof u!="function"&&(!(i%1)&&(u=rc(u)).precision==null&&(u.trim=!0),u=Wv(u)),o===1/0)return u;const l=Math.max(1,i*o/t.ticks().length);return c=>{let f=c/s(Math.round(r(c)));return f*i<i-.5&&(f*=i),f<=l?u(c):""}},t.nice=()=>n(t7(n(),{floor:o=>s(Math.floor(r(o))),ceil:o=>s(Math.ceil(r(o)))})),t}function n7(){const e=Vk(mx()).domain([1,10]);return e.copy=()=>Hg(e,n7()).base(e.base()),Oa.apply(e,arguments),e}function dI(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function pI(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Wk(e){var t=1,n=e(dI(t),pI(t));return n.constant=function(i){return arguments.length?e(dI(t=+i),pI(t)):t},Fc(n)}function i7(){var e=Wk(mx());return e.copy=function(){return Hg(e,i7()).constant(e.constant())},Oa.apply(e,arguments)}function gI(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function ble(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function _le(e){return e<0?-e*e:e*e}function Gk(e){var t=e(Gi,Gi),n=1;function i(){return n===1?e(Gi,Gi):n===.5?e(ble,_le):e(gI(n),gI(1/n))}return t.exponent=function(r){return arguments.length?(n=+r,i()):n},Fc(t)}function Hk(){var e=Gk(mx());return e.copy=function(){return Hg(e,Hk()).exponent(e.exponent())},Oa.apply(e,arguments),e}function wle(){return Hk.apply(null,arguments).exponent(.5)}function r7(){var e=[],t=[],n=[],i;function r(){var a=0,o=Math.max(1,t.length);for(n=new Array(o-1);++a<o;)n[a-1]=y4(e,a/o);return s}function s(a){return a==null||isNaN(a=+a)?i:t[Mu(n,a)]}return s.invertExtent=function(a){var o=t.indexOf(a);return o<0?[NaN,NaN]:[o>0?n[o-1]:e[0],o<n.length?n[o]:e[e.length-1]]},s.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let o of a)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(bo),r()},s.range=function(a){return arguments.length?(t=Array.from(a),r()):t.slice()},s.unknown=function(a){return arguments.length?(i=a,s):i},s.quantiles=function(){return n.slice()},s.copy=function(){return r7().domain(e).range(t).unknown(i)},Oa.apply(s,arguments)}function s7(){var e=0,t=1,n=1,i=[.5],r=[0,1],s;function a(u){return u!=null&&u<=u?r[Mu(i,u,0,n)]:s}function o(){var u=-1;for(i=new Array(n);++u<n;)i[u]=((u+1)*t-(u-n)*e)/(n+1);return a}return a.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,o()):[e,t]},a.range=function(u){return arguments.length?(n=(r=Array.from(u)).length-1,o()):r.slice()},a.invertExtent=function(u){var l=r.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,i[0]]:l>=n?[i[n-1],t]:[i[l-1],i[l]]},a.unknown=function(u){return arguments.length&&(s=u),a},a.thresholds=function(){return i.slice()},a.copy=function(){return s7().domain([e,t]).range(r).unknown(s)},Oa.apply(Fc(a),arguments)}function a7(){var e=[.5],t=[0,1],n,i=1;function r(s){return s!=null&&s<=s?t[Mu(e,s,0,i)]:n}return r.domain=function(s){return arguments.length?(e=Array.from(s),i=Math.min(e.length,t.length-1),r):e.slice()},r.range=function(s){return arguments.length?(t=Array.from(s),i=Math.min(e.length,t.length-1),r):t.slice()},r.invertExtent=function(s){var a=t.indexOf(s);return[e[a-1],e[a]]},r.unknown=function(s){return arguments.length?(n=s,r):n},r.copy=function(){return a7().domain(e).range(t).unknown(n)},Oa.apply(r,arguments)}function Ele(e){return new Date(e)}function Sle(e){return e instanceof Date?+e:+new Date(+e)}function Yk(e,t,n,i,r,s,a,o,u,l){var c=J9(),f=c.invert,d=c.domain,p=l(".%L"),m=l(":%S"),y=l("%I:%M"),v=l("%I %p"),b=l("%a %d"),_=l("%b %d"),E=l("%B"),S=l("%Y");function A($){return(u($)<$?p:o($)<$?m:a($)<$?y:s($)<$?v:i($)<$?r($)<$?b:_:n($)<$?E:S)($)}return c.invert=function($){return new Date(f($))},c.domain=function($){return arguments.length?d(Array.from($,Sle)):d().map(Ele)},c.ticks=function($){var C=d();return e(C[0],C[C.length-1],$??10)},c.tickFormat=function($,C){return C==null?A:l(C)},c.nice=function($){var C=d();return(!$||typeof $.range!="function")&&($=t(C[0],C[C.length-1],$??10)),$?d(t7(C,$)):c},c.copy=function(){return Hg(c,Yk(e,t,n,i,r,s,a,o,u,l))},c}function Ale(){return Oa.apply(Yk(Fre,Mre,ba,eg,Lh,_o,Yv,Gv,go,IC).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Cle(){return Oa.apply(Yk(Tre,Ore,_a,tg,zh,Cu,Xv,Hv,go,DC).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function yx(){var e=0,t=1,n,i,r,s,a=Gi,o=!1,u;function l(f){return f==null||isNaN(f=+f)?u:a(r===0?.5:(f=(s(f)-n)*r,o?Math.max(0,Math.min(1,f)):f))}l.domain=function(f){return arguments.length?([e,t]=f,n=s(e=+e),i=s(t=+t),r=n===i?0:1/(i-n),l):[e,t]},l.clamp=function(f){return arguments.length?(o=!!f,l):o},l.interpolator=function(f){return arguments.length?(a=f,l):a};function c(f){return function(d){var p,m;return arguments.length?([p,m]=d,a=f(p,m),l):[a(0),a(1)]}}return l.range=c(Zu),l.rangeRound=c(Gg),l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return s=f,n=f(e),i=f(t),r=n===i?0:1/(i-n),l}}function el(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Xk(){var e=Fc(yx()(Gi));return e.copy=function(){return el(e,Xk())},Ju.apply(e,arguments)}function o7(){var e=Vk(yx()).domain([1,10]);return e.copy=function(){return el(e,o7()).base(e.base())},Ju.apply(e,arguments)}function u7(){var e=Wk(yx());return e.copy=function(){return el(e,u7()).constant(e.constant())},Ju.apply(e,arguments)}function Kk(){var e=Gk(yx());return e.copy=function(){return el(e,Kk()).exponent(e.exponent())},Ju.apply(e,arguments)}function kle(){return Kk.apply(null,arguments).exponent(.5)}function vx(){var e=0,t=.5,n=1,i=1,r,s,a,o,u,l=Gi,c,f=!1,d;function p(y){return isNaN(y=+y)?d:(y=.5+((y=+c(y))-s)*(i*y<i*s?o:u),l(f?Math.max(0,Math.min(1,y)):y))}p.domain=function(y){return arguments.length?([e,t,n]=y,r=c(e=+e),s=c(t=+t),a=c(n=+n),o=r===s?0:.5/(s-r),u=s===a?0:.5/(a-s),i=s<r?-1:1,p):[e,t,n]},p.clamp=function(y){return arguments.length?(f=!!y,p):f},p.interpolator=function(y){return arguments.length?(l=y,p):l};function m(y){return function(v){var b,_,E;return arguments.length?([b,_,E]=v,l=qk(y,[b,_,E]),p):[l(0),l(.5),l(1)]}}return p.range=m(Zu),p.rangeRound=m(Gg),p.unknown=function(y){return arguments.length?(d=y,p):d},function(y){return c=y,r=y(e),s=y(t),a=y(n),o=r===s?0:.5/(s-r),u=s===a?0:.5/(a-s),i=s<r?-1:1,p}}function l7(){var e=Fc(vx()(Gi));return e.copy=function(){return el(e,l7())},Ju.apply(e,arguments)}function c7(){var e=Vk(vx()).domain([.1,1,10]);return e.copy=function(){return el(e,c7()).base(e.base())},Ju.apply(e,arguments)}function f7(){var e=Wk(vx());return e.copy=function(){return el(e,f7()).constant(e.constant())},Ju.apply(e,arguments)}function Jk(){var e=Gk(vx());return e.copy=function(){return el(e,Jk()).exponent(e.exponent())},Ju.apply(e,arguments)}function $le(){return Jk.apply(null,arguments).exponent(.5)}function Fa(e){for(var t=e.length/6|0,n=new Array(t),i=0;i<t;)n[i]="#"+e.slice(i*6,++i*6);return n}const Tle=Fa("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Ole=Fa("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),Fle=Fa("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),Mle=Fa("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),Nle=Fa("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),Rle=Fa("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),Ile=Fa("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),Dle=Fa("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),Ple=Fa("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),Lle=Fa("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f");function Qk(e,t,n){const i=e-t+n*2;return e?i>0?i:1:0}const zle="identity",ih="linear",To="log",Yg="pow",Xg="sqrt",xx="symlog",ac="time",oc="utc",ga="sequential",Vh="diverging",rh="quantile",bx="quantize",_x="threshold",Zk="ordinal",fS="point",h7="band",e$="bin-ordinal",Cn="continuous",Kg="discrete",Jg="discretizing",ns="interpolating",t$="temporal";function Ble(e){return function(t){let n=t[0],i=t[1],r;return i<n&&(r=n,n=i,i=r),[e.invert(n),e.invert(i)]}}function Ule(e){return function(t){const n=e.range();let i=t[0],r=t[1],s=-1,a,o,u,l;for(r<i&&(o=i,i=r,r=o),u=0,l=n.length;u<l;++u)n[u]>=i&&n[u]<=r&&(s<0&&(s=u),a=u);if(!(s<0))return i=e.invertExtent(n[s]),r=e.invertExtent(n[a]),[i[0]===void 0?i[1]:i[0],r[1]===void 0?r[0]:r[1]]}}function n$(){const e=Lk().unknown(void 0),t=e.domain,n=e.range;let i=[0,1],r,s,a=!1,o=0,u=0,l=.5;delete e.unknown;function c(){const f=t().length,d=i[1]<i[0],p=i[1-d],m=Qk(f,o,u);let y=i[d-0];r=(p-y)/(m||1),a&&(r=Math.floor(r)),y+=(p-y-r*(f-o))*l,s=r*(1-o),a&&(y=Math.round(y),s=Math.round(s));const v=pr(f).map(b=>y+r*b);return n(d?v.reverse():v)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(i=[+f[0],+f[1]],c()):i.slice()},e.rangeRound=function(f){return i=[+f[0],+f[1]],a=!0,c()},e.bandwidth=function(){return s},e.step=function(){return r},e.round=function(f){return arguments.length?(a=!!f,c()):a},e.padding=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),o=u,c()):o},e.paddingInner=function(f){return arguments.length?(o=Math.max(0,Math.min(1,f)),c()):o},e.paddingOuter=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const d=i[1]<i[0],p=d?n().reverse():n(),m=p.length-1;let y=+f[0],v=+f[1],b,_,E;if(!(y!==y||v!==v)&&(v<y&&(E=y,y=v,v=E),!(v<p[0]||y>i[1-d])))return b=Math.max(0,Mu(p,y)-1),_=y===v?b:Mu(p,v)-1,y-p[b]>s+1e-10&&++b,d&&(E=b,b=m-_,_=m-E),b>_?void 0:t().slice(b,_+1)},e.invert=function(f){const d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return n$().domain(t()).range(i).round(a).paddingInner(o).paddingOuter(u).align(l)},c()}function d7(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return d7(t())},e}function jle(){return d7(n$().paddingInner(1))}var qle=Array.prototype.map;function Vle(e){return qle.call(e,ai)}const Wle=Array.prototype.slice;function p7(){let e=[],t=[];function n(i){return i==null||i!==i?void 0:t[(Mu(e,i)-1)%t.length]}return n.domain=function(i){return arguments.length?(e=Vle(i),n):e.slice()},n.range=function(i){return arguments.length?(t=Wle.call(i),n):t.slice()},n.tickFormat=function(i,r){return Q9(e[0],ot(e),i??10,r)},n.copy=function(){return p7().domain(n.domain()).range(n.range())},n}const vy=new Map,g7=Symbol("vega_scale");function m7(e){return e[g7]=!0,e}function Gle(e){return e&&e[g7]===!0}function Hle(e,t,n){const i=function(){const s=t();return s.invertRange||(s.invertRange=s.invert?Ble(s):s.invertExtent?Ule(s):void 0),s.type=e,m7(s)};return i.metadata=Os(pe(n)),i}function gt(e,t,n){return arguments.length>1?(vy.set(e,Hle(e,t,n)),this):y7(e)?vy.get(e):void 0}gt(zle,e7);gt(ih,Z9,Cn);gt(To,n7,[Cn,To]);gt(Yg,Hk,Cn);gt(Xg,wle,Cn);gt(xx,i7,Cn);gt(ac,Ale,[Cn,t$]);gt(oc,Cle,[Cn,t$]);gt(ga,Xk,[Cn,ns]);gt(`${ga}-${ih}`,Xk,[Cn,ns]);gt(`${ga}-${To}`,o7,[Cn,ns,To]);gt(`${ga}-${Yg}`,Kk,[Cn,ns]);gt(`${ga}-${Xg}`,kle,[Cn,ns]);gt(`${ga}-${xx}`,u7,[Cn,ns]);gt(`${Vh}-${ih}`,l7,[Cn,ns]);gt(`${Vh}-${To}`,c7,[Cn,ns,To]);gt(`${Vh}-${Yg}`,Jk,[Cn,ns]);gt(`${Vh}-${Xg}`,$le,[Cn,ns]);gt(`${Vh}-${xx}`,f7,[Cn,ns]);gt(rh,r7,[Jg,rh]);gt(bx,s7,Jg);gt(_x,a7,Jg);gt(e$,p7,[Kg,Jg]);gt(Zk,Lk,Kg);gt(h7,n$,Kg);gt(fS,jle,Kg);function y7(e){return vy.has(e)}function Mc(e,t){const n=vy.get(e);return n&&n.metadata[t]}function i$(e){return Mc(e,Cn)}function sh(e){return Mc(e,Kg)}function hS(e){return Mc(e,Jg)}function v7(e){return Mc(e,To)}function Yle(e){return Mc(e,t$)}function x7(e){return Mc(e,ns)}function b7(e){return Mc(e,rh)}const Xle=["clamp","base","constant","exponent"];function _7(e,t){const n=t[0],i=ot(t)-n;return function(r){return e(n+r*i)}}function wx(e,t,n){return qk(r$(t||"rgb",n),e)}function w7(e,t){const n=new Array(t),i=t+1;for(let r=0;r<t;)n[r]=e(++r/i);return n}function E7(e,t,n){const i=n-t;let r,s,a;return!i||!Number.isFinite(i)?di(.5):(r=(s=e.type).indexOf("-"),s=r<0?s:s.slice(r+1),a=gt(s)().domain([t,n]).range([0,1]),Xle.forEach(o=>e[o]?a[o](e[o]()):0),a)}function r$(e,t){const n=cle[Kle(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function Kle(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const Jle={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},Qle={accent:Ole,category10:Tle,category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",dark2:Fle,observable10:Mle,paired:Nle,pastel1:Rle,pastel2:Ile,set1:Dle,set2:Ple,set3:Lle,tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5"};function S7(e){if(Q(e))return e;const t=e.length/6|0,n=new Array(t);for(let i=0;i<t;)n[i]="#"+e.slice(i*6,++i*6);return n}function A7(e,t){for(const n in e)s$(n,t(e[n]))}const mI={};A7(Qle,S7);A7(Jle,e=>wx(S7(e)));function s$(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(mI[e]=t,this):mI[e]}const k1="symbol",Zle="discrete",ece="gradient",tce=e=>Q(e)?e.map(t=>String(t)):String(e),nce=(e,t)=>e[1]-t[1],ice=(e,t)=>t[1]-e[1];function a$(e,t,n){let i;return dt(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(Ug(e.domain())/n||1)+1))),de(t)&&(i=t.step,t=t.interval),ge(t)&&(t=e.type===ac?Bh(t):e.type==oc?Uh(t):K("Only time and utc scales accept interval strings."),i&&(t=t.every(i))),t}function C7(e,t,n){let i=e.range(),r=i[0],s=ot(i),a=nce;if(r>s&&(i=s,s=r,r=i,a=ice),r=Math.floor(r),s=Math.ceil(s),t=t.map(o=>[o,e(o)]).filter(o=>r<=o[1]&&o[1]<=s).sort(a).map(o=>o[0]),n>0&&t.length>1){const o=[t[0],ot(t)];for(;t.length>n&&t.length>=3;)t=t.filter((u,l)=>!(l%2));t.length<3&&(t=o)}return t}function o$(e,t){return e.bins?C7(e,e.bins,t):e.ticks?e.ticks(t):e.domain()}function k7(e,t,n,i,r,s){const a=t.type;let o=tce;if(a===ac||r===ac)o=e.timeFormat(i);else if(a===oc||r===oc)o=e.utcFormat(i);else if(v7(a)){const u=e.formatFloat(i);if(s||t.bins)o=u;else{const l=$7(t,n,!1);o=c=>l(c)?u(c):""}}else if(t.tickFormat){const u=t.domain();o=e.formatSpan(u[0],u[u.length-1],n,i)}else i&&(o=e.format(i));return o}function $7(e,t,n){const i=o$(e,t),r=e.base(),s=Math.log(r),a=Math.max(1,r*t/i.length),o=u=>{let l=u/Math.pow(r,Math.round(Math.log(u)/s));return l*r<r-.5&&(l*=r),l<=a};return n?i.filter(o):o}const dS={[rh]:"quantiles",[bx]:"thresholds",[_x]:"domain"},T7={[rh]:"quantiles",[bx]:"domain"};function O7(e,t){return e.bins?ace(e.bins):e.type===To?$7(e,t,!0):dS[e.type]?sce(e[dS[e.type]]()):o$(e,t)}function rce(e,t,n){const i=t[T7[t.type]](),r=i.length;let s=r>1?i[1]-i[0]:i[0],a;for(a=1;a<r;++a)s=Math.min(s,i[a]-i[a-1]);return e.formatSpan(0,s,3*10,n)}function sce(e){const t=[-1/0].concat(e);return t.max=1/0,t}function ace(e){const t=e.slice(0,-1);return t.max=ot(e),t}const oce=e=>dS[e.type]||e.bins;function F7(e,t,n,i,r,s,a){const o=T7[t.type]&&s!==ac&&s!==oc?rce(e,t,r):k7(e,t,n,r,s,a);return i===k1&&oce(t)?uce(o):i===Zle?lce(o):cce(o)}const uce=e=>(t,n,i)=>{const r=yI(i[n+1],yI(i.max,1/0)),s=vI(t,e),a=vI(r,e);return s&&a?s+" – "+a:a?"< "+a:"≥ "+s},yI=(e,t)=>e??t,lce=e=>(t,n)=>n?e(t):null,cce=e=>t=>e(t),vI=(e,t)=>Number.isFinite(e)?t(e):null;function fce(e){const t=e.domain(),n=t.length-1;let i=+t[0],r=+ot(t),s=r-i;if(e.type===_x){const a=n?s/n:.1;i-=a,r+=a,s=r-i}return a=>(a-i)/s}function hce(e,t,n,i){const r=i||t.type;return ge(n)&&Yle(r)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&r===ac?e.timeFormat("%A, %d %B %Y, %X"):!n&&r===oc?e.utcFormat("%A, %d %B %Y, %X UTC"):F7(e,t,5,null,n,i,!0)}function M7(e,t,n){n=n||{};const i=Math.max(3,n.maxlen||7),r=hce(e,t,n.format,n.formatType);if(hS(t.type)){const s=O7(t).slice(1).map(r),a=s.length;return`${a} boundar${a===1?"y":"ies"}: ${s.join(", ")}`}else if(sh(t.type)){const s=t.domain(),a=s.length,o=a>i?s.slice(0,i-2).map(r).join(", ")+", ending with "+s.slice(-1).map(r):s.map(r).join(", ");return`${a} value${a===1?"":"s"}: ${o}`}else{const s=t.domain();return`values from ${r(s[0])} to ${r(ot(s))}`}}let N7=0;function dce(){N7=0}const xy="p_";function u$(e){return e&&e.gradient}function R7(e,t,n){const i=e.gradient;let r=e.id,s=i==="radial"?xy:"";return r||(r=e.id="gradient_"+N7++,i==="radial"?(e.x1=Qs(e.x1,.5),e.y1=Qs(e.y1,.5),e.r1=Qs(e.r1,0),e.x2=Qs(e.x2,.5),e.y2=Qs(e.y2,.5),e.r2=Qs(e.r2,.5),s=xy):(e.x1=Qs(e.x1,0),e.y1=Qs(e.y1,0),e.x2=Qs(e.x2,1),e.y2=Qs(e.y2,0))),t[r]=e,"url("+(n||"")+"#"+s+r+")"}function Qs(e,t){return e??t}function I7(e,t){var n=[],i;return i={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(r,s){return n.push({offset:r,color:s}),i}}}const xI={basis:{curve:uue},"basis-closed":{curve:lue},"basis-open":{curve:cue},bundle:{curve:fue,tension:"beta",value:.85},cardinal:{curve:hue,tension:"tension",value:0},"cardinal-open":{curve:pue,tension:"tension",value:0},"cardinal-closed":{curve:due,tension:"tension",value:0},"catmull-rom":{curve:gue,tension:"alpha",value:.5},"catmull-rom-closed":{curve:mue,tension:"alpha",value:.5},"catmull-rom-open":{curve:yue,tension:"alpha",value:.5},linear:{curve:Nk},"linear-closed":{curve:vue},monotone:{horizontal:bue,vertical:xue},natural:{curve:_ue},step:{curve:wue},"step-after":{curve:Sue},"step-before":{curve:Eue}};function l$(e,t,n){var i=ve(xI,e)&&xI[e],r=null;return i&&(r=i.curve||i[t||"vertical"],i.tension&&n!=null&&(r=r[i.tension](n))),r}const pce={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},gce=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,mce=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,yce=/^((\s+,?\s*)|(,\s*))/,vce=/^[01]/;function ah(e){const t=[];return(e.match(gce)||[]).forEach(i=>{let r=i[0];const s=r.toLowerCase(),a=pce[s],o=xce(s,a,i.slice(1).trim()),u=o.length;if(u<a||u&&u%a!==0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([r,...o.slice(0,a)]),u!==a){s==="m"&&(r=r==="M"?"L":"l");for(let l=a;l<u;l+=a)t.push([r,...o.slice(l,l+a)])}}),t}function xce(e,t,n){const i=[];for(let r=0;t&&r<n.length;)for(let s=0;s<t;++s){const a=e==="a"&&(s===3||s===4)?vce:mce,o=n.slice(r).match(a);if(o===null)throw Error("Invalid SVG path, incorrect parameter type");r+=o[0].length,i.push(+o[0]);const u=n.slice(r).match(yce);u!==null&&(r+=u[0].length)}return i}const Pu=Math.PI/180,bce=1e-14,Bl=Math.PI/2,oa=Math.PI*2,hf=Math.sqrt(3)/2;var rw={},sw={},D7=[].join;function _ce(e,t,n,i,r,s,a,o,u){const l=D7.call(arguments);if(rw[l])return rw[l];const c=a*Pu,f=Math.sin(c),d=Math.cos(c);n=Math.abs(n),i=Math.abs(i);const p=d*(o-e)*.5+f*(u-t)*.5,m=d*(u-t)*.5-f*(o-e)*.5;let y=p*p/(n*n)+m*m/(i*i);y>1&&(y=Math.sqrt(y),n*=y,i*=y);const v=d/n,b=f/n,_=-f/i,E=d/i,S=v*o+b*u,A=_*o+E*u,$=v*e+b*t,C=_*e+E*t;let N=1/(($-S)*($-S)+(C-A)*(C-A))-.25;N<0&&(N=0);let P=Math.sqrt(N);s==r&&(P=-P);const D=.5*(S+$)-P*(C-A),W=.5*(A+C)+P*($-S),q=Math.atan2(A-W,S-D);let R=Math.atan2(C-W,$-D)-q;R<0&&s===1?R+=oa:R>0&&s===0&&(R-=oa);const U=Math.ceil(Math.abs(R/(Bl+.001))),G=[];for(let Z=0;Z<U;++Z){const J=q+Z*R/U,he=q+(Z+1)*R/U;G[Z]=[D,W,J,he,n,i,f,d]}return rw[l]=G}function wce(e){const t=D7.call(e);if(sw[t])return sw[t];var n=e[0],i=e[1],r=e[2],s=e[3],a=e[4],o=e[5],u=e[6],l=e[7];const c=l*a,f=-u*o,d=u*a,p=l*o,m=Math.cos(r),y=Math.sin(r),v=Math.cos(s),b=Math.sin(s),_=.5*(s-r),E=Math.sin(_*.5),S=8/3*E*E/Math.sin(_),A=n+m-S*y,$=i+y+S*m,C=n+v,M=i+b,N=C+S*b,P=M-S*v;return sw[t]=[c*A+f*$,d*A+p*$,c*N+f*P,d*N+p*P,c*C+f*M,d*C+p*M]}const Rr=["l",0,0,0,0,0,0,0];function Ece(e,t,n){const i=Rr[0]=e[0];if(i==="a"||i==="A")Rr[1]=t*e[1],Rr[2]=n*e[2],Rr[3]=e[3],Rr[4]=e[4],Rr[5]=e[5],Rr[6]=t*e[6],Rr[7]=n*e[7];else if(i==="h"||i==="H")Rr[1]=t*e[1];else if(i==="v"||i==="V")Rr[1]=n*e[1];else for(var r=1,s=e.length;r<s;++r)Rr[r]=(r%2==1?t:n)*e[r];return Rr}function ug(e,t,n,i,r,s){var a,o=null,u=0,l=0,c=0,f=0,d,p,m,y,v=0,b=0;n==null&&(n=0),i==null&&(i=0),r==null&&(r=1),s==null&&(s=r),e.beginPath&&e.beginPath();for(var _=0,E=t.length;_<E;++_){switch(a=t[_],(r!==1||s!==1)&&(a=Ece(a,r,s)),a[0]){case"l":u+=a[1],l+=a[2],e.lineTo(u+n,l+i);break;case"L":u=a[1],l=a[2],e.lineTo(u+n,l+i);break;case"h":u+=a[1],e.lineTo(u+n,l+i);break;case"H":u=a[1],e.lineTo(u+n,l+i);break;case"v":l+=a[1],e.lineTo(u+n,l+i);break;case"V":l=a[1],e.lineTo(u+n,l+i);break;case"m":u+=a[1],l+=a[2],v=u,b=l,e.moveTo(u+n,l+i);break;case"M":u=a[1],l=a[2],v=u,b=l,e.moveTo(u+n,l+i);break;case"c":d=u+a[5],p=l+a[6],c=u+a[3],f=l+a[4],e.bezierCurveTo(u+a[1]+n,l+a[2]+i,c+n,f+i,d+n,p+i),u=d,l=p;break;case"C":u=a[5],l=a[6],c=a[3],f=a[4],e.bezierCurveTo(a[1]+n,a[2]+i,c+n,f+i,u+n,l+i);break;case"s":d=u+a[3],p=l+a[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+i,u+a[1]+n,l+a[2]+i,d+n,p+i),c=u+a[1],f=l+a[2],u=d,l=p;break;case"S":d=a[3],p=a[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+i,a[1]+n,a[2]+i,d+n,p+i),u=d,l=p,c=a[1],f=a[2];break;case"q":d=u+a[3],p=l+a[4],c=u+a[1],f=l+a[2],e.quadraticCurveTo(c+n,f+i,d+n,p+i),u=d,l=p;break;case"Q":d=a[3],p=a[4],e.quadraticCurveTo(a[1]+n,a[2]+i,d+n,p+i),u=d,l=p,c=a[1],f=a[2];break;case"t":d=u+a[1],p=l+a[2],o[0].match(/[QqTt]/)===null?(c=u,f=l):o[0]==="t"?(c=2*u-m,f=2*l-y):o[0]==="q"&&(c=2*u-c,f=2*l-f),m=c,y=f,e.quadraticCurveTo(c+n,f+i,d+n,p+i),u=d,l=p,c=u+a[1],f=l+a[2];break;case"T":d=a[1],p=a[2],c=2*u-c,f=2*l-f,e.quadraticCurveTo(c+n,f+i,d+n,p+i),u=d,l=p;break;case"a":bI(e,u+n,l+i,[a[1],a[2],a[3],a[4],a[5],a[6]+u+n,a[7]+l+i]),u+=a[6],l+=a[7];break;case"A":bI(e,u+n,l+i,[a[1],a[2],a[3],a[4],a[5],a[6]+n,a[7]+i]),u=a[6],l=a[7];break;case"z":case"Z":u=v,l=b,e.closePath();break}o=a}}function bI(e,t,n,i){const r=_ce(i[5],i[6],i[0],i[1],i[3],i[4],i[2],t,n);for(let s=0;s<r.length;++s){const a=wce(r[s]);e.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5])}}const _I=.5773502691896257,wI={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,oa)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/2.5;e.moveTo(-n,-i),e.lineTo(-n,i),e.lineTo(-i,i),e.lineTo(-i,n),e.lineTo(i,n),e.lineTo(i,i),e.lineTo(n,i),e.lineTo(n,-i),e.lineTo(i,-i),e.lineTo(i,-n),e.lineTo(-i,-n),e.lineTo(-i,-i),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),i=-n/2;e.rect(i,i,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/7,r=n/2.5,s=n/8;e.moveTo(-i,n),e.lineTo(i,n),e.lineTo(i,-s),e.lineTo(r,-s),e.lineTo(0,-n),e.lineTo(-r,-s),e.lineTo(-i,-s),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,i=hf*n,r=i-n*_I,s=n/4;e.moveTo(0,-i-r),e.lineTo(-s,i-r),e.lineTo(s,i-r),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,i=hf*n,r=i-n*_I;e.moveTo(0,-i-r),e.lineTo(-n,i-r),e.lineTo(n,i-r),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,i=hf*n;e.moveTo(0,-i),e.lineTo(-n,i),e.lineTo(n,i),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,i=hf*n;e.moveTo(0,i),e.lineTo(-n,-i),e.lineTo(n,-i),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,i=hf*n;e.moveTo(i,0),e.lineTo(-i,-n),e.lineTo(-i,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,i=hf*n;e.moveTo(-i,0),e.lineTo(i,-n),e.lineTo(i,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function P7(e){return ve(wI,e)?wI[e]:Sce(e)}var aw={};function Sce(e){if(!ve(aw,e)){const t=ah(e);aw[e]={draw:function(n,i){ug(n,t,0,0,Math.sqrt(i)/2)}}}return aw[e]}const ru=.448084975506;function Ace(e){return e.x}function Cce(e){return e.y}function kce(e){return e.width}function $ce(e){return e.height}function eo(e){return typeof e=="function"?e:()=>+e}function Um(e,t,n){return Math.max(t,Math.min(e,n))}function L7(){var e=Ace,t=Cce,n=kce,i=$ce,r=eo(0),s=r,a=r,o=r,u=null;function l(c,f,d){var p,m=f??+e.call(this,c),y=d??+t.call(this,c),v=+n.call(this,c),b=+i.call(this,c),_=Math.min(v,b)/2,E=Um(+r.call(this,c),0,_),S=Um(+s.call(this,c),0,_),A=Um(+a.call(this,c),0,_),$=Um(+o.call(this,c),0,_);if(u||(u=p=lx()),E<=0&&S<=0&&A<=0&&$<=0)u.rect(m,y,v,b);else{var C=m+v,M=y+b;u.moveTo(m+E,y),u.lineTo(C-S,y),u.bezierCurveTo(C-ru*S,y,C,y+ru*S,C,y+S),u.lineTo(C,M-$),u.bezierCurveTo(C,M-ru*$,C-ru*$,M,C-$,M),u.lineTo(m+A,M),u.bezierCurveTo(m+ru*A,M,m,M-ru*A,m,M-A),u.lineTo(m,y+E),u.bezierCurveTo(m,y+ru*E,m+ru*E,y,m+E,y),u.closePath()}if(p)return u=null,p+""||null}return l.x=function(c){return arguments.length?(e=eo(c),l):e},l.y=function(c){return arguments.length?(t=eo(c),l):t},l.width=function(c){return arguments.length?(n=eo(c),l):n},l.height=function(c){return arguments.length?(i=eo(c),l):i},l.cornerRadius=function(c,f,d,p){return arguments.length?(r=eo(c),s=f!=null?eo(f):r,o=d!=null?eo(d):r,a=p!=null?eo(p):s,l):r},l.context=function(c){return arguments.length?(u=c??null,l):u},l}function z7(){var e,t,n,i,r=null,s,a,o,u;function l(f,d,p){const m=p/2;if(s){var y=o-d,v=f-a;if(y||v){var b=Math.hypot(y,v),_=(y/=b)*u,E=(v/=b)*u,S=Math.atan2(v,y);r.moveTo(a-_,o-E),r.lineTo(f-y*m,d-v*m),r.arc(f,d,m,S-Math.PI,S),r.lineTo(a+_,o+E),r.arc(a,o,u,S,S+Math.PI)}else r.arc(f,d,m,0,oa);r.closePath()}else s=1;a=f,o=d,u=m}function c(f){var d,p=f.length,m,y=!1,v;for(r==null&&(r=v=lx()),d=0;d<=p;++d)!(d<p&&i(m=f[d],d,f))===y&&(y=!y)&&(s=0),y&&l(+e(m,d,f),+t(m,d,f),+n(m,d,f));if(v)return r=null,v+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(i=f,c):i},c.context=function(f){return arguments.length?(f==null?r=null:r=f,c):r},c}function Qg(e,t){return e??t}const Zg=e=>e.x||0,e0=e=>e.y||0,Tce=e=>e.width||0,Oce=e=>e.height||0,Fce=e=>(e.x||0)+(e.width||0),Mce=e=>(e.y||0)+(e.height||0),Nce=e=>e.startAngle||0,Rce=e=>e.endAngle||0,Ice=e=>e.padAngle||0,Dce=e=>e.innerRadius||0,Pce=e=>e.outerRadius||0,Lce=e=>e.cornerRadius||0,zce=e=>Qg(e.cornerRadiusTopLeft,e.cornerRadius)||0,Bce=e=>Qg(e.cornerRadiusTopRight,e.cornerRadius)||0,Uce=e=>Qg(e.cornerRadiusBottomRight,e.cornerRadius)||0,jce=e=>Qg(e.cornerRadiusBottomLeft,e.cornerRadius)||0,qce=e=>Qg(e.size,64),Vce=e=>e.size||1,Ex=e=>e.defined!==!1,Wce=e=>P7(e.shape||"circle"),Gce=sue().startAngle(Nce).endAngle(Rce).padAngle(Ice).innerRadius(Dce).outerRadius(Pce).cornerRadius(Lce),Hce=p9().x(Zg).y1(e0).y0(Mce).defined(Ex),Yce=p9().y(e0).x1(Zg).x0(Fce).defined(Ex),Xce=d9().x(Zg).y(e0).defined(Ex),Kce=L7().x(Zg).y(e0).width(Tce).height(Oce).cornerRadius(zce,Bce,Uce,jce),Jce=oue().type(Wce).size(qce),Qce=z7().x(Zg).y(e0).defined(Ex).size(Vce);function c$(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function Zce(e,t){return Gce.context(e)(t)}function efe(e,t){const n=t[0],i=n.interpolate||"linear";return(n.orient==="horizontal"?Yce:Hce).curve(l$(i,n.orient,n.tension)).context(e)(t)}function tfe(e,t){const n=t[0],i=n.interpolate||"linear";return Xce.curve(l$(i,n.orient,n.tension)).context(e)(t)}function Wh(e,t,n,i){return Kce.context(e)(t,n,i)}function nfe(e,t){return(t.mark.shape||t.shape).context(e)(t)}function ife(e,t){return Jce.context(e)(t)}function rfe(e,t){return Qce.context(e)(t)}var B7=1;function U7(){B7=1}function f$(e,t,n){var i=t.clip,r=e._defs,s=t.clip_id||(t.clip_id="clip"+B7++),a=r.clipping[s]||(r.clipping[s]={id:s});return Ye(i)?a.path=i(null):c$(n)?a.path=Wh(null,n,0,0):(a.width=n.width||0,a.height=n.height||0),"url(#"+s+")"}function pn(e){this.clear(),e&&this.union(e)}pn.prototype={clone(){return new pn(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,i){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),i<t?(this.y2=t,this.y1=i):(this.y1=t,this.y2=i),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const i=this.rotatedPoints(e,t,n);return this.clear().add(i[0],i[1]).add(i[2],i[3]).add(i[4],i[5]).add(i[6],i[7])},rotatedPoints(e,t,n){var{x1:i,y1:r,x2:s,y2:a}=this,o=Math.cos(e),u=Math.sin(e),l=t-t*o+n*u,c=n-t*u-n*o;return[o*i-u*r+l,u*i+o*r+c,o*i-u*a+l,u*i+o*a+c,o*s-u*r+l,u*s+o*r+c,o*s-u*a+l,u*s+o*a+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function Sx(e){this.mark=e,this.bounds=this.bounds||new pn}function Ax(e){Sx.call(this,e),this.items=this.items||[]}ce(Ax,Sx);class j7{constructor(t){this._pending=0,this._loader=t||Jv()}pending(){return this._pending}sanitizeURL(t){const n=this;return EI(n),n._loader.sanitize(t,{context:"href"}).then(i=>(Gd(n),i)).catch(()=>(Gd(n),null))}loadImage(t){const n=this,i=Aue();return EI(n),n._loader.sanitize(t,{context:"image"}).then(r=>{const s=r.href;if(!s||!i)throw{url:s};const a=new i,o=ve(r,"crossOrigin")?r.crossOrigin:"anonymous";return o!=null&&(a.crossOrigin=o),a.onload=()=>Gd(n),a.onerror=()=>Gd(n),a.src=s,a}).catch(r=>(Gd(n),{complete:!1,width:0,height:0,src:r&&r.url||""}))}ready(){const t=this;return new Promise(n=>{function i(r){t.pending()?setTimeout(()=>{i(!0)},10):n(r)}i(!1)})}}function EI(e){e._pending+=1}function Gd(e){e._pending-=1}function zo(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const i=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(i+(n?sfe(t,i):0))}return e}function sfe(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const afe=oa-1e-8;let Cx,$1,T1,Gl,pS,O1,gS,mS;const gu=(e,t)=>Cx.add(e,t),F1=(e,t)=>gu($1=e,T1=t),SI=e=>gu(e,Cx.y1),AI=e=>gu(Cx.x1,e),Ul=(e,t)=>pS*e+gS*t,jl=(e,t)=>O1*e+mS*t,ow=(e,t)=>gu(Ul(e,t),jl(e,t)),uw=(e,t)=>F1(Ul(e,t),jl(e,t));function t0(e,t){return Cx=e,t?(Gl=t*Pu,pS=mS=Math.cos(Gl),O1=Math.sin(Gl),gS=-O1):(pS=mS=1,Gl=O1=gS=0),ofe}const ofe={beginPath(){},closePath(){},moveTo:uw,lineTo:uw,rect(e,t,n,i){Gl?(ow(e+n,t),ow(e+n,t+i),ow(e,t+i),uw(e,t)):(gu(e+n,t+i),F1(e,t))},quadraticCurveTo(e,t,n,i){const r=Ul(e,t),s=jl(e,t),a=Ul(n,i),o=jl(n,i);CI($1,r,a,SI),CI(T1,s,o,AI),F1(a,o)},bezierCurveTo(e,t,n,i,r,s){const a=Ul(e,t),o=jl(e,t),u=Ul(n,i),l=jl(n,i),c=Ul(r,s),f=jl(r,s);kI($1,a,u,c,SI),kI(T1,o,l,f,AI),F1(c,f)},arc(e,t,n,i,r,s){if(i+=Gl,r+=Gl,$1=n*Math.cos(r)+e,T1=n*Math.sin(r)+t,Math.abs(r-i)>afe)gu(e-n,t-n),gu(e+n,t+n);else{const a=l=>gu(n*Math.cos(l)+e,n*Math.sin(l)+t);let o,u;if(a(i),a(r),r!==i)if(i=i%oa,i<0&&(i+=oa),r=r%oa,r<0&&(r+=oa),r<i&&(s=!s,o=i,i=r,r=o),s)for(r-=oa,o=i-i%Bl,u=0;u<4&&o>r;++u,o-=Bl)a(o);else for(o=i-i%Bl+Bl,u=0;u<4&&o<r;++u,o=o+Bl)a(o)}}};function CI(e,t,n,i){const r=(e-t)/(e+n-2*t);0<r&&r<1&&i(e+(t-e)*r)}function kI(e,t,n,i,r){const s=i-e+3*t-3*n,a=e+n-2*t,o=e-t;let u=0,l=0,c;Math.abs(s)>bce?(c=a*a+o*s,c>=0&&(c=Math.sqrt(c),u=(-a+c)/s,l=(-a-c)/s)):u=.5*o/a,0<u&&u<1&&r($I(u,e,t,n,i)),0<l&&l<1&&r($I(l,e,t,n,i))}function $I(e,t,n,i,r){const s=1-e,a=s*s,o=e*e;return a*s*t+3*a*e*n+3*s*o*i+o*e*r}var Tu=(Tu=$u(1,1))?Tu.getContext("2d"):null;const yS=new pn;function h$(e){return function(t,n){if(!Tu)return!0;e(Tu,t),yS.clear().union(t.bounds).intersect(n).round();const{x1:i,y1:r,x2:s,y2:a}=yS;for(let o=r;o<=a;++o)for(let u=i;u<=s;++u)if(Tu.isPointInPath(u,o))return!0;return!1}}function d$(e,t){return t.contains(e.x||0,e.y||0)}function q7(e,t){const n=e.x||0,i=e.y||0,r=e.width||0,s=e.height||0;return t.intersects(yS.set(n,i,n+r,i+s))}function V7(e,t){const n=e.x||0,i=e.y||0,r=e.x2!=null?e.x2:n,s=e.y2!=null?e.y2:i;return Tf(t,n,i,r,s)}function Tf(e,t,n,i,r){const{x1:s,y1:a,x2:o,y2:u}=e,l=i-t,c=r-n;let f=0,d=1,p,m,y,v;for(v=0;v<4;++v){if(v===0&&(p=-l,m=-(s-t)),v===1&&(p=l,m=o-t),v===2&&(p=-c,m=-(a-n)),v===3&&(p=c,m=u-n),Math.abs(p)<1e-10&&m<0)return!1;if(y=m/p,p<0){if(y>d)return!1;y>f&&(f=y)}else if(p>0){if(y<f)return!1;y<d&&(d=y)}}return!0}function oh(e,t){e.globalCompositeOperation=t.blend||"source-over"}function ds(e,t){return e??t}function TI(e,t){const n=t.length;for(let i=0;i<n;++i)e.addColorStop(t[i].offset,t[i].color);return e}function ufe(e,t,n){const i=n.width(),r=n.height();let s;if(t.gradient==="radial")s=e.createRadialGradient(n.x1+ds(t.x1,.5)*i,n.y1+ds(t.y1,.5)*r,Math.max(i,r)*ds(t.r1,0),n.x1+ds(t.x2,.5)*i,n.y1+ds(t.y2,.5)*r,Math.max(i,r)*ds(t.r2,.5));else{const a=ds(t.x1,0),o=ds(t.y1,0),u=ds(t.x2,1),l=ds(t.y2,0);if(a===u||o===l||i===r)s=e.createLinearGradient(n.x1+a*i,n.y1+o*r,n.x1+u*i,n.y1+l*r);else{const c=$u(Math.ceil(i),Math.ceil(r)),f=c.getContext("2d");return f.scale(i,r),f.fillStyle=TI(f.createLinearGradient(a,o,u,l),t.stops),f.fillRect(0,0,i,r),e.createPattern(c,"no-repeat")}}return TI(s,t.stops)}function W7(e,t,n){return u$(n)?ufe(e,n,t.bounds):n}function by(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=W7(e,t,t.fill),!0):!1}var lfe=[];function uh(e,t,n){var i=(i=t.strokeWidth)!=null?i:1;return i<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=W7(e,t,t.stroke),e.lineWidth=i,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||lfe),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function cfe(e,t){return e.zindex-t.zindex||e.index-t.index}function p$(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],i,r,s;for(r=0,s=t.length;r<s;++r)i=t[r],i.index=r,i.zindex&&n.push(i);return e.zdirty=!1,e.zitems=n.sort(cfe)}function Ms(e,t){var n=e.items,i,r;if(!n||!n.length)return;const s=p$(e);if(s&&s.length){for(i=0,r=n.length;i<r;++i)n[i].zindex||t(n[i]);n=s}for(i=0,r=n.length;i<r;++i)t(n[i])}function _y(e,t){var n=e.items,i,r;if(!n||!n.length)return null;const s=p$(e);for(s&&s.length&&(n=s),r=n.length;--r>=0;)if(i=t(n[r]))return i;if(n===s){for(n=e.items,r=n.length;--r>=0;)if(!n[r].zindex&&(i=t(n[r])))return i}return null}function g$(e){return function(t,n,i){Ms(n,r=>{(!i||i.intersects(r.bounds))&&G7(e,t,r,r)})}}function ffe(e){return function(t,n,i){n.items.length&&(!i||i.intersects(n.bounds))&&G7(e,t,n.items[0],n.items)}}function G7(e,t,n,i){var r=n.opacity==null?1:n.opacity;r!==0&&(e(t,i)||(oh(t,n),n.fill&&by(t,n,r)&&t.fill(),n.stroke&&uh(t,n,r)&&t.stroke()))}function kx(e){return e=e||Xr,function(t,n,i,r,s,a){return i*=t.pixelRatio,r*=t.pixelRatio,_y(n,o=>{const u=o.bounds;if(!(u&&!u.contains(s,a)||!u)&&e(t,o,i,r,s,a))return o})}}function n0(e,t){return function(n,i,r,s){var a=Array.isArray(i)?i[0]:i,o=t??a.fill,u=a.stroke&&n.isPointInStroke,l,c;return u&&(l=a.strokeWidth,c=a.strokeCap,n.lineWidth=l??1,n.lineCap=c??"butt"),e(n,i)?!1:o&&n.isPointInPath(r,s)||u&&n.isPointInStroke(r,s)}}function m$(e){return kx(n0(e))}function Jl(e,t){return"translate("+e+","+t+")"}function y$(e){return"rotate("+e+")"}function hfe(e,t){return"scale("+e+","+t+")"}function H7(e){return Jl(e.x||0,e.y||0)}function dfe(e){return Jl(e.x||0,e.y||0)+(e.angle?" "+y$(e.angle):"")}function pfe(e){return Jl(e.x||0,e.y||0)+(e.angle?" "+y$(e.angle):"")+(e.scaleX||e.scaleY?" "+hfe(e.scaleX||1,e.scaleY||1):"")}function v$(e,t,n){function i(a,o){a("transform",dfe(o)),a("d",t(null,o))}function r(a,o){return t(t0(a,o.angle),o),zo(a,o).translate(o.x||0,o.y||0)}function s(a,o){var u=o.x||0,l=o.y||0,c=o.angle||0;a.translate(u,l),c&&a.rotate(c*=Pu),a.beginPath(),t(a,o),c&&a.rotate(-c),a.translate(-u,-l)}return{type:e,tag:"path",nested:!1,attr:i,bound:r,draw:g$(s),pick:m$(s),isect:n||h$(s)}}var gfe=v$("arc",Zce);function mfe(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],i=e[0].orient==="horizontal"?"y":"x",r=e.length,s=1/0,a,o;--r>=0;)e[r].defined!==!1&&(o=Math.abs(e[r][i]-n),o<s&&(s=o,a=e[r]));return a}function yfe(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),i=e.length,r,s,a;--i>=0;)if(e[i].defined!==!1&&(r=e[i].x-t[0],s=e[i].y-t[1],a=r*r+s*s,a<n))return e[i];return null}function vfe(e,t){for(var n=e.length,i,r,s;--n>=0;)if(e[n].defined!==!1&&(i=e[n].x-t[0],r=e[n].y-t[1],s=i*i+r*r,i=e[n].size||1,s<i*i))return e[n];return null}function x$(e,t,n){function i(u,l){var c=l.mark.items;c.length&&u("d",t(null,c))}function r(u,l){var c=l.items;return c.length===0?u:(t(t0(u),c),zo(u,c[0]))}function s(u,l){u.beginPath(),t(u,l)}const a=n0(s);function o(u,l,c,f,d,p){var m=l.items,y=l.bounds;return!m||!m.length||y&&!y.contains(d,p)?null:(c*=u.pixelRatio,f*=u.pixelRatio,a(u,m,c,f)?m[0]:null)}return{type:e,tag:"path",nested:!0,attr:i,bound:r,draw:ffe(s),pick:o,isect:d$,tip:n}}var xfe=x$("area",efe,mfe);function bfe(e,t){var n=t.clip;e.save(),Ye(n)?(e.beginPath(),n(e),e.clip()):Y7(e,t.group)}function Y7(e,t){e.beginPath(),c$(t)?Wh(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function X7(e){const t=ds(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function _fe(e,t){e("transform",H7(t))}function K7(e,t){const n=X7(t);e("d",Wh(null,t,n,n))}function wfe(e,t){e("class","background"),e("aria-hidden",!0),K7(e,t)}function Efe(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?K7(e,t):e("d","")}function Sfe(e,t,n){const i=t.clip?f$(n,t,t):null;e("clip-path",i)}function Afe(e,t){if(!t.clip&&t.items){const n=t.items,i=n.length;for(let r=0;r<i;++r)e.union(n[r].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),zo(e,t),e.translate(t.x||0,t.y||0)}function lg(e,t,n,i){const r=X7(t);e.beginPath(),Wh(e,t,(n||0)+r,(i||0)+r)}const Cfe=n0(lg),kfe=n0(lg,!1),$fe=n0(lg,!0);function Tfe(e,t,n,i){Ms(t,r=>{const s=r.x||0,a=r.y||0,o=r.strokeForeground,u=r.opacity==null?1:r.opacity;(r.stroke||r.fill)&&u&&(lg(e,r,s,a),oh(e,r),r.fill&&by(e,r,u)&&e.fill(),r.stroke&&!o&&uh(e,r,u)&&e.stroke()),e.save(),e.translate(s,a),r.clip&&Y7(e,r),n&&n.translate(-s,-a),Ms(r,l=>{(l.marktype==="group"||i==null||i.includes(l.marktype))&&this.draw(e,l,n,i)}),n&&n.translate(s,a),e.restore(),o&&r.stroke&&u&&(lg(e,r,s,a),oh(e,r),uh(e,r,u)&&e.stroke())})}function Ofe(e,t,n,i,r,s){if(t.bounds&&!t.bounds.contains(r,s)||!t.items)return null;const a=n*e.pixelRatio,o=i*e.pixelRatio;return _y(t,u=>{let l,c,f;const d=u.bounds;if(d&&!d.contains(r,s))return;c=u.x||0,f=u.y||0;const p=c+(u.width||0),m=f+(u.height||0),y=u.clip;if(y&&(r<c||r>p||s<f||s>m))return;if(e.save(),e.translate(c,f),c=r-c,f=s-f,y&&c$(u)&&!$fe(e,u,a,o))return e.restore(),null;const v=u.strokeForeground,b=t.interactive!==!1;return b&&v&&u.stroke&&kfe(e,u,a,o)?(e.restore(),u):(l=_y(u,_=>Ffe(_,c,f)?this.pick(_,n,i,c,f):null),!l&&b&&(u.fill||!v&&u.stroke)&&Cfe(e,u,a,o)&&(l=u),e.restore(),l||null)})}function Ffe(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var Mfe={type:"group",tag:"g",nested:!1,attr:_fe,bound:Afe,draw:Tfe,pick:Ofe,isect:q7,content:Sfe,background:wfe,foreground:Efe},cg={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function b$(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(i=>{e.image=i,e.image.url=e.url})),n}function _$(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function w$(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function $x(e,t){return e==="center"?t/2:e==="right"?t:0}function Tx(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function Nfe(e,t,n){const i=b$(t,n),r=_$(t,i),s=w$(t,i),a=(t.x||0)-$x(t.align,r),o=(t.y||0)-Tx(t.baseline,s),u=!i.src&&i.toDataURL?i.toDataURL():i.src||"";e("href",u,cg["xmlns:xlink"],"xlink:href"),e("transform",Jl(a,o)),e("width",r),e("height",s),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function Rfe(e,t){const n=t.image,i=_$(t,n),r=w$(t,n),s=(t.x||0)-$x(t.align,i),a=(t.y||0)-Tx(t.baseline,r);return e.set(s,a,s+i,a+r)}function Ife(e,t,n){Ms(t,i=>{if(n&&!n.intersects(i.bounds))return;const r=b$(i,this);let s=_$(i,r),a=w$(i,r);if(s===0||a===0)return;let o=(i.x||0)-$x(i.align,s),u=(i.y||0)-Tx(i.baseline,a),l,c,f,d;i.aspect!==!1&&(c=r.width/r.height,f=i.width/i.height,c===c&&f===f&&c!==f&&(f<c?(d=s/c,u+=(a-d)/2,a=d):(d=a*c,o+=(s-d)/2,s=d))),(r.complete||r.toDataURL)&&(oh(e,i),e.globalAlpha=(l=i.opacity)!=null?l:1,e.imageSmoothingEnabled=i.smooth!==!1,e.drawImage(r,o,u,s,a))})}var Dfe={type:"image",tag:"image",nested:!1,attr:Nfe,bound:Rfe,draw:Ife,pick:kx(),isect:Xr,get:b$,xOffset:$x,yOffset:Tx},Pfe=x$("line",tfe,yfe);function Lfe(e,t){var n=t.scaleX||1,i=t.scaleY||1;(n!==1||i!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",pfe(t)),e("d",t.path)}function M1(e,t){var n=t.path;if(n==null)return!0;var i=t.x||0,r=t.y||0,s=t.scaleX||1,a=t.scaleY||1,o=(t.angle||0)*Pu,u=t.pathCache;(!u||u.path!==n)&&((t.pathCache=u=ah(n)).path=n),o&&e.rotate&&e.translate?(e.translate(i,r),e.rotate(o),ug(e,u,0,0,s,a),e.rotate(-o),e.translate(-i,-r)):ug(e,u,i,r,s,a)}function zfe(e,t){return M1(t0(e,t.angle),t)?e.set(0,0,0,0):zo(e,t,!0)}var Bfe={type:"path",tag:"path",nested:!1,attr:Lfe,bound:zfe,draw:g$(M1),pick:m$(M1),isect:h$(M1)};function Ufe(e,t){e("d",Wh(null,t))}function jfe(e,t){var n,i;return zo(e.set(n=t.x||0,i=t.y||0,n+t.width||0,i+t.height||0),t)}function OI(e,t){e.beginPath(),Wh(e,t)}var qfe={type:"rect",tag:"path",nested:!1,attr:Ufe,bound:jfe,draw:g$(OI),pick:m$(OI),isect:q7};function Vfe(e,t){e("transform",H7(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function Wfe(e,t){var n,i;return zo(e.set(n=t.x||0,i=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:i),t)}function J7(e,t,n){var i,r,s,a;return t.stroke&&uh(e,t,n)?(i=t.x||0,r=t.y||0,s=t.x2!=null?t.x2:i,a=t.y2!=null?t.y2:r,e.beginPath(),e.moveTo(i,r),e.lineTo(s,a),!0):!1}function Gfe(e,t,n){Ms(t,i=>{if(!(n&&!n.intersects(i.bounds))){var r=i.opacity==null?1:i.opacity;r&&J7(e,i,r)&&(oh(e,i),e.stroke())}})}function Hfe(e,t,n,i){return e.isPointInStroke?J7(e,t,1)&&e.isPointInStroke(n,i):!1}var Yfe={type:"rule",tag:"line",nested:!1,attr:Vfe,bound:Wfe,draw:Gfe,pick:kx(Hfe),isect:V7},Xfe=v$("shape",nfe),Kfe=v$("symbol",ife,d$);const FI=r4();var yr={height:Ma,measureWidth:E$,estimateWidth:wy,width:wy,canvas:Q7};Q7(!0);function Q7(e){yr.width=e&&Tu?E$:wy}function wy(e,t){return Z7(zu(e,t),Ma(e))}function Z7(e,t){return~~(.8*e.length*t)}function E$(e,t){return Ma(e)<=0||!(t=zu(e,t))?0:ez(t,Ox(e))}function ez(e,t){const n=`(${t}) ${e}`;let i=FI.get(n);return i===void 0&&(Tu.font=t,i=Tu.measureText(e).width,FI.set(n,i)),i}function Ma(e){return e.fontSize!=null?+e.fontSize||0:11}function Lu(e){return e.lineHeight!=null?e.lineHeight:Ma(e)+2}function Jfe(e){return Q(e)?e.length>1?e:e[0]:e}function i0(e){return Jfe(e.lineBreak&&e.text&&!Q(e.text)?e.text.split(e.lineBreak):e.text)}function S$(e){const t=i0(e);return(Q(t)?t.length-1:0)*Lu(e)}function zu(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?Zfe(e,n):n}function Qfe(e){if(yr.width===E$){const t=Ox(e);return n=>ez(n,t)}else if(yr.width===wy){const t=Ma(e);return n=>Z7(n,t)}else return t=>yr.width(e,t)}function Zfe(e,t){var n=+e.limit,i=Qfe(e);if(i(t)<n)return t;var r=e.ellipsis||"…",s=e.dir==="rtl",a=0,o=t.length,u;if(n-=i(r),s){for(;a<o;)u=a+o>>>1,i(t.slice(u))>n?a=u+1:o=u;return r+t.slice(a)}else{for(;a<o;)u=1+(a+o>>>1),i(t.slice(0,u))<n?a=u:o=u-1;return t.slice(0,a)+r}}function r0(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Ox(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+Ma(e)+"px "+r0(e,t)}function A$(e){var t=e.baseline,n=Ma(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*Lu(e):t==="line-bottom"?.29*n-.5*Lu(e):0)}const ehe={left:"start",center:"middle",right:"end"},Dp=new pn;function Fx(e){var t=e.x||0,n=e.y||0,i=e.radius||0,r;return i&&(r=(e.theta||0)-Bl,t+=i*Math.cos(r),n+=i*Math.sin(r)),Dp.x1=t,Dp.y1=n,Dp}function the(e,t){var n=t.dx||0,i=(t.dy||0)+A$(t),r=Fx(t),s=r.x1,a=r.y1,o=t.angle||0,u;e("text-anchor",ehe[t.align]||"start"),o?(u=Jl(s,a)+" "+y$(o),(n||i)&&(u+=" "+Jl(n,i))):u=Jl(s+n,a+i),e("transform",u)}function C$(e,t,n){var i=yr.height(t),r=t.align,s=Fx(t),a=s.x1,o=s.y1,u=t.dx||0,l=(t.dy||0)+A$(t)-Math.round(.8*i),c=i0(t),f;if(Q(c)?(i+=Lu(t)*(c.length-1),f=c.reduce((d,p)=>Math.max(d,yr.width(t,p)),0)):f=yr.width(t,c),r==="center"?u-=f/2:r==="right"&&(u-=f),e.set(u+=a,l+=o,u+f,l+i),t.angle&&!n)e.rotate(t.angle*Pu,a,o);else if(n===2)return e.rotatedPoints(t.angle*Pu,a,o);return e}function nhe(e,t,n){Ms(t,i=>{var r=i.opacity==null?1:i.opacity,s,a,o,u,l,c,f;if(!(n&&!n.intersects(i.bounds)||r===0||i.fontSize<=0||i.text==null||i.text.length===0)){if(e.font=Ox(i),e.textAlign=i.align||"left",s=Fx(i),a=s.x1,o=s.y1,i.angle&&(e.save(),e.translate(a,o),e.rotate(i.angle*Pu),a=o=0),a+=i.dx||0,o+=(i.dy||0)+A$(i),c=i0(i),oh(e,i),Q(c))for(l=Lu(i),u=0;u<c.length;++u)f=zu(i,c[u]),i.fill&&by(e,i,r)&&e.fillText(f,a,o),i.stroke&&uh(e,i,r)&&e.strokeText(f,a,o),o+=l;else f=zu(i,c),i.fill&&by(e,i,r)&&e.fillText(f,a,o),i.stroke&&uh(e,i,r)&&e.strokeText(f,a,o);i.angle&&e.restore()}})}function ihe(e,t,n,i,r,s){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var a=Fx(t),o=a.x1,u=a.y1,l=C$(Dp,t,1),c=-t.angle*Pu,f=Math.cos(c),d=Math.sin(c),p=f*r-d*s+(o-f*o+d*u),m=d*r+f*s+(u-d*o-f*u);return l.contains(p,m)}function rhe(e,t){const n=C$(Dp,e,2);return Tf(t,n[0],n[1],n[2],n[3])||Tf(t,n[0],n[1],n[4],n[5])||Tf(t,n[4],n[5],n[6],n[7])||Tf(t,n[2],n[3],n[6],n[7])}var she={type:"text",tag:"text",nested:!1,attr:the,bound:C$,draw:nhe,pick:kx(ihe),isect:rhe},ahe=x$("trail",rfe,vfe),wr={arc:gfe,area:xfe,group:Mfe,image:Dfe,line:Pfe,path:Bfe,rect:qfe,rule:Yfe,shape:Xfe,symbol:Kfe,text:she,trail:ahe};function vS(e,t,n){var i=wr[e.mark.marktype],r=t||i.bound;return i.nested&&(e=e.mark),r(e.bounds||(e.bounds=new pn),e,n)}var MI={mark:null};function tz(e,t,n){var i=wr[e.marktype],r=i.bound,s=e.items,a=s&&s.length,o,u,l,c;if(i.nested)return a?l=s[0]:(MI.mark=e,l=MI),c=vS(l,r,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new pn,a)for(o=0,u=s.length;o<u;++o)t.union(vS(s[o],r,n));return e.bounds=t}const ohe=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function nz(e,t){return JSON.stringify(e,ohe,t)}function iz(e){const t=typeof e=="string"?JSON.parse(e):e;return rz(t)}function rz(e){var t=e.marktype,n=e.items,i,r,s;if(n)for(r=0,s=n.length;r<s;++r)i=t?"mark":"group",n[r][i]=e,n[r].zindex&&(n[r][i].zdirty=!0),(t||i)==="group"&&rz(n[r]);return t&&tz(e),e}class sz{constructor(t){arguments.length?this.root=iz(t):(this.root=NI({marktype:"group",name:"root",role:"frame"}),this.root.items=[new Ax(this.root)])}toJSON(t){return nz(this.root,t||0)}mark(t,n,i){n=n||this.root.items[0];const r=NI(t,n);return n.items[i]=r,r.zindex&&(r.group.zdirty=!0),r}}function NI(e,t){const n={bounds:new pn,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function mu(e,t,n){return!e&&typeof document<"u"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function k$(e,t){t=t.toLowerCase();for(var n=e.childNodes,i=0,r=n.length;i<r;++i)if(n[i].tagName.toLowerCase()===t)return n[i]}function xn(e,t,n,i){var r=e.childNodes[t],s;return(!r||r.tagName.toLowerCase()!==n.toLowerCase())&&(s=r||null,r=mu(e.ownerDocument,n,i),e.insertBefore(r,s)),r}function Lr(e,t){for(var n=e.childNodes,i=n.length;i>t;)e.removeChild(n[--i]);return e}function az(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function Mx(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function uhe(e,t,n,i){var r=e&&e.mark,s,a;if(r&&(s=wr[r.marktype]).tip){for(a=Mx(t,n),a[0]-=i[0],a[1]-=i[1];e=e.mark.group;)a[0]-=e.x||0,a[1]-=e.y||0;e=s.tip(r.items,a)}return e}let $$=class{constructor(t,n){this._active=null,this._handlers={},this._loader=t||Jv(),this._tooltip=n||lhe}initialize(t,n,i){return this._el=t,this._obj=i||null,this.origin(n)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()}scene(t){return arguments.length?(this._scene=t,this):this._scene}on(){}off(){}_handlerIndex(t,n,i){for(let r=t?t.length:0;--r>=0;)if(t[r].type===n&&(!i||t[r].handler===i))return r;return-1}handlers(t){const n=this._handlers,i=[];if(t)i.push(...n[this.eventName(t)]);else for(const r in n)i.push(...n[r]);return i}eventName(t){const n=t.indexOf(".");return n<0?t:t.slice(0,n)}handleHref(t,n,i){this._loader.sanitize(i,{context:"href"}).then(r=>{const s=new MouseEvent(t.type,t),a=mu(null,"a");for(const o in r)a.setAttribute(o,r[o]);a.dispatchEvent(s)}).catch(()=>{})}handleTooltip(t,n,i){if(n&&n.tooltip!=null){n=uhe(n,t,this.canvas(),this._origin);const r=i&&n&&n.tooltip||null;this._tooltip.call(this._obj,this,t,n,r)}}getItemBoundingClientRect(t){const n=this.canvas();if(!n)return;const i=n.getBoundingClientRect(),r=this._origin,s=t.bounds,a=s.width(),o=s.height();let u=s.x1+r[0]+i.left,l=s.y1+r[1]+i.top;for(;t.mark&&(t=t.mark.group);)u+=t.x||0,l+=t.y||0;return{x:u,y:l,width:a,height:o,left:u,top:l,right:u+a,bottom:l+o}}};function lhe(e,t,n,i){e.element().setAttribute("title",i||"")}class s0{constructor(t){this._el=null,this._bgcolor=null,this._loader=new j7(t)}initialize(t,n,i,r,s){return this._el=t,this.resize(n,i,r,s)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}background(t){return arguments.length===0?this._bgcolor:(this._bgcolor=t,this)}resize(t,n,i,r){return this._width=t,this._height=n,this._origin=i||[0,0],this._scale=r||1,this}dirty(){}render(t,n){const i=this;return i._call=function(){i._render(t,n)},i._call(),i._call=null,i}_render(){}renderAsync(t,n){const i=this.render(t,n);return this._ready?this._ready.then(()=>i):Promise.resolve(i)}_load(t,n){var i=this,r=i._loader[t](n);if(!i._ready){const s=i._call;i._ready=i._loader.ready().then(a=>{a&&s(),i._ready=null})}return r}sanitizeURL(t){return this._load("sanitizeURL",t)}loadImage(t){return this._load("loadImage",t)}}const che="keydown",fhe="keypress",hhe="keyup",oz="dragenter",N1="dragleave",uz="dragover",xS="pointerdown",dhe="pointerup",Ey="pointermove",R1="pointerout",lz="pointerover",bS="mousedown",phe="mouseup",cz="mousemove",Sy="mouseout",fz="mouseover",Ay="click",ghe="dblclick",mhe="wheel",hz="mousewheel",Cy="touchstart",ky="touchmove",$y="touchend",yhe=[che,fhe,hhe,oz,N1,uz,xS,dhe,Ey,R1,lz,bS,phe,cz,Sy,fz,Ay,ghe,mhe,hz,Cy,ky,$y],_S=Ey,Pp=Sy,wS=Ay;class a0 extends $${constructor(t,n){super(t,n),this._down=null,this._touch=null,this._first=!0,this._events={},this.events=yhe,this.pointermove=II([Ey,cz],[lz,fz],[R1,Sy]),this.dragover=II([uz],[oz],[N1]),this.pointerout=DI([R1,Sy]),this.dragleave=DI([N1])}initialize(t,n,i){return this._canvas=t&&k$(t,"canvas"),[Ay,bS,xS,Ey,R1,N1].forEach(r=>RI(this,r)),super.initialize(t,n,i)}canvas(){return this._canvas}context(){return this._canvas.getContext("2d")}DOMMouseScroll(t){this.fire(hz,t)}pointerdown(t){this._down=this._active,this.fire(xS,t)}mousedown(t){this._down=this._active,this.fire(bS,t)}click(t){this._down===this._active&&(this.fire(Ay,t),this._down=null)}touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(Cy,t,!0)}touchmove(t){this.fire(ky,t,!0)}touchend(t){this.fire($y,t,!0),this._touch=null}fire(t,n,i){const r=i?this._touch:this._active,s=this._handlers[t];if(n.vegaType=t,t===wS&&r&&r.href?this.handleHref(n,r,r.href):(t===_S||t===Pp)&&this.handleTooltip(n,r,t!==Pp),s)for(let a=0,o=s.length;a<o;++a)s[a].handler.call(this._obj,n,r)}on(t,n){const i=this.eventName(t),r=this._handlers;return this._handlerIndex(r[i],t,n)<0&&(RI(this,t),(r[i]||(r[i]=[])).push({type:t,handler:n})),this}off(t,n){const i=this.eventName(t),r=this._handlers[i],s=this._handlerIndex(r,t,n);return s>=0&&r.splice(s,1),this}pickEvent(t){const n=Mx(t,this._canvas),i=this._origin;return this.pick(this._scene,n[0],n[1],n[0]-i[0],n[1]-i[1])}pick(t,n,i,r,s){const a=this.context();return wr[t.marktype].pick.call(this,a,t,n,i,r,s)}}const vhe=e=>e===Cy||e===ky||e===$y?[Cy,ky,$y]:[e];function RI(e,t){vhe(t).forEach(n=>xhe(e,n))}function xhe(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?i=>e[t](i):i=>e.fire(t,i)))}function xp(e,t,n){t.forEach(i=>e.fire(i,n))}function II(e,t,n){return function(i){const r=this._active,s=this.pickEvent(i);s===r?xp(this,e,i):((!r||!r.exit)&&xp(this,n,i),this._active=s,xp(this,t,i),xp(this,e,i))}}function DI(e){return function(t){xp(this,e,t),this._active=null}}function bhe(){return typeof window<"u"&&window.devicePixelRatio||1}function _he(e,t,n,i,r,s){const a=typeof HTMLElement<"u"&&e instanceof HTMLElement&&e.parentNode!=null,o=e.getContext("2d"),u=a?bhe():r;e.width=t*u,e.height=n*u;for(const l in s)o[l]=s[l];return a&&u!==1&&(e.style.width=t+"px",e.style.height=n+"px"),o.pixelRatio=u,o.setTransform(u,0,0,u,u*i[0],u*i[1]),e}class Ty extends s0{constructor(t){super(t),this._options={},this._redraw=!1,this._dirty=new pn,this._tempb=new pn}initialize(t,n,i,r,s,a){return this._options=a||{},this._canvas=this._options.externalContext?null:$u(1,1,this._options.type),t&&this._canvas&&(Lr(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),super.initialize(t,n,i,r,s)}resize(t,n,i,r){if(super.resize(t,n,i,r),this._canvas)_he(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const s=this._options.externalContext;s||K("CanvasRenderer is missing a valid canvas or context"),s.scale(this._scale,this._scale),s.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this}canvas(){return this._canvas}context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)}dirty(t){const n=this._tempb.clear().union(t.bounds);let i=t.mark.group;for(;i;)n.translate(i.x||0,i.y||0),i=i.mark.group;this._dirty.union(n)}_render(t,n){const i=this.context(),r=this._origin,s=this._width,a=this._height,o=this._dirty,u=whe(r,s,a);i.save();const l=this._redraw||o.empty()?(this._redraw=!1,u.expand(1)):Ehe(i,u.intersect(o),r);return this.clear(-r[0],-r[1],s,a),this.draw(i,t,l,n),i.restore(),o.clear(),this}draw(t,n,i,r){if(n.marktype!=="group"&&r!=null&&!r.includes(n.marktype))return;const s=wr[n.marktype];n.clip&&bfe(t,n),s.draw.call(this,t,n,i,r),n.clip&&t.restore()}clear(t,n,i,r){const s=this._options,a=this.context();s.type!=="pdf"&&!s.externalContext&&a.clearRect(t,n,i,r),this._bgcolor!=null&&(a.fillStyle=this._bgcolor,a.fillRect(t,n,i,r))}}const whe=(e,t,n)=>new pn().set(0,0,t,n).translate(-e[0],-e[1]);function Ehe(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}class dz extends $${constructor(t,n){super(t,n);const i=this;i._hrefHandler=lw(i,(r,s)=>{s&&s.href&&i.handleHref(r,s,s.href)}),i._tooltipHandler=lw(i,(r,s)=>{i.handleTooltip(r,s,r.type!==Pp)})}initialize(t,n,i){let r=this._svg;return r&&(r.removeEventListener(wS,this._hrefHandler),r.removeEventListener(_S,this._tooltipHandler),r.removeEventListener(Pp,this._tooltipHandler)),this._svg=r=t&&k$(t,"svg"),r&&(r.addEventListener(wS,this._hrefHandler),r.addEventListener(_S,this._tooltipHandler),r.addEventListener(Pp,this._tooltipHandler)),super.initialize(t,n,i)}canvas(){return this._svg}on(t,n){const i=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[i],t,n)<0){const a={type:t,handler:n,listener:lw(this,n)};(r[i]||(r[i]=[])).push(a),this._svg&&this._svg.addEventListener(i,a.listener)}return this}off(t,n){const i=this.eventName(t),r=this._handlers[i],s=this._handlerIndex(r,t,n);return s>=0&&(this._svg&&this._svg.removeEventListener(i,r[s].listener),r.splice(s,1)),this}}const lw=(e,t)=>n=>{let i=n.target.__data__;i=Array.isArray(i)?i[0]:i,n.vegaType=n.type,t.call(e._obj,n,i)},pz="aria-hidden",T$="aria-label",O$="role",F$="aria-roledescription",gz="graphics-object",M$="graphics-symbol",mz=(e,t,n)=>({[O$]:e,[F$]:t,[T$]:n||void 0}),She=Os(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),PI={axis:{desc:"axis",caption:khe},legend:{desc:"legend",caption:$he},"title-text":{desc:"title",caption:e=>`Title text '${zI(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${zI(e)}'`}},LI={ariaRole:O$,ariaRoleDescription:F$,description:T$};function yz(e,t){const n=t.aria===!1;if(e(pz,n||void 0),n||t.description==null)for(const i in LI)e(LI[i],void 0);else{const i=t.mark.marktype;e(T$,t.description),e(O$,t.ariaRole||(i==="group"?gz:M$)),e(F$,t.ariaRoleDescription||`${i} mark`)}}function vz(e){return e.aria===!1?{[pz]:!0}:She[e.role]?null:PI[e.role]?Che(e,PI[e.role]):Ahe(e)}function Ahe(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(i=>i.description!=null&&i.aria!==!1);return mz(n?gz:M$,`${t} mark container`,e.description)}function Che(e,t){try{const n=e.items[0],i=t.caption||(()=>"");return mz(t.role||M$,t.desc,n.description||i(n))}catch{return null}}function zI(e){return pe(e.text).join(" ")}function khe(e){const t=e.datum,n=e.orient,i=t.title?xz(e):null,r=e.context,s=r.scales[t.scale].value,a=r.dataflow.locale(),o=s.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(i?` titled '${i}'`:"")+` for a ${sh(o)?"discrete":o} scale with ${M7(a,s,e)}`}function $he(e){const t=e.datum,n=t.title?xz(e):null,i=`${t.type||""} legend`.trim(),r=t.scales,s=Object.keys(r),a=e.context,o=a.scales[r[s[0]]].value,u=a.dataflow.locale();return Ohe(i)+(n?` titled '${n}'`:"")+` for ${The(s)} with ${M7(u,o,e)}`}function xz(e){try{return pe(ot(e.items).items[0].text).join(" ")}catch{return null}}function The(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+ot(e)}function Ohe(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const bz=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Fhe=e=>bz(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function N$(){let e="",t="",n="";const i=[],r=()=>t=n="",s=u=>{t&&(e+=`${t}>${n}`,r()),i.push(u)},a=(u,l)=>(l!=null&&(t+=` ${u}="${Fhe(l)}"`),o),o={open(u){s(u),t="<"+u;for(var l=arguments.length,c=new Array(l>1?l-1:0),f=1;f<l;f++)c[f-1]=arguments[f];for(const d of c)for(const p in d)a(p,d[p]);return o},close(){const u=i.pop();return t?e+=t+(n?`>${n}</${u}>`:"/>"):e+=`</${u}>`,r(),o},attr:a,text:u=>(n+=bz(u),o),toString:()=>e};return o}const _z=e=>wz(N$(),e)+"";function wz(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,i=n.length;for(let r=0;r<i;++r)e.attr(n[r].name,n[r].value)}if(t.hasChildNodes()){const n=t.childNodes;for(const i of n)i.nodeType===3?e.text(i.nodeValue):wz(e,i)}return e.close()}const Oy={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},Fy={blend:"mix-blend-mode"},Ez={fill:"none","stroke-miterlimit":10},Hd=0,BI="http://www.w3.org/2000/xmlns/",vn=cg.xmlns;class R$ extends s0{constructor(t){super(t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}initialize(t,n,i,r,s){return this._defs={},this._clearDefs(),t&&(this._svg=xn(t,0,"svg",vn),this._svg.setAttributeNS(BI,"xmlns",vn),this._svg.setAttributeNS(BI,"xmlns:xlink",cg["xmlns:xlink"]),this._svg.setAttribute("version",cg.version),this._svg.setAttribute("class","marks"),Lr(t,1),this._root=xn(this._svg,Hd,"g",vn),yu(this._root,Ez),Lr(this._svg,Hd+1)),this.background(this._bgcolor),super.initialize(t,n,i,r,s)}background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),super.background(...arguments)}resize(t,n,i,r){return super.resize(t,n,i,r),this._svg&&(yu(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this}canvas(){return this._svg}svg(){const t=this._svg,n=this._bgcolor;if(!t)return null;let i;n&&(t.removeAttribute("style"),i=xn(t,Hd,"rect",vn),yu(i,{width:this._width,height:this._height,fill:n}));const r=_z(t);return n&&(t.removeChild(i),this._svg.style.setProperty("background-color",n)),r}_render(t,n){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t,void 0,n),Lr(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this}dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))}isDirty(t){return this._dirtyAll||!t._svg||!t._svg.ownerSVGElement||t.dirty===this._dirtyID}_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const n=++this._dirtyID;let i,r,s,a,o,u,l;for(o=0,u=t.length;o<u;++o)if(i=t[o],r=i.mark,r.marktype!==s&&(s=r.marktype,a=wr[s]),r.zdirty&&r.dirty!==n&&(this._dirtyAll=!1,UI(i,n),r.items.forEach(c=>{c.dirty=n})),!r.zdirty){if(i.exit){a.nested&&r.items.length?(l=r.items[0],l._svg&&this._update(a,l._svg,l)):i._svg&&(l=i._svg.parentNode,l&&l.removeChild(i._svg)),i._svg=null;continue}i=a.nested?r.items[0]:i,i._update!==n&&(!i._svg||!i._svg.ownerSVGElement?(this._dirtyAll=!1,UI(i,n)):this._update(a,i._svg,i),i._update=n)}return!this._dirtyAll}mark(t,n,i,r){if(!this.isDirty(n))return n._svg;const s=this._svg,a=n.marktype,o=wr[a],u=n.interactive===!1?"none":null,l=o.tag==="g",c=jI(n,t,i,"g",s);if(a!=="group"&&r!=null&&!r.includes(a))return Lr(c,0),n._svg;c.setAttribute("class",az(n));const f=vz(n);for(const y in f)xi(c,y,f[y]);l||xi(c,"pointer-events",u),xi(c,"clip-path",n.clip?f$(this,n,n.group):null);let d=null,p=0;const m=y=>{const v=this.isDirty(y),b=jI(y,c,d,o.tag,s);v&&(this._update(o,b,y),l&&Rhe(this,b,y,r)),d=b,++p};return o.nested?n.items.length&&m(n.items[0]):Ms(n,m),Lr(c,p),c}_update(t,n,i){yo=n,ri=n.__values__,yz(Lp,i),t.attr(Lp,i,this);const r=Dhe[t.type];r&&r.call(this,t,n,i),yo&&this.style(yo,i)}style(t,n){if(n!=null){for(const i in Oy){let r=i==="font"?r0(n):n[i];if(r===ri[i])continue;const s=Oy[i];r==null?t.removeAttribute(s):(u$(r)&&(r=R7(r,this._defs.gradient,Sz())),t.setAttribute(s,r+"")),ri[i]=r}for(const i in Fy)I1(t,Fy[i],n[i])}}defs(){const t=this._svg,n=this._defs;let i=n.el,r=0;for(const s in n.gradient)i||(n.el=i=xn(t,Hd+1,"defs",vn)),r=Mhe(i,n.gradient[s],r);for(const s in n.clipping)i||(n.el=i=xn(t,Hd+1,"defs",vn)),r=Nhe(i,n.clipping[s],r);i&&(r===0?(t.removeChild(i),n.el=null):Lr(i,r))}_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}}function UI(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function Mhe(e,t,n){let i,r,s;if(t.gradient==="radial"){let a=xn(e,n++,"pattern",vn);yu(a,{id:xy+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),a=xn(a,0,"rect",vn),yu(a,{width:1,height:1,fill:`url(${Sz()}#${t.id})`}),e=xn(e,n++,"radialGradient",vn),yu(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=xn(e,n++,"linearGradient",vn),yu(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(i=0,r=t.stops.length;i<r;++i)s=xn(e,i,"stop",vn),s.setAttribute("offset",t.stops[i].offset),s.setAttribute("stop-color",t.stops[i].color);return Lr(e,i),n}function Nhe(e,t,n){let i;return e=xn(e,n,"clipPath",vn),e.setAttribute("id",t.id),t.path?(i=xn(e,0,"path",vn),i.setAttribute("d",t.path)):(i=xn(e,0,"rect",vn),yu(i,{x:0,y:0,width:t.width,height:t.height})),Lr(e,1),n+1}function Rhe(e,t,n,i){t=t.lastChild.previousSibling;let r,s=0;Ms(n,a=>{r=e.mark(t,a,r,i),++s}),Lr(t,1+s)}function jI(e,t,n,i,r){let s=e._svg,a;if(!s&&(a=t.ownerDocument,s=mu(a,i,vn),e._svg=s,e.mark&&(s.__data__=e,s.__values__={fill:"default"},i==="g"))){const o=mu(a,"path",vn);s.appendChild(o),o.__data__=e;const u=mu(a,"g",vn);s.appendChild(u),u.__data__=e;const l=mu(a,"path",vn);s.appendChild(l),l.__data__=e,l.__values__={fill:"default"}}return(s.ownerSVGElement!==r||Ihe(s,n))&&t.insertBefore(s,n?n.nextSibling:t.firstChild),s}function Ihe(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let yo=null,ri=null;const Dhe={group(e,t,n){const i=yo=t.childNodes[2];ri=i.__values__,e.foreground(Lp,n,this),ri=t.__values__,yo=t.childNodes[1],e.content(Lp,n,this);const r=yo=t.childNodes[0];e.background(Lp,n,this);const s=n.mark.interactive===!1?"none":null;if(s!==ri.events&&(xi(i,"pointer-events",s),xi(r,"pointer-events",s),ri.events=s),n.strokeForeground&&n.stroke){const a=n.fill;xi(i,"display",null),this.style(r,n),xi(r,"stroke",null),a&&(n.fill=null),ri=i.__values__,this.style(i,n),a&&(n.fill=a),yo=null}else xi(i,"display","none")},image(e,t,n){n.smooth===!1?(I1(t,"image-rendering","optimizeSpeed"),I1(t,"image-rendering","pixelated")):I1(t,"image-rendering",null)},text(e,t,n){const i=i0(n);let r,s,a,o;Q(i)?(s=i.map(u=>zu(n,u)),r=s.join(`
`),r!==ri.text&&(Lr(t,0),a=t.ownerDocument,o=Lu(n),s.forEach((u,l)=>{const c=mu(a,"tspan",vn);c.__data__=n,c.textContent=u,l&&(c.setAttribute("x",0),c.setAttribute("dy",o)),t.appendChild(c)}),ri.text=r)):(s=zu(n,i),s!==ri.text&&(t.textContent=s,ri.text=s)),xi(t,"font-family",r0(n)),xi(t,"font-size",Ma(n)+"px"),xi(t,"font-style",n.fontStyle),xi(t,"font-variant",n.fontVariant),xi(t,"font-weight",n.fontWeight)}};function Lp(e,t,n){t!==ri[e]&&(n?Phe(yo,e,t,n):xi(yo,e,t),ri[e]=t)}function I1(e,t,n){n!==ri[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),ri[t]=n)}function yu(e,t){for(const n in t)xi(e,n,t[n])}function xi(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function Phe(e,t,n,i){n!=null?e.setAttributeNS(i,t,n):e.removeAttributeNS(i,t)}function Sz(){let e;return typeof window>"u"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}class Az extends s0{constructor(t){super(t),this._text=null,this._defs={gradient:{},clipping:{}}}svg(){return this._text}_render(t){const n=N$();n.open("svg",We({},cg,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const i=this._bgcolor;return i&&i!=="transparent"&&i!=="none"&&n.open("rect",{width:this._width,height:this._height,fill:i}).close(),n.open("g",Ez,{transform:"translate("+this._origin+")"}),this.mark(n,t),n.close(),this.defs(n),this._text=n.close()+"",this}mark(t,n){const i=wr[n.marktype],r=i.tag,s=[yz,i.attr];t.open("g",{class:az(n),"clip-path":n.clip?f$(this,n,n.group):null},vz(n),{"pointer-events":r!=="g"&&n.interactive===!1?"none":null});const a=o=>{const u=this.href(o);if(u&&t.open("a",u),t.open(r,this.attr(n,o,s,r!=="g"?r:null)),r==="text"){const l=i0(o);if(Q(l)){const c={x:0,dy:Lu(o)};for(let f=0;f<l.length;++f)t.open("tspan",f?c:null).text(zu(o,l[f])).close()}else t.text(zu(o,l))}else if(r==="g"){const l=o.strokeForeground,c=o.fill,f=o.stroke;l&&f&&(o.stroke=null),t.open("path",this.attr(n,o,i.background,"bgrect")).close(),t.open("g",this.attr(n,o,i.content)),Ms(o,d=>this.mark(t,d)),t.close(),l&&f?(c&&(o.fill=null),o.stroke=f,t.open("path",this.attr(n,o,i.foreground,"bgrect")).close(),c&&(o.fill=c)):t.open("path",this.attr(n,o,i.foreground,"bgfore")).close()}t.close(),u&&t.close()};return i.nested?n.items&&n.items.length&&a(n.items[0]):Ms(n,a),t.close()}href(t){const n=t.href;let i;if(n){if(i=this._hrefs&&this._hrefs[n])return i;this.sanitizeURL(n).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[n]=r})}return null}attr(t,n,i,r){const s={},a=(o,u,l,c)=>{s[c||o]=u};return Array.isArray(i)?i.forEach(o=>o(a,n,this)):i(a,n,this),r&&Lhe(s,n,t,r,this._defs),s}defs(t){const n=this._defs.gradient,i=this._defs.clipping;if(Object.keys(n).length+Object.keys(i).length!==0){t.open("defs");for(const s in n){const a=n[s],o=a.stops;a.gradient==="radial"?(t.open("pattern",{id:xy+s,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+s+")"}).close(),t.close(),t.open("radialGradient",{id:s,fx:a.x1,fy:a.y1,fr:a.r1,cx:a.x2,cy:a.y2,r:a.r2})):t.open("linearGradient",{id:s,x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2});for(let u=0;u<o.length;++u)t.open("stop",{offset:o[u].offset,"stop-color":o[u].color}).close();t.close()}for(const s in i){const a=i[s];t.open("clipPath",{id:s}),a.path?t.open("path",{d:a.path}).close():t.open("rect",{x:0,y:0,width:a.width,height:a.height}).close(),t.close()}t.close()}}}function Lhe(e,t,n,i,r){let s;if(t==null||(i==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),i==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;i==="image"&&t.smooth===!1&&(s=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),i==="text"&&(e["font-family"]=r0(t),e["font-size"]=Ma(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const a in Oy){let o=t[a];const u=Oy[a];o==="transparent"&&(u==="fill"||u==="stroke")||o!=null&&(u$(o)&&(o=R7(o,r.gradient,"")),e[u]=o)}for(const a in Fy){const o=t[a];o!=null&&(s=s||[],s.push(`${Fy[a]}: ${o};`))}return s&&(e.style=s.join(" ")),e}const ms={svgMarkTypes:["text"],svgOnTop:!0,debug:!1};function zhe(e){ms.svgMarkTypes=e.svgMarkTypes??["text"],ms.svgOnTop=e.svgOnTop??!0,ms.debug=e.debug??!1}class ES extends s0{constructor(t){super(t),this._svgRenderer=new R$(t),this._canvasRenderer=new Ty(t)}initialize(t,n,i,r,s){this._root_el=xn(t,0,"div");const a=xn(this._root_el,0,"div"),o=xn(this._root_el,1,"div");return this._root_el.style.position="relative",ms.debug||(a.style.height="100%",o.style.position="absolute",o.style.top="0",o.style.left="0",o.style.height="100%",o.style.width="100%"),this._svgEl=ms.svgOnTop?o:a,this._canvasEl=ms.svgOnTop?a:o,this._svgEl.style.pointerEvents="none",this._canvasRenderer.initialize(this._canvasEl,n,i,r,s),this._svgRenderer.initialize(this._svgEl,n,i,r,s),super.initialize(t,n,i,r,s)}dirty(t){return ms.svgMarkTypes.includes(t.mark.marktype)?this._svgRenderer.dirty(t):this._canvasRenderer.dirty(t),this}_render(t,n){const r=(n??["arc","area","image","line","path","rect","rule","shape","symbol","text","trail"]).filter(s=>!ms.svgMarkTypes.includes(s));this._svgRenderer.render(t,ms.svgMarkTypes),this._canvasRenderer.render(t,r)}resize(t,n,i,r){return super.resize(t,n,i,r),this._svgRenderer.resize(t,n,i,r),this._canvasRenderer.resize(t,n,i,r),this}background(t){return ms.svgOnTop?this._canvasRenderer.background(t):this._svgRenderer.background(t),this}}class Cz extends a0{constructor(t,n){super(t,n)}initialize(t,n,i){const r=xn(xn(t,0,"div"),ms.svgOnTop?0:1,"div");return super.initialize(r,n,i)}}const kz="canvas",$z="hybrid",Tz="png",Oz="svg",Fz="none",vu={Canvas:kz,PNG:Tz,SVG:Oz,Hybrid:$z,None:Fz},uc={};uc[kz]=uc[Tz]={renderer:Ty,headless:Ty,handler:a0};uc[Oz]={renderer:R$,headless:Az,handler:dz};uc[$z]={renderer:ES,headless:ES,handler:Cz};uc[Fz]={};function Nx(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(uc[e]=t,this):uc[e]}function Mz(e,t,n){const i=[],r=new pn().union(t),s=e.marktype;return s?Nz(e,r,n,i):s==="group"?Rz(e,r,n,i):K("Intersect scene must be mark node or group item.")}function Nz(e,t,n,i){if(Bhe(e,t,n)){const r=e.items,s=e.marktype,a=r.length;let o=0;if(s==="group")for(;o<a;++o)Rz(r[o],t,n,i);else for(const u=wr[s].isect;o<a;++o){const l=r[o];Iz(l,t,u)&&i.push(l)}}return i}function Bhe(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function Rz(e,t,n,i){n&&n(e.mark)&&Iz(e,t,wr.group.isect)&&i.push(e);const r=e.items,s=r&&r.length;if(s){const a=e.x||0,o=e.y||0;t.translate(-a,-o);for(let u=0;u<s;++u)Nz(r[u],t,n,i);t.translate(a,o)}return i}function Iz(e,t,n){const i=e.bounds;return t.encloses(i)||t.intersects(i)&&n(e,t)}const cw=new pn;function Dz(e){const t=e.clip;if(Ye(t))t(t0(cw.clear()));else if(t)cw.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(cw)}const Uhe=1e-9;function I$(e,t,n){return e===t?!0:n==="path"?Pz(e,t):e instanceof Date&&t instanceof Date?+e==+t:dt(e)&&dt(t)?Math.abs(e-t)<=Uhe:!e||!t||!de(e)&&!de(t)?e==t:jhe(e,t)}function Pz(e,t){return I$(ah(e),ah(t))}function jhe(e,t){var n=Object.keys(e),i=Object.keys(t),r,s;if(n.length!==i.length)return!1;for(n.sort(),i.sort(),s=n.length-1;s>=0;s--)if(n[s]!=i[s])return!1;for(s=n.length-1;s>=0;s--)if(r=n[s],!I$(e[r],t[r],r))return!1;return typeof e==typeof t}function qhe(){U7(),dce()}const lh="top",_s="left",ws="right",Bu="bottom",Vhe="top-left",Whe="top-right",Ghe="bottom-left",Hhe="bottom-right",D$="start",SS="middle",bi="end",Yhe="x",Xhe="y",Rx="group",P$="axis",L$="title",Khe="frame",Jhe="scope",z$="legend",Lz="row-header",zz="row-footer",Bz="row-title",Uz="column-header",jz="column-footer",qz="column-title",Qhe="padding",Zhe="symbol",Vz="fit",Wz="fit-x",Gz="fit-y",ede="pad",B$="none",jm="all",AS="each",U$="flush",xu="column",bu="row";function Hz(e){H.call(this,null,e)}ce(Hz,H,{transform(e,t){const n=t.dataflow,i=e.mark,r=i.marktype,s=wr[r],a=s.bound;let o=i.bounds,u;if(s.nested)i.items.length&&n.dirty(i.items[0]),o=qm(i,a),i.items.forEach(l=>{l.bounds.clear().union(o)});else if(r===Rx||e.modified())switch(t.visit(t.MOD,l=>n.dirty(l)),o.clear(),i.items.forEach(l=>o.union(qm(l,a))),i.role){case P$:case z$:case L$:t.reflow()}else u=t.changed(t.REM),t.visit(t.ADD,l=>{o.union(qm(l,a))}),t.visit(t.MOD,l=>{u=u||o.alignsWith(l.bounds),n.dirty(l),o.union(qm(l,a))}),u&&(o.clear(),i.items.forEach(l=>o.union(l.bounds)));return Dz(i),t.modifies("bounds")}});function qm(e,t,n){return t(e.bounds.clear(),e,n)}const qI=":vega_identifier:";function j$(e){H.call(this,0,e)}j$.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};ce(j$,H,{transform(e,t){const n=tde(t.dataflow),i=e.as;let r=n.value;return t.visit(t.ADD,s=>s[i]=s[i]||++r),n.set(this.value=r),t}});function tde(e){return e._signals[qI]||(e._signals[qI]=e.add(0))}function Yz(e){H.call(this,null,e)}ce(Yz,H,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,nde(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const i=n.marktype===Rx?Ax:Sx;return t.visit(t.ADD,r=>i.call(r,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function nde(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function Xz(e){H.call(this,null,e)}const VI={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((i,r)=>!r||!Kz(n.bounds,i.bounds,t)?(n=i,1):i.opacity=0)}},Kz=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),WI=(e,t)=>{for(var n=1,i=e.length,r=e[0].bounds,s;n<i;r=s,++n)if(Kz(r,s=e[n].bounds,t))return!0},ide=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},rde=(e,t,n)=>{var i=e.range(),r=new pn;return t===lh||t===Bu?r.set(i[0],-1/0,i[1],1/0):r.set(-1/0,i[0],1/0,i[1]),r.expand(n||1),s=>r.encloses(s.bounds)},GI=e=>(e.forEach(t=>t.opacity=1),e),HI=(e,t)=>e.reflow(t.modified()).modifies("opacity");ce(Xz,H,{transform(e,t){const n=VI[e.method]||VI.parity,i=e.separation||0;let r=t.materialize(t.SOURCE).source,s,a;if(!r||!r.length)return;if(!e.method)return e.modified("method")&&(GI(r),t=HI(t,e)),t;if(r=r.filter(ide),!r.length)return;if(e.sort&&(r=r.slice().sort(e.sort)),s=GI(r),t=HI(t,e),s.length>=3&&WI(s,i)){do s=n(s,i);while(s.length>=3&&WI(s,i));s.length<3&&!ot(r).opacity&&(s.length>1&&(ot(s).opacity=0),ot(r).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(a=rde(e.boundScale,e.boundOrient,+e.boundTolerance),r.forEach(u=>{a(u)||(u.opacity=0)}));const o=s[0].mark.bounds.clear();return r.forEach(u=>{u.opacity&&o.union(u.bounds)}),t}});function Jz(e){H.call(this,null,e)}ce(Jz,H,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,i=>n.dirty(i)),t.fields&&t.fields.zindex){const i=t.source&&t.source[0];i&&(i.mark.zdirty=!0)}}});const ii=new pn;function Of(e,t,n){return e[t]===n?0:(e[t]=n,1)}function sde(e){var t=e.items[0].orient;return t===_s||t===ws}function ade(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function ode(e,t,n,i){var r=t.items[0],s=r.datum,a=r.translate!=null?r.translate:.5,o=r.orient,u=ade(s),l=r.range,c=r.offset,f=r.position,d=r.minExtent,p=r.maxExtent,m=s.title&&r.items[u[2]].items[0],y=r.titlePadding,v=r.bounds,b=m&&S$(m),_=0,E=0,S,A;switch(ii.clear().union(v),v.clear(),(S=u[0])>-1&&v.union(r.items[S].bounds),(S=u[1])>-1&&v.union(r.items[S].bounds),o){case lh:_=f||0,E=-c,A=Math.max(d,Math.min(p,-v.y1)),v.add(0,-A).add(l,0),m&&Vm(e,m,A,y,b,0,-1,v);break;case _s:_=-c,E=f||0,A=Math.max(d,Math.min(p,-v.x1)),v.add(-A,0).add(0,l),m&&Vm(e,m,A,y,b,1,-1,v);break;case ws:_=n+c,E=f||0,A=Math.max(d,Math.min(p,v.x2)),v.add(0,0).add(A,l),m&&Vm(e,m,A,y,b,1,1,v);break;case Bu:_=f||0,E=i+c,A=Math.max(d,Math.min(p,v.y2)),v.add(0,0).add(l,A),m&&Vm(e,m,A,y,0,0,1,v);break;default:_=r.x,E=r.y}return zo(v.translate(_,E),r),Of(r,"x",_+a)|Of(r,"y",E+a)&&(r.bounds=ii,e.dirty(r),r.bounds=v,e.dirty(r)),r.mark.bounds.clear().union(v)}function Vm(e,t,n,i,r,s,a,o){const u=t.bounds;if(t.auto){const l=a*(n+r+i);let c=0,f=0;e.dirty(t),s?c=(t.x||0)-(t.x=l):f=(t.y||0)-(t.y=l),t.mark.bounds.clear().union(u.translate(-c,-f)),e.dirty(t)}o.union(u)}const YI=(e,t)=>Math.floor(Math.min(e,t)),XI=(e,t)=>Math.ceil(Math.max(e,t));function ude(e){var t=e.items,n=t.length,i=0,r,s;const a={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;i<n;++i)if(r=t[i],s=r.items,r.marktype===Rx)switch(r.role){case P$:case z$:case L$:break;case Lz:a.rowheaders.push(...s);break;case zz:a.rowfooters.push(...s);break;case Uz:a.colheaders.push(...s);break;case jz:a.colfooters.push(...s);break;case Bz:a.rowtitle=s[0];break;case qz:a.coltitle=s[0];break;default:a.marks.push(...s)}return a}function lde(e){return new pn().set(0,0,e.width||0,e.height||0)}function cde(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function Lt(e,t,n){const i=de(e)?e[t]:e;return i??(n!==void 0?n:0)}function KI(e){return e<0?Math.ceil(-e):0}function Qz(e,t,n){var i=!n.nodirty,r=n.bounds===U$?lde:cde,s=ii.set(0,0,0,0),a=Lt(n.align,xu),o=Lt(n.align,bu),u=Lt(n.padding,xu),l=Lt(n.padding,bu),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),d=t.length,p=Array(d),m=Array(c),y=0,v=Array(d),b=Array(f),_=0,E=Array(d),S=Array(d),A=Array(d),$,C,M,N,P,D,W,q,z,R,U;for(C=0;C<c;++C)m[C]=0;for(C=0;C<f;++C)b[C]=0;for(C=0;C<d;++C)D=t[C],P=A[C]=r(D),D.x=D.x||0,E[C]=0,D.y=D.y||0,S[C]=0,M=C%c,N=~~(C/c),y=Math.max(y,W=Math.ceil(P.x2)),_=Math.max(_,q=Math.ceil(P.y2)),m[M]=Math.max(m[M],W),b[N]=Math.max(b[N],q),p[C]=u+KI(P.x1),v[C]=l+KI(P.y1),i&&e.dirty(t[C]);for(C=0;C<d;++C)C%c===0&&(p[C]=0),C<c&&(v[C]=0);if(a===AS)for(M=1;M<c;++M){for(U=0,C=M;C<d;C+=c)U<p[C]&&(U=p[C]);for(C=M;C<d;C+=c)p[C]=U+m[M-1]}else if(a===jm){for(U=0,C=0;C<d;++C)C%c&&U<p[C]&&(U=p[C]);for(C=0;C<d;++C)C%c&&(p[C]=U+y)}else for(a=!1,M=1;M<c;++M)for(C=M;C<d;C+=c)p[C]+=m[M-1];if(o===AS)for(N=1;N<f;++N){for(U=0,C=N*c,$=C+c;C<$;++C)U<v[C]&&(U=v[C]);for(C=N*c;C<$;++C)v[C]=U+b[N-1]}else if(o===jm){for(U=0,C=c;C<d;++C)U<v[C]&&(U=v[C]);for(C=c;C<d;++C)v[C]=U+_}else for(o=!1,N=1;N<f;++N)for(C=N*c,$=C+c;C<$;++C)v[C]+=b[N-1];for(z=0,C=0;C<d;++C)z=p[C]+(C%c?z:0),E[C]+=z-t[C].x;for(M=0;M<c;++M)for(R=0,C=M;C<d;C+=c)R+=v[C],S[C]+=R-t[C].y;if(a&&Lt(n.center,xu)&&f>1)for(C=0;C<d;++C)P=a===jm?y:m[C%c],z=P-A[C].x2-t[C].x-E[C],z>0&&(E[C]+=z/2);if(o&&Lt(n.center,bu)&&c!==1)for(C=0;C<d;++C)P=o===jm?_:b[~~(C/c)],R=P-A[C].y2-t[C].y-S[C],R>0&&(S[C]+=R/2);for(C=0;C<d;++C)s.union(A[C].translate(E[C],S[C]));switch(z=Lt(n.anchor,Yhe),R=Lt(n.anchor,Xhe),Lt(n.anchor,xu)){case bi:z-=s.width();break;case SS:z-=s.width()/2}switch(Lt(n.anchor,bu)){case bi:R-=s.height();break;case SS:R-=s.height()/2}for(z=Math.round(z),R=Math.round(R),s.clear(),C=0;C<d;++C)t[C].mark.bounds.clear();for(C=0;C<d;++C)D=t[C],D.x+=E[C]+=z,D.y+=S[C]+=R,s.union(D.mark.bounds.union(D.bounds.translate(E[C],S[C]))),i&&e.dirty(D);return s}function fde(e,t,n){var i=ude(t),r=i.marks,s=n.bounds===U$?hde:dde,a=n.offset,o=n.columns||r.length,u=o<=0?1:Math.ceil(r.length/o),l=u*o,c,f,d,p,m,y,v;const b=Qz(e,r,n);b.empty()&&b.set(0,0,0,0),i.rowheaders&&(y=Lt(n.headerBand,bu,null),c=Wm(e,i.rowheaders,r,o,u,-Lt(a,"rowHeader"),YI,0,s,"x1",0,o,1,y)),i.colheaders&&(y=Lt(n.headerBand,xu,null),f=Wm(e,i.colheaders,r,o,o,-Lt(a,"columnHeader"),YI,1,s,"y1",0,1,o,y)),i.rowfooters&&(y=Lt(n.footerBand,bu,null),d=Wm(e,i.rowfooters,r,o,u,Lt(a,"rowFooter"),XI,0,s,"x2",o-1,o,1,y)),i.colfooters&&(y=Lt(n.footerBand,xu,null),p=Wm(e,i.colfooters,r,o,o,Lt(a,"columnFooter"),XI,1,s,"y2",l-o,1,o,y)),i.rowtitle&&(m=Lt(n.titleAnchor,bu),v=Lt(a,"rowTitle"),v=m===bi?d+v:c-v,y=Lt(n.titleBand,bu,.5),JI(e,i.rowtitle,v,0,b,y)),i.coltitle&&(m=Lt(n.titleAnchor,xu),v=Lt(a,"columnTitle"),v=m===bi?p+v:f-v,y=Lt(n.titleBand,xu,.5),JI(e,i.coltitle,v,1,b,y))}function hde(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function dde(e,t){return e.bounds[t]}function Wm(e,t,n,i,r,s,a,o,u,l,c,f,d,p){var m=n.length,y=0,v=0,b,_,E,S,A,$,C,M,N;if(!m)return y;for(b=c;b<m;b+=f)n[b]&&(y=a(y,u(n[b],l)));if(!t.length)return y;for(t.length>r&&(e.warn("Grid headers exceed limit: "+r),t=t.slice(0,r)),y+=s,_=0,S=t.length;_<S;++_)e.dirty(t[_]),t[_].mark.bounds.clear();for(b=c,_=0,S=t.length;_<S;++_,b+=f){for($=t[_],A=$.mark.bounds,E=b;E>=0&&(C=n[E])==null;E-=d);o?(M=p==null?C.x:Math.round(C.bounds.x1+p*C.bounds.width()),N=y):(M=y,N=p==null?C.y:Math.round(C.bounds.y1+p*C.bounds.height())),A.union($.bounds.translate(M-($.x||0),N-($.y||0))),$.x=M,$.y=N,e.dirty($),v=a(v,A[l])}return v}function JI(e,t,n,i,r,s){if(t){e.dirty(t);var a=n,o=n;i?a=Math.round(r.x1+s*r.width()):o=Math.round(r.y1+s*r.height()),t.bounds.translate(a-(t.x||0),o-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=a,t.y=o,e.dirty(t)}}function pde(e,t){const n=e[t]||{};return(i,r)=>n[i]!=null?n[i]:e[i]!=null?e[i]:r}function gde(e,t){let n=-1/0;return e.forEach(i=>{i.offset!=null&&(n=Math.max(n,i.offset))}),n>-1/0?n:t}function mde(e,t,n,i,r,s,a){const o=pde(n,t),u=gde(e,o("offset",0)),l=o("anchor",D$),c=l===bi?1:l===SS?.5:0,f={align:AS,bounds:o("bounds",U$),columns:o("direction")==="vertical"?1:e.length,padding:o("margin",8),center:o("center"),nodirty:!0};switch(t){case _s:f.anchor={x:Math.floor(i.x1)-u,column:bi,y:c*(a||i.height()+2*i.y1),row:l};break;case ws:f.anchor={x:Math.ceil(i.x2)+u,y:c*(a||i.height()+2*i.y1),row:l};break;case lh:f.anchor={y:Math.floor(r.y1)-u,row:bi,x:c*(s||r.width()+2*r.x1),column:l};break;case Bu:f.anchor={y:Math.ceil(r.y2)+u,x:c*(s||r.width()+2*r.x1),column:l};break;case Vhe:f.anchor={x:u,y:u};break;case Whe:f.anchor={x:s-u,y:u,column:bi};break;case Ghe:f.anchor={x:u,y:a-u,row:bi};break;case Hhe:f.anchor={x:s-u,y:a-u,column:bi,row:bi};break}return f}function yde(e,t){var n=t.items[0],i=n.datum,r=n.orient,s=n.bounds,a=n.x,o=n.y,u,l;return n._bounds?n._bounds.clear().union(s):n._bounds=s.clone(),s.clear(),xde(e,n,n.items[0].items[0]),s=vde(n,s),u=2*n.padding,l=2*n.padding,s.empty()||(u=Math.ceil(s.width()+u),l=Math.ceil(s.height()+l)),i.type===Zhe&&bde(n.items[0].items[0].items[0].items),r!==B$&&(n.x=a=0,n.y=o=0),n.width=u,n.height=l,zo(s.set(a,o,a+u,o+l),n),n.mark.bounds.clear().union(s),n}function vde(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function xde(e,t,n){var i=t.padding,r=i-n.x,s=i-n.y;if(!t.datum.title)(r||s)&&Yd(e,n,r,s);else{var a=t.items[1].items[0],o=a.anchor,u=t.titlePadding||0,l=i-a.x,c=i-a.y;switch(a.orient){case _s:r+=Math.ceil(a.bounds.width())+u;break;case ws:case Bu:break;default:s+=a.bounds.height()+u}switch((r||s)&&Yd(e,n,r,s),a.orient){case _s:c+=df(t,n,a,o,1,1);break;case ws:l+=df(t,n,a,bi,0,0)+u,c+=df(t,n,a,o,1,1);break;case Bu:l+=df(t,n,a,o,0,0),c+=df(t,n,a,bi,-1,0,1)+u;break;default:l+=df(t,n,a,o,0,0)}(l||c)&&Yd(e,a,l,c),(l=Math.round(a.bounds.x1-i))<0&&(Yd(e,n,-l,0),Yd(e,a,-l,0))}}function df(e,t,n,i,r,s,a){const o=e.datum.type!=="symbol",u=n.datum.vgrad,l=o&&(s||!u)&&!a?t.items[0]:t,c=l.bounds[r?"y2":"x2"]-e.padding,f=u&&s?c:0,d=u&&s?0:c,p=r<=0?0:S$(n);return Math.round(i===D$?f:i===bi?d-p:.5*(c-p))}function Yd(e,t,n,i){t.x+=n,t.y+=i,t.bounds.translate(n,i),t.mark.bounds.translate(n,i),e.dirty(t)}function bde(e){const t=e.reduce((n,i)=>(n[i.column]=Math.max(i.bounds.x2-i.x,n[i.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function _de(e,t,n,i,r){var s=t.items[0],a=s.frame,o=s.orient,u=s.anchor,l=s.offset,c=s.padding,f=s.items[0].items[0],d=s.items[1]&&s.items[1].items[0],p=o===_s||o===ws?i:n,m=0,y=0,v=0,b=0,_=0,E;if(a!==Rx?o===_s?(m=r.y2,p=r.y1):o===ws?(m=r.y1,p=r.y2):(m=r.x1,p=r.x2):o===_s&&(m=i,p=0),E=u===D$?m:u===bi?p:(m+p)/2,d&&d.text){switch(o){case lh:case Bu:_=f.bounds.height()+c;break;case _s:b=f.bounds.width()+c;break;case ws:b=-f.bounds.width()-c;break}ii.clear().union(d.bounds),ii.translate(b-(d.x||0),_-(d.y||0)),Of(d,"x",b)|Of(d,"y",_)&&(e.dirty(d),d.bounds.clear().union(ii),d.mark.bounds.clear().union(ii),e.dirty(d)),ii.clear().union(d.bounds)}else ii.clear();switch(ii.union(f.bounds),o){case lh:y=E,v=r.y1-ii.height()-l;break;case _s:y=r.x1-ii.width()-l,v=E;break;case ws:y=r.x2+ii.width()+l,v=E;break;case Bu:y=E,v=r.y2+l;break;default:y=s.x,v=s.y}return Of(s,"x",y)|Of(s,"y",v)&&(ii.translate(y,v),e.dirty(s),s.bounds.clear().union(ii),t.bounds.clear().union(ii),e.dirty(s)),s.bounds}function Zz(e){H.call(this,null,e)}ce(Zz,H,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(i=>{e.layout&&fde(n,i,e.layout),Ede(n,i,e)}),wde(e.mark.group)?t.reflow():t}});function wde(e){return e&&e.mark.role!=="legend-entry"}function Ede(e,t,n){var i=t.items,r=Math.max(0,t.width||0),s=Math.max(0,t.height||0),a=new pn().set(0,0,r,s),o=a.clone(),u=a.clone(),l=[],c,f,d,p,m,y;for(m=0,y=i.length;m<y;++m)switch(f=i[m],f.role){case P$:p=sde(f)?o:u,p.union(ode(e,f,r,s));break;case L$:c=f;break;case z$:l.push(yde(e,f));break;case Khe:case Jhe:case Lz:case zz:case Bz:case Uz:case jz:case qz:o.union(f.bounds),u.union(f.bounds);break;default:a.union(f.bounds)}if(l.length){const v={};l.forEach(b=>{d=b.orient||ws,d!==B$&&(v[d]||(v[d]=[])).push(b)});for(const b in v){const _=v[b];Qz(e,_,mde(_,b,n.legends,o,u,r,s))}l.forEach(b=>{const _=b.bounds;if(_.equals(b._bounds)||(b.bounds=b._bounds,e.dirty(b),b.bounds=_,e.dirty(b)),n.autosize&&(n.autosize.type===Vz||n.autosize.type===Wz||n.autosize.type===Gz))switch(b.orient){case _s:case ws:a.add(_.x1,0).add(_.x2,0);break;case lh:case Bu:a.add(0,_.y1).add(0,_.y2)}else a.union(_)})}a.union(o).union(u),c&&a.union(_de(e,c,r,s,a)),t.clip&&a.set(0,0,t.width||0,t.height||0),Sde(e,t,a,n)}function Sde(e,t,n,i){const r=i.autosize||{},s=r.type;if(e._autosize<1||!s)return;let a=e._width,o=e._height,u=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-u)),p=Math.max(0,Math.ceil(n.y2-c));if(r.contains===Qhe){const m=e.padding();a-=m.left+m.right,o-=m.top+m.bottom}s===B$?(l=0,f=0,u=a,c=o):s===Vz?(u=Math.max(0,a-l-d),c=Math.max(0,o-f-p)):s===Wz?(u=Math.max(0,a-l-d),o=c+f+p):s===Gz?(a=u+l+d,c=Math.max(0,o-f-p)):s===ede&&(a=u+l+d,o=c+f+p),e._resizeView(a,o,u,c,[l,f],r.resize)}const Ade=Object.freeze(Object.defineProperty({__proto__:null,bound:Hz,identifier:j$,mark:Yz,overlap:Xz,render:Jz,viewlayout:Zz},Symbol.toStringTag,{value:"Module"}));function eB(e){H.call(this,null,e)}ce(eB,H,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,s=e.scale,a=e.count==null?e.values?e.values.length:10:e.count,o=a$(s,a,e.minstep),u=e.format||k7(n,s,o,e.formatSpecifier,e.formatType,!!e.values),l=e.values?C7(s,e.values,o):o$(s,o);return r&&(i.rem=r),r=l.map((c,f)=>yt({index:f/(l.length-1||1),value:c,label:u(c)})),e.extra&&r.length&&r.push(yt({index:-1,extra:{value:r[0].value},label:""})),i.source=r,i.add=r,this.value=r,i}});function tB(e){H.call(this,null,e)}function Cde(){return yt({})}function kde(e){const t=Dh().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}ce(tB,H,{transform(e,t){var n=t.dataflow,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.item||Cde,s=e.key||$e,a=this.value;return Q(i.encode)&&(i.encode=null),a&&(e.modified("key")||t.modified(s))&&K("DataJoin does not support modified key function or fields."),a||(t=t.addAll(),this.value=a=kde(s)),t.visit(t.ADD,o=>{const u=s(o);let l=a.get(u);l?l.exit?(a.empty--,i.add.push(l)):i.mod.push(l):(l=r(o),a.set(u,l),i.add.push(l)),l.datum=o,l.exit=!1}),t.visit(t.MOD,o=>{const u=s(o),l=a.get(u);l&&(l.datum=o,i.mod.push(l))}),t.visit(t.REM,o=>{const u=s(o),l=a.get(u);o===l.datum&&!l.exit&&(i.rem.push(l),l.exit=!0,++a.empty)}),t.changed(t.ADD_MOD)&&i.modifies("datum"),(t.clean()||e.clean&&a.empty>n.cleanThreshold)&&n.runAfter(a.clean),i}});function nB(e){H.call(this,null,e)}ce(nB,H,{transform(e,t){var n=t.fork(t.ADD_REM),i=e.mod||!1,r=e.encoders,s=t.encode;if(Q(s))if(n.changed()||s.every(f=>r[f]))s=s[0],n.encode=null;else return t.StopPropagation;var a=s==="enter",o=r.update||au,u=r.enter||au,l=r.exit||au,c=(s&&!a?r[s]:o)||au;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{u(f,e),o(f,e)}),n.modifies(u.output),n.modifies(o.output),c!==au&&c!==o&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&l!==au&&(t.visit(t.REM,f=>{l(f,e)}),n.modifies(l.output)),a||c!==au){const f=t.MOD|(e.modified()?t.REFLOW:0);a?(t.visit(f,d=>{const p=u(d,e)||i;(c(d,e)||p)&&n.mod.push(d)}),n.mod.length&&n.modifies(u.output)):t.visit(f,d=>{(c(d,e)||i)&&n.mod.push(d)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});function iB(e){H.call(this,[],e)}ce(iB,H,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,s=e.type||k1,a=e.scale,o=+e.limit,u=a$(a,e.count==null?5:e.count,e.minstep),l=!!e.values||s===k1,c=e.format||F7(n,a,u,s,e.formatSpecifier,e.formatType,l),f=e.values||O7(a,u),d,p,m,y,v;return r&&(i.rem=r),s===k1?(o&&f.length>o?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),r=f.slice(0,o-1),v=!0):r=f,Ye(m=e.size)?(!e.values&&a(r[0])===0&&(r=r.slice(1)),y=r.reduce((b,_)=>Math.max(b,m(_,e)),0)):m=di(y=m||8),r=r.map((b,_)=>yt({index:_,label:c(b,_,r),value:b,offset:y,size:m(b,e)})),v&&(v=f[r.length],r.push(yt({index:r.length,label:`…${f.length-r.length} entries`,value:v,offset:y,size:m(v,e)})))):s===ece?(d=a.domain(),p=E7(a,d[0],ot(d)),f.length<3&&!e.values&&d[0]!==ot(d)&&(f=[d[0],ot(d)]),r=f.map((b,_)=>yt({index:_,label:c(b,_,f),value:b,perc:p(b)}))):(m=f.length-1,p=fce(a),r=f.map((b,_)=>yt({index:_,label:c(b,_,f),value:b,perc:_?p(b):0,perc2:_===m?1:p(f[_+1])}))),i.source=r,i.add=r,this.value=r,i}});const $de=e=>e.source.x,Tde=e=>e.source.y,Ode=e=>e.target.x,Fde=e=>e.target.y;function q$(e){H.call(this,{},e)}q$.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};ce(q$,H,{transform(e,t){var n=e.sourceX||$de,i=e.sourceY||Tde,r=e.targetX||Ode,s=e.targetY||Fde,a=e.as||"path",o=e.orient||"vertical",u=e.shape||"line",l=QI.get(u+"-"+o)||QI.get(u);return l||K("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[a]=l(n(c),i(c),r(c),s(c))}),t.reflow(e.modified()).modifies(a)}});const rB=(e,t,n,i)=>"M"+e+","+t+"L"+n+","+i,Mde=(e,t,n,i)=>rB(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),sB=(e,t,n,i)=>{var r=n-e,s=i-t,a=Math.hypot(r,s)/2,o=180*Math.atan2(s,r)/Math.PI;return"M"+e+","+t+"A"+a+","+a+" "+o+" 0 1 "+n+","+i},Nde=(e,t,n,i)=>sB(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),aB=(e,t,n,i)=>{const r=n-e,s=i-t,a=.2*(r+s),o=.2*(s-r);return"M"+e+","+t+"C"+(e+a)+","+(t+o)+" "+(n+o)+","+(i-a)+" "+n+","+i},Rde=(e,t,n,i)=>aB(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),Ide=(e,t,n,i)=>"M"+e+","+t+"V"+i+"H"+n,Dde=(e,t,n,i)=>"M"+e+","+t+"H"+n+"V"+i,Pde=(e,t,n,i)=>{const r=Math.cos(e),s=Math.sin(e),a=Math.cos(n),o=Math.sin(n),u=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*r+","+t*s+"A"+t+","+t+" 0 0,"+(u?1:0)+" "+t*a+","+t*o+"L"+i*a+","+i*o},Lde=(e,t,n,i)=>{const r=(e+n)/2;return"M"+e+","+t+"C"+r+","+t+" "+r+","+i+" "+n+","+i},zde=(e,t,n,i)=>{const r=(t+i)/2;return"M"+e+","+t+"C"+e+","+r+" "+n+","+r+" "+n+","+i},Bde=(e,t,n,i)=>{const r=Math.cos(e),s=Math.sin(e),a=Math.cos(n),o=Math.sin(n),u=(t+i)/2;return"M"+t*r+","+t*s+"C"+u*r+","+u*s+" "+u*a+","+u*o+" "+i*a+","+i*o},QI=Dh({line:rB,"line-radial":Mde,arc:sB,"arc-radial":Nde,curve:aB,"curve-radial":Rde,"orthogonal-horizontal":Ide,"orthogonal-vertical":Dde,"orthogonal-radial":Pde,"diagonal-horizontal":Lde,"diagonal-vertical":zde,"diagonal-radial":Bde});function V$(e){H.call(this,null,e)}V$.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};ce(V$,H,{transform(e,t){var n=e.as||["startAngle","endAngle"],i=n[0],r=n[1],s=e.field||Mh,a=e.startAngle||0,o=e.endAngle!=null?e.endAngle:2*Math.PI,u=t.source,l=u.map(s),c=l.length,f=a,d=(o-a)/b4(l),p=pr(c),m,y,v;for(e.sort&&p.sort((b,_)=>l[b]-l[_]),m=0;m<c;++m)v=l[p[m]],y=u[p[m]],y[i]=f,y[r]=f+=v*d;return this.value=l,t.reflow(e.modified()).modifies(n)}});const Ude=5;function jde(e){const t=e.type;return!e.bins&&(t===ih||t===Yg||t===Xg)}function oB(e){return i$(e)&&e!==ga}const qde=Os(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function uB(e){H.call(this,null,e),this.modified(!0)}ce(uB,H,{transform(e,t){var n=t.dataflow,i=this.value,r=Vde(e);(!i||r!==i.type)&&(this.value=i=gt(r)());for(r in e)if(!qde[r]){if(r==="padding"&&oB(i.type))continue;Ye(i[r])?i[r](e[r]):n.warn("Unsupported scale property: "+r)}return Kde(i,e,Xde(i,e,Gde(i,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Vde(e){var t=e.type,n="",i;return t===ga?ga+"-"+ih:(Wde(e)&&(i=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=i===2?ga+"-":i===3?Vh+"-":""),(n+t||ih).toLowerCase())}function Wde(e){const t=e.type;return i$(t)&&t!==ac&&t!==oc&&(e.scheme||e.range&&e.range.length&&e.range.every(ge))}function Gde(e,t,n){const i=Hde(e,t.domainRaw,n);if(i>-1)return i;var r=t.domain,s=e.type,a=t.zero||t.zero===void 0&&jde(e),o,u;if(!r)return 0;if((a||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(o=(r=r.slice()).length-1||1,a&&(r[0]>0&&(r[0]=0),r[o]<0&&(r[o]=0)),t.domainMin!=null&&(r[0]=t.domainMin),t.domainMax!=null&&(r[o]=t.domainMax),t.domainMid!=null)){u=t.domainMid;const l=u>r[o]?o+1:u<r[0]?0:o;l!==o&&n.warn("Scale domainMid exceeds domain min or max.",u),r.splice(l,0,u)}return oB(s)&&t.padding&&r[0]!==ot(r)&&(r=Yde(s,r,t.range,t.padding,t.exponent,t.constant)),e.domain(lB(s,r,n)),s===Zk&&e.unknown(t.domainImplicit?rS:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&a$(e,t.nice)||null),r.length}function Hde(e,t,n){return t?(e.domain(lB(e.type,t,n)),t.length):-1}function Yde(e,t,n,i,r,s){var a=Math.abs(ot(n)-n[0]),o=a/(a-2*i),u=e===To?_C(t,null,o):e===Xg?ty(t,null,o,.5):e===Yg?ty(t,null,o,r||1):e===xx?wC(t,null,o,s||1):bC(t,null,o);return t=t.slice(),t[0]=u[0],t[t.length-1]=u[1],t}function lB(e,t,n){if(v7(e)){var i=Math.abs(t.reduce((r,s)=>r+(s<0?-1:s>0?1:0),0));i!==t.length&&n.warn("Log scale domain includes zero: "+le(t))}return t}function Xde(e,t,n){let i=t.bins;if(i&&!Q(i)){const r=e.domain(),s=r[0],a=ot(r),o=i.step;let u=i.start==null?s:i.start,l=i.stop==null?a:i.stop;o||K("Scale bins parameter missing step property."),u<s&&(u=o*Math.ceil(s/o)),l>a&&(l=o*Math.floor(a/o)),i=pr(u,l+o/2,o)}return i?e.bins=i:e.bins&&delete e.bins,e.type===e$&&(i?!t.domain&&!t.domainRaw&&(e.domain(i),n=i.length):e.bins=e.domain()),n}function Kde(e,t,n){var i=e.type,r=t.round||!1,s=t.range;if(t.rangeStep!=null)s=Jde(i,t,n);else if(t.scheme&&(s=Qde(i,t,n),Ye(s))){if(e.interpolator)return e.interpolator(s);K(`Scale type ${i} does not support interpolating color schemes.`)}if(s&&x7(i))return e.interpolator(wx(CS(s,t.reverse),t.interpolate,t.interpolateGamma));s&&t.interpolate&&e.interpolate?e.interpolate(r$(t.interpolate,t.interpolateGamma)):Ye(e.round)?e.round(r):Ye(e.rangeRound)&&e.interpolate(r?Gg:Zu),s&&e.range(CS(s,t.reverse))}function Jde(e,t,n){e!==h7&&e!==fS&&K("Only band and point scales support rangeStep.");var i=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,r=e===fS?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*Qk(n,r,i)]}function Qde(e,t,n){var i=t.schemeExtent,r,s;return Q(t.scheme)?s=wx(t.scheme,t.interpolate,t.interpolateGamma):(r=t.scheme.toLowerCase(),s=s$(r),s||K(`Unrecognized scheme name: ${t.scheme}`)),n=e===_x?n+1:e===e$?n-1:e===rh||e===bx?+t.schemeCount||Ude:n,x7(e)?ZI(s,i,t.reverse):Ye(s)?w7(ZI(s,i),n):e===Zk?s:s.slice(0,n)}function ZI(e,t,n){return Ye(e)&&(t||n)?_7(e,CS(t||[0,1],n)):e}function CS(e,t){return t?e.slice().reverse():e}function cB(e){H.call(this,null,e)}ce(cB,H,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(Tc(e.sort)),this.modified(n),t}});const eD="zero",fB="center",hB="normalize",dB=["y0","y1"];function W$(e){H.call(this,null,e)}W$.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:eD,values:[eD,fB,hB]},{name:"as",type:"string",array:!0,length:2,default:dB}]};ce(W$,H,{transform(e,t){var n=e.as||dB,i=n[0],r=n[1],s=Tc(e.sort),a=e.field||Mh,o=e.offset===fB?Zde:e.offset===hB?epe:tpe,u,l,c,f;for(u=npe(t.source,e.groupby,s,a),l=0,c=u.length,f=u.max;l<c;++l)o(u[l],f,a,i,r);return t.reflow(e.modified()).modifies(n)}});function Zde(e,t,n,i,r){for(var s=(t-e.sum)/2,a=e.length,o=0,u;o<a;++o)u=e[o],u[i]=s,u[r]=s+=Math.abs(n(u))}function epe(e,t,n,i,r){for(var s=1/e.sum,a=0,o=e.length,u=0,l=0,c;u<o;++u)c=e[u],c[i]=a,c[r]=a=s*(l+=Math.abs(n(c)))}function tpe(e,t,n,i,r){for(var s=0,a=0,o=e.length,u=0,l,c;u<o;++u)c=e[u],l=+n(c),l<0?(c[i]=a,c[r]=a+=l):(c[i]=s,c[r]=s+=l)}function npe(e,t,n,i){var r=[],s=y=>y(c),a,o,u,l,c,f,d,p,m;if(t==null)r.push(e.slice());else for(a={},o=0,u=e.length;o<u;++o)c=e[o],f=t.map(s),d=a[f],d||(a[f]=d=[],r.push(d)),d.push(c);for(f=0,m=0,l=r.length;f<l;++f){for(d=r[f],o=0,p=0,u=d.length;o<u;++o)p+=Math.abs(i(d[o]));d.sum=p,p>m&&(m=p),n&&d.sort(n)}return r.max=m,r}const ipe=Object.freeze(Object.defineProperty({__proto__:null,axisticks:eB,datajoin:tB,encode:nB,legendentries:iB,linkpath:q$,pie:V$,scale:uB,sortitems:cB,stack:W$},Symbol.toStringTag,{value:"Module"}));var Fe=1e-6,kS=1e-12,Qe=Math.PI,Zt=Qe/2,My=Qe/4,Ti=Qe*2,an=180/Qe,Je=Qe/180,at=Math.abs,Gh=Math.atan,Qr=Math.atan2,Oe=Math.cos,Gm=Math.ceil,pB=Math.exp,$S=Math.hypot,Ny=Math.log,fw=Math.pow,Te=Math.sin,qr=Math.sign||function(e){return e>0?1:e<0?-1:0},Oi=Math.sqrt,G$=Math.tan;function gB(e){return e>1?0:e<-1?Qe:Math.acos(e)}function Ji(e){return e>1?Zt:e<-1?-Zt:Math.asin(e)}function Wn(){}function Ry(e,t){e&&nD.hasOwnProperty(e.type)&&nD[e.type](e,t)}var tD={Feature:function(e,t){Ry(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)Ry(n[i].geometry,t)}},nD={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)e=n[i],t.point(e[0],e[1],e[2])},LineString:function(e,t){TS(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)TS(n[i],t,0)},Polygon:function(e,t){iD(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)iD(n[i],t)},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)Ry(n[i],t)}};function TS(e,t,n){var i=-1,r=e.length-n,s;for(t.lineStart();++i<r;)s=e[i],t.point(s[0],s[1],s[2]);t.lineEnd()}function iD(e,t){var n=-1,i=e.length;for(t.polygonStart();++n<i;)TS(e[n],t,1);t.polygonEnd()}function co(e,t){e&&tD.hasOwnProperty(e.type)?tD[e.type](e,t):Ry(e,t)}var Iy=new ki,Dy=new ki,mB,yB,OS,FS,MS,Ea={point:Wn,lineStart:Wn,lineEnd:Wn,polygonStart:function(){Iy=new ki,Ea.lineStart=rpe,Ea.lineEnd=spe},polygonEnd:function(){var e=+Iy;Dy.add(e<0?Ti+e:e),this.lineStart=this.lineEnd=this.point=Wn},sphere:function(){Dy.add(Ti)}};function rpe(){Ea.point=ape}function spe(){vB(mB,yB)}function ape(e,t){Ea.point=vB,mB=e,yB=t,e*=Je,t*=Je,OS=e,FS=Oe(t=t/2+My),MS=Te(t)}function vB(e,t){e*=Je,t*=Je,t=t/2+My;var n=e-OS,i=n>=0?1:-1,r=i*n,s=Oe(t),a=Te(t),o=MS*a,u=FS*s+o*Oe(r),l=o*i*Te(r);Iy.add(Qr(l,u)),OS=e,FS=s,MS=a}function ope(e){return Dy=new ki,co(e,Ea),Dy*2}function Py(e){return[Qr(e[1],e[0]),Ji(e[2])]}function lc(e){var t=e[0],n=e[1],i=Oe(n);return[i*Oe(t),i*Te(t),Te(n)]}function Hm(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function ch(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function hw(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Ym(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Ly(e){var t=Oi(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var qt,Vi,Xt,fr,Pl,xB,bB,Bf,zp,fu,Oo,oo={point:NS,lineStart:rD,lineEnd:sD,polygonStart:function(){oo.point=wB,oo.lineStart=upe,oo.lineEnd=lpe,zp=new ki,Ea.polygonStart()},polygonEnd:function(){Ea.polygonEnd(),oo.point=NS,oo.lineStart=rD,oo.lineEnd=sD,Iy<0?(qt=-(Xt=180),Vi=-(fr=90)):zp>Fe?fr=90:zp<-1e-6&&(Vi=-90),Oo[0]=qt,Oo[1]=Xt},sphere:function(){qt=-(Xt=180),Vi=-(fr=90)}};function NS(e,t){fu.push(Oo=[qt=e,Xt=e]),t<Vi&&(Vi=t),t>fr&&(fr=t)}function _B(e,t){var n=lc([e*Je,t*Je]);if(Bf){var i=ch(Bf,n),r=[i[1],-i[0],0],s=ch(r,i);Ly(s),s=Py(s);var a=e-Pl,o=a>0?1:-1,u=s[0]*an*o,l,c=at(a)>180;c^(o*Pl<u&&u<o*e)?(l=s[1]*an,l>fr&&(fr=l)):(u=(u+360)%360-180,c^(o*Pl<u&&u<o*e)?(l=-s[1]*an,l<Vi&&(Vi=l)):(t<Vi&&(Vi=t),t>fr&&(fr=t))),c?e<Pl?cr(qt,e)>cr(qt,Xt)&&(Xt=e):cr(e,Xt)>cr(qt,Xt)&&(qt=e):Xt>=qt?(e<qt&&(qt=e),e>Xt&&(Xt=e)):e>Pl?cr(qt,e)>cr(qt,Xt)&&(Xt=e):cr(e,Xt)>cr(qt,Xt)&&(qt=e)}else fu.push(Oo=[qt=e,Xt=e]);t<Vi&&(Vi=t),t>fr&&(fr=t),Bf=n,Pl=e}function rD(){oo.point=_B}function sD(){Oo[0]=qt,Oo[1]=Xt,oo.point=NS,Bf=null}function wB(e,t){if(Bf){var n=e-Pl;zp.add(at(n)>180?n+(n>0?360:-360):n)}else xB=e,bB=t;Ea.point(e,t),_B(e,t)}function upe(){Ea.lineStart()}function lpe(){wB(xB,bB),Ea.lineEnd(),at(zp)>Fe&&(qt=-(Xt=180)),Oo[0]=qt,Oo[1]=Xt,Bf=null}function cr(e,t){return(t-=e)<0?t+360:t}function cpe(e,t){return e[0]-t[0]}function aD(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function fpe(e){var t,n,i,r,s,a,o;if(fr=Xt=-(qt=Vi=1/0),fu=[],co(e,oo),n=fu.length){for(fu.sort(cpe),t=1,i=fu[0],s=[i];t<n;++t)r=fu[t],aD(i,r[0])||aD(i,r[1])?(cr(i[0],r[1])>cr(i[0],i[1])&&(i[1]=r[1]),cr(r[0],i[1])>cr(i[0],i[1])&&(i[0]=r[0])):s.push(i=r);for(a=-1/0,n=s.length-1,t=0,i=s[n];t<=n;i=r,++t)r=s[t],(o=cr(i[1],r[0]))>a&&(a=o,qt=r[0],Xt=i[1])}return fu=Oo=null,qt===1/0||Vi===1/0?[[NaN,NaN],[NaN,NaN]]:[[qt,Vi],[Xt,fr]]}var bp,zy,By,Uy,jy,qy,Vy,Wy,RS,IS,DS,EB,SB,_i,wi,Ei,Es={sphere:Wn,point:H$,lineStart:oD,lineEnd:uD,polygonStart:function(){Es.lineStart=ppe,Es.lineEnd=gpe},polygonEnd:function(){Es.lineStart=oD,Es.lineEnd=uD}};function H$(e,t){e*=Je,t*=Je;var n=Oe(t);o0(n*Oe(e),n*Te(e),Te(t))}function o0(e,t,n){++bp,By+=(e-By)/bp,Uy+=(t-Uy)/bp,jy+=(n-jy)/bp}function oD(){Es.point=hpe}function hpe(e,t){e*=Je,t*=Je;var n=Oe(t);_i=n*Oe(e),wi=n*Te(e),Ei=Te(t),Es.point=dpe,o0(_i,wi,Ei)}function dpe(e,t){e*=Je,t*=Je;var n=Oe(t),i=n*Oe(e),r=n*Te(e),s=Te(t),a=Qr(Oi((a=wi*s-Ei*r)*a+(a=Ei*i-_i*s)*a+(a=_i*r-wi*i)*a),_i*i+wi*r+Ei*s);zy+=a,qy+=a*(_i+(_i=i)),Vy+=a*(wi+(wi=r)),Wy+=a*(Ei+(Ei=s)),o0(_i,wi,Ei)}function uD(){Es.point=H$}function ppe(){Es.point=mpe}function gpe(){AB(EB,SB),Es.point=H$}function mpe(e,t){EB=e,SB=t,e*=Je,t*=Je,Es.point=AB;var n=Oe(t);_i=n*Oe(e),wi=n*Te(e),Ei=Te(t),o0(_i,wi,Ei)}function AB(e,t){e*=Je,t*=Je;var n=Oe(t),i=n*Oe(e),r=n*Te(e),s=Te(t),a=wi*s-Ei*r,o=Ei*i-_i*s,u=_i*r-wi*i,l=$S(a,o,u),c=Ji(l),f=l&&-c/l;RS.add(f*a),IS.add(f*o),DS.add(f*u),zy+=c,qy+=c*(_i+(_i=i)),Vy+=c*(wi+(wi=r)),Wy+=c*(Ei+(Ei=s)),o0(_i,wi,Ei)}function ype(e){bp=zy=By=Uy=jy=qy=Vy=Wy=0,RS=new ki,IS=new ki,DS=new ki,co(e,Es);var t=+RS,n=+IS,i=+DS,r=$S(t,n,i);return r<kS&&(t=qy,n=Vy,i=Wy,zy<Fe&&(t=By,n=Uy,i=jy),r=$S(t,n,i),r<kS)?[NaN,NaN]:[Qr(n,t)*an,Ji(i/r)*an]}function PS(e,t){function n(i,r){return i=e(i,r),t(i[0],i[1])}return e.invert&&t.invert&&(n.invert=function(i,r){return i=t.invert(i,r),i&&e.invert(i[0],i[1])}),n}function LS(e,t){return at(e)>Qe&&(e-=Math.round(e/Ti)*Ti),[e,t]}LS.invert=LS;function CB(e,t,n){return(e%=Ti)?t||n?PS(cD(e),fD(t,n)):cD(e):t||n?fD(t,n):LS}function lD(e){return function(t,n){return t+=e,at(t)>Qe&&(t-=Math.round(t/Ti)*Ti),[t,n]}}function cD(e){var t=lD(e);return t.invert=lD(-e),t}function fD(e,t){var n=Oe(e),i=Te(e),r=Oe(t),s=Te(t);function a(o,u){var l=Oe(u),c=Oe(o)*l,f=Te(o)*l,d=Te(u),p=d*n+c*i;return[Qr(f*r-p*s,c*n-d*i),Ji(p*r+f*s)]}return a.invert=function(o,u){var l=Oe(u),c=Oe(o)*l,f=Te(o)*l,d=Te(u),p=d*r-f*s;return[Qr(f*r+d*s,c*n+p*i),Ji(p*n-c*i)]},a}function vpe(e){e=CB(e[0]*Je,e[1]*Je,e.length>2?e[2]*Je:0);function t(n){return n=e(n[0]*Je,n[1]*Je),n[0]*=an,n[1]*=an,n}return t.invert=function(n){return n=e.invert(n[0]*Je,n[1]*Je),n[0]*=an,n[1]*=an,n},t}function xpe(e,t,n,i,r,s){if(n){var a=Oe(t),o=Te(t),u=i*n;r==null?(r=t+i*Ti,s=t-u/2):(r=hD(a,r),s=hD(a,s),(i>0?r<s:r>s)&&(r+=i*Ti));for(var l,c=r;i>0?c>s:c<s;c-=u)l=Py([a,-o*Oe(c),-o*Te(c)]),e.point(l[0],l[1])}}function hD(e,t){t=lc(t),t[0]-=e,Ly(t);var n=gB(-t[1]);return((-t[2]<0?-n:n)+Ti-Fe)%Ti}function kB(){var e=[],t;return{point:function(n,i,r){t.push([n,i,r])},lineStart:function(){e.push(t=[])},lineEnd:Wn,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function D1(e,t){return at(e[0]-t[0])<Fe&&at(e[1]-t[1])<Fe}function Xm(e,t,n,i){this.x=e,this.z=t,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function $B(e,t,n,i,r){var s=[],a=[],o,u;if(e.forEach(function(m){if(!((y=m.length-1)<=0)){var y,v=m[0],b=m[y],_;if(D1(v,b)){if(!v[2]&&!b[2]){for(r.lineStart(),o=0;o<y;++o)r.point((v=m[o])[0],v[1]);r.lineEnd();return}b[0]+=2*Fe}s.push(_=new Xm(v,m,null,!0)),a.push(_.o=new Xm(v,null,_,!1)),s.push(_=new Xm(b,m,null,!1)),a.push(_.o=new Xm(b,null,_,!0))}}),!!s.length){for(a.sort(t),dD(s),dD(a),o=0,u=a.length;o<u;++o)a[o].e=n=!n;for(var l=s[0],c,f;;){for(var d=l,p=!0;d.v;)if((d=d.n)===l)return;c=d.z,r.lineStart();do{if(d.v=d.o.v=!0,d.e){if(p)for(o=0,u=c.length;o<u;++o)r.point((f=c[o])[0],f[1]);else i(d.x,d.n.x,1,r);d=d.n}else{if(p)for(c=d.p.z,o=c.length-1;o>=0;--o)r.point((f=c[o])[0],f[1]);else i(d.x,d.p.x,-1,r);d=d.p}d=d.o,c=d.z,p=!p}while(!d.v);r.lineEnd()}}}function dD(e){if(t=e.length){for(var t,n=0,i=e[0],r;++n<t;)i.n=r=e[n],r.p=i,i=r;i.n=r=e[0],r.p=i}}function dw(e){return at(e[0])<=Qe?e[0]:qr(e[0])*((at(e[0])+Qe)%Ti-Qe)}function bpe(e,t){var n=dw(t),i=t[1],r=Te(i),s=[Te(n),-Oe(n),0],a=0,o=0,u=new ki;r===1?i=Zt+Fe:r===-1&&(i=-Zt-Fe);for(var l=0,c=e.length;l<c;++l)if(d=(f=e[l]).length)for(var f,d,p=f[d-1],m=dw(p),y=p[1]/2+My,v=Te(y),b=Oe(y),_=0;_<d;++_,m=S,v=$,b=C,p=E){var E=f[_],S=dw(E),A=E[1]/2+My,$=Te(A),C=Oe(A),M=S-m,N=M>=0?1:-1,P=N*M,D=P>Qe,W=v*$;if(u.add(Qr(W*N*Te(P),b*C+W*Oe(P))),a+=D?M+N*Ti:M,D^m>=n^S>=n){var q=ch(lc(p),lc(E));Ly(q);var z=ch(s,q);Ly(z);var R=(D^M>=0?-1:1)*Ji(z[2]);(i>R||i===R&&(q[0]||q[1]))&&(o+=D^M>=0?1:-1)}}return(a<-1e-6||a<Fe&&u<-1e-12)^o&1}function TB(e,t,n,i){return function(r){var s=t(r),a=kB(),o=t(a),u=!1,l,c,f,d={point:p,lineStart:y,lineEnd:v,polygonStart:function(){d.point=b,d.lineStart=_,d.lineEnd=E,c=[],l=[]},polygonEnd:function(){d.point=p,d.lineStart=y,d.lineEnd=v,c=x4(c);var S=bpe(l,i);c.length?(u||(r.polygonStart(),u=!0),$B(c,wpe,S,n,r)):S&&(u||(r.polygonStart(),u=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),u&&(r.polygonEnd(),u=!1),c=l=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function p(S,A){e(S,A)&&r.point(S,A)}function m(S,A){s.point(S,A)}function y(){d.point=m,s.lineStart()}function v(){d.point=p,s.lineEnd()}function b(S,A){f.push([S,A]),o.point(S,A)}function _(){o.lineStart(),f=[]}function E(){b(f[0][0],f[0][1]),o.lineEnd();var S=o.clean(),A=a.result(),$,C=A.length,M,N,P;if(f.pop(),l.push(f),f=null,!!C){if(S&1){if(N=A[0],(M=N.length-1)>0){for(u||(r.polygonStart(),u=!0),r.lineStart(),$=0;$<M;++$)r.point((P=N[$])[0],P[1]);r.lineEnd()}return}C>1&&S&2&&A.push(A.pop().concat(A.shift())),c.push(A.filter(_pe))}}return d}}function _pe(e){return e.length>1}function wpe(e,t){return((e=e.x)[0]<0?e[1]-Zt-Fe:Zt-e[1])-((t=t.x)[0]<0?t[1]-Zt-Fe:Zt-t[1])}const pD=TB(function(){return!0},Epe,Ape,[-Qe,-Zt]);function Epe(e){var t=NaN,n=NaN,i=NaN,r;return{lineStart:function(){e.lineStart(),r=1},point:function(s,a){var o=s>0?Qe:-Qe,u=at(s-t);at(u-Qe)<Fe?(e.point(t,n=(n+a)/2>0?Zt:-Zt),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(o,n),e.point(s,n),r=0):i!==o&&u>=Qe&&(at(t-i)<Fe&&(t-=i*Fe),at(s-o)<Fe&&(s-=o*Fe),n=Spe(t,n,s,a),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(o,n),r=0),e.point(t=s,n=a),i=o},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-r}}}function Spe(e,t,n,i){var r,s,a=Te(e-n);return at(a)>Fe?Gh((Te(t)*(s=Oe(i))*Te(n)-Te(i)*(r=Oe(t))*Te(e))/(r*s*a)):(t+i)/2}function Ape(e,t,n,i){var r;if(e==null)r=n*Zt,i.point(-Qe,r),i.point(0,r),i.point(Qe,r),i.point(Qe,0),i.point(Qe,-r),i.point(0,-r),i.point(-Qe,-r),i.point(-Qe,0),i.point(-Qe,r);else if(at(e[0]-t[0])>Fe){var s=e[0]<t[0]?Qe:-Qe;r=n*s/2,i.point(-s,r),i.point(0,r),i.point(s,r)}else i.point(t[0],t[1])}function Cpe(e){var t=Oe(e),n=2*Je,i=t>0,r=at(t)>Fe;function s(c,f,d,p){xpe(p,e,n,d,c,f)}function a(c,f){return Oe(c)*Oe(f)>t}function o(c){var f,d,p,m,y;return{lineStart:function(){m=p=!1,y=1},point:function(v,b){var _=[v,b],E,S=a(v,b),A=i?S?0:l(v,b):S?l(v+(v<0?Qe:-Qe),b):0;if(!f&&(m=p=S)&&c.lineStart(),S!==p&&(E=u(f,_),(!E||D1(f,E)||D1(_,E))&&(_[2]=1)),S!==p)y=0,S?(c.lineStart(),E=u(_,f),c.point(E[0],E[1])):(E=u(f,_),c.point(E[0],E[1],2),c.lineEnd()),f=E;else if(r&&f&&i^S){var $;!(A&d)&&($=u(_,f,!0))&&(y=0,i?(c.lineStart(),c.point($[0][0],$[0][1]),c.point($[1][0],$[1][1]),c.lineEnd()):(c.point($[1][0],$[1][1]),c.lineEnd(),c.lineStart(),c.point($[0][0],$[0][1],3)))}S&&(!f||!D1(f,_))&&c.point(_[0],_[1]),f=_,p=S,d=A},lineEnd:function(){p&&c.lineEnd(),f=null},clean:function(){return y|(m&&p)<<1}}}function u(c,f,d){var p=lc(c),m=lc(f),y=[1,0,0],v=ch(p,m),b=Hm(v,v),_=v[0],E=b-_*_;if(!E)return!d&&c;var S=t*b/E,A=-t*_/E,$=ch(y,v),C=Ym(y,S),M=Ym(v,A);hw(C,M);var N=$,P=Hm(C,N),D=Hm(N,N),W=P*P-D*(Hm(C,C)-1);if(!(W<0)){var q=Oi(W),z=Ym(N,(-P-q)/D);if(hw(z,C),z=Py(z),!d)return z;var R=c[0],U=f[0],G=c[1],Z=f[1],J;U<R&&(J=R,R=U,U=J);var he=U-R,we=at(he-Qe)<Fe,Ce=we||he<Fe;if(!we&&Z<G&&(J=G,G=Z,Z=J),Ce?we?G+Z>0^z[1]<(at(z[0]-R)<Fe?G:Z):G<=z[1]&&z[1]<=Z:he>Qe^(R<=z[0]&&z[0]<=U)){var ze=Ym(N,(-P+q)/D);return hw(ze,C),[z,Py(ze)]}}}function l(c,f){var d=i?e:Qe-e,p=0;return c<-d?p|=1:c>d&&(p|=2),f<-d?p|=4:f>d&&(p|=8),p}return TB(a,o,s,i?[0,-e]:[-Qe,e-Qe])}function kpe(e,t,n,i,r,s){var a=e[0],o=e[1],u=t[0],l=t[1],c=0,f=1,d=u-a,p=l-o,m;if(m=n-a,!(!d&&m>0)){if(m/=d,d<0){if(m<c)return;m<f&&(f=m)}else if(d>0){if(m>f)return;m>c&&(c=m)}if(m=r-a,!(!d&&m<0)){if(m/=d,d<0){if(m>f)return;m>c&&(c=m)}else if(d>0){if(m<c)return;m<f&&(f=m)}if(m=i-o,!(!p&&m>0)){if(m/=p,p<0){if(m<c)return;m<f&&(f=m)}else if(p>0){if(m>f)return;m>c&&(c=m)}if(m=s-o,!(!p&&m<0)){if(m/=p,p<0){if(m>f)return;m>c&&(c=m)}else if(p>0){if(m<c)return;m<f&&(f=m)}return c>0&&(e[0]=a+c*d,e[1]=o+c*p),f<1&&(t[0]=a+f*d,t[1]=o+f*p),!0}}}}}var Km=1e9,Jm=-1e9;function OB(e,t,n,i){function r(l,c){return e<=l&&l<=n&&t<=c&&c<=i}function s(l,c,f,d){var p=0,m=0;if(l==null||(p=a(l,f))!==(m=a(c,f))||u(l,c)<0^f>0)do d.point(p===0||p===3?e:n,p>1?i:t);while((p=(p+f+4)%4)!==m);else d.point(c[0],c[1])}function a(l,c){return at(l[0]-e)<Fe?c>0?0:3:at(l[0]-n)<Fe?c>0?2:1:at(l[1]-t)<Fe?c>0?1:0:c>0?3:2}function o(l,c){return u(l.x,c.x)}function u(l,c){var f=a(l,1),d=a(c,1);return f!==d?f-d:f===0?c[1]-l[1]:f===1?l[0]-c[0]:f===2?l[1]-c[1]:c[0]-l[0]}return function(l){var c=l,f=kB(),d,p,m,y,v,b,_,E,S,A,$,C={point:M,lineStart:W,lineEnd:q,polygonStart:P,polygonEnd:D};function M(R,U){r(R,U)&&c.point(R,U)}function N(){for(var R=0,U=0,G=p.length;U<G;++U)for(var Z=p[U],J=1,he=Z.length,we=Z[0],Ce,ze,bt=we[0],Ie=we[1];J<he;++J)Ce=bt,ze=Ie,we=Z[J],bt=we[0],Ie=we[1],ze<=i?Ie>i&&(bt-Ce)*(i-ze)>(Ie-ze)*(e-Ce)&&++R:Ie<=i&&(bt-Ce)*(i-ze)<(Ie-ze)*(e-Ce)&&--R;return R}function P(){c=f,d=[],p=[],$=!0}function D(){var R=N(),U=$&&R,G=(d=x4(d)).length;(U||G)&&(l.polygonStart(),U&&(l.lineStart(),s(null,null,1,l),l.lineEnd()),G&&$B(d,o,R,s,l),l.polygonEnd()),c=l,d=p=m=null}function W(){C.point=z,p&&p.push(m=[]),A=!0,S=!1,_=E=NaN}function q(){d&&(z(y,v),b&&S&&f.rejoin(),d.push(f.result())),C.point=M,S&&c.lineEnd()}function z(R,U){var G=r(R,U);if(p&&m.push([R,U]),A)y=R,v=U,b=G,A=!1,G&&(c.lineStart(),c.point(R,U));else if(G&&S)c.point(R,U);else{var Z=[_=Math.max(Jm,Math.min(Km,_)),E=Math.max(Jm,Math.min(Km,E))],J=[R=Math.max(Jm,Math.min(Km,R)),U=Math.max(Jm,Math.min(Km,U))];kpe(Z,J,e,t,n,i)?(S||(c.lineStart(),c.point(Z[0],Z[1])),c.point(J[0],J[1]),G||c.lineEnd(),$=!1):G&&(c.lineStart(),c.point(R,U),$=!1)}_=R,E=U,S=G}return C}}function gD(e,t,n){var i=pr(e,t-Fe,n).concat(t);return function(r){return i.map(function(s){return[r,s]})}}function mD(e,t,n){var i=pr(e,t-Fe,n).concat(t);return function(r){return i.map(function(s){return[s,r]})}}function $pe(){var e,t,n,i,r,s,a,o,u=10,l=u,c=90,f=360,d,p,m,y,v=2.5;function b(){return{type:"MultiLineString",coordinates:_()}}function _(){return pr(Gm(i/c)*c,n,c).map(m).concat(pr(Gm(o/f)*f,a,f).map(y)).concat(pr(Gm(t/u)*u,e,u).filter(function(E){return at(E%c)>Fe}).map(d)).concat(pr(Gm(s/l)*l,r,l).filter(function(E){return at(E%f)>Fe}).map(p))}return b.lines=function(){return _().map(function(E){return{type:"LineString",coordinates:E}})},b.outline=function(){return{type:"Polygon",coordinates:[m(i).concat(y(a).slice(1),m(n).reverse().slice(1),y(o).reverse().slice(1))]}},b.extent=function(E){return arguments.length?b.extentMajor(E).extentMinor(E):b.extentMinor()},b.extentMajor=function(E){return arguments.length?(i=+E[0][0],n=+E[1][0],o=+E[0][1],a=+E[1][1],i>n&&(E=i,i=n,n=E),o>a&&(E=o,o=a,a=E),b.precision(v)):[[i,o],[n,a]]},b.extentMinor=function(E){return arguments.length?(t=+E[0][0],e=+E[1][0],s=+E[0][1],r=+E[1][1],t>e&&(E=t,t=e,e=E),s>r&&(E=s,s=r,r=E),b.precision(v)):[[t,s],[e,r]]},b.step=function(E){return arguments.length?b.stepMajor(E).stepMinor(E):b.stepMinor()},b.stepMajor=function(E){return arguments.length?(c=+E[0],f=+E[1],b):[c,f]},b.stepMinor=function(E){return arguments.length?(u=+E[0],l=+E[1],b):[u,l]},b.precision=function(E){return arguments.length?(v=+E,d=gD(s,r,90),p=mD(t,e,v),m=gD(o,a,90),y=mD(i,n,v),b):v},b.extentMajor([[-180,-90+Fe],[180,90-Fe]]).extentMinor([[-180,-80-Fe],[180,80+Fe]])}const fg=e=>e;var pw=new ki,zS=new ki,FB,MB,BS,US,fo={point:Wn,lineStart:Wn,lineEnd:Wn,polygonStart:function(){fo.lineStart=Tpe,fo.lineEnd=Fpe},polygonEnd:function(){fo.lineStart=fo.lineEnd=fo.point=Wn,pw.add(at(zS)),zS=new ki},result:function(){var e=pw/2;return pw=new ki,e}};function Tpe(){fo.point=Ope}function Ope(e,t){fo.point=NB,FB=BS=e,MB=US=t}function NB(e,t){zS.add(US*e-BS*t),BS=e,US=t}function Fpe(){NB(FB,MB)}var fh=1/0,Gy=fh,hg=-fh,Hy=hg,Yy={point:Mpe,lineStart:Wn,lineEnd:Wn,polygonStart:Wn,polygonEnd:Wn,result:function(){var e=[[fh,Gy],[hg,Hy]];return hg=Hy=-(Gy=fh=1/0),e}};function Mpe(e,t){e<fh&&(fh=e),e>hg&&(hg=e),t<Gy&&(Gy=t),t>Hy&&(Hy=t)}var jS=0,qS=0,_p=0,Xy=0,Ky=0,Ff=0,VS=0,WS=0,wp=0,RB,IB,ua,la,Br={point:cc,lineStart:yD,lineEnd:vD,polygonStart:function(){Br.lineStart=Ipe,Br.lineEnd=Dpe},polygonEnd:function(){Br.point=cc,Br.lineStart=yD,Br.lineEnd=vD},result:function(){var e=wp?[VS/wp,WS/wp]:Ff?[Xy/Ff,Ky/Ff]:_p?[jS/_p,qS/_p]:[NaN,NaN];return jS=qS=_p=Xy=Ky=Ff=VS=WS=wp=0,e}};function cc(e,t){jS+=e,qS+=t,++_p}function yD(){Br.point=Npe}function Npe(e,t){Br.point=Rpe,cc(ua=e,la=t)}function Rpe(e,t){var n=e-ua,i=t-la,r=Oi(n*n+i*i);Xy+=r*(ua+e)/2,Ky+=r*(la+t)/2,Ff+=r,cc(ua=e,la=t)}function vD(){Br.point=cc}function Ipe(){Br.point=Ppe}function Dpe(){DB(RB,IB)}function Ppe(e,t){Br.point=DB,cc(RB=ua=e,IB=la=t)}function DB(e,t){var n=e-ua,i=t-la,r=Oi(n*n+i*i);Xy+=r*(ua+e)/2,Ky+=r*(la+t)/2,Ff+=r,r=la*e-ua*t,VS+=r*(ua+e),WS+=r*(la+t),wp+=r*3,cc(ua=e,la=t)}function PB(e){this._context=e}PB.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Ti);break}}},result:Wn};var GS=new ki,gw,LB,zB,Ep,Sp,dg={point:Wn,lineStart:function(){dg.point=Lpe},lineEnd:function(){gw&&BB(LB,zB),dg.point=Wn},polygonStart:function(){gw=!0},polygonEnd:function(){gw=null},result:function(){var e=+GS;return GS=new ki,e}};function Lpe(e,t){dg.point=BB,LB=Ep=e,zB=Sp=t}function BB(e,t){Ep-=e,Sp-=t,GS.add(Oi(Ep*Ep+Sp*Sp)),Ep=e,Sp=t}let xD,Jy,bD,_D;class wD{constructor(t){this._append=t==null?UB:zpe(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==bD||this._append!==Jy){const i=this._radius,r=this._;this._="",this._append`m0,${i}a${i},${i} 0 1,1 0,${-2*i}a${i},${i} 0 1,1 0,${2*i}z`,bD=i,Jy=this._append,_D=this._,this._=r}this._+=_D;break}}}result(){const t=this._;return this._="",t.length?t:null}}function UB(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function zpe(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return UB;if(t!==xD){const n=10**t;xD=t,Jy=function(r){let s=1;this._+=r[0];for(const a=r.length;s<a;++s)this._+=Math.round(arguments[s]*n)/n+r[s]}}return Jy}function jB(e,t){let n=3,i=4.5,r,s;function a(o){return o&&(typeof i=="function"&&s.pointRadius(+i.apply(this,arguments)),co(o,r(s))),s.result()}return a.area=function(o){return co(o,r(fo)),fo.result()},a.measure=function(o){return co(o,r(dg)),dg.result()},a.bounds=function(o){return co(o,r(Yy)),Yy.result()},a.centroid=function(o){return co(o,r(Br)),Br.result()},a.projection=function(o){return arguments.length?(r=o==null?(e=null,fg):(e=o).stream,a):e},a.context=function(o){return arguments.length?(s=o==null?(t=null,new wD(n)):new PB(t=o),typeof i!="function"&&s.pointRadius(i),a):t},a.pointRadius=function(o){return arguments.length?(i=typeof o=="function"?o:(s.pointRadius(+o),+o),a):i},a.digits=function(o){if(!arguments.length)return n;if(o==null)n=null;else{const u=Math.floor(o);if(!(u>=0))throw new RangeError(`invalid digits: ${o}`);n=u}return t===null&&(s=new wD(n)),a},a.projection(e).digits(n).context(t)}function Ix(e){return function(t){var n=new HS;for(var i in e)n[i]=e[i];return n.stream=t,n}}function HS(){}HS.prototype={constructor:HS,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Y$(e,t,n){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),i!=null&&e.clipExtent(null),co(n,e.stream(Yy)),t(Yy.result()),i!=null&&e.clipExtent(i),e}function Dx(e,t,n){return Y$(e,function(i){var r=t[1][0]-t[0][0],s=t[1][1]-t[0][1],a=Math.min(r/(i[1][0]-i[0][0]),s/(i[1][1]-i[0][1])),o=+t[0][0]+(r-a*(i[1][0]+i[0][0]))/2,u=+t[0][1]+(s-a*(i[1][1]+i[0][1]))/2;e.scale(150*a).translate([o,u])},n)}function X$(e,t,n){return Dx(e,[[0,0],t],n)}function K$(e,t,n){return Y$(e,function(i){var r=+t,s=r/(i[1][0]-i[0][0]),a=(r-s*(i[1][0]+i[0][0]))/2,o=-s*i[0][1];e.scale(150*s).translate([a,o])},n)}function J$(e,t,n){return Y$(e,function(i){var r=+t,s=r/(i[1][1]-i[0][1]),a=-s*i[0][0],o=(r-s*(i[1][1]+i[0][1]))/2;e.scale(150*s).translate([a,o])},n)}var ED=16,Bpe=Oe(30*Je);function SD(e,t){return+t?jpe(e,t):Upe(e)}function Upe(e){return Ix({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function jpe(e,t){function n(i,r,s,a,o,u,l,c,f,d,p,m,y,v){var b=l-i,_=c-r,E=b*b+_*_;if(E>4*t&&y--){var S=a+d,A=o+p,$=u+m,C=Oi(S*S+A*A+$*$),M=Ji($/=C),N=at(at($)-1)<Fe||at(s-f)<Fe?(s+f)/2:Qr(A,S),P=e(N,M),D=P[0],W=P[1],q=D-i,z=W-r,R=_*q-b*z;(R*R/E>t||at((b*q+_*z)/E-.5)>.3||a*d+o*p+u*m<Bpe)&&(n(i,r,s,a,o,u,D,W,N,S/=C,A/=C,$,y,v),v.point(D,W),n(D,W,N,S,A,$,l,c,f,d,p,m,y,v))}}return function(i){var r,s,a,o,u,l,c,f,d,p,m,y,v={point:b,lineStart:_,lineEnd:S,polygonStart:function(){i.polygonStart(),v.lineStart=A},polygonEnd:function(){i.polygonEnd(),v.lineStart=_}};function b(M,N){M=e(M,N),i.point(M[0],M[1])}function _(){f=NaN,v.point=E,i.lineStart()}function E(M,N){var P=lc([M,N]),D=e(M,N);n(f,d,c,p,m,y,f=D[0],d=D[1],c=M,p=P[0],m=P[1],y=P[2],ED,i),i.point(f,d)}function S(){v.point=b,i.lineEnd()}function A(){_(),v.point=$,v.lineEnd=C}function $(M,N){E(r=M,N),s=f,a=d,o=p,u=m,l=y,v.point=E}function C(){n(f,d,c,p,m,y,s,a,r,o,u,l,ED,i),v.lineEnd=S,S()}return v}}var qpe=Ix({point:function(e,t){this.stream.point(e*Je,t*Je)}});function Vpe(e){return Ix({point:function(t,n){var i=e(t,n);return this.stream.point(i[0],i[1])}})}function Wpe(e,t,n,i,r){function s(a,o){return a*=i,o*=r,[t+e*a,n-e*o]}return s.invert=function(a,o){return[(a-t)/e*i,(n-o)/e*r]},s}function AD(e,t,n,i,r,s){if(!s)return Wpe(e,t,n,i,r);var a=Oe(s),o=Te(s),u=a*e,l=o*e,c=a/e,f=o/e,d=(o*n-a*t)/e,p=(o*t+a*n)/e;function m(y,v){return y*=i,v*=r,[u*y-l*v+t,n-l*y-u*v]}return m.invert=function(y,v){return[i*(c*y-f*v+d),r*(p-f*y-c*v)]},m}function Na(e){return qB(function(){return e})()}function qB(e){var t,n=150,i=480,r=250,s=0,a=0,o=0,u=0,l=0,c,f=0,d=1,p=1,m=null,y=pD,v=null,b,_,E,S=fg,A=.5,$,C,M,N,P;function D(R){return M(R[0]*Je,R[1]*Je)}function W(R){return R=M.invert(R[0],R[1]),R&&[R[0]*an,R[1]*an]}D.stream=function(R){return N&&P===R?N:N=qpe(Vpe(c)(y($(S(P=R)))))},D.preclip=function(R){return arguments.length?(y=R,m=void 0,z()):y},D.postclip=function(R){return arguments.length?(S=R,v=b=_=E=null,z()):S},D.clipAngle=function(R){return arguments.length?(y=+R?Cpe(m=R*Je):(m=null,pD),z()):m*an},D.clipExtent=function(R){return arguments.length?(S=R==null?(v=b=_=E=null,fg):OB(v=+R[0][0],b=+R[0][1],_=+R[1][0],E=+R[1][1]),z()):v==null?null:[[v,b],[_,E]]},D.scale=function(R){return arguments.length?(n=+R,q()):n},D.translate=function(R){return arguments.length?(i=+R[0],r=+R[1],q()):[i,r]},D.center=function(R){return arguments.length?(s=R[0]%360*Je,a=R[1]%360*Je,q()):[s*an,a*an]},D.rotate=function(R){return arguments.length?(o=R[0]%360*Je,u=R[1]%360*Je,l=R.length>2?R[2]%360*Je:0,q()):[o*an,u*an,l*an]},D.angle=function(R){return arguments.length?(f=R%360*Je,q()):f*an},D.reflectX=function(R){return arguments.length?(d=R?-1:1,q()):d<0},D.reflectY=function(R){return arguments.length?(p=R?-1:1,q()):p<0},D.precision=function(R){return arguments.length?($=SD(C,A=R*R),z()):Oi(A)},D.fitExtent=function(R,U){return Dx(D,R,U)},D.fitSize=function(R,U){return X$(D,R,U)},D.fitWidth=function(R,U){return K$(D,R,U)},D.fitHeight=function(R,U){return J$(D,R,U)};function q(){var R=AD(n,0,0,d,p,f).apply(null,t(s,a)),U=AD(n,i-R[0],r-R[1],d,p,f);return c=CB(o,u,l),C=PS(t,U),M=PS(c,C),$=SD(C,A),z()}function z(){return N=P=null,D}return function(){return t=e.apply(this,arguments),D.invert=t.invert&&W,q()}}function Q$(e){var t=0,n=Qe/3,i=qB(e),r=i(t,n);return r.parallels=function(s){return arguments.length?i(t=s[0]*Je,n=s[1]*Je):[t*an,n*an]},r}function Gpe(e){var t=Oe(e);function n(i,r){return[i*t,Te(r)/t]}return n.invert=function(i,r){return[i/t,Ji(r*t)]},n}function Hpe(e,t){var n=Te(e),i=(n+Te(t))/2;if(at(i)<Fe)return Gpe(e);var r=1+n*(2*i-n),s=Oi(r)/i;function a(o,u){var l=Oi(r-2*i*Te(u))/i;return[l*Te(o*=i),s-l*Oe(o)]}return a.invert=function(o,u){var l=s-u,c=Qr(o,at(l))*qr(l);return l*i<0&&(c-=Qe*qr(o)*qr(l)),[c/i,Ji((r-(o*o+l*l)*i*i)/(2*i))]},a}function Qy(){return Q$(Hpe).scale(155.424).center([0,33.6442])}function VB(){return Qy().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Ype(e){var t=e.length;return{point:function(n,i){for(var r=-1;++r<t;)e[r].point(n,i)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function Xpe(){var e,t,n=VB(),i,r=Qy().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s,a=Qy().rotate([157,0]).center([-3,19.9]).parallels([8,18]),o,u,l={point:function(d,p){u=[d,p]}};function c(d){var p=d[0],m=d[1];return u=null,i.point(p,m),u||(s.point(p,m),u)||(o.point(p,m),u)}c.invert=function(d){var p=n.scale(),m=n.translate(),y=(d[0]-m[0])/p,v=(d[1]-m[1])/p;return(v>=.12&&v<.234&&y>=-.425&&y<-.214?r:v>=.166&&v<.234&&y>=-.214&&y<-.115?a:n).invert(d)},c.stream=function(d){return e&&t===d?e:e=Ype([n.stream(t=d),r.stream(d),a.stream(d)])},c.precision=function(d){return arguments.length?(n.precision(d),r.precision(d),a.precision(d),f()):n.precision()},c.scale=function(d){return arguments.length?(n.scale(d),r.scale(d*.35),a.scale(d),c.translate(n.translate())):n.scale()},c.translate=function(d){if(!arguments.length)return n.translate();var p=n.scale(),m=+d[0],y=+d[1];return i=n.translate(d).clipExtent([[m-.455*p,y-.238*p],[m+.455*p,y+.238*p]]).stream(l),s=r.translate([m-.307*p,y+.201*p]).clipExtent([[m-.425*p+Fe,y+.12*p+Fe],[m-.214*p-Fe,y+.234*p-Fe]]).stream(l),o=a.translate([m-.205*p,y+.212*p]).clipExtent([[m-.214*p+Fe,y+.166*p+Fe],[m-.115*p-Fe,y+.234*p-Fe]]).stream(l),f()},c.fitExtent=function(d,p){return Dx(c,d,p)},c.fitSize=function(d,p){return X$(c,d,p)},c.fitWidth=function(d,p){return K$(c,d,p)},c.fitHeight=function(d,p){return J$(c,d,p)};function f(){return e=t=null,c}return c.scale(1070)}function WB(e){return function(t,n){var i=Oe(t),r=Oe(n),s=e(i*r);return s===1/0?[2,0]:[s*r*Te(t),s*Te(n)]}}function u0(e){return function(t,n){var i=Oi(t*t+n*n),r=e(i),s=Te(r),a=Oe(r);return[Qr(t*s,i*a),Ji(i&&n*s/i)]}}var GB=WB(function(e){return Oi(2/(1+e))});GB.invert=u0(function(e){return 2*Ji(e/2)});function Kpe(){return Na(GB).scale(124.75).clipAngle(180-.001)}var HB=WB(function(e){return(e=gB(e))&&e/Te(e)});HB.invert=u0(function(e){return e});function Jpe(){return Na(HB).scale(79.4188).clipAngle(180-.001)}function Px(e,t){return[e,Ny(G$((Zt+t)/2))]}Px.invert=function(e,t){return[e,2*Gh(pB(t))-Zt]};function Qpe(){return YB(Px).scale(961/Ti)}function YB(e){var t=Na(e),n=t.center,i=t.scale,r=t.translate,s=t.clipExtent,a=null,o,u,l;t.scale=function(f){return arguments.length?(i(f),c()):i()},t.translate=function(f){return arguments.length?(r(f),c()):r()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?a=o=u=l=null:(a=+f[0][0],o=+f[0][1],u=+f[1][0],l=+f[1][1]),c()):a==null?null:[[a,o],[u,l]]};function c(){var f=Qe*i(),d=t(vpe(t.rotate()).invert([0,0]));return s(a==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===Px?[[Math.max(d[0]-f,a),o],[Math.min(d[0]+f,u),l]]:[[a,Math.max(d[1]-f,o)],[u,Math.min(d[1]+f,l)]])}return c()}function Qm(e){return G$((Zt+e)/2)}function Zpe(e,t){var n=Oe(e),i=e===t?Te(e):Ny(n/Oe(t))/Ny(Qm(t)/Qm(e)),r=n*fw(Qm(e),i)/i;if(!i)return Px;function s(a,o){r>0?o<-Zt+Fe&&(o=-Zt+Fe):o>Zt-Fe&&(o=Zt-Fe);var u=r/fw(Qm(o),i);return[u*Te(i*a),r-u*Oe(i*a)]}return s.invert=function(a,o){var u=r-o,l=qr(i)*Oi(a*a+u*u),c=Qr(a,at(u))*qr(u);return u*i<0&&(c-=Qe*qr(a)*qr(u)),[c/i,2*Gh(fw(r/l,1/i))-Zt]},s}function ege(){return Q$(Zpe).scale(109.5).parallels([30,30])}function Zy(e,t){return[e,t]}Zy.invert=Zy;function tge(){return Na(Zy).scale(152.63)}function nge(e,t){var n=Oe(e),i=e===t?Te(e):(n-Oe(t))/(t-e),r=n/i+e;if(at(i)<Fe)return Zy;function s(a,o){var u=r-o,l=i*a;return[u*Te(l),r-u*Oe(l)]}return s.invert=function(a,o){var u=r-o,l=Qr(a,at(u))*qr(u);return u*i<0&&(l-=Qe*qr(a)*qr(u)),[l/i,r-qr(i)*Oi(a*a+u*u)]},s}function ige(){return Q$(nge).scale(131.154).center([0,13.9389])}var Bp=1.340264,Up=-.081106,jp=893e-6,qp=.003796,ev=Oi(3)/2,rge=12;function XB(e,t){var n=Ji(ev*Te(t)),i=n*n,r=i*i*i;return[e*Oe(n)/(ev*(Bp+3*Up*i+r*(7*jp+9*qp*i))),n*(Bp+Up*i+r*(jp+qp*i))]}XB.invert=function(e,t){for(var n=t,i=n*n,r=i*i*i,s=0,a,o,u;s<rge&&(o=n*(Bp+Up*i+r*(jp+qp*i))-t,u=Bp+3*Up*i+r*(7*jp+9*qp*i),n-=a=o/u,i=n*n,r=i*i*i,!(at(a)<kS));++s);return[ev*e*(Bp+3*Up*i+r*(7*jp+9*qp*i))/Oe(n),Ji(Te(n)/ev)]};function sge(){return Na(XB).scale(177.158)}function KB(e,t){var n=Oe(t),i=Oe(e)*n;return[n*Te(e)/i,Te(t)/i]}KB.invert=u0(Gh);function age(){return Na(KB).scale(144.049).clipAngle(60)}function oge(){var e=1,t=0,n=0,i=1,r=1,s=0,a,o,u=null,l,c,f,d=1,p=1,m=Ix({point:function(S,A){var $=E([S,A]);this.stream.point($[0],$[1])}}),y=fg,v,b;function _(){return d=e*i,p=e*r,v=b=null,E}function E(S){var A=S[0]*d,$=S[1]*p;if(s){var C=$*a-A*o;A=A*a+$*o,$=C}return[A+t,$+n]}return E.invert=function(S){var A=S[0]-t,$=S[1]-n;if(s){var C=$*a+A*o;A=A*a-$*o,$=C}return[A/d,$/p]},E.stream=function(S){return v&&b===S?v:v=m(y(b=S))},E.postclip=function(S){return arguments.length?(y=S,u=l=c=f=null,_()):y},E.clipExtent=function(S){return arguments.length?(y=S==null?(u=l=c=f=null,fg):OB(u=+S[0][0],l=+S[0][1],c=+S[1][0],f=+S[1][1]),_()):u==null?null:[[u,l],[c,f]]},E.scale=function(S){return arguments.length?(e=+S,_()):e},E.translate=function(S){return arguments.length?(t=+S[0],n=+S[1],_()):[t,n]},E.angle=function(S){return arguments.length?(s=S%360*Je,o=Te(s),a=Oe(s),_()):s*an},E.reflectX=function(S){return arguments.length?(i=S?-1:1,_()):i<0},E.reflectY=function(S){return arguments.length?(r=S?-1:1,_()):r<0},E.fitExtent=function(S,A){return Dx(E,S,A)},E.fitSize=function(S,A){return X$(E,S,A)},E.fitWidth=function(S,A){return K$(E,S,A)},E.fitHeight=function(S,A){return J$(E,S,A)},E}function JB(e,t){var n=t*t,i=n*n;return[e*(.8707-.131979*n+i*(-.013791+i*(.003971*n-.001529*i))),t*(1.007226+n*(.015085+i*(-.044475+.028874*n-.005916*i)))]}JB.invert=function(e,t){var n=t,i=25,r;do{var s=n*n,a=s*s;n-=r=(n*(1.007226+s*(.015085+a*(-.044475+.028874*s-.005916*a)))-t)/(1.007226+s*(.015085*3+a*(-.044475*7+.028874*9*s-.005916*11*a)))}while(at(r)>Fe&&--i>0);return[e/(.8707+(s=n*n)*(-.131979+s*(-.013791+s*s*s*(.003971-.001529*s)))),n]};function uge(){return Na(JB).scale(175.295)}function QB(e,t){return[Oe(t)*Te(e),Te(t)]}QB.invert=u0(Ji);function lge(){return Na(QB).scale(249.5).clipAngle(90+Fe)}function ZB(e,t){var n=Oe(t),i=1+Oe(e)*n;return[n*Te(e)/i,Te(t)/i]}ZB.invert=u0(function(e){return 2*Gh(e)});function cge(){return Na(ZB).scale(250).clipAngle(142)}function eU(e,t){return[Ny(G$((Zt+t)/2)),-e]}eU.invert=function(e,t){return[-t,2*Gh(pB(e))-Zt]};function fge(){var e=YB(eU),t=e.center,n=e.rotate;return e.center=function(i){return arguments.length?t([-i[1],i[0]]):(i=t(),[i[1],-i[0]])},e.rotate=function(i){return arguments.length?n([i[0],i[1],i.length>2?i[2]+90:90]):(i=n(),[i[0],i[1],i[2]-90])},n([0,0,90]).scale(159.155)}var hge=Math.abs,YS=Math.cos,tv=Math.sin,dge=1e-6,tU=Math.PI,XS=tU/2,CD=pge(2);function kD(e){return e>1?XS:e<-1?-XS:Math.asin(e)}function pge(e){return e>0?Math.sqrt(e):0}function gge(e,t){var n=e*tv(t),i=30,r;do t-=r=(t+tv(t)-n)/(1+YS(t));while(hge(r)>dge&&--i>0);return t/2}function mge(e,t,n){function i(r,s){return[e*r*YS(s=gge(n,s)),t*tv(s)]}return i.invert=function(r,s){return s=kD(s/t),[r/(e*YS(s)),kD((2*s+tv(2*s))/n)]},i}var yge=mge(CD/XS,CD,tU);function vge(){return Na(yge).scale(169.529)}const xge=jB(),KS=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function bge(e,t){return function n(){const i=t();return i.type=e,i.path=jB().projection(i),i.copy=i.copy||function(){const r=n();return KS.forEach(s=>{i[s]&&r[s](i[s]())}),r.path.pointRadius(i.path.pointRadius()),r},m7(i)}}function Z$(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(nv[e]=bge(e,t),this):nv[e]||null}function nU(e){return e&&e.path||xge}const nv={albers:VB,albersusa:Xpe,azimuthalequalarea:Kpe,azimuthalequidistant:Jpe,conicconformal:ege,conicequalarea:Qy,conicequidistant:ige,equalEarth:sge,equirectangular:tge,gnomonic:age,identity:oge,mercator:Qpe,mollweide:vge,naturalEarth1:uge,orthographic:lge,stereographic:cge,transversemercator:fge};for(const e in nv)Z$(e,nv[e]);function _ge(){}const to=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function iU(){var e=1,t=1,n=o;function i(u,l){return l.map(c=>r(u,c))}function r(u,l){var c=[],f=[];return s(u,l,d=>{n(d,u,l),wge(d)>0?c.push([d]):f.push(d)}),f.forEach(d=>{for(var p=0,m=c.length,y;p<m;++p)if(Ege((y=c[p])[0],d)!==-1){y.push(d);return}}),{type:"MultiPolygon",value:l,coordinates:c}}function s(u,l,c){var f=[],d=[],p,m,y,v,b,_;for(p=m=-1,v=u[0]>=l,to[v<<1].forEach(E);++p<e-1;)y=v,v=u[p+1]>=l,to[y|v<<1].forEach(E);for(to[v<<0].forEach(E);++m<t-1;){for(p=-1,v=u[m*e+e]>=l,b=u[m*e]>=l,to[v<<1|b<<2].forEach(E);++p<e-1;)y=v,v=u[m*e+e+p+1]>=l,_=b,b=u[m*e+p+1]>=l,to[y|v<<1|b<<2|_<<3].forEach(E);to[v|b<<3].forEach(E)}for(p=-1,b=u[m*e]>=l,to[b<<2].forEach(E);++p<e-1;)_=b,b=u[m*e+p+1]>=l,to[b<<2|_<<3].forEach(E);to[b<<3].forEach(E);function E(S){var A=[S[0][0]+p,S[0][1]+m],$=[S[1][0]+p,S[1][1]+m],C=a(A),M=a($),N,P;(N=d[C])?(P=f[M])?(delete d[N.end],delete f[P.start],N===P?(N.ring.push($),c(N.ring)):f[N.start]=d[P.end]={start:N.start,end:P.end,ring:N.ring.concat(P.ring)}):(delete d[N.end],N.ring.push($),d[N.end=M]=N):(N=f[M])?(P=d[C])?(delete f[N.start],delete d[P.end],N===P?(N.ring.push($),c(N.ring)):f[P.start]=d[N.end]={start:P.start,end:N.end,ring:P.ring.concat(N.ring)}):(delete f[N.start],N.ring.unshift(A),f[N.start=C]=N):f[C]=d[M]={start:C,end:M,ring:[A,$]}}}function a(u){return u[0]*2+u[1]*(e+1)*4}function o(u,l,c){u.forEach(f=>{var d=f[0],p=f[1],m=d|0,y=p|0,v,b=l[y*e+m];d>0&&d<e&&m===d&&(v=l[y*e+m-1],f[0]=d+(c-v)/(b-v)-.5),p>0&&p<t&&y===p&&(v=l[(y-1)*e+m],f[1]=p+(c-v)/(b-v)-.5)})}return i.contour=r,i.size=function(u){if(!arguments.length)return[e,t];var l=Math.floor(u[0]),c=Math.floor(u[1]);return l>=0&&c>=0||K("invalid size"),e=l,t=c,i},i.smooth=function(u){return arguments.length?(n=u?o:_ge,i):n===o},i}function wge(e){for(var t=0,n=e.length,i=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)i+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return i}function Ege(e,t){for(var n=-1,i=t.length,r;++n<i;)if(r=Sge(e,t[n]))return r;return 0}function Sge(e,t){for(var n=t[0],i=t[1],r=-1,s=0,a=e.length,o=a-1;s<a;o=s++){var u=e[s],l=u[0],c=u[1],f=e[o],d=f[0],p=f[1];if(Age(u,f,t))return 0;c>i!=p>i&&n<(d-l)*(i-c)/(p-c)+l&&(r=-r)}return r}function Age(e,t,n){var i;return Cge(e,t,n)&&kge(e[i=+(e[0]===t[0])],n[i],t[i])}function Cge(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function kge(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function rU(e,t,n){return function(i){var r=xa(i),s=n?Math.min(r[0],0):r[0],a=r[1],o=a-s,u=t?Nu(s,a,e):o/(e+1);return pr(s+u,a,u)}}function e3(e){H.call(this,null,e)}e3.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};ce(e3,H,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=e.field||hi,s=iU().smooth(e.smooth!==!1),a=e.thresholds||$ge(i,r,e),o=e.as===null?null:e.as||"contour",u=[];return i.forEach(l=>{const c=r(l),f=s.size([c.width,c.height])(c.values,Q(a)?a:a(c.values));Tge(f,c,l,e),f.forEach(d=>{u.push(ex(l,yt(o!=null?{[o]:d}:d)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function $ge(e,t,n){const i=rU(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?i:i(e.map(r=>Yl(t(r).values)))}function Tge(e,t,n,i){let r=i.scale||t.scale,s=i.translate||t.translate;if(Ye(r)&&(r=r(n,i)),Ye(s)&&(s=s(n,i)),(r===1||r==null)&&!s)return;const a=(dt(r)?r:r[0])||1,o=(dt(r)?r:r[1])||1,u=s&&s[0]||0,l=s&&s[1]||0;e.forEach(sU(t,a,o,u,l))}function sU(e,t,n,i,r){const s=e.x1||0,a=e.y1||0,o=t*n<0;function u(f){f.forEach(l)}function l(f){o&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-s)*t+i,f[1]=(f[1]-a)*n+r}return function(f){return f.coordinates.forEach(u),f}}function $D(e,t,n){const i=e>=0?e:GC(t,n);return Math.round((Math.sqrt(4*i*i+1)-1)/2)}function mw(e){return Ye(e)?e:di(+e)}function aU(){var e=u=>u[0],t=u=>u[1],n=Mh,i=[-1,-1],r=960,s=500,a=2;function o(u,l){const c=$D(i[0],u,e)>>a,f=$D(i[1],u,t)>>a,d=c?c+2:0,p=f?f+2:0,m=2*d+(r>>a),y=2*p+(s>>a),v=new Float32Array(m*y),b=new Float32Array(m*y);let _=v;u.forEach(S=>{const A=d+(+e(S)>>a),$=p+(+t(S)>>a);A>=0&&A<m&&$>=0&&$<y&&(v[A+$*m]+=+n(S))}),c>0&&f>0?(pf(m,y,v,b,c),gf(m,y,b,v,f),pf(m,y,v,b,c),gf(m,y,b,v,f),pf(m,y,v,b,c),gf(m,y,b,v,f)):c>0?(pf(m,y,v,b,c),pf(m,y,b,v,c),pf(m,y,v,b,c),_=b):f>0&&(gf(m,y,v,b,f),gf(m,y,b,v,f),gf(m,y,v,b,f),_=b);const E=l?Math.pow(2,-2*a):1/b4(_);for(let S=0,A=m*y;S<A;++S)_[S]*=E;return{values:_,scale:1<<a,width:m,height:y,x1:d,y1:p,x2:d+(r>>a),y2:p+(s>>a)}}return o.x=function(u){return arguments.length?(e=mw(u),o):e},o.y=function(u){return arguments.length?(t=mw(u),o):t},o.weight=function(u){return arguments.length?(n=mw(u),o):n},o.size=function(u){if(!arguments.length)return[r,s];var l=+u[0],c=+u[1];return l>=0&&c>=0||K("invalid size"),r=l,s=c,o},o.cellSize=function(u){return arguments.length?((u=+u)>=1||K("invalid cell size"),a=Math.floor(Math.log(u)/Math.LN2),o):1<<a},o.bandwidth=function(u){return arguments.length?(u=pe(u),u.length===1&&(u=[+u[0],+u[0]]),u.length!==2&&K("invalid bandwidth"),i=u,o):i},o}function pf(e,t,n,i,r){const s=(r<<1)+1;for(let a=0;a<t;++a)for(let o=0,u=0;o<e+r;++o)o<e&&(u+=n[o+a*e]),o>=r&&(o>=s&&(u-=n[o-s+a*e]),i[o-r+a*e]=u/Math.min(o+1,e-1+s-o,s))}function gf(e,t,n,i,r){const s=(r<<1)+1;for(let a=0;a<e;++a)for(let o=0,u=0;o<t+r;++o)o<t&&(u+=n[a+o*e]),o>=r&&(o>=s&&(u-=n[a+(o-s)*e]),i[a+(o-r)*e]=u/Math.min(o+1,t-1+s-o,s))}function t3(e){H.call(this,null,e)}t3.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const Oge=["x","y","weight","size","cellSize","bandwidth"];function oU(e,t){return Oge.forEach(n=>t[n]!=null?e[n](t[n]):0),e}ce(t3,H,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=Fge(i,e.groupby),s=(e.groupby||[]).map(en),a=oU(aU(),e),o=e.as||"grid",u=[];function l(c,f){for(let d=0;d<s.length;++d)c[s[d]]=f[d];return c}return u=r.map(c=>yt(l({[o]:a(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function Fge(e,t){var n=[],i=c=>c(o),r,s,a,o,u,l;if(t==null)n.push(e);else for(r={},s=0,a=e.length;s<a;++s)o=e[s],u=t.map(i),l=r[u],l||(r[u]=l=[],l.dims=u,n.push(l)),l.push(o);return n}function n3(e){H.call(this,null,e)}n3.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};ce(n3,H,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=iU().smooth(e.smooth!==!1),r=e.values,s=e.thresholds||rU(e.count||10,e.nice,!!r),a=e.size,o,u;return r||(r=t.materialize(t.SOURCE).source,o=oU(aU(),e)(r,!0),u=sU(o,o.scale||1,o.scale||1,0,0),a=[o.width,o.height],r=o.values),s=Q(s)?s:s(r),r=i.size(a)(r,s),u&&r.forEach(u),this.value&&(n.rem=this.value),this.value=n.source=n.add=(r||[]).map(yt),n}});const JS="Feature",i3="FeatureCollection",Mge="MultiPoint";function r3(e){H.call(this,null,e)}r3.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};ce(r3,H,{transform(e,t){var n=this._features,i=this._points,r=e.fields,s=r&&r[0],a=r&&r[1],o=e.geojson||!r&&hi,u=t.ADD,l;l=e.modified()||t.changed(t.REM)||t.modified(ui(o))||s&&t.modified(ui(s))||a&&t.modified(ui(a)),(!this.value||l)&&(u=t.SOURCE,this._features=n=[],this._points=i=[]),o&&t.visit(u,c=>n.push(o(c))),s&&a&&(t.visit(u,c=>{var f=s(c),d=a(c);f!=null&&d!=null&&(f=+f)===f&&(d=+d)===d&&i.push([f,d])}),n=n.concat({type:JS,geometry:{type:Mge,coordinates:i}})),this.value={type:i3,features:n}}});function s3(e){H.call(this,null,e)}s3.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};ce(s3,H,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.field||hi,s=e.as||"path",a=n.SOURCE;!i||e.modified()?(this.value=i=nU(e.projection),n.materialize().reflow()):a=r===hi||t.modified(r.fields)?n.ADD_MOD:n.ADD;const o=Nge(i,e.pointRadius);return n.visit(a,u=>u[s]=i(r(u))),i.pointRadius(o),n.modifies(s)}});function Nge(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function a3(e){H.call(this,null,e)}a3.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};ce(a3,H,{transform(e,t){var n=e.projection,i=e.fields[0],r=e.fields[1],s=e.as||["x","y"],a=s[0],o=s[1],u;function l(c){const f=n([i(c),r(c)]);f?(c[a]=f[0],c[o]=f[1]):(c[a]=void 0,c[o]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(u=t.modified(i.fields)||t.modified(r.fields),t.visit(u?t.ADD_MOD:t.ADD,l)),t.modifies(s)}});function o3(e){H.call(this,null,e)}o3.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};ce(o3,H,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.as||"shape",s=n.ADD;return(!i||e.modified())&&(this.value=i=Rge(nU(e.projection),e.field||Yr("datum"),e.pointRadius),n.materialize().reflow(),s=n.SOURCE),n.visit(s,a=>a[r]=i),n.modifies(r)}});function Rge(e,t,n){const i=n==null?r=>e(t(r)):r=>{var s=e.pointRadius(),a=e.pointRadius(n)(t(r));return e.pointRadius(s),a};return i.context=r=>(e.context(r),i),i}function u3(e){H.call(this,[],e),this.generator=$pe()}u3.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};ce(u3,H,{transform(e,t){var n=this.value,i=this.generator,r;if(!n.length||e.modified())for(const s in e)Ye(i[s])&&i[s](e[s]);return r=i(),n.length?t.mod.push(g8(n[0],r)):t.add.push(yt(r)),n[0]=r,t}});function l3(e){H.call(this,null,e)}l3.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};ce(l3,H,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,i=e.resolve==="shared",r=e.field||hi,s=Dge(e.opacity,e),a=Ige(e.color,e),o=e.as||"image",u={$x:0,$y:0,$value:0,$max:i?Yl(n.map(l=>Yl(r(l).values))):0};return n.forEach(l=>{const c=r(l),f=We({},l,u);i||(f.$max=Yl(c.values||[])),l[o]=Pge(c,f,a.dep?a:di(a(f)),s.dep?s:di(s(f)))}),t.reflow(!0).modifies(o)}});function Ige(e,t){let n;return Ye(e)?(n=i=>Du(e(i,t)),n.dep=uU(e)):n=di(Du(e||"#888")),n}function Dge(e,t){let n;return Ye(e)?(n=i=>e(i,t),n.dep=uU(e)):e?n=di(e):(n=i=>i.$value/i.$max||0,n.dep=!0),n}function uU(e){if(!Ye(e))return!1;const t=Os(ui(e));return t.$x||t.$y||t.$value||t.$max}function Pge(e,t,n,i){const r=e.width,s=e.height,a=e.x1||0,o=e.y1||0,u=e.x2||r,l=e.y2||s,c=e.values,f=c?v=>c[v]:pu,d=$u(u-a,l-o),p=d.getContext("2d"),m=p.getImageData(0,0,u-a,l-o),y=m.data;for(let v=o,b=0;v<l;++v){t.$y=v-o;for(let _=a,E=v*r;_<u;++_,b+=4){t.$x=_-a,t.$value=f(_+E);const S=n(t);y[b+0]=S.r,y[b+1]=S.g,y[b+2]=S.b,y[b+3]=~~(255*i(t))}}return p.putImageData(m,0,0),d}function lU(e){H.call(this,null,e),this.modified(!0)}ce(lU,H,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=zge(e.type),KS.forEach(i=>{e[i]!=null&&TD(n,i,e[i])})):KS.forEach(i=>{e.modified(i)&&TD(n,i,e[i])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&Lge(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Lge(e,t){const n=Bge(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function zge(e){const t=Z$((e||"mercator").toLowerCase());return t||K("Unrecognized projection type: "+e),t()}function TD(e,t,n){Ye(e[t])&&e[t](n)}function Bge(e){return e=pe(e),e.length===1?e[0]:{type:i3,features:e.reduce((t,n)=>t.concat(Uge(n)),[])}}function Uge(e){return e.type===i3?e.features:pe(e).filter(t=>t!=null).map(t=>t.type===JS?t:{type:JS,geometry:t})}const jge=Object.freeze(Object.defineProperty({__proto__:null,contour:n3,geojson:r3,geopath:s3,geopoint:a3,geoshape:o3,graticule:u3,heatmap:l3,isocontour:e3,kde2d:t3,projection:lU},Symbol.toStringTag,{value:"Module"}));function qge(e,t){var n,i=1;e==null&&(e=0),t==null&&(t=0);function r(){var s,a=n.length,o,u=0,l=0;for(s=0;s<a;++s)o=n[s],u+=o.x,l+=o.y;for(u=(u/a-e)*i,l=(l/a-t)*i,s=0;s<a;++s)o=n[s],o.x-=u,o.y-=l}return r.initialize=function(s){n=s},r.x=function(s){return arguments.length?(e=+s,r):e},r.y=function(s){return arguments.length?(t=+s,r):t},r.strength=function(s){return arguments.length?(i=+s,r):i},r}function Vge(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return cU(this.cover(t,n),t,n,e)}function cU(e,t,n,i){if(isNaN(t)||isNaN(n))return e;var r,s=e._root,a={data:i},o=e._x0,u=e._y0,l=e._x1,c=e._y1,f,d,p,m,y,v,b,_;if(!s)return e._root=a,e;for(;s.length;)if((y=t>=(f=(o+l)/2))?o=f:l=f,(v=n>=(d=(u+c)/2))?u=d:c=d,r=s,!(s=s[b=v<<1|y]))return r[b]=a,e;if(p=+e._x.call(null,s.data),m=+e._y.call(null,s.data),t===p&&n===m)return a.next=s,r?r[b]=a:e._root=a,e;do r=r?r[b]=new Array(4):e._root=new Array(4),(y=t>=(f=(o+l)/2))?o=f:l=f,(v=n>=(d=(u+c)/2))?u=d:c=d;while((b=v<<1|y)===(_=(m>=d)<<1|p>=f));return r[_]=s,r[b]=a,e}function Wge(e){var t,n,i=e.length,r,s,a=new Array(i),o=new Array(i),u=1/0,l=1/0,c=-1/0,f=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(s=+this._y.call(null,t))||(a[n]=r,o[n]=s,r<u&&(u=r),r>c&&(c=r),s<l&&(l=s),s>f&&(f=s));if(u>c||l>f)return this;for(this.cover(u,l).cover(c,f),n=0;n<i;++n)cU(this,a[n],o[n],e[n]);return this}function Gge(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,i=this._y0,r=this._x1,s=this._y1;if(isNaN(n))r=(n=Math.floor(e))+1,s=(i=Math.floor(t))+1;else{for(var a=r-n||1,o=this._root,u,l;n>e||e>=r||i>t||t>=s;)switch(l=(t<i)<<1|e<n,u=new Array(4),u[l]=o,o=u,a*=2,l){case 0:r=n+a,s=i+a;break;case 1:n=r-a,s=i+a;break;case 2:r=n+a,i=s-a;break;case 3:n=r-a,i=s-a;break}this._root&&this._root.length&&(this._root=o)}return this._x0=n,this._y0=i,this._x1=r,this._y1=s,this}function Hge(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function Yge(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Si(e,t,n,i,r){this.node=e,this.x0=t,this.y0=n,this.x1=i,this.y1=r}function Xge(e,t,n){var i,r=this._x0,s=this._y0,a,o,u,l,c=this._x1,f=this._y1,d=[],p=this._root,m,y;for(p&&d.push(new Si(p,r,s,c,f)),n==null?n=1/0:(r=e-n,s=t-n,c=e+n,f=t+n,n*=n);m=d.pop();)if(!(!(p=m.node)||(a=m.x0)>c||(o=m.y0)>f||(u=m.x1)<r||(l=m.y1)<s))if(p.length){var v=(a+u)/2,b=(o+l)/2;d.push(new Si(p[3],v,b,u,l),new Si(p[2],a,b,v,l),new Si(p[1],v,o,u,b),new Si(p[0],a,o,v,b)),(y=(t>=b)<<1|e>=v)&&(m=d[d.length-1],d[d.length-1]=d[d.length-1-y],d[d.length-1-y]=m)}else{var _=e-+this._x.call(null,p.data),E=t-+this._y.call(null,p.data),S=_*_+E*E;if(S<n){var A=Math.sqrt(n=S);r=e-A,s=t-A,c=e+A,f=t+A,i=p.data}}return i}function Kge(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,i,r,s,a=this._x0,o=this._y0,u=this._x1,l=this._y1,c,f,d,p,m,y,v,b;if(!n)return this;if(n.length)for(;;){if((m=c>=(d=(a+u)/2))?a=d:u=d,(y=f>=(p=(o+l)/2))?o=p:l=p,t=n,!(n=n[v=y<<1|m]))return this;if(!n.length)break;(t[v+1&3]||t[v+2&3]||t[v+3&3])&&(i=t,b=v)}for(;n.data!==e;)if(r=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,r?(s?r.next=s:delete r.next,this):t?(s?t[v]=s:delete t[v],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(i?i[b]=n:this._root=n),this):(this._root=s,this)}function Jge(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function Qge(){return this._root}function Zge(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function e0e(e){var t=[],n,i=this._root,r,s,a,o,u;for(i&&t.push(new Si(i,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(i=n.node,s=n.x0,a=n.y0,o=n.x1,u=n.y1)&&i.length){var l=(s+o)/2,c=(a+u)/2;(r=i[3])&&t.push(new Si(r,l,c,o,u)),(r=i[2])&&t.push(new Si(r,s,c,l,u)),(r=i[1])&&t.push(new Si(r,l,a,o,c)),(r=i[0])&&t.push(new Si(r,s,a,l,c))}return this}function t0e(e){var t=[],n=[],i;for(this._root&&t.push(new Si(this._root,this._x0,this._y0,this._x1,this._y1));i=t.pop();){var r=i.node;if(r.length){var s,a=i.x0,o=i.y0,u=i.x1,l=i.y1,c=(a+u)/2,f=(o+l)/2;(s=r[0])&&t.push(new Si(s,a,o,c,f)),(s=r[1])&&t.push(new Si(s,c,o,u,f)),(s=r[2])&&t.push(new Si(s,a,f,c,l)),(s=r[3])&&t.push(new Si(s,c,f,u,l))}n.push(i)}for(;i=n.pop();)e(i.node,i.x0,i.y0,i.x1,i.y1);return this}function n0e(e){return e[0]}function i0e(e){return arguments.length?(this._x=e,this):this._x}function r0e(e){return e[1]}function s0e(e){return arguments.length?(this._y=e,this):this._y}function c3(e,t,n){var i=new f3(t??n0e,n??r0e,NaN,NaN,NaN,NaN);return e==null?i:i.addAll(e)}function f3(e,t,n,i,r,s){this._x=e,this._y=t,this._x0=n,this._y0=i,this._x1=r,this._y1=s,this._root=void 0}function OD(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Mi=c3.prototype=f3.prototype;Mi.copy=function(){var e=new f3(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,i;if(!t)return e;if(!t.length)return e._root=OD(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var r=0;r<4;++r)(i=t.source[r])&&(i.length?n.push({source:i,target:t.target[r]=new Array(4)}):t.target[r]=OD(i));return e};Mi.add=Vge;Mi.addAll=Wge;Mi.cover=Gge;Mi.data=Hge;Mi.extent=Yge;Mi.find=Xge;Mi.remove=Kge;Mi.removeAll=Jge;Mi.root=Qge;Mi.size=Zge;Mi.visit=e0e;Mi.visitAfter=t0e;Mi.x=i0e;Mi.y=s0e;function Ai(e){return function(){return e}}function _u(e){return(e()-.5)*1e-6}function a0e(e){return e.x+e.vx}function o0e(e){return e.y+e.vy}function u0e(e){var t,n,i,r=1,s=1;typeof e!="function"&&(e=Ai(e==null?1:+e));function a(){for(var l,c=t.length,f,d,p,m,y,v,b=0;b<s;++b)for(f=c3(t,a0e,o0e).visitAfter(o),l=0;l<c;++l)d=t[l],y=n[d.index],v=y*y,p=d.x+d.vx,m=d.y+d.vy,f.visit(_);function _(E,S,A,$,C){var M=E.data,N=E.r,P=y+N;if(M){if(M.index>d.index){var D=p-M.x-M.vx,W=m-M.y-M.vy,q=D*D+W*W;q<P*P&&(D===0&&(D=_u(i),q+=D*D),W===0&&(W=_u(i),q+=W*W),q=(P-(q=Math.sqrt(q)))/q*r,d.vx+=(D*=q)*(P=(N*=N)/(v+N)),d.vy+=(W*=q)*P,M.vx-=D*(P=1-P),M.vy-=W*P)}return}return S>p+P||$<p-P||A>m+P||C<m-P}}function o(l){if(l.data)return l.r=n[l.data.index];for(var c=l.r=0;c<4;++c)l[c]&&l[c].r>l.r&&(l.r=l[c].r)}function u(){if(t){var l,c=t.length,f;for(n=new Array(c),l=0;l<c;++l)f=t[l],n[f.index]=+e(f,l,t)}}return a.initialize=function(l,c){t=l,i=c,u()},a.iterations=function(l){return arguments.length?(s=+l,a):s},a.strength=function(l){return arguments.length?(r=+l,a):r},a.radius=function(l){return arguments.length?(e=typeof l=="function"?l:Ai(+l),u(),a):e},a}function l0e(e){return e.index}function FD(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function c0e(e){var t=l0e,n=f,i,r=Ai(30),s,a,o,u,l,c=1;e==null&&(e=[]);function f(v){return 1/Math.min(o[v.source.index],o[v.target.index])}function d(v){for(var b=0,_=e.length;b<c;++b)for(var E=0,S,A,$,C,M,N,P;E<_;++E)S=e[E],A=S.source,$=S.target,C=$.x+$.vx-A.x-A.vx||_u(l),M=$.y+$.vy-A.y-A.vy||_u(l),N=Math.sqrt(C*C+M*M),N=(N-s[E])/N*v*i[E],C*=N,M*=N,$.vx-=C*(P=u[E]),$.vy-=M*P,A.vx+=C*(P=1-P),A.vy+=M*P}function p(){if(a){var v,b=a.length,_=e.length,E=new Map(a.map((A,$)=>[t(A,$,a),A])),S;for(v=0,o=new Array(b);v<_;++v)S=e[v],S.index=v,typeof S.source!="object"&&(S.source=FD(E,S.source)),typeof S.target!="object"&&(S.target=FD(E,S.target)),o[S.source.index]=(o[S.source.index]||0)+1,o[S.target.index]=(o[S.target.index]||0)+1;for(v=0,u=new Array(_);v<_;++v)S=e[v],u[v]=o[S.source.index]/(o[S.source.index]+o[S.target.index]);i=new Array(_),m(),s=new Array(_),y()}}function m(){if(a)for(var v=0,b=e.length;v<b;++v)i[v]=+n(e[v],v,e)}function y(){if(a)for(var v=0,b=e.length;v<b;++v)s[v]=+r(e[v],v,e)}return d.initialize=function(v,b){a=v,l=b,p()},d.links=function(v){return arguments.length?(e=v,p(),d):e},d.id=function(v){return arguments.length?(t=v,d):t},d.iterations=function(v){return arguments.length?(c=+v,d):c},d.strength=function(v){return arguments.length?(n=typeof v=="function"?v:Ai(+v),m(),d):n},d.distance=function(v){return arguments.length?(r=typeof v=="function"?v:Ai(+v),y(),d):r},d}var f0e={value:()=>{}};function fU(){for(var e=0,t=arguments.length,n={},i;e<t;++e){if(!(i=arguments[e]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new P1(n)}function P1(e){this._=e}function h0e(e,t){return e.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}P1.prototype=fU.prototype={constructor:P1,on:function(e,t){var n=this._,i=h0e(e+"",n),r,s=-1,a=i.length;if(arguments.length<2){for(;++s<a;)if((r=(e=i[s]).type)&&(r=d0e(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<a;)if(r=(e=i[s]).type)n[r]=MD(n[r],e.name,t);else if(t==null)for(r in n)n[r]=MD(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new P1(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,s;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],i=0,r=s.length;i<r;++i)s[i].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],r=0,s=i.length;r<s;++r)i[r].value.apply(t,n)}};function d0e(e,t){for(var n=0,i=e.length,r;n<i;++n)if((r=e[n]).name===t)return r.value}function MD(e,t,n){for(var i=0,r=e.length;i<r;++i)if(e[i].name===t){e[i]=f0e,e=e.slice(0,i).concat(e.slice(i+1));break}return n!=null&&e.push({name:t,value:n}),e}var hh=0,Ap=0,Xd=0,hU=1e3,iv,Cp,rv=0,fc=0,Lx=0,pg=typeof performance=="object"&&performance.now?performance:Date,dU=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function h3(){return fc||(dU(p0e),fc=pg.now()+Lx)}function p0e(){fc=0}function sv(){this._call=this._time=this._next=null}sv.prototype=pU.prototype={constructor:sv,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?h3():+n)+(t==null?0:+t),!this._next&&Cp!==this&&(Cp?Cp._next=this:iv=this,Cp=this),this._call=e,this._time=n,QS()},stop:function(){this._call&&(this._call=null,this._time=1/0,QS())}};function pU(e,t,n){var i=new sv;return i.restart(e,t,n),i}function g0e(){h3(),++hh;for(var e=iv,t;e;)(t=fc-e._time)>=0&&e._call.call(void 0,t),e=e._next;--hh}function ND(){fc=(rv=pg.now())+Lx,hh=Ap=0;try{g0e()}finally{hh=0,y0e(),fc=0}}function m0e(){var e=pg.now(),t=e-rv;t>hU&&(Lx-=t,rv=e)}function y0e(){for(var e,t=iv,n,i=1/0;t;)t._call?(i>t._time&&(i=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:iv=n);Cp=e,QS(i)}function QS(e){if(!hh){Ap&&(Ap=clearTimeout(Ap));var t=e-fc;t>24?(e<1/0&&(Ap=setTimeout(ND,e-pg.now()-Lx)),Xd&&(Xd=clearInterval(Xd))):(Xd||(rv=pg.now(),Xd=setInterval(m0e,hU)),hh=1,dU(ND))}}function v0e(e,t,n){var i=new sv,r=t;return t==null?(i.restart(e,t,n),i):(i._restart=i.restart,i.restart=function(s,a,o){a=+a,o=o==null?h3():+o,i._restart(function u(l){l+=r,i._restart(u,r+=a,o),s(l)},a,o)},i.restart(e,t,n),i)}const x0e=1664525,b0e=1013904223,RD=4294967296;function _0e(){let e=1;return()=>(e=(x0e*e+b0e)%RD)/RD}function w0e(e){return e.x}function E0e(e){return e.y}var S0e=10,A0e=Math.PI*(3-Math.sqrt(5));function C0e(e){var t,n=1,i=.001,r=1-Math.pow(i,1/300),s=0,a=.6,o=new Map,u=pU(f),l=fU("tick","end"),c=_0e();e==null&&(e=[]);function f(){d(),l.call("tick",t),n<i&&(u.stop(),l.call("end",t))}function d(y){var v,b=e.length,_;y===void 0&&(y=1);for(var E=0;E<y;++E)for(n+=(s-n)*r,o.forEach(function(S){S(n)}),v=0;v<b;++v)_=e[v],_.fx==null?_.x+=_.vx*=a:(_.x=_.fx,_.vx=0),_.fy==null?_.y+=_.vy*=a:(_.y=_.fy,_.vy=0);return t}function p(){for(var y=0,v=e.length,b;y<v;++y){if(b=e[y],b.index=y,b.fx!=null&&(b.x=b.fx),b.fy!=null&&(b.y=b.fy),isNaN(b.x)||isNaN(b.y)){var _=S0e*Math.sqrt(.5+y),E=y*A0e;b.x=_*Math.cos(E),b.y=_*Math.sin(E)}(isNaN(b.vx)||isNaN(b.vy))&&(b.vx=b.vy=0)}}function m(y){return y.initialize&&y.initialize(e,c),y}return p(),t={tick:d,restart:function(){return u.restart(f),t},stop:function(){return u.stop(),t},nodes:function(y){return arguments.length?(e=y,p(),o.forEach(m),t):e},alpha:function(y){return arguments.length?(n=+y,t):n},alphaMin:function(y){return arguments.length?(i=+y,t):i},alphaDecay:function(y){return arguments.length?(r=+y,t):+r},alphaTarget:function(y){return arguments.length?(s=+y,t):s},velocityDecay:function(y){return arguments.length?(a=1-y,t):1-a},randomSource:function(y){return arguments.length?(c=y,o.forEach(m),t):c},force:function(y,v){return arguments.length>1?(v==null?o.delete(y):o.set(y,m(v)),t):o.get(y)},find:function(y,v,b){var _=0,E=e.length,S,A,$,C,M;for(b==null?b=1/0:b*=b,_=0;_<E;++_)C=e[_],S=y-C.x,A=v-C.y,$=S*S+A*A,$<b&&(M=C,b=$);return M},on:function(y,v){return arguments.length>1?(l.on(y,v),t):l.on(y)}}}function k0e(){var e,t,n,i,r=Ai(-30),s,a=1,o=1/0,u=.81;function l(p){var m,y=e.length,v=c3(e,w0e,E0e).visitAfter(f);for(i=p,m=0;m<y;++m)t=e[m],v.visit(d)}function c(){if(e){var p,m=e.length,y;for(s=new Array(m),p=0;p<m;++p)y=e[p],s[y.index]=+r(y,p,e)}}function f(p){var m=0,y,v,b=0,_,E,S;if(p.length){for(_=E=S=0;S<4;++S)(y=p[S])&&(v=Math.abs(y.value))&&(m+=y.value,b+=v,_+=v*y.x,E+=v*y.y);p.x=_/b,p.y=E/b}else{y=p,y.x=y.data.x,y.y=y.data.y;do m+=s[y.data.index];while(y=y.next)}p.value=m}function d(p,m,y,v){if(!p.value)return!0;var b=p.x-t.x,_=p.y-t.y,E=v-m,S=b*b+_*_;if(E*E/u<S)return S<o&&(b===0&&(b=_u(n),S+=b*b),_===0&&(_=_u(n),S+=_*_),S<a&&(S=Math.sqrt(a*S)),t.vx+=b*p.value*i/S,t.vy+=_*p.value*i/S),!0;if(p.length||S>=o)return;(p.data!==t||p.next)&&(b===0&&(b=_u(n),S+=b*b),_===0&&(_=_u(n),S+=_*_),S<a&&(S=Math.sqrt(a*S)));do p.data!==t&&(E=s[p.data.index]*i/S,t.vx+=b*E,t.vy+=_*E);while(p=p.next)}return l.initialize=function(p,m){e=p,n=m,c()},l.strength=function(p){return arguments.length?(r=typeof p=="function"?p:Ai(+p),c(),l):r},l.distanceMin=function(p){return arguments.length?(a=p*p,l):Math.sqrt(a)},l.distanceMax=function(p){return arguments.length?(o=p*p,l):Math.sqrt(o)},l.theta=function(p){return arguments.length?(u=p*p,l):Math.sqrt(u)},l}function $0e(e){var t=Ai(.1),n,i,r;typeof e!="function"&&(e=Ai(e==null?0:+e));function s(o){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vx+=(r[u]-c.x)*i[u]*o}function a(){if(n){var o,u=n.length;for(i=new Array(u),r=new Array(u),o=0;o<u;++o)i[o]=isNaN(r[o]=+e(n[o],o,n))?0:+t(n[o],o,n)}}return s.initialize=function(o){n=o,a()},s.strength=function(o){return arguments.length?(t=typeof o=="function"?o:Ai(+o),a(),s):t},s.x=function(o){return arguments.length?(e=typeof o=="function"?o:Ai(+o),a(),s):e},s}function T0e(e){var t=Ai(.1),n,i,r;typeof e!="function"&&(e=Ai(e==null?0:+e));function s(o){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vy+=(r[u]-c.y)*i[u]*o}function a(){if(n){var o,u=n.length;for(i=new Array(u),r=new Array(u),o=0;o<u;++o)i[o]=isNaN(r[o]=+e(n[o],o,n))?0:+t(n[o],o,n)}}return s.initialize=function(o){n=o,a()},s.strength=function(o){return arguments.length?(t=typeof o=="function"?o:Ai(+o),a(),s):t},s.y=function(o){return arguments.length?(e=typeof o=="function"?o:Ai(+o),a(),s):e},s}const ID={center:qge,collide:u0e,nbody:k0e,link:c0e,x:$0e,y:T0e},kp="forces",ZS=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],O0e=["static","iterations"],gU=["x","y","vx","vy"];function d3(e){H.call(this,null,e)}d3.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30,expr:!0},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:gU}]};ce(d3,H,{transform(e,t){var n=this.value,i=t.changed(t.ADD_REM),r=e.modified(ZS),s=e.iterations||300;if(n?(i&&(t.modifies("index"),n.nodes(t.source)),(r||t.changed(t.MOD))&&mU(n,e,0,t)):(this.value=n=M0e(t.source,e),n.on("tick",F0e(t.dataflow,this)),e.static||(i=!0,n.tick()),t.modifies("index")),r||i||e.modified(O0e)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/s)),e.static)for(n.stop();--s>=0;)n.tick();else if(n.stopped()&&n.restart(),!i)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let o=this._argops,u=0,l=o.length,c;u<l;++u)if(c=o[u],!(c.name!==kp||c.op._argval.force!=="link")){for(var i=c.op._argops,r=0,s=i.length,a;r<s;++r)if(i[r].name==="links"&&(a=i[r].op.source)){n.pulse(a,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(gU)}});function F0e(e,t){return()=>e.touch(t).run()}function M0e(e,t){const n=C0e(e),i=n.stop,r=n.restart;let s=!1;return n.stopped=()=>s,n.restart=()=>(s=!1,r()),n.stop=()=>(s=!0,i()),mU(n,t,!0).on("end",()=>s=!0)}function mU(e,t,n,i){var r=pe(t.forces),s,a,o,u;for(s=0,a=ZS.length;s<a;++s)o=ZS[s],o!==kp&&t.modified(o)&&e[o](t[o]);for(s=0,a=r.length;s<a;++s)u=kp+s,o=n||t.modified(kp,s)?R0e(r[s]):i&&N0e(r[s],i)?e.force(u):null,o&&e.force(u,o);for(a=e.numForces||0;s<a;++s)e.force(kp+s,null);return e.numForces=r.length,e}function N0e(e,t){var n,i;for(n in e)if(Ye(i=e[n])&&t.modified(ui(i)))return 1;return 0}function R0e(e){var t,n;ve(ID,e.force)||K("Unrecognized force: "+e.force),t=ID[e.force]();for(n in e)Ye(t[n])&&I0e(t[n],e[n],e);return t}function I0e(e,t,n){e(Ye(t)?i=>t(i,n):t)}const D0e=Object.freeze(Object.defineProperty({__proto__:null,force:d3},Symbol.toStringTag,{value:"Module"}));function P0e(e,t){return e.parent===t.parent?1:2}function L0e(e){return e.reduce(z0e,0)/e.length}function z0e(e,t){return e+t.x}function B0e(e){return 1+e.reduce(U0e,0)}function U0e(e,t){return Math.max(e,t.y)}function j0e(e){for(var t;t=e.children;)e=t[0];return e}function q0e(e){for(var t;t=e.children;)e=t[t.length-1];return e}function V0e(){var e=P0e,t=1,n=1,i=!1;function r(s){var a,o=0;s.eachAfter(function(d){var p=d.children;p?(d.x=L0e(p),d.y=B0e(p)):(d.x=a?o+=e(d,a):0,d.y=0,a=d)});var u=j0e(s),l=q0e(s),c=u.x-e(u,l)/2,f=l.x+e(l,u)/2;return s.eachAfter(i?function(d){d.x=(d.x-s.x)*t,d.y=(s.y-d.y)*n}:function(d){d.x=(d.x-c)/(f-c)*t,d.y=(1-(s.y?d.y/s.y:1))*n})}return r.separation=function(s){return arguments.length?(e=s,r):e},r.size=function(s){return arguments.length?(i=!1,t=+s[0],n=+s[1],r):i?null:[t,n]},r.nodeSize=function(s){return arguments.length?(i=!0,t=+s[0],n=+s[1],r):i?[t,n]:null},r}function W0e(e){var t=0,n=e.children,i=n&&n.length;if(!i)t=1;else for(;--i>=0;)t+=n[i].value;e.value=t}function G0e(){return this.eachAfter(W0e)}function H0e(e,t){let n=-1;for(const i of this)e.call(t,i,++n,this);return this}function Y0e(e,t){for(var n=this,i=[n],r,s,a=-1;n=i.pop();)if(e.call(t,n,++a,this),r=n.children)for(s=r.length-1;s>=0;--s)i.push(r[s]);return this}function X0e(e,t){for(var n=this,i=[n],r=[],s,a,o,u=-1;n=i.pop();)if(r.push(n),s=n.children)for(a=0,o=s.length;a<o;++a)i.push(s[a]);for(;n=r.pop();)e.call(t,n,++u,this);return this}function K0e(e,t){let n=-1;for(const i of this)if(e.call(t,i,++n,this))return i}function J0e(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,i=t.children,r=i&&i.length;--r>=0;)n+=i[r].value;t.value=n})}function Q0e(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function Z0e(e){for(var t=this,n=eme(t,e),i=[t];t!==n;)t=t.parent,i.push(t);for(var r=i.length;e!==n;)i.splice(r,0,e),e=e.parent;return i}function eme(e,t){if(e===t)return e;var n=e.ancestors(),i=t.ancestors(),r=null;for(e=n.pop(),t=i.pop();e===t;)r=e,e=n.pop(),t=i.pop();return r}function tme(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function nme(){return Array.from(this)}function ime(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function rme(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*sme(){var e=this,t,n=[e],i,r,s;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,i=e.children)for(r=0,s=i.length;r<s;++r)n.push(i[r]);while(n.length)}function p3(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=ume)):t===void 0&&(t=ome);for(var n=new dh(e),i,r=[n],s,a,o,u;i=r.pop();)if((a=t(i.data))&&(u=(a=Array.from(a)).length))for(i.children=a,o=u-1;o>=0;--o)r.push(s=a[o]=new dh(a[o])),s.parent=i,s.depth=i.depth+1;return n.eachBefore(yU)}function ame(){return p3(this).eachBefore(lme)}function ome(e){return e.children}function ume(e){return Array.isArray(e)?e[1]:null}function lme(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function yU(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function dh(e){this.data=e,this.depth=this.height=0,this.parent=null}dh.prototype=p3.prototype={constructor:dh,count:G0e,each:H0e,eachAfter:X0e,eachBefore:Y0e,find:K0e,sum:J0e,sort:Q0e,path:Z0e,ancestors:tme,descendants:nme,leaves:ime,links:rme,copy:ame,[Symbol.iterator]:sme};function L1(e){return e==null?null:vU(e)}function vU(e){if(typeof e!="function")throw new Error;return e}function ql(){return 0}function Sf(e){return function(){return e}}const cme=1664525,fme=1013904223,DD=4294967296;function hme(){let e=1;return()=>(e=(cme*e+fme)%DD)/DD}function dme(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function pme(e,t){let n=e.length,i,r;for(;n;)r=t()*n--|0,i=e[n],e[n]=e[r],e[r]=i;return e}function gme(e,t){for(var n=0,i=(e=pme(Array.from(e),t)).length,r=[],s,a;n<i;)s=e[n],a&&xU(a,s)?++n:(a=yme(r=mme(r,s)),n=0);return a}function mme(e,t){var n,i;if(yw(t,e))return[t];for(n=0;n<e.length;++n)if(Zm(t,e[n])&&yw($p(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(i=n+1;i<e.length;++i)if(Zm($p(e[n],e[i]),t)&&Zm($p(e[n],t),e[i])&&Zm($p(e[i],t),e[n])&&yw(bU(e[n],e[i],t),e))return[e[n],e[i],t];throw new Error}function Zm(e,t){var n=e.r-t.r,i=t.x-e.x,r=t.y-e.y;return n<0||n*n<i*i+r*r}function xU(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function yw(e,t){for(var n=0;n<t.length;++n)if(!xU(e,t[n]))return!1;return!0}function yme(e){switch(e.length){case 1:return vme(e[0]);case 2:return $p(e[0],e[1]);case 3:return bU(e[0],e[1],e[2])}}function vme(e){return{x:e.x,y:e.y,r:e.r}}function $p(e,t){var n=e.x,i=e.y,r=e.r,s=t.x,a=t.y,o=t.r,u=s-n,l=a-i,c=o-r,f=Math.sqrt(u*u+l*l);return{x:(n+s+u/f*c)/2,y:(i+a+l/f*c)/2,r:(f+r+o)/2}}function bU(e,t,n){var i=e.x,r=e.y,s=e.r,a=t.x,o=t.y,u=t.r,l=n.x,c=n.y,f=n.r,d=i-a,p=i-l,m=r-o,y=r-c,v=u-s,b=f-s,_=i*i+r*r-s*s,E=_-a*a-o*o+u*u,S=_-l*l-c*c+f*f,A=p*m-d*y,$=(m*S-y*E)/(A*2)-i,C=(y*v-m*b)/A,M=(p*E-d*S)/(A*2)-r,N=(d*b-p*v)/A,P=C*C+N*N-1,D=2*(s+$*C+M*N),W=$*$+M*M-s*s,q=-(Math.abs(P)>1e-6?(D+Math.sqrt(D*D-4*P*W))/(2*P):W/D);return{x:i+$+C*q,y:r+M+N*q,r:q}}function PD(e,t,n){var i=e.x-t.x,r,s,a=e.y-t.y,o,u,l=i*i+a*a;l?(s=t.r+n.r,s*=s,u=e.r+n.r,u*=u,s>u?(r=(l+u-s)/(2*l),o=Math.sqrt(Math.max(0,u/l-r*r)),n.x=e.x-r*i-o*a,n.y=e.y-r*a+o*i):(r=(l+s-u)/(2*l),o=Math.sqrt(Math.max(0,s/l-r*r)),n.x=t.x+r*i-o*a,n.y=t.y+r*a+o*i)):(n.x=t.x+n.r,n.y=t.y)}function LD(e,t){var n=e.r+t.r-1e-6,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function zD(e){var t=e._,n=e.next._,i=t.r+n.r,r=(t.x*n.r+n.x*t.r)/i,s=(t.y*n.r+n.y*t.r)/i;return r*r+s*s}function e1(e){this._=e,this.next=null,this.previous=null}function xme(e,t){if(!(s=(e=dme(e)).length))return 0;var n,i,r,s,a,o,u,l,c,f,d;if(n=e[0],n.x=0,n.y=0,!(s>1))return n.r;if(i=e[1],n.x=-i.r,i.x=n.r,i.y=0,!(s>2))return n.r+i.r;PD(i,n,r=e[2]),n=new e1(n),i=new e1(i),r=new e1(r),n.next=r.previous=i,i.next=n.previous=r,r.next=i.previous=n;e:for(u=3;u<s;++u){PD(n._,i._,r=e[u]),r=new e1(r),l=i.next,c=n.previous,f=i._.r,d=n._.r;do if(f<=d){if(LD(l._,r._)){i=l,n.next=i,i.previous=n,--u;continue e}f+=l._.r,l=l.next}else{if(LD(c._,r._)){n=c,n.next=i,i.previous=n,--u;continue e}d+=c._.r,c=c.previous}while(l!==c.next);for(r.previous=n,r.next=i,n.next=i.previous=i=r,a=zD(n);(r=r.next)!==i;)(o=zD(r))<a&&(n=r,a=o);i=n.next}for(n=[i._],r=i;(r=r.next)!==i;)n.push(r._);for(r=gme(n,t),u=0;u<s;++u)n=e[u],n.x-=r.x,n.y-=r.y;return r.r}function bme(e){return Math.sqrt(e.value)}function _me(){var e=null,t=1,n=1,i=ql;function r(s){const a=hme();return s.x=t/2,s.y=n/2,e?s.eachBefore(BD(e)).eachAfter(vw(i,.5,a)).eachBefore(UD(1)):s.eachBefore(BD(bme)).eachAfter(vw(ql,1,a)).eachAfter(vw(i,s.r/Math.min(t,n),a)).eachBefore(UD(Math.min(t,n)/(2*s.r))),s}return r.radius=function(s){return arguments.length?(e=L1(s),r):e},r.size=function(s){return arguments.length?(t=+s[0],n=+s[1],r):[t,n]},r.padding=function(s){return arguments.length?(i=typeof s=="function"?s:Sf(+s),r):i},r}function BD(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function vw(e,t,n){return function(i){if(r=i.children){var r,s,a=r.length,o=e(i)*t||0,u;if(o)for(s=0;s<a;++s)r[s].r+=o;if(u=xme(r,n),o)for(s=0;s<a;++s)r[s].r-=o;i.r=u+o}}}function UD(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function _U(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function l0(e,t,n,i,r){for(var s=e.children,a,o=-1,u=s.length,l=e.value&&(i-t)/e.value;++o<u;)a=s[o],a.y0=n,a.y1=r,a.x0=t,a.x1=t+=a.value*l}function wme(){var e=1,t=1,n=0,i=!1;function r(a){var o=a.height+1;return a.x0=a.y0=n,a.x1=e,a.y1=t/o,a.eachBefore(s(t,o)),i&&a.eachBefore(_U),a}function s(a,o){return function(u){u.children&&l0(u,u.x0,a*(u.depth+1)/o,u.x1,a*(u.depth+2)/o);var l=u.x0,c=u.y0,f=u.x1-n,d=u.y1-n;f<l&&(l=f=(l+f)/2),d<c&&(c=d=(c+d)/2),u.x0=l,u.y0=c,u.x1=f,u.y1=d}}return r.round=function(a){return arguments.length?(i=!!a,r):i},r.size=function(a){return arguments.length?(e=+a[0],t=+a[1],r):[e,t]},r.padding=function(a){return arguments.length?(n=+a,r):n},r}var Eme={depth:-1},jD={},xw={};function Sme(e){return e.id}function Ame(e){return e.parentId}function qD(){var e=Sme,t=Ame,n;function i(r){var s=Array.from(r),a=e,o=t,u,l,c,f,d,p,m,y,v=new Map;if(n!=null){const b=s.map((S,A)=>Cme(n(S,A,r))),_=b.map(VD),E=new Set(b).add("");for(const S of _)E.has(S)||(E.add(S),b.push(S),_.push(VD(S)),s.push(xw));a=(S,A)=>b[A],o=(S,A)=>_[A]}for(c=0,u=s.length;c<u;++c)l=s[c],p=s[c]=new dh(l),(m=a(l,c,r))!=null&&(m+="")&&(y=p.id=m,v.set(y,v.has(y)?jD:p)),(m=o(l,c,r))!=null&&(m+="")&&(p.parent=m);for(c=0;c<u;++c)if(p=s[c],m=p.parent){if(d=v.get(m),!d)throw new Error("missing: "+m);if(d===jD)throw new Error("ambiguous: "+m);d.children?d.children.push(p):d.children=[p],p.parent=d}else{if(f)throw new Error("multiple roots");f=p}if(!f)throw new Error("no root");if(n!=null){for(;f.data===xw&&f.children.length===1;)f=f.children[0],--u;for(let b=s.length-1;b>=0&&(p=s[b],p.data===xw);--b)p.data=null}if(f.parent=Eme,f.eachBefore(function(b){b.depth=b.parent.depth+1,--u}).eachBefore(yU),f.parent=null,u>0)throw new Error("cycle");return f}return i.id=function(r){return arguments.length?(e=L1(r),i):e},i.parentId=function(r){return arguments.length?(t=L1(r),i):t},i.path=function(r){return arguments.length?(n=L1(r),i):n},i}function Cme(e){e=`${e}`;let t=e.length;return eA(e,t-1)&&!eA(e,t-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function VD(e){let t=e.length;if(t<2)return"";for(;--t>1&&!eA(e,t););return e.slice(0,t)}function eA(e,t){if(e[t]==="/"){let n=0;for(;t>0&&e[--t]==="\\";)++n;if(!(n&1))return!0}return!1}function kme(e,t){return e.parent===t.parent?1:2}function bw(e){var t=e.children;return t?t[0]:e.t}function _w(e){var t=e.children;return t?t[t.length-1]:e.t}function $me(e,t,n){var i=n/(t.i-e.i);t.c-=i,t.s+=n,e.c+=i,t.z+=n,t.m+=n}function Tme(e){for(var t=0,n=0,i=e.children,r=i.length,s;--r>=0;)s=i[r],s.z+=t,s.m+=t,t+=s.s+(n+=s.c)}function Ome(e,t,n){return e.a.parent===t.parent?e.a:n}function z1(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}z1.prototype=Object.create(dh.prototype);function Fme(e){for(var t=new z1(e,0),n,i=[t],r,s,a,o;n=i.pop();)if(s=n._.children)for(n.children=new Array(o=s.length),a=o-1;a>=0;--a)i.push(r=n.children[a]=new z1(s[a],a)),r.parent=n;return(t.parent=new z1(null,0)).children=[t],t}function Mme(){var e=kme,t=1,n=1,i=null;function r(l){var c=Fme(l);if(c.eachAfter(s),c.parent.m=-c.z,c.eachBefore(a),i)l.eachBefore(u);else{var f=l,d=l,p=l;l.eachBefore(function(_){_.x<f.x&&(f=_),_.x>d.x&&(d=_),_.depth>p.depth&&(p=_)});var m=f===d?1:e(f,d)/2,y=m-f.x,v=t/(d.x+m+y),b=n/(p.depth||1);l.eachBefore(function(_){_.x=(_.x+y)*v,_.y=_.depth*b})}return l}function s(l){var c=l.children,f=l.parent.children,d=l.i?f[l.i-1]:null;if(c){Tme(l);var p=(c[0].z+c[c.length-1].z)/2;d?(l.z=d.z+e(l._,d._),l.m=l.z-p):l.z=p}else d&&(l.z=d.z+e(l._,d._));l.parent.A=o(l,d,l.parent.A||f[0])}function a(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function o(l,c,f){if(c){for(var d=l,p=l,m=c,y=d.parent.children[0],v=d.m,b=p.m,_=m.m,E=y.m,S;m=_w(m),d=bw(d),m&&d;)y=bw(y),p=_w(p),p.a=l,S=m.z+_-d.z-v+e(m._,d._),S>0&&($me(Ome(m,l,f),l,S),v+=S,b+=S),_+=m.m,v+=d.m,E+=y.m,b+=p.m;m&&!_w(p)&&(p.t=m,p.m+=_-b),d&&!bw(y)&&(y.t=d,y.m+=v-E,f=l)}return f}function u(l){l.x*=t,l.y=l.depth*n}return r.separation=function(l){return arguments.length?(e=l,r):e},r.size=function(l){return arguments.length?(i=!1,t=+l[0],n=+l[1],r):i?null:[t,n]},r.nodeSize=function(l){return arguments.length?(i=!0,t=+l[0],n=+l[1],r):i?[t,n]:null},r}function zx(e,t,n,i,r){for(var s=e.children,a,o=-1,u=s.length,l=e.value&&(r-n)/e.value;++o<u;)a=s[o],a.x0=t,a.x1=i,a.y0=n,a.y1=n+=a.value*l}var wU=(1+Math.sqrt(5))/2;function EU(e,t,n,i,r,s){for(var a=[],o=t.children,u,l,c=0,f=0,d=o.length,p,m,y=t.value,v,b,_,E,S,A,$;c<d;){p=r-n,m=s-i;do v=o[f++].value;while(!v&&f<d);for(b=_=v,A=Math.max(m/p,p/m)/(y*e),$=v*v*A,S=Math.max(_/$,$/b);f<d;++f){if(v+=l=o[f].value,l<b&&(b=l),l>_&&(_=l),$=v*v*A,E=Math.max(_/$,$/b),E>S){v-=l;break}S=E}a.push(u={value:v,dice:p<m,children:o.slice(c,f)}),u.dice?l0(u,n,i,r,y?i+=m*v/y:s):zx(u,n,i,y?n+=p*v/y:r,s),y-=v,c=f}return a}const SU=function e(t){function n(i,r,s,a,o){EU(t,i,r,s,a,o)}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(wU);function Nme(){var e=SU,t=!1,n=1,i=1,r=[0],s=ql,a=ql,o=ql,u=ql,l=ql;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=i,d.eachBefore(f),r=[0],t&&d.eachBefore(_U),d}function f(d){var p=r[d.depth],m=d.x0+p,y=d.y0+p,v=d.x1-p,b=d.y1-p;v<m&&(m=v=(m+v)/2),b<y&&(y=b=(y+b)/2),d.x0=m,d.y0=y,d.x1=v,d.y1=b,d.children&&(p=r[d.depth+1]=s(d)/2,m+=l(d)-p,y+=a(d)-p,v-=o(d)-p,b-=u(d)-p,v<m&&(m=v=(m+v)/2),b<y&&(y=b=(y+b)/2),e(d,m,y,v,b))}return c.round=function(d){return arguments.length?(t=!!d,c):t},c.size=function(d){return arguments.length?(n=+d[0],i=+d[1],c):[n,i]},c.tile=function(d){return arguments.length?(e=vU(d),c):e},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(s=typeof d=="function"?d:Sf(+d),c):s},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(a=typeof d=="function"?d:Sf(+d),c):a},c.paddingRight=function(d){return arguments.length?(o=typeof d=="function"?d:Sf(+d),c):o},c.paddingBottom=function(d){return arguments.length?(u=typeof d=="function"?d:Sf(+d),c):u},c.paddingLeft=function(d){return arguments.length?(l=typeof d=="function"?d:Sf(+d),c):l},c}function Rme(e,t,n,i,r){var s=e.children,a,o=s.length,u,l=new Array(o+1);for(l[0]=u=a=0;a<o;++a)l[a+1]=u+=s[a].value;c(0,o,e.value,t,n,i,r);function c(f,d,p,m,y,v,b){if(f>=d-1){var _=s[f];_.x0=m,_.y0=y,_.x1=v,_.y1=b;return}for(var E=l[f],S=p/2+E,A=f+1,$=d-1;A<$;){var C=A+$>>>1;l[C]<S?A=C+1:$=C}S-l[A-1]<l[A]-S&&f+1<A&&--A;var M=l[A]-E,N=p-M;if(v-m>b-y){var P=p?(m*N+v*M)/p:v;c(f,A,M,m,y,P,b),c(A,d,N,P,y,v,b)}else{var D=p?(y*N+b*M)/p:b;c(f,A,M,m,y,v,D),c(A,d,N,m,D,v,b)}}}function Ime(e,t,n,i,r){(e.depth&1?zx:l0)(e,t,n,i,r)}const Dme=function e(t){function n(i,r,s,a,o){if((u=i._squarify)&&u.ratio===t)for(var u,l,c,f,d=-1,p,m=u.length,y=i.value;++d<m;){for(l=u[d],c=l.children,f=l.value=0,p=c.length;f<p;++f)l.value+=c[f].value;l.dice?l0(l,r,s,a,y?s+=(o-s)*l.value/y:o):zx(l,r,s,y?r+=(a-r)*l.value/y:a,o),y-=l.value}else i._squarify=u=EU(t,i,r,s,a,o),u.ratio=t}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(wU);function tA(e,t,n){const i={};return e.each(r=>{const s=r.data;n(s)&&(i[t(s)]=r)}),e.lookup=i,e}function g3(e){H.call(this,null,e)}g3.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const Pme=e=>e.values;ce(g3,H,{transform(e,t){t.source||K("Nest transform requires an upstream data source.");var n=e.generate,i=e.modified(),r=t.clone(),s=this.value;return(!s||i||t.changed())&&(s&&s.each(a=>{a.children&&Zv(a.data)&&r.rem.push(a.data)}),this.value=s=p3({values:pe(e.keys).reduce((a,o)=>(a.key(o),a),Lme()).entries(r.source)},Pme),n&&s.each(a=>{a.children&&(a=yt(a.data),r.add.push(a),r.source.push(a))}),tA(s,$e,$e)),r.source.root=s,r}});function Lme(){const e=[],t={entries:r=>i(n(r,0),0),key:r=>(e.push(r),t)};function n(r,s){if(s>=e.length)return r;const a=r.length,o=e[s++],u={},l={};let c=-1,f,d,p;for(;++c<a;)f=o(d=r[c])+"",(p=u[f])?p.push(d):u[f]=[d];for(f in u)l[f]=n(u[f],s);return l}function i(r,s){if(++s>e.length)return r;const a=[];for(const o in r)a.push({key:o,values:i(r[o],s)});return a}return t}function Bo(e){H.call(this,null,e)}const zme=(e,t)=>e.parent===t.parent?1:2;ce(Bo,H,{transform(e,t){(!t.source||!t.source.root)&&K(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),i=this.fields,r=t.source.root,s=e.as||i;e.field?r.sum(e.field):r.count(),e.sort&&r.sort(Tc(e.sort,a=>a.data)),Bme(n,this.params,e),n.separation&&n.separation(e.separation!==!1?zme:Mh);try{this.value=n(r)}catch(a){K(a)}return r.each(a=>Ume(a,i,s)),t.reflow(e.modified()).modifies(s).modifies("leaf")}});function Bme(e,t,n){for(let i,r=0,s=t.length;r<s;++r)i=t[r],i in n&&e[i](n[i])}function Ume(e,t,n){const i=e.data,r=t.length-1;for(let s=0;s<r;++s)i[n[s]]=e[t[s]];i[n[r]]=e.children?e.children.length:0}const nA=["x","y","r","depth","children"];function m3(e){Bo.call(this,e)}m3.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:nA.length,default:nA}]};ce(m3,Bo,{layout:_me,params:["radius","size","padding"],fields:nA});const iA=["x0","y0","x1","y1","depth","children"];function y3(e){Bo.call(this,e)}y3.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:iA.length,default:iA}]};ce(y3,Bo,{layout:wme,params:["size","round","padding"],fields:iA});function v3(e){H.call(this,null,e)}v3.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};ce(v3,H,{transform(e,t){t.source||K("Stratify transform requires an upstream data source.");let n=this.value;const i=e.modified(),r=t.fork(t.ALL).materialize(t.SOURCE),s=!n||i||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return r.source=r.source.slice(),s&&(n=r.source.length?tA(qD().id(e.key).parentId(e.parentKey)(r.source),e.key,Xr):tA(qD()([{}]),e.key,e.key)),r.source.root=this.value=n,r}});const WD={tidy:Mme,cluster:V0e},rA=["x","y","depth","children"];function x3(e){Bo.call(this,e)}x3.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:rA.length,default:rA}]};ce(x3,Bo,{layout(e){const t=e||"tidy";if(ve(WD,t))return WD[t]();K("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:rA});function b3(e){H.call(this,[],e)}b3.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};ce(b3,H,{transform(e,t){const n=this.value,i=t.source&&t.source.root,r=t.fork(t.NO_SOURCE),s={};return i||K("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(r.rem=n,t.visit(t.SOURCE,a=>s[$e(a)]=1),i.each(a=>{const o=a.data,u=a.parent&&a.parent.data;u&&s[$e(o)]&&s[$e(u)]&&r.add.push(yt({source:u,target:o}))}),this.value=r.add):t.changed(t.MOD)&&(t.visit(t.MOD,a=>s[$e(a)]=1),n.forEach(a=>{(s[$e(a.source)]||s[$e(a.target)])&&r.mod.push(a)})),r}});const GD={binary:Rme,dice:l0,slice:zx,slicedice:Ime,squarify:SU,resquarify:Dme},sA=["x0","y0","x1","y1","depth","children"];function _3(e){Bo.call(this,e)}_3.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:sA.length,default:sA}]};ce(_3,Bo,{layout(){const e=Nme();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{ve(GD,t)?e.tile(GD[t]):K("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:sA});const jme=Object.freeze(Object.defineProperty({__proto__:null,nest:g3,pack:m3,partition:y3,stratify:v3,tree:x3,treelinks:b3,treemap:_3},Symbol.toStringTag,{value:"Module"})),ww=4278190080;function qme(e,t){const n=e.bitmap();return(t||[]).forEach(i=>n.set(e(i.boundary[0]),e(i.boundary[3]))),[n,void 0]}function Vme(e,t,n,i,r){const s=e.width,a=e.height,o=i||r,u=$u(s,a).getContext("2d"),l=$u(s,a).getContext("2d"),c=o&&$u(s,a).getContext("2d");n.forEach(M=>B1(u,M,!1)),B1(l,t,!1),o&&B1(c,t,!0);const f=Ew(u,s,a),d=Ew(l,s,a),p=o&&Ew(c,s,a),m=e.bitmap(),y=o&&e.bitmap();let v,b,_,E,S,A,$,C;for(b=0;b<a;++b)for(v=0;v<s;++v)S=b*s+v,A=f[S]&ww,C=d[S]&ww,$=o&&p[S]&ww,(A||$||C)&&(_=e(v),E=e(b),!r&&(A||C)&&m.set(_,E),o&&(A||$)&&y.set(_,E));return[m,y]}function Ew(e,t,n){return new Uint32Array(e.getImageData(0,0,t,n).data.buffer)}function B1(e,t,n){if(!t.length)return;const i=t[0].mark.marktype;i==="group"?t.forEach(r=>{r.items.forEach(s=>B1(e,s.items,n))}):wr[i].draw(e,{items:n?t.map(Wme):t})}function Wme(e){const t=ex(e,{});return t.stroke&&t.strokeOpacity!==0||t.fill&&t.fillOpacity!==0?{...t,strokeOpacity:1,stroke:"#000",fillOpacity:0}:t}const no=5,yi=31,gg=32,hu=new Uint32Array(gg+1),xs=new Uint32Array(gg+1);xs[0]=0;hu[0]=~xs[0];for(let e=1;e<=gg;++e)xs[e]=xs[e-1]<<1|1,hu[e]=~xs[e];function Gme(e,t){const n=new Uint32Array(~~((e*t+gg)/gg));function i(s,a){n[s]|=a}function r(s,a){n[s]&=a}return{array:n,get:(s,a)=>{const o=a*e+s;return n[o>>>no]&1<<(o&yi)},set:(s,a)=>{const o=a*e+s;i(o>>>no,1<<(o&yi))},clear:(s,a)=>{const o=a*e+s;r(o>>>no,~(1<<(o&yi)))},getRange:(s,a,o,u)=>{let l=u,c,f,d,p;for(;l>=a;--l)if(c=l*e+s,f=l*e+o,d=c>>>no,p=f>>>no,d===p){if(n[d]&hu[c&yi]&xs[(f&yi)+1])return!0}else{if(n[d]&hu[c&yi]||n[p]&xs[(f&yi)+1])return!0;for(let m=d+1;m<p;++m)if(n[m])return!0}return!1},setRange:(s,a,o,u)=>{let l,c,f,d,p;for(;a<=u;++a)if(l=a*e+s,c=a*e+o,f=l>>>no,d=c>>>no,f===d)i(f,hu[l&yi]&xs[(c&yi)+1]);else for(i(f,hu[l&yi]),i(d,xs[(c&yi)+1]),p=f+1;p<d;++p)i(p,4294967295)},clearRange:(s,a,o,u)=>{let l,c,f,d,p;for(;a<=u;++a)if(l=a*e+s,c=a*e+o,f=l>>>no,d=c>>>no,f===d)r(f,xs[l&yi]|hu[(c&yi)+1]);else for(r(f,xs[l&yi]),r(d,hu[(c&yi)+1]),p=f+1;p<d;++p)r(p,0)},outOfBounds:(s,a,o,u)=>s<0||a<0||u>=t||o>=e}}function Hme(e,t,n){const i=Math.max(1,Math.sqrt(e*t/1e6)),r=~~((e+2*n+i)/i),s=~~((t+2*n+i)/i),a=o=>~~((o+n)/i);return a.invert=o=>o*i-n,a.bitmap=()=>Gme(r,s),a.ratio=i,a.padding=n,a.width=e,a.height=t,a}function Yme(e,t,n,i){const r=e.width,s=e.height;return function(a){const o=a.datum.datum.items[i].items,u=o.length,l=a.datum.fontSize,c=yr.width(a.datum,a.datum.text);let f=0,d,p,m,y,v,b,_;for(let E=0;E<u;++E)d=o[E].x,m=o[E].y,p=o[E].x2===void 0?d:o[E].x2,y=o[E].y2===void 0?m:o[E].y2,v=(d+p)/2,b=(m+y)/2,_=Math.abs(p-d+y-m),_>=f&&(f=_,a.x=v,a.y=b);return v=c/2,b=l/2,d=a.x-v,p=a.x+v,m=a.y-b,y=a.y+b,a.align="center",d<0&&p<=r?a.align="left":0<=d&&r<p&&(a.align="right"),a.baseline="middle",m<0&&y<=s?a.baseline="top":0<=m&&s<y&&(a.baseline="bottom"),!0}}function av(e,t,n,i,r,s){let a=n/2;return e-a<0||e+a>r||t-(a=i/2)<0||t+a>s}function wu(e,t,n,i,r,s,a,o){const u=r*s/(i*2),l=e(t-u),c=e(t+u),f=e(n-(s=s/2)),d=e(n+s);return a.outOfBounds(l,f,c,d)||a.getRange(l,f,c,d)||o&&o.getRange(l,f,c,d)}function Xme(e,t,n,i){const r=e.width,s=e.height,a=t[0],o=t[1];function u(l,c,f,d,p){const m=e.invert(l),y=e.invert(c);let v=f,b=s,_;if(!av(m,y,d,p,r,s)&&!wu(e,m,y,p,d,v,a,o)&&!wu(e,m,y,p,d,p,a,null)){for(;b-v>=1;)_=(v+b)/2,wu(e,m,y,p,d,_,a,o)?b=_:v=_;if(v>f)return[m,y,v,!0]}}return function(l){const c=l.datum.datum.items[i].items,f=c.length,d=l.datum.fontSize,p=yr.width(l.datum,l.datum.text);let m=n?d:0,y=!1,v=!1,b=0,_,E,S,A,$,C,M,N,P,D,W,q,z,R,U,G,Z;for(let J=0;J<f;++J){for(_=c[J].x,S=c[J].y,E=c[J].x2===void 0?_:c[J].x2,A=c[J].y2===void 0?S:c[J].y2,_>E&&(Z=_,_=E,E=Z),S>A&&(Z=S,S=A,A=Z),P=e(_),W=e(E),D=~~((P+W)/2),q=e(S),R=e(A),z=~~((q+R)/2),M=D;M>=P;--M)for(N=z;N>=q;--N)G=u(M,N,m,p,d),G&&([l.x,l.y,m,y]=G);for(M=D;M<=W;++M)for(N=z;N<=R;++N)G=u(M,N,m,p,d),G&&([l.x,l.y,m,y]=G);!y&&!n&&(U=Math.abs(E-_+A-S),$=(_+E)/2,C=(S+A)/2,U>=b&&!av($,C,p,d,r,s)&&!wu(e,$,C,d,p,d,a,null)&&(b=U,l.x=$,l.y=C,v=!0))}return y||v?($=p/2,C=d/2,a.setRange(e(l.x-$),e(l.y-C),e(l.x+$),e(l.y+C)),l.align="center",l.baseline="middle",!0):!1}}const Kme=[-1,-1,1,1],Jme=[-1,1,-1,1];function Qme(e,t,n,i){const r=e.width,s=e.height,a=t[0],o=t[1],u=e.bitmap();return function(l){const c=l.datum.datum.items[i].items,f=c.length,d=l.datum.fontSize,p=yr.width(l.datum,l.datum.text),m=[];let y=n?d:0,v=!1,b=!1,_=0,E,S,A,$,C,M,N,P,D,W,q,z;for(let R=0;R<f;++R){for(E=c[R].x,A=c[R].y,S=c[R].x2===void 0?E:c[R].x2,$=c[R].y2===void 0?A:c[R].y2,m.push([e((E+S)/2),e((A+$)/2)]);m.length;)if([N,P]=m.pop(),!(a.get(N,P)||o.get(N,P)||u.get(N,P))){u.set(N,P);for(let U=0;U<4;++U)C=N+Kme[U],M=P+Jme[U],u.outOfBounds(C,M,C,M)||m.push([C,M]);if(C=e.invert(N),M=e.invert(P),D=y,W=s,!av(C,M,p,d,r,s)&&!wu(e,C,M,d,p,D,a,o)&&!wu(e,C,M,d,p,d,a,null)){for(;W-D>=1;)q=(D+W)/2,wu(e,C,M,d,p,q,a,o)?W=q:D=q;D>y&&(l.x=C,l.y=M,y=D,v=!0)}}!v&&!n&&(z=Math.abs(S-E+$-A),C=(E+S)/2,M=(A+$)/2,z>=_&&!av(C,M,p,d,r,s)&&!wu(e,C,M,d,p,d,a,null)&&(_=z,l.x=C,l.y=M,b=!0))}return v||b?(C=p/2,M=d/2,a.setRange(e(l.x-C),e(l.y-M),e(l.x+C),e(l.y+M)),l.align="center",l.baseline="middle",!0):!1}}const Zme=["right","center","left"],e1e=["bottom","middle","top"];function t1e(e,t,n,i){const r=e.width,s=e.height,a=t[0],o=t[1],u=i.length;return function(l){const c=l.boundary,f=l.datum.fontSize;if(c[2]<0||c[5]<0||c[0]>r||c[3]>s)return!1;let d=l.textWidth??0,p,m,y,v,b,_,E,S,A,$,C,M,N,P,D;for(let W=0;W<u;++W){if(p=(n[W]&3)-1,m=(n[W]>>>2&3)-1,y=p===0&&m===0||i[W]<0,v=p&&m?Math.SQRT1_2:1,b=i[W]<0?-1:1,_=c[1+p]+i[W]*p*v,C=c[4+m]+b*f*m/2+i[W]*m*v,S=C-f/2,A=C+f/2,M=e(_),P=e(S),D=e(A),!d)if(HD(M,M,P,D,a,o,_,_,S,A,c,y))d=yr.width(l.datum,l.datum.text);else continue;if($=_+b*d*p/2,_=$-d/2,E=$+d/2,M=e(_),N=e(E),HD(M,N,P,D,a,o,_,E,S,A,c,y))return l.x=p?p*b<0?E:_:$,l.y=m?m*b<0?A:S:C,l.align=Zme[p*b+1],l.baseline=e1e[m*b+1],a.setRange(M,P,N,D),!0}return!1}}function HD(e,t,n,i,r,s,a,o,u,l,c,f){return!(r.outOfBounds(e,n,t,i)||(f&&s||r).getRange(e,n,t,i))}const Sw=0,Aw=4,Cw=8,kw=0,$w=1,Tw=2,n1e={"top-left":Sw+kw,top:Sw+$w,"top-right":Sw+Tw,left:Aw+kw,middle:Aw+$w,right:Aw+Tw,"bottom-left":Cw+kw,bottom:Cw+$w,"bottom-right":Cw+Tw},i1e={naive:Yme,"reduced-search":Xme,floodfill:Qme};function r1e(e,t,n,i,r,s,a,o,u,l,c){if(!e.length)return e;const f=Math.max(i.length,r.length),d=s1e(i,f),p=a1e(r,f),m=o1e(e[0].datum),y=m==="group"&&e[0].datum.items[u].marktype,v=y==="area",b=u1e(m,y,o,u),_=l===null||l===1/0,E=v&&c==="naive";let S=-1,A=-1;const $=e.map(P=>{const D=_?yr.width(P,P.text):void 0;return S=Math.max(S,D),A=Math.max(A,P.fontSize),{datum:P,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:b(P),textWidth:D}});l=l===null||l===1/0?Math.max(S,A)+Math.max(...i):l;const C=Hme(t[0],t[1],l);let M;if(!E){n&&$.sort((W,q)=>n(W.datum,q.datum));let P=!1;for(let W=0;W<p.length&&!P;++W)P=p[W]===5||d[W]<0;const D=(m&&a||v)&&e.map(W=>W.datum);M=s.length||D?Vme(C,D||[],s,P,v):qme(C,a&&$)}const N=v?i1e[c](C,M,a,u):t1e(C,M,p,d);return $.forEach(P=>P.opacity=+N(P)),$}function s1e(e,t){const n=new Float64Array(t),i=e.length;for(let r=0;r<i;++r)n[r]=e[r]||0;for(let r=i;r<t;++r)n[r]=n[i-1];return n}function a1e(e,t){const n=new Int8Array(t),i=e.length;for(let r=0;r<i;++r)n[r]|=n1e[e[r]];for(let r=i;r<t;++r)n[r]=n[i-1];return n}function o1e(e){return e&&e.mark&&e.mark.marktype}function u1e(e,t,n,i){const r=s=>[s.x,s.x,s.x,s.y,s.y,s.y];return e?e==="line"||e==="area"?s=>r(s.datum):t==="line"?s=>{const a=s.datum.items[i].items;return r(a.length?a[n==="start"?0:a.length-1]:{x:NaN,y:NaN})}:s=>{const a=s.datum.bounds;return[a.x1,(a.x1+a.x2)/2,a.x2,a.y1,(a.y1+a.y2)/2,a.y2]}:r}const aA=["x","y","opacity","align","baseline"],AU=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function w3(e){H.call(this,null,e)}w3.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:AU},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:aA.length,default:aA}]};ce(w3,H,{transform(e,t){function n(s){const a=e[s];return Ye(a)&&t.modified(a.fields)}const i=e.modified();if(!(i||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&K("Size parameter should be specified as a [width, height] array.");const r=e.as||aA;return r1e(t.materialize(t.SOURCE).source||[],e.size,e.sort,pe(e.offset==null?1:e.offset),pe(e.anchor||AU),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding===void 0?0:e.padding,e.method||"naive").forEach(s=>{const a=s.datum;a[r[0]]=s.x,a[r[1]]=s.y,a[r[2]]=s.opacity,a[r[3]]=s.align,a[r[4]]=s.baseline}),t.reflow(i).modifies(r)}});const l1e=Object.freeze(Object.defineProperty({__proto__:null,label:w3},Symbol.toStringTag,{value:"Module"}));function CU(e,t){var n=[],i=function(c){return c(o)},r,s,a,o,u,l;if(t==null)n.push(e);else for(r={},s=0,a=e.length;s<a;++s)o=e[s],u=t.map(i),l=r[u],l||(r[u]=l=[],l.dims=u,n.push(l)),l.push(o);return n}function E3(e){H.call(this,null,e)}E3.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};ce(E3,H,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=CU(i,e.groupby),s=(e.groupby||[]).map(en),a=s.length,o=e.as||[en(e.x),en(e.y)],u=[];r.forEach(l=>{N8(l,e.x,e.y,e.bandwidth||.3).forEach(c=>{const f={};for(let d=0;d<a;++d)f[s[d]]=l.dims[d];f[o[0]]=c[0],f[o[1]]=c[1],u.push(yt(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});const oA={constant:rk,linear:sk,log:T8,exp:O8,pow:F8,quad:ak,poly:M8},c1e=(e,t)=>e==="poly"?t:e==="quad"?2:1;function S3(e){H.call(this,null,e)}S3.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(oA)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};ce(S3,H,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=CU(i,e.groupby),s=(e.groupby||[]).map(en),a=e.method||"linear",o=e.order==null?3:e.order,u=c1e(a,o),l=e.as||[en(e.x),en(e.y)],c=oA[a],f=[];let d=e.extent;ve(oA,a)||K("Invalid regression method: "+a),d!=null&&a==="log"&&d[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),r.forEach(p=>{if(p.length<=u){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const y=c(p,e.x,e.y,o);if(e.params){f.push(yt({keys:p.dims,coef:y.coef,rSquared:y.rSquared}));return}const v=d||xa(p,e.x),b=_=>{const E={};for(let S=0;S<s.length;++S)E[s[S]]=p.dims[S];E[l[0]]=_[0],E[l[1]]=_[1],f.push(yt(E))};a==="linear"||a==="constant"?v.forEach(_=>b([_,y.predict(_)])):ox(y.predict,v,25,200).forEach(b)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});const f1e=Object.freeze(Object.defineProperty({__proto__:null,loess:E3,regression:S3},Symbol.toStringTag,{value:"Module"})),wo=11102230246251565e-32,ti=134217729,h1e=(3+8*wo)*wo;function Ow(e,t,n,i,r){let s,a,o,u,l=t[0],c=i[0],f=0,d=0;c>l==c>-l?(s=l,l=t[++f]):(s=c,c=i[++d]);let p=0;if(f<e&&d<n)for(c>l==c>-l?(a=l+s,o=s-(a-l),l=t[++f]):(a=c+s,o=s-(a-c),c=i[++d]),s=a,o!==0&&(r[p++]=o);f<e&&d<n;)c>l==c>-l?(a=s+l,u=a-s,o=s-(a-u)+(l-u),l=t[++f]):(a=s+c,u=a-s,o=s-(a-u)+(c-u),c=i[++d]),s=a,o!==0&&(r[p++]=o);for(;f<e;)a=s+l,u=a-s,o=s-(a-u)+(l-u),l=t[++f],s=a,o!==0&&(r[p++]=o);for(;d<n;)a=s+c,u=a-s,o=s-(a-u)+(c-u),c=i[++d],s=a,o!==0&&(r[p++]=o);return(s!==0||p===0)&&(r[p++]=s),p}function d1e(e,t){let n=t[0];for(let i=1;i<e;i++)n+=t[i];return n}function c0(e){return new Float64Array(e)}const p1e=(3+16*wo)*wo,g1e=(2+12*wo)*wo,m1e=(9+64*wo)*wo*wo,mf=c0(4),YD=c0(8),XD=c0(12),KD=c0(16),vi=c0(4);function y1e(e,t,n,i,r,s,a){let o,u,l,c,f,d,p,m,y,v,b,_,E,S,A,$,C,M;const N=e-r,P=n-r,D=t-s,W=i-s;S=N*W,d=ti*N,p=d-(d-N),m=N-p,d=ti*W,y=d-(d-W),v=W-y,A=m*v-(S-p*y-m*y-p*v),$=D*P,d=ti*D,p=d-(d-D),m=D-p,d=ti*P,y=d-(d-P),v=P-y,C=m*v-($-p*y-m*y-p*v),b=A-C,f=A-b,mf[0]=A-(b+f)+(f-C),_=S+b,f=_-S,E=S-(_-f)+(b-f),b=E-$,f=E-b,mf[1]=E-(b+f)+(f-$),M=_+b,f=M-_,mf[2]=_-(M-f)+(b-f),mf[3]=M;let q=d1e(4,mf),z=g1e*a;if(q>=z||-q>=z||(f=e-N,o=e-(N+f)+(f-r),f=n-P,l=n-(P+f)+(f-r),f=t-D,u=t-(D+f)+(f-s),f=i-W,c=i-(W+f)+(f-s),o===0&&u===0&&l===0&&c===0)||(z=m1e*a+h1e*Math.abs(q),q+=N*c+W*o-(D*l+P*u),q>=z||-q>=z))return q;S=o*W,d=ti*o,p=d-(d-o),m=o-p,d=ti*W,y=d-(d-W),v=W-y,A=m*v-(S-p*y-m*y-p*v),$=u*P,d=ti*u,p=d-(d-u),m=u-p,d=ti*P,y=d-(d-P),v=P-y,C=m*v-($-p*y-m*y-p*v),b=A-C,f=A-b,vi[0]=A-(b+f)+(f-C),_=S+b,f=_-S,E=S-(_-f)+(b-f),b=E-$,f=E-b,vi[1]=E-(b+f)+(f-$),M=_+b,f=M-_,vi[2]=_-(M-f)+(b-f),vi[3]=M;const R=Ow(4,mf,4,vi,YD);S=N*c,d=ti*N,p=d-(d-N),m=N-p,d=ti*c,y=d-(d-c),v=c-y,A=m*v-(S-p*y-m*y-p*v),$=D*l,d=ti*D,p=d-(d-D),m=D-p,d=ti*l,y=d-(d-l),v=l-y,C=m*v-($-p*y-m*y-p*v),b=A-C,f=A-b,vi[0]=A-(b+f)+(f-C),_=S+b,f=_-S,E=S-(_-f)+(b-f),b=E-$,f=E-b,vi[1]=E-(b+f)+(f-$),M=_+b,f=M-_,vi[2]=_-(M-f)+(b-f),vi[3]=M;const U=Ow(R,YD,4,vi,XD);S=o*c,d=ti*o,p=d-(d-o),m=o-p,d=ti*c,y=d-(d-c),v=c-y,A=m*v-(S-p*y-m*y-p*v),$=u*l,d=ti*u,p=d-(d-u),m=u-p,d=ti*l,y=d-(d-l),v=l-y,C=m*v-($-p*y-m*y-p*v),b=A-C,f=A-b,vi[0]=A-(b+f)+(f-C),_=S+b,f=_-S,E=S-(_-f)+(b-f),b=E-$,f=E-b,vi[1]=E-(b+f)+(f-$),M=_+b,f=M-_,vi[2]=_-(M-f)+(b-f),vi[3]=M;const G=Ow(U,XD,4,vi,KD);return KD[G-1]}function t1(e,t,n,i,r,s){const a=(t-s)*(n-r),o=(e-r)*(i-s),u=a-o,l=Math.abs(a+o);return Math.abs(u)>=p1e*l?u:-y1e(e,t,n,i,r,s,l)}const JD=Math.pow(2,-52),n1=new Uint32Array(512);class ov{static from(t,n=w1e,i=E1e){const r=t.length,s=new Float64Array(r*2);for(let a=0;a<r;a++){const o=t[a];s[2*a]=n(o),s[2*a+1]=i(o)}return new ov(s)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const i=Math.max(2*n-5,0);this._triangles=new Uint32Array(i*3),this._halfedges=new Int32Array(i*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:i,_hullTri:r,_hullHash:s}=this,a=t.length>>1;let o=1/0,u=1/0,l=-1/0,c=-1/0;for(let N=0;N<a;N++){const P=t[2*N],D=t[2*N+1];P<o&&(o=P),D<u&&(u=D),P>l&&(l=P),D>c&&(c=D),this._ids[N]=N}const f=(o+l)/2,d=(u+c)/2;let p,m,y;for(let N=0,P=1/0;N<a;N++){const D=Fw(f,d,t[2*N],t[2*N+1]);D<P&&(p=N,P=D)}const v=t[2*p],b=t[2*p+1];for(let N=0,P=1/0;N<a;N++){if(N===p)continue;const D=Fw(v,b,t[2*N],t[2*N+1]);D<P&&D>0&&(m=N,P=D)}let _=t[2*m],E=t[2*m+1],S=1/0;for(let N=0;N<a;N++){if(N===p||N===m)continue;const P=b1e(v,b,_,E,t[2*N],t[2*N+1]);P<S&&(y=N,S=P)}let A=t[2*y],$=t[2*y+1];if(S===1/0){for(let D=0;D<a;D++)this._dists[D]=t[2*D]-t[0]||t[2*D+1]-t[1];Mf(this._ids,this._dists,0,a-1);const N=new Uint32Array(a);let P=0;for(let D=0,W=-1/0;D<a;D++){const q=this._ids[D],z=this._dists[q];z>W&&(N[P++]=q,W=z)}this.hull=N.subarray(0,P),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(t1(v,b,_,E,A,$)<0){const N=m,P=_,D=E;m=y,_=A,E=$,y=N,A=P,$=D}const C=_1e(v,b,_,E,A,$);this._cx=C.x,this._cy=C.y;for(let N=0;N<a;N++)this._dists[N]=Fw(t[2*N],t[2*N+1],C.x,C.y);Mf(this._ids,this._dists,0,a-1),this._hullStart=p;let M=3;i[p]=n[y]=m,i[m]=n[p]=y,i[y]=n[m]=p,r[p]=0,r[m]=1,r[y]=2,s.fill(-1),s[this._hashKey(v,b)]=p,s[this._hashKey(_,E)]=m,s[this._hashKey(A,$)]=y,this.trianglesLen=0,this._addTriangle(p,m,y,-1,-1,-1);for(let N=0,P,D;N<this._ids.length;N++){const W=this._ids[N],q=t[2*W],z=t[2*W+1];if(N>0&&Math.abs(q-P)<=JD&&Math.abs(z-D)<=JD||(P=q,D=z,W===p||W===m||W===y))continue;let R=0;for(let he=0,we=this._hashKey(q,z);he<this._hashSize&&(R=s[(we+he)%this._hashSize],!(R!==-1&&R!==i[R]));he++);R=n[R];let U=R,G;for(;G=i[U],t1(q,z,t[2*U],t[2*U+1],t[2*G],t[2*G+1])>=0;)if(U=G,U===R){U=-1;break}if(U===-1)continue;let Z=this._addTriangle(U,W,i[U],-1,-1,r[U]);r[W]=this._legalize(Z+2),r[U]=Z,M++;let J=i[U];for(;G=i[J],t1(q,z,t[2*J],t[2*J+1],t[2*G],t[2*G+1])<0;)Z=this._addTriangle(J,W,G,r[W],-1,r[J]),r[W]=this._legalize(Z+2),i[J]=J,M--,J=G;if(U===R)for(;G=n[U],t1(q,z,t[2*G],t[2*G+1],t[2*U],t[2*U+1])<0;)Z=this._addTriangle(G,W,U,-1,r[U],r[G]),this._legalize(Z+2),r[G]=Z,i[U]=U,M--,U=G;this._hullStart=n[W]=U,i[U]=n[J]=W,i[W]=J,s[this._hashKey(q,z)]=W,s[this._hashKey(t[2*U],t[2*U+1])]=U}this.hull=new Uint32Array(M);for(let N=0,P=this._hullStart;N<M;N++)this.hull[N]=P,P=i[P];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(v1e(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:i,coords:r}=this;let s=0,a=0;for(;;){const o=i[t],u=t-t%3;if(a=u+(t+2)%3,o===-1){if(s===0)break;t=n1[--s];continue}const l=o-o%3,c=u+(t+1)%3,f=l+(o+2)%3,d=n[a],p=n[t],m=n[c],y=n[f];if(x1e(r[2*d],r[2*d+1],r[2*p],r[2*p+1],r[2*m],r[2*m+1],r[2*y],r[2*y+1])){n[t]=y,n[o]=d;const b=i[f];if(b===-1){let E=this._hullStart;do{if(this._hullTri[E]===f){this._hullTri[E]=t;break}E=this._hullPrev[E]}while(E!==this._hullStart)}this._link(t,b),this._link(o,i[a]),this._link(a,f);const _=l+(o+1)%3;s<n1.length&&(n1[s++]=_)}else{if(s===0)break;t=n1[--s]}}return a}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,i,r,s,a){const o=this.trianglesLen;return this._triangles[o]=t,this._triangles[o+1]=n,this._triangles[o+2]=i,this._link(o,r),this._link(o+1,s),this._link(o+2,a),this.trianglesLen+=3,o}}function v1e(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function Fw(e,t,n,i){const r=e-n,s=t-i;return r*r+s*s}function x1e(e,t,n,i,r,s,a,o){const u=e-a,l=t-o,c=n-a,f=i-o,d=r-a,p=s-o,m=u*u+l*l,y=c*c+f*f,v=d*d+p*p;return u*(f*v-y*p)-l*(c*v-y*d)+m*(c*p-f*d)<0}function b1e(e,t,n,i,r,s){const a=n-e,o=i-t,u=r-e,l=s-t,c=a*a+o*o,f=u*u+l*l,d=.5/(a*l-o*u),p=(l*c-o*f)*d,m=(a*f-u*c)*d;return p*p+m*m}function _1e(e,t,n,i,r,s){const a=n-e,o=i-t,u=r-e,l=s-t,c=a*a+o*o,f=u*u+l*l,d=.5/(a*l-o*u),p=e+(l*c-o*f)*d,m=t+(a*f-u*c)*d;return{x:p,y:m}}function Mf(e,t,n,i){if(i-n<=20)for(let r=n+1;r<=i;r++){const s=e[r],a=t[s];let o=r-1;for(;o>=n&&t[e[o]]>a;)e[o+1]=e[o--];e[o+1]=s}else{const r=n+i>>1;let s=n+1,a=i;Kd(e,r,s),t[e[n]]>t[e[i]]&&Kd(e,n,i),t[e[s]]>t[e[i]]&&Kd(e,s,i),t[e[n]]>t[e[s]]&&Kd(e,n,s);const o=e[s],u=t[o];for(;;){do s++;while(t[e[s]]<u);do a--;while(t[e[a]]>u);if(a<s)break;Kd(e,s,a)}e[n+1]=e[a],e[a]=o,i-s+1>=a-n?(Mf(e,t,s,i),Mf(e,t,n,a-1)):(Mf(e,t,n,a-1),Mf(e,t,s,i))}}function Kd(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function w1e(e){return e[0]}function E1e(e){return e[1]}const QD=1e-6;class Hl{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,i){t=+t,n=+n,i=+i;const r=t+i,s=n;if(i<0)throw new Error("negative radius");this._x1===null?this._+=`M${r},${s}`:(Math.abs(this._x1-r)>QD||Math.abs(this._y1-s)>QD)&&(this._+="L"+r+","+s),i&&(this._+=`A${i},${i},0,1,1,${t-i},${n}A${i},${i},0,1,1,${this._x1=r},${this._y1=s}`)}rect(t,n,i,r){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+i}v${+r}h${-i}Z`}value(){return this._||null}}class uA{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}let S1e=class{constructor(t,[n,i,r,s]=[0,0,960,500]){if(!((r=+r)>=(n=+n))||!((s=+s)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=r,this.xmin=n,this.ymax=s,this.ymin=i,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:i},vectors:r}=this;let s,a;const o=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let y=0,v=0,b=i.length,_,E;y<b;y+=3,v+=2){const S=i[y]*2,A=i[y+1]*2,$=i[y+2]*2,C=t[S],M=t[S+1],N=t[A],P=t[A+1],D=t[$],W=t[$+1],q=N-C,z=P-M,R=D-C,U=W-M,G=(q*U-z*R)*2;if(Math.abs(G)<1e-9){if(s===void 0){s=a=0;for(const J of n)s+=t[J*2],a+=t[J*2+1];s/=n.length,a/=n.length}const Z=1e9*Math.sign((s-C)*U-(a-M)*R);_=(C+D)/2-Z*U,E=(M+W)/2+Z*R}else{const Z=1/G,J=q*q+z*z,he=R*R+U*U;_=C+(U*J-z*he)*Z,E=M+(q*he-R*J)*Z}o[v]=_,o[v+1]=E}let u=n[n.length-1],l,c=u*4,f,d=t[2*u],p,m=t[2*u+1];r.fill(0);for(let y=0;y<n.length;++y)u=n[y],l=c,f=d,p=m,c=u*4,d=t[2*u],m=t[2*u+1],r[l+2]=r[c]=p-m,r[l+3]=r[c+1]=d-f}render(t){const n=t==null?t=new Hl:void 0,{delaunay:{halfedges:i,inedges:r,hull:s},circumcenters:a,vectors:o}=this;if(s.length<=1)return null;for(let c=0,f=i.length;c<f;++c){const d=i[c];if(d<c)continue;const p=Math.floor(c/3)*2,m=Math.floor(d/3)*2,y=a[p],v=a[p+1],b=a[m],_=a[m+1];this._renderSegment(y,v,b,_,t)}let u,l=s[s.length-1];for(let c=0;c<s.length;++c){u=l,l=s[c];const f=Math.floor(r[l]/3)*2,d=a[f],p=a[f+1],m=u*4,y=this._project(d,p,o[m+2],o[m+3]);y&&this._renderSegment(d,p,y[0],y[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new Hl:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const i=n==null?n=new Hl:void 0,r=this._clip(t);if(r===null||!r.length)return;n.moveTo(r[0],r[1]);let s=r.length;for(;r[0]===r[s-2]&&r[1]===r[s-1]&&s>1;)s-=2;for(let a=2;a<s;a+=2)(r[a]!==r[a-2]||r[a+1]!==r[a-1])&&n.lineTo(r[a],r[a+1]);return n.closePath(),i&&i.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,i=t.length/2;n<i;++n){const r=this.cellPolygon(n);r&&(r.index=n,yield r)}}cellPolygon(t){const n=new uA;return this.renderCell(t,n),n.value()}_renderSegment(t,n,i,r,s){let a;const o=this._regioncode(t,n),u=this._regioncode(i,r);o===0&&u===0?(s.moveTo(t,n),s.lineTo(i,r)):(a=this._clipSegment(t,n,i,r,o,u))&&(s.moveTo(a[0],a[1]),s.lineTo(a[2],a[3]))}contains(t,n,i){return n=+n,n!==n||(i=+i,i!==i)?!1:this.delaunay._step(t,n,i)===t}*neighbors(t){const n=this._clip(t);if(n)for(const i of this.delaunay.neighbors(t)){const r=this._clip(i);if(r){e:for(let s=0,a=n.length;s<a;s+=2)for(let o=0,u=r.length;o<u;o+=2)if(n[s]===r[o]&&n[s+1]===r[o+1]&&n[(s+2)%a]===r[(o+u-2)%u]&&n[(s+3)%a]===r[(o+u-1)%u]){yield i;break e}}}}_cell(t){const{circumcenters:n,delaunay:{inedges:i,halfedges:r,triangles:s}}=this,a=i[t];if(a===-1)return null;const o=[];let u=a;do{const l=Math.floor(u/3);if(o.push(n[l*2],n[l*2+1]),u=u%3===2?u-2:u+1,s[u]!==t)break;u=r[u]}while(u!==a&&u!==-1);return o}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:i}=this,r=t*4;return this._simplify(i[r]||i[r+1]?this._clipInfinite(t,n,i[r],i[r+1],i[r+2],i[r+3]):this._clipFinite(t,n))}_clipFinite(t,n){const i=n.length;let r=null,s,a,o=n[i-2],u=n[i-1],l,c=this._regioncode(o,u),f,d=0;for(let p=0;p<i;p+=2)if(s=o,a=u,o=n[p],u=n[p+1],l=c,c=this._regioncode(o,u),l===0&&c===0)f=d,d=0,r?r.push(o,u):r=[o,u];else{let m,y,v,b,_;if(l===0){if((m=this._clipSegment(s,a,o,u,l,c))===null)continue;[y,v,b,_]=m}else{if((m=this._clipSegment(o,u,s,a,c,l))===null)continue;[b,_,y,v]=m,f=d,d=this._edgecode(y,v),f&&d&&this._edge(t,f,d,r,r.length),r?r.push(y,v):r=[y,v]}f=d,d=this._edgecode(b,_),f&&d&&this._edge(t,f,d,r,r.length),r?r.push(b,_):r=[b,_]}if(r)f=d,d=this._edgecode(r[0],r[1]),f&&d&&this._edge(t,f,d,r,r.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return r}_clipSegment(t,n,i,r,s,a){const o=s<a;for(o&&([t,n,i,r,s,a]=[i,r,t,n,a,s]);;){if(s===0&&a===0)return o?[i,r,t,n]:[t,n,i,r];if(s&a)return null;let u,l,c=s||a;c&8?(u=t+(i-t)*(this.ymax-n)/(r-n),l=this.ymax):c&4?(u=t+(i-t)*(this.ymin-n)/(r-n),l=this.ymin):c&2?(l=n+(r-n)*(this.xmax-t)/(i-t),u=this.xmax):(l=n+(r-n)*(this.xmin-t)/(i-t),u=this.xmin),s?(t=u,n=l,s=this._regioncode(t,n)):(i=u,r=l,a=this._regioncode(i,r))}}_clipInfinite(t,n,i,r,s,a){let o=Array.from(n),u;if((u=this._project(o[0],o[1],i,r))&&o.unshift(u[0],u[1]),(u=this._project(o[o.length-2],o[o.length-1],s,a))&&o.push(u[0],u[1]),o=this._clipFinite(t,o))for(let l=0,c=o.length,f,d=this._edgecode(o[c-2],o[c-1]);l<c;l+=2)f=d,d=this._edgecode(o[l],o[l+1]),f&&d&&(l=this._edge(t,f,d,o,l),c=o.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(o=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return o}_edge(t,n,i,r,s){for(;n!==i;){let a,o;switch(n){case 5:n=4;continue;case 4:n=6,a=this.xmax,o=this.ymin;break;case 6:n=2;continue;case 2:n=10,a=this.xmax,o=this.ymax;break;case 10:n=8;continue;case 8:n=9,a=this.xmin,o=this.ymax;break;case 9:n=1;continue;case 1:n=5,a=this.xmin,o=this.ymin;break}(r[s]!==a||r[s+1]!==o)&&this.contains(t,a,o)&&(r.splice(s,0,a,o),s+=2)}return s}_project(t,n,i,r){let s=1/0,a,o,u;if(r<0){if(n<=this.ymin)return null;(a=(this.ymin-n)/r)<s&&(u=this.ymin,o=t+(s=a)*i)}else if(r>0){if(n>=this.ymax)return null;(a=(this.ymax-n)/r)<s&&(u=this.ymax,o=t+(s=a)*i)}if(i>0){if(t>=this.xmax)return null;(a=(this.xmax-t)/i)<s&&(o=this.xmax,u=n+(s=a)*r)}else if(i<0){if(t<=this.xmin)return null;(a=(this.xmin-t)/i)<s&&(o=this.xmin,u=n+(s=a)*r)}return[o,u]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}_simplify(t){if(t&&t.length>4){for(let n=0;n<t.length;n+=2){const i=(n+2)%t.length,r=(n+4)%t.length;(t[n]===t[i]&&t[i]===t[r]||t[n+1]===t[i+1]&&t[i+1]===t[r+1])&&(t.splice(i,2),n-=2)}t.length||(t=null)}return t}};const A1e=2*Math.PI,yf=Math.pow;function C1e(e){return e[0]}function k1e(e){return e[1]}function $1e(e){const{triangles:t,coords:n}=e;for(let i=0;i<t.length;i+=3){const r=2*t[i],s=2*t[i+1],a=2*t[i+2];if((n[a]-n[r])*(n[s+1]-n[r+1])-(n[s]-n[r])*(n[a+1]-n[r+1])>1e-10)return!1}return!0}function T1e(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class A3{static from(t,n=C1e,i=k1e,r){return new A3("length"in t?O1e(t,n,i,r):Float64Array.from(F1e(t,n,i,r)))}constructor(t){this._delaunator=new ov(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&$1e(t)){this.collinear=Int32Array.from({length:n.length/2},(d,p)=>p).sort((d,p)=>n[2*d]-n[2*p]||n[2*d+1]-n[2*p+1]);const u=this.collinear[0],l=this.collinear[this.collinear.length-1],c=[n[2*u],n[2*u+1],n[2*l],n[2*l+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let d=0,p=n.length/2;d<p;++d){const m=T1e(n[2*d],n[2*d+1],f);n[2*d]=m[0],n[2*d+1]=m[1]}this._delaunator=new ov(n)}else delete this.collinear;const i=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,a=this.inedges.fill(-1),o=this._hullIndex.fill(-1);for(let u=0,l=i.length;u<l;++u){const c=s[u%3===2?u-2:u+1];(i[u]===-1||a[c]===-1)&&(a[c]=u)}for(let u=0,l=r.length;u<l;++u)o[r[u]]=u;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],a[r[0]]=1,r.length===2&&(a[r[1]]=0,this.triangles[1]=r[1],this.triangles[2]=r[1]))}voronoi(t){return new S1e(this,t)}*neighbors(t){const{inedges:n,hull:i,_hullIndex:r,halfedges:s,triangles:a,collinear:o}=this;if(o){const f=o.indexOf(t);f>0&&(yield o[f-1]),f<o.length-1&&(yield o[f+1]);return}const u=n[t];if(u===-1)return;let l=u,c=-1;do{if(yield c=a[l],l=l%3===2?l-2:l+1,a[l]!==t)return;if(l=s[l],l===-1){const f=i[(r[t]+1)%i.length];f!==c&&(yield f);return}}while(l!==u)}find(t,n,i=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const r=i;let s;for(;(s=this._step(i,t,n))>=0&&s!==i&&s!==r;)i=s;return s}_step(t,n,i){const{inedges:r,hull:s,_hullIndex:a,halfedges:o,triangles:u,points:l}=this;if(r[t]===-1||!l.length)return(t+1)%(l.length>>1);let c=t,f=yf(n-l[t*2],2)+yf(i-l[t*2+1],2);const d=r[t];let p=d;do{let m=u[p];const y=yf(n-l[m*2],2)+yf(i-l[m*2+1],2);if(y<f&&(f=y,c=m),p=p%3===2?p-2:p+1,u[p]!==t)break;if(p=o[p],p===-1){if(p=s[(a[t]+1)%s.length],p!==m&&yf(n-l[p*2],2)+yf(i-l[p*2+1],2)<f)return p;break}}while(p!==d);return c}render(t){const n=t==null?t=new Hl:void 0,{points:i,halfedges:r,triangles:s}=this;for(let a=0,o=r.length;a<o;++a){const u=r[a];if(u<a)continue;const l=s[a]*2,c=s[u]*2;t.moveTo(i[l],i[l+1]),t.lineTo(i[c],i[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n){n===void 0&&(!t||typeof t.moveTo!="function")&&(n=t,t=null),n=n==null?2:+n;const i=t==null?t=new Hl:void 0,{points:r}=this;for(let s=0,a=r.length;s<a;s+=2){const o=r[s],u=r[s+1];t.moveTo(o+n,u),t.arc(o,u,n,0,A1e)}return i&&i.value()}renderHull(t){const n=t==null?t=new Hl:void 0,{hull:i,points:r}=this,s=i[0]*2,a=i.length;t.moveTo(r[s],r[s+1]);for(let o=1;o<a;++o){const u=2*i[o];t.lineTo(r[u],r[u+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new uA;return this.renderHull(t),t.value()}renderTriangle(t,n){const i=n==null?n=new Hl:void 0,{points:r,triangles:s}=this,a=s[t*=3]*2,o=s[t+1]*2,u=s[t+2]*2;return n.moveTo(r[a],r[a+1]),n.lineTo(r[o],r[o+1]),n.lineTo(r[u],r[u+1]),n.closePath(),i&&i.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,i=t.length/3;n<i;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new uA;return this.renderTriangle(t,n),n.value()}}function O1e(e,t,n,i){const r=e.length,s=new Float64Array(r*2);for(let a=0;a<r;++a){const o=e[a];s[a*2]=t.call(i,o,a,e),s[a*2+1]=n.call(i,o,a,e)}return s}function*F1e(e,t,n,i){let r=0;for(const s of e)yield t.call(i,s,r,e),yield n.call(i,s,r,e),++r}function C3(e){H.call(this,null,e)}C3.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const M1e=[-1e5,-1e5,1e5,1e5];ce(C3,H,{transform(e,t){const n=e.as||"path",i=t.source;if(!i||!i.length)return t;let r=e.size;r=r?[0,0,r[0],r[1]]:(r=e.extent)?[r[0][0],r[0][1],r[1][0],r[1][1]]:M1e;const s=this.value=A3.from(i,e.x,e.y).voronoi(r);for(let a=0,o=i.length;a<o;++a){const u=s.cellPolygon(a);i[a][n]=u&&!R1e(u)?N1e(u):null}return t.reflow(e.modified()).modifies(n)}});function N1e(e){const t=e[0][0],n=e[0][1];let i=e.length-1;for(;e[i][0]===t&&e[i][1]===n;--i);return"M"+e.slice(0,i+1).join("L")+"Z"}function R1e(e){return e.length===2&&e[0][0]===e[1][0]&&e[0][1]===e[1][1]}const I1e=Object.freeze(Object.defineProperty({__proto__:null,voronoi:C3},Symbol.toStringTag,{value:"Module"}));var Mw=Math.PI/180,Tp=64,U1=2048;function D1e(){var e=[256,256],t,n,i,r,s,a,o,u=kU,l=[],c=Math.random,f={};f.layout=function(){for(var m=d($u()),y=j1e((e[0]>>5)*e[1]),v=null,b=l.length,_=-1,E=[],S=l.map($=>({text:t($),font:n($),style:r($),weight:s($),rotate:a($),size:~~(i($)+1e-14),padding:o($),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:$})).sort(($,C)=>C.size-$.size);++_<b;){var A=S[_];A.x=e[0]*(c()+.5)>>1,A.y=e[1]*(c()+.5)>>1,P1e(m,A,S,_),A.hasText&&p(y,A,v)&&(E.push(A),v?z1e(v,A):v=[{x:A.x+A.x0,y:A.y+A.y0},{x:A.x+A.x1,y:A.y+A.y1}],A.x-=e[0]>>1,A.y-=e[1]>>1)}return E};function d(m){m.width=m.height=1;var y=Math.sqrt(m.getContext("2d").getImageData(0,0,1,1).data.length>>2);m.width=(Tp<<5)/y,m.height=U1/y;var v=m.getContext("2d");return v.fillStyle=v.strokeStyle="red",v.textAlign="center",{context:v,ratio:y}}function p(m,y,v){for(var b=y.x,_=y.y,E=Math.hypot(e[0],e[1]),S=u(e),A=c()<.5?1:-1,$=-A,C,M,N;(C=S($+=A))&&(M=~~C[0],N=~~C[1],!(Math.min(Math.abs(M),Math.abs(N))>=E));)if(y.x=b+M,y.y=_+N,!(y.x+y.x0<0||y.y+y.y0<0||y.x+y.x1>e[0]||y.y+y.y1>e[1])&&(!v||!L1e(y,m,e[0]))&&(!v||B1e(y,v))){for(var P=y.sprite,D=y.width>>5,W=e[0]>>5,q=y.x-(D<<4),z=q&127,R=32-z,U=y.y1-y.y0,G=(y.y+y.y0)*W+(q>>5),Z,J=0;J<U;J++){Z=0;for(var he=0;he<=D;he++)m[G+he]|=Z<<R|(he<D?(Z=P[J*D+he])>>>z:0);G+=W}return y.sprite=null,!0}return!1}return f.words=function(m){return arguments.length?(l=m,f):l},f.size=function(m){return arguments.length?(e=[+m[0],+m[1]],f):e},f.font=function(m){return arguments.length?(n=Cl(m),f):n},f.fontStyle=function(m){return arguments.length?(r=Cl(m),f):r},f.fontWeight=function(m){return arguments.length?(s=Cl(m),f):s},f.rotate=function(m){return arguments.length?(a=Cl(m),f):a},f.text=function(m){return arguments.length?(t=Cl(m),f):t},f.spiral=function(m){return arguments.length?(u=q1e[m]||m,f):u},f.fontSize=function(m){return arguments.length?(i=Cl(m),f):i},f.padding=function(m){return arguments.length?(o=Cl(m),f):o},f.random=function(m){return arguments.length?(c=m,f):c},f}function P1e(e,t,n,i){if(!t.sprite){var r=e.context,s=e.ratio;r.clearRect(0,0,(Tp<<5)/s,U1/s);var a=0,o=0,u=0,l=n.length,c,f,d,p,m;for(--i;++i<l;){if(t=n[i],r.save(),r.font=t.style+" "+t.weight+" "+~~((t.size+1)/s)+"px "+t.font,c=r.measureText(t.text+"m").width*s,d=t.size<<1,t.rotate){var y=Math.sin(t.rotate*Mw),v=Math.cos(t.rotate*Mw),b=c*v,_=c*y,E=d*v,S=d*y;c=Math.max(Math.abs(b+S),Math.abs(b-S))+31>>5<<5,d=~~Math.max(Math.abs(_+E),Math.abs(_-E))}else c=c+31>>5<<5;if(d>u&&(u=d),a+c>=Tp<<5&&(a=0,o+=u,u=0),o+d>=U1)break;r.translate((a+(c>>1))/s,(o+(d>>1))/s),t.rotate&&r.rotate(t.rotate*Mw),r.fillText(t.text,0,0),t.padding&&(r.lineWidth=2*t.padding,r.strokeText(t.text,0,0)),r.restore(),t.width=c,t.height=d,t.xoff=a,t.yoff=o,t.x1=c>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,a+=c}for(var A=r.getImageData(0,0,(Tp<<5)/s,U1/s).data,$=[];--i>=0;)if(t=n[i],!!t.hasText){for(c=t.width,f=c>>5,d=t.y1-t.y0,p=0;p<d*f;p++)$[p]=0;if(a=t.xoff,a==null)return;o=t.yoff;var C=0,M=-1;for(m=0;m<d;m++){for(p=0;p<c;p++){var N=f*m+(p>>5),P=A[(o+m)*(Tp<<5)+(a+p)<<2]?1<<31-p%32:0;$[N]|=P,C|=P}C?M=m:(t.y0++,d--,m--,o++)}t.y1=t.y0+M,t.sprite=$.slice(0,(t.y1-t.y0)*f)}}}function L1e(e,t,n){n>>=5;for(var i=e.sprite,r=e.width>>5,s=e.x-(r<<4),a=s&127,o=32-a,u=e.y1-e.y0,l=(e.y+e.y0)*n+(s>>5),c,f=0;f<u;f++){c=0;for(var d=0;d<=r;d++)if((c<<o|(d<r?(c=i[f*r+d])>>>a:0))&t[l+d])return!0;l+=n}return!1}function z1e(e,t){var n=e[0],i=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>i.x&&(i.x=t.x+t.x1),t.y+t.y1>i.y&&(i.y=t.y+t.y1)}function B1e(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function kU(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function U1e(e){var t=4,n=t*e[0]/e[1],i=0,r=0;return function(s){var a=s<0?-1:1;switch(Math.sqrt(1+4*a*s)-a&3){case 0:i+=n;break;case 1:r+=t;break;case 2:i-=n;break;default:r-=t;break}return[i,r]}}function j1e(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function Cl(e){return typeof e=="function"?e:function(){return e}}var q1e={archimedean:kU,rectangular:U1e};const $U=["x","y","font","fontSize","fontStyle","fontWeight","angle"],V1e=["text","font","rotate","fontSize","fontStyle","fontWeight"];function k3(e){H.call(this,D1e(),e)}k3.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:$U}]};ce(k3,H,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&K("Wordcloud size dimensions must be non-zero.");function n(m){const y=e[m];return Ye(y)&&t.modified(y.fields)}const i=e.modified();if(!(i||t.changed(t.ADD_REM)||V1e.some(n)))return;const r=t.materialize(t.SOURCE).source,s=this.value,a=e.as||$U;let o=e.fontSize||14,u;if(Ye(o)?u=e.fontSizeRange:o=di(o),u){const m=o,y=gt("sqrt")().domain(xa(r,m)).range(u);o=v=>y(m(v))}r.forEach(m=>{m[a[0]]=NaN,m[a[1]]=NaN,m[a[3]]=0});const l=s.words(r).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(o).random(Jr).layout(),c=s.size(),f=c[0]>>1,d=c[1]>>1,p=l.length;for(let m=0,y,v;m<p;++m)y=l[m],v=y.datum,v[a[0]]=y.x+f,v[a[1]]=y.y+d,v[a[2]]=y.font,v[a[3]]=y.size,v[a[4]]=y.style,v[a[5]]=y.weight,v[a[6]]=y.rotate;return t.reflow(i).modifies(a)}});const W1e=Object.freeze(Object.defineProperty({__proto__:null,wordcloud:k3},Symbol.toStringTag,{value:"Module"})),G1e=e=>new Uint8Array(e),H1e=e=>new Uint16Array(e),Vp=e=>new Uint32Array(e);function Y1e(){let e=8,t=[],n=Vp(0),i=i1(0,e),r=i1(0,e);return{data:()=>t,seen:()=>n=X1e(n,t.length),add(s){for(let a=0,o=t.length,u=s.length,l;a<u;++a)l=s[a],l._index=o++,t.push(l)},remove(s,a){const o=t.length,u=Array(o-s),l=t;let c,f,d;for(f=0;!a[f]&&f<o;++f)u[f]=t[f],l[f]=f;for(d=f;f<o;++f)c=t[f],a[f]?l[f]=-1:(l[f]=d,i[d]=i[f],r[d]=r[f],u[d]=c,c._index=d++),i[f]=0;return t=u,l},size:()=>t.length,curr:()=>i,prev:()=>r,reset:s=>r[s]=i[s],all:()=>e<257?255:e<65537?65535:4294967295,set(s,a){i[s]|=a},clear(s,a){i[s]&=~a},resize(s,a){const o=i.length;(s>o||a>e)&&(e=Math.max(a,e),i=i1(s,e,i),r=i1(s,e))}}}function X1e(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function i1(e,t,n){const i=(t<257?G1e:t<65537?H1e:Vp)(e);return n&&i.set(n),i}function ZD(e,t,n){const i=1<<t;return{one:i,zero:~i,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(r,s){const a=this,o=a.bisect(a.range,r.value),u=r.index,l=o[0],c=o[1],f=u.length;let d;for(d=0;d<l;++d)s[u[d]]|=i;for(d=c;d<f;++d)s[u[d]]|=i;return a}}}function e6(){let e=Vp(0),t=[],n=0;function i(o,u,l){if(!u.length)return[];const c=n,f=u.length,d=Vp(f);let p=Array(f),m,y,v;for(v=0;v<f;++v)p[v]=o(u[v]),d[v]=v;if(p=K1e(p,d),c)m=t,y=e,t=Array(c+f),e=Vp(c+f),J1e(l,m,y,c,p,d,f,t,e);else{if(l>0)for(v=0;v<f;++v)d[v]+=l;t=p,e=d}return n=c+f,{index:d,value:p}}function r(o,u){const l=n;let c,f,d;for(f=0;!u[e[f]]&&f<l;++f);for(d=f;f<l;++f)u[c=e[f]]||(e[d]=c,t[d]=t[f],++d);n=l-o}function s(o){for(let u=0,l=n;u<l;++u)e[u]=o[e[u]]}function a(o,u){let l;return u?l=u.length:(u=t,l=n),[tre(u,o[0],0,l),Mu(u,o[1],0,l)]}return{insert:i,remove:r,bisect:a,reindex:s,index:()=>e,size:()=>n}}function K1e(e,t){return e.sort.call(t,(n,i)=>{const r=e[n],s=e[i];return r<s?-1:r>s?1:0}),rre(e,t)}function J1e(e,t,n,i,r,s,a,o,u){let l=0,c=0,f;for(f=0;l<i&&c<a;++f)t[l]<r[c]?(o[f]=t[l],u[f]=n[l++]):(o[f]=r[c],u[f]=s[c++]+e);for(;l<i;++l,++f)o[f]=t[l],u[f]=n[l];for(;c<a;++c,++f)o[f]=r[c],u[f]=s[c]+e}function $3(e){H.call(this,Y1e(),e),this._indices=null,this._dims=null}$3.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};ce($3,H,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(i=>t.modified(i.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,i=e.query,r=this._indices={},s=this._dims=[],a=i.length;let o=0,u,l;for(;o<a;++o)u=n[o].fname,l=r[u]||(r[u]=e6()),s.push(ZD(l,o,i[o]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),i=e.fields,r=e.query,s=this._indices,a=this._dims,o=this.value,u=o.curr(),l=o.prev(),c=o.all(),f=n.rem=n.add,d=n.mod,p=r.length,m={};let y,v,b,_,E,S,A,$,C;if(l.set(u),t.rem.length&&(E=this.remove(e,t,n)),t.add.length&&o.add(t.add),t.mod.length)for(S={},_=t.mod,A=0,$=_.length;A<$;++A)S[_[A]._index]=1;for(A=0;A<p;++A)C=i[A],(!a[A]||e.modified("fields",A)||t.modified(C.fields))&&(b=C.fname,(y=m[b])||(s[b]=v=e6(),m[b]=y=v.insert(C,t.source,0)),a[A]=ZD(v,A,r[A]).onAdd(y,u));for(A=0,$=o.data().length;A<$;++A)E[A]||(l[A]!==u[A]?f.push(A):S[A]&&u[A]!==c&&d.push(A));return o.mask=(1<<p)-1,n},eval(e,t){const n=t.materialize().fork(),i=this._dims.length;let r=0;return t.rem.length&&(this.remove(e,t,n),r|=(1<<i)-1),e.modified("query")&&!e.modified("fields")&&(r|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),r|=(1<<i)-1),t.mod.length&&(this.modify(t,n),r|=(1<<i)-1),this.value.mask=r,n},insert(e,t,n){const i=t.add,r=this.value,s=this._dims,a=this._indices,o=e.fields,u={},l=n.add,c=r.size()+i.length,f=s.length;let d=r.size(),p,m,y;r.resize(c,f),r.add(i);const v=r.curr(),b=r.prev(),_=r.all();for(p=0;p<f;++p)m=o[p].fname,y=u[m]||(u[m]=a[m].insert(o[p],i,d)),s[p].onAdd(y,v);for(;d<c;++d)b[d]=_,v[d]!==_&&l.push(d)},modify(e,t){const n=t.mod,i=this.value,r=i.curr(),s=i.all(),a=e.mod;let o,u,l;for(o=0,u=a.length;o<u;++o)l=a[o]._index,r[l]!==s&&n.push(l)},remove(e,t,n){const i=this._indices,r=this.value,s=r.curr(),a=r.prev(),o=r.all(),u={},l=n.rem,c=t.rem;let f,d,p,m;for(f=0,d=c.length;f<d;++f)p=c[f]._index,u[p]=1,a[p]=m=s[p],s[p]=o,m!==o&&l.push(p);for(p in i)i[p].remove(d,u);return this.reindex(t,d,u),u},reindex(e,t,n){const i=this._indices,r=this.value;e.runAfter(()=>{const s=r.remove(t,n);for(const a in i)i[a].reindex(s)})},update(e,t,n){const i=this._dims,r=e.query,s=t.stamp,a=i.length;let o=0,u,l;for(n.filters=0,l=0;l<a;++l)e.modified("query",l)&&(u=l,++o);if(o===1)o=i[u].one,this.incrementOne(i[u],r[u],n.add,n.rem);else for(l=0,o=0;l<a;++l)e.modified("query",l)&&(o|=i[l].one,this.incrementAll(i[l],r[l],s,n.add),n.rem=n.add);return o},incrementAll(e,t,n,i){const r=this.value,s=r.seen(),a=r.curr(),o=r.prev(),u=e.index(),l=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],p=l[0],m=l[1],y=e.one;let v,b,_;if(f<p)for(v=f,b=Math.min(p,d);v<b;++v)_=u[v],s[_]!==n&&(o[_]=a[_],s[_]=n,i.push(_)),a[_]^=y;else if(f>p)for(v=p,b=Math.min(f,m);v<b;++v)_=u[v],s[_]!==n&&(o[_]=a[_],s[_]=n,i.push(_)),a[_]^=y;if(d>m)for(v=Math.max(f,m),b=d;v<b;++v)_=u[v],s[_]!==n&&(o[_]=a[_],s[_]=n,i.push(_)),a[_]^=y;else if(d<m)for(v=Math.max(p,d),b=m;v<b;++v)_=u[v],s[_]!==n&&(o[_]=a[_],s[_]=n,i.push(_)),a[_]^=y;e.range=t.slice()},incrementOne(e,t,n,i){const r=this.value,s=r.curr(),a=e.index(),o=e.bisect(e.range),u=e.bisect(t),l=u[0],c=u[1],f=o[0],d=o[1],p=e.one;let m,y,v;if(l<f)for(m=l,y=Math.min(f,c);m<y;++m)v=a[m],s[v]^=p,n.push(v);else if(l>f)for(m=f,y=Math.min(l,d);m<y;++m)v=a[m],s[v]^=p,i.push(v);if(c>d)for(m=Math.max(l,d),y=c;m<y;++m)v=a[m],s[v]^=p,n.push(v);else if(c<d)for(m=Math.max(f,c),y=d;m<y;++m)v=a[m],s[v]^=p,i.push(v);e.range=t.slice()}});function T3(e){H.call(this,null,e)}T3.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};ce(T3,H,{transform(e,t){const n=~(e.ignore||0),i=e.filter,r=i.mask;if(!(r&n))return t.StopPropagation;const s=t.fork(t.ALL),a=i.data(),o=i.curr(),u=i.prev(),l=c=>o[c]&n?null:a[c];return s.filter(s.MOD,l),r&r-1?(s.filter(s.ADD,c=>{const f=o[c]&n;return!f&&f^u[c]&n?a[c]:null}),s.filter(s.REM,c=>{const f=o[c]&n;return f&&!(f^(f^u[c]&n))?a[c]:null})):(s.filter(s.ADD,l),s.filter(s.REM,c=>(o[c]&n)===r?a[c]:null)),s.filter(s.SOURCE,c=>l(c._index))}});const Q1e=Object.freeze(Object.defineProperty({__proto__:null,crossfilter:$3,resolvefilter:T3},Symbol.toStringTag,{value:"Module"})),Z1e="RawCode",hc="Literal",eye="Property",tye="Identifier",nye="ArrayExpression",iye="BinaryExpression",TU="CallExpression",rye="ConditionalExpression",sye="LogicalExpression",aye="MemberExpression",oye="ObjectExpression",uye="UnaryExpression";function Ls(e){this.type=e}Ls.prototype.visit=function(e){let t,n,i;if(e(this))return 1;for(t=lye(this),n=0,i=t.length;n<i;++n)if(t[n].visit(e))return 1};function lye(e){switch(e.type){case nye:return e.elements;case iye:case sye:return[e.left,e.right];case TU:return[e.callee].concat(e.arguments);case rye:return[e.test,e.consequent,e.alternate];case aye:return[e.object,e.property];case oye:return e.properties;case eye:return[e.key,e.value];case uye:return[e.argument];case tye:case hc:case Z1e:default:return[]}}var Ra,_e,Y,ci,Et,Bx=1,f0=2,dc=3,tl=4,Ux=5,Nc=6,qi=7,h0=8,cye=9;Ra={};Ra[Bx]="Boolean";Ra[f0]="<end>";Ra[dc]="Identifier";Ra[tl]="Keyword";Ra[Ux]="Null";Ra[Nc]="Numeric";Ra[qi]="Punctuator";Ra[h0]="String";Ra[cye]="RegularExpression";var fye="ArrayExpression",hye="BinaryExpression",dye="CallExpression",pye="ConditionalExpression",OU="Identifier",gye="Literal",mye="LogicalExpression",yye="MemberExpression",vye="ObjectExpression",xye="Property",bye="UnaryExpression",Fn="Unexpected token %0",_ye="Unexpected number",wye="Unexpected string",Eye="Unexpected identifier",Sye="Unexpected reserved word",Aye="Unexpected end of input",lA="Invalid regular expression",Nw="Invalid regular expression: missing /",FU="Octal literals are not allowed in strict mode.",Cye="Duplicate data property in object literal not allowed in strict mode",Gn="ILLEGAL",mg="Disabled.",kye=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),$ye=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function jx(e,t){if(!e)throw new Error("ASSERT: "+t)}function uo(e){return e>=48&&e<=57}function O3(e){return"0123456789abcdefABCDEF".includes(e)}function Wp(e){return"01234567".includes(e)}function Tye(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].includes(e)}function yg(e){return e===10||e===13||e===8232||e===8233}function d0(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&kye.test(String.fromCharCode(e))}function uv(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&$ye.test(String.fromCharCode(e))}const Oye={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function MU(){for(;Y<ci;){const e=_e.charCodeAt(Y);if(Tye(e)||yg(e))++Y;else break}}function cA(e){var t,n,i,r=0;for(n=e==="u"?4:2,t=0;t<n;++t)Y<ci&&O3(_e[Y])?(i=_e[Y++],r=r*16+"0123456789abcdef".indexOf(i.toLowerCase())):ht({},Fn,Gn);return String.fromCharCode(r)}function Fye(){var e,t,n,i;for(e=_e[Y],t=0,e==="}"&&ht({},Fn,Gn);Y<ci&&(e=_e[Y++],!!O3(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&ht({},Fn,Gn),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,i=(t-65536&1023)+56320,String.fromCharCode(n,i))}function NU(){var e,t;for(e=_e.charCodeAt(Y++),t=String.fromCharCode(e),e===92&&(_e.charCodeAt(Y)!==117&&ht({},Fn,Gn),++Y,e=cA("u"),(!e||e==="\\"||!d0(e.charCodeAt(0)))&&ht({},Fn,Gn),t=e);Y<ci&&(e=_e.charCodeAt(Y),!!uv(e));)++Y,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),_e.charCodeAt(Y)!==117&&ht({},Fn,Gn),++Y,e=cA("u"),(!e||e==="\\"||!uv(e.charCodeAt(0)))&&ht({},Fn,Gn),t+=e);return t}function Mye(){var e,t;for(e=Y++;Y<ci;){if(t=_e.charCodeAt(Y),t===92)return Y=e,NU();if(uv(t))++Y;else break}return _e.slice(e,Y)}function Nye(){var e,t,n;return e=Y,t=_e.charCodeAt(Y)===92?NU():Mye(),t.length===1?n=dc:Oye.hasOwnProperty(t)?n=tl:t==="null"?n=Ux:t==="true"||t==="false"?n=Bx:n=dc,{type:n,value:t,start:e,end:Y}}function Rw(){var e=Y,t=_e.charCodeAt(Y),n,i=_e[Y],r,s,a;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++Y,{type:qi,value:String.fromCharCode(t),start:e,end:Y};default:if(n=_e.charCodeAt(Y+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return Y+=2,{type:qi,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:Y};case 33:case 61:return Y+=2,_e.charCodeAt(Y)===61&&++Y,{type:qi,value:_e.slice(e,Y),start:e,end:Y}}}if(a=_e.substr(Y,4),a===">>>=")return Y+=4,{type:qi,value:a,start:e,end:Y};if(s=a.substr(0,3),s===">>>"||s==="<<="||s===">>=")return Y+=3,{type:qi,value:s,start:e,end:Y};if(r=s.substr(0,2),i===r[1]&&"+-<>&|".includes(i)||r==="=>")return Y+=2,{type:qi,value:r,start:e,end:Y};if(r==="//"&&ht({},Fn,Gn),"<>=!+-*%&|^/".includes(i))return++Y,{type:qi,value:i,start:e,end:Y};ht({},Fn,Gn)}function Rye(e){let t="";for(;Y<ci&&O3(_e[Y]);)t+=_e[Y++];return t.length===0&&ht({},Fn,Gn),d0(_e.charCodeAt(Y))&&ht({},Fn,Gn),{type:Nc,value:parseInt("0x"+t,16),start:e,end:Y}}function Iye(e){let t="0"+_e[Y++];for(;Y<ci&&Wp(_e[Y]);)t+=_e[Y++];return(d0(_e.charCodeAt(Y))||uo(_e.charCodeAt(Y)))&&ht({},Fn,Gn),{type:Nc,value:parseInt(t,8),octal:!0,start:e,end:Y}}function t6(){var e,t,n;if(n=_e[Y],jx(uo(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=Y,e="",n!=="."){if(e=_e[Y++],n=_e[Y],e==="0"){if(n==="x"||n==="X")return++Y,Rye(t);if(Wp(n))return Iye(t);n&&uo(n.charCodeAt(0))&&ht({},Fn,Gn)}for(;uo(_e.charCodeAt(Y));)e+=_e[Y++];n=_e[Y]}if(n==="."){for(e+=_e[Y++];uo(_e.charCodeAt(Y));)e+=_e[Y++];n=_e[Y]}if(n==="e"||n==="E")if(e+=_e[Y++],n=_e[Y],(n==="+"||n==="-")&&(e+=_e[Y++]),uo(_e.charCodeAt(Y)))for(;uo(_e.charCodeAt(Y));)e+=_e[Y++];else ht({},Fn,Gn);return d0(_e.charCodeAt(Y))&&ht({},Fn,Gn),{type:Nc,value:parseFloat(e),start:t,end:Y}}function Dye(){var e="",t,n,i,r,s=!1;for(t=_e[Y],jx(t==="'"||t==='"',"String literal must starts with a quote"),n=Y,++Y;Y<ci;)if(i=_e[Y++],i===t){t="";break}else if(i==="\\")if(i=_e[Y++],!i||!yg(i.charCodeAt(0)))switch(i){case"u":case"x":_e[Y]==="{"?(++Y,e+=Fye()):e+=cA(i);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Wp(i)?(r="01234567".indexOf(i),r!==0&&(s=!0),Y<ci&&Wp(_e[Y])&&(s=!0,r=r*8+"01234567".indexOf(_e[Y++]),"0123".includes(i)&&Y<ci&&Wp(_e[Y])&&(r=r*8+"01234567".indexOf(_e[Y++]))),e+=String.fromCharCode(r)):e+=i;break}else i==="\r"&&_e[Y]===`
`&&++Y;else{if(yg(i.charCodeAt(0)))break;e+=i}return t!==""&&ht({},Fn,Gn),{type:h0,value:e,octal:s,start:n,end:Y}}function Pye(e,t){let n=e;t.includes("u")&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(i,r)=>{if(parseInt(r,16)<=1114111)return"x";ht({},lA)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{ht({},lA)}try{return new RegExp(e,t)}catch{return null}}function Lye(){var e,t,n,i,r;for(e=_e[Y],jx(e==="/","Regular expression literal must start with a slash"),t=_e[Y++],n=!1,i=!1;Y<ci;)if(e=_e[Y++],t+=e,e==="\\")e=_e[Y++],yg(e.charCodeAt(0))&&ht({},Nw),t+=e;else if(yg(e.charCodeAt(0)))ht({},Nw);else if(n)e==="]"&&(n=!1);else if(e==="/"){i=!0;break}else e==="["&&(n=!0);return i||ht({},Nw),r=t.substr(1,t.length-2),{value:r,literal:t}}function zye(){var e,t,n;for(t="",n="";Y<ci&&(e=_e[Y],!!uv(e.charCodeAt(0)));)++Y,e==="\\"&&Y<ci?ht({},Fn,Gn):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&ht({},lA,n),{value:n,literal:t}}function Bye(){var e,t,n,i;return Et=null,MU(),e=Y,t=Lye(),n=zye(),i=Pye(t.value,n.value),{literal:t.literal+n.literal,value:i,regex:{pattern:t.value,flags:n.value},start:e,end:Y}}function Uye(e){return e.type===dc||e.type===tl||e.type===Bx||e.type===Ux}function RU(){if(MU(),Y>=ci)return{type:f0,start:Y,end:Y};const e=_e.charCodeAt(Y);return d0(e)?Nye():e===40||e===41||e===59?Rw():e===39||e===34?Dye():e===46?uo(_e.charCodeAt(Y+1))?t6():Rw():uo(e)?t6():Rw()}function Wi(){const e=Et;return Y=e.end,Et=RU(),Y=e.end,e}function IU(){const e=Y;Et=RU(),Y=e}function jye(e){const t=new Ls(fye);return t.elements=e,t}function n6(e,t,n){const i=new Ls(e==="||"||e==="&&"?mye:hye);return i.operator=e,i.left=t,i.right=n,i}function qye(e,t){const n=new Ls(dye);return n.callee=e,n.arguments=t,n}function Vye(e,t,n){const i=new Ls(pye);return i.test=e,i.consequent=t,i.alternate=n,i}function F3(e){const t=new Ls(OU);return t.name=e,t}function Op(e){const t=new Ls(gye);return t.value=e.value,t.raw=_e.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function i6(e,t,n){const i=new Ls(yye);return i.computed=e==="[",i.object=t,i.property=n,i.computed||(n.member=!0),i}function Wye(e){const t=new Ls(vye);return t.properties=e,t}function r6(e,t,n){const i=new Ls(xye);return i.key=t,i.value=n,i.kind=e,i}function Gye(e,t){const n=new Ls(bye);return n.operator=e,n.argument=t,n.prefix=!0,n}function ht(e,t){var n,i=Array.prototype.slice.call(arguments,2),r=t.replace(/%(\d)/g,(s,a)=>(jx(a<i.length,"Message reference must be in range"),i[a]));throw n=new Error(r),n.index=Y,n.description=r,n}function qx(e){e.type===f0&&ht(e,Aye),e.type===Nc&&ht(e,_ye),e.type===h0&&ht(e,wye),e.type===dc&&ht(e,Eye),e.type===tl&&ht(e,Sye),ht(e,Fn,e.value)}function fi(e){const t=Wi();(t.type!==qi||t.value!==e)&&qx(t)}function It(e){return Et.type===qi&&Et.value===e}function Iw(e){return Et.type===tl&&Et.value===e}function Hye(){const e=[];for(Y=Et.start,fi("[");!It("]");)It(",")?(Wi(),e.push(null)):(e.push(pc()),It("]")||fi(","));return Wi(),jye(e)}function s6(){Y=Et.start;const e=Wi();return e.type===h0||e.type===Nc?(e.octal&&ht(e,FU),Op(e)):F3(e.value)}function Yye(){var e,t,n,i;if(Y=Et.start,e=Et,e.type===dc)return n=s6(),fi(":"),i=pc(),r6("init",n,i);if(e.type===f0||e.type===qi)qx(e);else return t=s6(),fi(":"),i=pc(),r6("init",t,i)}function Xye(){var e=[],t,n,i,r={},s=String;for(Y=Et.start,fi("{");!It("}");)t=Yye(),t.key.type===OU?n=t.key.name:n=s(t.key.value),i="$"+n,Object.prototype.hasOwnProperty.call(r,i)?ht({},Cye):r[i]=!0,e.push(t),It("}")||fi(",");return fi("}"),Wye(e)}function Kye(){fi("(");const e=M3();return fi(")"),e}const Jye={if:1};function Qye(){var e,t,n;if(It("("))return Kye();if(It("["))return Hye();if(It("{"))return Xye();if(e=Et.type,Y=Et.start,e===dc||Jye[Et.value])n=F3(Wi().value);else if(e===h0||e===Nc)Et.octal&&ht(Et,FU),n=Op(Wi());else{if(e===tl)throw new Error(mg);e===Bx?(t=Wi(),t.value=t.value==="true",n=Op(t)):e===Ux?(t=Wi(),t.value=null,n=Op(t)):It("/")||It("/=")?(n=Op(Bye()),IU()):qx(Wi())}return n}function Zye(){const e=[];if(fi("("),!It(")"))for(;Y<ci&&(e.push(pc()),!It(")"));)fi(",");return fi(")"),e}function eve(){Y=Et.start;const e=Wi();return Uye(e)||qx(e),F3(e.value)}function tve(){return fi("."),eve()}function nve(){fi("[");const e=M3();return fi("]"),e}function ive(){var e,t,n;for(e=Qye();;)if(It("."))n=tve(),e=i6(".",e,n);else if(It("("))t=Zye(),e=qye(e,t);else if(It("["))n=nve(),e=i6("[",e,n);else break;return e}function a6(){const e=ive();if(Et.type===qi&&(It("++")||It("--")))throw new Error(mg);return e}function j1(){var e,t;if(Et.type!==qi&&Et.type!==tl)t=a6();else{if(It("++")||It("--"))throw new Error(mg);if(It("+")||It("-")||It("~")||It("!"))e=Wi(),t=j1(),t=Gye(e.value,t);else{if(Iw("delete")||Iw("void")||Iw("typeof"))throw new Error(mg);t=a6()}}return t}function o6(e){let t=0;if(e.type!==qi&&e.type!==tl)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function rve(){var e,t,n,i,r,s,a,o,u,l;if(e=Et,u=j1(),i=Et,r=o6(i),r===0)return u;for(i.prec=r,Wi(),t=[e,Et],a=j1(),s=[u,i,a];(r=o6(Et))>0;){for(;s.length>2&&r<=s[s.length-2].prec;)a=s.pop(),o=s.pop().value,u=s.pop(),t.pop(),n=n6(o,u,a),s.push(n);i=Wi(),i.prec=r,s.push(i),t.push(Et),n=j1(),s.push(n)}for(l=s.length-1,n=s[l],t.pop();l>1;)t.pop(),n=n6(s[l-1].value,s[l-2],n),l-=2;return n}function pc(){var e,t,n;return e=rve(),It("?")&&(Wi(),t=pc(),fi(":"),n=pc(),e=Vye(e,t,n)),e}function M3(){const e=pc();if(It(","))throw new Error(mg);return e}function N3(e){_e=e,Y=0,ci=_e.length,Et=null,IU();const t=M3();if(Et.type!==f0)throw new Error("Unexpect token after expression.");return t}var DU={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function PU(e){function t(a,o,u,l){let c=e(o[0]);return u&&(c=u+"("+c+")",u.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+a+(l<0?"":l===0?"()":"("+o.slice(1).map(e).join(",")+")")}function n(a,o,u){return l=>t(a,l,o,u)}const i="new Date",r="String",s="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(a){a.length<3&&K("Missing arguments to clamp function."),a.length>3&&K("Too many arguments to clamp function.");const o=a.map(e);return"Math.max("+o[1]+", Math.min("+o[2]+","+o[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:i,date:n("getDate",i,0),day:n("getDay",i,0),year:n("getFullYear",i,0),month:n("getMonth",i,0),hours:n("getHours",i,0),minutes:n("getMinutes",i,0),seconds:n("getSeconds",i,0),milliseconds:n("getMilliseconds",i,0),time:n("getTime",i,0),timezoneoffset:n("getTimezoneOffset",i,0),utcdate:n("getUTCDate",i,0),utcday:n("getUTCDay",i,0),utcyear:n("getUTCFullYear",i,0),utcmonth:n("getUTCMonth",i,0),utchours:n("getUTCHours",i,0),utcminutes:n("getUTCMinutes",i,0),utcseconds:n("getUTCSeconds",i,0),utcmilliseconds:n("getUTCMilliseconds",i,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",r,0),lower:n("toLowerCase",r,0),substring:n("substring",r),split:n("split",r),trim:n("trim",r,0),regexp:s,test:n("test",s),if:function(a){a.length<3&&K("Missing arguments to if function."),a.length>3&&K("Too many arguments to if function.");const o=a.map(e);return"("+o[0]+"?"+o[1]+":"+o[2]+")"}}}function sve(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function LU(e){e=e||{};const t=e.allowed?Os(e.allowed):{},n=e.forbidden?Os(e.forbidden):{},i=e.constants||DU,r=(e.functions||PU)(f),s=e.globalvar,a=e.fieldvar,o=Ye(s)?s:m=>`${s}["${m}"]`;let u={},l={},c=0;function f(m){if(ge(m))return m;const y=d[m.type];return y==null&&K("Unsupported type: "+m.type),y(m)}const d={Literal:m=>m.raw,Identifier:m=>{const y=m.name;return c>0?y:ve(n,y)?K("Illegal identifier: "+y):ve(i,y)?i[y]:ve(t,y)?y:(u[y]=1,o(y))},MemberExpression:m=>{const y=!m.computed,v=f(m.object);y&&(c+=1);const b=f(m.property);return v===a&&(l[sve(b)]=1),y&&(c-=1),v+(y?"."+b:"["+b+"]")},CallExpression:m=>{m.callee.type!=="Identifier"&&K("Illegal callee type: "+m.callee.type);const y=m.callee.name,v=m.arguments,b=ve(r,y)&&r[y];return b||K("Unrecognized function: "+y),Ye(b)?b(v):b+"("+v.map(f).join(",")+")"},ArrayExpression:m=>"["+m.elements.map(f).join(",")+"]",BinaryExpression:m=>"("+f(m.left)+" "+m.operator+" "+f(m.right)+")",UnaryExpression:m=>"("+m.operator+f(m.argument)+")",ConditionalExpression:m=>"("+f(m.test)+"?"+f(m.consequent)+":"+f(m.alternate)+")",LogicalExpression:m=>"("+f(m.left)+m.operator+f(m.right)+")",ObjectExpression:m=>"{"+m.properties.map(f).join(",")+"}",Property:m=>{c+=1;const y=f(m.key);return c-=1,y+":"+f(m.value)}};function p(m){const y={code:f(m),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},y}return p.functions=r,p.constants=i,p}const u6=Symbol("vega_selection_getter");function zU(e){return(!e.getter||!e.getter[u6])&&(e.getter=Yr(e.field),e.getter[u6]=!0),e.getter}const R3="intersect",l6="union",ave="vlMulti",ove="vlPoint",c6="or",uve="and",aa="_vgsid_",vg=Yr(aa),lve="E",cve="R",fve="R-E",hve="R-LE",dve="R-RE",pve="E-LT",gve="E-LTE",mve="E-GT",yve="E-GTE",vve="E-VALID",xve="E-ONE",lv="index:unit";function f6(e,t){for(var n=t.fields,i=t.values,r=n.length,s=0,a,o;s<r;++s)if(o=n[s],a=zU(o)(e),Au(a)&&(a=ai(a)),Au(i[s])&&(i[s]=ai(i[s])),Q(i[s])&&Au(i[s][0])&&(i[s]=i[s].map(ai)),o.type===lve){if(Q(i[s])?!i[s].includes(a):a!==i[s])return!1}else if(o.type===cve){if(!$f(a,i[s]))return!1}else if(o.type===dve){if(!$f(a,i[s],!0,!1))return!1}else if(o.type===fve){if(!$f(a,i[s],!1,!1))return!1}else if(o.type===hve){if(!$f(a,i[s],!1,!0))return!1}else if(o.type===pve){if(a>=i[s])return!1}else if(o.type===gve){if(a>i[s])return!1}else if(o.type===mve){if(a<=i[s])return!1}else if(o.type===yve){if(a<i[s])return!1}else if(o.type===vve){if(a===null||isNaN(a))return!1}else if(o.type===xve&&i[s].indexOf(a)===-1)return!1;return!0}function bve(e,t,n){for(var i=this.context.data[e],r=i?i.values.value:[],s=i?i[lv]&&i[lv].value:void 0,a=n===R3,o=r.length,u=0,l,c,f,d,p;u<o;++u)if(l=r[u],s&&a){if(c=c||{},f=c[d=l.unit]||0,f===-1)continue;if(p=f6(t,l),c[d]=p?-1:++f,p&&s.size===1)return!0;if(!p&&f===s.get(d).count)return!1}else if(p=f6(t,l),a^p)return p;return o&&a}const BU=Ph(vg),_ve=BU.left,wve=BU.right;function Eve(e,t,n){const i=this.context.data[e],r=i?i.values.value:[],s=i?i[lv]&&i[lv].value:void 0,a=n===R3,o=vg(t),u=_ve(r,o);if(u===r.length||vg(r[u])!==o)return!1;if(s&&a){if(s.size===1)return!0;if(wve(r,o)-u<s.size)return!1}return!0}function Sve(e,t){return e.map(n=>We(t.fields?{values:t.fields.map(i=>zU(i)(n.datum))}:{[aa]:vg(n.datum)},t))}function Ave(e,t,n,i){for(var r=this.context.data[e],s=r?r.values.value:[],a={},o={},u={},l,c,f,d,p,m,y,v,b,_,E=s.length,S=0,A,$;S<E;++S)if(l=s[S],d=l.unit,c=l.fields,f=l.values,c&&f){for(A=0,$=c.length;A<$;++A)p=c[A],y=a[p.field]||(a[p.field]={}),v=y[d]||(y[d]=[]),u[p.field]=b=p.type.charAt(0),_=Dw[`${b}_union`],y[d]=_(v,pe(f[A]));n&&(v=o[d]||(o[d]=[]),v.push(pe(f).reduce((C,M,N)=>(C[c[N].field]=M,C),{})))}else p=aa,m=vg(l),y=a[p]||(a[p]={}),v=y[d]||(y[d]=[]),v.push(m),n&&(v=o[d]||(o[d]=[]),v.push({[aa]:m}));if(t=t||l6,a[aa]?a[aa]=Dw[`${aa}_${t}`](...Object.values(a[aa])):Object.keys(a).forEach(C=>{a[C]=Object.keys(a[C]).map(M=>a[C][M]).reduce((M,N)=>M===void 0?N:Dw[`${u[C]}_${t}`](M,N))}),s=Object.keys(o),n&&s.length){const C=i?ove:ave;a[C]=t===l6?{[c6]:s.reduce((M,N)=>(M.push(...o[N]),M),[])}:{[uve]:s.map(M=>({[c6]:o[M]}))}}return a}var Dw={[`${aa}_union`]:dre,[`${aa}_intersect`]:fre,E_union:function(e,t){if(!e.length)return t;for(var n=0,i=t.length;n<i;++n)e.includes(t[n])||e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.includes(n)):t},R_union:function(e,t){var n=ai(t[0]),i=ai(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<i&&(e[1]=i),e):[n,i]},R_intersect:function(e,t){var n=ai(t[0]),i=ai(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?i<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>i&&(e[1]=i),e):[n,i]}};const Cve=":",kve="@";function I3(e,t,n,i){t[0].type!==hc&&K("First argument to selection functions must be a string literal.");const r=t[0].value,s=t.length>=2&&ot(t).value,a="unit",o=kve+a,u=Cve+r;s===R3&&!ve(i,o)&&(i[o]=n.getData(r).indataRef(n,a)),ve(i,u)||(i[u]=n.getData(r).tuplesRef())}function UU(e){const t=this.context.data[e];return t?t.values.value:[]}function $ve(e,t,n){const i=this.context.data[e]["index:"+t],r=i?i.value.get(n):void 0;return r&&r.count}function Tve(e,t){const n=this.context.dataflow,i=this.context.data[e],r=i.input;return n.pulse(r,n.changeset().remove(Xr).insert(t)),1}function Ove(e,t,n){if(e){const i=this.context.dataflow,r=e.mark.source;i.pulse(r,i.changeset().encode(e,t))}return n!==void 0?n:e}const p0=e=>function(t,n){const i=this.context.dataflow.locale();return t===null?"null":i[e](n)(t)},Fve=p0("format"),jU=p0("timeFormat"),Mve=p0("utcFormat"),Nve=p0("timeParse"),Rve=p0("utcParse"),r1=new Date(2e3,0,1);function Vx(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(r1.setYear(2e3),r1.setMonth(e),r1.setDate(t),jU.call(this,r1,n))}function Ive(e){return Vx.call(this,e,1,"%B")}function Dve(e){return Vx.call(this,e,1,"%b")}function Pve(e){return Vx.call(this,0,2+e,"%A")}function Lve(e){return Vx.call(this,0,2+e,"%a")}const zve=":",Bve="@",fA="%",qU="$";function D3(e,t,n,i){t[0].type!==hc&&K("First argument to data functions must be a string literal.");const r=t[0].value,s=zve+r;if(!ve(s,i))try{i[s]=n.getData(r).tuplesRef()}catch{}}function Uve(e,t,n,i){t[0].type!==hc&&K("First argument to indata must be a string literal."),t[1].type!==hc&&K("Second argument to indata must be a string literal.");const r=t[0].value,s=t[1].value,a=Bve+s;ve(a,i)||(i[a]=n.getData(r).indataRef(n,s))}function $i(e,t,n,i){if(t[0].type===hc)h6(n,i,t[0].value);else for(e in n.scales)h6(n,i,e)}function h6(e,t,n){const i=fA+n;if(!ve(t,i))try{t[i]=e.scaleRef(n)}catch{}}function Ia(e,t){if(ge(e)){const n=t.scales[e];return n&&Gle(n.value)?n.value:void 0}}function jve(e,t,n){t.__bandwidth=r=>r&&r.bandwidth?r.bandwidth():0,n._bandwidth=$i,n._range=$i,n._scale=$i;const i=r=>"_["+(r.type===hc?le(fA+r.value):le(fA)+"+"+e(r))+"]";return{_bandwidth:r=>`this.__bandwidth(${i(r[0])})`,_range:r=>`${i(r[0])}.range()`,_scale:r=>`${i(r[0])}(${e(r[1])})`}}function P3(e,t){return function(n,i,r){if(n){const s=Ia(n,(r||this).context);return s&&s.path[e](i)}else return t(i)}}const qve=P3("area",ope),Vve=P3("bounds",fpe),Wve=P3("centroid",ype);function Gve(e,t){const n=Ia(e,(t||this).context);return n&&n.scale()}function Hve(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function L3(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(i){e.warn(i)}return n[n.length-1]}function Yve(){return L3(this.context.dataflow,"warn",arguments)}function Xve(){return L3(this.context.dataflow,"info",arguments)}function Kve(){return L3(this.context.dataflow,"debug",arguments)}function Pw(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function hA(e){const t=Du(e),n=Pw(t.r),i=Pw(t.g),r=Pw(t.b);return .2126*n+.7152*i+.0722*r}function Jve(e,t){const n=hA(e),i=hA(t),r=Math.max(n,i),s=Math.min(n,i);return(r+.05)/(s+.05)}function Qve(){const e=[].slice.call(arguments);return e.unshift({}),We(...e)}function VU(e,t){return e===t||e!==e&&t!==t?!0:Q(e)?Q(t)&&e.length===t.length?Zve(e,t):!1:de(e)&&de(t)?WU(e,t):!1}function Zve(e,t){for(let n=0,i=e.length;n<i;++n)if(!VU(e[n],t[n]))return!1;return!0}function WU(e,t){for(const n in e)if(!VU(e[n],t[n]))return!1;return!0}function d6(e){return t=>WU(e,t)}function exe(e,t,n,i,r,s){const a=this.context.dataflow,o=this.context.data[e],u=o.input,l=a.stamp();let c=o.changes,f,d;if(a._trigger===!1||!(u.value.length||t||i))return 0;if((!c||c.stamp<l)&&(o.changes=c=a.changeset(),c.stamp=l,a.runAfter(()=>{o.modified=!0,a.pulse(u,c).run()},!0,1)),n&&(f=n===!0?Xr:Q(n)||Zv(n)?n:d6(n),c.remove(f)),t&&c.insert(t),i&&(f=d6(i),u.value.some(f)?c.remove(f):c.insert(i)),r)for(d in s)c.modify(r,d,s[d]);return 1}function txe(e){const t=e.touches,n=t[0].clientX-t[1].clientX,i=t[0].clientY-t[1].clientY;return Math.hypot(n,i)}function nxe(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const p6={};function ixe(e,t){const n=p6[t]||(p6[t]=Yr(t));return Q(e)?e.map(n):n(e)}function Wx(e){return Q(e)||ArrayBuffer.isView(e)?e:null}function z3(e){return Wx(e)||(ge(e)?e:null)}function rxe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return Wx(e).join(...n)}function sxe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return z3(e).indexOf(...n)}function axe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return z3(e).lastIndexOf(...n)}function oxe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return z3(e).slice(...n)}function uxe(e,t,n){return Ye(n)&&K("Function argument passed to replace."),String(e).replace(t,n)}function lxe(e){return Wx(e).slice().reverse()}function cxe(e){return Wx(e).slice().sort(Ih)}function fxe(e,t,n){return Qk(e||0,t||0,n||0)}function hxe(e,t){const n=Ia(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function dxe(e,t){const n=Ia(e,(t||this).context);return n?n.copy():void 0}function pxe(e,t){const n=Ia(e,(t||this).context);return n?n.domain():[]}function gxe(e,t,n){const i=Ia(e,(n||this).context);return i?Q(t)?(i.invertRange||i.invert)(t):(i.invert||i.invertExtent)(t):void 0}function mxe(e,t){const n=Ia(e,(t||this).context);return n&&n.range?n.range():[]}function yxe(e,t,n){const i=Ia(e,(n||this).context);return i?i(t):void 0}function vxe(e,t,n,i,r){let s=typeof e=="string"?Ia(e,(r||this).context):e;const a=I7(t,n);let o=s.domain(),u=o[0],l=ot(o),c=hi;return l-u?c=E7(s,u,l):s=(s.interpolator?gt("sequential")().interpolator(s.interpolator()):gt("linear")().interpolate(s.interpolate()).range(s.range())).domain([u=0,l=1]),s.ticks&&(o=s.ticks(+i||15),u!==o[0]&&o.unshift(u),l!==ot(o)&&o.push(l)),o.forEach(f=>a.stop(c(f),s(f))),a}function xxe(e,t,n){const i=Ia(e,(n||this).context);return function(r){return i?i.path.context(r)(t):""}}function bxe(e){let t=null;return function(n){return n?ug(n,t=t||ah(e)):e}}const GU=e=>e.data;function HU(e,t){const n=UU.call(t,e);return n.root&&n.root.lookup||{}}function _xe(e,t,n){const i=HU(e,this),r=i[t],s=i[n];return r&&s?r.path(s).map(GU):void 0}function wxe(e,t){const n=HU(e,this)[t];return n?n.ancestors().map(GU):void 0}const YU=()=>typeof window<"u"&&window||null;function Exe(){const e=YU();return e?e.screen:{}}function Sxe(){const e=YU();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function Axe(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function XU(e,t,n){if(!e)return[];const[i,r]=e,s=new pn().set(i[0],i[1],r[0],r[1]),a=n||this.context.dataflow.scenegraph().root;return Mz(a,s,Cxe(t))}function Cxe(e){let t=null;if(e){const n=pe(e.marktype),i=pe(e.markname);t=r=>(!n.length||n.some(s=>r.marktype===s))&&(!i.length||i.some(s=>r.name===s))}return t}function kxe(e,t,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5;e=pe(e);const r=e[e.length-1];return r===void 0||Math.hypot(r[0]-t,r[1]-n)>i?[...e,[t,n]]:e}function $xe(e){return pe(e).reduce((t,n,i)=>{let[r,s]=n;return t+=i==0?`M ${r},${s} `:i===e.length-1?" Z":`L ${r},${s} `},"")}function Txe(e,t,n){const{x:i,y:r,mark:s}=n,a=new pn().set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[u,l]of t)u<a.x1&&(a.x1=u),u>a.x2&&(a.x2=u),l<a.y1&&(a.y1=l),l>a.y2&&(a.y2=l);return a.translate(i,r),XU([[a.x1,a.y1],[a.x2,a.y2]],e,s).filter(u=>Oxe(u.x,u.y,t))}function Oxe(e,t,n){let i=0;for(let r=0,s=n.length-1;r<n.length;s=r++){const[a,o]=n[s],[u,l]=n[r];l>t!=o>t&&e<(a-u)*(t-l)/(o-l)+u&&i++}return i&1}const xg={random(){return Jr()},cumulativeNormal:rx,cumulativeLogNormal:QC,cumulativeUniform:nk,densityNormal:HC,densityLogNormal:JC,densityUniform:tk,quantileNormal:sx,quantileLogNormal:ZC,quantileUniform:ik,sampleNormal:ix,sampleLogNormal:KC,sampleUniform:ek,isArray:Q,isBoolean:Ku,isDate:Au,isDefined(e){return e!==void 0},isNumber:dt,isObject:de,isRegExp:n4,isString:ge,isTuple:Zv,isValid(e){return e!=null&&e===e},toBoolean:CC,toDate(e){return kC(e)},toNumber:ai,toString:$C,indexof:sxe,join:rxe,lastindexof:axe,replace:uxe,reverse:lxe,sort:cxe,slice:oxe,flush:e4,lerp:i4,merge:Qve,pad:a4,peek:ot,pluck:ixe,span:Ug,inrange:$f,truncate:o4,rgb:Du,lab:my,hcl:yy,hsl:py,luminance:hA,contrast:Jve,sequence:pr,format:Fve,utcFormat:Mve,utcParse:Rve,utcOffset:B4,utcSequence:q4,timeFormat:jU,timeParse:Nve,timeOffset:z4,timeSequence:j4,timeUnitSpecifier:$4,monthFormat:Ive,monthAbbrevFormat:Dve,dayFormat:Pve,dayAbbrevFormat:Lve,quarter:KL,utcquarter:JL,week:O4,utcweek:N4,dayofyear:T4,utcdayofyear:M4,warn:Yve,info:Xve,debug:Kve,extent(e){return xa(e)},inScope:Hve,intersect:XU,clampRange:QL,pinchDistance:txe,pinchAngle:nxe,screen:Exe,containerSize:Axe,windowSize:Sxe,bandspace:fxe,setdata:Tve,pathShape:bxe,panLinear:GL,panLog:HL,panPow:YL,panSymlog:XL,zoomLinear:bC,zoomLog:_C,zoomPow:ty,zoomSymlog:wC,encode:Ove,modify:exe,lassoAppend:kxe,lassoPath:$xe,intersectLasso:Txe},Fxe=["view","item","group","xy","x","y"],Mxe="event.vega.",KU="this.",B3={},JU={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${le(qU+e)}]`,functions:Nxe,constants:DU,visitors:B3},dA=LU(JU);function Nxe(e){const t=PU(e);Fxe.forEach(n=>t[n]=Mxe+n);for(const n in xg)t[n]=KU+n;return We(t,jve(e,xg,B3)),t}function ln(e,t,n){return arguments.length===1?xg[e]:(xg[e]=t,n&&(B3[e]=n),dA&&(dA.functions[e]=KU+e),this)}ln("bandwidth",hxe,$i);ln("copy",dxe,$i);ln("domain",pxe,$i);ln("range",mxe,$i);ln("invert",gxe,$i);ln("scale",yxe,$i);ln("gradient",vxe,$i);ln("geoArea",qve,$i);ln("geoBounds",Vve,$i);ln("geoCentroid",Wve,$i);ln("geoShape",xxe,$i);ln("geoScale",Gve,$i);ln("indata",$ve,Uve);ln("data",UU,D3);ln("treePath",_xe,D3);ln("treeAncestors",wxe,D3);ln("vlSelectionTest",bve,I3);ln("vlSelectionIdTest",Eve,I3);ln("vlSelectionResolve",Ave,I3);ln("vlSelectionTuples",Sve);function Sa(e,t){const n={};let i;try{e=ge(e)?e:le(e)+"",i=N3(e)}catch{K("Expression parse error: "+e)}i.visit(s=>{if(s.type!==TU)return;const a=s.callee.name,o=JU.visitors[a];o&&o(a,s.arguments,t,n)});const r=dA(i);return r.globals.forEach(s=>{const a=qU+s;!ve(n,a)&&t.getSignal(s)&&(n[a]=t.signalRef(s))}),{$expr:We({code:r.code},t.options.ast?{ast:i}:null),$fields:r.fields,$params:n}}function Rxe(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(i=>t.parseOperator(i)),n.forEach(i=>t.parseOperatorParameters(i)),(e.streams||[]).forEach(i=>t.parseStream(i)),(e.updates||[]).forEach(i=>t.parseUpdate(i)),t.resolve()}const Ixe=Os(["rule"]),g6=Os(["group","image","rect"]);function Dxe(e,t){let n="";return Ixe[t]||(e.x2&&(e.x?(g6[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(g6[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function U3(e){return(e+"").toLowerCase()}function Pxe(e){return U3(e)==="operator"}function Lxe(e){return U3(e)==="collect"}function Jd(e,t,n){n.endsWith(";")||(n="return("+n+");");const i=Function(...t.concat(n));return e&&e.functions?i.bind(e.functions):i}function zxe(e,t,n,i){return`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${n}
  : (u > v || v == null) && u != null ? ${i}
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}
  : v !== v && u === u ? ${i} : `}var Bxe={operator:(e,t)=>Jd(e,["_"],t.code),parameter:(e,t)=>Jd(e,["datum","_"],t.code),event:(e,t)=>Jd(e,["event"],t.code),handler:(e,t)=>{const n=`var datum=event.item&&event.item.datum;return ${t.code};`;return Jd(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:i}=t;let r="var o=item,datum=o.datum,m=0,$;";for(const s in i){const a="o["+le(s)+"]";r+=`$=${i[s].code};if(${a}!==$)${a}=$,m=1;`}return r+=Dxe(i,n),r+="return m;",Jd(e,["item","_"],r)},codegen:{get(e){const t=`[${e.map(le).join("][")}]`,n=Function("_",`return _${t};`);return n.path=t,n},comparator(e,t){let n;const i=(s,a)=>{const o=t[a];let u,l;return s.path?(u=`a${s.path}`,l=`b${s.path}`):((n=n||{})["f"+a]=s,u=`this.f${a}(a)`,l=`this.f${a}(b)`),zxe(u,l,-o,o)},r=Function("a","b","var u, v; return "+e.map(i).join("")+"0;");return n?r.bind(n):r}}};function Uxe(e){const t=this;Pxe(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function jxe(e){const t=this;if(e.params){const n=t.get(e.id);n||K("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function qxe(e,t){t=t||{};const n=this;for(const i in e){const r=e[i];t[i]=Q(r)?r.map(s=>m6(s,n,t)):m6(r,n,t)}return t}function m6(e,t,n){if(!e||!de(e))return e;for(let i=0,r=y6.length,s;i<r;++i)if(s=y6[i],ve(e,s.key))return s.parse(e,t,n);return e}var y6=[{key:"$ref",parse:Vxe},{key:"$key",parse:Gxe},{key:"$expr",parse:Wxe},{key:"$field",parse:Hxe},{key:"$encode",parse:Xxe},{key:"$compare",parse:Yxe},{key:"$context",parse:Kxe},{key:"$subflow",parse:Jxe},{key:"$tupleid",parse:Qxe}];function Vxe(e,t){return t.get(e.$ref)||K("Operator not defined: "+e.$ref)}function Wxe(e,t,n){e.$params&&t.parseParameters(e.$params,n);const i="e:"+e.$expr.code;return t.fn[i]||(t.fn[i]=tr(t.parameterExpression(e.$expr),e.$fields))}function Gxe(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=AC(e.$key,e.$flat,t.expr.codegen))}function Hxe(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=Yr(e.$field,e.$name,t.expr.codegen))}function Yxe(e,t){const n="c:"+e.$compare+"_"+e.$order,i=pe(e.$compare).map(r=>r&&r.$tupleid?$e:r);return t.fn[n]||(t.fn[n]=EC(i,e.$order,t.expr.codegen))}function Xxe(e,t){const n=e.$encode,i={};for(const r in n){const s=n[r];i[r]=tr(t.encodeExpression(s.$expr),s.$fields),i[r].output=s.$output}return i}function Kxe(e,t){return t}function Jxe(e,t){const n=e.$subflow;return function(i,r,s){const a=t.fork().parse(n),o=a.get(n.operators[0].id),u=a.signals.parent;return u&&u.set(s),o.detachSubflow=()=>t.detach(a),o}}function Qxe(){return $e}function Zxe(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,i=e.stream!=null?t.get(e.stream):void 0,r;e.source?i=t.events(e.source,e.type,n):e.merge&&(r=e.merge.map(s=>t.get(s)),i=r[0].merge.apply(r[0],r.slice(1))),e.between&&(r=e.between.map(s=>t.get(s)),i=i.between(r[0],r[1])),e.filter&&(i=i.filter(n)),e.throttle!=null&&(i=i.throttle(+e.throttle)),e.debounce!=null&&(i=i.debounce(+e.debounce)),i==null&&K("Invalid stream definition: "+JSON.stringify(e)),e.consume&&i.consume(!0),t.stream(e,i)}function ebe(e){var t=this,n=de(n=e.source)?n.$ref:n,i=t.get(n),r=null,s=e.update,a=void 0;i||K("Source not defined: "+e.source),r=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),s&&s.$expr&&(s.$params&&(a=t.parseParameters(s.$params)),s=t.handlerExpression(s.$expr)),t.update(e,i,r,s,a)}const tbe={skip:!0};function nbe(e){var t=this,n={};if(e.signals){var i=n.signals={};Object.keys(t.signals).forEach(s=>{const a=t.signals[s];e.signals(s,a)&&(i[s]=a.value)})}if(e.data){var r=n.data={};Object.keys(t.data).forEach(s=>{const a=t.data[s];e.data(s,a)&&(r[s]=a.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(s=>s.getState(e))),n}function ibe(e){var t=this,n=t.dataflow,i=e.data,r=e.signals;Object.keys(r||{}).forEach(s=>{n.update(t.signals[s],r[s],tbe)}),Object.keys(i||{}).forEach(s=>{n.pulse(t.data[s].input,n.changeset().remove(Xr).insert(i[s]))}),(e.subcontext||[]).forEach((s,a)=>{const o=t.subcontext[a];o&&o.setState(s)})}function QU(e,t,n,i){return new ZU(e,t,n,i)}function ZU(e,t,n,i){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=i||Bxe,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function v6(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}ZU.prototype=v6.prototype={fork(){const e=new v6(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,i=n.dataflow,r=e.value;if(n.set(e.id,t),Lxe(e.type)&&r&&(r.$ingest?i.ingest(t,r.$ingest,r.$format):r.$request?i.preload(t,r.$request,r.$format):i.pulse(t,i.changeset().insert(r))),e.root&&(n.root=t),e.parent){let s=n.get(e.parent.$ref);s?(i.connect(s,[t]),t.targets().add(s)):(n.unresolved=n.unresolved||[]).push(()=>{s=n.get(e.parent.$ref),i.connect(s,[t]),t.targets().add(s)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const s in e.data){const a=n.data[s]||(n.data[s]={});e.data[s].forEach(o=>a[o]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[U3(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,i,r){this.dataflow.on(t,n,i,r,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:Rxe,parseOperator:Uxe,parseOperatorParameters:jxe,parseParameters:qxe,parseStream:Zxe,parseUpdate:ebe,getState:nbe,setState:ibe};function rbe(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),ej(t,e.description()))}function ej(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function sbe(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const Lw="default";function abe(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:Lw,item:null}));e.on(e.events("view","pointermove"),t,(n,i)=>{const r=t.value,s=r?ge(r)?r:r.user:Lw,a=i.item&&i.item.cursor||null;return r&&s===r.user&&a==r.item?r:{user:s,item:a}}),e.add(null,function(n){let i=n.cursor,r=this.value;return ge(i)||(r=i.item,i=i.user),pA(e,i&&i!==Lw?i:r||i),r},{cursor:t})}function pA(e,t){const n=e.globalCursor()?typeof document<"u"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function cv(e,t){var n=e._runtime.data;return ve(n,t)||K("Unrecognized data set: "+t),n[t]}function obe(e,t){return arguments.length<2?cv(this,e).values.value:Gx.call(this,e,Oc().remove(Xr).insert(t))}function Gx(e,t){m8(t)||K("Second argument to changes must be a changeset.");const n=cv(this,e);return n.modified=!0,this.pulse(n.input,t)}function ube(e,t){return Gx.call(this,e,Oc().insert(t))}function lbe(e,t){return Gx.call(this,e,Oc().remove(t))}function tj(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function nj(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function Hx(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function cbe(e){var t=Hx(e),n=tj(e),i=nj(e);e._renderer.background(e.background()),e._renderer.resize(n,i,t),e._handler.origin(t),e._resizeListeners.forEach(r=>{try{r(n,i)}catch(s){e.error(s)}})}function fbe(e,t,n){var i=e._renderer,r=i&&i.canvas(),s,a,o;return r&&(o=Hx(e),a=t.changedTouches?t.changedTouches[0]:t,s=Mx(a,r),s[0]-=o[0],s[1]-=o[1]),t.dataflow=e,t.item=n,t.vega=hbe(e,n,s),t}function hbe(e,t,n){const i=t?t.mark.marktype==="group"?t:t.mark.group:null;function r(a){var o=i,u;if(a){for(u=t;u;u=u.mark.group)if(u.mark.name===a){o=u;break}}return o&&o.mark&&o.mark.interactive?o:{}}function s(a){if(!a)return n;ge(a)&&(a=r(a));const o=n.slice();for(;a;)o[0]-=a.x||0,o[1]-=a.y||0,a=a.mark&&a.mark.group;return o}return{view:di(e),item:di(t||{}),group:r,xy:s,x:a=>s(a)[0],y:a=>s(a)[1]}}const x6="view",dbe="timer",pbe="window",gbe={trap:!1};function mbe(e){const t=We({defaults:{}},e),n=(i,r)=>{r.forEach(s=>{Q(i[s])&&(i[s]=Os(i[s]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function ij(e,t,n,i){e._eventListeners.push({type:n,sources:pe(t),handler:i})}function ybe(e,t){var n=e._eventConfig.defaults,i=n.prevent,r=n.allow;return i===!1||r===!0?!1:i===!0||r===!1?!0:i?i[t]:r?!r[t]:e.preventDefault()}function s1(e,t,n){const i=e._eventConfig&&e._eventConfig[t];return i===!1||de(i)&&!i[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function vbe(e,t,n){var i=this,r=new nx(n),s=function(l,c){i.runAsync(null,()=>{e===x6&&ybe(i,t)&&l.preventDefault(),r.receive(fbe(i,l,c))})},a;if(e===dbe)s1(i,"timer",t)&&i.timer(s,t);else if(e===x6)s1(i,"view",t)&&i.addEventListener(t,s,gbe);else if(e===pbe?s1(i,"window",t)&&typeof window<"u"&&(a=[window]):typeof document<"u"&&s1(i,"selector",t)&&(a=Array.from(document.querySelectorAll(e))),!a)i.warn("Can not resolve event source: "+e);else{for(var o=0,u=a.length;o<u;++o)a[o].addEventListener(t,s);ij(i,a,t,s)}return r}function b6(e){return e.item}function _6(e){return e.item.mark.source}function w6(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function xbe(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","pointerover",b6),_6,w6(e)),this.on(this.events("view","pointerout",b6),_6,w6(t)),this}function bbe(){var e=this._tooltip,t=this._timers,n=this._handler.handlers(),i=this._eventListeners,r,s,a,o,u;for(r=t.length;--r>=0;)t[r].stop();for(r=i.length;--r>=0;)for(a=i[r],s=a.sources.length;--s>=0;)a.sources[s].removeEventListener(a.type,a.handler);for(e&&e.call(this,this._handler,null,null,null),r=n.length;--r>=0;)u=n[r].type,o=n[r].handler,this._handler.off(u,o);return this}function vr(e,t,n){const i=document.createElement(e);for(const r in t)i.setAttribute(r,t[r]);return n!=null&&(i.textContent=n),i}const _be="vega-bind",wbe="vega-bind-name",Ebe="vega-bind-radio";function Sbe(e,t,n){if(!t)return;const i=n.param;let r=n.state;return r||(r=n.state={elements:null,active:!1,set:null,update:a=>{a!=e.signal(i.signal)&&e.runAsync(null,()=>{r.source=!0,e.signal(i.signal,a)})}},i.debounce&&(r.update=SC(i.debounce,r.update))),(i.input==null&&i.element?Abe:kbe)(r,t,i,e),r.active||(e.on(e._signals[i.signal],null,()=>{r.source?r.source=!1:r.set(e.signal(i.signal))}),r.active=!0),r}function Abe(e,t,n,i){const r=n.event||"input",s=()=>e.update(t.value);i.signal(n.signal,t.value),t.addEventListener(r,s),ij(i,t,r,s),e.set=a=>{t.value=a,t.dispatchEvent(Cbe(r))}}function Cbe(e){return typeof Event<"u"?new Event(e):{type:e}}function kbe(e,t,n,i){const r=i.signal(n.signal),s=vr("div",{class:_be}),a=n.input==="radio"?s:s.appendChild(vr("label"));a.appendChild(vr("span",{class:wbe},n.name||n.signal)),t.appendChild(s);let o=$be;switch(n.input){case"checkbox":o=Tbe;break;case"select":o=Obe;break;case"radio":o=Fbe;break;case"range":o=Mbe;break}o(e,a,n,r)}function $be(e,t,n,i){const r=vr("input");for(const s in n)s!=="signal"&&s!=="element"&&r.setAttribute(s==="input"?"type":s,n[s]);r.setAttribute("name",n.signal),r.value=i,t.appendChild(r),r.addEventListener("input",()=>e.update(r.value)),e.elements=[r],e.set=s=>r.value=s}function Tbe(e,t,n,i){const r={type:"checkbox",name:n.signal};i&&(r.checked=!0);const s=vr("input",r);t.appendChild(s),s.addEventListener("change",()=>e.update(s.checked)),e.elements=[s],e.set=a=>s.checked=!!a||null}function Obe(e,t,n,i){const r=vr("select",{name:n.signal}),s=n.labels||[];n.options.forEach((a,o)=>{const u={value:a};fv(a,i)&&(u.selected=!0),r.appendChild(vr("option",u,(s[o]||a)+""))}),t.appendChild(r),r.addEventListener("change",()=>{e.update(n.options[r.selectedIndex])}),e.elements=[r],e.set=a=>{for(let o=0,u=n.options.length;o<u;++o)if(fv(n.options[o],a)){r.selectedIndex=o;return}}}function Fbe(e,t,n,i){const r=vr("span",{class:Ebe}),s=n.labels||[];t.appendChild(r),e.elements=n.options.map((a,o)=>{const u={type:"radio",name:n.signal,value:a};fv(a,i)&&(u.checked=!0);const l=vr("input",u);l.addEventListener("change",()=>e.update(a));const c=vr("label",{},(s[o]||a)+"");return c.prepend(l),r.appendChild(c),l}),e.set=a=>{const o=e.elements,u=o.length;for(let l=0;l<u;++l)fv(o[l].value,a)&&(o[l].checked=!0)}}function Mbe(e,t,n,i){i=i!==void 0?i:(+n.max+ +n.min)/2;const r=n.max!=null?n.max:Math.max(100,+i)||100,s=n.min||Math.min(0,r,+i)||0,a=n.step||Nu(s,r,100),o=vr("input",{type:"range",name:n.signal,min:s,max:r,step:a});o.value=i;const u=vr("span",{},+i);t.appendChild(o),t.appendChild(u);const l=()=>{u.textContent=o.value,e.update(+o.value)};o.addEventListener("input",l),o.addEventListener("change",l),e.elements=[o],e.set=c=>{o.value=c,u.textContent=c}}function fv(e,t){return e===t||e+""==t+""}function rj(e,t,n,i,r,s){return t=t||new i(e.loader()),t.initialize(n,tj(e),nj(e),Hx(e),r,s).background(e.background())}function j3(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function Nbe(e,t,n,i){const r=new i(e.loader(),j3(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,Hx(e),e);return t&&t.handlers().forEach(s=>{r.on(s.type,s.handler)}),r}function Rbe(e,t){const n=this,i=n._renderType,r=n._eventConfig.bind,s=Nx(i);e=n._el=e?zw(n,e,!0):null,rbe(n),s||n.error("Unrecognized renderer type: "+i);const a=s.handler||a0,o=e?s.renderer:s.headless;return n._renderer=o?rj(n,n._renderer,e,o):null,n._handler=Nbe(n,n._handler,e,a),n._redraw=!0,e&&r!=="none"&&(t=t?n._elBind=zw(n,t,!0):e.appendChild(vr("form",{class:"vega-bindings"})),n._bind.forEach(u=>{u.param.element&&r!=="container"&&(u.element=zw(n,u.param.element,!!u.param.input))}),n._bind.forEach(u=>{Sbe(n,u.element||t,u)})),n}function zw(e,t,n){if(typeof t=="string")if(typeof document<"u"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.textContent=""}catch(i){t=null,e.error(i)}return t}const Qd=e=>+e||0,Ibe=e=>({top:e,bottom:e,left:e,right:e});function E6(e){return de(e)?{top:Qd(e.top),bottom:Qd(e.bottom),left:Qd(e.left),right:Qd(e.right)}:Ibe(Qd(e))}async function q3(e,t,n,i){const r=Nx(t),s=r&&r.headless;return s||K("Unrecognized renderer type: "+t),await e.runAsync(),rj(e,null,null,s,n,i).renderAsync(e._scenegraph.root)}async function Dbe(e,t){e!==vu.Canvas&&e!==vu.SVG&&e!==vu.PNG&&K("Unrecognized image type: "+e);const n=await q3(this,e,t);return e===vu.SVG?Pbe(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function Pbe(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function Lbe(e,t){return(await q3(this,vu.Canvas,e,t)).canvas()}async function zbe(e){return(await q3(this,vu.SVG,e)).svg()}function Bbe(e,t,n){return QU(e,eh,xg,n).parse(t)}function Ube(e){var t=this._runtime.scales;return ve(t,e)||K("Unrecognized scale or projection: "+e),t[e].value}var sj="width",aj="height",V3="padding",S6={skip:!0};function oj(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===V3?i.left+i.right:0)}function uj(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===V3?i.top+i.bottom:0)}function jbe(e){var t=e._signals,n=t[sj],i=t[aj],r=t[V3];function s(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,o=>{e._width=o.size,e._viewWidth=oj(e,o.size),s()},{size:n}),e._resizeHeight=e.add(null,o=>{e._height=o.size,e._viewHeight=uj(e,o.size),s()},{size:i});const a=e.add(null,s,{pad:r});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=i.rank+1,a.rank=r.rank+1}function qbe(e,t,n,i,r,s){this.runAfter(a=>{let o=0;a._autosize=0,a.width()!==n&&(o=1,a.signal(sj,n,S6),a._resizeWidth.skip(!0)),a.height()!==i&&(o=1,a.signal(aj,i,S6),a._resizeHeight.skip(!0)),a._viewWidth!==e&&(a._resize=1,a._viewWidth=e),a._viewHeight!==t&&(a._resize=1,a._viewHeight=t),(a._origin[0]!==r[0]||a._origin[1]!==r[1])&&(a._resize=1,a._origin=r),o&&a.run("enter"),s&&a.runAfter(u=>u.resize())},!1,1)}function Vbe(e){return this._runtime.getState(e||{data:Wbe,signals:Gbe,recurse:!0})}function Wbe(e,t){return t.modified&&Q(t.input.value)&&!e.startsWith("_:vega:_")}function Gbe(e,t){return!(e==="parent"||t instanceof eh.proxy)}function Hbe(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function Ybe(e,t){function n(i){e({timestamp:Date.now(),elapsed:i})}this._timers.push(v0e(n,t))}function Xbe(e,t,n,i){const r=e.element();r&&r.setAttribute("title",Kbe(i))}function Kbe(e){return e==null?"":Q(e)?lj(e):de(e)&&!Au(e)?Jbe(e):e+""}function Jbe(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(Q(n)?lj(n):cj(n))}).join(`
`)}function lj(e){return"["+e.map(cj).join(", ")+"]"}function cj(e){return Q(e)?"[…]":de(e)&&!Au(e)?"{…}":e}function Qbe(){if(this.renderer()==="canvas"&&this._renderer._canvas){let e=null;const t=()=>{e?.();const n=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);n.addEventListener("change",t),e=()=>{n.removeEventListener("change",t)},this._renderer._canvas.getContext("2d").pixelRatio=window.devicePixelRatio||1,this._redraw=!0,this._resize=1,this.resize().runAsync()};t()}}function fj(e,t){const n=this;if(t=t||{},Pf.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const s=We({},e.locale,t.locale);n.locale(a8(s.number,s.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||vu.Canvas,n._scenegraph=new sz;const i=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||Xbe,n._redraw=!0,n._handler=new a0().scene(i),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=mbe(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const r=Bbe(n,e,t.expr);n._runtime=r,n._signals=r.signals,n._bind=(e.bindings||[]).map(s=>({state:null,param:We({},s)})),r.root&&r.root.set(i),i.source=r.data.root.input,n.pulse(r.data.root.input,n.changeset().insert(i.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=oj(n,n._width),n._viewHeight=uj(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,jbe(n),sbe(n),abe(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind),t.watchPixelRatio&&n._watchPixelRatio()}function a1(e,t){return ve(e._signals,t)?e._signals[t]:K("Unrecognized signal name: "+le(t))}function hj(e,t){const n=(e._targets||[]).filter(i=>i._update&&i._update.handler===t);return n.length?n[0]:null}function A6(e,t,n,i){let r=hj(n,i);return r||(r=j3(e,()=>i(t,n.value)),r.handler=i,e.on(n,null,r)),e}function C6(e,t,n){const i=hj(t,n);return i&&t._targets.remove(i),e}ce(fj,Pf,{async evaluate(e,t,n){if(await Pf.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,cbe(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(i){this.error(i)}return n&&A1(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&ej(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const i=a1(this,e);return arguments.length===1?i.value:this.update(i,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",E6(e)):E6(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(Nx(e)||K("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(Pf.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(a1(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:qbe,addEventListener(e,t,n){let i=t;return n&&n.trap===!1||(i=j3(this,t),i.raw=t),this._handler.on(e,i),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),i=n.length,r,s;--i>=0;)if(s=n[i].type,r=n[i].handler,e===s&&(t===r||t===r.raw)){this._handler.off(s,r);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.includes(e)||t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return A6(this,e,a1(this,e),t)},removeSignalListener(e,t){return C6(this,a1(this,e),t)},addDataListener(e,t){return A6(this,e,cv(this,e).values,t)},removeDataListener(e,t){return C6(this,cv(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=pA(this,null);this._globalCursor=!!e,t&&pA(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:Ybe,events:vbe,finalize:bbe,hover:xbe,data:obe,change:Gx,insert:ube,remove:lbe,scale:Ube,initialize:Rbe,toImageURL:Dbe,toCanvas:Lbe,toSVG:zbe,getState:Vbe,setState:Hbe,_watchPixelRatio:Qbe});const Zbe="view",hv="[",dv="]",dj="{",pj="}",e2e=":",gj=",",t2e="@",n2e=">",i2e=/[[\]{}]/,r2e={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let mj,yj;function nl(e,t,n){return mj=t||Zbe,yj=n||r2e,vj(e.trim()).map(gA)}function s2e(e){return yj[e]}function Gp(e,t,n,i,r){const s=e.length;let a=0,o;for(;t<s;++t){if(o=e[t],!a&&o===n)return t;r&&r.indexOf(o)>=0?--a:i&&i.indexOf(o)>=0&&++a}return t}function vj(e){const t=[],n=e.length;let i=0,r=0;for(;r<n;)r=Gp(e,r,gj,hv+dj,dv+pj),t.push(e.substring(i,r).trim()),i=++r;if(t.length===0)throw"Empty event selector: "+e;return t}function gA(e){return e[0]==="["?a2e(e):o2e(e)}function a2e(e){const t=e.length;let n=1,i;if(n=Gp(e,n,dv,hv,dv),n===t)throw"Empty between selector: "+e;if(i=vj(e.substring(1,n)),i.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==n2e)throw"Expected '>' after between selector: "+e;i=i.map(gA);const r=gA(e.slice(1).trim());return r.between?{between:i,stream:r}:(r.between=i,r)}function o2e(e){const t={source:mj},n=[];let i=[0,0],r=0,s=0,a=e.length,o=0,u,l;if(e[a-1]===pj){if(o=e.lastIndexOf(dj),o>=0){try{i=u2e(e.substring(o+1,a-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,o).trim(),a=e.length}else throw"Unmatched right brace: "+e;o=0}if(!a)throw e;if(e[0]===t2e&&(r=++o),u=Gp(e,o,e2e),u<a&&(n.push(e.substring(s,u).trim()),s=o=++u),o=Gp(e,o,hv),o===a)n.push(e.substring(s,a).trim());else if(n.push(e.substring(s,o).trim()),l=[],s=++o,s===a)throw"Unmatched left bracket: "+e;for(;o<a;){if(o=Gp(e,o,dv),o===a)throw"Unmatched left bracket: "+e;if(l.push(e.substring(s,o).trim()),o<a-1&&e[++o]!==hv)throw"Expected left bracket: "+e;s=++o}if(!(a=n.length)||i2e.test(n[a-1]))throw"Invalid event selector: "+e;return a>1?(t.type=n[1],r?t.markname=n[0].slice(1):s2e(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),i[0]&&(t.throttle=i[0]),i[1]&&(t.debounce=i[1]),t}function u2e(e){const t=e.split(gj);if(!e.length||t.length>2)throw e;return t.map(n=>{const i=+n;if(i!==i)throw e;return i})}function l2e(e){return de(e)?e:{type:e||"pad"}}const Zd=e=>+e||0,c2e=e=>({top:e,bottom:e,left:e,right:e});function f2e(e){return de(e)?e.signal?e:{top:Zd(e.top),bottom:Zd(e.bottom),left:Zd(e.left),right:Zd(e.right)}:c2e(Zd(e))}const Mn=e=>de(e)&&!Q(e)?We({},e):{value:e};function k6(e,t,n,i){return n!=null?(de(n)&&!Q(n)||Q(n)&&n.length&&de(n[0])?e.update[t]=n:e[i||"enter"][t]={value:n},1):0}function Xn(e,t,n){for(const i in t)k6(e,i,t[i]);for(const i in n)k6(e,i,n[i],"update")}function Hh(e,t,n){for(const i in t)n&&ve(n,i)||(e[i]=We(e[i]||{},t[i]));return e}function Af(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const W3="mark",G3="frame",H3="scope",h2e="axis",d2e="axis-domain",p2e="axis-grid",g2e="axis-label",m2e="axis-tick",y2e="axis-title",v2e="legend",x2e="legend-band",b2e="legend-entry",_2e="legend-gradient",xj="legend-label",w2e="legend-symbol",E2e="legend-title",S2e="title",A2e="title-text",C2e="title-subtitle";function k2e(e,t,n,i,r){const s={},a={};let o,u,l,c;u="lineBreak",t==="text"&&r[u]!=null&&!Af(u,e)&&Bw(s,u,r[u]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),c=n===G3?r.group:n===W3?We({},r.mark,r[t]):null;for(u in c)l=Af(u,e)||(u==="fill"||u==="stroke")&&(Af("fill",e)||Af("stroke",e)),l||Bw(s,u,c[u]);pe(i).forEach(f=>{const d=r.style&&r.style[f];for(const p in d)Af(p,e)||Bw(s,p,d[p])}),e=We({},e);for(u in s)c=s[u],c.signal?(o=o||{})[u]=c:a[u]=c;return e.enter=We(a,e.enter),o&&(e.update=We(o,e.update)),e}function Bw(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const bj=e=>ge(e)?le(e):e.signal?`(${e.signal})`:_j(e);function Yx(e){if(e.gradient!=null)return T2e(e);let t=e.signal?`(${e.signal})`:e.color?$2e(e.color):e.field!=null?_j(e.field):e.value!==void 0?le(e.value):void 0;return e.scale!=null&&(t=O2e(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t=`pow(${t},${q1(e.exponent)})`),e.mult!=null&&(t+=`*${q1(e.mult)}`),e.offset!=null&&(t+=`+${q1(e.offset)}`),e.round&&(t=`round(${t})`),t}const o1=(e,t,n,i)=>`(${e}(${[t,n,i].map(Yx).join(",")})+'')`;function $2e(e){return e.c?o1("hcl",e.h,e.c,e.l):e.h||e.s?o1("hsl",e.h,e.s,e.l):e.l||e.a?o1("lab",e.l,e.a,e.b):e.r||e.g||e.b?o1("rgb",e.r,e.g,e.b):null}function T2e(e){const t=[e.start,e.stop,e.count].map(n=>n==null?null:le(n));for(;t.length&&ot(t)==null;)t.pop();return t.unshift(bj(e.gradient)),`gradient(${t.join(",")})`}function q1(e){return de(e)?"("+Yx(e)+")":e}function _j(e){return wj(de(e)?e:{datum:e})}function wj(e){let t,n,i;if(e.signal)t="datum",i=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(i=e.parent,t+=".datum"):i=e.group}else e.datum?(t="datum",i=e.datum):K("Invalid field reference: "+le(e));return e.signal||(i=ge(i)?Ta(i).map(le).join("]["):wj(i)),t+"["+i+"]"}function O2e(e,t){const n=bj(e.scale);return e.range!=null?t=`lerp(_range(${n}), ${+e.range})`:(t!==void 0&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(+e.band==1?"":"*"+q1(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),t==null&&(t="0")),t}function F2e(e){let t="";return e.forEach(n=>{const i=Yx(n);t+=n.test?`(${n.test})?${i}:`:i}),ot(t)===":"&&(t+="null"),t}function Ej(e,t,n,i,r,s){const a={};s=s||{},s.encoders={$encode:a},e=k2e(e,t,n,i,r.config);for(const o in e)a[o]=M2e(e[o],t,s,r);return s}function M2e(e,t,n,i){const r={},s={};for(const a in e)e[a]!=null&&(r[a]=R2e(N2e(e[a]),i,n,s));return{$expr:{marktype:t,channels:r},$fields:Object.keys(s),$output:Object.keys(e)}}function N2e(e){return Q(e)?F2e(e):Yx(e)}function R2e(e,t,n,i){const r=Sa(e,t);return r.$fields.forEach(s=>i[s]=1),We(n,r.$params),r.$expr}const I2e="outer",D2e=["value","update","init","react","bind"];function $6(e,t){K(e+' for "outer" push: '+le(t))}function Sj(e,t){const n=e.name;if(e.push===I2e)t.signals[n]||$6("No prior signal definition",n),D2e.forEach(i=>{e[i]!==void 0&&$6("Invalid property ",i)});else{const i=t.addSignal(n,e.value);e.react===!1&&(i.react=!1),e.bind&&t.addBinding(n,e.bind)}}function mA(e,t,n,i){this.id=-1,this.type=e,this.value=t,this.params=n,i&&(this.parent=i)}function Xx(e,t,n,i){return new mA(e,t,n,i)}function pv(e,t){return Xx("operator",e,t)}function ke(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function bg(e,t){return t?{$field:e,$name:t}:{$field:e}}const yA=bg("key");function T6(e,t){return{$compare:e,$order:t}}function P2e(e,t){const n={$key:e};return t&&(n.$flat=!0),n}const L2e="ascending",z2e="descending";function B2e(e){return de(e)?(e.order===z2e?"-":"+")+Kx(e.op,e.field):""}function Kx(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const Y3="scope",vA="view";function En(e){return e&&e.signal}function U2e(e){return e&&e.expr}function V1(e){if(En(e))return!0;if(de(e)){for(const t in e)if(V1(e[t]))return!0}return!1}function ys(e,t){return e??t}function Ql(e){return e&&e.signal||e}const O6="timer";function _g(e,t){return(e.merge?q2e:e.stream?V2e:e.type?W2e:K("Invalid stream specification: "+le(e)))(e,t)}function j2e(e){return e===Y3?vA:e||vA}function q2e(e,t){const n=e.merge.map(r=>_g(r,t)),i=X3({merge:n},e,t);return t.addStream(i).id}function V2e(e,t){const n=_g(e.stream,t),i=X3({stream:n},e,t);return t.addStream(i).id}function W2e(e,t){let n;e.type===O6?(n=t.event(O6,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(j2e(e.source),e.type);const i=X3({stream:n},e,t);return Object.keys(i).length===1?n:t.addStream(i).id}function X3(e,t,n){let i=t.between;return i&&(i.length!==2&&K('Stream "between" parameter must have 2 entries: '+le(t)),e.between=[_g(i[0],n),_g(i[1],n)]),i=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&i.push(G2e(t.marktype,t.markname,t.markrole)),t.source===Y3&&i.push("inScope(event.item)"),i.length&&(e.filter=Sa("("+i.join(")&&(")+")",n).$expr),(i=t.throttle)!=null&&(e.throttle=+i),(i=t.debounce)!=null&&(e.debounce=+i),t.consume&&(e.consume=!0),e}function G2e(e,t,n){const i="event.item";return i+(e&&e!=="*"?"&&"+i+".mark.marktype==='"+e+"'":"")+(n?"&&"+i+".mark.role==='"+n+"'":"")+(t?"&&"+i+".mark.name==='"+t+"'":"")}const H2e={code:"_.$value",ast:{type:"Identifier",value:"value"}};function Y2e(e,t,n){const i=e.encode,r={target:n};let s=e.events,a=e.update,o=[];s||K("Signal update missing events specification."),ge(s)&&(s=nl(s,t.isSubscope()?Y3:vA)),s=pe(s).filter(u=>u.signal||u.scale?(o.push(u),0):1),o.length>1&&(o=[K2e(o)]),s.length&&o.push(s.length>1?{merge:s}:s[0]),i!=null&&(a&&K("Signal encode and update are mutually exclusive."),a="encode(item(),"+le(i)+")"),r.update=ge(a)?Sa(a,t):a.expr!=null?Sa(a.expr,t):a.value!=null?a.value:a.signal!=null?{$expr:H2e,$params:{$value:t.signalRef(a.signal)}}:K("Invalid signal update specification."),e.force&&(r.options={force:!0}),o.forEach(u=>t.addUpdate(We(X2e(u,t),r)))}function X2e(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):_g(e,t)}}function K2e(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function J2e(e,t){const n=t.getSignal(e.name);let i=e.update;e.init&&(i?K("Signals can not include both init and update expressions."):(i=e.init,n.initonly=!0)),i&&(i=Sa(i,t),n.update=i.$expr,n.params=i.$params),e.on&&e.on.forEach(r=>Y2e(r,t,n.id))}const $t=e=>(t,n,i)=>Xx(e,n,t||void 0,i),Aj=$t("aggregate"),Q2e=$t("axisticks"),Cj=$t("bound"),zs=$t("collect"),F6=$t("compare"),Z2e=$t("datajoin"),kj=$t("encode"),e_e=$t("expression"),t_e=$t("facet"),n_e=$t("field"),i_e=$t("key"),r_e=$t("legendentries"),s_e=$t("load"),a_e=$t("mark"),o_e=$t("multiextent"),u_e=$t("multivalues"),l_e=$t("overlap"),c_e=$t("params"),$j=$t("prefacet"),f_e=$t("projection"),h_e=$t("proxy"),d_e=$t("relay"),Tj=$t("render"),p_e=$t("scale"),Rc=$t("sieve"),g_e=$t("sortitems"),Oj=$t("viewlayout"),m_e=$t("values");let y_e=0;const Fj={min:"min",max:"max",count:"sum"};function v_e(e,t){const n=e.type||"linear";y7(n)||K("Unrecognized scale type: "+le(n)),t.addScale(e.name,{type:n,domain:void 0})}function x_e(e,t){const n=t.getScale(e.name).params;let i;n.domain=Mj(e.domain,e,t),e.range!=null&&(n.range=Rj(e,t,n)),e.interpolate!=null&&T_e(e.interpolate,n),e.nice!=null&&(n.nice=$_e(e.nice,t)),e.bins!=null&&(n.bins=k_e(e.bins,t));for(i in e)ve(n,i)||i==="name"||(n[i]=Vr(e[i],t))}function Vr(e,t){return de(e)?e.signal?t.signalRef(e.signal):K("Unsupported object: "+le(e)):e}function W1(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>Vr(n,t))}function Jx(e){K("Can not find data set: "+le(e))}function Mj(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&K("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(Q(e)?b_e:e.fields?w_e:__e)(e,t,n)}function b_e(e,t,n){return e.map(i=>Vr(i,n))}function __e(e,t,n){const i=n.getData(e.data);return i||Jx(e.data),sh(t.type)?i.valuesRef(n,e.field,Nj(e.sort,!1)):b7(t.type)?i.domainRef(n,e.field):i.extentRef(n,e.field)}function w_e(e,t,n){const i=e.data,r=e.fields.reduce((s,a)=>(a=ge(a)?{data:i,field:a}:Q(a)||a.signal?E_e(a,n):a,s.push(a),s),[]);return(sh(t.type)?S_e:b7(t.type)?A_e:C_e)(e,n,r)}function E_e(e,t){const n="_:vega:_"+y_e++,i=zs({});if(Q(e))i.value={$ingest:e};else if(e.signal){const r="setdata("+le(n)+","+e.signal+")";i.params.input=t.signalRef(r)}return t.addDataPipeline(n,[i,Rc({})]),{data:n,field:"data"}}function S_e(e,t,n){const i=Nj(e.sort,!0);let r,s;const a=n.map(l=>{const c=t.getData(l.data);return c||Jx(l.data),c.countsRef(t,l.field,i)}),o={groupby:yA,pulse:a};i&&(r=i.op||"count",s=i.field?Kx(r,i.field):"count",o.ops=[Fj[r]],o.fields=[t.fieldRef(s)],o.as=[s]),r=t.add(Aj(o));const u=t.add(zs({pulse:ke(r)}));return s=t.add(m_e({field:yA,sort:t.sortRef(i),pulse:ke(u)})),ke(s)}function Nj(e,t){return e&&(!e.field&&!e.op?de(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?K("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!Fj[e.op]&&K("Multiple domain scales can not be sorted using "+e.op)),e}function A_e(e,t,n){const i=n.map(r=>{const s=t.getData(r.data);return s||Jx(r.data),s.domainRef(t,r.field)});return ke(t.add(u_e({values:i})))}function C_e(e,t,n){const i=n.map(r=>{const s=t.getData(r.data);return s||Jx(r.data),s.extentRef(t,r.field)});return ke(t.add(o_e({extents:i})))}function k_e(e,t){return e.signal||Q(e)?W1(e,t):t.objectProperty(e)}function $_e(e,t){return e.signal?t.signalRef(e.signal):de(e)?{interval:Vr(e.interval),step:Vr(e.step)}:Vr(e)}function T_e(e,t){t.interpolate=Vr(e.type||e),e.gamma!=null&&(t.interpolateGamma=Vr(e.gamma))}function Rj(e,t,n){const i=t.config.range;let r=e.range;if(r.signal)return t.signalRef(r.signal);if(ge(r)){if(i&&ve(i,r))return e=We({},e,{range:i[r]}),Rj(e,t,n);r==="width"?r=[0,{signal:"width"}]:r==="height"?r=sh(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:K("Unrecognized scale range value: "+le(r))}else if(r.scheme){n.scheme=Q(r.scheme)?W1(r.scheme,t):Vr(r.scheme,t),r.extent&&(n.schemeExtent=W1(r.extent,t)),r.count&&(n.schemeCount=Vr(r.count,t));return}else if(r.step){n.rangeStep=Vr(r.step,t);return}else{if(sh(e.type)&&!Q(r))return Mj(r,e,t);Q(r)||K("Unsupported range type: "+le(r))}return r.map(s=>(Q(s)?W1:Vr)(s,t))}function O_e(e,t){const n=t.config.projection||{},i={};for(const r in e)r!=="name"&&(i[r]=xA(e[r],r,t));for(const r in n)i[r]==null&&(i[r]=xA(n[r],r,t));t.addProjection(e.name,i)}function xA(e,t,n){return Q(e)?e.map(i=>xA(i,t,n)):de(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:K("Unsupported parameter object: "+le(e)):e}const Bs="top",Yh="left",Xh="right",Uu="bottom",Ij="center",F_e="vertical",M_e="start",N_e="middle",R_e="end",bA="index",K3="label",I_e="offset",ph="perc",D_e="perc2",Gr="value",g0="guide-label",J3="guide-title",P_e="group-title",L_e="group-subtitle",M6="symbol",G1="gradient",_A="discrete",wA="size",z_e="shape",B_e="fill",U_e="stroke",j_e="strokeWidth",q_e="strokeDash",V_e="opacity",Q3=[wA,z_e,B_e,U_e,j_e,q_e,V_e],m0={name:1,style:1,interactive:1},lt={value:0},Hr={value:1},Qx="group",Dj="rect",Z3="rule",W_e="symbol",Ic="text";function wg(e){return e.type=Qx,e.interactive=e.interactive||!1,e}function nr(e,t){const n=(i,r)=>ys(e[i],ys(t[i],r));return n.isVertical=i=>F_e===ys(e.direction,t.direction||(i?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>ys(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>ys(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>ys(e.columns,ys(t.columns,+n.isVertical(!0))),n}function Pj(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function G_e(e,t,n){const i=t.config.style[n];return i&&i[e]}function Zx(e,t,n){return`item.anchor === '${M_e}' ? ${e} : item.anchor === '${R_e}' ? ${t} : ${n}`}const eT=Zx(le(Yh),le(Xh),le(Ij));function H_e(e){const t=e("tickBand");let n=e("tickOffset"),i,r;return t?t.signal?(i={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},r={signal:`(${t.signal}) === 'extent'`},de(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : ${n}`})):t==="extent"?(i=1,r=!0,n=0):(i=.5,r=!1):(i=e("bandPosition"),r=e("tickExtra")),{extra:r,band:i,offset:n}}function Lj(e,t){return t?e?de(e)?Object.assign({},e,{offset:Lj(e.offset,t)}):{value:e,offset:t}:t:e}function Er(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=Hh(e.encode,t,m0)):e.interactive=!1,e}function Y_e(e,t,n,i){const r=nr(e,n),s=r.isVertical(),a=r.gradientThickness(),o=r.gradientLength();let u,l,c,f,d;s?(l=[0,1],c=[0,0],f=a,d=o):(l=[0,0],c=[1,0],f=o,d=a);const p={enter:u={opacity:lt,x:lt,y:lt,width:Mn(f),height:Mn(d)},update:We({},u,{opacity:Hr,fill:{gradient:t,start:l,stop:c}}),exit:{opacity:lt}};return Xn(p,{stroke:r("gradientStrokeColor"),strokeWidth:r("gradientStrokeWidth")},{opacity:r("gradientOpacity")}),Er({type:Dj,role:_2e,encode:p},i)}function X_e(e,t,n,i,r){const s=nr(e,n),a=s.isVertical(),o=s.gradientThickness(),u=s.gradientLength();let l,c,f,d,p="";a?(l="y",f="y2",c="x",d="width",p="1-"):(l="x",f="x2",c="y",d="height");const m={opacity:lt,fill:{scale:t,field:Gr}};m[l]={signal:p+"datum."+ph,mult:u},m[c]=lt,m[f]={signal:p+"datum."+D_e,mult:u},m[d]=Mn(o);const y={enter:m,update:We({},m,{opacity:Hr}),exit:{opacity:lt}};return Xn(y,{stroke:s("gradientStrokeColor"),strokeWidth:s("gradientStrokeWidth")},{opacity:s("gradientOpacity")}),Er({type:Dj,role:x2e,key:Gr,from:r,encode:y},i)}const K_e=`datum.${ph}<=0?"${Yh}":datum.${ph}>=1?"${Xh}":"${Ij}"`,J_e=`datum.${ph}<=0?"${Uu}":datum.${ph}>=1?"${Bs}":"${N_e}"`;function N6(e,t,n,i){const r=nr(e,t),s=r.isVertical(),a=Mn(r.gradientThickness()),o=r.gradientLength();let u=r("labelOverlap"),l,c,f,d,p="";const m={enter:l={opacity:lt},update:c={opacity:Hr,text:{field:K3}},exit:{opacity:lt}};return Xn(m,{fill:r("labelColor"),fillOpacity:r("labelOpacity"),font:r("labelFont"),fontSize:r("labelFontSize"),fontStyle:r("labelFontStyle"),fontWeight:r("labelFontWeight"),limit:ys(e.labelLimit,t.gradientLabelLimit)}),s?(l.align={value:"left"},l.baseline=c.baseline={signal:J_e},f="y",d="x",p="1-"):(l.align=c.align={signal:K_e},l.baseline={value:"top"},f="x",d="y"),l[f]=c[f]={signal:p+"datum."+ph,mult:o},l[d]=c[d]=a,a.offset=ys(e.labelOffset,t.gradientLabelOffset)||0,u=u?{separation:r("labelSeparation"),method:u,order:"datum."+bA}:void 0,Er({type:Ic,role:xj,style:g0,key:Gr,from:i,encode:m,overlap:u},n)}function Q_e(e,t,n,i,r){const s=nr(e,t),a=n.entries,o=!!(a&&a.interactive),u=a?a.name:void 0,l=s("clipHeight"),c=s("symbolOffset"),f={data:"value"},d=`(${r}) ? datum.${I_e} : datum.${wA}`,p=l?Mn(l):{field:wA},m=`datum.${bA}`,y=`max(1, ${r})`;let v,b,_,E,S;p.mult=.5,v={enter:b={opacity:lt,x:{signal:d,mult:.5,offset:c},y:p},update:_={opacity:Hr,x:b.x,y:b.y},exit:{opacity:lt}};let A=null,$=null;e.fill||(A=t.symbolBaseFillColor,$=t.symbolBaseStrokeColor),Xn(v,{fill:s("symbolFillColor",A),shape:s("symbolType"),size:s("symbolSize"),stroke:s("symbolStrokeColor",$),strokeDash:s("symbolDash"),strokeDashOffset:s("symbolDashOffset"),strokeWidth:s("symbolStrokeWidth")},{opacity:s("symbolOpacity")}),Q3.forEach(P=>{e[P]&&(_[P]=b[P]={scale:e[P],field:Gr})});const C=Er({type:W_e,role:w2e,key:Gr,from:f,clip:l?!0:void 0,encode:v},n.symbols),M=Mn(c);M.offset=s("labelOffset"),v={enter:b={opacity:lt,x:{signal:d,offset:M},y:p},update:_={opacity:Hr,text:{field:K3},x:b.x,y:b.y},exit:{opacity:lt}},Xn(v,{align:s("labelAlign"),baseline:s("labelBaseline"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontStyle:s("labelFontStyle"),fontWeight:s("labelFontWeight"),limit:s("labelLimit")});const N=Er({type:Ic,role:xj,style:g0,key:Gr,from:f,encode:v},n.labels);return v={enter:{noBound:{value:!l},width:lt,height:l?Mn(l):lt,opacity:lt},exit:{opacity:lt},update:_={opacity:Hr,row:{signal:null},column:{signal:null}}},s.isVertical(!0)?(E=`ceil(item.mark.items.length / ${y})`,_.row.signal=`${m}%${E}`,_.column.signal=`floor(${m} / ${E})`,S={field:["row",m]}):(_.row.signal=`floor(${m} / ${y})`,_.column.signal=`${m} % ${y}`,S={field:m}),_.column.signal=`(${r})?${_.column.signal}:${m}`,i={facet:{data:i,name:"value",groupby:bA}},wg({role:H3,from:i,encode:Hh(v,a,m0),marks:[C,N],name:u,interactive:o,sort:S})}function Z_e(e,t){const n=nr(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const tT='item.orient === "left"',nT='item.orient === "right"',eb=`(${tT} || ${nT})`,ewe=`datum.vgrad && ${eb}`,twe=Zx('"top"','"bottom"','"middle"'),nwe=Zx('"right"','"left"','"center"'),iwe=`datum.vgrad && ${nT} ? (${nwe}) : (${eb} && !(datum.vgrad && ${tT})) ? "left" : ${eT}`,rwe=`item._anchor || (${eb} ? "middle" : "start")`,swe=`${ewe} ? (${tT} ? -90 : 90) : 0`,awe=`${eb} ? (datum.vgrad ? (${nT} ? "bottom" : "top") : ${twe}) : "top"`;function owe(e,t,n,i){const r=nr(e,t),s={enter:{opacity:lt},update:{opacity:Hr,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:lt}};return Xn(s,{orient:r("titleOrient"),_anchor:r("titleAnchor"),anchor:{signal:rwe},angle:{signal:swe},align:{signal:iwe},baseline:{signal:awe},text:e.title,fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),baseline:r("titleBaseline")}),Er({type:Ic,role:E2e,style:J3,from:i,encode:s},n)}function uwe(e,t){let n;return de(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+R6(e.path)+")":e.sphere&&(n="geoShape("+R6(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function R6(e){return de(e)&&e.signal?e.signal:le(e)}function zj(e){const t=e.role||"";return t.startsWith("axis")||t.startsWith("legend")||t.startsWith("title")?t:e.type===Qx?H3:t||W3}function lwe(e){return{marktype:e.type,name:e.name||void 0,role:e.role||zj(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function cwe(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function iT(e,t){const n=x8(e.type);n||K("Unrecognized transform type: "+le(e.type));const i=Xx(n.type.toLowerCase(),null,Bj(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(i)),i.metadata=n.metadata||{},i}function Bj(e,t,n){const i={},r=e.params.length;for(let s=0;s<r;++s){const a=e.params[s];i[a.name]=fwe(a,t,n)}return i}function fwe(e,t,n){const i=e.type,r=t[e.name];if(i==="index")return hwe(e,t,n);if(r===void 0){e.required&&K("Missing required "+le(t.type)+" parameter: "+le(e.name));return}else{if(i==="param")return dwe(e,t,n);if(i==="projection")return n.projectionRef(t[e.name])}return e.array&&!En(r)?r.map(s=>I6(e,s,n)):I6(e,r,n)}function I6(e,t,n){const i=e.type;if(En(t))return P6(i)?K("Expression references can not be signals."):Uw(i)?n.fieldRef(t):L6(i)?n.compareRef(t):n.signalRef(t.signal);{const r=e.expr||Uw(i);return r&&pwe(t)?n.exprRef(t.expr,t.as):r&&gwe(t)?bg(t.field,t.as):P6(i)?Sa(t,n):mwe(i)?ke(n.getData(t).values):Uw(i)?bg(t):L6(i)?n.compareRef(t):t}}function hwe(e,t,n){return ge(t.from)||K('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function dwe(e,t,n){const i=t[e.name];return e.array?(Q(i)||K("Expected an array of sub-parameters. Instead: "+le(i)),i.map(r=>D6(e,r,n))):D6(e,i,n)}function D6(e,t,n){const i=e.params.length;let r;for(let a=0;a<i;++a){r=e.params[a];for(const o in r.key)if(r.key[o]!==t[o]){r=null;break}if(r)break}r||K("Unsupported parameter: "+le(t));const s=We(Bj(r,t,n),r.key);return ke(n.add(c_e(s)))}const pwe=e=>e&&e.expr,gwe=e=>e&&e.field,mwe=e=>e==="data",P6=e=>e==="expr",Uw=e=>e==="field",L6=e=>e==="compare";function ywe(e,t,n){let i,r,s,a,o;return e?(i=e.facet)&&(t||K("Only group marks can be faceted."),i.field!=null?a=o=H1(i,n):(e.data?o=ke(n.getData(e.data).aggregate):(s=iT(We({type:"aggregate",groupby:pe(i.groupby)},i.aggregate),n),s.params.key=n.keyRef(i.groupby),s.params.pulse=H1(i,n),a=o=ke(n.add(s))),r=n.keyRef(i.groupby,!0))):a=ke(n.add(zs(null,[{}]))),a||(a=H1(e,n)),{key:r,pulse:a,parent:o}}function H1(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:ke(t.getData(e.data).output)}function gc(e,t,n,i,r){this.scope=e,this.input=t,this.output=n,this.values=i,this.aggregate=r,this.index={}}gc.fromEntries=function(e,t){const n=t.length,i=t[n-1],r=t[n-2];let s=t[0],a=null,o=1;for(s&&s.type==="load"&&(s=t[1]),e.add(t[0]);o<n;++o)t[o].params.pulse=ke(t[o-1]),e.add(t[o]),t[o].type==="aggregate"&&(a=t[o]);return new gc(e,s,r,i,a)};function Uj(e){return ge(e)?e:null}function z6(e,t,n){const i=Kx(n.op,n.field);let r;if(t.ops){for(let s=0,a=t.as.length;s<a;++s)if(t.as[s]===i)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((r=n.op.signal)?e.signalRef(r):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(i))}function ep(e,t,n,i,r,s,a){const o=t[n]||(t[n]={}),u=B2e(s);let l=Uj(r),c,f;if(l!=null&&(e=t.scope,l=l+(u?"|"+u:""),c=o[l]),!c){const d=s?{field:yA,pulse:t.countsRef(e,r,s)}:{field:e.fieldRef(r),pulse:ke(t.output)};u&&(d.sort=e.sortRef(s)),f=e.add(Xx(i,void 0,d)),a&&(t.index[r]=f),c=ke(f),l!=null&&(o[l]=c)}return c}gc.prototype={countsRef(e,t,n){const i=this,r=i.counts||(i.counts={}),s=Uj(t);let a,o,u;return s!=null&&(e=i.scope,a=r[s]),a?n&&n.field&&z6(e,a.agg.params,n):(u={groupby:e.fieldRef(t,"key"),pulse:ke(i.output)},n&&n.field&&z6(e,u,n),o=e.add(Aj(u)),a=e.add(zs({pulse:ke(o)})),a={agg:o,ref:ke(a)},s!=null&&(r[s]=a)),a.ref},tuplesRef(){return ke(this.values)},extentRef(e,t){return ep(e,this,"extent","extent",t,!1)},domainRef(e,t){return ep(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return ep(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return ep(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return ep(e,this,"indata","tupleindex",t,!0,!0)}};function vwe(e,t,n){const i=e.from.facet,r=i.name,s=H1(i,t);let a;i.name||K("Facet must have a name: "+le(i)),i.data||K("Facet must reference a data set: "+le(i)),i.field?a=t.add($j({field:t.fieldRef(i.field),pulse:s})):i.groupby?a=t.add(t_e({key:t.keyRef(i.groupby),group:ke(t.proxy(n.parent)),pulse:s})):K("Facet must specify groupby or field: "+le(i));const o=t.fork(),u=o.add(zs()),l=o.add(Rc({pulse:ke(u)}));o.addData(r,new gc(o,u,u,l)),o.addSignal("parent",null),a.params.subflow={$subflow:o.parse(e).toRuntime()}}function xwe(e,t,n){const i=t.add($j({pulse:n.pulse})),r=t.fork();r.add(Rc()),r.addSignal("parent",null),i.params.subflow={$subflow:r.parse(e).toRuntime()}}function jj(e,t,n){const i=e.remove,r=e.insert,s=e.toggle,a=e.modify,o=e.values,u=t.add(pv()),l="if("+e.trigger+',modify("'+n+'",'+[r,i,s,a,o].map(f=>f??"null").join(",")+"),0)",c=Sa(l,t);u.update=c.$expr,u.params=c.$params}function tb(e,t){const n=zj(e),i=e.type===Qx,r=e.from&&e.from.facet,s=e.overlap;let a=e.layout||n===H3||n===G3,o,u,l,c,f,d,p;const m=n===W3||a||r,y=ywe(e.from,i,t);u=t.add(Z2e({key:y.key||(e.key?bg(e.key):void 0),pulse:y.pulse,clean:!i}));const v=ke(u);u=l=t.add(zs({pulse:v})),u=t.add(a_e({markdef:lwe(e),interactive:cwe(e.interactive,t),clip:uwe(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:ke(u)}));const b=ke(u);u=c=t.add(kj(Ej(e.encode,e.type,n,e.style,t,{mod:!1,pulse:b}))),u.params.parent=t.encode(),e.transform&&e.transform.forEach($=>{const C=iT($,t),M=C.metadata;(M.generates||M.changes)&&K("Mark transforms should not generate new data."),M.nomod||(c.params.mod=!0),C.params.pulse=ke(u),t.add(u=C)}),e.sort&&(u=t.add(g_e({sort:t.compareRef(e.sort),pulse:ke(u)})));const _=ke(u);(r||a)&&(a=t.add(Oj({layout:t.objectProperty(e.layout),legends:t.legends,mark:b,pulse:_})),d=ke(a));const E=t.add(Cj({mark:b,pulse:d||_}));p=ke(E),i&&(m&&(o=t.operators,o.pop(),a&&o.pop()),t.pushState(_,d||p,v),r?vwe(e,t,y):m?xwe(e,t,y):t.parse(e),t.popState(),m&&(a&&o.push(a),o.push(E))),s&&(p=bwe(s,p,t));const S=t.add(Tj({pulse:p})),A=t.add(Rc({pulse:ke(S)},void 0,t.parent()));e.name!=null&&(f=e.name,t.addData(f,new gc(t,l,S,A)),e.on&&e.on.forEach($=>{($.insert||$.remove||$.toggle)&&K("Marks only support modify triggers."),jj($,t,f)}))}function bwe(e,t,n){const i=e.method,r=e.bound,s=e.separation,a={separation:En(s)?n.signalRef(s.signal):s,method:En(i)?n.signalRef(i.signal):i,pulse:t};if(e.order&&(a.sort=n.compareRef({field:e.order})),r){const o=r.tolerance;a.boundTolerance=En(o)?n.signalRef(o.signal):+o,a.boundScale=n.scaleRef(r.scale),a.boundOrient=r.orient}return ke(n.add(l_e(a)))}function _we(e,t){const n=t.config.legend,i=e.encode||{},r=nr(e,n),s=i.legend||{},a=s.name||void 0,o=s.interactive,u=s.style,l={};let c=0,f,d,p;Q3.forEach(E=>e[E]?(l[E]=e[E],c=c||e[E]):0),c||K("Missing valid scale for legend.");const m=wwe(e,t.scaleType(c)),y={title:e.title!=null,scales:l,type:m,vgrad:m!=="symbol"&&r.isVertical()},v=ke(t.add(zs(null,[y]))),b={enter:{x:{value:0},y:{value:0}}},_=ke(t.add(r_e(d={type:m,scale:t.scaleRef(c),count:t.objectProperty(r("tickCount")),limit:t.property(r("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return m===G1?(p=[Y_e(e,c,n,i.gradient),N6(e,n,i.labels,_)],d.count=d.count||t.signalRef(`max(2,2*floor((${Ql(r.gradientLength())})/100))`)):m===_A?p=[X_e(e,c,n,i.gradient,_),N6(e,n,i.labels,_)]:(f=Z_e(e,n),p=[Q_e(e,n,i,_,Ql(f.columns))],d.size=Awe(e,t,p[0].marks)),p=[wg({role:b2e,from:v,encode:b,marks:p,layout:f,interactive:o})],y.title&&p.push(owe(e,n,i.title,v)),tb(wg({role:v2e,from:v,encode:Hh(Swe(r,e,n),s,m0),marks:p,aria:r("aria"),description:r("description"),zindex:r("zindex"),name:a,interactive:o,style:u}),t)}function wwe(e,t){let n=e.type||M6;return!e.type&&Ewe(e)===1&&(e.fill||e.stroke)&&(n=i$(t)?G1:hS(t)?_A:M6),n!==G1?n:hS(t)?_A:G1}function Ewe(e){return Q3.reduce((t,n)=>t+(e[n]?1:0),0)}function Swe(e,t,n){const i={enter:{},update:{}};return Xn(i,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),i}function Awe(e,t,n){const i=Ql(B6("size",e,n)),r=Ql(B6("strokeWidth",e,n)),s=Ql(Cwe(n[1].encode,t,g0));return Sa(`max(ceil(sqrt(${i})+${r}),${s})`,t)}function B6(e,t,n){return t[e]?`scale("${t[e]}",datum)`:Pj(e,n[0].encode)}function Cwe(e,t,n){return Pj("fontSize",e)||G_e("fontSize",t,n)}const kwe=`item.orient==="${Yh}"?-90:item.orient==="${Xh}"?90:0`;function $we(e,t){e=ge(e)?{text:e}:e;const n=nr(e,t.config.title),i=e.encode||{},r=i.group||{},s=r.name||void 0,a=r.interactive,o=r.style,u=[],l={},c=ke(t.add(zs(null,[l])));return u.push(Fwe(e,n,Twe(e),c)),e.subtitle&&u.push(Mwe(e,n,i.subtitle,c)),tb(wg({role:S2e,from:c,encode:Owe(n,r),marks:u,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:s,interactive:a,style:o}),t)}function Twe(e){const t=e.encode;return t&&t.title||We({name:e.name,interactive:e.interactive,style:e.style},t)}function Owe(e,t){const n={enter:{},update:{}};return Xn(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:eT},angle:{signal:kwe},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),Hh(n,t,m0)}function Fwe(e,t,n,i){const r={value:0},s=e.text,a={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return Xn(a,{text:s,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Er({type:Ic,role:A2e,style:P_e,from:i,encode:a},n)}function Mwe(e,t,n,i){const r={value:0},s=e.subtitle,a={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return Xn(a,{text:s,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Er({type:Ic,role:C2e,style:L_e,from:i,encode:a},n)}function Nwe(e,t){const n=[];e.transform&&e.transform.forEach(i=>{n.push(iT(i,t))}),e.on&&e.on.forEach(i=>{jj(i,t,e.name)}),t.addDataPipeline(e.name,Rwe(e,t,n))}function Rwe(e,t,n){const i=[];let r=null,s=!1,a=!1,o,u,l,c,f;for(e.values?En(e.values)||V1(e.format)?(i.push(U6(t,e)),i.push(r=kl())):i.push(r=kl({$ingest:e.values,$format:e.format})):e.url?V1(e.url)||V1(e.format)?(i.push(U6(t,e)),i.push(r=kl())):i.push(r=kl({$request:e.url,$format:e.format})):e.source&&(r=o=pe(e.source).map(d=>ke(t.getData(d).output)),i.push(null)),u=0,l=n.length;u<l;++u)c=n[u],f=c.metadata,!r&&!f.source&&i.push(r=kl()),i.push(c),f.generates&&(a=!0),f.modifies&&!a&&(s=!0),f.source?r=c:f.changes&&(r=null);return o&&(l=o.length-1,i[0]=d_e({derive:s,pulse:l?o:o[0]}),(s||l)&&i.splice(1,0,kl())),r||i.push(kl()),i.push(Rc({})),i}function kl(e){const t=zs({},e);return t.metadata={source:!0},t}function U6(e,t){return s_e({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const qj=e=>e===Uu||e===Bs,nb=(e,t,n)=>En(e)?Lwe(e.signal,t,n):e===Yh||e===Bs?t:n,Nn=(e,t,n)=>En(e)?Dwe(e.signal,t,n):qj(e)?t:n,ks=(e,t,n)=>En(e)?Pwe(e.signal,t,n):qj(e)?n:t,Vj=(e,t,n)=>En(e)?zwe(e.signal,t,n):e===Bs?{value:t}:{value:n},Iwe=(e,t,n)=>En(e)?Bwe(e.signal,t,n):e===Xh?{value:t}:{value:n},Dwe=(e,t,n)=>Wj(`${e} === '${Bs}' || ${e} === '${Uu}'`,t,n),Pwe=(e,t,n)=>Wj(`${e} !== '${Bs}' && ${e} !== '${Uu}'`,t,n),Lwe=(e,t,n)=>rT(`${e} === '${Yh}' || ${e} === '${Bs}'`,t,n),zwe=(e,t,n)=>rT(`${e} === '${Bs}'`,t,n),Bwe=(e,t,n)=>rT(`${e} === '${Xh}'`,t,n),Wj=(e,t,n)=>(t=t!=null?Mn(t):t,n=n!=null?Mn(n):n,j6(t)&&j6(n)?(t=t?t.signal||le(t.value):null,n=n?n.signal||le(n.value):null,{signal:`${e} ? (${t}) : (${n})`}):[We({test:e},t)].concat(n||[])),j6=e=>e==null||Object.keys(e).length===1,rT=(e,t,n)=>({signal:`${e} ? (${Nf(t)}) : (${Nf(n)})`}),Uwe=(e,t,n,i,r)=>({signal:(i!=null?`${e} === '${Yh}' ? (${Nf(i)}) : `:"")+(n!=null?`${e} === '${Uu}' ? (${Nf(n)}) : `:"")+(r!=null?`${e} === '${Xh}' ? (${Nf(r)}) : `:"")+(t!=null?`${e} === '${Bs}' ? (${Nf(t)}) : `:"")+"(null)"}),Nf=e=>En(e)?e.signal:e==null?null:le(e),jwe=(e,t)=>t===0?0:En(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t},Uf=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function vf(e,t,n,i){let r;if(t&&ve(t,e))return t[e];if(ve(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":r="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":r=e[5].toLowerCase()+e.slice(6)}return i[J3][r]}else if(e.startsWith("label")){switch(e){case"labelColor":r="fill";break;case"labelFont":case"labelFontSize":r=e[5].toLowerCase()+e.slice(6)}return i[g0][r]}return null}function q6(e){const t={};for(const n of e)if(n)for(const i in n)t[i]=1;return Object.keys(t)}function qwe(e,t){var n=t.config,i=n.style,r=n.axis,s=t.scaleType(e.scale)==="band"&&n.axisBand,a=e.orient,o,u,l;if(En(a)){const f=q6([n.axisX,n.axisY]),d=q6([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);o={};for(l of f)o[l]=Nn(a,vf(l,n.axisX,r,i),vf(l,n.axisY,r,i));u={};for(l of d)u[l]=Uwe(a.signal,vf(l,n.axisTop,r,i),vf(l,n.axisBottom,r,i),vf(l,n.axisLeft,r,i),vf(l,n.axisRight,r,i))}else o=a===Bs||a===Uu?n.axisX:n.axisY,u=n["axis"+a[0].toUpperCase()+a.slice(1)];return o||u||s?We({},r,o,u,s):r}function Vwe(e,t,n,i){const r=nr(e,t),s=e.orient;let a,o;const u={enter:a={opacity:lt},update:o={opacity:Hr},exit:{opacity:lt}};Xn(u,{stroke:r("domainColor"),strokeCap:r("domainCap"),strokeDash:r("domainDash"),strokeDashOffset:r("domainDashOffset"),strokeWidth:r("domainWidth"),strokeOpacity:r("domainOpacity")});const l=V6(e,0),c=V6(e,1);return a.x=o.x=Nn(s,l,lt),a.x2=o.x2=Nn(s,c),a.y=o.y=ks(s,l,lt),a.y2=o.y2=ks(s,c),Er({type:Z3,role:d2e,from:i,encode:u},n)}function V6(e,t){return{scale:e.scale,range:t}}function Wwe(e,t,n,i,r){const s=nr(e,t),a=e.orient,o=e.gridScale,u=nb(a,1,-1),l=Gwe(e.offset,u);let c,f,d;const p={enter:c={opacity:lt},update:d={opacity:Hr},exit:f={opacity:lt}};Xn(p,{stroke:s("gridColor"),strokeCap:s("gridCap"),strokeDash:s("gridDash"),strokeDashOffset:s("gridDashOffset"),strokeOpacity:s("gridOpacity"),strokeWidth:s("gridWidth")});const m={scale:e.scale,field:Gr,band:r.band,extra:r.extra,offset:r.offset,round:s("tickRound")},y=Nn(a,{signal:"height"},{signal:"width"}),v=o?{scale:o,range:0,mult:u,offset:l}:{value:0,offset:l},b=o?{scale:o,range:1,mult:u,offset:l}:We(y,{mult:u,offset:l});return c.x=d.x=Nn(a,m,v),c.y=d.y=ks(a,m,v),c.x2=d.x2=ks(a,b),c.y2=d.y2=Nn(a,b),f.x=Nn(a,m),f.y=ks(a,m),Er({type:Z3,role:p2e,key:Gr,from:i,encode:p},n)}function Gwe(e,t){if(t!==1)if(!de(e))e=En(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);else{let n=e=We({},e);for(;n.mult!=null;)if(de(n.mult))n=n.mult=We({},n.mult);else return n.mult=En(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n.mult=t}return e}function Hwe(e,t,n,i,r,s){const a=nr(e,t),o=e.orient,u=nb(o,-1,1);let l,c,f;const d={enter:l={opacity:lt},update:f={opacity:Hr},exit:c={opacity:lt}};Xn(d,{stroke:a("tickColor"),strokeCap:a("tickCap"),strokeDash:a("tickDash"),strokeDashOffset:a("tickDashOffset"),strokeOpacity:a("tickOpacity"),strokeWidth:a("tickWidth")});const p=Mn(r);p.mult=u;const m={scale:e.scale,field:Gr,band:s.band,extra:s.extra,offset:s.offset,round:a("tickRound")};return f.y=l.y=Nn(o,lt,m),f.y2=l.y2=Nn(o,p),c.x=Nn(o,m),f.x=l.x=ks(o,lt,m),f.x2=l.x2=ks(o,p),c.y=ks(o,m),Er({type:Z3,role:m2e,key:Gr,from:i,encode:d},n)}function jw(e,t,n,i,r){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+i+","+r+")"}}function Ywe(e,t,n,i,r,s){const a=nr(e,t),o=e.orient,u=e.scale,l=nb(o,-1,1),c=Ql(a("labelFlush")),f=Ql(a("labelFlushOffset")),d=a("labelAlign"),p=a("labelBaseline");let m=c===0||!!c,y;const v=Mn(r);v.mult=l,v.offset=Mn(a("labelPadding")||0),v.offset.mult=l;const b={scale:u,field:Gr,band:.5,offset:Lj(s.offset,a("labelOffset"))},_=Nn(o,m?jw(u,c,'"left"','"right"','"center"'):{value:"center"},Iwe(o,"left","right")),E=Nn(o,Vj(o,"bottom","top"),m?jw(u,c,'"top"','"bottom"','"middle"'):{value:"middle"}),S=jw(u,c,`-(${f})`,f,0);m=m&&f;const A={opacity:lt,x:Nn(o,b,v),y:ks(o,b,v)},$={enter:A,update:y={opacity:Hr,text:{field:K3},x:A.x,y:A.y,align:_,baseline:E},exit:{opacity:lt,x:A.x,y:A.y}};Xn($,{dx:!d&&m?Nn(o,S):null,dy:!p&&m?ks(o,S):null}),Xn($,{angle:a("labelAngle"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontWeight:a("labelFontWeight"),fontStyle:a("labelFontStyle"),limit:a("labelLimit"),lineHeight:a("labelLineHeight")},{align:d,baseline:p});const C=a("labelBound");let M=a("labelOverlap");return M=M||C?{separation:a("labelSeparation"),method:M,order:"datum.index",bound:C?{scale:u,orient:o,tolerance:C}:null}:void 0,y.align!==_&&(y.align=Uf(y.align,_)),y.baseline!==E&&(y.baseline=Uf(y.baseline,E)),Er({type:Ic,role:g2e,style:g0,key:Gr,from:i,encode:$,overlap:M},n)}function Xwe(e,t,n,i){const r=nr(e,t),s=e.orient,a=nb(s,-1,1);let o,u;const l={enter:o={opacity:lt,anchor:Mn(r("titleAnchor",null)),align:{signal:eT}},update:u=We({},o,{opacity:Hr,text:Mn(e.title)}),exit:{opacity:lt}},c={signal:`lerp(range("${e.scale}"), ${Zx(0,1,.5)})`};return u.x=Nn(s,c),u.y=ks(s,c),o.angle=Nn(s,lt,jwe(a,90)),o.baseline=Nn(s,Vj(s,Uu,Bs),{value:Uu}),u.angle=o.angle,u.baseline=o.baseline,Xn(l,{fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),angle:r("titleAngle"),baseline:r("titleBaseline")}),Kwe(r,s,l,n),l.update.align=Uf(l.update.align,o.align),l.update.angle=Uf(l.update.angle,o.angle),l.update.baseline=Uf(l.update.baseline,o.baseline),Er({type:Ic,role:y2e,style:J3,from:i,encode:l},n)}function Kwe(e,t,n,i){const r=(o,u)=>o!=null?(n.update[u]=Uf(Mn(o),n.update[u]),!1):!Af(u,i),s=r(e("titleX"),"x"),a=r(e("titleY"),"y");n.enter.auto=a===s?Mn(a):Nn(t,Mn(a),Mn(s))}function Jwe(e,t){const n=qwe(e,t),i=e.encode||{},r=i.axis||{},s=r.name||void 0,a=r.interactive,o=r.style,u=nr(e,n),l=H_e(u),c={scale:e.scale,ticks:!!u("ticks"),labels:!!u("labels"),grid:!!u("grid"),domain:!!u("domain"),title:e.title!=null},f=ke(t.add(zs({},[c]))),d=ke(t.add(Q2e({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),p=[];let m;return c.grid&&p.push(Wwe(e,n,i.grid,d,l)),c.ticks&&(m=u("tickSize"),p.push(Hwe(e,n,i.ticks,d,m,l))),c.labels&&(m=c.ticks?m:0,p.push(Ywe(e,n,i.labels,d,m,l))),c.domain&&p.push(Vwe(e,n,i.domain,f)),c.title&&p.push(Xwe(e,n,i.title,f)),tb(wg({role:h2e,from:f,encode:Hh(Qwe(u,e),r,m0),marks:p,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:s,interactive:a,style:o}),t)}function Qwe(e,t){const n={enter:{},update:{}};return Xn(n,{orient:e("orient"),offset:e("offset")||0,position:ys(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function Gj(e,t,n){const i=pe(e.signals),r=pe(e.scales);return n||i.forEach(s=>Sj(s,t)),pe(e.projections).forEach(s=>O_e(s,t)),r.forEach(s=>v_e(s,t)),pe(e.data).forEach(s=>Nwe(s,t)),r.forEach(s=>x_e(s,t)),(n||i).forEach(s=>J2e(s,t)),pe(e.axes).forEach(s=>Jwe(s,t)),pe(e.marks).forEach(s=>tb(s,t)),pe(e.legends).forEach(s=>_we(s,t)),e.title&&$we(e.title,t),t.parseLambdas(),t}const Zwe=e=>Hh({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function eEe(e,t){const n=t.config,i=ke(t.root=t.add(pv())),r=tEe(e,n);r.forEach(l=>Sj(l,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const s=t.add(zs()),a=t.add(kj(Ej(Zwe(e.encode),Qx,G3,e.style,t,{pulse:ke(s)}))),o=t.add(Oj({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:i,pulse:ke(a)}));t.operators.pop(),t.pushState(ke(a),ke(o),null),Gj(e,t,r),t.operators.push(o);let u=t.add(Cj({mark:i,pulse:ke(o)}));return u=t.add(Tj({pulse:ke(u)})),u=t.add(Rc({pulse:ke(u)})),t.addData("root",new gc(t,s,s,u)),t}function tp(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function tEe(e,t){const n=a=>ys(e[a],t[a]),i=[tp("background",n("background")),tp("autosize",l2e(n("autosize"))),tp("padding",f2e(n("padding"))),tp("width",n("width")||0),tp("height",n("height")||0)],r=i.reduce((a,o)=>(a[o.name]=o,a),{}),s={};return pe(e.signals).forEach(a=>{ve(r,a.name)?a=We(r[a.name],a):i.push(a),s[a.name]=a}),pe(t.signals).forEach(a=>{!ve(s,a.name)&&!ve(r,a.name)&&i.push(a)}),i}function Hj(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function W6(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}Hj.prototype=W6.prototype={parse(e){return Gj(e,this)},fork(){return new W6(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof mA?ke(e):e;return this.add(h_e({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(i,r,s){let a,o;i&&(a=i.data||(i.data={}),o=a[r]||(a[r]=[]),o.push(s))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const i in t.index)n(t.index[i],e,"index:"+i)}return this},pushState(e,t,n){this._encode.push(ke(this.add(Rc({pulse:e})))),this._parent.push(t),this._lookup.push(n?ke(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return ot(this._parent)},encode(){return ot(this._encode)},lookup(){return ot(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(ge(e))return bg(e,t);e.signal||K("Unsupported field reference: "+le(e));const n=e.signal;let i=this.field[n];if(!i){const r={name:this.signalRef(n)};t&&(r.as=t),this.field[n]=i=ke(this.add(n_e(r)))}return i},compareRef(e){let t=!1;const n=s=>En(s)?(t=!0,this.signalRef(s.signal)):U2e(s)?(t=!0,this.exprRef(s.expr)):s,i=pe(e.field).map(n),r=pe(e.order).map(n);return t?ke(this.add(F6({fields:i,orders:r}))):T6(i,r)},keyRef(e,t){let n=!1;const i=s=>En(s)?(n=!0,ke(r[s.signal])):s,r=this.signals;return e=pe(e).map(i),n?ke(this.add(i_e({fields:e,flat:t}))):P2e(e,t)},sortRef(e){if(!e)return e;const t=Kx(e.op,e.field),n=e.order||L2e;return n.signal?ke(this.add(F6({fields:t,orders:this.signalRef(n.signal)}))):T6(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const i=this.id();this.streams.push({id:i,source:e,type:t}),this.events[n]=i}return this.events[n]},hasOwnSignal(e){return ve(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&K("Duplicate signal name: "+le(e));const n=t instanceof mA?t:this.add(pv(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||K("Unrecognized signal name: "+le(e)),this.signals[e]},signalRef(e){return this.signals[e]?ke(this.signals[e]):(ve(this.lambdas,e)||(this.lambdas[e]=this.add(pv(null))),ke(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const i=e[t],r=Sa(i,this),s=this.lambdas[i];s.params=r.$params,s.update=r.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!de(e)?e:this.signalRef(e.signal||sT(e))},exprRef(e,t){const n={expr:Sa(e,this)};return t&&(n.expr.$name=t),ke(this.add(e_e(n)))},addBinding(e,t){this.bindings||K("Nested signals do not support binding: "+le(e)),this.bindings.push(We({signal:e},t))},addScaleProj(e,t){ve(this.scales,e)&&K("Duplicate scale or projection name: "+le(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,p_e(t))},addProjection(e,t){this.addScaleProj(e,f_e(t))},getScale(e){return this.scales[e]||K("Unrecognized scale name: "+le(e)),this.scales[e]},scaleRef(e){return ke(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return ve(this.data,e)&&K("Duplicate data set name: "+le(e)),this.data[e]=t},getData(e){return this.data[e]||K("Undefined data set name: "+le(e)),this.data[e]},addDataPipeline(e,t){return ve(this.data,e)&&K("Duplicate data set name: "+le(e)),this.addData(e,gc.fromEntries(this,t))}};function sT(e){return(Q(e)?nEe:iEe)(e)}function nEe(e){const t=e.length;let n="[";for(let i=0;i<t;++i){const r=e[i];n+=(i>0?",":"")+(de(r)?r.signal||sT(r):le(r))}return n+"]"}function iEe(e){let t="{",n=0,i,r;for(i in e)r=e[i],t+=(++n>1?",":"")+le(i)+":"+(de(r)?r.signal||sT(r):le(r));return t+"}"}function rEe(){const e="sans-serif",i="#4c78a8",r="#000",s="#888",a="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:i},area:{fill:i},image:null,line:{stroke:i,strokeWidth:2},path:{stroke:i},rect:{fill:i},rule:{stroke:r},shape:{stroke:i},symbol:{fill:i,size:64},text:{fill:r,font:e,fontSize:11},trail:{fill:i,size:2},style:{"guide-label":{fill:r,font:e,fontSize:10},"guide-title":{fill:r,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:r,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:r,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:a},view:{fill:"transparent"}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:s,grid:!1,gridWidth:1,gridColor:a,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:s,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:a,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:s,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function sEe(e,t,n){return de(e)||K("Input Vega specification must be an object."),t=Nh(rEe(),t,e.config),eEe(e,new Hj(t,n)).toRuntime()}var aEe="5.31.0";We(eh,Yoe,Ade,ipe,jge,D0e,l1e,jme,f1e,I1e,W1e,Q1e);const oEe=Object.freeze(Object.defineProperty({__proto__:null,Bounds:pn,CanvasHandler:a0,CanvasRenderer:Ty,DATE:Ki,DAY:si,DAYOFYEAR:wa,Dataflow:Pf,Debug:UL,Error:yC,EventStream:nx,Gradient:I7,GroupItem:Ax,HOURS:br,Handler:$$,HybridHandler:Cz,HybridRenderer:ES,Info:BL,Item:Sx,MILLISECONDS:Fs,MINUTES:_r,MONTH:li,Marks:wr,MultiPulse:jC,None:zL,Operator:Ot,Parameters:tx,Pulse:ku,QUARTER:Xi,RenderType:vu,Renderer:s0,ResourceLoader:j7,SECONDS:Kr,SVGHandler:dz,SVGRenderer:R$,SVGStringRenderer:Az,Scenegraph:sz,TIME_UNITS:MC,Transform:H,View:fj,WEEK:_n,Warn:vC,YEAR:Hn,accessor:tr,accessorFields:ui,accessorName:en,array:pe,ascending:Ih,bandwidthNRD:GC,bin:w8,bootstrapCI:E8,boundClip:Dz,boundContext:t0,boundItem:vS,boundMark:tz,boundStroke:zo,changeset:Oc,clampRange:QL,codegenExpression:LU,compare:EC,constant:di,cumulativeLogNormal:QC,cumulativeNormal:rx,cumulativeUniform:nk,dayofyear:T4,debounce:SC,defaultLocale:PC,definition:x8,densityLogNormal:JC,densityNormal:HC,densityUniform:tk,domChild:xn,domClear:Lr,domCreate:mu,domFind:k$,dotbin:S8,error:K,expressionFunction:ln,extend:We,extent:xa,extentIndex:ZL,falsy:au,fastmap:Dh,field:Yr,flush:e4,font:Ox,fontFamily:r0,fontSize:Ma,format:S1,formatLocale:oy,formats:BC,hasOwnProperty:ve,id:Bg,identity:hi,inferType:u8,inferTypes:l8,ingest:yt,inherits:ce,inrange:$f,interpolate:r$,interpolateColors:wx,interpolateRange:_7,intersect:Mz,intersectBoxLine:Tf,intersectPath:h$,intersectPoint:d$,intersectRule:V7,isArray:Q,isBoolean:Ku,isDate:Au,isFunction:Ye,isIterable:t4,isNumber:dt,isObject:de,isRegExp:n4,isString:ge,isTuple:Zv,key:AC,lerp:i4,lineHeight:Lu,loader:Jv,locale:a8,logger:xC,lruCache:r4,markup:N$,merge:s4,mergeConfig:Nh,multiLineOffset:S$,one:Mh,pad:a4,panLinear:GL,panLog:HL,panPow:YL,panSymlog:XL,parse:sEe,parseExpression:N3,parseSelector:nl,path:lx,pathCurves:l$,pathEqual:Pz,pathParse:ah,pathRectangle:L7,pathRender:ug,pathSymbols:P7,pathTrail:z7,peek:ot,point:Mx,projection:Z$,quantileLogNormal:ZC,quantileNormal:sx,quantileUniform:ik,quantiles:VC,quantizeInterpolator:w7,quarter:KL,quartiles:WC,get random(){return Jr},randomInteger:Qae,randomKDE:XC,randomLCG:Jae,randomLogNormal:C8,randomMixture:k8,randomNormal:YC,randomUniform:$8,read:h8,regressionConstant:rk,regressionExp:O8,regressionLinear:sk,regressionLoess:N8,regressionLog:T8,regressionPoly:M8,regressionPow:F8,regressionQuad:ak,renderModule:Nx,repeat:fp,resetDefaultLocale:Yse,resetSVGClipId:U7,resetSVGDefIds:qhe,responseType:f8,runtimeContext:QU,sampleCurve:ox,sampleLogNormal:KC,sampleNormal:ix,sampleUniform:ek,scale:gt,sceneEqual:I$,sceneFromJSON:iz,scenePickVisit:_y,sceneToJSON:nz,sceneVisit:Ms,sceneZOrder:p$,scheme:s$,serializeXML:_z,setHybridRendererOptions:zhe,setRandom:Xae,span:Ug,splitAccessPath:Ta,stringValue:le,textMetrics:yr,timeBin:G4,timeFloor:D4,timeFormatLocale:ng,timeInterval:Bh,timeOffset:z4,timeSequence:j4,timeUnitSpecifier:$4,timeUnits:NC,toBoolean:CC,toDate:kC,toNumber:ai,toSet:Os,toString:$C,transform:b8,transforms:eh,truncate:o4,truthy:Xr,tupleid:$e,typeParsers:eS,utcFloor:P4,utcInterval:Uh,utcOffset:B4,utcSequence:q4,utcdayofyear:M4,utcquarter:JL,utcweek:N4,version:aEe,visitArray:lu,week:O4,writeConfig:Rh,zero:pu,zoomLinear:bC,zoomLog:_C,zoomPow:ty,zoomSymlog:wC},Symbol.toStringTag,{value:"Module"}));function uEe(e,t,n){let i;t.x2&&(t.x?(n&&e.x>e.x2&&(i=e.x,e.x=e.x2,e.x2=i),e.width=e.x2-e.x):e.x=e.x2-(e.width||0)),t.xc&&(e.x=e.xc-(e.width||0)/2),t.y2&&(t.y?(n&&e.y>e.y2&&(i=e.y,e.y=e.y2,e.y2=i),e.height=e.y2-e.y):e.y=e.y2-(e.height||0)),t.yc&&(e.y=e.yc-(e.height||0)/2)}var lEe={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},cEe={"*":(e,t)=>e*t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,">":(e,t)=>e>t,"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,">=":(e,t)=>e>=t,"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,"===":(e,t)=>e===t,"!==":(e,t)=>e!==t,"&":(e,t)=>e&t,"|":(e,t)=>e|t,"^":(e,t)=>e^t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t},fEe={"+":e=>+e,"-":e=>-e,"~":e=>~e,"!":e=>!e};const hEe=Array.prototype.slice,$l=(e,t,n)=>{const i=n?n(t[0]):t[0];return i[e].apply(i,hEe.call(t,1))},dEe=(e,t,n,i,r,s,a)=>new Date(e,t||0,n??1,i||0,r||0,s||0,a||0);var pEe={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(e,t,n)=>Math.max(t,Math.min(n,e)),now:Date.now,utc:Date.UTC,datetime:dEe,date:e=>new Date(e).getDate(),day:e=>new Date(e).getDay(),year:e=>new Date(e).getFullYear(),month:e=>new Date(e).getMonth(),hours:e=>new Date(e).getHours(),minutes:e=>new Date(e).getMinutes(),seconds:e=>new Date(e).getSeconds(),milliseconds:e=>new Date(e).getMilliseconds(),time:e=>new Date(e).getTime(),timezoneoffset:e=>new Date(e).getTimezoneOffset(),utcdate:e=>new Date(e).getUTCDate(),utcday:e=>new Date(e).getUTCDay(),utcyear:e=>new Date(e).getUTCFullYear(),utcmonth:e=>new Date(e).getUTCMonth(),utchours:e=>new Date(e).getUTCHours(),utcminutes:e=>new Date(e).getUTCMinutes(),utcseconds:e=>new Date(e).getUTCSeconds(),utcmilliseconds:e=>new Date(e).getUTCMilliseconds(),length:e=>e.length,join:function(){return $l("join",arguments)},indexof:function(){return $l("indexOf",arguments)},lastindexof:function(){return $l("lastIndexOf",arguments)},slice:function(){return $l("slice",arguments)},reverse:e=>e.slice().reverse(),sort:e=>e.slice().sort(Ih),parseFloat,parseInt,upper:e=>String(e).toUpperCase(),lower:e=>String(e).toLowerCase(),substring:function(){return $l("substring",arguments,String)},split:function(){return $l("split",arguments,String)},replace:function(){return $l("replace",arguments,String)},trim:e=>String(e).trim(),regexp:RegExp,test:(e,t)=>RegExp(e).test(t)};const gEe=["view","item","group","xy","x","y"],EA=new Set([Function,eval,setTimeout,setInterval]);typeof setImmediate=="function"&&EA.add(setImmediate);const mEe={Literal:(e,t)=>t.value,Identifier:(e,t)=>{const n=t.name;return e.memberDepth>0?n:n==="datum"?e.datum:n==="event"?e.event:n==="item"?e.item:lEe[n]||e.params["$"+n]},MemberExpression:(e,t)=>{const n=!t.computed,i=e(t.object);n&&(e.memberDepth+=1);const r=e(t.property);if(n&&(e.memberDepth-=1),EA.has(i[r])){console.error(`Prevented interpretation of member "${r}" which could lead to insecure code execution`);return}return i[r]},CallExpression:(e,t)=>{const n=t.arguments;let i=t.callee.name;return i.startsWith("_")&&(i=i.slice(1)),i==="if"?e(n[0])?e(n[1]):e(n[2]):(e.fn[i]||pEe[i]).apply(e.fn,n.map(e))},ArrayExpression:(e,t)=>t.elements.map(e),BinaryExpression:(e,t)=>cEe[t.operator](e(t.left),e(t.right)),UnaryExpression:(e,t)=>fEe[t.operator](e(t.argument)),ConditionalExpression:(e,t)=>e(t.test)?e(t.consequent):e(t.alternate),LogicalExpression:(e,t)=>t.operator==="&&"?e(t.left)&&e(t.right):e(t.left)||e(t.right),ObjectExpression:(e,t)=>t.properties.reduce((n,i)=>{e.memberDepth+=1;const r=e(i.key);return e.memberDepth-=1,EA.has(e(i.value))?console.error(`Prevented interpretation of property "${r}" which could lead to insecure code execution`):n[r]=e(i.value),n},{})};function np(e,t,n,i,r,s){const a=o=>mEe[o.type](a,o);return a.memberDepth=0,a.fn=Object.create(t),a.params=n,a.datum=i,a.event=r,a.item=s,gEe.forEach(o=>a.fn[o]=function(){return r.vega[o](...arguments)}),a(e)}var yEe={operator(e,t){const n=t.ast,i=e.functions;return r=>np(n,i,r)},parameter(e,t){const n=t.ast,i=e.functions;return(r,s)=>np(n,i,s,r)},event(e,t){const n=t.ast,i=e.functions;return r=>np(n,i,void 0,void 0,r)},handler(e,t){const n=t.ast,i=e.functions;return(r,s)=>{const a=s.item&&s.item.datum;return np(n,i,r,a,s)}},encode(e,t){const{marktype:n,channels:i}=t,r=e.functions,s=n==="group"||n==="image"||n==="rect";return(a,o)=>{const u=a.datum;let l=0,c;for(const f in i)c=np(i[f].ast,r,o,u,void 0,a),a[f]!==c&&(a[f]=c,l=1);return n!=="rule"&&uEe(a,i,s),l}}};const vEe="5.23.0",xEe={version:vEe};function aT(e){return se(e,"or")}function oT(e){return se(e,"and")}function uT(e){return se(e,"not")}function Y1(e,t){if(uT(e))Y1(e.not,t);else if(oT(e))for(const n of e.and)Y1(n,t);else if(aT(e))for(const n of e.or)Y1(n,t);else t(e)}function jf(e,t){return uT(e)?{not:jf(e.not,t)}:oT(e)?{and:e.and.map(n=>jf(n,t))}:aT(e)?{or:e.or.map(n=>jf(n,t))}:t(e)}const De=structuredClone;function Yj(e){throw new Error(e)}function gh(e,t){const n={};for(const i of t)ve(e,i)&&(n[i]=e[i]);return n}function Hi(e,t){const n={...e};for(const i of t)delete n[i];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>kt(e)).join(",")})`};function nt(e){if(dt(e))return e;const t=ge(e)?e:kt(e);if(t.length<250)return t;let n=0;for(let i=0;i<t.length;i++){const r=t.charCodeAt(i);n=(n<<5)-n+r,n=n&n}return n}function SA(e){return e===!1||e===null}function Ze(e,t){return e.includes(t)}function mh(e,t){let n=0;for(const[i,r]of e.entries())if(t(r,i,n++))return!0;return!1}function lT(e,t){let n=0;for(const[i,r]of e.entries())if(!t(r,i,n++))return!1;return!0}function Xj(e,...t){for(const n of t)bEe(e,n??{});return e}function bEe(e,t){for(const n of re(t))Rh(e,n,t[n],!0)}function fa(e,t){const n=[],i={};let r;for(const s of e)r=t(s),!(r in i)&&(i[r]=1,n.push(s));return n}function _Ee(e,t){const n=re(e),i=re(t);if(n.length!==i.length)return!1;for(const r of n)if(e[r]!==t[r])return!1;return!0}function Kj(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function cT(e,t){for(const n of e)if(t.has(n))return!0;return!1}function AA(e){const t=new Set;for(const n of e){const r=Ta(n).map((a,o)=>o===0?a:`[${a}]`),s=r.map((a,o)=>r.slice(0,o+1).join(""));for(const a of s)t.add(a)}return t}function fT(e,t){return e===void 0||t===void 0?!0:cT(AA(e),AA(t))}function Ct(e){return re(e).length===0}const re=Object.keys,Yn=Object.values,ju=Object.entries;function Eg(e){return e===!0||e===!1}function Bt(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function Hp(e,t){return uT(e)?`!(${Hp(e.not,t)})`:oT(e)?`(${e.and.map(n=>Hp(n,t)).join(") && (")})`:aT(e)?`(${e.or.map(n=>Hp(n,t)).join(") || (")})`:t(e)}function gv(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&gv(e[n],t)&&delete e[n],Ct(e)}function y0(e){return e.charAt(0).toUpperCase()+e.substr(1)}function hT(e,t="datum"){const n=Ta(e),i=[];for(let r=1;r<=n.length;r++){const s=`[${n.slice(0,r).map(le).join("][")}]`;i.push(`${t}${s}`)}return i.join(" && ")}function Jj(e,t="datum"){return`${t}[${le(Ta(e).join("."))}]`}function wt(e){return`datum['${e.replaceAll("'","\\'")}']`}function wEe(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function Zr(e){return`${Ta(e).map(wEe).join("\\.")}`}function mc(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function Kh(e){return`${Ta(e).join(".")}`}function yh(e){return e?Ta(e).length:0}function on(...e){return e.find(t=>t!==void 0)}let Qj=42;function Zj(e){const t=++Qj;return e?String(e)+t:t}function EEe(){Qj=42}function eq(e){return tq(e)?e:`__${e}`}function tq(e){return e.startsWith("__")}function Sg(e){if(e!==void 0)return(e%360+360)%360}function ib(e){return dt(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}const G6=Object.getPrototypeOf(structuredClone({}));function gr(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor.name!==t.constructor.name)return!1;let n,i;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(i=n;i--!==0;)if(!gr(e[i],t[i]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const s of e.entries())if(!t.has(s[0]))return!1;for(const s of e.entries())if(!gr(s[1],t.get(s[0])))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const s of e.entries())if(!t.has(s[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(n=e.length,n!=t.length)return!1;for(i=n;i--!==0;)if(e[i]!==t[i])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&e.valueOf!==G6.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&e.toString!==G6.toString)return e.toString()===t.toString();const r=Object.keys(e);if(n=r.length,n!==Object.keys(t).length)return!1;for(i=n;i--!==0;)if(!Object.prototype.hasOwnProperty.call(t,r[i]))return!1;for(i=n;i--!==0;){const s=r[i];if(!gr(e[s],t[s]))return!1}return!0}return e!==e&&t!==t}function kt(e){const t=[];return function n(i){if(i&&i.toJSON&&typeof i.toJSON=="function"&&(i=i.toJSON()),i===void 0)return;if(typeof i=="number")return isFinite(i)?""+i:"null";if(typeof i!="object")return JSON.stringify(i);let r,s;if(Array.isArray(i)){for(s="[",r=0;r<i.length;r++)r&&(s+=","),s+=n(i[r])||"null";return s+"]"}if(i===null)return"null";if(t.includes(i))throw new TypeError("Converting circular structure to JSON");const a=t.push(i)-1,o=Object.keys(i).sort();for(s="",r=0;r<o.length;r++){const u=o[r],l=n(i[u]);l&&(s&&(s+=","),s+=JSON.stringify(u)+":"+l)}return t.splice(a,1),`{${s}}`}(e)}function se(e,t){return de(e)&&ve(e,t)&&e[t]!==void 0}const Eo="row",So="column",rb="facet",Ut="x",Pn="y",Us="x2",Da="y2",il="xOffset",Jh="yOffset",js="radius",Uo="radius2",is="theta",jo="theta2",qs="latitude",Vs="longitude",Ws="latitude2",es="longitude2",rl="time",Qi="color",Pa="fill",La="stroke",Zi="shape",qo="size",Dc="angle",Vo="opacity",sl="fillOpacity",al="strokeOpacity",ol="strokeWidth",ul="strokeDash",v0="text",vh="order",x0="detail",sb="key",yc="tooltip",ab="href",ob="url",ub="description",SEe={x:1,y:1,x2:1,y2:1},nq={theta:1,theta2:1,radius:1,radius2:1};function iq(e){return ve(nq,e)}const dT={longitude:1,longitude2:1,latitude:1,latitude2:1};function rq(e){switch(e){case qs:return"y";case Ws:return"y2";case Vs:return"x";case es:return"x2"}}function sq(e){return ve(dT,e)}const AEe=re(dT),pT={...SEe,...nq,...dT,xOffset:1,yOffset:1,color:1,fill:1,stroke:1,time:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1};function qf(e){return e===Qi||e===Pa||e===La}const aq={row:1,column:1,facet:1},Wr=re(aq),gT={...pT,...aq},CEe=re(gT),{order:z4e,detail:B4e,tooltip:U4e,...kEe}=gT,{row:j4e,column:q4e,facet:V4e,...$Ee}=kEe;function TEe(e){return ve($Ee,e)}function oq(e){return ve(gT,e)}const OEe=[Us,Da,Ws,es,jo,Uo];function uq(e){return Pc(e)!==e}function Pc(e){switch(e){case Us:return Ut;case Da:return Pn;case Ws:return qs;case es:return Vs;case jo:return is;case Uo:return js}return e}function qu(e){if(iq(e))switch(e){case is:return"startAngle";case jo:return"endAngle";case js:return"outerRadius";case Uo:return"innerRadius"}return e}function za(e){switch(e){case Ut:return Us;case Pn:return Da;case qs:return Ws;case Vs:return es;case is:return jo;case js:return Uo}}function er(e){switch(e){case Ut:case Us:return"width";case Pn:case Da:return"height"}}function lq(e){switch(e){case Ut:return"xOffset";case Pn:return"yOffset";case Us:return"x2Offset";case Da:return"y2Offset";case is:return"thetaOffset";case js:return"radiusOffset";case jo:return"theta2Offset";case Uo:return"radius2Offset"}}function mT(e){switch(e){case Ut:return"xOffset";case Pn:return"yOffset"}}function FEe(e){switch(e){case"xOffset":return"x";case"yOffset":return"y"}}const MEe=re(pT),{x:W4e,y:G4e,x2:H4e,y2:Y4e,xOffset:X4e,yOffset:K4e,latitude:J4e,longitude:Q4e,latitude2:Z4e,longitude2:e8e,theta:t8e,theta2:n8e,radius:i8e,radius2:r8e,...yT}=pT,NEe=re(yT),vT={x:1,y:1},Wo=re(vT);function un(e){return ve(vT,e)}const xT={theta:1,radius:1},REe=re(xT);function lb(e){return e==="width"?Ut:Pn}const cq={xOffset:1,yOffset:1};function b0(e){return ve(cq,e)}const IEe={time:1};function qw(e){return e in IEe}const{text:s8e,tooltip:a8e,href:o8e,url:u8e,description:l8e,detail:c8e,key:f8e,order:h8e,...fq}=yT,DEe=re(fq);function PEe(e){return ve(yT,e)}function LEe(e){switch(e){case Qi:case Pa:case La:case qo:case Zi:case Vo:case ol:case ul:return!0;case sl:case al:case Dc:case rl:return!1}}const hq={...vT,...xT,...cq,...fq},bT=re(hq);function Ba(e){return ve(hq,e)}function zEe(e,t){return UEe(e)[t]}const dq={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:d8e,...BEe}=dq;function UEe(e){switch(e){case Qi:case Pa:case La:case ub:case x0:case sb:case yc:case ab:case vh:case Vo:case sl:case al:case ol:case rb:case Eo:case So:return dq;case Ut:case Pn:case il:case Jh:case qs:case Vs:case rl:return BEe;case Us:case Da:case Ws:case es:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case qo:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case ul:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case Zi:return{point:"always",geoshape:"always"};case v0:return{text:"always"};case Dc:return{point:"always",square:"always",text:"always"};case ob:return{image:"always"};case is:return{text:"always",arc:"always"};case js:return{text:"always",arc:"always"};case jo:case Uo:return{arc:"always"}}}function Vw(e){switch(e){case Ut:case Pn:case is:case js:case il:case Jh:case qo:case Dc:case ol:case Vo:case sl:case al:case rl:case Us:case Da:case jo:case Uo:return;case rb:case Eo:case So:case Zi:case ul:case v0:case yc:case ab:case ob:case ub:return"discrete";case Qi:case Pa:case La:return"flexible";case qs:case Vs:case Ws:case es:case x0:case sb:case vh:return}}const jEe={argmax:1,argmin:1,average:1,count:1,distinct:1,exponential:1,exponentialb:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},qEe={count:1,min:1,max:1};function Fo(e){return se(e,"argmin")}function ll(e){return se(e,"argmax")}function _T(e){return ge(e)&&ve(jEe,e)}const VEe=new Set(["count","valid","missing","distinct"]);function cb(e){return ge(e)&&VEe.has(e)}function WEe(e){return ge(e)&&Ze(["min","max"],e)}const GEe=new Set(["count","sum","distinct","valid","missing"]),HEe=new Set(["mean","average","median","q1","q3","min","max"]);function pq(e){return Ku(e)&&(e=wb(e,void 0)),"bin"+re(e).map(t=>fb(e[t])?Bt(`_${t}_${ju(e[t])}`):Bt(`_${t}_${e[t]}`)).join("")}function Nt(e){return e===!0||Lc(e)&&!e.binned}function Un(e){return e==="binned"||Lc(e)&&e.binned===!0}function Lc(e){return de(e)}function fb(e){return se(e,"param")}function H6(e){switch(e){case Eo:case So:case qo:case Qi:case Pa:case La:case ol:case Vo:case sl:case al:case Zi:return 6;case ul:return 4;default:return 10}}function _0(e){return se(e,"expr")}function jn(e,{level:t}={level:0}){const n=re(e||{}),i={};for(const r of n)i[r]=t===0?hr(e[r]):jn(e[r],{level:t-1});return i}function gq(e){const{anchor:t,frame:n,offset:i,orient:r,angle:s,limit:a,color:o,subtitleColor:u,subtitleFont:l,subtitleFontSize:c,subtitleFontStyle:f,subtitleFontWeight:d,subtitleLineHeight:p,subtitlePadding:m,...y}=e,v={...y,...o?{fill:o}:{}},b={...t?{anchor:t}:{},...n?{frame:n}:{},...i?{offset:i}:{},...r?{orient:r}:{},...s!==void 0?{angle:s}:{},...a!==void 0?{limit:a}:{}},_={...u?{subtitleColor:u}:{},...l?{subtitleFont:l}:{},...c?{subtitleFontSize:c}:{},...f?{subtitleFontStyle:f}:{},...d?{subtitleFontWeight:d}:{},...p?{subtitleLineHeight:p}:{},...m?{subtitlePadding:m}:{}},E=gh(e,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:v,subtitleMarkConfig:E,nonMarkTitleProperties:b,subtitle:_}}function du(e){return ge(e)||Q(e)&&ge(e[0])}function Ee(e){return se(e,"signal")}function zc(e){return se(e,"step")}function YEe(e){return Q(e)?!1:se(e,"fields")&&!se(e,"data")}function XEe(e){return Q(e)?!1:se(e,"fields")&&se(e,"data")}function vo(e){return Q(e)?!1:se(e,"field")&&se(e,"data")}const KEe={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1},JEe=re(KEe),QEe={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},CA=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function mq(e){const t=Q(e.condition)?e.condition.map(Y6):Y6(e.condition);return{...hr(e),condition:t}}function hr(e){if(_0(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function Y6(e){if(_0(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function Dt(e){if(_0(e)){const{expr:t,...n}=e;return{signal:t,...n}}return Ee(e)?e:e!==void 0?{value:e}:void 0}function ZEe(e){return Ee(e)?e.signal:le(e)}function X6(e){return Ee(e)?e.signal:le(e.value)}function Ss(e){return Ee(e)?e.signal:e==null?null:le(e)}function eSe(e,t,n){for(const i of n){const r=Aa(i,t.markDef,t.config);r!==void 0&&(e[i]=Dt(r))}return e}function yq(e){return[].concat(e.type,e.style??[])}function At(e,t,n,i={}){const{vgChannel:r,ignoreVgConfig:s}=i;return r&&se(t,r)?t[r]:t[e]!==void 0?t[e]:s&&(!r||r===e)?void 0:Aa(e,t,n,i)}function Aa(e,t,n,{vgChannel:i}={}){const r=kA(e,t,n.style);return on(i?r:void 0,r,i?n[t.type][i]:void 0,n[t.type][e],i?n.mark[i]:n.mark[e])}function kA(e,t,n){return vq(e,yq(t),n)}function vq(e,t,n){t=pe(t);let i;for(const r of t){const s=n[r];se(s,e)&&(i=s[e])}return i}function xq(e,t){return pe(e).reduce((n,i)=>(n.field.push(fe(i,t)),n.order.push(i.sort??"ascending"),n),{field:[],order:[]})}function bq(e,t){const n=[...e];return t.forEach(i=>{for(const r of n)if(gr(r,i))return;n.push(i)}),n}function _q(e,t){return gr(e,t)||!t?e:e?[...pe(e),...pe(t)].join(", "):t}function wq(e,t){const n=e.value,i=t.value;if(n==null||i===null)return{explicit:e.explicit,value:null};if((du(n)||Ee(n))&&(du(i)||Ee(i)))return{explicit:e.explicit,value:_q(n,i)};if(du(n)||Ee(n))return{explicit:e.explicit,value:n};if(du(i)||Ee(i))return{explicit:e.explicit,value:i};if(!du(n)&&!Ee(n)&&!du(i)&&!Ee(i))return{explicit:e.explicit,value:bq(n,i)};throw new Error("It should never reach here")}function wT(e){return`Invalid specification ${kt(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const tSe='Autosize "fit" only works for single views and layered views.';function K6(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function J6(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function Q6(e){return e?`Dropping "fit-${e}" because spec has discrete ${er(e)}.`:'Dropping "fit" because spec has discrete size.'}function ET(e){return`Unknown field for ${e}. Cannot calculate view size.`}function Z6(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function nSe(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function iSe(e){return`The "nearest" transform is not supported for ${e} marks.`}function Eq(e){return`Selection not supported for ${e} yet.`}function rSe(e){return`Cannot find a selection named "${e}".`}const sSe="Scale bindings are currently only supported for scales with unbinned, continuous domains.",aSe="Sequntial scales are deprecated. The available quantitative scale type values are linear, log, pow, sqrt, symlog, time and utc",oSe="Legend bindings are only supported for selections over an individual field or encoding channel.";function uSe(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}function lSe(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}const cSe="The same selection must be used to override scale domains in a layered view.",fSe='Interval selections should be initialized using "x", "y", "longitude", or "latitude" keys.';function hSe(e){return`Unknown repeated value "${e}".`}function e5(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const dSe="Multiple timer selections in one unit spec are not supported. Ignoring all but the first.",ST="Animation involving facet, layer, or concat is currently unsupported.";function pSe(e){return`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${le(e)}.`}function gSe(e,t,n,i){return(e.length?"Multiple ":"No ")+`matching ${le(t)} encoding found for selection ${le(n.param)}. Using "field": ${le(i)}.`}const mSe="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function ySe(e){return`Unrecognized parse "${e}".`}function t5(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}const vSe="Attempt to add the same child twice.";function xSe(e){return`Ignoring an invalid transform: ${kt(e)}.`}const bSe='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function n5(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function _Se(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${kt(t)} is overridden by a child projection ${kt(n)}.`}const wSe="Arc marks uses theta channel rather than angle, replacing angle with theta.";function ESe(e){return`${e}Offset dropped because ${e} is continuous`}function SSe(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${kt(n)}}.`}function Sq(e){return`Invalid field type "${e}".`}function ASe(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function CSe(e){return`Invalid aggregation operator "${e}".`}function Aq(e,t){const{fill:n,stroke:i}=t;return`Dropping color ${e} as the plot also has ${n&&i?"fill and stroke":n?"fill":"stroke"}.`}function kSe(e){return`Position range does not support relative band size for ${e}.`}function $A(e,t){return`Dropping ${kt(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const $Se="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function hb(e,t,n){return`${e} dropped as it is incompatible with "${t}".`}function TSe(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function OSe(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function FSe(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function MSe(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function Ww(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function NSe(e){return`The ${e} for range marks cannot be an expression`}function RSe(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function ISe(e,t){return`Specified orient "${e}" overridden with "${t}".`}function DSe(e){return`Cannot use the scale property "${e}" with non-color channel.`}function PSe(e){return`Cannot use the relative band size with ${e} scale.`}function LSe(e){return`Using unaggregated domain with raw field has no effect (${kt(e)}).`}function zSe(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function BSe(e){return`Unaggregated domain is currently unsupported for log scale (${kt(e)}).`}function USe(e){return`Cannot apply size to non-oriented mark "${e}".`}function jSe(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function qSe(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function Cq(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function kq(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function VSe(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${kt(n)} and ${kt(i)}). Using ${kt(n)}.`}function WSe(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${kt(n)} and ${kt(i)}). Using the union of the two domains.`}function GSe(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function HSe(e){return`Dropping sort property ${kt(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const i5="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",YSe="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",XSe="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",KSe="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function JSe(e){return`Cannot stack "${e}" if there is already "${e}2".`}function QSe(e){return`Stack is applied to a non-linear scale (${e}).`}function ZSe(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function mv(e,t){return`Invalid ${e}: ${kt(t)}.`}function eAe(e){return`Dropping day from datetime ${kt(e)} as day cannot be combined with other units.`}function tAe(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function nAe(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function iAe(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function r5(e){return`1D error band does not support ${e}.`}function $q(e){return`Channel ${e} is required for "binned" bin.`}function rAe(e){return`Channel ${e} should not be used with "binned" bin.`}function sAe(e){return`Domain for ${e} is required for threshold scale.`}const Tq=xC(vC);let vc=Tq;function aAe(e){return vc=e,vc}function oAe(){return vc=Tq,vc}function AT(...e){vc.error(...e)}function oe(...e){vc.warn(...e)}function uAe(...e){vc.debug(...e)}function Bc(e){if(e&&de(e)){for(const t of kT)if(se(e,t))return!0}return!1}const Oq=["january","february","march","april","may","june","july","august","september","october","november","december"],lAe=Oq.map(e=>e.substr(0,3)),Fq=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],cAe=Fq.map(e=>e.substr(0,3));function fAe(e){if(ib(e)&&(e=+e),dt(e))return e>4&&oe(mv("quarter",e)),e-1;throw new Error(mv("quarter",e))}function hAe(e){if(ib(e)&&(e=+e),dt(e))return e-1;{const t=e.toLowerCase(),n=Oq.indexOf(t);if(n!==-1)return n;const i=t.substr(0,3),r=lAe.indexOf(i);if(r!==-1)return r;throw new Error(mv("month",e))}}function dAe(e){if(ib(e)&&(e=+e),dt(e))return e%7;{const t=e.toLowerCase(),n=Fq.indexOf(t);if(n!==-1)return n;const i=t.substr(0,3),r=cAe.indexOf(i);if(r!==-1)return r;throw new Error(mv("day",e))}}function CT(e,t){const n=[];if(t&&e.day!==void 0&&re(e).length>1&&(oe(eAe(e)),e=De(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const i=t?hAe(e.month):e.month;n.push(i)}else if(e.quarter!==void 0){const i=t?fAe(e.quarter):e.quarter;n.push(dt(i)?i*3:`${i}*3`)}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const i=t?dAe(e.day):e.day;n.push(dt(i)?i+1:`${i}+1`)}else n.push(1);for(const i of["hours","minutes","seconds","milliseconds"]){const r=e[i];n.push(typeof r>"u"?0:r)}return n}function xc(e){const n=CT(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function pAe(e){const n=CT(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function gAe(e){const t=CT(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}const Mq={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},kT=re(Mq);function mAe(e){return ve(Mq,e)}function Uc(e){return de(e)?e.binned:Nq(e)}function Nq(e){return e&&e.startsWith("binned")}function $T(e){return e.startsWith("utc")}function yAe(e){return e.substring(3)}const vAe={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function db(e){return kT.filter(t=>Iq(e,t))}function Rq(e){const t=db(e);return t[t.length-1]}function Iq(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function xAe(e,t,{end:n}={end:!1}){const i=hT(t),r=$T(e)?"utc":"";function s(u){return u==="quarter"?`(${r}quarter(${i})-1)`:`${r}${u}(${i})`}let a;const o={};for(const u of kT)Iq(e,u)&&(o[u]=s(u),a=u);return n&&(o[a]+="+1"),pAe(o)}function Dq(e){if(!e)return;const t=db(e);return`timeUnitSpecifier(${kt(t)}, ${kt(vAe)})`}function bAe(e,t,n){if(!e)return;const i=Dq(e);return`${n||$T(e)?"utc":"time"}Format(${t}, ${i})`}function Rn(e){if(!e)return;let t;return ge(e)?Nq(e)?t={unit:e.substring(6),binned:!0}:t={unit:e}:de(e)&&(t={...e,...e.unit?{unit:e.unit}:{}}),$T(t.unit)&&(t.utc=!0,t.unit=yAe(t.unit)),t}function _Ae(e){const{utc:t,...n}=Rn(e);return n.unit?(t?"utc":"")+re(n).map(i=>Bt(`${i==="unit"?"":`_${i}_`}${n[i]}`)).join(""):(t?"utc":"")+"timeunit"+re(n).map(i=>Bt(`_${i}_${n[i]}`)).join("")}function Pq(e,t=n=>n){const n=Rn(e),i=Rq(n.unit);if(i&&i!=="day"){const r={year:2001,month:1,date:1,hours:0,minutes:0,seconds:0,milliseconds:0},{step:s,part:a}=Lq(i,n.step),o={...r,[a]:+r[a]+s};return`${t(xc(o))} - ${t(xc(r))}`}}const wAe={year:1,month:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1};function EAe(e){return ve(wAe,e)}function Lq(e,t=1){if(EAe(e))return{part:e,step:t};switch(e){case"day":case"dayofyear":return{part:"date",step:t};case"quarter":return{part:"month",step:t*3};case"week":return{part:"date",step:t*7}}}function SAe(e){return se(e,"param")}function TT(e){return!!e?.field&&e.equal!==void 0}function OT(e){return!!e?.field&&e.lt!==void 0}function FT(e){return!!e?.field&&e.lte!==void 0}function MT(e){return!!e?.field&&e.gt!==void 0}function NT(e){return!!e?.field&&e.gte!==void 0}function RT(e){if(e?.field){if(Q(e.range)&&e.range.length===2)return!0;if(Ee(e.range))return!0}return!1}function IT(e){return!!e?.field&&(Q(e.oneOf)||Q(e.in))}function AAe(e){return!!e?.field&&e.valid!==void 0}function zq(e){return IT(e)||TT(e)||RT(e)||OT(e)||MT(e)||FT(e)||NT(e)}function ea(e,t){return Eb(e,{timeUnit:t,wrapTime:!0})}function CAe(e,t){return e.map(n=>ea(n,t))}function Bq(e,t=!0){const{field:n}=e,i=Rn(e.timeUnit),{unit:r,binned:s}=i||{},a=fe(e,{expr:"datum"}),o=r?`time(${s?a:xAe(r,n)})`:a;if(TT(e))return`${o}===${ea(e.equal,r)}`;if(OT(e)){const u=e.lt;return`${o}<${ea(u,r)}`}else if(MT(e)){const u=e.gt;return`${o}>${ea(u,r)}`}else if(FT(e)){const u=e.lte;return`${o}<=${ea(u,r)}`}else if(NT(e)){const u=e.gte;return`${o}>=${ea(u,r)}`}else{if(IT(e))return`indexof([${CAe(e.oneOf,r).join(",")}], ${o}) !== -1`;if(AAe(e))return pb(o,e.valid);if(RT(e)){const{range:u}=jn(e),l=Ee(u)?{signal:`${u.signal}[0]`}:u[0],c=Ee(u)?{signal:`${u.signal}[1]`}:u[1];if(l!==null&&c!==null&&t)return"inrange("+o+", ["+ea(l,r)+", "+ea(c,r)+"])";const f=[];return l!==null&&f.push(`${o} >= ${ea(l,r)}`),c!==null&&f.push(`${o} <= ${ea(c,r)}`),f.length>0?f.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${kt(e)}`)}function pb(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function kAe(e){return zq(e)&&e.timeUnit?{...e,timeUnit:Rn(e.timeUnit)}:e}const w0={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};function $Ae(e){return e==="quantitative"||e==="temporal"}function Uq(e){return e==="ordinal"||e==="nominal"}const bc=w0.quantitative,DT=w0.ordinal,xh=w0.temporal,PT=w0.nominal,Qh=w0.geojson;function TAe(e){if(e)switch(e=e.toLowerCase(),e){case"q":case bc:return"quantitative";case"t":case xh:return"temporal";case"o":case DT:return"ordinal";case"n":case PT:return"nominal";case Qh:return"geojson"}}const qn={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",TIME:"time",UTC:"utc",POINT:"point",BAND:"band"},TA={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function OAe(e,t){const n=TA[e],i=TA[t];return n===i||n==="ordinal-position"&&i==="time"||i==="ordinal-position"&&n==="time"}const FAe={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function s5(e){return FAe[e]}const jq=new Set(["linear","log","pow","sqrt","symlog"]),qq=new Set([...jq,"time","utc"]);function Vq(e){return jq.has(e)}const Wq=new Set(["quantile","quantize","threshold"]),MAe=new Set([...qq,...Wq,"sequential","identity"]),NAe=new Set(["ordinal","bin-ordinal","point","band"]);function In(e){return NAe.has(e)}function Ns(e){return MAe.has(e)}function ha(e){return qq.has(e)}function bh(e){return Wq.has(e)}const RAe={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,tickBandPaddingInner:.25,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:4,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4,zero:!0,framesPerSecond:2,animationDuration:5};function IAe(e){return!ge(e)&&se(e,"name")}function Gq(e){return se(e,"param")}function DAe(e){return se(e,"unionWith")}function PAe(e){return de(e)&&"field"in e}const LAe={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,domainRaw:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},{type:p8e,domain:g8e,range:m8e,rangeMax:y8e,rangeMin:v8e,scheme:x8e,...zAe}=LAe,BAe=re(zAe);function OA(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return ha(e)||e==="band"||e==="point";case"padding":case"rangeMin":case"rangeMax":return ha(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return e==="band";case"domainMax":case"domainMid":case"domainMin":case"domainRaw":case"clamp":return ha(e);case"nice":return ha(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return Ns(e)&&!Ze(["log","time","utc","threshold","quantile"],e)}}function Hq(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return qf(e)?void 0:DSe(t);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"domainRaw":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}function UAe(e,t){return Ze([DT,PT],t)?e===void 0||In(e):t===xh?Ze([qn.TIME,qn.UTC,void 0],e):t===bc?Vq(e)||bh(e)||e===void 0:!0}function jAe(e,t,n=!1){if(!Ba(e))return!1;switch(e){case Ut:case Pn:case il:case Jh:case is:case js:return ha(t)||t==="band"?!0:t==="point"?!n:!1;case rl:return Ze(["linear","band"],t);case qo:case ol:case Vo:case sl:case al:case Dc:return ha(t)||bh(t)||Ze(["band","point","ordinal"],t);case Qi:case Pa:case La:return t!=="band";case ul:case Zi:return t==="ordinal"||bh(t)}}function qAe(e){return de(e)&&"value"in e}const Ni={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},Yq=Ni.arc,gb=Ni.area,mb=Ni.bar,VAe=Ni.image,yb=Ni.line,vb=Ni.point,WAe=Ni.rect,yv=Ni.rule,Xq=Ni.text,LT=Ni.tick,GAe=Ni.trail,zT=Ni.circle,BT=Ni.square,Kq=Ni.geoshape;function cl(e){return["line","area","trail"].includes(e)}function Ag(e){return["rect","bar","image","arc","tick"].includes(e)}const HAe=new Set(re(Ni));function Ca(e){return se(e,"type")}const YAe=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],XAe=["fill","fillOpacity"],KAe=[...YAe,...XAe],JAe={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1},a5=re(JAe),Gw=["binSpacing","continuousBandSize","discreteBandSize","minBandSize"],QAe={area:["line","point"],bar:Gw,rect:Gw,line:["point"],tick:["bandSize","thickness",...Gw]},ZAe={color:"#4c78a8",invalid:"break-paths-show-path-domains",timeUnitBandSize:1},eCe={mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1},Jq=re(eCe);function _c(e){return se(e,"band")}const tCe={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},nCe=5,UT={binSpacing:0,continuousBandSize:nCe,minBandSize:.25,timeUnitBandPosition:.5},iCe={...UT,binSpacing:1},rCe={...UT,thickness:1};function sCe(e){return Ca(e)?e.type:e}function Qq(e,{isPath:t}){return e===void 0||e==="break-paths-show-path-domains"?t?"break-paths-show-domains":"filter":e===null?"show":e}function jT({markDef:e,config:t,scaleChannel:n,scaleType:i,isCountAggregate:r}){if(!i||!Ns(i)||r)return"always-valid";const s=Qq(At("invalid",e,t),{isPath:cl(e.type)});return t.scale?.invalid?.[n]!==void 0?"show":s}function aCe(e){return e==="break-paths-filter-domains"||e==="break-paths-show-domains"}function Zq({scaleName:e,scale:t,mode:n}){const i=`domain('${e}')`;if(!t||!e)return;const r=`${i}[0]`,s=`peek(${i})`,a=t.domainHasZero();return a==="definitely"?{scale:e,value:0}:a==="maybe"?{signal:`scale('${e}', inrange(0, ${i}) ? 0 : ${n==="zeroOrMin"?r:s})`}:{signal:`scale('${e}', ${n==="zeroOrMin"?r:s})`}}function eV({scaleChannel:e,channelDef:t,scale:n,scaleName:i,markDef:r,config:s}){const a=n?.get("type"),o=Is(t),u=cb(o?.aggregate),l=jT({scaleChannel:e,markDef:r,config:s,scaleType:a,isCountAggregate:u});if(o&&l==="show"){const c=s.scale.invalid?.[e]??"zero-or-min";return{test:pb(fe(o,{expr:"datum"}),!1),...oCe(c,n,i)}}}function oCe(e,t,n){if(qAe(e)){const{value:i}=e;return Ee(i)?{signal:i.signal}:{value:i}}return Zq({scale:t,scaleName:n,mode:"zeroOrMin"})}function qT(e){const{channel:t,channelDef:n,markDef:i,scale:r,scaleName:s,config:a}=e,o=Pc(t),u=VT(e),l=eV({scaleChannel:o,channelDef:n,scale:r,scaleName:s,markDef:i,config:a});return l!==void 0?[l,u]:u}function uCe(e){const{datum:t}=e;return Bc(t)?xc(t):`${kt(t)}`}function Zl(e,t,n,i){const r={};if(t&&(r.scale=t),Ua(e)){const{datum:s}=e;Bc(s)?r.signal=xc(s):Ee(s)?r.signal=s.signal:_0(s)?r.signal=s.expr:r.value=s}else r.field=fe(e,n);if(i){const{offset:s,band:a}=i;s&&(r.offset=s),a&&(r.band=a)}return r}function vv({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:i,startSuffix:r,endSuffix:s="end",bandPosition:a=.5}){const o=!Ee(a)&&0<a&&a<1?"datum":void 0,u=fe(t,{expr:o,suffix:r}),l=n!==void 0?fe(n,{expr:o}):fe(t,{suffix:s,expr:o}),c={};if(a===0||a===1){c.scale=e;const f=a===0?u:l;c.field=f}else{const f=Ee(a)?`(1-${a.signal}) * ${u} + ${a.signal} * ${l}`:`${1-a} * ${u} + ${a} * ${l}`;c.signal=`scale("${e}", ${f})`}return i&&(c.offset=i),c}function lCe({scaleName:e,fieldDef:t}){const n=fe(t,{expr:"datum"}),i=fe(t,{expr:"datum",suffix:"end"});return`abs(scale("${e}", ${i}) - scale("${e}", ${n}))`}function VT({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:s,scale:a,stack:o,offset:u,defaultRef:l,bandPosition:c}){if(t){if(Le(t)){const f=a?.get("type");if(Fi(t)){c??(c=Vu({fieldDef:t,fieldDef2:n,markDef:i,config:r}));const{bin:d,timeUnit:p,type:m}=t;if(Nt(d)||c&&p&&m===xh)return o?.impute?Zl(t,s,{binSuffix:"mid"},{offset:u}):c&&!In(f)?vv({scaleName:s,fieldOrDatumDef:t,bandPosition:c,offset:u}):Zl(t,s,k0(t,e)?{binSuffix:"range"}:{},{offset:u});if(Un(d)){if(ue(n))return vv({scaleName:s,fieldOrDatumDef:t,fieldOrDatumDef2:n,bandPosition:c,offset:u});oe($q(e===Ut?Us:Da))}}return Zl(t,s,In(f)?{binSuffix:"range"}:{},{offset:u,band:f==="band"?c??t.bandPosition??.5:void 0})}else if(Rs(t)){const f=t.value,d=u?{offset:u}:{};return{...Yp(e,f),...d}}}return Ye(l)&&(l=l()),l&&{...l,...u?{offset:u}:{}}}function Yp(e,t){return Ze(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:Ze(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:Dt(t)}function wc(e){return e&&e!=="number"&&e!=="time"}function tV(e,t,n){return`${e}(${t}${n?`, ${kt(n)}`:""})`}const cCe=" – ";function WT({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:s}){if(wc(n))return As({fieldOrDatumDef:e,format:t,formatType:n,expr:i,config:s});const a=nV(e,i,r),o=_h(e);if(t===void 0&&n===void 0&&s.customFormatTypes){if(o==="quantitative"){if(r&&s.normalizedNumberFormatType)return As({fieldOrDatumDef:e,format:s.normalizedNumberFormat,formatType:s.normalizedNumberFormatType,expr:i,config:s});if(s.numberFormatType)return As({fieldOrDatumDef:e,format:s.numberFormat,formatType:s.numberFormatType,expr:i,config:s})}if(o==="temporal"&&s.timeFormatType&&ue(e)&&e.timeUnit===void 0)return As({fieldOrDatumDef:e,format:s.timeFormat,formatType:s.timeFormatType,expr:i,config:s})}if(Eh(e)){const u=hCe({field:a,timeUnit:ue(e)?Rn(e.timeUnit)?.unit:void 0,format:t,formatType:s.timeFormatType,rawTimeFormat:s.timeFormat,isUTCScale:jc(e)&&e.scale?.type===qn.UTC});return u?{signal:u}:void 0}if(t=FA({type:o,specifiedFormat:t,config:s,normalizeStack:r}),ue(e)&&Nt(e.bin)){const u=fe(e,{expr:i,binSuffix:"end"});return{signal:E0(a,u,t,n,s)}}else return t||_h(e)==="quantitative"?{signal:`${sV(a,t)}`}:{signal:`isValid(${a}) ? ${a} : ""+${a}`}}function nV(e,t,n){return ue(e)?n?`${fe(e,{expr:t,suffix:"end"})}-${fe(e,{expr:t,suffix:"start"})}`:fe(e,{expr:t}):uCe(e)}function As({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:s,field:a}){if(a??(a=nV(e,i,r)),a!=="datum.value"&&ue(e)&&Nt(e.bin)){const o=fe(e,{expr:i,binSuffix:"end"});return{signal:E0(a,o,t,n,s)}}return{signal:tV(n,a,t)}}function iV(e,t,n,i,r,s){if(!(ge(i)&&wc(i))&&!(n===void 0&&i===void 0&&r.customFormatTypes&&_h(e)==="quantitative"&&(r.normalizedNumberFormatType&&wh(e)&&e.stack==="normalize"||r.numberFormatType))){if(wh(e)&&e.stack==="normalize"&&r.normalizedNumberFormat)return FA({type:"quantitative",config:r,normalizeStack:!0});if(Eh(e)){const a=ue(e)?Rn(e.timeUnit)?.unit:void 0;return a===void 0&&r.customFormatTypes&&r.timeFormatType?void 0:fCe({specifiedFormat:n,timeUnit:a,config:r,omitTimeFormatConfig:s})}return FA({type:t,specifiedFormat:n,config:r})}}function rV(e,t,n){if(e&&(Ee(e)||e==="number"||e==="time"))return e;if(Eh(t)&&n!=="time"&&n!=="utc")return ue(t)&&Rn(t?.timeUnit)?.utc?"utc":"time"}function FA({type:e,specifiedFormat:t,config:n,normalizeStack:i}){if(ge(t))return t;if(e===bc)return i?n.normalizedNumberFormat:n.numberFormat}function fCe({specifiedFormat:e,timeUnit:t,config:n,omitTimeFormatConfig:i}){return e||(t?{signal:Dq(t)}:i?void 0:n.timeFormat)}function sV(e,t){return`format(${e}, "${t||""}")`}function o5(e,t,n,i){return wc(n)?tV(n,e,t):sV(e,(ge(t)?t:void 0)??i.numberFormat)}function E0(e,t,n,i,r){if(n===void 0&&i===void 0&&r.customFormatTypes&&r.numberFormatType)return E0(e,t,r.numberFormat,r.numberFormatType,r);const s=o5(e,n,i,r),a=o5(t,n,i,r);return`${pb(e,!1)} ? "null" : ${s} + "${cCe}" + ${a}`}function hCe({field:e,timeUnit:t,format:n,formatType:i,rawTimeFormat:r,isUTCScale:s}){return!t||n?!t&&i?`${i}(${e}, '${n}')`:(n=ge(n)?n:r,`${s?"utc":"time"}Format(${e}, '${n}')`):bAe(t,e,s)}const xb="min",dCe={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function u5(e){return ve(dCe,e)}function pCe(e){return se(e,"encoding")}function Ao(e){return e&&(e.op==="count"||se(e,"field"))}function aV(e){return e&&Q(e)}function S0(e){return se(e,"row")||se(e,"column")}function GT(e){return se(e,"header")}function bb(e){return se(e,"facet")}function gCe(e){return se(e,"param")}function mCe(e){return!ge(e)&&se(e,"repeat")}function l5(e){const{field:t,timeUnit:n,bin:i,aggregate:r}=e;return{...n?{timeUnit:n}:{},...i?{bin:i}:{},...r?{aggregate:r}:{},field:t}}function HT(e){return se(e,"sort")}function Vu({fieldDef:e,fieldDef2:t,markDef:n,config:i}){if(Le(e)&&e.bandPosition!==void 0)return e.bandPosition;if(ue(e)){const{timeUnit:r,bin:s}=e;if(r&&!t)return Aa("timeUnitBandPosition",n,i);if(Nt(s))return .5}}function oV({channel:e,fieldDef:t,fieldDef2:n,markDef:i,config:r,scaleType:s,useVlSizeChannel:a}){const o=er(e),u=At(a?"size":o,i,r,{vgChannel:o});if(u!==void 0)return u;if(ue(t)){const{timeUnit:l,bin:c}=t;if(l&&!n)return{band:Aa("timeUnitBandSize",i,r)};if(Nt(c)&&!In(s))return{band:1}}if(Ag(i.type))return s?In(s)?r[i.type]?.discreteBandSize||{band:1}:r[i.type]?.continuousBandSize:r[i.type]?.discreteBandSize}function uV(e,t,n,i){return Nt(e.bin)||e.timeUnit&&Fi(e)&&e.type==="temporal"?Vu({fieldDef:e,fieldDef2:t,markDef:n,config:i})!==void 0:!1}function lV(e){return se(e,"sort")&&!se(e,"field")}function A0(e){return se(e,"condition")}function _b(e){const t=e?.condition;return!!t&&!Q(t)&&ue(t)}function C0(e){const t=e?.condition;return!!t&&!Q(t)&&Le(t)}function yCe(e){const t=e?.condition;return!!t&&(Q(t)||Rs(t))}function ue(e){return se(e,"field")||e?.aggregate==="count"}function _h(e){return e?.type}function Ua(e){return se(e,"datum")}function Eu(e){return Fi(e)&&!bv(e)||xv(e)}function c5(e){return Fi(e)&&e.type==="quantitative"&&!e.bin||xv(e)}function xv(e){return Ua(e)&&dt(e.datum)}function Le(e){return ue(e)||Ua(e)}function Fi(e){return e&&(se(e,"field")||e.aggregate==="count")&&se(e,"type")}function Rs(e){return se(e,"value")}function jc(e){return se(e,"scale")||se(e,"sort")}function wh(e){return se(e,"axis")||se(e,"stack")||se(e,"impute")}function cV(e){return se(e,"legend")}function fV(e){return se(e,"format")||se(e,"formatType")}function vCe(e){return Hi(e,["legend","axis","header","scale"])}function xCe(e){return se(e,"op")}function fe(e,t={}){let n=e.field;const i=t.prefix;let r=t.suffix,s="";if(_Ce(e))n=eq("count");else{let a;if(!t.nofn)if(xCe(e))a=e.op;else{const{bin:o,aggregate:u,timeUnit:l}=e;Nt(o)?(a=pq(o),r=(t.binSuffix??"")+(t.suffix??"")):u?ll(u)?(s=`["${n}"]`,n=`argmax_${u.argmax}`):Fo(u)?(s=`["${n}"]`,n=`argmin_${u.argmin}`):a=String(u):l&&!Uc(l)&&(a=_Ae(l),r=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+(t.suffix??""))}a&&(n=n?`${a}_${n}`:a)}return r&&(n=`${n}_${r}`),i&&(n=`${i}_${n}`),t.forAs?Kh(n):t.expr?Jj(n,t.expr)+s:Zr(n)+s}function bv(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return ue(e)&&!!e.bin;case"temporal":return!1}throw new Error(Sq(e.type))}function bCe(e){return jc(e)&&bh(e.scale?.type)}function _Ce(e){return e.aggregate==="count"}function wCe(e,t){const{field:n,bin:i,timeUnit:r,aggregate:s}=e;if(s==="count")return t.countTitle;if(Nt(i))return`${n} (binned)`;if(r&&!Uc(r)){const a=Rn(r)?.unit;if(a)return`${n} (${db(a).join("-")})`}else if(s)return ll(s)?`${n} for max ${s.argmax}`:Fo(s)?`${n} for min ${s.argmin}`:`${y0(s)} of ${n}`;return n}function ECe(e){const{aggregate:t,bin:n,timeUnit:i,field:r}=e;if(ll(t))return`${r} for argmax(${t.argmax})`;if(Fo(t))return`${r} for argmin(${t.argmin})`;const s=i&&!Uc(i)?Rn(i):void 0,a=t||s?.unit||s?.maxbins&&"timeunit"||Nt(n)&&"bin";return a?`${a.toUpperCase()}(${r})`:r}const hV=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return ECe(e);default:return wCe(e,t)}};let dV=hV;function pV(e){dV=e}function SCe(){pV(hV)}function Vf(e,t,{allowDisabling:n,includeDefault:i=!0}){const r=YT(e)?.title;if(!ue(e))return r??e.title;const s=e,a=i?XT(s,t):void 0;return n?on(r,s.title,a):r??s.title??a}function YT(e){if(wh(e)&&e.axis)return e.axis;if(cV(e)&&e.legend)return e.legend;if(GT(e)&&e.header)return e.header}function XT(e,t){return dV(e,t)}function _v(e){if(fV(e)){const{format:t,formatType:n}=e;return{format:t,formatType:n}}else{const t=YT(e)??{},{format:n,formatType:i}=t;return{format:n,formatType:i}}}function ACe(e,t){switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(HT(e)&&Q(e.sort))return"ordinal";const{aggregate:n,bin:i,timeUnit:r}=e;if(r)return"temporal";if(i||n&&!ll(n)&&!Fo(n))return"quantitative";if(jc(e)&&e.scale?.type)switch(TA[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}function Is(e){if(ue(e))return e;if(_b(e))return e.condition}function wn(e){if(Le(e))return e;if(C0(e))return e.condition}function gV(e,t,n,i={}){if(ge(e)||dt(e)||Ku(e)){const r=ge(e)?"string":dt(e)?"number":"boolean";return oe(SSe(t,r,e)),{value:e}}return Le(e)?wv(e,t,n,i):C0(e)?{...e,condition:wv(e.condition,t,n,i)}:e}function wv(e,t,n,i){if(fV(e)){const{format:r,formatType:s,...a}=e;if(wc(s)&&!n.customFormatTypes)return oe(n5(t)),wv(a,t,n,i)}else{const r=wh(e)?"axis":cV(e)?"legend":GT(e)?"header":null;if(r&&e[r]){const{format:s,formatType:a,...o}=e[r];if(wc(a)&&!n.customFormatTypes)return oe(n5(t)),wv({...e,[r]:o},t,n,i)}}return ue(e)?KT(e,t,i):CCe(e)}function CCe(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=dt(n)?"quantitative":ge(n)?"nominal":Bc(n)?"temporal":void 0,{...e,type:t}}function KT(e,t,{compositeMark:n=!1}={}){const{aggregate:i,timeUnit:r,bin:s,field:a}=e,o={...e};if(!n&&i&&!_T(i)&&!ll(i)&&!Fo(i)&&(oe(CSe(i)),delete o.aggregate),r&&(o.timeUnit=Rn(r)),a&&(o.field=`${a}`),Nt(s)&&(o.bin=wb(s,t)),Un(s)&&!un(t)&&oe(rAe(t)),Fi(o)){const{type:u}=o,l=TAe(u);u!==l&&(o.type=l),u!=="quantitative"&&cb(i)&&(oe(ASe(u,i)),o.type="quantitative")}else if(!uq(t)){const u=ACe(o,t);o.type=u}if(Fi(o)){const{compatible:u,warning:l}=kCe(o,t)||{};u===!1&&oe(l)}if(HT(o)&&ge(o.sort)){const{sort:u}=o;if(u5(u))return{...o,sort:{encoding:u}};const l=u.substring(1);if(u.charAt(0)==="-"&&u5(l))return{...o,sort:{encoding:l,order:"descending"}}}if(GT(o)){const{header:u}=o;if(u){const{orient:l,...c}=u;if(l)return{...o,header:{...c,labelOrient:u.labelOrient||l,titleOrient:u.titleOrient||l}}}}return o}function wb(e,t){return Ku(e)?{maxbins:H6(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?{...e,maxbins:H6(t)}:e}const xf={compatible:!0};function kCe(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case Eo:case So:case rb:return bv(e)?xf:{compatible:!1,warning:OSe(t)};case Ut:case Pn:case il:case Jh:case Qi:case Pa:case La:case v0:case x0:case sb:case yc:case ab:case ob:case Dc:case is:case js:case ub:return xf;case Vs:case es:case qs:case Ws:return n!==bc?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:xf;case Vo:case sl:case al:case ol:case qo:case jo:case Uo:case Us:case Da:case rl:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:xf;case Zi:case ul:return!bv(e)&&!bCe(e)?{compatible:!1,warning:FSe(t)}:xf;case vh:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:xf}}function Eh(e){const{formatType:t}=_v(e);return t==="time"||!t&&$Ce(e)}function $Ce(e){return e&&(e.type==="temporal"||ue(e)&&!!e.timeUnit)}function Eb(e,{timeUnit:t,type:n,wrapTime:i,undefinedIfExprNotRequired:r}){const s=t&&Rn(t)?.unit;let a=s||n==="temporal",o;return _0(e)?o=e.expr:Ee(e)?o=e.signal:Bc(e)?(a=!0,o=xc(e)):(ge(e)||dt(e))&&a&&(o=`datetime(${kt(e)})`,mAe(s)&&(dt(e)&&e<1e4||ge(e)&&isNaN(Date.parse(e)))&&(o=xc({[s]:e}))),o?i&&a?`time(${o})`:o:r?void 0:kt(e)}function mV(e,t){const{type:n}=e;return t.map(i=>{const r=ue(e)&&!Uc(e.timeUnit)?e.timeUnit:void 0,s=Eb(i,{timeUnit:r,type:n,undefinedIfExprNotRequired:!0});return s!==void 0?{signal:s}:i})}function k0(e,t){return Nt(e.bin)?Ba(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}const f5={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function $0(e){return e?.condition}const yV=["domain","grid","labels","ticks","title"],TCe={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},vV={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},OCe={...vV,style:1,labelExpr:1,encoding:1};function h5(e){return ve(OCe,e)}const FCe={axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1},xV=re(FCe);function Go(e){return se(e,"mark")}class Sb{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return Go(t)?sCe(t.mark)===this.name:!1}}function ec(e,t){const n=e&&e[t];return n?Q(n)?mh(n,i=>!!i.field):ue(n)||_b(n):!1}function bV(e,t){const n=e&&e[t];return n?Q(n)?mh(n,i=>!!i.field):ue(n)||Ua(n)||C0(n):!1}function _V(e,t){if(un(t)){const n=e[t];if((ue(n)||Ua(n))&&(Uq(n.type)||ue(n)&&n.timeUnit)){const i=mT(t);return bV(e,i)}}return!1}function wV(e){return mh(CEe,t=>{if(ec(e,t)){const n=e[t];if(Q(n))return mh(n,i=>!!i.aggregate);{const i=Is(n);return i&&!!i.aggregate}}return!1})}function EV(e,t){const n=[],i=[],r=[],s=[],a={};return JT(e,(o,u)=>{if(ue(o)){const{field:l,aggregate:c,bin:f,timeUnit:d,...p}=o;if(c||d||f){const y=YT(o)?.title;let v=fe(o,{forAs:!0});const b={...y?[]:{title:Vf(o,t,{allowDisabling:!0})},...p,field:v};if(c){let _;if(ll(c)?(_="argmax",v=fe({op:"argmax",field:c.argmax},{forAs:!0}),b.field=`${v}.${l}`):Fo(c)?(_="argmin",v=fe({op:"argmin",field:c.argmin},{forAs:!0}),b.field=`${v}.${l}`):c!=="boxplot"&&c!=="errorbar"&&c!=="errorband"&&(_=c),_){const E={op:_,as:v};l&&(E.field=l),s.push(E)}}else if(n.push(v),Fi(o)&&Nt(f)){if(i.push({bin:f,field:l,as:v}),n.push(fe(o,{binSuffix:"end"})),k0(o,u)&&n.push(fe(o,{binSuffix:"range"})),un(u)){const _={field:`${v}_end`};a[`${u}2`]=_}b.bin="binned",uq(u)||(b.type=bc)}else if(d&&!Uc(d)){r.push({timeUnit:d,field:l,as:v});const _=Fi(o)&&o.type!==xh&&"time";_&&(u===v0||u===yc?b.formatType=_:PEe(u)?b.legend={formatType:_,...b.legend}:un(u)&&(b.axis={formatType:_,...b.axis}))}a[u]=b}else n.push(l),a[u]=e[u]}else a[u]=e[u]}),{bins:i,timeUnits:r,aggregate:s,groupby:n,encoding:a}}function MCe(e,t,n){const i=zEe(t,n);if(i){if(i==="binned"){const r=e[t===Us?Ut:Pn];return!!(ue(r)&&ue(e[t])&&Un(r.bin))}}else return!1;return!0}function NCe(e,t,n,i){const r={};for(const s of re(e))oq(s)||oe(TSe(s));for(let s of MEe){if(!e[s])continue;const a=e[s];if(b0(s)){const o=FEe(s),u=r[o];if(ue(u)&&$Ae(u.type)&&ue(a)&&!u.timeUnit){oe(ESe(o));continue}}if(s==="angle"&&t==="arc"&&!e.theta&&(oe(wSe),s=is),!MCe(e,s,t)){oe(hb(s,t));continue}if(s===qo&&t==="line"&&Is(e[s])?.aggregate){oe($Se);continue}if(s===Qi&&(n?"fill"in e:"stroke"in e)){oe(Aq("encoding",{fill:"fill"in e,stroke:"stroke"in e}));continue}if(s===x0||s===vh&&!Q(a)&&!Rs(a)||s===yc&&Q(a)){if(a){if(s===vh){const o=e[s];if(lV(o)){r[s]=o;continue}}r[s]=pe(a).reduce((o,u)=>(ue(u)?o.push(KT(u,s)):oe($A(u,s)),o),[])}}else{if(s===yc&&a===null)r[s]=null;else if(!ue(a)&&!Ua(a)&&!Rs(a)&&!A0(a)&&!Ee(a)){oe($A(a,s));continue}r[s]=gV(a,s,i)}}return r}function Ab(e,t){const n={};for(const i of re(e)){const r=gV(e[i],i,t,{compositeMark:!0});n[i]=r}return n}function RCe(e){const t=[];for(const n of re(e))if(ec(e,n)){const i=e[n],r=pe(i);for(const s of r)ue(s)?t.push(s):_b(s)&&t.push(s.condition)}return t}function JT(e,t,n){if(e)for(const i of re(e)){const r=e[i];if(Q(r))for(const s of r)t.call(n,s,i);else t.call(n,r,i)}}function ICe(e,t,n,i){return e?re(e).reduce((r,s)=>{const a=e[s];return Q(a)?a.reduce((o,u)=>t.call(i,o,u,s),r):t.call(i,r,a,s)},n):n}function SV(e,t){return re(t).reduce((n,i)=>{switch(i){case Ut:case Pn:case ab:case ub:case ob:case Us:case Da:case il:case Jh:case is:case jo:case js:case Uo:case rl:case qs:case Vs:case Ws:case es:case v0:case Zi:case Dc:case yc:return n;case vh:if(e==="line"||e==="trail")return n;case x0:case sb:{const r=t[i];if(Q(r)||ue(r))for(const s of pe(r))s.aggregate||n.push(fe(s,{}));return n}case qo:if(e==="trail")return n;case Qi:case Pa:case La:case Vo:case sl:case al:case ul:case ol:{const r=Is(t[i]);return r&&!r.aggregate&&n.push(fe(r,{})),n}}},[])}function DCe(e){const{tooltip:t,...n}=e;if(!t)return{filteredEncoding:n};let i,r;if(Q(t)){for(const s of t)s.aggregate?(i||(i=[]),i.push(s)):(r||(r=[]),r.push(s));i&&(n.tooltip=i)}else t.aggregate?n.tooltip=t:r=t;return Q(r)&&r.length===1&&(r=r[0]),{customTooltipWithoutAggregatedField:r,filteredEncoding:n}}function MA(e,t,n,i=!0){if("tooltip"in n)return{tooltip:n.tooltip};const r=e.map(({fieldPrefix:a,titlePrefix:o})=>{const u=i?` of ${QT(t)}`:"";return{field:a+t.field,type:t.type,title:Ee(o)?{signal:`${o}"${escape(u)}"`}:o+u}}),s=RCe(n).map(vCe);return{tooltip:[...r,...fa(s,nt)]}}function QT(e){const{title:t,field:n}=e;return on(t,n)}function ZT(e,t,n,i,r){const{scale:s,axis:a}=n;return({partName:o,mark:u,positionPrefix:l,endPositionPrefix:c=void 0,extraEncoding:f={}})=>{const d=QT(n);return AV(e,o,r,{mark:u,encoding:{[t]:{field:`${l}_${n.field}`,type:n.type,...d!==void 0?{title:d}:{},...s!==void 0?{scale:s}:{},...a!==void 0?{axis:a}:{}},...ge(c)?{[`${t}2`]:{field:`${c}_${n.field}`}}:{},...i,...f}})}}function AV(e,t,n,i){const{clip:r,color:s,opacity:a}=e,o=e.type;return e[t]||e[t]===void 0&&n[t]?[{...i,mark:{...n[t],...r?{clip:r}:{},...s?{color:s}:{},...a?{opacity:a}:{},...Ca(i.mark)?i.mark:{type:i.mark},style:`${o}-${String(t)}`,...Ku(e[t])?{}:e[t]}}]:[]}function CV(e,t,n){const{encoding:i}=e,r=t==="vertical"?"y":"x",s=i[r],a=i[`${r}2`],o=i[`${r}Error`],u=i[`${r}Error2`];return{continuousAxisChannelDef:u1(s,n),continuousAxisChannelDef2:u1(a,n),continuousAxisChannelDefError:u1(o,n),continuousAxisChannelDefError2:u1(u,n),continuousAxis:r}}function u1(e,t){if(e?.aggregate){const{aggregate:n,...i}=e;return n!==t&&oe(iAe(n,t)),i}else return e}function kV(e,t){const{mark:n,encoding:i}=e,{x:r,y:s}=i;if(Ca(n)&&n.orient)return n.orient;if(Eu(r)){if(Eu(s)){const a=ue(r)&&r.aggregate,o=ue(s)&&s.aggregate;if(!a&&o===t)return"vertical";if(!o&&a===t)return"horizontal";if(a===t&&o===t)throw new Error("Both x and y cannot have aggregate");return Eh(s)&&!Eh(r)?"horizontal":"vertical"}return"horizontal"}else{if(Eu(s))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}}const Ev="boxplot",PCe=["box","median","outliers","rule","ticks"],LCe=new Sb(Ev,TV);function $V(e){return dt(e)?"tukey":e}function TV(e,{config:t}){e={...e,encoding:Ab(e.encoding,t)};const{mark:n,encoding:i,params:r,projection:s,...a}=e,o=Ca(n)?n:{type:n};r&&oe(Eq("boxplot"));const u=o.extent??t.boxplot.extent,l=At("size",o,t),c=o.invalid,f=$V(u),{bins:d,timeUnits:p,transform:m,continuousAxisChannelDef:y,continuousAxis:v,groupby:b,aggregate:_,encodingWithoutContinuousAxis:E,ticksOrient:S,boxOrient:A,customTooltipWithoutAggregatedField:$}=zCe(e,u,t),C=Kh(y.field),{color:M,size:N,...P}=E,D=gl=>ZT(o,v,y,gl,t.boxplot),W=D(P),q=D(E),z=(de(t.boxplot.box)?t.boxplot.box.color:t.mark.color)||"#4c78a8",R=D({...P,...N?{size:N}:{},color:{condition:{test:`${wt(`lower_box_${y.field}`)} >= ${wt(`upper_box_${y.field}`)}`,...M||{value:z}}}}),U=MA([{fieldPrefix:f==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:f==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],y,E),G={type:"tick",color:"black",opacity:1,orient:S,invalid:c,aria:!1},Z=f==="min-max"?U:MA([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],y,E),J=[...W({partName:"rule",mark:{type:"rule",invalid:c,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:Z}),...W({partName:"rule",mark:{type:"rule",invalid:c,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:Z}),...W({partName:"ticks",mark:G,positionPrefix:"lower_whisker",extraEncoding:Z}),...W({partName:"ticks",mark:G,positionPrefix:"upper_whisker",extraEncoding:Z})],he=[...f!=="tukey"?J:[],...q({partName:"box",mark:{type:"bar",...l?{size:l}:{},orient:A,invalid:c,ariaRoleDescription:"box"},positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:U}),...R({partName:"median",mark:{type:"tick",invalid:c,...de(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{},...l?{size:l}:{},orient:S,aria:!1},positionPrefix:"mid_box",extraEncoding:U})];if(f==="min-max")return{...a,transform:(a.transform??[]).concat(m),layer:he};const we=wt(`lower_box_${y.field}`),Ce=wt(`upper_box_${y.field}`),ze=`(${Ce} - ${we})`,bt=`${we} - ${u} * ${ze}`,Ie=`${Ce} + ${u} * ${ze}`,nn=wt(y.field),Va={joinaggregate:OV(y.field),groupby:b},Di={transform:[{filter:`(${bt} <= ${nn}) && (${nn} <= ${Ie})`},{aggregate:[{op:"min",field:y.field,as:`lower_whisker_${C}`},{op:"max",field:y.field,as:`upper_whisker_${C}`},{op:"min",field:`lower_box_${y.field}`,as:`lower_box_${C}`},{op:"max",field:`upper_box_${y.field}`,as:`upper_box_${C}`},..._],groupby:b}],layer:J},{tooltip:ye,...Ue}=P,{scale:je,axis:ae}=y,fn=QT(y),Ge=Hi(ae,["title"]),Ht=AV(o,"outliers",t.boxplot,{transform:[{filter:`(${nn} < ${bt}) || (${nn} > ${Ie})`}],mark:"point",encoding:{[v]:{field:y.field,type:y.type,...fn!==void 0?{title:fn}:{},...je!==void 0?{scale:je}:{},...Ct(Ge)?{}:{axis:Ge}},...Ue,...M?{color:M}:{},...$?{tooltip:$}:{}}})[0];let hn;const dn=[...d,...p,Va];return Ht?hn={transform:dn,layer:[Ht,Di]}:(hn=Di,hn.transform.unshift(...dn)),{...a,layer:[hn,{transform:m,layer:he}]}}function OV(e){const t=Kh(e);return[{op:"q1",field:e,as:`lower_box_${t}`},{op:"q3",field:e,as:`upper_box_${t}`}]}function zCe(e,t,n){const i=kV(e,Ev),{continuousAxisChannelDef:r,continuousAxis:s}=CV(e,i,Ev),a=r.field,o=Kh(a),u=$V(t),l=[...OV(a),{op:"median",field:a,as:`mid_box_${o}`},{op:"min",field:a,as:(u==="min-max"?"lower_whisker_":"min_")+o},{op:"max",field:a,as:(u==="min-max"?"upper_whisker_":"max_")+o}],c=u==="min-max"||u==="tukey"?[]:[{calculate:`${wt(`upper_box_${o}`)} - ${wt(`lower_box_${o}`)}`,as:`iqr_${o}`},{calculate:`min(${wt(`upper_box_${o}`)} + ${wt(`iqr_${o}`)} * ${t}, ${wt(`max_${o}`)})`,as:`upper_whisker_${o}`},{calculate:`max(${wt(`lower_box_${o}`)} - ${wt(`iqr_${o}`)} * ${t}, ${wt(`min_${o}`)})`,as:`lower_whisker_${o}`}],{[s]:f,...d}=e.encoding,{customTooltipWithoutAggregatedField:p,filteredEncoding:m}=DCe(d),{bins:y,timeUnits:v,aggregate:b,groupby:_,encoding:E}=EV(m,n),S=i==="vertical"?"horizontal":"vertical",A=i,$=[...y,...v,{aggregate:[...b,...l],groupby:_},...c];return{bins:y,timeUnits:v,transform:$,groupby:_,aggregate:b,continuousAxisChannelDef:r,continuousAxis:s,encodingWithoutContinuousAxis:E,ticksOrient:S,boxOrient:A,customTooltipWithoutAggregatedField:p}}const eO="errorbar",BCe=["ticks","rule"],UCe=new Sb(eO,FV);function FV(e,{config:t}){e={...e,encoding:Ab(e.encoding,t)};const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:s,ticksOrient:a,markDef:o,outerSpec:u,tooltipEncoding:l}=MV(e,eO,t);delete s.size;const c=ZT(o,r,i,s,t.errorbar),f=o.thickness,d=o.size,p={type:"tick",orient:a,aria:!1,...f!==void 0?{thickness:f}:{},...d!==void 0?{size:d}:{}},m=[...c({partName:"ticks",mark:p,positionPrefix:"lower",extraEncoding:l}),...c({partName:"ticks",mark:p,positionPrefix:"upper",extraEncoding:l}),...c({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar",...f!==void 0?{size:f}:{}},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return{...u,transform:n,...m.length>1?{layer:m}:{...m[0]}}}function jCe(e,t){const{encoding:n}=e;if(qCe(n))return{orient:kV(e,t),inputType:"raw"};const i=VCe(n),r=WCe(n),s=n.x,a=n.y;if(i){if(r)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const o=n.x2,u=n.y2;if(Le(o)&&Le(u))throw new Error(`${t} cannot have both x2 and y2`);if(Le(o)){if(Eu(s))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(Le(u)){if(Eu(a))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const o=n.xError,u=n.xError2,l=n.yError,c=n.yError2;if(Le(u)&&!Le(o))throw new Error(`${t} cannot have xError2 without xError`);if(Le(c)&&!Le(l))throw new Error(`${t} cannot have yError2 without yError`);if(Le(o)&&Le(l))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(Le(o)){if(Eu(s))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(Le(l)){if(Eu(a))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function qCe(e){return(Le(e.x)||Le(e.y))&&!Le(e.x2)&&!Le(e.y2)&&!Le(e.xError)&&!Le(e.xError2)&&!Le(e.yError)&&!Le(e.yError2)}function VCe(e){return Le(e.x2)||Le(e.y2)}function WCe(e){return Le(e.xError)||Le(e.xError2)||Le(e.yError)||Le(e.yError2)}function MV(e,t,n){const{mark:i,encoding:r,params:s,projection:a,...o}=e,u=Ca(i)?i:{type:i};s&&oe(Eq(t));const{orient:l,inputType:c}=jCe(e,t),{continuousAxisChannelDef:f,continuousAxisChannelDef2:d,continuousAxisChannelDefError:p,continuousAxisChannelDefError2:m,continuousAxis:y}=CV(e,l,t),{errorBarSpecificAggregate:v,postAggregateCalculates:b,tooltipSummary:_,tooltipTitleWithFieldName:E}=GCe(u,f,d,p,m,c,t,n),{[y]:S,[y==="x"?"x2":"y2"]:A,[y==="x"?"xError":"yError"]:$,[y==="x"?"xError2":"yError2"]:C,...M}=r,{bins:N,timeUnits:P,aggregate:D,groupby:W,encoding:q}=EV(M,n),z=[...D,...v],R=c!=="raw"?[]:W,U=MA(_,f,q,E);return{transform:[...o.transform??[],...N,...P,...z.length===0?[]:[{aggregate:z,groupby:R}],...b],groupby:R,continuousAxisChannelDef:f,continuousAxis:y,encodingWithoutContinuousAxis:q,ticksOrient:l==="vertical"?"horizontal":"vertical",markDef:u,outerSpec:o,tooltipEncoding:U}}function GCe(e,t,n,i,r,s,a,o){let u=[],l=[];const c=t.field;let f,d=!1;if(s==="raw"){const p=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":o.errorbar.center,m=e.extent?e.extent:p==="mean"?"stderr":"iqr";if(p==="median"!=(m==="iqr")&&oe(nAe(p,m,a)),m==="stderr"||m==="stdev")u=[{op:m,field:c,as:`extent_${c}`},{op:p,field:c,as:`center_${c}`}],l=[{calculate:`${wt(`center_${c}`)} + ${wt(`extent_${c}`)}`,as:`upper_${c}`},{calculate:`${wt(`center_${c}`)} - ${wt(`extent_${c}`)}`,as:`lower_${c}`}],f=[{fieldPrefix:"center_",titlePrefix:y0(p)},{fieldPrefix:"upper_",titlePrefix:d5(p,m,"+")},{fieldPrefix:"lower_",titlePrefix:d5(p,m,"-")}],d=!0;else{let y,v,b;m==="ci"?(y="mean",v="ci0",b="ci1"):(y="median",v="q1",b="q3"),u=[{op:v,field:c,as:`lower_${c}`},{op:b,field:c,as:`upper_${c}`},{op:y,field:c,as:`center_${c}`}],f=[{fieldPrefix:"upper_",titlePrefix:Vf({field:c,aggregate:b,type:"quantitative"},o,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:Vf({field:c,aggregate:v,type:"quantitative"},o,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:Vf({field:c,aggregate:y,type:"quantitative"},o,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&oe(tAe(e.center,e.extent)),s==="aggregated-upper-lower"?(f=[],l=[{calculate:wt(n.field),as:`upper_${c}`},{calculate:wt(c),as:`lower_${c}`}]):s==="aggregated-error"&&(f=[{fieldPrefix:"",titlePrefix:c}],l=[{calculate:`${wt(c)} + ${wt(i.field)}`,as:`upper_${c}`}],r?l.push({calculate:`${wt(c)} + ${wt(r.field)}`,as:`lower_${c}`}):l.push({calculate:`${wt(c)} - ${wt(i.field)}`,as:`lower_${c}`}));for(const p of l)f.push({fieldPrefix:p.as.substring(0,6),titlePrefix:mc(mc(p.calculate,"datum['",""),"']","")})}return{postAggregateCalculates:l,errorBarSpecificAggregate:u,tooltipSummary:f,tooltipTitleWithFieldName:d}}function d5(e,t,n){return`${y0(e)} ${n} ${t}`}const tO="errorband",HCe=["band","borders"],YCe=new Sb(tO,NV);function NV(e,{config:t}){e={...e,encoding:Ab(e.encoding,t)};const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:s,markDef:a,outerSpec:o,tooltipEncoding:u}=MV(e,tO,t),l=a,c=ZT(l,r,i,s,t.errorband),f=e.encoding.x!==void 0&&e.encoding.y!==void 0;let d={type:f?"area":"rect"},p={type:f?"line":"rule"};const m={...l.interpolate?{interpolate:l.interpolate}:{},...l.tension&&l.interpolate?{tension:l.tension}:{}};return f?(d={...d,...m,ariaRoleDescription:"errorband"},p={...p,...m,aria:!1}):l.interpolate?oe(r5("interpolate")):l.tension&&oe(r5("tension")),{...o,transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...c({partName:"borders",mark:p,positionPrefix:"lower",extraEncoding:u}),...c({partName:"borders",mark:p,positionPrefix:"upper",extraEncoding:u})]}}const RV={};function nO(e,t,n){const i=new Sb(e,t);RV[e]={normalizer:i,parts:n}}function XCe(){return re(RV)}nO(Ev,TV,PCe);nO(eO,FV,BCe);nO(tO,NV,HCe);const KCe=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],IV={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},DV={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},JCe=re(IV),QCe=re(DV),ZCe={header:1,headerRow:1,headerColumn:1,headerFacet:1},PV=re(ZCe),LV=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],eke={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},tke={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},Ds="_vgsid_",nke={point:{on:"click",fields:[Ds],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[pointerdown, window:pointerup] > window:pointermove!",encodings:["x","y"],translate:"[pointerdown, window:pointerup] > window:pointermove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function iO(e){return e==="legend"||!!e?.legend}function Hw(e){return iO(e)&&de(e)}function rO(e){return!!e?.select}function zV(e){const t=[];for(const n of e||[]){if(rO(n))continue;const{expr:i,bind:r,...s}=n;if(r&&i){const a={...s,bind:r,init:i};t.push(a)}else{const a={...s,...i?{update:i}:{},...r?{bind:r}:{}};t.push(a)}}return t}function ike(e){return Cb(e)||aO(e)||sO(e)}function sO(e){return se(e,"concat")}function Cb(e){return se(e,"vconcat")}function aO(e){return se(e,"hconcat")}function BV({step:e,offsetIsDiscrete:t}){return t?e.for??"offset":"position"}function ka(e){return se(e,"step")}function p5(e){return se(e,"view")||se(e,"width")||se(e,"height")}const g5=20,rke={align:1,bounds:1,center:1,columns:1,spacing:1},ske=re(rke);function ake(e,t,n){const i=n[t],r={},{spacing:s,columns:a}=i;s!==void 0&&(r.spacing=s),a!==void 0&&(bb(e)&&!S0(e.facet)||sO(e))&&(r.columns=a),Cb(e)&&(r.columns=1);for(const o of ske)if(e[o]!==void 0)if(o==="spacing"){const u=e[o];r[o]=dt(u)?u:{row:u.row??s,column:u.column??s}}else r[o]=e[o];return r}function NA(e,t){return e[t]??e[t==="width"?"continuousWidth":"continuousHeight"]}function RA(e,t){const n=Sv(e,t);return ka(n)?n.step:UV}function Sv(e,t){const n=e[t]??e[t==="width"?"discreteWidth":"discreteHeight"];return on(n,{step:e.step})}const UV=20,oke={continuousWidth:200,continuousHeight:200,step:UV},uke={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:oke,mark:ZAe,arc:{},area:{},bar:iCe,circle:{},geoshape:{},image:{},line:{},point:{},rect:UT,rule:{color:"black"},square:{},text:{color:"black"},tick:rCe,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:RAe,projection:{},legend:eke,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:nke,style:{},title:{},facet:{spacing:g5},concat:{spacing:g5},normalizedNumberFormat:".0%"},io=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],m5={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},y5={blue:io[0],orange:io[1],red:io[2],teal:io[3],green:io[4],yellow:io[5],purple:io[6],pink:io[7],brown:io[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function lke(e={}){return{signals:[{name:"color",value:de(e)?{...y5,...e}:y5}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function cke(e){return{signals:[{name:"fontSize",value:de(e)?{...m5,...e}:m5}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function fke(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function jV(e){const t=re(e||{}),n={};for(const i of t){const r=e[i];n[i]=$0(r)?mq(r):hr(r)}return n}function hke(e){const t=re(e),n={};for(const i of t)n[i]=jV(e[i]);return n}const dke=[...Jq,...xV,...PV,"background","padding","legend","lineBreak","scale","style","title","view"];function qV(e={}){const{color:t,font:n,fontSize:i,selection:r,...s}=e,a=Nh({},De(uke),n?fke(n):{},t?lke(t):{},i?cke(i):{},s||{});r&&Rh(a,"selection",r,!0);const o=Hi(a,dke);for(const u of["background","lineBreak","padding"])a[u]&&(o[u]=hr(a[u]));for(const u of Jq)a[u]&&(o[u]=jn(a[u]));for(const u of xV)a[u]&&(o[u]=jV(a[u]));for(const u of PV)a[u]&&(o[u]=jn(a[u]));if(a.legend&&(o.legend=jn(a.legend)),a.scale){const{invalid:u,...l}=a.scale,c=jn(u,{level:1});o.scale={...jn(l),...re(c).length>0?{invalid:c}:{}}}return a.style&&(o.style=hke(a.style)),a.title&&(o.title=jn(a.title)),a.view&&(o.view=jn(a.view)),o}const pke=new Set(["view",...HAe]),gke=["color","fontSize","background","padding","facet","concat","numberFormat","numberFormatType","normalizedNumberFormat","normalizedNumberFormatType","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],mke={view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"],...QAe};function yke(e){e=De(e);for(const t of gke)delete e[t];if(e.axis)for(const t in e.axis)$0(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of KCe)delete e.legend[t];if(e.mark){for(const t of a5)delete e.mark[t];e.mark.tooltip&&de(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(zV(e.params)),delete e.params);for(const t of pke){for(const i of a5)delete e[t][i];const n=mke[t];if(n)for(const i of n)delete e[t][i];xke(e,t)}for(const t of XCe())delete e[t];vke(e);for(const t in e)de(e[t])&&Ct(e[t])&&delete e[t];return Ct(e)?void 0:e}function vke(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:i}=gq(e.title);Ct(t)||(e.style["group-title"]={...e.style["group-title"],...t}),Ct(n)||(e.style["group-subtitle"]={...e.style["group-subtitle"],...n}),Ct(i)?delete e.title:e.title=i}function xke(e,t,n,i){const r=e[t];t==="view"&&(n="cell");const s={...r,...e.style[n??t]};Ct(s)||(e.style[n??t]=s),delete e[t]}function kb(e){return se(e,"layer")}function bke(e){return se(e,"repeat")}function _ke(e){return!Q(e.repeat)&&se(e.repeat,"layer")}class oO{map(t,n){return bb(t)?this.mapFacet(t,n):bke(t)?this.mapRepeat(t,n):aO(t)?this.mapHConcat(t,n):Cb(t)?this.mapVConcat(t,n):sO(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(kb(t))return this.mapLayer(t,n);if(Go(t))return this.mapUnit(t,n);throw new Error(wT(t))}mapLayer(t,n){return{...t,layer:t.layer.map(i=>this.mapLayerOrUnit(i,n))}}mapHConcat(t,n){return{...t,hconcat:t.hconcat.map(i=>this.map(i,n))}}mapVConcat(t,n){return{...t,vconcat:t.vconcat.map(i=>this.map(i,n))}}mapConcat(t,n){const{concat:i,...r}=t;return{...r,concat:i.map(s=>this.map(s,n))}}mapFacet(t,n){return{...t,spec:this.map(t.spec,n)}}mapRepeat(t,n){return{...t,spec:this.map(t.spec,n)}}}const wke={zero:1,center:1,normalize:1};function Eke(e){return ve(wke,e)}const Ske=new Set([Yq,mb,gb,yv,vb,zT,BT,yb,Xq,LT]),Ake=new Set([mb,gb,Yq]);function bf(e){return ue(e)&&_h(e)==="quantitative"&&!e.bin}function v5(e,t,{orient:n,type:i}){const r=t==="x"?"y":"radius",s=t==="x"&&["bar","area"].includes(i),a=e[t],o=e[r];if(ue(a)&&ue(o))if(bf(a)&&bf(o)){if(a.stack)return t;if(o.stack)return r;const u=ue(a)&&!!a.aggregate,l=ue(o)&&!!o.aggregate;if(u!==l)return u?t:r;if(s){if(n==="vertical")return r;if(n==="horizontal")return t}}else{if(bf(a))return t;if(bf(o))return r}else{if(bf(a))return s&&n==="vertical"?void 0:t;if(bf(o))return s&&n==="horizontal"?void 0:r}}function Cke(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function VV(e,t){const n=Ca(e)?e:{type:e},i=n.type;if(!Ske.has(i))return null;const r=v5(t,"x",n)||v5(t,"theta",n);if(!r)return null;const s=t[r],a=ue(s)?fe(s,{}):void 0,o=Cke(r),u=[],l=new Set;if(t[o]){const y=t[o],v=ue(y)?fe(y,{}):void 0;v&&v!==a&&(u.push(o),l.add(v))}const c=o==="x"?"xOffset":"yOffset",f=t[c],d=ue(f)?fe(f,{}):void 0;d&&d!==a&&(u.push(c),l.add(d));const p=NEe.reduce((y,v)=>{if(v!=="tooltip"&&ec(t,v)){const b=t[v];for(const _ of pe(b)){const E=Is(_);if(E.aggregate)continue;const S=fe(E,{});(!S||!l.has(S))&&y.push({channel:v,fieldDef:E})}}return y},[]);let m;return s.stack!==void 0?Ku(s.stack)?m=s.stack?"zero":null:m=s.stack:Ake.has(i)&&(m="zero"),!m||!Eke(m)||wV(t)&&p.length===0?null:(s?.scale?.type&&s?.scale?.type!==qn.LINEAR&&s?.stack&&oe(QSe(s.scale.type)),Le(t[za(r)])?(s.stack!==void 0&&oe(JSe(r)),null):(ue(s)&&s.aggregate&&!GEe.has(s.aggregate)&&oe(ZSe(s.aggregate)),{groupbyChannels:u,groupbyFields:l,fieldChannel:r,impute:s.impute===null?!1:cl(i),stackBy:p,offset:m}))}function WV(e,t,n){const i=jn(e),r=At("orient",i,n);if(i.orient=Oke(i.type,t,r),r!==void 0&&r!==i.orient&&oe(ISe(i.orient,r)),i.type==="bar"&&i.orient){const u=At("cornerRadiusEnd",i,n);if(u!==void 0){const l=i.orient==="horizontal"&&t.x2||i.orient==="vertical"&&t.y2?["cornerRadius"]:tCe[i.orient];for(const c of l)i[c]=u;i.cornerRadiusEnd!==void 0&&delete i.cornerRadiusEnd}}const s=At("opacity",i,n),a=At("fillOpacity",i,n);return s===void 0&&a===void 0&&(i.opacity=$ke(i.type,t)),At("cursor",i,n)===void 0&&(i.cursor=kke(i,t,n)),i}function kke(e,t,n){return t.href||e.href||At("href",e,n)?"pointer":e.cursor}function $ke(e,t){if(Ze([vb,LT,zT,BT],e)&&!wV(t))return .7}function Tke(e,t,{graticule:n}){if(n)return!1;const i=Aa("filled",e,t),r=e.type;return on(i,r!==vb&&r!==yb&&r!==yv)}function Oke(e,t,n){switch(e){case vb:case zT:case BT:case Xq:case WAe:case VAe:return}const{x:i,y:r,x2:s,y2:a}=t;switch(e){case mb:if(ue(i)&&(Un(i.bin)||ue(r)&&r.aggregate&&!i.aggregate))return"vertical";if(ue(r)&&(Un(r.bin)||ue(i)&&i.aggregate&&!r.aggregate))return"horizontal";if(a||s){if(n)return n;if(!s)return(ue(i)&&i.type===bc&&!Nt(i.bin)||xv(i))&&ue(r)&&Un(r.bin)?"horizontal":"vertical";if(!a)return(ue(r)&&r.type===bc&&!Nt(r.bin)||xv(r))&&ue(i)&&Un(i.bin)?"vertical":"horizontal"}case yv:if(s&&!(ue(i)&&Un(i.bin))&&a&&!(ue(r)&&Un(r.bin)))return;case gb:if(a)return ue(r)&&Un(r.bin)?"horizontal":"vertical";if(s)return ue(i)&&Un(i.bin)?"vertical":"horizontal";if(e===yv){if(i&&!r)return"vertical";if(r&&!i)return"horizontal"}case yb:case LT:{const o=c5(i),u=c5(r);if(n)return n;if(o&&!u)return e!=="tick"?"horizontal":"vertical";if(!o&&u)return e!=="tick"?"vertical":"horizontal";if(o&&u)return"vertical";{const l=Fi(i)&&i.type===xh,c=Fi(r)&&r.type===xh;if(l&&!c)return"vertical";if(!l&&c)return"horizontal"}return}}return"vertical"}function Fke(e){const{point:t,line:n,...i}=e;return re(i).length>1?i:i.type}function Mke(e){for(const t of["line","area","rule","trail"])e[t]&&(e={...e,[t]:Hi(e[t],["point","line"])});return e}function Yw(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?de(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?de(t.point)?t.point:{}:void 0}function x5(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class Nke{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(Go(t)){const{mark:i,encoding:r}=t,s=Ca(i)?i:{type:i};switch(s.type){case"line":case"rule":case"trail":return!!Yw(s,n[s.type],r);case"area":return!!Yw(s,n[s.type],r)||!!x5(s,n[s.type])}}return!1}run(t,n,i){const{config:r}=n,{params:s,projection:a,mark:o,name:u,encoding:l,...c}=t,f=Ab(l,r),d=Ca(o)?o:{type:o},p=Yw(d,r[d.type],f),m=d.type==="area"&&x5(d,r[d.type]),y=[{name:u,...s?{params:s}:{},mark:Fke({...d.type==="area"&&d.opacity===void 0&&d.fillOpacity===void 0?{opacity:.7}:{},...d}),encoding:Hi(f,["shape"])}],v=VV(WV(d,f,r),f);let b=f;if(v){const{fieldChannel:_,offset:E}=v;b={...f,[_]:{...f[_],...E?{stack:E}:{}}}}return b=Hi(b,["y2","x2"]),m&&y.push({...a?{projection:a}:{},mark:{type:"line",...gh(d,["clip","interpolate","tension","tooltip"]),...m},encoding:b}),p&&y.push({...a?{projection:a}:{},mark:{type:"point",opacity:1,filled:!0,...gh(d,["clip","tooltip"]),...p},encoding:b}),i({...c,layer:y},{...n,config:Mke(r)})}}function Rke(e,t){return t?S0(e)?HV(e,t):GV(e,t):e}function Xw(e,t){return t?HV(e,t):e}function IA(e,t,n){const i=t[e];if(mCe(i)){if(i.repeat in n)return{...t,[e]:n[i.repeat]};oe(hSe(i.repeat));return}return t}function GV(e,t){if(e=IA("field",e,t),e!==void 0){if(e===null)return null;if(HT(e)&&Ao(e.sort)){const n=IA("field",e.sort,t);e={...e,...n?{sort:n}:{}}}return e}}function b5(e,t){if(ue(e))return GV(e,t);{const n=IA("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function _5(e,t){if(Le(e)){const n=b5(e,t);if(n)return n;if(A0(e))return{condition:e.condition}}else{if(C0(e)){const n=b5(e.condition,t);if(n)return{...e,condition:n};{const{condition:i,...r}=e;return r}}return e}}function HV(e,t){const n={};for(const i in e)if(se(e,i)){const r=e[i];if(Q(r))n[i]=r.map(s=>_5(s,t)).filter(s=>s);else{const s=_5(r,t);s!==void 0&&(n[i]=s)}}return n}class Ike{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(Go(t)){const{encoding:n,mark:i}=t;if(i==="line"||Ca(i)&&i.type==="line")for(const r of OEe){const s=Pc(r),a=n[s];if(n[r]&&(ue(a)&&!Un(a.bin)||Ua(a)))return!0}}return!1}run(t,n,i){const{encoding:r,mark:s}=t;return oe(RSe(!!r.x2,!!r.y2)),i({...t,mark:de(s)?{...s,type:"rule"}:"rule"},n)}}class Dke extends oO{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[LCe,UCe,YCe,new Nke,new Ike]}map(t,n){if(Go(t)){const i=ec(t.encoding,Eo),r=ec(t.encoding,So),s=ec(t.encoding,rb);if(i||r||s)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:i,parentProjection:r}=n,s=Xw(t.encoding,n.repeater),a={...t,...t.name?{name:[n.repeaterPrefix,t.name].filter(u=>u).join("_")}:{},...s?{encoding:s}:{}};if(i||r)return this.mapUnitWithParentEncodingOrProjection(a,n);const o=this.mapLayerOrUnit.bind(this);for(const u of this.nonFacetUnitNormalizers)if(u.hasMatchingType(a,n.config))return u.run(a,n,o);return a}mapRepeat(t,n){return _ke(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:i,spec:r,...s}=t,{row:a,column:o,layer:u}=i,{repeater:l={},repeaterPrefix:c=""}=n;return a||o?this.mapRepeat({...t,repeat:{...a?{row:a}:{},...o?{column:o}:{}},spec:{repeat:{layer:u},spec:r}},n):{...s,layer:u.map(f=>{const d={...l,layer:f},p=`${(r.name?`${r.name}_`:"")+c}child__layer_${Bt(f)}`,m=this.mapLayerOrUnit(r,{...n,repeater:d,repeaterPrefix:p});return m.name=p,m})}}mapNonLayerRepeat(t,n){const{repeat:i,spec:r,data:s,...a}=t;!Q(i)&&t.columns&&(t=Hi(t,["columns"]),oe(e5("repeat")));const o=[],{repeater:u={},repeaterPrefix:l=""}=n,c=!Q(i)&&i.row||[u?u.row:null],f=!Q(i)&&i.column||[u?u.column:null],d=Q(i)&&i||[u?u.repeat:null];for(const m of d)for(const y of c)for(const v of f){const b={repeat:m,row:y,column:v,layer:u.layer},_=(r.name?`${r.name}_`:"")+l+"child__"+(Q(i)?`${Bt(m)}`:(i.row?`row_${Bt(y)}`:"")+(i.column?`column_${Bt(v)}`:"")),E=this.map(r,{...n,repeater:b,repeaterPrefix:_});E.name=_,o.push(Hi(E,["data"]))}const p=Q(i)?t.columns:i.column?i.column.length:1;return{data:r.data??s,align:"all",...a,columns:p,concat:o}}mapFacet(t,n){const{facet:i}=t;return S0(i)&&t.columns&&(t=Hi(t,["columns"]),oe(e5("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:i,projection:r}=t,{parentEncoding:s,parentProjection:a,config:o}=n,u=E5({parentProjection:a,projection:r}),l=w5({parentEncoding:s,encoding:Xw(i,n.repeater)});return this.mapUnit({...t,...u?{projection:u}:{},...l?{encoding:l}:{}},{config:o})}mapFacetedUnit(t,n){const{row:i,column:r,facet:s,...a}=t.encoding,{mark:o,width:u,projection:l,height:c,view:f,params:d,encoding:p,...m}=t,{facetMapping:y,layout:v}=this.getFacetMappingAndLayout({row:i,column:r,facet:s},n),b=Xw(a,n.repeater);return this.mapFacet({...m,...v,facet:y,spec:{...u?{width:u}:{},...c?{height:c}:{},...f?{view:f}:{},...l?{projection:l}:{},mark:o,encoding:b,...d?{params:d}:{}}},n)}getFacetMappingAndLayout(t,n){const{row:i,column:r,facet:s}=t;if(i||r){s&&oe(MSe([...i?[Eo]:[],...r?[So]:[]]));const a={},o={};for(const u of[Eo,So]){const l=t[u];if(l){const{align:c,center:f,spacing:d,columns:p,...m}=l;a[u]=m;for(const y of["align","center","spacing"])l[y]!==void 0&&(o[y]??(o[y]={}),o[y][u]=l[y])}}return{facetMapping:a,layout:o}}else{const{align:a,center:o,spacing:u,columns:l,...c}=s;return{facetMapping:Rke(c,n.repeater),layout:{...a?{align:a}:{},...o?{center:o}:{},...u?{spacing:u}:{},...l?{columns:l}:{}}}}}mapLayer(t,{parentEncoding:n,parentProjection:i,...r}){const{encoding:s,projection:a,...o}=t,u={...r,parentEncoding:w5({parentEncoding:n,encoding:s,layer:!0}),parentProjection:E5({parentProjection:i,projection:a})};return super.mapLayer({...o,...t.name?{name:[u.repeaterPrefix,t.name].filter(l=>l).join("_")}:{}},u)}}function w5({parentEncoding:e,encoding:t={},layer:n}){let i={};if(e){const r=new Set([...re(e),...re(t)]);for(const s of r){const a=t[s],o=e[s];if(Le(a)){const u={...o,...a};i[s]=u}else C0(a)?i[s]={...a,condition:{...o,...a.condition}}:a||a===null?i[s]=a:(n||Rs(o)||Ee(o)||Le(o)||Q(o))&&(i[s]=o)}}else i=t;return!i||Ct(i)?void 0:i}function E5(e){const{parentProjection:t,projection:n}=e;return t&&n&&oe(_Se({parentProjection:t,projection:n})),n??t}function uO(e){return se(e,"filter")}function Pke(e){return se(e,"stop")}function YV(e){return se(e,"lookup")}function Lke(e){return se(e,"data")}function zke(e){return se(e,"param")}function Bke(e){return se(e,"pivot")}function Uke(e){return se(e,"density")}function jke(e){return se(e,"quantile")}function qke(e){return se(e,"regression")}function Vke(e){return se(e,"loess")}function Wke(e){return se(e,"sample")}function Gke(e){return se(e,"window")}function Hke(e){return se(e,"joinaggregate")}function Yke(e){return se(e,"flatten")}function Xke(e){return se(e,"calculate")}function XV(e){return se(e,"bin")}function Kke(e){return se(e,"impute")}function Jke(e){return se(e,"timeUnit")}function Qke(e){return se(e,"aggregate")}function Zke(e){return se(e,"stack")}function e$e(e){return se(e,"fold")}function t$e(e){return se(e,"extent")&&!se(e,"density")&&!se(e,"regression")}function n$e(e){return e.map(t=>uO(t)?{filter:jf(t.filter,kAe)}:t)}class i$e extends oO{map(t,n){return n.emptySelections??(n.emptySelections={}),n.selectionPredicates??(n.selectionPredicates={}),t=S5(t,n),super.map(t,n)}mapLayerOrUnit(t,n){if(t=S5(t,n),t.encoding){const i={};for(const[r,s]of ju(t.encoding))i[r]=KV(s,n);t={...t,encoding:i}}return super.mapLayerOrUnit(t,n)}mapUnit(t,n){const{selection:i,...r}=t;return i?{...r,params:ju(i).map(([s,a])=>{const{init:o,bind:u,empty:l,...c}=a;c.type==="single"?(c.type="point",c.toggle=!1):c.type==="multi"&&(c.type="point"),n.emptySelections[s]=l!=="none";for(const f of Yn(n.selectionPredicates[s]??{}))f.empty=l!=="none";return{name:s,value:o,select:c,bind:u}})}:t}}function S5(e,t){const{transform:n,...i}=e;if(n){const r=n.map(s=>{if(uO(s))return{filter:DA(s,t)};if(XV(s)&&Lc(s.bin))return{...s,bin:JV(s.bin)};if(YV(s)){const{selection:a,...o}=s.from;return a?{...s,from:{param:a,...o}}:s}return s});return{...i,transform:r}}return e}function KV(e,t){const n=De(e);if(ue(n)&&Lc(n.bin)&&(n.bin=JV(n.bin)),jc(n)&&n.scale?.domain?.selection){const{selection:i,...r}=n.scale.domain;n.scale.domain={...r,...i?{param:i}:{}}}if(A0(n))if(Q(n.condition))n.condition=n.condition.map(i=>{const{selection:r,param:s,test:a,...o}=i;return s?i:{...o,test:DA(i,t)}});else{const{selection:i,param:r,test:s,...a}=KV(n.condition,t);n.condition=r?n.condition:{...a,test:DA(n.condition,t)}}return n}function JV(e){const t=e.extent;if(t?.selection){const{selection:n,...i}=t;return{...e,extent:{...i,param:n}}}return e}function DA(e,t){const n=i=>jf(i,r=>{var s;const a=t.emptySelections[r]??!0,o={param:r,empty:a};return(s=t.selectionPredicates)[r]??(s[r]=[]),t.selectionPredicates[r].push(o),o});return e.selection?n(e.selection):jf(e.test||e.filter,i=>i.selection?n(i.selection):i)}class PA extends oO{map(t,n){const i=n.selections??[];if(t.params&&!Go(t)){const r=[];for(const s of t.params)rO(s)?i.push(s):r.push(s);t.params=r}return n.selections=i,super.map(t,n)}mapUnit(t,n){const i=n.selections;if(!i||!i.length)return t;const r=(n.path??[]).concat(t.name),s=[];for(const a of i)if(!a.views||!a.views.length)s.push(a);else for(const o of a.views)(ge(o)&&(o===t.name||r.includes(o))||Q(o)&&o.map(u=>r.indexOf(u)).every((u,l,c)=>u!==-1&&(l===0||u>c[l-1])))&&s.push(a);return s.length&&(t.params=s),t}}for(const e of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=PA.prototype[e];PA.prototype[e]=function(n,i){return t.call(this,n,r$e(n,i))}}function r$e(e,t){return e.name?{...t,path:(t.path??[]).concat(e.name)}:t}function QV(e,t){t===void 0&&(t=qV(e.config));const n=u$e(e,t),{width:i,height:r}=e,s=l$e(n,{width:i,height:r,autosize:e.autosize},t);return{...n,...s?{autosize:s}:{}}}const s$e=new Dke,a$e=new i$e,o$e=new PA;function u$e(e,t={}){const n={config:t};return o$e.map(s$e.map(a$e.map(e,n),n),n)}function A5(e){return ge(e)?{type:e}:e??{}}function l$e(e,t,n){let{width:i,height:r}=t;const s=Go(e)||kb(e),a={};s?i=="container"&&r=="container"?(a.type="fit",a.contains="padding"):i=="container"?(a.type="fit-x",a.contains="padding"):r=="container"&&(a.type="fit-y",a.contains="padding"):(i=="container"&&(oe(K6("width")),i=void 0),r=="container"&&(oe(K6("height")),r=void 0));const o={type:"pad",...a,...n?A5(n.autosize):{},...A5(e.autosize)};if(o.type==="fit"&&!s&&(oe(tSe),o.type="pad"),i=="container"&&!(o.type=="fit"||o.type=="fit-x")&&oe(J6("width")),r=="container"&&!(o.type=="fit"||o.type=="fit-y")&&oe(J6("height")),!gr(o,{type:"pad"}))return o}function c$e(e){return["fit","fit-x","fit-y"].includes(e)}function f$e(e){return e?`fit-${lb(e)}`:"fit"}const h$e=["background","padding"];function C5(e,t){const n={};for(const i of h$e)e&&e[i]!==void 0&&(n[i]=hr(e[i]));return t&&(n.params=e.params),n}class Ho{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new Ho(De(this.explicit),De(this.implicit))}combine(){return{...this.explicit,...this.implicit}}get(t){return on(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,{value:n,explicit:i}){n!==void 0&&this.set(t,n,i)}set(t,n,i){return delete this[i?"implicit":"explicit"][t],this[i?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,{explicit:n,implicit:i}){n[t]!==void 0?this.set(t,n[t],!0):i[t]!==void 0&&this.set(t,i[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of re(t.combine())){const i=t.getWithExplicit(n);this.setWithExplicit(n,i)}}}function sa(e){return{explicit:!0,value:e}}function lr(e){return{explicit:!1,value:e}}function ZV(e){return(t,n,i,r)=>{const s=e(t.value,n.value);return s>0?t:s<0?n:$b(t,n,i,r)}}function $b(e,t,n,i){return e.explicit&&t.explicit&&oe(VSe(n,i,e.value,t.value)),e}function Wu(e,t,n,i,r=$b){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:gr(e.value,t.value)?e:r(e,t,n,i)}class d$e extends Ho{constructor(t={},n={},i=!1){super(t,n),this.explicit=t,this.implicit=n,this.parseNothing=i}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function Sh(e){return se(e,"url")}function Cg(e){return se(e,"values")}function eW(e){return se(e,"name")&&!Sh(e)&&!Cg(e)&&!Ou(e)}function Ou(e){return e&&(tW(e)||nW(e)||lO(e))}function tW(e){return se(e,"sequence")}function nW(e){return se(e,"sphere")}function lO(e){return se(e,"graticule")}var Wt;(function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup",e[e.PreFilterInvalid=5]="PreFilterInvalid",e[e.PostFilterInvalid=6]="PostFilterInvalid"})(Wt||(Wt={}));function iW({invalid:e,isPath:t}){switch(Qq(e,{isPath:t})){case"filter":return{marks:"exclude-invalid-values",scales:"exclude-invalid-values"};case"break-paths-show-domains":return{marks:t?"include-invalid-values":"exclude-invalid-values",scales:"include-invalid-values"};case"break-paths-filter-domains":return{marks:t?"include-invalid-values":"exclude-invalid-values",scales:"exclude-invalid-values"};case"show":return{marks:"include-invalid-values",scales:"include-invalid-values"}}}function p$e(e){const{marks:t,scales:n}=iW(e);return t===n?Wt.Main:n==="include-invalid-values"?Wt.PreFilterInvalid:Wt.PostFilterInvalid}class St{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.includes(t)){oe(vSe);return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const r of this._children)r.parent=t;this._children=[],t.removeChild(this);const i=t.parent.removeChild(t);this._parent=n,n.addChild(this,i),t.parent=this}}class Yi extends St{clone(){const t=new this.constructor;return t.debugName=`clone_${this.debugName}`,t._source=this._source,t._name=`clone_${this._name}`,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}constructor(t,n,i,r){super(t,n),this.type=i,this.refCounts=r,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${Zj()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}function Kw(e){return e.as!==void 0}function k5(e){return`${e}_end`}class ma extends St{clone(){return new ma(null,De(this.timeUnits))}constructor(t,n){super(t),this.timeUnits=n}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,s,a)=>{const{field:o,timeUnit:u}=s;if(u){let l;if(Uc(u)){if(Vt(n)){const{mark:c,markDef:f,config:d}=n,p=Vu({fieldDef:s,markDef:f,config:d});(Ag(c)||p)&&(l={timeUnit:Rn(u),field:o})}}else l={as:fe(s,{forAs:!0}),field:o,timeUnit:u};if(Vt(n)){const{mark:c,markDef:f,config:d}=n,p=Vu({fieldDef:s,markDef:f,config:d});Ag(c)&&un(a)&&p!==.5&&(l.rectBandPosition=p)}l&&(r[nt(l)]=l)}return r},{});return Ct(i)?null:new ma(t,i)}static makeFromTransform(t,n){const{timeUnit:i,...r}={...n},s=Rn(i),a={...r,timeUnit:s};return new ma(t,{[nt(a)]:a})}merge(t){this.timeUnits={...this.timeUnits};for(const n in t.timeUnits)this.timeUnits[n]||(this.timeUnits[n]=t.timeUnits[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}removeFormulas(t){const n={};for(const[i,r]of ju(this.timeUnits)){const s=Kw(r)?r.as:`${r.field}_end`;t.has(s)||(n[i]=r)}this.timeUnits=n}producedFields(){return new Set(Yn(this.timeUnits).map(t=>Kw(t)?t.as:k5(t.field)))}dependentFields(){return new Set(Yn(this.timeUnits).map(t=>t.field))}hash(){return`TimeUnit ${nt(this.timeUnits)}`}assemble(){const t=[];for(const n of Yn(this.timeUnits)){const{rectBandPosition:i}=n,r=Rn(n.timeUnit);if(Kw(n)){const{field:s,as:a}=n,{unit:o,utc:u,...l}=r,c=[a,`${a}_end`];t.push({field:Zr(s),type:"timeunit",...o?{units:db(o)}:{},...u?{timezone:"utc"}:{},...l,as:c}),t.push(...$5(c,i,r))}else if(n){const{field:s}=n,a=s.replaceAll("\\.","."),o=rW({timeUnit:r,field:a}),u=k5(a);t.push({type:"formula",expr:o,as:u}),t.push(...$5([a,u],i,r))}}return t}}const Tb="offsetted_rect_start",Ob="offsetted_rect_end";function rW({timeUnit:e,field:t,reverse:n}){const{unit:i,utc:r}=e,s=Rq(i),{part:a,step:o}=Lq(s,e.step);return`${r?"utcOffset":"timeOffset"}('${a}', ${wt(t)}, ${n?-o:o})`}function $5([e,t],n,i){if(n!==void 0&&n!==.5){const r=wt(e),s=wt(t);return[{type:"formula",expr:T5([rW({timeUnit:i,field:e,reverse:!0}),r],n+.5),as:`${e}_${Tb}`},{type:"formula",expr:T5([r,s],n+.5),as:`${e}_${Ob}`}]}return[]}function T5([e,t],n){return`${1-n} * ${e} + ${n} * ${t}`}const T0="_tuple_fields";class g$e{constructor(...t){this.items=t,this.hasChannel={},this.hasField={},this.hasSelectionId=!1}}const m$e={defined:()=>!0,parse:(e,t,n)=>{const i=t.name,r=t.project??(t.project=new g$e),s={},a={},o=new Set,u=(m,y)=>{const v=y==="visual"?m.channel:m.field;let b=Bt(`${i}_${v}`);for(let _=1;o.has(b);_++)b=Bt(`${i}_${v}_${_}`);return o.add(b),{[y]:b}},l=t.type,c=e.config.selection[l],f=n.value!==void 0?pe(n.value):null;let{fields:d,encodings:p}=de(n.select)?n.select:{};if(!d&&!p&&f){for(const m of f)if(de(m))for(const y of re(m))TEe(y)?(p||(p=[])).push(y):l==="interval"?(oe(fSe),p=c.encodings):(d??(d=[])).push(y)}!d&&!p&&(p=c.encodings,"fields"in c&&(d=c.fields));for(const m of p??[]){const y=e.fieldDef(m);if(y){let v=y.field;if(y.aggregate){oe(nSe(m,y.aggregate));continue}else if(!v){oe(Z6(m));continue}if(y.timeUnit&&!Uc(y.timeUnit)){v=e.vgField(m);const b={timeUnit:y.timeUnit,as:v,field:y.field};a[nt(b)]=b}if(!s[v]){const b=l==="interval"&&Ba(m)&&Ns(e.getScaleComponent(m).get("type"))?"R":y.bin?"R-RE":"E",_={field:v,channel:m,type:b,index:r.items.length};_.signals={...u(_,"data"),...u(_,"visual")},r.items.push(s[v]=_),r.hasField[v]=s[v],r.hasSelectionId=r.hasSelectionId||v===Ds,sq(m)?(_.geoChannel=m,_.channel=rq(m),r.hasChannel[_.channel]=s[v]):r.hasChannel[m]=s[v]}}else oe(Z6(m))}for(const m of d??[]){if(r.hasField[m])continue;const y={type:"E",field:m,index:r.items.length};y.signals={...u(y,"data")},r.items.push(y),r.hasField[m]=y,r.hasSelectionId=r.hasSelectionId||m===Ds}f&&(t.init=f.map(m=>r.items.map(y=>de(m)?m[y.geoChannel||y.channel]!==void 0?m[y.geoChannel||y.channel]:m[y.field]:m))),Ct(a)||(r.timeUnit=new ma(null,a))},signals:(e,t,n)=>{const i=t.name+T0;return n.filter(s=>s.name===i).length>0||t.project.hasSelectionId?n:n.concat({name:i,value:t.project.items.map(uW)})}},sW="_curr",X1="anim_value",Cf="anim_clock",LA="eased_anim_clock",aW="min_extent",oW="max_range_extent",Jw="last_tick_at",Qw="is_playing",y$e=1/60*1e3,v$e=(e,t)=>[{name:LA,update:Cf},{name:`${e}_domain`,init:`domain('${t}')`},{name:aW,init:`extent(${e}_domain)[0]`},{name:oW,init:`extent(range('${t}'))[1]`},{name:X1,update:`invert('${t}', ${LA})`}],x$e={defined:e=>e.type==="point",topLevelSignals:(e,t,n)=>(ya(t)&&(n=n.concat([{name:Cf,init:"0",on:[{events:{type:"timer",throttle:y$e},update:`${Qw} ? (${Cf} + (now() - ${Jw}) > ${oW} ? 0 : ${Cf} + (now() - ${Jw})) : ${Cf}`}]},{name:Jw,init:"now()",on:[{events:[{signal:Cf},{signal:Qw}],update:"now()"}]},{name:Qw,init:"true"}])),n),signals:(e,t,n)=>{const i=t.name,r=i+T0,s=t.project,a="(item().isVoronoi ? datum.datum : datum)",o=Yn(e.component.selection??{}).reduce((c,f)=>f.type==="interval"?c.concat(f.name+Wf):c,[]).map(c=>`indexof(item().mark.name, '${c}') < 0`).join(" && "),u=`datum && item().mark.marktype !== 'group' && indexof(item().mark.role, 'legend') < 0${o?` && ${o}`:""}`;let l=`unit: ${tc(e)}, `;if(t.project.hasSelectionId)l+=`${Ds}: ${a}[${le(Ds)}]`;else if(ya(t))l+=`fields: ${r}, values: [${X1} ? ${X1} : ${aW}]`;else{const c=s.items.map(f=>e.fieldDef(f.channel)?.bin?`[${a}[${le(e.vgField(f.channel,{}))}], ${a}[${le(e.vgField(f.channel,{binSuffix:"end"}))}]]`:`${a}[${le(f.field)}]`).join(", ");l+=`fields: ${r}, values: [${c}]`}if(ya(t))return n.concat(v$e(t.name,e.scaleName(rl)),[{name:i+No,on:[{events:[{signal:LA},{signal:X1}],update:`{${l}}`,force:!0}]}]);{const c=t.events;return n.concat([{name:i+No,on:c?[{events:c,update:`${u} ? {${l}} : null`,force:!0}]:[]}])}}};function uW(e){const{signals:t,hasLegend:n,index:i,...r}=e;return r.field=Zr(r.field),r}function Ec(e,t=!0,n=hi){if(Q(e)){const i=e.map(r=>Ec(r,t,n));return t?`[${i.join(", ")}]`:i}else if(Bc(e))return n(t?xc(e):gAe(e));return t?n(kt(e)):e}function b$e(e,t){for(const n of Yn(e.component.selection??{})){const i=n.name;let r=`${i}${No}, ${n.resolve==="global"?"true":`{unit: ${tc(e)}}`}`;for(const s of Mb)s.defined(n)&&(s.signals&&(t=s.signals(e,n,t)),s.modifyExpr&&(r=s.modifyExpr(e,n,r)));t.push({name:i+H$e,on:[{events:{signal:n.name+No},update:`modify(${le(n.name+Sc)}, ${r})`}]})}return cO(t)}function _$e(e,t){if(e.component.selection&&re(e.component.selection).length){const n=le(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:nl("pointermove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return cO(t)}function w$e(e,t){let n=!1;for(const i of Yn(e.component.selection??{})){const r=i.name,s=le(r+Sc);if(t.filter(o=>o.name===r).length===0){const o=i.resolve==="global"?"union":i.resolve,u=i.type==="point"?", true, true)":")";t.push({name:i.name,update:`${AW}(${s}, ${le(o)}${u}`})}n=!0;for(const o of Mb)o.defined(i)&&o.topLevelSignals&&(t=o.topLevelSignals(e,i,t))}return n&&t.filter(r=>r.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"pointermove",update:"isTuple(group()) ? group() : unit"}]}),cO(t)}function E$e(e,t){const n=[],i=[],r=tc(e,{escape:!1});for(const s of Yn(e.component.selection??{})){const a={name:s.name+Sc};if(s.project.hasSelectionId&&(a.transform=[{type:"collect",sort:{field:Ds}}]),s.init){const u=s.project.items.map(uW);a.values=s.project.hasSelectionId?s.init.map(l=>({unit:r,[Ds]:Ec(l,!1)[0]})):s.init.map(l=>({unit:r,fields:u,values:Ec(l,!1)}))}if([...n,...t].filter(u=>u.name===s.name+Sc).length||n.push(a),ya(s)&&t.length){const u=e.lookupDataSource(e.getDataName(Wt.Main)),l=t.find(f=>f.name===u),c=l.transform.find(f=>f.type==="filter"&&f.expr.includes("vlSelectionTest"));if(c){l.transform=l.transform.filter(d=>d!==c);const f={name:l.name+sW,source:l.name,transform:[c]};i.push(f)}}}return n.concat(t,i)}function lW(e,t){for(const n of Yn(e.component.selection??{}))for(const i of Mb)i.defined(n)&&i.marks&&(t=i.marks(e,n,t));return t}function S$e(e,t){for(const n of e.children)Vt(n)&&(t=lW(n,t));return t}function A$e(e,t,n,i){const r=OW(e,t.param,t);return{signal:Ns(n.get("type"))&&Q(i)&&i[0]>i[1]?`isValid(${r}) && reverse(${r})`:r}}function cO(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}const Co={defined:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const i of t.project.items){const r=i.channel;if(!Ba(r))continue;const s=e.getScaleComponent(r),a=s?s.get("type"):void 0;if(a=="sequential"&&oe(aSe),!s||!Ns(a)){oe(sSe);continue}s.set("selectionExtent",{param:t.name,field:i.field},!0),n.push(i)}},topLevelSignals:(e,t,n)=>{const i=t.scales.filter(a=>n.filter(o=>o.name===a.signals.data).length===0);if(!e.parent||BA(e)||i.length===0)return n;const r=n.find(a=>a.name===t.name);let s=r.update;if(s.includes(AW))r.update=`{${i.map(a=>`${le(Zr(a.field))}: ${a.signals.data}`).join(", ")}}`;else{for(const a of i){const o=`${le(Zr(a.field))}: ${a.signals.data}`;s.includes(o)||(s=`${s.substring(0,s.length-1)}, ${o}}`)}r.update=s}return n.concat(i.map(a=>({name:a.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!BA(e))for(const i of t.scales){const r=n.find(s=>s.name===i.signals.data);r.push="outer",delete r.value,delete r.update}return n}};function zA(e,t){return`domain(${le(e.scaleName(t))})`}function BA(e){return e.parent&&id(e.parent)&&(!e.parent.parent||BA(e.parent.parent))}const Wf="_brush",cW="_scale_trigger",ip="geo_interval_init_tick",fW="_init",C$e="_center",k$e={defined:e=>e.type==="interval",parse:(e,t,n)=>{var i;if(e.hasProjection){const r={...de(n.select)?n.select:{}};r.fields=[Ds],r.encodings||(r.encodings=n.value?re(n.value):[Vs,qs]),n.select={type:"interval",...r}}if(t.translate&&!Co.defined(t)){const r=`!event.item || event.item.mark.name !== ${le(t.name+Wf)}`;for(const s of t.events){if(!s.between){oe(`${s} is not an ordered event stream for interval selections.`);continue}const a=pe((i=s.between[0]).filter??(i.filter=[]));a.includes(r)||a.push(r)}}},signals:(e,t,n)=>{const i=t.name,r=i+No,s=Yn(t.project.hasChannel).filter(o=>o.channel===Ut||o.channel===Pn),a=t.init?t.init[0]:null;if(n.push(...s.reduce((o,u)=>o.concat($$e(e,t,u,a&&a[u.index])),[])),e.hasProjection){const o=le(e.projectionName()),u=e.projectionName()+C$e,{x:l,y:c}=t.project.hasChannel,f=l&&l.signals.visual,d=c&&c.signals.visual,p=l?a&&a[l.index]:`${u}[0]`,m=c?a&&a[c.index]:`${u}[1]`,y=A=>e.getSizeSignalRef(A).signal,v=`[[${f?f+"[0]":"0"}, ${d?d+"[0]":"0"}],[${f?f+"[1]":y("width")}, ${d?d+"[1]":y("height")}]]`;a&&(n.unshift({name:i+fW,init:`[scale(${o}, [${l?p[0]:p}, ${c?m[0]:m}]), scale(${o}, [${l?p[1]:p}, ${c?m[1]:m}])]`}),(!l||!c)&&(n.find($=>$.name===u)||n.unshift({name:u,update:`invert(${o}, [${y("width")}/2, ${y("height")}/2])`})));const b=`intersect(${v}, {markname: ${le(e.getName("marks"))}}, unit.mark)`,_=`{unit: ${tc(e)}}`,E=`vlSelectionTuples(${b}, ${_})`,S=s.map(A=>A.signals.visual);return n.concat({name:r,on:[{events:[...S.length?[{signal:S.join(" || ")}]:[],...a?[{signal:ip}]:[]],update:E}]})}else{if(!Co.defined(t)){const l=i+cW,c=s.map(f=>{const d=f.channel,{data:p,visual:m}=f.signals,y=le(e.scaleName(d)),v=e.getScaleComponent(d).get("type"),b=Ns(v)?"+":"";return`(!isArray(${p}) || (${b}invert(${y}, ${m})[0] === ${b}${p}[0] && ${b}invert(${y}, ${m})[1] === ${b}${p}[1]))`});c.length&&n.push({name:l,value:{},on:[{events:s.map(f=>({scale:e.scaleName(f.channel)})),update:c.join(" && ")+` ? ${l} : {}`}]})}const o=s.map(l=>l.signals.data),u=`unit: ${tc(e)}, fields: ${i+T0}, values`;return n.concat({name:r,...a?{init:`{${u}: ${Ec(a)}}`}:{},...o.length?{on:[{events:[{signal:o.join(" || ")}],update:`${o.join(" && ")} ? {${u}: [${o}]} : null`}]}:{}})}},topLevelSignals:(e,t,n)=>(Vt(e)&&e.hasProjection&&t.init&&(n.filter(r=>r.name===ip).length||n.unshift({name:ip,value:null,on:[{events:"timer{1}",update:`${ip} === null ? {} : ${ip}`}]})),n),marks:(e,t,n)=>{const i=t.name,{x:r,y:s}=t.project.hasChannel,a=r?.signals.visual,o=s?.signals.visual,u=`data(${le(t.name+Sc)})`;if(Co.defined(t)||!r&&!s)return n;const l={x:r!==void 0?{signal:`${a}[0]`}:{value:0},y:s!==void 0?{signal:`${o}[0]`}:{value:0},x2:r!==void 0?{signal:`${a}[1]`}:{field:{group:"width"}},y2:s!==void 0?{signal:`${o}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const v of re(l))l[v]=[{test:`${u}.length && ${u}[0].unit === ${tc(e)}`,...l[v]},{value:0}];const{fill:c,fillOpacity:f,cursor:d,...p}=t.mark,m=re(p).reduce((v,b)=>(v[b]=[{test:[r!==void 0&&`${a}[0] !== ${a}[1]`,s!==void 0&&`${o}[0] !== ${o}[1]`].filter(_=>_).join(" && "),value:p[b]},{value:null}],v),{}),y=d??(t.translate?"move":null);return[{name:`${i+Wf}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:c},fillOpacity:{value:f}},update:l}},...n,{name:i+Wf,type:"rect",clip:!0,encode:{enter:{...y?{cursor:{value:y}}:{},fill:{value:"transparent"}},update:{...l,...m}}}]}};function $$e(e,t,n,i){const r=!e.hasProjection,s=n.channel,a=n.signals.visual,o=le(r?e.scaleName(s):e.projectionName()),u=d=>`scale(${o}, ${d})`,l=e.getSizeSignalRef(s===Ut?"width":"height").signal,c=`${s}(unit)`,f=t.events.reduce((d,p)=>[...d,{events:p.between[0],update:`[${c}, ${c}]`},{events:p,update:`[${a}[0], clamp(${c}, 0, ${l})]`}],[]);if(r){const d=n.signals.data,p=Co.defined(t),m=e.getScaleComponent(s),y=m?m.get("type"):void 0,v=i?{init:Ec(i,!0,u)}:{value:[]};return f.push({events:{signal:t.name+cW},update:Ns(y)?`[${u(`${d}[0]`)}, ${u(`${d}[1]`)}]`:"[0, 0]"}),p?[{name:d,on:[]}]:[{name:a,...v,on:f},{name:d,...i?{init:Ec(i)}:{},on:[{events:{signal:a},update:`${a}[0] === ${a}[1] ? null : invert(${o}, ${a})`}]}]}else{const d=s===Ut?0:1,p=t.name+fW,m=i?{init:`[${p}[0][${d}], ${p}[1][${d}]]`}:{value:[]};return[{name:a,...m,on:f}]}}function Zh({model:e,channelDef:t,vgChannel:n,invalidValueRef:i,mainRefFn:r}){const s=A0(t)&&t.condition;let a=[];s&&(a=pe(s).map(l=>{const c=r(l);if(gCe(l)){const{param:f,empty:d}=l;return{test:TW(e,{param:f,empty:d}),...c}}else return{test:kv(e,l.test),...c}})),i!==void 0&&a.push(i);const o=r(t);return o!==void 0&&a.push(o),a.length>1||a.length===1&&a[0].test?{[n]:a}:a.length===1?{[n]:a[0]}:{}}function fO(e,t="text"){const n=e.encoding[t];return Zh({model:e,channelDef:n,vgChannel:t,mainRefFn:i=>Fb(i,e.config),invalidValueRef:void 0})}function Fb(e,t,n="datum"){if(e){if(Rs(e))return Dt(e.value);if(Le(e)){const{format:i,formatType:r}=_v(e);return WT({fieldOrDatumDef:e,format:i,formatType:r,expr:n,config:t})}}}function hW(e,t={}){const{encoding:n,markDef:i,config:r,stack:s}=e,a=n.tooltip;if(Q(a))return{tooltip:O5({tooltip:a},s,r,t)};{const o=t.reactiveGeom?"datum.datum":"datum";return Zh({model:e,channelDef:a,vgChannel:"tooltip",mainRefFn:l=>{const c=Fb(l,r,o);if(c)return c;if(l===null)return;let f=At("tooltip",i,r);if(f===!0&&(f={content:"encoding"}),ge(f))return{value:f};if(de(f))return Ee(f)?f:f.content==="encoding"?O5(n,s,r,t):{signal:o}},invalidValueRef:void 0})}}function dW(e,t,n,{reactiveGeom:i}={}){const r={...n,...n.tooltipFormat},s=new Set,a=i?"datum.datum":"datum",o=[];function u(c,f){const d=Pc(f),p=Fi(c)?c:{...c,type:e[d].type},m=p.title||XT(p,r),y=pe(m).join(", ").replaceAll(/"/g,'\\"');let v;if(un(f)){const b=f==="x"?"x2":"y2",_=Is(e[b]);if(Un(p.bin)&&_){const E=fe(p,{expr:a}),S=fe(_,{expr:a}),{format:A,formatType:$}=_v(p);v=E0(E,S,A,$,r),s.add(b)}}if((un(f)||f===is||f===js)&&t&&t.fieldChannel===f&&t.offset==="normalize"){const{format:b,formatType:_}=_v(p);v=WT({fieldOrDatumDef:p,format:b,formatType:_,expr:a,config:r,normalizeStack:!0}).signal}v??(v=Fb(p,r,a).signal),o.push({channel:f,key:y,value:v})}JT(e,(c,f)=>{ue(c)?u(c,f):_b(c)&&u(c.condition,f)});const l={};for(const{channel:c,key:f,value:d}of o)!s.has(c)&&!l[f]&&(l[f]=d);return l}function O5(e,t,n,{reactiveGeom:i}={}){const r=dW(e,t,n,{reactiveGeom:i}),s=ju(r).map(([a,o])=>`"${a}": ${o}`);return s.length>0?{signal:`{${s.join(", ")}}`}:void 0}function T$e(e){const{markDef:t,config:n}=e,i=At("aria",t,n);return i===!1?{}:{...i?{aria:i}:{},...O$e(e),...F$e(e)}}function O$e(e){const{mark:t,markDef:n,config:i}=e;if(i.aria===!1)return{};const r=At("ariaRoleDescription",n,i);return r!=null?{ariaRoleDescription:{value:r}}:ve(QEe,t)?{}:{ariaRoleDescription:{value:t}}}function F$e(e){const{encoding:t,markDef:n,config:i,stack:r}=e,s=t.description;if(s)return Zh({model:e,channelDef:s,vgChannel:"description",mainRefFn:u=>Fb(u,e.config),invalidValueRef:void 0});const a=At("description",n,i);if(a!=null)return{description:Dt(a)};if(i.aria===!1)return{};const o=dW(t,r,i);if(!Ct(o))return{description:{signal:ju(o).map(([u,l],c)=>`"${c>0?"; ":""}${u}: " + (${l})`).join(" + ")}}}function Vn(e,t,n={}){const{markDef:i,encoding:r,config:s}=t,{vgChannel:a}=n;let{defaultRef:o,defaultValue:u}=n;const l=r[e];o===void 0&&(u??(u=At(e,i,s,{vgChannel:a,ignoreVgConfig:!A0(l)})),u!==void 0&&(o=Dt(u)));const c={markDef:i,config:s,scaleName:t.scaleName(e),scale:t.getScaleComponent(e)},f=eV({...c,scaleChannel:e,channelDef:l});return Zh({model:t,channelDef:l,vgChannel:a??e,invalidValueRef:f,mainRefFn:p=>VT({...c,channel:e,channelDef:p,stack:null,defaultRef:o})})}function pW(e,t={filled:void 0}){const{markDef:n,encoding:i,config:r}=e,{type:s}=n,a=t.filled??At("filled",n,r),o=Ze(["bar","point","circle","square","geoshape"],s)?"transparent":void 0,u=At(a===!0?"color":void 0,n,r,{vgChannel:"fill"})??r.mark[a===!0&&"color"]??o,l=At(a===!1?"color":void 0,n,r,{vgChannel:"stroke"})??r.mark[a===!1&&"color"],c=a?"fill":"stroke",f={...u?{fill:Dt(u)}:{},...l?{stroke:Dt(l)}:{}};return n.color&&(a?n.fill:n.stroke)&&oe(Aq("property",{fill:"fill"in n,stroke:"stroke"in n})),{...f,...Vn("color",e,{vgChannel:c,defaultValue:a?u:l}),...Vn("fill",e,{defaultValue:i.fill?u:void 0}),...Vn("stroke",e,{defaultValue:i.stroke?l:void 0})}}function M$e(e){const{encoding:t,mark:n}=e,i=t.order;return!cl(n)&&Rs(i)?Zh({model:e,channelDef:i,vgChannel:"zindex",mainRefFn:r=>Dt(r.value),invalidValueRef:void 0}):{}}function Ah({channel:e,markDef:t,encoding:n={},model:i,bandPosition:r}){const s=`${e}Offset`,a=t[s],o=n[s];if((s==="xOffset"||s==="yOffset")&&o)return{offsetType:"encoding",offset:VT({channel:s,channelDef:o,markDef:t,config:i?.config,scaleName:i.scaleName(s),scale:i.getScaleComponent(s),stack:null,defaultRef:Dt(a),bandPosition:r})};const u=t[s];return u?{offsetType:"visual",offset:u}:{}}function Ci(e,t,{defaultPos:n,vgChannel:i}){const{encoding:r,markDef:s,config:a,stack:o}=t,u=r[e],l=r[za(e)],c=t.scaleName(e),f=t.getScaleComponent(e),{offset:d,offsetType:p}=Ah({channel:e,markDef:s,encoding:r,model:t,bandPosition:.5}),m=hO({model:t,defaultPos:n,channel:e,scaleName:c,scale:f}),y=!u&&un(e)&&(r.latitude||r.longitude)?{field:t.getName(e)}:N$e({channel:e,channelDef:u,channel2Def:l,markDef:s,config:a,scaleName:c,scale:f,stack:o,offset:d,defaultRef:m,bandPosition:p==="encoding"?0:void 0});return y?{[i||e]:y}:void 0}function N$e(e){const{channel:t,channelDef:n,scaleName:i,stack:r,offset:s,markDef:a}=e;if(Le(n)&&r&&t===r.fieldChannel){if(ue(n)){let o=n.bandPosition;if(o===void 0&&a.type==="text"&&(t==="radius"||t==="theta")&&(o=.5),o!==void 0)return vv({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",bandPosition:o,offset:s})}return Zl(n,i,{suffix:"end"},{offset:s})}return qT(e)}function hO({model:e,defaultPos:t,channel:n,scaleName:i,scale:r}){const{markDef:s,config:a}=e;return()=>{const o=Pc(n),u=qu(n),l=At(n,s,a,{vgChannel:u});if(l!==void 0)return Yp(n,l);switch(t){case"zeroOrMin":return F5({scaleName:i,scale:r,mode:"zeroOrMin",mainChannel:o,config:a});case"zeroOrMax":return F5({scaleName:i,scale:r,mode:{zeroOrMax:{widthSignal:e.width.signal,heightSignal:e.height.signal}},mainChannel:o,config:a});case"mid":return{...e[er(n)],mult:.5}}}}function F5({mainChannel:e,config:t,...n}){const i=Zq(n),{mode:r}=n;if(i)return i;switch(e){case"radius":{if(r==="zeroOrMin")return{value:0};const{widthSignal:s,heightSignal:a}=r.zeroOrMax;return{signal:`min(${s},${a})/2`}}case"theta":return r==="zeroOrMin"?{value:0}:{signal:"2*PI"};case"x":return r==="zeroOrMin"?{value:0}:{field:{group:"width"}};case"y":return r==="zeroOrMin"?{field:{group:"height"}}:{value:0}}}const R$e={left:"x",center:"xc",right:"x2"},I$e={top:"y",middle:"yc",bottom:"y2"};function gW(e,t,n,i="middle"){if(e==="radius"||e==="theta")return qu(e);const r=e==="x"?"align":"baseline",s=At(r,t,n);let a;return Ee(s)?(oe(NSe(r)),a=void 0):a=s,e==="x"?R$e[a||(i==="top"?"left":"center")]:I$e[a||i]}function Av(e,t,{defaultPos:n,defaultPos2:i,range:r}){return r?mW(e,t,{defaultPos:n,defaultPos2:i}):Ci(e,t,{defaultPos:n})}function mW(e,t,{defaultPos:n,defaultPos2:i}){const{markDef:r,config:s}=t,a=za(e),o=er(e),u=D$e(t,i,a),l=u[o]?gW(e,r,s):qu(e);return{...Ci(e,t,{defaultPos:n,vgChannel:l}),...u}}function D$e(e,t,n){const{encoding:i,mark:r,markDef:s,stack:a,config:o}=e,u=Pc(n),l=er(n),c=qu(n),f=i[u],d=e.scaleName(u),p=e.getScaleComponent(u),{offset:m}=n in i||n in s?Ah({channel:n,markDef:s,encoding:i,model:e}):Ah({channel:u,markDef:s,encoding:i,model:e});if(!f&&(n==="x2"||n==="y2")&&(i.latitude||i.longitude)){const v=er(n),b=e.markDef[v];return b!=null?{[v]:{value:b}}:{[c]:{field:e.getName(n)}}}const y=P$e({channel:n,channelDef:f,channel2Def:i[n],markDef:s,config:o,scaleName:d,scale:p,stack:a,offset:m,defaultRef:void 0});return y!==void 0?{[c]:y}:l1(n,s)||l1(n,{[n]:kA(n,s,o.style),[l]:kA(l,s,o.style)})||l1(n,o[r])||l1(n,o.mark)||{[c]:hO({model:e,defaultPos:t,channel:n,scaleName:d,scale:p})()}}function P$e({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:s,scale:a,stack:o,offset:u,defaultRef:l}){return Le(t)&&o&&e.charAt(0)===o.fieldChannel.charAt(0)?Zl(t,s,{suffix:"start"},{offset:u}):qT({channel:e,channelDef:n,scaleName:s,scale:a,stack:o,markDef:i,config:r,offset:u,defaultRef:l})}function l1(e,t){const n=er(e),i=qu(e);if(t[i]!==void 0)return{[i]:Yp(e,t[i])};if(t[e]!==void 0)return{[i]:Yp(e,t[e])};if(t[n]){const r=t[n];if(_c(r))oe(kSe(n));else return{[n]:Yp(e,r)}}}function Mo(e,t){const{config:n,encoding:i,markDef:r}=e,s=r.type,a=za(t),o=er(t),u=i[t],l=i[a],c=e.getScaleComponent(t),f=c?c.get("type"):void 0,d=r.orient,p=i[o]??i.size??At("size",r,n,{vgChannel:o}),m=lq(t),y=s==="bar"&&(t==="x"?d==="vertical":d==="horizontal")||s==="tick"&&(t==="y"?d==="vertical":d==="horizontal");return ue(u)&&(Nt(u.bin)||Un(u.bin)||u.timeUnit&&!l)&&!(p&&!_c(p))&&!i[m]&&!In(f)?B$e({fieldDef:u,fieldDef2:l,channel:t,model:e}):(Le(u)&&In(f)||y)&&!l?z$e(u,t,e):mW(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function L$e(e,t,n,i,r,s,a){if(_c(r))if(n){const u=n.get("type");if(u==="band"){let l=`bandwidth('${t}')`;r.band!==1&&(l=`${r.band} * ${l}`);const c=Aa("minBandSize",{type:a},i);return{signal:c?`max(${Ss(c)}, ${l})`:l}}else r.band!==1&&(oe(PSe(u)),r=void 0)}else return{mult:r.band,field:{group:e}};else{if(Ee(r))return r;if(r)return{value:r}}if(n){const u=n.get("range");if(zc(u)&&dt(u.step))return{value:u.step-2}}if(!s){const{bandPaddingInner:u,barBandPaddingInner:l,rectBandPaddingInner:c,tickBandPaddingInner:f}=i.scale,d=on(u,a==="tick"?f:a==="bar"?l:c);if(Ee(d))return{signal:`(1 - (${d.signal})) * ${e}`};if(dt(d))return{signal:`${1-d} * ${e}`}}return{value:RA(i.view,e)-2}}function z$e(e,t,n){const{markDef:i,encoding:r,config:s,stack:a}=n,o=i.orient,u=n.scaleName(t),l=n.getScaleComponent(t),c=er(t),f=za(t),d=lq(t),p=n.scaleName(d),m=n.getScaleComponent(mT(t)),y=i.type==="tick"||o==="horizontal"&&t==="y"||o==="vertical"&&t==="x";let v;(r.size||i.size)&&(y?v=Vn("size",n,{vgChannel:c,defaultRef:Dt(i.size)}):oe(USe(i.type)));const b=!!v,_=oV({channel:t,fieldDef:e,markDef:i,config:s,scaleType:(l||m)?.get("type"),useVlSizeChannel:y});v=v||{[c]:L$e(c,p||u,m||l,s,_,!!e,i.type)};const E=(l||m)?.get("type")==="band"&&_c(_)&&!b?"top":"middle",S=gW(t,i,s,E),A=S==="xc"||S==="yc",{offset:$,offsetType:C}=Ah({channel:t,markDef:i,encoding:r,model:n,bandPosition:A?.5:0}),M=qT({channel:t,channelDef:e,markDef:i,config:s,scaleName:u,scale:l,stack:a,offset:$,defaultRef:hO({model:n,defaultPos:"mid",channel:t,scaleName:u,scale:l}),bandPosition:A?C==="encoding"?0:.5:Ee(_)?{signal:`(1-${_})/2`}:_c(_)?(1-_.band)/2:0});if(c)return{[S]:M,...v};{const N=qu(f),P=v[c],D=$?{...P,offset:$}:P;return{[S]:M,[N]:Q(M)?[M[0],{...M[1],offset:D}]:{...M,offset:D}}}}function M5(e,t,n,i,r,s,a){if(iq(e))return 0;const o=e==="x"||e==="y2",u=o?-t/2:t/2;if(Ee(n)||Ee(r)||Ee(i)||s){const l=Ss(n),c=Ss(r),f=Ss(i),d=Ss(s),m=s?`(${a} < ${d} ? ${o?"":"-"}0.5 * (${d} - (${a})) : ${u})`:u,y=f?`${f} + `:"",v=l?`(${l} ? -1 : 1) * `:"",b=c?`(${c} + ${m})`:m;return{signal:y+v+b}}else return r=r||0,i+(n?-r-u:+r+u)}function B$e({fieldDef:e,fieldDef2:t,channel:n,model:i}){const{config:r,markDef:s,encoding:a}=i,o=i.getScaleComponent(n),u=i.scaleName(n),l=o?o.get("type"):void 0,c=o.get("reverse"),f=oV({channel:n,fieldDef:e,markDef:s,config:r,scaleType:l}),p=i.component.axes[n]?.[0]?.get("translate")??.5,m=un(n)?At("binSpacing",s,r)??0:0,y=za(n),v=qu(n),b=qu(y),_=Aa("minBandSize",s,r),{offset:E}=Ah({channel:n,markDef:s,encoding:a,model:i,bandPosition:0}),{offset:S}=Ah({channel:y,markDef:s,encoding:a,model:i,bandPosition:0}),A=lCe({fieldDef:e,scaleName:u}),$=M5(n,m,c,p,E,_,A),C=M5(y,m,c,p,S??E,_,A),M=Ee(f)?{signal:`(1-${f.signal})/2`}:_c(f)?(1-f.band)/2:.5,N=Vu({fieldDef:e,fieldDef2:t,markDef:s,config:r});if(Nt(e.bin)||e.timeUnit){const P=e.timeUnit&&N!==.5;return{[b]:N5({fieldDef:e,scaleName:u,bandPosition:M,offset:C,useRectOffsetField:P}),[v]:N5({fieldDef:e,scaleName:u,bandPosition:Ee(M)?{signal:`1-${M.signal}`}:1-M,offset:$,useRectOffsetField:P})}}else if(Un(e.bin)){const P=Zl(e,u,{},{offset:C});if(ue(t))return{[b]:P,[v]:Zl(t,u,{},{offset:$})};if(Lc(e.bin)&&e.bin.step)return{[b]:P,[v]:{signal:`scale("${u}", ${fe(e,{expr:"datum"})} + ${e.bin.step})`,offset:$}}}oe($q(y))}function N5({fieldDef:e,scaleName:t,bandPosition:n,offset:i,useRectOffsetField:r}){return vv({scaleName:t,fieldOrDatumDef:e,bandPosition:n,offset:i,...r?{startSuffix:Tb,endSuffix:Ob}:{}})}const U$e=new Set(["aria","width","height"]);function rs(e,t){const{fill:n=void 0,stroke:i=void 0}=t.color==="include"?pW(e):{};return{...j$e(e.markDef,t),...R5("fill",n),...R5("stroke",i),...Vn("opacity",e),...Vn("fillOpacity",e),...Vn("strokeOpacity",e),...Vn("strokeWidth",e),...Vn("strokeDash",e),...M$e(e),...hW(e),...fO(e,"href"),...T$e(e)}}function R5(e,t){return t?{[e]:t}:{}}function j$e(e,t){return JEe.reduce((n,i)=>(!U$e.has(i)&&se(e,i)&&t[i]!=="ignore"&&(n[i]=Dt(e[i])),n),{})}function dO(e){const{config:t,markDef:n}=e,i=new Set;if(e.forEachFieldDef((r,s)=>{let a;if(!Ba(s)||!(a=e.getScaleType(s)))return;const o=cb(r.aggregate),u=jT({scaleChannel:s,markDef:n,config:t,scaleType:a,isCountAggregate:o});if(aCe(u)){const l=e.vgField(s,{expr:"datum",binSuffix:e.stack?.impute?"mid":void 0});l&&i.add(l)}}),i.size>0)return{defined:{signal:[...i].map(s=>pb(s,!0)).join(" && ")}}}function I5(e,t){if(t!==void 0)return{[e]:Dt(t)}}const Zw="voronoi",yW={defined:e=>e.type==="point"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(Zw)},marks:(e,t,n)=>{const{x:i,y:r}=t.project.hasChannel,s=e.mark;if(cl(s))return oe(iSe(s)),n;const a={name:e.getName(Zw),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0},...hW(e,{reactiveGeom:!0})}},transform:[{type:"voronoi",x:{expr:i||!r?"datum.datum.x || 0":"0"},y:{expr:r||!i?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let o=0,u=!1;return n.forEach((l,c)=>{const f=l.name??"";f===e.component.mark[0].name?o=c:f.includes(Zw)&&(u=!0)}),u||n.splice(o+1,0,a),n}},vW={defined:e=>e.type==="point"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!iO(e.bind),parse:(e,t,n)=>CW(t,n),topLevelSignals:(e,t,n)=>{const i=t.name,r=t.project,s=t.bind,a=t.init&&t.init[0],o=yW.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return r.items.forEach((u,l)=>{const c=Bt(`${i}_${u.field}`);n.filter(d=>d.name===c).length||n.unshift({name:c,...a?{init:Ec(a[l])}:{value:null},on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${o}[${le(u.field)}] : null`}]:[],bind:s[u.field]??s[u.channel]??s})}),n},signals:(e,t,n)=>{const i=t.name,r=t.project,s=n.find(l=>l.name===i+No),a=i+T0,o=r.items.map(l=>Bt(`${i}_${l.field}`)),u=o.map(l=>`${l} !== null`).join(" && ");return o.length&&(s.update=`${u} ? {fields: ${a}, values: [${o.join(", ")}]} : null`),delete s.value,delete s.on,n}},Cv="_toggle",xW={defined:e=>e.type==="point"&&!ya(e)&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+Cv,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+No,i=t.name+Cv;return`${i} ? null : ${n}, `+(t.resolve==="global"?`${i} ? null : true, `:`${i} ? null : {unit: ${tc(e)}}, `)+`${i} ? ${n} : null`}},q$e={defined:e=>e.clear!==void 0&&e.clear!==!1&&!ya(e),parse:(e,t)=>{t.clear&&(t.clear=ge(t.clear)?nl(t.clear,"view"):t.clear)},topLevelSignals:(e,t,n)=>{if(vW.defined(t))for(const i of t.project.items){const r=n.findIndex(s=>s.name===Bt(`${t.name}_${i.field}`));r!==-1&&n[r].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function i(r,s){r!==-1&&n[r].on&&n[r].on.push({events:t.clear,update:s})}if(t.type==="interval")for(const r of t.project.items){const s=n.findIndex(a=>a.name===r.signals.visual);if(i(s,"[0, 0]"),s===-1){const a=n.findIndex(o=>o.name===r.signals.data);i(a,"null")}}else{let r=n.findIndex(s=>s.name===t.name+No);i(r,"null"),xW.defined(t)&&(r=n.findIndex(s=>s.name===t.name+Cv),i(r,"false"))}return n}},bW={defined:e=>{const t=e.resolve==="global"&&e.bind&&iO(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==Ds;return t&&!n&&oe(oSe),t&&n},parse:(e,t,n)=>{const i=De(n);if(i.select=ge(i.select)?{type:i.select,toggle:t.toggle}:{...i.select,toggle:t.toggle},CW(t,i),de(n.select)&&(n.select.on||n.select.clear)){const a='event.item && indexof(event.item.mark.role, "legend") < 0';for(const o of t.events)o.filter=pe(o.filter??[]),o.filter.includes(a)||o.filter.push(a)}const r=Hw(t.bind)?t.bind.legend:"click",s=ge(r)?nl(r,"view"):pe(r);t.bind={legend:{merge:s}}},topLevelSignals:(e,t,n)=>{const i=t.name,r=Hw(t.bind)&&t.bind.legend,s=a=>o=>{const u=De(o);return u.markname=a,u};for(const a of t.project.items){if(!a.hasLegend)continue;const o=`${Bt(a.field)}_legend`,u=`${i}_${o}`;if(n.filter(c=>c.name===u).length===0){const c=r.merge.map(s(`${o}_symbols`)).concat(r.merge.map(s(`${o}_labels`))).concat(r.merge.map(s(`${o}_entries`)));n.unshift({name:u,...t.init?{}:{value:null},on:[{events:c,update:"isDefined(datum.value) ? datum.value : item().items[0].items[0].datum.value",force:!0},{events:r.merge,update:`!event.item || !datum ? null : ${u}`,force:!0}]})}}return n},signals:(e,t,n)=>{const i=t.name,r=t.project,s=n.find(d=>d.name===i+No),a=i+T0,o=r.items.filter(d=>d.hasLegend).map(d=>Bt(`${i}_${Bt(d.field)}_legend`)),l=`${o.map(d=>`${d} !== null`).join(" && ")} ? {fields: ${a}, values: [${o.join(", ")}]} : null`;t.events&&o.length>0?s.on.push({events:o.map(d=>({signal:d})),update:l}):o.length>0&&(s.update=l,delete s.value,delete s.on);const c=n.find(d=>d.name===i+Cv),f=Hw(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push({...c.on[0],events:f}):c.on[0].events=f),n}};function V$e(e,t,n){const i=e.fieldDef(t)?.field;for(const r of Yn(e.component.selection??{})){const s=r.project.hasField[i]??r.project.hasChannel[t];if(s&&bW.defined(r)){const a=n.get("selections")??[];a.push(r.name),n.set("selections",a,!1),s.hasLegend=!0}}}const _W="_translate_anchor",wW="_translate_delta",W$e={defined:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const i=t.name,r=Co.defined(t),s=i+_W,{x:a,y:o}=t.project.hasChannel;let u=nl(t.translate,"scope");return r||(u=u.map(l=>(l.between[0].markname=i+Wf,l))),n.push({name:s,value:{},on:[{events:u.map(l=>l.between[0]),update:"{x: x(unit), y: y(unit)"+(a!==void 0?`, extent_x: ${r?zA(e,Ut):`slice(${a.signals.visual})`}`:"")+(o!==void 0?`, extent_y: ${r?zA(e,Pn):`slice(${o.signals.visual})`}`:"")+"}"}]},{name:i+wW,value:{},on:[{events:u,update:`{x: ${s}.x - x(unit), y: ${s}.y - y(unit)}`}]}),a!==void 0&&D5(e,t,a,"width",n),o!==void 0&&D5(e,t,o,"height",n),n}};function D5(e,t,n,i,r){const s=t.name,a=s+_W,o=s+wW,u=n.channel,l=Co.defined(t),c=r.find(A=>A.name===n.signals[l?"data":"visual"]),f=e.getSizeSignalRef(i).signal,d=e.getScaleComponent(u),p=d&&d.get("type"),m=d&&d.get("reverse"),y=l?u===Ut?m?"":"-":m?"-":"":"",v=`${a}.extent_${u}`,b=`${y}${o}.${u} / ${l?`${f}`:`span(${v})`}`,_=!l||!d?"panLinear":p==="log"?"panLog":p==="symlog"?"panSymlog":p==="pow"?"panPow":"panLinear",E=l?p==="pow"?`, ${d.get("exponent")??1}`:p==="symlog"?`, ${d.get("constant")??1}`:"":"",S=`${_}(${v}, ${b}${E})`;c.on.push({events:{signal:o},update:l?S:`clampRange(${S}, 0, ${f})`})}const EW="_zoom_anchor",SW="_zoom_delta",G$e={defined:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const i=t.name,r=Co.defined(t),s=i+SW,{x:a,y:o}=t.project.hasChannel,u=le(e.scaleName(Ut)),l=le(e.scaleName(Pn));let c=nl(t.zoom,"scope");return r||(c=c.map(f=>(f.markname=i+Wf,f))),n.push({name:i+EW,on:[{events:c,update:r?"{"+[u?`x: invert(${u}, x(unit))`:"",l?`y: invert(${l}, y(unit))`:""].filter(f=>f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:s,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),a!==void 0&&P5(e,t,a,"width",n),o!==void 0&&P5(e,t,o,"height",n),n}};function P5(e,t,n,i,r){const s=t.name,a=n.channel,o=Co.defined(t),u=r.find(_=>_.name===n.signals[o?"data":"visual"]),l=e.getSizeSignalRef(i).signal,c=e.getScaleComponent(a),f=c&&c.get("type"),d=o?zA(e,a):u.name,p=s+SW,m=`${s}${EW}.${a}`,y=!o||!c?"zoomLinear":f==="log"?"zoomLog":f==="symlog"?"zoomSymlog":f==="pow"?"zoomPow":"zoomLinear",v=o?f==="pow"?`, ${c.get("exponent")??1}`:f==="symlog"?`, ${c.get("constant")??1}`:"":"",b=`${y}(${d}, ${m}, ${p}${v})`;u.on.push({events:{signal:p},update:o?b:`clampRange(${b}, 0, ${l})`})}const Sc="_store",No="_tuple",H$e="_modify",AW="vlSelectionResolve",Mb=[x$e,k$e,m$e,xW,vW,Co,bW,q$e,W$e,G$e,yW];function Y$e(e){let t=e.parent;for(;t&&!xr(t);)t=t.parent;return t}function tc(e,{escape:t}={escape:!0}){let n=t?le(e.name):e.name;const i=Y$e(e);if(i){const{facet:r}=i;for(const s of Wr)r[s]&&(n+=` + '__facet_${s}_' + (facet[${le(i.vgField(s))}])`)}return n}function pO(e){return Yn(e.component.selection??{}).reduce((t,n)=>t||n.project.hasSelectionId,!1)}function CW(e,t){(ge(t.select)||!t.select.on)&&delete e.events,(ge(t.select)||!t.select.clear)&&delete e.clear,(ge(t.select)||!t.select.toggle)&&delete e.toggle}function ya(e){return e.events?.find(t=>"type"in t&&t.type==="timer")}function UA(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...UA(e.object)),t.push(...UA(e.property))),t)}function kW(e){return e.object.type==="MemberExpression"?kW(e.object):e.object.name==="datum"}function $W(e){const t=N3(e),n=new Set;return t.visit(i=>{i.type==="MemberExpression"&&kW(i)&&n.add(UA(i).slice(1).join("."))}),n}class ed extends St{clone(){return new ed(null,this.model,De(this.filter))}constructor(t,n,i){super(t),this.model=n,this.filter=i,this.expr=kv(this.model,this.filter,this),this._dependentFields=$W(this.expr)}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function X$e(e,t){const n={},i=e.config.selection;if(!t||!t.length)return n;let r=0;for(const s of t){const a=Bt(s.name),o=s.select,u=ge(o)?o:o.type,l=de(o)?De(o):{type:u},c=i[u];for(const p in c)p==="fields"||p==="encodings"||(p==="mark"&&(l.mark={...c.mark,...l.mark}),(l[p]===void 0||l[p]===!0)&&(l[p]=De(c[p]??l[p])));const f=n[a]={...l,name:a,type:u,init:s.value,bind:s.bind,events:ge(l.on)?nl(l.on,"scope"):pe(De(l.on))};if(ya(f)&&(r++,r>1)){delete n[a];continue}const d=De(s);for(const p of Mb)p.defined(f)&&p.parse&&p.parse(e,f,d)}return r>1&&oe(dSe),n}function TW(e,t,n,i="datum"){const r=ge(t)?t:t.param,s=Bt(r),a=le(s+Sc);let o;try{o=e.getSelectionComponent(s,r)}catch{return`!!${s}`}if(o.project.timeUnit){const d=n??e.component.data.raw,p=o.project.timeUnit.clone();d.parent?p.insertAsParentOf(d):d.parent=p}const u=o.project.hasSelectionId?"vlSelectionIdTest(":"vlSelectionTest(",l=o.resolve==="global"?")":`, ${le(o.resolve)})`,c=`${u}${a}, ${i}${l}`,f=`length(data(${a}))`;return t.empty===!1?`${f} && ${c}`:`!${f} || ${c}`}function OW(e,t,n){const i=Bt(t),r=n.encoding;let s=n.field,a;try{a=e.getSelectionComponent(i,t)}catch{return i}if(!r&&!s)s=a.project.items[0].field,a.project.items.length>1&&oe(pSe(s));else if(r&&!s){const o=a.project.items.filter(u=>u.channel===r);!o.length||o.length>1?(s=a.project.items[0].field,oe(gSe(o,r,n,s))):s=o[0].field}return`${a.name}[${le(Zr(s))}]`}function K$e(e,t){for(const[n,i]of ju(e.component.selection??{})){const r=e.getName(`lookup_${n}`);e.component.data.outputNodes[r]=i.materialized=new Yi(new ed(t,e,{param:n}),r,Wt.Lookup,e.component.data.outputNodeRefCounts)}}function kv(e,t,n){return Hp(t,i=>ge(i)?i:SAe(i)?TW(e,i,n):Bq(i))}function J$e(e,t){if(e)return Q(e)&&!du(e)?e.map(n=>XT(n,t)).join(", "):e}function eE(e,t,n,i){var r,s;e.encode??(e.encode={}),(r=e.encode)[t]??(r[t]={}),(s=e.encode[t]).update??(s.update={}),e.encode[t].update[n]=i}function Fp(e,t,n,i={header:!1}){const{disable:r,orient:s,scale:a,labelExpr:o,title:u,zindex:l,...c}=e.combine();if(!r){for(const f in c){const d=f,p=TCe[d],m=c[d];if(p&&p!==t&&p!=="both")delete c[d];else if($0(m)){const{condition:y,...v}=m,b=pe(y),_=f5[d];if(_){const{vgProp:E,part:S}=_,A=[...b.map($=>{const{test:C,...M}=$;return{test:kv(null,C),...M}}),v];eE(c,S,E,A),delete c[d]}else if(_===null){const E={signal:b.map(S=>{const{test:A,...$}=S;return`${kv(null,A)} ? ${X6($)} : `}).join("")+X6(v)};c[d]=E}}else if(Ee(m)){const y=f5[d];if(y){const{vgProp:v,part:b}=y;eE(c,b,v,m),delete c[d]}}Ze(["labelAlign","labelBaseline"],d)&&c[d]===null&&delete c[d]}if(t==="grid"){if(!c.grid)return;if(c.encode){const{grid:f}=c.encode;c.encode={...f?{grid:f}:{}},Ct(c.encode)&&delete c.encode}return{scale:a,orient:s,...c,domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:on(l,0)}}else{if(!i.header&&e.mainExtracted)return;if(o!==void 0){let d=o;c.encode?.labels?.update&&Ee(c.encode.labels.update.text)&&(d=mc(o,"datum.label",c.encode.labels.update.text.signal)),eE(c,"labels","text",{signal:d})}if(c.labelAlign===null&&delete c.labelAlign,c.encode){for(const d of yV)e.hasAxisPart(d)||delete c.encode[d];Ct(c.encode)&&delete c.encode}const f=J$e(u,n);return{scale:a,orient:s,grid:!1,...f?{title:f}:{},...c,...n.aria===!1?{aria:!1}:{},zindex:on(l,0)}}}}function FW(e){const{axes:t}=e.component,n=[];for(const i of Wo)if(t[i]){for(const r of t[i])if(!r.get("disable")&&!r.get("gridScale")){const s=i==="x"?"height":"width",a=e.getSizeSignalRef(s).signal;s!==a&&n.push({name:s,update:a})}}return n}function Q$e(e,t){const{x:n=[],y:i=[]}=e;return[...n.map(r=>Fp(r,"grid",t)),...i.map(r=>Fp(r,"grid",t)),...n.map(r=>Fp(r,"main",t)),...i.map(r=>Fp(r,"main",t))].filter(r=>r)}function L5(e,t,n,i){return Object.assign.apply(null,[{},...e.map(r=>{if(r==="axisOrient"){const s=n==="x"?"bottom":"left",a=t[n==="x"?"axisBottom":"axisLeft"]||{},o=t[n==="x"?"axisTop":"axisRight"]||{},u=new Set([...re(a),...re(o)]),l={};for(const c of u.values())l[c]={signal:`${i.signal} === "${s}" ? ${Ss(a[c])} : ${Ss(o[c])}`};return l}return t[r]})])}function Z$e(e,t,n,i){const r=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:Vq(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],s=e==="x"?"axisX":"axisY",a=Ee(n)?"axisOrient":`axis${y0(n)}`,o=[...r,...r.map(l=>s+l.substr(4))],u=["axis",a,s];return{vlOnlyAxisConfig:L5(o,i,e,n),vgAxisConfig:L5(u,i,e,n),axisConfigStyle:e3e([...u,...o],i)}}function e3e(e,t){const n=[{}];for(const i of e){let r=t[i]?.style;if(r){r=pe(r);for(const s of r)n.push(t.style[s])}}return Object.assign.apply(null,n)}function jA(e,t,n,i={}){const r=vq(e,n,t);if(r!==void 0)return{configFrom:"style",configValue:r};for(const s of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(i[s]?.[e]!==void 0)return{configFrom:s,configValue:i[s][e]};return{}}const z5={scale:({model:e,channel:t})=>e.scaleName(t),format:({format:e})=>e,formatType:({formatType:e})=>e,grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>t.grid??t3e(n,e),gridScale:({model:e,channel:t})=>n3e(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelAlign||NW(t,n,i),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelBaseline||MW(t,n,i),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>e.labelFlush??r3e(t.type,n),labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>e.labelOverlap??s3e(t.type,n,ue(t)&&!!t.timeUnit,ue(t)?t.sort:void 0),orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:i,scaleType:r})=>{const s=e==="x"?"width":e==="y"?"height":void 0,a=s?t.getSizeSignalRef(s):void 0;return n.tickCount??o3e({fieldOrDatumDef:i,scaleType:r,size:a,values:n.values})},tickMinStep:u3e,title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const i=RW(t,n);if(i!==void 0)return i;const r=t.typedFieldDef(n),s=n==="x"?"x2":"y2",a=t.fieldDef(s);return bq(r?[l5(r)]:[],ue(a)?[l5(a)]:[])},values:({axis:e,fieldOrDatumDef:t})=>l3e(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>e.zindex??c3e(n,t)};function t3e(e,t){return!In(e)&&ue(t)&&!Nt(t?.bin)&&!Un(t?.bin)}function n3e(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function i3e(e,t,n,i,r){const s=t?.labelAngle;if(s!==void 0)return Ee(s)?s:Sg(s);{const{configValue:a}=jA("labelAngle",i,t?.style,r);return a!==void 0?Sg(a):n===Ut&&Ze([PT,DT],e.type)&&!(ue(e)&&e.timeUnit)?270:void 0}}function qA(e){return`(((${e.signal} % 360) + 360) % 360)`}function MW(e,t,n,i){if(e!==void 0)if(n==="x"){if(Ee(e)){const r=qA(e),s=Ee(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${r} && ${r} < 135) || (225 < ${r} && ${r} < 315) ? "middle" :(${r} <= 45 || 315 <= ${r}) === ${s} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(Ee(t)){const r=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${r} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(Ee(e)){const r=qA(e),s=Ee(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${r} <= 45 || 315 <= ${r} || (135 <= ${r} && ${r} <= 225) ? ${i?'"middle"':"null"} : (45 <= ${r} && ${r} <= 135) === ${s} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return i?"middle":null;if(Ee(t)){const r=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${r} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function NW(e,t,n){if(e===void 0)return;const i=n==="x",r=i?0:90,s=i?"bottom":"left";if(Ee(e)){const a=qA(e),o=Ee(t)?`(${t.signal} === "${s}")`:t===s;return{signal:`(${r?`(${a} + 90)`:a} % 180 === 0) ? ${i?null:'"center"'} :(${r} < ${a} && ${a} < ${180+r}) === ${o} ? "left" : "right"`}}if((e+r)%180===0)return i?null:"center";if(Ee(t)){const a=r<e&&e<180+r?"===":"!==";return{signal:`${`${t.signal} ${a} "${s}"`} ? "left" : "right"`}}return(r<e&&e<180+r)==(t===s)?"left":"right"}function r3e(e,t){if(t==="x"&&Ze(["quantitative","temporal"],e))return!0}function s3e(e,t,n,i){if(n&&!de(i)||e!=="nominal"&&e!=="ordinal")return t==="log"||t==="symlog"?"greedy":!0}function a3e(e){return e==="x"?"bottom":"left"}function o3e({fieldOrDatumDef:e,scaleType:t,size:n,values:i}){if(!i&&!In(t)&&t!=="log"){if(ue(e)){if(Nt(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&Ze(["month","hours","day","quarter"],Rn(e.timeUnit)?.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function u3e({format:e,fieldOrDatumDef:t}){if(e==="d")return 1;if(ue(t)){const{timeUnit:n}=t;if(n){const i=Pq(n);if(i)return{signal:i}}}}function RW(e,t){const n=t==="x"?"x2":"y2",i=e.fieldDef(t),r=e.fieldDef(n),s=i?i.title:void 0,a=r?r.title:void 0;if(s&&a)return _q(s,a);if(s)return s;if(a)return a;if(s!==void 0)return s;if(a!==void 0)return a}function l3e(e,t){const n=e.values;if(Q(n))return mV(t,n);if(Ee(n))return n}function c3e(e,t){return e==="rect"&&bv(t)?1:0}class Ch extends St{clone(){return new Ch(null,De(this.transform))}constructor(t,n){super(t),this.transform=n,this._dependentFields=$W(this.transform.calculate)}static parseAllForSortIndex(t,n){return n.forEachFieldDef((i,r)=>{if(jc(i)&&aV(i.sort)){const{field:s,timeUnit:a}=i,o=i.sort,u=o.map((l,c)=>`${Bq({field:s,timeUnit:a,equal:l})} ? ${c} : `).join("")+o.length;t=new Ch(t,{calculate:u,as:kh(i,r,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${nt(this.transform)}`}}function kh(e,t,n){return fe(e,{prefix:t,suffix:"sort_index",...n})}function Nb(e,t){return Ze(["top","bottom"],t)?"column":Ze(["left","right"],t)||e==="row"?"row":"column"}function $h(e,t,n,i){const r=i==="row"?n.headerRow:i==="column"?n.headerColumn:n.headerFacet;return on((t||{})[e],r[e],n.header[e])}function Rb(e,t,n,i){const r={};for(const s of e){const a=$h(s,t||{},n,i);a!==void 0&&(r[s]=a)}return r}const gO=["row","column"],mO=["header","footer"];function f3e(e,t){const n=e.component.layoutHeaders[t].title,i=e.config?e.config:void 0,r=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:s,titleAngle:a,titleOrient:o}=Rb(["titleAnchor","titleAngle","titleOrient"],r.header,i,t),u=Nb(t,o),l=Sg(a);return{name:`${t}-title`,type:"group",role:`${u}-title`,title:{text:n,...t==="row"?{orient:"left"}:{},style:"guide-title",...DW(l,u),...IW(u,l,s),...PW(i,r,t,JCe,IV)}}}function IW(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const i=NW(t,e==="row"?"left":"top",e==="row"?"y":"x");return i?{align:i}:{}}function DW(e,t){const n=MW(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function h3e(e,t){const n=e.component.layoutHeaders[t],i=[];for(const r of mO)if(n[r])for(const s of n[r]){const a=p3e(e,t,r,n,s);a!=null&&i.push(a)}return i}function d3e(e,t){const{sort:n}=e;return Ao(n)?{field:fe(n,{expr:"datum"}),order:n.order??"ascending"}:Q(n)?{field:kh(e,t,{expr:"datum"}),order:"ascending"}:{field:fe(e,{expr:"datum"}),order:n??"ascending"}}function VA(e,t,n){const{format:i,formatType:r,labelAngle:s,labelAnchor:a,labelOrient:o,labelExpr:u}=Rb(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),l=WT({fieldOrDatumDef:e,format:i,formatType:r,expr:"parent",config:n}).signal,c=Nb(t,o);return{text:{signal:u?mc(mc(u,"datum.label",l),"datum.value",fe(e,{expr:"parent"})):l},...t==="row"?{orient:"left"}:{},style:"guide-label",frame:"group",...DW(s,c),...IW(c,s,a),...PW(n,e,t,QCe,DV)}}function p3e(e,t,n,i,r){if(r){let s=null;const{facetFieldDef:a}=i,o=e.config?e.config:void 0;if(a&&r.labels){const{labelOrient:f}=Rb(["labelOrient"],a.header,o,t);(t==="row"&&!Ze(["top","bottom"],f)||t==="column"&&!Ze(["left","right"],f))&&(s=VA(a,t,o))}const u=xr(e)&&!S0(e.facet),l=r.axes,c=l?.length>0;if(s||c){const f=t==="row"?"height":"width";return{name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`,...i.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:d3e(a,t)}:{},...c&&u?{from:{data:e.getName(`facet_domain_${t}`)}}:{},...s?{title:s}:{},...r.sizeSignal?{encode:{update:{[f]:r.sizeSignal}}}:{},...c?{axes:l}:{}}}}return null}const g3e={column:{start:0,end:1},row:{start:1,end:0}};function m3e(e,t){return g3e[t][e]}function y3e(e,t){const n={};for(const i of Wr){const r=e[i];if(r?.facetFieldDef){const{titleAnchor:s,titleOrient:a}=Rb(["titleAnchor","titleOrient"],r.facetFieldDef.header,t,i),o=Nb(i,a),u=m3e(s,o);u!==void 0&&(n[o]=u)}}return Ct(n)?void 0:n}function PW(e,t,n,i,r){const s={};for(const a of i){if(!r[a])continue;const o=$h(a,t?.header,e,n);o!==void 0&&(s[r[a]]=o)}return s}function yO(e){return[...c1(e,"width"),...c1(e,"height"),...c1(e,"childWidth"),...c1(e,"childHeight")]}function c1(e,t){const n=t==="width"?"x":"y",i=e.component.layoutSize.get(t);if(!i||i==="merged")return[];const r=e.getSizeSignalRef(t).signal;if(i==="step"){const s=e.getScaleComponent(n);if(s){const a=s.get("type"),o=s.get("range");if(In(a)&&zc(o)){const u=e.scaleName(n);return xr(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[B5(u,o)]:[B5(u,o),{name:r,update:LW(u,s,`domain('${u}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(i=="container"){const s=r.endsWith("width"),a=s?"containerSize()[0]":"containerSize()[1]",o=NA(e.config.view,s?"width":"height"),u=`isFinite(${a}) ? ${a} : ${o}`;return[{name:r,init:u,on:[{update:u,events:"window:resize"}]}]}else return[{name:r,value:i}]}function B5(e,t){const n=`${e}_step`;return Ee(t.step)?{name:n,update:t.step.signal}:{name:n,value:t.step}}function LW(e,t,n){const i=t.get("type"),r=t.get("padding"),s=on(t.get("paddingOuter"),r);let a=t.get("paddingInner");return a=i==="band"?a!==void 0?a:r:1,`bandspace(${n}, ${Ss(a)}, ${Ss(s)}) * ${e}_step`}function zW(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function BW(e,t){return re(e).reduce((n,i)=>({...n,...Zh({model:t,channelDef:e[i],vgChannel:i,mainRefFn:r=>Dt(r.value),invalidValueRef:void 0})}),{})}function UW(e,t){if(xr(t))return e==="theta"?"independent":"shared";if(id(t))return"shared";if(SO(t))return un(e)||e==="theta"||e==="radius"?"independent":"shared";throw new Error("invalid model type for resolve")}function vO(e,t){const n=e.scale[t],i=un(t)?"axis":"legend";return n==="independent"?(e[i][t]==="shared"&&oe(GSe(t)),"independent"):e[i][t]||"shared"}const v3e={...tke,disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1},jW=re(v3e);class x3e extends Ho{}const U5={symbols:b3e,gradient:_3e,labels:w3e,entries:E3e};function b3e(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r,legendType:s}){if(s!=="symbol")return;const{markDef:a,encoding:o,config:u,mark:l}=n,c=a.filled&&l!=="trail";let f={...eSe({},n,KAe),...pW(n,{filled:c})};const d=r.get("symbolOpacity")??u.legend.symbolOpacity,p=r.get("symbolFillColor")??u.legend.symbolFillColor,m=r.get("symbolStrokeColor")??u.legend.symbolStrokeColor,y=d===void 0?qW(o.opacity)??a.opacity:void 0;if(f.fill){if(i==="fill"||c&&i===Qi)delete f.fill;else if(se(f.fill,"field"))p?delete f.fill:(f.fill=Dt(u.legend.symbolBaseFillColor??"black"),f.fillOpacity=Dt(y??1));else if(Q(f.fill)){const v=WA(o.fill??o.color)??a.fill??(c&&a.color);v&&(f.fill=Dt(v))}}if(f.stroke){if(i==="stroke"||!c&&i===Qi)delete f.stroke;else if(se(f.stroke,"field")||m)delete f.stroke;else if(Q(f.stroke)){const v=on(WA(o.stroke||o.color),a.stroke,c?a.color:void 0);v&&(f.stroke={value:v})}}if(i!==Vo){const v=ue(t)&&WW(n,r,t);v?f.opacity=[{test:v,...Dt(y??1)},Dt(u.legend.unselectedOpacity)]:y&&(f.opacity=Dt(y))}return f={...f,...e},Ct(f)?void 0:f}function _3e(e,{model:t,legendType:n,legendCmpt:i}){if(n!=="gradient")return;const{config:r,markDef:s,encoding:a}=t;let o={};const l=(i.get("gradientOpacity")??r.legend.gradientOpacity)===void 0?qW(a.opacity)||s.opacity:void 0;return l&&(o.opacity=Dt(l)),o={...o,...e},Ct(o)?void 0:o}function w3e(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r}){const s=n.legend(i)||{},a=n.config,o=ue(t)?WW(n,r,t):void 0,u=o?[{test:o,value:1},{value:a.legend.unselectedOpacity}]:void 0,{format:l,formatType:c}=s;let f;wc(c)?f=As({fieldOrDatumDef:t,field:"datum.value",format:l,formatType:c,config:a}):l===void 0&&c===void 0&&a.customFormatTypes&&(t.type==="quantitative"&&a.numberFormatType?f=As({fieldOrDatumDef:t,field:"datum.value",format:a.numberFormat,formatType:a.numberFormatType,config:a}):t.type==="temporal"&&a.timeFormatType&&ue(t)&&t.timeUnit===void 0&&(f=As({fieldOrDatumDef:t,field:"datum.value",format:a.timeFormat,formatType:a.timeFormatType,config:a})));const d={...u?{opacity:u}:{},...f?{text:f}:{},...e};return Ct(d)?void 0:d}function E3e(e,{legendCmpt:t}){return t.get("selections")?.length?{...e,fill:{value:"transparent"}}:e}function qW(e){return VW(e,(t,n)=>Math.max(t,n.value))}function WA(e){return VW(e,(t,n)=>on(t,n.value))}function VW(e,t){if(yCe(e))return pe(e.condition).reduce(t,e.value);if(Rs(e))return e.value}function WW(e,t,n){const i=t.get("selections");if(!i?.length)return;const r=le(n.field);return i.map(s=>`(!length(data(${le(Bt(s)+Sc)})) || (${s}[${r}] && indexof(${s}[${r}], datum.value) >= 0))`).join(" || ")}const j5={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:i,formatType:r}=t;return iV(e,e.type,i,r,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return rV(i,t,n)},gradientLength:e=>{const{legend:t,legendConfig:n}=e;return t.gradientLength??n.gradientLength??O3e(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>e.labelOverlap??t.labelOverlap??F3e(n),symbolType:({legend:e,markDef:t,channel:n,encoding:i})=>e.symbolType??A3e(t.type,n,i.shape,t.shape),title:({fieldOrDatumDef:e,config:t})=>Vf(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(qf(n)&&ha(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>S3e(t,e)};function S3e(e,t){const n=e.values;if(Q(n))return mV(t,n);if(Ee(n))return n}function A3e(e,t,n,i){if(t!=="shape"){const r=WA(n)??i;if(r)return r}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function C3e(e){const{legend:t}=e;return on(t.type,k3e(e))}function k3e({channel:e,timeUnit:t,scaleType:n}){if(qf(e)){if(Ze(["quarter","month","day"],t))return"symbol";if(ha(n))return"gradient"}return"symbol"}function $3e({legendConfig:e,legendType:t,orient:n,legend:i}){return i.direction??e[t?"gradientDirection":"symbolDirection"]??T3e(n,t)}function T3e(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function O3e({legendConfig:e,model:t,direction:n,orient:i,scaleType:r}){const{gradientHorizontalMaxLength:s,gradientHorizontalMinLength:a,gradientVerticalMaxLength:o,gradientVerticalMinLength:u}=e;if(ha(r))return n==="horizontal"?i==="top"||i==="bottom"?q5(t,"width",a,s):a:q5(t,"height",u,o)}function q5(e,t,n,i){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${i})`}}function F3e(e){if(Ze(["quantile","threshold","log","symlog"],e))return"greedy"}function GW(e){const t=Vt(e)?M3e(e):D3e(e);return e.component.legends=t,t}function M3e(e){const{encoding:t}=e,n={};for(const i of[Qi,...LV]){const r=wn(t[i]);!r||!e.getScaleComponent(i)||i===Zi&&ue(r)&&r.type===Qh||(n[i]=I3e(e,i))}return n}function N3e(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function R3e(e,t,n,i){switch(t){case"disable":return n!==void 0;case"values":return!!n?.values;case"title":if(t==="title"&&e===i?.title)return!0}return e===(n||{})[t]}function I3e(e,t){let n=e.legend(t);const{markDef:i,encoding:r,config:s}=e,a=s.legend,o=new x3e({},N3e(e,t));V$e(e,t,o);const u=n!==void 0?!n:a.disable;if(o.set("disable",u,n!==void 0),u)return o;n=n||{};const l=e.getScaleComponent(t).get("type"),c=wn(r[t]),f=ue(c)?Rn(c.timeUnit)?.unit:void 0,d=n.orient||s.legend.orient||"right",p=C3e({legend:n,channel:t,timeUnit:f,scaleType:l}),m=$3e({legend:n,legendType:p,orient:d,legendConfig:a}),y={legend:n,channel:t,model:e,markDef:i,encoding:r,fieldOrDatumDef:c,legendConfig:a,config:s,scaleType:l,orient:d,legendType:p,direction:m};for(const S of jW){if(p==="gradient"&&S.startsWith("symbol")||p==="symbol"&&S.startsWith("gradient"))continue;const A=S in j5?j5[S](y):n[S];if(A!==void 0){const $=R3e(A,S,n,e.fieldDef(t));($||s.legend[S]===void 0)&&o.set(S,A,$)}}const v=n?.encoding??{},b=o.get("selections"),_={},E={fieldOrDatumDef:c,model:e,channel:t,legendCmpt:o,legendType:p};for(const S of["labels","legend","title","symbols","gradient","entries"]){const A=BW(v[S]??{},e),$=S in U5?U5[S](A,E):A;$!==void 0&&!Ct($)&&(_[S]={...b?.length&&ue(c)?{name:`${Bt(c.field)}_legend_${S}`}:{},...b?.length?{interactive:!!b}:{},update:$})}return Ct(_)||o.set("encode",_,!!n?.encoding),o}function D3e(e){const{legends:t,resolve:n}=e.component;for(const i of e.children){GW(i);for(const r of re(i.component.legends))n.legend[r]=vO(e.component.resolve,r),n.legend[r]==="shared"&&(t[r]=HW(t[r],i.component.legends[r]),t[r]||(n.legend[r]="independent",delete t[r]))}for(const i of re(t))for(const r of e.children)r.component.legends[i]&&n.legend[i]==="shared"&&delete r.component.legends[i];return t}function HW(e,t){if(!e)return t.clone();const n=e.getWithExplicit("orient"),i=t.getWithExplicit("orient");if(n.explicit&&i.explicit&&n.value!==i.value)return;let r=!1;for(const s of jW){const a=Wu(e.getWithExplicit(s),t.getWithExplicit(s),s,"legend",(o,u)=>{switch(s){case"symbolType":return P3e(o,u);case"title":return wq(o,u);case"type":return r=!0,lr("symbol")}return $b(o,u,s,"legend")});e.setWithExplicit(s,a)}return r&&(e.implicit?.encode?.gradient&&gv(e.implicit,["encode","gradient"]),e.explicit?.encode?.gradient&&gv(e.explicit,["encode","gradient"])),e}function P3e(e,t){return t.value==="circle"?t:e}function L3e(e,t,n,i){var r,s;e.encode??(e.encode={}),(r=e.encode)[t]??(r[t]={}),(s=e.encode[t]).update??(s.update={}),e.encode[t].update[n]=i}function YW(e){const t=e.component.legends,n={};for(const r of re(t)){const s=e.getScaleComponent(r),a=kt(s.get("domains"));if(n[a])for(const o of n[a])HW(o,t[r])||n[a].push(t[r]);else n[a]=[t[r].clone()]}return Yn(n).flat().map(r=>z3e(r,e.config)).filter(r=>r!==void 0)}function z3e(e,t){const{disable:n,labelExpr:i,selections:r,...s}=e.combine();if(!n){if(t.aria===!1&&s.aria==null&&(s.aria=!1),s.encode?.symbols){const a=s.encode.symbols.update;a.fill&&a.fill.value!=="transparent"&&!a.stroke&&!s.stroke&&(a.stroke={value:"transparent"});for(const o of LV)s[o]&&delete a[o]}if(s.title||delete s.title,i!==void 0){let a=i;s.encode?.labels?.update&&Ee(s.encode.labels.update.text)&&(a=mc(i,"datum.label",s.encode.labels.update.text.signal)),L3e(s,"labels","text",{signal:a})}return s}}function B3e(e){return id(e)||SO(e)?U3e(e):XW(e)}function U3e(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),XW(e))}function XW(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:i}=n;if(t.data){const r={signal:`[${t.size.map(a=>a.signal).join(", ")}]`},s=t.data.reduce((a,o)=>{const u=Ee(o)?o.signal:`data('${e.lookupDataSource(o)}')`;return Ze(a,u)||a.push(u),a},[]);if(s.length<=0)throw new Error("Projection's fit didn't find any data sources");return[{name:i,size:r,fit:{signal:s.length>1?`[${s.join(", ")}]`:s[0]},...n}]}else return[{name:i,translate:{signal:"[width / 2, height / 2]"},...n}]}const j3e=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class KW extends Ho{constructor(t,n,i,r){super({...n},{name:t}),this.specifiedProjection=n,this.size=i,this.data=r,this.merged=!1}get isFit(){return!!this.data}}function JW(e){e.component.projection=Vt(e)?q3e(e):G3e(e)}function q3e(e){if(e.hasProjection){const t=jn(e.specifiedProjection),n=!(t&&(t.scale!=null||t.translate!=null)),i=n?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,r=n?V3e(e):void 0,s=new KW(e.projectionName(!0),{...jn(e.config.projection),...t},i,r);return s.get("type")||s.set("type","equalEarth",!1),s}}function V3e(e){const t=[],{encoding:n}=e;for(const i of[[Vs,qs],[es,Ws]])(wn(n[i[0]])||wn(n[i[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(Zi)&&e.typedFieldDef(Zi).type===Qh&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(Wt.Main)),t}function W3e(e,t){const n=lT(j3e,r=>!!(!ve(e.explicit,r)&&!ve(t.explicit,r)||ve(e.explicit,r)&&ve(t.explicit,r)&&gr(e.get(r),t.get(r))));if(gr(e.size,t.size)){if(n)return e;if(gr(e.explicit,{}))return t;if(gr(t.explicit,{}))return e}return null}function G3e(e){if(e.children.length===0)return;let t;for(const i of e.children)JW(i);const n=lT(e.children,i=>{const r=i.component.projection;if(r)if(t){const s=W3e(t,r);return s&&(t=s),!!s}else return t=r,!0;else return!0});if(t&&n){const i=e.projectionName(!0),r=new KW(i,t.specifiedProjection,t.size,De(t.data));for(const s of e.children){const a=s.component.projection;a&&(a.isFit&&r.data.push(...s.component.projection.data),s.renameProjection(a.get("name"),i),a.merged=!0)}return r}}function H3e(e,t,n,i){if(k0(t,n)){const r=Vt(e)?e.axis(n)??e.legend(n)??{}:{},s=fe(t,{expr:"datum"}),a=fe(t,{expr:"datum",binSuffix:"end"});return{formulaAs:fe(t,{binSuffix:"range",forAs:!0}),formula:E0(s,a,r.format,r.formatType,i)}}return{}}function QW(e,t){return`${pq(e)}_${t}`}function Y3e(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function xO(e,t,n){const i=wb(n,void 0)??{},r=QW(i,t);return e.getName(`${r}_bins`)}function X3e(e){return"as"in e}function V5(e,t,n){let i,r;X3e(e)?i=ge(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:i=[fe(e,{forAs:!0}),fe(e,{binSuffix:"end",forAs:!0})];const s={...wb(t,void 0)},a=QW(s,e.field),{signal:o,extentSignal:u}=Y3e(n,a);if(fb(s.extent)){const c=s.extent;r=OW(n,c.param,c),delete s.extent}const l={bin:s,field:e.field,as:[i],...o?{signal:o}:{},...u?{extentSignal:u}:{},...r?{span:r}:{}};return{key:a,binComponent:l}}class va extends St{clone(){return new va(null,De(this.bins))}constructor(t,n){super(t),this.bins=n}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,s,a)=>{if(Fi(s)&&Nt(s.bin)){const{key:o,binComponent:u}=V5(s,s.bin,n);r[o]={...u,...r[o],...H3e(n,s,a,n.config)}}return r},{});return Ct(i)?null:new va(t,i)}static makeFromTransform(t,n,i){const{key:r,binComponent:s}=V5(n,n.bin,i);return new va(t,{[r]:s})}merge(t,n){for(const i of re(t.bins))i in this.bins?(n(t.bins[i].signal,this.bins[i].signal),this.bins[i].as=fa([...this.bins[i].as,...t.bins[i].as],nt)):this.bins[i]=t.bins[i];for(const i of t.children)t.removeChild(i),i.parent=this;t.remove()}producedFields(){return new Set(Yn(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(Yn(this.bins).map(t=>t.field))}hash(){return`Bin ${nt(this.bins)}`}assemble(){return Yn(this.bins).flatMap(t=>{const n=[],[i,...r]=t.as,{extent:s,...a}=t.bin,o={type:"bin",field:Zr(t.field),as:i,signal:t.signal,...fb(s)?{extent:null}:{extent:s},...t.span?{span:{signal:`span(${t.span})`}}:{},...a};!s&&t.extentSignal&&(n.push({type:"extent",field:Zr(t.field),signal:t.extentSignal}),o.extent={signal:t.extentSignal}),n.push(o);for(const u of r)for(let l=0;l<2;l++)n.push({type:"formula",expr:fe({field:i[l]},{expr:"datum"}),as:u[l]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}function K3e(e,t,n,i){const r=Vt(i)?i.encoding[za(t)]:void 0;if(Fi(n)&&Vt(i)&&uV(n,r,i.markDef,i.config)){e.add(fe(n,{})),e.add(fe(n,{suffix:"end"}));const{mark:s,markDef:a,config:o}=i,u=Vu({fieldDef:n,markDef:a,config:o});Ag(s)&&u!==.5&&un(t)&&(e.add(fe(n,{suffix:Tb})),e.add(fe(n,{suffix:Ob}))),n.bin&&k0(n,t)&&e.add(fe(n,{binSuffix:"range"}))}else if(sq(t)){const s=rq(t);e.add(i.getName(s))}else e.add(fe(n));return jc(n)&&PAe(n.scale?.range)&&e.add(n.scale.range.field),e}function J3e(e,t){for(const n of re(t)){const i=t[n];for(const r of re(i))n in e?e[n][r]=new Set([...e[n][r]??[],...i[r]]):e[n]={[r]:i[r]}}}class $s extends St{clone(){return new $s(null,new Set(this.dimensions),De(this.measures))}constructor(t,n,i){super(t),this.dimensions=n,this.measures=i}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let i=!1;n.forEachFieldDef(a=>{a.aggregate&&(i=!0)});const r={},s=new Set;return!i||(n.forEachFieldDef((a,o)=>{const{aggregate:u,field:l}=a;if(u)if(u==="count")r["*"]??(r["*"]={}),r["*"].count=new Set([fe(a,{forAs:!0})]);else{if(Fo(u)||ll(u)){const c=Fo(u)?"argmin":"argmax",f=u[c];r[f]??(r[f]={}),r[f][c]=new Set([fe({op:c,field:f},{forAs:!0})])}else r[l]??(r[l]={}),r[l][u]=new Set([fe(a,{forAs:!0})]);Ba(o)&&n.scaleDomain(o)==="unaggregated"&&(r[l]??(r[l]={}),r[l].min=new Set([fe({field:l,aggregate:"min"},{forAs:!0})]),r[l].max=new Set([fe({field:l,aggregate:"max"},{forAs:!0})]))}else K3e(s,o,a,n)}),s.size+re(r).length===0)?null:new $s(t,s,r)}static makeFromTransform(t,n){var i;const r=new Set,s={};for(const a of n.aggregate){const{op:o,field:u,as:l}=a;o&&(o==="count"?(s["*"]??(s["*"]={}),s["*"].count=new Set([l||fe(a,{forAs:!0})])):(s[u]??(s[u]={}),(i=s[u])[o]??(i[o]=new Set),s[u][o].add(l||fe(a,{forAs:!0}))))}for(const a of n.groupby??[])r.add(a);return r.size+re(s).length===0?null:new $s(t,r,s)}merge(t){return Kj(this.dimensions,t.dimensions)?(J3e(this.measures,t.measures),!0):(uAe("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...re(this.measures)])}producedFields(){const t=new Set;for(const n of re(this.measures))for(const i of re(this.measures[n])){const r=this.measures[n][i];r.size===0?t.add(`${i}_${n}`):r.forEach(t.add,t)}return t}hash(){return`Aggregate ${nt({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],i=[];for(const s of re(this.measures))for(const a of re(this.measures[s]))for(const o of this.measures[s][a])i.push(o),t.push(a),n.push(s==="*"?null:Zr(s));return{type:"aggregate",groupby:[...this.dimensions].map(Zr),ops:t,fields:n,as:i}}}class td extends St{constructor(t,n,i,r){super(t),this.model=n,this.name=i,this.data=r;for(const s of Wr){const a=n.facet[s];if(a){const{bin:o,sort:u}=a;this[s]={name:n.getName(`${s}_domain`),fields:[fe(a),...Nt(o)?[fe(a,{binSuffix:"end"})]:[]],...Ao(u)?{sortField:u}:Q(u)?{sortIndexField:kh(a,s)}:{}}}}this.childModel=n.child}hash(){let t="Facet";for(const n of Wr)this[n]&&(t+=` ${n.charAt(0)}:${nt(this[n])}`);return t}get fields(){const t=[];for(const n of Wr)this[n]?.fields&&t.push(...this[n].fields);return t}dependentFields(){const t=new Set(this.fields);for(const n of Wr)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of Wo){const i=this.childModel.component.scales[n];if(i&&!i.merged){const r=i.get("type"),s=i.get("range");if(In(r)&&zc(s)){const a=Ib(this.childModel,n),o=EO(a);o?t[n]=o:oe(ET(n))}}}return t}assembleRowColumnHeaderData(t,n,i){const r={row:"y",column:"x",facet:void 0}[t],s=[],a=[],o=[];r&&i&&i[r]&&(n?(s.push(`distinct_${i[r]}`),a.push("max")):(s.push(i[r]),a.push("distinct")),o.push(`distinct_${i[r]}`));const{sortField:u,sortIndexField:l}=this[t];if(u){const{op:c=xb,field:f}=u;s.push(f),a.push(c),o.push(fe(u,{forAs:!0}))}else l&&(s.push(l),a.push("max"),o.push(l));return{name:this[t].name,source:n??this.data,transform:[{type:"aggregate",groupby:this[t].fields,...s.length?{fields:s,ops:a,as:o}:{}}]}}assembleFacetHeaderData(t){const{columns:n}=this.model.layout,{layoutHeaders:i}=this.model.component,r=[],s={};for(const u of gO){for(const l of mO){const c=(i[u]&&i[u][l])??[];for(const f of c)if(f.axes?.length>0){s[u]=!0;break}}if(s[u]){const l=`length(data("${this.facet.name}"))`,c=u==="row"?n?{signal:`ceil(${l} / ${n})`}:1:n?{signal:`min(${l}, ${n})`}:{signal:l};r.push({name:`${this.facet.name}_${u}`,transform:[{type:"sequence",start:0,stop:c}]})}}const{row:a,column:o}=s;return(a||o)&&r.unshift(this.assembleRowColumnHeaderData("facet",null,t)),r}assemble(){const t=[];let n=null;const i=this.getChildIndependentFieldsWithStep(),{column:r,row:s,facet:a}=this;if(r&&s&&(i.x||i.y)){n=`cross_${this.column.name}_${this.row.name}`;const o=[].concat(i.x??[],i.y??[]),u=o.map(()=>"distinct");t.push({name:n,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:o,ops:u}]})}for(const o of[So,Eo])this[o]&&t.push(this.assembleRowColumnHeaderData(o,n,i));if(a){const o=this.assembleFacetHeaderData(i);o&&t.push(...o)}return t}}function W5(e){return e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e}function Q3e(e,t){const n=hT(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.startsWith("date:")){const i=W5(t.slice(5,t.length));return`timeParse(${n},'${i}')`}else if(t.startsWith("utc:")){const i=W5(t.slice(4,t.length));return`utcParse(${n},'${i}')`}else return oe(ySe(t)),null}function Z3e(e){const t={};return Y1(e.filter,n=>{if(zq(n)){let i=null;TT(n)?i=hr(n.equal):FT(n)?i=hr(n.lte):OT(n)?i=hr(n.lt):MT(n)?i=hr(n.gt):NT(n)?i=hr(n.gte):RT(n)?i=n.range[0]:IT(n)&&(i=(n.oneOf??n.in)[0]),i&&(Bc(i)?t[n.field]="date":dt(i)?t[n.field]="number":ge(i)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function eTe(e){const t={};function n(i){Eh(i)?t[i.field]="date":i.type==="quantitative"&&WEe(i.aggregate)?t[i.field]="number":yh(i.field)>1?i.field in t||(t[i.field]="flatten"):jc(i)&&Ao(i.sort)&&yh(i.sort.field)>1&&(i.sort.field in t||(t[i.sort.field]="flatten"))}if((Vt(e)||xr(e))&&e.forEachFieldDef((i,r)=>{if(Fi(i))n(i);else{const s=Pc(r),a=e.fieldDef(s);n({...i,type:a.type})}}),Vt(e)){const{mark:i,markDef:r,encoding:s}=e;if(cl(i)&&!e.encoding.order){const a=r.orient==="horizontal"?"y":"x",o=s[a];ue(o)&&o.type==="quantitative"&&!(o.field in t)&&(t[o.field]="number")}}return t}function tTe(e){const t={};if(Vt(e)&&e.component.selection)for(const n of re(e.component.selection)){const i=e.component.selection[n];for(const r of i.project.items)!r.channel&&yh(r.field)>1&&(t[r.field]="flatten")}return t}class oi extends St{clone(){return new oi(null,De(this._parse))}constructor(t,n){super(t),this._parse=n}hash(){return`Parse ${nt(this._parse)}`}static makeExplicit(t,n,i){let r={};const s=n.data;return!Ou(s)&&s?.format?.parse&&(r=s.format.parse),this.makeWithAncestors(t,r,{},i)}static makeWithAncestors(t,n,i,r){for(const o of re(i)){const u=r.getWithExplicit(o);u.value!==void 0&&(u.explicit||u.value===i[o]||u.value==="derived"||i[o]==="flatten"?delete i[o]:oe(t5(o,i[o],u.value)))}for(const o of re(n)){const u=r.get(o);u!==void 0&&(u===n[o]?delete n[o]:oe(t5(o,n[o],u)))}const s=new Ho(n,i);r.copyAll(s);const a={};for(const o of re(s.combine())){const u=s.get(o);u!==null&&(a[o]=u)}return re(a).length===0||r.parseNothing?null:new oi(t,a)}get parse(){return this._parse}merge(t){this._parse={...this._parse,...t.parse},t.remove()}assembleFormatParse(){const t={};for(const n of re(this._parse)){const i=this._parse[n];yh(n)===1&&(t[n]=i)}return t}producedFields(){return new Set(re(this._parse))}dependentFields(){return new Set(re(this._parse))}assembleTransforms(t=!1){return re(this._parse).filter(n=>t?yh(n)>1:!0).map(n=>{const i=Q3e(n,this._parse[n]);return i?{type:"formula",expr:i,as:Kh(n)}:null}).filter(n=>n!==null)}}class Gu extends St{clone(){return new Gu(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([Ds])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:Ds}}}class O0 extends St{clone(){return new O0(null,this.params)}constructor(t,n){super(t),this.params=n}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${nt(this.params)}`}assemble(){return{type:"graticule",...this.params===!0?{}:this.params}}}class F0 extends St{clone(){return new F0(null,this.params)}constructor(t,n){super(t),this.params=n}dependentFields(){return new Set}producedFields(){return new Set([this.params.as??"data"])}hash(){return`Hash ${nt(this.params)}`}assemble(){return{type:"sequence",...this.params}}}class Ac extends St{constructor(t){super(null),t??(t={name:"source"});let n;if(Ou(t)||(n=t.format?{...Hi(t.format,["parse"])}:{}),Cg(t))this._data={values:t.values};else if(Sh(t)){if(this._data={url:t.url},!n.type){let i=/(?:\.([^.]+))?$/.exec(t.url)[1];Ze(["json","csv","tsv","dsv","topojson"],i)||(i="json"),n.type=i}}else nW(t)?this._data={values:[{type:"Sphere"}]}:(eW(t)||Ou(t))&&(this._data={});this._generator=Ou(t),t.name&&(this._name=t.name),n&&!Ct(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return{name:this._name,...this._data,transform:[]}}}var G5=function(e,t,n,i,r){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?r.call(e,n):r?r.value=n:t.set(e,n),n},nTe=function(e,t,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(e):i?i.value:t.get(e)},Mp;function bO(e){return e instanceof Ac||e instanceof O0||e instanceof F0}class _O{constructor(){Mp.set(this,void 0),G5(this,Mp,!1,"f")}setModified(){G5(this,Mp,!0,"f")}get modifiedFlag(){return nTe(this,Mp,"f")}}Mp=new WeakMap;class qc extends _O{getNodeDepths(t,n,i){i.set(t,n);for(const r of t.children)this.getNodeDepths(r,n+1,i);return i}optimize(t){const i=[...this.getNodeDepths(t,0,new Map).entries()].sort((r,s)=>s[1]-r[1]);for(const r of i)this.run(r[0]);return this.modifiedFlag}}class wO extends _O{optimize(t){this.run(t);for(const n of t.children)this.optimize(n);return this.modifiedFlag}}class iTe extends wO{mergeNodes(t,n){const i=n.shift();for(const r of n)t.removeChild(r),r.parent=i,r.remove()}run(t){const n=t.children.map(r=>r.hash()),i={};for(let r=0;r<n.length;r++)i[n[r]]===void 0?i[n[r]]=[t.children[r]]:i[n[r]].push(t.children[r]);for(const r of re(i))i[r].length>1&&(this.setModified(),this.mergeNodes(t,i[r]))}}class rTe extends wO{constructor(t){super(),this.requiresSelectionId=t&&pO(t)}run(t){t instanceof Gu&&(this.requiresSelectionId&&(bO(t.parent)||t.parent instanceof $s||t.parent instanceof oi)||(this.setModified(),t.remove()))}}class sTe extends _O{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,n){let i=new Set;t instanceof ma&&(i=t.producedFields(),cT(i,n)&&(this.setModified(),t.removeFormulas(n),t.producedFields.length===0&&t.remove()));for(const r of t.children)this.run(r,new Set([...n,...i]))}}class aTe extends wO{constructor(){super()}run(t){t instanceof Yi&&!t.isRequired()&&(this.setModified(),t.remove())}}class oTe extends qc{run(t){if(!bO(t)&&!(t.numChildren()>1)){for(const n of t.children)if(n instanceof oi)if(t instanceof oi)this.setModified(),t.merge(n);else{if(fT(t.producedFields(),n.dependentFields()))continue;this.setModified(),n.swapWithParent()}}}}class uTe extends qc{run(t){const n=[...t.children],i=t.children.filter(r=>r instanceof oi);if(t.numChildren()>1&&i.length>=1){const r={},s=new Set;for(const a of i){const o=a.parse;for(const u of re(o))u in r?r[u]!==o[u]&&s.add(u):r[u]=o[u]}for(const a of s)delete r[a];if(!Ct(r)){this.setModified();const a=new oi(t,r);for(const o of n){if(o instanceof oi)for(const u of re(r))delete o.parse[u];t.removeChild(o),o.parent=a,o instanceof oi&&re(o.parse).length===0&&o.remove()}}}}}class lTe extends qc{run(t){t instanceof Yi||t.numChildren()>0||t instanceof td||t instanceof Ac||(this.setModified(),t.remove())}}class cTe extends qc{run(t){const n=t.children.filter(r=>r instanceof ma),i=n.pop();for(const r of n)this.setModified(),i.merge(r)}}class fTe extends qc{run(t){const n=t.children.filter(r=>r instanceof $s),i={};for(const r of n){const s=nt(r.groupBy);s in i||(i[s]=[]),i[s].push(r)}for(const r of re(i)){const s=i[r];if(s.length>1){const a=s.pop();for(const o of s)a.merge(o)&&(t.removeChild(o),o.parent=a,o.remove(),this.setModified())}}}}class hTe extends qc{constructor(t){super(),this.model=t}run(t){const n=!(bO(t)||t instanceof ed||t instanceof oi||t instanceof Gu),i=[],r=[];for(const s of t.children)s instanceof va&&(n&&!fT(t.producedFields(),s.dependentFields())?i.push(s):r.push(s));if(i.length>0){const s=i.pop();for(const a of i)s.merge(a,this.model.renameSignal.bind(this.model));this.setModified(),t instanceof va?t.merge(s,this.model.renameSignal.bind(this.model)):s.swapWithParent()}if(r.length>1){const s=r.pop();for(const a of r)s.merge(a,this.model.renameSignal.bind(this.model));this.setModified()}}}class dTe extends qc{run(t){const n=[...t.children];if(!mh(n,a=>a instanceof Yi)||t.numChildren()<=1)return;const r=[];let s;for(const a of n)if(a instanceof Yi){let o=a;for(;o.numChildren()===1;){const[u]=o.children;if(u instanceof Yi)o=u;else break}r.push(...o.children),s?(t.removeChild(a),a.parent=s.parent,s.parent.removeChild(s),s.parent=o,this.setModified()):s=o}else r.push(a);if(r.length){this.setModified();for(const a of r)a.parent.removeChild(a),a.parent=s}}}class Vc extends St{clone(){return new Vc(null,De(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=fa(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){return t.as??fe(t)}hash(){return`JoinAggregateTransform ${nt(this.transform)}`}assemble(){const t=[],n=[],i=[];for(const s of this.transform.joinaggregate)n.push(s.op),i.push(this.getDefaultName(s)),t.push(s.field===void 0?null:s.field);const r=this.transform.groupby;return{type:"joinaggregate",as:i,ops:n,fields:t,...r!==void 0?{groupby:r}:{}}}}class Th extends St{clone(){return new Th(null,{...this.filter})}constructor(t,n){super(t),this.filter=n}static make(t,n,i){const{config:r,markDef:s}=n,{marks:a,scales:o}=i;if(a==="include-invalid-values"&&o==="include-invalid-values")return null;const u=n.reduceFieldDef((l,c,f)=>{const d=Ba(f)&&n.getScaleComponent(f);if(d){const p=d.get("type"),{aggregate:m}=c,y=jT({scaleChannel:f,markDef:s,config:r,scaleType:p,isCountAggregate:cb(m)});y!=="show"&&y!=="always-valid"&&(l[c.field]=c)}return l},{});return re(u).length?new Th(t,u):null}dependentFields(){return new Set(re(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${nt(this.filter)}`}assemble(){const t=re(this.filter).reduce((n,i)=>{const r=this.filter[i],s=fe(r,{expr:"datum"});return r!==null&&(r.type==="temporal"?n.push(`(isDate(${s}) || (${GA(s)}))`):r.type==="quantitative"&&n.push(GA(s))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}function GA(e){return`isValid(${e}) && isFinite(+${e})`}function pTe(e){return e.stack.stackBy.reduce((t,n)=>{const i=n.fieldDef,r=fe(i);return r&&t.push(r),t},[])}function gTe(e){return Q(e)&&e.every(t=>ge(t))&&e.length>1}class ko extends St{clone(){return new ko(null,De(this._stack))}constructor(t,n){super(t),this._stack=n}static makeFromTransform(t,n){const{stack:i,groupby:r,as:s,offset:a="zero"}=n,o=[],u=[];if(n.sort!==void 0)for(const f of n.sort)o.push(f.field),u.push(on(f.order,"ascending"));const l={field:o,order:u};let c;return gTe(s)?c=s:ge(s)?c=[s,`${s}_end`]:c=[`${n.stack}_start`,`${n.stack}_end`],new ko(t,{dimensionFieldDefs:[],stackField:i,groupby:r,offset:a,sort:l,facetby:[],as:c})}static makeFromEncoding(t,n){const i=n.stack,{encoding:r}=n;if(!i)return null;const{groupbyChannels:s,fieldChannel:a,offset:o,impute:u}=i,l=s.map(p=>{const m=r[p];return Is(m)}).filter(p=>!!p),c=pTe(n),f=n.encoding.order;let d;if(Q(f)||ue(f))d=xq(f);else{const p=lV(f)?f.sort:a==="y"?"descending":"ascending";d=c.reduce((m,y)=>(m.field.includes(y)||(m.field.push(y),m.order.push(p)),m),{field:[],order:[]})}return new ko(t,{dimensionFieldDefs:l,stackField:n.vgField(a),facetby:[],stackby:c,sort:d,offset:o,impute:u,as:[n.vgField(a,{suffix:"start",forAs:!0}),n.vgField(a,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${nt(this._stack)}`}getGroupbyFields(){const{dimensionFieldDefs:t,impute:n,groupby:i}=this._stack;return t.length>0?t.map(r=>r.bin?n?[fe(r,{binSuffix:"mid"})]:[fe(r,{}),fe(r,{binSuffix:"end"})]:[fe(r)]).flat():i??[]}assemble(){const t=[],{facetby:n,dimensionFieldDefs:i,stackField:r,stackby:s,sort:a,offset:o,impute:u,as:l}=this._stack;if(u)for(const c of i){const{bandPosition:f=.5,bin:d}=c;if(d){const p=fe(c,{expr:"datum"}),m=fe(c,{expr:"datum",binSuffix:"end"});t.push({type:"formula",expr:`${GA(p)} ? ${f}*${p}+${1-f}*${m} : ${p}`,as:fe(c,{binSuffix:"mid",forAs:!0})})}t.push({type:"impute",field:r,groupby:[...s,...n],key:fe(c,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:r,sort:a,as:l,offset:o}),t}}class nd extends St{clone(){return new nd(null,De(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=fa(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return(this.transform.groupby??[]).forEach(t.add,t),(this.transform.sort??[]).forEach(n=>t.add(n.field)),this.transform.window.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){return t.as??fe(t)}hash(){return`WindowTransform ${nt(this.transform)}`}assemble(){const t=[],n=[],i=[],r=[];for(const f of this.transform.window)n.push(f.op),i.push(this.getDefaultName(f)),r.push(f.param===void 0?null:f.param),t.push(f.field===void 0?null:f.field);const s=this.transform.frame,a=this.transform.groupby;if(s&&s[0]===null&&s[1]===null&&n.every(f=>_T(f)))return{type:"joinaggregate",as:i,ops:n,fields:t,...a!==void 0?{groupby:a}:{}};const o=[],u=[];if(this.transform.sort!==void 0)for(const f of this.transform.sort)o.push(f.field),u.push(f.order??"ascending");const l={field:o,order:u},c=this.transform.ignorePeers;return{type:"window",params:r,as:i,ops:n,fields:t,sort:l,...c!==void 0?{ignorePeers:c}:{},...a!==void 0?{groupby:a}:{},...s!==void 0?{frame:s}:{}}}}function mTe(e){function t(n){if(!(n instanceof td)){const i=n.clone();if(i instanceof Yi){const r=YA+i.getSource();i.setSource(r),e.model.component.data.outputNodes[r]=i}else(i instanceof $s||i instanceof ko||i instanceof nd||i instanceof Vc)&&i.addDimensions(e.fields);for(const r of n.children.flatMap(t))r.parent=i;return[i]}return n.children.flatMap(t)}return t}function HA(e){if(e instanceof td)if(e.numChildren()===1&&!(e.children[0]instanceof Yi)){const t=e.children[0];(t instanceof $s||t instanceof ko||t instanceof nd||t instanceof Vc)&&t.addDimensions(e.fields),t.swapWithParent(),HA(e)}else{const t=e.model.component.data.main;ZW(t);const n=mTe(e),i=e.children.map(n).flat();for(const r of i)r.parent=t}else e.children.map(HA)}function ZW(e){if(e instanceof Yi&&e.type===Wt.Main&&e.numChildren()===1){const t=e.children[0];t instanceof td||(t.swapWithParent(),ZW(e))}}const YA="scale_",f1=5;function XA(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return!1;if(!XA(t.children))return!1}return!0}function hs(e,t){let n=!1;for(const i of t)n=e.optimize(i)||n;return n}function H5(e,t,n){let i=e.sources,r=!1;return r=hs(new aTe,i)||r,r=hs(new rTe(t),i)||r,i=i.filter(s=>s.numChildren()>0),r=hs(new lTe,i)||r,i=i.filter(s=>s.numChildren()>0),n||(r=hs(new oTe,i)||r,r=hs(new hTe(t),i)||r,r=hs(new sTe,i)||r,r=hs(new uTe,i)||r,r=hs(new fTe,i)||r,r=hs(new cTe,i)||r,r=hs(new iTe,i)||r,r=hs(new dTe,i)||r),e.sources=i,r}function yTe(e,t){XA(e.sources);let n=0,i=0;for(let r=0;r<f1&&H5(e,t,!0);r++)n++;e.sources.map(HA);for(let r=0;r<f1&&H5(e,t,!1);r++)i++;XA(e.sources),Math.max(n,i)===f1&&oe(`Maximum optimization runs(${f1}) reached.`)}class $n{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new $n(()=>t(n))}}function eG(e){Vt(e)?vTe(e):xTe(e)}function vTe(e){const t=e.component.scales;for(const n of re(t)){const i=_Te(e,n);if(t[n].setWithExplicit("domains",i),ETe(e,n),e.component.data.isFaceted){let s=e;for(;!xr(s)&&s.parent;)s=s.parent;if(s.component.resolve.scale[n]==="shared")for(const o of i.value)vo(o)&&(o.data=YA+o.data.replace(YA,""))}}}function xTe(e){for(const n of e.children)eG(n);const t=e.component.scales;for(const n of re(t)){let i,r=null;for(const s of e.children){const a=s.component.scales[n];if(a){i===void 0?i=a.getWithExplicit("domains"):i=Wu(i,a.getWithExplicit("domains"),"domains","scale",KA);const o=a.get("selectionExtent");r&&o&&r.param!==o.param&&oe(cSe),r=o}}t[n].setWithExplicit("domains",i),r&&t[n].set("selectionExtent",r,!0)}}function bTe(e,t,n,i){if(e==="unaggregated"){const{valid:r,reason:s}=Y5(t,n);if(!r){oe(s);return}}else if(e===void 0&&i.useUnaggregatedDomain){const{valid:r}=Y5(t,n);if(r)return"unaggregated"}return e}function _Te(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:i}=e,r=bTe(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return r!==e.scaleDomain(t)&&(e.specifiedScales[t]={...e.specifiedScales[t],domain:r}),t==="x"&&wn(i.x2)?wn(i.x)?Wu(uu(n,r,e,"x"),uu(n,r,e,"x2"),"domain","scale",KA):uu(n,r,e,"x2"):t==="y"&&wn(i.y2)?wn(i.y)?Wu(uu(n,r,e,"y"),uu(n,r,e,"y2"),"domain","scale",KA):uu(n,r,e,"y2"):uu(n,r,e,t)}function wTe(e,t,n){return e.map(i=>({signal:`{data: ${Eb(i,{timeUnit:n,type:t})}}`}))}function tE(e,t,n){const i=Rn(n)?.unit;return t==="temporal"||i?wTe(e,t,i):[e]}function uu(e,t,n,i){const{encoding:r,markDef:s,mark:a,config:o,stack:u}=n,l=wn(r[i]),{type:c}=l,f=l.timeUnit,d=p$e({invalid:Aa("invalid",s,o),isPath:cl(a)});if(DAe(t)){const y=uu(e,void 0,n,i),v=tE(t.unionWith,c,f);return sa([...v,...y.value])}else{if(Ee(t))return sa([t]);if(t&&t!=="unaggregated"&&!Gq(t))return sa(tE(t,c,f))}if(u&&i===u.fieldChannel){if(u.offset==="normalize")return lr([[0,1]]);const y=n.requestDataName(d);return lr([{data:y,field:n.vgField(i,{suffix:"start"})},{data:y,field:n.vgField(i,{suffix:"end"})}])}const p=Ba(i)&&ue(l)?STe(n,i,e):void 0;if(Ua(l)){const y=tE([l.datum],c,f);return lr(y)}const m=l;if(t==="unaggregated"){const{field:y}=l;return lr([{data:n.requestDataName(d),field:fe({field:y,aggregate:"min"})},{data:n.requestDataName(d),field:fe({field:y,aggregate:"max"})}])}else if(Nt(m.bin)){if(In(e))return lr(e==="bin-ordinal"?[]:[{data:Eg(p)?n.requestDataName(d):n.requestDataName(Wt.Raw),field:n.vgField(i,k0(m,i)?{binSuffix:"range"}:{}),sort:p===!0||!de(p)?{field:n.vgField(i,{}),op:"min"}:p}]);{const{bin:y}=m;if(Nt(y)){const v=xO(n,m.field,y);return lr([new $n(()=>{const b=n.getSignalName(v);return`[${b}.start, ${b}.stop]`})])}else return lr([{data:n.requestDataName(d),field:n.vgField(i,{})}])}}else if(m.timeUnit&&Ze(["time","utc"],e)){const y=r[za(i)];if(uV(m,y,s,o)){const v=n.requestDataName(d),b=Vu({fieldDef:m,fieldDef2:y,markDef:s,config:o}),_=Ag(a)&&b!==.5&&un(i);return lr([{data:v,field:n.vgField(i,_?{suffix:Tb}:{})},{data:v,field:n.vgField(i,{suffix:_?Ob:"end"})}])}}return lr(p?[{data:Eg(p)?n.requestDataName(d):n.requestDataName(Wt.Raw),field:n.vgField(i),sort:p}]:[{data:n.requestDataName(d),field:n.vgField(i)}])}function nE(e,t){const{op:n,field:i,order:r}=e;return{op:n??(t?"sum":xb),...i?{field:Zr(i)}:{},...r?{order:r}:{}}}function ETe(e,t){const n=e.component.scales[t],i=e.specifiedScales[t].domain,r=e.fieldDef(t)?.bin,s=Gq(i)?i:void 0,a=Lc(r)&&fb(r.extent)?r.extent:void 0;(s||a)&&n.set("selectionExtent",s??a,!0)}function STe(e,t,n){if(!In(n))return;const i=e.fieldDef(t),r=i.sort;if(aV(r))return{op:"min",field:kh(i,t),order:"ascending"};const{stack:s}=e,a=s?new Set([...s.groupbyFields,...s.stackBy.map(o=>o.fieldDef.field)]):void 0;if(Ao(r)){const o=s&&!a.has(r.field);return nE(r,o)}else if(pCe(r)){const{encoding:o,order:u}=r,l=e.fieldDef(o),{aggregate:c,field:f}=l,d=s&&!a.has(f);if(Fo(c)||ll(c))return nE({field:fe(l),order:u},d);if(_T(c)||!c)return nE({op:c,field:f,order:u},d)}else{if(r==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(Ze(["ascending",void 0],r))return!0}}function Y5(e,t){const{aggregate:n,type:i}=e;return n?ge(n)&&!HEe.has(n)?{valid:!1,reason:zSe(n)}:i==="quantitative"&&t==="log"?{valid:!1,reason:BSe(e)}:{valid:!0}:{valid:!1,reason:LSe(e)}}function KA(e,t,n,i){return e.explicit&&t.explicit&&oe(WSe(n,i,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function ATe(e){const t=fa(e.map(a=>{if(vo(a)){const{sort:o,...u}=a;return u}return a}),nt),n=fa(e.map(a=>{if(vo(a)){const o=a.sort;return o!==void 0&&!Eg(o)&&("op"in o&&o.op==="count"&&delete o.field,o.order==="ascending"&&delete o.order),o}}).filter(a=>a!==void 0),nt);if(t.length===0)return;if(t.length===1){const a=e[0];if(vo(a)&&n.length>0){let o=n[0];if(n.length>1){oe(i5);const u=n.filter(l=>de(l)&&"op"in l&&l.op!=="min");n.every(l=>de(l)&&"op"in l)&&u.length===1?o=u[0]:o=!0}else if(de(o)&&"field"in o){const u=o.field;a.field===u&&(o=o.order?{order:o.order}:!0)}return{...a,sort:o}}return a}const i=fa(n.map(a=>Eg(a)||!("op"in a)||ge(a.op)&&ve(qEe,a.op)?a:(oe(HSe(a)),!0)),nt);let r;i.length===1?r=i[0]:i.length>1&&(oe(i5),r=!0);const s=fa(e.map(a=>vo(a)?a.data:null),a=>a);return s.length===1&&s[0]!==null?{data:s[0],fields:t.map(o=>o.field),...r?{sort:r}:{}}:{fields:t,...r?{sort:r}:{}}}function EO(e){if(vo(e)&&ge(e.field))return e.field;if(YEe(e)){let t;for(const n of e.fields)if(vo(n)&&ge(n.field)){if(!t)t=n.field;else if(t!==n.field)return oe(YSe),t}return oe(XSe),t}else if(XEe(e)){oe(KSe);const t=e.fields[0];return ge(t)?t:void 0}}function Ib(e,t){const i=e.component.scales[t].get("domains").map(r=>(vo(r)&&(r.data=e.lookupDataSource(r.data)),r));return ATe(i)}function tG(e){return id(e)||SO(e)?e.children.reduce((t,n)=>t.concat(tG(n)),X5(e)):X5(e)}function X5(e){return re(e.component.scales).reduce((t,n)=>{const i=e.component.scales[n];if(i.merged)return t;const r=i.combine(),{name:s,type:a,selectionExtent:o,domains:u,range:l,reverse:c,...f}=r,d=CTe(r.range,s,n,e),p=Ib(e,n),m=o?A$e(e,o,i,p):null;return t.push({name:s,type:a,...p?{domain:p}:{},...m?{domainRaw:m}:{},range:d,...c!==void 0?{reverse:c}:{},...f}),t},[])}function CTe(e,t,n,i){if(un(n)){if(zc(e))return{step:{signal:`${t}_step`}}}else if(de(e)&&vo(e))return{...e,data:i.lookupDataSource(e.data)};return e}class nG extends Ho{constructor(t,n){super({},{name:t}),this.merged=!1,this.setWithExplicit("type",n)}domainHasZero(){const t=this.get("type");if(Ze([qn.LOG,qn.TIME,qn.UTC],t))return"definitely-not";const n=this.get("zero");if(n===!0||n===void 0&&Ze([qn.LINEAR,qn.SQRT,qn.POW],t))return"definitely";const i=this.get("domains");if(i.length>0){let r=!1,s=!1,a=!1;for(const o of i){if(Q(o)){const u=o[0],l=o[o.length-1];if(dt(u)&&dt(l))if(u<=0&&l>=0){r=!0;continue}else{s=!0;continue}}a=!0}if(r)return"definitely";if(s&&!a)return"definitely-not"}return"maybe"}}const kTe=["range","scheme"];function $Te(e){const t=e.component.scales;for(const n of bT){const i=t[n];if(!i)continue;const r=TTe(n,e);i.setWithExplicit("range",r)}}function K5(e,t){const n=e.fieldDef(t);if(n?.bin){const{bin:i,field:r}=n,s=er(t),a=e.getName(s);if(de(i)&&i.binned&&i.step!==void 0)return new $n(()=>{const o=e.scaleName(t),u=`(domain("${o}")[1] - domain("${o}")[0]) / ${i.step}`;return`${e.getSignalName(a)} / (${u})`});if(Nt(i)){const o=xO(e,r,i);return new $n(()=>{const u=e.getSignalName(o),l=`(${u}.stop - ${u}.start) / ${u}.step`;return`${e.getSignalName(a)} / (${l})`})}}}function TTe(e,t){const n=t.specifiedScales[e],{size:i}=t,s=t.getScaleComponent(e).get("type");for(const f of kTe)if(n[f]!==void 0){const d=OA(s,f),p=Hq(e,f);if(!d)oe(Cq(s,f,e));else if(p)oe(p);else switch(f){case"range":{const m=n.range;if(Q(m)){if(un(e))return sa(m.map(y=>{if(y==="width"||y==="height"){const v=t.getName(y),b=t.getSignalName.bind(t);return $n.fromName(b,v)}return y}))}else if(de(m))return sa({data:t.requestDataName(Wt.Main),field:m.field,sort:{op:"min",field:t.vgField(e)}});return sa(m)}case"scheme":return sa(OTe(n[f]))}}const a=e===Ut||e==="xOffset"?"width":"height",o=i[a];if(ka(o)){if(un(e))if(In(s)){const f=rG(o,t,e);if(f)return sa({step:f})}else oe(kq(a));else if(b0(e)){const f=e===il?"x":"y";if(t.getScaleComponent(f).get("type")==="band"){const m=sG(o,s);if(m)return sa(m)}}}const{rangeMin:u,rangeMax:l}=n,c=FTe(e,t);return(u!==void 0||l!==void 0)&&OA(s,"rangeMin")&&Q(c)&&c.length===2?sa([u??c[0],l??c[1]]):lr(c)}function OTe(e){return IAe(e)?{scheme:e.name,...Hi(e,["name"])}:{scheme:e}}function iG(e,t,n,{center:i}={}){const r=er(e),s=t.getName(r),a=t.getSignalName.bind(t);return e===Pn&&Ns(n)?i?[$n.fromName(o=>`${a(o)}/2`,s),$n.fromName(o=>`-${a(o)}/2`,s)]:[$n.fromName(a,s),0]:i?[$n.fromName(o=>`-${a(o)}/2`,s),$n.fromName(o=>`${a(o)}/2`,s)]:[0,$n.fromName(a,s)]}function FTe(e,t){const{size:n,config:i,mark:r,encoding:s}=t,{type:a}=wn(s[e]),u=t.getScaleComponent(e).get("type"),{domain:l,domainMid:c}=t.specifiedScales[e];switch(e){case Ut:case Pn:{if(Ze(["point","band"],u)){const f=aG(e,n,i.view);if(ka(f))return{step:rG(f,t,e)}}return iG(e,t,u)}case il:case Jh:return MTe(e,t,u);case qo:{const f=ITe(r,i),d=DTe(r,n,t,i);return bh(u)?RTe(f,d,NTe(u,i,l,e)):[f,d]}case is:return[0,Math.PI*2];case Dc:return[0,360];case js:return[0,new $n(()=>{const f=t.getSignalName(xr(t.parent)?"child_width":"width"),d=t.getSignalName(xr(t.parent)?"child_height":"height");return`min(${f},${d})/2`})];case rl:return{step:1e3/i.scale.framesPerSecond};case ol:return[i.scale.minStrokeWidth,i.scale.maxStrokeWidth];case ul:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case Zi:return"symbol";case Qi:case Pa:case La:return u==="ordinal"?a==="nominal"?"category":"ordinal":c!==void 0?"diverging":r==="rect"||r==="geoshape"?"heatmap":"ramp";case Vo:case sl:case al:return[i.scale.minOpacity,i.scale.maxOpacity]}}function rG(e,t,n){const{encoding:i}=t,r=t.getScaleComponent(n),s=mT(n),a=i[s];if(BV({step:e,offsetIsDiscrete:Le(a)&&Uq(a.type)})==="offset"&&bV(i,s)){const u=t.getScaleComponent(s);let c=`domain('${t.scaleName(s)}').length`;if(u.get("type")==="band"){const d=u.get("paddingInner")??u.get("padding")??0,p=u.get("paddingOuter")??u.get("padding")??0;c=`bandspace(${c}, ${d}, ${p})`}const f=r.get("paddingInner")??r.get("padding");return{signal:`${e.step} * ${c} / (1-${ZEe(f)})`}}else return e.step}function sG(e,t){if(BV({step:e,offsetIsDiscrete:In(t)})==="offset")return{step:e.step}}function MTe(e,t,n){const i=e===il?"x":"y",r=t.getScaleComponent(i);if(!r)return iG(i,t,n,{center:!0});const s=r.get("type"),a=t.scaleName(i),{markDef:o,config:u}=t;if(s==="band"){const l=aG(i,t.size,t.config.view);if(ka(l)){const c=sG(l,n);if(c)return c}return[0,{signal:`bandwidth('${a}')`}]}else{const l=t.encoding[i];if(ue(l)&&l.timeUnit){const c=Pq(l.timeUnit,m=>`scale('${a}', ${m})`),f=t.config.scale.bandWithNestedOffsetPaddingInner,d=Vu({fieldDef:l,markDef:o,config:u})-.5,p=d!==0?` + ${d}`:"";if(f){const m=Ee(f)?`${f.signal}/2`+p:`${f/2+d}`,y=Ee(f)?`(1 - ${f.signal}/2)`+p:`${1-f/2+d}`;return[{signal:`${m} * (${c})`},{signal:`${y} * (${c})`}]}return[0,{signal:c}]}return Yj(`Cannot use ${e} scale if ${i} scale is not discrete.`)}}function aG(e,t,n){const i=e===Ut?"width":"height",r=t[i];return r||Sv(n,i)}function NTe(e,t,n,i){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&Q(n)?n.length+1:(oe(sAe(i)),3)}}function RTe(e,t,n){const i=()=>{const r=Ss(t),s=Ss(e),a=`(${r} - ${s}) / (${n} - 1)`;return`sequence(${s}, ${r} + ${a}, ${a})`};return Ee(t)?new $n(i):{signal:i()}}function ITe(e,t){switch(e){case"bar":case"tick":return t.scale.minBandSize;case"line":case"trail":case"rule":return t.scale.minStrokeWidth;case"text":return t.scale.minFontSize;case"point":case"square":case"circle":return t.scale.minSize}throw new Error(hb("size",e))}const J5=.95;function DTe(e,t,n,i){const r={x:K5(n,"x"),y:K5(n,"y")};switch(e){case"bar":case"tick":{if(i.scale.maxBandSize!==void 0)return i.scale.maxBandSize;const s=Q5(t,r,i.view);return dt(s)?s-1:new $n(()=>`${s.signal} - 1`)}case"line":case"trail":case"rule":return i.scale.maxStrokeWidth;case"text":return i.scale.maxFontSize;case"point":case"square":case"circle":{if(i.scale.maxSize)return i.scale.maxSize;const s=Q5(t,r,i.view);return dt(s)?Math.pow(J5*s,2):new $n(()=>`pow(${J5} * ${s.signal}, 2)`)}}throw new Error(hb("size",e))}function Q5(e,t,n){const i=ka(e.width)?e.width.step:RA(n,"width"),r=ka(e.height)?e.height.step:RA(n,"height");return t.x||t.y?new $n(()=>`min(${[t.x?t.x.signal:i,t.y?t.y.signal:r].join(", ")})`):Math.min(i,r)}function oG(e,t){Vt(e)?PTe(e,t):lG(e,t)}function PTe(e,t){const n=e.component.scales,{config:i,encoding:r,markDef:s,specifiedScales:a}=e;for(const o of re(n)){const u=a[o],l=n[o],c=e.getScaleComponent(o),f=wn(r[o]),d=u[t],p=c.get("type"),m=c.get("padding"),y=c.get("paddingInner"),v=OA(p,t),b=Hq(o,t);if(d!==void 0&&(v?b&&oe(b):oe(Cq(p,t,o))),v&&b===void 0)if(d!==void 0){const _=f.timeUnit,E=f.type;switch(t){case"domainMax":case"domainMin":Bc(u[t])||E==="temporal"||_?l.set(t,{signal:Eb(u[t],{type:E,timeUnit:_})},!0):l.set(t,u[t],!0);break;default:l.copyKeyFromObject(t,u)}}else{const _=se(Z5,t)?Z5[t]({model:e,channel:o,fieldOrDatumDef:f,scaleType:p,scalePadding:m,scalePaddingInner:y,domain:u.domain,domainMin:u.domainMin,domainMax:u.domainMax,markDef:s,config:i,hasNestedOffsetScale:_V(r,o),hasSecondaryRangeChannel:!!r[za(o)]}):i.scale[t];_!==void 0&&l.set(t,_,!1)}}}const Z5={bins:({model:e,fieldOrDatumDef:t})=>ue(t)?LTe(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>zTe(e,t.type),nice:({scaleType:e,channel:t,domain:n,domainMin:i,domainMax:r,fieldOrDatumDef:s})=>BTe(e,t,n,i,r,s),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:i,config:r})=>UTe(e,t,r.scale,n,i,r.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,scaleType:i,config:r,hasNestedOffsetScale:s})=>jTe(e,t,n.type,i,r.scale,s),paddingOuter:({scalePadding:e,channel:t,scaleType:n,scalePaddingInner:i,config:r,hasNestedOffsetScale:s})=>qTe(e,t,n,i,r.scale,s),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:i})=>{const r=ue(e)?e.sort:void 0;return VTe(t,r,n,i.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:i,scaleType:r,config:s,hasSecondaryRangeChannel:a})=>WTe(e,t,n,i,r,s.scale,a)};function uG(e){Vt(e)?$Te(e):lG(e,"range")}function lG(e,t){const n=e.component.scales;for(const i of e.children)t==="range"?uG(i):oG(i,t);for(const i of re(n)){let r;for(const s of e.children){const a=s.component.scales[i];if(a){const o=a.getWithExplicit(t);r=Wu(r,o,t,"scale",ZV((u,l)=>{switch(t){case"range":return u.step&&l.step?u.step-l.step:0}return 0}))}}n[i].setWithExplicit(t,r)}}function LTe(e,t){const n=t.bin;if(Nt(n)){const i=xO(e,t.field,n);return new $n(()=>e.getSignalName(i))}else if(Un(n)&&Lc(n)&&n.step!==void 0)return{step:n.step}}function zTe(e,t){if(Ze([Qi,Pa,La],e)&&t!=="nominal")return"hcl"}function BTe(e,t,n,i,r,s){if(!(Is(s)?.bin||Q(n)||r!=null||i!=null||Ze([qn.TIME,qn.UTC],e)))return un(t)?!0:void 0}function UTe(e,t,n,i,r,s){if(un(e)){if(ha(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:a,orient:o}=r;if(a==="bar"&&!(ue(i)&&(i.bin||i.timeUnit))&&(o==="vertical"&&e==="x"||o==="horizontal"&&e==="y"))return s.continuousBandSize}if(t===qn.POINT)return n.pointPadding}}function jTe(e,t,n,i,r,s=!1){if(e===void 0){if(un(t)){const{bandPaddingInner:a,barBandPaddingInner:o,rectBandPaddingInner:u,tickBandPaddingInner:l,bandWithNestedOffsetPaddingInner:c}=r;return s?c:on(a,n==="bar"?o:n==="tick"?l:u)}else if(b0(t)&&i===qn.BAND)return r.offsetBandPaddingInner}}function qTe(e,t,n,i,r,s=!1){if(e===void 0){if(un(t)){const{bandPaddingOuter:a,bandWithNestedOffsetPaddingOuter:o}=r;if(s)return o;if(n===qn.BAND)return on(a,Ee(i)?{signal:`${i.signal}/2`}:i/2)}else if(b0(t)){if(n===qn.POINT)return .5;if(n===qn.BAND)return r.offsetBandPaddingOuter}}}function VTe(e,t,n,i){if(n==="x"&&i.xReverse!==void 0)return Ns(e)&&t==="descending"?Ee(i.xReverse)?{signal:`!${i.xReverse.signal}`}:!i.xReverse:i.xReverse;if(Ns(e)&&t==="descending")return!0}function WTe(e,t,n,i,r,s,a){if(!!n&&n!=="unaggregated"&&Ns(r)){if(Q(n)){const u=n[0],l=n[n.length-1];if(dt(u)&&u<=0&&dt(l)&&l>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!bh(r))return!0;if(!(ue(t)&&t.bin)&&Ze([...Wo,...REe],e)){const{orient:u,type:l}=i;return Ze(["bar","area","line","trail"],l)&&(u==="horizontal"&&e==="y"||u==="vertical"&&e==="x")?!1:Ze(["bar","area"],l)&&!a?!0:s?.zero}return!1}function GTe(e,t,n,i,r=!1){const s=HTe(t,n,i,r),{type:a}=e;return Ba(t)?a!==void 0?jAe(t,a)?ue(n)&&!UAe(a,n.type)?(oe(qSe(a,s)),s):a:(oe(jSe(t,a,s)),s):s:null}function HTe(e,t,n,i){switch(t.type){case"nominal":case"ordinal":{if(qf(e)||Vw(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&oe(Ww(e,"ordinal")),"ordinal";if(qw(e))return"band";if(un(e)||b0(e)){if(Ze(["rect","bar","image","rule","tick"],n.type)||i)return"band"}else if(n.type==="arc"&&e in xT)return"band";const r=n[er(e)];return _c(r)||wh(t)&&t.axis?.tickBand?"band":"point"}case"temporal":return qf(e)?"time":Vw(e)==="discrete"?(oe(Ww(e,"temporal")),"ordinal"):ue(t)&&t.timeUnit&&Rn(t.timeUnit).utc?"utc":qw(e)?"band":"time";case"quantitative":return qf(e)?ue(t)&&Nt(t.bin)?"bin-ordinal":"linear":Vw(e)==="discrete"?(oe(Ww(e,"quantitative")),"ordinal"):qw(e)?"band":"linear";case"geojson":return}throw new Error(Sq(t.type))}function YTe(e,{ignoreRange:t}={}){cG(e),eG(e);for(const n of BAe)oG(e,n);t||uG(e)}function cG(e){Vt(e)?e.component.scales=XTe(e):e.component.scales=JTe(e)}function XTe(e){const{encoding:t,mark:n,markDef:i}=e,r={};for(const s of bT){const a=wn(t[s]);if(a&&n===Kq&&s===Zi&&a.type===Qh)continue;let o=a&&a.scale;if(a&&o!==null&&o!==!1){o??(o={});const u=_V(t,s),l=GTe(o,s,a,i,u);r[s]=new nG(e.scaleName(`${s}`,!0),{value:l,explicit:o.type===l})}}return r}const KTe=ZV((e,t)=>s5(e)-s5(t));function JTe(e){var t;const n=e.component.scales={},i={},r=e.component.resolve;for(const s of e.children){cG(s);for(const a of re(s.component.scales))if((t=r.scale)[a]??(t[a]=UW(a,e)),r.scale[a]==="shared"){const o=i[a],u=s.component.scales[a].getWithExplicit("type");o?OAe(o.value,u.value)?i[a]=Wu(o,u,"type","scale",KTe):(r.scale[a]="independent",delete i[a]):i[a]=u}}for(const s of re(i)){const a=e.scaleName(s,!0),o=i[s];n[s]=new nG(a,o);for(const u of e.children){const l=u.component.scales[s];l&&(u.renameScale(l.get("name"),a),l.merged=!0)}}return n}class iE{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function Vt(e){return e?.type==="unit"}function xr(e){return e?.type==="facet"}function SO(e){return e?.type==="concat"}function id(e){return e?.type==="layer"}class AO{constructor(t,n,i,r,s,a,o){this.type=n,this.parent=i,this.config=s,this.parent=i,this.config=s,this.view=jn(o),this.name=t.name??r,this.title=du(t.title)?{text:t.title}:t.title?jn(t.title):void 0,this.scaleNameMap=i?i.scaleNameMap:new iE,this.projectionNameMap=i?i.projectionNameMap:new iE,this.signalNameMap=i?i.signalNameMap:new iE,this.data=t.data,this.description=t.description,this.transforms=n$e(t.transform??[]),this.layout=n==="layer"||n==="unit"?{}:ake(t,n,s),this.component={data:{sources:i?i.component.data.sources:[],outputNodes:i?i.component.data.outputNodes:{},outputNodeRefCounts:i?i.component.data.outputNodeRefCounts:{},isFaceted:bb(t)||i?.component.data.isFaceted&&t.data===void 0},layoutSize:new Ho,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:{scale:{},axis:{},legend:{},...a?De(a):{}},selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){YTe(this)}parseProjection(){JW(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){GW(this)}assembleEncodeFromView(t){const{style:n,...i}=t,r={};for(const s of re(i)){const a=i[s];a!==void 0&&(r[s]=Dt(a))}return r}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=Dt(this.description)),this.type==="unit"||this.type==="layer")?{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height"),...n}:Ct(n)?void 0:n}assembleLayout(){if(!this.layout)return;const{spacing:t,...n}=this.layout,{component:i,config:r}=this,s=y3e(i.layoutHeaders,r);return{padding:t,...this.assembleDefaultLayout(),...n,...s?{titleBand:s}:{}}}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const i of Wr)t[i].title&&n.push(f3e(this,i));for(const i of gO)n=n.concat(h3e(this,i));return n}assembleAxes(){return Q$e(this.component.axes,this.config)}assembleLegends(){return YW(this)}assembleProjections(){return B3e(this)}assembleTitle(){const{encoding:t,...n}=this.title??{},i={...gq(this.config.title).nonMarkTitleProperties,...n,...t?{encode:{update:t}}:{}};if(i.text)return Ze(["unit","layer"],this.type)?Ze(["middle",void 0],i.anchor)&&(i.frame??(i.frame="group")):i.anchor??(i.anchor="start"),Ct(i)?void 0:i}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const i=this.assembleLayout();i&&(n.layout=i),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const r=!this.parent||xr(this.parent)?tG(this):[];r.length>0&&(n.scales=r);const s=this.assembleAxes();s.length>0&&(n.axes=s);const a=this.assembleLegends();return a.length>0&&(n.legends=a),n}getName(t){return Bt((this.name?`${this.name}_`:"")+t)}getDataName(t){return this.getName(Wt[t].toLowerCase())}requestDataName(t){const n=this.getDataName(t),i=this.component.data.outputNodeRefCounts;return i[n]=(i[n]||0)+1,n}getSizeSignalRef(t){if(xr(this.parent)){const n=zW(t),i=lb(n),r=this.component.scales[i];if(r&&!r.merged){const s=r.get("type"),a=r.get("range");if(In(s)&&zc(a)){const o=r.get("name"),u=Ib(this,i),l=EO(u);if(l){const c=fe({aggregate:"distinct",field:l},{expr:"datum"});return{signal:LW(o,r,c)}}else return oe(ET(i)),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(oq(t)&&Ba(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getScaleType(t){const n=this.getScaleComponent(t);return n?n.get("type"):void 0}getSelectionComponent(t,n){let i=this.component.selection[t];if(!i&&this.parent&&(i=this.parent.getSelectionComponent(t,n)),!i)throw new Error(rSe(n));return i}hasAxisOrientSignalRef(){return this.component.axes.x?.some(t=>t.hasOrientSignalRef())||this.component.axes.y?.some(t=>t.hasOrientSignalRef())}}class fG extends AO{vgField(t,n={}){const i=this.fieldDef(t);if(i)return fe(i,n)}reduceFieldDef(t,n){return ICe(this.getMapping(),(i,r,s)=>{const a=Is(r);return a?t(i,a,s):i},n)}forEachFieldDef(t,n){JT(this.getMapping(),(i,r)=>{const s=Is(i);s&&t(s,r)},n)}}class Db extends St{clone(){return new Db(null,De(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=De(n);const i=this.transform.as??[void 0,void 0];this.transform.as=[i[0]??"value",i[1]??"density"];const r=this.transform.resolve??"shared";this.transform.resolve=r}dependentFields(){return new Set([this.transform.density,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${nt(this.transform)}`}assemble(){const{density:t,...n}=this.transform,i={type:"kde",field:t,...n};return i.resolve=this.transform.resolve,i}}class Pb extends St{clone(){return new Pb(null,De(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=De(n)}dependentFields(){return new Set([this.transform.extent])}producedFields(){return new Set([])}hash(){return`ExtentTransform ${nt(this.transform)}`}assemble(){const{extent:t,param:n}=this.transform;return{type:"extent",field:t,signal:n}}}class Lb extends St{clone(){return new Lb(this.parent,De(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=De(n);const{flatten:i,as:r=[]}=this.transform;this.transform.as=i.map((s,a)=>r[a]??s)}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${nt(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class zb extends St{clone(){return new zb(null,De(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=De(n);const i=this.transform.as??[void 0,void 0];this.transform.as=[i[0]??"key",i[1]??"value"]}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${nt(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class Gf extends St{clone(){return new Gf(null,De(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let i=0;for(const r of[[Vs,qs],[es,Ws]]){const s=r.map(a=>{const o=wn(n.encoding[a]);return ue(o)?o.field:Ua(o)?{expr:`${o.datum}`}:Rs(o)?{expr:`${o.value}`}:void 0});(s[0]||s[1])&&(t=new Gf(t,s,null,n.getName(`geojson_${i++}`)))}if(n.channelHasField(Zi)){const r=n.typedFieldDef(Zi);r.type===Qh&&(t=new Gf(t,null,r.field,n.getName(`geojson_${i++}`)))}return t}constructor(t,n,i,r){super(t),this.fields=n,this.geojson=i,this.signal=r}dependentFields(){const t=(this.fields??[]).filter(ge);return new Set([...this.geojson?[this.geojson]:[],...t])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${nt(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],{type:"geojson",...this.fields?{fields:this.fields}:{},...this.geojson?{geojson:this.geojson}:{},signal:this.signal}]}}class kg extends St{clone(){return new kg(null,this.projection,De(this.fields),De(this.as))}constructor(t,n,i,r){super(t),this.projection=n,this.fields=i,this.as=r}static parseAll(t,n){if(!n.projectionName())return t;for(const i of[[Vs,qs],[es,Ws]]){const r=i.map(a=>{const o=wn(n.encoding[a]);return ue(o)?o.field:Ua(o)?{expr:`${o.datum}`}:Rs(o)?{expr:`${o.value}`}:void 0}),s=i[0]===es?"2":"";(r[0]||r[1])&&(t=new kg(t,n.projectionName(),r,[n.getName(`x${s}`),n.getName(`y${s}`)]))}return t}dependentFields(){return new Set(this.fields.filter(ge))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${nt(this.fields)} ${nt(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class nc extends St{clone(){return new nc(null,De(this.transform))}constructor(t,n){super(t),this.transform=n}dependentFields(){return new Set([this.transform.impute,this.transform.key,...this.transform.groupby??[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:i,step:r}=t;return{signal:`sequence(${[n,i,...r?[r]:[]].join(",")})`}}static makeFromTransform(t,n){return new nc(t,n)}static makeFromEncoding(t,n){const i=n.encoding,r=i.x,s=i.y;if(ue(r)&&ue(s)){const a=r.impute?r:s.impute?s:void 0;if(a===void 0)return;const o=r.impute?s:s.impute?r:void 0,{method:u,value:l,frame:c,keyvals:f}=a.impute,d=SV(n.mark,i);return new nc(t,{impute:a.field,key:o.field,...u?{method:u}:{},...l!==void 0?{value:l}:{},...c?{frame:c}:{},...f!==void 0?{keyvals:f}:{},...d.length?{groupby:d}:{}})}return null}hash(){return`Impute ${nt(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:i,method:r,groupby:s,value:a,frame:o=[null,null]}=this.transform,u={type:"impute",field:t,key:n,...i?{keyvals:Pke(i)?this.processSequence(i):i}:{},method:"value",...s?{groupby:s}:{},value:!r||r==="value"?a:null};if(r&&r!=="value"){const l={type:"window",as:[`imputed_${t}_value`],ops:[r],fields:[t],frame:o,ignorePeers:!1,...s?{groupby:s}:{}},c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[u,l,c]}else return[u]}}class Bb extends St{clone(){return new Bb(null,De(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=De(n);const i=this.transform.as??[void 0,void 0];this.transform.as=[i[0]??n.on,i[1]??n.loess]}dependentFields(){return new Set([this.transform.loess,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${nt(this.transform)}`}assemble(){const{loess:t,on:n,...i}=this.transform;return{type:"loess",x:n,y:t,...i}}}class $g extends St{clone(){return new $g(null,De(this.transform),this.secondary)}constructor(t,n,i){super(t),this.transform=n,this.secondary=i}static make(t,n,i,r){const s=n.component.data.sources,{from:a}=i;let o=null;if(Lke(a)){let u=pG(a.data,s);u||(u=new Ac(a.data),s.push(u));const l=n.getName(`lookup_${r}`);o=new Yi(u,l,Wt.Lookup,n.component.data.outputNodeRefCounts),n.component.data.outputNodes[l]=o}else if(zke(a)){const u=a.param;i={as:u,...i};let l;try{l=n.getSelectionComponent(Bt(u),u)}catch{throw new Error(uSe(u))}if(o=l.materialized,!o)throw new Error(lSe(u))}return new $g(t,i,o.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?pe(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${nt({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t={values:this.transform.from.fields,...this.transform.as?{as:pe(this.transform.as)}:{}};else{let n=this.transform.as;ge(n)||(oe(bSe),n="_lookup"),t={as:[n]}}return{type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup],...t,...this.transform.default?{default:this.transform.default}:{}}}}class Ub extends St{clone(){return new Ub(null,De(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=De(n);const i=this.transform.as??[void 0,void 0];this.transform.as=[i[0]??"prob",i[1]??"value"]}dependentFields(){return new Set([this.transform.quantile,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${nt(this.transform)}`}assemble(){const{quantile:t,...n}=this.transform;return{type:"quantile",field:t,...n}}}class jb extends St{clone(){return new jb(null,De(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=De(n);const i=this.transform.as??[void 0,void 0];this.transform.as=[i[0]??n.on,i[1]??n.regression]}dependentFields(){return new Set([this.transform.regression,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${nt(this.transform)}`}assemble(){const{regression:t,on:n,...i}=this.transform;return{type:"regression",x:n,y:t,...i}}}class qb extends St{clone(){return new qb(null,De(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=fa((this.transform.groupby??[]).concat(t),n=>n)}producedFields(){}dependentFields(){return new Set([this.transform.pivot,this.transform.value,...this.transform.groupby??[]])}hash(){return`PivotTransform ${nt(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:i,limit:r,op:s}=this.transform;return{type:"pivot",field:t,value:n,...r!==void 0?{limit:r}:{},...s!==void 0?{op:s}:{},...i!==void 0?{groupby:i}:{}}}}class Vb extends St{clone(){return new Vb(null,De(this.transform))}constructor(t,n){super(t),this.transform=n}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${nt(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function hG(e){let t=0;function n(i,r){if(i instanceof Ac&&!i.isGenerator&&!Sh(i.data)&&(e.push(r),r={name:null,source:r.name,transform:[]}),i instanceof oi&&(i.parent instanceof Ac&&!r.source?(r.format={...r.format,parse:i.assembleFormatParse()},r.transform.push(...i.assembleTransforms(!0))):r.transform.push(...i.assembleTransforms())),i instanceof td){r.name||(r.name=`data_${t++}`),!r.source||r.transform.length>0?(e.push(r),i.data=r.name):i.data=r.source,e.push(...i.assemble());return}switch((i instanceof O0||i instanceof F0||i instanceof Th||i instanceof ed||i instanceof Ch||i instanceof kg||i instanceof $s||i instanceof $g||i instanceof nd||i instanceof Vc||i instanceof zb||i instanceof Lb||i instanceof Db||i instanceof Bb||i instanceof Ub||i instanceof jb||i instanceof Gu||i instanceof Vb||i instanceof qb||i instanceof Pb)&&r.transform.push(i.assemble()),(i instanceof va||i instanceof ma||i instanceof nc||i instanceof ko||i instanceof Gf)&&r.transform.push(...i.assemble()),i instanceof Yi&&(r.source&&r.transform.length===0?i.setSource(r.source):i.parent instanceof Yi?i.setSource(r.name):(r.name||(r.name=`data_${t++}`),i.setSource(r.name),i.numChildren()===1&&(e.push(r),r={name:null,source:r.name,transform:[]}))),i.numChildren()){case 0:i instanceof Yi&&(!r.source||r.transform.length>0)&&e.push(r);break;case 1:n(i.children[0],r);break;default:{r.name||(r.name=`data_${t++}`);let s=r.name;!r.source||r.transform.length>0?e.push(r):s=r.source;for(const a of i.children)n(a,{name:null,source:s,transform:[]});break}}}return n}function QTe(e){const t=[],n=hG(t);for(const i of e.children)n(i,{source:e.name,name:null,transform:[]});return t}function ZTe(e,t){const n=[],i=hG(n);let r=0;for(const a of e.sources){a.hasName()||(a.dataName=`source_${r++}`);const o=a.assemble();i(a,o)}for(const a of n)a.transform.length===0&&delete a.transform;let s=0;for(const[a,o]of n.entries())(o.transform??[]).length===0&&!o.source&&n.splice(s++,0,n.splice(a,1)[0]);for(const a of n)for(const o of a.transform??[])o.type==="lookup"&&(o.from=e.outputNodes[o.from].getSource());for(const a of n)a.name in t&&(a.values=t[a.name]);return n}function eOe(e){return e==="top"||e==="left"||Ee(e)?"header":"footer"}function tOe(e){for(const t of Wr)nOe(e,t);eP(e,"x"),eP(e,"y")}function nOe(e,t){const{facet:n,config:i,child:r,component:s}=e;if(e.channelHasField(t)){const a=n[t],o=$h("title",null,i,t);let u=Vf(a,i,{allowDisabling:!0,includeDefault:o===void 0||!!o});r.component.layoutHeaders[t].title&&(u=Q(u)?u.join(", "):u,u+=` / ${r.component.layoutHeaders[t].title}`,r.component.layoutHeaders[t].title=null);const l=$h("labelOrient",a.header,i,t),c=a.header!==null?on(a.header?.labels,i.header.labels,!0):!1,f=Ze(["bottom","right"],l)?"footer":"header";s.layoutHeaders[t]={title:a.header!==null?u:null,facetFieldDef:a,[f]:t==="facet"?[]:[dG(e,t,c)]}}}function dG(e,t,n){const i=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(i)?e.child.getSizeSignalRef(i):void 0,axes:[]}}function eP(e,t){const{child:n}=e;if(n.component.axes[t]){const{layoutHeaders:i,resolve:r}=e.component;if(r.axis[t]=vO(r,t),r.axis[t]==="shared"){const s=t==="x"?"column":"row",a=i[s];for(const o of n.component.axes[t]){const u=eOe(o.get("orient"));a[u]??(a[u]=[dG(e,s,!1)]);const l=Fp(o,"main",e.config,{header:!0});l&&a[u][0].axes.push(l),o.mainExtracted=!0}}}}function iOe(e){CO(e),$v(e,"width"),$v(e,"height")}function rOe(e){CO(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";$v(e,t),$v(e,n)}function CO(e){for(const t of e.children)t.parseLayoutSize()}function $v(e,t){const n=zW(t),i=lb(n),r=e.component.resolve,s=e.component.layoutSize;let a;for(const o of e.children){const u=o.component.layoutSize.getWithExplicit(n),l=r.scale[i]??UW(i,e);if(l==="independent"&&u.value==="step"){a=void 0;break}if(a){if(l==="independent"&&a.value!==u.value){a=void 0;break}a=Wu(a,u,n,"")}else a=u}if(a){for(const o of e.children)e.renameSignal(o.getName(n),e.getName(t)),o.component.layoutSize.set(n,"merged",!1);s.setWithExplicit(t,a)}else s.setWithExplicit(t,{explicit:!1,value:void 0})}function sOe(e){const{size:t,component:n}=e;for(const i of Wo){const r=er(i);if(t[r]){const s=t[r];n.layoutSize.set(r,ka(s)?"step":s,!0)}else{const s=aOe(e,r);n.layoutSize.set(r,s,!1)}}}function aOe(e,t){const n=t==="width"?"x":"y",i=e.config,r=e.getScaleComponent(n);if(r){const s=r.get("type"),a=r.get("range");if(In(s)){const o=Sv(i.view,t);return zc(a)||ka(o)?"step":o}else return NA(i.view,t)}else{if(e.hasProjection||e.mark==="arc")return NA(i.view,t);{const s=Sv(i.view,t);return ka(s)?s.step:s}}}function JA(e,t,n){return fe(t,{suffix:`by_${fe(e)}`,...n})}class Xp extends fG{constructor(t,n,i,r){super(t,"facet",n,i,r,t.resolve),this.child=FO(t.spec,this,this.getName("child"),void 0,r),this.children=[this.child],this.facet=this.initFacet(t.facet)}initFacet(t){if(!S0(t))return{facet:this.initFacetFieldDef(t,"facet")};const n=re(t),i={};for(const r of n){if(![Eo,So].includes(r)){oe(hb(r,"facet"));break}const s=t[r];if(s.field===void 0){oe($A(s,r));break}i[r]=this.initFacetFieldDef(s,r)}return i}initFacetFieldDef(t,n){const i=KT(t,n);return i.header?i.header=jn(i.header):i.header===null&&(i.header=null),i}channelHasField(t){return se(this.facet,t)}fieldDef(t){return this.facet[t]}parseData(){this.component.data=Wb(this),this.child.parseData()}parseLayoutSize(){CO(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection,Object.values(this.component.selection).some(t=>ya(t))&&AT(ST)}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),tOe(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){const t={};for(const n of Wr)for(const i of mO){const r=this.component.layoutHeaders[n],s=r[i],{facetFieldDef:a}=r;if(a){const o=$h("titleOrient",a.header,this.config,n);if(["right","bottom"].includes(o)){const u=Nb(n,o);t.titleAnchor??(t.titleAnchor={}),t.titleAnchor[u]="end"}}if(s?.[0]){const o=n==="row"?"height":"width",u=i==="header"?"headerBand":"footerBand";n!=="facet"&&!this.child.component.layoutSize.get(o)&&(t[u]??(t[u]={}),t[u][n]=.5),r.title&&(t.offset??(t.offset={}),t.offset[n==="row"?"rowTitle":"columnTitle"]=10)}}return t}assembleDefaultLayout(){const{column:t,row:n}=this.facet,i=t?this.columnDistinctSignal():n?1:void 0;let r="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(r="none"),{...this.getHeaderLayoutMixins(),...i?{columns:i}:{},bounds:"full",align:r}}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof Xp))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroupStyle(){}assembleGroup(t){return this.parent&&this.parent instanceof Xp?{...this.channelHasField("column")?{encode:{update:{columns:{field:fe(this.facet.column,{prefix:"distinct"})}}}}:{},...super.assembleGroup(t)}:super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],i=[];if(this.child instanceof Xp){if(this.child.channelHasField("column")){const r=fe(this.child.facet.column);t.push(r),n.push("distinct"),i.push(`distinct_${r}`)}}else for(const r of Wo){const s=this.child.component.scales[r];if(s&&!s.merged){const a=s.get("type"),o=s.get("range");if(In(a)&&zc(o)){const u=Ib(this.child,r),l=EO(u);l?(t.push(l),n.push("distinct"),i.push(`distinct_${l}`)):oe(ET(r))}}}return{fields:t,ops:n,as:i}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:i,column:r}=this.facet,{fields:s,ops:a,as:o}=this.getCardinalityAggregateForChild(),u=[];for(const c of Wr){const f=this.facet[c];if(f){u.push(fe(f));const{bin:d,sort:p}=f;if(Nt(d)&&u.push(fe(f,{binSuffix:"end"})),Ao(p)){const{field:m,op:y=xb}=p,v=JA(f,p);i&&r?(s.push(v),a.push("max"),o.push(v)):(s.push(m),a.push(y),o.push(v))}else if(Q(p)){const m=kh(f,c);s.push(m),a.push("max"),o.push(m)}}}const l=!!i&&!!r;return{name:t,data:n,groupby:u,...l||s.length>0?{aggregate:{...l?{cross:l}:{},...s.length?{fields:s,ops:a,as:o}:{}}}:{}}}facetSortFields(t){const{facet:n}=this,i=n[t];return i?Ao(i.sort)?[JA(i,i.sort,{expr:"datum"})]:Q(i.sort)?[kh(i,t,{expr:"datum"})]:[fe(i,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,i=n[t];if(i){const{sort:r}=i;return[(Ao(r)?r.order:!Q(r)&&r)||"ascending"]}return[]}assembleLabelTitle(){const{facet:t,config:n}=this;if(t.facet)return VA(t.facet,"facet",n);const i={row:["top","bottom"],column:["left","right"]};for(const r of gO)if(t[r]){const s=$h("labelOrient",t[r]?.header,n,r);if(i[r].includes(s))return VA(t[r],r,n)}}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,i=QTe(n),r=t.assembleGroupEncodeEntry(!1),s=this.assembleLabelTitle()||t.assembleTitle(),a=t.assembleGroupStyle();return[{name:this.getName("cell"),type:"group",...s?{title:s}:{},...a?{style:a}:{},from:{facet:this.assembleFacet()},sort:{field:Wr.map(u=>this.facetSortFields(u)).flat(),order:Wr.map(u=>this.facetSortOrder(u)).flat()},...i.length>0?{data:i}:{},...r?{encode:{update:r}}:{},...t.assembleGroup(_$e(this,[]))}]}getMapping(){return this.facet}}function oOe(e,t){const{row:n,column:i}=t;if(n&&i){let r=null;for(const s of[n,i])if(Ao(s.sort)){const{field:a,op:o=xb}=s.sort;e=r=new Vc(e,{joinaggregate:[{op:o,field:a,as:JA(s,s.sort,{forAs:!0})}],groupby:[fe(s)]})}return r}return null}function pG(e,t){for(const n of t){const i=n.data;if(e.name&&n.hasName()&&e.name!==n.dataName)continue;const r=e.format?.mesh,s=i.format?.feature;if(r&&s)continue;const a=e.format?.feature;if((a||s)&&a!==s)continue;const o=i.format?.mesh;if(!((r||o)&&r!==o)){if(Cg(e)&&Cg(i)){if(gr(e.values,i.values))return n}else if(Sh(e)&&Sh(i)){if(e.url===i.url)return n}else if(eW(e)&&e.name===n.dataName)return n}}return null}function uOe(e,t){if(e.data||!e.parent){if(e.data===null){const i=new Ac({values:[]});return t.push(i),i}const n=pG(e.data,t);if(n)return Ou(e.data)||(n.data.format=Xj({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const i=new Ac(e.data);return t.push(i),i}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function lOe(e,t,n){let i=0;for(const r of t.transforms){let s,a;if(Xke(r))a=e=new Ch(e,r),s="derived";else if(uO(r)){const o=Z3e(r);a=e=oi.makeWithAncestors(e,{},o,n)??e,e=new ed(e,t,r.filter)}else if(XV(r))a=e=va.makeFromTransform(e,r,t),s="number";else if(Jke(r))s="date",n.getWithExplicit(r.field).value===void 0&&(e=new oi(e,{[r.field]:s}),n.set(r.field,s,!1)),a=e=ma.makeFromTransform(e,r);else if(Qke(r))a=e=$s.makeFromTransform(e,r),s="number",pO(t)&&(e=new Gu(e));else if(YV(r))a=e=$g.make(e,t,r,i++),s="derived";else if(Gke(r))a=e=new nd(e,r),s="number";else if(Hke(r))a=e=new Vc(e,r),s="number";else if(Zke(r))a=e=ko.makeFromTransform(e,r),s="derived";else if(e$e(r))a=e=new zb(e,r),s="derived";else if(t$e(r))a=e=new Pb(e,r),s="derived";else if(Yke(r))a=e=new Lb(e,r),s="derived";else if(Bke(r))a=e=new qb(e,r),s="derived";else if(Wke(r))e=new Vb(e,r);else if(Kke(r))a=e=nc.makeFromTransform(e,r),s="derived";else if(Uke(r))a=e=new Db(e,r),s="derived";else if(jke(r))a=e=new Ub(e,r),s="derived";else if(qke(r))a=e=new jb(e,r),s="derived";else if(Vke(r))a=e=new Bb(e,r),s="derived";else{oe(xSe(r));continue}if(a&&s!==void 0)for(const o of a.producedFields()??[])n.set(o,s,!1)}return e}function Wb(e){let t=uOe(e,e.component.data.sources);const{outputNodes:n,outputNodeRefCounts:i}=e.component.data,r=e.data,a=!(r&&(Ou(r)||Sh(r)||Cg(r)))&&e.parent?e.parent.component.data.ancestorParse.clone():new d$e;Ou(r)?(tW(r)?t=new F0(t,r.sequence):lO(r)&&(t=new O0(t,r.graticule)),a.parseNothing=!0):r?.format?.parse===null&&(a.parseNothing=!0),t=oi.makeExplicit(t,e,a)??t,t=new Gu(t);const o=e.parent&&id(e.parent);(Vt(e)||xr(e))&&o&&(t=va.makeFromEncoding(t,e)??t),e.transforms.length>0&&(t=lOe(t,e,a));const u=tTe(e),l=eTe(e);t=oi.makeWithAncestors(t,{},{...u,...l},a)??t,Vt(e)&&(t=Gf.parseAll(t,e),t=kg.parseAll(t,e)),(Vt(e)||xr(e))&&(o||(t=va.makeFromEncoding(t,e)??t),t=ma.makeFromEncoding(t,e)??t,t=Ch.parseAllForSortIndex(t,e));const c=t=h1(Wt.Raw,e,t);if(Vt(e)){const v=$s.makeFromEncoding(t,e);v&&(t=v,pO(e)&&(t=new Gu(t))),t=nc.makeFromEncoding(t,e)??t,t=ko.makeFromEncoding(t,e)??t}let f,d;if(Vt(e)){const{markDef:v,mark:b,config:_}=e,E=At("invalid",v,_),{marks:S,scales:A}=d=iW({invalid:E,isPath:cl(b)});S!==A&&A==="include-invalid-values"&&(f=t=h1(Wt.PreFilterInvalid,e,t)),S==="exclude-invalid-values"&&(t=Th.make(t,e,d)??t)}const p=t=h1(Wt.Main,e,t);let m;if(Vt(e)&&d){const{marks:v,scales:b}=d;v==="include-invalid-values"&&b==="exclude-invalid-values"&&(t=Th.make(t,e,d)??t,m=t=h1(Wt.PostFilterInvalid,e,t))}Vt(e)&&K$e(e,p);let y=null;if(xr(e)){const v=e.getName("facet");t=oOe(t,e.facet)??t,y=new td(t,e,v,p.getSource()),n[v]=y}return{...e.component.data,outputNodes:n,outputNodeRefCounts:i,raw:c,main:p,facetRoot:y,ancestorParse:a,preFilterInvalid:f,postFilterInvalid:m}}function h1(e,t,n){const{outputNodes:i,outputNodeRefCounts:r}=t.component.data,s=t.getDataName(e),a=new Yi(n,s,e,r);return i[s]=a,a}class cOe extends AO{constructor(t,n,i,r){super(t,"concat",n,i,r,t.resolve),(t.resolve?.axis?.x==="shared"||t.resolve?.axis?.y==="shared")&&oe(mSe),this.children=this.getChildren(t).map((s,a)=>FO(s,this,this.getName(`concat_${a}`),void 0,r))}parseData(){this.component.data=Wb(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of re(t.component.selection))this.component.selection[n]=t.component.selection[n]}Object.values(this.component.selection).some(t=>ya(t))&&AT(ST)}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return Cb(t)?t.vconcat:aO(t)?t.hconcat:t.concat}parseLayoutSize(){rOe(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=yO(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),i=t.assembleGroupStyle(),r=t.assembleGroupEncodeEntry(!1);return{type:"group",name:t.getName("group"),...n?{title:n}:{},...i?{style:i}:{},...r?{encode:{update:r}}:{},...t.assembleGroup()}})}assembleGroupStyle(){}assembleDefaultLayout(){const t=this.layout.columns;return{...t!=null?{columns:t}:{},bounds:"full",align:"each"}}}function fOe(e){return e===!1||e===null}const hOe={disable:1,gridScale:1,scale:1,...vV,labelExpr:1,encode:1},gG=re(hOe);class kO extends Ho{constructor(t={},n={},i=!1){super(),this.explicit=t,this.implicit=n,this.mainExtracted=i}clone(){return new kO(De(this.explicit),De(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!fOe(this.get(t))}hasOrientSignalRef(){return Ee(this.explicit.orient)}}function dOe(e,t,n){const{encoding:i,config:r}=e,s=wn(i[t])??wn(i[za(t)]),a=e.axis(t)||{},{format:o,formatType:u}=a;if(wc(u))return{text:As({fieldOrDatumDef:s,field:"datum.value",format:o,formatType:u,config:r}),...n};if(o===void 0&&u===void 0&&r.customFormatTypes){if(_h(s)==="quantitative"){if(wh(s)&&s.stack==="normalize"&&r.normalizedNumberFormatType)return{text:As({fieldOrDatumDef:s,field:"datum.value",format:r.normalizedNumberFormat,formatType:r.normalizedNumberFormatType,config:r}),...n};if(r.numberFormatType)return{text:As({fieldOrDatumDef:s,field:"datum.value",format:r.numberFormat,formatType:r.numberFormatType,config:r}),...n}}if(_h(s)==="temporal"&&r.timeFormatType&&ue(s)&&!s.timeUnit)return{text:As({fieldOrDatumDef:s,field:"datum.value",format:r.timeFormat,formatType:r.timeFormatType,config:r}),...n}}return n}function pOe(e){return Wo.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[_Oe(n,e)]),t),{})}const gOe={bottom:"top",top:"bottom",left:"right",right:"left"};function mOe(e){const{axes:t,resolve:n}=e.component,i={top:0,bottom:0,right:0,left:0};for(const r of e.children){r.parseAxesAndHeaders();for(const s of re(r.component.axes))n.axis[s]=vO(e.component.resolve,s),n.axis[s]==="shared"&&(t[s]=yOe(t[s],r.component.axes[s]),t[s]||(n.axis[s]="independent",delete t[s]))}for(const r of Wo){for(const s of e.children)if(s.component.axes[r]){if(n.axis[r]==="independent"){t[r]=(t[r]??[]).concat(s.component.axes[r]);for(const a of s.component.axes[r]){const{value:o,explicit:u}=a.getWithExplicit("orient");if(!Ee(o)){if(i[o]>0&&!u){const l=gOe[o];i[o]>i[l]&&a.set("orient",l,!1)}i[o]++}}}delete s.component.axes[r]}if(n.axis[r]==="independent"&&t[r]&&t[r].length>1)for(const[s,a]of(t[r]||[]).entries())s>0&&a.get("grid")&&!a.explicit.grid&&(a.implicit.grid=!1)}}function yOe(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let i=0;i<n;i++){const r=e[i],s=t[i];if(!!r!=!!s)return;if(r&&s){const a=r.getWithExplicit("orient"),o=s.getWithExplicit("orient");if(a.explicit&&o.explicit&&a.value!==o.value)return;e[i]=vOe(r,s)}}}else return t.map(n=>n.clone());return e}function vOe(e,t){for(const n of gG){const i=Wu(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(r,s)=>{switch(n){case"title":return wq(r,s);case"gridScale":return{explicit:r.explicit,value:on(r.value,s.value)}}return $b(r,s,n,"axis")});e.setWithExplicit(n,i)}return e}function xOe(e,t,n,i,r){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(Ee(n.labelAngle)?n.labelAngle:Sg(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===RW(i,r))return!0}return e===n[t]}const bOe=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function _Oe(e,t){let n=t.axis(e);const i=new kO,r=wn(t.encoding[e]),{mark:s,config:a}=t,o=n?.orient||a[e==="x"?"axisX":"axisY"]?.orient||a.axis?.orient||a3e(e),u=t.getScaleComponent(e).get("type"),l=Z$e(e,u,o,t.config),c=n!==void 0?!n:jA("disable",a.style,n?.style,l).configValue;if(i.set("disable",c,n!==void 0),c)return i;n=n||{};const f=i3e(r,n,e,a.style,l),d=rV(n.formatType,r,u),p=iV(r,r.type,n.format,n.formatType,a,!0),m={fieldOrDatumDef:r,axis:n,channel:e,model:t,scaleType:u,orient:o,labelAngle:f,format:p,formatType:d,mark:s,config:a};for(const b of gG){const _=b in z5?z5[b](m):h5(b)?n[b]:void 0,E=_!==void 0,S=xOe(_,b,n,t,e);if(E&&S)i.set(b,_,S);else{const{configValue:A=void 0,configFrom:$=void 0}=h5(b)&&b!=="values"?jA(b,a.style,n.style,l):{},C=A!==void 0;E&&!C?i.set(b,_,S):($!=="vgAxisConfig"||bOe.has(b)&&C||$0(A)||Ee(A))&&i.set(b,A,!1)}}const y=n.encoding??{},v=yV.reduce((b,_)=>{if(!i.hasAxisPart(_))return b;const E=BW(y[_]??{},t),S=_==="labels"?dOe(t,e,E):E;return S!==void 0&&!Ct(S)&&(b[_]={update:S}),b},{});return Ct(v)||i.set("encode",v,!!n.encoding||n.labelAngle!==void 0),i}function wOe({encoding:e,size:t}){for(const n of Wo){const i=er(n);ka(t[i])&&Eu(e[n])&&(delete t[i],oe(kq(i)))}return t}const EOe={vgMark:"arc",encodeEntry:e=>({...rs(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...Ci("x",e,{defaultPos:"mid"}),...Ci("y",e,{defaultPos:"mid"}),...Mo(e,"radius"),...Mo(e,"theta")})},SOe={vgMark:"area",encodeEntry:e=>({...rs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"}),...Av("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"}),...Av("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"}),...dO(e)})},AOe={vgMark:"rect",encodeEntry:e=>({...rs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Mo(e,"x"),...Mo(e,"y")})},COe={vgMark:"shape",encodeEntry:e=>({...rs(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})}),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[{type:"geoshape",projection:e.projectionName(),...n&&ue(n)&&n.type===Qh?{field:fe(n,{expr:"datum"})}:{}}]}},kOe={vgMark:"image",encodeEntry:e=>({...rs(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"}),...Mo(e,"x"),...Mo(e,"y"),...fO(e,"url")})},$Oe={vgMark:"line",encodeEntry:e=>({...rs(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...Ci("x",e,{defaultPos:"mid"}),...Ci("y",e,{defaultPos:"mid"}),...Vn("size",e,{vgChannel:"strokeWidth"}),...dO(e)})},TOe={vgMark:"trail",encodeEntry:e=>({...rs(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...Ci("x",e,{defaultPos:"mid"}),...Ci("y",e,{defaultPos:"mid"}),...Vn("size",e),...dO(e)})};function $O(e,t){const{config:n}=e;return{...rs(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...Ci("x",e,{defaultPos:"mid"}),...Ci("y",e,{defaultPos:"mid"}),...Vn("size",e),...Vn("angle",e),...OOe(e,n,t)}}function OOe(e,t,n){return n?{shape:{value:n}}:Vn("shape",e)}const FOe={vgMark:"symbol",encodeEntry:e=>$O(e)},MOe={vgMark:"symbol",encodeEntry:e=>$O(e,"circle")},NOe={vgMark:"symbol",encodeEntry:e=>$O(e,"square")},ROe={vgMark:"rect",encodeEntry:e=>({...rs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Mo(e,"x"),...Mo(e,"y")})},IOe={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:{...rs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Av("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"}),...Av("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"}),...Vn("size",e,{vgChannel:"strokeWidth"})}}},DOe={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return{...rs(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"}),...Ci("x",e,{defaultPos:"mid"}),...Ci("y",e,{defaultPos:"mid"}),...fO(e),...Vn("size",e,{vgChannel:"fontSize"}),...Vn("angle",e),...I5("align",POe(e.markDef,n,t)),...I5("baseline",LOe(e.markDef,n,t)),...Ci("radius",e,{defaultPos:null}),...Ci("theta",e,{defaultPos:null})}}};function POe(e,t,n){if(At("align",e,n)===void 0)return"center"}function LOe(e,t,n){if(At("baseline",e,n)===void 0)return"middle"}const zOe={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,i=n.orient,r=i==="horizontal"?"x":"y",s=i==="horizontal"?"y":"x",a=i==="horizontal"?"height":"width";return{...rs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Mo(e,r),...Ci(s,e,{defaultPos:"mid",vgChannel:s==="y"?"yc":"xc"}),[a]:Dt(At("thickness",n,t))}}},d1={arc:EOe,area:SOe,bar:AOe,circle:MOe,geoshape:COe,image:kOe,line:$Oe,point:FOe,rect:ROe,rule:IOe,square:NOe,text:DOe,tick:zOe,trail:TOe};function BOe(e){if(Ze([yb,gb,GAe],e.mark)){const t=SV(e.mark,e.encoding);if(t.length>0)return UOe(e,t)}else if(e.mark===mb){const t=CA.some(n=>At(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t)return jOe(e)}return TO(e)}const tP="faceted_path_";function UOe(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:tP+e.requestDataName(Wt.Main),data:e.requestDataName(Wt.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:TO(e,{fromPrefix:tP})}]}const nP="stack_group_";function jOe(e){const[t]=TO(e,{fromPrefix:nP}),n=e.scaleName(e.stack.fieldChannel),i=(l={})=>e.vgField(e.stack.fieldChannel,l),r=(l,c)=>{const f=[i({prefix:"min",suffix:"start",expr:c}),i({prefix:"max",suffix:"start",expr:c}),i({prefix:"min",suffix:"end",expr:c}),i({prefix:"max",suffix:"end",expr:c})];return`${l}(${f.map(d=>`scale('${n}',${d})`).join(",")})`};let s,a;e.stack.fieldChannel==="x"?(s={...gh(t.encode.update,["y","yc","y2","height",...CA]),x:{signal:r("min","datum")},x2:{signal:r("max","datum")},clip:{value:!0}},a={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},t.encode.update={...Hi(t.encode.update,["y","yc","y2"]),height:{field:{group:"height"}}}):(s={...gh(t.encode.update,["x","xc","x2","width"]),y:{signal:r("min","datum")},y2:{signal:r("max","datum")},clip:{value:!0}},a={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},t.encode.update={...Hi(t.encode.update,["x","xc","x2"]),width:{field:{group:"width"}}});for(const l of CA){const c=Aa(l,e.markDef,e.config);t.encode.update[l]?(s[l]=t.encode.update[l],delete t.encode.update[l]):c&&(s[l]=Dt(c)),c&&(t.encode.update[l]={value:0})}const o=[];if(e.stack.groupbyChannels?.length>0)for(const l of e.stack.groupbyChannels){const c=e.fieldDef(l),f=fe(c);f&&o.push(f),(c?.bin||c?.timeUnit)&&o.push(fe(c,{binSuffix:"end"}))}return s=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((l,c)=>{if(t.encode.update[c])return{...l,[c]:t.encode.update[c]};{const f=Aa(c,e.markDef,e.config);return f!==void 0?{...l,[c]:Dt(f)}:l}},s),s.stroke&&(s.strokeForeground={value:!0},s.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(Wt.Main),name:nP+e.requestDataName(Wt.Main),groupby:o,aggregate:{fields:[i({suffix:"start"}),i({suffix:"start"}),i({suffix:"end"}),i({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:s},marks:[{type:"group",encode:{update:a},marks:[t]}]}]}function qOe(e){const{encoding:t,stack:n,mark:i,markDef:r,config:s}=e,a=t.order;if(!(!Q(a)&&Rs(a)&&SA(a.value)||!a&&SA(At("order",r,s)))){if((Q(a)||ue(a))&&!n)return xq(a,{expr:"datum"});if(cl(i)){const o=r.orient==="horizontal"?"y":"x",u=t[o];if(ue(u))return{field:o}}}}function TO(e,t={fromPrefix:""}){const{mark:n,markDef:i,encoding:r,config:s}=e,a=on(i.clip,VOe(e),WOe(e)),o=yq(i),u=r.key,l=qOe(e),c=GOe(e),f=At("aria",i,s),d=d1[n].postEncodingTransform?d1[n].postEncodingTransform(e):null;return[{name:e.getName("marks"),type:d1[n].vgMark,...a?{clip:a}:{},...o?{style:o}:{},...u?{key:u.field}:{},...l?{sort:l}:{},...c||{},...f===!1?{aria:f}:{},from:{data:t.fromPrefix+e.requestDataName(Wt.Main)},encode:{update:d1[n].encodeEntry(e)},...d?{transform:d}:{}}]}function VOe(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t?.get("selectionExtent")||n?.get("selectionExtent")?!0:void 0}function WOe(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function GOe(e){if(!e.component.selection)return null;const t=re(e.component.selection).length;let n=t,i=e.parent;for(;i&&n===0;)n=re(i.component.selection).length,i=i.parent;return n?{interactive:t>0||e.mark==="geoshape"||!!e.encoding.tooltip||!!e.markDef.tooltip}:null}class mG extends fG{constructor(t,n,i,r={},s){super(t,"unit",n,i,s,void 0,p5(t)?t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[],this.correctDataNames=l=>(l.from?.data&&(l.from.data=this.lookupDataSource(l.from.data),"time"in this.encoding&&(l.from.data=l.from.data+sW)),l.from?.facet?.data&&(l.from.facet.data=this.lookupDataSource(l.from.facet.data)),l);const a=Ca(t.mark)?{...t.mark}:{type:t.mark},o=a.type;a.filled===void 0&&(a.filled=Tke(a,s,{graticule:t.data&&lO(t.data)}));const u=this.encoding=NCe(t.encoding||{},o,a.filled,s);this.markDef=WV(a,u,s),this.size=wOe({encoding:u,size:p5(t)?{...r,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}}:r}),this.stack=VV(this.markDef,u),this.specifiedScales=this.initScales(o,u),this.specifiedAxes=this.initAxes(u),this.specifiedLegends=this.initLegends(u),this.specifiedProjection=t.projection,this.selection=(t.params??[]).filter(l=>rO(l))}get hasProjection(){const{encoding:t}=this,n=this.mark===Kq,i=t&&AEe.some(r=>Le(t[r]));return n||i}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return bT.reduce((i,r)=>{const s=wn(n[r]);return s&&(i[r]=this.initScale(s.scale??{})),i},{})}initScale(t){const{domain:n,range:i}=t,r=jn(t);return Q(n)&&(r.domain=n.map(hr)),Q(i)&&(r.range=i.map(hr)),r}initAxes(t){return Wo.reduce((n,i)=>{const r=t[i];if(Le(r)||i===Ut&&Le(t.x2)||i===Pn&&Le(t.y2)){const s=Le(r)?r.axis:void 0;n[i]=s&&this.initAxis({...s})}return n},{})}initAxis(t){const n=re(t),i={};for(const r of n){const s=t[r];i[r]=$0(s)?mq(s):hr(s)}return i}initLegends(t){return DEe.reduce((n,i)=>{const r=wn(t[i]);if(r&&LEe(i)){const s=r.legend;n[i]=s&&jn(s)}return n},{})}parseData(){this.component.data=Wb(this)}parseLayoutSize(){sOe(this)}parseSelections(){this.component.selection=X$e(this,this.selection)}parseMarkGroup(){this.component.mark=BOe(this)}parseAxesAndHeaders(){this.component.axes=pOe(this)}assembleSelectionTopLevelSignals(t){return w$e(this,t)}assembleSignals(){return[...FW(this),...b$e(this,[])]}assembleSelectionData(t){return E$e(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return yO(this)}assembleMarks(){let t=this.component.mark??[];return(!this.parent||!id(this.parent))&&(t=lW(this,t)),t.map(this.correctDataNames)}assembleGroupStyle(){const{style:t}=this.view||{};return t!==void 0?t:this.encoding.x||this.encoding.y?"cell":"view"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return ec(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return Is(n)}typedFieldDef(t){const n=this.fieldDef(t);return Fi(n)?n:null}}class OO extends AO{constructor(t,n,i,r,s){super(t,"layer",n,i,s,t.resolve,t.view);const a={...r,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}};this.children=t.layer.map((o,u)=>{if(kb(o))return new OO(o,this,this.getName(`layer_${u}`),a,s);if(Go(o))return new mG(o,this,this.getName(`layer_${u}`),a,s);throw new Error(wT(o))})}parseData(){this.component.data=Wb(this);for(const t of this.children)t.parseData()}parseLayoutSize(){iOe(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of re(t.component.selection))this.component.selection[n]=t.component.selection[n]}Object.values(this.component.selection).some(t=>ya(t))&&AT(ST)}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){mOe(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),FW(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),yO(this))}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleGroupStyle(){const t=new Set;for(const i of this.children)for(const r of pe(i.assembleGroupStyle()))t.add(r);const n=Array.from(t);return n.length>1?n:n.length===1?n[0]:void 0}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return S$e(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),YW(this))}}function FO(e,t,n,i,r){if(bb(e))return new Xp(e,t,n,r);if(kb(e))return new OO(e,t,n,i,r);if(Go(e))return new mG(e,t,n,i,r);if(ike(e))return new cOe(e,t,n,r);throw new Error(wT(e))}function HOe(e,t={}){t.logger&&aAe(t.logger),t.fieldTitle&&pV(t.fieldTitle);try{const n=qV(Nh(t.config,e.config)),i=QV(e,n),r=FO(i,null,"",void 0,n);return r.parse(),yTe(r.component.data,r),{spec:XOe(r,YOe(e,i.autosize,n,r),e.datasets,e.usermeta),normalized:i}}finally{t.logger&&oAe(),t.fieldTitle&&SCe()}}function YOe(e,t,n,i){const r=i.component.layoutSize.get("width"),s=i.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},i.hasAxisOrientSignalRef()&&(t.resize=!0)):ge(t)&&(t={type:t}),r&&s&&c$e(t.type)){if(r==="step"&&s==="step")oe(Q6()),t.type="pad";else if(r==="step"||s==="step"){const a=r==="step"?"width":"height";oe(Q6(lb(a)));const o=a==="width"?"height":"width";t.type=f$e(o)}}return{...re(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t},...C5(n,!1),...C5(e,!0)}}function XOe(e,t,n={},i){const r=e.config?yke(e.config):void 0,s=ZTe(e.component.data,n),a=e.assembleSelectionData(s),o=e.assembleProjections(),u=e.assembleTitle(),l=e.assembleGroupStyle(),c=e.assembleGroupEncodeEntry(!0);let f=e.assembleLayoutSignals();f=f.filter(m=>(m.name==="width"||m.name==="height")&&m.value!==void 0?(t[m.name]=+m.value,!1):!0);const{params:d,...p}=t;return{$schema:"https://vega.github.io/schema/vega/v5.json",...e.description?{description:e.description}:{},...p,...u?{title:u}:{},...l?{style:l}:{},...c?{encode:{update:c}}:{},data:a,...o.length>0?{projections:o}:{},...e.assembleGroup([...f,...e.assembleSelectionTopLevelSignals([]),...zV(d)]),...r?{config:r}:{},...i?{usermeta:i}:{}}}const KOe=xEe.version,JOe=Object.freeze(Object.defineProperty({__proto__:null,accessPathDepth:yh,accessPathWithDatum:hT,accessWithDatumToUnescapedPath:wt,compile:HOe,contains:Ze,deepEqual:gr,deleteNestedProperty:gv,duplicate:De,entries:ju,every:lT,fieldIntersection:fT,flatAccessWithDatum:Jj,getFirstDefined:on,hasIntersection:cT,hasProperty:se,hash:nt,internalField:eq,isBoolean:Eg,isEmpty:Ct,isEqual:_Ee,isInternalField:tq,isNullOrFalse:SA,isNumeric:ib,keys:re,logicalExpr:Hp,mergeDeep:Xj,never:Yj,normalize:QV,normalizeAngle:Sg,omit:Hi,pick:gh,prefixGenerator:AA,removePathFromField:Kh,replaceAll:mc,replacePathInField:Zr,resetIdCounter:EEe,setEqual:Kj,some:mh,stringify:kt,titleCase:y0,unique:fa,uniqueId:Zj,vals:Yn,varName:Bt,version:KOe},Symbol.toStringTag,{value:"Module"}));function yG(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var QOe="2.15.0",ZOe={version:QOe};const _f="#fff",iP="#888",eFe={background:"#333",view:{stroke:iP},title:{color:_f,subtitleColor:_f},style:{"guide-label":{fill:_f},"guide-title":{fill:_f}},axis:{domainColor:_f,gridColor:iP,tickColor:_f}},Tl="#4572a7",tFe={background:"#fff",arc:{fill:Tl},area:{fill:Tl},line:{stroke:Tl,strokeWidth:2},path:{stroke:Tl},rect:{fill:Tl},shape:{stroke:Tl},symbol:{fill:Tl,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},Ol="#30a2da",rE="#cbcbcb",nFe="#999",iFe="#333",rP="#f0f0f0",sP="#333",rFe={arc:{fill:Ol},area:{fill:Ol},axis:{domainColor:rE,grid:!0,gridColor:rE,gridWidth:1,labelColor:nFe,labelFontSize:10,titleColor:iFe,tickColor:rE,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:rP,group:{fill:rP},legend:{labelColor:sP,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:sP,titleFontSize:14,titlePadding:10},line:{stroke:Ol,strokeWidth:2},path:{stroke:Ol,strokeWidth:.5},rect:{fill:Ol},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:Ol},bar:{binSpacing:2,fill:Ol,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},Fl="#000",sFe={group:{fill:"#e5e5e5"},arc:{fill:Fl},area:{fill:Fl},line:{stroke:Fl},path:{stroke:Fl},rect:{fill:Fl},shape:{stroke:Fl},symbol:{fill:Fl,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},aFe=22,oFe="normal",aP="Benton Gothic, sans-serif",oP=11.5,uFe="normal",Ml="#82c6df",sE="Benton Gothic Bold, sans-serif",uP="normal",lP=13,rp={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"]},lFe={background:"#ffffff",title:{anchor:"start",color:"#000000",font:sE,fontSize:aFe,fontWeight:oFe},arc:{fill:Ml},area:{fill:Ml},line:{stroke:Ml,strokeWidth:2},path:{stroke:Ml},rect:{fill:Ml},shape:{stroke:Ml},symbol:{fill:Ml,size:30},axis:{labelFont:aP,labelFontSize:oP,labelFontWeight:uFe,titleFont:sE,titleFontSize:lP,titleFontWeight:uP},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:aP,labelFontSize:oP,symbolType:"square",titleFont:sE,titleFontSize:lP,titleFontWeight:uP},range:{category:rp["category-6"],diverging:rp["fireandice-6"],heatmap:rp["fire-7"],ordinal:rp["fire-7"],ramp:rp["fire-7"]}},Nl="#ab5787",p1="#979797",cFe={background:"#f9f9f9",arc:{fill:Nl},area:{fill:Nl},line:{stroke:Nl},path:{stroke:Nl},rect:{fill:Nl},shape:{stroke:Nl},symbol:{fill:Nl,size:30},axis:{domainColor:p1,domainWidth:.5,gridWidth:.2,labelColor:p1,tickColor:p1,tickWidth:.2,titleColor:p1},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},Rl="#3e5c69",fFe={background:"#fff",arc:{fill:Rl},area:{fill:Rl},line:{stroke:Rl},path:{stroke:Rl},rect:{fill:Rl},shape:{stroke:Rl},symbol:{fill:Rl},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},Ir="#1696d2",cP="#000000",hFe="#FFFFFF",g1="Lato",aE="Lato",dFe="Lato",pFe="#DEDDDD",gFe=18,sp={"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},mFe={background:hFe,title:{anchor:"start",fontSize:gFe,font:g1},axisX:{domain:!0,domainColor:cP,domainWidth:1,grid:!1,labelFontSize:12,labelFont:aE,labelAngle:0,tickColor:cP,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:g1},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:pFe,gridWidth:1,labelFontSize:12,labelFont:aE,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:g1,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:aE,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:g1,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:sp["six-groups-cat-1"],diverging:sp["diverging-colors"],heatmap:sp["diverging-colors"],ordinal:sp["six-groups-seq"],ramp:sp["shades-blue"]},area:{fill:Ir},rect:{fill:Ir},line:{color:Ir,stroke:Ir,strokeWidth:5},trail:{color:Ir,stroke:Ir,strokeWidth:0,size:1},path:{stroke:Ir,strokeWidth:.5},point:{filled:!0},text:{font:dFe,color:Ir,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:Ir,stroke:null}},arc:{fill:Ir},shape:{stroke:Ir},symbol:{fill:Ir,size:30}},Il="#3366CC",fP="#ccc",m1="Arial, sans-serif",yFe={arc:{fill:Il},area:{fill:Il},path:{stroke:Il},rect:{fill:Il},shape:{stroke:Il},symbol:{stroke:Il},circle:{fill:Il},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:m1,fontSize:12},"guide-title":{font:m1,fontSize:12},"group-title":{font:m1,fontSize:12}},title:{font:m1,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:fP,tickColor:fP,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},MO=e=>e*(1/3+1),hP=MO(9),dP=MO(10),pP=MO(12),ap="Segoe UI",gP="wf_standard-font, helvetica, arial, sans-serif",mP="#252423",op="#605E5C",yP="transparent",vFe="#C8C6C4",ps="#118DFF",xFe="#12239E",bFe="#E66C37",_Fe="#6B007B",wFe="#E044A7",EFe="#744EC2",SFe="#D9B300",AFe="#D64550",vG=ps,xG="#DEEFFF",vP=[xG,vG],CFe=[xG,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",vG],kFe={view:{stroke:yP},background:yP,font:ap,header:{titleFont:gP,titleFontSize:pP,titleColor:mP,labelFont:ap,labelFontSize:dP,labelColor:op},axis:{ticks:!1,grid:!1,domain:!1,labelColor:op,labelFontSize:hP,titleFont:gP,titleColor:mP,titleFontSize:pP,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:vFe,gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:ps},line:{stroke:ps,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:ap,fontSize:hP,fill:op},arc:{fill:ps},area:{fill:ps,line:!0,opacity:.6},path:{stroke:ps},rect:{fill:ps},point:{fill:ps,filled:!0,size:75},shape:{stroke:ps},symbol:{fill:ps,strokeWidth:1.5,size:50},legend:{titleFont:ap,titleFontWeight:"bold",titleColor:op,labelFont:ap,labelFontSize:dP,labelColor:op,symbolType:"circle",symbolSize:75},range:{category:[ps,xFe,bFe,_Fe,wFe,EFe,SFe,AFe],diverging:vP,heatmap:vP,ordinal:CFe}},oE='IBM Plex Sans,system-ui,-apple-system,BlinkMacSystemFont,".sfnstext-regular",sans-serif',$Fe='IBM Plex Sans Condensed, system-ui, -apple-system, BlinkMacSystemFont, ".SFNSText-Regular", sans-serif',uE=400,y1={textPrimary:{g90:"#f4f4f4",g100:"#f4f4f4",white:"#161616",g10:"#161616"},textSecondary:{g90:"#c6c6c6",g100:"#c6c6c6",white:"#525252",g10:"#525252"},layerAccent01:{white:"#e0e0e0",g10:"#e0e0e0",g90:"#525252",g100:"#393939"},gridBg:{white:"#ffffff",g10:"#ffffff",g90:"#161616",g100:"#161616"}},TFe=["#8a3ffc","#33b1ff","#007d79","#ff7eb6","#fa4d56","#fff1f1","#6fdc8c","#4589ff","#d12771","#d2a106","#08bdba","#bae6ff","#ba4e00","#d4bbff"],OFe=["#6929c4","#1192e8","#005d5d","#9f1853","#fa4d56","#570408","#198038","#002d9c","#ee538b","#b28600","#009d9a","#012749","#8a3800","#a56eff"];function Gb({theme:e,background:t}){const n=["white","g10"].includes(e)?"light":"dark",i=y1.gridBg[e],r=y1.textPrimary[e],s=y1.textSecondary[e],a=n==="dark"?TFe:OFe,o=n==="dark"?"#d4bbff":"#6929c4";return{background:t,arc:{fill:o},area:{fill:o},path:{stroke:o},rect:{fill:o},shape:{stroke:o},symbol:{stroke:o},circle:{fill:o},view:{fill:i,stroke:i},group:{fill:i},title:{color:r,anchor:"start",dy:-15,fontSize:16,font:oE,fontWeight:600},axis:{labelColor:s,labelFontSize:12,labelFont:$Fe,labelFontWeight:uE,titleColor:r,titleFontWeight:600,titleFontSize:12,grid:!0,gridColor:y1.layerAccent01[e],labelAngle:0},axisX:{titlePadding:10},axisY:{titlePadding:2.5},style:{"guide-label":{font:oE,fill:s,fontWeight:uE},"guide-title":{font:oE,fill:s,fontWeight:uE}},range:{category:a,diverging:["#750e13","#a2191f","#da1e28","#fa4d56","#ff8389","#ffb3b8","#ffd7d9","#fff1f1","#e5f6ff","#bae6ff","#82cfff","#33b1ff","#1192e8","#0072c3","#00539a","#003a6d"],heatmap:["#f6f2ff","#e8daff","#d4bbff","#be95ff","#a56eff","#8a3ffc","#6929c4","#491d8b","#31135e","#1c0f30"]}}}const FFe=Gb({theme:"white",background:"#ffffff"}),MFe=Gb({theme:"g10",background:"#f4f4f4"}),NFe=Gb({theme:"g90",background:"#262626"}),RFe=Gb({theme:"g100",background:"#161616"}),IFe=ZOe.version,DFe=Object.freeze(Object.defineProperty({__proto__:null,carbong10:MFe,carbong100:RFe,carbong90:NFe,carbonwhite:FFe,dark:eFe,excel:tFe,fivethirtyeight:rFe,ggplot2:sFe,googlecharts:yFe,latimes:lFe,powerbi:kFe,quartz:cFe,urbaninstitute:mFe,version:IFe,vox:fFe},Symbol.toStringTag,{value:"Module"}));function PFe(e,t,n,i){if(Q(e))return`[${e.map(r=>t(ge(r)?r:xP(r,n))).join(", ")}]`;if(de(e)){let r="";const{title:s,image:a,...o}=e;s&&(r+=`<h2>${t(s)}</h2>`),a&&(r+=`<img src="${new URL(t(a),i||location.href).href}">`);const u=Object.keys(o);if(u.length>0){r+="<table>";for(const l of u){let c=o[l];c!==void 0&&(de(c)&&(c=xP(c,n)),r+=`<tr><td class="key">${t(l)}</td><td class="value">${t(c)}</td></tr>`)}r+="</table>"}return r||"{}"}return t(e)}function LFe(e){const t=[];return function(n,i){if(typeof i!="object"||i===null)return i;const r=t.indexOf(this)+1;return t.length=r,t.length>e?"[Object]":t.indexOf(i)>=0?"[Circular]":(t.push(i),i)}}function xP(e,t){return JSON.stringify(e,LFe(t))}var zFe=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black;
}
#vg-tooltip-element.visible {
  visibility: visible;
}
#vg-tooltip-element h2 {
  margin-top: 0;
  margin-bottom: 10px;
  font-size: 13px;
}
#vg-tooltip-element table {
  border-spacing: 0;
}
#vg-tooltip-element table tr {
  border: none;
}
#vg-tooltip-element table tr td {
  overflow: hidden;
  text-overflow: ellipsis;
  padding-top: 2px;
  padding-bottom: 2px;
}
#vg-tooltip-element table tr td.key {
  color: #808080;
  max-width: 150px;
  text-align: right;
  padding-right: 4px;
}
#vg-tooltip-element table tr td.value {
  display: block;
  max-width: 300px;
  max-height: 7em;
  text-align: left;
}
#vg-tooltip-element.dark-theme {
  background-color: rgba(32, 32, 32, 0.9);
  border: 1px solid #f5f5f5;
  color: white;
}
#vg-tooltip-element.dark-theme td.key {
  color: #bfbfbf;
}
`;const bG="vg-tooltip-element",BFe={offsetX:10,offsetY:10,id:bG,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:UFe,maxDepth:2,formatTooltip:PFe,baseURL:"",anchor:"cursor",position:["top","bottom","left","right","top-left","top-right","bottom-left","bottom-right"]};function UFe(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function jFe(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return zFe.toString().replace(bG,e)}function _G(e,t,{offsetX:n,offsetY:i}){const r=wG({x1:e.clientX,x2:e.clientX,y1:e.clientY,y2:e.clientY},t,n,i),s=["bottom-right","bottom-left","top-right","top-left"];for(const a of s)if(EG(r[a],t))return r[a];return r["top-left"]}function qFe(e,t,n,i,r){const{position:s,offsetX:a,offsetY:o}=r,u=e._el.getBoundingClientRect(),l=e._origin,c=VFe(u,l,n),f=wG(c,i,a,o),d=Array.isArray(s)?s:[s];for(const p of d)if(EG(f[p],i)&&!WFe(t,f[p],i))return f[p];return _G(t,i,r)}function VFe(e,t,n){const i=n.isVoronoi?n.datum.bounds:n.bounds;let r=e.left+t[0]+i.x1,s=e.top+t[1]+i.y1,a=n;for(;a.mark.group;)a=a.mark.group,r+=a.x??0,s+=a.y??0;const o=i.x2-i.x1,u=i.y2-i.y1;return{x1:r,x2:r+o,y1:s,y2:s+u}}function wG(e,t,n,i){const r=(e.x1+e.x2)/2,s=(e.y1+e.y2)/2,a=e.x1-t.width-n,o=r-t.width/2,u=e.x2+n,l=e.y1-t.height-i,c=s-t.height/2,f=e.y2+i;return{top:{x:o,y:l},bottom:{x:o,y:f},left:{x:a,y:c},right:{x:u,y:c},"top-left":{x:a,y:l},"top-right":{x:u,y:l},"bottom-left":{x:a,y:f},"bottom-right":{x:u,y:f}}}function EG(e,t){return e.x>=0&&e.y>=0&&e.x+t.width<=window.innerWidth&&e.y+t.height<=window.innerHeight}function WFe(e,t,n){return e.clientX>=t.x&&e.clientX<=t.x+n.width&&e.clientY>=t.y&&e.clientY<=t.y+n.height}class GFe{constructor(t){this.options={...BFe,...t};const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const i=document.createElement("style");i.setAttribute("id",this.options.styleId),i.innerHTML=jFe(n);const r=document.head;r.childNodes.length>0?r.insertBefore(i,r.childNodes[0]):r.appendChild(i)}}tooltipHandler(t,n,i,r){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),(document.fullscreenElement??document.body).appendChild(this.el)),r==null||r===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=this.options.formatTooltip(r,this.options.sanitize,this.options.maxDepth,this.options.baseURL),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:s,y:a}=this.options.anchor==="mark"?qFe(t,n,i,this.el.getBoundingClientRect(),this.options):_G(n,this.el.getBoundingClientRect(),this.options);this.el.style.top=`${a}px`,this.el.style.left=`${s}px`}}var lE={};/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var HFe=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var s in r)r.hasOwnProperty(s)&&(i[s]=r[s])},e(t,n)};return function(t,n){e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),YFe=Object.prototype.hasOwnProperty;function QA(e,t){return YFe.call(e,t)}function ZA(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var i=[];for(var r in e)QA(e,r)&&i.push(r);return i}function mr(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function eC(e){for(var t=0,n=e.length,i;t<n;){if(i=e.charCodeAt(t),i>=48&&i<=57){t++;continue}return!1}return!0}function Ll(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function SG(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function tC(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(tC(e[t]))return!0}else if(typeof e=="object"){for(var i=ZA(e),r=i.length,s=0;s<r;s++)if(tC(e[i[s]]))return!0}}return!1}function bP(e,t){var n=[e];for(var i in t){var r=typeof t[i]=="object"?JSON.stringify(t[i],null,2):t[i];typeof r<"u"&&n.push(i+": "+r)}return n.join(`
`)}var AG=function(e){HFe(t,e);function t(n,i,r,s,a){var o=this.constructor,u=e.call(this,bP(n,{name:i,index:r,operation:s,tree:a}))||this;return u.name=i,u.index=r,u.operation=s,u.tree=a,Object.setPrototypeOf(u,o.prototype),u.message=bP(n,{name:i,index:r,operation:s,tree:a}),u}return t}(Error),Kt=AG,XFe=mr,Rf={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var i=e[t];return delete e[t],{newDocument:n,removed:i}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:function(e,t,n){var i=Tv(n,this.path);i&&(i=mr(i));var r=ic(n,{op:"remove",path:this.from}).removed;return ic(n,{op:"add",path:this.path,value:r}),{newDocument:n,removed:i}},copy:function(e,t,n){var i=Tv(n,this.from);return ic(n,{op:"add",path:this.path,value:mr(i)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:Tg(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},KFe={add:function(e,t,n){return eC(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var i=e.splice(t,1);return{newDocument:n,removed:i[0]}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:Rf.move,copy:Rf.copy,test:Rf.test,_get:Rf._get};function Tv(e,t){if(t=="")return e;var n={op:"_get",path:t};return ic(e,n),n.value}function ic(e,t,n,i,r,s){if(n===void 0&&(n=!1),i===void 0&&(i=!0),r===void 0&&(r=!0),s===void 0&&(s=0),n&&(typeof n=="function"?n(t,0,e,t.path):Ov(t,0)),t.path===""){var a={newDocument:e};if(t.op==="add")return a.newDocument=t.value,a;if(t.op==="replace")return a.newDocument=t.value,a.removed=e,a;if(t.op==="move"||t.op==="copy")return a.newDocument=Tv(e,t.from),t.op==="move"&&(a.removed=e),a;if(t.op==="test"){if(a.test=Tg(e,t.value),a.test===!1)throw new Kt("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return a.newDocument=e,a}else{if(t.op==="remove")return a.removed=e,a.newDocument=null,a;if(t.op==="_get")return t.value=e,a;if(n)throw new Kt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,t,e);return a}}else{i||(e=mr(e));var o=t.path||"",u=o.split("/"),l=e,c=1,f=u.length,d=void 0,p=void 0,m=void 0;for(typeof n=="function"?m=n:m=Ov;;){if(p=u[c],p&&p.indexOf("~")!=-1&&(p=SG(p)),r&&(p=="__proto__"||p=="prototype"&&c>0&&u[c-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(l[p]===void 0?d=u.slice(0,c).join("/"):c==f-1&&(d=t.path),d!==void 0&&m(t,0,e,d)),c++,Array.isArray(l)){if(p==="-")p=l.length;else{if(n&&!eC(p))throw new Kt("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,t,e);eC(p)&&(p=~~p)}if(c>=f){if(n&&t.op==="add"&&p>l.length)throw new Kt("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,t,e);var a=KFe[t.op].call(t,l,p,e);if(a.test===!1)throw new Kt("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return a}}else if(c>=f){var a=Rf[t.op].call(t,l,p,e);if(a.test===!1)throw new Kt("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return a}if(l=l[p],n&&c<f&&(!l||typeof l!="object"))throw new Kt("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",s,t,e)}}}function Hb(e,t,n,i,r){if(i===void 0&&(i=!0),r===void 0&&(r=!0),n&&!Array.isArray(t))throw new Kt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");i||(e=mr(e));for(var s=new Array(t.length),a=0,o=t.length;a<o;a++)s[a]=ic(e,t[a],n,!0,r,a),e=s[a].newDocument;return s.newDocument=e,s}function JFe(e,t,n){var i=ic(e,t);if(i.test===!1)throw new Kt("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return i.newDocument}function Ov(e,t,n,i){if(typeof e!="object"||e===null||Array.isArray(e))throw new Kt("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(Rf[e.op]){if(typeof e.path!="string")throw new Kt("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new Kt('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new Kt("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new Kt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&tC(e.value))throw new Kt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var r=e.path.split("/").length,s=i.split("/").length;if(r!==s+1&&r!==s)throw new Kt("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==i)throw new Kt("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var a={op:"_get",path:e.from,value:void 0},o=CG([a],n);if(o&&o.name==="OPERATION_PATH_UNRESOLVABLE")throw new Kt("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new Kt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function CG(e,t,n){try{if(!Array.isArray(e))throw new Kt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)Hb(mr(t),mr(e),n||!0);else{n=n||Ov;for(var i=0;i<e.length;i++)n(e[i],i,t,void 0)}}catch(r){if(r instanceof Kt)return r;throw r}}function Tg(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),i=Array.isArray(t),r,s,a;if(n&&i){if(s=e.length,s!=t.length)return!1;for(r=s;r--!==0;)if(!Tg(e[r],t[r]))return!1;return!0}if(n!=i)return!1;var o=Object.keys(e);if(s=o.length,s!==Object.keys(t).length)return!1;for(r=s;r--!==0;)if(!t.hasOwnProperty(o[r]))return!1;for(r=s;r--!==0;)if(a=o[r],!Tg(e[a],t[a]))return!1;return!0}return e!==e&&t!==t}var QFe=Object.freeze({__proto__:null,JsonPatchError:Kt,_areEquals:Tg,applyOperation:ic,applyPatch:Hb,applyReducer:JFe,deepClone:XFe,getValueByPointer:Tv,validate:CG,validator:Ov});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */var NO=new WeakMap,ZFe=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),eMe=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function tMe(e){return NO.get(e)}function nMe(e,t){return e.observers.get(t)}function iMe(e,t){e.observers.delete(t.callback)}function rMe(e,t){t.unobserve()}function sMe(e,t){var n=[],i,r=tMe(e);if(!r)r=new ZFe(e),NO.set(e,r);else{var s=nMe(r,t);i=s&&s.observer}if(i)return i;if(i={},r.value=mr(e),t){i.callback=t,i.next=null;var a=function(){nC(i)},o=function(){clearTimeout(i.next),i.next=setTimeout(a)};typeof window<"u"&&(window.addEventListener("mouseup",o),window.addEventListener("keyup",o),window.addEventListener("mousedown",o),window.addEventListener("keydown",o),window.addEventListener("change",o))}return i.patches=n,i.object=e,i.unobserve=function(){nC(i),clearTimeout(i.next),iMe(r,i),typeof window<"u"&&(window.removeEventListener("mouseup",o),window.removeEventListener("keyup",o),window.removeEventListener("mousedown",o),window.removeEventListener("keydown",o),window.removeEventListener("change",o))},r.observers.set(t,new eMe(t,i)),i}function nC(e,t){t===void 0&&(t=!1);var n=NO.get(e.object);RO(n.value,e.object,e.patches,"",t),e.patches.length&&Hb(n.value,e.patches);var i=e.patches;return i.length>0&&(e.patches=[],e.callback&&e.callback(i)),i}function RO(e,t,n,i,r){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var s=ZA(t),a=ZA(e),o=!1,u=a.length-1;u>=0;u--){var l=a[u],c=e[l];if(QA(t,l)&&!(t[l]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var f=t[l];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null&&Array.isArray(c)===Array.isArray(f)?RO(c,f,n,i+"/"+Ll(l),r):c!==f&&(r&&n.push({op:"test",path:i+"/"+Ll(l),value:mr(c)}),n.push({op:"replace",path:i+"/"+Ll(l),value:mr(f)}))}else Array.isArray(e)===Array.isArray(t)?(r&&n.push({op:"test",path:i+"/"+Ll(l),value:mr(c)}),n.push({op:"remove",path:i+"/"+Ll(l)}),o=!0):(r&&n.push({op:"test",path:i,value:e}),n.push({op:"replace",path:i,value:t}))}if(!(!o&&s.length==a.length))for(var u=0;u<s.length;u++){var l=s[u];!QA(e,l)&&t[l]!==void 0&&n.push({op:"add",path:i+"/"+Ll(l),value:mr(t[l])})}}}function aMe(e,t,n){n===void 0&&(n=!1);var i=[];return RO(e,t,i,"",n),i}var oMe=Object.freeze({__proto__:null,compare:aMe,generate:nC,observe:sMe,unobserve:rMe});Object.assign({},QFe,oMe,{JsonPatchError:AG,deepClone:mr,escapePathComponent:Ll,unescapePathComponent:SG});function uMe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var cE,_P;function lMe(){if(_P)return cE;_P=1;class e{constructor(){this.max=1e3,this.map=new Map}get(n){const i=this.map.get(n);if(i!==void 0)return this.map.delete(n),this.map.set(n,i),i}delete(n){return this.map.delete(n)}set(n,i){if(!this.delete(n)&&i!==void 0){if(this.map.size>=this.max){const s=this.map.keys().next().value;this.delete(s)}this.map.set(n,i)}return this}}return cE=e,cE}var fE,wP;function IO(){if(wP)return fE;wP=1;const e=Object.freeze({loose:!0}),t=Object.freeze({});return fE=i=>i?typeof i!="object"?e:i:t,fE}var v1={exports:{}},hE,EP;function DO(){if(EP)return hE;EP=1;const e="2.0.0",t=256,n=Number.MAX_SAFE_INTEGER||9007199254740991,i=16,r=t-6;return hE={MAX_LENGTH:t,MAX_SAFE_COMPONENT_LENGTH:i,MAX_SAFE_BUILD_LENGTH:r,MAX_SAFE_INTEGER:n,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:e,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},hE}var dE,SP;function Yb(){return SP||(SP=1,dE=typeof process=="object"&&lE&&lE.NODE_DEBUG&&/\bsemver\b/i.test(lE.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{}),dE}var AP;function PO(){return AP||(AP=1,function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:r}=DO(),s=Yb();t=e.exports={};const a=t.re=[],o=t.safeRe=[],u=t.src=[],l=t.t={};let c=0;const f="[a-zA-Z0-9-]",d=[["\\s",1],["\\d",r],[f,i]],p=y=>{for(const[v,b]of d)y=y.split(`${v}*`).join(`${v}{0,${b}}`).split(`${v}+`).join(`${v}{1,${b}}`);return y},m=(y,v,b)=>{const _=p(v),E=c++;s(y,E,v),l[y]=E,u[E]=v,a[E]=new RegExp(v,b?"g":void 0),o[E]=new RegExp(_,b?"g":void 0)};m("NUMERICIDENTIFIER","0|[1-9]\\d*"),m("NUMERICIDENTIFIERLOOSE","\\d+"),m("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${f}*`),m("MAINVERSION",`(${u[l.NUMERICIDENTIFIER]})\\.(${u[l.NUMERICIDENTIFIER]})\\.(${u[l.NUMERICIDENTIFIER]})`),m("MAINVERSIONLOOSE",`(${u[l.NUMERICIDENTIFIERLOOSE]})\\.(${u[l.NUMERICIDENTIFIERLOOSE]})\\.(${u[l.NUMERICIDENTIFIERLOOSE]})`),m("PRERELEASEIDENTIFIER",`(?:${u[l.NUMERICIDENTIFIER]}|${u[l.NONNUMERICIDENTIFIER]})`),m("PRERELEASEIDENTIFIERLOOSE",`(?:${u[l.NUMERICIDENTIFIERLOOSE]}|${u[l.NONNUMERICIDENTIFIER]})`),m("PRERELEASE",`(?:-(${u[l.PRERELEASEIDENTIFIER]}(?:\\.${u[l.PRERELEASEIDENTIFIER]})*))`),m("PRERELEASELOOSE",`(?:-?(${u[l.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[l.PRERELEASEIDENTIFIERLOOSE]})*))`),m("BUILDIDENTIFIER",`${f}+`),m("BUILD",`(?:\\+(${u[l.BUILDIDENTIFIER]}(?:\\.${u[l.BUILDIDENTIFIER]})*))`),m("FULLPLAIN",`v?${u[l.MAINVERSION]}${u[l.PRERELEASE]}?${u[l.BUILD]}?`),m("FULL",`^${u[l.FULLPLAIN]}$`),m("LOOSEPLAIN",`[v=\\s]*${u[l.MAINVERSIONLOOSE]}${u[l.PRERELEASELOOSE]}?${u[l.BUILD]}?`),m("LOOSE",`^${u[l.LOOSEPLAIN]}$`),m("GTLT","((?:<|>)?=?)"),m("XRANGEIDENTIFIERLOOSE",`${u[l.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),m("XRANGEIDENTIFIER",`${u[l.NUMERICIDENTIFIER]}|x|X|\\*`),m("XRANGEPLAIN",`[v=\\s]*(${u[l.XRANGEIDENTIFIER]})(?:\\.(${u[l.XRANGEIDENTIFIER]})(?:\\.(${u[l.XRANGEIDENTIFIER]})(?:${u[l.PRERELEASE]})?${u[l.BUILD]}?)?)?`),m("XRANGEPLAINLOOSE",`[v=\\s]*(${u[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[l.XRANGEIDENTIFIERLOOSE]})(?:${u[l.PRERELEASELOOSE]})?${u[l.BUILD]}?)?)?`),m("XRANGE",`^${u[l.GTLT]}\\s*${u[l.XRANGEPLAIN]}$`),m("XRANGELOOSE",`^${u[l.GTLT]}\\s*${u[l.XRANGEPLAINLOOSE]}$`),m("COERCEPLAIN",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?`),m("COERCE",`${u[l.COERCEPLAIN]}(?:$|[^\\d])`),m("COERCEFULL",u[l.COERCEPLAIN]+`(?:${u[l.PRERELEASE]})?(?:${u[l.BUILD]})?(?:$|[^\\d])`),m("COERCERTL",u[l.COERCE],!0),m("COERCERTLFULL",u[l.COERCEFULL],!0),m("LONETILDE","(?:~>?)"),m("TILDETRIM",`(\\s*)${u[l.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",m("TILDE",`^${u[l.LONETILDE]}${u[l.XRANGEPLAIN]}$`),m("TILDELOOSE",`^${u[l.LONETILDE]}${u[l.XRANGEPLAINLOOSE]}$`),m("LONECARET","(?:\\^)"),m("CARETTRIM",`(\\s*)${u[l.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",m("CARET",`^${u[l.LONECARET]}${u[l.XRANGEPLAIN]}$`),m("CARETLOOSE",`^${u[l.LONECARET]}${u[l.XRANGEPLAINLOOSE]}$`),m("COMPARATORLOOSE",`^${u[l.GTLT]}\\s*(${u[l.LOOSEPLAIN]})$|^$`),m("COMPARATOR",`^${u[l.GTLT]}\\s*(${u[l.FULLPLAIN]})$|^$`),m("COMPARATORTRIM",`(\\s*)${u[l.GTLT]}\\s*(${u[l.LOOSEPLAIN]}|${u[l.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",m("HYPHENRANGE",`^\\s*(${u[l.XRANGEPLAIN]})\\s+-\\s+(${u[l.XRANGEPLAIN]})\\s*$`),m("HYPHENRANGELOOSE",`^\\s*(${u[l.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[l.XRANGEPLAINLOOSE]})\\s*$`),m("STAR","(<|>)?=?\\s*\\*"),m("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),m("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(v1,v1.exports)),v1.exports}var pE,CP;function cMe(){if(CP)return pE;CP=1;const e=/^[0-9]+$/,t=(i,r)=>{const s=e.test(i),a=e.test(r);return s&&a&&(i=+i,r=+r),i===r?0:s&&!a?-1:a&&!s?1:i<r?-1:1};return pE={compareIdentifiers:t,rcompareIdentifiers:(i,r)=>t(r,i)},pE}var gE,kP;function LO(){if(kP)return gE;kP=1;const e=Yb(),{MAX_LENGTH:t,MAX_SAFE_INTEGER:n}=DO(),{safeRe:i,t:r}=PO(),s=IO(),{compareIdentifiers:a}=cMe();class o{constructor(l,c){if(c=s(c),l instanceof o){if(l.loose===!!c.loose&&l.includePrerelease===!!c.includePrerelease)return l;l=l.version}else if(typeof l!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof l}".`);if(l.length>t)throw new TypeError(`version is longer than ${t} characters`);e("SemVer",l,c),this.options=c,this.loose=!!c.loose,this.includePrerelease=!!c.includePrerelease;const f=l.trim().match(c.loose?i[r.LOOSE]:i[r.FULL]);if(!f)throw new TypeError(`Invalid Version: ${l}`);if(this.raw=l,this.major=+f[1],this.minor=+f[2],this.patch=+f[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");f[4]?this.prerelease=f[4].split(".").map(d=>{if(/^[0-9]+$/.test(d)){const p=+d;if(p>=0&&p<n)return p}return d}):this.prerelease=[],this.build=f[5]?f[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(l){if(e("SemVer.compare",this.version,this.options,l),!(l instanceof o)){if(typeof l=="string"&&l===this.version)return 0;l=new o(l,this.options)}return l.version===this.version?0:this.compareMain(l)||this.comparePre(l)}compareMain(l){return l instanceof o||(l=new o(l,this.options)),a(this.major,l.major)||a(this.minor,l.minor)||a(this.patch,l.patch)}comparePre(l){if(l instanceof o||(l=new o(l,this.options)),this.prerelease.length&&!l.prerelease.length)return-1;if(!this.prerelease.length&&l.prerelease.length)return 1;if(!this.prerelease.length&&!l.prerelease.length)return 0;let c=0;do{const f=this.prerelease[c],d=l.prerelease[c];if(e("prerelease compare",c,f,d),f===void 0&&d===void 0)return 0;if(d===void 0)return 1;if(f===void 0)return-1;if(f===d)continue;return a(f,d)}while(++c)}compareBuild(l){l instanceof o||(l=new o(l,this.options));let c=0;do{const f=this.build[c],d=l.build[c];if(e("build compare",c,f,d),f===void 0&&d===void 0)return 0;if(d===void 0)return 1;if(f===void 0)return-1;if(f===d)continue;return a(f,d)}while(++c)}inc(l,c,f){switch(l){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",c,f);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",c,f);break;case"prepatch":this.prerelease.length=0,this.inc("patch",c,f),this.inc("pre",c,f);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",c,f),this.inc("pre",c,f);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const d=Number(f)?1:0;if(!c&&f===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[d];else{let p=this.prerelease.length;for(;--p>=0;)typeof this.prerelease[p]=="number"&&(this.prerelease[p]++,p=-2);if(p===-1){if(c===this.prerelease.join(".")&&f===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(d)}}if(c){let p=[c,d];f===!1&&(p=[c]),a(this.prerelease[0],c)===0?isNaN(this.prerelease[1])&&(this.prerelease=p):this.prerelease=p}break}default:throw new Error(`invalid increment argument: ${l}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return gE=o,gE}var mE,$P;function rd(){if($P)return mE;$P=1;const e=LO();return mE=(n,i,r)=>new e(n,r).compare(new e(i,r)),mE}var yE,TP;function fMe(){if(TP)return yE;TP=1;const e=rd();return yE=(n,i,r)=>e(n,i,r)===0,yE}var vE,OP;function hMe(){if(OP)return vE;OP=1;const e=rd();return vE=(n,i,r)=>e(n,i,r)!==0,vE}var xE,FP;function dMe(){if(FP)return xE;FP=1;const e=rd();return xE=(n,i,r)=>e(n,i,r)>0,xE}var bE,MP;function pMe(){if(MP)return bE;MP=1;const e=rd();return bE=(n,i,r)=>e(n,i,r)>=0,bE}var _E,NP;function gMe(){if(NP)return _E;NP=1;const e=rd();return _E=(n,i,r)=>e(n,i,r)<0,_E}var wE,RP;function mMe(){if(RP)return wE;RP=1;const e=rd();return wE=(n,i,r)=>e(n,i,r)<=0,wE}var EE,IP;function yMe(){if(IP)return EE;IP=1;const e=fMe(),t=hMe(),n=dMe(),i=pMe(),r=gMe(),s=mMe();return EE=(o,u,l,c)=>{switch(u){case"===":return typeof o=="object"&&(o=o.version),typeof l=="object"&&(l=l.version),o===l;case"!==":return typeof o=="object"&&(o=o.version),typeof l=="object"&&(l=l.version),o!==l;case"":case"=":case"==":return e(o,l,c);case"!=":return t(o,l,c);case">":return n(o,l,c);case">=":return i(o,l,c);case"<":return r(o,l,c);case"<=":return s(o,l,c);default:throw new TypeError(`Invalid operator: ${u}`)}},EE}var SE,DP;function vMe(){if(DP)return SE;DP=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(c,f){if(f=n(f),c instanceof t){if(c.loose===!!f.loose)return c;c=c.value}c=c.trim().split(/\s+/).join(" "),a("comparator",c,f),this.options=f,this.loose=!!f.loose,this.parse(c),this.semver===e?this.value="":this.value=this.operator+this.semver.version,a("comp",this)}parse(c){const f=this.options.loose?i[r.COMPARATORLOOSE]:i[r.COMPARATOR],d=c.match(f);if(!d)throw new TypeError(`Invalid comparator: ${c}`);this.operator=d[1]!==void 0?d[1]:"",this.operator==="="&&(this.operator=""),d[2]?this.semver=new o(d[2],this.options.loose):this.semver=e}toString(){return this.value}test(c){if(a("Comparator.test",c,this.options.loose),this.semver===e||c===e)return!0;if(typeof c=="string")try{c=new o(c,this.options)}catch{return!1}return s(c,this.operator,this.semver,this.options)}intersects(c,f){if(!(c instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new u(c.value,f).test(this.value):c.operator===""?c.value===""?!0:new u(this.value,f).test(c.semver):(f=n(f),f.includePrerelease&&(this.value==="<0.0.0-0"||c.value==="<0.0.0-0")||!f.includePrerelease&&(this.value.startsWith("<0.0.0")||c.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&c.operator.startsWith(">")||this.operator.startsWith("<")&&c.operator.startsWith("<")||this.semver.version===c.semver.version&&this.operator.includes("=")&&c.operator.includes("=")||s(this.semver,"<",c.semver,f)&&this.operator.startsWith(">")&&c.operator.startsWith("<")||s(this.semver,">",c.semver,f)&&this.operator.startsWith("<")&&c.operator.startsWith(">")))}}SE=t;const n=IO(),{safeRe:i,t:r}=PO(),s=yMe(),a=Yb(),o=LO(),u=kG();return SE}var AE,PP;function kG(){if(PP)return AE;PP=1;const e=/\s+/g;class t{constructor(R,U){if(U=r(U),R instanceof t)return R.loose===!!U.loose&&R.includePrerelease===!!U.includePrerelease?R:new t(R.raw,U);if(R instanceof s)return this.raw=R.value,this.set=[[R]],this.formatted=void 0,this;if(this.options=U,this.loose=!!U.loose,this.includePrerelease=!!U.includePrerelease,this.raw=R.trim().replace(e," "),this.set=this.raw.split("||").map(G=>this.parseRange(G.trim())).filter(G=>G.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const G=this.set[0];if(this.set=this.set.filter(Z=>!y(Z[0])),this.set.length===0)this.set=[G];else if(this.set.length>1){for(const Z of this.set)if(Z.length===1&&v(Z[0])){this.set=[Z];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let R=0;R<this.set.length;R++){R>0&&(this.formatted+="||");const U=this.set[R];for(let G=0;G<U.length;G++)G>0&&(this.formatted+=" "),this.formatted+=U[G].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(R){const G=((this.options.includePrerelease&&p)|(this.options.loose&&m))+":"+R,Z=i.get(G);if(Z)return Z;const J=this.options.loose,he=J?u[l.HYPHENRANGELOOSE]:u[l.HYPHENRANGE];R=R.replace(he,W(this.options.includePrerelease)),a("hyphen replace",R),R=R.replace(u[l.COMPARATORTRIM],c),a("comparator trim",R),R=R.replace(u[l.TILDETRIM],f),a("tilde trim",R),R=R.replace(u[l.CARETTRIM],d),a("caret trim",R);let we=R.split(" ").map(Ie=>_(Ie,this.options)).join(" ").split(/\s+/).map(Ie=>D(Ie,this.options));J&&(we=we.filter(Ie=>(a("loose invalid filter",Ie,this.options),!!Ie.match(u[l.COMPARATORLOOSE])))),a("range list",we);const Ce=new Map,ze=we.map(Ie=>new s(Ie,this.options));for(const Ie of ze){if(y(Ie))return[Ie];Ce.set(Ie.value,Ie)}Ce.size>1&&Ce.has("")&&Ce.delete("");const bt=[...Ce.values()];return i.set(G,bt),bt}intersects(R,U){if(!(R instanceof t))throw new TypeError("a Range is required");return this.set.some(G=>b(G,U)&&R.set.some(Z=>b(Z,U)&&G.every(J=>Z.every(he=>J.intersects(he,U)))))}test(R){if(!R)return!1;if(typeof R=="string")try{R=new o(R,this.options)}catch{return!1}for(let U=0;U<this.set.length;U++)if(q(this.set[U],R,this.options))return!0;return!1}}AE=t;const n=lMe(),i=new n,r=IO(),s=vMe(),a=Yb(),o=LO(),{safeRe:u,t:l,comparatorTrimReplace:c,tildeTrimReplace:f,caretTrimReplace:d}=PO(),{FLAG_INCLUDE_PRERELEASE:p,FLAG_LOOSE:m}=DO(),y=z=>z.value==="<0.0.0-0",v=z=>z.value==="",b=(z,R)=>{let U=!0;const G=z.slice();let Z=G.pop();for(;U&&G.length;)U=G.every(J=>Z.intersects(J,R)),Z=G.pop();return U},_=(z,R)=>(a("comp",z,R),z=$(z,R),a("caret",z),z=S(z,R),a("tildes",z),z=M(z,R),a("xrange",z),z=P(z,R),a("stars",z),z),E=z=>!z||z.toLowerCase()==="x"||z==="*",S=(z,R)=>z.trim().split(/\s+/).map(U=>A(U,R)).join(" "),A=(z,R)=>{const U=R.loose?u[l.TILDELOOSE]:u[l.TILDE];return z.replace(U,(G,Z,J,he,we)=>{a("tilde",z,G,Z,J,he,we);let Ce;return E(Z)?Ce="":E(J)?Ce=`>=${Z}.0.0 <${+Z+1}.0.0-0`:E(he)?Ce=`>=${Z}.${J}.0 <${Z}.${+J+1}.0-0`:we?(a("replaceTilde pr",we),Ce=`>=${Z}.${J}.${he}-${we} <${Z}.${+J+1}.0-0`):Ce=`>=${Z}.${J}.${he} <${Z}.${+J+1}.0-0`,a("tilde return",Ce),Ce})},$=(z,R)=>z.trim().split(/\s+/).map(U=>C(U,R)).join(" "),C=(z,R)=>{a("caret",z,R);const U=R.loose?u[l.CARETLOOSE]:u[l.CARET],G=R.includePrerelease?"-0":"";return z.replace(U,(Z,J,he,we,Ce)=>{a("caret",z,Z,J,he,we,Ce);let ze;return E(J)?ze="":E(he)?ze=`>=${J}.0.0${G} <${+J+1}.0.0-0`:E(we)?J==="0"?ze=`>=${J}.${he}.0${G} <${J}.${+he+1}.0-0`:ze=`>=${J}.${he}.0${G} <${+J+1}.0.0-0`:Ce?(a("replaceCaret pr",Ce),J==="0"?he==="0"?ze=`>=${J}.${he}.${we}-${Ce} <${J}.${he}.${+we+1}-0`:ze=`>=${J}.${he}.${we}-${Ce} <${J}.${+he+1}.0-0`:ze=`>=${J}.${he}.${we}-${Ce} <${+J+1}.0.0-0`):(a("no pr"),J==="0"?he==="0"?ze=`>=${J}.${he}.${we}${G} <${J}.${he}.${+we+1}-0`:ze=`>=${J}.${he}.${we}${G} <${J}.${+he+1}.0-0`:ze=`>=${J}.${he}.${we} <${+J+1}.0.0-0`),a("caret return",ze),ze})},M=(z,R)=>(a("replaceXRanges",z,R),z.split(/\s+/).map(U=>N(U,R)).join(" ")),N=(z,R)=>{z=z.trim();const U=R.loose?u[l.XRANGELOOSE]:u[l.XRANGE];return z.replace(U,(G,Z,J,he,we,Ce)=>{a("xRange",z,G,Z,J,he,we,Ce);const ze=E(J),bt=ze||E(he),Ie=bt||E(we),nn=Ie;return Z==="="&&nn&&(Z=""),Ce=R.includePrerelease?"-0":"",ze?Z===">"||Z==="<"?G="<0.0.0-0":G="*":Z&&nn?(bt&&(he=0),we=0,Z===">"?(Z=">=",bt?(J=+J+1,he=0,we=0):(he=+he+1,we=0)):Z==="<="&&(Z="<",bt?J=+J+1:he=+he+1),Z==="<"&&(Ce="-0"),G=`${Z+J}.${he}.${we}${Ce}`):bt?G=`>=${J}.0.0${Ce} <${+J+1}.0.0-0`:Ie&&(G=`>=${J}.${he}.0${Ce} <${J}.${+he+1}.0-0`),a("xRange return",G),G})},P=(z,R)=>(a("replaceStars",z,R),z.trim().replace(u[l.STAR],"")),D=(z,R)=>(a("replaceGTE0",z,R),z.trim().replace(u[R.includePrerelease?l.GTE0PRE:l.GTE0],"")),W=z=>(R,U,G,Z,J,he,we,Ce,ze,bt,Ie,nn)=>(E(G)?U="":E(Z)?U=`>=${G}.0.0${z?"-0":""}`:E(J)?U=`>=${G}.${Z}.0${z?"-0":""}`:he?U=`>=${U}`:U=`>=${U}${z?"-0":""}`,E(ze)?Ce="":E(bt)?Ce=`<${+ze+1}.0.0-0`:E(Ie)?Ce=`<${ze}.${+bt+1}.0-0`:nn?Ce=`<=${ze}.${bt}.${Ie}-${nn}`:z?Ce=`<${ze}.${bt}.${+Ie+1}-0`:Ce=`<=${Ce}`,`${U} ${Ce}`.trim()),q=(z,R,U)=>{for(let G=0;G<z.length;G++)if(!z[G].test(R))return!1;if(R.prerelease.length&&!U.includePrerelease){for(let G=0;G<z.length;G++)if(a(z[G].semver),z[G].semver!==s.ANY&&z[G].semver.prerelease.length>0){const Z=z[G].semver;if(Z.major===R.major&&Z.minor===R.minor&&Z.patch===R.patch)return!0}return!1}return!0};return AE}var CE,LP;function xMe(){if(LP)return CE;LP=1;const e=kG();return CE=(n,i,r)=>{try{i=new e(i,r)}catch{return!1}return i.test(n)},CE}var bMe=xMe(),$G=uMe(bMe);function _Me(e,t,n){const i=e.open(t),r=250,{origin:s}=new URL(t);let a=40;function o(l){l.source===i&&(a=0,e.removeEventListener("message",o,!1))}e.addEventListener("message",o,!1);function u(){a<=0||(i.postMessage(n,s),setTimeout(u,r),a-=1)}setTimeout(u,r)}var wMe=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box;
}
.vega-embed.has-actions {
  padding-right: 38px;
}
.vega-embed details:not([open]) > :not(summary) {
  display: none !important;
}
.vega-embed summary {
  list-style: none;
  position: absolute;
  top: 0;
  right: 0;
  padding: 6px;
  z-index: 1000;
  background: white;
  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
  color: #1b1e23;
  border: 1px solid #aaa;
  border-radius: 999px;
  opacity: 0.2;
  transition: opacity 0.4s ease-in;
  cursor: pointer;
  line-height: 0px;
}
.vega-embed summary::-webkit-details-marker {
  display: none;
}
.vega-embed summary:active {
  box-shadow: #aaa 0px 0px 0px 1px inset;
}
.vega-embed summary svg {
  width: 14px;
  height: 14px;
}
.vega-embed details[open] summary {
  opacity: 0.7;
}
.vega-embed:hover summary, .vega-embed:focus-within summary {
  opacity: 1 !important;
  transition: opacity 0.2s ease;
}
.vega-embed .vega-actions {
  position: absolute;
  z-index: 1001;
  top: 35px;
  right: -9px;
  display: flex;
  flex-direction: column;
  padding-bottom: 8px;
  padding-top: 8px;
  border-radius: 4px;
  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
  border: 1px solid #d9d9d9;
  background: white;
  animation-duration: 0.15s;
  animation-name: scale-in;
  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
  text-align: left;
}
.vega-embed .vega-actions a {
  padding: 8px 16px;
  font-family: sans-serif;
  font-size: 14px;
  font-weight: 600;
  white-space: nowrap;
  color: #434a56;
  text-decoration: none;
}
.vega-embed .vega-actions a:hover, .vega-embed .vega-actions a:focus {
  background-color: #f7f7f9;
  color: black;
}
.vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
  content: "";
  display: inline-block;
  position: absolute;
}
.vega-embed .vega-actions::before {
  left: auto;
  right: 14px;
  top: -16px;
  border: 8px solid rgba(0, 0, 0, 0);
  border-bottom-color: #d9d9d9;
}
.vega-embed .vega-actions::after {
  left: auto;
  right: 15px;
  top: -14px;
  border: 7px solid rgba(0, 0, 0, 0);
  border-bottom-color: #fff;
}
.vega-embed .chart-wrapper.fit-x {
  width: 100%;
}
.vega-embed .chart-wrapper.fit-y {
  height: 100%;
}

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px;
}

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}
`;function TG(e,...t){for(const n of t)EMe(e,n);return e}function EMe(e,t){for(const n of Object.keys(t))Rh(e,n,t[n],!0)}const ta=oEe;let Og=JOe;const zP=typeof window<"u"?window:void 0;Og===void 0&&zP?.vl?.compile&&(Og=zP.vl);const SMe={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},AMe={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},Np={vega:"Vega","vega-lite":"Vega-Lite"},Fv={vega:ta.version,"vega-lite":Og?Og.version:"not available"},CMe={vega:e=>e,"vega-lite":(e,t)=>Og.compile(e,{config:t}).spec},kMe=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,$Me="chart-wrapper";function TMe(e){return typeof e=="function"}function BP(e,t,n,i){const r=`<html><head>${t}</head><body><pre><code class="json">`,s=`</code></pre>${n}</body></html>`,a=window.open("");a.document.write(r+e+s),a.document.title=`${Np[i]} JSON Source`}function OMe(e,t){if(e.$schema){const n=yG(e.$schema);t&&t!==n.library&&console.warn(`The given visualization spec is written in ${Np[n.library]}, but mode argument sets ${Np[t]??t}.`);const i=n.library;return $G(Fv[i],`^${n.version.slice(1)}`)||console.warn(`The input spec uses ${Np[i]} ${n.version}, but the current version of ${Np[i]} is v${Fv[i]}.`),i}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t??"vega"}function OG(e){return!!(e&&"load"in e)}function UP(e){return OG(e)?e:ta.loader(e)}function FMe(e){const t=e.usermeta?.embedOptions??{};return ge(t.defaultStyle)&&(t.defaultStyle=!1),t}async function MMe(e,t,n={}){let i,r;ge(t)?(r=UP(n.loader),i=JSON.parse(await r.load(t))):i=t;const s=FMe(i),a=s.loader;(!r||a)&&(r=UP(n.loader??a));const o=await jP(s,r),u=await jP(n,r),l={...TG(u,o),config:Nh(u.config??{},o.config??{})};return await RMe(e,i,l,r)}async function jP(e,t){const n=ge(e.config)?JSON.parse(await t.load(e.config)):e.config??{},i=ge(e.patch)?JSON.parse(await t.load(e.patch)):e.patch;return{...e,...i?{patch:i}:{},...n?{config:n}:{}}}function NMe(e){const t=e.getRootNode?e.getRootNode():document;return t instanceof ShadowRoot?{root:t,rootContainer:t}:{root:document,rootContainer:document.head??document.body}}async function RMe(e,t,n={},i){const r=n.theme?Nh(DFe[n.theme],n.config??{}):n.config,s=Ku(n.actions)?n.actions:TG({},SMe,n.actions??{}),a={...AMe,...n.i18n},o=n.renderer??"canvas",u=n.logLevel??ta.Warn,l=n.downloadFileName??"visualization",c=typeof e=="string"?document.querySelector(e):e;if(!c)throw new Error(`${e} does not exist`);if(n.defaultStyle!==!1){const A="vega-embed-style",{root:$,rootContainer:C}=NMe(c);if(!$.getElementById(A)){const M=document.createElement("style");M.id=A,M.innerHTML=n.defaultStyle===void 0||n.defaultStyle===!0?wMe.toString():n.defaultStyle,C.appendChild(M)}}const f=OMe(t,n.mode);let d=CMe[f](t,r);if(f==="vega-lite"&&d.$schema){const A=yG(d.$schema);$G(Fv.vega,`^${A.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${A.version}, but current version is v${Fv.vega}.`)}c.classList.add("vega-embed"),s&&c.classList.add("has-actions"),c.innerHTML="";let p=c;if(s){const A=document.createElement("div");A.classList.add($Me),c.appendChild(A),p=A}const m=n.patch;if(m&&(d=m instanceof Function?m(d):Hb(d,m,!0,!1).newDocument),n.formatLocale&&ta.formatLocale(n.formatLocale),n.timeFormatLocale&&ta.timeFormatLocale(n.timeFormatLocale),n.expressionFunctions)for(const A in n.expressionFunctions){const $=n.expressionFunctions[A];"fn"in $?ta.expressionFunction(A,$.fn,$.visitor):$ instanceof Function&&ta.expressionFunction(A,$)}const{ast:y}=n,v=ta.parse(d,f==="vega-lite"?{}:r,{ast:y}),b=new(n.viewClass||ta.View)(v,{loader:i,logLevel:u,renderer:o,...y?{expr:ta.expressionInterpreter??n.expr??yEe}:{}});if(b.addSignalListener("autosize",(A,$)=>{const{type:C}=$;C=="fit-x"?(p.classList.add("fit-x"),p.classList.remove("fit-y")):C=="fit-y"?(p.classList.remove("fit-x"),p.classList.add("fit-y")):C=="fit"?p.classList.add("fit-x","fit-y"):p.classList.remove("fit-x","fit-y")}),n.tooltip!==!1){const{loader:A,tooltip:$}=n,C=A&&!OG(A)?A?.baseURL:void 0,M=TMe($)?$:new GFe({baseURL:C,...$===!0?{}:$}).call;b.tooltip(M)}let{hover:_}=n;if(_===void 0&&(_=f==="vega"),_){const{hoverSet:A,updateSet:$}=typeof _=="boolean"?{}:_;b.hover(A,$)}n&&(n.width!=null&&b.width(n.width),n.height!=null&&b.height(n.height),n.padding!=null&&b.padding(n.padding)),await b.initialize(p,n.bind).runAsync();let E;if(s!==!1){let A=c;if(n.defaultStyle!==!1||n.forceActionsMenu){const C=document.createElement("details");C.title=a.CLICK_TO_VIEW_ACTIONS,c.append(C),A=C;const M=document.createElement("summary");M.innerHTML=kMe,C.append(M),E=N=>{C.contains(N.target)||C.removeAttribute("open")},document.addEventListener("click",E)}const $=document.createElement("div");if(A.append($),$.classList.add("vega-actions"),s===!0||s.export!==!1){for(const C of["svg","png"])if(s===!0||s.export===!0||s.export[C]){const M=a[`${C.toUpperCase()}_ACTION`],N=document.createElement("a"),P=de(n.scaleFactor)?n.scaleFactor[C]:n.scaleFactor;N.text=M,N.href="#",N.target="_blank",N.download=`${l}.${C}`,N.addEventListener("mousedown",async function(D){D.preventDefault();const W=await b.toImageURL(C,P);this.href=W}),$.append(N)}}if(s===!0||s.source!==!1){const C=document.createElement("a");C.text=a.SOURCE_ACTION,C.href="#",C.addEventListener("click",function(M){BP(P_(t),n.sourceHeader??"",n.sourceFooter??"",f),M.preventDefault()}),$.append(C)}if(f==="vega-lite"&&(s===!0||s.compiled!==!1)){const C=document.createElement("a");C.text=a.COMPILED_ACTION,C.href="#",C.addEventListener("click",function(M){BP(P_(d),n.sourceHeader??"",n.sourceFooter??"","vega"),M.preventDefault()}),$.append(C)}if(s===!0||s.editor!==!1){const C=n.editorUrl??"https://vega.github.io/editor/",M=document.createElement("a");M.text=a.EDITOR_ACTION,M.href="#",M.addEventListener("click",function(N){_Me(window,C,{config:r,mode:m?"vega":f,renderer:o,spec:P_(m?d:t)}),N.preventDefault()}),$.append(M)}}function S(){E&&document.removeEventListener("click",E),b.finalize()}return{view:b,spec:t,vgSpec:d,finalize:S,embedOptions:n}}const IMe={key:0,class:"error-message"},DMe=jv({__name:"VegaLite",props:{spec:{type:String,required:!0}},setup(e){const t=e,n=dr(),i=dr();function r(){let s;try{s=JSON.parse(t.spec)}catch(a){a instanceof Error?(console.error("Error parsing spec",a),i.value="Error parsing spec: "+a.message):(console.error("Error parsing spec: Non-error value",a),i.value="Error parsing spec: Unknown error"),n.value.innerHTML="";return}MMe(n.value,s).then(a=>{console.log("Chart rendered successfully"),i.value=null}).catch(a=>{console.error("Error rendering chart",a),i.value="Error rendering chart: "+a.toString(),n.value.innerHTML=""})}return RL(()=>{r()}),Zp(()=>t.spec,r),(s,a)=>(ca(),Yf(IL,null,[lie("div",{ref_key:"vegaContainer",ref:n,class:"vega-chart-container"},null,512),i.value?(ca(),Yf("div",IMe,DL(i.value),1)):cie("",!0)],64))}}),PMe=PL(DMe,[["__scopeId","data-v-bd58cf71"]]),LMe=jv({__name:"TableComponent",setup(e){return(t,n)=>(ca(),Yf("div",null,"TABLE COMPONENT STUB"))}});function zMe(e){let{source:t,representation:n}=e;const{transformation:i}=e;return Array.isArray(t)||(t=[t]),Array.isArray(n)||(n=[n]),i?{source:t,transformation:i,representation:n}:{source:t,representation:n}}function qP(e,t){return e==null?t:typeof e=="function"?e:n=>n[e]}function BMe(e,t,n,i,r,s){const a=new Float64Array(s),o=(s-1)/(r-i);for(let u=0;u<e.length;++u){const l=e[u],c=t(l,u,e),f=n(l,u,e);if(!(Number.isFinite(c)&&Number.isFinite(f)))continue;const d=(c-i)*o,p=Math.floor(d),m=p+1;0<=p&&m<s?(a[p]+=(m-d)*f,a[m]+=(d-p)*f):p===-1?a[m]+=(d-p)*f:m===s&&(a[p]+=(m-d)*f)}return a}function VP(e,t=!1){const n=new Float64Array(5),i=new Float64Array(4);UMe(n,i,e);const r=Float64Array.of(0,i[1]-n[1]*i[0],i[2]-n[2]*i[0],i[3]-n[3]*i[0],-n[4]*i[0]),s=1+n[1]+n[2]+n[3]+n[4],a=(i[0]+i[1]+i[2]+i[3])/s,o=(r[1]+r[2]+r[3]+r[4])/s;return{sigma:e,negative:t,a:n,b_causal:i,b_anticausal:r,sum_causal:a,sum_anticausal:o}}function UMe(e,t,n){const r=Float64Array.of(.84,1.8675,.84,-1.8675,-.34015,-.1299,-.34015,.1299),s=Math.exp(-1.783/n),a=Math.exp(-1.723/n),o=.6318/n,u=1.997/n,l=Float64Array.of(-s*Math.cos(o),s*Math.sin(o),-s*Math.cos(-o),s*Math.sin(-o),-a*Math.cos(u),a*Math.sin(u),-a*Math.cos(-u),a*Math.sin(-u)),c=n*2.5066282746310007,f=Float64Array.of(r[0],r[1],0,0,0,0,0,0),d=Float64Array.of(1,0,l[0],l[1],0,0,0,0,0,0);let p,m;for(m=2;m<8;m+=2){for(f[m]=l[m]*f[m-2]-l[m+1]*f[m-1],f[m+1]=l[m]*f[m-1]+l[m+1]*f[m-2],p=m-2;p>0;p-=2)f[p]+=l[m]*f[p-2]-l[m+1]*f[p-1],f[p+1]+=l[m]*f[p-1]+l[m+1]*f[p-2];for(p=0;p<=m;p+=2)f[p]+=r[m]*d[p]-r[m+1]*d[p+1],f[p+1]+=r[m]*d[p+1]+r[m+1]*d[p];for(d[m+2]=l[m]*d[m]-l[m+1]*d[m+1],d[m+3]=l[m]*d[m+1]+l[m+1]*d[m],p=m;p>0;p-=2)d[p]+=l[m]*d[p-2]-l[m+1]*d[p-1],d[p+1]+=l[m]*d[p-1]+l[m+1]*d[p-2]}for(m=0;m<4;++m)p=m<<1,t[m]=f[p]/c,e[m+1]=d[p+2]}function jMe(e,t,n,i=1,r=new Float64Array(n),s=new Float64Array(n),a=new Float64Array(5),o=r,u=qMe){const l=i*2,c=i*3,f=i*4,d=i*n;let p,m;for(u(r,t,n,i,e.b_causal,3,e.a,4,e.sum_causal,a,e.sigma),m=4,p=f;m<n;++m,p+=i)r[m]=e.b_causal[0]*t[p]+e.b_causal[1]*t[p-i]+e.b_causal[2]*t[p-l]+e.b_causal[3]*t[p-c]-e.a[1]*r[m-1]-e.a[2]*r[m-2]-e.a[3]*r[m-3]-e.a[4]*r[m-4];for(u(s,t,n,-i,e.b_anticausal,4,e.a,4,e.sum_anticausal,a,e.sigma),m=4,p=d-i*5;m<n;++m,p-=i)s[m]=e.b_anticausal[1]*t[p+i]+e.b_anticausal[2]*t[p+l]+e.b_anticausal[3]*t[p+c]+e.b_anticausal[4]*t[p+f]-e.a[1]*s[m-1]-e.a[2]*s[m-2]-e.a[3]*s[m-3]-e.a[4]*s[m-4];if(e.negative)for(m=0,p=0;m<n;++m,p+=i)o[p]=r[m]+s[n-m-1];else for(m=0,p=0;m<n;++m,p+=i)o[p]=Math.max(0,r[m]+s[n-m-1]);return o}function qMe(e,t,n,i,r,s,a,o,u,l,c,f=.5){const d=Math.abs(i)*n,p=i<0?d+i:0;let m,y,v;for(y=0;y<o;++y)for(l[y]=y<=s?r[y]:0,v=1;v<=o&&v<=y;++v)l[y]-=a[v]*l[y-v];for(v=0;v<o;++v)for(e[v]=0,y=1;y<=v;++y)m=p+i*y,m>=0&&m<d&&(e[v]+=l[v-y]*t[m]);const b=t[p],_=Math.ceil(c*10);for(y=0;y<_;++y){for(v=0;v<o;++v)e[v]+=l[v]*b;if(u-=Math.abs(l[0]),u<=f)break;for(l[o]=y+o<=s?r[y+o]:0,v=1;v<=o;++v)l[o]-=a[v]*l[o-v];for(v=0;v<o;++v)l[v]=l[v+1]}}function VMe(e,t,n=0){const i=e.length;let r,s;for(let a=0;a<i;++a){const o=t(e[a],a,e);o!=null&&(r===void 0?o>=o&&(r=s=o):(o<r&&(r=o),o>s&&(s=o)))}return[r-n,s+n]}function FG(e,t){const n=e.map(t).filter(l=>l!=null&&l>=l);n.sort((l,c)=>l-c);const i=WMe(n),r=WP(n,.25),s=WP(n,.75),a=n.length,o=(s-r)/1.34;return 1.06*(Math.min(i,o)||i||Math.abs(r)||1)*Math.pow(a,-.2)}function WMe(e){const t=e.length;let n=0,i,r=0,s=0;for(let a=0;a<t;++a){const o=e[a];i=o-r,r+=i/++n,s+=i*(o-r)}return n>1?Math.sqrt(s/(n-1)):NaN}function WP(e,t){const n=e.length;if(!n)return NaN;if((t=+t)<=0||n<2)return e[0];if(t>=1)return e[n-1];const i=(n-1)*t,r=Math.floor(i),s=e[r];return s+(e[r+1]-s)*(i-r)}function GMe(e,t={}){const{adjust:n=1,pad:i=3,bins:r=512}=t,s=qP(t.x,b=>b),a=qP(t.weight,()=>1/e.length);let o=t.bandwidth??n*FG(e,s);const[u,l]=t.extent??VMe(e,s,i*o),c=BMe(e,s,a,u,l,r),f=(l-u)/(r-1),d=c.some(b=>b<0);let p=VP(o/f,d),m;function*y(b="x",_="y"){const E=v.grid(),S=1/f;for(let A=0;A<r;++A)yield{[b]:u+A*f,[_]:E[A]*S}}const v={[Symbol.iterator]:y,points:y,grid:()=>m||(m=jMe(p,c,r)),extent:()=>[u,l],bandwidth(b){return arguments.length?(b!==o&&(o=b,m=null,p=VP(o/f,d)),v):o}};return v}var Rp={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var HMe=Rp.exports,GP;function YMe(){return GP||(GP=1,function(e,t){(function(){var n,i="4.17.21",r=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",o="Invalid `variable` option passed into `_.template`",u="__lodash_hash_undefined__",l=500,c="__lodash_placeholder__",f=1,d=2,p=4,m=1,y=2,v=1,b=2,_=4,E=8,S=16,A=32,$=64,C=128,M=256,N=512,P=30,D="...",W=800,q=16,z=1,R=2,U=3,G=1/0,Z=9007199254740991,J=17976931348623157e292,he=NaN,we=4294967295,Ce=we-1,ze=we>>>1,bt=[["ary",C],["bind",v],["bindKey",b],["curry",E],["curryRight",S],["flip",N],["partial",A],["partialRight",$],["rearg",M]],Ie="[object Arguments]",nn="[object Array]",Va="[object AsyncFunction]",Di="[object Boolean]",ye="[object Date]",Ue="[object DOMException]",je="[object Error]",ae="[object Function]",fn="[object GeneratorFunction]",Ge="[object Map]",Ht="[object Number]",hn="[object Null]",dn="[object Object]",gl="[object Promise]",yX="[object Proxy]",yd="[object RegExp]",os="[object Set]",vd="[object String]",B0="[object Symbol]",vX="[object Undefined]",xd="[object WeakMap]",xX="[object WeakSet]",bd="[object ArrayBuffer]",Hc="[object DataView]",c2="[object Float32Array]",f2="[object Float64Array]",h2="[object Int8Array]",d2="[object Int16Array]",p2="[object Int32Array]",g2="[object Uint8Array]",m2="[object Uint8ClampedArray]",y2="[object Uint16Array]",v2="[object Uint32Array]",bX=/\b__p \+= '';/g,_X=/\b(__p \+=) '' \+/g,wX=/(__e\(.*?\)|\b__t\)) \+\n'';/g,TF=/&(?:amp|lt|gt|quot|#39);/g,OF=/[&<>"']/g,EX=RegExp(TF.source),SX=RegExp(OF.source),AX=/<%-([\s\S]+?)%>/g,CX=/<%([\s\S]+?)%>/g,FF=/<%=([\s\S]+?)%>/g,kX=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,$X=/^\w*$/,TX=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,x2=/[\\^$.*+?()[\]{}|]/g,OX=RegExp(x2.source),b2=/^\s+/,FX=/\s/,MX=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,NX=/\{\n\/\* \[wrapped with (.+)\] \*/,RX=/,? & /,IX=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,DX=/[()=,{}\[\]\/\s]/,PX=/\\(\\)?/g,LX=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,MF=/\w*$/,zX=/^[-+]0x[0-9a-f]+$/i,BX=/^0b[01]+$/i,UX=/^\[object .+?Constructor\]$/,jX=/^0o[0-7]+$/i,qX=/^(?:0|[1-9]\d*)$/,VX=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,U0=/($^)/,WX=/['\n\r\u2028\u2029\\]/g,j0="\\ud800-\\udfff",GX="\\u0300-\\u036f",HX="\\ufe20-\\ufe2f",YX="\\u20d0-\\u20ff",NF=GX+HX+YX,RF="\\u2700-\\u27bf",IF="a-z\\xdf-\\xf6\\xf8-\\xff",XX="\\xac\\xb1\\xd7\\xf7",KX="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",JX="\\u2000-\\u206f",QX=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",DF="A-Z\\xc0-\\xd6\\xd8-\\xde",PF="\\ufe0e\\ufe0f",LF=XX+KX+JX+QX,_2="['’]",ZX="["+j0+"]",zF="["+LF+"]",q0="["+NF+"]",BF="\\d+",eK="["+RF+"]",UF="["+IF+"]",jF="[^"+j0+LF+BF+RF+IF+DF+"]",w2="\\ud83c[\\udffb-\\udfff]",tK="(?:"+q0+"|"+w2+")",qF="[^"+j0+"]",E2="(?:\\ud83c[\\udde6-\\uddff]){2}",S2="[\\ud800-\\udbff][\\udc00-\\udfff]",Yc="["+DF+"]",VF="\\u200d",WF="(?:"+UF+"|"+jF+")",nK="(?:"+Yc+"|"+jF+")",GF="(?:"+_2+"(?:d|ll|m|re|s|t|ve))?",HF="(?:"+_2+"(?:D|LL|M|RE|S|T|VE))?",YF=tK+"?",XF="["+PF+"]?",iK="(?:"+VF+"(?:"+[qF,E2,S2].join("|")+")"+XF+YF+")*",rK="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",sK="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",KF=XF+YF+iK,aK="(?:"+[eK,E2,S2].join("|")+")"+KF,oK="(?:"+[qF+q0+"?",q0,E2,S2,ZX].join("|")+")",uK=RegExp(_2,"g"),lK=RegExp(q0,"g"),A2=RegExp(w2+"(?="+w2+")|"+oK+KF,"g"),cK=RegExp([Yc+"?"+UF+"+"+GF+"(?="+[zF,Yc,"$"].join("|")+")",nK+"+"+HF+"(?="+[zF,Yc+WF,"$"].join("|")+")",Yc+"?"+WF+"+"+GF,Yc+"+"+HF,sK,rK,BF,aK].join("|"),"g"),fK=RegExp("["+VF+j0+NF+PF+"]"),hK=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,dK=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],pK=-1,Rt={};Rt[c2]=Rt[f2]=Rt[h2]=Rt[d2]=Rt[p2]=Rt[g2]=Rt[m2]=Rt[y2]=Rt[v2]=!0,Rt[Ie]=Rt[nn]=Rt[bd]=Rt[Di]=Rt[Hc]=Rt[ye]=Rt[je]=Rt[ae]=Rt[Ge]=Rt[Ht]=Rt[dn]=Rt[yd]=Rt[os]=Rt[vd]=Rt[xd]=!1;var Ft={};Ft[Ie]=Ft[nn]=Ft[bd]=Ft[Hc]=Ft[Di]=Ft[ye]=Ft[c2]=Ft[f2]=Ft[h2]=Ft[d2]=Ft[p2]=Ft[Ge]=Ft[Ht]=Ft[dn]=Ft[yd]=Ft[os]=Ft[vd]=Ft[B0]=Ft[g2]=Ft[m2]=Ft[y2]=Ft[v2]=!0,Ft[je]=Ft[ae]=Ft[xd]=!1;var gK={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},mK={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},yK={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},vK={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},xK=parseFloat,bK=parseInt,JF=typeof Fm=="object"&&Fm&&Fm.Object===Object&&Fm,_K=typeof self=="object"&&self&&self.Object===Object&&self,Ln=JF||_K||Function("return this")(),C2=t&&!t.nodeType&&t,ml=C2&&!0&&e&&!e.nodeType&&e,QF=ml&&ml.exports===C2,k2=QF&&JF.process,Cr=function(){try{var B=ml&&ml.require&&ml.require("util").types;return B||k2&&k2.binding&&k2.binding("util")}catch{}}(),ZF=Cr&&Cr.isArrayBuffer,eM=Cr&&Cr.isDate,tM=Cr&&Cr.isMap,nM=Cr&&Cr.isRegExp,iM=Cr&&Cr.isSet,rM=Cr&&Cr.isTypedArray;function ir(B,X,V){switch(V.length){case 0:return B.call(X);case 1:return B.call(X,V[0]);case 2:return B.call(X,V[0],V[1]);case 3:return B.call(X,V[0],V[1],V[2])}return B.apply(X,V)}function wK(B,X,V,xe){for(var Be=-1,mt=B==null?0:B.length;++Be<mt;){var gn=B[Be];X(xe,gn,V(gn),B)}return xe}function kr(B,X){for(var V=-1,xe=B==null?0:B.length;++V<xe&&X(B[V],V,B)!==!1;);return B}function EK(B,X){for(var V=B==null?0:B.length;V--&&X(B[V],V,B)!==!1;);return B}function sM(B,X){for(var V=-1,xe=B==null?0:B.length;++V<xe;)if(!X(B[V],V,B))return!1;return!0}function Xo(B,X){for(var V=-1,xe=B==null?0:B.length,Be=0,mt=[];++V<xe;){var gn=B[V];X(gn,V,B)&&(mt[Be++]=gn)}return mt}function V0(B,X){var V=B==null?0:B.length;return!!V&&Xc(B,X,0)>-1}function $2(B,X,V){for(var xe=-1,Be=B==null?0:B.length;++xe<Be;)if(V(X,B[xe]))return!0;return!1}function Pt(B,X){for(var V=-1,xe=B==null?0:B.length,Be=Array(xe);++V<xe;)Be[V]=X(B[V],V,B);return Be}function Ko(B,X){for(var V=-1,xe=X.length,Be=B.length;++V<xe;)B[Be+V]=X[V];return B}function T2(B,X,V,xe){var Be=-1,mt=B==null?0:B.length;for(xe&&mt&&(V=B[++Be]);++Be<mt;)V=X(V,B[Be],Be,B);return V}function SK(B,X,V,xe){var Be=B==null?0:B.length;for(xe&&Be&&(V=B[--Be]);Be--;)V=X(V,B[Be],Be,B);return V}function O2(B,X){for(var V=-1,xe=B==null?0:B.length;++V<xe;)if(X(B[V],V,B))return!0;return!1}var AK=F2("length");function CK(B){return B.split("")}function kK(B){return B.match(IX)||[]}function aM(B,X,V){var xe;return V(B,function(Be,mt,gn){if(X(Be,mt,gn))return xe=mt,!1}),xe}function W0(B,X,V,xe){for(var Be=B.length,mt=V+(xe?1:-1);xe?mt--:++mt<Be;)if(X(B[mt],mt,B))return mt;return-1}function Xc(B,X,V){return X===X?zK(B,X,V):W0(B,oM,V)}function $K(B,X,V,xe){for(var Be=V-1,mt=B.length;++Be<mt;)if(xe(B[Be],X))return Be;return-1}function oM(B){return B!==B}function uM(B,X){var V=B==null?0:B.length;return V?N2(B,X)/V:he}function F2(B){return function(X){return X==null?n:X[B]}}function M2(B){return function(X){return B==null?n:B[X]}}function lM(B,X,V,xe,Be){return Be(B,function(mt,gn,Tt){V=xe?(xe=!1,mt):X(V,mt,gn,Tt)}),V}function TK(B,X){var V=B.length;for(B.sort(X);V--;)B[V]=B[V].value;return B}function N2(B,X){for(var V,xe=-1,Be=B.length;++xe<Be;){var mt=X(B[xe]);mt!==n&&(V=V===n?mt:V+mt)}return V}function R2(B,X){for(var V=-1,xe=Array(B);++V<B;)xe[V]=X(V);return xe}function OK(B,X){return Pt(X,function(V){return[V,B[V]]})}function cM(B){return B&&B.slice(0,pM(B)+1).replace(b2,"")}function rr(B){return function(X){return B(X)}}function I2(B,X){return Pt(X,function(V){return B[V]})}function _d(B,X){return B.has(X)}function fM(B,X){for(var V=-1,xe=B.length;++V<xe&&Xc(X,B[V],0)>-1;);return V}function hM(B,X){for(var V=B.length;V--&&Xc(X,B[V],0)>-1;);return V}function FK(B,X){for(var V=B.length,xe=0;V--;)B[V]===X&&++xe;return xe}var MK=M2(gK),NK=M2(mK);function RK(B){return"\\"+vK[B]}function IK(B,X){return B==null?n:B[X]}function Kc(B){return fK.test(B)}function DK(B){return hK.test(B)}function PK(B){for(var X,V=[];!(X=B.next()).done;)V.push(X.value);return V}function D2(B){var X=-1,V=Array(B.size);return B.forEach(function(xe,Be){V[++X]=[Be,xe]}),V}function dM(B,X){return function(V){return B(X(V))}}function Jo(B,X){for(var V=-1,xe=B.length,Be=0,mt=[];++V<xe;){var gn=B[V];(gn===X||gn===c)&&(B[V]=c,mt[Be++]=V)}return mt}function G0(B){var X=-1,V=Array(B.size);return B.forEach(function(xe){V[++X]=xe}),V}function LK(B){var X=-1,V=Array(B.size);return B.forEach(function(xe){V[++X]=[xe,xe]}),V}function zK(B,X,V){for(var xe=V-1,Be=B.length;++xe<Be;)if(B[xe]===X)return xe;return-1}function BK(B,X,V){for(var xe=V+1;xe--;)if(B[xe]===X)return xe;return xe}function Jc(B){return Kc(B)?jK(B):AK(B)}function us(B){return Kc(B)?qK(B):CK(B)}function pM(B){for(var X=B.length;X--&&FX.test(B.charAt(X)););return X}var UK=M2(yK);function jK(B){for(var X=A2.lastIndex=0;A2.test(B);)++X;return X}function qK(B){return B.match(A2)||[]}function VK(B){return B.match(cK)||[]}var WK=function B(X){X=X==null?Ln:Qc.defaults(Ln.Object(),X,Qc.pick(Ln,dK));var V=X.Array,xe=X.Date,Be=X.Error,mt=X.Function,gn=X.Math,Tt=X.Object,P2=X.RegExp,GK=X.String,$r=X.TypeError,H0=V.prototype,HK=mt.prototype,Zc=Tt.prototype,Y0=X["__core-js_shared__"],X0=HK.toString,_t=Zc.hasOwnProperty,YK=0,gM=function(){var h=/[^.]+$/.exec(Y0&&Y0.keys&&Y0.keys.IE_PROTO||"");return h?"Symbol(src)_1."+h:""}(),K0=Zc.toString,XK=X0.call(Tt),KK=Ln._,JK=P2("^"+X0.call(_t).replace(x2,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),J0=QF?X.Buffer:n,Qo=X.Symbol,Q0=X.Uint8Array,mM=J0?J0.allocUnsafe:n,Z0=dM(Tt.getPrototypeOf,Tt),yM=Tt.create,vM=Zc.propertyIsEnumerable,em=H0.splice,xM=Qo?Qo.isConcatSpreadable:n,wd=Qo?Qo.iterator:n,yl=Qo?Qo.toStringTag:n,tm=function(){try{var h=wl(Tt,"defineProperty");return h({},"",{}),h}catch{}}(),QK=X.clearTimeout!==Ln.clearTimeout&&X.clearTimeout,ZK=xe&&xe.now!==Ln.Date.now&&xe.now,eJ=X.setTimeout!==Ln.setTimeout&&X.setTimeout,nm=gn.ceil,im=gn.floor,L2=Tt.getOwnPropertySymbols,tJ=J0?J0.isBuffer:n,bM=X.isFinite,nJ=H0.join,iJ=dM(Tt.keys,Tt),mn=gn.max,Qn=gn.min,rJ=xe.now,sJ=X.parseInt,_M=gn.random,aJ=H0.reverse,z2=wl(X,"DataView"),Ed=wl(X,"Map"),B2=wl(X,"Promise"),ef=wl(X,"Set"),Sd=wl(X,"WeakMap"),Ad=wl(Tt,"create"),rm=Sd&&new Sd,tf={},oJ=El(z2),uJ=El(Ed),lJ=El(B2),cJ=El(ef),fJ=El(Sd),sm=Qo?Qo.prototype:n,Cd=sm?sm.valueOf:n,wM=sm?sm.toString:n;function O(h){if(Yt(h)&&!qe(h)&&!(h instanceof tt)){if(h instanceof Tr)return h;if(_t.call(h,"__wrapped__"))return EN(h)}return new Tr(h)}var nf=function(){function h(){}return function(g){if(!jt(g))return{};if(yM)return yM(g);h.prototype=g;var x=new h;return h.prototype=n,x}}();function am(){}function Tr(h,g){this.__wrapped__=h,this.__actions__=[],this.__chain__=!!g,this.__index__=0,this.__values__=n}O.templateSettings={escape:AX,evaluate:CX,interpolate:FF,variable:"",imports:{_:O}},O.prototype=am.prototype,O.prototype.constructor=O,Tr.prototype=nf(am.prototype),Tr.prototype.constructor=Tr;function tt(h){this.__wrapped__=h,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=we,this.__views__=[]}function hJ(){var h=new tt(this.__wrapped__);return h.__actions__=Pi(this.__actions__),h.__dir__=this.__dir__,h.__filtered__=this.__filtered__,h.__iteratees__=Pi(this.__iteratees__),h.__takeCount__=this.__takeCount__,h.__views__=Pi(this.__views__),h}function dJ(){if(this.__filtered__){var h=new tt(this);h.__dir__=-1,h.__filtered__=!0}else h=this.clone(),h.__dir__*=-1;return h}function pJ(){var h=this.__wrapped__.value(),g=this.__dir__,x=qe(h),w=g<0,k=x?h.length:0,F=CQ(0,k,this.__views__),I=F.start,L=F.end,j=L-I,ee=w?L:I-1,te=this.__iteratees__,ie=te.length,me=0,Se=Qn(j,this.__takeCount__);if(!x||!w&&k==j&&Se==j)return GM(h,this.__actions__);var Ne=[];e:for(;j--&&me<Se;){ee+=g;for(var Xe=-1,Re=h[ee];++Xe<ie;){var et=te[Xe],rt=et.iteratee,or=et.type,mi=rt(Re);if(or==R)Re=mi;else if(!mi){if(or==z)continue e;break e}}Ne[me++]=Re}return Ne}tt.prototype=nf(am.prototype),tt.prototype.constructor=tt;function vl(h){var g=-1,x=h==null?0:h.length;for(this.clear();++g<x;){var w=h[g];this.set(w[0],w[1])}}function gJ(){this.__data__=Ad?Ad(null):{},this.size=0}function mJ(h){var g=this.has(h)&&delete this.__data__[h];return this.size-=g?1:0,g}function yJ(h){var g=this.__data__;if(Ad){var x=g[h];return x===u?n:x}return _t.call(g,h)?g[h]:n}function vJ(h){var g=this.__data__;return Ad?g[h]!==n:_t.call(g,h)}function xJ(h,g){var x=this.__data__;return this.size+=this.has(h)?0:1,x[h]=Ad&&g===n?u:g,this}vl.prototype.clear=gJ,vl.prototype.delete=mJ,vl.prototype.get=yJ,vl.prototype.has=vJ,vl.prototype.set=xJ;function Wa(h){var g=-1,x=h==null?0:h.length;for(this.clear();++g<x;){var w=h[g];this.set(w[0],w[1])}}function bJ(){this.__data__=[],this.size=0}function _J(h){var g=this.__data__,x=om(g,h);if(x<0)return!1;var w=g.length-1;return x==w?g.pop():em.call(g,x,1),--this.size,!0}function wJ(h){var g=this.__data__,x=om(g,h);return x<0?n:g[x][1]}function EJ(h){return om(this.__data__,h)>-1}function SJ(h,g){var x=this.__data__,w=om(x,h);return w<0?(++this.size,x.push([h,g])):x[w][1]=g,this}Wa.prototype.clear=bJ,Wa.prototype.delete=_J,Wa.prototype.get=wJ,Wa.prototype.has=EJ,Wa.prototype.set=SJ;function Ga(h){var g=-1,x=h==null?0:h.length;for(this.clear();++g<x;){var w=h[g];this.set(w[0],w[1])}}function AJ(){this.size=0,this.__data__={hash:new vl,map:new(Ed||Wa),string:new vl}}function CJ(h){var g=xm(this,h).delete(h);return this.size-=g?1:0,g}function kJ(h){return xm(this,h).get(h)}function $J(h){return xm(this,h).has(h)}function TJ(h,g){var x=xm(this,h),w=x.size;return x.set(h,g),this.size+=x.size==w?0:1,this}Ga.prototype.clear=AJ,Ga.prototype.delete=CJ,Ga.prototype.get=kJ,Ga.prototype.has=$J,Ga.prototype.set=TJ;function xl(h){var g=-1,x=h==null?0:h.length;for(this.__data__=new Ga;++g<x;)this.add(h[g])}function OJ(h){return this.__data__.set(h,u),this}function FJ(h){return this.__data__.has(h)}xl.prototype.add=xl.prototype.push=OJ,xl.prototype.has=FJ;function ls(h){var g=this.__data__=new Wa(h);this.size=g.size}function MJ(){this.__data__=new Wa,this.size=0}function NJ(h){var g=this.__data__,x=g.delete(h);return this.size=g.size,x}function RJ(h){return this.__data__.get(h)}function IJ(h){return this.__data__.has(h)}function DJ(h,g){var x=this.__data__;if(x instanceof Wa){var w=x.__data__;if(!Ed||w.length<r-1)return w.push([h,g]),this.size=++x.size,this;x=this.__data__=new Ga(w)}return x.set(h,g),this.size=x.size,this}ls.prototype.clear=MJ,ls.prototype.delete=NJ,ls.prototype.get=RJ,ls.prototype.has=IJ,ls.prototype.set=DJ;function EM(h,g){var x=qe(h),w=!x&&Sl(h),k=!x&&!w&&iu(h),F=!x&&!w&&!k&&of(h),I=x||w||k||F,L=I?R2(h.length,GK):[],j=L.length;for(var ee in h)(g||_t.call(h,ee))&&!(I&&(ee=="length"||k&&(ee=="offset"||ee=="parent")||F&&(ee=="buffer"||ee=="byteLength"||ee=="byteOffset")||Ka(ee,j)))&&L.push(ee);return L}function SM(h){var g=h.length;return g?h[J2(0,g-1)]:n}function PJ(h,g){return bm(Pi(h),bl(g,0,h.length))}function LJ(h){return bm(Pi(h))}function U2(h,g,x){(x!==n&&!cs(h[g],x)||x===n&&!(g in h))&&Ha(h,g,x)}function kd(h,g,x){var w=h[g];(!(_t.call(h,g)&&cs(w,x))||x===n&&!(g in h))&&Ha(h,g,x)}function om(h,g){for(var x=h.length;x--;)if(cs(h[x][0],g))return x;return-1}function zJ(h,g,x,w){return Zo(h,function(k,F,I){g(w,k,x(k),I)}),w}function AM(h,g){return h&&Xs(g,kn(g),h)}function BJ(h,g){return h&&Xs(g,zi(g),h)}function Ha(h,g,x){g=="__proto__"&&tm?tm(h,g,{configurable:!0,enumerable:!0,value:x,writable:!0}):h[g]=x}function j2(h,g){for(var x=-1,w=g.length,k=V(w),F=h==null;++x<w;)k[x]=F?n:w_(h,g[x]);return k}function bl(h,g,x){return h===h&&(x!==n&&(h=h<=x?h:x),g!==n&&(h=h>=g?h:g)),h}function Or(h,g,x,w,k,F){var I,L=g&f,j=g&d,ee=g&p;if(x&&(I=k?x(h,w,k,F):x(h)),I!==n)return I;if(!jt(h))return h;var te=qe(h);if(te){if(I=$Q(h),!L)return Pi(h,I)}else{var ie=Zn(h),me=ie==ae||ie==fn;if(iu(h))return XM(h,L);if(ie==dn||ie==Ie||me&&!k){if(I=j||me?{}:pN(h),!L)return j?yQ(h,BJ(I,h)):mQ(h,AM(I,h))}else{if(!Ft[ie])return k?h:{};I=TQ(h,ie,L)}}F||(F=new ls);var Se=F.get(h);if(Se)return Se;F.set(h,I),qN(h)?h.forEach(function(Re){I.add(Or(Re,g,x,Re,h,F))}):UN(h)&&h.forEach(function(Re,et){I.set(et,Or(Re,g,x,et,h,F))});var Ne=ee?j?u_:o_:j?zi:kn,Xe=te?n:Ne(h);return kr(Xe||h,function(Re,et){Xe&&(et=Re,Re=h[et]),kd(I,et,Or(Re,g,x,et,h,F))}),I}function UJ(h){var g=kn(h);return function(x){return CM(x,h,g)}}function CM(h,g,x){var w=x.length;if(h==null)return!w;for(h=Tt(h);w--;){var k=x[w],F=g[k],I=h[k];if(I===n&&!(k in h)||!F(I))return!1}return!0}function kM(h,g,x){if(typeof h!="function")throw new $r(a);return Rd(function(){h.apply(n,x)},g)}function $d(h,g,x,w){var k=-1,F=V0,I=!0,L=h.length,j=[],ee=g.length;if(!L)return j;x&&(g=Pt(g,rr(x))),w?(F=$2,I=!1):g.length>=r&&(F=_d,I=!1,g=new xl(g));e:for(;++k<L;){var te=h[k],ie=x==null?te:x(te);if(te=w||te!==0?te:0,I&&ie===ie){for(var me=ee;me--;)if(g[me]===ie)continue e;j.push(te)}else F(g,ie,w)||j.push(te)}return j}var Zo=eN(Ys),$M=eN(V2,!0);function jJ(h,g){var x=!0;return Zo(h,function(w,k,F){return x=!!g(w,k,F),x}),x}function um(h,g,x){for(var w=-1,k=h.length;++w<k;){var F=h[w],I=g(F);if(I!=null&&(L===n?I===I&&!ar(I):x(I,L)))var L=I,j=F}return j}function qJ(h,g,x,w){var k=h.length;for(x=He(x),x<0&&(x=-x>k?0:k+x),w=w===n||w>k?k:He(w),w<0&&(w+=k),w=x>w?0:WN(w);x<w;)h[x++]=g;return h}function TM(h,g){var x=[];return Zo(h,function(w,k,F){g(w,k,F)&&x.push(w)}),x}function zn(h,g,x,w,k){var F=-1,I=h.length;for(x||(x=FQ),k||(k=[]);++F<I;){var L=h[F];g>0&&x(L)?g>1?zn(L,g-1,x,w,k):Ko(k,L):w||(k[k.length]=L)}return k}var q2=tN(),OM=tN(!0);function Ys(h,g){return h&&q2(h,g,kn)}function V2(h,g){return h&&OM(h,g,kn)}function lm(h,g){return Xo(g,function(x){return Ja(h[x])})}function _l(h,g){g=tu(g,h);for(var x=0,w=g.length;h!=null&&x<w;)h=h[Ks(g[x++])];return x&&x==w?h:n}function FM(h,g,x){var w=g(h);return qe(h)?w:Ko(w,x(h))}function pi(h){return h==null?h===n?vX:hn:yl&&yl in Tt(h)?AQ(h):LQ(h)}function W2(h,g){return h>g}function VJ(h,g){return h!=null&&_t.call(h,g)}function WJ(h,g){return h!=null&&g in Tt(h)}function GJ(h,g,x){return h>=Qn(g,x)&&h<mn(g,x)}function G2(h,g,x){for(var w=x?$2:V0,k=h[0].length,F=h.length,I=F,L=V(F),j=1/0,ee=[];I--;){var te=h[I];I&&g&&(te=Pt(te,rr(g))),j=Qn(te.length,j),L[I]=!x&&(g||k>=120&&te.length>=120)?new xl(I&&te):n}te=h[0];var ie=-1,me=L[0];e:for(;++ie<k&&ee.length<j;){var Se=te[ie],Ne=g?g(Se):Se;if(Se=x||Se!==0?Se:0,!(me?_d(me,Ne):w(ee,Ne,x))){for(I=F;--I;){var Xe=L[I];if(!(Xe?_d(Xe,Ne):w(h[I],Ne,x)))continue e}me&&me.push(Ne),ee.push(Se)}}return ee}function HJ(h,g,x,w){return Ys(h,function(k,F,I){g(w,x(k),F,I)}),w}function Td(h,g,x){g=tu(g,h),h=vN(h,g);var w=h==null?h:h[Ks(Mr(g))];return w==null?n:ir(w,h,x)}function MM(h){return Yt(h)&&pi(h)==Ie}function YJ(h){return Yt(h)&&pi(h)==bd}function XJ(h){return Yt(h)&&pi(h)==ye}function Od(h,g,x,w,k){return h===g?!0:h==null||g==null||!Yt(h)&&!Yt(g)?h!==h&&g!==g:KJ(h,g,x,w,Od,k)}function KJ(h,g,x,w,k,F){var I=qe(h),L=qe(g),j=I?nn:Zn(h),ee=L?nn:Zn(g);j=j==Ie?dn:j,ee=ee==Ie?dn:ee;var te=j==dn,ie=ee==dn,me=j==ee;if(me&&iu(h)){if(!iu(g))return!1;I=!0,te=!1}if(me&&!te)return F||(F=new ls),I||of(h)?fN(h,g,x,w,k,F):EQ(h,g,j,x,w,k,F);if(!(x&m)){var Se=te&&_t.call(h,"__wrapped__"),Ne=ie&&_t.call(g,"__wrapped__");if(Se||Ne){var Xe=Se?h.value():h,Re=Ne?g.value():g;return F||(F=new ls),k(Xe,Re,x,w,F)}}return me?(F||(F=new ls),SQ(h,g,x,w,k,F)):!1}function JJ(h){return Yt(h)&&Zn(h)==Ge}function H2(h,g,x,w){var k=x.length,F=k,I=!w;if(h==null)return!F;for(h=Tt(h);k--;){var L=x[k];if(I&&L[2]?L[1]!==h[L[0]]:!(L[0]in h))return!1}for(;++k<F;){L=x[k];var j=L[0],ee=h[j],te=L[1];if(I&&L[2]){if(ee===n&&!(j in h))return!1}else{var ie=new ls;if(w)var me=w(ee,te,j,h,g,ie);if(!(me===n?Od(te,ee,m|y,w,ie):me))return!1}}return!0}function NM(h){if(!jt(h)||NQ(h))return!1;var g=Ja(h)?JK:UX;return g.test(El(h))}function QJ(h){return Yt(h)&&pi(h)==yd}function ZJ(h){return Yt(h)&&Zn(h)==os}function eQ(h){return Yt(h)&&Cm(h.length)&&!!Rt[pi(h)]}function RM(h){return typeof h=="function"?h:h==null?Bi:typeof h=="object"?qe(h)?PM(h[0],h[1]):DM(h):nR(h)}function Y2(h){if(!Nd(h))return iJ(h);var g=[];for(var x in Tt(h))_t.call(h,x)&&x!="constructor"&&g.push(x);return g}function tQ(h){if(!jt(h))return PQ(h);var g=Nd(h),x=[];for(var w in h)w=="constructor"&&(g||!_t.call(h,w))||x.push(w);return x}function X2(h,g){return h<g}function IM(h,g){var x=-1,w=Li(h)?V(h.length):[];return Zo(h,function(k,F,I){w[++x]=g(k,F,I)}),w}function DM(h){var g=c_(h);return g.length==1&&g[0][2]?mN(g[0][0],g[0][1]):function(x){return x===h||H2(x,h,g)}}function PM(h,g){return h_(h)&&gN(g)?mN(Ks(h),g):function(x){var w=w_(x,h);return w===n&&w===g?E_(x,h):Od(g,w,m|y)}}function cm(h,g,x,w,k){h!==g&&q2(g,function(F,I){if(k||(k=new ls),jt(F))nQ(h,g,I,x,cm,w,k);else{var L=w?w(p_(h,I),F,I+"",h,g,k):n;L===n&&(L=F),U2(h,I,L)}},zi)}function nQ(h,g,x,w,k,F,I){var L=p_(h,x),j=p_(g,x),ee=I.get(j);if(ee){U2(h,x,ee);return}var te=F?F(L,j,x+"",h,g,I):n,ie=te===n;if(ie){var me=qe(j),Se=!me&&iu(j),Ne=!me&&!Se&&of(j);te=j,me||Se||Ne?qe(L)?te=L:rn(L)?te=Pi(L):Se?(ie=!1,te=XM(j,!0)):Ne?(ie=!1,te=KM(j,!0)):te=[]:Id(j)||Sl(j)?(te=L,Sl(L)?te=GN(L):(!jt(L)||Ja(L))&&(te=pN(j))):ie=!1}ie&&(I.set(j,te),k(te,j,w,F,I),I.delete(j)),U2(h,x,te)}function LM(h,g){var x=h.length;if(x)return g+=g<0?x:0,Ka(g,x)?h[g]:n}function zM(h,g,x){g.length?g=Pt(g,function(F){return qe(F)?function(I){return _l(I,F.length===1?F[0]:F)}:F}):g=[Bi];var w=-1;g=Pt(g,rr(Me()));var k=IM(h,function(F,I,L){var j=Pt(g,function(ee){return ee(F)});return{criteria:j,index:++w,value:F}});return TK(k,function(F,I){return gQ(F,I,x)})}function iQ(h,g){return BM(h,g,function(x,w){return E_(h,w)})}function BM(h,g,x){for(var w=-1,k=g.length,F={};++w<k;){var I=g[w],L=_l(h,I);x(L,I)&&Fd(F,tu(I,h),L)}return F}function rQ(h){return function(g){return _l(g,h)}}function K2(h,g,x,w){var k=w?$K:Xc,F=-1,I=g.length,L=h;for(h===g&&(g=Pi(g)),x&&(L=Pt(h,rr(x)));++F<I;)for(var j=0,ee=g[F],te=x?x(ee):ee;(j=k(L,te,j,w))>-1;)L!==h&&em.call(L,j,1),em.call(h,j,1);return h}function UM(h,g){for(var x=h?g.length:0,w=x-1;x--;){var k=g[x];if(x==w||k!==F){var F=k;Ka(k)?em.call(h,k,1):e_(h,k)}}return h}function J2(h,g){return h+im(_M()*(g-h+1))}function sQ(h,g,x,w){for(var k=-1,F=mn(nm((g-h)/(x||1)),0),I=V(F);F--;)I[w?F:++k]=h,h+=x;return I}function Q2(h,g){var x="";if(!h||g<1||g>Z)return x;do g%2&&(x+=h),g=im(g/2),g&&(h+=h);while(g);return x}function Ke(h,g){return g_(yN(h,g,Bi),h+"")}function aQ(h){return SM(uf(h))}function oQ(h,g){var x=uf(h);return bm(x,bl(g,0,x.length))}function Fd(h,g,x,w){if(!jt(h))return h;g=tu(g,h);for(var k=-1,F=g.length,I=F-1,L=h;L!=null&&++k<F;){var j=Ks(g[k]),ee=x;if(j==="__proto__"||j==="constructor"||j==="prototype")return h;if(k!=I){var te=L[j];ee=w?w(te,j,L):n,ee===n&&(ee=jt(te)?te:Ka(g[k+1])?[]:{})}kd(L,j,ee),L=L[j]}return h}var jM=rm?function(h,g){return rm.set(h,g),h}:Bi,uQ=tm?function(h,g){return tm(h,"toString",{configurable:!0,enumerable:!1,value:A_(g),writable:!0})}:Bi;function lQ(h){return bm(uf(h))}function Fr(h,g,x){var w=-1,k=h.length;g<0&&(g=-g>k?0:k+g),x=x>k?k:x,x<0&&(x+=k),k=g>x?0:x-g>>>0,g>>>=0;for(var F=V(k);++w<k;)F[w]=h[w+g];return F}function cQ(h,g){var x;return Zo(h,function(w,k,F){return x=g(w,k,F),!x}),!!x}function fm(h,g,x){var w=0,k=h==null?w:h.length;if(typeof g=="number"&&g===g&&k<=ze){for(;w<k;){var F=w+k>>>1,I=h[F];I!==null&&!ar(I)&&(x?I<=g:I<g)?w=F+1:k=F}return k}return Z2(h,g,Bi,x)}function Z2(h,g,x,w){var k=0,F=h==null?0:h.length;if(F===0)return 0;g=x(g);for(var I=g!==g,L=g===null,j=ar(g),ee=g===n;k<F;){var te=im((k+F)/2),ie=x(h[te]),me=ie!==n,Se=ie===null,Ne=ie===ie,Xe=ar(ie);if(I)var Re=w||Ne;else ee?Re=Ne&&(w||me):L?Re=Ne&&me&&(w||!Se):j?Re=Ne&&me&&!Se&&(w||!Xe):Se||Xe?Re=!1:Re=w?ie<=g:ie<g;Re?k=te+1:F=te}return Qn(F,Ce)}function qM(h,g){for(var x=-1,w=h.length,k=0,F=[];++x<w;){var I=h[x],L=g?g(I):I;if(!x||!cs(L,j)){var j=L;F[k++]=I===0?0:I}}return F}function VM(h){return typeof h=="number"?h:ar(h)?he:+h}function sr(h){if(typeof h=="string")return h;if(qe(h))return Pt(h,sr)+"";if(ar(h))return wM?wM.call(h):"";var g=h+"";return g=="0"&&1/h==-1/0?"-0":g}function eu(h,g,x){var w=-1,k=V0,F=h.length,I=!0,L=[],j=L;if(x)I=!1,k=$2;else if(F>=r){var ee=g?null:_Q(h);if(ee)return G0(ee);I=!1,k=_d,j=new xl}else j=g?[]:L;e:for(;++w<F;){var te=h[w],ie=g?g(te):te;if(te=x||te!==0?te:0,I&&ie===ie){for(var me=j.length;me--;)if(j[me]===ie)continue e;g&&j.push(ie),L.push(te)}else k(j,ie,x)||(j!==L&&j.push(ie),L.push(te))}return L}function e_(h,g){return g=tu(g,h),h=vN(h,g),h==null||delete h[Ks(Mr(g))]}function WM(h,g,x,w){return Fd(h,g,x(_l(h,g)),w)}function hm(h,g,x,w){for(var k=h.length,F=w?k:-1;(w?F--:++F<k)&&g(h[F],F,h););return x?Fr(h,w?0:F,w?F+1:k):Fr(h,w?F+1:0,w?k:F)}function GM(h,g){var x=h;return x instanceof tt&&(x=x.value()),T2(g,function(w,k){return k.func.apply(k.thisArg,Ko([w],k.args))},x)}function t_(h,g,x){var w=h.length;if(w<2)return w?eu(h[0]):[];for(var k=-1,F=V(w);++k<w;)for(var I=h[k],L=-1;++L<w;)L!=k&&(F[k]=$d(F[k]||I,h[L],g,x));return eu(zn(F,1),g,x)}function HM(h,g,x){for(var w=-1,k=h.length,F=g.length,I={};++w<k;){var L=w<F?g[w]:n;x(I,h[w],L)}return I}function n_(h){return rn(h)?h:[]}function i_(h){return typeof h=="function"?h:Bi}function tu(h,g){return qe(h)?h:h_(h,g)?[h]:wN(vt(h))}var fQ=Ke;function nu(h,g,x){var w=h.length;return x=x===n?w:x,!g&&x>=w?h:Fr(h,g,x)}var YM=QK||function(h){return Ln.clearTimeout(h)};function XM(h,g){if(g)return h.slice();var x=h.length,w=mM?mM(x):new h.constructor(x);return h.copy(w),w}function r_(h){var g=new h.constructor(h.byteLength);return new Q0(g).set(new Q0(h)),g}function hQ(h,g){var x=g?r_(h.buffer):h.buffer;return new h.constructor(x,h.byteOffset,h.byteLength)}function dQ(h){var g=new h.constructor(h.source,MF.exec(h));return g.lastIndex=h.lastIndex,g}function pQ(h){return Cd?Tt(Cd.call(h)):{}}function KM(h,g){var x=g?r_(h.buffer):h.buffer;return new h.constructor(x,h.byteOffset,h.length)}function JM(h,g){if(h!==g){var x=h!==n,w=h===null,k=h===h,F=ar(h),I=g!==n,L=g===null,j=g===g,ee=ar(g);if(!L&&!ee&&!F&&h>g||F&&I&&j&&!L&&!ee||w&&I&&j||!x&&j||!k)return 1;if(!w&&!F&&!ee&&h<g||ee&&x&&k&&!w&&!F||L&&x&&k||!I&&k||!j)return-1}return 0}function gQ(h,g,x){for(var w=-1,k=h.criteria,F=g.criteria,I=k.length,L=x.length;++w<I;){var j=JM(k[w],F[w]);if(j){if(w>=L)return j;var ee=x[w];return j*(ee=="desc"?-1:1)}}return h.index-g.index}function QM(h,g,x,w){for(var k=-1,F=h.length,I=x.length,L=-1,j=g.length,ee=mn(F-I,0),te=V(j+ee),ie=!w;++L<j;)te[L]=g[L];for(;++k<I;)(ie||k<F)&&(te[x[k]]=h[k]);for(;ee--;)te[L++]=h[k++];return te}function ZM(h,g,x,w){for(var k=-1,F=h.length,I=-1,L=x.length,j=-1,ee=g.length,te=mn(F-L,0),ie=V(te+ee),me=!w;++k<te;)ie[k]=h[k];for(var Se=k;++j<ee;)ie[Se+j]=g[j];for(;++I<L;)(me||k<F)&&(ie[Se+x[I]]=h[k++]);return ie}function Pi(h,g){var x=-1,w=h.length;for(g||(g=V(w));++x<w;)g[x]=h[x];return g}function Xs(h,g,x,w){var k=!x;x||(x={});for(var F=-1,I=g.length;++F<I;){var L=g[F],j=w?w(x[L],h[L],L,x,h):n;j===n&&(j=h[L]),k?Ha(x,L,j):kd(x,L,j)}return x}function mQ(h,g){return Xs(h,f_(h),g)}function yQ(h,g){return Xs(h,hN(h),g)}function dm(h,g){return function(x,w){var k=qe(x)?wK:zJ,F=g?g():{};return k(x,h,Me(w,2),F)}}function rf(h){return Ke(function(g,x){var w=-1,k=x.length,F=k>1?x[k-1]:n,I=k>2?x[2]:n;for(F=h.length>3&&typeof F=="function"?(k--,F):n,I&&gi(x[0],x[1],I)&&(F=k<3?n:F,k=1),g=Tt(g);++w<k;){var L=x[w];L&&h(g,L,w,F)}return g})}function eN(h,g){return function(x,w){if(x==null)return x;if(!Li(x))return h(x,w);for(var k=x.length,F=g?k:-1,I=Tt(x);(g?F--:++F<k)&&w(I[F],F,I)!==!1;);return x}}function tN(h){return function(g,x,w){for(var k=-1,F=Tt(g),I=w(g),L=I.length;L--;){var j=I[h?L:++k];if(x(F[j],j,F)===!1)break}return g}}function vQ(h,g,x){var w=g&v,k=Md(h);function F(){var I=this&&this!==Ln&&this instanceof F?k:h;return I.apply(w?x:this,arguments)}return F}function nN(h){return function(g){g=vt(g);var x=Kc(g)?us(g):n,w=x?x[0]:g.charAt(0),k=x?nu(x,1).join(""):g.slice(1);return w[h]()+k}}function sf(h){return function(g){return T2(eR(ZN(g).replace(uK,"")),h,"")}}function Md(h){return function(){var g=arguments;switch(g.length){case 0:return new h;case 1:return new h(g[0]);case 2:return new h(g[0],g[1]);case 3:return new h(g[0],g[1],g[2]);case 4:return new h(g[0],g[1],g[2],g[3]);case 5:return new h(g[0],g[1],g[2],g[3],g[4]);case 6:return new h(g[0],g[1],g[2],g[3],g[4],g[5]);case 7:return new h(g[0],g[1],g[2],g[3],g[4],g[5],g[6])}var x=nf(h.prototype),w=h.apply(x,g);return jt(w)?w:x}}function xQ(h,g,x){var w=Md(h);function k(){for(var F=arguments.length,I=V(F),L=F,j=af(k);L--;)I[L]=arguments[L];var ee=F<3&&I[0]!==j&&I[F-1]!==j?[]:Jo(I,j);if(F-=ee.length,F<x)return oN(h,g,pm,k.placeholder,n,I,ee,n,n,x-F);var te=this&&this!==Ln&&this instanceof k?w:h;return ir(te,this,I)}return k}function iN(h){return function(g,x,w){var k=Tt(g);if(!Li(g)){var F=Me(x,3);g=kn(g),x=function(L){return F(k[L],L,k)}}var I=h(g,x,w);return I>-1?k[F?g[I]:I]:n}}function rN(h){return Xa(function(g){var x=g.length,w=x,k=Tr.prototype.thru;for(h&&g.reverse();w--;){var F=g[w];if(typeof F!="function")throw new $r(a);if(k&&!I&&vm(F)=="wrapper")var I=new Tr([],!0)}for(w=I?w:x;++w<x;){F=g[w];var L=vm(F),j=L=="wrapper"?l_(F):n;j&&d_(j[0])&&j[1]==(C|E|A|M)&&!j[4].length&&j[9]==1?I=I[vm(j[0])].apply(I,j[3]):I=F.length==1&&d_(F)?I[L]():I.thru(F)}return function(){var ee=arguments,te=ee[0];if(I&&ee.length==1&&qe(te))return I.plant(te).value();for(var ie=0,me=x?g[ie].apply(this,ee):te;++ie<x;)me=g[ie].call(this,me);return me}})}function pm(h,g,x,w,k,F,I,L,j,ee){var te=g&C,ie=g&v,me=g&b,Se=g&(E|S),Ne=g&N,Xe=me?n:Md(h);function Re(){for(var et=arguments.length,rt=V(et),or=et;or--;)rt[or]=arguments[or];if(Se)var mi=af(Re),ur=FK(rt,mi);if(w&&(rt=QM(rt,w,k,Se)),F&&(rt=ZM(rt,F,I,Se)),et-=ur,Se&&et<ee){var sn=Jo(rt,mi);return oN(h,g,pm,Re.placeholder,x,rt,sn,L,j,ee-et)}var fs=ie?x:this,Za=me?fs[h]:h;return et=rt.length,L?rt=zQ(rt,L):Ne&&et>1&&rt.reverse(),te&&j<et&&(rt.length=j),this&&this!==Ln&&this instanceof Re&&(Za=Xe||Md(Za)),Za.apply(fs,rt)}return Re}function sN(h,g){return function(x,w){return HJ(x,h,g(w),{})}}function gm(h,g){return function(x,w){var k;if(x===n&&w===n)return g;if(x!==n&&(k=x),w!==n){if(k===n)return w;typeof x=="string"||typeof w=="string"?(x=sr(x),w=sr(w)):(x=VM(x),w=VM(w)),k=h(x,w)}return k}}function s_(h){return Xa(function(g){return g=Pt(g,rr(Me())),Ke(function(x){var w=this;return h(g,function(k){return ir(k,w,x)})})})}function mm(h,g){g=g===n?" ":sr(g);var x=g.length;if(x<2)return x?Q2(g,h):g;var w=Q2(g,nm(h/Jc(g)));return Kc(g)?nu(us(w),0,h).join(""):w.slice(0,h)}function bQ(h,g,x,w){var k=g&v,F=Md(h);function I(){for(var L=-1,j=arguments.length,ee=-1,te=w.length,ie=V(te+j),me=this&&this!==Ln&&this instanceof I?F:h;++ee<te;)ie[ee]=w[ee];for(;j--;)ie[ee++]=arguments[++L];return ir(me,k?x:this,ie)}return I}function aN(h){return function(g,x,w){return w&&typeof w!="number"&&gi(g,x,w)&&(x=w=n),g=Qa(g),x===n?(x=g,g=0):x=Qa(x),w=w===n?g<x?1:-1:Qa(w),sQ(g,x,w,h)}}function ym(h){return function(g,x){return typeof g=="string"&&typeof x=="string"||(g=Nr(g),x=Nr(x)),h(g,x)}}function oN(h,g,x,w,k,F,I,L,j,ee){var te=g&E,ie=te?I:n,me=te?n:I,Se=te?F:n,Ne=te?n:F;g|=te?A:$,g&=~(te?$:A),g&_||(g&=-4);var Xe=[h,g,k,Se,ie,Ne,me,L,j,ee],Re=x.apply(n,Xe);return d_(h)&&xN(Re,Xe),Re.placeholder=w,bN(Re,h,g)}function a_(h){var g=gn[h];return function(x,w){if(x=Nr(x),w=w==null?0:Qn(He(w),292),w&&bM(x)){var k=(vt(x)+"e").split("e"),F=g(k[0]+"e"+(+k[1]+w));return k=(vt(F)+"e").split("e"),+(k[0]+"e"+(+k[1]-w))}return g(x)}}var _Q=ef&&1/G0(new ef([,-0]))[1]==G?function(h){return new ef(h)}:$_;function uN(h){return function(g){var x=Zn(g);return x==Ge?D2(g):x==os?LK(g):OK(g,h(g))}}function Ya(h,g,x,w,k,F,I,L){var j=g&b;if(!j&&typeof h!="function")throw new $r(a);var ee=w?w.length:0;if(ee||(g&=-97,w=k=n),I=I===n?I:mn(He(I),0),L=L===n?L:He(L),ee-=k?k.length:0,g&$){var te=w,ie=k;w=k=n}var me=j?n:l_(h),Se=[h,g,x,w,k,te,ie,F,I,L];if(me&&DQ(Se,me),h=Se[0],g=Se[1],x=Se[2],w=Se[3],k=Se[4],L=Se[9]=Se[9]===n?j?0:h.length:mn(Se[9]-ee,0),!L&&g&(E|S)&&(g&=-25),!g||g==v)var Ne=vQ(h,g,x);else g==E||g==S?Ne=xQ(h,g,L):(g==A||g==(v|A))&&!k.length?Ne=bQ(h,g,x,w):Ne=pm.apply(n,Se);var Xe=me?jM:xN;return bN(Xe(Ne,Se),h,g)}function lN(h,g,x,w){return h===n||cs(h,Zc[x])&&!_t.call(w,x)?g:h}function cN(h,g,x,w,k,F){return jt(h)&&jt(g)&&(F.set(g,h),cm(h,g,n,cN,F),F.delete(g)),h}function wQ(h){return Id(h)?n:h}function fN(h,g,x,w,k,F){var I=x&m,L=h.length,j=g.length;if(L!=j&&!(I&&j>L))return!1;var ee=F.get(h),te=F.get(g);if(ee&&te)return ee==g&&te==h;var ie=-1,me=!0,Se=x&y?new xl:n;for(F.set(h,g),F.set(g,h);++ie<L;){var Ne=h[ie],Xe=g[ie];if(w)var Re=I?w(Xe,Ne,ie,g,h,F):w(Ne,Xe,ie,h,g,F);if(Re!==n){if(Re)continue;me=!1;break}if(Se){if(!O2(g,function(et,rt){if(!_d(Se,rt)&&(Ne===et||k(Ne,et,x,w,F)))return Se.push(rt)})){me=!1;break}}else if(!(Ne===Xe||k(Ne,Xe,x,w,F))){me=!1;break}}return F.delete(h),F.delete(g),me}function EQ(h,g,x,w,k,F,I){switch(x){case Hc:if(h.byteLength!=g.byteLength||h.byteOffset!=g.byteOffset)return!1;h=h.buffer,g=g.buffer;case bd:return!(h.byteLength!=g.byteLength||!F(new Q0(h),new Q0(g)));case Di:case ye:case Ht:return cs(+h,+g);case je:return h.name==g.name&&h.message==g.message;case yd:case vd:return h==g+"";case Ge:var L=D2;case os:var j=w&m;if(L||(L=G0),h.size!=g.size&&!j)return!1;var ee=I.get(h);if(ee)return ee==g;w|=y,I.set(h,g);var te=fN(L(h),L(g),w,k,F,I);return I.delete(h),te;case B0:if(Cd)return Cd.call(h)==Cd.call(g)}return!1}function SQ(h,g,x,w,k,F){var I=x&m,L=o_(h),j=L.length,ee=o_(g),te=ee.length;if(j!=te&&!I)return!1;for(var ie=j;ie--;){var me=L[ie];if(!(I?me in g:_t.call(g,me)))return!1}var Se=F.get(h),Ne=F.get(g);if(Se&&Ne)return Se==g&&Ne==h;var Xe=!0;F.set(h,g),F.set(g,h);for(var Re=I;++ie<j;){me=L[ie];var et=h[me],rt=g[me];if(w)var or=I?w(rt,et,me,g,h,F):w(et,rt,me,h,g,F);if(!(or===n?et===rt||k(et,rt,x,w,F):or)){Xe=!1;break}Re||(Re=me=="constructor")}if(Xe&&!Re){var mi=h.constructor,ur=g.constructor;mi!=ur&&"constructor"in h&&"constructor"in g&&!(typeof mi=="function"&&mi instanceof mi&&typeof ur=="function"&&ur instanceof ur)&&(Xe=!1)}return F.delete(h),F.delete(g),Xe}function Xa(h){return g_(yN(h,n,CN),h+"")}function o_(h){return FM(h,kn,f_)}function u_(h){return FM(h,zi,hN)}var l_=rm?function(h){return rm.get(h)}:$_;function vm(h){for(var g=h.name+"",x=tf[g],w=_t.call(tf,g)?x.length:0;w--;){var k=x[w],F=k.func;if(F==null||F==h)return k.name}return g}function af(h){var g=_t.call(O,"placeholder")?O:h;return g.placeholder}function Me(){var h=O.iteratee||C_;return h=h===C_?RM:h,arguments.length?h(arguments[0],arguments[1]):h}function xm(h,g){var x=h.__data__;return MQ(g)?x[typeof g=="string"?"string":"hash"]:x.map}function c_(h){for(var g=kn(h),x=g.length;x--;){var w=g[x],k=h[w];g[x]=[w,k,gN(k)]}return g}function wl(h,g){var x=IK(h,g);return NM(x)?x:n}function AQ(h){var g=_t.call(h,yl),x=h[yl];try{h[yl]=n;var w=!0}catch{}var k=K0.call(h);return w&&(g?h[yl]=x:delete h[yl]),k}var f_=L2?function(h){return h==null?[]:(h=Tt(h),Xo(L2(h),function(g){return vM.call(h,g)}))}:T_,hN=L2?function(h){for(var g=[];h;)Ko(g,f_(h)),h=Z0(h);return g}:T_,Zn=pi;(z2&&Zn(new z2(new ArrayBuffer(1)))!=Hc||Ed&&Zn(new Ed)!=Ge||B2&&Zn(B2.resolve())!=gl||ef&&Zn(new ef)!=os||Sd&&Zn(new Sd)!=xd)&&(Zn=function(h){var g=pi(h),x=g==dn?h.constructor:n,w=x?El(x):"";if(w)switch(w){case oJ:return Hc;case uJ:return Ge;case lJ:return gl;case cJ:return os;case fJ:return xd}return g});function CQ(h,g,x){for(var w=-1,k=x.length;++w<k;){var F=x[w],I=F.size;switch(F.type){case"drop":h+=I;break;case"dropRight":g-=I;break;case"take":g=Qn(g,h+I);break;case"takeRight":h=mn(h,g-I);break}}return{start:h,end:g}}function kQ(h){var g=h.match(NX);return g?g[1].split(RX):[]}function dN(h,g,x){g=tu(g,h);for(var w=-1,k=g.length,F=!1;++w<k;){var I=Ks(g[w]);if(!(F=h!=null&&x(h,I)))break;h=h[I]}return F||++w!=k?F:(k=h==null?0:h.length,!!k&&Cm(k)&&Ka(I,k)&&(qe(h)||Sl(h)))}function $Q(h){var g=h.length,x=new h.constructor(g);return g&&typeof h[0]=="string"&&_t.call(h,"index")&&(x.index=h.index,x.input=h.input),x}function pN(h){return typeof h.constructor=="function"&&!Nd(h)?nf(Z0(h)):{}}function TQ(h,g,x){var w=h.constructor;switch(g){case bd:return r_(h);case Di:case ye:return new w(+h);case Hc:return hQ(h,x);case c2:case f2:case h2:case d2:case p2:case g2:case m2:case y2:case v2:return KM(h,x);case Ge:return new w;case Ht:case vd:return new w(h);case yd:return dQ(h);case os:return new w;case B0:return pQ(h)}}function OQ(h,g){var x=g.length;if(!x)return h;var w=x-1;return g[w]=(x>1?"& ":"")+g[w],g=g.join(x>2?", ":" "),h.replace(MX,`{
/* [wrapped with `+g+`] */
`)}function FQ(h){return qe(h)||Sl(h)||!!(xM&&h&&h[xM])}function Ka(h,g){var x=typeof h;return g=g??Z,!!g&&(x=="number"||x!="symbol"&&qX.test(h))&&h>-1&&h%1==0&&h<g}function gi(h,g,x){if(!jt(x))return!1;var w=typeof g;return(w=="number"?Li(x)&&Ka(g,x.length):w=="string"&&g in x)?cs(x[g],h):!1}function h_(h,g){if(qe(h))return!1;var x=typeof h;return x=="number"||x=="symbol"||x=="boolean"||h==null||ar(h)?!0:$X.test(h)||!kX.test(h)||g!=null&&h in Tt(g)}function MQ(h){var g=typeof h;return g=="string"||g=="number"||g=="symbol"||g=="boolean"?h!=="__proto__":h===null}function d_(h){var g=vm(h),x=O[g];if(typeof x!="function"||!(g in tt.prototype))return!1;if(h===x)return!0;var w=l_(x);return!!w&&h===w[0]}function NQ(h){return!!gM&&gM in h}var RQ=Y0?Ja:O_;function Nd(h){var g=h&&h.constructor,x=typeof g=="function"&&g.prototype||Zc;return h===x}function gN(h){return h===h&&!jt(h)}function mN(h,g){return function(x){return x==null?!1:x[h]===g&&(g!==n||h in Tt(x))}}function IQ(h){var g=Sm(h,function(w){return x.size===l&&x.clear(),w}),x=g.cache;return g}function DQ(h,g){var x=h[1],w=g[1],k=x|w,F=k<(v|b|C),I=w==C&&x==E||w==C&&x==M&&h[7].length<=g[8]||w==(C|M)&&g[7].length<=g[8]&&x==E;if(!(F||I))return h;w&v&&(h[2]=g[2],k|=x&v?0:_);var L=g[3];if(L){var j=h[3];h[3]=j?QM(j,L,g[4]):L,h[4]=j?Jo(h[3],c):g[4]}return L=g[5],L&&(j=h[5],h[5]=j?ZM(j,L,g[6]):L,h[6]=j?Jo(h[5],c):g[6]),L=g[7],L&&(h[7]=L),w&C&&(h[8]=h[8]==null?g[8]:Qn(h[8],g[8])),h[9]==null&&(h[9]=g[9]),h[0]=g[0],h[1]=k,h}function PQ(h){var g=[];if(h!=null)for(var x in Tt(h))g.push(x);return g}function LQ(h){return K0.call(h)}function yN(h,g,x){return g=mn(g===n?h.length-1:g,0),function(){for(var w=arguments,k=-1,F=mn(w.length-g,0),I=V(F);++k<F;)I[k]=w[g+k];k=-1;for(var L=V(g+1);++k<g;)L[k]=w[k];return L[g]=x(I),ir(h,this,L)}}function vN(h,g){return g.length<2?h:_l(h,Fr(g,0,-1))}function zQ(h,g){for(var x=h.length,w=Qn(g.length,x),k=Pi(h);w--;){var F=g[w];h[w]=Ka(F,x)?k[F]:n}return h}function p_(h,g){if(!(g==="constructor"&&typeof h[g]=="function")&&g!="__proto__")return h[g]}var xN=_N(jM),Rd=eJ||function(h,g){return Ln.setTimeout(h,g)},g_=_N(uQ);function bN(h,g,x){var w=g+"";return g_(h,OQ(w,BQ(kQ(w),x)))}function _N(h){var g=0,x=0;return function(){var w=rJ(),k=q-(w-x);if(x=w,k>0){if(++g>=W)return arguments[0]}else g=0;return h.apply(n,arguments)}}function bm(h,g){var x=-1,w=h.length,k=w-1;for(g=g===n?w:g;++x<g;){var F=J2(x,k),I=h[F];h[F]=h[x],h[x]=I}return h.length=g,h}var wN=IQ(function(h){var g=[];return h.charCodeAt(0)===46&&g.push(""),h.replace(TX,function(x,w,k,F){g.push(k?F.replace(PX,"$1"):w||x)}),g});function Ks(h){if(typeof h=="string"||ar(h))return h;var g=h+"";return g=="0"&&1/h==-1/0?"-0":g}function El(h){if(h!=null){try{return X0.call(h)}catch{}try{return h+""}catch{}}return""}function BQ(h,g){return kr(bt,function(x){var w="_."+x[0];g&x[1]&&!V0(h,w)&&h.push(w)}),h.sort()}function EN(h){if(h instanceof tt)return h.clone();var g=new Tr(h.__wrapped__,h.__chain__);return g.__actions__=Pi(h.__actions__),g.__index__=h.__index__,g.__values__=h.__values__,g}function UQ(h,g,x){(x?gi(h,g,x):g===n)?g=1:g=mn(He(g),0);var w=h==null?0:h.length;if(!w||g<1)return[];for(var k=0,F=0,I=V(nm(w/g));k<w;)I[F++]=Fr(h,k,k+=g);return I}function jQ(h){for(var g=-1,x=h==null?0:h.length,w=0,k=[];++g<x;){var F=h[g];F&&(k[w++]=F)}return k}function qQ(){var h=arguments.length;if(!h)return[];for(var g=V(h-1),x=arguments[0],w=h;w--;)g[w-1]=arguments[w];return Ko(qe(x)?Pi(x):[x],zn(g,1))}var VQ=Ke(function(h,g){return rn(h)?$d(h,zn(g,1,rn,!0)):[]}),WQ=Ke(function(h,g){var x=Mr(g);return rn(x)&&(x=n),rn(h)?$d(h,zn(g,1,rn,!0),Me(x,2)):[]}),GQ=Ke(function(h,g){var x=Mr(g);return rn(x)&&(x=n),rn(h)?$d(h,zn(g,1,rn,!0),n,x):[]});function HQ(h,g,x){var w=h==null?0:h.length;return w?(g=x||g===n?1:He(g),Fr(h,g<0?0:g,w)):[]}function YQ(h,g,x){var w=h==null?0:h.length;return w?(g=x||g===n?1:He(g),g=w-g,Fr(h,0,g<0?0:g)):[]}function XQ(h,g){return h&&h.length?hm(h,Me(g,3),!0,!0):[]}function KQ(h,g){return h&&h.length?hm(h,Me(g,3),!0):[]}function JQ(h,g,x,w){var k=h==null?0:h.length;return k?(x&&typeof x!="number"&&gi(h,g,x)&&(x=0,w=k),qJ(h,g,x,w)):[]}function SN(h,g,x){var w=h==null?0:h.length;if(!w)return-1;var k=x==null?0:He(x);return k<0&&(k=mn(w+k,0)),W0(h,Me(g,3),k)}function AN(h,g,x){var w=h==null?0:h.length;if(!w)return-1;var k=w-1;return x!==n&&(k=He(x),k=x<0?mn(w+k,0):Qn(k,w-1)),W0(h,Me(g,3),k,!0)}function CN(h){var g=h==null?0:h.length;return g?zn(h,1):[]}function QQ(h){var g=h==null?0:h.length;return g?zn(h,G):[]}function ZQ(h,g){var x=h==null?0:h.length;return x?(g=g===n?1:He(g),zn(h,g)):[]}function eZ(h){for(var g=-1,x=h==null?0:h.length,w={};++g<x;){var k=h[g];w[k[0]]=k[1]}return w}function kN(h){return h&&h.length?h[0]:n}function tZ(h,g,x){var w=h==null?0:h.length;if(!w)return-1;var k=x==null?0:He(x);return k<0&&(k=mn(w+k,0)),Xc(h,g,k)}function nZ(h){var g=h==null?0:h.length;return g?Fr(h,0,-1):[]}var iZ=Ke(function(h){var g=Pt(h,n_);return g.length&&g[0]===h[0]?G2(g):[]}),rZ=Ke(function(h){var g=Mr(h),x=Pt(h,n_);return g===Mr(x)?g=n:x.pop(),x.length&&x[0]===h[0]?G2(x,Me(g,2)):[]}),sZ=Ke(function(h){var g=Mr(h),x=Pt(h,n_);return g=typeof g=="function"?g:n,g&&x.pop(),x.length&&x[0]===h[0]?G2(x,n,g):[]});function aZ(h,g){return h==null?"":nJ.call(h,g)}function Mr(h){var g=h==null?0:h.length;return g?h[g-1]:n}function oZ(h,g,x){var w=h==null?0:h.length;if(!w)return-1;var k=w;return x!==n&&(k=He(x),k=k<0?mn(w+k,0):Qn(k,w-1)),g===g?BK(h,g,k):W0(h,oM,k,!0)}function uZ(h,g){return h&&h.length?LM(h,He(g)):n}var lZ=Ke($N);function $N(h,g){return h&&h.length&&g&&g.length?K2(h,g):h}function cZ(h,g,x){return h&&h.length&&g&&g.length?K2(h,g,Me(x,2)):h}function fZ(h,g,x){return h&&h.length&&g&&g.length?K2(h,g,n,x):h}var hZ=Xa(function(h,g){var x=h==null?0:h.length,w=j2(h,g);return UM(h,Pt(g,function(k){return Ka(k,x)?+k:k}).sort(JM)),w});function dZ(h,g){var x=[];if(!(h&&h.length))return x;var w=-1,k=[],F=h.length;for(g=Me(g,3);++w<F;){var I=h[w];g(I,w,h)&&(x.push(I),k.push(w))}return UM(h,k),x}function m_(h){return h==null?h:aJ.call(h)}function pZ(h,g,x){var w=h==null?0:h.length;return w?(x&&typeof x!="number"&&gi(h,g,x)?(g=0,x=w):(g=g==null?0:He(g),x=x===n?w:He(x)),Fr(h,g,x)):[]}function gZ(h,g){return fm(h,g)}function mZ(h,g,x){return Z2(h,g,Me(x,2))}function yZ(h,g){var x=h==null?0:h.length;if(x){var w=fm(h,g);if(w<x&&cs(h[w],g))return w}return-1}function vZ(h,g){return fm(h,g,!0)}function xZ(h,g,x){return Z2(h,g,Me(x,2),!0)}function bZ(h,g){var x=h==null?0:h.length;if(x){var w=fm(h,g,!0)-1;if(cs(h[w],g))return w}return-1}function _Z(h){return h&&h.length?qM(h):[]}function wZ(h,g){return h&&h.length?qM(h,Me(g,2)):[]}function EZ(h){var g=h==null?0:h.length;return g?Fr(h,1,g):[]}function SZ(h,g,x){return h&&h.length?(g=x||g===n?1:He(g),Fr(h,0,g<0?0:g)):[]}function AZ(h,g,x){var w=h==null?0:h.length;return w?(g=x||g===n?1:He(g),g=w-g,Fr(h,g<0?0:g,w)):[]}function CZ(h,g){return h&&h.length?hm(h,Me(g,3),!1,!0):[]}function kZ(h,g){return h&&h.length?hm(h,Me(g,3)):[]}var $Z=Ke(function(h){return eu(zn(h,1,rn,!0))}),TZ=Ke(function(h){var g=Mr(h);return rn(g)&&(g=n),eu(zn(h,1,rn,!0),Me(g,2))}),OZ=Ke(function(h){var g=Mr(h);return g=typeof g=="function"?g:n,eu(zn(h,1,rn,!0),n,g)});function FZ(h){return h&&h.length?eu(h):[]}function MZ(h,g){return h&&h.length?eu(h,Me(g,2)):[]}function NZ(h,g){return g=typeof g=="function"?g:n,h&&h.length?eu(h,n,g):[]}function y_(h){if(!(h&&h.length))return[];var g=0;return h=Xo(h,function(x){if(rn(x))return g=mn(x.length,g),!0}),R2(g,function(x){return Pt(h,F2(x))})}function TN(h,g){if(!(h&&h.length))return[];var x=y_(h);return g==null?x:Pt(x,function(w){return ir(g,n,w)})}var RZ=Ke(function(h,g){return rn(h)?$d(h,g):[]}),IZ=Ke(function(h){return t_(Xo(h,rn))}),DZ=Ke(function(h){var g=Mr(h);return rn(g)&&(g=n),t_(Xo(h,rn),Me(g,2))}),PZ=Ke(function(h){var g=Mr(h);return g=typeof g=="function"?g:n,t_(Xo(h,rn),n,g)}),LZ=Ke(y_);function zZ(h,g){return HM(h||[],g||[],kd)}function BZ(h,g){return HM(h||[],g||[],Fd)}var UZ=Ke(function(h){var g=h.length,x=g>1?h[g-1]:n;return x=typeof x=="function"?(h.pop(),x):n,TN(h,x)});function ON(h){var g=O(h);return g.__chain__=!0,g}function jZ(h,g){return g(h),h}function _m(h,g){return g(h)}var qZ=Xa(function(h){var g=h.length,x=g?h[0]:0,w=this.__wrapped__,k=function(F){return j2(F,h)};return g>1||this.__actions__.length||!(w instanceof tt)||!Ka(x)?this.thru(k):(w=w.slice(x,+x+(g?1:0)),w.__actions__.push({func:_m,args:[k],thisArg:n}),new Tr(w,this.__chain__).thru(function(F){return g&&!F.length&&F.push(n),F}))});function VZ(){return ON(this)}function WZ(){return new Tr(this.value(),this.__chain__)}function GZ(){this.__values__===n&&(this.__values__=VN(this.value()));var h=this.__index__>=this.__values__.length,g=h?n:this.__values__[this.__index__++];return{done:h,value:g}}function HZ(){return this}function YZ(h){for(var g,x=this;x instanceof am;){var w=EN(x);w.__index__=0,w.__values__=n,g?k.__wrapped__=w:g=w;var k=w;x=x.__wrapped__}return k.__wrapped__=h,g}function XZ(){var h=this.__wrapped__;if(h instanceof tt){var g=h;return this.__actions__.length&&(g=new tt(this)),g=g.reverse(),g.__actions__.push({func:_m,args:[m_],thisArg:n}),new Tr(g,this.__chain__)}return this.thru(m_)}function KZ(){return GM(this.__wrapped__,this.__actions__)}var JZ=dm(function(h,g,x){_t.call(h,x)?++h[x]:Ha(h,x,1)});function QZ(h,g,x){var w=qe(h)?sM:jJ;return x&&gi(h,g,x)&&(g=n),w(h,Me(g,3))}function ZZ(h,g){var x=qe(h)?Xo:TM;return x(h,Me(g,3))}var eee=iN(SN),tee=iN(AN);function nee(h,g){return zn(wm(h,g),1)}function iee(h,g){return zn(wm(h,g),G)}function ree(h,g,x){return x=x===n?1:He(x),zn(wm(h,g),x)}function FN(h,g){var x=qe(h)?kr:Zo;return x(h,Me(g,3))}function MN(h,g){var x=qe(h)?EK:$M;return x(h,Me(g,3))}var see=dm(function(h,g,x){_t.call(h,x)?h[x].push(g):Ha(h,x,[g])});function aee(h,g,x,w){h=Li(h)?h:uf(h),x=x&&!w?He(x):0;var k=h.length;return x<0&&(x=mn(k+x,0)),km(h)?x<=k&&h.indexOf(g,x)>-1:!!k&&Xc(h,g,x)>-1}var oee=Ke(function(h,g,x){var w=-1,k=typeof g=="function",F=Li(h)?V(h.length):[];return Zo(h,function(I){F[++w]=k?ir(g,I,x):Td(I,g,x)}),F}),uee=dm(function(h,g,x){Ha(h,x,g)});function wm(h,g){var x=qe(h)?Pt:IM;return x(h,Me(g,3))}function lee(h,g,x,w){return h==null?[]:(qe(g)||(g=g==null?[]:[g]),x=w?n:x,qe(x)||(x=x==null?[]:[x]),zM(h,g,x))}var cee=dm(function(h,g,x){h[x?0:1].push(g)},function(){return[[],[]]});function fee(h,g,x){var w=qe(h)?T2:lM,k=arguments.length<3;return w(h,Me(g,4),x,k,Zo)}function hee(h,g,x){var w=qe(h)?SK:lM,k=arguments.length<3;return w(h,Me(g,4),x,k,$M)}function dee(h,g){var x=qe(h)?Xo:TM;return x(h,Am(Me(g,3)))}function pee(h){var g=qe(h)?SM:aQ;return g(h)}function gee(h,g,x){(x?gi(h,g,x):g===n)?g=1:g=He(g);var w=qe(h)?PJ:oQ;return w(h,g)}function mee(h){var g=qe(h)?LJ:lQ;return g(h)}function yee(h){if(h==null)return 0;if(Li(h))return km(h)?Jc(h):h.length;var g=Zn(h);return g==Ge||g==os?h.size:Y2(h).length}function vee(h,g,x){var w=qe(h)?O2:cQ;return x&&gi(h,g,x)&&(g=n),w(h,Me(g,3))}var xee=Ke(function(h,g){if(h==null)return[];var x=g.length;return x>1&&gi(h,g[0],g[1])?g=[]:x>2&&gi(g[0],g[1],g[2])&&(g=[g[0]]),zM(h,zn(g,1),[])}),Em=ZK||function(){return Ln.Date.now()};function bee(h,g){if(typeof g!="function")throw new $r(a);return h=He(h),function(){if(--h<1)return g.apply(this,arguments)}}function NN(h,g,x){return g=x?n:g,g=h&&g==null?h.length:g,Ya(h,C,n,n,n,n,g)}function RN(h,g){var x;if(typeof g!="function")throw new $r(a);return h=He(h),function(){return--h>0&&(x=g.apply(this,arguments)),h<=1&&(g=n),x}}var v_=Ke(function(h,g,x){var w=v;if(x.length){var k=Jo(x,af(v_));w|=A}return Ya(h,w,g,x,k)}),IN=Ke(function(h,g,x){var w=v|b;if(x.length){var k=Jo(x,af(IN));w|=A}return Ya(g,w,h,x,k)});function DN(h,g,x){g=x?n:g;var w=Ya(h,E,n,n,n,n,n,g);return w.placeholder=DN.placeholder,w}function PN(h,g,x){g=x?n:g;var w=Ya(h,S,n,n,n,n,n,g);return w.placeholder=PN.placeholder,w}function LN(h,g,x){var w,k,F,I,L,j,ee=0,te=!1,ie=!1,me=!0;if(typeof h!="function")throw new $r(a);g=Nr(g)||0,jt(x)&&(te=!!x.leading,ie="maxWait"in x,F=ie?mn(Nr(x.maxWait)||0,g):F,me="trailing"in x?!!x.trailing:me);function Se(sn){var fs=w,Za=k;return w=k=n,ee=sn,I=h.apply(Za,fs),I}function Ne(sn){return ee=sn,L=Rd(et,g),te?Se(sn):I}function Xe(sn){var fs=sn-j,Za=sn-ee,iR=g-fs;return ie?Qn(iR,F-Za):iR}function Re(sn){var fs=sn-j,Za=sn-ee;return j===n||fs>=g||fs<0||ie&&Za>=F}function et(){var sn=Em();if(Re(sn))return rt(sn);L=Rd(et,Xe(sn))}function rt(sn){return L=n,me&&w?Se(sn):(w=k=n,I)}function or(){L!==n&&YM(L),ee=0,w=j=k=L=n}function mi(){return L===n?I:rt(Em())}function ur(){var sn=Em(),fs=Re(sn);if(w=arguments,k=this,j=sn,fs){if(L===n)return Ne(j);if(ie)return YM(L),L=Rd(et,g),Se(j)}return L===n&&(L=Rd(et,g)),I}return ur.cancel=or,ur.flush=mi,ur}var _ee=Ke(function(h,g){return kM(h,1,g)}),wee=Ke(function(h,g,x){return kM(h,Nr(g)||0,x)});function Eee(h){return Ya(h,N)}function Sm(h,g){if(typeof h!="function"||g!=null&&typeof g!="function")throw new $r(a);var x=function(){var w=arguments,k=g?g.apply(this,w):w[0],F=x.cache;if(F.has(k))return F.get(k);var I=h.apply(this,w);return x.cache=F.set(k,I)||F,I};return x.cache=new(Sm.Cache||Ga),x}Sm.Cache=Ga;function Am(h){if(typeof h!="function")throw new $r(a);return function(){var g=arguments;switch(g.length){case 0:return!h.call(this);case 1:return!h.call(this,g[0]);case 2:return!h.call(this,g[0],g[1]);case 3:return!h.call(this,g[0],g[1],g[2])}return!h.apply(this,g)}}function See(h){return RN(2,h)}var Aee=fQ(function(h,g){g=g.length==1&&qe(g[0])?Pt(g[0],rr(Me())):Pt(zn(g,1),rr(Me()));var x=g.length;return Ke(function(w){for(var k=-1,F=Qn(w.length,x);++k<F;)w[k]=g[k].call(this,w[k]);return ir(h,this,w)})}),x_=Ke(function(h,g){var x=Jo(g,af(x_));return Ya(h,A,n,g,x)}),zN=Ke(function(h,g){var x=Jo(g,af(zN));return Ya(h,$,n,g,x)}),Cee=Xa(function(h,g){return Ya(h,M,n,n,n,g)});function kee(h,g){if(typeof h!="function")throw new $r(a);return g=g===n?g:He(g),Ke(h,g)}function $ee(h,g){if(typeof h!="function")throw new $r(a);return g=g==null?0:mn(He(g),0),Ke(function(x){var w=x[g],k=nu(x,0,g);return w&&Ko(k,w),ir(h,this,k)})}function Tee(h,g,x){var w=!0,k=!0;if(typeof h!="function")throw new $r(a);return jt(x)&&(w="leading"in x?!!x.leading:w,k="trailing"in x?!!x.trailing:k),LN(h,g,{leading:w,maxWait:g,trailing:k})}function Oee(h){return NN(h,1)}function Fee(h,g){return x_(i_(g),h)}function Mee(){if(!arguments.length)return[];var h=arguments[0];return qe(h)?h:[h]}function Nee(h){return Or(h,p)}function Ree(h,g){return g=typeof g=="function"?g:n,Or(h,p,g)}function Iee(h){return Or(h,f|p)}function Dee(h,g){return g=typeof g=="function"?g:n,Or(h,f|p,g)}function Pee(h,g){return g==null||CM(h,g,kn(g))}function cs(h,g){return h===g||h!==h&&g!==g}var Lee=ym(W2),zee=ym(function(h,g){return h>=g}),Sl=MM(function(){return arguments}())?MM:function(h){return Yt(h)&&_t.call(h,"callee")&&!vM.call(h,"callee")},qe=V.isArray,Bee=ZF?rr(ZF):YJ;function Li(h){return h!=null&&Cm(h.length)&&!Ja(h)}function rn(h){return Yt(h)&&Li(h)}function Uee(h){return h===!0||h===!1||Yt(h)&&pi(h)==Di}var iu=tJ||O_,jee=eM?rr(eM):XJ;function qee(h){return Yt(h)&&h.nodeType===1&&!Id(h)}function Vee(h){if(h==null)return!0;if(Li(h)&&(qe(h)||typeof h=="string"||typeof h.splice=="function"||iu(h)||of(h)||Sl(h)))return!h.length;var g=Zn(h);if(g==Ge||g==os)return!h.size;if(Nd(h))return!Y2(h).length;for(var x in h)if(_t.call(h,x))return!1;return!0}function Wee(h,g){return Od(h,g)}function Gee(h,g,x){x=typeof x=="function"?x:n;var w=x?x(h,g):n;return w===n?Od(h,g,n,x):!!w}function b_(h){if(!Yt(h))return!1;var g=pi(h);return g==je||g==Ue||typeof h.message=="string"&&typeof h.name=="string"&&!Id(h)}function Hee(h){return typeof h=="number"&&bM(h)}function Ja(h){if(!jt(h))return!1;var g=pi(h);return g==ae||g==fn||g==Va||g==yX}function BN(h){return typeof h=="number"&&h==He(h)}function Cm(h){return typeof h=="number"&&h>-1&&h%1==0&&h<=Z}function jt(h){var g=typeof h;return h!=null&&(g=="object"||g=="function")}function Yt(h){return h!=null&&typeof h=="object"}var UN=tM?rr(tM):JJ;function Yee(h,g){return h===g||H2(h,g,c_(g))}function Xee(h,g,x){return x=typeof x=="function"?x:n,H2(h,g,c_(g),x)}function Kee(h){return jN(h)&&h!=+h}function Jee(h){if(RQ(h))throw new Be(s);return NM(h)}function Qee(h){return h===null}function Zee(h){return h==null}function jN(h){return typeof h=="number"||Yt(h)&&pi(h)==Ht}function Id(h){if(!Yt(h)||pi(h)!=dn)return!1;var g=Z0(h);if(g===null)return!0;var x=_t.call(g,"constructor")&&g.constructor;return typeof x=="function"&&x instanceof x&&X0.call(x)==XK}var __=nM?rr(nM):QJ;function ete(h){return BN(h)&&h>=-9007199254740991&&h<=Z}var qN=iM?rr(iM):ZJ;function km(h){return typeof h=="string"||!qe(h)&&Yt(h)&&pi(h)==vd}function ar(h){return typeof h=="symbol"||Yt(h)&&pi(h)==B0}var of=rM?rr(rM):eQ;function tte(h){return h===n}function nte(h){return Yt(h)&&Zn(h)==xd}function ite(h){return Yt(h)&&pi(h)==xX}var rte=ym(X2),ste=ym(function(h,g){return h<=g});function VN(h){if(!h)return[];if(Li(h))return km(h)?us(h):Pi(h);if(wd&&h[wd])return PK(h[wd]());var g=Zn(h),x=g==Ge?D2:g==os?G0:uf;return x(h)}function Qa(h){if(!h)return h===0?h:0;if(h=Nr(h),h===G||h===-1/0){var g=h<0?-1:1;return g*J}return h===h?h:0}function He(h){var g=Qa(h),x=g%1;return g===g?x?g-x:g:0}function WN(h){return h?bl(He(h),0,we):0}function Nr(h){if(typeof h=="number")return h;if(ar(h))return he;if(jt(h)){var g=typeof h.valueOf=="function"?h.valueOf():h;h=jt(g)?g+"":g}if(typeof h!="string")return h===0?h:+h;h=cM(h);var x=BX.test(h);return x||jX.test(h)?bK(h.slice(2),x?2:8):zX.test(h)?he:+h}function GN(h){return Xs(h,zi(h))}function ate(h){return h?bl(He(h),-9007199254740991,Z):h===0?h:0}function vt(h){return h==null?"":sr(h)}var ote=rf(function(h,g){if(Nd(g)||Li(g)){Xs(g,kn(g),h);return}for(var x in g)_t.call(g,x)&&kd(h,x,g[x])}),HN=rf(function(h,g){Xs(g,zi(g),h)}),$m=rf(function(h,g,x,w){Xs(g,zi(g),h,w)}),ute=rf(function(h,g,x,w){Xs(g,kn(g),h,w)}),lte=Xa(j2);function cte(h,g){var x=nf(h);return g==null?x:AM(x,g)}var fte=Ke(function(h,g){h=Tt(h);var x=-1,w=g.length,k=w>2?g[2]:n;for(k&&gi(g[0],g[1],k)&&(w=1);++x<w;)for(var F=g[x],I=zi(F),L=-1,j=I.length;++L<j;){var ee=I[L],te=h[ee];(te===n||cs(te,Zc[ee])&&!_t.call(h,ee))&&(h[ee]=F[ee])}return h}),hte=Ke(function(h){return h.push(n,cN),ir(YN,n,h)});function dte(h,g){return aM(h,Me(g,3),Ys)}function pte(h,g){return aM(h,Me(g,3),V2)}function gte(h,g){return h==null?h:q2(h,Me(g,3),zi)}function mte(h,g){return h==null?h:OM(h,Me(g,3),zi)}function yte(h,g){return h&&Ys(h,Me(g,3))}function vte(h,g){return h&&V2(h,Me(g,3))}function xte(h){return h==null?[]:lm(h,kn(h))}function bte(h){return h==null?[]:lm(h,zi(h))}function w_(h,g,x){var w=h==null?n:_l(h,g);return w===n?x:w}function _te(h,g){return h!=null&&dN(h,g,VJ)}function E_(h,g){return h!=null&&dN(h,g,WJ)}var wte=sN(function(h,g,x){g!=null&&typeof g.toString!="function"&&(g=K0.call(g)),h[g]=x},A_(Bi)),Ete=sN(function(h,g,x){g!=null&&typeof g.toString!="function"&&(g=K0.call(g)),_t.call(h,g)?h[g].push(x):h[g]=[x]},Me),Ste=Ke(Td);function kn(h){return Li(h)?EM(h):Y2(h)}function zi(h){return Li(h)?EM(h,!0):tQ(h)}function Ate(h,g){var x={};return g=Me(g,3),Ys(h,function(w,k,F){Ha(x,g(w,k,F),w)}),x}function Cte(h,g){var x={};return g=Me(g,3),Ys(h,function(w,k,F){Ha(x,k,g(w,k,F))}),x}var kte=rf(function(h,g,x){cm(h,g,x)}),YN=rf(function(h,g,x,w){cm(h,g,x,w)}),$te=Xa(function(h,g){var x={};if(h==null)return x;var w=!1;g=Pt(g,function(F){return F=tu(F,h),w||(w=F.length>1),F}),Xs(h,u_(h),x),w&&(x=Or(x,f|d|p,wQ));for(var k=g.length;k--;)e_(x,g[k]);return x});function Tte(h,g){return XN(h,Am(Me(g)))}var Ote=Xa(function(h,g){return h==null?{}:iQ(h,g)});function XN(h,g){if(h==null)return{};var x=Pt(u_(h),function(w){return[w]});return g=Me(g),BM(h,x,function(w,k){return g(w,k[0])})}function Fte(h,g,x){g=tu(g,h);var w=-1,k=g.length;for(k||(k=1,h=n);++w<k;){var F=h==null?n:h[Ks(g[w])];F===n&&(w=k,F=x),h=Ja(F)?F.call(h):F}return h}function Mte(h,g,x){return h==null?h:Fd(h,g,x)}function Nte(h,g,x,w){return w=typeof w=="function"?w:n,h==null?h:Fd(h,g,x,w)}var KN=uN(kn),JN=uN(zi);function Rte(h,g,x){var w=qe(h),k=w||iu(h)||of(h);if(g=Me(g,4),x==null){var F=h&&h.constructor;k?x=w?new F:[]:jt(h)?x=Ja(F)?nf(Z0(h)):{}:x={}}return(k?kr:Ys)(h,function(I,L,j){return g(x,I,L,j)}),x}function Ite(h,g){return h==null?!0:e_(h,g)}function Dte(h,g,x){return h==null?h:WM(h,g,i_(x))}function Pte(h,g,x,w){return w=typeof w=="function"?w:n,h==null?h:WM(h,g,i_(x),w)}function uf(h){return h==null?[]:I2(h,kn(h))}function Lte(h){return h==null?[]:I2(h,zi(h))}function zte(h,g,x){return x===n&&(x=g,g=n),x!==n&&(x=Nr(x),x=x===x?x:0),g!==n&&(g=Nr(g),g=g===g?g:0),bl(Nr(h),g,x)}function Bte(h,g,x){return g=Qa(g),x===n?(x=g,g=0):x=Qa(x),h=Nr(h),GJ(h,g,x)}function Ute(h,g,x){if(x&&typeof x!="boolean"&&gi(h,g,x)&&(g=x=n),x===n&&(typeof g=="boolean"?(x=g,g=n):typeof h=="boolean"&&(x=h,h=n)),h===n&&g===n?(h=0,g=1):(h=Qa(h),g===n?(g=h,h=0):g=Qa(g)),h>g){var w=h;h=g,g=w}if(x||h%1||g%1){var k=_M();return Qn(h+k*(g-h+xK("1e-"+((k+"").length-1))),g)}return J2(h,g)}var jte=sf(function(h,g,x){return g=g.toLowerCase(),h+(x?QN(g):g)});function QN(h){return S_(vt(h).toLowerCase())}function ZN(h){return h=vt(h),h&&h.replace(VX,MK).replace(lK,"")}function qte(h,g,x){h=vt(h),g=sr(g);var w=h.length;x=x===n?w:bl(He(x),0,w);var k=x;return x-=g.length,x>=0&&h.slice(x,k)==g}function Vte(h){return h=vt(h),h&&SX.test(h)?h.replace(OF,NK):h}function Wte(h){return h=vt(h),h&&OX.test(h)?h.replace(x2,"\\$&"):h}var Gte=sf(function(h,g,x){return h+(x?"-":"")+g.toLowerCase()}),Hte=sf(function(h,g,x){return h+(x?" ":"")+g.toLowerCase()}),Yte=nN("toLowerCase");function Xte(h,g,x){h=vt(h),g=He(g);var w=g?Jc(h):0;if(!g||w>=g)return h;var k=(g-w)/2;return mm(im(k),x)+h+mm(nm(k),x)}function Kte(h,g,x){h=vt(h),g=He(g);var w=g?Jc(h):0;return g&&w<g?h+mm(g-w,x):h}function Jte(h,g,x){h=vt(h),g=He(g);var w=g?Jc(h):0;return g&&w<g?mm(g-w,x)+h:h}function Qte(h,g,x){return x||g==null?g=0:g&&(g=+g),sJ(vt(h).replace(b2,""),g||0)}function Zte(h,g,x){return(x?gi(h,g,x):g===n)?g=1:g=He(g),Q2(vt(h),g)}function ene(){var h=arguments,g=vt(h[0]);return h.length<3?g:g.replace(h[1],h[2])}var tne=sf(function(h,g,x){return h+(x?"_":"")+g.toLowerCase()});function nne(h,g,x){return x&&typeof x!="number"&&gi(h,g,x)&&(g=x=n),x=x===n?we:x>>>0,x?(h=vt(h),h&&(typeof g=="string"||g!=null&&!__(g))&&(g=sr(g),!g&&Kc(h))?nu(us(h),0,x):h.split(g,x)):[]}var ine=sf(function(h,g,x){return h+(x?" ":"")+S_(g)});function rne(h,g,x){return h=vt(h),x=x==null?0:bl(He(x),0,h.length),g=sr(g),h.slice(x,x+g.length)==g}function sne(h,g,x){var w=O.templateSettings;x&&gi(h,g,x)&&(g=n),h=vt(h),g=$m({},g,w,lN);var k=$m({},g.imports,w.imports,lN),F=kn(k),I=I2(k,F),L,j,ee=0,te=g.interpolate||U0,ie="__p += '",me=P2((g.escape||U0).source+"|"+te.source+"|"+(te===FF?LX:U0).source+"|"+(g.evaluate||U0).source+"|$","g"),Se="//# sourceURL="+(_t.call(g,"sourceURL")?(g.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++pK+"]")+`
`;h.replace(me,function(Re,et,rt,or,mi,ur){return rt||(rt=or),ie+=h.slice(ee,ur).replace(WX,RK),et&&(L=!0,ie+=`' +
__e(`+et+`) +
'`),mi&&(j=!0,ie+=`';
`+mi+`;
__p += '`),rt&&(ie+=`' +
((__t = (`+rt+`)) == null ? '' : __t) +
'`),ee=ur+Re.length,Re}),ie+=`';
`;var Ne=_t.call(g,"variable")&&g.variable;if(!Ne)ie=`with (obj) {
`+ie+`
}
`;else if(DX.test(Ne))throw new Be(o);ie=(j?ie.replace(bX,""):ie).replace(_X,"$1").replace(wX,"$1;"),ie="function("+(Ne||"obj")+`) {
`+(Ne?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(L?", __e = _.escape":"")+(j?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ie+`return __p
}`;var Xe=tR(function(){return mt(F,Se+"return "+ie).apply(n,I)});if(Xe.source=ie,b_(Xe))throw Xe;return Xe}function ane(h){return vt(h).toLowerCase()}function one(h){return vt(h).toUpperCase()}function une(h,g,x){if(h=vt(h),h&&(x||g===n))return cM(h);if(!h||!(g=sr(g)))return h;var w=us(h),k=us(g),F=fM(w,k),I=hM(w,k)+1;return nu(w,F,I).join("")}function lne(h,g,x){if(h=vt(h),h&&(x||g===n))return h.slice(0,pM(h)+1);if(!h||!(g=sr(g)))return h;var w=us(h),k=hM(w,us(g))+1;return nu(w,0,k).join("")}function cne(h,g,x){if(h=vt(h),h&&(x||g===n))return h.replace(b2,"");if(!h||!(g=sr(g)))return h;var w=us(h),k=fM(w,us(g));return nu(w,k).join("")}function fne(h,g){var x=P,w=D;if(jt(g)){var k="separator"in g?g.separator:k;x="length"in g?He(g.length):x,w="omission"in g?sr(g.omission):w}h=vt(h);var F=h.length;if(Kc(h)){var I=us(h);F=I.length}if(x>=F)return h;var L=x-Jc(w);if(L<1)return w;var j=I?nu(I,0,L).join(""):h.slice(0,L);if(k===n)return j+w;if(I&&(L+=j.length-L),__(k)){if(h.slice(L).search(k)){var ee,te=j;for(k.global||(k=P2(k.source,vt(MF.exec(k))+"g")),k.lastIndex=0;ee=k.exec(te);)var ie=ee.index;j=j.slice(0,ie===n?L:ie)}}else if(h.indexOf(sr(k),L)!=L){var me=j.lastIndexOf(k);me>-1&&(j=j.slice(0,me))}return j+w}function hne(h){return h=vt(h),h&&EX.test(h)?h.replace(TF,UK):h}var dne=sf(function(h,g,x){return h+(x?" ":"")+g.toUpperCase()}),S_=nN("toUpperCase");function eR(h,g,x){return h=vt(h),g=x?n:g,g===n?DK(h)?VK(h):kK(h):h.match(g)||[]}var tR=Ke(function(h,g){try{return ir(h,n,g)}catch(x){return b_(x)?x:new Be(x)}}),pne=Xa(function(h,g){return kr(g,function(x){x=Ks(x),Ha(h,x,v_(h[x],h))}),h});function gne(h){var g=h==null?0:h.length,x=Me();return h=g?Pt(h,function(w){if(typeof w[1]!="function")throw new $r(a);return[x(w[0]),w[1]]}):[],Ke(function(w){for(var k=-1;++k<g;){var F=h[k];if(ir(F[0],this,w))return ir(F[1],this,w)}})}function mne(h){return UJ(Or(h,f))}function A_(h){return function(){return h}}function yne(h,g){return h==null||h!==h?g:h}var vne=rN(),xne=rN(!0);function Bi(h){return h}function C_(h){return RM(typeof h=="function"?h:Or(h,f))}function bne(h){return DM(Or(h,f))}function _ne(h,g){return PM(h,Or(g,f))}var wne=Ke(function(h,g){return function(x){return Td(x,h,g)}}),Ene=Ke(function(h,g){return function(x){return Td(h,x,g)}});function k_(h,g,x){var w=kn(g),k=lm(g,w);x==null&&!(jt(g)&&(k.length||!w.length))&&(x=g,g=h,h=this,k=lm(g,kn(g)));var F=!(jt(x)&&"chain"in x)||!!x.chain,I=Ja(h);return kr(k,function(L){var j=g[L];h[L]=j,I&&(h.prototype[L]=function(){var ee=this.__chain__;if(F||ee){var te=h(this.__wrapped__),ie=te.__actions__=Pi(this.__actions__);return ie.push({func:j,args:arguments,thisArg:h}),te.__chain__=ee,te}return j.apply(h,Ko([this.value()],arguments))})}),h}function Sne(){return Ln._===this&&(Ln._=KK),this}function $_(){}function Ane(h){return h=He(h),Ke(function(g){return LM(g,h)})}var Cne=s_(Pt),kne=s_(sM),$ne=s_(O2);function nR(h){return h_(h)?F2(Ks(h)):rQ(h)}function Tne(h){return function(g){return h==null?n:_l(h,g)}}var One=aN(),Fne=aN(!0);function T_(){return[]}function O_(){return!1}function Mne(){return{}}function Nne(){return""}function Rne(){return!0}function Ine(h,g){if(h=He(h),h<1||h>Z)return[];var x=we,w=Qn(h,we);g=Me(g),h-=we;for(var k=R2(w,g);++x<h;)g(x);return k}function Dne(h){return qe(h)?Pt(h,Ks):ar(h)?[h]:Pi(wN(vt(h)))}function Pne(h){var g=++YK;return vt(h)+g}var Lne=gm(function(h,g){return h+g},0),zne=a_("ceil"),Bne=gm(function(h,g){return h/g},1),Une=a_("floor");function jne(h){return h&&h.length?um(h,Bi,W2):n}function qne(h,g){return h&&h.length?um(h,Me(g,2),W2):n}function Vne(h){return uM(h,Bi)}function Wne(h,g){return uM(h,Me(g,2))}function Gne(h){return h&&h.length?um(h,Bi,X2):n}function Hne(h,g){return h&&h.length?um(h,Me(g,2),X2):n}var Yne=gm(function(h,g){return h*g},1),Xne=a_("round"),Kne=gm(function(h,g){return h-g},0);function Jne(h){return h&&h.length?N2(h,Bi):0}function Qne(h,g){return h&&h.length?N2(h,Me(g,2)):0}return O.after=bee,O.ary=NN,O.assign=ote,O.assignIn=HN,O.assignInWith=$m,O.assignWith=ute,O.at=lte,O.before=RN,O.bind=v_,O.bindAll=pne,O.bindKey=IN,O.castArray=Mee,O.chain=ON,O.chunk=UQ,O.compact=jQ,O.concat=qQ,O.cond=gne,O.conforms=mne,O.constant=A_,O.countBy=JZ,O.create=cte,O.curry=DN,O.curryRight=PN,O.debounce=LN,O.defaults=fte,O.defaultsDeep=hte,O.defer=_ee,O.delay=wee,O.difference=VQ,O.differenceBy=WQ,O.differenceWith=GQ,O.drop=HQ,O.dropRight=YQ,O.dropRightWhile=XQ,O.dropWhile=KQ,O.fill=JQ,O.filter=ZZ,O.flatMap=nee,O.flatMapDeep=iee,O.flatMapDepth=ree,O.flatten=CN,O.flattenDeep=QQ,O.flattenDepth=ZQ,O.flip=Eee,O.flow=vne,O.flowRight=xne,O.fromPairs=eZ,O.functions=xte,O.functionsIn=bte,O.groupBy=see,O.initial=nZ,O.intersection=iZ,O.intersectionBy=rZ,O.intersectionWith=sZ,O.invert=wte,O.invertBy=Ete,O.invokeMap=oee,O.iteratee=C_,O.keyBy=uee,O.keys=kn,O.keysIn=zi,O.map=wm,O.mapKeys=Ate,O.mapValues=Cte,O.matches=bne,O.matchesProperty=_ne,O.memoize=Sm,O.merge=kte,O.mergeWith=YN,O.method=wne,O.methodOf=Ene,O.mixin=k_,O.negate=Am,O.nthArg=Ane,O.omit=$te,O.omitBy=Tte,O.once=See,O.orderBy=lee,O.over=Cne,O.overArgs=Aee,O.overEvery=kne,O.overSome=$ne,O.partial=x_,O.partialRight=zN,O.partition=cee,O.pick=Ote,O.pickBy=XN,O.property=nR,O.propertyOf=Tne,O.pull=lZ,O.pullAll=$N,O.pullAllBy=cZ,O.pullAllWith=fZ,O.pullAt=hZ,O.range=One,O.rangeRight=Fne,O.rearg=Cee,O.reject=dee,O.remove=dZ,O.rest=kee,O.reverse=m_,O.sampleSize=gee,O.set=Mte,O.setWith=Nte,O.shuffle=mee,O.slice=pZ,O.sortBy=xee,O.sortedUniq=_Z,O.sortedUniqBy=wZ,O.split=nne,O.spread=$ee,O.tail=EZ,O.take=SZ,O.takeRight=AZ,O.takeRightWhile=CZ,O.takeWhile=kZ,O.tap=jZ,O.throttle=Tee,O.thru=_m,O.toArray=VN,O.toPairs=KN,O.toPairsIn=JN,O.toPath=Dne,O.toPlainObject=GN,O.transform=Rte,O.unary=Oee,O.union=$Z,O.unionBy=TZ,O.unionWith=OZ,O.uniq=FZ,O.uniqBy=MZ,O.uniqWith=NZ,O.unset=Ite,O.unzip=y_,O.unzipWith=TN,O.update=Dte,O.updateWith=Pte,O.values=uf,O.valuesIn=Lte,O.without=RZ,O.words=eR,O.wrap=Fee,O.xor=IZ,O.xorBy=DZ,O.xorWith=PZ,O.zip=LZ,O.zipObject=zZ,O.zipObjectDeep=BZ,O.zipWith=UZ,O.entries=KN,O.entriesIn=JN,O.extend=HN,O.extendWith=$m,k_(O,O),O.add=Lne,O.attempt=tR,O.camelCase=jte,O.capitalize=QN,O.ceil=zne,O.clamp=zte,O.clone=Nee,O.cloneDeep=Iee,O.cloneDeepWith=Dee,O.cloneWith=Ree,O.conformsTo=Pee,O.deburr=ZN,O.defaultTo=yne,O.divide=Bne,O.endsWith=qte,O.eq=cs,O.escape=Vte,O.escapeRegExp=Wte,O.every=QZ,O.find=eee,O.findIndex=SN,O.findKey=dte,O.findLast=tee,O.findLastIndex=AN,O.findLastKey=pte,O.floor=Une,O.forEach=FN,O.forEachRight=MN,O.forIn=gte,O.forInRight=mte,O.forOwn=yte,O.forOwnRight=vte,O.get=w_,O.gt=Lee,O.gte=zee,O.has=_te,O.hasIn=E_,O.head=kN,O.identity=Bi,O.includes=aee,O.indexOf=tZ,O.inRange=Bte,O.invoke=Ste,O.isArguments=Sl,O.isArray=qe,O.isArrayBuffer=Bee,O.isArrayLike=Li,O.isArrayLikeObject=rn,O.isBoolean=Uee,O.isBuffer=iu,O.isDate=jee,O.isElement=qee,O.isEmpty=Vee,O.isEqual=Wee,O.isEqualWith=Gee,O.isError=b_,O.isFinite=Hee,O.isFunction=Ja,O.isInteger=BN,O.isLength=Cm,O.isMap=UN,O.isMatch=Yee,O.isMatchWith=Xee,O.isNaN=Kee,O.isNative=Jee,O.isNil=Zee,O.isNull=Qee,O.isNumber=jN,O.isObject=jt,O.isObjectLike=Yt,O.isPlainObject=Id,O.isRegExp=__,O.isSafeInteger=ete,O.isSet=qN,O.isString=km,O.isSymbol=ar,O.isTypedArray=of,O.isUndefined=tte,O.isWeakMap=nte,O.isWeakSet=ite,O.join=aZ,O.kebabCase=Gte,O.last=Mr,O.lastIndexOf=oZ,O.lowerCase=Hte,O.lowerFirst=Yte,O.lt=rte,O.lte=ste,O.max=jne,O.maxBy=qne,O.mean=Vne,O.meanBy=Wne,O.min=Gne,O.minBy=Hne,O.stubArray=T_,O.stubFalse=O_,O.stubObject=Mne,O.stubString=Nne,O.stubTrue=Rne,O.multiply=Yne,O.nth=uZ,O.noConflict=Sne,O.noop=$_,O.now=Em,O.pad=Xte,O.padEnd=Kte,O.padStart=Jte,O.parseInt=Qte,O.random=Ute,O.reduce=fee,O.reduceRight=hee,O.repeat=Zte,O.replace=ene,O.result=Fte,O.round=Xne,O.runInContext=B,O.sample=pee,O.size=yee,O.snakeCase=tne,O.some=vee,O.sortedIndex=gZ,O.sortedIndexBy=mZ,O.sortedIndexOf=yZ,O.sortedLastIndex=vZ,O.sortedLastIndexBy=xZ,O.sortedLastIndexOf=bZ,O.startCase=ine,O.startsWith=rne,O.subtract=Kne,O.sum=Jne,O.sumBy=Qne,O.template=sne,O.times=Ine,O.toFinite=Qa,O.toInteger=He,O.toLength=WN,O.toLower=ane,O.toNumber=Nr,O.toSafeInteger=ate,O.toString=vt,O.toUpper=one,O.trim=une,O.trimEnd=lne,O.trimStart=cne,O.truncate=fne,O.unescape=hne,O.uniqueId=Pne,O.upperCase=dne,O.upperFirst=S_,O.each=FN,O.eachRight=MN,O.first=kN,k_(O,function(){var h={};return Ys(O,function(g,x){_t.call(O.prototype,x)||(h[x]=g)}),h}(),{chain:!1}),O.VERSION=i,kr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(h){O[h].placeholder=O}),kr(["drop","take"],function(h,g){tt.prototype[h]=function(x){x=x===n?1:mn(He(x),0);var w=this.__filtered__&&!g?new tt(this):this.clone();return w.__filtered__?w.__takeCount__=Qn(x,w.__takeCount__):w.__views__.push({size:Qn(x,we),type:h+(w.__dir__<0?"Right":"")}),w},tt.prototype[h+"Right"]=function(x){return this.reverse()[h](x).reverse()}}),kr(["filter","map","takeWhile"],function(h,g){var x=g+1,w=x==z||x==U;tt.prototype[h]=function(k){var F=this.clone();return F.__iteratees__.push({iteratee:Me(k,3),type:x}),F.__filtered__=F.__filtered__||w,F}}),kr(["head","last"],function(h,g){var x="take"+(g?"Right":"");tt.prototype[h]=function(){return this[x](1).value()[0]}}),kr(["initial","tail"],function(h,g){var x="drop"+(g?"":"Right");tt.prototype[h]=function(){return this.__filtered__?new tt(this):this[x](1)}}),tt.prototype.compact=function(){return this.filter(Bi)},tt.prototype.find=function(h){return this.filter(h).head()},tt.prototype.findLast=function(h){return this.reverse().find(h)},tt.prototype.invokeMap=Ke(function(h,g){return typeof h=="function"?new tt(this):this.map(function(x){return Td(x,h,g)})}),tt.prototype.reject=function(h){return this.filter(Am(Me(h)))},tt.prototype.slice=function(h,g){h=He(h);var x=this;return x.__filtered__&&(h>0||g<0)?new tt(x):(h<0?x=x.takeRight(-h):h&&(x=x.drop(h)),g!==n&&(g=He(g),x=g<0?x.dropRight(-g):x.take(g-h)),x)},tt.prototype.takeRightWhile=function(h){return this.reverse().takeWhile(h).reverse()},tt.prototype.toArray=function(){return this.take(we)},Ys(tt.prototype,function(h,g){var x=/^(?:filter|find|map|reject)|While$/.test(g),w=/^(?:head|last)$/.test(g),k=O[w?"take"+(g=="last"?"Right":""):g],F=w||/^find/.test(g);k&&(O.prototype[g]=function(){var I=this.__wrapped__,L=w?[1]:arguments,j=I instanceof tt,ee=L[0],te=j||qe(I),ie=function(et){var rt=k.apply(O,Ko([et],L));return w&&me?rt[0]:rt};te&&x&&typeof ee=="function"&&ee.length!=1&&(j=te=!1);var me=this.__chain__,Se=!!this.__actions__.length,Ne=F&&!me,Xe=j&&!Se;if(!F&&te){I=Xe?I:new tt(this);var Re=h.apply(I,L);return Re.__actions__.push({func:_m,args:[ie],thisArg:n}),new Tr(Re,me)}return Ne&&Xe?h.apply(this,L):(Re=this.thru(ie),Ne?w?Re.value()[0]:Re.value():Re)})}),kr(["pop","push","shift","sort","splice","unshift"],function(h){var g=H0[h],x=/^(?:push|sort|unshift)$/.test(h)?"tap":"thru",w=/^(?:pop|shift)$/.test(h);O.prototype[h]=function(){var k=arguments;if(w&&!this.__chain__){var F=this.value();return g.apply(qe(F)?F:[],k)}return this[x](function(I){return g.apply(qe(I)?I:[],k)})}}),Ys(tt.prototype,function(h,g){var x=O[g];if(x){var w=x.name+"";_t.call(tf,w)||(tf[w]=[]),tf[w].push({name:g,func:x})}}),tf[pm(n,b).name]=[{name:"wrapper",func:n}],tt.prototype.clone=hJ,tt.prototype.reverse=dJ,tt.prototype.value=pJ,O.prototype.at=qZ,O.prototype.chain=VZ,O.prototype.commit=WZ,O.prototype.next=GZ,O.prototype.plant=YZ,O.prototype.reverse=XZ,O.prototype.toJSON=O.prototype.valueOf=O.prototype.value=KZ,O.prototype.first=O.prototype.head,wd&&(O.prototype[wd]=HZ),O},Qc=WK();ml?((ml.exports=Qc)._=Qc,C2._=Qc):Ln._=Qc}).call(HMe)}(Rp,Rp.exports)),Rp.exports}var XMe=YMe();const x1=2147483648,KMe=4294967295;class zO{constructor(t){this._size=t,this._bits=new Uint32Array(Math.ceil(t/32))}get length(){return this._size}count(){const t=this._bits.length;let n=0;for(let i=0;i<t;++i)for(let r=this._bits[i];r;++n)r&=r-1;return n}get(t){return this._bits[t>>5]&x1>>>t}set(t){this._bits[t>>5]|=x1>>>t}clear(t){this._bits[t>>5]&=~(x1>>>t)}scan(t){for(let n=this.next(0);n>=0;n=this.next(n+1))t(n)}next(t){const n=this._bits,i=n.length;let r=t>>5,s=n[r]&KMe>>>t;for(;r<i;s=n[++r])if(s!==0)return(r<<5)+Math.clz32(s);return-1}nth(t){let n=this.next(0);for(;t--&&n>=0;)n=this.next(n+1);return n}not(){const t=this._bits,n=t.length;for(let r=0;r<n;++r)t[r]=~t[r];const i=this._size%32;return i&&(t[n-1]&=x1>>i-1),this}and(t){if(t){const n=this._bits,i=t._bits,r=n.length;for(let s=0;s<r;++s)n[s]&=i[s]}return this}or(t){if(t){const n=this._bits,i=t._bits,r=n.length;for(let s=0;s<r;++s)n[s]|=i[s]}return this}}function JMe(e,t,n,i,r){return e==null?null:e<t?-1/0:e>n?1/0:(e=Math.max(t,Math.min(e,n)),t+i*Math.floor(1e-14+(e-t)/i+(r||0)))}function Hu(e){return e instanceof Date}function Mv(e){return e instanceof RegExp}function Yu(e){return e===Object(e)}function BO(e,t){return e==null||t==null||e!==e||t!==t?!1:e===t?!0:Hu(e)||Hu(t)?+e==+t:Mv(e)&&Mv(t)?e+""==t+"":Yu(e)&&Yu(t)?QMe(e,t):!1}function QMe(e,t){if(Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;if(e.length||t.length)return HP(e,t);const n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length||(n.sort(),i.sort(),!HP(n,i,(s,a)=>s===a)))return!1;const r=n.length;for(let s=0;s<r;++s){const a=n[s];if(!BO(e[a],t[a]))return!1}return!0}function HP(e,t,n=BO){const i=e.length;if(i!==t.length)return!1;for(let r=0;r<i;++r)if(!n(e[r],t[r]))return!1;return!0}function ZMe(e,t,n){if(t instanceof Map){if(t.has(e))return t.get(e)}else{const i=`${e}`;if(Object.hasOwn(t,i))return t[i]}return n!==void 0?n:e}function eNe(e,t,n){let i=arguments.length;e=+e,t=+t,n=i<2?(t=e,e=0,1):i<3?1:+n,i=Math.max(0,Math.ceil((t-e)/n))|0;const r=new Array(i);for(let s=0;s<i;++s)r[s]=e+s*n;return r}const ft=void 0;function Ri(e){return Array.isArray(e)}const tNe=Object.getPrototypeOf(Int8Array);function Xb(e){return e instanceof tNe}function fl(e){return Ri(e)||Xb(e)}function Gs(e){return typeof e=="string"}function Cs(e){return e!=null&&e===e}const M0=e=>fl(e)||Gs(e);function nNe(e){return fl(e)?e.filter(t=>Cs(t)):e}function iNe(...e){return[].concat(...e)}function rNe(e,t,n){return M0(e)?e.includes(t,n):!1}function sNe(e,t){return M0(e)?e.indexOf(t):-1}function aNe(e,t){return fl(e)?e.join(t):ft}function oNe(e,t){return M0(e)?e.lastIndexOf(t):-1}function uNe(e){return M0(e)?e.length:0}function lNe(e,t){return fl(e)?e.map(n=>Cs(n)?n[t]:ft):ft}function cNe(e){return fl(e)?e.slice().reverse():Gs(e)?e.split("").reverse().join(""):ft}function fNe(e,t,n){return M0(e)?e.slice(t,n):ft}const hNe=Object.freeze(Object.defineProperty({__proto__:null,compact:nNe,concat:iNe,includes:rNe,indexof:sNe,join:aNe,lastindexof:oNe,length:uNe,pluck:lNe,reverse:cNe,slice:fNe},Symbol.toStringTag,{value:"Module"}));function K1(e,t,n="0"){const i=e+"",r=i.length;return r<t?Array(t-r+1).join(n)+i:i}const Zs=e=>(e<10?"0":"")+e,dNe=e=>e<0?"-"+K1(-e,6):e>9999?"+"+K1(e,6):K1(e,4);function MG(e,t,n,i,r,s,a,o,u){const l=o?"Z":"";return dNe(e)+"-"+Zs(t+1)+"-"+Zs(n)+(!u||a?"T"+Zs(i)+":"+Zs(r)+":"+Zs(s)+"."+K1(a,3)+l:s?"T"+Zs(i)+":"+Zs(r)+":"+Zs(s)+l:r||i||!o?"T"+Zs(i)+":"+Zs(r)+l:"")}function NG(e,t){return isNaN(e)?"Invalid Date":MG(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds(),!1,t)}function Kb(e,t){return isNaN(e)?"Invalid Date":MG(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds(),!0,t)}const pNe=/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/;function RG(e){return e.match(pNe)&&!isNaN(Date.parse(e))}function gNe(e,t=Date.parse){return RG(e)?t(e):e}const IG=6e4,DG=864e5,PG=6048e5,Jt=new Date,Qt=new Date,cn=e=>(Jt.setTime(typeof e=="string"?gNe(e):e),Jt);function mNe(e,t){return NG(cn(e),!t)}function yNe(e,t){return Kb(cn(e),!t)}function vNe(){return Date.now()}function xNe(e){return+cn(e)}function bNe(e,t,n,i,r,s,a){return arguments.length?new Date(e,t||0,n??1,i||0,r||0,s||0,a||0):new Date(Date.now())}function _Ne(e){return cn(e).getFullYear()}function wNe(e){return Math.floor(cn(e).getMonth()/3)}function ENe(e){return cn(e).getMonth()}function SNe(e,t){const n=t||0;Qt.setTime(+e),Qt.setDate(Qt.getDate()-(Qt.getDay()+7-n)%7),Qt.setHours(0,0,0,0),Jt.setTime(+e),Jt.setMonth(0),Jt.setDate(1),Jt.setDate(1-(Jt.getDay()+7-n)%7),Jt.setHours(0,0,0,0);const i=(Qt.getTimezoneOffset()-Jt.getTimezoneOffset())*IG;return Math.floor((1+(+Qt-+Jt)-i)/PG)}function ANe(e){return cn(e).getDate()}function CNe(e){Qt.setTime(+e),Qt.setHours(0,0,0,0),Jt.setTime(+Qt),Jt.setMonth(0),Jt.setDate(1);const t=(Qt.getTimezoneOffset()-Jt.getTimezoneOffset())*IG;return Math.floor(1+(+Qt-+Jt-t)/DG)}function kNe(e){return cn(e).getDay()}function $Ne(e){return cn(e).getHours()}function TNe(e){return cn(e).getMinutes()}function ONe(e){return cn(e).getSeconds()}function FNe(e){return cn(e).getMilliseconds()}function MNe(e,t,n,i,r,s,a){return arguments.length?new Date(Date.UTC(e,t||0,n??1,i||0,r||0,s||0,a||0)):new Date(Date.now())}function NNe(e){return cn(e).getUTCFullYear()}function RNe(e){return Math.floor(cn(e).getUTCMonth()/3)}function INe(e){return cn(e).getUTCMonth()}function DNe(e,t){const n=t||0;return Qt.setTime(+e),Qt.setUTCDate(Qt.getUTCDate()-(Qt.getUTCDay()+7-n)%7),Qt.setUTCHours(0,0,0,0),Jt.setTime(+e),Jt.setUTCMonth(0),Jt.setUTCDate(1),Jt.setUTCDate(1-(Jt.getUTCDay()+7-n)%7),Jt.setUTCHours(0,0,0,0),Math.floor((1+(+Qt-+Jt))/PG)}function PNe(e){return cn(e).getUTCDate()}function LNe(e){Qt.setTime(+e),Qt.setUTCHours(0,0,0,0);const t=Date.UTC(Qt.getUTCFullYear(),0,1);return Math.floor(1+(+Qt-t)/DG)}function zNe(e){return cn(e).getUTCDay()}function BNe(e){return cn(e).getUTCHours()}function UNe(e){return cn(e).getUTCMinutes()}function jNe(e){return cn(e).getUTCSeconds()}function qNe(e){return cn(e).getUTCMilliseconds()}const VNe=Object.freeze(Object.defineProperty({__proto__:null,date:ANe,datetime:bNe,dayofweek:kNe,dayofyear:CNe,format_date:mNe,format_utcdate:yNe,hours:$Ne,milliseconds:FNe,minutes:TNe,month:ENe,now:vNe,quarter:wNe,seconds:ONe,timestamp:xNe,utcdate:PNe,utcdatetime:MNe,utcdayofweek:zNe,utcdayofyear:LNe,utchours:BNe,utcmilliseconds:qNe,utcminutes:UNe,utcmonth:INe,utcquarter:RNe,utcseconds:jNe,utcweek:DNe,utcyear:NNe,week:SNe,year:_Ne},Symbol.toStringTag,{value:"Module"}));function WNe(e){return JSON.parse(e)}function GNe(e){return JSON.stringify(e)}const HNe=Object.freeze(Object.defineProperty({__proto__:null,parse_json:WNe,to_json:GNe},Symbol.toStringTag,{value:"Module"}));let YNe=Math.random;function sd(){return YNe()}function XNe(){return sd()}function KNe(e){return Number.isNaN(e)}function JNe(e){return Number.isFinite(e)}function QNe(e){return Math.abs(e)}function ZNe(e){return Math.cbrt(e)}function eRe(e){return Math.ceil(e)}function tRe(e){return Math.clz32(e)}function nRe(e){return Math.exp(e)}function iRe(e){return Math.expm1(e)}function rRe(e){return Math.floor(e)}function sRe(e){return Math.fround(e)}function aRe(...e){return Math.max(...e)}function oRe(...e){return Math.min(...e)}function uRe(e){return Math.log(e)}function lRe(e){return Math.log10(e)}function cRe(e){return Math.log1p(e)}function fRe(e){return Math.log2(e)}function hRe(e,t){return Math.pow(e,t)}function dRe(e){return Math.round(e)}function pRe(e){return Math.sign(e)}function gRe(e){return Math.sqrt(e)}function mRe(e){return Math.trunc(e)}function yRe(e){return 180*e/Math.PI}function vRe(e){return Math.PI*e/180}function xRe(e){return Math.acos(e)}function bRe(e){return Math.acosh(e)}function _Re(e){return Math.asin(e)}function wRe(e){return Math.asinh(e)}function ERe(e){return Math.atan(e)}function SRe(e,t){return Math.atan2(e,t)}function ARe(e){return Math.atanh(e)}function CRe(e){return Math.cos(e)}function kRe(e){return Math.cosh(e)}function $Re(e){return Math.sin(e)}function TRe(e){return Math.sinh(e)}function ORe(e){return Math.tan(e)}function FRe(e){return Math.tanh(e)}const MRe=Object.freeze(Object.defineProperty({__proto__:null,abs:QNe,acos:xRe,acosh:bRe,asin:_Re,asinh:wRe,atan:ERe,atan2:SRe,atanh:ARe,cbrt:ZNe,ceil:eRe,clz32:tRe,cos:CRe,cosh:kRe,degrees:yRe,exp:nRe,expm1:iRe,floor:rRe,fround:sRe,greatest:aRe,is_finite:JNe,is_nan:KNe,least:oRe,log:uRe,log10:lRe,log1p:cRe,log2:fRe,pow:hRe,radians:vRe,random:XNe,round:dRe,sign:pRe,sin:$Re,sinh:TRe,sqrt:gRe,tan:ORe,tanh:FRe,trunc:mRe},Symbol.toStringTag,{value:"Module"}));function UO(e){return e instanceof Map}function NRe(e){return e instanceof Set}function Jb(e){return UO(e)||NRe(e)}function jO(e){return Array.from(e)}function RRe(e,t){return Jb(e)?e.has(t):e!=null?Object.hasOwn(e,`${t}`):!1}function IRe(e){return UO(e)?jO(e.keys()):e!=null?Object.keys(e):[]}function DRe(e){return Jb(e)?jO(e.values()):e!=null?Object.values(e):[]}function PRe(e){return Jb(e)?jO(e.entries()):e!=null?Object.entries(e):[]}function LRe(e){return e?Object.fromEntries(e):ft}const zRe=Object.freeze(Object.defineProperty({__proto__:null,entries:PRe,has:RRe,keys:IRe,object:LRe,values:DRe},Symbol.toStringTag,{value:"Module"}));function BRe(e){return e==null?e:new Date(e)}function URe(e){return e==null?e:Number.parseFloat(e)}function jRe(e,t){return e==null?e:Number.parseInt(e,t)}function qRe(e,t,n){return e==null?!1:String(e).endsWith(t,n)}function VRe(e,t,n){const i=e==null?e:String(e).match(t);return n==null||i==null?i:typeof n=="number"?i[n]:i.groups?i.groups[n]:null}function WRe(e,t){return e==null?e:String(e).normalize(t)}function GRe(e,t,n){return e==null?e:String(e).padEnd(t,n)}function HRe(e,t,n){return e==null?e:String(e).padStart(t,n)}function YRe(e){return e==null?e:String(e).toUpperCase()}function XRe(e){return e==null?e:String(e).toLowerCase()}function KRe(e,t){return e==null?e:String(e).repeat(t)}function JRe(e,t,n){return e==null?e:String(e).replace(t,String(n))}function QRe(e,t,n){return e==null?[]:String(e).split(t,n)}function ZRe(e,t,n){return e==null?!1:String(e).startsWith(t,n)}function eIe(e,t,n){return e==null?e:String(e).substring(t,n)}function tIe(e){return e==null?e:String(e).trim()}const nIe=Object.freeze(Object.defineProperty({__proto__:null,endswith:qRe,lower:XRe,match:VRe,normalize:WRe,padend:GRe,padstart:HRe,parse_date:BRe,parse_float:URe,parse_int:jRe,repeat:KRe,replace:JRe,split:QRe,startswith:ZRe,substring:eIe,trim:tIe,upper:YRe},Symbol.toStringTag,{value:"Module"})),If={bin:JMe,equal:BO,recode:ZMe,sequence:eNe,...hNe,...VNe,...HNe,...MRe,...zRe,...nIe};function $a(e){return e!=null?Ri(e)?e:[e]:[]}function Fg(e){return typeof e=="bigint"}function Ro(e){return e===void 0?e+"":Fg(e)?e+"n":JSON.stringify(e)}let iIe=class{constructor(t,n,i){this.name=t,this.fields=n,this.params=i}toString(){const t=[...this.fields.map(n=>`d[${Ro(n)}]`),...this.params.map(Ro)];return`d => op.${this.name}(${t})`}toObject(){return{expr:this.toString(),func:!0}}};function Ve(e,t=[],n=[]){return new iIe(e,$a(t),$a(n))}const LG=e=>Ve("any",e),zG=()=>Ve("count"),BG=e=>Ve("array_agg",e),UG=e=>Ve("array_agg_distinct",e),jG=(e,t)=>Ve("map_agg",[e,t]),qG=(e,t)=>Ve("object_agg",[e,t]),VG=(e,t)=>Ve("entries_agg",[e,t]),su={...If,row_object:(...e)=>Ve("row_object",null,e.flat()),count:zG,any:LG,array_agg:BG,array_agg_distinct:UG,object_agg:qG,map_agg:jG,entries_agg:VG,valid:e=>Ve("valid",e),invalid:e=>Ve("invalid",e),distinct:e=>Ve("distinct",e),mode:e=>Ve("mode",e),sum:e=>Ve("sum",e),product:e=>Ve("product",e),mean:e=>Ve("mean",e),average:e=>Ve("average",e),variance:e=>Ve("variance",e),variancep:e=>Ve("variancep",e),stdev:e=>Ve("stdev",e),stdevp:e=>Ve("stdevp",e),min:e=>Ve("min",e),max:e=>Ve("max",e),quantile:(e,t)=>Ve("quantile",e,t),median:e=>Ve("median",e),covariance:(e,t)=>Ve("covariance",[e,t]),covariancep:(e,t)=>Ve("covariancep",[e,t]),corr:(e,t)=>Ve("corr",[e,t]),bins:(e,t,n,i,r)=>Ve("bins",e,[t,n,i,r]),row_number:()=>Ve("row_number"),rank:()=>Ve("rank"),avg_rank:()=>Ve("avg_rank"),dense_rank:()=>Ve("dense_rank"),percent_rank:()=>Ve("percent_rank"),cume_dist:()=>Ve("cume_dist"),ntile:e=>Ve("ntile",null,e),lag:(e,t,n)=>Ve("lag",e,[t,n]),lead:(e,t,n)=>Ve("lead",e,[t,n]),first_value:e=>Ve("first_value",e),last_value:e=>Ve("last_value",e),nth_value:(e,t)=>Ve("nth_value",e,t),fill_down:(e,t)=>Ve("fill_down",e,t),fill_up:(e,t)=>Ve("fill_up",e,t)};function Gt(e,t){throw Error(e,{cause:t})}function rIe(e,t){e=Jb(e)?e:new Set(e);let n=t,i=0;for(;e.has(n);)n=t+ ++i;return n}function Kn(e){return typeof e=="function"}function ad(e,t){const n=Array(e);if(Kn(t))for(let i=0;i<e;++i)n[i]=t(i);else n.fill(t);return n}function sIe(e,t,n=15,i=!0,r=0,s){const o=Math.LN10;if(s==null){const u=Math.ceil(Math.log(n)/o),l=t-e||Math.abs(e)||1,c=[5,2];for(s=Math.max(r,Math.pow(10,Math.round(Math.log(l)/o)-u));Math.ceil(l/s)>n;)s*=10;const f=c.length;for(let d=0;d<f;++d){const p=s/c[d];p>=r&&l/p<=n&&(s=p)}}if(i){let u=Math.log(s);const l=u>=0?0:~~(-u/o)+1,c=Math.pow(10,-l-1);u=Math.floor(e/s+c)*s,e=e<u?u-s:u,t=Math.ceil(t/s)*s}return[e,t===e?e+s:t,s]}function Oh(e){const t=typeof e;return t==="string"?`"${e}"`:t!=="object"||!e?e:Hu(e)?+e:Ri(e)||Xb(e)?`[${e.map(Oh)}]`:Mv(e)?e+"":aIe(e)}function aIe(e){let t="{",n=-1;for(const i in e)++n>0&&(t+=","),t+=`"${i}":${Oh(e[i])}`;return t+="}",t}function Nv(e,t){const n=e.length;return n===1?(i,r)=>Oh(e[0](i,r)):(i,r)=>{let s="";for(let a=0;a<n;++a){a>0&&(s+="|");const o=e[a](i,r);if(t&&(o==null||o!==o))return null;s+=Oh(o)}return s}}function oIe(){const e=new Map;return{count(){return e.size},values(){return Array.from(e.values(),t=>t.v)},increment(t){const n=Oh(t),i=e.get(n);i?++i.n:e.set(n,{v:t,n:1})},decrement(t){const n=Oh(t),i=e.get(n);i.n===1?e.delete(n):--i.n},forEach(t){e.forEach(({v:n,n:i})=>t(n,i))}}}function lo(){}function uIe(e,t=0,n=e.length){let i=e[t++];for(let r=t;r<n;++r)i*=e[r];return i}function yn(e){return e.init=e.init||lo,e.add=e.add||lo,e.rem=e.rem||lo,e}function YP(e,t){return e.product_v=!1,e.product=t}const WG={count:{create:()=>yn({value:e=>e.count}),param:[]},array_agg:{create:()=>yn({init:e=>e.values=!0,value:e=>e.list.values(e.stream)}),param:[1]},object_agg:{create:()=>yn({init:e=>e.values=!0,value:e=>Object.fromEntries(e.list.values())}),param:[2]},map_agg:{create:()=>yn({init:e=>e.values=!0,value:e=>new Map(e.list.values())}),param:[2]},entries_agg:{create:()=>yn({init:e=>e.values=!0,value:e=>e.list.values(e.stream)}),param:[2]},any:{create:()=>yn({add:(e,t)=>{e.any==null&&(e.any=t)},value:e=>e.valid?e.any:ft}),param:[1]},valid:{create:()=>yn({value:e=>e.valid}),param:[1]},invalid:{create:()=>yn({value:e=>e.count-e.valid}),param:[1]},distinct:{create:()=>({init:e=>e.distinct=oIe(),value:e=>e.distinct.count()+(e.valid===e.count?0:1),add:(e,t)=>e.distinct.increment(t),rem:(e,t)=>e.distinct.decrement(t)}),param:[1]},array_agg_distinct:{create:()=>yn({value:e=>e.distinct.values()}),param:[1],req:["distinct"]},mode:{create:()=>yn({value:e=>{let t=ft,n=0;return e.distinct.forEach((i,r)=>{r>n&&(n=r,t=i)}),t}}),param:[1],req:["distinct"]},sum:{create:()=>({init:e=>e.sum=0,value:e=>e.valid?e.sum:ft,add:(e,t)=>Fg(t)?e.sum===0?e.sum=t:e.sum+=t:e.sum+=+t,rem:(e,t)=>e.sum-=t}),param:[1]},product:{create:()=>({init:e=>YP(e,1),value:e=>e.valid?e.product_v?YP(e,uIe(e.list.values())):e.product:void 0,add:(e,t)=>Fg(t)&&e.product===1?e.product=t:e.product*=t,rem:(e,t)=>t==0||t===1/0||t===-1/0?e.product_v=!0:e.product/=t}),param:[1],stream:["array_agg"]},mean:{create:()=>({init:e=>e.mean=0,value:e=>e.valid?e.mean:ft,add:(e,t)=>{e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid},rem:(e,t)=>{e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean}}),param:[1]},average:{create:()=>yn({value:e=>e.valid?e.mean:ft}),param:[1],req:["mean"]},variance:{create:()=>({init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):ft,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean)}),param:[1],req:["mean"]},variancep:{create:()=>yn({value:e=>e.valid>1?e.dev/e.valid:ft}),param:[1],req:["variance"]},stdev:{create:()=>yn({value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):ft}),param:[1],req:["variance"]},stdevp:{create:()=>yn({value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):ft}),param:[1],req:["variance"]},min:{create:()=>({init:e=>e.min=ft,value:e=>e.min=Number.isNaN(e.min)?e.list.min():e.min,add:(e,t)=>{(t<e.min||e.min===ft)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)}}),param:[1],stream:["array_agg"]},max:{create:()=>({init:e=>e.max=ft,value:e=>e.max=Number.isNaN(e.max)?e.list.max():e.max,add:(e,t)=>{(t>e.max||e.max===ft)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)}}),param:[1],stream:["array_agg"]},quantile:{create:e=>yn({value:t=>t.list.quantile(e)}),param:[1,1],req:["array_agg"]},median:{create:()=>yn({value:e=>e.list.quantile(.5)}),param:[1],req:["array_agg"]},covariance:{create:()=>({init:e=>{e.cov=e.mean_x=e.mean_y=e.dev_x=e.dev_y=0},value:e=>e.valid>1?e.cov/(e.valid-1):ft,add:(e,t,n)=>{const i=t-e.mean_x,r=n-e.mean_y;e.mean_x+=i/e.valid,e.mean_y+=r/e.valid;const s=n-e.mean_y;e.dev_x+=i*(t-e.mean_x),e.dev_y+=r*s,e.cov+=i*s},rem:(e,t,n)=>{const i=t-e.mean_x,r=n-e.mean_y;e.mean_x-=e.valid?i/e.valid:e.mean_x,e.mean_y-=e.valid?r/e.valid:e.mean_y;const s=n-e.mean_y;e.dev_x-=i*(t-e.mean_x),e.dev_y-=r*s,e.cov-=i*s}}),param:[2]},covariancep:{create:()=>yn({value:e=>e.valid>1?e.cov/e.valid:ft}),param:[2],req:["covariance"]},corr:{create:()=>yn({value:e=>e.valid>1?e.cov/(Math.sqrt(e.dev_x)*Math.sqrt(e.dev_y)):ft}),param:[2],req:["covariance"]},bins:{create:(e,t,n,i)=>yn({value:r=>sIe(r.min,r.max,e,t,n,i)}),param:[1,4],req:["min","max"]}},XP={create(){let e;return{init:()=>e=1,value:t=>{const n=t.index;return n&&!t.peer(n)?e=n+1:e}}},param:[]},KP={create(){let e;return{init:()=>e=0,value:t=>{const{index:n,peer:i,size:r}=t;let s=n;if(e<s){for(;s+1<r&&i(s+1);)++s;e=s}return(1+e)/r}}},param:[]},GG={row_number:{create(){return{init:lo,value:e=>e.index+1}},param:[]},rank:XP,avg_rank:{create(){let e,t;return{init:()=>(e=-1,t=1),value:n=>{const i=n.index;if(i>=e){for(t=e=i+1;n.peer(e);t+=++e);t/=e-i}return t}}},param:[]},dense_rank:{create(){let e;return{init:()=>e=1,value:t=>{const n=t.index;return n&&!t.peer(n)?++e:e}}},param:[]},percent_rank:{create(){const{init:e,value:t}=XP.create();return{init:e,value:n=>(t(n)-1)/(n.size-1)}},param:[]},cume_dist:KP,ntile:{create(e){e=+e,e>0||Gt("ntile num must be greater than zero.");const{init:t,value:n}=KP.create();return{init:t,value:i=>Math.ceil(e*n(i))}},param:[0,1]},lag:{create(e,t=ft){return e=+e||1,{init:lo,value:(n,i)=>{const r=n.index-e;return r>=0?n.value(r,i):t}}},param:[1,2]},lead:{create(e,t=ft){return e=+e||1,{init:lo,value:(n,i)=>{const r=n.index+e;return r<n.size?n.value(r,i):t}}},param:[1,2]},first_value:{create(){return{init:lo,value:(e,t)=>e.value(e.i0,t)}},param:[1]},last_value:{create(){return{init:lo,value:(e,t)=>e.value(e.i1-1,t)}},param:[1]},nth_value:{create(e){return e=+e,e>0||Gt("nth_value nth must be greater than zero."),{init:lo,value:(t,n)=>{const i=t.i0+(e-1);return i<t.i1?t.value(i,n):ft}}},param:[1,1]},fill_down:{create(e=ft){let t;return{init:()=>t=e,value:(n,i)=>{const r=n.value(n.index,i);return Cs(r)?t=r:t}}},param:[1,1]},fill_up:{create(e=ft){let t,n;return{init:()=>(t=e,n=-1),value:(i,r)=>i.index<=n?t:(n=lIe(i,r,i.index))>=0?t=i.value(n,r):(n=i.size,t=e)}},param:[1,1]}};function lIe(e,t,n){for(const i=e.size;n<i;++n)if(Cs(e.value(n,t)))return n;return-1}function qO(e){return Object.hasOwn(WG,e)}function VO(e){return Object.hasOwn(GG,e)}function HG(e){return Object.hasOwn(If,e)||e==="row_object"}function YG(e){return qO(e)&&WG[e]}function XG(e){return VO(e)&&GG[e]}function N0(e,t=(i,r)=>i,n=""){const i=e.length;if(!i)return"";let r=t(e[0],0);for(let s=1;s<i;++s)r+=n+t(e[s],s);return r}function od(e,t,...n){const i=["_","$"],r=i.slice(0,n.length);return r.push('"use strict"; const '+n.map((s,a)=>s.map((o,u)=>`${i[a]}${u} = ${i[a]}[${u}]`).join(", ")).join(", ")+`; return (${e}) => ${t};`),Function(...r)(...n)}function WO(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function cIe(e,t=0,n=e.length){let i=n?e[t++]:ft;for(let r=t;r<n;++r)i<e[r]&&(i=e[r]);return i}function fIe(e,t=0,n=e.length){let i=n?e[t++]:ft;for(let r=t;r<n;++r)i>e[r]&&(i=e[r]);return i}function b1(e){return Fg(e)?e:+e}function hIe(e,t){const n=e.length;if(!n)return ft;if((t=+t)<=0||n<2)return b1(e[0]);if(t>=1)return b1(e[n-1]);const i=(n-1)*t,r=Math.floor(i),s=b1(e[r]);return Fg(s)?s:s+(b1(e[r+1])-s)*(i-r)}class dIe{constructor(t){this._values=t||[],this._sorted=null,this._start=0}values(t){return this._start&&(this._values=this._values.slice(this._start),this._start=0),t?this._values.slice():this._values}add(t){this._values.push(t),this._sorted=null}rem(){this._start+=1,this._sorted=null}min(){return this._sorted&&this._sorted.length?this._sorted[0]:fIe(this._values,this._start)}max(){return this._sorted&&this._sorted.length?this._sorted[this._sorted.length-1]:cIe(this._values,this._start)}quantile(t){return this._sorted||(this._sorted=this.values(!0),this._sorted.sort(WO)),hIe(this._sorted,t)}}class pIe{constructor(t){this._outputs=t}size(){return this._outputs.length}outputs(){return this._outputs}init(t){return{}}add(t,n,i){}rem(t,n,i){}write(t,n,i){}}const Rv=(e,t,n)=>od(t,"{"+N0(e,(i,r)=>`_${r}.${n}(${t});`)+"}",e);function gIe(e,t){const{ops:n,output:i}=mIe(e,t),r=e[0].fields,s=r.length,a=s===0?GO:s===1?yIe:s===2?vIe:Gt("Unsupported field count: "+s);return new a(r,n,i,t)}function mIe(e,t){const n={},i=[];function r(a,o=[]){const u=a+":"+o;if(n[u])return n[u];const l=YG(a),c=l.create(...o);return t<0&&l.stream&&l.stream.forEach(f=>r(f,[])),l.req&&l.req.forEach(f=>r(f,[])),n[u]=c,i.push(c),c}const s=e.map(a=>{const o=r(a.name,a.params);return o.output=a.id,o});return{ops:i,output:s}}class GO extends pIe{constructor(t,n,i,r){super(i),this._op=n,this._fields=t,this._stream=!!r}init(){const t={count:0,valid:0,stream:this._stream};return this._op.forEach(n=>n.init(t)),t.values&&(t.list=new dIe),t}write(t,n,i){const r=this._outputs,s=r.length;for(let a=0;a<s;++a)n[r[a].output][i]=r[a].value(t);return 1}_add(){}_rem(){}add(t){++t.count}rem(t){--t.count}}class yIe extends GO{constructor(t,n,i,r){super(t,n,i,r);const s=["state","v1","v2"];this._add=Rv(n,s,"add"),this._rem=Rv(n,s,"rem")}add(t,n,i){const r=this._fields[0](n,i);++t.count,Cs(r)&&(++t.valid,t.list&&t.list.add(r),this._add(t,r))}rem(t,n,i){const r=this._fields[0](n,i);--t.count,Cs(r)&&(--t.valid,t.list&&t.list.rem(),this._rem(t,r))}}class vIe extends GO{constructor(t,n,i,r){super(t,n,i,r);const s=["state","v1","v2"];this._add=Rv(n,s,"add"),this._rem=Rv(n,s,"rem")}add(t,n,i){const r=this._fields[0](n,i),s=this._fields[1](n,i);++t.count,Cs(r)&&Cs(s)&&(++t.valid,t.list&&t.list.add([r,s]),this._add(t,r,s))}rem(t,n,i){const r=this._fields[0](n,i),s=this._fields[1](n,i);--t.count,Cs(r)&&Cs(s)&&(--t.valid,t.list&&t.list.rem(),this._rem(t,r,s))}}function Wc(e,t,n){if(t.length){const i=e.data(),{keys:r}=e.groups()||{},s=ud(e,t),a=r?(o,u)=>s[o][r[u]]:o=>s[o][0];n=n.map(o=>u=>o(u,i,a))}return n}function ud(e,t,n){if(!t.length)return n;const i=KG(t),r=e.groups(),s=r?r.size:1;return n=n||ad(t.length,()=>Array(s)),s>1?i.forEach(a=>{const o=QG(e,a,r);for(let u=0;u<s;++u)a.write(o[u],n,u)}):i.forEach(a=>{const o=JG(e,a);a.write(o,n,0)}),n}function KG(e,t){const n=[],i={};for(const r of e){const s=r.fields.map(a=>a+"").join(",");(i[s]||(i[s]=[])).push(r)}for(const r in i)n.push(gIe(i[r],t));return n}function JG(e,t){const n=t.init(),i=e.totalRows(),r=e.data(),s=e.mask();if(e.isOrdered()){const a=e.indices();for(let o=0;o<i;++o)t.add(n,a[o],r)}else if(s)for(let a=s.next(0);a>=0;a=s.next(a+1))t.add(n,a,r);else for(let a=0;a<i;++a)t.add(n,a,r);return n}function QG(e,t,n){const{keys:i,size:r}=n,s=ad(r,()=>t.init()),a=e.data();if(e.isOrdered()){const o=e.indices(),u=o.length;for(let l=0;l<u;++l){const c=o[l];t.add(s[i[c]],c,a)}}else if(e.isFiltered()){const o=e.mask();for(let u=o.next(0);u>=0;u=o.next(u+1))t.add(s[i[u]],u,a)}else{const o=e.totalRows();for(let u=0;u<o;++u)t.add(s[i[u]],u,a)}return s}function ZG(e,t){const{get:n,names:i,rows:r,size:s}=t,a=i.length;for(let o=0;o<a;++o){const u=e.add(i[o],Array(s)),l=n[o];for(let c=0;c<s;++c)u[c]=l(r[c])}}function HO(e){return Ri(e)?e:UO(e)?e.entries():e?Object.entries(e):[]}const xIe="ArrayPattern",bIe="ArrowFunctionExpression",_Ie="FunctionExpression",Fu="Identifier",ld="Literal",eH="MemberExpression",wIe="ObjectExpression",tH="ObjectPattern",nH="Property",iH="Column",EIe="Constant",SIe="Dictionary",AIe="Function",CIe="Parameter",rH="Op";function ut(e,t,n,i){const r=n[e.type]||n.Default;if(r&&r(e,t,i)===!1)return;const s=kIe[e.type];s&&s(e,t,n)}const _1=(e,t,n)=>{ut(e.argument,t,n,e)},kE=(e,t,n)=>{ut(e.left,t,n,e),ut(e.right,t,n,e)},JP=(e,t,n)=>{ut(e.test,t,n,e),ut(e.consequent,t,n,e),e.alternate&&ut(e.alternate,t,n,e)},$E=(e,t,n)=>{na(e.params,t,n,e),ut(e.body,t,n,e)},QP=(e,t,n)=>{ut(e.callee,t,n,e),na(e.arguments,t,n,e)},na=(e,t,n,i)=>{e.forEach(r=>ut(r,t,n,i))},kIe={TemplateLiteral:(e,t,n)=>{na(e.expressions,t,n,e),na(e.quasis,t,n,e)},MemberExpression:(e,t,n)=>{ut(e.object,t,n,e),ut(e.property,t,n,e)},CallExpression:QP,NewExpression:QP,ArrayExpression:(e,t,n)=>{na(e.elements,t,n,e)},AssignmentExpression:kE,AwaitExpression:_1,BinaryExpression:kE,LogicalExpression:kE,UnaryExpression:_1,UpdateExpression:_1,ConditionalExpression:JP,ObjectExpression:(e,t,n)=>{na(e.properties,t,n,e)},Property:(e,t,n)=>{ut(e.key,t,n,e),ut(e.value,t,n,e)},ArrowFunctionExpression:$E,FunctionExpression:$E,FunctionDeclaration:$E,VariableDeclaration:(e,t,n)=>{na(e.declarations,t,n,e)},VariableDeclarator:(e,t,n)=>{ut(e.id,t,n,e),ut(e.init,t,n,e)},SpreadElement:(e,t,n)=>{ut(e.argument,t,n,e)},BlockStatement:(e,t,n)=>{na(e.body,t,n,e)},ExpressionStatement:(e,t,n)=>{ut(e.expression,t,n,e)},IfStatement:JP,ForStatement:(e,t,n)=>{ut(e.init,t,n,e),ut(e.test,t,n,e),ut(e.update,t,n,e),ut(e.body,t,n,e)},WhileStatement:(e,t,n)=>{ut(e.test,t,n,e),ut(e.body,t,n,e)},DoWhileStatement:(e,t,n)=>{ut(e.body,t,n,e),ut(e.test,t,n,e)},SwitchStatement:(e,t,n)=>{ut(e.discriminant,t,n,e),na(e.cases,t,n,e)},SwitchCase:(e,t,n)=>{e.test&&ut(e.test,t,n,e),na(e.consequent,t,n,e)},ReturnStatement:_1,Program:(e,t,n)=>{ut(e.body[0],t,n,e)}};function sH(e){delete e.start,delete e.end,delete e.optional}function ZP(e){sH(e),delete e.object,delete e.property,delete e.computed,e.table||delete e.table}function $Ie(e){return ut(e,null,{Column:ZP,Constant:ZP,Default:sH}),e}function bn(e,t){return t&&t.type===e}function TIe(e){return bn(_Ie,e)||bn(bIe,e)}const Mt=(e,t)=>{const n=FIe[e.type];return n?n(e,t):Gt(`Unsupported expression construct: ${e.type}`)},TE=(e,t)=>"("+Mt(e.left,t)+" "+e.operator+" "+Mt(e.right,t)+")",OE=(e,t)=>"("+ia(e.params,t)+")=>"+Mt(e.body,t),eL=(e,t)=>Mt(e.callee,t)+"("+ia(e.arguments,t)+")",ia=(e,t,n=",")=>e.map(i=>Mt(i,t)).join(n),YO=e=>e.computed?`[${Ro(e.name)}]`:`.${e.name}`,tL=(e,t,n)=>{const i=e.table||"";return`data${i}${YO(e)}.${n}(${t.index}${i})`},OIe=(e,t)=>{const n=e.table||"";return`data${n}${YO(e)}[${t.index}${n}]`},FIe={Constant:e=>e.raw,Column:(e,t)=>e.array?OIe(e,t):tL(e,t,"at"),Dictionary:(e,t)=>tL(e,t,"key"),Function:e=>`fn.${e.name}`,Parameter:e=>`$${YO(e)}`,Op:(e,t)=>`op(${Ro(e.name)},${t.op||t.index})`,Literal:e=>e.raw,Identifier:e=>e.name,TemplateLiteral:(e,t)=>{const{quasis:n,expressions:i}=e,r=i.length;let s=n[0].value.raw;for(let a=0;a<r;)s+="${"+Mt(i[a],t)+"}"+n[++a].value.raw;return"`"+s+"`"},MemberExpression:(e,t)=>{const n=!e.computed,i=Mt(e.object,t),r=Mt(e.property,t);return i+(n?"."+r:"["+r+"]")},CallExpression:eL,NewExpression:(e,t)=>"new "+eL(e,t),ArrayExpression:(e,t)=>"["+ia(e.elements,t)+"]",AssignmentExpression:TE,BinaryExpression:TE,LogicalExpression:TE,UnaryExpression:(e,t)=>"("+e.operator+Mt(e.argument,t)+")",ConditionalExpression:(e,t)=>"("+Mt(e.test,t)+"?"+Mt(e.consequent,t)+":"+Mt(e.alternate,t)+")",ObjectExpression:(e,t)=>"({"+ia(e.properties,t)+"})",Property:(e,t)=>{const n=Mt(e.key,t);return(e.computed?`[${n}]`:n)+":"+Mt(e.value,t)},ArrowFunctionExpression:OE,FunctionExpression:OE,FunctionDeclaration:OE,ArrayPattern:(e,t)=>"["+ia(e.elements,t)+"]",ObjectPattern:(e,t)=>"{"+ia(e.properties,t)+"}",VariableDeclaration:(e,t)=>e.kind+" "+ia(e.declarations,t,","),VariableDeclarator:(e,t)=>Mt(e.id,t)+"="+Mt(e.init,t),SpreadElement:(e,t)=>"..."+Mt(e.argument,t),BlockStatement:(e,t)=>"{"+ia(e.body,t,";")+";}",BreakStatement:()=>"break",ExpressionStatement:(e,t)=>Mt(e.expression,t),IfStatement:(e,t)=>"if ("+Mt(e.test,t)+")"+Mt(e.consequent,t)+(e.alternate?" else "+Mt(e.alternate,t):""),SwitchStatement:(e,t)=>"switch ("+Mt(e.discriminant,t)+") {"+ia(e.cases,t,"")+"}",SwitchCase:(e,t)=>(e.test?"case "+Mt(e.test,t):"default")+": "+ia(e.consequent,t,";")+";",ReturnStatement:(e,t)=>"return "+Mt(e.argument,t),Program:(e,t)=>Mt(e.body[0],t)};function Iv(e,t={index:"row"}){return Mt(e,t)}function up(e,t,n){return e=`"use strict"; return ${e};`,Function("fn","$",e)(t,n)}const XO={escape:(e,t,n)=>up(e,t,n),expr:(e,t)=>up(`(row,data,op)=>${e}`,If,t),expr2:(e,t)=>up(`(row0,data0,row,data)=>${e}`,If,t),join:(e,t)=>up(`(row1,data1,row2,data2)=>${e}`,If,t),param:(e,t)=>up(e,If,t)},MIe={"==":1,"!=":1,"===":1,"!==":1};function aH(e,t,n=0,i=void 0,r=void 0){if(e.type=iH,e.name=t,e.table=n,fl(i)&&(e.array=!0),r&&i&&Kn(i.keyFor)){const s=MIe[r.operator]?r.left===e?r.right:r.left:r.callee&&r.callee.name==="equal"?r.arguments[r.arguments[0]===e?1:0]:null;s&&s.type===ld&&NIe(r,e,s,i.keyFor(s.value))}return e}function NIe(e,t,n,i){return i<0?(e.type=ld,e.value=!1,e.raw="false"):(t.type=SIe,n.value=i,n.raw=i+""),!0}const oH="row_object";function uH(e,t,n=t.columnNames()){e.type=wIe;const i=e.properties=[];for(const r of HO(n)){const[s,a]=Ri(r)?r:[r,r];i.push({type:nH,key:{type:ld,raw:Ro(a)},value:aH({computed:!0},s,0,t.column(s))})}return e}function lH(e,t){return Iv(uH({},e,t))}function cH(e,t){return XO.expr(lH(e,t))}function RIe(e){return Kn(e)?e:()=>e}const IIe="Escaped functions are not valid as rollup or pivot values.";function DIe(e,t,n){e.aggronly&&Gt(IIe);const i=`(row,data)=>fn(${lH(e.table)},$)`;return{escape:XO.escape(i,RIe(t.expr),n)}}var PIe=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,7,9,32,4,318,1,80,3,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,68,8,2,0,3,0,2,3,2,4,2,0,15,1,83,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,7,19,58,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,343,9,54,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,10,5350,0,7,14,11465,27,2343,9,87,9,39,4,60,6,26,9,535,9,470,0,2,54,8,3,82,0,12,1,19628,1,4178,9,519,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,245,1,2,9,726,6,110,6,6,9,4759,9,787719,239],fH=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,4,51,13,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,39,27,10,22,251,41,7,1,17,2,60,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,31,9,2,0,3,0,2,37,2,0,26,0,2,0,45,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,200,32,32,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,26,3994,6,582,6842,29,1763,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,433,44,212,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,42,9,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,229,29,3,0,496,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],LIe="‌‍·̀-ͯ·҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-٩ٰۖ-ۜ۟-۪ۤۧۨ-ۭ۰-۹ܑܰ-݊ަ-ް߀-߉߫-߽߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࢗ-࢟࣊-ࣣ࣡-ःऺ-़ा-ॏ॑-ॗॢॣ०-९ঁ-ঃ়া-ৄেৈো-্ৗৢৣ০-৯৾ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣ૦-૯ૺ-૿ଁ-ଃ଼ା-ୄେୈୋ-୍୕-ୗୢୣ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఀ-ఄ఼ా-ౄె-ైొ-్ౕౖౢౣ౦-౯ಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣ೦-೯ೳഀ-ഃ഻഼ാ-ൄെ-ൈൊ-്ൗൢൣ൦-൯ඁ-ඃ්ා-ුූෘ-ෟ෦-෯ෲෳัิ-ฺ็-๎๐-๙ັິ-ຼ່-໎໐-໙༘༙༠-༩༹༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှ၀-၉ၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟፩-፱ᜒ-᜕ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝០-៩᠋-᠍᠏-᠙ᢩᤠ-ᤫᤰ-᤻᥆-᥏᧐-᧚ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼-᪉᪐-᪙᪰-᪽ᪿ-ᫎᬀ-ᬄ᬴-᭄᭐-᭙᭫-᭳ᮀ-ᮂᮡ-ᮭ᮰-᮹᯦-᯳ᰤ-᰷᱀-᱉᱐-᱙᳐-᳔᳒-᳨᳭᳴᳷-᳹᷀-᷿‌‍‿⁀⁔⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯・꘠-꘩꙯ꙴ-꙽ꚞꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧ꠬ꢀꢁꢴ-ꣅ꣐-꣙꣠-꣱ꣿ-꤉ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀꧐-꧙ꧥ꧰-꧹ꨩ-ꨶꩃꩌꩍ꩐-꩙ꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭꯰-꯹ﬞ︀-️︠-︯︳︴﹍-﹏０-９＿･",hH="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙՠ-ֈא-תׯ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࡠ-ࡪࡰ-ࢇࢉ-ࢎࢠ-ࣉऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱৼਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౝౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೝೞೠೡೱೲഄ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄຆ-ຊຌ-ຣລວ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜑᜟ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡸᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭌᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲊᲐ-ᲺᲽ-Ჿᳩ-ᳬᳮ-ᳳᳵᳶᳺᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖ゛-ゟァ-ヺー-ヿㄅ-ㄯㄱ-ㆎㆠ-ㆿㇰ-ㇿ㐀-䶿一-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꟍꟐꟑꟓꟕ-Ƛꟲ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꣾꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭩꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",FE={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},ME="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",zIe={5:ME,"5module":ME+" export import",6:ME+" const class extends export import super"},BIe=/^in(stanceof)?$/,UIe=new RegExp("["+hH+"]"),jIe=new RegExp("["+hH+LIe+"]");function iC(e,t){for(var n=65536,i=0;i<t.length;i+=2){if(n+=t[i],n>e)return!1;if(n+=t[i+1],n>=e)return!0}return!1}function Io(e,t){return e<65?e===36:e<91?!0:e<97?e===95:e<123?!0:e<=65535?e>=170&&UIe.test(String.fromCharCode(e)):t===!1?!1:iC(e,fH)}function Fh(e,t){return e<48?e===36:e<58?!0:e<65?!1:e<91?!0:e<97?e===95:e<123?!0:e<=65535?e>=170&&jIe.test(String.fromCharCode(e)):t===!1?!1:iC(e,fH)||iC(e,PIe)}var ct=function(t,n){n===void 0&&(n={}),this.label=t,this.keyword=n.keyword,this.beforeExpr=!!n.beforeExpr,this.startsExpr=!!n.startsExpr,this.isLoop=!!n.isLoop,this.isAssign=!!n.isAssign,this.prefix=!!n.prefix,this.postfix=!!n.postfix,this.binop=n.binop||null,this.updateContext=null};function Dr(e,t){return new ct(e,{beforeExpr:!0,binop:t})}var Pr={beforeExpr:!0},Ui={startsExpr:!0},KO={};function st(e,t){return t===void 0&&(t={}),t.keyword=e,KO[e]=new ct(e,t)}var T={num:new ct("num",Ui),regexp:new ct("regexp",Ui),string:new ct("string",Ui),name:new ct("name",Ui),privateId:new ct("privateId",Ui),eof:new ct("eof"),bracketL:new ct("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new ct("]"),braceL:new ct("{",{beforeExpr:!0,startsExpr:!0}),braceR:new ct("}"),parenL:new ct("(",{beforeExpr:!0,startsExpr:!0}),parenR:new ct(")"),comma:new ct(",",Pr),semi:new ct(";",Pr),colon:new ct(":",Pr),dot:new ct("."),question:new ct("?",Pr),questionDot:new ct("?."),arrow:new ct("=>",Pr),template:new ct("template"),invalidTemplate:new ct("invalidTemplate"),ellipsis:new ct("...",Pr),backQuote:new ct("`",Ui),dollarBraceL:new ct("${",{beforeExpr:!0,startsExpr:!0}),eq:new ct("=",{beforeExpr:!0,isAssign:!0}),assign:new ct("_=",{beforeExpr:!0,isAssign:!0}),incDec:new ct("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new ct("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:Dr("||",1),logicalAND:Dr("&&",2),bitwiseOR:Dr("|",3),bitwiseXOR:Dr("^",4),bitwiseAND:Dr("&",5),equality:Dr("==/!=/===/!==",6),relational:Dr("</>/<=/>=",7),bitShift:Dr("<</>>/>>>",8),plusMin:new ct("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:Dr("%",10),star:Dr("*",10),slash:Dr("/",10),starstar:new ct("**",{beforeExpr:!0}),coalesce:Dr("??",1),_break:st("break"),_case:st("case",Pr),_catch:st("catch"),_continue:st("continue"),_debugger:st("debugger"),_default:st("default",Pr),_do:st("do",{isLoop:!0,beforeExpr:!0}),_else:st("else",Pr),_finally:st("finally"),_for:st("for",{isLoop:!0}),_function:st("function",Ui),_if:st("if"),_return:st("return",Pr),_switch:st("switch"),_throw:st("throw",Pr),_try:st("try"),_var:st("var"),_const:st("const"),_while:st("while",{isLoop:!0}),_with:st("with"),_new:st("new",{beforeExpr:!0,startsExpr:!0}),_this:st("this",Ui),_super:st("super",Ui),_class:st("class",Ui),_extends:st("extends",Pr),_export:st("export"),_import:st("import",Ui),_null:st("null",Ui),_true:st("true",Ui),_false:st("false",Ui),_in:st("in",{beforeExpr:!0,binop:7}),_instanceof:st("instanceof",{beforeExpr:!0,binop:7}),_typeof:st("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:st("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:st("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},ss=/\r\n?|\n|\u2028|\u2029/,qIe=new RegExp(ss.source,"g");function cd(e){return e===10||e===13||e===8232||e===8233}function dH(e,t,n){n===void 0&&(n=e.length);for(var i=t;i<n;i++){var r=e.charCodeAt(i);if(cd(r))return i<n-1&&r===13&&e.charCodeAt(i+1)===10?i+2:i+1}return-1}var pH=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,zr=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,gH=Object.prototype,VIe=gH.hasOwnProperty,WIe=gH.toString,fd=Object.hasOwn||function(e,t){return VIe.call(e,t)},nL=Array.isArray||function(e){return WIe.call(e)==="[object Array]"},iL=Object.create(null);function Su(e){return iL[e]||(iL[e]=new RegExp("^(?:"+e.replace(/ /g,"|")+")$"))}function Do(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10)+55296,(e&1023)+56320))}var GIe=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,Mg=function(t,n){this.line=t,this.column=n};Mg.prototype.offset=function(t){return new Mg(this.line,this.column+t)};var Qb=function(t,n,i){this.start=n,this.end=i,t.sourceFile!==null&&(this.source=t.sourceFile)};function mH(e,t){for(var n=1,i=0;;){var r=dH(e,i,t);if(r<0)return new Mg(n,t-i);++n,i=r}}var rC={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},rL=!1;function HIe(e){var t={};for(var n in rC)t[n]=e&&fd(e,n)?e[n]:rC[n];if(t.ecmaVersion==="latest"?t.ecmaVersion=1e8:t.ecmaVersion==null?(!rL&&typeof console=="object"&&console.warn&&(rL=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),t.ecmaVersion=11):t.ecmaVersion>=2015&&(t.ecmaVersion-=2009),t.allowReserved==null&&(t.allowReserved=t.ecmaVersion<5),(!e||e.allowHashBang==null)&&(t.allowHashBang=t.ecmaVersion>=14),nL(t.onToken)){var i=t.onToken;t.onToken=function(r){return i.push(r)}}return nL(t.onComment)&&(t.onComment=YIe(t,t.onComment)),t}function YIe(e,t){return function(n,i,r,s,a,o){var u={type:n?"Block":"Line",value:i,start:r,end:s};e.locations&&(u.loc=new Qb(this,a,o)),e.ranges&&(u.range=[r,s]),t.push(u)}}var Ng=1,hd=2,JO=4,yH=8,vH=16,xH=32,QO=64,bH=128,R0=256,ZO=Ng|hd|R0;function eF(e,t){return hd|(e?JO:0)|(t?yH:0)}var Dv=0,tF=1,Yo=2,_H=3,wH=4,EH=5,Sn=function(t,n,i){this.options=t=HIe(t),this.sourceFile=t.sourceFile,this.keywords=Su(zIe[t.ecmaVersion>=6?6:t.sourceType==="module"?"5module":5]);var r="";t.allowReserved!==!0&&(r=FE[t.ecmaVersion>=6?6:t.ecmaVersion===5?5:3],t.sourceType==="module"&&(r+=" await")),this.reservedWords=Su(r);var s=(r?r+" ":"")+FE.strict;this.reservedWordsStrict=Su(s),this.reservedWordsStrictBind=Su(s+" "+FE.strictBind),this.input=String(n),this.containsEsc=!1,i?(this.pos=i,this.lineStart=this.input.lastIndexOf(`
`,i-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(ss).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=T.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=t.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&t.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(Ng),this.regexpState=null,this.privateNameStack=[]},ja={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};Sn.prototype.parse=function(){var t=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(t)};ja.inFunction.get=function(){return(this.currentVarScope().flags&hd)>0};ja.inGenerator.get=function(){return(this.currentVarScope().flags&yH)>0&&!this.currentVarScope().inClassFieldInit};ja.inAsync.get=function(){return(this.currentVarScope().flags&JO)>0&&!this.currentVarScope().inClassFieldInit};ja.canAwait.get=function(){for(var e=this.scopeStack.length-1;e>=0;e--){var t=this.scopeStack[e];if(t.inClassFieldInit||t.flags&R0)return!1;if(t.flags&hd)return(t.flags&JO)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction};ja.allowSuper.get=function(){var e=this.currentThisScope(),t=e.flags,n=e.inClassFieldInit;return(t&QO)>0||n||this.options.allowSuperOutsideMethod};ja.allowDirectSuper.get=function(){return(this.currentThisScope().flags&bH)>0};ja.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())};ja.allowNewDotTarget.get=function(){var e=this.currentThisScope(),t=e.flags,n=e.inClassFieldInit;return(t&(hd|R0))>0||n};ja.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&R0)>0};Sn.extend=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];for(var i=this,r=0;r<t.length;r++)i=t[r](i);return i};Sn.parse=function(t,n){return new this(n,t).parse()};Sn.parseExpressionAt=function(t,n,i){var r=new this(i,t,n);return r.nextToken(),r.parseExpression()};Sn.tokenizer=function(t,n){return new this(n,t)};Object.defineProperties(Sn.prototype,ja);var Ii=Sn.prototype,XIe=/^(?:'((?:\\[^]|[^'\\])*?)'|"((?:\\[^]|[^"\\])*?)")/;Ii.strictDirective=function(e){if(this.options.ecmaVersion<5)return!1;for(;;){zr.lastIndex=e,e+=zr.exec(this.input)[0].length;var t=XIe.exec(this.input.slice(e));if(!t)return!1;if((t[1]||t[2])==="use strict"){zr.lastIndex=e+t[0].length;var n=zr.exec(this.input),i=n.index+n[0].length,r=this.input.charAt(i);return r===";"||r==="}"||ss.test(n[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(r)||r==="!"&&this.input.charAt(i+1)==="=")}e+=t[0].length,zr.lastIndex=e,e+=zr.exec(this.input)[0].length,this.input[e]===";"&&e++}};Ii.eat=function(e){return this.type===e?(this.next(),!0):!1};Ii.isContextual=function(e){return this.type===T.name&&this.value===e&&!this.containsEsc};Ii.eatContextual=function(e){return this.isContextual(e)?(this.next(),!0):!1};Ii.expectContextual=function(e){this.eatContextual(e)||this.unexpected()};Ii.canInsertSemicolon=function(){return this.type===T.eof||this.type===T.braceR||ss.test(this.input.slice(this.lastTokEnd,this.start))};Ii.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0};Ii.semicolon=function(){!this.eat(T.semi)&&!this.insertSemicolon()&&this.unexpected()};Ii.afterTrailingComma=function(e,t){if(this.type===e)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),t||this.next(),!0};Ii.expect=function(e){this.eat(e)||this.unexpected()};Ii.unexpected=function(e){this.raise(e??this.start,"Unexpected token")};var Zb=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};Ii.checkPatternErrors=function(e,t){if(e){e.trailingComma>-1&&this.raiseRecoverable(e.trailingComma,"Comma is not permitted after the rest element");var n=t?e.parenthesizedAssign:e.parenthesizedBind;n>-1&&this.raiseRecoverable(n,t?"Assigning to rvalue":"Parenthesized pattern")}};Ii.checkExpressionErrors=function(e,t){if(!e)return!1;var n=e.shorthandAssign,i=e.doubleProto;if(!t)return n>=0||i>=0;n>=0&&this.raise(n,"Shorthand property assignments are valid only in destructuring patterns"),i>=0&&this.raiseRecoverable(i,"Redefinition of __proto__ property")};Ii.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")};Ii.isSimpleAssignTarget=function(e){return e.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(e.expression):e.type==="Identifier"||e.type==="MemberExpression"};var Ae=Sn.prototype;Ae.parseTopLevel=function(e){var t=Object.create(null);for(e.body||(e.body=[]);this.type!==T.eof;){var n=this.parseStatement(null,!0,t);e.body.push(n)}if(this.inModule)for(var i=0,r=Object.keys(this.undefinedExports);i<r.length;i+=1){var s=r[i];this.raiseRecoverable(this.undefinedExports[s].start,"Export '"+s+"' is not defined")}return this.adaptDirectivePrologue(e.body),this.next(),e.sourceType=this.options.sourceType,this.finishNode(e,"Program")};var nF={kind:"loop"},KIe={kind:"switch"};Ae.isLet=function(e){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;zr.lastIndex=this.pos;var t=zr.exec(this.input),n=this.pos+t[0].length,i=this.input.charCodeAt(n);if(i===91||i===92)return!0;if(e)return!1;if(i===123||i>55295&&i<56320)return!0;if(Io(i,!0)){for(var r=n+1;Fh(i=this.input.charCodeAt(r),!0);)++r;if(i===92||i>55295&&i<56320)return!0;var s=this.input.slice(n,r);if(!BIe.test(s))return!0}return!1};Ae.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;zr.lastIndex=this.pos;var e=zr.exec(this.input),t=this.pos+e[0].length,n;return!ss.test(this.input.slice(this.pos,t))&&this.input.slice(t,t+8)==="function"&&(t+8===this.input.length||!(Fh(n=this.input.charCodeAt(t+8))||n>55295&&n<56320))};Ae.parseStatement=function(e,t,n){var i=this.type,r=this.startNode(),s;switch(this.isLet(e)&&(i=T._var,s="let"),i){case T._break:case T._continue:return this.parseBreakContinueStatement(r,i.keyword);case T._debugger:return this.parseDebuggerStatement(r);case T._do:return this.parseDoStatement(r);case T._for:return this.parseForStatement(r);case T._function:return e&&(this.strict||e!=="if"&&e!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(r,!1,!e);case T._class:return e&&this.unexpected(),this.parseClass(r,!0);case T._if:return this.parseIfStatement(r);case T._return:return this.parseReturnStatement(r);case T._switch:return this.parseSwitchStatement(r);case T._throw:return this.parseThrowStatement(r);case T._try:return this.parseTryStatement(r);case T._const:case T._var:return s=s||this.value,e&&s!=="var"&&this.unexpected(),this.parseVarStatement(r,s);case T._while:return this.parseWhileStatement(r);case T._with:return this.parseWithStatement(r);case T.braceL:return this.parseBlock(!0,r);case T.semi:return this.parseEmptyStatement(r);case T._export:case T._import:if(this.options.ecmaVersion>10&&i===T._import){zr.lastIndex=this.pos;var a=zr.exec(this.input),o=this.pos+a[0].length,u=this.input.charCodeAt(o);if(u===40||u===46)return this.parseExpressionStatement(r,this.parseExpression())}return this.options.allowImportExportEverywhere||(t||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),i===T._import?this.parseImport(r):this.parseExport(r,n);default:if(this.isAsyncFunction())return e&&this.unexpected(),this.next(),this.parseFunctionStatement(r,!0,!e);var l=this.value,c=this.parseExpression();return i===T.name&&c.type==="Identifier"&&this.eat(T.colon)?this.parseLabeledStatement(r,l,c,e):this.parseExpressionStatement(r,c)}};Ae.parseBreakContinueStatement=function(e,t){var n=t==="break";this.next(),this.eat(T.semi)||this.insertSemicolon()?e.label=null:this.type!==T.name?this.unexpected():(e.label=this.parseIdent(),this.semicolon());for(var i=0;i<this.labels.length;++i){var r=this.labels[i];if((e.label==null||r.name===e.label.name)&&(r.kind!=null&&(n||r.kind==="loop")||e.label&&n))break}return i===this.labels.length&&this.raise(e.start,"Unsyntactic "+t),this.finishNode(e,n?"BreakStatement":"ContinueStatement")};Ae.parseDebuggerStatement=function(e){return this.next(),this.semicolon(),this.finishNode(e,"DebuggerStatement")};Ae.parseDoStatement=function(e){return this.next(),this.labels.push(nF),e.body=this.parseStatement("do"),this.labels.pop(),this.expect(T._while),e.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(T.semi):this.semicolon(),this.finishNode(e,"DoWhileStatement")};Ae.parseForStatement=function(e){this.next();var t=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(nF),this.enterScope(0),this.expect(T.parenL),this.type===T.semi)return t>-1&&this.unexpected(t),this.parseFor(e,null);var n=this.isLet();if(this.type===T._var||this.type===T._const||n){var i=this.startNode(),r=n?"let":this.value;return this.next(),this.parseVar(i,!0,r),this.finishNode(i,"VariableDeclaration"),(this.type===T._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&i.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===T._in?t>-1&&this.unexpected(t):e.await=t>-1),this.parseForIn(e,i)):(t>-1&&this.unexpected(t),this.parseFor(e,i))}var s=this.isContextual("let"),a=!1,o=this.containsEsc,u=new Zb,l=this.start,c=t>-1?this.parseExprSubscripts(u,"await"):this.parseExpression(!0,u);return this.type===T._in||(a=this.options.ecmaVersion>=6&&this.isContextual("of"))?(t>-1?(this.type===T._in&&this.unexpected(t),e.await=!0):a&&this.options.ecmaVersion>=8&&(c.start===l&&!o&&c.type==="Identifier"&&c.name==="async"?this.unexpected():this.options.ecmaVersion>=9&&(e.await=!1)),s&&a&&this.raise(c.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(c,!1,u),this.checkLValPattern(c),this.parseForIn(e,c)):(this.checkExpressionErrors(u,!0),t>-1&&this.unexpected(t),this.parseFor(e,c))};Ae.parseFunctionStatement=function(e,t,n){return this.next(),this.parseFunction(e,Kp|(n?0:sC),!1,t)};Ae.parseIfStatement=function(e){return this.next(),e.test=this.parseParenExpression(),e.consequent=this.parseStatement("if"),e.alternate=this.eat(T._else)?this.parseStatement("if"):null,this.finishNode(e,"IfStatement")};Ae.parseReturnStatement=function(e){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(T.semi)||this.insertSemicolon()?e.argument=null:(e.argument=this.parseExpression(),this.semicolon()),this.finishNode(e,"ReturnStatement")};Ae.parseSwitchStatement=function(e){this.next(),e.discriminant=this.parseParenExpression(),e.cases=[],this.expect(T.braceL),this.labels.push(KIe),this.enterScope(0);for(var t,n=!1;this.type!==T.braceR;)if(this.type===T._case||this.type===T._default){var i=this.type===T._case;t&&this.finishNode(t,"SwitchCase"),e.cases.push(t=this.startNode()),t.consequent=[],this.next(),i?t.test=this.parseExpression():(n&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),n=!0,t.test=null),this.expect(T.colon)}else t||this.unexpected(),t.consequent.push(this.parseStatement(null));return this.exitScope(),t&&this.finishNode(t,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(e,"SwitchStatement")};Ae.parseThrowStatement=function(e){return this.next(),ss.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),e.argument=this.parseExpression(),this.semicolon(),this.finishNode(e,"ThrowStatement")};var JIe=[];Ae.parseCatchClauseParam=function(){var e=this.parseBindingAtom(),t=e.type==="Identifier";return this.enterScope(t?xH:0),this.checkLValPattern(e,t?wH:Yo),this.expect(T.parenR),e};Ae.parseTryStatement=function(e){if(this.next(),e.block=this.parseBlock(),e.handler=null,this.type===T._catch){var t=this.startNode();this.next(),this.eat(T.parenL)?t.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),t.param=null,this.enterScope(0)),t.body=this.parseBlock(!1),this.exitScope(),e.handler=this.finishNode(t,"CatchClause")}return e.finalizer=this.eat(T._finally)?this.parseBlock():null,!e.handler&&!e.finalizer&&this.raise(e.start,"Missing catch or finally clause"),this.finishNode(e,"TryStatement")};Ae.parseVarStatement=function(e,t,n){return this.next(),this.parseVar(e,!1,t,n),this.semicolon(),this.finishNode(e,"VariableDeclaration")};Ae.parseWhileStatement=function(e){return this.next(),e.test=this.parseParenExpression(),this.labels.push(nF),e.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(e,"WhileStatement")};Ae.parseWithStatement=function(e){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),e.object=this.parseParenExpression(),e.body=this.parseStatement("with"),this.finishNode(e,"WithStatement")};Ae.parseEmptyStatement=function(e){return this.next(),this.finishNode(e,"EmptyStatement")};Ae.parseLabeledStatement=function(e,t,n,i){for(var r=0,s=this.labels;r<s.length;r+=1){var a=s[r];a.name===t&&this.raise(n.start,"Label '"+t+"' is already declared")}for(var o=this.type.isLoop?"loop":this.type===T._switch?"switch":null,u=this.labels.length-1;u>=0;u--){var l=this.labels[u];if(l.statementStart===e.start)l.statementStart=this.start,l.kind=o;else break}return this.labels.push({name:t,kind:o,statementStart:this.start}),e.body=this.parseStatement(i?i.indexOf("label")===-1?i+"label":i:"label"),this.labels.pop(),e.label=n,this.finishNode(e,"LabeledStatement")};Ae.parseExpressionStatement=function(e,t){return e.expression=t,this.semicolon(),this.finishNode(e,"ExpressionStatement")};Ae.parseBlock=function(e,t,n){for(e===void 0&&(e=!0),t===void 0&&(t=this.startNode()),t.body=[],this.expect(T.braceL),e&&this.enterScope(0);this.type!==T.braceR;){var i=this.parseStatement(null);t.body.push(i)}return n&&(this.strict=!1),this.next(),e&&this.exitScope(),this.finishNode(t,"BlockStatement")};Ae.parseFor=function(e,t){return e.init=t,this.expect(T.semi),e.test=this.type===T.semi?null:this.parseExpression(),this.expect(T.semi),e.update=this.type===T.parenR?null:this.parseExpression(),this.expect(T.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,"ForStatement")};Ae.parseForIn=function(e,t){var n=this.type===T._in;return this.next(),t.type==="VariableDeclaration"&&t.declarations[0].init!=null&&(!n||this.options.ecmaVersion<8||this.strict||t.kind!=="var"||t.declarations[0].id.type!=="Identifier")&&this.raise(t.start,(n?"for-in":"for-of")+" loop variable declaration may not have an initializer"),e.left=t,e.right=n?this.parseExpression():this.parseMaybeAssign(),this.expect(T.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,n?"ForInStatement":"ForOfStatement")};Ae.parseVar=function(e,t,n,i){for(e.declarations=[],e.kind=n;;){var r=this.startNode();if(this.parseVarId(r,n),this.eat(T.eq)?r.init=this.parseMaybeAssign(t):!i&&n==="const"&&!(this.type===T._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!i&&r.id.type!=="Identifier"&&!(t&&(this.type===T._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):r.init=null,e.declarations.push(this.finishNode(r,"VariableDeclarator")),!this.eat(T.comma))break}return e};Ae.parseVarId=function(e,t){e.id=this.parseBindingAtom(),this.checkLValPattern(e.id,t==="var"?tF:Yo,!1)};var Kp=1,sC=2,SH=4;Ae.parseFunction=function(e,t,n,i,r){this.initFunction(e),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!i)&&(this.type===T.star&&t&sC&&this.unexpected(),e.generator=this.eat(T.star)),this.options.ecmaVersion>=8&&(e.async=!!i),t&Kp&&(e.id=t&SH&&this.type!==T.name?null:this.parseIdent(),e.id&&!(t&sC)&&this.checkLValSimple(e.id,this.strict||e.generator||e.async?this.treatFunctionsAsVar?tF:Yo:_H));var s=this.yieldPos,a=this.awaitPos,o=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(eF(e.async,e.generator)),t&Kp||(e.id=this.type===T.name?this.parseIdent():null),this.parseFunctionParams(e),this.parseFunctionBody(e,n,!1,r),this.yieldPos=s,this.awaitPos=a,this.awaitIdentPos=o,this.finishNode(e,t&Kp?"FunctionDeclaration":"FunctionExpression")};Ae.parseFunctionParams=function(e){this.expect(T.parenL),e.params=this.parseBindingList(T.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()};Ae.parseClass=function(e,t){this.next();var n=this.strict;this.strict=!0,this.parseClassId(e,t),this.parseClassSuper(e);var i=this.enterClassBody(),r=this.startNode(),s=!1;for(r.body=[],this.expect(T.braceL);this.type!==T.braceR;){var a=this.parseClassElement(e.superClass!==null);a&&(r.body.push(a),a.type==="MethodDefinition"&&a.kind==="constructor"?(s&&this.raiseRecoverable(a.start,"Duplicate constructor in the same class"),s=!0):a.key&&a.key.type==="PrivateIdentifier"&&QIe(i,a)&&this.raiseRecoverable(a.key.start,"Identifier '#"+a.key.name+"' has already been declared"))}return this.strict=n,this.next(),e.body=this.finishNode(r,"ClassBody"),this.exitClassBody(),this.finishNode(e,t?"ClassDeclaration":"ClassExpression")};Ae.parseClassElement=function(e){if(this.eat(T.semi))return null;var t=this.options.ecmaVersion,n=this.startNode(),i="",r=!1,s=!1,a="method",o=!1;if(this.eatContextual("static")){if(t>=13&&this.eat(T.braceL))return this.parseClassStaticBlock(n),n;this.isClassElementNameStart()||this.type===T.star?o=!0:i="static"}if(n.static=o,!i&&t>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===T.star)&&!this.canInsertSemicolon()?s=!0:i="async"),!i&&(t>=9||!s)&&this.eat(T.star)&&(r=!0),!i&&!s&&!r){var u=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?a=u:i=u)}if(i?(n.computed=!1,n.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),n.key.name=i,this.finishNode(n.key,"Identifier")):this.parseClassElementName(n),t<13||this.type===T.parenL||a!=="method"||r||s){var l=!n.static&&Pv(n,"constructor"),c=l&&e;l&&a!=="method"&&this.raise(n.key.start,"Constructor can't have get/set modifier"),n.kind=l?"constructor":a,this.parseClassMethod(n,r,s,c)}else this.parseClassField(n);return n};Ae.isClassElementNameStart=function(){return this.type===T.name||this.type===T.privateId||this.type===T.num||this.type===T.string||this.type===T.bracketL||this.type.keyword};Ae.parseClassElementName=function(e){this.type===T.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),e.computed=!1,e.key=this.parsePrivateIdent()):this.parsePropertyName(e)};Ae.parseClassMethod=function(e,t,n,i){var r=e.key;e.kind==="constructor"?(t&&this.raise(r.start,"Constructor can't be a generator"),n&&this.raise(r.start,"Constructor can't be an async method")):e.static&&Pv(e,"prototype")&&this.raise(r.start,"Classes may not have a static property named prototype");var s=e.value=this.parseMethod(t,n,i);return e.kind==="get"&&s.params.length!==0&&this.raiseRecoverable(s.start,"getter should have no params"),e.kind==="set"&&s.params.length!==1&&this.raiseRecoverable(s.start,"setter should have exactly one param"),e.kind==="set"&&s.params[0].type==="RestElement"&&this.raiseRecoverable(s.params[0].start,"Setter cannot use rest params"),this.finishNode(e,"MethodDefinition")};Ae.parseClassField=function(e){if(Pv(e,"constructor")?this.raise(e.key.start,"Classes can't have a field named 'constructor'"):e.static&&Pv(e,"prototype")&&this.raise(e.key.start,"Classes can't have a static field named 'prototype'"),this.eat(T.eq)){var t=this.currentThisScope(),n=t.inClassFieldInit;t.inClassFieldInit=!0,e.value=this.parseMaybeAssign(),t.inClassFieldInit=n}else e.value=null;return this.semicolon(),this.finishNode(e,"PropertyDefinition")};Ae.parseClassStaticBlock=function(e){e.body=[];var t=this.labels;for(this.labels=[],this.enterScope(R0|QO);this.type!==T.braceR;){var n=this.parseStatement(null);e.body.push(n)}return this.next(),this.exitScope(),this.labels=t,this.finishNode(e,"StaticBlock")};Ae.parseClassId=function(e,t){this.type===T.name?(e.id=this.parseIdent(),t&&this.checkLValSimple(e.id,Yo,!1)):(t===!0&&this.unexpected(),e.id=null)};Ae.parseClassSuper=function(e){e.superClass=this.eat(T._extends)?this.parseExprSubscripts(null,!1):null};Ae.enterClassBody=function(){var e={declared:Object.create(null),used:[]};return this.privateNameStack.push(e),e.declared};Ae.exitClassBody=function(){var e=this.privateNameStack.pop(),t=e.declared,n=e.used;if(this.options.checkPrivateFields)for(var i=this.privateNameStack.length,r=i===0?null:this.privateNameStack[i-1],s=0;s<n.length;++s){var a=n[s];fd(t,a.name)||(r?r.used.push(a):this.raiseRecoverable(a.start,"Private field '#"+a.name+"' must be declared in an enclosing class"))}};function QIe(e,t){var n=t.key.name,i=e[n],r="true";return t.type==="MethodDefinition"&&(t.kind==="get"||t.kind==="set")&&(r=(t.static?"s":"i")+t.kind),i==="iget"&&r==="iset"||i==="iset"&&r==="iget"||i==="sget"&&r==="sset"||i==="sset"&&r==="sget"?(e[n]="true",!1):i?!0:(e[n]=r,!1)}function Pv(e,t){var n=e.computed,i=e.key;return!n&&(i.type==="Identifier"&&i.name===t||i.type==="Literal"&&i.value===t)}Ae.parseExportAllDeclaration=function(e,t){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(e.exported=this.parseModuleExportName(),this.checkExport(t,e.exported,this.lastTokStart)):e.exported=null),this.expectContextual("from"),this.type!==T.string&&this.unexpected(),e.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(e.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(e,"ExportAllDeclaration")};Ae.parseExport=function(e,t){if(this.next(),this.eat(T.star))return this.parseExportAllDeclaration(e,t);if(this.eat(T._default))return this.checkExport(t,"default",this.lastTokStart),e.declaration=this.parseExportDefaultDeclaration(),this.finishNode(e,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())e.declaration=this.parseExportDeclaration(e),e.declaration.type==="VariableDeclaration"?this.checkVariableExport(t,e.declaration.declarations):this.checkExport(t,e.declaration.id,e.declaration.id.start),e.specifiers=[],e.source=null;else{if(e.declaration=null,e.specifiers=this.parseExportSpecifiers(t),this.eatContextual("from"))this.type!==T.string&&this.unexpected(),e.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(e.attributes=this.parseWithClause());else{for(var n=0,i=e.specifiers;n<i.length;n+=1){var r=i[n];this.checkUnreserved(r.local),this.checkLocalExport(r.local),r.local.type==="Literal"&&this.raise(r.local.start,"A string literal cannot be used as an exported binding without `from`.")}e.source=null}this.semicolon()}return this.finishNode(e,"ExportNamedDeclaration")};Ae.parseExportDeclaration=function(e){return this.parseStatement(null)};Ae.parseExportDefaultDeclaration=function(){var e;if(this.type===T._function||(e=this.isAsyncFunction())){var t=this.startNode();return this.next(),e&&this.next(),this.parseFunction(t,Kp|SH,!1,e)}else if(this.type===T._class){var n=this.startNode();return this.parseClass(n,"nullableID")}else{var i=this.parseMaybeAssign();return this.semicolon(),i}};Ae.checkExport=function(e,t,n){e&&(typeof t!="string"&&(t=t.type==="Identifier"?t.name:t.value),fd(e,t)&&this.raiseRecoverable(n,"Duplicate export '"+t+"'"),e[t]=!0)};Ae.checkPatternExport=function(e,t){var n=t.type;if(n==="Identifier")this.checkExport(e,t,t.start);else if(n==="ObjectPattern")for(var i=0,r=t.properties;i<r.length;i+=1){var s=r[i];this.checkPatternExport(e,s)}else if(n==="ArrayPattern")for(var a=0,o=t.elements;a<o.length;a+=1){var u=o[a];u&&this.checkPatternExport(e,u)}else n==="Property"?this.checkPatternExport(e,t.value):n==="AssignmentPattern"?this.checkPatternExport(e,t.left):n==="RestElement"&&this.checkPatternExport(e,t.argument)};Ae.checkVariableExport=function(e,t){if(e)for(var n=0,i=t;n<i.length;n+=1){var r=i[n];this.checkPatternExport(e,r.id)}};Ae.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()};Ae.parseExportSpecifier=function(e){var t=this.startNode();return t.local=this.parseModuleExportName(),t.exported=this.eatContextual("as")?this.parseModuleExportName():t.local,this.checkExport(e,t.exported,t.exported.start),this.finishNode(t,"ExportSpecifier")};Ae.parseExportSpecifiers=function(e){var t=[],n=!0;for(this.expect(T.braceL);!this.eat(T.braceR);){if(n)n=!1;else if(this.expect(T.comma),this.afterTrailingComma(T.braceR))break;t.push(this.parseExportSpecifier(e))}return t};Ae.parseImport=function(e){return this.next(),this.type===T.string?(e.specifiers=JIe,e.source=this.parseExprAtom()):(e.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),e.source=this.type===T.string?this.parseExprAtom():this.unexpected()),this.options.ecmaVersion>=16&&(e.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(e,"ImportDeclaration")};Ae.parseImportSpecifier=function(){var e=this.startNode();return e.imported=this.parseModuleExportName(),this.eatContextual("as")?e.local=this.parseIdent():(this.checkUnreserved(e.imported),e.local=e.imported),this.checkLValSimple(e.local,Yo),this.finishNode(e,"ImportSpecifier")};Ae.parseImportDefaultSpecifier=function(){var e=this.startNode();return e.local=this.parseIdent(),this.checkLValSimple(e.local,Yo),this.finishNode(e,"ImportDefaultSpecifier")};Ae.parseImportNamespaceSpecifier=function(){var e=this.startNode();return this.next(),this.expectContextual("as"),e.local=this.parseIdent(),this.checkLValSimple(e.local,Yo),this.finishNode(e,"ImportNamespaceSpecifier")};Ae.parseImportSpecifiers=function(){var e=[],t=!0;if(this.type===T.name&&(e.push(this.parseImportDefaultSpecifier()),!this.eat(T.comma)))return e;if(this.type===T.star)return e.push(this.parseImportNamespaceSpecifier()),e;for(this.expect(T.braceL);!this.eat(T.braceR);){if(t)t=!1;else if(this.expect(T.comma),this.afterTrailingComma(T.braceR))break;e.push(this.parseImportSpecifier())}return e};Ae.parseWithClause=function(){var e=[];if(!this.eat(T._with))return e;this.expect(T.braceL);for(var t={},n=!0;!this.eat(T.braceR);){if(n)n=!1;else if(this.expect(T.comma),this.afterTrailingComma(T.braceR))break;var i=this.parseImportAttribute(),r=i.key.type==="Identifier"?i.key.name:i.key.value;fd(t,r)&&this.raiseRecoverable(i.key.start,"Duplicate attribute key '"+r+"'"),t[r]=!0,e.push(i)}return e};Ae.parseImportAttribute=function(){var e=this.startNode();return e.key=this.type===T.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never"),this.expect(T.colon),this.type!==T.string&&this.unexpected(),e.value=this.parseExprAtom(),this.finishNode(e,"ImportAttribute")};Ae.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===T.string){var e=this.parseLiteral(this.value);return GIe.test(e.value)&&this.raise(e.start,"An export name cannot include a lone surrogate."),e}return this.parseIdent(!0)};Ae.adaptDirectivePrologue=function(e){for(var t=0;t<e.length&&this.isDirectiveCandidate(e[t]);++t)e[t].directive=e[t].expression.raw.slice(1,-1)};Ae.isDirectiveCandidate=function(e){return this.options.ecmaVersion>=5&&e.type==="ExpressionStatement"&&e.expression.type==="Literal"&&typeof e.expression.value=="string"&&(this.input[e.start]==='"'||this.input[e.start]==="'")};var as=Sn.prototype;as.toAssignable=function(e,t,n){if(this.options.ecmaVersion>=6&&e)switch(e.type){case"Identifier":this.inAsync&&e.name==="await"&&this.raise(e.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":e.type="ObjectPattern",n&&this.checkPatternErrors(n,!0);for(var i=0,r=e.properties;i<r.length;i+=1){var s=r[i];this.toAssignable(s,t),s.type==="RestElement"&&(s.argument.type==="ArrayPattern"||s.argument.type==="ObjectPattern")&&this.raise(s.argument.start,"Unexpected token")}break;case"Property":e.kind!=="init"&&this.raise(e.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(e.value,t);break;case"ArrayExpression":e.type="ArrayPattern",n&&this.checkPatternErrors(n,!0),this.toAssignableList(e.elements,t);break;case"SpreadElement":e.type="RestElement",this.toAssignable(e.argument,t),e.argument.type==="AssignmentPattern"&&this.raise(e.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":e.operator!=="="&&this.raise(e.left.end,"Only '=' operator can be used for specifying default value."),e.type="AssignmentPattern",delete e.operator,this.toAssignable(e.left,t);break;case"ParenthesizedExpression":this.toAssignable(e.expression,t,n);break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!t)break;default:this.raise(e.start,"Assigning to rvalue")}else n&&this.checkPatternErrors(n,!0);return e};as.toAssignableList=function(e,t){for(var n=e.length,i=0;i<n;i++){var r=e[i];r&&this.toAssignable(r,t)}if(n){var s=e[n-1];this.options.ecmaVersion===6&&t&&s&&s.type==="RestElement"&&s.argument.type!=="Identifier"&&this.unexpected(s.argument.start)}return e};as.parseSpread=function(e){var t=this.startNode();return this.next(),t.argument=this.parseMaybeAssign(!1,e),this.finishNode(t,"SpreadElement")};as.parseRestBinding=function(){var e=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==T.name&&this.unexpected(),e.argument=this.parseBindingAtom(),this.finishNode(e,"RestElement")};as.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case T.bracketL:var e=this.startNode();return this.next(),e.elements=this.parseBindingList(T.bracketR,!0,!0),this.finishNode(e,"ArrayPattern");case T.braceL:return this.parseObj(!0)}return this.parseIdent()};as.parseBindingList=function(e,t,n,i){for(var r=[],s=!0;!this.eat(e);)if(s?s=!1:this.expect(T.comma),t&&this.type===T.comma)r.push(null);else{if(n&&this.afterTrailingComma(e))break;if(this.type===T.ellipsis){var a=this.parseRestBinding();this.parseBindingListItem(a),r.push(a),this.type===T.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(e);break}else r.push(this.parseAssignableListItem(i))}return r};as.parseAssignableListItem=function(e){var t=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(t),t};as.parseBindingListItem=function(e){return e};as.parseMaybeDefault=function(e,t,n){if(n=n||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(T.eq))return n;var i=this.startNodeAt(e,t);return i.left=n,i.right=this.parseMaybeAssign(),this.finishNode(i,"AssignmentPattern")};as.checkLValSimple=function(e,t,n){t===void 0&&(t=Dv);var i=t!==Dv;switch(e.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(e.name)&&this.raiseRecoverable(e.start,(i?"Binding ":"Assigning to ")+e.name+" in strict mode"),i&&(t===Yo&&e.name==="let"&&this.raiseRecoverable(e.start,"let is disallowed as a lexically bound name"),n&&(fd(n,e.name)&&this.raiseRecoverable(e.start,"Argument name clash"),n[e.name]=!0),t!==EH&&this.declareName(e.name,t,e.start));break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":i&&this.raiseRecoverable(e.start,"Binding member expression");break;case"ParenthesizedExpression":return i&&this.raiseRecoverable(e.start,"Binding parenthesized expression"),this.checkLValSimple(e.expression,t,n);default:this.raise(e.start,(i?"Binding":"Assigning to")+" rvalue")}};as.checkLValPattern=function(e,t,n){switch(t===void 0&&(t=Dv),e.type){case"ObjectPattern":for(var i=0,r=e.properties;i<r.length;i+=1){var s=r[i];this.checkLValInnerPattern(s,t,n)}break;case"ArrayPattern":for(var a=0,o=e.elements;a<o.length;a+=1){var u=o[a];u&&this.checkLValInnerPattern(u,t,n)}break;default:this.checkLValSimple(e,t,n)}};as.checkLValInnerPattern=function(e,t,n){switch(t===void 0&&(t=Dv),e.type){case"Property":this.checkLValInnerPattern(e.value,t,n);break;case"AssignmentPattern":this.checkLValPattern(e.left,t,n);break;case"RestElement":this.checkLValPattern(e.argument,t,n);break;default:this.checkLValPattern(e,t,n)}};var gs=function(t,n,i,r,s){this.token=t,this.isExpr=!!n,this.preserveSpace=!!i,this.override=r,this.generator=!!s},zt={b_stat:new gs("{",!1),b_expr:new gs("{",!0),b_tmpl:new gs("${",!1),p_stat:new gs("(",!1),p_expr:new gs("(",!0),q_tmpl:new gs("`",!0,!0,function(e){return e.tryReadTemplateToken()}),f_stat:new gs("function",!1),f_expr:new gs("function",!0),f_expr_gen:new gs("function",!0,!1,null,!0),f_gen:new gs("function",!1,!1,null,!0)},dd=Sn.prototype;dd.initialContext=function(){return[zt.b_stat]};dd.curContext=function(){return this.context[this.context.length-1]};dd.braceIsBlock=function(e){var t=this.curContext();return t===zt.f_expr||t===zt.f_stat?!0:e===T.colon&&(t===zt.b_stat||t===zt.b_expr)?!t.isExpr:e===T._return||e===T.name&&this.exprAllowed?ss.test(this.input.slice(this.lastTokEnd,this.start)):e===T._else||e===T.semi||e===T.eof||e===T.parenR||e===T.arrow?!0:e===T.braceL?t===zt.b_stat:e===T._var||e===T._const||e===T.name?!1:!this.exprAllowed};dd.inGeneratorContext=function(){for(var e=this.context.length-1;e>=1;e--){var t=this.context[e];if(t.token==="function")return t.generator}return!1};dd.updateContext=function(e){var t,n=this.type;n.keyword&&e===T.dot?this.exprAllowed=!1:(t=n.updateContext)?t.call(this,e):this.exprAllowed=n.beforeExpr};dd.overrideContext=function(e){this.curContext()!==e&&(this.context[this.context.length-1]=e)};T.parenR.updateContext=T.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var e=this.context.pop();e===zt.b_stat&&this.curContext().token==="function"&&(e=this.context.pop()),this.exprAllowed=!e.isExpr};T.braceL.updateContext=function(e){this.context.push(this.braceIsBlock(e)?zt.b_stat:zt.b_expr),this.exprAllowed=!0};T.dollarBraceL.updateContext=function(){this.context.push(zt.b_tmpl),this.exprAllowed=!0};T.parenL.updateContext=function(e){var t=e===T._if||e===T._for||e===T._with||e===T._while;this.context.push(t?zt.p_stat:zt.p_expr),this.exprAllowed=!0};T.incDec.updateContext=function(){};T._function.updateContext=T._class.updateContext=function(e){e.beforeExpr&&e!==T._else&&!(e===T.semi&&this.curContext()!==zt.p_stat)&&!(e===T._return&&ss.test(this.input.slice(this.lastTokEnd,this.start)))&&!((e===T.colon||e===T.braceL)&&this.curContext()===zt.b_stat)?this.context.push(zt.f_expr):this.context.push(zt.f_stat),this.exprAllowed=!1};T.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0};T.backQuote.updateContext=function(){this.curContext()===zt.q_tmpl?this.context.pop():this.context.push(zt.q_tmpl),this.exprAllowed=!1};T.star.updateContext=function(e){if(e===T._function){var t=this.context.length-1;this.context[t]===zt.f_expr?this.context[t]=zt.f_expr_gen:this.context[t]=zt.f_gen}this.exprAllowed=!0};T.name.updateContext=function(e){var t=!1;this.options.ecmaVersion>=6&&e!==T.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(t=!0),this.exprAllowed=t};var Pe=Sn.prototype;Pe.checkPropClash=function(e,t,n){if(!(this.options.ecmaVersion>=9&&e.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(e.computed||e.method||e.shorthand))){var i=e.key,r;switch(i.type){case"Identifier":r=i.name;break;case"Literal":r=String(i.value);break;default:return}var s=e.kind;if(this.options.ecmaVersion>=6){r==="__proto__"&&s==="init"&&(t.proto&&(n?n.doubleProto<0&&(n.doubleProto=i.start):this.raiseRecoverable(i.start,"Redefinition of __proto__ property")),t.proto=!0);return}r="$"+r;var a=t[r];if(a){var o;s==="init"?o=this.strict&&a.init||a.get||a.set:o=a.init||a[s],o&&this.raiseRecoverable(i.start,"Redefinition of property")}else a=t[r]={init:!1,get:!1,set:!1};a[s]=!0}};Pe.parseExpression=function(e,t){var n=this.start,i=this.startLoc,r=this.parseMaybeAssign(e,t);if(this.type===T.comma){var s=this.startNodeAt(n,i);for(s.expressions=[r];this.eat(T.comma);)s.expressions.push(this.parseMaybeAssign(e,t));return this.finishNode(s,"SequenceExpression")}return r};Pe.parseMaybeAssign=function(e,t,n){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(e);this.exprAllowed=!1}var i=!1,r=-1,s=-1,a=-1;t?(r=t.parenthesizedAssign,s=t.trailingComma,a=t.doubleProto,t.parenthesizedAssign=t.trailingComma=-1):(t=new Zb,i=!0);var o=this.start,u=this.startLoc;(this.type===T.parenL||this.type===T.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=e==="await");var l=this.parseMaybeConditional(e,t);if(n&&(l=n.call(this,l,o,u)),this.type.isAssign){var c=this.startNodeAt(o,u);return c.operator=this.value,this.type===T.eq&&(l=this.toAssignable(l,!1,t)),i||(t.parenthesizedAssign=t.trailingComma=t.doubleProto=-1),t.shorthandAssign>=l.start&&(t.shorthandAssign=-1),this.type===T.eq?this.checkLValPattern(l):this.checkLValSimple(l),c.left=l,this.next(),c.right=this.parseMaybeAssign(e),a>-1&&(t.doubleProto=a),this.finishNode(c,"AssignmentExpression")}else i&&this.checkExpressionErrors(t,!0);return r>-1&&(t.parenthesizedAssign=r),s>-1&&(t.trailingComma=s),l};Pe.parseMaybeConditional=function(e,t){var n=this.start,i=this.startLoc,r=this.parseExprOps(e,t);if(this.checkExpressionErrors(t))return r;if(this.eat(T.question)){var s=this.startNodeAt(n,i);return s.test=r,s.consequent=this.parseMaybeAssign(),this.expect(T.colon),s.alternate=this.parseMaybeAssign(e),this.finishNode(s,"ConditionalExpression")}return r};Pe.parseExprOps=function(e,t){var n=this.start,i=this.startLoc,r=this.parseMaybeUnary(t,!1,!1,e);return this.checkExpressionErrors(t)||r.start===n&&r.type==="ArrowFunctionExpression"?r:this.parseExprOp(r,n,i,-1,e)};Pe.parseExprOp=function(e,t,n,i,r){var s=this.type.binop;if(s!=null&&(!r||this.type!==T._in)&&s>i){var a=this.type===T.logicalOR||this.type===T.logicalAND,o=this.type===T.coalesce;o&&(s=T.logicalAND.binop);var u=this.value;this.next();var l=this.start,c=this.startLoc,f=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,r),l,c,s,r),d=this.buildBinary(t,n,e,f,u,a||o);return(a&&this.type===T.coalesce||o&&(this.type===T.logicalOR||this.type===T.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(d,t,n,i,r)}return e};Pe.buildBinary=function(e,t,n,i,r,s){i.type==="PrivateIdentifier"&&this.raise(i.start,"Private identifier can only be left side of binary expression");var a=this.startNodeAt(e,t);return a.left=n,a.operator=r,a.right=i,this.finishNode(a,s?"LogicalExpression":"BinaryExpression")};Pe.parseMaybeUnary=function(e,t,n,i){var r=this.start,s=this.startLoc,a;if(this.isContextual("await")&&this.canAwait)a=this.parseAwait(i),t=!0;else if(this.type.prefix){var o=this.startNode(),u=this.type===T.incDec;o.operator=this.value,o.prefix=!0,this.next(),o.argument=this.parseMaybeUnary(null,!0,u,i),this.checkExpressionErrors(e,!0),u?this.checkLValSimple(o.argument):this.strict&&o.operator==="delete"&&AH(o.argument)?this.raiseRecoverable(o.start,"Deleting local variable in strict mode"):o.operator==="delete"&&aC(o.argument)?this.raiseRecoverable(o.start,"Private fields can not be deleted"):t=!0,a=this.finishNode(o,u?"UpdateExpression":"UnaryExpression")}else if(!t&&this.type===T.privateId)(i||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),a=this.parsePrivateIdent(),this.type!==T._in&&this.unexpected();else{if(a=this.parseExprSubscripts(e,i),this.checkExpressionErrors(e))return a;for(;this.type.postfix&&!this.canInsertSemicolon();){var l=this.startNodeAt(r,s);l.operator=this.value,l.prefix=!1,l.argument=a,this.checkLValSimple(a),this.next(),a=this.finishNode(l,"UpdateExpression")}}if(!n&&this.eat(T.starstar))if(t)this.unexpected(this.lastTokStart);else return this.buildBinary(r,s,a,this.parseMaybeUnary(null,!1,!1,i),"**",!1);else return a};function AH(e){return e.type==="Identifier"||e.type==="ParenthesizedExpression"&&AH(e.expression)}function aC(e){return e.type==="MemberExpression"&&e.property.type==="PrivateIdentifier"||e.type==="ChainExpression"&&aC(e.expression)||e.type==="ParenthesizedExpression"&&aC(e.expression)}Pe.parseExprSubscripts=function(e,t){var n=this.start,i=this.startLoc,r=this.parseExprAtom(e,t);if(r.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return r;var s=this.parseSubscripts(r,n,i,!1,t);return e&&s.type==="MemberExpression"&&(e.parenthesizedAssign>=s.start&&(e.parenthesizedAssign=-1),e.parenthesizedBind>=s.start&&(e.parenthesizedBind=-1),e.trailingComma>=s.start&&(e.trailingComma=-1)),s};Pe.parseSubscripts=function(e,t,n,i,r){for(var s=this.options.ecmaVersion>=8&&e.type==="Identifier"&&e.name==="async"&&this.lastTokEnd===e.end&&!this.canInsertSemicolon()&&e.end-e.start===5&&this.potentialArrowAt===e.start,a=!1;;){var o=this.parseSubscript(e,t,n,i,s,a,r);if(o.optional&&(a=!0),o===e||o.type==="ArrowFunctionExpression"){if(a){var u=this.startNodeAt(t,n);u.expression=o,o=this.finishNode(u,"ChainExpression")}return o}e=o}};Pe.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(T.arrow)};Pe.parseSubscriptAsyncArrow=function(e,t,n,i){return this.parseArrowExpression(this.startNodeAt(e,t),n,!0,i)};Pe.parseSubscript=function(e,t,n,i,r,s,a){var o=this.options.ecmaVersion>=11,u=o&&this.eat(T.questionDot);i&&u&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var l=this.eat(T.bracketL);if(l||u&&this.type!==T.parenL&&this.type!==T.backQuote||this.eat(T.dot)){var c=this.startNodeAt(t,n);c.object=e,l?(c.property=this.parseExpression(),this.expect(T.bracketR)):this.type===T.privateId&&e.type!=="Super"?c.property=this.parsePrivateIdent():c.property=this.parseIdent(this.options.allowReserved!=="never"),c.computed=!!l,o&&(c.optional=u),e=this.finishNode(c,"MemberExpression")}else if(!i&&this.eat(T.parenL)){var f=new Zb,d=this.yieldPos,p=this.awaitPos,m=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var y=this.parseExprList(T.parenR,this.options.ecmaVersion>=8,!1,f);if(r&&!u&&this.shouldParseAsyncArrow())return this.checkPatternErrors(f,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=d,this.awaitPos=p,this.awaitIdentPos=m,this.parseSubscriptAsyncArrow(t,n,y,a);this.checkExpressionErrors(f,!0),this.yieldPos=d||this.yieldPos,this.awaitPos=p||this.awaitPos,this.awaitIdentPos=m||this.awaitIdentPos;var v=this.startNodeAt(t,n);v.callee=e,v.arguments=y,o&&(v.optional=u),e=this.finishNode(v,"CallExpression")}else if(this.type===T.backQuote){(u||s)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var b=this.startNodeAt(t,n);b.tag=e,b.quasi=this.parseTemplate({isTagged:!0}),e=this.finishNode(b,"TaggedTemplateExpression")}return e};Pe.parseExprAtom=function(e,t,n){this.type===T.slash&&this.readRegexp();var i,r=this.potentialArrowAt===this.start;switch(this.type){case T._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),i=this.startNode(),this.next(),this.type===T.parenL&&!this.allowDirectSuper&&this.raise(i.start,"super() call outside constructor of a subclass"),this.type!==T.dot&&this.type!==T.bracketL&&this.type!==T.parenL&&this.unexpected(),this.finishNode(i,"Super");case T._this:return i=this.startNode(),this.next(),this.finishNode(i,"ThisExpression");case T.name:var s=this.start,a=this.startLoc,o=this.containsEsc,u=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!o&&u.name==="async"&&!this.canInsertSemicolon()&&this.eat(T._function))return this.overrideContext(zt.f_expr),this.parseFunction(this.startNodeAt(s,a),0,!1,!0,t);if(r&&!this.canInsertSemicolon()){if(this.eat(T.arrow))return this.parseArrowExpression(this.startNodeAt(s,a),[u],!1,t);if(this.options.ecmaVersion>=8&&u.name==="async"&&this.type===T.name&&!o&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return u=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(T.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(s,a),[u],!0,t)}return u;case T.regexp:var l=this.value;return i=this.parseLiteral(l.value),i.regex={pattern:l.pattern,flags:l.flags},i;case T.num:case T.string:return this.parseLiteral(this.value);case T._null:case T._true:case T._false:return i=this.startNode(),i.value=this.type===T._null?null:this.type===T._true,i.raw=this.type.keyword,this.next(),this.finishNode(i,"Literal");case T.parenL:var c=this.start,f=this.parseParenAndDistinguishExpression(r,t);return e&&(e.parenthesizedAssign<0&&!this.isSimpleAssignTarget(f)&&(e.parenthesizedAssign=c),e.parenthesizedBind<0&&(e.parenthesizedBind=c)),f;case T.bracketL:return i=this.startNode(),this.next(),i.elements=this.parseExprList(T.bracketR,!0,!0,e),this.finishNode(i,"ArrayExpression");case T.braceL:return this.overrideContext(zt.b_expr),this.parseObj(!1,e);case T._function:return i=this.startNode(),this.next(),this.parseFunction(i,0);case T._class:return this.parseClass(this.startNode(),!1);case T._new:return this.parseNew();case T.backQuote:return this.parseTemplate();case T._import:return this.options.ecmaVersion>=11?this.parseExprImport(n):this.unexpected();default:return this.parseExprAtomDefault()}};Pe.parseExprAtomDefault=function(){this.unexpected()};Pe.parseExprImport=function(e){var t=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===T.parenL&&!e)return this.parseDynamicImport(t);if(this.type===T.dot){var n=this.startNodeAt(t.start,t.loc&&t.loc.start);return n.name="import",t.meta=this.finishNode(n,"Identifier"),this.parseImportMeta(t)}else this.unexpected()};Pe.parseDynamicImport=function(e){if(this.next(),e.source=this.parseMaybeAssign(),this.options.ecmaVersion>=16)this.eat(T.parenR)?e.options=null:(this.expect(T.comma),this.afterTrailingComma(T.parenR)?e.options=null:(e.options=this.parseMaybeAssign(),this.eat(T.parenR)||(this.expect(T.comma),this.afterTrailingComma(T.parenR)||this.unexpected())));else if(!this.eat(T.parenR)){var t=this.start;this.eat(T.comma)&&this.eat(T.parenR)?this.raiseRecoverable(t,"Trailing comma is not allowed in import()"):this.unexpected(t)}return this.finishNode(e,"ImportExpression")};Pe.parseImportMeta=function(e){this.next();var t=this.containsEsc;return e.property=this.parseIdent(!0),e.property.name!=="meta"&&this.raiseRecoverable(e.property.start,"The only valid meta property for import is 'import.meta'"),t&&this.raiseRecoverable(e.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(e.start,"Cannot use 'import.meta' outside a module"),this.finishNode(e,"MetaProperty")};Pe.parseLiteral=function(e){var t=this.startNode();return t.value=e,t.raw=this.input.slice(this.start,this.end),t.raw.charCodeAt(t.raw.length-1)===110&&(t.bigint=t.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(t,"Literal")};Pe.parseParenExpression=function(){this.expect(T.parenL);var e=this.parseExpression();return this.expect(T.parenR),e};Pe.shouldParseArrow=function(e){return!this.canInsertSemicolon()};Pe.parseParenAndDistinguishExpression=function(e,t){var n=this.start,i=this.startLoc,r,s=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var a=this.start,o=this.startLoc,u=[],l=!0,c=!1,f=new Zb,d=this.yieldPos,p=this.awaitPos,m;for(this.yieldPos=0,this.awaitPos=0;this.type!==T.parenR;)if(l?l=!1:this.expect(T.comma),s&&this.afterTrailingComma(T.parenR,!0)){c=!0;break}else if(this.type===T.ellipsis){m=this.start,u.push(this.parseParenItem(this.parseRestBinding())),this.type===T.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else u.push(this.parseMaybeAssign(!1,f,this.parseParenItem));var y=this.lastTokEnd,v=this.lastTokEndLoc;if(this.expect(T.parenR),e&&this.shouldParseArrow(u)&&this.eat(T.arrow))return this.checkPatternErrors(f,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=d,this.awaitPos=p,this.parseParenArrowList(n,i,u,t);(!u.length||c)&&this.unexpected(this.lastTokStart),m&&this.unexpected(m),this.checkExpressionErrors(f,!0),this.yieldPos=d||this.yieldPos,this.awaitPos=p||this.awaitPos,u.length>1?(r=this.startNodeAt(a,o),r.expressions=u,this.finishNodeAt(r,"SequenceExpression",y,v)):r=u[0]}else r=this.parseParenExpression();if(this.options.preserveParens){var b=this.startNodeAt(n,i);return b.expression=r,this.finishNode(b,"ParenthesizedExpression")}else return r};Pe.parseParenItem=function(e){return e};Pe.parseParenArrowList=function(e,t,n,i){return this.parseArrowExpression(this.startNodeAt(e,t),n,!1,i)};var ZIe=[];Pe.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var e=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===T.dot){var t=this.startNodeAt(e.start,e.loc&&e.loc.start);t.name="new",e.meta=this.finishNode(t,"Identifier"),this.next();var n=this.containsEsc;return e.property=this.parseIdent(!0),e.property.name!=="target"&&this.raiseRecoverable(e.property.start,"The only valid meta property for new is 'new.target'"),n&&this.raiseRecoverable(e.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(e.start,"'new.target' can only be used in functions and class static block"),this.finishNode(e,"MetaProperty")}var i=this.start,r=this.startLoc;return e.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),i,r,!0,!1),this.eat(T.parenL)?e.arguments=this.parseExprList(T.parenR,this.options.ecmaVersion>=8,!1):e.arguments=ZIe,this.finishNode(e,"NewExpression")};Pe.parseTemplateElement=function(e){var t=e.isTagged,n=this.startNode();return this.type===T.invalidTemplate?(t||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),n.value={raw:this.value.replace(/\r\n?/g,`
`),cooked:null}):n.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),n.tail=this.type===T.backQuote,this.finishNode(n,"TemplateElement")};Pe.parseTemplate=function(e){e===void 0&&(e={});var t=e.isTagged;t===void 0&&(t=!1);var n=this.startNode();this.next(),n.expressions=[];var i=this.parseTemplateElement({isTagged:t});for(n.quasis=[i];!i.tail;)this.type===T.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(T.dollarBraceL),n.expressions.push(this.parseExpression()),this.expect(T.braceR),n.quasis.push(i=this.parseTemplateElement({isTagged:t}));return this.next(),this.finishNode(n,"TemplateLiteral")};Pe.isAsyncProp=function(e){return!e.computed&&e.key.type==="Identifier"&&e.key.name==="async"&&(this.type===T.name||this.type===T.num||this.type===T.string||this.type===T.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===T.star)&&!ss.test(this.input.slice(this.lastTokEnd,this.start))};Pe.parseObj=function(e,t){var n=this.startNode(),i=!0,r={};for(n.properties=[],this.next();!this.eat(T.braceR);){if(i)i=!1;else if(this.expect(T.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(T.braceR))break;var s=this.parseProperty(e,t);e||this.checkPropClash(s,r,t),n.properties.push(s)}return this.finishNode(n,e?"ObjectPattern":"ObjectExpression")};Pe.parseProperty=function(e,t){var n=this.startNode(),i,r,s,a;if(this.options.ecmaVersion>=9&&this.eat(T.ellipsis))return e?(n.argument=this.parseIdent(!1),this.type===T.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(n,"RestElement")):(n.argument=this.parseMaybeAssign(!1,t),this.type===T.comma&&t&&t.trailingComma<0&&(t.trailingComma=this.start),this.finishNode(n,"SpreadElement"));this.options.ecmaVersion>=6&&(n.method=!1,n.shorthand=!1,(e||t)&&(s=this.start,a=this.startLoc),e||(i=this.eat(T.star)));var o=this.containsEsc;return this.parsePropertyName(n),!e&&!o&&this.options.ecmaVersion>=8&&!i&&this.isAsyncProp(n)?(r=!0,i=this.options.ecmaVersion>=9&&this.eat(T.star),this.parsePropertyName(n)):r=!1,this.parsePropertyValue(n,e,i,r,s,a,t,o),this.finishNode(n,"Property")};Pe.parseGetterSetter=function(e){e.kind=e.key.name,this.parsePropertyName(e),e.value=this.parseMethod(!1);var t=e.kind==="get"?0:1;if(e.value.params.length!==t){var n=e.value.start;e.kind==="get"?this.raiseRecoverable(n,"getter should have no params"):this.raiseRecoverable(n,"setter should have exactly one param")}else e.kind==="set"&&e.value.params[0].type==="RestElement"&&this.raiseRecoverable(e.value.params[0].start,"Setter cannot use rest params")};Pe.parsePropertyValue=function(e,t,n,i,r,s,a,o){(n||i)&&this.type===T.colon&&this.unexpected(),this.eat(T.colon)?(e.value=t?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,a),e.kind="init"):this.options.ecmaVersion>=6&&this.type===T.parenL?(t&&this.unexpected(),e.kind="init",e.method=!0,e.value=this.parseMethod(n,i)):!t&&!o&&this.options.ecmaVersion>=5&&!e.computed&&e.key.type==="Identifier"&&(e.key.name==="get"||e.key.name==="set")&&this.type!==T.comma&&this.type!==T.braceR&&this.type!==T.eq?((n||i)&&this.unexpected(),this.parseGetterSetter(e)):this.options.ecmaVersion>=6&&!e.computed&&e.key.type==="Identifier"?((n||i)&&this.unexpected(),this.checkUnreserved(e.key),e.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=r),e.kind="init",t?e.value=this.parseMaybeDefault(r,s,this.copyNode(e.key)):this.type===T.eq&&a?(a.shorthandAssign<0&&(a.shorthandAssign=this.start),e.value=this.parseMaybeDefault(r,s,this.copyNode(e.key))):e.value=this.copyNode(e.key),e.shorthand=!0):this.unexpected()};Pe.parsePropertyName=function(e){if(this.options.ecmaVersion>=6){if(this.eat(T.bracketL))return e.computed=!0,e.key=this.parseMaybeAssign(),this.expect(T.bracketR),e.key;e.computed=!1}return e.key=this.type===T.num||this.type===T.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")};Pe.initFunction=function(e){e.id=null,this.options.ecmaVersion>=6&&(e.generator=e.expression=!1),this.options.ecmaVersion>=8&&(e.async=!1)};Pe.parseMethod=function(e,t,n){var i=this.startNode(),r=this.yieldPos,s=this.awaitPos,a=this.awaitIdentPos;return this.initFunction(i),this.options.ecmaVersion>=6&&(i.generator=e),this.options.ecmaVersion>=8&&(i.async=!!t),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(eF(t,i.generator)|QO|(n?bH:0)),this.expect(T.parenL),i.params=this.parseBindingList(T.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(i,!1,!0,!1),this.yieldPos=r,this.awaitPos=s,this.awaitIdentPos=a,this.finishNode(i,"FunctionExpression")};Pe.parseArrowExpression=function(e,t,n,i){var r=this.yieldPos,s=this.awaitPos,a=this.awaitIdentPos;return this.enterScope(eF(n,!1)|vH),this.initFunction(e),this.options.ecmaVersion>=8&&(e.async=!!n),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,e.params=this.toAssignableList(t,!0),this.parseFunctionBody(e,!0,!1,i),this.yieldPos=r,this.awaitPos=s,this.awaitIdentPos=a,this.finishNode(e,"ArrowFunctionExpression")};Pe.parseFunctionBody=function(e,t,n,i){var r=t&&this.type!==T.braceL,s=this.strict,a=!1;if(r)e.body=this.parseMaybeAssign(i),e.expression=!0,this.checkParams(e,!1);else{var o=this.options.ecmaVersion>=7&&!this.isSimpleParamList(e.params);(!s||o)&&(a=this.strictDirective(this.end),a&&o&&this.raiseRecoverable(e.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var u=this.labels;this.labels=[],a&&(this.strict=!0),this.checkParams(e,!s&&!a&&!t&&!n&&this.isSimpleParamList(e.params)),this.strict&&e.id&&this.checkLValSimple(e.id,EH),e.body=this.parseBlock(!1,void 0,a&&!s),e.expression=!1,this.adaptDirectivePrologue(e.body.body),this.labels=u}this.exitScope()};Pe.isSimpleParamList=function(e){for(var t=0,n=e;t<n.length;t+=1){var i=n[t];if(i.type!=="Identifier")return!1}return!0};Pe.checkParams=function(e,t){for(var n=Object.create(null),i=0,r=e.params;i<r.length;i+=1){var s=r[i];this.checkLValInnerPattern(s,tF,t?null:n)}};Pe.parseExprList=function(e,t,n,i){for(var r=[],s=!0;!this.eat(e);){if(s)s=!1;else if(this.expect(T.comma),t&&this.afterTrailingComma(e))break;var a=void 0;n&&this.type===T.comma?a=null:this.type===T.ellipsis?(a=this.parseSpread(i),i&&this.type===T.comma&&i.trailingComma<0&&(i.trailingComma=this.start)):a=this.parseMaybeAssign(!1,i),r.push(a)}return r};Pe.checkUnreserved=function(e){var t=e.start,n=e.end,i=e.name;if(this.inGenerator&&i==="yield"&&this.raiseRecoverable(t,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&i==="await"&&this.raiseRecoverable(t,"Cannot use 'await' as identifier inside an async function"),this.currentThisScope().inClassFieldInit&&i==="arguments"&&this.raiseRecoverable(t,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(i==="arguments"||i==="await")&&this.raise(t,"Cannot use "+i+" in class static initialization block"),this.keywords.test(i)&&this.raise(t,"Unexpected keyword '"+i+"'"),!(this.options.ecmaVersion<6&&this.input.slice(t,n).indexOf("\\")!==-1)){var r=this.strict?this.reservedWordsStrict:this.reservedWords;r.test(i)&&(!this.inAsync&&i==="await"&&this.raiseRecoverable(t,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(t,"The keyword '"+i+"' is reserved"))}};Pe.parseIdent=function(e){var t=this.parseIdentNode();return this.next(!!e),this.finishNode(t,"Identifier"),e||(this.checkUnreserved(t),t.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=t.start)),t};Pe.parseIdentNode=function(){var e=this.startNode();return this.type===T.name?e.name=this.value:this.type.keyword?(e.name=this.type.keyword,(e.name==="class"||e.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=T.name):this.unexpected(),e};Pe.parsePrivateIdent=function(){var e=this.startNode();return this.type===T.privateId?e.name=this.value:this.unexpected(),this.next(),this.finishNode(e,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(e.start,"Private field '#"+e.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(e)),e};Pe.parseYield=function(e){this.yieldPos||(this.yieldPos=this.start);var t=this.startNode();return this.next(),this.type===T.semi||this.canInsertSemicolon()||this.type!==T.star&&!this.type.startsExpr?(t.delegate=!1,t.argument=null):(t.delegate=this.eat(T.star),t.argument=this.parseMaybeAssign(e)),this.finishNode(t,"YieldExpression")};Pe.parseAwait=function(e){this.awaitPos||(this.awaitPos=this.start);var t=this.startNode();return this.next(),t.argument=this.parseMaybeUnary(null,!0,!1,e),this.finishNode(t,"AwaitExpression")};var Lv=Sn.prototype;Lv.raise=function(e,t){var n=mH(this.input,e);t+=" ("+n.line+":"+n.column+")";var i=new SyntaxError(t);throw i.pos=e,i.loc=n,i.raisedAt=this.pos,i};Lv.raiseRecoverable=Lv.raise;Lv.curPosition=function(){if(this.options.locations)return new Mg(this.curLine,this.pos-this.lineStart)};var hl=Sn.prototype,eDe=function(t){this.flags=t,this.var=[],this.lexical=[],this.functions=[],this.inClassFieldInit=!1};hl.enterScope=function(e){this.scopeStack.push(new eDe(e))};hl.exitScope=function(){this.scopeStack.pop()};hl.treatFunctionsAsVarInScope=function(e){return e.flags&hd||!this.inModule&&e.flags&Ng};hl.declareName=function(e,t,n){var i=!1;if(t===Yo){var r=this.currentScope();i=r.lexical.indexOf(e)>-1||r.functions.indexOf(e)>-1||r.var.indexOf(e)>-1,r.lexical.push(e),this.inModule&&r.flags&Ng&&delete this.undefinedExports[e]}else if(t===wH){var s=this.currentScope();s.lexical.push(e)}else if(t===_H){var a=this.currentScope();this.treatFunctionsAsVar?i=a.lexical.indexOf(e)>-1:i=a.lexical.indexOf(e)>-1||a.var.indexOf(e)>-1,a.functions.push(e)}else for(var o=this.scopeStack.length-1;o>=0;--o){var u=this.scopeStack[o];if(u.lexical.indexOf(e)>-1&&!(u.flags&xH&&u.lexical[0]===e)||!this.treatFunctionsAsVarInScope(u)&&u.functions.indexOf(e)>-1){i=!0;break}if(u.var.push(e),this.inModule&&u.flags&Ng&&delete this.undefinedExports[e],u.flags&ZO)break}i&&this.raiseRecoverable(n,"Identifier '"+e+"' has already been declared")};hl.checkLocalExport=function(e){this.scopeStack[0].lexical.indexOf(e.name)===-1&&this.scopeStack[0].var.indexOf(e.name)===-1&&(this.undefinedExports[e.name]=e)};hl.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]};hl.currentVarScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(t.flags&ZO)return t}};hl.currentThisScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(t.flags&ZO&&!(t.flags&vH))return t}};var e2=function(t,n,i){this.type="",this.start=n,this.end=0,t.options.locations&&(this.loc=new Qb(t,i)),t.options.directSourceFile&&(this.sourceFile=t.options.directSourceFile),t.options.ranges&&(this.range=[n,0])},I0=Sn.prototype;I0.startNode=function(){return new e2(this,this.start,this.startLoc)};I0.startNodeAt=function(e,t){return new e2(this,e,t)};function CH(e,t,n,i){return e.type=t,e.end=n,this.options.locations&&(e.loc.end=i),this.options.ranges&&(e.range[1]=n),e}I0.finishNode=function(e,t){return CH.call(this,e,t,this.lastTokEnd,this.lastTokEndLoc)};I0.finishNodeAt=function(e,t,n,i){return CH.call(this,e,t,n,i)};I0.copyNode=function(e){var t=new e2(this,e.start,this.startLoc);for(var n in e)t[n]=e[n];return t};var tDe="Gara Garay Gukh Gurung_Khema Hrkt Katakana_Or_Hiragana Kawi Kirat_Rai Krai Nag_Mundari Nagm Ol_Onal Onao Sunu Sunuwar Todhri Todr Tulu_Tigalari Tutg Unknown Zzzz",kH="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",$H=kH+" Extended_Pictographic",TH=$H,OH=TH+" EBase EComp EMod EPres ExtPict",FH=OH,nDe=FH,iDe={9:kH,10:$H,11:TH,12:OH,13:FH,14:nDe},rDe="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",sDe={9:"",10:"",11:"",12:"",13:"",14:rDe},sL="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",MH="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",NH=MH+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",RH=NH+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",IH=RH+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",DH=IH+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",aDe=DH+" "+tDe,oDe={9:MH,10:NH,11:RH,12:IH,13:DH,14:aDe},PH={};function uDe(e){var t=PH[e]={binary:Su(iDe[e]+" "+sL),binaryOfStrings:Su(sDe[e]),nonBinary:{General_Category:Su(sL),Script:Su(oDe[e])}};t.nonBinary.Script_Extensions=t.nonBinary.Script,t.nonBinary.gc=t.nonBinary.General_Category,t.nonBinary.sc=t.nonBinary.Script,t.nonBinary.scx=t.nonBinary.Script_Extensions}for(var NE=0,aL=[9,10,11,12,13,14];NE<aL.length;NE+=1){var lDe=aL[NE];uDe(lDe)}var be=Sn.prototype,zv=function(t,n){this.parent=t,this.base=n||this};zv.prototype.separatedFrom=function(t){for(var n=this;n;n=n.parent)for(var i=t;i;i=i.parent)if(n.base===i.base&&n!==i)return!0;return!1};zv.prototype.sibling=function(){return new zv(this.parent,this.base)};var qa=function(t){this.parser=t,this.validFlags="gim"+(t.options.ecmaVersion>=6?"uy":"")+(t.options.ecmaVersion>=9?"s":"")+(t.options.ecmaVersion>=13?"d":"")+(t.options.ecmaVersion>=15?"v":""),this.unicodeProperties=PH[t.options.ecmaVersion>=14?14:t.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=Object.create(null),this.backReferenceNames=[],this.branchID=null};qa.prototype.reset=function(t,n,i){var r=i.indexOf("v")!==-1,s=i.indexOf("u")!==-1;this.start=t|0,this.source=n+"",this.flags=i,r&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=s&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=s&&this.parser.options.ecmaVersion>=9)};qa.prototype.raise=function(t){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+t)};qa.prototype.at=function(t,n){n===void 0&&(n=!1);var i=this.source,r=i.length;if(t>=r)return-1;var s=i.charCodeAt(t);if(!(n||this.switchU)||s<=55295||s>=57344||t+1>=r)return s;var a=i.charCodeAt(t+1);return a>=56320&&a<=57343?(s<<10)+a-56613888:s};qa.prototype.nextIndex=function(t,n){n===void 0&&(n=!1);var i=this.source,r=i.length;if(t>=r)return r;var s=i.charCodeAt(t),a;return!(n||this.switchU)||s<=55295||s>=57344||t+1>=r||(a=i.charCodeAt(t+1))<56320||a>57343?t+1:t+2};qa.prototype.current=function(t){return t===void 0&&(t=!1),this.at(this.pos,t)};qa.prototype.lookahead=function(t){return t===void 0&&(t=!1),this.at(this.nextIndex(this.pos,t),t)};qa.prototype.advance=function(t){t===void 0&&(t=!1),this.pos=this.nextIndex(this.pos,t)};qa.prototype.eat=function(t,n){return n===void 0&&(n=!1),this.current(n)===t?(this.advance(n),!0):!1};qa.prototype.eatChars=function(t,n){n===void 0&&(n=!1);for(var i=this.pos,r=0,s=t;r<s.length;r+=1){var a=s[r],o=this.at(i,n);if(o===-1||o!==a)return!1;i=this.nextIndex(i,n)}return this.pos=i,!0};be.validateRegExpFlags=function(e){for(var t=e.validFlags,n=e.flags,i=!1,r=!1,s=0;s<n.length;s++){var a=n.charAt(s);t.indexOf(a)===-1&&this.raise(e.start,"Invalid regular expression flag"),n.indexOf(a,s+1)>-1&&this.raise(e.start,"Duplicate regular expression flag"),a==="u"&&(i=!0),a==="v"&&(r=!0)}this.options.ecmaVersion>=15&&i&&r&&this.raise(e.start,"Invalid regular expression flag")};function cDe(e){for(var t in e)return!0;return!1}be.validateRegExpPattern=function(e){this.regexp_pattern(e),!e.switchN&&this.options.ecmaVersion>=9&&cDe(e.groupNames)&&(e.switchN=!0,this.regexp_pattern(e))};be.regexp_pattern=function(e){e.pos=0,e.lastIntValue=0,e.lastStringValue="",e.lastAssertionIsQuantifiable=!1,e.numCapturingParens=0,e.maxBackReference=0,e.groupNames=Object.create(null),e.backReferenceNames.length=0,e.branchID=null,this.regexp_disjunction(e),e.pos!==e.source.length&&(e.eat(41)&&e.raise("Unmatched ')'"),(e.eat(93)||e.eat(125))&&e.raise("Lone quantifier brackets")),e.maxBackReference>e.numCapturingParens&&e.raise("Invalid escape");for(var t=0,n=e.backReferenceNames;t<n.length;t+=1){var i=n[t];e.groupNames[i]||e.raise("Invalid named capture referenced")}};be.regexp_disjunction=function(e){var t=this.options.ecmaVersion>=16;for(t&&(e.branchID=new zv(e.branchID,null)),this.regexp_alternative(e);e.eat(124);)t&&(e.branchID=e.branchID.sibling()),this.regexp_alternative(e);t&&(e.branchID=e.branchID.parent),this.regexp_eatQuantifier(e,!0)&&e.raise("Nothing to repeat"),e.eat(123)&&e.raise("Lone quantifier brackets")};be.regexp_alternative=function(e){for(;e.pos<e.source.length&&this.regexp_eatTerm(e););};be.regexp_eatTerm=function(e){return this.regexp_eatAssertion(e)?(e.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(e)&&e.switchU&&e.raise("Invalid quantifier"),!0):(e.switchU?this.regexp_eatAtom(e):this.regexp_eatExtendedAtom(e))?(this.regexp_eatQuantifier(e),!0):!1};be.regexp_eatAssertion=function(e){var t=e.pos;if(e.lastAssertionIsQuantifiable=!1,e.eat(94)||e.eat(36))return!0;if(e.eat(92)){if(e.eat(66)||e.eat(98))return!0;e.pos=t}if(e.eat(40)&&e.eat(63)){var n=!1;if(this.options.ecmaVersion>=9&&(n=e.eat(60)),e.eat(61)||e.eat(33))return this.regexp_disjunction(e),e.eat(41)||e.raise("Unterminated group"),e.lastAssertionIsQuantifiable=!n,!0}return e.pos=t,!1};be.regexp_eatQuantifier=function(e,t){return t===void 0&&(t=!1),this.regexp_eatQuantifierPrefix(e,t)?(e.eat(63),!0):!1};be.regexp_eatQuantifierPrefix=function(e,t){return e.eat(42)||e.eat(43)||e.eat(63)||this.regexp_eatBracedQuantifier(e,t)};be.regexp_eatBracedQuantifier=function(e,t){var n=e.pos;if(e.eat(123)){var i=0,r=-1;if(this.regexp_eatDecimalDigits(e)&&(i=e.lastIntValue,e.eat(44)&&this.regexp_eatDecimalDigits(e)&&(r=e.lastIntValue),e.eat(125)))return r!==-1&&r<i&&!t&&e.raise("numbers out of order in {} quantifier"),!0;e.switchU&&!t&&e.raise("Incomplete quantifier"),e.pos=n}return!1};be.regexp_eatAtom=function(e){return this.regexp_eatPatternCharacters(e)||e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)};be.regexp_eatReverseSolidusAtomEscape=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatAtomEscape(e))return!0;e.pos=t}return!1};be.regexp_eatUncapturingGroup=function(e){var t=e.pos;if(e.eat(40)){if(e.eat(63)){if(this.options.ecmaVersion>=16){var n=this.regexp_eatModifiers(e),i=e.eat(45);if(n||i){for(var r=0;r<n.length;r++){var s=n.charAt(r);n.indexOf(s,r+1)>-1&&e.raise("Duplicate regular expression modifiers")}if(i){var a=this.regexp_eatModifiers(e);!n&&!a&&e.current()===58&&e.raise("Invalid regular expression modifiers");for(var o=0;o<a.length;o++){var u=a.charAt(o);(a.indexOf(u,o+1)>-1||n.indexOf(u)>-1)&&e.raise("Duplicate regular expression modifiers")}}}}if(e.eat(58)){if(this.regexp_disjunction(e),e.eat(41))return!0;e.raise("Unterminated group")}}e.pos=t}return!1};be.regexp_eatCapturingGroup=function(e){if(e.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(e):e.current()===63&&e.raise("Invalid group"),this.regexp_disjunction(e),e.eat(41))return e.numCapturingParens+=1,!0;e.raise("Unterminated group")}return!1};be.regexp_eatModifiers=function(e){for(var t="",n=0;(n=e.current())!==-1&&fDe(n);)t+=Do(n),e.advance();return t};function fDe(e){return e===105||e===109||e===115}be.regexp_eatExtendedAtom=function(e){return e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)||this.regexp_eatInvalidBracedQuantifier(e)||this.regexp_eatExtendedPatternCharacter(e)};be.regexp_eatInvalidBracedQuantifier=function(e){return this.regexp_eatBracedQuantifier(e,!0)&&e.raise("Nothing to repeat"),!1};be.regexp_eatSyntaxCharacter=function(e){var t=e.current();return LH(t)?(e.lastIntValue=t,e.advance(),!0):!1};function LH(e){return e===36||e>=40&&e<=43||e===46||e===63||e>=91&&e<=94||e>=123&&e<=125}be.regexp_eatPatternCharacters=function(e){for(var t=e.pos,n=0;(n=e.current())!==-1&&!LH(n);)e.advance();return e.pos!==t};be.regexp_eatExtendedPatternCharacter=function(e){var t=e.current();return t!==-1&&t!==36&&!(t>=40&&t<=43)&&t!==46&&t!==63&&t!==91&&t!==94&&t!==124?(e.advance(),!0):!1};be.regexp_groupSpecifier=function(e){if(e.eat(63)){this.regexp_eatGroupName(e)||e.raise("Invalid group");var t=this.options.ecmaVersion>=16,n=e.groupNames[e.lastStringValue];if(n)if(t)for(var i=0,r=n;i<r.length;i+=1){var s=r[i];s.separatedFrom(e.branchID)||e.raise("Duplicate capture group name")}else e.raise("Duplicate capture group name");t?(n||(e.groupNames[e.lastStringValue]=[])).push(e.branchID):e.groupNames[e.lastStringValue]=!0}};be.regexp_eatGroupName=function(e){if(e.lastStringValue="",e.eat(60)){if(this.regexp_eatRegExpIdentifierName(e)&&e.eat(62))return!0;e.raise("Invalid capture group name")}return!1};be.regexp_eatRegExpIdentifierName=function(e){if(e.lastStringValue="",this.regexp_eatRegExpIdentifierStart(e)){for(e.lastStringValue+=Do(e.lastIntValue);this.regexp_eatRegExpIdentifierPart(e);)e.lastStringValue+=Do(e.lastIntValue);return!0}return!1};be.regexp_eatRegExpIdentifierStart=function(e){var t=e.pos,n=this.options.ecmaVersion>=11,i=e.current(n);return e.advance(n),i===92&&this.regexp_eatRegExpUnicodeEscapeSequence(e,n)&&(i=e.lastIntValue),hDe(i)?(e.lastIntValue=i,!0):(e.pos=t,!1)};function hDe(e){return Io(e,!0)||e===36||e===95}be.regexp_eatRegExpIdentifierPart=function(e){var t=e.pos,n=this.options.ecmaVersion>=11,i=e.current(n);return e.advance(n),i===92&&this.regexp_eatRegExpUnicodeEscapeSequence(e,n)&&(i=e.lastIntValue),dDe(i)?(e.lastIntValue=i,!0):(e.pos=t,!1)};function dDe(e){return Fh(e,!0)||e===36||e===95||e===8204||e===8205}be.regexp_eatAtomEscape=function(e){return this.regexp_eatBackReference(e)||this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)||e.switchN&&this.regexp_eatKGroupName(e)?!0:(e.switchU&&(e.current()===99&&e.raise("Invalid unicode escape"),e.raise("Invalid escape")),!1)};be.regexp_eatBackReference=function(e){var t=e.pos;if(this.regexp_eatDecimalEscape(e)){var n=e.lastIntValue;if(e.switchU)return n>e.maxBackReference&&(e.maxBackReference=n),!0;if(n<=e.numCapturingParens)return!0;e.pos=t}return!1};be.regexp_eatKGroupName=function(e){if(e.eat(107)){if(this.regexp_eatGroupName(e))return e.backReferenceNames.push(e.lastStringValue),!0;e.raise("Invalid named reference")}return!1};be.regexp_eatCharacterEscape=function(e){return this.regexp_eatControlEscape(e)||this.regexp_eatCControlLetter(e)||this.regexp_eatZero(e)||this.regexp_eatHexEscapeSequence(e)||this.regexp_eatRegExpUnicodeEscapeSequence(e,!1)||!e.switchU&&this.regexp_eatLegacyOctalEscapeSequence(e)||this.regexp_eatIdentityEscape(e)};be.regexp_eatCControlLetter=function(e){var t=e.pos;if(e.eat(99)){if(this.regexp_eatControlLetter(e))return!0;e.pos=t}return!1};be.regexp_eatZero=function(e){return e.current()===48&&!t2(e.lookahead())?(e.lastIntValue=0,e.advance(),!0):!1};be.regexp_eatControlEscape=function(e){var t=e.current();return t===116?(e.lastIntValue=9,e.advance(),!0):t===110?(e.lastIntValue=10,e.advance(),!0):t===118?(e.lastIntValue=11,e.advance(),!0):t===102?(e.lastIntValue=12,e.advance(),!0):t===114?(e.lastIntValue=13,e.advance(),!0):!1};be.regexp_eatControlLetter=function(e){var t=e.current();return zH(t)?(e.lastIntValue=t%32,e.advance(),!0):!1};function zH(e){return e>=65&&e<=90||e>=97&&e<=122}be.regexp_eatRegExpUnicodeEscapeSequence=function(e,t){t===void 0&&(t=!1);var n=e.pos,i=t||e.switchU;if(e.eat(117)){if(this.regexp_eatFixedHexDigits(e,4)){var r=e.lastIntValue;if(i&&r>=55296&&r<=56319){var s=e.pos;if(e.eat(92)&&e.eat(117)&&this.regexp_eatFixedHexDigits(e,4)){var a=e.lastIntValue;if(a>=56320&&a<=57343)return e.lastIntValue=(r-55296)*1024+(a-56320)+65536,!0}e.pos=s,e.lastIntValue=r}return!0}if(i&&e.eat(123)&&this.regexp_eatHexDigits(e)&&e.eat(125)&&pDe(e.lastIntValue))return!0;i&&e.raise("Invalid unicode escape"),e.pos=n}return!1};function pDe(e){return e>=0&&e<=1114111}be.regexp_eatIdentityEscape=function(e){if(e.switchU)return this.regexp_eatSyntaxCharacter(e)?!0:e.eat(47)?(e.lastIntValue=47,!0):!1;var t=e.current();return t!==99&&(!e.switchN||t!==107)?(e.lastIntValue=t,e.advance(),!0):!1};be.regexp_eatDecimalEscape=function(e){e.lastIntValue=0;var t=e.current();if(t>=49&&t<=57){do e.lastIntValue=10*e.lastIntValue+(t-48),e.advance();while((t=e.current())>=48&&t<=57);return!0}return!1};var BH=0,Po=1,Ur=2;be.regexp_eatCharacterClassEscape=function(e){var t=e.current();if(gDe(t))return e.lastIntValue=-1,e.advance(),Po;var n=!1;if(e.switchU&&this.options.ecmaVersion>=9&&((n=t===80)||t===112)){e.lastIntValue=-1,e.advance();var i;if(e.eat(123)&&(i=this.regexp_eatUnicodePropertyValueExpression(e))&&e.eat(125))return n&&i===Ur&&e.raise("Invalid property name"),i;e.raise("Invalid property name")}return BH};function gDe(e){return e===100||e===68||e===115||e===83||e===119||e===87}be.regexp_eatUnicodePropertyValueExpression=function(e){var t=e.pos;if(this.regexp_eatUnicodePropertyName(e)&&e.eat(61)){var n=e.lastStringValue;if(this.regexp_eatUnicodePropertyValue(e)){var i=e.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(e,n,i),Po}}if(e.pos=t,this.regexp_eatLoneUnicodePropertyNameOrValue(e)){var r=e.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(e,r)}return BH};be.regexp_validateUnicodePropertyNameAndValue=function(e,t,n){fd(e.unicodeProperties.nonBinary,t)||e.raise("Invalid property name"),e.unicodeProperties.nonBinary[t].test(n)||e.raise("Invalid property value")};be.regexp_validateUnicodePropertyNameOrValue=function(e,t){if(e.unicodeProperties.binary.test(t))return Po;if(e.switchV&&e.unicodeProperties.binaryOfStrings.test(t))return Ur;e.raise("Invalid property name")};be.regexp_eatUnicodePropertyName=function(e){var t=0;for(e.lastStringValue="";UH(t=e.current());)e.lastStringValue+=Do(t),e.advance();return e.lastStringValue!==""};function UH(e){return zH(e)||e===95}be.regexp_eatUnicodePropertyValue=function(e){var t=0;for(e.lastStringValue="";mDe(t=e.current());)e.lastStringValue+=Do(t),e.advance();return e.lastStringValue!==""};function mDe(e){return UH(e)||t2(e)}be.regexp_eatLoneUnicodePropertyNameOrValue=function(e){return this.regexp_eatUnicodePropertyValue(e)};be.regexp_eatCharacterClass=function(e){if(e.eat(91)){var t=e.eat(94),n=this.regexp_classContents(e);return e.eat(93)||e.raise("Unterminated character class"),t&&n===Ur&&e.raise("Negated character class may contain strings"),!0}return!1};be.regexp_classContents=function(e){return e.current()===93?Po:e.switchV?this.regexp_classSetExpression(e):(this.regexp_nonEmptyClassRanges(e),Po)};be.regexp_nonEmptyClassRanges=function(e){for(;this.regexp_eatClassAtom(e);){var t=e.lastIntValue;if(e.eat(45)&&this.regexp_eatClassAtom(e)){var n=e.lastIntValue;e.switchU&&(t===-1||n===-1)&&e.raise("Invalid character class"),t!==-1&&n!==-1&&t>n&&e.raise("Range out of order in character class")}}};be.regexp_eatClassAtom=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatClassEscape(e))return!0;if(e.switchU){var n=e.current();(n===99||VH(n))&&e.raise("Invalid class escape"),e.raise("Invalid escape")}e.pos=t}var i=e.current();return i!==93?(e.lastIntValue=i,e.advance(),!0):!1};be.regexp_eatClassEscape=function(e){var t=e.pos;if(e.eat(98))return e.lastIntValue=8,!0;if(e.switchU&&e.eat(45))return e.lastIntValue=45,!0;if(!e.switchU&&e.eat(99)){if(this.regexp_eatClassControlLetter(e))return!0;e.pos=t}return this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)};be.regexp_classSetExpression=function(e){var t=Po,n;if(!this.regexp_eatClassSetRange(e))if(n=this.regexp_eatClassSetOperand(e)){n===Ur&&(t=Ur);for(var i=e.pos;e.eatChars([38,38]);){if(e.current()!==38&&(n=this.regexp_eatClassSetOperand(e))){n!==Ur&&(t=Po);continue}e.raise("Invalid character in character class")}if(i!==e.pos)return t;for(;e.eatChars([45,45]);)this.regexp_eatClassSetOperand(e)||e.raise("Invalid character in character class");if(i!==e.pos)return t}else e.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(e)){if(n=this.regexp_eatClassSetOperand(e),!n)return t;n===Ur&&(t=Ur)}};be.regexp_eatClassSetRange=function(e){var t=e.pos;if(this.regexp_eatClassSetCharacter(e)){var n=e.lastIntValue;if(e.eat(45)&&this.regexp_eatClassSetCharacter(e)){var i=e.lastIntValue;return n!==-1&&i!==-1&&n>i&&e.raise("Range out of order in character class"),!0}e.pos=t}return!1};be.regexp_eatClassSetOperand=function(e){return this.regexp_eatClassSetCharacter(e)?Po:this.regexp_eatClassStringDisjunction(e)||this.regexp_eatNestedClass(e)};be.regexp_eatNestedClass=function(e){var t=e.pos;if(e.eat(91)){var n=e.eat(94),i=this.regexp_classContents(e);if(e.eat(93))return n&&i===Ur&&e.raise("Negated character class may contain strings"),i;e.pos=t}if(e.eat(92)){var r=this.regexp_eatCharacterClassEscape(e);if(r)return r;e.pos=t}return null};be.regexp_eatClassStringDisjunction=function(e){var t=e.pos;if(e.eatChars([92,113])){if(e.eat(123)){var n=this.regexp_classStringDisjunctionContents(e);if(e.eat(125))return n}else e.raise("Invalid escape");e.pos=t}return null};be.regexp_classStringDisjunctionContents=function(e){for(var t=this.regexp_classString(e);e.eat(124);)this.regexp_classString(e)===Ur&&(t=Ur);return t};be.regexp_classString=function(e){for(var t=0;this.regexp_eatClassSetCharacter(e);)t++;return t===1?Po:Ur};be.regexp_eatClassSetCharacter=function(e){var t=e.pos;if(e.eat(92))return this.regexp_eatCharacterEscape(e)||this.regexp_eatClassSetReservedPunctuator(e)?!0:e.eat(98)?(e.lastIntValue=8,!0):(e.pos=t,!1);var n=e.current();return n<0||n===e.lookahead()&&yDe(n)||vDe(n)?!1:(e.advance(),e.lastIntValue=n,!0)};function yDe(e){return e===33||e>=35&&e<=38||e>=42&&e<=44||e===46||e>=58&&e<=64||e===94||e===96||e===126}function vDe(e){return e===40||e===41||e===45||e===47||e>=91&&e<=93||e>=123&&e<=125}be.regexp_eatClassSetReservedPunctuator=function(e){var t=e.current();return xDe(t)?(e.lastIntValue=t,e.advance(),!0):!1};function xDe(e){return e===33||e===35||e===37||e===38||e===44||e===45||e>=58&&e<=62||e===64||e===96||e===126}be.regexp_eatClassControlLetter=function(e){var t=e.current();return t2(t)||t===95?(e.lastIntValue=t%32,e.advance(),!0):!1};be.regexp_eatHexEscapeSequence=function(e){var t=e.pos;if(e.eat(120)){if(this.regexp_eatFixedHexDigits(e,2))return!0;e.switchU&&e.raise("Invalid escape"),e.pos=t}return!1};be.regexp_eatDecimalDigits=function(e){var t=e.pos,n=0;for(e.lastIntValue=0;t2(n=e.current());)e.lastIntValue=10*e.lastIntValue+(n-48),e.advance();return e.pos!==t};function t2(e){return e>=48&&e<=57}be.regexp_eatHexDigits=function(e){var t=e.pos,n=0;for(e.lastIntValue=0;jH(n=e.current());)e.lastIntValue=16*e.lastIntValue+qH(n),e.advance();return e.pos!==t};function jH(e){return e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102}function qH(e){return e>=65&&e<=70?10+(e-65):e>=97&&e<=102?10+(e-97):e-48}be.regexp_eatLegacyOctalEscapeSequence=function(e){if(this.regexp_eatOctalDigit(e)){var t=e.lastIntValue;if(this.regexp_eatOctalDigit(e)){var n=e.lastIntValue;t<=3&&this.regexp_eatOctalDigit(e)?e.lastIntValue=t*64+n*8+e.lastIntValue:e.lastIntValue=t*8+n}else e.lastIntValue=t;return!0}return!1};be.regexp_eatOctalDigit=function(e){var t=e.current();return VH(t)?(e.lastIntValue=t-48,e.advance(),!0):(e.lastIntValue=0,!1)};function VH(e){return e>=48&&e<=55}be.regexp_eatFixedHexDigits=function(e,t){var n=e.pos;e.lastIntValue=0;for(var i=0;i<t;++i){var r=e.current();if(!jH(r))return e.pos=n,!1;e.lastIntValue=16*e.lastIntValue+qH(r),e.advance()}return!0};var iF=function(t){this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new Qb(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])},it=Sn.prototype;it.next=function(e){!e&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new iF(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()};it.getToken=function(){return this.next(),new iF(this)};typeof Symbol<"u"&&(it[Symbol.iterator]=function(){var e=this;return{next:function(){var t=e.getToken();return{done:t.type===T.eof,value:t}}}});it.nextToken=function(){var e=this.curContext();if((!e||!e.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(T.eof);if(e.override)return e.override(this);this.readToken(this.fullCharCodeAtPos())};it.readToken=function(e){return Io(e,this.options.ecmaVersion>=6)||e===92?this.readWord():this.getTokenFromCode(e)};it.fullCharCodeAtPos=function(){var e=this.input.charCodeAt(this.pos);if(e<=55295||e>=56320)return e;var t=this.input.charCodeAt(this.pos+1);return t<=56319||t>=57344?e:(e<<10)+t-56613888};it.skipBlockComment=function(){var e=this.options.onComment&&this.curPosition(),t=this.pos,n=this.input.indexOf("*/",this.pos+=2);if(n===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=n+2,this.options.locations)for(var i=void 0,r=t;(i=dH(this.input,r,this.pos))>-1;)++this.curLine,r=this.lineStart=i;this.options.onComment&&this.options.onComment(!0,this.input.slice(t+2,n),t,this.pos,e,this.curPosition())};it.skipLineComment=function(e){for(var t=this.pos,n=this.options.onComment&&this.curPosition(),i=this.input.charCodeAt(this.pos+=e);this.pos<this.input.length&&!cd(i);)i=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(t+e,this.pos),t,this.pos,n,this.curPosition())};it.skipSpace=function(){e:for(;this.pos<this.input.length;){var e=this.input.charCodeAt(this.pos);switch(e){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(e>8&&e<14||e>=5760&&pH.test(String.fromCharCode(e)))++this.pos;else break e}}};it.finishToken=function(e,t){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var n=this.type;this.type=e,this.value=t,this.updateContext(n)};it.readToken_dot=function(){var e=this.input.charCodeAt(this.pos+1);if(e>=48&&e<=57)return this.readNumber(!0);var t=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&e===46&&t===46?(this.pos+=3,this.finishToken(T.ellipsis)):(++this.pos,this.finishToken(T.dot))};it.readToken_slash=function(){var e=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):e===61?this.finishOp(T.assign,2):this.finishOp(T.slash,1)};it.readToken_mult_modulo_exp=function(e){var t=this.input.charCodeAt(this.pos+1),n=1,i=e===42?T.star:T.modulo;return this.options.ecmaVersion>=7&&e===42&&t===42&&(++n,i=T.starstar,t=this.input.charCodeAt(this.pos+2)),t===61?this.finishOp(T.assign,n+1):this.finishOp(i,n)};it.readToken_pipe_amp=function(e){var t=this.input.charCodeAt(this.pos+1);if(t===e){if(this.options.ecmaVersion>=12){var n=this.input.charCodeAt(this.pos+2);if(n===61)return this.finishOp(T.assign,3)}return this.finishOp(e===124?T.logicalOR:T.logicalAND,2)}return t===61?this.finishOp(T.assign,2):this.finishOp(e===124?T.bitwiseOR:T.bitwiseAND,1)};it.readToken_caret=function(){var e=this.input.charCodeAt(this.pos+1);return e===61?this.finishOp(T.assign,2):this.finishOp(T.bitwiseXOR,1)};it.readToken_plus_min=function(e){var t=this.input.charCodeAt(this.pos+1);return t===e?t===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||ss.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(T.incDec,2):t===61?this.finishOp(T.assign,2):this.finishOp(T.plusMin,1)};it.readToken_lt_gt=function(e){var t=this.input.charCodeAt(this.pos+1),n=1;return t===e?(n=e===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+n)===61?this.finishOp(T.assign,n+1):this.finishOp(T.bitShift,n)):t===33&&e===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(t===61&&(n=2),this.finishOp(T.relational,n))};it.readToken_eq_excl=function(e){var t=this.input.charCodeAt(this.pos+1);return t===61?this.finishOp(T.equality,this.input.charCodeAt(this.pos+2)===61?3:2):e===61&&t===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(T.arrow)):this.finishOp(e===61?T.eq:T.prefix,1)};it.readToken_question=function(){var e=this.options.ecmaVersion;if(e>=11){var t=this.input.charCodeAt(this.pos+1);if(t===46){var n=this.input.charCodeAt(this.pos+2);if(n<48||n>57)return this.finishOp(T.questionDot,2)}if(t===63){if(e>=12){var i=this.input.charCodeAt(this.pos+2);if(i===61)return this.finishOp(T.assign,3)}return this.finishOp(T.coalesce,2)}}return this.finishOp(T.question,1)};it.readToken_numberSign=function(){var e=this.options.ecmaVersion,t=35;if(e>=13&&(++this.pos,t=this.fullCharCodeAtPos(),Io(t,!0)||t===92))return this.finishToken(T.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+Do(t)+"'")};it.getTokenFromCode=function(e){switch(e){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(T.parenL);case 41:return++this.pos,this.finishToken(T.parenR);case 59:return++this.pos,this.finishToken(T.semi);case 44:return++this.pos,this.finishToken(T.comma);case 91:return++this.pos,this.finishToken(T.bracketL);case 93:return++this.pos,this.finishToken(T.bracketR);case 123:return++this.pos,this.finishToken(T.braceL);case 125:return++this.pos,this.finishToken(T.braceR);case 58:return++this.pos,this.finishToken(T.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(T.backQuote);case 48:var t=this.input.charCodeAt(this.pos+1);if(t===120||t===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(t===111||t===79)return this.readRadixNumber(8);if(t===98||t===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(e);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(e);case 124:case 38:return this.readToken_pipe_amp(e);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(e);case 60:case 62:return this.readToken_lt_gt(e);case 61:case 33:return this.readToken_eq_excl(e);case 63:return this.readToken_question();case 126:return this.finishOp(T.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+Do(e)+"'")};it.finishOp=function(e,t){var n=this.input.slice(this.pos,this.pos+t);return this.pos+=t,this.finishToken(e,n)};it.readRegexp=function(){for(var e,t,n=this.pos;;){this.pos>=this.input.length&&this.raise(n,"Unterminated regular expression");var i=this.input.charAt(this.pos);if(ss.test(i)&&this.raise(n,"Unterminated regular expression"),e)e=!1;else{if(i==="[")t=!0;else if(i==="]"&&t)t=!1;else if(i==="/"&&!t)break;e=i==="\\"}++this.pos}var r=this.input.slice(n,this.pos);++this.pos;var s=this.pos,a=this.readWord1();this.containsEsc&&this.unexpected(s);var o=this.regexpState||(this.regexpState=new qa(this));o.reset(n,r,a),this.validateRegExpFlags(o),this.validateRegExpPattern(o);var u=null;try{u=new RegExp(r,a)}catch{}return this.finishToken(T.regexp,{pattern:r,flags:a,value:u})};it.readInt=function(e,t,n){for(var i=this.options.ecmaVersion>=12&&t===void 0,r=n&&this.input.charCodeAt(this.pos)===48,s=this.pos,a=0,o=0,u=0,l=t??1/0;u<l;++u,++this.pos){var c=this.input.charCodeAt(this.pos),f=void 0;if(i&&c===95){r&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),o===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),u===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),o=c;continue}if(c>=97?f=c-97+10:c>=65?f=c-65+10:c>=48&&c<=57?f=c-48:f=1/0,f>=e)break;o=c,a=a*e+f}return i&&o===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===s||t!=null&&this.pos-s!==t?null:a};function bDe(e,t){return t?parseInt(e,8):parseFloat(e.replace(/_/g,""))}function WH(e){return typeof BigInt!="function"?null:BigInt(e.replace(/_/g,""))}it.readRadixNumber=function(e){var t=this.pos;this.pos+=2;var n=this.readInt(e);return n==null&&this.raise(this.start+2,"Expected number in radix "+e),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(n=WH(this.input.slice(t,this.pos)),++this.pos):Io(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(T.num,n)};it.readNumber=function(e){var t=this.pos;!e&&this.readInt(10,void 0,!0)===null&&this.raise(t,"Invalid number");var n=this.pos-t>=2&&this.input.charCodeAt(t)===48;n&&this.strict&&this.raise(t,"Invalid number");var i=this.input.charCodeAt(this.pos);if(!n&&!e&&this.options.ecmaVersion>=11&&i===110){var r=WH(this.input.slice(t,this.pos));return++this.pos,Io(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(T.num,r)}n&&/[89]/.test(this.input.slice(t,this.pos))&&(n=!1),i===46&&!n&&(++this.pos,this.readInt(10),i=this.input.charCodeAt(this.pos)),(i===69||i===101)&&!n&&(i=this.input.charCodeAt(++this.pos),(i===43||i===45)&&++this.pos,this.readInt(10)===null&&this.raise(t,"Invalid number")),Io(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var s=bDe(this.input.slice(t,this.pos),n);return this.finishToken(T.num,s)};it.readCodePoint=function(){var e=this.input.charCodeAt(this.pos),t;if(e===123){this.options.ecmaVersion<6&&this.unexpected();var n=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,t>1114111&&this.invalidStringToken(n,"Code point out of bounds")}else t=this.readHexChar(4);return t};it.readString=function(e){for(var t="",n=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var i=this.input.charCodeAt(this.pos);if(i===e)break;i===92?(t+=this.input.slice(n,this.pos),t+=this.readEscapedChar(!1),n=this.pos):i===8232||i===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(cd(i)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return t+=this.input.slice(n,this.pos++),this.finishToken(T.string,t)};var GH={};it.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(e){if(e===GH)this.readInvalidTemplateToken();else throw e}this.inTemplateElement=!1};it.invalidStringToken=function(e,t){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw GH;this.raise(e,t)};it.readTmplToken=function(){for(var e="",t=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var n=this.input.charCodeAt(this.pos);if(n===96||n===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===T.template||this.type===T.invalidTemplate)?n===36?(this.pos+=2,this.finishToken(T.dollarBraceL)):(++this.pos,this.finishToken(T.backQuote)):(e+=this.input.slice(t,this.pos),this.finishToken(T.template,e));if(n===92)e+=this.input.slice(t,this.pos),e+=this.readEscapedChar(!0),t=this.pos;else if(cd(n)){switch(e+=this.input.slice(t,this.pos),++this.pos,n){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:e+=`
`;break;default:e+=String.fromCharCode(n);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),t=this.pos}else++this.pos}};it.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(T.invalidTemplate,this.input.slice(this.start,this.pos));case"\r":this.input[this.pos+1]===`
`&&++this.pos;case`
`:case"\u2028":case"\u2029":++this.curLine,this.lineStart=this.pos+1;break}this.raise(this.start,"Unterminated template")};it.readEscapedChar=function(e){var t=this.input.charCodeAt(++this.pos);switch(++this.pos,t){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return Do(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),e){var n=this.pos-1;this.invalidStringToken(n,"Invalid escape sequence in template string")}default:if(t>=48&&t<=55){var i=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],r=parseInt(i,8);return r>255&&(i=i.slice(0,-1),r=parseInt(i,8)),this.pos+=i.length-1,t=this.input.charCodeAt(this.pos),(i!=="0"||t===56||t===57)&&(this.strict||e)&&this.invalidStringToken(this.pos-1-i.length,e?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(r)}return cd(t)?(this.options.locations&&(this.lineStart=this.pos,++this.curLine),""):String.fromCharCode(t)}};it.readHexChar=function(e){var t=this.pos,n=this.readInt(16,e);return n===null&&this.invalidStringToken(t,"Bad character escape sequence"),n};it.readWord1=function(){this.containsEsc=!1;for(var e="",t=!0,n=this.pos,i=this.options.ecmaVersion>=6;this.pos<this.input.length;){var r=this.fullCharCodeAtPos();if(Fh(r,i))this.pos+=r<=65535?1:2;else if(r===92){this.containsEsc=!0,e+=this.input.slice(n,this.pos);var s=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var a=this.readCodePoint();(t?Io:Fh)(a,i)||this.invalidStringToken(s,"Invalid Unicode escape"),e+=Do(a),n=this.pos}else break;t=!1}return e+this.input.slice(n,this.pos)};it.readWord=function(){var e=this.readWord1(),t=T.name;return this.keywords.test(e)&&(t=KO[e]),this.finishToken(t,e)};var _De="8.14.0";Sn.acorn={Parser:Sn,version:_De,defaultOptions:rC,Position:Mg,SourceLocation:Qb,getLineInfo:mH,Node:e2,TokenType:ct,tokTypes:T,keywordTypes:KO,TokContext:gs,tokContexts:zt,isIdentifierChar:Fh,isIdentifierStart:Io,Token:iF,isNewLine:cd,lineBreak:ss,lineBreakG:qIe,nonASCIIwhitespace:pH};function wDe(e,t){return Sn.parse(e,t)}const rF={undefined:"void(0)",Infinity:"Number.POSITIVE_INFINITY",NaN:"Number.NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2"};function dl(e){return typeof e=="number"}const EDe={ecmaVersion:11},oL="$",SDe="d",ADe="d1",CDe="d2",Bn=e=>(t,n)=>n.error(t,e+" not allowed"),kDe=Bn("Aggregate function"),$De=Bn("Window function"),TDe="Invalid argument",sF="Invalid column reference",ODe=sF+" (must be input to an aggregate function)",HH="Invalid function call",FDe="Invalid member expression",MDe="Invalid operator parameter",NDe="Invalid param reference",RDe="Invalid variable reference",IDe="Variable not accessible in operator call",DDe="Unsupported variable declaration",PDe="Unsupported destructuring pattern",YH="Table expressions do not support closures",XH="Use aq.escape(fn) to use a function as-is (including closures)",LDe="use table.params({ name: value }) to define dynamic parameters",zDe="use aq.addFunction(name, fn) to add new op functions",BDe=`
Note: ${YH}. ${XH}, or ${LDe}.`,KH=`
Note: ${YH}. ${XH}, or ${zDe}.`,UDe=`The ${oH} method is not valid in multi-table expressions.`;function jDe(e,t){const n=qDe(t);let i=e.root=n;return e.spec=t,e.tuple=null,e.tuple1=null,e.tuple2=null,e.$param=null,e.$op=0,e.scope=new Set,e.paramsRef=new Map,e.columnRef=new Map,TIe(i)?(WDe(i,e),i=i.body):e.join?(e.scope.add(e.tuple1=ADe),e.scope.add(e.tuple2=CDe),e.scope.add(e.$param=oL)):(e.scope.add(e.tuple=SDe),e.scope.add(e.$param=oL)),ut(i,e,aF),e.root}function qDe(e){try{const t=e.field?VDe(e):Ri(e)?Ro(e):e;return wDe(`expr=(${t})`,EDe).body[0].expression.right}catch{Gt(`Expression parse error: ${e+""}`)}}function VDe(e){const t=JSON.stringify(e+"");return e.table?`(a,b)=>b[${t}]`:`d=>d[${t}]`}const aF={FunctionDeclaration:Bn("Function definitions"),ForStatement:Bn("For loops"),ForOfStatement:Bn("For-of loops"),ForInStatement:Bn("For-in loops"),WhileStatement:Bn("While loops"),DoWhileStatement:Bn("Do-while loops"),AwaitExpression:Bn("Await expressions"),ArrowFunctionExpression:Bn("Function definitions"),AssignmentExpression:Bn("Assignments"),FunctionExpression:Bn("Function definitions"),NewExpression:Bn('Use of "new"'),UpdateExpression:Bn("Update expressions"),VariableDeclarator(e,t){lC(e.id,t)},Identifier(e,t,n){ZH(e,t,n)&&!t.scope.has(e.name)&&t.error(e,RDe,BDe)},CallExpression(e,t){const n=JH(e.callee),i=YG(n)||XG(n);if(i){if((t.join||t.aggregate===!1)&&qO(n)&&kDe(e,t),(t.join||t.window===!1)&&VO(n)&&$De(e,t),t.$op=1,t.ast)uC(e,n,t),e.arguments.forEach(r=>ut(r,t,oC));else{const r=t.op(GDe(t,i,n,e.arguments));Object.assign(e,{type:rH,name:r.id})}return t.$op=0,!1}else HG(n)?uC(e,n,t):t.error(e,HH,KH)},MemberExpression(e,t,n){const{object:i,property:r}=e;if(!bn(Fu,i))return;const{name:s}=i;if(QH(e)&&bn(Fu,r)&&Object.hasOwn(rF,r.name)){nY(e,r.name);return}const a=s===t.tuple?0:s===t.tuple1?1:s===t.tuple2?2:-1;if(a>=0)return uL(e,a,t,eY,n);if(s===t.$param)return uL(e,a,t,YDe);t.paramsRef.has(s)?Rg(e,t.paramsRef.get(s)):t.columnRef.has(s)?tY(i,s,t,e):Object.hasOwn(t.params,s)&&Rg(i,s)}};function uL(e,t,n,i,r){const{property:s,computed:a}=e;let o;if(!a)o=s.name;else if(bn(ld,s))o=s.value;else try{ut(s,n,aF,e),o=n.param(s)}catch{n.error(e,FDe)}return i(e,o,t,n,r),!1}const oC={...aF,VariableDeclarator:Bn("Variable declaration in operator call"),Identifier(e,t,n){ZH(e,t,n)&&t.error(e,IDe)},CallExpression(e,t){const n=JH(e.callee);HG(n)?uC(e,n,t):t.error(e,HH,KH)}};function WDe(e,t){e.generator&&Bn("Generator functions")(e,t),e.async&&Bn("Async functions")(e,t);const{params:n}=e,i=n.length,r=a=>(o,u)=>t.columnRef.set(o,[u,a]),s=(a,o)=>t.paramsRef.set(a,o);i&&(t.join?(lp(t,n[0],"tuple1",r(1)),i>1&&lp(t,n[1],"tuple2",r(2)),i>2&&lp(t,n[2],"$param",s)):(lp(t,n[0],"tuple",r(0)),i>1&&lp(t,n[1],"$param",s))),t.root=e.body}function lp(e,t,n,i){bn(Fu,t)?(e.scope.add(t.name),e[n]=t.name):bn(tH,t)&&t.properties.forEach(r=>{const s=bn(Fu,r.key)?r.key.name:bn(ld,r.key)?r.key.value:e.error(r,TDe);bn(Fu,r.value)||e.error(r.value,PDe),i(r.value.name,s)})}function GDe(e,t,n,i){const r=[],s=[],a=t.param[0]||0,o=a+(t.param[1]||0);return i.forEach((u,l)=>{l<a?(ut(u,e,oC),r.push(e.field(u))):l<o?(ut(u,e,oC),s.push(e.param(u))):e.error(u,MDe)}),{name:n,fields:r,params:s,...e.spec.window||{}}}function JH(e){return bn(Fu,e)?e.name:bn(eH,e)?QH(e)?HDe(e.property.name):e.property.name:null}function QH(e){return bn(Fu,e.object)&&e.object.name==="Math"}function HDe(e){return e==="max"?"greatest":e==="min"?"least":e}function ZH(e,t,n){const{name:i}=e;if(!(bn(eH,n)&&n.property===e)){if(!(bn(nH,n)&&n.key===e))if(t.paramsRef.has(i))Rg(e,t.paramsRef.get(i));else if(t.columnRef.has(i))tY(e,i,t,n);else if(Object.hasOwn(t.params,i))Rg(e,i);else if(Object.hasOwn(rF,i))nY(e,i);else return!0}}function eY(e,t,n,i,r){const s=n===0?i.table:n>0?i.join[n-1]:null,a=s&&s.column(t);s&&!a&&i.error(e,sF),i.aggronly&&!i.$op&&i.error(e,ODe),aH(e,t,n,a,r)}function tY(e,t,n,i){const[r,s]=n.columnRef.get(t);eY(e,r,s,n,i)}function YDe(e,t,n,i){i.params&&!Object.hasOwn(i.params,t)&&i.error(e,NDe),Rg(e,t)}function Rg(e,t){e.type=CIe,e.name=t}function nY(e,t){e.type=EIe,e.name=t,e.raw=rF[t]}function uC(e,t,n){if(t===oH){const i=n.table;i||n.error(e,UDe),uH(e,i,e.arguments.length?e.arguments.map(r=>{const s=n.param(r),a=dl(s)?i.columnName(s):s;return i.column(a)||n.error(r,sF),a}):i.columnNames())}else e.callee={type:AIe,name:t}}function lC(e,t){bn(Fu,e)?t.scope.add(e.name):bn(xIe,e)?e.elements.forEach(n=>lC(n,t)):bn(tH,e)?e.properties.forEach(n=>lC(n.value,t)):t.error(e.id,DDe)}const XDe={[iH]:1,[rH]:1};function Sr(e,t={}){const n=t.generate||Iv,i=t.compiler||XO,r=JDe(t),s={},a={},o=[],u=[];let l=0,c=-1;const f=t.join?i.join:t.index==1?i.expr2:i.expr,d={op(y){const v=KDe(y);return a[v]||(y.id=++c,a[v]=y)},field(y){const v=n(y);return s[v]||(s[v]=++l)},param(y){return bn(ld,y)?y.value:i.param(n(y),r)},value(y,v){o.push(y);const b=v.escape||(t.ast?$Ie(v):f(n(v),r));u.push(b),XDe[v.type]&&b!==v&&Yu(b)&&(b.field=v.name)},error(y,v,b=""){const _=y.start-6,E=y.end-6,S=String(d.spec).slice(_,E);Gt(`${v}: "${S}"${b}`)}};Object.assign(d,t,{params:r});for(const[y,v]of HO(e))d.value(y+"",v.escape?DIe(d,v,r):jDe(d,v));if(t.ast)return{names:o,exprs:u};const p=[];for(const y in s)p[s[y]]=i.expr(y,r);const m=Object.values(a);return m.forEach(y=>y.fields=y.fields.map(v=>p[v])),{names:o,exprs:u,ops:m}}function KDe(e){let t=`${e.name}(${e.fields.concat(e.params).join(",")})`;if(e.frame){const n=e.frame.map(i=>Number.isFinite(i)?Math.abs(i):-1);t+=`[${n},${!!e.peers}]`}return t}function JDe(e){return(e.table?RE(e.table):e.join?{...RE(e.join[1]),...RE(e.join[0])}:{})||{}}function RE(e){return e&&Kn(e.params)?e.params():{}}function oF(e,t){return e&&e.expr?new lL({...e,...t}):new lL(t,e)}class lL{constructor(t,n){this.expr=n,Object.assign(this,t)}toString(){return String(this.expr)}toObject(){return{...this,expr:this.toString(),...Kn(this.expr)?{func:!0}:{}}}}function Bv(e,t,n=0){const i=n?{field:!0,table:n}:{field:!0};return oF(e,t?{expr:t,...i}:i)}function iY(e,t){for(const[n,i]of HO(t))e.set(n,i);return e}function Lo(e,t,n=new Map){return t=dl(t)?e.columnName(t):t,Gs(t)?n.set(t,t):Ri(t)?t.forEach(i=>Lo(e,i,n)):Kn(t)?Lo(e,t(e),n):Yu(t)?iY(n,t):Gt(`Invalid column selection: ${Ro(t)}`),n}function rY(e,t){return e.toObject=t,e}function sY(e){return Ri(e)?e.map(sY):e&&e.toObject?e.toObject():e}function Ig(){return rY(e=>e.columnNames(),()=>({all:[]}))}function aY(...e){return e=e.flat(),rY(t=>{const n=Lo(t,e);return t.columnNames(i=>!n.has(i))},()=>({not:sY(e)}))}function Ps(e,t,n,i={window:!1}){const r=new Map,s=a=>{a=dl(a)?t.columnName(a):a,Gs(a)?r.set(a,Bv(a)):Kn(a)?Lo(t,a).forEach(s):Yu(a)?iY(r,a):Gt(`Invalid ${e} value: ${a+""}`)};return $a(n).forEach(s),i.preparse&&i.preparse(r),Sr(r,{table:t,...i})}function uF(e,...t){return QDe(e,Ps("groupby",e,t.flat()))}function QDe(e,t){return e.create({groups:ZDe(e,t)})}function ZDe(e,{names:t=[],exprs:n=[],ops:i=[]}){const r=t.length;if(r===0)return null;if(r===1&&!e.isFiltered()&&n[0].field){const p=e.column(n[0].field);if(p.groups)return p.groups(t)}let s=Wc(e,i,n);const a=Nv(s),o=e.totalRows(),u=new Uint32Array(o),l={},c=[],f=e.data(),d=e.mask();if(d)for(let p=d.next(0);p>=0;p=d.next(p+1)){const m=a(p,f)+"";u[p]=l[m]??=c.push(p)-1}else for(let p=0;p<o;++p){const m=a(p,f)+"";u[p]=l[m]??=c.push(p)-1}return i.length||(s=s.map(p=>m=>p(m,f))),{keys:u,get:s,names:t,rows:c,size:c.length}}function Ar(e){return e?new cL({...e.data()},e.columnNames()):new cL}class cL{constructor(t,n){this.data=t||{},this.names=n||[]}add(t,n){return this.has(t)||this.names.push(t+""),this.data[t]=n}has(t){return Object.hasOwn(this.data,t)}groupby(t){return this.groups=t,this}new(t){const{data:n,names:i,groups:r=null}=this;return t.create({data:n,names:i,groups:r,filter:null,order:null})}derive(t){return t.create(this)}}function Dg(e,t){return lF(e,Sr(t,{table:e,aggronly:!0,window:!1}))}function lF(e,{names:t,exprs:n,ops:i=[]}){const r=Ar(),s=e.groups();return s&&ZG(r,s),e6e(t,n,s,ud(e,i),r),r.new(e)}function e6e(e,t,n,i=[],r){if(!t.length)return;const s=n?n.size:1,a=(u,l)=>i[u][l],o=e.length;for(let u=0;u<o;++u){const l=t[u];if(l.field!=null)r.add(e[u],i[l.field]);else if(s>1){const c=r.add(e[u],Array(s));for(let f=0;f<s;++f)c[f]=l(f,null,a)}else r.add(e[u],[l(0,null,a)])}}function oY(e,...t){return cF(e,Lo(e,t.flat()))}function cF(e,t){const n=Ar();return t.forEach((i,r)=>{const s=Gs(i)?i:r;if(s){const a=e.column(r)||Gt(`Unrecognized column: ${r}`);n.add(s,a)}}),n.derive(e)}function t6e(e,t){if(!e||!t)return e;const{keys:n,rows:i,size:r}=e,s=new Uint32Array(r);t.scan(c=>s[n[c]]=1);const a=s.reduce((c,f)=>c+f,0);if(a===r)return e;const o=Array(a);let u=0;for(let c=0;c<r;++c)s[c]&&(o[s[c]=u++]=i[c]);const l=new Uint32Array(n.length);return t.scan(c=>l[c]=s[n[c]]),{...e,keys:l,rows:o,size:u}}function n6e(e,t,n,i){const{keys:r,rows:s,size:a}=e;let o=s,u=a,l=null;if(n){l=new Int32Array(a),t(m=>l[r[m]]=1);const p=l.reduce((m,y)=>m+y,0);if(p!==a){o=Array(p),u=0;for(let m=0;m<a;++m)l[m]&&(o[l[m]=u++]=s[m])}}let c=-1;const f=new Uint32Array(i);return t(u!==a?p=>f[++c]=l[r[p]]:p=>f[++c]=r[p]),{...e,keys:f,rows:o,size:u}}function i6e(e,t,n,i){const r=i==="map"||i===!0?jG:i==="entries"?VG:i==="object"?qG:Gt('groups option must be "map", "entries", or "object".'),{names:s}=e.groups(),a=rIe(e.columnNames(),"_");let o=oY(e,{}).reify(t).create({data:{[a]:n}});o=Dg(o,{[a]:BG(a)});for(let u=s.length;--u>=0;)o=Dg(uF(o,s.slice(0,u)),{[a]:r(s[u],a)});return o.get(a)}function r6e(e){return Xb(e)?e.constructor:Array}let cC=class{constructor(t,n,i,r,s,a){const o=Object.freeze({...t});n=n?.slice()??Object.keys(o);const u=n.length?o[n[0]].length:0;this._names=Object.freeze(n),this._data=o,this._total=u,this._nrows=i?.count()??u,this._mask=i??null,this._group=r??null,this._order=s??null,this._params=a,this._index=null,this._partitions=null}create({data:t=void 0,names:n=void 0,filter:i=void 0,groups:r=void 0,order:s=void 0}={}){const a=i!==void 0?i:this.mask();return new this.constructor(t||this._data,n||(t?null:this._names),a,r!==void 0?r:t6e(this._group,i&&a),s!==void 0?s:this._order,this._params)}params(t){return arguments.length?(t&&(this._params={...this._params,...t}),this):this._params}get[Symbol.toStringTag](){if(!this._names)return"Object";const t=this.numRows(),n=this.numCols(),i=r=>r!==1?"s":"";return`Table: ${n} col${i(n)} x ${t} row${i(t)}`+(this.isFiltered()?` (${this.totalRows()} backing)`:"")+(this.isGrouped()?`, ${this._group.size} groups`:"")+(this.isOrdered()?", ordered":"")}isFiltered(){return!!this._mask}isGrouped(){return!!this._group}isOrdered(){return!!this._order}data(){return this._data}mask(){return this._mask}groups(){return this._group}comparator(){return this._order}totalRows(){return this._total}numRows(){return this._nrows}get size(){return this._nrows}numCols(){return this._names.length}columnNames(t){return t?this._names.filter(t):this._names.slice()}columnName(t){return this._names[t]}columnIndex(t){return this._names.indexOf(t)}column(t){return this._data[t]}columnAt(t){return this._data[this._names[t]]}array(t,n=Array){const i=this.column(t),r=new n(this.numRows());let s=-1;return this.scan(a=>r[++s]=i.at(a),!0),r}get(t,n=0){const i=this.column(t);return this.isFiltered()||this.isOrdered()?i.at(this.indices()[n]):i.at(n)}getter(t){const n=this.column(t),i=this.isFiltered()||this.isOrdered()?this.indices():null;if(i)return r=>n.at(i[r]);if(n)return r=>n.at(r);Gt(`Unrecognized column: ${t}`)}object(t=0){return fL(this)(t)}objects(t={}){const{grouped:n,limit:i,offset:r}=t,s=Lo(this,t.columns||Ig()),a=cH(this,s),o=[];if(this.scan((u,l)=>o.push(a(u,l)),!0,i,r),n&&this.isGrouped()){const u=[];return this.scan(l=>u.push(l),!0,i,r),i6e(this,u,o,n)}return o}*[Symbol.iterator](){const t=fL(this),n=this.numRows();for(let i=0;i<n;++i)yield t(i)}*values(t){const n=this.getter(t),i=this.numRows();for(let r=0;r<i;++r)yield n(r)}print(t={}){const n=dl(t)?{limit:+t}:{...t,limit:10},i=this.objects({...n,grouped:!1}),r=`${this[Symbol.toStringTag]}. Showing ${i.length} rows.`;return console.log(r),console.table(i),this}indices(t=!0){if(this._index)return this._index;const n=this.numRows(),i=new Uint32Array(n),r=this.isOrdered(),s=this.mask();let a=-1;if(s)for(let o=s.next(0);o>=0;o=s.next(o+1))i[++a]=o;else for(let o=0;o<n;++o)i[++a]=o;if(t&&r){const{_order:o,_data:u}=this;i.sort((l,c)=>o(l,c,u))}return(t||!r)&&(this._index=i),i}partitions(t=!0){if(this._partitions)return this._partitions;if(!this.isGrouped())return[this.indices(t)];const{keys:n,size:i}=this._group,r=ad(i,()=>[]),s=this._index,a=this.mask(),o=this.numRows();if(s&&this.isOrdered())for(let u=0,l;u<o;++u)l=s[u],r[n[l]].push(l);else if(a)for(let u=a.next(0);u>=0;u=a.next(u+1))r[n[u]].push(u);else for(let u=0;u<o;++u)r[n[u]].push(u);if(t&&!s&&this.isOrdered()){const u=this._order,l=this._data;for(let c=0;c<i;++c)r[c].sort((f,d)=>u(f,d,l))}return(t||!this.isOrdered())&&(this._partitions=r),r}reify(t){const n=t?t.length:this.numRows(),i=this._names;let r,s;if(!t&&!this.isOrdered())if(this.isFiltered())n===this.totalRows()&&(r=this.data());else return this;if(!r){const a=t?u=>t.forEach(u):u=>this.scan(u,!0),o=i.length;r={};for(let u=0;u<o;++u){const l=i[u],c=this.column(l),f=r[l]=new(r6e(c))(n);let d=-1;fl(c)?a(p=>f[++d]=c[p]):a(p=>f[++d]=c.at(p))}this.isGrouped()&&(s=n6e(this.groups(),a,!!t,n))}return this.create({data:r,names:i,groups:s,filter:null,order:null})}scan(t,n,i=1/0,r=0){const s=this._mask,a=this._nrows,o=this._data;let u=r||0;if(u>a)return;const l=Math.min(a,u+i),c=()=>u=this._total;if(n&&this.isOrdered()||s&&this._index){const f=this.indices(),d=this._data;for(;u<l;++u)t(f[u],d,c)}else if(s){let f=l-u+1;for(u=s.nth(u);--f&&u>-1;u=s.next(u+1))t(u,o,c)}else for(;u<l;++u)t(u,o,c)}};function fL(e){let t=e._builder;if(!t){const n=cH(e),i=e.data();if(e.isOrdered()||e.isFiltered()){const r=e.indices();t=s=>n(r[s],i)}else t=r=>n(r,i);e._builder=t}return t}function s6e(e,...t){t=t.flat();const n=e.numRows(),i=e.reify(),r=Ar(i).groupby(i.groups());return t.forEach(s=>{s=s instanceof cC?s:new cC(s),s.numRows()!==n&&Gt("Assign row counts do not match"),s=s.reify(),s.columnNames(a=>r.add(a,s.column(a)))}),r.new(e)}function uY(e,...t){t=t.flat();const n=e.numRows(),i=n+t.reduce((a,o)=>a+o.numRows(),0);if(n===i)return e;const r=[e,...t],s=Ar();return e.columnNames().forEach(a=>{const o=Array(i);let u=0;r.forEach(l=>{const c=l.column(a)||{at:()=>ft};l.scan(f=>o[u++]=c.at(f))}),s.add(a,o)}),s.new(e)}function lY(e,t,{before:n=void 0,after:i=void 0}={}){const r=n!=null,s=i!=null;r||s||Gt("relocate requires a before or after option."),r&&s&&Gt("relocate accepts only one of the before or after options."),t=Lo(e,t);const a=[...Lo(e,r?n:i).keys()],o=r?a[0]:a.pop(),u=new Map;return e.columnNames().forEach(l=>{const c=!t.has(l);if(l===o){s&&c&&u.set(l,l);for(const[f,d]of t)u.set(f,d);if(s)return}c&&u.set(l,l)}),cF(e,u)}function cY(e){return{left(t,n,i,r){for(i==null&&(i=0),r==null&&(r=t.length);i<r;){const s=i+r>>>1;e(t[s],n)<0?i=s+1:r=s}return i},right(t,n,i,r){for(i==null&&(i=0),r==null&&(r=t.length);i<r;){const s=i+r>>>1;e(t[s],n)>0?r=s:i=s+1}return i}}}const hL=cY(WO);function a6e(e,t,n,i,r){let s,a,o,u,l;const c=y=>a[y-1]===a[y],f=i.length,d=r.length,p=i.length?od(["w","r","k"],"{"+N0(i,(y,v)=>`r[_${v}.id][k]=_${v}.value(w,_${v}.get);`)+"}",i):()=>{},m={i0:0,i1:0,index:0,size:0,peer:c,init(y,v,b,_){m.index=m.i0=m.i1=0,m.size=v.length,s=y,a=v,u=b,l=_,o=r?r.map(E=>E.init()):null;for(let E=0;E<f;++E)i[E].init();return m},value(y,v){return v(s[y],e)},step(y){const[v,b]=t,_=m.size,E=m.i0,S=m.i1;m.i0=v!=null?Math.max(0,y-Math.abs(v)):0,m.i1=b!=null?Math.min(_,y+Math.abs(b)+1):_,m.index=y,n&&(m.i0>0&&c(m.i0)&&(m.i0=hL.left(a,a[m.i0])),m.i1<_&&c(m.i1)&&(m.i1=hL.right(a,a[m.i1-1])));for(let A=0;A<d;++A){const $=r[A],C=o[A];for(let M=E;M<m.i0;++M)$.rem(C,s[M],e);for(let M=S;M<m.i1;++M)$.add(C,s[M],e);$.write(C,u,l)}return p(m,u,l),u}};return m}const o6e=e=>(e.frame||[null,null]).map(t=>Number.isFinite(t)?Math.abs(t):null),u6e=e=>!!e.peers;function l6e(e){const{id:t,name:n,fields:i=[],params:r=[]}=e;return{...XG(n).create(...r),get:i.length?i[0]:null,id:t}}function c6e(e,t,n,i={},r){const s=e.data(),a=f6e(r,s),o=a.length,u=od(["r","d","op"],"{"+N0(t,(l,c)=>`_${c}[r] = $${c}(r, d, op);`)+"}",t,n);e.partitions().forEach((l,c)=>{const f=l.length,d=h6e(e,l);for(let m=0;m<o;++m)a[m].init(l,d,i,c);const p=m=>i[m][c];for(let m=0;m<f;++m){for(let y=0;y<o;++y)a[y].step(m);u(l[m],s,p)}})}function f6e(e,t){const n={};return e.forEach(i=>{const r=o6e(i),s=u6e(i),a=`${r},${s}`,{aggOps:o,winOps:u}=n[a]||(n[a]={frame:r,peers:s,aggOps:[],winOps:[]});qO(i.name)?o.push(i):u.push(l6e(i))}),Object.values(n).map(i=>a6e(t,i.frame,i.peers,i.winOps,KG(i.aggOps,i.frame[0]!=null?-1:1)))}function h6e(e,t){if(e.isOrdered()){const n=e.comparator(),i=e.data(),r=t.length,s=new Uint32Array(r);for(let a=1,o=0;a<r;++a)s[a]=n(t[a-1],t[a],i)?++o:o;return s}else return t}function d6e(e){return VO(e.name)||e.frame&&(Number.isFinite(e.frame[0])||Number.isFinite(e.frame[1]))}function p6e(e,t,n={}){const i=fF(e,Sr(t,{table:e}),n);return n.drop||n.before==null&&n.after==null?i:lY(i,Object.keys(t).filter(r=>!e.column(r)),n)}function fF(e,{names:t,exprs:n,ops:i=[]},r={}){const s=e.totalRows(),a=Ar(r.drop?null:e),o=t.map(d=>a.add(d,Array(s))),[u,l]=g6e(i),c=e.isGrouped()?e.groups().size:1,f=ud(e,u,ad(i.length,()=>Array(c)));return l.length?c6e(e,o,n,f,l):m6e(e,o,n,f),a.derive(e)}function g6e(e){const t=[],n=[],i=e.length;for(let r=0;r<i;++r){const s=e[r];s.id=r,(d6e(s)?n:t).push(s)}return[t,n]}function m6e(e,t,n,i){const r=e.mask(),s=e.data(),{keys:a}=e.groups()||{},o=a?(l,c)=>i[l][a[c]]:l=>i[l][0],u=t.length;for(let l=0;l<u;++l){const c=n[l],f=t[l];if(r)for(let d=r.next(0);d>=0;d=r.next(d+1))f[d]=c(d,s,o);else{const d=e.totalRows();for(let p=0;p<d;++p)f[p]=c(p,s,o)}}}function hF(e,t){const n=Sr({p:t},{table:e});let i=n.exprs[0];if(n.ops.length){const r=fF(e,n,{drop:!0}).column("p");i=s=>r.at(s)}return y6e(e,i)}function y6e(e,t){const n=e.totalRows(),i=e.mask(),r=e.data(),s=new zO(n);if(i)for(let a=i.next(0);a>=0;a=i.next(a+1))t(a,r)&&s.set(a);else for(let a=0;a<n;++a)t(a,r)&&s.set(a);return e.create({filter:s})}function n2(e,...t){t=t.flat();const n=uF(e,t.length?t:e.columnNames());return hF(n,"row_number() === 1").ungroup().reify()}function fY(e,t){const n=new Map;return e.scan((i,r)=>{const s=t(i,r);s!=null&&s===s&&n.set(s,i)}),n}function v6e(e,t,n){const i=new Map,r=e.length;for(let s=0;s<r;++s){const a=e[s],o=n(a,t);o!=null&&o===o&&(i.has(o)?i.get(o).push(s):i.set(o,[s]))}return i}function x6e(e,t){const n=new Set(t);return e.filter(i=>n.has(i))}function Uv(e,t,n){const i=new Map;$a(n).forEach((s,a)=>{s=dl(s)?t.columnName(s):s,Gs(s)?i.set(a,Bv(s)):Kn(s)||Yu(s)&&s.expr?i.set(a,s):Gt(`Invalid ${e} key value: ${s+""}`)});const r=Sr(i,{table:t,aggregate:!1,window:!1});return Nv(r.exprs,!0)}function dF(e,t,n){if(n)Gs(n)?n=[n,n]:Ri(n)&&n.length===1&&(n=[n[0],n[0]]);else{const i=x6e(e.columnNames(),t.columnNames());i.length||Gt("Natural join requires shared column names."),n=[i,i]}return n}function hY(e,t,n,i){return n.length!==i.length&&Gt("Mismatched number of join keys"),[Uv("join",e,n),Uv("join",t,i)]}function dY(e,t,n){return gY(e,t,n,{anti:!1})}function pY(e,t,n){return gY(e,t,n,{anti:!0})}function gY(e,t,n,i){n=dF(e,t,n);const r=Ri(n)?hY(e,t,...n.map($a)):Sr({on:n},{join:[e,t]}).exprs[0];return b6e(e,t,r,i)}function b6e(e,t,n,i={}){const r=new zO(e.totalRows());return(Ri(n)?_6e:w6e)(r,e,t,n),i.anti&&r.not().and(e.mask()),e.create({filter:r})}function _6e(e,t,n,[i,r]){const s=fY(n,r);t.scan((a,o)=>{s.get(i(a,o))>=0&&e.set(a)})}function w6e(e,t,n,i){const r=t.numRows(),s=n.numRows(),a=t.data(),o=n.data();if(t.isFiltered()||n.isFiltered()){const u=t.indices(!1),l=n.indices(!1);for(let c=0;c<r;++c){const f=u[c];for(let d=0;d<s;++d)if(i(f,a,l[d],o)){e.set(f);break}}}else for(let u=0;u<r;++u)for(let l=0;l<s;++l)if(i(u,a,l,o)){e.set(u);break}}function E6e(e,...t){if(t=t.flat(),t.length===0)return e;const n=e.columnNames();return n2(t.reduce((i,r)=>pY(i,r.select(n)),e))}function S6e(e,t,n){return mY(e,Ps("unroll",e,t),n&&n.drop?{...n,drop:Ps("unroll",e,n.drop).names}:n)}function mY(e,{names:t=[],exprs:n=[],ops:i=[]},r={}){if(!t.length)return e;const s=r.limit>0?+r.limit:1/0,a=r.index?r.index===!0?"index":r.index+"":null,o=new Set(r.drop),u=Wc(e,i,n),l=Ar(),c=new Set(t),f=[],d=[],p=[];e.columnNames().forEach(S=>{if(!o.has(S)){const A=l.add(S,[]);c.has(S)||(f.push(e.column(S)),d.push(A))}}),t.forEach(S=>{o.has(S)||(l.has(S)||l.add(S,[]),p.push(l.data[S]))});const m=a?l.add(a,[]):null;let y=0;const v=f.length,b=p.length,_=(S,A)=>{for(let $=0;$<v;++$)d[$].length=y+A,d[$].fill(f[$].at(S),y,y+A)},E=m?(S,A)=>{for(let $=0;$<A;++$)m[S+$]=$}:()=>{};if(b===1){const S=u[0],A=p[0];e.scan(($,C)=>{const M=$a(S($,C)),N=Math.min(M.length,s);_($,N);for(let P=0;P<N;++P)A[y+P]=M[P];E(y,N),y+=N})}else e.scan((S,A)=>{let $=0;const C=u.map(M=>{const N=$a(M(S,A));return $=Math.min(Math.max($,N.length),s),N});_(S,$);for(let M=0;M<b;++M){const N=p[M],P=C[M];for(let D=0;D<$;++D)N[y+D]=P[D]}E(y,$),y+=$});return l.new(e)}function A6e(e,t,n){return C6e(e,Ps("fold",e,t),n)}function C6e(e,{names:t=[],exprs:n=[],ops:i=[]},r={}){if(t.length===0)return e;const[s="key",a="value"]=r.as||[],o=Wc(e,i,n);return mY(e,{names:[s,a],exprs:[()=>t,(u,l)=>o.map(c=>c(u,l))]},{...r,drop:t})}function i2(e){return e.isGrouped()?e.create({groups:null}):e}function k6e(e,t,n={}){if(t=Sr(t,{table:e}),t.names.forEach(i=>e.column(i)?0:Gt(`Invalid impute column ${Ro(i)}`)),n.expand){const i={preparse:$6e,window:!1,aggronly:!0},r=Ps("impute",e,n.expand,i),s=lF(i2(e),r);return dL(e,t,r.names,r.names.map(a=>s.get(a,0)))}else return dL(e,t)}function $6e(e){e.forEach((t,n)=>t.field?e.set(n,UG(t+"")):0)}function dL(e,t,n,i){const r=n&&n.length;e=r?T6e(e,n,i):e;const{names:s,exprs:a,ops:o}=t,u=Wc(e,o,a),l=r?null:Ar(e),c=e.totalRows();return s.forEach((f,d)=>{const p=e.column(f),m=r?p:l.add(f,Array(c)),y=u[d];e.scan(v=>{const b=p.at(v);m[v]=Cs(b)?b:y(v)})}),r?e:e.create(l)}function T6e(e,t,n){const i=e.groups(),r=e.data(),s=(i?i.names:[]).concat(t),a=(i?i.get:[]).concat(t.map(m=>e.getter(m))),o=new Set,u=Nv(a);e.scan((m,y)=>o.add(u(m,y)));const l=e.columnNames(),c=Ar(),f=l.map(m=>c.add(m,[]));l.forEach((m,y)=>{const v=r[m],b=f[y];e.scan(_=>b.push(v.at(_)))});const d=Nv(a.map((m,y)=>v=>v[y])),p=od("v","{"+f.map((m,y)=>`_${y}.push(v[$${y}]);`).join("")+"}",f,l.map(m=>s.indexOf(m)));if(i){let m=i.keys.length;const y=n.reduce((b,_)=>b*_.length,i.size),v=new Uint32Array(y+(m-o.size));v.set(i.keys),pL(i,n,(b,_)=>{o.has(d(b))||(p(b),v[m++]=_[0])}),c.groupby({...i,keys:v})}else pL(i,n,m=>{o.has(d(m))||p(m)});return c.new(e)}function pL(e,t,n){const i=e?e.get.length:0,r=e?1:0,s=r+t.length,a=new Int32Array(s),o=new Int32Array(s),u=[];if(e){const{get:c,rows:f,size:d}=e;a[0]=d,u.push((p,m)=>{const y=f[m];for(let v=0;v<i;++v)p[v]=c[v](y)})}t.forEach((c,f)=>{const d=f+i;a[f+r]=c.length,u.push((p,m)=>p[d]=c[m])});const l=Array(i+t.length);for(let c=0;c<s;++c)u[c](l,0);n(l,o);for(let c=s-1;c>=0;){const f=++o[c];f<a[c]?(u[c](l,f),n(l,o),c=s-1):(o[c]=0,u[c](l,0),--c)}}function O6e(e,...t){t=t.flat();const n=e.columnNames();return t.length?n2(t.reduce((i,r)=>dY(i,r.select(n)),e)):e.reify([])}const F6e={aggregate:!1,window:!1},M6e={...F6e,index:1},gL=-1/0;function N6e(e,t,n,i){return Ip(e,t,()=>!0,n,{...i,left:!0,right:!0})}function Ip(e,t,n,i,r={}){n=dF(e,t,n);const s={join:[e,t]};let a;if(Ri(n)){const[o,u]=n.map($a);a=hY(e,t,o,u),i||(i=R6e(e,o,u,r))}else a=Sr({on:n},s).exprs[0],i||(i=[Ig(),Ig()]);return P6e(e,t,a,I6e(e,t,i,s,r&&r.suffix),r)}function R6e(e,t,n,i){const r=[];t.forEach((a,o)=>Gs(a)&&a===n[o]?r.push(a):0);const s=aY(r);if(i.left&&i.right){const a=new Set(r);return[e.columnNames().map(o=>{const u=`[${Ro(o)}]`;return a.has(o)?{[o]:`(a, b) => a${u} == null ? b${u} : a${u}`}:o}),s]}return i.right?[s,Ig()]:[Ig(),s]}function I6e(e,t,n,i,r=[]){if(Ri(n)){let s,a,o,u=n.length;s=a=o={names:[],exprs:[]},u--&&(s=Ps("join",e,n[0],i)),u--&&(a=Ps("join",t,n[1],M6e)),u--&&(o=Sr(n[2],i));const l=new Set,c=new Set(s.names);return a.names.forEach(f=>{c.has(f)&&l.add(f)}),l.size&&(r[0]!==""&&mL(s.names,l,r[0]||"_1"),r[1]!==""&&mL(a.names,l,r[1]||"_2")),{names:s.names.concat(a.names,o.names),exprs:s.exprs.concat(a.exprs,o.exprs)}}else return Sr(n,i)}function mL(e,t,n){e.forEach((i,r)=>t.has(i)?e[r]=i+n:0)}function D6e(e,t){const n=["i","a","j","b"];return od(n,"{"+N0(e,(i,r)=>`_${r}.push($${r}(${n}));`)+"}",e,t)}function P6e(e,t,n,{names:i,exprs:r},s={}){const a=e.data(),o=e.indices(!1),u=o.length,l=new Int32Array(u),c=t.data(),f=t.indices(!1),d=f.length,p=new Int32Array(d),m=i.length,y=Ar(),v=Array(m),b=Array(m);for(let S=0;S<i.length;++S)v[S]=y.add(i[S],[]),b[S]=r[S];const _=D6e(v,b);if((Ri(n)?z6e:L6e)(_,n,a,c,o,f,l,p,u,d),s.left)for(let S=0;S<u;++S)l[S]||_(o[S],a,gL,c);if(s.right)for(let S=0;S<d;++S)p[S]||_(gL,a,f[S],c);return y.new(e)}function L6e(e,t,n,i,r,s,a,o,u,l){for(let c=0;c<u;++c){const f=r[c];for(let d=0;d<l;++d){const p=s[d];t(f,n,p,i)&&(e(f,n,p,i),a[c]=1,o[d]=1)}}}function z6e(e,[t,n],i,r,s,a,o,u,l,c){let f,d,p,m,y,v,b,_,E=e;l>=c?(f=i,d=t,p=o,m=s,y=r,v=n,b=u,_=a):(f=r,d=n,p=u,m=a,y=i,v=t,b=o,_=s,E=($,C,M,N)=>e(M,N,$,C));const S=v6e(_,y,v),A=m.length;for(let $=0;$<A;++$){const C=m[$],M=S.get(d(C,f));if(M){const N=M.length;for(let P=0;P<N;++P){const D=M[P];E(C,f,_[D],y),b[D]=1}p[$]=1}}}function B6e(e,t,n,...i){return n=dF(e,t,n),i=i.length===0?[aY(e.columnNames())]:i.flat(),U6e(e,t,[Uv("lookup",e,n[0]),Uv("lookup",t,n[1])],Ps("lookup",t,i))}function U6e(e,t,[n,i],{names:r,exprs:s,ops:a=[]}){const o=Ar(e),u=e.totalRows();r.forEach(d=>o.add(d,Array(u).fill(ft)));const l=fY(t,i),c=od(["lr","rr","data"],"{"+N0(r,(d,p)=>`_[${p}][lr] = $[${p}](rr, data);`)+"}",r.map(d=>o.data[d]),Wc(t,a,s)),f=t.data();return e.scan((d,p)=>{const m=l.get(n(d,p));m>=0&&c(d,m,f)}),o.derive(e)}const j6e=(e,t,n,i)=>`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${n} : (u > v || v == null) && u != null ? ${i} : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n} : v !== v && u === u ? ${i} : `,q6e=(e,t,n,i,r)=>`(v = ${t}, (u = ${e}) == null && v == null) ? 0 : v == null ? ${i} : u == null ? ${n} : (u = ${r}(u,v)) ? u : `;function V6e(e,t){const n=[],i=[],r=[];let s=null,a="0",o="0";e.isGrouped()&&(s=e.groups().keys,a="ka",o="kb");const{ops:u}=Sr(t,{table:e,value:(p,m)=>{if(n.push(p),m.escape){const y=v=>`fn[${r.length}](${v}, data)`;i.push([y("a"),y("b")]),r.push(m.escape)}else i.push([Iv(m,{index:"a",op:a}),Iv(m,{index:"b",op:o})])},window:!1}),l=ud(e,u),c=(p,m)=>l[p][m],f=n.length;let d="return (a, b) => {"+(c&&e.isGrouped()?"const ka = keys[a], kb = keys[b];":"")+"let u, v; return ";for(let p=0;p<f;++p){const m=t.get(n[p]),y=m.desc?-1:1,[v,b]=i[p];m.collate?(d+=q6e(v,b,-y,y,`${y<0?"-":""}fn[${r.length}]`),r.push(m.collate)):d+=j6e(v,b,-y,y)}return d+="0;};",Function("op","keys","fn","data",d)(c,s,r,e.data())}function W6e(e,...t){return H6e(e,G6e(e,t.flat()))}function G6e(e,t){let n=-1;const i=new Map,r=s=>i.set(++n+"",s);return t.forEach(s=>{const a=s.expr!=null?s.expr:s;if(Yu(a)&&!Kn(a))for(const o in a)r(a[o]);else r(dl(a)?Bv(s,e.columnName(a)):Gs(a)?Bv(s):Kn(a)?s:Gt(`Invalid orderby field: ${s+""}`))}),V6e(e,i)}function H6e(e,t){return e.create({order:t})}function Y6e(e,t,n,i){return K6e(e,Ps("fold",e,t),Ps("fold",e,n,{preparse:X6e,window:!1,aggronly:!0}),i)}function X6e(e){e.forEach((t,n)=>t.field?e.set(n,LG(t+"")):0)}const fC=(e,t)=>e??t;function K6e(e,t,n,i={}){const{keys:r,keyColumn:s}=J6e(e,t,i),a=fC(i.valueSeparator,"_"),o=n.names.length>1?(l,c)=>c+a+r[l]:l=>r[l],u=r.map(l=>ud(e,n.ops.map(c=>{if(c.name==="count"){const d=p=>l===s[p]?1:NaN;return d.toString=()=>l+":1",{...c,name:"sum",fields:[d]}}const f=c.fields.map(d=>{const p=(m,y)=>l===s[m]?d(m,y):NaN;return p.toString=()=>l+":"+d,p});return{...c,fields:f}})));return Q6e(n,o,e.groups(),u).new(e)}function J6e(e,t,n){const i=n.limit>0?+n.limit:1/0,r=fC(n.sort,!0),s=fC(n.keySeparator,"_"),a=Wc(e,t.ops,t.exprs),o=a.length===1?a[0]:(f,d)=>a.map(p=>p(f,d)).join(s),u=Array(e.totalRows());e.scan((f,d)=>u[f]=o(f,d));const l=ud(i2(e),[{id:0,name:"array_agg_distinct",fields:[f=>u[f]],params:[]}])[0][0],c=r?l.sort():l;return{keys:Number.isFinite(i)?c.slice(0,i):c,keyColumn:u}}function Q6e({names:e,exprs:t},n,i,r){const s=i?i.size:1,a=Ar(),o=r.length,u=e.length;let l;const c=(f,d)=>l[f][d];i&&ZG(a,i);for(let f=0;f<u;++f){const d=t[f];if(d.field!=null)for(let p=0;p<o;++p)a.add(n(p,e[f]),r[p][d.field]);else if(s>1)for(let p=0;p<o;++p){l=r[p];const m=a.add(n(p,e[f]),Array(s));for(let y=0;y<s;++y)m[y]=d(y,null,c)}else for(let p=0;p<o;++p)l=r[p],a.add(n(p,e[f]),[d(0,null,c)])}return a}function Z6e(e,t){const n=Ar(),i=e.groups(),{get:r,names:s=[],rows:a,size:o=1}=i||{},u=new Uint32Array(o+1);s.forEach(d=>n.add(d,null));const l=i?QG(e,t,i):[JG(e,t)];t.outputs().map(d=>n.add(d,[]));const c=u.length-1;let f=0;for(let d=0;d<c;++d)f+=u[d+1]=t.write(l[d],n.data,u[d]);if(i){const d=e.data();s.forEach((p,m)=>{const y=n.data[p]=Array(f),v=r[m];for(let b=0,_=0;b<o;++b)y.fill(v(a[b],d),_,_+=u[b+1])})}return n.new(e)}function e5e(e,...t){const n=new Map;return e.columnNames(i=>(n.set(i,i),0)),cF(e,Lo(e,t.flat(),n))}function t5e(e,t,n,i){return(t?i?i5e:n5e:i?s5e:r5e)(e.length,e,n,i)}function n5e(e,t,n){const i=n.length;for(let r=0;r<e;++r)t[r]=n[i*sd()|0];return t}function i5e(e,t,n,i){const r=n.length,s=new Float64Array(r);let a=0;for(let u=0;u<r;++u)s[u]=a+=i(n[u]);const o=cY(WO).right;for(let u=0;u<e;++u)t[u]=n[o(s,a*sd())];return t}function r5e(e,t,n){const i=n.length;if(e>=i)return n;for(let r=0;r<e;++r)t[r]=n[r];for(let r=e;r<i;++r){const s=r*sd();s<e&&(t[s|0]=n[r])}return t}function s5e(e,t,n,i){const r=n.length;if(e>=r)return n;const s=new Float32Array(r),a=new Uint32Array(r);for(let o=0;o<r;++o)a[o]=o,s[o]=-Math.log(sd())/i(n[o]);a.sort((o,u)=>s[o]-s[u]);for(let o=0;o<e;++o)t[o]=n[a[o]];return t}function a5e(e,t=0,n=e.length){let i=n-(t=+t);for(;i;){const r=sd()*i--|0,s=e[i+t];e[i+t]=e[r+t],e[r+t]=s}return e}function o5e(e,t,n={}){return c5e(e,u5e(e,t),l5e(e,n.weight),n)}const yY=e=>t=>e.at(t)||0;function u5e(e,t){return dl(t)?()=>t:yY(lF(e,Sr({size:t},{table:e,window:!1})).column("size"))}function l5e(e,t){return t==null?null:(t=dl(t)?e.columnName(t):t,yY(Gs(t)?e.column(t):fF(e,Sr({w:t},{table:e}),{drop:!0}).column("w")))}function c5e(e,t,n,i={}){const{replace:r,shuffle:s}=i,a=e.partitions(!1);let o=0;t=a.map((c,f)=>{let d=t(f);return o+=d=r?d:Math.min(c.length,d),d});const u=new Uint32Array(o);let l=0;return a.forEach((c,f)=>{const d=t[f],p=u.subarray(l,l+=d);!r&&d===c.length?p.set(c):t5e(p,r,c,n)}),s!==!1&&(a.length>1||!r)&&a5e(u),e.reify(u)}function f5e(e=0,t=1/0){return`${yL(e)} < row_number() && row_number() <= ${yL(t)}`}function yL(e){return e<0?`count() + ${e}`:e}function h5e(e,t=0,n=1/0){if(e.isGrouped())return hF(e,f5e(t,n)).reify();const i=[],r=e.numRows();return t=Math.max(0,t+(t<0?r:0)),n=Math.min(r,Math.max(0,n+(n<0?r:0))),e.scan(s=>i.push(s),!0,n-t,t),e.reify(i)}function d5e(e,t,n){return p5e(e,Ps("spread",e,t),n)}function p5e(e,{names:t,exprs:n,ops:i=[]},r={}){if(t.length===0)return e;const s=t.length===1&&r.as||[],a=r.drop==null?!0:!!r.drop,o=r.limit==null?s.length||1/0:Math.max(1,+r.limit||1),u=Wc(e,i,n),l=Ar(),c=t.reduce((d,p,m)=>d.set(p,m),new Map),f=(d,p)=>{const m=g5e(e,u[d],o),y=m.length;for(let v=0;v<y;++v)l.add(s[v]||`${p}_${v+1}`,m[v])};return e.columnNames().forEach(d=>{c.has(d)?(a||l.add(d,e.column(d)),f(c.get(d),d),c.delete(d)):l.add(d,e.column(d))}),c.forEach(f),l.derive(e)}function g5e(e,t,n){const i=e.totalRows(),r=[];return e.scan((s,a)=>{const o=$a(t(s,a)),u=Math.min(o.length,n);for(;r.length<u;)r.push(Array(i).fill(ft));for(let l=0;l<u;++l)r[l][s]=o[l]}),r}function m5e(e,...t){return n2(uY(e,t.flat()))}function y5e(e){return e.isOrdered()?e.create({order:null}):e}const vY=Uint8Array.of(65,82,82,79,87,49),v5e=Uint8Array.of(255,255,255,255,0,0,0,0),Pg={V1:0,V5:4},x5e={Little:0},J1={NONE:0,Schema:1,DictionaryBatch:2,RecordBatch:3},ne={Dictionary:-1,NONE:0,Null:1,Int:2,Float:3,Binary:4,Utf8:5,Bool:6,Decimal:7,Date:8,Time:9,Timestamp:10,Interval:11,List:12,Struct:13,Union:14,FixedSizeBinary:15,FixedSizeList:16,Map:17,Duration:18,LargeBinary:19,LargeUtf8:20,LargeList:21,RunEndEncoded:22,BinaryView:23,Utf8View:24,ListView:25,LargeListView:26},r2={HALF:0,SINGLE:1,DOUBLE:2},Lg={DAY:0,MILLISECOND:1},Ts={SECOND:0,MILLISECOND:1,MICROSECOND:2,NANOSECOND:3},zg={YEAR_MONTH:0,DAY_TIME:1,MONTH_DAY_NANO:2},xY={Sparse:0,Dense:1},pd=Uint8Array,pF=Uint16Array,gF=Uint32Array,mF=BigUint64Array,yF=Int8Array,bY=Int16Array,gd=Int32Array,md=BigInt64Array,_Y=Float32Array,D0=Float64Array;function b5e(e,t){const n=Math.log2(e)-3;return(t?[yF,bY,gd,md]:[pd,pF,gF,mF])[n]}const _5e=Object.getPrototypeOf(Int8Array);function wY(e){return e instanceof _5e}function EY(e){return Array.isArray(e)||wY(e)}function vF(e){return e===md||e===mF}function xF(e,t){let n=0,i=e.length;if(i<=2147483648)do{const r=n+i>>>1;e[r]<=t?n=r+1:i=r}while(n<i);else do{const r=Math.trunc((n+i)/2);e[r]<=t?n=r+1:i=r}while(n<i);return n}function w5e(e,t=1){return(e*t+7&-8)/t}function E5e(e,t=e.length){const n=w5e(t,e.BYTES_PER_ELEMENT);return e.length>n?e.subarray(0,n):e.length<n?SY(e,n):e}function SY(e,t,n=0){const i=new e.constructor(t);return i.set(e,n),i}function AY(e,t,n){for(;e.length<=t;)e=SY(e,e.length<<1,n?e.length:0);return e}function S5e(e){return e instanceof Date}function A5e(e){return typeof e[Symbol.iterator]=="function"}function CY(e,t,n){if(t(e))return e;throw new Error(n(e))}function P0(e,t,n){return t=Array.isArray(t)?t:Object.values(t),CY(e,i=>t.includes(i),n??(()=>`${e} must be one of ${t}`))}function C5e(e,t){for(const[n,i]of Object.entries(e))if(i===t)return n;return"<Unknown>"}const s2=e=>`Unsupported data type: "${C5e(ne,e)}" (id ${e})`,a2=(e,t,n=!0,i=null)=>({name:e,type:t,nullable:n,metadata:i});function kY(e){return Object.hasOwn(e,"name")&&$Y(e.type)}function $Y(e){return typeof e?.typeId=="number"}function TY(e,t="",n=!0){return kY(e)?e:a2(t,CY(e,$Y,()=>"Data type expected."),n)}const OY=e=>({typeId:e}),k5e=(e,t,n=!1,i=-1)=>({typeId:ne.Dictionary,id:i,dictionary:e,indices:t||bF(),ordered:n}),$5e=()=>OY(ne.Null),pl=(e=32,t=!0)=>({typeId:ne.Int,bitWidth:P0(e,[8,16,32,64]),signed:t,values:b5e(e,t)}),FY=()=>pl(8),MY=()=>pl(16),bF=()=>pl(32),NY=()=>pl(64),T5e=()=>pl(8,!1),O5e=()=>pl(16,!1),F5e=()=>pl(32,!1),M5e=()=>pl(64,!1),RY=(e=2)=>({typeId:ne.Float,precision:P0(e,r2),values:[pF,_Y,D0][e]}),N5e=()=>RY(r2.SINGLE),_F=()=>RY(r2.DOUBLE),R5e=()=>({typeId:ne.Utf8,offsets:gd}),I5e=()=>OY(ne.Bool),D5e=e=>({typeId:ne.Date,unit:P0(e,Lg),values:e===Lg.DAY?gd:md}),P5e=()=>D5e(Lg.DAY),L5e=(e=Ts.MILLISECOND,t=null)=>({typeId:ne.Timestamp,unit:P0(e,Ts),timezone:t,values:md}),z5e=e=>({typeId:ne.List,children:[TY(e)],offsets:gd}),B5e=e=>({typeId:ne.Struct,children:Array.isArray(e)&&kY(e[0])?e:Object.entries(e).map(([t,n])=>a2(t,n))}),U5e=(e,t)=>({typeId:ne.FixedSizeList,stride:t,children:[TY(e)]}),IY=new D0(2),o2=IY.buffer,j5e=new md(o2),wf=new gF(o2),vL=new gd(o2),q5e=new pd(o2);function V5e(e){return e}function xo(e){return BigInt(e)}function DY(e){return vF(e)?xo:V5e}function W5e(e){return e/864e5|0}function G5e(e){return e===Ts.SECOND?t=>xo(t/1e3):e===Ts.MILLISECOND?xo:e===Ts.MICROSECOND?t=>xo(t*1e3):t=>xo(t*1e6)}function H5e([e,t,n]){return vL[0]=e,vL[1]=t,j5e[1]=xo(n),q5e}function Xu(e){if(e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER)throw Error(`BigInt exceeds integer number representation: ${e}`);return Number(e)}function wF(e,t){return Number(e/t)+Number(e%t)/Number(t)}function Y5e(e,t,n,i,r){const s=typeof e=="bigint"?e:xo(Math.trunc(e*r));t[n]=s,t[n+1]=s>>64n,i>2&&(t[n+2]=s>>128n,t[n+3]=s>>192n)}const Df=e=>BigInt.asUintN(64,e);function X5e(e,t){const n=t<<1;let i;return BigInt.asIntN(64,e[n+1])<0?(i=Df(~e[n])|Df(~e[n+1])<<64n,i=-(i+1n)):i=e[n]|e[n+1]<<64n,i}function K5e(e,t){const n=t<<2;let i;return BigInt.asIntN(64,e[n+3])<0?(i=Df(~e[n])|Df(~e[n+1])<<64n|Df(~e[n+2])<<128n|Df(~e[n+3])<<192n,i=-(i+1n)):i=e[n]|e[n+1]<<64n|e[n+2]<<128n|e[n+3]<<192n,i}function J5e(e){if(e!==e)return 32256;IY[0]=e;const t=(wf[1]&2147483648)>>16&65535;let n=wf[1]&2146435072,i=0;return n>=1089470464?wf[0]>0?n=31744:(n=(n&2080374784)>>16,i=(wf[1]&1048575)>>10):n<=1056964608?(i=1048576+(wf[1]&1048575),i=1048576+(i<<(n>>20)-998)>>21,n=0):(n=n-1056964608>>10,i=(wf[1]&1048575)+512>>10),t|n|i&65535}const Q5e=new TextDecoder("utf-8"),Z5e=new TextEncoder;function EF(e){return Q5e.decode(e)}function PY(e){return Z5e.encode(e)}function u2(e){return`${typeof e!="object"||!e?e??null:S5e(e)?+e:EY(e)?`[${e.map(u2)}]`:ePe(e)}`}function ePe(e){let t="",n=-1;for(const i in e)++n>0&&(t+=","),t+=`"${i}":${u2(e[i])}`;return`{${t}}`}const kf=4,IE=2;function LY(e,t){return(e[t>>3]&1<<t%8)!==0}function DE(e,t){return tPe(e,t)<<16>>16}function tPe(e,t){return e[t]|e[t+1]<<8}function Hf(e,t){return e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24}function xL(e,t){return Hf(e,t)>>>0}function nPe(e,t){return Xu(BigInt.asIntN(64,BigInt(xL(e,t))+(BigInt(xL(e,t+kf))<<32n)))}const PE=Symbol("rowIndex");function hC(e,t){class n{constructor(s){this[PE]=s}toJSON(){return BY(e,t,this[PE])}}const i=n.prototype;for(let r=0;r<e.length;++r){if(Object.hasOwn(i,e[r]))continue;const s=t[r];Object.defineProperty(i,e[r],{get(){return s.at(this[PE])},enumerable:!0})}return r=>new n(r)}function zY(e,t){return n=>BY(e,t,n)}function BY(e,t,n){const i={};for(let r=0;r<e.length;++r)i[e[r]]=t[r].at(n);return i}function iPe(e){return e instanceof Jp}class L0{constructor({length:t,nullCount:n,type:i,validity:r,values:s,offsets:a,sizes:o,children:u}){this.length=t,this.nullCount=n,this.type=i,this.validity=r,this.values=s,this.offsets=a,this.sizes=o,this.children=u,(!n||!this.validity)&&(this.at=l=>this.value(l))}get[Symbol.toStringTag](){return"Batch"}at(t){return this.isValid(t)?this.value(t):null}isValid(t){return LY(this.validity,t)}value(t){return this.values[t]}slice(t,n){const i=n-t,r=Array(i);for(let s=0;s<i;++s)r[s]=this.at(t+s);return r}*[Symbol.iterator](){for(let t=0;t<this.length;++t)yield this.at(t)}}lf(L0,"ArrayType",null);class Jp extends L0{constructor(t){super(t);const{length:n,values:i}=this;this.values=i.subarray(0,n)}slice(t,n){return this.nullCount?super.slice(t,n):this.values.subarray(t,n)}[Symbol.iterator](){return this.nullCount?super[Symbol.iterator]():this.values[Symbol.iterator]()}}class l2 extends L0{}lf(l2,"ArrayType",D0);class tn extends L0{}lf(tn,"ArrayType",Array);class UY extends tn{value(t){return null}}class Gc extends l2{value(t){return Xu(this.values[t])}}class rPe extends l2{value(t){const n=this.values[t],i=(n&31744)>>10,r=(n&1023)/1024,s=(-1)**((n&32768)>>15);switch(i){case 31:return s*(r?Number.NaN:1/0);case 0:return s*(r?6103515625e-14*r:0)}return s*2**(i-15)*(1+r)}}class sPe extends tn{value(t){return LY(this.values,t)}}class jY extends L0{constructor(t){super(t);const{bitWidth:n,scale:i}=this.type;this.decimal=n===128?X5e:K5e,this.scale=10n**BigInt(i)}}class qY extends jY{value(t){return wF(this.decimal(this.values,t),this.scale)}}lf(qY,"ArrayType",D0);class VY extends jY{value(t){return this.decimal(this.values,t)}}lf(VY,"ArrayType",Array);class bL extends tn{constructor(t){super(t),this.source=t}value(t){return new Date(this.source.value(t))}}class aPe extends l2{value(t){return 864e5*this.values[t]}}const oPe=Gc;class uPe extends Gc{value(t){return super.value(t)*1e3}}const lPe=Gc;class cPe extends Gc{value(t){return wF(this.values[t],1000n)}}class fPe extends Gc{value(t){return wF(this.values[t],1000000n)}}class hPe extends tn{value(t){return this.values.subarray(t<<1,t+1<<1)}}class dPe extends tn{value(t){const n=this.values,i=t<<4;return Float64Array.of(Hf(n,i),Hf(n,i+4),nPe(n,i+8))}}const WY=({values:e,offsets:t},n)=>e.subarray(t[n],t[n+1]),GY=({values:e,offsets:t},n)=>e.subarray(Xu(t[n]),Xu(t[n+1]));class pPe extends tn{value(t){return WY(this,t)}}class gPe extends tn{value(t){return GY(this,t)}}class mPe extends tn{value(t){return EF(WY(this,t))}}class yPe extends tn{value(t){return EF(GY(this,t))}}class vPe extends tn{value(t){const n=this.offsets;return this.children[0].slice(n[t],n[t+1])}}class xPe extends tn{value(t){const n=this.offsets;return this.children[0].slice(Xu(n[t]),Xu(n[t+1]))}}class bPe extends tn{value(t){const n=this.offsets[t],i=n+this.sizes[t];return this.children[0].slice(n,i)}}class _Pe extends tn{value(t){const n=this.offsets[t],i=n+this.sizes[t];return this.children[0].slice(Xu(n),Xu(i))}}class HY extends tn{constructor(t){super(t),this.stride=this.type.stride}}class wPe extends HY{value(t){const{stride:n,values:i}=this;return i.subarray(t*n,(t+1)*n)}}class EPe extends HY{value(t){const{children:n,stride:i}=this;return n[0].slice(t*i,(t+1)*i)}}function YY({children:e,offsets:t},n){const[i,r]=e[0].children,s=t[n],a=t[n+1],o=[];for(let u=s;u<a;++u)o.push([i.at(u),r.at(u)]);return o}class SPe extends tn{value(t){return YY(this,t)}}class APe extends tn{value(t){return new Map(YY(this,t))}}class XY extends tn{constructor({typeIds:t,...n}){super(n),this.typeIds=t,this.typeMap=this.type.typeMap}value(t,n=t){const{typeIds:i,children:r,typeMap:s}=this;return r[s[i[t]]].at(n)}}class CPe extends XY{value(t){return super.value(t,this.offsets[t])}}class KY extends tn{constructor(t,n=zY){super(t),this.names=this.type.children.map(i=>i.name),this.factory=n(this.names,this.children)}value(t){return this.factory(t)}}class kPe extends KY{constructor(t){super(t,hC)}}class $Pe extends tn{value(t){const[{values:n},i]=this.children;return i.at(xF(n,t))}}class TPe extends tn{setDictionary(t){return this.dictionary=t,this.cache=t.cache(),this}value(t){return this.cache[this.key(t)]}key(t){return this.values[t]}}class JY extends tn{constructor({data:t,...n}){super(n),this.data=t}view(t){const{values:n,data:i}=this,r=t<<4;let s=r+4,a=n;const o=Hf(a,r);return o>12&&(s=Hf(a,r+12),a=i[Hf(a,r+8)]),a.subarray(s,s+o)}}class OPe extends JY{value(t){return this.view(t)}}class FPe extends JY{value(t){return EF(this.view(t))}}class SF{constructor(t,n=t[0]?.type){this.type=n,this.length=t.reduce((s,a)=>s+a.length,0),this.nullCount=t.reduce((s,a)=>s+a.nullCount,0),this.data=t;const i=t.length,r=new Int32Array(i+1);if(i===1){const[s]=t;r[1]=s.length,this.at=a=>s.at(a)}else for(let s=0,a=0;s<i;++s)r[s+1]=a+=t[s].length;this.offsets=r}get[Symbol.toStringTag](){return"Column"}[Symbol.iterator](){const t=this.data;return t.length===1?t[0][Symbol.iterator]():MPe(t)}at(t){const{data:n,offsets:i}=this,r=xF(i,t)-1;return n[r]?.at(t-i[r])}get(t){return this.at(t)}toArray(){const{length:t,nullCount:n,data:i}=this,r=!n&&iPe(i[0]),s=i.length;if(r&&s===1)return i[0].values;const a=!s||n>0?Array:i[0].constructor.ArrayType??i[0].values.constructor,o=new a(t);return r?NPe(o,i):RPe(o,i)}cache(){return this._cache??(this._cache=this.toArray())}}function*MPe(e){for(let t=0;t<e.length;++t){const n=e[t][Symbol.iterator]();for(let i=n.next();!i.done;i=n.next())yield i.value}}function NPe(e,t){for(let n=0,i=0;n<t.length;++n){const{values:r}=t[n];e.set(r,i),i+=r.length}return e}function RPe(e,t){let n=-1;for(let i=0;i<t.length;++i){const r=t[i];for(let s=0;s<r.length;++s)e[++n]=r.at(s)}return e}class AF{constructor(t,n,i=!1){const r=t.fields.map(a=>a.name);this.schema=t,this.names=r,this.children=n,this.factory=i?hC:zY;const s=[];this.getFactory=a=>s[a]??(s[a]=this.factory(r,n.map(o=>o.data[a])))}get[Symbol.toStringTag](){return"Table"}get numCols(){return this.names.length}get numRows(){return this.children[0]?.length??0}getChildAt(t){return this.children[t]}getChild(t){const n=this.names.findIndex(i=>i===t);return n>-1?this.children[n]:void 0}selectAt(t,n=[]){const{children:i,factory:r,schema:s}=this,{fields:a}=s;return new AF({...s,fields:t.map((o,u)=>IPe(a[o],n[u]))},t.map(o=>i[o]),r===hC)}select(t,n){const i=this.names,r=t.map(s=>i.indexOf(s));return this.selectAt(r,n)}toColumns(){const{children:t,names:n}=this,i={};return n.forEach((r,s)=>i[r]=t[s]?.toArray()??[]),i}toArray(){const{children:t,getFactory:n,numRows:i}=this,r=t[0]?.data??[],s=Array(i);for(let a=0,o=-1;a<r.length;++a){const u=n(a);for(let l=0;l<r[a].length;++l)s[++o]=u(l)}return s}*[Symbol.iterator](){const{children:t,getFactory:n}=this,i=t[0]?.data??[];for(let r=0;r<i.length;++r){const s=n(r);for(let a=0;a<i[r].length;++a)yield s(a)}}at(t){const{children:n,getFactory:i,numRows:r}=this;if(t<0||t>=r)return null;const[{offsets:s}]=n,a=xF(s,t)-1;return i(a)(t-s[a])}get(t){return this.at(t)}}function IPe(e,t){return t!=null&&t!==e.name?{...e,name:t}:e}function QY(e,t={}){const{typeId:n,bitWidth:i,precision:r,unit:s}=e,{useBigInt:a,useDate:o,useDecimalBigInt:u,useMap:l,useProxy:c}=t;switch(n){case ne.Null:return UY;case ne.Bool:return sPe;case ne.Int:case ne.Time:case ne.Duration:return a||i<64?Jp:Gc;case ne.Float:return r?Jp:rPe;case ne.Date:return _L(s===Lg.DAY?aPe:oPe,o&&bL);case ne.Timestamp:return _L(s===Ts.SECOND?uPe:s===Ts.MILLISECOND?lPe:s===Ts.MICROSECOND?cPe:fPe,o&&bL);case ne.Decimal:return u?VY:qY;case ne.Interval:return s===zg.DAY_TIME?hPe:s===zg.YEAR_MONTH?Jp:dPe;case ne.FixedSizeBinary:return wPe;case ne.Utf8:return mPe;case ne.LargeUtf8:return yPe;case ne.Binary:return pPe;case ne.LargeBinary:return gPe;case ne.BinaryView:return OPe;case ne.Utf8View:return FPe;case ne.List:return vPe;case ne.LargeList:return xPe;case ne.Map:return l?APe:SPe;case ne.ListView:return bPe;case ne.LargeListView:return _Pe;case ne.FixedSizeList:return EPe;case ne.Struct:return c?kPe:KY;case ne.RunEndEncoded:return $Pe;case ne.Dictionary:return TPe;case ne.Union:return e.mode?CPe:XY}throw new Error(s2(n))}function _L(e,t){return t?class extends t{constructor(i){super(new e(i))}}:e}function dC(e,t,n){e[t]=n,e[t+1]=n>>8,e[t+2]=n>>16,e[t+3]=n>>24}const w1=1024;class DPe{constructor(t){this.sink=t,this.minalign=1,this.buf=new Uint8Array(w1),this.space=w1,this.vtables=[],this.outputBytes=0}offset(){return this.buf.length-this.space}writeInt8(t){this.buf[this.space-=1]=t}writeInt16(t){this.buf[this.space-=2]=t,this.buf[this.space+1]=t>>8}writeInt32(t){dC(this.buf,this.space-=4,t)}writeInt64(t){const n=BigInt(t);this.writeInt32(Number(BigInt.asIntN(32,n>>BigInt(32)))),this.writeInt32(Number(BigInt.asIntN(32,n)))}addInt8(t){ro(this,1,0),this.writeInt8(t)}addInt16(t){ro(this,2,0),this.writeInt16(t)}addInt32(t){ro(this,4,0),this.writeInt32(t)}addInt64(t){ro(this,8,0),this.writeInt64(t)}addOffset(t){ro(this,kf,0),this.writeInt32(this.offset()-t+kf)}addObject(t,n){const i=PPe(this,t);return n?.(i),i.finish()}addVector(t,n,i,r){const s=t?.length;if(!s)return 0;ro(this,kf,n*s),ro(this,i,n*s);for(let a=s;--a>=0;)r(this,t[a]);return this.writeInt32(s),this.offset()}addOffsetVector(t){return this.addVector(t,4,4,(n,i)=>n.addOffset(i))}addString(t){if(t==null)return 0;const n=PY(t),i=n.length;return this.addInt8(0),ro(this,kf,i),this.buf.set(n,this.space-=i),this.writeInt32(i),this.offset()}finish(t){ro(this,this.minalign,kf),this.addOffset(t)}flush(){const{buf:t,sink:n}=this,i=t.subarray(this.space,t.length);n.write(i),this.outputBytes+=i.byteLength,this.minalign=1,this.vtables=[],this.buf=new Uint8Array(w1),this.space=w1}addBuffer(t){const n=t.byteLength;if(!n)return 0;this.sink.write(t),this.outputBytes+=n;const i=(n+7&-8)-n;return this.addPadding(i),n+i}addPadding(t){t>0&&(this.sink.write(new Uint8Array(t)),this.outputBytes+=t)}}function ro(e,t,n){let{buf:i,space:r,minalign:s}=e;t>s&&(e.minalign=t);const a=i.length,o=a-r+n,u=~o+1&t-1;i=AY(i,o+u+t-1,!0),r+=i.length-a;for(let l=0;l<u;++l)i[--r]=0;e.buf=i,e.space=r}function PPe(e,t){const n=Array(t).fill(0),i=e.offset();function r(s){n[s]=e.offset()}return{addInt8(s,a,o){a!=o&&(e.addInt8(a),r(s))},addInt16(s,a,o){a!=o&&(e.addInt16(a),r(s))},addInt32(s,a,o){a!=o&&(e.addInt32(a),r(s))},addInt64(s,a,o){a!=o&&(e.addInt64(a),r(s))},addOffset(s,a,o){a!=o&&(e.addOffset(a),r(s))},finish(){e.addInt32(0);const s=e.offset();let a=t;for(;--a>=0&&n[a]===0;);const o=a+1;for(;a>=0;--a)e.addInt16(n[a]?s-n[a]:0);const u=2;e.addInt16(s-i);const l=(o+u)*IE;e.addInt16(l);let c=0;const{buf:f,vtables:d,space:p}=e;e:for(a=0;a<d.length;++a){const m=f.length-d[a];if(l==DE(f,m)){for(let y=IE;y<l;y+=IE)if(DE(f,p+y)!=DE(f,m+y))continue e;c=d[a];break}}if(c)e.space=f.length-s,dC(f,e.space,c-s);else{const m=e.offset();d.push(m),dC(f,f.length-s,m-s)}return s}}}function ZY(e,t){const{nodes:n,regions:i,variadic:r}=t,s=e.addVector(n,16,8,(u,l)=>(u.writeInt64(l.nullCount),u.writeInt64(l.length),u.offset())),a=e.addVector(i,16,8,(u,l)=>(u.writeInt64(l.length),u.writeInt64(l.offset),u.offset())),o=e.addVector(r,8,8,(u,l)=>u.addInt64(l));return e.addObject(5,u=>{u.addInt64(0,n[0].length,0),u.addOffset(1,s,0),u.addOffset(2,a,0),u.addOffset(4,o,0)})}function LPe(e,t){const n=ZY(e,t.data);return e.addObject(3,i=>{i.addInt64(0,t.id,0),i.addOffset(1,n,0),i.addInt8(2,+t.isDelta,0)})}function CF(e,t){return t?.size>0?e.addOffsetVector(Array.from(t,([n,i])=>{const r=e.addString(`${n}`),s=e.addString(`${i}`);return e.addObject(2,a=>{a.addOffset(0,r,0),a.addOffset(1,s,0)})})):0}function Q1(e,t){switch(P0(t.typeId,ne,s2)){case ne.Dictionary:return KPe(e,t);case ne.Int:return VPe(e,t);case ne.Float:return qPe(e,t);case ne.Decimal:return BPe(e,t);case ne.Date:return zPe(e,t);case ne.Time:return HPe(e,t);case ne.Timestamp:return YPe(e,t);case ne.Interval:return WPe(e,t);case ne.Duration:return UPe(e,t);case ne.FixedSizeBinary:case ne.FixedSizeList:return jPe(e,t);case ne.Map:return GPe(e,t);case ne.Union:return XPe(e,t)}return e.addObject(0)}function zPe(e,t){return e.addObject(1,n=>{n.addInt16(0,t.unit,Lg.MILLISECOND)})}function BPe(e,t){return e.addObject(3,n=>{n.addInt32(0,t.precision,0),n.addInt32(1,t.scale,0),n.addInt32(2,t.bitWidth,128)})}function UPe(e,t){return e.addObject(1,n=>{n.addInt16(0,t.unit,Ts.MILLISECOND)})}function jPe(e,t){return e.addObject(1,n=>{n.addInt32(0,t.stride,0)})}function qPe(e,t){return e.addObject(1,n=>{n.addInt16(0,t.precision,r2.HALF)})}function VPe(e,t){return e.addObject(2,n=>{n.addInt32(0,t.bitWidth,0),n.addInt8(1,+t.signed,0)})}function WPe(e,t){return e.addObject(1,n=>{n.addInt16(0,t.unit,zg.YEAR_MONTH)})}function GPe(e,t){return e.addObject(1,n=>{n.addInt8(0,+t.keysSorted,0)})}function HPe(e,t){return e.addObject(2,n=>{n.addInt16(0,t.unit,Ts.MILLISECOND),n.addInt32(1,t.bitWidth,32)})}function YPe(e,t){const n=e.addString(t.timezone);return e.addObject(2,i=>{i.addInt16(0,t.unit,Ts.SECOND),i.addOffset(1,n,0)})}function XPe(e,t){const n=e.addVector(t.typeIds,4,4,(i,r)=>i.addInt32(r));return e.addObject(2,i=>{i.addInt16(0,t.mode,xY.Sparse),i.addOffset(1,n,0)})}function KPe(e,t){return e.addObject(4,n=>{n.addInt64(0,t.id,0),n.addOffset(1,Q1(e,t.indices),0),n.addInt8(2,+t.ordered,0)})}const JPe=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;function eX(e,t){const{fields:n,metadata:i}=t,r=n.map(o=>tX(e,o)),s=e.addOffsetVector(r),a=CF(e,i);return e.addObject(4,o=>{o.addInt16(0,+!JPe,0),o.addOffset(1,s,0),o.addOffset(2,a,0)})}function tX(e,t){const{name:n,nullable:i,type:r,metadata:s}=t;let{typeId:a}=r,o=0,u=0;if(a!==ne.Dictionary)o=Q1(e,r);else{const p=r.dictionary;a=p.typeId,u=Q1(e,r),o=Q1(e,p)}const l=(r.children||[]).map(p=>tX(e,p)),c=e.addOffsetVector(l),f=CF(e,s),d=e.addString(n);return e.addObject(7,p=>{p.addOffset(0,d,0),p.addInt8(1,+i,0),p.addInt8(2,a,ne.NONE),p.addOffset(3,o,0),p.addOffset(4,u,0),p.addOffset(5,c,0),p.addOffset(6,f,0)})}function QPe(e,t,n,i,r){const s=CF(e,r),a=e.addVector(i,24,8,wL),o=e.addVector(n,24,8,wL),u=eX(e,t);e.finish(e.addObject(5,c=>{c.addInt16(0,Pg.V5,Pg.V1),c.addOffset(1,u,0),c.addOffset(2,o,0),c.addOffset(3,a,0),c.addOffset(4,s,0)}));const l=e.offset();e.addInt32(0),e.addInt32(-1),e.flush(),e.sink.write(new Uint8Array(Int32Array.of(l).buffer)),e.sink.write(vY)}function wL(e,{offset:t,metadataLength:n,bodyLength:i}){return e.writeInt64(i),e.writeInt32(0),e.writeInt32(n),e.writeInt64(t),e.offset()}function LE(e,t,n,i,r){e.finish(e.addObject(5,u=>{u.addInt16(0,Pg.V5,Pg.V1),u.addInt8(1,t,J1.NONE),u.addOffset(2,n,0),u.addInt64(3,i,0)}));const s=8,a=e.offset(),o=a+s+7&-8;r?.push({offset:e.outputBytes,metadataLength:o,bodyLength:i}),e.addInt32(o-s),e.addInt32(-1),e.flush(),e.addPadding(o-a-s)}class ZPe{write(t){}pad(t){this.write(new Uint8Array(t))}finish(){return null}}class eLe extends ZPe{constructor(){super(),this.buffers=[]}write(t){this.buffers.push(t)}finish(){const t=this.buffers,n=t.reduce((r,s)=>r+s.byteLength,0),i=new Uint8Array(n);for(let r=0,s=0;r<t.length;++r)i.set(t[r],s),s+=t[r].byteLength;return i}}const EL="stream",SL="file";function tLe(e,{sink:t,format:n=EL}={}){if(n!==EL&&n!==SL)throw new Error(`Unrecognized Arrow IPC format: ${n}`);const{schema:i,dictionaries:r=[],records:s=[],metadata:a}=e,o=new DPe(t||new eLe),u=n===SL,l=[],c=[];u&&o.addBuffer(vY),i&&LE(o,J1.Schema,eX(o,i),0);for(const f of r){const{data:d}=f;LE(o,J1.DictionaryBatch,LPe(o,f),d.byteLength,l),AL(o,d.buffers)}for(const f of s)LE(o,J1.RecordBatch,ZY(o,f),f.byteLength,c),AL(o,f.buffers);return o.addBuffer(v5e),u&&QPe(o,i,l,c,a),o.sink}function AL(e,t){for(let n=0;n<t.length;++n)e.addBuffer(t[n])}function nLe(e,t){typeof t=="string"&&(t={format:t});const n=e.children;iLe(n);const{dictionaries:i,idMap:r}=sLe(n),s=oLe(n),o={schema:aLe(e.schema,r),dictionaries:i,records:s};return tLe(o,t).finish()}function iLe(e){const t=e[0]?.data.map(n=>n.length);e.forEach(({data:n})=>{if(n.length!==t.length||n.some((i,r)=>i.length!==t[r]))throw new Error("Columns have inconsistent batch sizes.")})}function rLe(){let e=0;const t=[],n=[],i=[],r=[];return{node(s,a){t.push({length:s,nullCount:a})},buffer(s){const a=s.byteLength,o=a+7&-8;n.push({offset:e,length:o}),e+=o,i.push(new Uint8Array(s.buffer,s.byteOffset,a))},variadic(s){r.push(s)},children(s,a){s.children.forEach((o,u)=>{iX(o.type,a.children[u],this)})},done(){return{byteLength:e,nodes:t,regions:n,variadic:r,buffers:i}}}}function sLe(e){const t=[],n=new Map,i=new Map;let r=-1;const s=a=>{if(n.has(a))i.set(a.type,n.get(a));else{n.set(a,++r);for(let o=0;o<a.data.length;++o)t.push({id:r,isDelta:o>0,data:nX([a],o)});i.set(a.type,r)}};return e.forEach(a=>pC(a.data[0],s)),{dictionaries:t,idMap:i}}function pC(e,t){if(e?.type.typeId===ne.Dictionary){const n=e.dictionary;t(n),pC(n.data[0],t)}e?.children?.forEach(n=>pC(n,t))}function aLe(e,t){if(!t.size)return e;const n=s=>{s.typeId===ne.Dictionary&&(s.id=t.get(s.dictionary),r(s)),s.children&&(s.children=s.children.slice()).forEach(i)},i=(s,a,o)=>{const u={...s.type};o[a]={...s,type:u},n(u)},r=s=>{const a={...s.dictionary};s.dictionary=a,n(a)};return e={...e,fields:e.fields.slice()},e.fields.forEach(i),e}function oLe(e){return(e[0]?.data||[]).map((t,n)=>nX(e,n))}function nX(e,t=0){const n=rLe();return e.forEach(i=>{iX(i.type,i.data[t],n)}),n.done()}function iX(e,t,n){const{typeId:i}=e;if(i!==ne.Null)switch(n.node(t.length,t.nullCount),i){case ne.Bool:case ne.Int:case ne.Time:case ne.Duration:case ne.Float:case ne.Date:case ne.Timestamp:case ne.Decimal:case ne.Interval:case ne.FixedSizeBinary:case ne.Dictionary:n.buffer(t.validity),n.buffer(t.values);return;case ne.Utf8:case ne.LargeUtf8:case ne.Binary:case ne.LargeBinary:n.buffer(t.validity),n.buffer(t.offsets),n.buffer(t.values);return;case ne.BinaryView:case ne.Utf8View:n.buffer(t.validity),n.buffer(t.values),n.variadic(t.data.length),t.data.forEach(r=>n.buffer(r));return;case ne.List:case ne.LargeList:case ne.Map:n.buffer(t.validity),n.buffer(t.offsets),n.children(e,t);return;case ne.ListView:case ne.LargeListView:n.buffer(t.validity),n.buffer(t.offsets),n.buffer(t.sizes),n.children(e,t);return;case ne.FixedSizeList:case ne.Struct:n.buffer(t.validity),n.children(e,t);return;case ne.RunEndEncoded:n.children(e,t);return;case ne.Union:{n.buffer(t.typeIds),e.mode===xY.Dense&&n.buffer(t.offsets),n.children(e,t);return}default:throw new Error(s2(i))}}function ts(e){return new rX(e)}let rX=class{constructor(t=pd){this.buf=new t(512)}array(t){return E5e(this.buf,t)}prep(t){t>=this.buf.length&&(this.buf=AY(this.buf,t))}get(t){return this.buf[t]}set(t,n){this.prep(n),this.buf[n]=t}write(t,n){this.prep(n+t.length),this.buf.set(t,n)}};function sX(){return new uLe}class uLe extends rX{set(t){const n=t>>3;this.prep(n),this.buf[n]|=1<<t%8}}class kF{constructor(t,n){this.type=t,this.ctx=n,this.batchClass=n.batchType(t)}init(){return this.index=-1,this}set(t,n){return this.index=n,!1}done(){return null}batch(){const t=new this.batchClass(this.done());return this.init(),t}}class Hs extends kF{constructor(t,n){super(t,n)}init(){return this.nullCount=0,this.validity=sX(),super.init()}set(t,n){this.index=n;const i=t!=null;return i?this.validity.set(n):this.nullCount++,i}done(){const{index:t,nullCount:n,type:i,validity:r}=this;return{length:t+1,nullCount:n,type:i,validity:n?r.array((t>>3)+1):new pd(0)}}}function lLe(){const e=new Map,t=new Set;return{get(n,i){const r=n.id;if(r>=0&&e.has(r))return e.get(r);{const s=cLe(n,i);return r>=0&&e.set(r,s),t.add(s),s}},finish(n){t.forEach(i=>i.finish(n))}}}function cLe(e,t){const n=Object.create(null),i=t.builder(e.dictionary),r=[];i.init();let s=-1;return{type:e,values:i,add(a){return r.push(a),a},key(a){const o=u2(a);let u=n[o];return u===void 0&&(n[o]=u=++s,i.set(a,u)),u},finish(a){const o=e.dictionary,u=new(QY(o,a))(i.done()),l=new SF([u]);r.forEach(c=>c.setDictionary(l))}}}class fLe extends Hs{constructor(t,n){super(t,n),this.dict=n.dictionary(t)}init(){return this.values=ts(this.type.indices.values),super.init()}set(t,n){super.set(t,n)&&this.values.set(this.dict.key(t),n)}done(){return{...super.done(),values:this.values.array(this.index+1)}}batch(){return this.dict.add(super.batch())}}function hLe(e){const t=gC();return e(n=>t.add(n)),t.type()}function gC(){let e=0,t=0,n=0,i=0,r=0,s=0,a=0,o=0,u=0,l=0,c=0,f=1/0,d=-1/0,p=1/0,m=-1/0,y,v,b,_={};return{add(E){if(e++,E==null){t++;return}switch(typeof E){case"string":u++;break;case"number":i++,E<f&&(f=E),E>d&&(d=E),Number.isInteger(E)&&r++;break;case"bigint":s++,y===void 0?y=v=E:(E<y&&(y=E),E>v&&(v=E));break;case"boolean":n++;break;case"object":if(E instanceof Date)a++,+E%864e5===0&&o++;else if(EY(E)){l++;const S=E.length;S<p&&(p=S),S>m&&(m=S),b??=gC(),E.forEach(b.add)}else{c++;for(const S in E)(_[S]??(_[S]=gC())).add(E[S])}}},type(){const E=e-t;return E===0?$5e():r===E?pLe(f,d):i===E?_F():s===E?gLe(y,v):n===E?I5e():o===E?P5e():a===E?L5e():u===E?k5e(R5e()):l===E?dLe(b.type(),p,m):c===E?B5e(Object.entries(_).map(S=>a2(S[0],S[1].type()))):mLe()}}}function dLe(e,t,n){return n===t?U5e(e,t):z5e(e)}function pLe(e,t){const n=Math.max(Math.abs(e)-1,t);return n<128?FY():n<32768?MY():n<2**31?bF():_F()}function gLe(e,t){const n=-e>t?-e-1n:t;if(n>=2**63)throw new Error(`BigInt exceeds 64 bits: ${n}`);return NY()}function mLe(){throw new Error("Mixed types detected, please define a union type.")}class aX extends Hs{constructor(t,n){super(t,n),this.toOffset=DY(t.offsets)}init(){return this.offsets=ts(this.type.offsets),this.values=ts(),this.pos=0,super.init()}set(t,n){const{offsets:i,values:r,toOffset:s}=this;super.set(t,n)&&(r.write(t,this.pos),this.pos+=t.length),i.set(s(this.pos),n+1)}done(){return{...super.done(),offsets:this.offsets.array(this.index+2),values:this.values.array(this.pos+1)}}}class yLe extends Hs{constructor(t,n){super(t,n)}init(){return this.values=sX(),super.init()}set(t,n){super.set(t,n),t&&this.values.set(n)}done(){return{...super.done(),values:this.values.array((this.index>>3)+1)}}}class vLe extends Hs{constructor(t,n){super(t,n),this.scale=10**t.scale,this.stride=t.bitWidth>>6}init(){return this.values=ts(this.type.values),super.init()}set(t,n){const{scale:i,stride:r,values:s}=this;super.set(t,n)&&(s.prep((n+1)*r),Y5e(t,s.buf,n*r,r,i))}done(){const{index:t,stride:n,values:i}=this;return{...super.done(),values:i.array((t+1)*n)}}}class xLe extends Hs{constructor(t,n){super(t,n),this.stride=t.stride}init(){return this.values=ts(),super.init()}set(t,n){super.set(t,n)&&this.values.write(t,n*this.stride)}done(){const{stride:t,values:n}=this;return{...super.done(),values:n.array(t*(this.index+1))}}}class bLe extends Hs{constructor(t,n){super(t,n),this.child=n.builder(this.type.children[0].type),this.stride=t.stride}init(){return this.child.init(),super.init()}set(t,n){const{child:i,stride:r}=this,s=n*r;if(super.set(t,n))for(let a=0;a<r;++a)i.set(t[a],s+a);else i.index=s+r}done(){const{child:t}=this;return{...super.done(),children:[t.batch()]}}}class _Le extends Hs{init(){return this.values=ts(this.type.values),super.init()}set(t,n){if(super.set(t,n)){const i=n<<1;this.values.set(t[0],i),this.values.set(t[1],i+1)}}done(){return{...super.done(),values:this.values.array(this.index+1<<1)}}}class wLe extends Hs{init(){return this.values=ts(),super.init()}set(t,n){super.set(t,n)&&this.values.write(H5e(t),n<<4)}done(){return{...super.done(),values:this.values.array(this.index+1<<4)}}}class oX extends Hs{constructor(t,n,i){super(t,n),this.child=i}init(){this.child.init();const t=this.type.offsets;return this.offsets=ts(t),this.toOffset=DY(t),this.pos=0,super.init()}done(){return{...super.done(),offsets:this.offsets.array(this.index+2),children:[this.child.batch()]}}}class ELe extends oX{constructor(t,n){super(t,n,n.builder(t.children[0].type))}set(t,n){const{child:i,offsets:r,toOffset:s}=this;super.set(t,n)&&t.forEach(a=>i.set(a,this.pos++)),r.set(s(this.pos),n+1)}}class uX extends Hs{constructor(t,n){super(t,n),this.children=t.children.map(i=>n.builder(i.type))}init(){return this.children.forEach(t=>t.init()),super.init()}done(){const{children:t}=this;return t.forEach(n=>n.index=this.index),{...super.done(),children:t.map(n=>n.batch())}}}class SLe extends uX{constructor(t,n){super(t,n),this.setters=this.children.map((i,r)=>{const s=t.children[r].name;return(a,o)=>i.set(a?.[s],o)})}set(t,n){super.set(t,n);const i=this.setters;for(let r=0;r<i.length;++r)i[r](t,n)}}class ALe extends oX{constructor(t,n){super(t,n,new CLe(t.children[0].type,n))}set(t,n){const{child:i,offsets:r,toOffset:s}=this;if(super.set(t,n))for(const a of t)i.set(a,this.pos++);r.set(s(this.pos),n+1)}}class CLe extends uX{set(t,n){super.set(t,n);const[i,r]=this.children;i.set(t[0],n),r.set(t[1],n)}}const kLe={};class $Le extends kF{constructor(t,n){super(t,n),this.children=t.children.map(i=>n.builder(i.type))}init(){return this.pos=0,this.key=null,this.value=kLe,this.children.forEach(t=>t.init()),super.init()}next(){const[t,n]=this.children;t.set(this.index+1,this.pos),n.set(this.value,this.pos++)}set(t,n){if(t!==this.value){const i=u2(t);i!==this.key&&(this.key&&this.next(),this.key=i,this.value=t)}this.index=n}done(){this.next();const{children:t,index:n,type:i}=this;return{length:n+1,nullCount:0,type:i,children:t.map(r=>r.batch())}}}class lX extends kF{constructor(t,n){super(t,n),this.children=t.children.map(i=>n.builder(i.type)),this.typeMap=t.typeMap,this.lookup=t.typeIdForValue}init(){return this.nullCount=0,this.typeIds=ts(yF),this.children.forEach(t=>t.init()),super.init()}set(t,n){const{children:i,lookup:r,typeMap:s,typeIds:a}=this;this.index=n;const o=r(t,n),u=i[s[o]];a.set(o,n),t==null&&++this.nullCount,this.update(t,n,u)}done(){const{children:t,nullCount:n,type:i,typeIds:r}=this,s=this.index+1;return{length:s,nullCount:n,type:i,typeIds:r.array(s),children:t.map(a=>a.batch())}}}class TLe extends lX{update(t,n,i){i.set(t,n),this.children.forEach(r=>{r!==i&&r.set(null,n)})}}class OLe extends lX{init(){return this.offsets=ts(this.type.offsets),super.init()}update(t,n,i){const r=i.index+1;i.set(t,r),this.offsets.set(r,n)}done(){return{...super.done(),offsets:this.offsets.array(this.index+1)}}}class FLe extends aX{set(t,n){super.set(t&&PY(t),n)}}class Qp extends Hs{constructor(t,n){super(t,n),this.values=ts(t.values)}init(){return this.values=ts(this.type.values),super.init()}set(t,n){super.set(t,n)&&this.values.set(t,n)}done(){return{...super.done(),values:this.values.array(this.index+1)}}}class MLe extends Qp{set(t,n){super.set(t==null?t:xo(t),n)}}class zE extends Qp{constructor(t,n,i){super(t,n),this.transform=i}set(t,n){super.set(t==null?t:this.transform(t),n)}}function cX(e={},t=lLe()){return{batchType:n=>QY(n,e),builder(n){return fX(n,this)},dictionary(n){return t.get(n,this)},finish:()=>t.finish(e)}}function fX(e,t=cX()){const{typeId:n}=e;switch(n){case ne.Int:case ne.Time:case ne.Duration:return vF(e.values)?new MLe(e,t):new Qp(e,t);case ne.Float:return e.precision?new Qp(e,t):new zE(e,t,J5e);case ne.Binary:case ne.LargeBinary:return new aX(e,t);case ne.Utf8:case ne.LargeUtf8:return new FLe(e,t);case ne.Bool:return new yLe(e,t);case ne.Decimal:return new vLe(e,t);case ne.Date:return new zE(e,t,e.unit?xo:W5e);case ne.Timestamp:return new zE(e,t,G5e(e.unit));case ne.Interval:switch(e.unit){case zg.DAY_TIME:return new _Le(e,t);case zg.MONTH_DAY_NANO:return new wLe(e,t)}return new Qp(e,t);case ne.List:case ne.LargeList:return new ELe(e,t);case ne.Struct:return new SLe(e,t);case ne.Union:return e.mode?new OLe(e,t):new TLe(e,t);case ne.FixedSizeBinary:return new xLe(e,t);case ne.FixedSizeList:return new bLe(e,t);case ne.Map:return new ALe(e,t);case ne.RunEndEncoded:return new $Le(e,t);case ne.Dictionary:return new fLe(e,t)}throw new Error(s2(n))}function hX(e,t,n={},i){const r=A5e(e)?u=>{for(const l of e)u(l)}:e;t??=hLe(r);const{maxBatchRows:s=1/0,...a}=n;let o;if(t.typeId===ne.Null){let u=0;r(()=>++u),o=NLe(t,u,s)}else{const u=cX(a,i),l=fX(t,u).init(),c=d=>o.push(d.batch());o=[];let f=0;r(d=>{l.set(d,f++),f>=s&&(c(l),f=0)}),f&&c(l),u.finish()}return new SF(o,t)}function NLe(e,t,n){const i=[],r=o=>new UY({length:o,nullCount:o,type:e}),s=Math.floor(t/n);for(let o=0;o<s;++o)i.push(r(n));const a=t%n;return a&&i.push(r(a)),i}function RLe(e,t,n={},i){return!t&&wY(e)?ILe(e,n):hX(r=>e.forEach(r),t,n,i)}function ILe(e,{maxBatchRows:t,useBigInt:n}){const i=e.constructor,r=DLe(i),s=e.length,a=Math.min(t||1/0,s),o=Math.floor(s/a),u=[],l=vF(i)&&!n?Gc:Jp,c=(d,p)=>u.push(new l({length:p-d,nullCount:0,type:r,validity:new pd(0),values:e.subarray(d,p)}));let f=0;for(let d=0;d<o;++d)c(f,f+=a);return f<s&&c(f,s),new SF(u)}function DLe(e){switch(e){case _Y:return N5e();case D0:return _F();case yF:return FY();case bY:return MY();case gd:return bF();case md:return NY();case pd:return T5e();case pF:return O5e();case gF:return F5e();case mF:return M5e()}}function PLe(e,t){const n=[],i=Array.isArray(e)?e:Object.entries(e),r=i[0]?.[1].length,s=i.map(([o,u])=>{if(u.length!==r)throw new Error("All columns must have the same length.");return n.push(a2(o,u.type)),u}),a={version:Pg.V5,endianness:x5e.Little,fields:n,metadata:null};return new AF(a,s,t)}function z0(e,t){return Kn(t)?t(e):t||e.columnNames()}function dX(e,t={}){const{columns:n,limit:i=1/0,offset:r=0,types:s={},...a}=t,o=z0(e,n),u=e.data(),l=r===0&&e.numRows()<=i&&!e.isFiltered()&&!e.isOrdered();return PLe(o.map(c=>{const f=u[c],d=s[c],p=fl(f);let m;if(l&&(p||Kn(f.toArray)))m=RLe(p?f:f.toArray(),d,a);else{const y=p?v=>f[v]:v=>f.at(v);m=hX(v=>e.scan(b=>v(y(b)),!0,i,r),d,a)}return[c,m]}))}function LLe(e,t={}){const{format:n="stream",...i}=t;return nLe(dX(e,i),{format:n})}function Cc(e){return e}function $F(e,t,n=100,i,r){const{start:s=Cc,cell:a,end:o=Cc}=r,u=e.data(),l=t.length;e.scan(c=>{s(c);for(let f=0;f<l;++f){const d=t[f];a(u[d].at(c),d,f)}o(c)},!0,n,i)}function zLe(e,t={}){const n=z0(e,t.columns),i=t.format||{},r=t.delimiter||",",s=t.header??!0,a=new RegExp(`["${r}
\r]`),o=c=>c==null?"":Hu(c)?Kb(c,!0):a.test(c+="")?'"'+c.replace(/"/g,'""')+'"':c,u=n.map(o);let l=s?u.join(r)+`
`:"";return $F(e,n,t.limit||1/0,t.offset,{cell(c,f,d){u[d]=o(i[f]?i[f](c):c)},end(){l+=u.join(r)+`
`}}),l}function BLe(e,t,n={}){for(const i in e)n[i]=t(e[i],i);return n}function ULe(e){return e.getUTCHours()===0&&e.getUTCMinutes()===0&&e.getUTCSeconds()===0&&e.getUTCMilliseconds()===0}function jLe(e,t={}){let n=0,i=0,r=0,s=0,a=0,o=0;return e(u=>{if(++n,u==null){++i;return}const l=typeof u;if(l==="object"&&Hu(u))++r,ULe(u)&&++s;else if(l==="number"&&(++a,u===u&&(u|0)!==u)){const c=u+"",f=c.indexOf(".");if(f>=0){const d=c.indexOf("e"),p=d>0?d:c.length;o=Math.max(o,p-f-1)}}}),{align:(i+a+r)/n>.5?"r":"l",format:{utc:r===s,digits:Math.min(o,t.maxdigits||6)}}}function pX(e,t,n){const i=n.format||{},r=n.align||{},s={},a={};return t.forEach(o=>{const u=jLe(qLe(e,o),n);a[o]=r[o]||u.align,s[o]=i[o]||u.format}),{align:a,format:s}}function qLe(e,t){const n=e.column(t);return i=>e.scan(r=>i(n.at(r)))}function gX(e,t={}){if(Kn(t))return t(e)+"";const n=typeof e;if(n==="object"){if(Hu(e))return t.utc?Kb(e):NG(e);{const i=JSON.stringify(e,(s,a)=>Xb(a)?Array.from(a):a),r=t.maxlen||30;return i.length>r?i.slice(0,28)+"…"+(i[0]==="["?"]":"}"):i}}else if(n==="number"){const i=t.digits||0;let r;return e!==0&&((r=Math.abs(e))>=1e18||r<Math.pow(10,-i))?e.toExponential(i):e.toFixed(i)}else return e+""}function VLe(e,t={}){const n=z0(e,t.columns),{align:i,format:r}=pX(e,n,t),s=WLe(t),a=t.null,o=y=>y==="c"?"center":y==="r"?"right":"left",u=y=>y.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),l=(y,v)=>u(gX(y,v)),c=a?(y,v)=>y==null?a(y):l(y,v):l;let f=-1,d=-1;const p=(y,v,b)=>{const _=b?o(i[v]):"",E=s[y]&&s[y](v,d,f)||"",S=(_?`text-align: ${_};`+(E?" ":""):"")+E;return`<${y}${S?` style="${S}"`:""}>`};let m=p("table")+p("thead")+p("tr",f)+n.map(y=>`${p("th",y,1)}${y}</th>`).join("")+"</tr></thead>"+p("tbody");return $F(e,n,t.limit,t.offset,{start(y){f=y,++d,m+=p("tr")},cell(y,v){m+=p("td",v,1)+c(y,r[v])+"</td>"},end(){m+="</tr>"}}),m+"</tbody></table>"}function WLe(e){return BLe(e.style,t=>Kn(t)?t:()=>t)}const CL={},Ef={},E1=34,cp=10,kL=13,GLe="columns",HLe="ndjson",YLe=e=>Hu(e)?Kb(e,!0):e;function XLe(e,{type:t,columns:n,format:i={},limit:r,offset:s}={}){const a=z0(e,n),o=a.map(l=>i[l]||YLe),u=l=>e.scan(l,!0,r,s);return t===GLe?KLe(e,a,o,u):JLe(e,a,o,u,t===HLe)}function KLe(e,t,n,i){let r="{";return t.forEach((s,a)=>{r+=(a?",":"")+JSON.stringify(s)+":[";const o=e.column(s),u=n[a];let l=-1;i(c=>{const f=o.at(c);r+=(++l?",":"")+JSON.stringify(u(f))}),r+="]"}),r+"}"}function JLe(e,t,n,i,r=!1){const s=t.length,a=t.map(d=>`"${d}":`),o=t.map(d=>e.column(d)),u=r?d=>d.replaceAll(`
`,""):Cc,l=r?`
`:",";let c=r?"":"[",f=-1;return i(d=>{const p=[];for(let m=0;m<s;++m)p.push(a[m]+JSON.stringify(n[m](o[m].at(d))));c+=(++f?l:"")+u(`{${p.join(",")}}`)}),c+(r?"":"]")}function QLe(e,t={}){const n=z0(e,t.columns),{align:i,format:r}=pX(e,n,t),s=u=>u==="c"?":-:":u==="r"?"-:":":-",a=u=>u.replace(/\|/g,"\\|");let o="|"+n.map(a).join("|")+`|
|`+n.map(u=>s(i[u])).join("|")+`|
`;return $F(e,n,t.limit,t.offset,{start(){o+="|"},cell(u,l){o+=a(gX(u,r[l]))+"|"},end(){o+=`
`}}),o}class mX extends cC{assign(...t){return s6e(this,...t)}count(t={}){const{as:n="count"}=t;return Dg(this,{[n]:zG()})}derive(t,n){return p6e(this,t,n)}filter(t){return hF(this,t)}slice(t,n){return h5e(this,t,n)}groupby(...t){return uF(this,...t)}orderby(...t){return W6e(this,...t)}relocate(t,n){return lY(this,$a(t),n)}rename(...t){return e5e(this,...t)}reduce(t){return Z6e(this,t)}rollup(t){return Dg(this,t)}sample(t,n){return o5e(this,t,n)}select(...t){return oY(this,...t)}ungroup(){return i2(this)}unorder(){return y5e(this)}dedupe(...t){return n2(this,...t)}impute(t,n){return k6e(this,t,n)}fold(t,n){return A6e(this,t,n)}pivot(t,n,i){return Y6e(this,t,n,i)}spread(t,n){return d5e(this,t,n)}unroll(t,n){return S6e(this,t,n)}lookup(t,n,...i){return B6e(this,t,n,...i)}join(t,n,i,r){return Ip(this,t,n,i,r)}join_left(t,n,i,r){const s={...r,left:!0,right:!1};return Ip(this,t,n,i,s)}join_right(t,n,i,r){const s={...r,left:!1,right:!0};return Ip(this,t,n,i,s)}join_full(t,n,i,r){const s={...r,left:!0,right:!0};return Ip(this,t,n,i,s)}cross(t,n,i){return N6e(this,t,n,i)}semijoin(t,n){return dY(this,t,n)}antijoin(t,n){return pY(this,t,n)}concat(...t){return uY(this,...t)}union(...t){return m5e(this,...t)}intersect(...t){return O6e(this,...t)}except(...t){return E6e(this,...t)}toArrow(t){return dX(this,t)}toArrowIPC(t){return LLe(this,t)}toCSV(t){return zLe(this,t)}toHTML(t){return VLe(this,t)}toJSON(t){return XLe(this,t)}toMarkdown(t){return QLe(this,t)}}function ZLe(e){const t=e.slice(-3).toLowerCase();return t===".gz"?"gzip":t===".zz"?"deflate":null}async function e4e(e,{fetch:t=void 0,decompress:n=ZLe(e)}={}){const i=await fetch(e,t).then(r=>r.body);return n?i.pipeThrough(new DecompressionStream(n)):i}function t4e(e){if(Kn(e[Symbol.asyncIterator]))return e[Symbol.asyncIterator]();{const t=e.getReader();return{next(){return t.read()},[Symbol.asyncIterator](){return this}}}}function n4e(e){return e.slice(1,-1).replace(/""/g,'"')}function i4e(e=","){e.length!==1&&Gt(`Text delimiter should be a single character, found "${e}"`);const t=e.charCodeAt(0);let n=0,i=0,r=!1,s=!1,a=!1,o=!1,u=null,l=null,c=[];function f(p){l=l?l+p:p}function d(){if(r)return r=!1,CL;const p=n;let m;if(a||u.charCodeAt(p)===E1){let v=o&&u.charCodeAt(p)!==E1;if(o=!1,a=!0,!v){for(;++n<i;)if(u.charCodeAt(n)===E1)if(++n<i){if(u.charCodeAt(n)!==E1){v=!0;break}}else return f(u.slice(p,i)),o=!0,Ef;if(!v)return f(u.slice(p,i)),Ef}const b=n4e((l??"")+u.slice(p,n));return a=!1,l=null,n>=i?(l=b,Ef):(m=u.charCodeAt(n++),m===cp?r=!0:m===kL&&(r=!0,n>=i?s=!0:u.charCodeAt(n)===cp&&++n),b)}let y;for(;n<i;){if(m=u.charCodeAt(y=n++),m===cp)r=!0;else if(m===kL)r=!0,n>=i?s=!0:u.charCodeAt(n)===cp&&++n;else if(m!==t)continue;return u.slice(p,y)}return f(u.slice(p,i)),Ef}return{start(){},transform(p,m){u=p,i=u.length,n=0;const y=[];let v;if(s&&(u.charCodeAt(n)===cp&&++n,s=!1),l!=null)if((v=d())===Ef){m.enqueue(y);return}else c.push((l??"")+v),l=null;for(;;)if((v=d())===Ef){m.enqueue(y);return}else v===CL?(y.push(c),c=[]):c.push(v)},flush(p){(c.length||l)&&(l!=null&&c.push(l),p.enqueue([c]))}}}function r4e(e,t,n){return e>0?t?(i,r)=>r<e||n(i).startsWith(t):(i,r)=>r<e:t?i=>n(i).startsWith(t):null}function s4e(e,t,n=Cc){const i=r4e(e,t,n);if(!i)return null;let r=0;return{start(){},flush(){},transform(s,a){const o=s.length,u=new zO(o);for(let l=0;l<s.length;++l,++r)i(s[l],r)&&u.set(l);a.enqueue(u.count()?s.filter((l,c)=>!u.get(c)):s)}}}const a4e=[e=>e==="true"||e==="false",e=>e!=="false"],$L=[e=>e==="NaN"||(e=+e)===e,e=>+e],o4e=[RG,e=>new Date(Date.parse(e))];function u4e(e){return e&&e!=="."?$L.map(t=>n=>t(n&&n.replace(e,"."))):$L}function l4e(e,t){const{decimal:n,limit:i=e.length}=t,r=[a4e,u4e(n),o4e],s=r.length;for(let a=0;a<s;++a){const[o,u]=r[a];if(c4e(e,o,i))return u}return Cc}function c4e(e,t,n){for(let i=0;i<n;++i){const r=e[i];if(r!=null&&!t(r))return!1}return!0}function f4e(e,t){let n=e;return t.forEach(i=>{i&&(n=n.pipeThrough(new TransformStream(i)))}),n}function h4e(e,t){const n={};return e.forEach((i,r)=>n[i]=t[r]),new mX(n,e)}async function d4e(e,t,n={}){const i=f4e(e,t),r=+n.autoMax||1e3,s=t4e(i),a=[];let o=0;for(;o<r;){const d=await s.next(),p=d.value;if(p?.length>0&&(a.push(p),o+=p.length),d.done)break}const{names:u,values:l,parsers:c}=p4e(a,n),f=u.length;for await(const d of s)for(let p=0;p<d.length;++p){const m=d[p];for(let y=0;y<f;++y)l[y].push(m[y]?c[y](m[y]):null)}return h4e(u,l)}function p4e(e,t){const[n]=e,i=n[0].length,r=+t.autoMax||1e3,s=ad(i,()=>[]);let a=t.header!==!1?n.shift():t.names;a=a?a.length<i?[...a,TL(i,a.length)]:a:TL(i);for(const u of e)for(let l=0;l<u.length;++l){const c=u[l];for(let f=0;f<i;++f)s[f].push(c[f]===""?null:c[f])}const o=g4e(a,s,{...t,limit:r});return o.forEach((u,l)=>{if(u===Cc)return;const c=s[l];for(let f=0;f<c.length;++f)c[f]!=null&&(c[f]=u(c[f]))}),{names:a,values:s,parsers:o}}function TL(e,t=0){return ad(e-t,n=>`col${n+t+1}`)}function g4e(e,t,n){const{parse:i={}}=n,r=n.autoType===!1;return e.map((s,a)=>Kn(i[s])?i[s]:r?Cc:l4e(t[a],n))}async function m4e(e,t){return(await e4e(e,t)).pipeThrough(new TextDecoderStream)}async function y4e(e,t){return d4e(e,x4e(t),t)}async function v4e(e,t){return y4e(await m4e(e,t),t)}function x4e({delimiter:e=",",skip:t=0,comment:n=void 0}={}){return[i4e(e),s4e(t,n,i=>i[0])]}function OL(e,t={}){const n=`d[${JSON.stringify(e)}]`,{maxbins:i,nice:r,minstep:s,step:a,offset:o}=t,u=[i,r,s,a];let l=u.length;for(;l&&u[--l]==null;)u.pop();const c=u.length?", "+u.map(f=>f+"").join(", "):"";return`d => op.bin(${n}, ...op.bins(${n}${c}), ${o||0})`}function b4e(e){return oF(e,{escape:!0,toString(){Gt("Escaped values can not be serialized.")}})}function _4e(e,t,n){return oF(e,{window:{frame:t||[-1/0,0],peers:!1}})}function FL(e,t){return Dg(i2(e),{_:t}).get("_")}function w4e(e,t){const n=i=>Gt(`Illegal argument type: ${i||typeof e}`);return e instanceof Map?ML(e.entries(),t):Hu(e)?n("Date"):Mv(e)?n("RegExp"):Gs(e)?n():Ri(e)?E4e(e,t):Kn(e[Symbol.iterator])?S4e(e,t):Yu(e)?ML(Object.entries(e),t):n()}function ML(e,t=["key","value"]){const n=[],i=[];for(const[s,a]of e)n.push(s),i.push(a);const r={};return t[0]&&(r[t[0]]=n),t[1]&&(r[t[1]]=i),r}function E4e(e,t){const n=e.length,i={},r=s=>i[s]=Array(n);if(n){t=t||Object.keys(e[0]);const s=t.map(r),a=s.length;for(let o=0;o<n;++o){const u=e[o];for(let l=0;l<a;++l)s[l][o]=u[t[l]]}}else t&&t.forEach(r);return i}function S4e(e,t){const n={},i=a=>n[a]=[];let r,s;for(const a of e){r||(t=t||Object.keys(a),r=t.map(i),s=r.length);for(let o=0;o<s;++o)r[o].push(a[t[o]])}return!r&&t&&t.forEach(i),n}function NL(e,t){return new mX(w4e(e,t),t)}const A4e=fie("DataSourcesStore",()=>{const e=dr({}),t=dr(!0);async function n(u){t.value=!0;const l=u.map(c=>i(c));await Promise.all(l),t.value=!1}async function i(u){if(r(u.name))return;const l=await v4e(u.source);e.value[u.name]={source:u,dest:l}}function r(u){return u in e.value?e.value[u]??null:null}function s(u,l){if(t.value)return null;const c=new Map;for(const d of u){const p=r(d);if(p===null)throw new Error(`key not found in data sources: [${d}]`);c.set(d,NL(p.dest.reify()))}return a(c,l??[]).objects()}function a(u,l){console.log("perform data transforations");const c=u.keys().next().value??"",f=u.get(c);if(!f)throw new Error("table not found");const d={key:c,table:f},p=y=>{const v=y?u.get(y):d.table;if(!v)throw new Error("in table not found");return v},m=y=>{y.out?d.key=y.out:y.in&&!Array.isArray(y.in)&&(d.key=y.in),u.set(d.key,d.table)};for(const y of l){if("groupby"in y){const v=p(y.in);Array.isArray(y.groupby)?d.table=v.groupby(...y.groupby):d.table=v.groupby(y.groupby)}else if("binby"in y){const v=p(y.in),{field:b,bins:_=10,nice:E=!0}=y.binby,{bin_start:S="start",bin_end:A="end"}=y.binby.output??{bin_start:"start",bin_end:"end"},$={};$[S]=OL(b,{maxbins:_,nice:E}),$[A]=OL(b,{maxbins:_,nice:E,offset:1}),d.table=v.groupby($)}else if("rollup"in y){const v=p(y.in),b={},_=[];for(const[E,S]of Object.entries(y.rollup))b[E]=o(S),S.op==="frequency"&&_.push(E);d.table=v.rollup(b);for(const E of _){const S={};S[E]=(A,$)=>A[$.freqKey]/su.sum(A[$.freqKey]),d.table=d.table.params({freqKey:E}).derive(S)}}else if("orderby"in y){const v=p(y.in);d.table=v.orderby(y.orderby)}else if("derive"in y){const v=p(y.in),b=XMe.cloneDeep(y.derive);for(const[_,E]of Object.entries(b))typeof E!="string"&&(b[_]=_4e(E.rolling.expression,E.rolling.window));d.table=v.derive(b)}else if("filter"in y){const v=p(y.in);d.table=v.filter(y.filter)}else if("join"in y){const[v,b]=y.in,_=u.get(v),E=u.get(b);if(!_||!E)throw new Error("join table not found");d.table=_.join(E,y.join.on)}else if("kde"in y){const v=p(y.in),{field:b,samples:_}=y.kde;let{bandwidth:E}=y.kde;E==null&&(E=FG(v.array(b),P=>P)),E=E??1;const{sample:S="sample",density:A="density"}=y.kde.output??{sample:"sample",density:"density"};let $;const C=FL(v,su.min(b))-E*3,M=FL(v,su.max(b))+E*3;console.log({minVal:C,maxVal:M});const N=v.partitions();for(let P=0;P<N.length;P++){const D=N[P];if(!D)throw new Error("partition is undefined");const W=D.map(R=>v.get(b,R)),q=GMe(W,{bandwidth:E,bins:_,extent:[C,M]}).points();let z=NL(q);if(z=z.rename({x:S,y:A}),v.isGrouped()){const R=v.groups();for(let U=0;U<R.names.length;U++){const G=R.names[U];if(G==null)throw new Error("name is undefined");const Z=R.get[U],J=R.rows[P];if(J==null)throw new Error("rowIndex is undefined");const he=Z(J);z=z.derive({[G]:b4e(he)})}}$?$=$.concat(z):$=z}if(!$)throw new Error("kdeTable is undefined");d.table=$}m(y)}return d.table}function o(u){switch(u.op){case"count":return su.count();case"min":if(!u.field)throw new Error("Field is required for min operation");return su.min(u.field);case"max":if(!u.field)throw new Error("Field is required for max operation");return su.max(u.field);case"mean":return su.mean(u.field);case"frequency":return su.count();default:throw new Error("unsupported Aggregate Function"+JSON.stringify(u))}}return{dataSources:e,loading:t,initDataSources:n,getDataObject:s}}),C4e={key:1},k4e=jv({__name:"ParserComponent",props:{spec:{}},setup(e){const t=A4e(),{loading:n}=hie(t),i=e,r=dr(null),s=dr(!1),a=dr("");RL(()=>{o()});async function o(){r.value=zMe(i.spec),await t.initDataSources(r.value.source),u()}Zp(()=>i.spec,()=>{o()}),Zp(n,()=>u());function u(){r.value&&l(r.value)&&(a.value=c(r.value),s.value=!0)}function l(d){return!d.representation.map(p=>p.mark).includes("row")}function c(d){const p={$schema:"https://vega.github.io/schema/vega-lite/v5.json",data:{values:[]}};try{p.data.values=t.getDataObject(d.source.map(v=>v.name),d.transformation)}catch(v){console.error("Failed to complete data transformation",v)}f.value=p.data.values;const m=d.representation;if(!Array.isArray(m))throw new Error("invalid spec passed to vega conversion");const y=m.map(v=>{const b=Array.isArray(v.mapping)?v.mapping:[v.mapping],_={};for(const E of b){const{encoding:S}=E;"value"in E?_[S]={value:E.value}:_[S]={field:E.field,type:E.type},(S==="x"||S==="y"||S==="size")&&(_[S].scale={zero:!1}),v.mark==="area"&&S==="y"&&(_[S].stack=!1)}return{mark:v.mark,encoding:_}});return p.layer=y,JSON.stringify(p)}const f=dr();return(d,p)=>die(t).loading?(ca(),Yf("p",C4e,"Loading...")):(ca(),Yf(IL,{key:0},[s.value?(ca(),Z1(PMe,{key:0,spec:a.value},null,8,["spec"])):(ca(),Z1(LMe,{key:1}))],64))}}),$4e={key:1},T4e=jv({__name:"EditorPage",setup(e){const t={automaticLayout:!0,formatOnType:!0,formatOnPaste:!0},n=dr(`{
  "source": {
    "name": "donors",
    "source": "./data/example_donors.csv"
  },
  "representation": {
    "mark": "point",
    "mapping": [
      { "encoding": "y", "field": "height", "type": "quantitative" },
      { "encoding": "x", "field": "weight", "type": "quantitative" }
    ]
  }
}`),i=pie();if(i.query.spec)try{n.value=xie.decompressFromEncodedURIComponent(i.query.spec)}catch(c){console.error("Failed to decode spec from URL parameter:",c)}const r=gie(),s=dr(50);function a(c){r.value=c}const o=ao(()=>JSON.parse(n.value)),u=ao(()=>{try{return JSON.parse(n.value),""}catch(c){return c instanceof Error?c.message:"Error parsing specification."}}),l=ao(()=>{try{return JSON.parse(n.value),!0}catch{return!1}});return(c,f)=>{const d=mie("vue-monaco-editor");return ca(),Z1(wie,{class:"flex row"},{default:R_(()=>[sR($ie,{modelValue:s.value,"onUpdate:modelValue":f[1]||(f[1]=p=>s.value=p),class:"flex-grow-1 q-mt-lg"},{before:R_(()=>[sR(d,{value:n.value,"onUpdate:value":f[0]||(f[0]=p=>n.value=p),language:"json",theme:"vs-light",options:t,onMount:a},null,8,["value"])]),after:R_(()=>[l.value?(ca(),Z1(k4e,{key:0,spec:o.value},null,8,["spec"])):(ca(),Yf("div",$4e,DL(u.value),1))]),_:1},8,["modelValue"])]),_:1})}}}),S8e=PL(T4e,[["__scopeId","data-v-681dae78"]]);export{S8e as default};
