var Zhe=Object.defineProperty;var Jhe=(e,t,n)=>t in e?Zhe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var rf=(e,t,n)=>Jhe(e,typeof t!="symbol"?t+"":t,n);import{Q as n3,c as efe,b as i3}from"./QBtn-CKFzgGSf.js";import{u as tfe,r as Qe,a as Cc,w as Yt,c as Le,g as es,Q as nfe,i as ife,f as jp,R as rfe,S as sfe,U as _T,m as OT,n as ca,y as ofe,z as afe,h as ct,V as fd,T as xk,l as lfe,W as Er,q as G0,X as dv,Y as r3,Z as s3,o as j4,$ as ufe,x as Xc,a0 as cfe,k as dfe,a1 as hfe,a2 as ffe,a3 as LF,a4 as NF,v as pfe,a5 as Oy,a6 as Rk,a7 as gfe,d as mh,L as hi,N as Gv,J as K4,a8 as Ek,O as O1,H as Dn,M as mfe,a9 as tm,aa as o3,ab as vfe,ac as Cfe,ad as yfe,ae as wfe,af as a3,I as jr,ag as l3,ah as bfe,ai as Sfe,aj as xfe,ak as Rfe,E as xb,P as Y4,al as Efe,am as Ffe,an as Afe,s as Dfe,F as yu,G as kfe}from"./index-CkKdE7Lg.js";import{Q as Pfe,a as vl,c as Mfe,d as Tfe,h as Ife}from"./QSpinner-DuK6SYs7.js";import{u as Fk,c as _fe,b as Ofe,h as Lfe,a as Nfe,Q as $fe}from"./scroll-wOVzZROT.js";import{c as X4,d as Q4,u as Bfe,l as Gfe,a as zfe,b as Hfe,Q as Vfe}from"./EditorStore-BLEZ9639.js";import{u as Wfe}from"./use-timeout-DqMgmTns.js";import{Q as Ufe}from"./QPage-DiGMfFab.js";import{_ as L1}from"./_plugin-vue_export-helper-DlAUqK2U.js";var Ly=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qfe(e){return e??null}function u3(e,t){return e??(t===!0?`f_${Fk()}`:null)}function jfe({getValue:e,required:t=!0}={}){if(tfe.value===!0){const n=e!==void 0?Qe(qfe(e())):Qe(null);return t===!0&&n.value===null&&Cc(()=>{n.value=`f_${Fk()}`}),e!==void 0&&Yt(e,i=>{n.value=u3(i,t)}),n}return e!==void 0?Le(()=>u3(e(),t)):Qe(`f_${Fk()}`)}const c3=/^on[A-Z]/;function Kfe(){const{attrs:e,vnode:t}=es(),n={listeners:Qe({}),attributes:Qe({})};function i(){const r={},s={};for(const o in e)o!=="class"&&o!=="style"&&c3.test(o)===!1&&(r[o]=e[o]);for(const o in t.props)c3.test(o)===!0&&(s[o]=t.props[o]);n.attributes.value=r,n.listeners.value=s}return nfe(i),i(),n}function Yfe({validate:e,resetValidation:t,requiresQForm:n}){const i=ife(rfe,!1);if(i!==!1){const{props:r,proxy:s}=es();Object.assign(s,{validate:e,resetValidation:t}),Yt(()=>r.disable,o=>{o===!0?(typeof t=="function"&&t(),i.unbindComponent(s)):i.bindComponent(s)}),Cc(()=>{r.disable!==!0&&i.bindComponent(s)}),jp(()=>{r.disable!==!0&&i.unbindComponent(s)})}else n===!0&&console.error("Parent QForm not found on useFormChild()!")}const d3=/^#[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/,h3=/^#[0-9a-fA-F]{4}([0-9a-fA-F]{4})?$/,f3=/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{4}|[0-9a-fA-F]{6}|[0-9a-fA-F]{8})$/,Ny=/^rgb\(((0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),){2}(0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5])\)$/,$y=/^rgba\(((0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),){2}(0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),(0|0\.[0-9]+[1-9]|0\.[1-9]+|1)\)$/,$F={date:e=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(e),time:e=>/^([0-1]?\d|2[0-3]):[0-5]\d$/.test(e),fulltime:e=>/^([0-1]?\d|2[0-3]):[0-5]\d:[0-5]\d$/.test(e),timeOrFulltime:e=>/^([0-1]?\d|2[0-3]):[0-5]\d(:[0-5]\d)?$/.test(e),email:e=>/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e),hexColor:e=>d3.test(e),hexaColor:e=>h3.test(e),hexOrHexaColor:e=>f3.test(e),rgbColor:e=>Ny.test(e),rgbaColor:e=>$y.test(e),rgbOrRgbaColor:e=>Ny.test(e)||$y.test(e),hexOrRgbColor:e=>d3.test(e)||Ny.test(e),hexaOrRgbaColor:e=>h3.test(e)||$y.test(e),anyColor:e=>f3.test(e)||Ny.test(e)||$y.test(e)},Xfe=[!0,!1,"ondemand"],Qfe={modelValue:{},error:{type:Boolean,default:null},errorMessage:String,noErrorIcon:Boolean,rules:Array,reactiveRules:Boolean,lazyRules:{type:[Boolean,String],default:!1,validator:e=>Xfe.includes(e)}};function Zfe(e,t){const{props:n,proxy:i}=es(),r=Qe(!1),s=Qe(null),o=Qe(!1);Yfe({validate:m,resetValidation:g});let a=0,l;const u=Le(()=>n.rules!==void 0&&n.rules!==null&&n.rules.length!==0),c=Le(()=>n.disable!==!0&&u.value===!0&&t.value===!1),d=Le(()=>n.error===!0||r.value===!0),h=Le(()=>typeof n.errorMessage=="string"&&n.errorMessage.length!==0?n.errorMessage:s.value);Yt(()=>n.modelValue,()=>{o.value=!0,c.value===!0&&n.lazyRules===!1&&C()});function p(){n.lazyRules!=="ondemand"&&c.value===!0&&o.value===!0&&C()}Yt(()=>n.reactiveRules,y=>{y===!0?l===void 0&&(l=Yt(()=>n.rules,p,{immediate:!0,deep:!0})):l!==void 0&&(l(),l=void 0)},{immediate:!0}),Yt(()=>n.lazyRules,p),Yt(e,y=>{y===!0?o.value=!0:c.value===!0&&n.lazyRules!=="ondemand"&&C()});function g(){a++,t.value=!1,o.value=!1,r.value=!1,s.value=null,C.cancel()}function m(y=n.modelValue){if(n.disable===!0||u.value===!1)return!0;const b=++a,S=t.value!==!0?()=>{o.value=!0}:()=>{},x=(A,F)=>{A===!0&&S(),r.value=A,s.value=F||null,t.value=!1},E=[];for(let A=0;A<n.rules.length;A++){const F=n.rules[A];let P;if(typeof F=="function"?P=F(y,$F):typeof F=="string"&&$F[F]!==void 0&&(P=$F[F](y)),P===!1||typeof P=="string")return x(!0,P),!1;P!==!0&&P!==void 0&&E.push(P)}return E.length===0?(x(!1),!0):(t.value=!0,Promise.all(E).then(A=>{if(A===void 0||Array.isArray(A)===!1||A.length===0)return b===a&&x(!1),!0;const F=A.find(P=>P===!1||typeof P=="string");return b===a&&x(F!==void 0,F),F===void 0},A=>(b===a&&(console.error(A),x(!0)),!1)))}const C=sfe(m,0);return jp(()=>{l!==void 0&&l(),C.cancel()}),Object.assign(i,{resetValidation:g,validate:m}),_T(i,"hasError",()=>d.value),{isDirtyModel:o,hasRules:u,hasError:d,errorMessage:h,validate:m,resetValidation:g}}let yd=[],zv=[];function Z4(e){zv=zv.filter(t=>t!==e)}function Jfe(e){Z4(e),zv.push(e)}function p3(e){Z4(e),zv.length===0&&yd.length!==0&&(yd[yd.length-1](),yd=[])}function LT(e){zv.length===0?e():yd.push(e)}function epe(e){yd=yd.filter(t=>t!==e)}function Ak(e){return e!=null&&(""+e).length!==0}const tpe={...X4,...Qfe,label:String,stackLabel:Boolean,hint:String,hideHint:Boolean,prefix:String,suffix:String,labelColor:String,color:String,bgColor:String,filled:Boolean,outlined:Boolean,borderless:Boolean,standout:[Boolean,String],square:Boolean,loading:Boolean,labelSlot:Boolean,bottomSlots:Boolean,hideBottomSpace:Boolean,rounded:Boolean,dense:Boolean,itemAligned:Boolean,counter:Boolean,clearable:Boolean,clearIcon:String,disable:Boolean,readonly:Boolean,autofocus:Boolean,for:String},npe={...tpe,maxlength:[Number,String]},ipe=["update:modelValue","clear","focus","blur"];function rpe({requiredForAttr:e=!0,tagProp:t,changeEvent:n=!1}={}){const{props:i,proxy:r}=es(),s=Q4(i,r.$q),o=jfe({required:e,getValue:()=>i.for});return{requiredForAttr:e,changeEvent:n,tag:t===!0?Le(()=>i.tag):{value:"label"},isDark:s,editable:Le(()=>i.disable!==!0&&i.readonly!==!0),innerLoading:Qe(!1),focused:Qe(!1),hasPopupOpen:!1,splitAttrs:Kfe(),targetUid:o,rootRef:Qe(null),targetRef:Qe(null),controlRef:Qe(null)}}function spe(e){const{props:t,emit:n,slots:i,attrs:r,proxy:s}=es(),{$q:o}=s;let a=null;e.hasValue===void 0&&(e.hasValue=Le(()=>Ak(t.modelValue))),e.emitValue===void 0&&(e.emitValue=V=>{n("update:modelValue",V)}),e.controlEvents===void 0&&(e.controlEvents={onFocusin:D,onFocusout:M}),Object.assign(e,{clearValue:O,onControlFocusin:D,onControlFocusout:M,focus:F}),e.computedCounter===void 0&&(e.computedCounter=Le(()=>{if(t.counter!==!1){const V=typeof t.modelValue=="string"||typeof t.modelValue=="number"?(""+t.modelValue).length:Array.isArray(t.modelValue)===!0?t.modelValue.length:0,U=t.maxlength!==void 0?t.maxlength:t.maxValues;return V+(U!==void 0?" / "+U:"")}}));const{isDirtyModel:l,hasRules:u,hasError:c,errorMessage:d,resetValidation:h}=Zfe(e.focused,e.innerLoading),p=e.floatingLabel!==void 0?Le(()=>t.stackLabel===!0||e.focused.value===!0||e.floatingLabel.value===!0):Le(()=>t.stackLabel===!0||e.focused.value===!0||e.hasValue.value===!0),g=Le(()=>t.bottomSlots===!0||t.hint!==void 0||u.value===!0||t.counter===!0||t.error!==null),m=Le(()=>t.filled===!0?"filled":t.outlined===!0?"outlined":t.borderless===!0?"borderless":t.standout?"standout":"standard"),C=Le(()=>`q-field row no-wrap items-start q-field--${m.value}`+(e.fieldClass!==void 0?` ${e.fieldClass.value}`:"")+(t.rounded===!0?" q-field--rounded":"")+(t.square===!0?" q-field--square":"")+(p.value===!0?" q-field--float":"")+(b.value===!0?" q-field--labeled":"")+(t.dense===!0?" q-field--dense":"")+(t.itemAligned===!0?" q-field--item-aligned q-item-type":"")+(e.isDark.value===!0?" q-field--dark":"")+(e.getControl===void 0?" q-field--auto-height":"")+(e.focused.value===!0?" q-field--focused":"")+(c.value===!0?" q-field--error":"")+(c.value===!0||e.focused.value===!0?" q-field--highlighted":"")+(t.hideBottomSpace!==!0&&g.value===!0?" q-field--with-bottom":"")+(t.disable===!0?" q-field--disabled":t.readonly===!0?" q-field--readonly":"")),y=Le(()=>"q-field__control relative-position row no-wrap"+(t.bgColor!==void 0?` bg-${t.bgColor}`:"")+(c.value===!0?" text-negative":typeof t.standout=="string"&&t.standout.length!==0&&e.focused.value===!0?` ${t.standout}`:t.color!==void 0?` text-${t.color}`:"")),b=Le(()=>t.labelSlot===!0||t.label!==void 0),S=Le(()=>"q-field__label no-pointer-events absolute ellipsis"+(t.labelColor!==void 0&&c.value!==!0?` text-${t.labelColor}`:"")),x=Le(()=>({id:e.targetUid.value,editable:e.editable.value,focused:e.focused.value,floatingLabel:p.value,modelValue:t.modelValue,emitValue:e.emitValue})),E=Le(()=>{const V={};return e.targetUid.value&&(V.for=e.targetUid.value),t.disable===!0&&(V["aria-disabled"]="true"),V});function A(){const V=document.activeElement;let U=e.targetRef!==void 0&&e.targetRef.value;U&&(V===null||V.id!==e.targetUid.value)&&(U.hasAttribute("tabindex")===!0||(U=U.querySelector("[tabindex]")),U&&U!==V&&U.focus({preventScroll:!0}))}function F(){LT(A)}function P(){epe(A);const V=document.activeElement;V!==null&&e.rootRef.value.contains(V)&&V.blur()}function D(V){a!==null&&(clearTimeout(a),a=null),e.editable.value===!0&&e.focused.value===!1&&(e.focused.value=!0,n("focus",V))}function M(V,U){a!==null&&clearTimeout(a),a=setTimeout(()=>{a=null,!(document.hasFocus()===!0&&(e.hasPopupOpen===!0||e.controlRef===void 0||e.controlRef.value===null||e.controlRef.value.contains(document.activeElement)!==!1))&&(e.focused.value===!0&&(e.focused.value=!1,n("blur",V)),U!==void 0&&U())})}function O(V){OT(V),o.platform.is.mobile!==!0?(e.targetRef!==void 0&&e.targetRef.value||e.rootRef.value).focus():e.rootRef.value.contains(document.activeElement)===!0&&document.activeElement.blur(),t.type==="file"&&(e.inputRef.value.value=null),n("update:modelValue",null),e.changeEvent===!0&&n("change",null),n("clear",t.modelValue),ca(()=>{const U=l.value;h(),l.value=U})}function B(V){[13,32].includes(V.keyCode)&&O(V)}function H(){const V=[];return i.prepend!==void 0&&V.push(ct("div",{class:"q-field__prepend q-field__marginal row no-wrap items-center",key:"prepend",onClick:fd},i.prepend())),V.push(ct("div",{class:"q-field__control-container col relative-position row no-wrap q-anchor--skip"},N())),c.value===!0&&t.noErrorIcon===!1&&V.push(G("error",[ct(n3,{name:o.iconSet.field.error,color:"negative"})])),t.loading===!0||e.innerLoading.value===!0?V.push(G("inner-loading-append",i.loading!==void 0?i.loading():[ct(Pfe,{color:t.color})])):t.clearable===!0&&e.hasValue.value===!0&&e.editable.value===!0&&V.push(G("inner-clearable-append",[ct(n3,{class:"q-field__focusable-action",name:t.clearIcon||o.iconSet.field.clear,tabindex:0,role:"button","aria-hidden":"false","aria-label":o.lang.label.clear,onKeyup:B,onClick:O})])),i.append!==void 0&&V.push(ct("div",{class:"q-field__append q-field__marginal row no-wrap items-center",key:"append",onClick:fd},i.append())),e.getInnerAppend!==void 0&&V.push(G("inner-append",e.getInnerAppend())),e.getControlChild!==void 0&&V.push(e.getControlChild()),V}function N(){const V=[];return t.prefix!==void 0&&t.prefix!==null&&V.push(ct("div",{class:"q-field__prefix no-pointer-events row items-center"},t.prefix)),e.getShadowControl!==void 0&&e.hasShadow.value===!0&&V.push(e.getShadowControl()),e.getControl!==void 0?V.push(e.getControl()):i.rawControl!==void 0?V.push(i.rawControl()):i.control!==void 0&&V.push(ct("div",{ref:e.targetRef,class:"q-field__native row",tabindex:-1,...e.splitAttrs.attributes.value,"data-autofocus":t.autofocus===!0||void 0},i.control(x.value))),b.value===!0&&V.push(ct("div",{class:S.value},vl(i.label,t.label))),t.suffix!==void 0&&t.suffix!==null&&V.push(ct("div",{class:"q-field__suffix no-pointer-events row items-center"},t.suffix)),V.concat(vl(i.default))}function L(){let V,U;c.value===!0?d.value!==null?(V=[ct("div",{role:"alert"},d.value)],U=`q--slot-error-${d.value}`):(V=vl(i.error),U="q--slot-error"):(t.hideHint!==!0||e.focused.value===!0)&&(t.hint!==void 0?(V=[ct("div",t.hint)],U=`q--slot-hint-${t.hint}`):(V=vl(i.hint),U="q--slot-hint"));const ie=t.counter===!0||i.counter!==void 0;if(t.hideBottomSpace===!0&&ie===!1&&V===void 0)return;const pe=ct("div",{key:U,class:"q-field__messages col"},V);return ct("div",{class:"q-field__bottom row items-start q-field__bottom--"+(t.hideBottomSpace!==!0?"animated":"stale"),onClick:fd},[t.hideBottomSpace===!0?pe:ct(xk,{name:"q-transition--field-message"},()=>pe),ie===!0?ct("div",{class:"q-field__counter"},i.counter!==void 0?i.counter():e.computedCounter.value):null])}function G(V,U){return U===null?null:ct("div",{key:V,class:"q-field__append q-field__marginal row no-wrap items-center q-anchor--skip"},U)}let q=!1;return ofe(()=>{q=!0}),afe(()=>{q===!0&&t.autofocus===!0&&s.focus()}),t.autofocus===!0&&Cc(()=>{s.focus()}),jp(()=>{a!==null&&clearTimeout(a)}),Object.assign(s,{focus:F,blur:P}),function(){const U=e.getControl===void 0&&i.control===void 0?{...e.splitAttrs.attributes.value,"data-autofocus":t.autofocus===!0||void 0,...E.value}:E.value;return ct(e.tag.value,{ref:e.rootRef,class:[C.value,r.class],style:r.style,...U},[i.before!==void 0?ct("div",{class:"q-field__before q-field__marginal row no-wrap items-center",onClick:fd},i.before()):null,ct("div",{class:"q-field__inner relative-position col self-stretch"},[ct("div",{ref:e.controlRef,class:y.value,tabindex:-1,...e.controlEvents},H()),g.value===!0?L():null]),i.after!==void 0?ct("div",{class:"q-field__after q-field__marginal row no-wrap items-center",onClick:fd},i.after()):null])}}const g3={date:"####/##/##",datetime:"####/##/## ##:##",time:"##:##",fulltime:"##:##:##",phone:"(###) ### - ####",card:"#### #### #### ####"},Rb={"#":{pattern:"[\\d]",negate:"[^\\d]"},S:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]"},N:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]"},A:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]",transform:e=>e.toLocaleUpperCase()},a:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]",transform:e=>e.toLocaleLowerCase()},X:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]",transform:e=>e.toLocaleUpperCase()},x:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]",transform:e=>e.toLocaleLowerCase()}},J4=Object.keys(Rb);J4.forEach(e=>{Rb[e].regex=new RegExp(Rb[e].pattern)});const ope=new RegExp("\\\\([^.*+?^${}()|([\\]])|([.*+?^${}()|[\\]])|(["+J4.join("")+"])|(.)","g"),m3=/[.*+?^${}()|[\]\\]/g,$n="",ape={mask:String,reverseFillMask:Boolean,fillMask:[Boolean,String],unmaskedValue:Boolean};function lpe(e,t,n,i){let r,s,o,a,l,u;const c=Qe(null),d=Qe(p());function h(){return e.autogrow===!0||["textarea","text","search","url","tel","password"].includes(e.type)}Yt(()=>e.type+e.autogrow,m),Yt(()=>e.mask,D=>{if(D!==void 0)C(d.value,!0);else{const M=F(d.value);m(),e.modelValue!==M&&t("update:modelValue",M)}}),Yt(()=>e.fillMask+e.reverseFillMask,()=>{c.value===!0&&C(d.value,!0)}),Yt(()=>e.unmaskedValue,()=>{c.value===!0&&C(d.value)});function p(){if(m(),c.value===!0){const D=E(F(e.modelValue));return e.fillMask!==!1?P(D):D}return e.modelValue}function g(D){if(D<r.length)return r.slice(-D);let M="",O=r;const B=O.indexOf($n);if(B!==-1){for(let H=D-O.length;H>0;H--)M+=$n;O=O.slice(0,B)+M+O.slice(B)}return O}function m(){if(c.value=e.mask!==void 0&&e.mask.length!==0&&h(),c.value===!1){a=void 0,r="",s="";return}const D=g3[e.mask]===void 0?e.mask:g3[e.mask],M=typeof e.fillMask=="string"&&e.fillMask.length!==0?e.fillMask.slice(0,1):"_",O=M.replace(m3,"\\$&"),B=[],H=[],N=[];let L=e.reverseFillMask===!0,G="",q="";D.replace(ope,(pe,K,Fe,Je,Me)=>{if(Je!==void 0){const De=Rb[Je];N.push(De),q=De.negate,L===!0&&(H.push("(?:"+q+"+)?("+De.pattern+"+)?(?:"+q+"+)?("+De.pattern+"+)?"),L=!1),H.push("(?:"+q+"+)?("+De.pattern+")?")}else if(Fe!==void 0)G="\\"+(Fe==="\\"?"":Fe),N.push(Fe),B.push("([^"+G+"]+)?"+G+"?");else{const De=K!==void 0?K:Me;G=De==="\\"?"\\\\\\\\":De.replace(m3,"\\\\$&"),N.push(De),B.push("([^"+G+"]+)?"+G+"?")}});const V=new RegExp("^"+B.join("")+"("+(G===""?".":"[^"+G+"]")+"+)?"+(G===""?"":"["+G+"]*")+"$"),U=H.length-1,ie=H.map((pe,K)=>K===0&&e.reverseFillMask===!0?new RegExp("^"+O+"*"+pe):K===U?new RegExp("^"+pe+"("+(q===""?".":q)+"+)?"+(e.reverseFillMask===!0?"$":O+"*")):new RegExp("^"+pe));o=N,a=pe=>{const K=V.exec(e.reverseFillMask===!0?pe:pe.slice(0,N.length+1));K!==null&&(pe=K.slice(1).join(""));const Fe=[],Je=ie.length;for(let Me=0,De=pe;Me<Je;Me++){const xt=ie[Me].exec(De);if(xt===null)break;De=De.slice(xt.shift().length),Fe.push(...xt)}return Fe.length!==0?Fe.join(""):pe},r=N.map(pe=>typeof pe=="string"?pe:$n).join(""),s=r.split($n).join(M)}function C(D,M,O){const B=i.value,H=B.selectionEnd,N=B.value.length-H,L=F(D);M===!0&&m();const G=E(L),q=e.fillMask!==!1?P(G):G,V=d.value!==q;B.value!==q&&(B.value=q),V===!0&&(d.value=q),document.activeElement===B&&ca(()=>{if(q===s){const ie=e.reverseFillMask===!0?s.length:0;B.setSelectionRange(ie,ie,"forward");return}if(O==="insertFromPaste"&&e.reverseFillMask!==!0){const ie=B.selectionEnd;let pe=H-1;for(let K=l;K<=pe&&K<ie;K++)r[K]!==$n&&pe++;b.right(B,pe);return}if(["deleteContentBackward","deleteContentForward"].indexOf(O)!==-1){const ie=e.reverseFillMask===!0?H===0?q.length>G.length?1:0:Math.max(0,q.length-(q===s?0:Math.min(G.length,N)+1))+1:H;B.setSelectionRange(ie,ie,"forward");return}if(e.reverseFillMask===!0)if(V===!0){const ie=Math.max(0,q.length-(q===s?0:Math.min(G.length,N+1)));ie===1&&H===1?B.setSelectionRange(ie,ie,"forward"):b.rightReverse(B,ie)}else{const ie=q.length-N;B.setSelectionRange(ie,ie,"backward")}else if(V===!0){const ie=Math.max(0,r.indexOf($n),Math.min(G.length,H)-1);b.right(B,ie)}else{const ie=H-1;b.right(B,ie)}});const U=e.unmaskedValue===!0?F(q):q;String(e.modelValue)!==U&&(e.modelValue!==null||U!=="")&&n(U,!0)}function y(D,M,O){const B=E(F(D.value));M=Math.max(0,r.indexOf($n),Math.min(B.length,M)),l=M,D.setSelectionRange(M,O,"forward")}const b={left(D,M){const O=r.slice(M-1).indexOf($n)===-1;let B=Math.max(0,M-1);for(;B>=0;B--)if(r[B]===$n){M=B,O===!0&&M++;break}if(B<0&&r[M]!==void 0&&r[M]!==$n)return b.right(D,0);M>=0&&D.setSelectionRange(M,M,"backward")},right(D,M){const O=D.value.length;let B=Math.min(O,M+1);for(;B<=O;B++)if(r[B]===$n){M=B;break}else r[B-1]===$n&&(M=B);if(B>O&&r[M-1]!==void 0&&r[M-1]!==$n)return b.left(D,O);D.setSelectionRange(M,M,"forward")},leftReverse(D,M){const O=g(D.value.length);let B=Math.max(0,M-1);for(;B>=0;B--)if(O[B-1]===$n){M=B;break}else if(O[B]===$n&&(M=B,B===0))break;if(B<0&&O[M]!==void 0&&O[M]!==$n)return b.rightReverse(D,0);M>=0&&D.setSelectionRange(M,M,"backward")},rightReverse(D,M){const O=D.value.length,B=g(O),H=B.slice(0,M+1).indexOf($n)===-1;let N=Math.min(O,M+1);for(;N<=O;N++)if(B[N-1]===$n){M=N,M>0&&H===!0&&M--;break}if(N>O&&B[M-1]!==void 0&&B[M-1]!==$n)return b.leftReverse(D,O);D.setSelectionRange(M,M,"forward")}};function S(D){t("click",D),u=void 0}function x(D){if(t("keydown",D),lfe(D)===!0||D.altKey===!0)return;const M=i.value,O=M.selectionStart,B=M.selectionEnd;if(D.shiftKey||(u=void 0),D.keyCode===37||D.keyCode===39){D.shiftKey&&u===void 0&&(u=M.selectionDirection==="forward"?O:B);const H=b[(D.keyCode===39?"right":"left")+(e.reverseFillMask===!0?"Reverse":"")];if(D.preventDefault(),H(M,u===O?B:O),D.shiftKey){const N=M.selectionStart;M.setSelectionRange(Math.min(u,N),Math.max(u,N),"forward")}}else D.keyCode===8&&e.reverseFillMask!==!0&&O===B?(b.left(M,O),M.setSelectionRange(M.selectionStart,B,"backward")):D.keyCode===46&&e.reverseFillMask===!0&&O===B&&(b.rightReverse(M,B),M.setSelectionRange(O,M.selectionEnd,"forward"))}function E(D){if(D==null||D==="")return"";if(e.reverseFillMask===!0)return A(D);const M=o;let O=0,B="";for(let H=0;H<M.length;H++){const N=D[O],L=M[H];if(typeof L=="string")B+=L,N===L&&O++;else if(N!==void 0&&L.regex.test(N))B+=L.transform!==void 0?L.transform(N):N,O++;else return B}return B}function A(D){const M=o,O=r.indexOf($n);let B=D.length-1,H="";for(let N=M.length-1;N>=0&&B!==-1;N--){const L=M[N];let G=D[B];if(typeof L=="string")H=L+H,G===L&&B--;else if(G!==void 0&&L.regex.test(G))do H=(L.transform!==void 0?L.transform(G):G)+H,B--,G=D[B];while(O===N&&G!==void 0&&L.regex.test(G));else return H}return H}function F(D){return typeof D!="string"||a===void 0?typeof D=="number"?a(""+D):D:a(D)}function P(D){return s.length-D.length<=0?D:e.reverseFillMask===!0&&D.length!==0?s.slice(0,-D.length)+D:D+s.slice(D.length)}return{innerValue:d,hasMask:c,moveCursorForPaste:y,updateMaskValue:C,onMaskedKeydown:x,onMaskedClick:S}}const upe={name:String};function cpe(e){return Le(()=>e.name||e.for)}function dpe(e,t){function n(){const i=e.modelValue;try{const r="DataTransfer"in window?new DataTransfer:"ClipboardEvent"in window?new ClipboardEvent("").clipboardData:void 0;return Object(i)===i&&("length"in i?Array.from(i):[i]).forEach(s=>{r.items.add(s)}),{files:r.files}}catch{return{files:void 0}}}return Le(()=>{if(e.type==="file")return n()})}const hpe=/[\u3000-\u303f\u3040-\u309f\u30a0-\u30ff\uff00-\uff9f\u4e00-\u9faf\u3400-\u4dbf]/,fpe=/[\u4e00-\u9fff\u3400-\u4dbf\u{20000}-\u{2a6df}\u{2a700}-\u{2b73f}\u{2b740}-\u{2b81f}\u{2b820}-\u{2ceaf}\uf900-\ufaff\u3300-\u33ff\ufe30-\ufe4f\uf900-\ufaff\u{2f800}-\u{2fa1f}]/u,ppe=/[\u3131-\u314e\u314f-\u3163\uac00-\ud7a3]/,gpe=/[a-z0-9_ -]$/i;function mpe(e){return function(n){if(n.type==="compositionend"||n.type==="change"){if(n.target.qComposing!==!0)return;n.target.qComposing=!1,e(n)}else n.type==="compositionupdate"&&n.target.qComposing!==!0&&typeof n.data=="string"&&(Er.is.firefox===!0?gpe.test(n.data)===!1:hpe.test(n.data)===!0||fpe.test(n.data)===!0||ppe.test(n.data)===!0)===!0&&(n.target.qComposing=!0)}}const vpe=G0({name:"QInput",inheritAttrs:!1,props:{...npe,...ape,...upe,modelValue:[String,Number,FileList],shadowText:String,type:{type:String,default:"text"},debounce:[String,Number],autogrow:Boolean,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...ipe,"paste","change","keydown","click","animationend"],setup(e,{emit:t,attrs:n}){const{proxy:i}=es(),{$q:r}=i,s={};let o=NaN,a,l,u=null,c;const d=Qe(null),h=cpe(e),{innerValue:p,hasMask:g,moveCursorForPaste:m,updateMaskValue:C,onMaskedKeydown:y,onMaskedClick:b}=lpe(e,t,G,d),S=dpe(e),x=Le(()=>Ak(p.value)),E=mpe(N),A=rpe({changeEvent:!0}),F=Le(()=>e.type==="textarea"||e.autogrow===!0),P=Le(()=>F.value===!0||["text","search","url","tel","password"].includes(e.type)),D=Le(()=>{const K={...A.splitAttrs.listeners.value,onInput:N,onPaste:H,onChange:V,onBlur:U,onFocus:dv};return K.onCompositionstart=K.onCompositionupdate=K.onCompositionend=E,g.value===!0&&(K.onKeydown=y,K.onClick=b),e.autogrow===!0&&(K.onAnimationend=L),K}),M=Le(()=>{const K={tabindex:0,"data-autofocus":e.autofocus===!0||void 0,rows:e.type==="textarea"?6:void 0,"aria-label":e.label,name:h.value,...A.splitAttrs.attributes.value,id:A.targetUid.value,maxlength:e.maxlength,disabled:e.disable===!0,readonly:e.readonly===!0};return F.value===!1&&(K.type=e.type),e.autogrow===!0&&(K.rows=1),K});Yt(()=>e.type,()=>{d.value&&(d.value.value=e.modelValue)}),Yt(()=>e.modelValue,K=>{if(g.value===!0){if(l===!0&&(l=!1,String(K)===o))return;C(K)}else p.value!==K&&(p.value=K,e.type==="number"&&s.hasOwnProperty("value")===!0&&(a===!0?a=!1:delete s.value));e.autogrow===!0&&ca(q)}),Yt(()=>e.autogrow,K=>{K===!0?ca(q):d.value!==null&&n.rows>0&&(d.value.style.height="auto")}),Yt(()=>e.dense,()=>{e.autogrow===!0&&ca(q)});function O(){LT(()=>{const K=document.activeElement;d.value!==null&&d.value!==K&&(K===null||K.id!==A.targetUid.value)&&d.value.focus({preventScroll:!0})})}function B(){d.value!==null&&d.value.select()}function H(K){if(g.value===!0&&e.reverseFillMask!==!0){const Fe=K.target;m(Fe,Fe.selectionStart,Fe.selectionEnd)}t("paste",K)}function N(K){if(!K||!K.target)return;if(e.type==="file"){t("update:modelValue",K.target.files);return}const Fe=K.target.value;if(K.target.qComposing===!0){s.value=Fe;return}if(g.value===!0)C(Fe,!1,K.inputType);else if(G(Fe),P.value===!0&&K.target===document.activeElement){const{selectionStart:Je,selectionEnd:Me}=K.target;Je!==void 0&&Me!==void 0&&ca(()=>{K.target===document.activeElement&&Fe.indexOf(K.target.value)===0&&K.target.setSelectionRange(Je,Me)})}e.autogrow===!0&&q()}function L(K){t("animationend",K),q()}function G(K,Fe){c=()=>{u=null,e.type!=="number"&&s.hasOwnProperty("value")===!0&&delete s.value,e.modelValue!==K&&o!==K&&(o=K,Fe===!0&&(l=!0),t("update:modelValue",K),ca(()=>{o===K&&(o=NaN)})),c=void 0},e.type==="number"&&(a=!0,s.value=K),e.debounce!==void 0?(u!==null&&clearTimeout(u),s.value=K,u=setTimeout(c,e.debounce)):c()}function q(){requestAnimationFrame(()=>{const K=d.value;if(K!==null){const Fe=K.parentNode.style,{scrollTop:Je}=K,{overflowY:Me,maxHeight:De}=r.platform.is.firefox===!0?{}:window.getComputedStyle(K),xt=Me!==void 0&&Me!=="scroll";xt===!0&&(K.style.overflowY="hidden"),Fe.marginBottom=K.scrollHeight-1+"px",K.style.height="1px",K.style.height=K.scrollHeight+"px",xt===!0&&(K.style.overflowY=parseInt(De,10)<K.scrollHeight?"auto":"hidden"),Fe.marginBottom="",K.scrollTop=Je}})}function V(K){E(K),u!==null&&(clearTimeout(u),u=null),c!==void 0&&c(),t("change",K.target.value)}function U(K){K!==void 0&&dv(K),u!==null&&(clearTimeout(u),u=null),c!==void 0&&c(),a=!1,l=!1,delete s.value,e.type!=="file"&&setTimeout(()=>{d.value!==null&&(d.value.value=p.value!==void 0?p.value:"")})}function ie(){return s.hasOwnProperty("value")===!0?s.value:p.value!==void 0?p.value:""}jp(()=>{U()}),Cc(()=>{e.autogrow===!0&&q()}),Object.assign(A,{innerValue:p,fieldClass:Le(()=>`q-${F.value===!0?"textarea":"input"}`+(e.autogrow===!0?" q-textarea--autogrow":"")),hasShadow:Le(()=>e.type!=="file"&&typeof e.shadowText=="string"&&e.shadowText.length!==0),inputRef:d,emitValue:G,hasValue:x,floatingLabel:Le(()=>x.value===!0&&(e.type!=="number"||isNaN(p.value)===!1)||Ak(e.displayValue)),getControl:()=>ct(F.value===!0?"textarea":"input",{ref:d,class:["q-field__native q-placeholder",e.inputClass],style:e.inputStyle,...M.value,...D.value,...e.type!=="file"?{value:ie()}:S.value}),getShadowControl:()=>ct("div",{class:"q-field__native q-field__shadow absolute-bottom no-pointer-events"+(F.value===!0?"":" text-no-wrap")},[ct("span",{class:"invisible"},ie()),ct("span",e.shadowText)])});const pe=spe(A);return Object.assign(i,{focus:O,select:B,getNativeElement:()=>d.value}),_T(i,"nativeEl",()=>d.value),pe}}),Cpe=G0({name:"QCardSection",props:{tag:{type:String,default:"div"},horizontal:Boolean},setup(e,{slots:t}){const n=Le(()=>`q-card__section q-card__section--${e.horizontal===!0?"horiz row no-wrap":"vert"}`);return()=>ct(e.tag,{class:n.value},vl(t.default))}});function ype(e,t,n){let i;function r(){i!==void 0&&(r3.remove(i),i=void 0)}return jp(()=>{e.value===!0&&r()}),{removeFromHistory:r,addToHistory(){i={condition:()=>n.value===!0,handler:t},r3.add(i)}}}const wpe={modelValue:{type:Boolean,default:null},"onUpdate:modelValue":[Function,Array]},bpe=["beforeShow","show","beforeHide","hide"];function Spe({showing:e,canShow:t,hideOnRouteChange:n,handleShow:i,handleHide:r,processOnMount:s}){const o=es(),{props:a,emit:l,proxy:u}=o;let c;function d(b){e.value===!0?g(b):h(b)}function h(b){if(a.disable===!0||b!==void 0&&b.qAnchorHandled===!0||t!==void 0&&t(b)!==!0)return;const S=a["onUpdate:modelValue"]!==void 0;S===!0&&(l("update:modelValue",!0),c=b,ca(()=>{c===b&&(c=void 0)})),(a.modelValue===null||S===!1)&&p(b)}function p(b){e.value!==!0&&(e.value=!0,l("beforeShow",b),i!==void 0?i(b):l("show",b))}function g(b){if(a.disable===!0)return;const S=a["onUpdate:modelValue"]!==void 0;S===!0&&(l("update:modelValue",!1),c=b,ca(()=>{c===b&&(c=void 0)})),(a.modelValue===null||S===!1)&&m(b)}function m(b){e.value!==!1&&(e.value=!1,l("beforeHide",b),r!==void 0?r(b):l("hide",b))}function C(b){a.disable===!0&&b===!0?a["onUpdate:modelValue"]!==void 0&&l("update:modelValue",!1):b===!0!==e.value&&(b===!0?p:m)(c)}Yt(()=>a.modelValue,C),n!==void 0&&Mfe(o)===!0&&Yt(()=>u.$route.fullPath,()=>{n.value===!0&&e.value===!0&&g()}),Cc(()=>{C(a.modelValue)});const y={show:h,hide:g,toggle:d};return Object.assign(u,y),y}const xpe={transitionShow:{type:String,default:"fade"},transitionHide:{type:String,default:"fade"},transitionDuration:{type:[String,Number],default:300}};function Rpe(e,t=()=>{},n=()=>{}){return{transitionProps:Le(()=>{const i=`q-transition--${e.transitionShow||t()}`,r=`q-transition--${e.transitionHide||n()}`;return{appear:!0,enterFromClass:`${i}-enter-from`,enterActiveClass:`${i}-enter-active`,enterToClass:`${i}-enter-to`,leaveFromClass:`${r}-leave-from`,leaveActiveClass:`${r}-leave-active`,leaveToClass:`${r}-leave-to`}}),transitionStyle:Le(()=>`--q-transition-duration: ${e.transitionDuration}ms`)}}let Epe=1,Fpe=document.body;function Ape(e,t){const n=document.createElement("div");if(n.id=`q-portal--${t}--${Epe++}`,s3.globalNodes!==void 0){const i=s3.globalNodes.class;i!==void 0&&(n.className=i)}return Fpe.appendChild(n),n}function Dpe(e){e.remove()}const BF=[],kpe=G0({name:"QPortal",setup(e,{slots:t}){return()=>t.default()}});function Ppe(e){for(e=e.parent;e!=null;){if(e.type.name==="QGlobalDialog")return!0;if(e.type.name==="QDialog"||e.type.name==="QMenu")return!1;e=e.parent}return!1}function Mpe(e,t,n,i){const r=Qe(!1),s=Qe(!1);let o=null;const a={},l=i==="dialog"&&Ppe(e);function u(d){if(d===!0){p3(a),s.value=!0;return}s.value=!1,r.value===!1&&(l===!1&&o===null&&(o=Ape(!1,i)),r.value=!0,BF.push(e.proxy),Jfe(a))}function c(d){if(s.value=!1,d!==!0)return;p3(a),r.value=!1;const h=BF.indexOf(e.proxy);h!==-1&&BF.splice(h,1),o!==null&&(Dpe(o),o=null)}return j4(()=>{c(!0)}),e.proxy.__qPortal=!0,_T(e.proxy,"contentEl",()=>t.value),{showPortal:u,hidePortal:c,portalIsActive:r,portalIsAccessible:s,renderPortal:()=>l===!0?n():r.value===!0?[ct(ufe,{to:o},ct(kpe,n))]:void 0}}let nm=0,GF,zF,Nm,HF=!1,v3,C3,y3,Qc=null;function Tpe(e){Ipe(e)&&OT(e)}function Ipe(e){if(e.target===document.body||e.target.classList.contains("q-layout__backdrop"))return!0;const t=cfe(e),n=e.shiftKey&&!e.deltaX,i=!n&&Math.abs(e.deltaX)<=Math.abs(e.deltaY),r=n||i?e.deltaY:e.deltaX;for(let s=0;s<t.length;s++){const o=t[s];if(Lfe(o,i))return i?r<0&&o.scrollTop===0?!0:r>0&&o.scrollTop+o.clientHeight===o.scrollHeight:r<0&&o.scrollLeft===0?!0:r>0&&o.scrollLeft+o.clientWidth===o.scrollWidth}return!0}function w3(e){e.target===document&&(document.scrollingElement.scrollTop=document.scrollingElement.scrollTop)}function By(e){HF!==!0&&(HF=!0,requestAnimationFrame(()=>{HF=!1;const{height:t}=e.target,{clientHeight:n,scrollTop:i}=document.scrollingElement;(Nm===void 0||t!==window.innerHeight)&&(Nm=n-t,document.scrollingElement.scrollTop=i),i>Nm&&(document.scrollingElement.scrollTop-=Math.ceil((i-Nm)/8))}))}function b3(e){const t=document.body,n=window.visualViewport!==void 0;if(e==="add"){const{overflowY:i,overflowX:r}=window.getComputedStyle(t);GF=_fe(window),zF=Ofe(window),v3=t.style.left,C3=t.style.top,y3=window.location.href,t.style.left=`-${GF}px`,t.style.top=`-${zF}px`,r!=="hidden"&&(r==="scroll"||t.scrollWidth>window.innerWidth)&&t.classList.add("q-body--force-scrollbar-x"),i!=="hidden"&&(i==="scroll"||t.scrollHeight>window.innerHeight)&&t.classList.add("q-body--force-scrollbar-y"),t.classList.add("q-body--prevent-scroll"),document.qScrollPrevented=!0,Er.is.ios===!0&&(n===!0?(window.scrollTo(0,0),window.visualViewport.addEventListener("resize",By,Xc.passiveCapture),window.visualViewport.addEventListener("scroll",By,Xc.passiveCapture),window.scrollTo(0,0)):window.addEventListener("scroll",w3,Xc.passiveCapture))}Er.is.desktop===!0&&Er.is.mac===!0&&window[`${e}EventListener`]("wheel",Tpe,Xc.notPassive),e==="remove"&&(Er.is.ios===!0&&(n===!0?(window.visualViewport.removeEventListener("resize",By,Xc.passiveCapture),window.visualViewport.removeEventListener("scroll",By,Xc.passiveCapture)):window.removeEventListener("scroll",w3,Xc.passiveCapture)),t.classList.remove("q-body--prevent-scroll"),t.classList.remove("q-body--force-scrollbar-x"),t.classList.remove("q-body--force-scrollbar-y"),document.qScrollPrevented=!1,t.style.left=v3,t.style.top=C3,window.location.href===y3&&window.scrollTo(GF,zF),Nm=void 0)}function _pe(e){let t="add";if(e===!0){if(nm++,Qc!==null){clearTimeout(Qc),Qc=null;return}if(nm>1)return}else{if(nm===0||(nm--,nm>0))return;if(t="remove",Er.is.ios===!0&&Er.is.nativeMobile===!0){Qc!==null&&clearTimeout(Qc),Qc=setTimeout(()=>{b3(t),Qc=null},100);return}}b3(t)}function Ope(){let e;return{preventBodyScroll(t){t!==e&&(e!==void 0||t===!0)&&(e=t,_pe(t))}}}const Ed=[];let tp;function Lpe(e){tp=e.keyCode===27}function Npe(){tp===!0&&(tp=!1)}function $pe(e){tp===!0&&(tp=!1,dfe(e,27)===!0&&Ed[Ed.length-1](e))}function e8(e){window[e]("keydown",Lpe),window[e]("blur",Npe),window[e]("keyup",$pe),tp=!1}function Bpe(e){Er.is.desktop===!0&&(Ed.push(e),Ed.length===1&&e8("addEventListener"))}function S3(e){const t=Ed.indexOf(e);t!==-1&&(Ed.splice(t,1),Ed.length===0&&e8("removeEventListener"))}const Fd=[];function t8(e){Fd[Fd.length-1](e)}function Gpe(e){Er.is.desktop===!0&&(Fd.push(e),Fd.length===1&&document.body.addEventListener("focusin",t8))}function x3(e){const t=Fd.indexOf(e);t!==-1&&(Fd.splice(t,1),Fd.length===0&&document.body.removeEventListener("focusin",t8))}let Gy=0;const zpe={standard:"fixed-full flex-center",top:"fixed-top justify-center",bottom:"fixed-bottom justify-center",right:"fixed-right items-center",left:"fixed-left items-center"},R3={standard:["scale","scale"],top:["slide-down","slide-up"],bottom:["slide-up","slide-down"],right:["slide-left","slide-right"],left:["slide-right","slide-left"]},Hpe=G0({name:"QDialog",inheritAttrs:!1,props:{...wpe,...xpe,transitionShow:String,transitionHide:String,persistent:Boolean,autoClose:Boolean,allowFocusOutside:Boolean,noEscDismiss:Boolean,noBackdropDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,noShake:Boolean,seamless:Boolean,maximized:Boolean,fullWidth:Boolean,fullHeight:Boolean,square:Boolean,backdropFilter:String,position:{type:String,default:"standard",validator:e=>["standard","top","bottom","left","right"].includes(e)}},emits:[...bpe,"shake","click","escapeKey"],setup(e,{slots:t,emit:n,attrs:i}){const r=es(),s=Qe(null),o=Qe(!1),a=Qe(!1);let l=null,u=null,c,d;const h=Le(()=>e.persistent!==!0&&e.noRouteDismiss!==!0&&e.seamless!==!0),{preventBodyScroll:p}=Ope(),{registerTimeout:g}=Wfe(),{registerTick:m,removeTick:C}=Nfe(),{transitionProps:y,transitionStyle:b}=Rpe(e,()=>R3[e.position][0],()=>R3[e.position][1]),S=Le(()=>b.value+(e.backdropFilter!==void 0?`;backdrop-filter:${e.backdropFilter};-webkit-backdrop-filter:${e.backdropFilter}`:"")),{showPortal:x,hidePortal:E,portalIsAccessible:A,renderPortal:F}=Mpe(r,s,Me,"dialog"),{hide:P}=Spe({showing:o,hideOnRouteChange:h,handleShow:L,handleHide:G,processOnMount:!0}),{addToHistory:D,removeFromHistory:M}=ype(o,P,h),O=Le(()=>`q-dialog__inner flex no-pointer-events q-dialog__inner--${e.maximized===!0?"maximized":"minimized"} q-dialog__inner--${e.position} ${zpe[e.position]}`+(a.value===!0?" q-dialog__inner--animating":"")+(e.fullWidth===!0?" q-dialog__inner--fullwidth":"")+(e.fullHeight===!0?" q-dialog__inner--fullheight":"")+(e.square===!0?" q-dialog__inner--square":"")),B=Le(()=>o.value===!0&&e.seamless!==!0),H=Le(()=>e.autoClose===!0?{onClick:K}:{}),N=Le(()=>[`q-dialog fullscreen no-pointer-events q-dialog--${B.value===!0?"modal":"seamless"}`,i.class]);Yt(()=>e.maximized,De=>{o.value===!0&&pe(De)}),Yt(B,De=>{p(De),De===!0?(Gpe(Je),Bpe(U)):(x3(Je),S3(U))});function L(De){D(),u=e.noRefocus===!1&&document.activeElement!==null?document.activeElement:null,pe(e.maximized),x(),a.value=!0,e.noFocus!==!0?(document.activeElement!==null&&document.activeElement.blur(),m(q)):C(),g(()=>{if(r.proxy.$q.platform.is.ios===!0){if(e.seamless!==!0&&document.activeElement){const{top:xt,bottom:En}=document.activeElement.getBoundingClientRect(),{innerHeight:Se}=window,je=window.visualViewport!==void 0?window.visualViewport.height:Se;xt>0&&En>je/2&&(document.scrollingElement.scrollTop=Math.min(document.scrollingElement.scrollHeight-je,En>=Se?1/0:Math.ceil(document.scrollingElement.scrollTop+En-je/2))),document.activeElement.scrollIntoView()}d=!0,s.value.click(),d=!1}x(!0),a.value=!1,n("show",De)},e.transitionDuration)}function G(De){C(),M(),ie(!0),a.value=!0,E(),u!==null&&(((De&&De.type.indexOf("key")===0?u.closest('[tabindex]:not([tabindex^="-"])'):void 0)||u).focus(),u=null),g(()=>{E(!0),a.value=!1,n("hide",De)},e.transitionDuration)}function q(De){LT(()=>{let xt=s.value;if(xt!==null){if(De!==void 0){const En=xt.querySelector(De);if(En!==null){En.focus({preventScroll:!0});return}}xt.contains(document.activeElement)!==!0&&(xt=xt.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||xt.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||xt.querySelector("[autofocus], [data-autofocus]")||xt,xt.focus({preventScroll:!0}))}})}function V(De){De&&typeof De.focus=="function"?De.focus({preventScroll:!0}):q(),n("shake");const xt=s.value;xt!==null&&(xt.classList.remove("q-animate--scale"),xt.classList.add("q-animate--scale"),l!==null&&clearTimeout(l),l=setTimeout(()=>{l=null,s.value!==null&&(xt.classList.remove("q-animate--scale"),q())},170))}function U(){e.seamless!==!0&&(e.persistent===!0||e.noEscDismiss===!0?e.maximized!==!0&&e.noShake!==!0&&V():(n("escapeKey"),P()))}function ie(De){l!==null&&(clearTimeout(l),l=null),(De===!0||o.value===!0)&&(pe(!1),e.seamless!==!0&&(p(!1),x3(Je),S3(U))),De!==!0&&(u=null)}function pe(De){De===!0?c!==!0&&(Gy<1&&document.body.classList.add("q-body--dialog"),Gy++,c=!0):c===!0&&(Gy<2&&document.body.classList.remove("q-body--dialog"),Gy--,c=!1)}function K(De){d!==!0&&(P(De),n("click",De))}function Fe(De){e.persistent!==!0&&e.noBackdropDismiss!==!0?P(De):e.noShake!==!0&&V()}function Je(De){e.allowFocusOutside!==!0&&A.value===!0&&efe(s.value,De.target)!==!0&&q('[tabindex]:not([tabindex="-1"])')}Object.assign(r.proxy,{focus:q,shake:V,__updateRefocusTarget(De){u=De||null}}),jp(ie);function Me(){return ct("div",{role:"dialog","aria-modal":B.value===!0?"true":"false",...i,class:N.value},[ct(xk,{name:"q-transition--fade",appear:!0},()=>B.value===!0?ct("div",{class:"q-dialog__backdrop fixed-full",style:S.value,"aria-hidden":"true",tabindex:-1,onClick:Fe}):null),ct(xk,y.value,()=>o.value===!0?ct("div",{ref:s,class:O.value,style:b.value,tabindex:-1,...H.value},vl(t.default)):null)])}return F}}),NT={left:!0,right:!0,up:!0,down:!0,horizontal:!0,vertical:!0},Vpe=Object.keys(NT);NT.all=!0;function E3(e){const t={};for(const n of Vpe)e[n]===!0&&(t[n]=!0);return Object.keys(t).length===0?NT:(t.horizontal===!0?t.left=t.right=!0:t.left===!0&&t.right===!0&&(t.horizontal=!0),t.vertical===!0?t.up=t.down=!0:t.up===!0&&t.down===!0&&(t.vertical=!0),t.horizontal===!0&&t.vertical===!0&&(t.all=!0),t)}const Wpe=["INPUT","TEXTAREA"];function F3(e,t){return t.event===void 0&&e.target!==void 0&&e.target.draggable!==!0&&typeof t.handler=="function"&&Wpe.includes(e.target.nodeName.toUpperCase())===!1&&(e.qClonedBy===void 0||e.qClonedBy.indexOf(t.uid)===-1)}function Upe(){if(window.getSelection!==void 0){const e=window.getSelection();e.empty!==void 0?e.empty():e.removeAllRanges!==void 0&&(e.removeAllRanges(),hfe.is.mobile!==!0&&e.addRange(document.createRange()))}else document.selection!==void 0&&document.selection.empty()}function VF(e,t,n){const i=Rk(e);let r,s=i.left-t.event.x,o=i.top-t.event.y,a=Math.abs(s),l=Math.abs(o);const u=t.direction;u.horizontal===!0&&u.vertical!==!0?r=s<0?"left":"right":u.horizontal!==!0&&u.vertical===!0?r=o<0?"up":"down":u.up===!0&&o<0?(r="up",a>l&&(u.left===!0&&s<0?r="left":u.right===!0&&s>0&&(r="right"))):u.down===!0&&o>0?(r="down",a>l&&(u.left===!0&&s<0?r="left":u.right===!0&&s>0&&(r="right"))):u.left===!0&&s<0?(r="left",a<l&&(u.up===!0&&o<0?r="up":u.down===!0&&o>0&&(r="down"))):u.right===!0&&s>0&&(r="right",a<l&&(u.up===!0&&o<0?r="up":u.down===!0&&o>0&&(r="down")));let c=!1;if(r===void 0&&n===!1){if(t.event.isFirst===!0||t.event.lastDir===void 0)return{};r=t.event.lastDir,c=!0,r==="left"||r==="right"?(i.left-=s,a=0,s=0):(i.top-=o,l=0,o=0)}return{synthetic:c,payload:{evt:e,touch:t.event.mouse!==!0,mouse:t.event.mouse===!0,position:i,direction:r,isFirst:t.event.isFirst,isFinal:n===!0,duration:Date.now()-t.event.time,distance:{x:a,y:l},offset:{x:s,y:o},delta:{x:i.left-t.event.lastX,y:i.top-t.event.lastY}}}}let qpe=0;const jpe=ffe({name:"touch-pan",beforeMount(e,{value:t,modifiers:n}){if(n.mouse!==!0&&Er.has.touch!==!0)return;function i(s,o){n.mouse===!0&&o===!0?OT(s):(n.stop===!0&&dv(s),n.prevent===!0&&fd(s))}const r={uid:"qvtp_"+qpe++,handler:t,modifiers:n,direction:E3(n),noop:pfe,mouseStart(s){F3(s,r)&&gfe(s)&&(Oy(r,"temp",[[document,"mousemove","move","notPassiveCapture"],[document,"mouseup","end","passiveCapture"]]),r.start(s,!0))},touchStart(s){if(F3(s,r)){const o=s.target;Oy(r,"temp",[[o,"touchmove","move","notPassiveCapture"],[o,"touchcancel","end","passiveCapture"],[o,"touchend","end","passiveCapture"]]),r.start(s)}},start(s,o){if(Er.is.firefox===!0&&NF(e,!0),r.lastEvt=s,o===!0||n.stop===!0){if(r.direction.all!==!0&&(o!==!0||r.modifiers.mouseAllDir!==!0&&r.modifiers.mousealldir!==!0)){const u=s.type.indexOf("mouse")!==-1?new MouseEvent(s.type,s):new TouchEvent(s.type,s);s.defaultPrevented===!0&&fd(u),s.cancelBubble===!0&&dv(u),Object.assign(u,{qKeyEvent:s.qKeyEvent,qClickOutside:s.qClickOutside,qAnchorHandled:s.qAnchorHandled,qClonedBy:s.qClonedBy===void 0?[r.uid]:s.qClonedBy.concat(r.uid)}),r.initialEvent={target:s.target,event:u}}dv(s)}const{left:a,top:l}=Rk(s);r.event={x:a,y:l,time:Date.now(),mouse:o===!0,detected:!1,isFirst:!0,isFinal:!1,lastX:a,lastY:l}},move(s){if(r.event===void 0)return;const o=Rk(s),a=o.left-r.event.x,l=o.top-r.event.y;if(a===0&&l===0)return;r.lastEvt=s;const u=r.event.mouse===!0,c=()=>{i(s,u);let p;n.preserveCursor!==!0&&n.preservecursor!==!0&&(p=document.documentElement.style.cursor||"",document.documentElement.style.cursor="grabbing"),u===!0&&document.body.classList.add("no-pointer-events--children"),document.body.classList.add("non-selectable"),Upe(),r.styleCleanup=g=>{if(r.styleCleanup=void 0,p!==void 0&&(document.documentElement.style.cursor=p),document.body.classList.remove("non-selectable"),u===!0){const m=()=>{document.body.classList.remove("no-pointer-events--children")};g!==void 0?setTimeout(()=>{m(),g()},50):m()}else g!==void 0&&g()}};if(r.event.detected===!0){r.event.isFirst!==!0&&i(s,r.event.mouse);const{payload:p,synthetic:g}=VF(s,r,!1);p!==void 0&&(r.handler(p)===!1?r.end(s):(r.styleCleanup===void 0&&r.event.isFirst===!0&&c(),r.event.lastX=p.position.left,r.event.lastY=p.position.top,r.event.lastDir=g===!0?void 0:p.direction,r.event.isFirst=!1));return}if(r.direction.all===!0||u===!0&&(r.modifiers.mouseAllDir===!0||r.modifiers.mousealldir===!0)){c(),r.event.detected=!0,r.move(s);return}const d=Math.abs(a),h=Math.abs(l);d!==h&&(r.direction.horizontal===!0&&d>h||r.direction.vertical===!0&&d<h||r.direction.up===!0&&d<h&&l<0||r.direction.down===!0&&d<h&&l>0||r.direction.left===!0&&d>h&&a<0||r.direction.right===!0&&d>h&&a>0?(r.event.detected=!0,r.move(s)):r.end(s,!0))},end(s,o){if(r.event!==void 0){if(LF(r,"temp"),Er.is.firefox===!0&&NF(e,!1),o===!0)r.styleCleanup!==void 0&&r.styleCleanup(),r.event.detected!==!0&&r.initialEvent!==void 0&&r.initialEvent.target.dispatchEvent(r.initialEvent.event);else if(r.event.detected===!0){r.event.isFirst===!0&&r.handler(VF(s===void 0?r.lastEvt:s,r).payload);const{payload:a}=VF(s===void 0?r.lastEvt:s,r,!0),l=()=>{r.handler(a)};r.styleCleanup!==void 0?r.styleCleanup(l):l()}r.event=void 0,r.initialEvent=void 0,r.lastEvt=void 0}}};if(e.__qtouchpan=r,n.mouse===!0){const s=n.mouseCapture===!0||n.mousecapture===!0?"Capture":"";Oy(r,"main",[[e,"mousedown","mouseStart",`passive${s}`]])}Er.has.touch===!0&&Oy(r,"main",[[e,"touchstart","touchStart",`passive${n.capture===!0?"Capture":""}`],[e,"touchmove","noop","notPassiveCapture"]])},updated(e,t){const n=e.__qtouchpan;n!==void 0&&(t.oldValue!==t.value&&(typeof value!="function"&&n.end(),n.handler=t.value),n.direction=E3(t.modifiers))},beforeUnmount(e){const t=e.__qtouchpan;t!==void 0&&(t.event!==void 0&&t.end(),LF(t,"main"),LF(t,"temp"),Er.is.firefox===!0&&NF(e,!1),t.styleCleanup!==void 0&&t.styleCleanup(),delete e.__qtouchpan)}}),Kpe=G0({name:"QSplitter",props:{...X4,modelValue:{type:Number,required:!0},reverse:Boolean,unit:{type:String,default:"%",validator:e=>["%","px"].includes(e)},limits:{type:Array,validator:e=>e.length!==2||typeof e[0]!="number"||typeof e[1]!="number"?!1:e[0]>=0&&e[0]<=e[1]},emitImmediately:Boolean,horizontal:Boolean,disable:Boolean,beforeClass:[Array,String,Object],afterClass:[Array,String,Object],separatorClass:[Array,String,Object],separatorStyle:[Array,String,Object]},emits:["update:modelValue"],setup(e,{slots:t,emit:n}){const{proxy:{$q:i}}=es(),r=Q4(e,i),s=Qe(null),o={before:Qe(null),after:Qe(null)},a=Le(()=>`q-splitter no-wrap ${e.horizontal===!0?"q-splitter--horizontal column":"q-splitter--vertical row"} q-splitter--${e.disable===!0?"disabled":"workable"}`+(r.value===!0?" q-splitter--dark":"")),l=Le(()=>e.horizontal===!0?"height":"width"),u=Le(()=>e.reverse!==!0?"before":"after"),c=Le(()=>e.limits!==void 0?e.limits:e.unit==="%"?[10,90]:[50,1/0]);function d(E){return(e.unit==="%"?E:Math.round(E))+e.unit}const h=Le(()=>({[u.value]:{[l.value]:d(e.modelValue)}}));let p,g,m,C,y;function b(E){if(E.isFirst===!0){const F=s.value.getBoundingClientRect()[l.value];p=e.horizontal===!0?"up":"left",g=e.unit==="%"?100:F,m=Math.min(g,c.value[1],Math.max(c.value[0],e.modelValue)),C=(e.reverse!==!0?1:-1)*(e.horizontal===!0?1:i.lang.rtl===!0?-1:1)*(e.unit==="%"?F===0?0:100/F:1),s.value.classList.add("q-splitter--active");return}if(E.isFinal===!0){y!==e.modelValue&&n("update:modelValue",y),s.value.classList.remove("q-splitter--active");return}const A=m+C*(E.direction===p?-1:1)*E.distance[e.horizontal===!0?"y":"x"];y=Math.min(g,c.value[1],Math.max(c.value[0],A)),o[u.value].value.style[l.value]=d(y),e.emitImmediately===!0&&e.modelValue!==y&&n("update:modelValue",y)}const S=Le(()=>[[jpe,b,void 0,{[e.horizontal===!0?"vertical":"horizontal"]:!0,prevent:!0,stop:!0,mouse:!0,mouseAllDir:!0}]]);function x(E,A){E<A[0]?n("update:modelValue",A[0]):E>A[1]&&n("update:modelValue",A[1])}return Yt(()=>e.modelValue,E=>{x(E,c.value)}),Yt(()=>e.limits,()=>{ca(()=>{x(e.modelValue,c.value)})}),()=>{const E=[ct("div",{ref:o.before,class:["q-splitter__panel q-splitter__before"+(e.reverse===!0?" col":""),e.beforeClass],style:h.value.before},vl(t.before)),ct("div",{class:["q-splitter__separator",e.separatorClass],style:e.separatorStyle,"aria-disabled":e.disable===!0?"true":void 0},[Tfe("div",{class:"q-splitter__separator-area absolute-full"},vl(t.separator),"sep",e.disable!==!0,()=>S.value)]),ct("div",{ref:o.after,class:["q-splitter__panel q-splitter__after"+(e.reverse===!0?"":" col"),e.afterClass],style:h.value.after},vl(t.after))];return ct("div",{class:a.value,ref:s},Ife(t.default,E))}}}),Ype=/("(?:[^\\"]|\\.)*")|[:,]/g;function WF(e,t={}){const n=JSON.stringify([1],void 0,t.indent===void 0?2:t.indent).slice(2,-3),i=n===""?1/0:t.maxLength===void 0?80:t.maxLength;let{replacer:r}=t;return function s(o,a,l){o&&typeof o.toJSON=="function"&&(o=o.toJSON());const u=JSON.stringify(o,r);if(u===void 0)return u;const c=i-a.length-l;if(u.length<=c){const d=u.replace(Ype,(h,p)=>p||`${h} `);if(d.length<=c)return d}if(r!=null&&(o=JSON.parse(u),r=void 0),typeof o=="object"&&o!==null){const d=a+n,h=[];let p=0,g,m;if(Array.isArray(o)){g="[",m="]";const{length:C}=o;for(;p<C;p++)h.push(s(o[p],d,p===C-1?0:1)||"null")}else{g="{",m="}";const C=Object.keys(o),{length:y}=C;for(;p<y;p++){const b=C[p],S=`${JSON.stringify(b)}: `,x=s(o[b],d,S.length+(p===y-1?0:1));x!==void 0&&h.push(S+x)}}if(h.length>0)return[g,n+h.join(`,
${d}`),m].join(`
${a}`)}return u}(e,"",0)}function $r(e,t,n){return e.fields=t||[],e.fname=n,e}function xn(e){return e==null?null:e.fname}function Li(e){return e==null?null:e.fields}function n8(e){return e.length===1?Xpe(e[0]):Qpe(e)}const Xpe=e=>function(t){return t[e]},Qpe=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function te(e){throw Error(e)}function La(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,l;e=e+"";function u(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(l=e[a],l==="\\")s+=e.substring(o,a++),o=a;else if(l===i)u(),i=null,r=-1;else{if(i)continue;o===r&&l==='"'||o===r&&l==="'"?(o=a+1,i=l):l==="."&&!r?a>o?u():o=a+1:l==="["?(a>o&&u(),r=o=a+1):l==="]"&&(r||te("Access path missing open bracket: "+e),r>0&&u(),r=0,o=a+1)}return r&&te("Access path missing closing bracket: "+e),i&&te("Access path missing closing quote: "+e),a>o&&(a++,u()),t}function Gs(e,t,n){const i=La(e);return e=i.length===1?i[0]:e,$r((n&&n.get||n8)(i),[e],t||e)}const z0=Gs("id"),zi=$r(e=>e,[],"identity"),Tu=$r(()=>0,[],"zero"),Kp=$r(()=>1,[],"one"),zs=$r(()=>!0,[],"true"),xu=$r(()=>!1,[],"false");function Zpe(e,t,n){const i=[t].concat([].slice.call(n));console[e].apply(console,i)}const i8=0,$T=1,BT=2,r8=3,s8=4;function GT(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Zpe,i=e||i8;return{level(r){return arguments.length?(i=+r,this):i},error(){return i>=$T&&n(t||"error","ERROR",arguments),this},warn(){return i>=BT&&n(t||"warn","WARN",arguments),this},info(){return i>=r8&&n(t||"log","INFO",arguments),this},debug(){return i>=s8&&n(t||"log","DEBUG",arguments),this}}}var ne=Array.isArray;function be(e){return e===Object(e)}const A3=e=>e!=="__proto__";function Yp(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((i,r)=>{for(const s in r)if(s==="signals")i.signals=Jpe(i.signals,r.signals);else{const o=s==="legend"?{layout:1}:s==="style"?!0:null;Xp(i,s,r[s],o)}return i},{})}function Xp(e,t,n,i){if(!A3(t))return;let r,s;if(be(n)&&!ne(n)){s=be(e[t])?e[t]:e[t]={};for(r in n)i&&(i===!0||i[r])?Xp(s,r,n[r]):A3(r)&&(s[r]=n[r])}else e[t]=n}function Jpe(e,t){if(e==null)return t;const n={},i=[];function r(s){n[s.name]||(n[s.name]=1,i.push(s))}return t.forEach(r),e.forEach(r),i}function wt(e){return e[e.length-1]}function _i(e){return e==null||e===""?null:+e}const o8=e=>t=>e*Math.exp(t),a8=e=>t=>Math.log(e*t),l8=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),u8=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,Eb=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function N1(e,t,n,i){const r=n(e[0]),s=n(wt(e)),o=(s-r)*t;return[i(r-o),i(s-o)]}function c8(e,t){return N1(e,t,_i,zi)}function d8(e,t){var n=Math.sign(e[0]);return N1(e,t,a8(n),o8(n))}function h8(e,t,n){return N1(e,t,Eb(n),Eb(1/n))}function f8(e,t,n){return N1(e,t,l8(n),u8(n))}function $1(e,t,n,i,r){const s=i(e[0]),o=i(wt(e)),a=t!=null?i(t):(s+o)/2;return[r(a+(s-a)*n),r(a+(o-a)*n)]}function zT(e,t,n){return $1(e,t,n,_i,zi)}function HT(e,t,n){const i=Math.sign(e[0]);return $1(e,t,n,a8(i),o8(i))}function Fb(e,t,n,i){return $1(e,t,n,Eb(i),Eb(1/i))}function VT(e,t,n,i){return $1(e,t,n,l8(i),u8(i))}function p8(e){return 1+~~(new Date(e).getMonth()/3)}function g8(e){return 1+~~(new Date(e).getUTCMonth()/3)}function xe(e){return e!=null?ne(e)?e:[e]:[]}function m8(e,t,n){let i=e[0],r=e[1],s;return r<i&&(s=r,r=i,i=s),s=r-i,s>=n-t?[t,n]:[i=Math.min(Math.max(i,t),n-s),i+s]}function ot(e){return typeof e=="function"}const ege="descending";function WT(e,t,n){n=n||{},t=xe(t)||[];const i=[],r=[],s={},o=n.comparator||tge;return xe(e).forEach((a,l)=>{a!=null&&(i.push(t[l]===ege?-1:1),r.push(a=ot(a)?a:Gs(a,null,n)),(Li(a)||[]).forEach(u=>s[u]=1))}),r.length===0?null:$r(o(r,i),Object.keys(s))}const Qp=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),tge=(e,t)=>e.length===1?nge(e[0],t[0]):ige(e,t,e.length),nge=(e,t)=>function(n,i){return Qp(e(n),e(i))*t},ige=(e,t,n)=>(t.push(0),function(i,r){let s,o=0,a=-1;for(;o===0&&++a<n;)s=e[a],o=Qp(s(i),s(r));return o*t[a]});function Hi(e){return ot(e)?e:()=>e}function UT(e,t){let n;return i=>{n&&clearTimeout(n),n=setTimeout(()=>(t(i),n=null),e)}}function it(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}function Ea(e,t){let n=0,i,r,s,o;if(e&&(i=e.length))if(t==null){for(r=e[n];n<i&&(r==null||r!==r);r=e[++n]);for(s=o=r;n<i;++n)r=e[n],r!=null&&(r<s&&(s=r),r>o&&(o=r))}else{for(r=t(e[n]);n<i&&(r==null||r!==r);r=t(e[++n]));for(s=o=r;n<i;++n)r=t(e[n]),r!=null&&(r<s&&(s=r),r>o&&(o=r))}return[s,o]}function v8(e,t){const n=e.length;let i=-1,r,s,o,a,l;if(t==null){for(;++i<n;)if(s=e[i],s!=null&&s>=s){r=o=s;break}if(i===n)return[-1,-1];for(a=l=i;++i<n;)s=e[i],s!=null&&(r>s&&(r=s,a=i),o<s&&(o=s,l=i))}else{for(;++i<n;)if(s=t(e[i],i,e),s!=null&&s>=s){r=o=s;break}if(i===n)return[-1,-1];for(a=l=i;++i<n;)s=t(e[i],i,e),s!=null&&(r>s&&(r=s,a=i),o<s&&(o=s,l=i))}return[a,l]}function Ae(e,t){return Object.hasOwn(e,t)}const zy={};function Zp(e){let t={},n;function i(s){return Ae(t,s)&&t[s]!==zy}const r={size:0,empty:0,object:t,has:i,get(s){return i(s)?t[s]:void 0},set(s,o){return i(s)||(++r.size,t[s]===zy&&--r.empty),t[s]=o,this},delete(s){return i(s)&&(--r.size,++r.empty,t[s]=zy),this},clear(){r.size=r.empty=0,r.object=t={}},test(s){return arguments.length?(n=s,r):n},clean(){const s={};let o=0;for(const a in t){const l=t[a];l!==zy&&(!n||!n(l))&&(s[a]=l,++o)}r.size=o,r.empty=0,r.object=t=s}};return e&&Object.keys(e).forEach(s=>{r.set(s,e[s])}),r}function C8(e,t,n,i,r,s){if(!n&&n!==0)return s;const o=+n;let a=e[0],l=wt(e),u;l<a&&(u=a,a=l,l=u),u=Math.abs(t-a);const c=Math.abs(l-t);return u<c&&u<=o?i:c<=o?r:s}function me(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),it(i,n)}function Ef(e,t,n,i){let r=t[0],s=t[t.length-1],o;return r>s&&(o=r,r=s,s=o),n=n===void 0||n,i=i===void 0||i,(n?r<=e:r<e)&&(i?e<=s:e<s)}function yc(e){return typeof e=="boolean"}function Wu(e){return Object.prototype.toString.call(e)==="[object Date]"}function y8(e){return e&&ot(e[Symbol.iterator])}function kt(e){return typeof e=="number"}function w8(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function Re(e){return typeof e=="string"}function qT(e,t,n){e&&(e=t?xe(e).map(a=>a.replace(/\\(.)/g,"$1")):xe(e));const i=e&&e.length,r=n&&n.get||n8,s=a=>r(t?[a]:La(a));let o;if(!i)o=function(){return""};else if(i===1){const a=s(e[0]);o=function(l){return""+a(l)}}else{const a=e.map(s);o=function(l){let u=""+a[0](l),c=0;for(;++c<i;)u+="|"+a[c](l);return u}}return $r(o,e,"key")}function b8(e,t){const n=e[0],i=wt(e),r=+t;return r?r===1?i:n+r*(i-n):n}const rge=1e4;function S8(e){e=+e||rge;let t,n,i;const r=()=>{t={},n={},i=0},s=(o,a)=>(++i>e&&(n=t,t={},i=1),t[o]=a);return r(),{clear:r,has:o=>Ae(t,o)||Ae(n,o),get:o=>Ae(t,o)?t[o]:Ae(n,o)?s(o,n[o]):void 0,set:(o,a)=>Ae(t,o)?t[o]=a:s(o,a)}}function x8(e,t,n,i){const r=t.length,s=n.length;if(!s)return t;if(!r)return n;const o=i||new t.constructor(r+s);let a=0,l=0,u=0;for(;a<r&&l<s;++u)o[u]=e(t[a],n[l])>0?n[l++]:t[a++];for(;a<r;++a,++u)o[u]=t[a];for(;l<s;++l,++u)o[u]=n[l];return o}function $m(e,t){let n="";for(;--t>=0;)n+=e;return n}function R8(e,t,n,i){const r=n||" ",s=e+"",o=t-s.length;return o<=0?s:i==="left"?$m(r,o)+s:i==="center"?$m(r,~~(o/2))+s+$m(r,Math.ceil(o/2)):s+$m(r,o)}function H0(e){return e&&wt(e)-e[0]||0}function ge(e){return ne(e)?"["+e.map(ge)+"]":be(e)||Re(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function jT(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const sge=e=>kt(e)||Wu(e)?e:Date.parse(e);function KT(e,t){return t=t||sge,e==null||e===""?null:t(e)}function YT(e){return e==null||e===""?null:e+""}function Fo(e){const t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t}function E8(e,t,n,i){const r=i??"",s=e+"",o=s.length,a=Math.max(0,t-r.length);return o<=t?s:n==="left"?r+s.slice(o-a):n==="center"?s.slice(0,Math.ceil(a/2))+r+s.slice(o-~~(a/2)):s.slice(0,a)+r}function Fu(e,t,n){if(e)if(t){const i=e.length;for(let r=0;r<i;++r){const s=t(e[r]);s&&n(s,r,e)}}else e.forEach(n)}var D3={},UF={},qF=34,im=10,jF=13;function F8(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function oge(e,t){var n=F8(e);return function(i,r){return t(n(i),r,e)}}function k3(e){var t=Object.create(null),n=[];return e.forEach(function(i){for(var r in i)r in t||n.push(t[r]=r)}),n}function Sr(e,t){var n=e+"",i=n.length;return i<t?new Array(t-i+1).join(0)+n:n}function age(e){return e<0?"-"+Sr(-e,6):e>9999?"+"+Sr(e,6):Sr(e,4)}function lge(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),i=e.getUTCSeconds(),r=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":age(e.getUTCFullYear())+"-"+Sr(e.getUTCMonth()+1,2)+"-"+Sr(e.getUTCDate(),2)+(r?"T"+Sr(t,2)+":"+Sr(n,2)+":"+Sr(i,2)+"."+Sr(r,3)+"Z":i?"T"+Sr(t,2)+":"+Sr(n,2)+":"+Sr(i,2)+"Z":n||t?"T"+Sr(t,2)+":"+Sr(n,2)+"Z":"")}function uge(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function i(d,h){var p,g,m=r(d,function(C,y){if(p)return p(C,y-1);g=C,p=h?oge(C,h):F8(C)});return m.columns=g||[],m}function r(d,h){var p=[],g=d.length,m=0,C=0,y,b=g<=0,S=!1;d.charCodeAt(g-1)===im&&--g,d.charCodeAt(g-1)===jF&&--g;function x(){if(b)return UF;if(S)return S=!1,D3;var A,F=m,P;if(d.charCodeAt(F)===qF){for(;m++<g&&d.charCodeAt(m)!==qF||d.charCodeAt(++m)===qF;);return(A=m)>=g?b=!0:(P=d.charCodeAt(m++))===im?S=!0:P===jF&&(S=!0,d.charCodeAt(m)===im&&++m),d.slice(F+1,A-1).replace(/""/g,'"')}for(;m<g;){if((P=d.charCodeAt(A=m++))===im)S=!0;else if(P===jF)S=!0,d.charCodeAt(m)===im&&++m;else if(P!==n)continue;return d.slice(F,A)}return b=!0,d.slice(F,g)}for(;(y=x())!==UF;){for(var E=[];y!==D3&&y!==UF;)E.push(y),y=x();h&&(E=h(E,C++))==null||p.push(E)}return p}function s(d,h){return d.map(function(p){return h.map(function(g){return c(p[g])}).join(e)})}function o(d,h){return h==null&&(h=k3(d)),[h.map(c).join(e)].concat(s(d,h)).join(`
`)}function a(d,h){return h==null&&(h=k3(d)),s(d,h).join(`
`)}function l(d){return d.map(u).join(`
`)}function u(d){return d.map(c).join(e)}function c(d){return d==null?"":d instanceof Date?lge(d):t.test(d+="")?'"'+d.replace(/"/g,'""')+'"':d}return{parse:i,parseRows:r,format:o,formatBody:a,formatRows:l,formatRow:u,formatValue:c}}function cge(e){return e}function dge(e){if(e==null)return cge;var t,n,i=e.scale[0],r=e.scale[1],s=e.translate[0],o=e.translate[1];return function(a,l){l||(t=n=0);var u=2,c=a.length,d=new Array(c);for(d[0]=(t+=a[0])*i+s,d[1]=(n+=a[1])*r+o;u<c;)d[u]=a[u],++u;return d}}function hge(e,t){for(var n,i=e.length,r=i-t;r<--i;)n=e[r],e[r++]=e[i],e[i]=n}function fge(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return P3(e,n)})}:P3(e,t)}function P3(e,t){var n=t.id,i=t.bbox,r=t.properties==null?{}:t.properties,s=A8(e,t);return n==null&&i==null?{type:"Feature",properties:r,geometry:s}:i==null?{type:"Feature",id:n,properties:r,geometry:s}:{type:"Feature",id:n,bbox:i,properties:r,geometry:s}}function A8(e,t){var n=dge(e.transform),i=e.arcs;function r(c,d){d.length&&d.pop();for(var h=i[c<0?~c:c],p=0,g=h.length;p<g;++p)d.push(n(h[p],p));c<0&&hge(d,g)}function s(c){return n(c)}function o(c){for(var d=[],h=0,p=c.length;h<p;++h)r(c[h],d);return d.length<2&&d.push(d[0]),d}function a(c){for(var d=o(c);d.length<4;)d.push(d[0]);return d}function l(c){return c.map(a)}function u(c){var d=c.type,h;switch(d){case"GeometryCollection":return{type:d,geometries:c.geometries.map(u)};case"Point":h=s(c.coordinates);break;case"MultiPoint":h=c.coordinates.map(s);break;case"LineString":h=o(c.arcs);break;case"MultiLineString":h=c.arcs.map(o);break;case"Polygon":h=l(c.arcs);break;case"MultiPolygon":h=c.arcs.map(l);break;default:return null}return{type:d,coordinates:h}}return u(t)}function pge(e,t){var n={},i={},r={},s=[],o=-1;t.forEach(function(u,c){var d=e.arcs[u<0?~u:u],h;d.length<3&&!d[1][0]&&!d[1][1]&&(h=t[++o],t[o]=u,t[c]=h)}),t.forEach(function(u){var c=a(u),d=c[0],h=c[1],p,g;if(p=r[d])if(delete r[p.end],p.push(u),p.end=h,g=i[h]){delete i[g.start];var m=g===p?p:p.concat(g);i[m.start=p.start]=r[m.end=g.end]=m}else i[p.start]=r[p.end]=p;else if(p=i[h])if(delete i[p.start],p.unshift(u),p.start=d,g=r[d]){delete r[g.end];var C=g===p?p:g.concat(p);i[C.start=g.start]=r[C.end=p.end]=C}else i[p.start]=r[p.end]=p;else p=[u],i[p.start=d]=r[p.end=h]=p});function a(u){var c=e.arcs[u<0?~u:u],d=c[0],h;return e.transform?(h=[0,0],c.forEach(function(p){h[0]+=p[0],h[1]+=p[1]})):h=c[c.length-1],u<0?[h,d]:[d,h]}function l(u,c){for(var d in u){var h=u[d];delete c[h.start],delete h.start,delete h.end,h.forEach(function(p){n[p<0?~p:p]=1}),s.push(h)}}return l(r,i),l(i,r),t.forEach(function(u){n[u<0?~u:u]||s.push([u])}),s}function gge(e){return A8(e,mge.apply(this,arguments))}function mge(e,t,n){var i,r,s;if(arguments.length>1)i=vge(e,t,n);else for(r=0,i=new Array(s=e.arcs.length);r<s;++r)i[r]=r;return{type:"MultiLineString",arcs:pge(e,i)}}function vge(e,t,n){var i=[],r=[],s;function o(d){var h=d<0?~d:d;(r[h]||(r[h]=[])).push({i:d,g:s})}function a(d){d.forEach(o)}function l(d){d.forEach(a)}function u(d){d.forEach(l)}function c(d){switch(s=d,d.type){case"GeometryCollection":d.geometries.forEach(c);break;case"LineString":a(d.arcs);break;case"MultiLineString":case"Polygon":l(d.arcs);break;case"MultiPolygon":u(d.arcs);break}}return c(t),r.forEach(n==null?function(d){i.push(d[0].i)}:function(d){n(d[0].g,d[d.length-1].g)&&i.push(d[0].i)}),i}function El(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Cge(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Jp(e){let t,n,i;e.length!==2?(t=El,n=(a,l)=>El(e(a),l),i=(a,l)=>e(a)-l):(t=e===El||e===Cge?e:yge,n=e,i=e);function r(a,l,u=0,c=a.length){if(u<c){if(t(l,l)!==0)return c;do{const d=u+c>>>1;n(a[d],l)<0?u=d+1:c=d}while(u<c)}return u}function s(a,l,u=0,c=a.length){if(u<c){if(t(l,l)!==0)return c;do{const d=u+c>>>1;n(a[d],l)<=0?u=d+1:c=d}while(u<c)}return u}function o(a,l,u=0,c=a.length){const d=r(a,l,u,c-1);return d>u&&i(a[d-1],l)>-i(a[d],l)?d-1:d}return{left:r,center:o,right:s}}function yge(){return 0}function D8(e){return e===null?NaN:+e}function*wge(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)(i=t(i,++n,e))!=null&&(i=+i)>=i&&(yield i)}}const k8=Jp(El),Zu=k8.right,bge=k8.left;Jp(D8).center;function Sge(e,t){let n=0,i,r=0,s=0;if(t===void 0)for(let o of e)o!=null&&(o=+o)>=o&&(i=o-r,r+=i/++n,s+=i*(o-r));else{let o=-1;for(let a of e)(a=t(a,++o,e))!=null&&(a=+a)>=a&&(i=a-r,r+=i/++n,s+=i*(a-r))}if(n>1)return s/(n-1)}function xge(e,t){const n=Sge(e,t);return n&&Math.sqrt(n)}class or{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const s=n[r],o=t+s,a=Math.abs(t)<Math.abs(s)?t-(o-s):s-(o-t);a&&(n[i++]=a),t=o}return n[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let n=this._n,i,r,s,o=0;if(n>0){for(o=t[--n];n>0&&(i=o,r=t[--n],o=i+r,s=r-(o-i),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(r=s*2,i=o+r,r==i-o&&(o=i))}return o}}class M3 extends Map{constructor(t,n=T8){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[i,r]of t)this.set(i,r)}get(t){return super.get(Dk(this,t))}has(t){return super.has(Dk(this,t))}set(t,n){return super.set(P8(this,t),n)}delete(t){return super.delete(M8(this,t))}}class Ab extends Set{constructor(t,n=T8){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const i of t)this.add(i)}has(t){return super.has(Dk(this,t))}add(t){return super.add(P8(this,t))}delete(t){return super.delete(M8(this,t))}}function Dk({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):n}function P8({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):(e.set(i,n),n)}function M8({_intern:e,_key:t},n){const i=t(n);return e.has(i)&&(n=e.get(i),e.delete(i)),n}function T8(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Rge(e,t){return Array.from(t,n=>e[n])}function Ege(e=El){if(e===El)return I8;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const i=e(t,n);return i||i===0?i:(e(n,n)===0)-(e(t,t)===0)}}function I8(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const Fge=Math.sqrt(50),Age=Math.sqrt(10),Dge=Math.sqrt(2);function Db(e,t,n){const i=(t-e)/Math.max(0,n),r=Math.floor(Math.log10(i)),s=i/Math.pow(10,r),o=s>=Fge?10:s>=Age?5:s>=Dge?2:1;let a,l,u;return r<0?(u=Math.pow(10,-r)/o,a=Math.round(e*u),l=Math.round(t*u),a/u<e&&++a,l/u>t&&--l,u=-u):(u=Math.pow(10,r)*o,a=Math.round(e/u),l=Math.round(t/u),a*u<e&&++a,l*u>t&&--l),l<a&&.5<=n&&n<2?Db(e,t,n*2):[a,l,u]}function kk(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const i=t<e,[r,s,o]=i?Db(t,e,n):Db(e,t,n);if(!(s>=r))return[];const a=s-r+1,l=new Array(a);if(i)if(o<0)for(let u=0;u<a;++u)l[u]=(s-u)/-o;else for(let u=0;u<a;++u)l[u]=(s-u)*o;else if(o<0)for(let u=0;u<a;++u)l[u]=(r+u)/-o;else for(let u=0;u<a;++u)l[u]=(r+u)*o;return l}function Pk(e,t,n){return t=+t,e=+e,n=+n,Db(e,t,n)[2]}function Ju(e,t,n){t=+t,e=+e,n=+n;const i=t<e,r=i?Pk(t,e,n):Pk(e,t,n);return(i?-1:1)*(r<0?1/-r:r)}function Ad(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n<r||n===void 0&&r>=r)&&(n=r)}return n}function Mk(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n>r||n===void 0&&r>=r)&&(n=r)}return n}function _8(e,t,n=0,i=1/0,r){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),i=Math.floor(Math.min(e.length-1,i)),!(n<=t&&t<=i))return e;for(r=r===void 0?I8:Ege(r);i>n;){if(i-n>600){const l=i-n+1,u=t-n+1,c=Math.log(l),d=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*d*(l-d)/l)*(u-l/2<0?-1:1),p=Math.max(n,Math.floor(t-u*d/l+h)),g=Math.min(i,Math.floor(t+(l-u)*d/l+h));_8(e,t,p,g,r)}const s=e[t];let o=n,a=i;for(rm(e,n,t),r(e[i],s)>0&&rm(e,n,i);o<a;){for(rm(e,o,a),++o,--a;r(e[o],s)<0;)++o;for(;r(e[a],s)>0;)--a}r(e[n],s)===0?rm(e,n,a):(++a,rm(e,a,i)),a<=t&&(n=a+1),t<=a&&(i=a-1)}return e}function rm(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function Tk(e,t,n){if(e=Float64Array.from(wge(e,n)),!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return Mk(e);if(t>=1)return Ad(e);var i,r=(i-1)*t,s=Math.floor(r),o=Ad(_8(e,s).subarray(0,s+1)),a=Mk(e.subarray(s+1));return o+(a-o)*(r-s)}}function O8(e,t,n=D8){if(!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return+n(e[0],0,e);if(t>=1)return+n(e[i-1],i-1,e);var i,r=(i-1)*t,s=Math.floor(r),o=+n(e[s],s,e),a=+n(e[s+1],s+1,e);return o+(a-o)*(r-s)}}function kge(e,t){let n=0,i=0;if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(++n,i+=r);else{let r=-1;for(let s of e)(s=t(s,++r,e))!=null&&(s=+s)>=s&&(++n,i+=s)}if(n)return i/n}function L8(e,t){return Tk(e,.5,t)}function*Pge(e){for(const t of e)yield*t}function N8(e){return Array.from(Pge(e))}function Ar(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(r);++i<r;)s[i]=e+i*n;return s}function $8(e,t){let n=0;for(let i of e)(i=+i)&&(n+=i);return n}function Mge(e,...t){e=new Ab(e),t=t.map(Tge);e:for(const n of e)for(const i of t)if(!i.has(n)){e.delete(n);continue e}return e}function Tge(e){return e instanceof Ab?e:new Ab(e)}function Ige(...e){const t=new Ab;for(const n of e)for(const i of n)t.add(i);return t}function _ge(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function kb(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function np(e){return e=kb(Math.abs(e)),e?e[1]:NaN}function Oge(e,t){return function(n,i){for(var r=n.length,s=[],o=0,a=e[0],l=0;r>0&&a>0&&(l+a+1>i&&(a=Math.max(1,i-l)),s.push(n.substring(r-=a,r+a)),!((l+=a+1)>i));)a=e[o=(o+1)%e.length];return s.reverse().join(t)}}function Lge(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var Nge=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Wd(e){if(!(t=Nge.exec(e)))throw new Error("invalid format: "+e);var t;return new XT({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Wd.prototype=XT.prototype;function XT(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}XT.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function $ge(e){e:for(var t=e.length,n=1,i=-1,r;n<t;++n)switch(e[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+e[n])break e;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(r+1):e}var B8;function Bge(e,t){var n=kb(e,t);if(!n)return e+"";var i=n[0],r=n[1],s=r-(B8=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+kb(e,Math.max(0,t+s-1))[0]}function T3(e,t){var n=kb(e,t);if(!n)return e+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const I3={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:_ge,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>T3(e*100,t),r:T3,s:Bge,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function _3(e){return e}var O3=Array.prototype.map,L3=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function G8(e){var t=e.grouping===void 0||e.thousands===void 0?_3:Oge(O3.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",r=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?_3:Lge(O3.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function u(d){d=Wd(d);var h=d.fill,p=d.align,g=d.sign,m=d.symbol,C=d.zero,y=d.width,b=d.comma,S=d.precision,x=d.trim,E=d.type;E==="n"?(b=!0,E="g"):I3[E]||(S===void 0&&(S=12),x=!0,E="g"),(C||h==="0"&&p==="=")&&(C=!0,h="0",p="=");var A=m==="$"?n:m==="#"&&/[boxX]/.test(E)?"0"+E.toLowerCase():"",F=m==="$"?i:/[%p]/.test(E)?o:"",P=I3[E],D=/[defgprs%]/.test(E);S=S===void 0?6:/[gprs]/.test(E)?Math.max(1,Math.min(21,S)):Math.max(0,Math.min(20,S));function M(O){var B=A,H=F,N,L,G;if(E==="c")H=P(O)+H,O="";else{O=+O;var q=O<0||1/O<0;if(O=isNaN(O)?l:P(Math.abs(O),S),x&&(O=$ge(O)),q&&+O==0&&g!=="+"&&(q=!1),B=(q?g==="("?g:a:g==="-"||g==="("?"":g)+B,H=(E==="s"?L3[8+B8/3]:"")+H+(q&&g==="("?")":""),D){for(N=-1,L=O.length;++N<L;)if(G=O.charCodeAt(N),48>G||G>57){H=(G===46?r+O.slice(N+1):O.slice(N))+H,O=O.slice(0,N);break}}}b&&!C&&(O=t(O,1/0));var V=B.length+O.length+H.length,U=V<y?new Array(y-V+1).join(h):"";switch(b&&C&&(O=t(U+O,U.length?y-H.length:1/0),U=""),p){case"<":O=B+O+H+U;break;case"=":O=B+U+O+H;break;case"^":O=U.slice(0,V=U.length>>1)+B+O+H+U.slice(V);break;default:O=U+B+O+H;break}return s(O)}return M.toString=function(){return d+""},M}function c(d,h){var p=u((d=Wd(d),d.type="f",d)),g=Math.max(-8,Math.min(8,Math.floor(np(h)/3)))*3,m=Math.pow(10,-g),C=L3[8+g/3];return function(y){return p(m*y)+C}}return{format:u,formatPrefix:c}}var Hy,B1,QT;Gge({thousands:",",grouping:[3],currency:["$",""]});function Gge(e){return Hy=G8(e),B1=Hy.format,QT=Hy.formatPrefix,Hy}function z8(e){return Math.max(0,-np(Math.abs(e)))}function H8(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(np(t)/3)))*3-np(Math.abs(e)))}function V8(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,np(t)-np(e))+1}const KF=new Date,YF=new Date;function Xn(e,t,n,i){function r(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return r.floor=s=>(e(s=new Date(+s)),s),r.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),r.round=s=>{const o=r(s),a=r.ceil(s);return s-o<a-s?o:a},r.offset=(s,o)=>(t(s=new Date(+s),o==null?1:Math.floor(o)),s),r.range=(s,o,a)=>{const l=[];if(s=r.ceil(s),a=a==null?1:Math.floor(a),!(s<o)||!(a>0))return l;let u;do l.push(u=new Date(+s)),t(s,a),e(s);while(u<s&&s<o);return l},r.filter=s=>Xn(o=>{if(o>=o)for(;e(o),!s(o);)o.setTime(o-1)},(o,a)=>{if(o>=o)if(a<0)for(;++a<=0;)for(;t(o,-1),!s(o););else for(;--a>=0;)for(;t(o,1),!s(o););}),n&&(r.count=(s,o)=>(KF.setTime(+s),YF.setTime(+o),e(KF),e(YF),Math.floor(n(KF,YF))),r.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?r.filter(i?o=>i(o)%s===0:o=>r.count(0,o)%s===0):r)),r}const ip=Xn(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);ip.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Xn(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):ip);ip.range;const Cl=1e3,Ps=Cl*60,yl=Ps*60,Nl=yl*24,ZT=Nl*7,N3=Nl*30,XF=Nl*365,wl=Xn(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Cl)},(e,t)=>(t-e)/Cl,e=>e.getUTCSeconds());wl.range;const G1=Xn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Cl)},(e,t)=>{e.setTime(+e+t*Ps)},(e,t)=>(t-e)/Ps,e=>e.getMinutes());G1.range;const z1=Xn(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ps)},(e,t)=>(t-e)/Ps,e=>e.getUTCMinutes());z1.range;const H1=Xn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Cl-e.getMinutes()*Ps)},(e,t)=>{e.setTime(+e+t*yl)},(e,t)=>(t-e)/yl,e=>e.getHours());H1.range;const V1=Xn(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*yl)},(e,t)=>(t-e)/yl,e=>e.getUTCHours());V1.range;const Fl=Xn(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ps)/Nl,e=>e.getDate()-1);Fl.range;const Uu=Xn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Nl,e=>e.getUTCDate()-1);Uu.range;const W8=Xn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Nl,e=>Math.floor(e/Nl));W8.range;function vh(e){return Xn(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Ps)/ZT)}const eg=vh(0),Pb=vh(1),zge=vh(2),Hge=vh(3),rp=vh(4),Vge=vh(5),Wge=vh(6);eg.range;Pb.range;zge.range;Hge.range;rp.range;Vge.range;Wge.range;function Ch(e){return Xn(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/ZT)}const tg=Ch(0),Mb=Ch(1),Uge=Ch(2),qge=Ch(3),sp=Ch(4),jge=Ch(5),Kge=Ch(6);tg.range;Mb.range;Uge.range;qge.range;sp.range;jge.range;Kge.range;const Hv=Xn(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Hv.range;const Vv=Xn(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Vv.range;const Fa=Xn(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Fa.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Xn(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Fa.range;const Aa=Xn(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Aa.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Xn(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Aa.range;function U8(e,t,n,i,r,s){const o=[[wl,1,Cl],[wl,5,5*Cl],[wl,15,15*Cl],[wl,30,30*Cl],[s,1,Ps],[s,5,5*Ps],[s,15,15*Ps],[s,30,30*Ps],[r,1,yl],[r,3,3*yl],[r,6,6*yl],[r,12,12*yl],[i,1,Nl],[i,2,2*Nl],[n,1,ZT],[t,1,N3],[t,3,3*N3],[e,1,XF]];function a(u,c,d){const h=c<u;h&&([u,c]=[c,u]);const p=d&&typeof d.range=="function"?d:l(u,c,d),g=p?p.range(u,+c+1):[];return h?g.reverse():g}function l(u,c,d){const h=Math.abs(c-u)/d,p=Jp(([,,C])=>C).right(o,h);if(p===o.length)return e.every(Ju(u/XF,c/XF,d));if(p===0)return ip.every(Math.max(Ju(u,c,d),1));const[g,m]=o[h/o[p-1][2]<o[p][2]/h?p-1:p];return g.every(m)}return[a,l]}const[Yge,Xge]=U8(Aa,Vv,tg,W8,V1,z1),[Qge,Zge]=U8(Fa,Hv,eg,Fl,H1,G1),wi="year",Tr="quarter",Ni="month",qn="week",Ir="date",Ii="day",Da="dayofyear",as="hours",ls="minutes",Hs="seconds",Ao="milliseconds",JT=[wi,Tr,Ni,qn,Ir,Ii,Da,as,ls,Hs,Ao],QF=JT.reduce((e,t,n)=>(e[t]=1+n,e),{});function eI(e){const t=xe(e).slice(),n={};return t.length||te("Missing time unit."),t.forEach(r=>{Ae(QF,r)?n[r]=1:te(`Invalid time unit: ${r}.`)}),(n[qn]||n[Ii]?1:0)+(n[Tr]||n[Ni]||n[Ir]?1:0)+(n[Da]?1:0)>1&&te(`Incompatible time units: ${e}`),t.sort((r,s)=>QF[r]-QF[s]),t}const Jge={[wi]:"%Y ",[Tr]:"Q%q ",[Ni]:"%b ",[Ir]:"%d ",[qn]:"W%U ",[Ii]:"%a ",[Da]:"%j ",[as]:"%H:00",[ls]:"00:%M",[Hs]:":%S",[Ao]:".%L",[`${wi}-${Ni}`]:"%Y-%m ",[`${wi}-${Ni}-${Ir}`]:"%Y-%m-%d ",[`${as}-${ls}`]:"%H:%M"};function q8(e,t){const n=it({},Jge,t),i=eI(e),r=i.length;let s="",o=0,a,l;for(o=0;o<r;)for(a=i.length;a>o;--a)if(l=i.slice(o,a).join("-"),n[l]!=null){s+=n[l],o=a;break}return s.trim()}const pd=new Date;function tI(e){return pd.setFullYear(e),pd.setMonth(0),pd.setDate(1),pd.setHours(0,0,0,0),pd}function j8(e){return Y8(new Date(e))}function K8(e){return Ik(new Date(e))}function Y8(e){return Fl.count(tI(e.getFullYear())-1,e)}function Ik(e){return eg.count(tI(e.getFullYear())-1,e)}function _k(e){return tI(e).getDay()}function eme(e,t,n,i,r,s,o){if(0<=e&&e<100){const a=new Date(-1,t,n,i,r,s,o);return a.setFullYear(e),a}return new Date(e,t,n,i,r,s,o)}function X8(e){return Z8(new Date(e))}function Q8(e){return Ok(new Date(e))}function Z8(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Uu.count(t-1,e)}function Ok(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return tg.count(t-1,e)}function Lk(e){return pd.setTime(Date.UTC(e,0,1)),pd.getUTCDay()}function tme(e,t,n,i,r,s,o){if(0<=e&&e<100){const a=new Date(Date.UTC(-1,t,n,i,r,s,o));return a.setUTCFullYear(n.y),a}return new Date(Date.UTC(e,t,n,i,r,s,o))}function J8(e,t,n,i,r){const s=t||1,o=wt(e),a=(y,b,S)=>(S=S||y,nme(n[S],i[S],y===o&&s,b)),l=new Date,u=Fo(e),c=u[wi]?a(wi):Hi(2012),d=u[Ni]?a(Ni):u[Tr]?a(Tr):Tu,h=u[qn]&&u[Ii]?a(Ii,1,qn+Ii):u[qn]?a(qn,1):u[Ii]?a(Ii,1):u[Ir]?a(Ir,1):u[Da]?a(Da,1):Kp,p=u[as]?a(as):Tu,g=u[ls]?a(ls):Tu,m=u[Hs]?a(Hs):Tu,C=u[Ao]?a(Ao):Tu;return function(y){l.setTime(+y);const b=c(l);return r(b,d(l),h(l,b),p(l),g(l),m(l),C(l))}}function nme(e,t,n,i){const r=n<=1?e:i?(s,o)=>i+n*Math.floor((e(s,o)-i)/n):(s,o)=>n*Math.floor(e(s,o)/n);return t?(s,o)=>t(r(s,o),o):r}function op(e,t,n){return t+e*7-(n+6)%7}const ime={[wi]:e=>e.getFullYear(),[Tr]:e=>Math.floor(e.getMonth()/3),[Ni]:e=>e.getMonth(),[Ir]:e=>e.getDate(),[as]:e=>e.getHours(),[ls]:e=>e.getMinutes(),[Hs]:e=>e.getSeconds(),[Ao]:e=>e.getMilliseconds(),[Da]:e=>Y8(e),[qn]:e=>Ik(e),[qn+Ii]:(e,t)=>op(Ik(e),e.getDay(),_k(t)),[Ii]:(e,t)=>op(1,e.getDay(),_k(t))},rme={[Tr]:e=>3*e,[qn]:(e,t)=>op(e,0,_k(t))};function eU(e,t){return J8(e,t||1,ime,rme,eme)}const sme={[wi]:e=>e.getUTCFullYear(),[Tr]:e=>Math.floor(e.getUTCMonth()/3),[Ni]:e=>e.getUTCMonth(),[Ir]:e=>e.getUTCDate(),[as]:e=>e.getUTCHours(),[ls]:e=>e.getUTCMinutes(),[Hs]:e=>e.getUTCSeconds(),[Ao]:e=>e.getUTCMilliseconds(),[Da]:e=>Z8(e),[qn]:e=>Ok(e),[Ii]:(e,t)=>op(1,e.getUTCDay(),Lk(t)),[qn+Ii]:(e,t)=>op(Ok(e),e.getUTCDay(),Lk(t))},ome={[Tr]:e=>3*e,[qn]:(e,t)=>op(e,0,Lk(t))};function tU(e,t){return J8(e,t||1,sme,ome,tme)}const ame={[wi]:Fa,[Tr]:Hv.every(3),[Ni]:Hv,[qn]:eg,[Ir]:Fl,[Ii]:Fl,[Da]:Fl,[as]:H1,[ls]:G1,[Hs]:wl,[Ao]:ip},lme={[wi]:Aa,[Tr]:Vv.every(3),[Ni]:Vv,[qn]:tg,[Ir]:Uu,[Ii]:Uu,[Da]:Uu,[as]:V1,[ls]:z1,[Hs]:wl,[Ao]:ip};function ng(e){return ame[e]}function ig(e){return lme[e]}function nU(e,t,n){return e?e.offset(t,n):void 0}function iU(e,t,n){return nU(ng(e),t,n)}function rU(e,t,n){return nU(ig(e),t,n)}function sU(e,t,n,i){return e?e.range(t,n,i):void 0}function oU(e,t,n,i){return sU(ng(e),t,n,i)}function aU(e,t,n,i){return sU(ig(e),t,n,i)}const Bm=1e3,Gm=Bm*60,zm=Gm*60,W1=zm*24,ume=W1*7,$3=W1*30,Nk=W1*365,lU=[wi,Ni,Ir,as,ls,Hs,Ao],Hm=lU.slice(0,-1),Vm=Hm.slice(0,-1),Wm=Vm.slice(0,-1),cme=Wm.slice(0,-1),dme=[wi,qn],B3=[wi,Ni],uU=[wi],sm=[[Hm,1,Bm],[Hm,5,5*Bm],[Hm,15,15*Bm],[Hm,30,30*Bm],[Vm,1,Gm],[Vm,5,5*Gm],[Vm,15,15*Gm],[Vm,30,30*Gm],[Wm,1,zm],[Wm,3,3*zm],[Wm,6,6*zm],[Wm,12,12*zm],[cme,1,W1],[dme,1,ume],[B3,1,$3],[B3,3,3*$3],[uU,1,Nk]];function cU(e){const t=e.extent,n=e.maxbins||40,i=Math.abs(H0(t))/n;let r=Jp(a=>a[2]).right(sm,i),s,o;return r===sm.length?(s=uU,o=Ju(t[0]/Nk,t[1]/Nk,n)):r?(r=sm[i/sm[r-1][2]<sm[r][2]/i?r-1:r],s=r[0],o=r[1]):(s=lU,o=Math.max(Ju(t[0],t[1],n),1)),{units:s,step:o}}function ZF(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function JF(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function om(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function dU(e){var t=e.dateTime,n=e.date,i=e.time,r=e.periods,s=e.days,o=e.shortDays,a=e.months,l=e.shortMonths,u=am(r),c=lm(r),d=am(s),h=lm(s),p=am(o),g=lm(o),m=am(a),C=lm(a),y=am(l),b=lm(l),S={a:q,A:V,b:U,B:ie,c:null,d:U3,e:U3,f:_me,g:Wme,G:qme,H:Mme,I:Tme,j:Ime,L:hU,m:Ome,M:Lme,p:pe,q:K,Q:K3,s:Y3,S:Nme,u:$me,U:Bme,V:Gme,w:zme,W:Hme,x:null,X:null,y:Vme,Y:Ume,Z:jme,"%":j3},x={a:Fe,A:Je,b:Me,B:De,c:null,d:q3,e:q3,f:Qme,g:ave,G:uve,H:Kme,I:Yme,j:Xme,L:pU,m:Zme,M:Jme,p:xt,q:En,Q:K3,s:Y3,S:eve,u:tve,U:nve,V:ive,w:rve,W:sve,x:null,X:null,y:ove,Y:lve,Z:cve,"%":j3},E={a:M,A:O,b:B,B:H,c:N,d:V3,e:V3,f:Ame,g:H3,G:z3,H:W3,I:W3,j:xme,L:Fme,m:Sme,M:Rme,p:D,q:bme,Q:kme,s:Pme,S:Eme,u:mme,U:vme,V:Cme,w:gme,W:yme,x:L,X:G,y:H3,Y:z3,Z:wme,"%":Dme};S.x=A(n,S),S.X=A(i,S),S.c=A(t,S),x.x=A(n,x),x.X=A(i,x),x.c=A(t,x);function A(Se,je){return function(et){var ce=[],On=-1,rt=0,gn=Se.length,Ln,Nn,Gc;for(et instanceof Date||(et=new Date(+et));++On<gn;)Se.charCodeAt(On)===37&&(ce.push(Se.slice(rt,On)),(Nn=G3[Ln=Se.charAt(++On)])!=null?Ln=Se.charAt(++On):Nn=Ln==="e"?" ":"0",(Gc=je[Ln])&&(Ln=Gc(et,Nn)),ce.push(Ln),rt=On+1);return ce.push(Se.slice(rt,On)),ce.join("")}}function F(Se,je){return function(et){var ce=om(1900,void 0,1),On=P(ce,Se,et+="",0),rt,gn;if(On!=et.length)return null;if("Q"in ce)return new Date(ce.Q);if("s"in ce)return new Date(ce.s*1e3+("L"in ce?ce.L:0));if(je&&!("Z"in ce)&&(ce.Z=0),"p"in ce&&(ce.H=ce.H%12+ce.p*12),ce.m===void 0&&(ce.m="q"in ce?ce.q:0),"V"in ce){if(ce.V<1||ce.V>53)return null;"w"in ce||(ce.w=1),"Z"in ce?(rt=JF(om(ce.y,0,1)),gn=rt.getUTCDay(),rt=gn>4||gn===0?Mb.ceil(rt):Mb(rt),rt=Uu.offset(rt,(ce.V-1)*7),ce.y=rt.getUTCFullYear(),ce.m=rt.getUTCMonth(),ce.d=rt.getUTCDate()+(ce.w+6)%7):(rt=ZF(om(ce.y,0,1)),gn=rt.getDay(),rt=gn>4||gn===0?Pb.ceil(rt):Pb(rt),rt=Fl.offset(rt,(ce.V-1)*7),ce.y=rt.getFullYear(),ce.m=rt.getMonth(),ce.d=rt.getDate()+(ce.w+6)%7)}else("W"in ce||"U"in ce)&&("w"in ce||(ce.w="u"in ce?ce.u%7:"W"in ce?1:0),gn="Z"in ce?JF(om(ce.y,0,1)).getUTCDay():ZF(om(ce.y,0,1)).getDay(),ce.m=0,ce.d="W"in ce?(ce.w+6)%7+ce.W*7-(gn+5)%7:ce.w+ce.U*7-(gn+6)%7);return"Z"in ce?(ce.H+=ce.Z/100|0,ce.M+=ce.Z%100,JF(ce)):ZF(ce)}}function P(Se,je,et,ce){for(var On=0,rt=je.length,gn=et.length,Ln,Nn;On<rt;){if(ce>=gn)return-1;if(Ln=je.charCodeAt(On++),Ln===37){if(Ln=je.charAt(On++),Nn=E[Ln in G3?je.charAt(On++):Ln],!Nn||(ce=Nn(Se,et,ce))<0)return-1}else if(Ln!=et.charCodeAt(ce++))return-1}return ce}function D(Se,je,et){var ce=u.exec(je.slice(et));return ce?(Se.p=c.get(ce[0].toLowerCase()),et+ce[0].length):-1}function M(Se,je,et){var ce=p.exec(je.slice(et));return ce?(Se.w=g.get(ce[0].toLowerCase()),et+ce[0].length):-1}function O(Se,je,et){var ce=d.exec(je.slice(et));return ce?(Se.w=h.get(ce[0].toLowerCase()),et+ce[0].length):-1}function B(Se,je,et){var ce=y.exec(je.slice(et));return ce?(Se.m=b.get(ce[0].toLowerCase()),et+ce[0].length):-1}function H(Se,je,et){var ce=m.exec(je.slice(et));return ce?(Se.m=C.get(ce[0].toLowerCase()),et+ce[0].length):-1}function N(Se,je,et){return P(Se,t,je,et)}function L(Se,je,et){return P(Se,n,je,et)}function G(Se,je,et){return P(Se,i,je,et)}function q(Se){return o[Se.getDay()]}function V(Se){return s[Se.getDay()]}function U(Se){return l[Se.getMonth()]}function ie(Se){return a[Se.getMonth()]}function pe(Se){return r[+(Se.getHours()>=12)]}function K(Se){return 1+~~(Se.getMonth()/3)}function Fe(Se){return o[Se.getUTCDay()]}function Je(Se){return s[Se.getUTCDay()]}function Me(Se){return l[Se.getUTCMonth()]}function De(Se){return a[Se.getUTCMonth()]}function xt(Se){return r[+(Se.getUTCHours()>=12)]}function En(Se){return 1+~~(Se.getUTCMonth()/3)}return{format:function(Se){var je=A(Se+="",S);return je.toString=function(){return Se},je},parse:function(Se){var je=F(Se+="",!1);return je.toString=function(){return Se},je},utcFormat:function(Se){var je=A(Se+="",x);return je.toString=function(){return Se},je},utcParse:function(Se){var je=F(Se+="",!0);return je.toString=function(){return Se},je}}}var G3={"-":"",_:" ",0:"0"},ai=/^\s*\d+/,hme=/^%/,fme=/[\\^$*+?|[\]().{}]/g;function Pt(e,t,n){var i=e<0?"-":"",r=(i?-e:e)+"",s=r.length;return i+(s<n?new Array(n-s+1).join(t)+r:r)}function pme(e){return e.replace(fme,"\\$&")}function am(e){return new RegExp("^(?:"+e.map(pme).join("|")+")","i")}function lm(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function gme(e,t,n){var i=ai.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function mme(e,t,n){var i=ai.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function vme(e,t,n){var i=ai.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function Cme(e,t,n){var i=ai.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function yme(e,t,n){var i=ai.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function z3(e,t,n){var i=ai.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function H3(e,t,n){var i=ai.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function wme(e,t,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function bme(e,t,n){var i=ai.exec(t.slice(n,n+1));return i?(e.q=i[0]*3-3,n+i[0].length):-1}function Sme(e,t,n){var i=ai.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function V3(e,t,n){var i=ai.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function xme(e,t,n){var i=ai.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function W3(e,t,n){var i=ai.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function Rme(e,t,n){var i=ai.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function Eme(e,t,n){var i=ai.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function Fme(e,t,n){var i=ai.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function Ame(e,t,n){var i=ai.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function Dme(e,t,n){var i=hme.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function kme(e,t,n){var i=ai.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function Pme(e,t,n){var i=ai.exec(t.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function U3(e,t){return Pt(e.getDate(),t,2)}function Mme(e,t){return Pt(e.getHours(),t,2)}function Tme(e,t){return Pt(e.getHours()%12||12,t,2)}function Ime(e,t){return Pt(1+Fl.count(Fa(e),e),t,3)}function hU(e,t){return Pt(e.getMilliseconds(),t,3)}function _me(e,t){return hU(e,t)+"000"}function Ome(e,t){return Pt(e.getMonth()+1,t,2)}function Lme(e,t){return Pt(e.getMinutes(),t,2)}function Nme(e,t){return Pt(e.getSeconds(),t,2)}function $me(e){var t=e.getDay();return t===0?7:t}function Bme(e,t){return Pt(eg.count(Fa(e)-1,e),t,2)}function fU(e){var t=e.getDay();return t>=4||t===0?rp(e):rp.ceil(e)}function Gme(e,t){return e=fU(e),Pt(rp.count(Fa(e),e)+(Fa(e).getDay()===4),t,2)}function zme(e){return e.getDay()}function Hme(e,t){return Pt(Pb.count(Fa(e)-1,e),t,2)}function Vme(e,t){return Pt(e.getFullYear()%100,t,2)}function Wme(e,t){return e=fU(e),Pt(e.getFullYear()%100,t,2)}function Ume(e,t){return Pt(e.getFullYear()%1e4,t,4)}function qme(e,t){var n=e.getDay();return e=n>=4||n===0?rp(e):rp.ceil(e),Pt(e.getFullYear()%1e4,t,4)}function jme(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Pt(t/60|0,"0",2)+Pt(t%60,"0",2)}function q3(e,t){return Pt(e.getUTCDate(),t,2)}function Kme(e,t){return Pt(e.getUTCHours(),t,2)}function Yme(e,t){return Pt(e.getUTCHours()%12||12,t,2)}function Xme(e,t){return Pt(1+Uu.count(Aa(e),e),t,3)}function pU(e,t){return Pt(e.getUTCMilliseconds(),t,3)}function Qme(e,t){return pU(e,t)+"000"}function Zme(e,t){return Pt(e.getUTCMonth()+1,t,2)}function Jme(e,t){return Pt(e.getUTCMinutes(),t,2)}function eve(e,t){return Pt(e.getUTCSeconds(),t,2)}function tve(e){var t=e.getUTCDay();return t===0?7:t}function nve(e,t){return Pt(tg.count(Aa(e)-1,e),t,2)}function gU(e){var t=e.getUTCDay();return t>=4||t===0?sp(e):sp.ceil(e)}function ive(e,t){return e=gU(e),Pt(sp.count(Aa(e),e)+(Aa(e).getUTCDay()===4),t,2)}function rve(e){return e.getUTCDay()}function sve(e,t){return Pt(Mb.count(Aa(e)-1,e),t,2)}function ove(e,t){return Pt(e.getUTCFullYear()%100,t,2)}function ave(e,t){return e=gU(e),Pt(e.getUTCFullYear()%100,t,2)}function lve(e,t){return Pt(e.getUTCFullYear()%1e4,t,4)}function uve(e,t){var n=e.getUTCDay();return e=n>=4||n===0?sp(e):sp.ceil(e),Pt(e.getUTCFullYear()%1e4,t,4)}function cve(){return"+0000"}function j3(){return"%"}function K3(e){return+e}function Y3(e){return Math.floor(+e/1e3)}var sf,nI,mU,iI,vU;dve({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function dve(e){return sf=dU(e),nI=sf.format,mU=sf.parse,iI=sf.utcFormat,vU=sf.utcParse,sf}function Um(e){const t={};return n=>t[n]||(t[n]=e(n))}function hve(e,t){return n=>{const i=e(n),r=i.indexOf(t);if(r<0)return i;let s=fve(i,r);const o=s<i.length?i.slice(s):"";for(;--s>r;)if(i[s]!=="0"){++s;break}return i.slice(0,s)+o}}function fve(e,t){let n=e.lastIndexOf("e"),i;if(n>0)return n;for(n=e.length;--n>t;)if(i=e.charCodeAt(n),i>=48&&i<=57)return n+1}function CU(e){const t=Um(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(i){const r=Wd(i||",");if(r.precision==null){switch(r.precision=12,r.type){case"%":r.precision-=2;break;case"e":r.precision-=1;break}return hve(t(r),t(".1f")(1)[1])}else return t(r)},formatSpan(i,r,s,o){o=Wd(o??",f");const a=Ju(i,r,s),l=Math.max(Math.abs(i),Math.abs(r));let u;if(o.precision==null)switch(o.type){case"s":return isNaN(u=H8(a,l))||(o.precision=u),n(o,l);case"":case"e":case"g":case"p":case"r":{isNaN(u=V8(a,l))||(o.precision=u-(o.type==="e"));break}case"f":case"%":{isNaN(u=z8(a))||(o.precision=u-(o.type==="%")*2);break}}return t(o)}}}let $k;yU();function yU(){return $k=CU({format:B1,formatPrefix:QT})}function wU(e){return CU(G8(e))}function Tb(e){return arguments.length?$k=wU(e):$k}function X3(e,t,n){n=n||{},be(n)||te(`Invalid time multi-format specifier: ${n}`);const i=t(Hs),r=t(ls),s=t(as),o=t(Ir),a=t(qn),l=t(Ni),u=t(Tr),c=t(wi),d=e(n[Ao]||".%L"),h=e(n[Hs]||":%S"),p=e(n[ls]||"%I:%M"),g=e(n[as]||"%I %p"),m=e(n[Ir]||n[Ii]||"%a %d"),C=e(n[qn]||"%b %d"),y=e(n[Ni]||"%B"),b=e(n[Tr]||"%B"),S=e(n[wi]||"%Y");return x=>(i(x)<x?d:r(x)<x?h:s(x)<x?p:o(x)<x?g:l(x)<x?a(x)<x?m:C:c(x)<x?u(x)<x?y:b:S)(x)}function bU(e){const t=Um(e.format),n=Um(e.utcFormat);return{timeFormat:i=>Re(i)?t(i):X3(t,ng,i),utcFormat:i=>Re(i)?n(i):X3(n,ig,i),timeParse:Um(e.parse),utcParse:Um(e.utcParse)}}let Bk;SU();function SU(){return Bk=bU({format:nI,parse:mU,utcFormat:iI,utcParse:vU})}function xU(e){return bU(dU(e))}function Wv(e){return arguments.length?Bk=xU(e):Bk}const Gk=(e,t)=>it({},e,t);function RU(e,t){const n=e?wU(e):Tb(),i=t?xU(t):Wv();return Gk(n,i)}function rI(e,t){const n=arguments.length;return n&&n!==2&&te("defaultLocale expects either zero or two arguments."),n?Gk(Tb(e),Wv(t)):Gk(Tb(),Wv())}function pve(){return yU(),SU(),rI()}const gve=/^(data:|([A-Za-z]+:)?\/\/)/,mve=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,vve=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Q3="file://";function Cve(e,t){return n=>({options:n||{},sanitize:wve,load:yve,fileAccess:!1,file:bve(t),http:xve(e)})}async function yve(e,t){const n=await this.sanitize(e,t),i=n.href;return n.localFile?this.file(i):this.http(i,t)}async function wve(e,t){t=it({},this.options,t);const n=this.fileAccess,i={href:null};let r,s,o;const a=mve.test(e.replace(vve,""));(e==null||typeof e!="string"||!a)&&te("Sanitize failure, invalid URI: "+ge(e));const l=gve.test(e);return(o=t.baseURL)&&!l&&(!e.startsWith("/")&&!o.endsWith("/")&&(e="/"+e),e=o+e),s=(r=e.startsWith(Q3))||t.mode==="file"||t.mode!=="http"&&!l&&n,r?e=e.slice(Q3.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),s=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(i,"localFile",{value:!!s}),i.href=e,t.target&&(i.target=t.target+""),t.rel&&(i.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(i.crossOrigin=t.crossOrigin+""),i}function bve(e){return e?t=>new Promise((n,i)=>{e.readFile(t,(r,s)=>{r?i(r):n(s)})}):Sve}async function Sve(){te("No file system access.")}function xve(e){return e?async function(t,n){const i=it({},this.options.http,n),r=n&&n.response,s=await e(t,i);return s.ok?ot(s[r])?s[r]():s.text():te(s.status+""+s.statusText)}:Rve}async function Rve(){te("No HTTP fetch method available.")}const Eve=e=>e!=null&&e===e,Fve=e=>e==="true"||e==="false"||e===!0||e===!1,Ave=e=>!Number.isNaN(Date.parse(e)),EU=e=>!Number.isNaN(+e)&&!(e instanceof Date),Dve=e=>EU(e)&&Number.isInteger(+e),zk={boolean:jT,integer:_i,number:_i,date:KT,string:YT,unknown:zi},Vy=[Fve,Dve,EU,Ave],kve=["boolean","integer","number","date"];function FU(e,t){if(!e||!e.length)return"unknown";const n=e.length,i=Vy.length,r=Vy.map((s,o)=>o+1);for(let s=0,o=0,a,l;s<n;++s)for(l=t?e[s][t]:e[s],a=0;a<i;++a)if(r[a]&&Eve(l)&&!Vy[a](l)&&(r[a]=0,++o,o===Vy.length))return"string";return kve[r.reduce((s,o)=>s===0?o:s,0)-1]}function AU(e,t){return t.reduce((n,i)=>(n[i]=FU(e,i),n),{})}function Z3(e){const t=function(n,i){const r={delimiter:e};return sI(n,i?it(i,r):r)};return t.responseType="text",t}function sI(e,t){return t.header&&(e=t.header.map(ge).join(t.delimiter)+`
`+e),uge(t.delimiter).parse(e+"")}sI.responseType="text";function Pve(e){return typeof Buffer=="function"&&ot(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function oI(e,t){const n=t&&t.property?Gs(t.property):zi;return be(e)&&!Pve(e)?Mve(n(e),t):n(JSON.parse(e))}oI.responseType="json";function Mve(e,t){return!ne(e)&&y8(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}const Tve={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function DU(e,t){let n,i,r,s;return e=oI(e,t),t&&t.feature?(n=fge,r=t.feature):t&&t.mesh?(n=gge,r=t.mesh,s=Tve[t.filter]):te("Missing TopoJSON feature or mesh parameter."),i=(i=e.objects[r])?n(e,i,s):te("Invalid TopoJSON object: "+r),i&&i.features||[i]}DU.responseType="json";const Vw={dsv:sI,csv:Z3(","),tsv:Z3("	"),json:oI,topojson:DU};function aI(e,t){return arguments.length>1?(Vw[e]=t,this):Ae(Vw,e)?Vw[e]:null}function kU(e){const t=aI(e);return t&&t.responseType||"text"}function PU(e,t,n,i){t=t||{};const r=aI(t.type||"json");return r||te("Unknown data format type: "+t.type),e=r(e,t),t.parse&&Ive(e,t.parse,n,i),Ae(e,"columns")&&delete e.columns,e}function Ive(e,t,n,i){if(!e.length)return;const r=Wv();n=n||r.timeParse,i=i||r.utcParse;let s=e.columns||Object.keys(e[0]),o,a,l,u,c,d;t==="auto"&&(t=AU(e,s)),s=Object.keys(t);const h=s.map(p=>{const g=t[p];let m,C;if(g&&(g.startsWith("date:")||g.startsWith("utc:")))return m=g.split(/:(.+)?/,2),C=m[1],(C[0]==="'"&&C[C.length-1]==="'"||C[0]==='"'&&C[C.length-1]==='"')&&(C=C.slice(1,-1)),(m[0]==="utc"?i:n)(C);if(!zk[g])throw Error("Illegal format pattern: "+p+":"+g);return zk[g]});for(l=0,c=e.length,d=s.length;l<c;++l)for(o=e[l],u=0;u<d;++u)a=s[u],o[a]=h[u](o[a])}const U1=Cve(typeof fetch<"u"&&fetch,null);function q1(e){const t=e||zi,n=[],i={};return n.add=r=>{const s=t(r);return i[s]||(i[s]=1,n.push(r)),n},n.remove=r=>{const s=t(r);if(i[s]){i[s]=0;const o=n.indexOf(r);o>=0&&n.splice(o,1)}return n},n}async function Ww(e,t){try{await t(e)}catch(n){e.error(n)}}const MU=Symbol("vega_id");let _ve=1;function j1(e){return!!(e&&$e(e))}function $e(e){return e[MU]}function TU(e,t){return e[MU]=t,e}function It(e){const t=e===Object(e)?e:{data:e};return $e(t)?t:TU(t,_ve++)}function lI(e){return K1(e,It({}))}function K1(e,t){for(const n in e)t[n]=e[n];return t}function IU(e,t){return TU(t,$e(e))}function yh(e,t){return e?t?(n,i)=>e(n,i)||$e(t(n))-$e(t(i)):(n,i)=>e(n,i)||$e(n)-$e(i):null}function _U(e){return e&&e.constructor===wh}function wh(){const e=[],t=[],n=[],i=[],r=[];let s=null,o=!1;return{constructor:wh,insert(a){const l=xe(a),u=l.length;for(let c=0;c<u;++c)e.push(l[c]);return this},remove(a){const l=ot(a)?i:t,u=xe(a),c=u.length;for(let d=0;d<c;++d)l.push(u[d]);return this},modify(a,l,u){const c={field:l,value:Hi(u)};return ot(a)?(c.filter=a,r.push(c)):(c.tuple=a,n.push(c)),this},encode(a,l){return ot(a)?r.push({filter:a,field:l}):n.push({tuple:a,field:l}),this},clean(a){return s=a,this},reflow(){return o=!0,this},pulse(a,l){const u={},c={};let d,h,p,g,m,C;for(d=0,h=l.length;d<h;++d)u[$e(l[d])]=1;for(d=0,h=t.length;d<h;++d)m=t[d],u[$e(m)]=-1;for(d=0,h=i.length;d<h;++d)g=i[d],l.forEach(b=>{g(b)&&(u[$e(b)]=-1)});for(d=0,h=e.length;d<h;++d)m=e[d],C=$e(m),u[C]?u[C]=1:a.add.push(It(e[d]));for(d=0,h=l.length;d<h;++d)m=l[d],u[$e(m)]<0&&a.rem.push(m);function y(b,S,x){x?b[S]=x(b):a.encode=S,o||(c[$e(b)]=b)}for(d=0,h=n.length;d<h;++d)p=n[d],m=p.tuple,g=p.field,C=u[$e(m)],C>0&&(y(m,g,p.value),a.modifies(g));for(d=0,h=r.length;d<h;++d)p=r[d],g=p.filter,l.forEach(b=>{g(b)&&u[$e(b)]>0&&y(b,p.field,p.value)}),a.modifies(p.field);if(o)a.mod=t.length||i.length?l.filter(b=>u[$e(b)]>0):l.slice();else for(C in c)a.mod.push(c[C]);return(s||s==null&&(t.length||i.length))&&a.clean(!0),a}}}const Uw="_:mod:_";function Y1(){Object.defineProperty(this,Uw,{writable:!0,value:{}})}Y1.prototype={set(e,t,n,i){const r=this,s=r[e],o=r[Uw];return t!=null&&t>=0?(s[t]!==n||i)&&(s[t]=n,o[t+":"+e]=-1,o[e]=-1):(s!==n||i)&&(r[e]=n,o[e]=ne(n)?1+n.length:-1),r},modified(e,t){const n=this[Uw];if(arguments.length){if(ne(e)){for(let i=0;i<e.length;++i)if(n[e[i]])return!0;return!1}}else{for(const i in n)if(n[i])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[Uw]={},this}};let Ove=0;const Lve="pulse",Nve=new Y1,$ve=1,Bve=2;function qt(e,t,n,i){this.id=++Ove,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,i)}function J3(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}qt.prototype={targets(){return this._targets||(this._targets=q1(z0))},set(e){return this.value!==e?(this.value=e,1):0},skip:J3($ve),modified:J3(Bve),parameters(e,t,n){t=t!==!1;const i=this._argval=this._argval||new Y1,r=this._argops=this._argops||[],s=[];let o,a,l,u;const c=(d,h,p)=>{p instanceof qt?(p!==this&&(t&&p.targets().add(this),s.push(p)),r.push({op:p,name:d,index:h})):i.set(d,h,p)};for(o in e)if(a=e[o],o===Lve)xe(a).forEach(d=>{d instanceof qt?d!==this&&(d.targets().add(this),s.push(d)):te("Pulse parameters must be operator instances.")}),this.source=a;else if(ne(a))for(i.set(o,-1,Array(l=a.length)),u=0;u<l;++u)c(o,u,a[u]);else c(o,-1,a);return this.marshall().clear(),n&&(r.initonly=!0),s},marshall(e){const t=this._argval||Nve,n=this._argops;let i,r,s,o;if(n){const a=n.length;for(r=0;r<a;++r)i=n[r],s=i.op,o=s.modified()&&s.stamp===e,t.set(i.name,i.index,s.value,o);if(n.initonly){for(r=0;r<a;++r)i=n[r],i.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,i,r;if(e)for(t=0,n=e.length;t<n;++t)i=e[t],r=i.op,r._targets&&r._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),i=t.call(this,n,e);if(n.clear(),i!==this.value)this.value=i;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function Gve(e,t,n,i){let r=1,s;return e instanceof qt?s=e:e&&e.prototype instanceof qt?s=new e:ot(e)?s=new qt(null,e):(r=0,s=new qt(e,t)),this.rank(s),r&&(i=n,n=t),n&&this.connect(s,s.parameters(n,i)),this.touch(s),s}function zve(e,t){const n=e.rank,i=t.length;for(let r=0;r<i;++r)if(n<t[r].rank){this.rerank(e);return}}let Hve=0;function X1(e,t,n){this.id=++Hve,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function Ru(e,t,n){return new X1(e,t,n)}X1.prototype={_filter:zs,_apply:zi,targets(){return this._targets||(this._targets=q1(z0))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,i=n?n.length:0;for(let r=0;r<i;++r)n[r].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=Ru(e);return this.targets().add(t),t},apply(e){const t=Ru(null,e);return this.targets().add(t),t},merge(){const e=Ru();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=Ru();return this.targets().add(Ru(null,null,UT(e,n=>{const i=n.dataflow;t.receive(n),i&&i.run&&i.run()}))),t},between(e,t){let n=!1;return e.targets().add(Ru(null,null,()=>n=!0)),t.targets().add(Ru(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=zs,this._targets=null}};function Vve(e,t,n,i){const r=this,s=Ru(n,i),o=function(u){u.dataflow=r;try{s.receive(u)}catch(c){r.error(c)}finally{r.run()}};let a;typeof e=="string"&&typeof document<"u"?a=document.querySelectorAll(e):a=xe(e);const l=a.length;for(let u=0;u<l;++u)a[u].addEventListener(t,o);return s}function Wve(e,t){const n=this.locale();return PU(e,t,n.timeParse,n.utcParse)}function Uve(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function qve(e,t){const n=this;let i=0,r;try{r=await n.loader().load(e,{context:"dataflow",response:kU(t&&t.type)});try{r=n.parse(r,t)}catch(s){i=-2,n.warn("Data ingestion failed",e,s)}}catch(s){i=-1,n.warn("Loading failed",e,s)}return{data:r,status:i}}async function jve(e,t,n){const i=this,r=i._pending||Kve(i);r.requests+=1;const s=await i.request(t,n);return i.pulse(e,i.changeset().remove(zs).insert(s.data||[])),r.done(),s}function Kve(e){let t;const n=new Promise(i=>t=i);return n.requests=0,n.done=()=>{--n.requests===0&&(e._pending=null,t(e))},e._pending=n}const Yve={skip:!0};function Xve(e,t,n,i,r){return(e instanceof qt?Zve:Qve)(this,e,t,n,i,r),this}function Qve(e,t,n,i,r,s){const o=it({},s,Yve);let a,l;ot(n)||(n=Hi(n)),i===void 0?a=u=>e.touch(n(u)):ot(i)?(l=new qt(null,i,r,!1),a=u=>{l.evaluate(u);const c=n(u),d=l.value;_U(d)?e.pulse(c,d,s):e.update(c,d,o)}):a=u=>e.update(n(u),i,o),t.apply(a)}function Zve(e,t,n,i,r,s){if(i===void 0)t.targets().add(n);else{const o=s||{},a=new qt(null,Jve(n,i),r,!1);a.modified(o.force),a.rank=t.rank,t.targets().add(a),n&&(a.skip(!0),a.value=n.value,a.targets().add(n),e.connect(n,[a]))}}function Jve(e,t){return t=ot(t)?t:Hi(t),e?function(n,i){const r=t(n,i);return e.skip()||(e.skip(r!==this.value).value=r),r}:t}function e0e(e){e.rank=++this._rank}function t0e(e){const t=[e];let n,i,r;for(;t.length;)if(this.rank(n=t.pop()),i=n._targets)for(r=i.length;--r>=0;)t.push(n=i[r]),n===e&&te("Cycle detected in dataflow graph.")}const Ib={},aa=1,Au=2,cl=4,n0e=aa|Au,ez=aa|cl,of=aa|Au|cl,tz=8,um=16,nz=32,iz=64;function qu(e,t,n){this.dataflow=e,this.stamp=t??-1,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function eA(e,t){const n=[];return Fu(e,t,i=>n.push(i)),n}function rz(e,t){const n={};return e.visit(t,i=>{n[$e(i)]=1}),i=>n[$e(i)]?null:i}function Wy(e,t){return e?(n,i)=>e(n,i)&&t(n,i):t}qu.prototype={StopPropagation:Ib,ADD:aa,REM:Au,MOD:cl,ADD_REM:n0e,ADD_MOD:ez,ALL:of,REFLOW:tz,SOURCE:um,NO_SOURCE:nz,NO_FIELDS:iz,fork(e){return new qu(this.dataflow).init(this,e)},clone(){const e=this.fork(of);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(of|um)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new qu(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&iz)&&(n.fields=e.fields),t&aa?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&Au?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&cl?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&nz?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||of;return t&aa&&this.add.length||t&Au&&this.rem.length||t&cl&&this.mod.length},reflow(e){if(e)return this.fork(of).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(cl,rz(this,aa))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return ne(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?ne(e)?e.some(i=>n[i]):n[e]:!!n:!1},filter(e,t){const n=this;return e&aa&&(n.addF=Wy(n.addF,t)),e&Au&&(n.remF=Wy(n.remF,t)),e&cl&&(n.modF=Wy(n.modF,t)),e&um&&(n.srcF=Wy(n.srcF,t)),n},materialize(e){e=e||of;const t=this;return e&aa&&t.addF&&(t.add=eA(t.add,t.addF),t.addF=null),e&Au&&t.remF&&(t.rem=eA(t.rem,t.remF),t.remF=null),e&cl&&t.modF&&(t.mod=eA(t.mod,t.modF),t.modF=null),e&um&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,i=t;if(e&um)return Fu(n.source,n.srcF,i),n;e&aa&&Fu(n.add,n.addF,i),e&Au&&Fu(n.rem,n.remF,i),e&cl&&Fu(n.mod,n.modF,i);const r=n.source;if(e&tz&&r){const s=n.add.length+n.mod.length;s===r.length||(s?Fu(r,rz(n,ez),i):Fu(r,n.srcF,i))}return n}};function uI(e,t,n,i){const r=this;let s=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=i||null,this.pulses=n;for(const o of n)if(o.stamp===t){if(o.fields){const a=r.fields||(r.fields={});for(const l in o.fields)a[l]=1}o.changed(r.ADD)&&(s|=r.ADD),o.changed(r.REM)&&(s|=r.REM),o.changed(r.MOD)&&(s|=r.MOD)}this.changes=s}me(uI,qu,{fork(e){const t=new qu(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?ne(e)?e.some(i=>n[i]):n[e]:0},filter(){te("MultiPulse does not support filtering.")},materialize(){te("MultiPulse does not support materialization.")},visit(e,t){const n=this,i=n.pulses,r=i.length;let s=0;if(e&n.SOURCE)for(;s<r;++s)i[s].visit(e,t);else for(;s<r;++s)i[s].stamp===n.stamp&&i[s].visit(e,t);return n}});async function i0e(e,t,n){const i=this,r=[];if(i._pulse)return OU(i);if(i._pending&&await i._pending,t&&await Ww(i,t),!i._touched.length)return i.debug("Dataflow invoked, but nothing to do."),i;const s=++i._clock;i._pulse=new qu(i,s,e),i._touched.forEach(c=>i._enqueue(c,!0)),i._touched=q1(z0);let o=0,a,l,u;try{for(;i._heap.size()>0;){if(a=i._heap.pop(),a.rank!==a.qrank){i._enqueue(a,!0);continue}l=a.run(i._getPulse(a,e)),l.then?l=await l:l.async&&(r.push(l.async),l=Ib),l!==Ib&&a._targets&&a._targets.forEach(c=>i._enqueue(c)),++o}}catch(c){i._heap.clear(),u=c}if(i._input={},i._pulse=null,i.debug(`Pulse ${s}: ${o} operators`),u&&(i._postrun=[],i.error(u)),i._postrun.length){const c=i._postrun.sort((d,h)=>h.priority-d.priority);i._postrun=[];for(let d=0;d<c.length;++d)await Ww(i,c[d].callback)}return n&&await Ww(i,n),r.length&&Promise.all(r).then(c=>i.runAsync(null,()=>{c.forEach(d=>{try{d(i)}catch(h){i.error(h)}})})),i}async function r0e(e,t,n){for(;this._running;)await this._running;const i=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(i,i),this._running}function s0e(e,t,n){return this._pulse?OU(this):(this.evaluate(e,t,n),this)}function o0e(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(i){this.error(i)}}function OU(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function a0e(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function l0e(e,t){const n=e.source,i=this._clock;return n&&ne(n)?new uI(this,i,n.map(r=>r.pulse),t):this._input[e.id]||u0e(this._pulse,n&&n.pulse)}function u0e(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==Ib&&(e.source=t.source),e)}const cI={skip:!1,force:!1};function c0e(e,t){const n=t||cI;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function d0e(e,t,n){const i=n||cI;return(e.set(t)||i.force)&&this.touch(e,i),this}function h0e(e,t,n){this.touch(e,n||cI);const i=new qu(this,this._clock+(this._pulse?0:1)),r=e.pulse&&e.pulse.source||[];return i.target=e,this._input[e.id]=t.pulse(i,r),this}function f0e(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),LU(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let i;return t.length?(i=t[0],t[0]=n,p0e(t,0,e)):i=n,i}}}function LU(e,t,n,i){let r,s;const o=e[n];for(;n>t;){if(s=n-1>>1,r=e[s],i(o,r)<0){e[n]=r,n=s;continue}break}return e[n]=o}function p0e(e,t,n){const i=t,r=e.length,s=e[t];let o=(t<<1)+1,a;for(;o<r;)a=o+1,a<r&&n(e[o],e[a])>=0&&(o=a),e[t]=e[o],t=o,o=(t<<1)+1;return e[t]=s,LU(e,i,t,n)}function Lf(){this.logger(GT()),this.logLevel($T),this._clock=0,this._rank=0,this._locale=rI();try{this._loader=U1()}catch{}this._touched=q1(z0),this._input={},this._pulse=null,this._heap=f0e((e,t)=>e.qrank-t.qrank),this._postrun=[]}function cm(e){return function(){return this._log[e].apply(this,arguments)}}Lf.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:cm("error"),warn:cm("warn"),info:cm("info"),debug:cm("debug"),logLevel:cm("level"),cleanThreshold:1e4,add:Gve,connect:zve,rank:e0e,rerank:t0e,pulse:h0e,touch:c0e,update:d0e,changeset:wh,ingest:Uve,parse:Wve,preload:jve,request:qve,events:Vve,on:Xve,evaluate:i0e,run:s0e,runAsync:r0e,runAfter:o0e,_enqueue:a0e,_getPulse:l0e};function Q(e,t){qt.call(this,e,null,t)}me(Q,qt,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const ap={};function NU(e){const t=$U(e);return t&&t.Definition||null}function $U(e){return e=e&&e.toLowerCase(),Ae(ap,e)?ap[e]:null}function*BU(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)i=t(i,++n,e),i!=null&&i!==""&&(i=+i)>=i&&(yield i)}}function dI(e,t,n){const i=Float64Array.from(BU(e,n));return i.sort(El),t.map(r=>O8(i,r))}function hI(e,t){return dI(e,[.25,.5,.75],t)}function fI(e,t){const n=e.length,i=xge(e,t),r=hI(e,t),s=(r[2]-r[0])/1.34;return 1.06*(Math.min(i,s)||i||Math.abs(r[0])||1)*Math.pow(n,-.2)}function GU(e){const t=e.maxbins||20,n=e.base||10,i=Math.log(n),r=e.divide||[5,2];let s=e.extent[0],o=e.extent[1],a,l,u,c,d,h;const p=e.span||o-s||Math.abs(s)||1;if(e.step)a=e.step;else if(e.steps){for(c=p/t,d=0,h=e.steps.length;d<h&&e.steps[d]<c;++d);a=e.steps[Math.max(0,d-1)]}else{for(l=Math.ceil(Math.log(t)/i),u=e.minstep||0,a=Math.max(u,Math.pow(n,Math.round(Math.log(p)/i)-l));Math.ceil(p/a)>t;)a*=n;for(d=0,h=r.length;d<h;++d)c=a/r[d],c>=u&&p/c<=t&&(a=c)}c=Math.log(a);const g=c>=0?0:~~(-c/i)+1,m=Math.pow(n,-g-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(s/a+m)*a,s=s<c?c-a:c,o=Math.ceil(o/a)*a),{start:s,stop:o===s?s+a:o,step:a}}var Vs=Math.random;function g0e(e){Vs=e}function zU(e,t,n,i){if(!e.length)return[void 0,void 0];const r=Float64Array.from(BU(e,i)),s=r.length,o=t;let a,l,u,c;for(u=0,c=Array(o);u<o;++u){for(a=0,l=0;l<s;++l)a+=r[~~(Vs()*s)];c[u]=a/s}return c.sort(El),[Tk(c,n/2),Tk(c,1-n/2)]}function HU(e,t,n,i){i=i||(h=>h);const r=e.length,s=new Float64Array(r);let o=0,a=1,l=i(e[0]),u=l,c=l+t,d;for(;a<r;++a){if(d=i(e[a]),d>=c){for(u=(l+u)/2;o<a;++o)s[o]=u;c=d+t,l=d}u=d}for(u=(l+u)/2;o<a;++o)s[o]=u;return n?m0e(s,t+t/4):s}function m0e(e,t){const n=e.length;let i=0,r=1,s,o;for(;e[i]===e[r];)++r;for(;r<n;){for(s=r+1;e[r]===e[s];)++s;if(e[r]-e[r-1]<t){for(o=r+(i+s-r-r>>1);o<r;)e[o++]=e[r];for(;o>r;)e[o--]=e[i]}i=r,r=s}return e}function v0e(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function C0e(e,t){t==null&&(t=e,e=0);let n,i,r;const s={min(o){return arguments.length?(n=o||0,r=i-n,s):n},max(o){return arguments.length?(i=o||0,r=i-n,s):i},sample(){return n+Math.floor(r*Vs())},pdf(o){return o===Math.floor(o)&&o>=n&&o<i?1/r:0},cdf(o){const a=Math.floor(o);return a<n?0:a>=i?1:(a-n+1)/r},icdf(o){return o>=0&&o<=1?n-1+Math.floor(o*r):NaN}};return s.min(e).max(t)}const VU=Math.sqrt(2*Math.PI),y0e=Math.SQRT2;let dm=NaN;function Q1(e,t){e=e||0,t=t??1;let n=0,i=0,r,s;if(dm===dm)n=dm,dm=NaN;else{do n=Vs()*2-1,i=Vs()*2-1,r=n*n+i*i;while(r===0||r>1);s=Math.sqrt(-2*Math.log(r)/r),n*=s,dm=i*s}return e+n*t}function pI(e,t,n){n=n??1;const i=(e-(t||0))/n;return Math.exp(-.5*i*i)/(n*VU)}function Z1(e,t,n){t=t||0,n=n??1;const i=(e-t)/n,r=Math.abs(i);let s;if(r>37)s=0;else{const o=Math.exp(-r*r/2);let a;r<7.07106781186547?(a=.0352624965998911*r+.700383064443688,a=a*r+6.37396220353165,a=a*r+33.912866078383,a=a*r+112.079291497871,a=a*r+221.213596169931,a=a*r+220.206867912376,s=o*a,a=.0883883476483184*r+1.75566716318264,a=a*r+16.064177579207,a=a*r+86.7807322029461,a=a*r+296.564248779674,a=a*r+637.333633378831,a=a*r+793.826512519948,a=a*r+440.413735824752,s=s/a):(a=r+.65,a=r+4/a,a=r+3/a,a=r+2/a,a=r+1/a,s=o/a/2.506628274631)}return i>0?1-s:s}function J1(e,t,n){return e<0||e>1?NaN:(t||0)+(n??1)*y0e*w0e(2*e-1)}function w0e(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function gI(e,t){let n,i;const r={mean(s){return arguments.length?(n=s||0,r):n},stdev(s){return arguments.length?(i=s??1,r):i},sample:()=>Q1(n,i),pdf:s=>pI(s,n,i),cdf:s=>Z1(s,n,i),icdf:s=>J1(s,n,i)};return r.mean(e).stdev(t)}function mI(e,t){const n=gI();let i=0;const r={data(s){return arguments.length?(e=s,i=s?s.length:0,r.bandwidth(t)):e},bandwidth(s){return arguments.length?(t=s,!t&&e&&(t=fI(e)),r):t},sample(){return e[~~(Vs()*i)]+t*n.sample()},pdf(s){let o=0,a=0;for(;a<i;++a)o+=n.pdf((s-e[a])/t);return o/t/i},cdf(s){let o=0,a=0;for(;a<i;++a)o+=n.cdf((s-e[a])/t);return o/i},icdf(){throw Error("KDE icdf not supported.")}};return r.data(e)}function vI(e,t){return e=e||0,t=t??1,Math.exp(e+Q1()*t)}function CI(e,t,n){if(e<=0)return 0;t=t||0,n=n??1;const i=(Math.log(e)-t)/n;return Math.exp(-.5*i*i)/(n*VU*e)}function yI(e,t,n){return Z1(Math.log(e),t,n)}function wI(e,t,n){return Math.exp(J1(e,t,n))}function WU(e,t){let n,i;const r={mean(s){return arguments.length?(n=s||0,r):n},stdev(s){return arguments.length?(i=s??1,r):i},sample:()=>vI(n,i),pdf:s=>CI(s,n,i),cdf:s=>yI(s,n,i),icdf:s=>wI(s,n,i)};return r.mean(e).stdev(t)}function UU(e,t){let n=0,i;function r(o){const a=[];let l=0,u;for(u=0;u<n;++u)l+=a[u]=o[u]==null?1:+o[u];for(u=0;u<n;++u)a[u]/=l;return a}const s={weights(o){return arguments.length?(i=r(t=o||[]),s):t},distributions(o){return arguments.length?(o?(n=o.length,e=o):(n=0,e=[]),s.weights(t)):e},sample(){const o=Vs();let a=e[n-1],l=i[0],u=0;for(;u<n-1;l+=i[++u])if(o<l){a=e[u];break}return a.sample()},pdf(o){let a=0,l=0;for(;l<n;++l)a+=i[l]*e[l].pdf(o);return a},cdf(o){let a=0,l=0;for(;l<n;++l)a+=i[l]*e[l].cdf(o);return a},icdf(){throw Error("Mixture icdf not supported.")}};return s.distributions(e).weights(t)}function bI(e,t){return t==null&&(t=e??1,e=0),e+(t-e)*Vs()}function SI(e,t,n){return n==null&&(n=t??1,t=0),e>=t&&e<=n?1/(n-t):0}function xI(e,t,n){return n==null&&(n=t??1,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function RI(e,t,n){return n==null&&(n=t??1,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function qU(e,t){let n,i;const r={min(s){return arguments.length?(n=s||0,r):n},max(s){return arguments.length?(i=s??1,r):i},sample:()=>bI(n,i),pdf:s=>SI(s,n,i),cdf:s=>xI(s,n,i),icdf:s=>RI(s,n,i)};return t==null&&(t=e??1,e=0),r.min(e).max(t)}function EI(e,t,n){let i=0,r=0;for(const s of e){const o=n(s);t(s)==null||o==null||isNaN(o)||(i+=(o-i)/++r)}return{coef:[i],predict:()=>i,rSquared:0}}function V0(e,t,n,i){const r=i-e*e,s=Math.abs(r)<1e-24?0:(n-e*t)/r;return[t-s*e,s]}function ex(e,t,n,i){e=e.filter(p=>{let g=t(p),m=n(p);return g!=null&&(g=+g)>=g&&m!=null&&(m=+m)>=m}),i&&e.sort((p,g)=>t(p)-t(g));const r=e.length,s=new Float64Array(r),o=new Float64Array(r);let a=0,l=0,u=0,c,d,h;for(h of e)s[a]=c=+t(h),o[a]=d=+n(h),++a,l+=(c-l)/a,u+=(d-u)/a;for(a=0;a<r;++a)s[a]-=l,o[a]-=u;return[s,o,l,u]}function W0(e,t,n,i){let r=-1,s,o;for(const a of e)s=t(a),o=n(a),s!=null&&(s=+s)>=s&&o!=null&&(o=+o)>=o&&i(s,o,++r)}function rg(e,t,n,i,r){let s=0,o=0;return W0(e,t,n,(a,l)=>{const u=l-r(a),c=l-i;s+=u*u,o+=c*c}),1-s/o}function FI(e,t,n){let i=0,r=0,s=0,o=0,a=0;W0(e,t,n,(c,d)=>{++a,i+=(c-i)/a,r+=(d-r)/a,s+=(c*d-s)/a,o+=(c*c-o)/a});const l=V0(i,r,s,o),u=c=>l[0]+l[1]*c;return{coef:l,predict:u,rSquared:rg(e,t,n,r,u)}}function jU(e,t,n){let i=0,r=0,s=0,o=0,a=0;W0(e,t,n,(c,d)=>{++a,c=Math.log(c),i+=(c-i)/a,r+=(d-r)/a,s+=(c*d-s)/a,o+=(c*c-o)/a});const l=V0(i,r,s,o),u=c=>l[0]+l[1]*Math.log(c);return{coef:l,predict:u,rSquared:rg(e,t,n,r,u)}}function KU(e,t,n){const[i,r,s,o]=ex(e,t,n);let a=0,l=0,u=0,c=0,d=0,h,p,g;W0(e,t,n,(b,S)=>{h=i[d++],p=Math.log(S),g=h*S,a+=(S*p-a)/d,l+=(g-l)/d,u+=(g*p-u)/d,c+=(h*g-c)/d});const[m,C]=V0(l/o,a/o,u/o,c/o),y=b=>Math.exp(m+C*(b-s));return{coef:[Math.exp(m-C*s),C],predict:y,rSquared:rg(e,t,n,o,y)}}function YU(e,t,n){let i=0,r=0,s=0,o=0,a=0,l=0;W0(e,t,n,(d,h)=>{const p=Math.log(d),g=Math.log(h);++l,i+=(p-i)/l,r+=(g-r)/l,s+=(p*g-s)/l,o+=(p*p-o)/l,a+=(h-a)/l});const u=V0(i,r,s,o),c=d=>u[0]*Math.pow(d,u[1]);return u[0]=Math.exp(u[0]),{coef:u,predict:c,rSquared:rg(e,t,n,a,c)}}function AI(e,t,n){const[i,r,s,o]=ex(e,t,n),a=i.length;let l=0,u=0,c=0,d=0,h=0,p,g,m,C;for(p=0;p<a;)g=i[p],m=r[p++],C=g*g,l+=(C-l)/p,u+=(C*g-u)/p,c+=(C*C-c)/p,d+=(g*m-d)/p,h+=(C*m-h)/p;const y=c-l*l,b=l*y-u*u,S=(h*l-d*u)/b,x=(d*y-h*u)/b,E=-S*l,A=F=>(F=F-s,S*F*F+x*F+E+o);return{coef:[E-x*s+S*s*s+o,x-2*S*s,S],predict:A,rSquared:rg(e,t,n,o,A)}}function XU(e,t,n,i){if(i===0)return EI(e,t,n);if(i===1)return FI(e,t,n);if(i===2)return AI(e,t,n);const[r,s,o,a]=ex(e,t,n),l=r.length,u=[],c=[],d=i+1;let h,p,g,m,C;for(h=0;h<d;++h){for(g=0,m=0;g<l;++g)m+=Math.pow(r[g],h)*s[g];for(u.push(m),C=new Float64Array(d),p=0;p<d;++p){for(g=0,m=0;g<l;++g)m+=Math.pow(r[g],h+p);C[p]=m}c.push(C)}c.push(u);const y=S0e(c),b=S=>{S-=o;let x=a+y[0]+y[1]*S+y[2]*S*S;for(h=3;h<d;++h)x+=y[h]*Math.pow(S,h);return x};return{coef:b0e(d,y,-o,a),predict:b,rSquared:rg(e,t,n,a,b)}}function b0e(e,t,n,i){const r=Array(e);let s,o,a,l;for(s=0;s<e;++s)r[s]=0;for(s=e-1;s>=0;--s)for(a=t[s],l=1,r[s]+=a,o=1;o<=s;++o)l*=(s+1-o)/o,r[s-o]+=a*Math.pow(n,o)*l;return r[0]+=i,r}function S0e(e){const t=e.length-1,n=[];let i,r,s,o,a;for(i=0;i<t;++i){for(o=i,r=i+1;r<t;++r)Math.abs(e[i][r])>Math.abs(e[i][o])&&(o=r);for(s=i;s<t+1;++s)a=e[s][i],e[s][i]=e[s][o],e[s][o]=a;for(r=i+1;r<t;++r)for(s=t;s>=i;s--)e[s][r]-=e[s][i]*e[i][r]/e[i][i]}for(r=t-1;r>=0;--r){for(a=0,s=r+1;s<t;++s)a+=e[s][r]*n[s];n[r]=(e[t][r]-a)/e[r][r]}return n}const sz=2,oz=1e-12;function QU(e,t,n,i){const[r,s,o,a]=ex(e,t,n,!0),l=r.length,u=Math.max(2,~~(i*l)),c=new Float64Array(l),d=new Float64Array(l),h=new Float64Array(l).fill(1);for(let p=-1;++p<=sz;){const g=[0,u-1];for(let C=0;C<l;++C){const y=r[C],b=g[0],S=g[1],x=y-r[b]>r[S]-y?b:S;let E=0,A=0,F=0,P=0,D=0;const M=1/Math.abs(r[x]-y||1);for(let H=b;H<=S;++H){const N=r[H],L=s[H],G=x0e(Math.abs(y-N)*M)*h[H],q=N*G;E+=G,A+=q,F+=L*G,P+=L*q,D+=N*q}const[O,B]=V0(A/E,F/E,P/E,D/E);c[C]=O+B*y,d[C]=Math.abs(s[C]-c[C]),R0e(r,C+1,g)}if(p===sz)break;const m=L8(d);if(Math.abs(m)<oz)break;for(let C=0,y,b;C<l;++C)y=d[C]/(6*m),h[C]=y>=1?oz:(b=1-y*y)*b}return E0e(r,c,o,a)}function x0e(e){return(e=1-e*e*e)*e*e}function R0e(e,t,n){const i=e[t];let r=n[0],s=n[1]+1;if(!(s>=e.length))for(;t>r&&e[s]-i<=i-e[r];)n[0]=++r,n[1]=s,++s}function E0e(e,t,n,i){const r=e.length,s=[];let o=0,a=0,l=[],u;for(;o<r;++o)u=e[o]+n,l[0]===u?l[1]+=(t[o]-l[1])/++a:(a=0,l[1]+=i,l=[u,t[o]],s.push(l));return l[1]+=i,s}const F0e=.5*Math.PI/180;function tx(e,t,n,i){n=n||25,i=Math.max(n,i||200);const r=m=>[m,e(m)],s=t[0],o=t[1],a=o-s,l=a/i,u=[r(s)],c=[];if(n===i){for(let m=1;m<i;++m)u.push(r(s+m/n*a));return u.push(r(o)),u}else{c.push(r(o));for(let m=n;--m>0;)c.push(r(s+m/n*a))}let d=u[0],h=c[c.length-1];const p=1/a,g=A0e(d[1],c);for(;h;){const m=r((d[0]+h[0])/2);m[0]-d[0]>=l&&D0e(d,m,h,p,g)>F0e?c.push(m):(d=h,u.push(h),c.pop()),h=c[c.length-1]}return u}function A0e(e,t){let n=e,i=e;const r=t.length;for(let s=0;s<r;++s){const o=t[s][1];o<n&&(n=o),o>i&&(i=o)}return 1/(i-n)}function D0e(e,t,n,i,r){const s=Math.atan2(r*(n[1]-e[1]),i*(n[0]-e[0])),o=Math.atan2(r*(t[1]-e[1]),i*(t[0]-e[0]));return Math.abs(s-o)}function k0e(e){return t=>{const n=e.length;let i=1,r=String(e[0](t));for(;i<n;++i)r+="|"+e[i](t);return r}}function Hk(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:k0e(e)}function ZU(e,t,n){return n||e+(t?"_"+t:"")}const tA=()=>{},P0e={init:tA,add:tA,rem:tA,idx:0},Uv={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.valid?e.sum:void 0,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3},exponential:{init:(e,t)=>{e.exp=0,e.exp_r=t},value:e=>e.valid?e.exp*(1-e.exp_r)/(1-e.exp_r**e.valid):void 0,add:(e,t)=>e.exp=e.exp_r*e.exp+t,rem:(e,t)=>e.exp=(e.exp-t/e.exp_r**(e.valid-1))/e.exp_r},exponentialb:{value:e=>e.valid?e.exp*(1-e.exp_r):void 0,req:["exponential"],idx:1}},U0=Object.keys(Uv).filter(e=>e!=="__count__");function M0e(e,t){return(n,i)=>it({name:e,aggregate_param:i,out:n||e},P0e,t)}[...U0,"__count__"].forEach(e=>{Uv[e]=M0e(e,Uv[e])});function JU(e,t,n){return Uv[e](n,t)}function e9(e,t){return e.idx-t.idx}function T0e(e){const t={};e.forEach(i=>t[i.name]=i);const n=i=>{i.req&&i.req.forEach(r=>{t[r]||n(t[r]=Uv[r]())})};return e.forEach(n),Object.values(t).sort(e9)}function I0e(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.aggregate_param==null?e.init(this):e.init(this,e.aggregate_param))}function _0e(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function O0e(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function L0e(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function t9(e,t){const n=t||zi,i=T0e(e),r=e.slice().sort(e9);function s(o){this._ops=i,this._out=r,this.cell=o,this.init()}return s.prototype.init=I0e,s.prototype.add=_0e,s.prototype.rem=O0e,s.prototype.set=L0e,s.prototype.get=n,s.fields=e.map(o=>o.out),s}function DI(e){this._key=e?Gs(e):$e,this.reset()}const Ei=DI.prototype;Ei.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};Ei.add=function(e){this._add.push(e)};Ei.rem=function(e){this._rem.push(e)};Ei.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,i=e.length,r=t.length,s=Array(i-r),o={};let a,l,u;for(a=0;a<r;++a)o[n(t[a])]=1;for(a=0,l=0;a<i;++a)o[n(u=e[a])]?o[n(u)]=0:s[l++]=u;return this._rem=[],this._add=s};Ei.distinct=function(e){const t=this.values(),n={};let i=t.length,r=0,s;for(;--i>=0;)s=e(t[i])+"",Ae(n,s)||(n[s]=1,++r);return r};Ei.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=v8(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext};Ei.argmin=function(e){return this.extent(e)[0]||{}};Ei.argmax=function(e){return this.extent(e)[1]||{}};Ei.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0};Ei.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0};Ei.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=hI(this.values(),e),this._get=e),this._q};Ei.q1=function(e){return this.quartile(e)[0]};Ei.q2=function(e){return this.quartile(e)[1]};Ei.q3=function(e){return this.quartile(e)[2]};Ei.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=zU(this.values(),1e3,.05,e),this._get=e),this._ci};Ei.ci0=function(e){return this.ci(e)[0]};Ei.ci1=function(e){return this.ci(e)[1]};function ec(e){Q.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}ec.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:U0},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};me(ec,Q,{transform(e,t){const n=this,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.modified();return n.stamp=i.stamp,n.value&&(r||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=r?n.init(e):Object.create(null),t.visit(t.SOURCE,s=>n.add(s))):(n.value=n.value||n.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),i.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&i.clean(!0).runAfter(()=>this.clean()),n.changes(i)},cross(){const e=this,t=e.value,n=e._dnames,i=n.map(()=>({})),r=n.length;function s(a){let l,u,c,d;for(l in a)for(c=a[l].tuple,u=0;u<r;++u)i[u][d=c[n[u]]]=d}s(e._prev),s(t);function o(a,l,u){const c=n[u],d=i[u++];for(const h in d){const p=a?a+"|"+h:h;l[c]=d[h],u<r?o(p,l,u):t[p]||e.cell(p,l)}}o("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],i={};function r(b){const S=xe(Li(b)),x=S.length;let E=0,A;for(;E<x;++E)i[A=S[E]]||(i[A]=1,t.push(A))}this._dims=xe(e.groupby),this._dnames=this._dims.map(b=>{const S=xn(b);return r(b),n.push(S),S}),this.cellkey=e.key?e.key:Hk(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const s=e.fields||[null],o=e.ops||["count"],a=e.aggregate_params||[null],l=e.as||[],u=s.length,c={};let d,h,p,g,m,C,y;for(u!==o.length&&te("Unmatched number of fields and aggregate ops."),y=0;y<u;++y){if(d=s[y],h=o[y],p=a[y]||null,d==null&&h!=="count"&&te("Null aggregate field specified."),m=xn(d),C=ZU(h,m,l[y]),n.push(C),h==="count"){this._counts.push(C);continue}g=c[m],g||(r(d),g=c[m]=[],g.field=d,this._measures.push(g)),h!=="count"&&(this._countOnly=!1),g.push(JU(h,p,C))}return this._measures=this._measures.map(b=>t9(b,b.field)),Object.create(null)},cellkey:Hk(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const i=this._measures,r=i.length;n.agg=Array(r);for(let s=0;s<r;++s)n.agg[s]=new i[s](n)}return n.store&&(n.data=new DI),n},newtuple(e,t){const n=this._dnames,i=this._dims,r=i.length,s={};for(let o=0;o<r;++o)s[n[o]]=i[o](e);return t?IU(t.tuple,s):It(s)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const i=n.agg;for(let r=0,s=i.length;r<s;++r)i[r].add(i[r].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const i=n.agg;for(let r=0,s=i.length;r<s;++r)i[r].rem(i[r].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let i=0,r=n.length;i<r;++i)t[n[i]]=e.num;if(!this._countOnly){const i=e.agg;for(let r=0,s=i.length;r<s;++r)i[r].set(t)}return t},changes(e){const t=this._adds,n=this._mods,i=this._prev,r=this._drop,s=e.add,o=e.rem,a=e.mod;let l,u,c,d;if(i)for(u in i)l=i[u],(!r||l.num)&&o.push(l.tuple);for(c=0,d=this._alen;c<d;++c)s.push(this.celltuple(t[c])),t[c]=null;for(c=0,d=this._mlen;c<d;++c)l=n[c],(l.num===0&&r?o:a).push(this.celltuple(l)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});const N0e=1e-14;function kI(e){Q.call(this,null,e)}kI.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};me(kI,Q,{transform(e,t){const n=e.interval!==!1,i=this._bins(e),r=i.start,s=i.step,o=e.as||["bin0","bin1"],a=o[0],l=o[1];let u;return e.modified()?(t=t.reflow(!0),u=t.SOURCE):u=t.modified(Li(e.field))?t.ADD_MOD:t.ADD,t.visit(u,n?c=>{const d=i(c);c[a]=d,c[l]=d==null?null:r+s*(1+(d-r)/s)}:c=>c[a]=i(c)),t.modifies(n?o:a)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=GU(e),i=n.step;let r=n.start,s=r+Math.ceil((n.stop-r)/i)*i,o,a;(o=e.anchor)!=null&&(a=o-(r+i*Math.floor((o-r)/i)),r+=a,s+=a);const l=function(u){let c=_i(t(u));return c==null?null:c<r?-1/0:c>s?1/0:(c=Math.max(r,Math.min(c,s-i)),r+i*Math.floor(N0e+(c-r)/i))};return l.start=r,l.stop=n.stop,l.step=i,this.value=$r(l,Li(t),e.name||"bin_"+xn(t))}});function n9(e,t,n){const i=e;let r=t||[],s=n||[],o={},a=0;return{add:l=>s.push(l),remove:l=>o[i(l)]=++a,size:()=>r.length,data:(l,u)=>(a&&(r=r.filter(c=>!o[i(c)]),o={},a=0),u&&l&&r.sort(l),s.length&&(r=l?x8(l,r,s.sort(l)):r.concat(s),s=[]),r)}}function PI(e){Q.call(this,[],e)}PI.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};me(PI,Q,{transform(e,t){const n=t.fork(t.ALL),i=n9($e,this.value,n.materialize(n.ADD).add),r=e.sort,s=t.changed()||r&&(e.modified("sort")||t.modified(r.fields));return n.visit(n.REM,i.remove),this.modified(s),this.value=n.source=i.data(yh(r),s),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function i9(e){qt.call(this,null,$0e,e)}me(i9,qt);function $0e(e){return this.value&&!e.modified()?this.value:WT(e.fields,e.orders)}function MI(e){Q.call(this,null,e)}MI.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function B0e(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}me(MI,Q,{transform(e,t){const n=d=>h=>{for(var p=B0e(a(h),e.case,s)||[],g,m=0,C=p.length;m<C;++m)o.test(g=p[m])||d(g)},i=this._parameterCheck(e,t),r=this._counts,s=this._match,o=this._stop,a=e.field,l=e.as||["text","count"],u=n(d=>r[d]=1+(r[d]||0)),c=n(d=>r[d]-=1);return i?t.visit(t.SOURCE,u):(t.visit(t.ADD,u),t.visit(t.REM,c)),this._finish(t,l)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,i=this._tuples||(this._tuples={}),r=t[0],s=t[1],o=e.fork(e.NO_SOURCE|e.NO_FIELDS);let a,l,u;for(a in n)l=i[a],u=n[a]||0,!l&&u?(i[a]=l=It({}),l[r]=a,l[s]=u,o.add.push(l)):u===0?(l&&o.rem.push(l),n[a]=null,i[a]=null):l[s]!==u&&(l[s]=u,o.mod.push(l));return o.modifies(t)}});function TI(e){Q.call(this,null,e)}TI.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};me(TI,Q,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.as||["a","b"],r=i[0],s=i[1],o=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let a=this.value;return o?(a&&(n.rem=a),a=t.materialize(t.SOURCE).source,n.add=this.value=G0e(a,r,s,e.filter||zs)):n.mod=a,n.source=this.value,n.modifies(i)}});function G0e(e,t,n,i){for(var r=[],s={},o=e.length,a=0,l,u;a<o;++a)for(s[t]=u=e[a],l=0;l<o;++l)s[n]=e[l],i(s)&&(r.push(It(s)),s={},s[t]=u);return r}const az={kde:mI,mixture:UU,normal:gI,lognormal:WU,uniform:qU},z0e="distributions",lz="function",H0e="field";function r9(e,t){const n=e[lz];Ae(az,n)||te("Unknown distribution function: "+n);const i=az[n]();for(const r in e)r===H0e?i.data((e.from||t()).map(e[r])):r===z0e?i[r](e[r].map(s=>r9(s,t))):typeof i[r]===lz&&i[r](e[r]);return i}function II(e){Q.call(this,null,e)}const s9=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],V0e={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:s9},{name:"weights",type:"number",array:!0}]};II.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:s9.concat(V0e)},{name:"as",type:"string",array:!0,default:["value","density"]}]};me(II,Q,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=r9(e.distribution,W0e(t)),r=e.steps||e.minsteps||25,s=e.steps||e.maxsteps||200;let o=e.method||"pdf";o!=="pdf"&&o!=="cdf"&&te("Invalid density method: "+o),!e.extent&&!i.data&&te("Missing density extent parameter."),o=i[o];const a=e.as||["value","density"],l=e.extent||Ea(i.data()),u=tx(o,l,r,s).map(c=>{const d={};return d[a[0]]=c[0],d[a[1]]=c[1],It(d)});this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});function W0e(e){return()=>e.materialize(e.SOURCE).source}function o9(e,t){return e?e.map((n,i)=>t[i]||xn(n)):null}function _I(e,t,n){const i=[],r=d=>d(l);let s,o,a,l,u,c;if(t==null)i.push(e.map(n));else for(s={},o=0,a=e.length;o<a;++o)l=e[o],u=t.map(r),c=s[u],c||(s[u]=c=[],c.dims=u,i.push(c)),c.push(n(l));return i}const a9="bin";function OI(e){Q.call(this,null,e)}OI.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:a9}]};const U0e=(e,t)=>H0(Ea(e,t))/30;me(OI,Q,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,i=_I(t.source,e.groupby,zi),r=e.smooth||!1,s=e.field,o=e.step||U0e(n,s),a=yh((g,m)=>s(g)-s(m)),l=e.as||a9,u=i.length;let c=1/0,d=-1/0,h=0,p;for(;h<u;++h){const g=i[h].sort(a);p=-1;for(const m of HU(g,o,r,s))m<c&&(c=m),m>d&&(d=m),g[++p][l]=m}return this.value={start:c,stop:d,step:o},t.reflow(!0).modifies(l)}});function l9(e){qt.call(this,null,q0e,e),this.modified(!0)}me(l9,qt);function q0e(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:$r(n=>t(n,e),Li(t),xn(t))}function LI(e){Q.call(this,[void 0,void 0],e)}LI.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};me(LI,Q,{transform(e,t){const n=this.value,i=e.field,r=t.changed()||t.modified(i.fields)||e.modified("field");let s=n[0],o=n[1];if((r||s==null)&&(s=1/0,o=-1/0),t.visit(r?t.SOURCE:t.ADD,a=>{const l=_i(i(a));l!=null&&(l<s&&(s=l),l>o&&(o=l))}),!Number.isFinite(s)||!Number.isFinite(o)){let a=xn(i);a&&(a=` for field "${a}"`),t.dataflow.warn(`Infinite extent${a}: [${s}, ${o}]`),s=o=void 0}this.value=[s,o]}});function NI(e,t){qt.call(this,e),this.parent=t,this.count=0}me(NI,qt,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function nx(e){Q.call(this,{},e),this._keys=Zp();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let i=0,r=t.active;i<r;++i)n(t[i],i,t)}}me(nx,Q,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,i){const r=this.value;let s=Ae(r,e)&&r[e],o,a;return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(a=i||(a=this._group[e])&&a.tuple,o=n.dataflow,s=new NI(n.fork(n.NO_SOURCE),this),o.add(s).connect(t(o,e,a)),r[e]=s,this.activate(s)),s},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const i=e[n].detachSubflow;i&&i(),delete e[n],++t}if(t){const n=this._targets.filter(i=>i&&i.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,i=e?e.length:0;let r=0;for(;r<i;++r)t[r]=e[r];for(;r<n&&t[r]!=null;++r)t[r]=null;t.active=i},transform(e,t){const n=t.dataflow,i=e.key,r=e.subflow,s=this._keys,o=e.modified("key"),a=l=>this.subflow(l,r,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,l=>{const u=$e(l),c=s.get(u);c!==void 0&&(s.delete(u),a(c).rem(l))}),t.visit(t.ADD,l=>{const u=i(l);s.set($e(l),u),a(u).add(l)}),o||t.modified(i.fields)?t.visit(t.MOD,l=>{const u=$e(l),c=s.get(u),d=i(l);c===d?a(d).mod(l):(s.set(u,d),a(c).rem(l),a(d).add(l))}):t.changed(t.MOD)&&t.visit(t.MOD,l=>{a(s.get($e(l))).mod(l)}),o&&t.visit(t.REFLOW,l=>{const u=$e(l),c=s.get(u),d=i(l);c!==d&&(s.set(u,d),a(c).rem(l),a(d).add(l))}),t.clean()?n.runAfter(()=>{this.clean(),s.clean()}):s.empty>n.cleanThreshold&&n.runAfter(s.clean),t}});function u9(e){qt.call(this,null,j0e,e)}me(u9,qt);function j0e(e){return this.value&&!e.modified()?this.value:ne(e.name)?xe(e.name).map(t=>Gs(t)):Gs(e.name,e.as)}function $I(e){Q.call(this,Zp(),e)}$I.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};me($I,Q,{transform(e,t){const n=t.dataflow,i=this.value,r=t.fork(),s=r.add,o=r.rem,a=r.mod,l=e.expr;let u=!0;t.visit(t.REM,d=>{const h=$e(d);i.has(h)?i.delete(h):o.push(d)}),t.visit(t.ADD,d=>{l(d,e)?s.push(d):i.set($e(d),1)});function c(d){const h=$e(d),p=l(d,e),g=i.get(h);p&&g?(i.delete(h),s.push(d)):!p&&!g?(i.set(h,1),o.push(d)):u&&p&&!g&&a.push(d)}return t.visit(t.MOD,c),e.modified()&&(u=!1,t.visit(t.REFLOW,c)),i.empty>n.cleanThreshold&&n.runAfter(i.clean),r}});function BI(e){Q.call(this,[],e)}BI.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};me(BI,Q,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=o9(i,e.as||[]),s=e.index||null,o=r.length;return n.rem=this.value,t.visit(t.SOURCE,a=>{const l=i.map(g=>g(a)),u=l.reduce((g,m)=>Math.max(g,m.length),0);let c=0,d,h,p;for(;c<u;++c){for(h=lI(a),d=0;d<o;++d)h[r[d]]=(p=l[d][c])==null?null:p;s&&(h[s]=c),n.add.push(h)}}),this.value=n.source=n.add,s&&n.modifies(s),n.modifies(r)}});function GI(e){Q.call(this,[],e)}GI.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};me(GI,Q,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=i.map(xn),s=e.as||["key","value"],o=s[0],a=s[1],l=i.length;return n.rem=this.value,t.visit(t.SOURCE,u=>{for(let c=0,d;c<l;++c)d=lI(u),d[o]=r[c],d[a]=i[c](u),n.add.push(d)}),this.value=n.source=n.add,n.modifies(s)}});function zI(e){Q.call(this,null,e)}zI.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};me(zI,Q,{transform(e,t){const n=e.expr,i=e.as,r=e.modified(),s=e.initonly?t.ADD:r?t.SOURCE:t.modified(n.fields)||t.modified(i)?t.ADD_MOD:t.ADD;return r&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(i),t.visit(s,o=>o[i]=n(o,e))}});function c9(e){Q.call(this,[],e)}me(c9,Q,{transform(e,t){const n=t.fork(t.ALL),i=e.generator;let r=this.value,s=e.size-r.length,o,a,l;if(s>0){for(o=[];--s>=0;)o.push(l=It(i(e))),r.push(l);n.add=n.add.length?n.materialize(n.ADD).add.concat(o):o}else a=r.slice(0,-s),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(a):a,r=r.slice(-s);return n.source=this.value=r,n}});const Uy={value:"value",median:L8,mean:kge,min:Mk,max:Ad},K0e=[];function HI(e){Q.call(this,[],e)}HI.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function Y0e(e){var t=e.method||Uy.value,n;if(Uy[t]==null)te("Unrecognized imputation method: "+t);else return t===Uy.value?(n=e.value!==void 0?e.value:0,()=>n):Uy[t]}function X0e(e){const t=e.field;return n=>n?t(n):NaN}me(HI,Q,{transform(e,t){var n=t.fork(t.ALL),i=Y0e(e),r=X0e(e),s=xn(e.field),o=xn(e.key),a=(e.groupby||[]).map(xn),l=Q0e(t.source,e.groupby,e.key,e.keyvals),u=[],c=this.value,d=l.domain.length,h,p,g,m,C,y,b,S,x,E;for(C=0,S=l.length;C<S;++C)for(h=l[C],g=h.values,p=NaN,b=0;b<d;++b)if(h[b]==null){for(m=l.domain[b],E={_impute:!0},y=0,x=g.length;y<x;++y)E[a[y]]=g[y];E[o]=m,E[s]=Number.isNaN(p)?p=i(h,r):p,u.push(It(E))}return u.length&&(n.add=n.materialize(n.ADD).add.concat(u)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=u,n}});function Q0e(e,t,n,i){var r=y=>y(C),s=[],o=i?i.slice():[],a={},l={},u,c,d,h,p,g,m,C;for(o.forEach((y,b)=>a[y]=b+1),h=0,m=e.length;h<m;++h)C=e[h],g=n(C),p=a[g]||(a[g]=o.push(g)),c=(u=t?t.map(r):K0e)+"",(d=l[c])||(d=l[c]=[],s.push(d),d.values=u),d[p-1]=C;return s.domain=o,s}function VI(e){ec.call(this,e)}VI.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:U0},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};me(VI,ec,{transform(e,t){const n=this,i=e.modified();let r;return n.value&&(i||t.modified(n._inputs,!0))?(r=n.value=i?n.init(e):{},t.visit(t.SOURCE,s=>n.add(s))):(r=n.value=n.value||this.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),n.changes(),t.visit(t.SOURCE,s=>{it(s,r[n.cellkey(s)].tuple)}),t.reflow(i).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,i;for(n=0,i=this._alen;n<i;++n)this.celltuple(e[n]),e[n]=null;for(n=0,i=this._mlen;n<i;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function WI(e){Q.call(this,null,e)}WI.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};me(WI,Q,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=_I(i,e.groupby,e.field),s=(e.groupby||[]).map(xn),o=e.bandwidth,a=e.cumulative?"cdf":"pdf",l=e.as||["value","density"],u=[];let c=e.extent,d=e.steps||e.minsteps||25,h=e.steps||e.maxsteps||200;a!=="pdf"&&a!=="cdf"&&te("Invalid density method: "+a),e.resolve==="shared"&&(c||(c=Ea(i,e.field)),d=h=e.steps||h),r.forEach(p=>{const g=mI(p,o)[a],m=e.counts?p.length:1,C=c||Ea(p);tx(g,C,d,h).forEach(y=>{const b={};for(let S=0;S<s.length;++S)b[s[S]]=p.dims[S];b[l[0]]=y[0],b[l[1]]=y[1]*m,u.push(It(b))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});function d9(e){qt.call(this,null,Z0e,e)}me(d9,qt);function Z0e(e){return this.value&&!e.modified()?this.value:qT(e.fields,e.flat)}function h9(e){Q.call(this,[],e),this._pending=null}me(h9,Q,{transform(e,t){const n=t.dataflow;return this._pending?nA(this,t,this._pending):J0e(e)?t.StopPropagation:e.values?nA(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(r=>(this._pending=xe(r.data),s=>s.touch(this)))}:n.request(e.url,e.format).then(i=>nA(this,t,xe(i.data)))}});function J0e(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function nA(e,t,n){n.forEach(It);const i=t.fork(t.NO_FIELDS&t.NO_SOURCE);return i.rem=e.value,e.value=i.source=i.add=n,e._pending=null,i.rem.length&&i.clean(!0),i}function UI(e){Q.call(this,{},e)}UI.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};me(UI,Q,{transform(e,t){const n=e.fields,i=e.index,r=e.values,s=e.default==null?null:e.default,o=e.modified(),a=n.length;let l=o?t.SOURCE:t.ADD,u=t,c=e.as,d,h,p;return r?(h=r.length,a>1&&!c&&te('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==a*h&&te('The "as" parameter has too few output field names.'),c=c||r.map(xn),d=function(g){for(var m=0,C=0,y,b;m<a;++m)if(b=i.get(n[m](g)),b==null)for(y=0;y<h;++y,++C)g[c[C]]=s;else for(y=0;y<h;++y,++C)g[c[C]]=r[y](b)}):(c||te("Missing output field names."),d=function(g){for(var m=0,C;m<a;++m)C=i.get(n[m](g)),g[c[m]]=C??s}),o?u=t.reflow(!0):(p=n.some(g=>t.modified(g.fields)),l|=p?t.MOD:0),t.visit(l,d),u.modifies(c)}});function f9(e){qt.call(this,null,eCe,e)}me(f9,qt);function eCe(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let i=1/0,r=-1/0,s,o;for(s=0;s<n;++s)o=t[s],o[0]<i&&(i=o[0]),o[1]>r&&(r=o[1]);return[i,r]}function p9(e){qt.call(this,null,tCe,e)}me(p9,qt);function tCe(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function g9(e){Q.call(this,null,e)}me(g9,Q,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function qI(e){ec.call(this,e)}qI.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:U0,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};me(qI,ec,{_transform:ec.prototype.transform,transform(e,t){return this._transform(nCe(e,t),t)}});function nCe(e,t){const n=e.field,i=e.value,r=(e.op==="count"?"__count__":e.op)||"sum",s=Li(n).concat(Li(i)),o=rCe(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:o.map(()=>r),fields:o.map(a=>iCe(a,n,i,s)),as:o.map(a=>a+""),modified:e.modified.bind(e)}}function iCe(e,t,n,i){return $r(r=>t(r)===e?n(r):NaN,i,e+"")}function rCe(e,t,n){const i={},r=[];return n.visit(n.SOURCE,s=>{const o=e(s);i[o]||(i[o]=1,r.push(o))}),r.sort(Qp),t?r.slice(0,t):r}function m9(e){nx.call(this,e)}me(m9,nx,{transform(e,t){const n=e.subflow,i=e.field,r=s=>this.subflow($e(s),n,t,s);return(e.modified("field")||i&&t.modified(Li(i)))&&te("PreFacet does not support field modification."),this.initTargets(),i?(t.visit(t.MOD,s=>{const o=r(s);i(s).forEach(a=>o.mod(a))}),t.visit(t.ADD,s=>{const o=r(s);i(s).forEach(a=>o.add(It(a)))}),t.visit(t.REM,s=>{const o=r(s);i(s).forEach(a=>o.rem(a))})):(t.visit(t.MOD,s=>r(s).mod(s)),t.visit(t.ADD,s=>r(s).add(s)),t.visit(t.REM,s=>r(s).rem(s))),t.clean()&&t.runAfter(()=>this.clean()),t}});function jI(e){Q.call(this,null,e)}jI.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};me(jI,Q,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=o9(e.fields,e.as||[]),s=i?(a,l)=>sCe(a,l,i,r):K1;let o;return this.value?o=this.value:(t=t.addAll(),o=this.value={}),t.visit(t.REM,a=>{const l=$e(a);n.rem.push(o[l]),o[l]=null}),t.visit(t.ADD,a=>{const l=s(a,It({}));o[$e(a)]=l,n.add.push(l)}),t.visit(t.MOD,a=>{n.mod.push(s(a,o[$e(a)]))}),n}});function sCe(e,t,n,i){for(let r=0,s=n.length;r<s;++r)t[i[r]]=n[r](e);return t}function v9(e){Q.call(this,null,e)}me(v9,Q,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function KI(e){Q.call(this,null,e)}KI.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const oCe=1e-14;me(KI,Q,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const r=t.materialize(t.SOURCE).source,s=_I(r,e.groupby,e.field),o=(e.groupby||[]).map(xn),a=[],l=e.step||.01,u=e.probs||Ar(l/2,1-oCe,l),c=u.length;return s.forEach(d=>{const h=dI(d,u);for(let p=0;p<c;++p){const g={};for(let m=0;m<o.length;++m)g[o[m]]=d.dims[m];g[i[0]]=u[p],g[i[1]]=h[p],a.push(It(g))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}});function C9(e){Q.call(this,null,e)}me(C9,Q,{transform(e,t){let n,i;return this.value?i=this.value:(n=t=t.addAll(),i=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,r=>{const s=$e(r);n.rem.push(i[s]),i[s]=null}),t.visit(t.ADD,r=>{const s=lI(r);i[$e(r)]=s,n.add.push(s)}),t.visit(t.MOD,r=>{const s=i[$e(r)];for(const o in r)s[o]=r[o],n.modifies(o);n.mod.push(s)})),n}});function YI(e){Q.call(this,[],e),this.count=0}YI.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};me(YI,Q,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.modified("size"),r=e.size,s=this.value.reduce((c,d)=>(c[$e(d)]=1,c),{});let o=this.value,a=this.count,l=0;function u(c){let d,h;o.length<r?o.push(c):(h=~~((a+1)*Vs()),h<o.length&&h>=l&&(d=o[h],s[$e(d)]&&n.rem.push(d),o[h]=c)),++a}if(t.rem.length&&(t.visit(t.REM,c=>{const d=$e(c);s[d]&&(s[d]=-1,n.rem.push(c)),--a}),o=o.filter(c=>s[$e(c)]!==-1)),(t.rem.length||i)&&o.length<r&&t.source&&(l=a=o.length,t.visit(t.SOURCE,c=>{s[$e(c)]||u(c)}),l=-1),i&&o.length>r){const c=o.length-r;for(let d=0;d<c;++d)s[$e(o[d])]=-1,n.rem.push(o[d]);o=o.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{s[$e(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,u),(t.add.length||l<0)&&(n.add=o.filter(c=>!s[$e(c)])),this.count=a,this.value=n.source=o,n}});function XI(e){Q.call(this,null,e)}XI.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};me(XI,Q,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),i=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=Ar(e.start,e.stop,e.step||1).map(r=>{const s={};return s[i]=r,It(s)}),n.add=t.add.concat(this.value),n}});function y9(e){Q.call(this,null,e),this.modified(!0)}me(y9,Q,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function QI(e){Q.call(this,null,e)}const w9=["unit0","unit1"];QI.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:JT,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:w9}]};me(QI,Q,{transform(e,t){const n=e.field,i=e.interval!==!1,r=e.timezone==="utc",s=this._floor(e,t),o=(r?ig:ng)(s.unit).offset,a=e.as||w9,l=a[0],u=a[1],c=s.step;let d=s.start||1/0,h=s.stop||-1/0,p=t.ADD;return(e.modified()||t.changed(t.REM)||t.modified(Li(n)))&&(t=t.reflow(!0),p=t.SOURCE,d=1/0,h=-1/0),t.visit(p,g=>{const m=n(g);let C,y;m==null?(g[l]=null,i&&(g[u]=null)):(g[l]=C=y=s(m),i&&(g[u]=y=o(C,c)),C<d&&(d=C),y>h&&(h=y))}),s.start=d,s.stop=h,t.modifies(i?a:l)},_floor(e,t){const n=e.timezone==="utc",{units:i,step:r}=e.units?{units:e.units,step:e.step||1}:cU({extent:e.extent||Ea(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),s=eI(i),o=this.value||{},a=(n?tU:eU)(s,r);return a.unit=wt(s),a.units=s,a.step=r,a.start=o.start,a.stop=o.stop,this.value=a}});function b9(e){Q.call(this,Zp(),e)}me(b9,Q,{transform(e,t){const n=t.dataflow,i=e.field,r=this.value,s=a=>r.set(i(a),a);let o=!0;return e.modified("field")||t.modified(i.fields)?(r.clear(),t.visit(t.SOURCE,s)):t.changed()?(t.visit(t.REM,a=>r.delete(i(a))),t.visit(t.ADD,s)):o=!1,this.modified(o),r.empty>n.cleanThreshold&&n.runAfter(r.clean),t.fork()}});function S9(e){Q.call(this,null,e)}me(S9,Q,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(yh(e.sort)):t.source).map(e.field))}});function aCe(e,t,n,i){const r=qv[e](t,n);return{init:r.init||Tu,update:function(s,o){o[i]=r.next(s)}}}const qv={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?++e:e}}},percent_rank:function(){const e=qv.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,i=t.compare;let r=t.index;if(e<r){for(;r+1<n.length&&!i(n[r],n[r+1]);)++r;e=r}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||te("ntile num must be greater than zero.");const n=qv.cume_dist(),i=n.next;return{init:n.init,next:r=>Math.ceil(t*i(r))}},lag:function(e,t){return t=+t||1,{next:n=>{const i=n.index-t;return i>=0?e(n.data[i]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const i=n.index+t,r=n.data;return i<r.length?e(r[i]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||te("nth_value nth must be greater than zero."),{next:n=>{const i=n.i0+(t-1);return i<n.i1?e(n.data[i]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const i=e(n.data[n.index]);return i!=null?t=i:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:i=>{const r=i.data;return i.index<=n?t:(n=lCe(e,r,i.index))<0?(n=r.length,t=null):t=e(r[n])}}}};function lCe(e,t,n){for(let i=t.length;n<i;++n)if(e(t[n])!=null)return n;return-1}const uCe=Object.keys(qv);function x9(e){const t=xe(e.ops),n=xe(e.fields),i=xe(e.params),r=xe(e.aggregate_params),s=xe(e.as),o=this.outputs=[],a=this.windows=[],l={},u={},c=[],d=[];let h=!0;function p(g){xe(Li(g)).forEach(m=>l[m]=1)}p(e.sort),t.forEach((g,m)=>{const C=n[m],y=i[m],b=r[m]||null,S=xn(C),x=ZU(g,S,s[m]);if(p(C),o.push(x),Ae(qv,g))a.push(aCe(g,C,y,x));else{if(C==null&&g!=="count"&&te("Null aggregate field specified."),g==="count"){c.push(x);return}h=!1;let E=u[S];E||(E=u[S]=[],E.field=C,d.push(E)),E.push(JU(g,b,x))}}),(c.length||d.length)&&(this.cell=cCe(d,c,h)),this.inputs=Object.keys(l)}const R9=x9.prototype;R9.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()};R9.update=function(e,t){const n=this.cell,i=this.windows,r=e.data,s=i&&i.length;let o;if(n){for(o=e.p0;o<e.i0;++o)n.rem(r[o]);for(o=e.p1;o<e.i1;++o)n.add(r[o]);n.set(t)}for(o=0;o<s;++o)i[o].update(e,t)};function cCe(e,t,n){e=e.map(l=>t9(l,l.field));const i={num:0,agg:null,store:!1,count:t};if(!n)for(var r=e.length,s=i.agg=Array(r),o=0;o<r;++o)s[o]=new e[o](i);if(i.store)var a=i.data=new DI;return i.add=function(l){if(i.num+=1,!n){a&&a.add(l);for(let u=0;u<r;++u)s[u].add(s[u].get(l),l)}},i.rem=function(l){if(i.num-=1,!n){a&&a.rem(l);for(let u=0;u<r;++u)s[u].rem(s[u].get(l),l)}},i.set=function(l){let u,c;for(a&&a.values(),u=0,c=t.length;u<c;++u)l[t[u]]=i.num;if(!n)for(u=0,c=s.length;u<c;++u)s[u].set(l)},i.init=function(){i.num=0,a&&a.reset();for(let l=0;l<r;++l)s[l].init()},i}function ZI(e){Q.call(this,{},e),this._mlen=0,this._mods=[]}ZI.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:uCe.concat(U0)},{name:"params",type:"number",null:!0,array:!0},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};me(ZI,Q,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),i=yh(e.sort),r=Hk(e.groupby),s=a=>this.group(r(a));let o=this.state;(!o||n)&&(o=this.state=new x9(e)),n||t.modified(o.inputs)?(this.value={},t.visit(t.SOURCE,a=>s(a).add(a))):(t.visit(t.REM,a=>s(a).remove(a)),t.visit(t.ADD,a=>s(a).add(a)));for(let a=0,l=this._mlen;a<l;++a)dCe(this._mods[a],o,i,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(o.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=n9($e),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function dCe(e,t,n,i){const r=i.sort,s=r&&!i.ignorePeers,o=i.frame||[null,0],a=e.data(n),l=a.length,u=s?Jp(r):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:a,compare:r||Hi(-1)};t.init();for(let d=0;d<l;++d)hCe(c,o,d,l),s&&fCe(c,u),t.update(c,a[d])}function hCe(e,t,n,i){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?i:Math.min(i,n+Math.abs(t[1])+1),e.index=n}function fCe(e,t){const n=e.i0,i=e.i1-1,r=e.compare,s=e.data,o=s.length-1;n>0&&!r(s[n],s[n-1])&&(e.i0=t.left(s,s[n])),i<o&&!r(s[i],s[i+1])&&(e.i1=t.right(s,s[i]))}const pCe=Object.freeze(Object.defineProperty({__proto__:null,aggregate:ec,bin:kI,collect:PI,compare:i9,countpattern:MI,cross:TI,density:II,dotbin:OI,expression:l9,extent:LI,facet:nx,field:u9,filter:$I,flatten:BI,fold:GI,formula:zI,generate:c9,impute:HI,joinaggregate:VI,kde:WI,key:d9,load:h9,lookup:UI,multiextent:f9,multivalues:p9,params:g9,pivot:qI,prefacet:m9,project:jI,proxy:v9,quantile:KI,relay:C9,sample:YI,sequence:XI,sieve:y9,subflow:NI,timeunit:QI,tupleindex:b9,values:S9,window:ZI},Symbol.toStringTag,{value:"Module"}));function Ot(e){return function(){return e}}const uz=Math.abs,Di=Math.atan2,Zc=Math.cos,gCe=Math.max,iA=Math.min,Qo=Math.sin,wd=Math.sqrt,Pi=1e-12,lp=Math.PI,_b=lp/2,E9=2*lp;function mCe(e){return e>1?0:e<-1?lp:Math.acos(e)}function cz(e){return e>=1?_b:e<=-1?-_b:Math.asin(e)}const Vk=Math.PI,Wk=2*Vk,ud=1e-6,vCe=Wk-ud;function F9(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function CCe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return F9;const n=10**t;return function(i){this._+=i[0];for(let r=1,s=i.length;r<s;++r)this._+=Math.round(arguments[r]*n)/n+i[r]}}let JI=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?F9:CCe(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,i,r){this._append`Q${+t},${+n},${this._x1=+i},${this._y1=+r}`}bezierCurveTo(t,n,i,r,s,o){this._append`C${+t},${+n},${+i},${+r},${this._x1=+s},${this._y1=+o}`}arcTo(t,n,i,r,s){if(t=+t,n=+n,i=+i,r=+r,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,a=this._y1,l=i-t,u=r-n,c=o-t,d=a-n,h=c*c+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(h>ud)if(!(Math.abs(d*l-u*c)>ud)||!s)this._append`L${this._x1=t},${this._y1=n}`;else{let p=i-o,g=r-a,m=l*l+u*u,C=p*p+g*g,y=Math.sqrt(m),b=Math.sqrt(h),S=s*Math.tan((Vk-Math.acos((m+h-C)/(2*y*b)))/2),x=S/b,E=S/y;Math.abs(x-1)>ud&&this._append`L${t+x*c},${n+x*d}`,this._append`A${s},${s},0,0,${+(d*p>c*g)},${this._x1=t+E*l},${this._y1=n+E*u}`}}arc(t,n,i,r,s,o){if(t=+t,n=+n,i=+i,o=!!o,i<0)throw new Error(`negative radius: ${i}`);let a=i*Math.cos(r),l=i*Math.sin(r),u=t+a,c=n+l,d=1^o,h=o?r-s:s-r;this._x1===null?this._append`M${u},${c}`:(Math.abs(this._x1-u)>ud||Math.abs(this._y1-c)>ud)&&this._append`L${u},${c}`,i&&(h<0&&(h=h%Wk+Wk),h>vCe?this._append`A${i},${i},0,1,${d},${t-a},${n-l}A${i},${i},0,1,${d},${this._x1=u},${this._y1=c}`:h>ud&&this._append`A${i},${i},0,${+(h>=Vk)},${d},${this._x1=t+i*Math.cos(s)},${this._y1=n+i*Math.sin(s)}`)}rect(t,n,i,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${i=+i}v${+r}h${-i}Z`}toString(){return this._}};function ix(){return new JI}ix.prototype=JI.prototype;function rx(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const i=Math.floor(n);if(!(i>=0))throw new RangeError(`invalid digits: ${n}`);t=i}return e},()=>new JI(t)}function yCe(e){return e.innerRadius}function wCe(e){return e.outerRadius}function bCe(e){return e.startAngle}function SCe(e){return e.endAngle}function xCe(e){return e&&e.padAngle}function RCe(e,t,n,i,r,s,o,a){var l=n-e,u=i-t,c=o-r,d=a-s,h=d*l-c*u;if(!(h*h<Pi))return h=(c*(t-s)-d*(e-r))/h,[e+h*l,t+h*u]}function qy(e,t,n,i,r,s,o){var a=e-n,l=t-i,u=(o?s:-s)/wd(a*a+l*l),c=u*l,d=-u*a,h=e+c,p=t+d,g=n+c,m=i+d,C=(h+g)/2,y=(p+m)/2,b=g-h,S=m-p,x=b*b+S*S,E=r-s,A=h*m-g*p,F=(S<0?-1:1)*wd(gCe(0,E*E*x-A*A)),P=(A*S-b*F)/x,D=(-A*b-S*F)/x,M=(A*S+b*F)/x,O=(-A*b+S*F)/x,B=P-C,H=D-y,N=M-C,L=O-y;return B*B+H*H>N*N+L*L&&(P=M,D=O),{cx:P,cy:D,x01:-c,y01:-d,x11:P*(r/E-1),y11:D*(r/E-1)}}function ECe(){var e=yCe,t=wCe,n=Ot(0),i=null,r=bCe,s=SCe,o=xCe,a=null,l=rx(u);function u(){var c,d,h=+e.apply(this,arguments),p=+t.apply(this,arguments),g=r.apply(this,arguments)-_b,m=s.apply(this,arguments)-_b,C=uz(m-g),y=m>g;if(a||(a=c=l()),p<h&&(d=p,p=h,h=d),!(p>Pi))a.moveTo(0,0);else if(C>E9-Pi)a.moveTo(p*Zc(g),p*Qo(g)),a.arc(0,0,p,g,m,!y),h>Pi&&(a.moveTo(h*Zc(m),h*Qo(m)),a.arc(0,0,h,m,g,y));else{var b=g,S=m,x=g,E=m,A=C,F=C,P=o.apply(this,arguments)/2,D=P>Pi&&(i?+i.apply(this,arguments):wd(h*h+p*p)),M=iA(uz(p-h)/2,+n.apply(this,arguments)),O=M,B=M,H,N;if(D>Pi){var L=cz(D/h*Qo(P)),G=cz(D/p*Qo(P));(A-=L*2)>Pi?(L*=y?1:-1,x+=L,E-=L):(A=0,x=E=(g+m)/2),(F-=G*2)>Pi?(G*=y?1:-1,b+=G,S-=G):(F=0,b=S=(g+m)/2)}var q=p*Zc(b),V=p*Qo(b),U=h*Zc(E),ie=h*Qo(E);if(M>Pi){var pe=p*Zc(S),K=p*Qo(S),Fe=h*Zc(x),Je=h*Qo(x),Me;if(C<lp)if(Me=RCe(q,V,Fe,Je,pe,K,U,ie)){var De=q-Me[0],xt=V-Me[1],En=pe-Me[0],Se=K-Me[1],je=1/Qo(mCe((De*En+xt*Se)/(wd(De*De+xt*xt)*wd(En*En+Se*Se)))/2),et=wd(Me[0]*Me[0]+Me[1]*Me[1]);O=iA(M,(h-et)/(je-1)),B=iA(M,(p-et)/(je+1))}else O=B=0}F>Pi?B>Pi?(H=qy(Fe,Je,q,V,p,B,y),N=qy(pe,K,U,ie,p,B,y),a.moveTo(H.cx+H.x01,H.cy+H.y01),B<M?a.arc(H.cx,H.cy,B,Di(H.y01,H.x01),Di(N.y01,N.x01),!y):(a.arc(H.cx,H.cy,B,Di(H.y01,H.x01),Di(H.y11,H.x11),!y),a.arc(0,0,p,Di(H.cy+H.y11,H.cx+H.x11),Di(N.cy+N.y11,N.cx+N.x11),!y),a.arc(N.cx,N.cy,B,Di(N.y11,N.x11),Di(N.y01,N.x01),!y))):(a.moveTo(q,V),a.arc(0,0,p,b,S,!y)):a.moveTo(q,V),!(h>Pi)||!(A>Pi)?a.lineTo(U,ie):O>Pi?(H=qy(U,ie,pe,K,h,-O,y),N=qy(q,V,Fe,Je,h,-O,y),a.lineTo(H.cx+H.x01,H.cy+H.y01),O<M?a.arc(H.cx,H.cy,O,Di(H.y01,H.x01),Di(N.y01,N.x01),!y):(a.arc(H.cx,H.cy,O,Di(H.y01,H.x01),Di(H.y11,H.x11),!y),a.arc(0,0,h,Di(H.cy+H.y11,H.cx+H.x11),Di(N.cy+N.y11,N.cx+N.x11),y),a.arc(N.cx,N.cy,O,Di(N.y11,N.x11),Di(N.y01,N.x01),!y))):a.arc(0,0,h,E,x,y)}if(a.closePath(),c)return a=null,c+""||null}return u.centroid=function(){var c=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,d=(+r.apply(this,arguments)+ +s.apply(this,arguments))/2-lp/2;return[Zc(d)*c,Qo(d)*c]},u.innerRadius=function(c){return arguments.length?(e=typeof c=="function"?c:Ot(+c),u):e},u.outerRadius=function(c){return arguments.length?(t=typeof c=="function"?c:Ot(+c),u):t},u.cornerRadius=function(c){return arguments.length?(n=typeof c=="function"?c:Ot(+c),u):n},u.padRadius=function(c){return arguments.length?(i=c==null?null:typeof c=="function"?c:Ot(+c),u):i},u.startAngle=function(c){return arguments.length?(r=typeof c=="function"?c:Ot(+c),u):r},u.endAngle=function(c){return arguments.length?(s=typeof c=="function"?c:Ot(+c),u):s},u.padAngle=function(c){return arguments.length?(o=typeof c=="function"?c:Ot(+c),u):o},u.context=function(c){return arguments.length?(a=c??null,u):a},u}function A9(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function D9(e){this._context=e}D9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function e_(e){return new D9(e)}function k9(e){return e[0]}function P9(e){return e[1]}function M9(e,t){var n=Ot(!0),i=null,r=e_,s=null,o=rx(a);e=typeof e=="function"?e:e===void 0?k9:Ot(e),t=typeof t=="function"?t:t===void 0?P9:Ot(t);function a(l){var u,c=(l=A9(l)).length,d,h=!1,p;for(i==null&&(s=r(p=o())),u=0;u<=c;++u)!(u<c&&n(d=l[u],u,l))===h&&((h=!h)?s.lineStart():s.lineEnd()),h&&s.point(+e(d,u,l),+t(d,u,l));if(p)return s=null,p+""||null}return a.x=function(l){return arguments.length?(e=typeof l=="function"?l:Ot(+l),a):e},a.y=function(l){return arguments.length?(t=typeof l=="function"?l:Ot(+l),a):t},a.defined=function(l){return arguments.length?(n=typeof l=="function"?l:Ot(!!l),a):n},a.curve=function(l){return arguments.length?(r=l,i!=null&&(s=r(i)),a):r},a.context=function(l){return arguments.length?(l==null?i=s=null:s=r(i=l),a):i},a}function T9(e,t,n){var i=null,r=Ot(!0),s=null,o=e_,a=null,l=rx(u);e=typeof e=="function"?e:e===void 0?k9:Ot(+e),t=typeof t=="function"?t:Ot(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?P9:Ot(+n);function u(d){var h,p,g,m=(d=A9(d)).length,C,y=!1,b,S=new Array(m),x=new Array(m);for(s==null&&(a=o(b=l())),h=0;h<=m;++h){if(!(h<m&&r(C=d[h],h,d))===y)if(y=!y)p=h,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),g=h-1;g>=p;--g)a.point(S[g],x[g]);a.lineEnd(),a.areaEnd()}y&&(S[h]=+e(C,h,d),x[h]=+t(C,h,d),a.point(i?+i(C,h,d):S[h],n?+n(C,h,d):x[h]))}if(b)return a=null,b+""||null}function c(){return M9().defined(r).curve(o).context(s)}return u.x=function(d){return arguments.length?(e=typeof d=="function"?d:Ot(+d),i=null,u):e},u.x0=function(d){return arguments.length?(e=typeof d=="function"?d:Ot(+d),u):e},u.x1=function(d){return arguments.length?(i=d==null?null:typeof d=="function"?d:Ot(+d),u):i},u.y=function(d){return arguments.length?(t=typeof d=="function"?d:Ot(+d),n=null,u):t},u.y0=function(d){return arguments.length?(t=typeof d=="function"?d:Ot(+d),u):t},u.y1=function(d){return arguments.length?(n=d==null?null:typeof d=="function"?d:Ot(+d),u):n},u.lineX0=u.lineY0=function(){return c().x(e).y(t)},u.lineY1=function(){return c().x(e).y(n)},u.lineX1=function(){return c().x(i).y(t)},u.defined=function(d){return arguments.length?(r=typeof d=="function"?d:Ot(!!d),u):r},u.curve=function(d){return arguments.length?(o=d,s!=null&&(a=o(s)),u):o},u.context=function(d){return arguments.length?(d==null?s=a=null:a=o(s=d),u):s},u}const FCe={draw(e,t){const n=wd(t/lp);e.moveTo(n,0),e.arc(0,0,n,0,E9)}};function ACe(e,t){let n=null,i=rx(r);e=typeof e=="function"?e:Ot(e||FCe),t=typeof t=="function"?t:Ot(t===void 0?64:+t);function r(){let s;if(n||(n=s=i()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),s)return n=null,s+""||null}return r.type=function(s){return arguments.length?(e=typeof s=="function"?s:Ot(s),r):e},r.size=function(s){return arguments.length?(t=typeof s=="function"?s:Ot(+s),r):t},r.context=function(s){return arguments.length?(n=s??null,r):n},r}function tc(){}function Ob(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function sx(e){this._context=e}sx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Ob(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Ob(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function DCe(e){return new sx(e)}function I9(e){this._context=e}I9.prototype={areaStart:tc,areaEnd:tc,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Ob(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function kCe(e){return new I9(e)}function _9(e){this._context=e}_9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:Ob(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function PCe(e){return new _9(e)}function O9(e,t){this._basis=new sx(e),this._beta=t}O9.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var i=e[0],r=t[0],s=e[n]-i,o=t[n]-r,a=-1,l;++a<=n;)l=a/n,this._basis.point(this._beta*e[a]+(1-this._beta)*(i+l*s),this._beta*t[a]+(1-this._beta)*(r+l*o));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const MCe=function e(t){function n(i){return t===1?new sx(i):new O9(i,t)}return n.beta=function(i){return e(+i)},n}(.85);function Lb(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function t_(e,t){this._context=e,this._k=(1-t)/6}t_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Lb(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:Lb(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const TCe=function e(t){function n(i){return new t_(i,t)}return n.tension=function(i){return e(+i)},n}(0);function n_(e,t){this._context=e,this._k=(1-t)/6}n_.prototype={areaStart:tc,areaEnd:tc,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Lb(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const ICe=function e(t){function n(i){return new n_(i,t)}return n.tension=function(i){return e(+i)},n}(0);function i_(e,t){this._context=e,this._k=(1-t)/6}i_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Lb(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const _Ce=function e(t){function n(i){return new i_(i,t)}return n.tension=function(i){return e(+i)},n}(0);function r_(e,t,n){var i=e._x1,r=e._y1,s=e._x2,o=e._y2;if(e._l01_a>Pi){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);i=(i*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,r=(r*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>Pi){var u=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);s=(s*u+e._x1*e._l23_2a-t*e._l12_2a)/c,o=(o*u+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(i,r,s,o,e._x2,e._y2)}function L9(e,t){this._context=e,this._alpha=t}L9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:r_(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const OCe=function e(t){function n(i){return t?new L9(i,t):new t_(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function N9(e,t){this._context=e,this._alpha=t}N9.prototype={areaStart:tc,areaEnd:tc,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:r_(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const LCe=function e(t){function n(i){return t?new N9(i,t):new n_(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function $9(e,t){this._context=e,this._alpha=t}$9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:r_(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const NCe=function e(t){function n(i){return t?new $9(i,t):new i_(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function B9(e){this._context=e}B9.prototype={areaStart:tc,areaEnd:tc,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function $Ce(e){return new B9(e)}function dz(e){return e<0?-1:1}function hz(e,t,n){var i=e._x1-e._x0,r=t-e._x1,s=(e._y1-e._y0)/(i||r<0&&-0),o=(n-e._y1)/(r||i<0&&-0),a=(s*r+o*i)/(i+r);return(dz(s)+dz(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(a))||0}function fz(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function rA(e,t,n){var i=e._x0,r=e._y0,s=e._x1,o=e._y1,a=(s-i)/3;e._context.bezierCurveTo(i+a,r+a*t,s-a,o-a*n,s,o)}function Nb(e){this._context=e}Nb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:rA(this,this._t0,fz(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,rA(this,fz(this,n=hz(this,e,t)),n);break;default:rA(this,this._t0,n=hz(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function G9(e){this._context=new z9(e)}(G9.prototype=Object.create(Nb.prototype)).point=function(e,t){Nb.prototype.point.call(this,t,e)};function z9(e){this._context=e}z9.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,i,r,s){this._context.bezierCurveTo(t,e,i,n,s,r)}};function BCe(e){return new Nb(e)}function GCe(e){return new G9(e)}function H9(e){this._context=e}H9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var i=pz(e),r=pz(t),s=0,o=1;o<n;++s,++o)this._context.bezierCurveTo(i[0][s],r[0][s],i[1][s],r[1][s],e[o],t[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function pz(e){var t,n=e.length-1,i,r=new Array(n),s=new Array(n),o=new Array(n);for(r[0]=0,s[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)r[t]=1,s[t]=4,o[t]=4*e[t]+2*e[t+1];for(r[n-1]=2,s[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)i=r[t]/s[t-1],s[t]-=i,o[t]-=i*o[t-1];for(r[n-1]=o[n-1]/s[n-1],t=n-2;t>=0;--t)r[t]=(o[t]-r[t+1])/s[t];for(s[n-1]=(e[n]+r[n-1])/2,t=0;t<n-1;++t)s[t]=2*e[t+1]-r[t+1];return[r,s]}function zCe(e){return new H9(e)}function ox(e,t){this._context=e,this._t=t}ox.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function HCe(e){return new ox(e,.5)}function VCe(e){return new ox(e,0)}function WCe(e){return new ox(e,1)}function ju(e,t){if(typeof document<"u"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const UCe=()=>typeof Image<"u"?Image:null;function Lo(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function wc(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Uk=Symbol("implicit");function q0(){var e=new M3,t=[],n=[],i=Uk;function r(s){let o=e.get(s);if(o===void 0){if(i!==Uk)return i;e.set(s,o=t.push(s)-1)}return n[o%n.length]}return r.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new M3;for(const o of s)e.has(o)||e.set(o,t.push(o)-1);return r},r.range=function(s){return arguments.length?(n=Array.from(s),r):n.slice()},r.unknown=function(s){return arguments.length?(i=s,r):i},r.copy=function(){return q0(t,n).unknown(i)},Lo.apply(r,arguments),r}function qk(){var e=q0().unknown(void 0),t=e.domain,n=e.range,i=0,r=1,s,o,a=!1,l=0,u=0,c=.5;delete e.unknown;function d(){var h=t().length,p=r<i,g=p?r:i,m=p?i:r;s=(m-g)/Math.max(1,h-l+u*2),a&&(s=Math.floor(s)),g+=(m-g-s*(h-l))*c,o=s*(1-l),a&&(g=Math.round(g),o=Math.round(o));var C=Ar(h).map(function(y){return g+s*y});return n(p?C.reverse():C)}return e.domain=function(h){return arguments.length?(t(h),d()):t()},e.range=function(h){return arguments.length?([i,r]=h,i=+i,r=+r,d()):[i,r]},e.rangeRound=function(h){return[i,r]=h,i=+i,r=+r,a=!0,d()},e.bandwidth=function(){return o},e.step=function(){return s},e.round=function(h){return arguments.length?(a=!!h,d()):a},e.padding=function(h){return arguments.length?(l=Math.min(1,u=+h),d()):l},e.paddingInner=function(h){return arguments.length?(l=Math.min(1,h),d()):l},e.paddingOuter=function(h){return arguments.length?(u=+h,d()):u},e.align=function(h){return arguments.length?(c=Math.max(0,Math.min(1,h)),d()):c},e.copy=function(){return qk(t(),[i,r]).round(a).paddingInner(l).paddingOuter(u).align(c)},Lo.apply(d(),arguments)}function sg(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function j0(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function bc(){}var Ud=.7,up=1/Ud,Nf="\\s*([+-]?\\d+)\\s*",jv="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ca="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",qCe=/^#([0-9a-f]{3,8})$/,jCe=new RegExp(`^rgb\\(${Nf},${Nf},${Nf}\\)$`),KCe=new RegExp(`^rgb\\(${Ca},${Ca},${Ca}\\)$`),YCe=new RegExp(`^rgba\\(${Nf},${Nf},${Nf},${jv}\\)$`),XCe=new RegExp(`^rgba\\(${Ca},${Ca},${Ca},${jv}\\)$`),QCe=new RegExp(`^hsl\\(${jv},${Ca},${Ca}\\)$`),ZCe=new RegExp(`^hsla\\(${jv},${Ca},${Ca},${jv}\\)$`),gz={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};sg(bc,Kv,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:mz,formatHex:mz,formatHex8:JCe,formatHsl:eye,formatRgb:vz,toString:vz});function mz(){return this.rgb().formatHex()}function JCe(){return this.rgb().formatHex8()}function eye(){return V9(this).formatHsl()}function vz(){return this.rgb().formatRgb()}function Kv(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=qCe.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Cz(t):n===3?new ei(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?jy(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?jy(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=jCe.exec(e))?new ei(t[1],t[2],t[3],1):(t=KCe.exec(e))?new ei(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=YCe.exec(e))?jy(t[1],t[2],t[3],t[4]):(t=XCe.exec(e))?jy(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=QCe.exec(e))?bz(t[1],t[2]/100,t[3]/100,1):(t=ZCe.exec(e))?bz(t[1],t[2]/100,t[3]/100,t[4]):gz.hasOwnProperty(e)?Cz(gz[e]):e==="transparent"?new ei(NaN,NaN,NaN,0):null}function Cz(e){return new ei(e>>16&255,e>>8&255,e&255,1)}function jy(e,t,n,i){return i<=0&&(e=t=n=NaN),new ei(e,t,n,i)}function s_(e){return e instanceof bc||(e=Kv(e)),e?(e=e.rgb(),new ei(e.r,e.g,e.b,e.opacity)):new ei}function nc(e,t,n,i){return arguments.length===1?s_(e):new ei(e,t,n,i??1)}function ei(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}sg(ei,nc,j0(bc,{brighter(e){return e=e==null?up:Math.pow(up,e),new ei(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Ud:Math.pow(Ud,e),new ei(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ei(Dd(this.r),Dd(this.g),Dd(this.b),$b(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:yz,formatHex:yz,formatHex8:tye,formatRgb:wz,toString:wz}));function yz(){return`#${bd(this.r)}${bd(this.g)}${bd(this.b)}`}function tye(){return`#${bd(this.r)}${bd(this.g)}${bd(this.b)}${bd((isNaN(this.opacity)?1:this.opacity)*255)}`}function wz(){const e=$b(this.opacity);return`${e===1?"rgb(":"rgba("}${Dd(this.r)}, ${Dd(this.g)}, ${Dd(this.b)}${e===1?")":`, ${e})`}`}function $b(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Dd(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function bd(e){return e=Dd(e),(e<16?"0":"")+e.toString(16)}function bz(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new go(e,t,n,i)}function V9(e){if(e instanceof go)return new go(e.h,e.s,e.l,e.opacity);if(e instanceof bc||(e=Kv(e)),!e)return new go;if(e instanceof go)return e;e=e.rgb();var t=e.r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),s=Math.max(t,n,i),o=NaN,a=s-r,l=(s+r)/2;return a?(t===s?o=(n-i)/a+(n<i)*6:n===s?o=(i-t)/a+2:o=(t-n)/a+4,a/=l<.5?s+r:2-s-r,o*=60):a=l>0&&l<1?0:o,new go(o,a,l,e.opacity)}function Bb(e,t,n,i){return arguments.length===1?V9(e):new go(e,t,n,i??1)}function go(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}sg(go,Bb,j0(bc,{brighter(e){return e=e==null?up:Math.pow(up,e),new go(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ud:Math.pow(Ud,e),new go(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new ei(sA(e>=240?e-240:e+120,r,i),sA(e,r,i),sA(e<120?e+240:e-120,r,i),this.opacity)},clamp(){return new go(Sz(this.h),Ky(this.s),Ky(this.l),$b(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=$b(this.opacity);return`${e===1?"hsl(":"hsla("}${Sz(this.h)}, ${Ky(this.s)*100}%, ${Ky(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Sz(e){return e=(e||0)%360,e<0?e+360:e}function Ky(e){return Math.max(0,Math.min(1,e||0))}function sA(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const W9=Math.PI/180,U9=180/Math.PI,Gb=18,q9=.96422,j9=1,K9=.82521,Y9=4/29,$f=6/29,X9=3*$f*$f,nye=$f*$f*$f;function Q9(e){if(e instanceof ya)return new ya(e.l,e.a,e.b,e.opacity);if(e instanceof bl)return Z9(e);e instanceof ei||(e=s_(e));var t=uA(e.r),n=uA(e.g),i=uA(e.b),r=oA((.2225045*t+.7168786*n+.0606169*i)/j9),s,o;return t===n&&n===i?s=o=r:(s=oA((.4360747*t+.3850649*n+.1430804*i)/q9),o=oA((.0139322*t+.0971045*n+.7141733*i)/K9)),new ya(116*r-16,500*(s-r),200*(r-o),e.opacity)}function zb(e,t,n,i){return arguments.length===1?Q9(e):new ya(e,t,n,i??1)}function ya(e,t,n,i){this.l=+e,this.a=+t,this.b=+n,this.opacity=+i}sg(ya,zb,j0(bc,{brighter(e){return new ya(this.l+Gb*(e??1),this.a,this.b,this.opacity)},darker(e){return new ya(this.l-Gb*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=q9*aA(t),e=j9*aA(e),n=K9*aA(n),new ei(lA(3.1338561*t-1.6168667*e-.4906146*n),lA(-.9787684*t+1.9161415*e+.033454*n),lA(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function oA(e){return e>nye?Math.pow(e,1/3):e/X9+Y9}function aA(e){return e>$f?e*e*e:X9*(e-Y9)}function lA(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function uA(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function iye(e){if(e instanceof bl)return new bl(e.h,e.c,e.l,e.opacity);if(e instanceof ya||(e=Q9(e)),e.a===0&&e.b===0)return new bl(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*U9;return new bl(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function Hb(e,t,n,i){return arguments.length===1?iye(e):new bl(e,t,n,i??1)}function bl(e,t,n,i){this.h=+e,this.c=+t,this.l=+n,this.opacity=+i}function Z9(e){if(isNaN(e.h))return new ya(e.l,0,0,e.opacity);var t=e.h*W9;return new ya(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}sg(bl,Hb,j0(bc,{brighter(e){return new bl(this.h,this.c,this.l+Gb*(e??1),this.opacity)},darker(e){return new bl(this.h,this.c,this.l-Gb*(e??1),this.opacity)},rgb(){return Z9(this).rgb()}}));var J9=-.14861,o_=1.78277,a_=-.29227,ax=-.90649,Yv=1.97294,xz=Yv*ax,Rz=Yv*o_,Ez=o_*a_-ax*J9;function rye(e){if(e instanceof kd)return new kd(e.h,e.s,e.l,e.opacity);e instanceof ei||(e=s_(e));var t=e.r/255,n=e.g/255,i=e.b/255,r=(Ez*i+xz*t-Rz*n)/(Ez+xz-Rz),s=i-r,o=(Yv*(n-r)-a_*s)/ax,a=Math.sqrt(o*o+s*s)/(Yv*r*(1-r)),l=a?Math.atan2(o,s)*U9-120:NaN;return new kd(l<0?l+360:l,a,r,e.opacity)}function jk(e,t,n,i){return arguments.length===1?rye(e):new kd(e,t,n,i??1)}function kd(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}sg(kd,jk,j0(bc,{brighter(e){return e=e==null?up:Math.pow(up,e),new kd(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ud:Math.pow(Ud,e),new kd(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*W9,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),i=Math.cos(e),r=Math.sin(e);return new ei(255*(t+n*(J9*i+o_*r)),255*(t+n*(a_*i+ax*r)),255*(t+n*(Yv*i)),this.opacity)}}));function e7(e,t,n,i,r){var s=e*e,o=s*e;return((1-3*e+3*s-o)*t+(4-6*s+3*o)*n+(1+3*e+3*s-3*o)*i+o*r)/6}function t7(e){var t=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[i],s=e[i+1],o=i>0?e[i-1]:2*r-s,a=i<t-1?e[i+2]:2*s-r;return e7((n-i/t)*t,o,r,s,a)}}function n7(e){var t=e.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*t),r=e[(i+t-1)%t],s=e[i%t],o=e[(i+1)%t],a=e[(i+2)%t];return e7((n-i/t)*t,r,s,o,a)}}const lx=e=>()=>e;function i7(e,t){return function(n){return e+n*t}}function sye(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}function ux(e,t){var n=t-e;return n?i7(e,n>180||n<-180?n-360*Math.round(n/360):n):lx(isNaN(e)?t:e)}function oye(e){return(e=+e)==1?ti:function(t,n){return n-t?sye(t,n,e):lx(isNaN(t)?n:t)}}function ti(e,t){var n=t-e;return n?i7(e,n):lx(isNaN(e)?t:e)}const Kk=function e(t){var n=oye(t);function i(r,s){var o=n((r=nc(r)).r,(s=nc(s)).r),a=n(r.g,s.g),l=n(r.b,s.b),u=ti(r.opacity,s.opacity);return function(c){return r.r=o(c),r.g=a(c),r.b=l(c),r.opacity=u(c),r+""}}return i.gamma=e,i}(1);function r7(e){return function(t){var n=t.length,i=new Array(n),r=new Array(n),s=new Array(n),o,a;for(o=0;o<n;++o)a=nc(t[o]),i[o]=a.r||0,r[o]=a.g||0,s[o]=a.b||0;return i=e(i),r=e(r),s=e(s),a.opacity=1,function(l){return a.r=i(l),a.g=r(l),a.b=s(l),a+""}}}var s7=r7(t7),aye=r7(n7);function l_(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,i=t.slice(),r;return function(s){for(r=0;r<n;++r)i[r]=e[r]*(1-s)+t[r]*s;return i}}function o7(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function lye(e,t){return(o7(t)?l_:a7)(e,t)}function a7(e,t){var n=t?t.length:0,i=e?Math.min(n,e.length):0,r=new Array(i),s=new Array(n),o;for(o=0;o<i;++o)r[o]=Sc(e[o],t[o]);for(;o<n;++o)s[o]=t[o];return function(a){for(o=0;o<i;++o)s[o]=r[o](a);return s}}function l7(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}function ho(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function u7(e,t){var n={},i={},r;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in e?n[r]=Sc(e[r],t[r]):i[r]=t[r];return function(s){for(r in n)i[r]=n[r](s);return i}}var Yk=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,cA=new RegExp(Yk.source,"g");function uye(e){return function(){return e}}function cye(e){return function(t){return e(t)+""}}function c7(e,t){var n=Yk.lastIndex=cA.lastIndex=0,i,r,s,o=-1,a=[],l=[];for(e=e+"",t=t+"";(i=Yk.exec(e))&&(r=cA.exec(t));)(s=r.index)>n&&(s=t.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(i=i[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,l.push({i:o,x:ho(i,r)})),n=cA.lastIndex;return n<t.length&&(s=t.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?l[0]?cye(l[0].x):uye(t):(t=l.length,function(u){for(var c=0,d;c<t;++c)a[(d=l[c]).i]=d.x(u);return a.join("")})}function Sc(e,t){var n=typeof t,i;return t==null||n==="boolean"?lx(t):(n==="number"?ho:n==="string"?(i=Kv(t))?(t=i,Kk):c7:t instanceof Kv?Kk:t instanceof Date?l7:o7(t)?l_:Array.isArray(t)?a7:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?u7:ho)(e,t)}function dye(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function hye(e,t){var n=ux(+e,+t);return function(i){var r=n(i);return r-360*Math.floor(r/360)}}function K0(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var Fz=180/Math.PI,Xk={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function d7(e,t,n,i,r,s){var o,a,l;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(l=e*n+t*i)&&(n-=e*l,i-=t*l),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,l/=a),e*i<t*n&&(e=-e,t=-t,l=-l,o=-o),{translateX:r,translateY:s,rotate:Math.atan2(t,e)*Fz,skewX:Math.atan(l)*Fz,scaleX:o,scaleY:a}}var Yy;function fye(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Xk:d7(t.a,t.b,t.c,t.d,t.e,t.f)}function pye(e){return e==null||(Yy||(Yy=document.createElementNS("http://www.w3.org/2000/svg","g")),Yy.setAttribute("transform",e),!(e=Yy.transform.baseVal.consolidate()))?Xk:(e=e.matrix,d7(e.a,e.b,e.c,e.d,e.e,e.f))}function h7(e,t,n,i){function r(u){return u.length?u.pop()+" ":""}function s(u,c,d,h,p,g){if(u!==d||c!==h){var m=p.push("translate(",null,t,null,n);g.push({i:m-4,x:ho(u,d)},{i:m-2,x:ho(c,h)})}else(d||h)&&p.push("translate("+d+t+h+n)}function o(u,c,d,h){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),h.push({i:d.push(r(d)+"rotate(",null,i)-2,x:ho(u,c)})):c&&d.push(r(d)+"rotate("+c+i)}function a(u,c,d,h){u!==c?h.push({i:d.push(r(d)+"skewX(",null,i)-2,x:ho(u,c)}):c&&d.push(r(d)+"skewX("+c+i)}function l(u,c,d,h,p,g){if(u!==d||c!==h){var m=p.push(r(p)+"scale(",null,",",null,")");g.push({i:m-4,x:ho(u,d)},{i:m-2,x:ho(c,h)})}else(d!==1||h!==1)&&p.push(r(p)+"scale("+d+","+h+")")}return function(u,c){var d=[],h=[];return u=e(u),c=e(c),s(u.translateX,u.translateY,c.translateX,c.translateY,d,h),o(u.rotate,c.rotate,d,h),a(u.skewX,c.skewX,d,h),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,d,h),u=c=null,function(p){for(var g=-1,m=h.length,C;++g<m;)d[(C=h[g]).i]=C.x(p);return d.join("")}}}var gye=h7(fye,"px, ","px)","deg)"),mye=h7(pye,", ",")",")"),vye=1e-12;function Az(e){return((e=Math.exp(e))+1/e)/2}function Cye(e){return((e=Math.exp(e))-1/e)/2}function yye(e){return((e=Math.exp(2*e))-1)/(e+1)}const wye=function e(t,n,i){function r(s,o){var a=s[0],l=s[1],u=s[2],c=o[0],d=o[1],h=o[2],p=c-a,g=d-l,m=p*p+g*g,C,y;if(m<vye)y=Math.log(h/u)/t,C=function(F){return[a+F*p,l+F*g,u*Math.exp(t*F*y)]};else{var b=Math.sqrt(m),S=(h*h-u*u+i*m)/(2*u*n*b),x=(h*h-u*u-i*m)/(2*h*n*b),E=Math.log(Math.sqrt(S*S+1)-S),A=Math.log(Math.sqrt(x*x+1)-x);y=(A-E)/t,C=function(F){var P=F*y,D=Az(E),M=u/(n*b)*(D*yye(t*P+E)-Cye(E));return[a+M*p,l+M*g,u*D/Az(t*P+E)]}}return C.duration=y*1e3*t/Math.SQRT2,C}return r.rho=function(s){var o=Math.max(.001,+s),a=o*o,l=a*a;return e(o,a,l)},r}(Math.SQRT2,2,4);function f7(e){return function(t,n){var i=e((t=Bb(t)).h,(n=Bb(n)).h),r=ti(t.s,n.s),s=ti(t.l,n.l),o=ti(t.opacity,n.opacity);return function(a){return t.h=i(a),t.s=r(a),t.l=s(a),t.opacity=o(a),t+""}}}const bye=f7(ux);var Sye=f7(ti);function xye(e,t){var n=ti((e=zb(e)).l,(t=zb(t)).l),i=ti(e.a,t.a),r=ti(e.b,t.b),s=ti(e.opacity,t.opacity);return function(o){return e.l=n(o),e.a=i(o),e.b=r(o),e.opacity=s(o),e+""}}function p7(e){return function(t,n){var i=e((t=Hb(t)).h,(n=Hb(n)).h),r=ti(t.c,n.c),s=ti(t.l,n.l),o=ti(t.opacity,n.opacity);return function(a){return t.h=i(a),t.c=r(a),t.l=s(a),t.opacity=o(a),t+""}}}const Rye=p7(ux);var Eye=p7(ti);function g7(e){return function t(n){n=+n;function i(r,s){var o=e((r=jk(r)).h,(s=jk(s)).h),a=ti(r.s,s.s),l=ti(r.l,s.l),u=ti(r.opacity,s.opacity);return function(c){return r.h=o(c),r.s=a(c),r.l=l(Math.pow(c,n)),r.opacity=u(c),r+""}}return i.gamma=t,i}(1)}const Fye=g7(ux);var Aye=g7(ti);function u_(e,t){t===void 0&&(t=e,e=Sc);for(var n=0,i=t.length-1,r=t[0],s=new Array(i<0?0:i);n<i;)s[n]=e(r,r=t[++n]);return function(o){var a=Math.max(0,Math.min(i-1,Math.floor(o*=i)));return s[a](o-a)}}function Dye(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e(i/(t-1));return n}const kye=Object.freeze(Object.defineProperty({__proto__:null,interpolate:Sc,interpolateArray:lye,interpolateBasis:t7,interpolateBasisClosed:n7,interpolateCubehelix:Fye,interpolateCubehelixLong:Aye,interpolateDate:l7,interpolateDiscrete:dye,interpolateHcl:Rye,interpolateHclLong:Eye,interpolateHsl:bye,interpolateHslLong:Sye,interpolateHue:hye,interpolateLab:xye,interpolateNumber:ho,interpolateNumberArray:l_,interpolateObject:u7,interpolateRgb:Kk,interpolateRgbBasis:s7,interpolateRgbBasisClosed:aye,interpolateRound:K0,interpolateString:c7,interpolateTransformCss:gye,interpolateTransformSvg:mye,interpolateZoom:wye,piecewise:u_,quantize:Dye},Symbol.toStringTag,{value:"Module"}));function Pye(e){return function(){return e}}function Qk(e){return+e}var Dz=[0,1];function Dr(e){return e}function Zk(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Pye(isNaN(t)?NaN:.5)}function Mye(e,t){var n;return e>t&&(n=e,e=t,t=n),function(i){return Math.max(e,Math.min(t,i))}}function Tye(e,t,n){var i=e[0],r=e[1],s=t[0],o=t[1];return r<i?(i=Zk(r,i),s=n(o,s)):(i=Zk(i,r),s=n(s,o)),function(a){return s(i(a))}}function Iye(e,t,n){var i=Math.min(e.length,t.length)-1,r=new Array(i),s=new Array(i),o=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<i;)r[o]=Zk(e[o],e[o+1]),s[o]=n(t[o],t[o+1]);return function(a){var l=Zu(e,a,1,i)-1;return s[l](r[l](a))}}function Y0(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function cx(){var e=Dz,t=Dz,n=Sc,i,r,s,o=Dr,a,l,u;function c(){var h=Math.min(e.length,t.length);return o!==Dr&&(o=Mye(e[0],e[h-1])),a=h>2?Iye:Tye,l=u=null,d}function d(h){return h==null||isNaN(h=+h)?s:(l||(l=a(e.map(i),t,n)))(i(o(h)))}return d.invert=function(h){return o(r((u||(u=a(t,e.map(i),ho)))(h)))},d.domain=function(h){return arguments.length?(e=Array.from(h,Qk),c()):e.slice()},d.range=function(h){return arguments.length?(t=Array.from(h),c()):t.slice()},d.rangeRound=function(h){return t=Array.from(h),n=K0,c()},d.clamp=function(h){return arguments.length?(o=h?!0:Dr,c()):o!==Dr},d.interpolate=function(h){return arguments.length?(n=h,c()):n},d.unknown=function(h){return arguments.length?(s=h,d):s},function(h,p){return i=h,r=p,c()}}function m7(){return cx()(Dr,Dr)}function v7(e,t,n,i){var r=Ju(e,t,n),s;switch(i=Wd(i??",f"),i.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return i.precision==null&&!isNaN(s=H8(r,o))&&(i.precision=s),QT(i,o)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(s=V8(r,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=s-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(s=z8(r))&&(i.precision=s-(i.type==="%")*2);break}}return B1(i)}function bh(e){var t=e.domain;return e.ticks=function(n){var i=t();return kk(i[0],i[i.length-1],n??10)},e.tickFormat=function(n,i){var r=t();return v7(r[0],r[r.length-1],n??10,i)},e.nice=function(n){n==null&&(n=10);var i=t(),r=0,s=i.length-1,o=i[r],a=i[s],l,u,c=10;for(a<o&&(u=o,o=a,a=u,u=r,r=s,s=u);c-- >0;){if(u=Pk(o,a,n),u===l)return i[r]=o,i[s]=a,t(i);if(u>0)o=Math.floor(o/u)*u,a=Math.ceil(a/u)*u;else if(u<0)o=Math.ceil(o*u)/u,a=Math.floor(a*u)/u;else break;l=u}return e},e}function hv(){var e=m7();return e.copy=function(){return Y0(e,hv())},Lo.apply(e,arguments),bh(e)}function C7(e){var t;function n(i){return i==null||isNaN(i=+i)?t:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(e=Array.from(i,Qk),n):e.slice()},n.unknown=function(i){return arguments.length?(t=i,n):t},n.copy=function(){return C7(e).unknown(t)},e=arguments.length?Array.from(e,Qk):[0,1],bh(n)}function y7(e,t){e=e.slice();var n=0,i=e.length-1,r=e[n],s=e[i],o;return s<r&&(o=n,n=i,i=o,o=r,r=s,s=o),e[n]=t.floor(r),e[i]=t.ceil(s),e}function kz(e){return Math.log(e)}function Pz(e){return Math.exp(e)}function _ye(e){return-Math.log(-e)}function Oye(e){return-Math.exp(-e)}function Lye(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Nye(e){return e===10?Lye:e===Math.E?Math.exp:t=>Math.pow(e,t)}function $ye(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Mz(e){return(t,n)=>-e(-t,n)}function c_(e){const t=e(kz,Pz),n=t.domain;let i=10,r,s;function o(){return r=$ye(i),s=Nye(i),n()[0]<0?(r=Mz(r),s=Mz(s),e(_ye,Oye)):e(kz,Pz),t}return t.base=function(a){return arguments.length?(i=+a,o()):i},t.domain=function(a){return arguments.length?(n(a),o()):n()},t.ticks=a=>{const l=n();let u=l[0],c=l[l.length-1];const d=c<u;d&&([u,c]=[c,u]);let h=r(u),p=r(c),g,m;const C=a==null?10:+a;let y=[];if(!(i%1)&&p-h<C){if(h=Math.floor(h),p=Math.ceil(p),u>0){for(;h<=p;++h)for(g=1;g<i;++g)if(m=h<0?g/s(-h):g*s(h),!(m<u)){if(m>c)break;y.push(m)}}else for(;h<=p;++h)for(g=i-1;g>=1;--g)if(m=h>0?g/s(-h):g*s(h),!(m<u)){if(m>c)break;y.push(m)}y.length*2<C&&(y=kk(u,c,C))}else y=kk(h,p,Math.min(p-h,C)).map(s);return d?y.reverse():y},t.tickFormat=(a,l)=>{if(a==null&&(a=10),l==null&&(l=i===10?"s":","),typeof l!="function"&&(!(i%1)&&(l=Wd(l)).precision==null&&(l.trim=!0),l=B1(l)),a===1/0)return l;const u=Math.max(1,i*a/t.ticks().length);return c=>{let d=c/s(Math.round(r(c)));return d*i<i-.5&&(d*=i),d<=u?l(c):""}},t.nice=()=>n(y7(n(),{floor:a=>s(Math.floor(r(a))),ceil:a=>s(Math.ceil(r(a)))})),t}function w7(){const e=c_(cx()).domain([1,10]);return e.copy=()=>Y0(e,w7()).base(e.base()),Lo.apply(e,arguments),e}function Tz(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Iz(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function d_(e){var t=1,n=e(Tz(t),Iz(t));return n.constant=function(i){return arguments.length?e(Tz(t=+i),Iz(t)):t},bh(n)}function b7(){var e=d_(cx());return e.copy=function(){return Y0(e,b7()).constant(e.constant())},Lo.apply(e,arguments)}function _z(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Bye(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Gye(e){return e<0?-e*e:e*e}function h_(e){var t=e(Dr,Dr),n=1;function i(){return n===1?e(Dr,Dr):n===.5?e(Bye,Gye):e(_z(n),_z(1/n))}return t.exponent=function(r){return arguments.length?(n=+r,i()):n},bh(t)}function f_(){var e=h_(cx());return e.copy=function(){return Y0(e,f_()).exponent(e.exponent())},Lo.apply(e,arguments),e}function zye(){return f_.apply(null,arguments).exponent(.5)}function S7(){var e=[],t=[],n=[],i;function r(){var o=0,a=Math.max(1,t.length);for(n=new Array(a-1);++o<a;)n[o-1]=O8(e,o/a);return s}function s(o){return o==null||isNaN(o=+o)?i:t[Zu(n,o)]}return s.invertExtent=function(o){var a=t.indexOf(o);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},s.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let a of o)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(El),r()},s.range=function(o){return arguments.length?(t=Array.from(o),r()):t.slice()},s.unknown=function(o){return arguments.length?(i=o,s):i},s.quantiles=function(){return n.slice()},s.copy=function(){return S7().domain(e).range(t).unknown(i)},Lo.apply(s,arguments)}function x7(){var e=0,t=1,n=1,i=[.5],r=[0,1],s;function o(l){return l!=null&&l<=l?r[Zu(i,l,0,n)]:s}function a(){var l=-1;for(i=new Array(n);++l<n;)i[l]=((l+1)*t-(l-n)*e)/(n+1);return o}return o.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,a()):[e,t]},o.range=function(l){return arguments.length?(n=(r=Array.from(l)).length-1,a()):r.slice()},o.invertExtent=function(l){var u=r.indexOf(l);return u<0?[NaN,NaN]:u<1?[e,i[0]]:u>=n?[i[n-1],t]:[i[u-1],i[u]]},o.unknown=function(l){return arguments.length&&(s=l),o},o.thresholds=function(){return i.slice()},o.copy=function(){return x7().domain([e,t]).range(r).unknown(s)},Lo.apply(bh(o),arguments)}function R7(){var e=[.5],t=[0,1],n,i=1;function r(s){return s!=null&&s<=s?t[Zu(e,s,0,i)]:n}return r.domain=function(s){return arguments.length?(e=Array.from(s),i=Math.min(e.length,t.length-1),r):e.slice()},r.range=function(s){return arguments.length?(t=Array.from(s),i=Math.min(e.length,t.length-1),r):t.slice()},r.invertExtent=function(s){var o=t.indexOf(s);return[e[o-1],e[o]]},r.unknown=function(s){return arguments.length?(n=s,r):n},r.copy=function(){return R7().domain(e).range(t).unknown(n)},Lo.apply(r,arguments)}function Hye(e){return new Date(e)}function Vye(e){return e instanceof Date?+e:+new Date(+e)}function p_(e,t,n,i,r,s,o,a,l,u){var c=m7(),d=c.invert,h=c.domain,p=u(".%L"),g=u(":%S"),m=u("%I:%M"),C=u("%I %p"),y=u("%a %d"),b=u("%b %d"),S=u("%B"),x=u("%Y");function E(A){return(l(A)<A?p:a(A)<A?g:o(A)<A?m:s(A)<A?C:i(A)<A?r(A)<A?y:b:n(A)<A?S:x)(A)}return c.invert=function(A){return new Date(d(A))},c.domain=function(A){return arguments.length?h(Array.from(A,Vye)):h().map(Hye)},c.ticks=function(A){var F=h();return e(F[0],F[F.length-1],A??10)},c.tickFormat=function(A,F){return F==null?E:u(F)},c.nice=function(A){var F=h();return(!A||typeof A.range!="function")&&(A=t(F[0],F[F.length-1],A??10)),A?h(y7(F,A)):c},c.copy=function(){return Y0(c,p_(e,t,n,i,r,s,o,a,l,u))},c}function Wye(){return Lo.apply(p_(Qge,Zge,Fa,Hv,eg,Fl,H1,G1,wl,nI).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Uye(){return Lo.apply(p_(Yge,Xge,Aa,Vv,tg,Uu,V1,z1,wl,iI).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function dx(){var e=0,t=1,n,i,r,s,o=Dr,a=!1,l;function u(d){return d==null||isNaN(d=+d)?l:o(r===0?.5:(d=(s(d)-n)*r,a?Math.max(0,Math.min(1,d)):d))}u.domain=function(d){return arguments.length?([e,t]=d,n=s(e=+e),i=s(t=+t),r=n===i?0:1/(i-n),u):[e,t]},u.clamp=function(d){return arguments.length?(a=!!d,u):a},u.interpolator=function(d){return arguments.length?(o=d,u):o};function c(d){return function(h){var p,g;return arguments.length?([p,g]=h,o=d(p,g),u):[o(0),o(1)]}}return u.range=c(Sc),u.rangeRound=c(K0),u.unknown=function(d){return arguments.length?(l=d,u):l},function(d){return s=d,n=d(e),i=d(t),r=n===i?0:1/(i-n),u}}function xc(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function hx(){var e=bh(dx()(Dr));return e.copy=function(){return xc(e,hx())},wc.apply(e,arguments)}function E7(){var e=c_(dx()).domain([1,10]);return e.copy=function(){return xc(e,E7()).base(e.base())},wc.apply(e,arguments)}function F7(){var e=d_(dx());return e.copy=function(){return xc(e,F7()).constant(e.constant())},wc.apply(e,arguments)}function g_(){var e=h_(dx());return e.copy=function(){return xc(e,g_()).exponent(e.exponent())},wc.apply(e,arguments)}function qye(){return g_.apply(null,arguments).exponent(.5)}function fx(){var e=0,t=.5,n=1,i=1,r,s,o,a,l,u=Dr,c,d=!1,h;function p(m){return isNaN(m=+m)?h:(m=.5+((m=+c(m))-s)*(i*m<i*s?a:l),u(d?Math.max(0,Math.min(1,m)):m))}p.domain=function(m){return arguments.length?([e,t,n]=m,r=c(e=+e),s=c(t=+t),o=c(n=+n),a=r===s?0:.5/(s-r),l=s===o?0:.5/(o-s),i=s<r?-1:1,p):[e,t,n]},p.clamp=function(m){return arguments.length?(d=!!m,p):d},p.interpolator=function(m){return arguments.length?(u=m,p):u};function g(m){return function(C){var y,b,S;return arguments.length?([y,b,S]=C,u=u_(m,[y,b,S]),p):[u(0),u(.5),u(1)]}}return p.range=g(Sc),p.rangeRound=g(K0),p.unknown=function(m){return arguments.length?(h=m,p):h},function(m){return c=m,r=m(e),s=m(t),o=m(n),a=r===s?0:.5/(s-r),l=s===o?0:.5/(o-s),i=s<r?-1:1,p}}function A7(){var e=bh(fx()(Dr));return e.copy=function(){return xc(e,A7())},wc.apply(e,arguments)}function D7(){var e=c_(fx()).domain([.1,1,10]);return e.copy=function(){return xc(e,D7()).base(e.base())},wc.apply(e,arguments)}function k7(){var e=d_(fx());return e.copy=function(){return xc(e,k7()).constant(e.constant())},wc.apply(e,arguments)}function m_(){var e=h_(fx());return e.copy=function(){return xc(e,m_()).exponent(e.exponent())},wc.apply(e,arguments)}function jye(){return m_.apply(null,arguments).exponent(.5)}function No(e){for(var t=e.length/6|0,n=new Array(t),i=0;i<t;)n[i]="#"+e.slice(i*6,++i*6);return n}const Kye=No("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Yye=No("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),Xye=No("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),Qye=No("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),Zye=No("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),Jye=No("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),ewe=No("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),twe=No("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),nwe=No("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),P7=No("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),iwe=e=>s7(e[e.length-1]);var rwe=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(No);const swe=iwe(rwe);function v_(e,t,n){const i=e-t+n*2;return e?i>0?i:1:0}const owe="identity",cp="linear",$l="log",X0="pow",Q0="sqrt",px="symlog",qd="time",jd="utc",wa="sequential",og="diverging",dp="quantile",gx="quantize",mx="threshold",C_="ordinal",Jk="point",M7="band",y_="bin-ordinal",Qn="continuous",Z0="discrete",J0="discretizing",Ks="interpolating",w_="temporal";function awe(e){return function(t){let n=t[0],i=t[1],r;return i<n&&(r=n,n=i,i=r),[e.invert(n),e.invert(i)]}}function lwe(e){return function(t){const n=e.range();let i=t[0],r=t[1],s=-1,o,a,l,u;for(r<i&&(a=i,i=r,r=a),l=0,u=n.length;l<u;++l)n[l]>=i&&n[l]<=r&&(s<0&&(s=l),o=l);if(!(s<0))return i=e.invertExtent(n[s]),r=e.invertExtent(n[o]),[i[0]===void 0?i[1]:i[0],r[1]===void 0?r[0]:r[1]]}}function b_(){const e=q0().unknown(void 0),t=e.domain,n=e.range;let i=[0,1],r,s,o=!1,a=0,l=0,u=.5;delete e.unknown;function c(){const d=t().length,h=i[1]<i[0],p=i[1-h],g=v_(d,a,l);let m=i[h-0];r=(p-m)/(g||1),o&&(r=Math.floor(r)),m+=(p-m-r*(d-a))*u,s=r*(1-a),o&&(m=Math.round(m),s=Math.round(s));const C=Ar(d).map(y=>m+r*y);return n(h?C.reverse():C)}return e.domain=function(d){return arguments.length?(t(d),c()):t()},e.range=function(d){return arguments.length?(i=[+d[0],+d[1]],c()):i.slice()},e.rangeRound=function(d){return i=[+d[0],+d[1]],o=!0,c()},e.bandwidth=function(){return s},e.step=function(){return r},e.round=function(d){return arguments.length?(o=!!d,c()):o},e.padding=function(d){return arguments.length?(l=Math.max(0,Math.min(1,d)),a=l,c()):a},e.paddingInner=function(d){return arguments.length?(a=Math.max(0,Math.min(1,d)),c()):a},e.paddingOuter=function(d){return arguments.length?(l=Math.max(0,Math.min(1,d)),c()):l},e.align=function(d){return arguments.length?(u=Math.max(0,Math.min(1,d)),c()):u},e.invertRange=function(d){if(d[0]==null||d[1]==null)return;const h=i[1]<i[0],p=h?n().reverse():n(),g=p.length-1;let m=+d[0],C=+d[1],y,b,S;if(!(m!==m||C!==C)&&(C<m&&(S=m,m=C,C=S),!(C<p[0]||m>i[1-h])))return y=Math.max(0,Zu(p,m)-1),b=m===C?y:Zu(p,C)-1,m-p[y]>s+1e-10&&++y,h&&(S=y,y=g-b,b=g-S),y>b?void 0:t().slice(y,b+1)},e.invert=function(d){const h=e.invertRange([d,d]);return h&&h[0]},e.copy=function(){return b_().domain(t()).range(i).round(o).paddingInner(a).paddingOuter(l).align(u)},c()}function T7(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return T7(t())},e}function uwe(){return T7(b_().paddingInner(1))}var cwe=Array.prototype.map;function dwe(e){return cwe.call(e,_i)}const hwe=Array.prototype.slice;function I7(){let e=[],t=[];function n(i){return i==null||i!==i?void 0:t[(Zu(e,i)-1)%t.length]}return n.domain=function(i){return arguments.length?(e=dwe(i),n):e.slice()},n.range=function(i){return arguments.length?(t=hwe.call(i),n):t.slice()},n.tickFormat=function(i,r){return v7(e[0],wt(e),i??10,r)},n.copy=function(){return I7().domain(n.domain()).range(n.range())},n}const Vb=new Map,_7=Symbol("vega_scale");function O7(e){return e[_7]=!0,e}function fwe(e){return e&&e[_7]===!0}function pwe(e,t,n){const i=function(){const s=t();return s.invertRange||(s.invertRange=s.invert?awe(s):s.invertExtent?lwe(s):void 0),s.type=e,O7(s)};return i.metadata=Fo(xe(n)),i}function Mt(e,t,n){return arguments.length>1?(Vb.set(e,pwe(e,t,n)),this):L7(e)?Vb.get(e):void 0}Mt(owe,C7);Mt(cp,hv,Qn);Mt($l,w7,[Qn,$l]);Mt(X0,f_,Qn);Mt(Q0,zye,Qn);Mt(px,b7,Qn);Mt(qd,Wye,[Qn,w_]);Mt(jd,Uye,[Qn,w_]);Mt(wa,hx,[Qn,Ks]);Mt(`${wa}-${cp}`,hx,[Qn,Ks]);Mt(`${wa}-${$l}`,E7,[Qn,Ks,$l]);Mt(`${wa}-${X0}`,g_,[Qn,Ks]);Mt(`${wa}-${Q0}`,qye,[Qn,Ks]);Mt(`${wa}-${px}`,F7,[Qn,Ks]);Mt(`${og}-${cp}`,A7,[Qn,Ks]);Mt(`${og}-${$l}`,D7,[Qn,Ks,$l]);Mt(`${og}-${X0}`,m_,[Qn,Ks]);Mt(`${og}-${Q0}`,jye,[Qn,Ks]);Mt(`${og}-${px}`,k7,[Qn,Ks]);Mt(dp,S7,[J0,dp]);Mt(gx,x7,J0);Mt(mx,R7,J0);Mt(y_,I7,[Z0,J0]);Mt(C_,q0,Z0);Mt(M7,b_,Z0);Mt(Jk,uwe,Z0);function L7(e){return Vb.has(e)}function Sh(e,t){const n=Vb.get(e);return n&&n.metadata[t]}function S_(e){return Sh(e,Qn)}function hp(e){return Sh(e,Z0)}function eP(e){return Sh(e,J0)}function N7(e){return Sh(e,$l)}function gwe(e){return Sh(e,w_)}function $7(e){return Sh(e,Ks)}function B7(e){return Sh(e,dp)}const mwe=["clamp","base","constant","exponent"];function G7(e,t){const n=t[0],i=wt(t)-n;return function(r){return e(n+r*i)}}function vx(e,t,n){return u_(x_(t||"rgb",n),e)}function z7(e,t){const n=new Array(t),i=t+1;for(let r=0;r<t;)n[r]=e(++r/i);return n}function H7(e,t,n){const i=n-t;let r,s,o;return!i||!Number.isFinite(i)?Hi(.5):(r=(s=e.type).indexOf("-"),s=r<0?s:s.slice(r+1),o=Mt(s)().domain([t,n]).range([0,1]),mwe.forEach(a=>e[a]?o[a](e[a]()):0),o)}function x_(e,t){const n=kye[vwe(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function vwe(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const Cwe={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},ywe={accent:Yye,category10:Kye,category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",dark2:Xye,observable10:Qye,paired:Zye,pastel1:Jye,pastel2:ewe,set1:twe,set2:nwe,set3:P7,tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5"};function V7(e){if(ne(e))return e;const t=e.length/6|0,n=new Array(t);for(let i=0;i<t;)n[i]="#"+e.slice(i*6,++i*6);return n}function W7(e,t){for(const n in e)R_(n,t(e[n]))}const Oz={};W7(ywe,V7);W7(Cwe,e=>vx(V7(e)));function R_(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(Oz[e]=t,this):Oz[e]}const qw="symbol",wwe="discrete",bwe="gradient",Swe=e=>ne(e)?e.map(t=>String(t)):String(e),xwe=(e,t)=>e[1]-t[1],Rwe=(e,t)=>t[1]-e[1];function E_(e,t,n){let i;return kt(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(H0(e.domain())/n||1)+1))),be(t)&&(i=t.step,t=t.interval),Re(t)&&(t=e.type===qd?ng(t):e.type==jd?ig(t):te("Only time and utc scales accept interval strings."),i&&(t=t.every(i))),t}function U7(e,t,n){let i=e.range(),r=i[0],s=wt(i),o=xwe;if(r>s&&(i=s,s=r,r=i,o=Rwe),r=Math.floor(r),s=Math.ceil(s),t=t.map(a=>[a,e(a)]).filter(a=>r<=a[1]&&a[1]<=s).sort(o).map(a=>a[0]),n>0&&t.length>1){const a=[t[0],wt(t)];for(;t.length>n&&t.length>=3;)t=t.filter((l,u)=>!(u%2));t.length<3&&(t=a)}return t}function F_(e,t){return e.bins?U7(e,e.bins,t):e.ticks?e.ticks(t):e.domain()}function q7(e,t,n,i,r,s){const o=t.type;let a=Swe;if(o===qd||r===qd)a=e.timeFormat(i);else if(o===jd||r===jd)a=e.utcFormat(i);else if(N7(o)){const l=e.formatFloat(i);if(s||t.bins)a=l;else{const u=j7(t,n,!1);a=c=>u(c)?l(c):""}}else if(t.tickFormat){const l=t.domain();a=e.formatSpan(l[0],l[l.length-1],n,i)}else i&&(a=e.format(i));return a}function j7(e,t,n){const i=F_(e,t),r=e.base(),s=Math.log(r),o=Math.max(1,r*t/i.length),a=l=>{let u=l/Math.pow(r,Math.round(Math.log(l)/s));return u*r<r-.5&&(u*=r),u<=o};return n?i.filter(a):a}const tP={[dp]:"quantiles",[gx]:"thresholds",[mx]:"domain"},K7={[dp]:"quantiles",[gx]:"domain"};function Y7(e,t){return e.bins?Awe(e.bins):e.type===$l?j7(e,t,!0):tP[e.type]?Fwe(e[tP[e.type]]()):F_(e,t)}function Ewe(e,t,n){const i=t[K7[t.type]](),r=i.length;let s=r>1?i[1]-i[0]:i[0],o;for(o=1;o<r;++o)s=Math.min(s,i[o]-i[o-1]);return e.formatSpan(0,s,3*10,n)}function Fwe(e){const t=[-1/0].concat(e);return t.max=1/0,t}function Awe(e){const t=e.slice(0,-1);return t.max=wt(e),t}const Dwe=e=>tP[e.type]||e.bins;function X7(e,t,n,i,r,s,o){const a=K7[t.type]&&s!==qd&&s!==jd?Ewe(e,t,r):q7(e,t,n,r,s,o);return i===qw&&Dwe(t)?kwe(a):i===wwe?Pwe(a):Mwe(a)}const kwe=e=>(t,n,i)=>{const r=Lz(i[n+1],Lz(i.max,1/0)),s=Nz(t,e),o=Nz(r,e);return s&&o?s+"  "+o:o?"< "+o:" "+s},Lz=(e,t)=>e??t,Pwe=e=>(t,n)=>n?e(t):null,Mwe=e=>t=>e(t),Nz=(e,t)=>Number.isFinite(e)?t(e):null;function Twe(e){const t=e.domain(),n=t.length-1;let i=+t[0],r=+wt(t),s=r-i;if(e.type===mx){const o=n?s/n:.1;i-=o,r+=o,s=r-i}return o=>(o-i)/s}function Iwe(e,t,n,i){const r=i||t.type;return Re(n)&&gwe(r)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&r===qd?e.timeFormat("%A, %d %B %Y, %X"):!n&&r===jd?e.utcFormat("%A, %d %B %Y, %X UTC"):X7(e,t,5,null,n,i,!0)}function Q7(e,t,n){n=n||{};const i=Math.max(3,n.maxlen||7),r=Iwe(e,t,n.format,n.formatType);if(eP(t.type)){const s=Y7(t).slice(1).map(r),o=s.length;return`${o} boundar${o===1?"y":"ies"}: ${s.join(", ")}`}else if(hp(t.type)){const s=t.domain(),o=s.length,a=o>i?s.slice(0,i-2).map(r).join(", ")+", ending with "+s.slice(-1).map(r):s.map(r).join(", ");return`${o} value${o===1?"":"s"}: ${a}`}else{const s=t.domain();return`values from ${r(s[0])} to ${r(wt(s))}`}}let Z7=0;function _we(){Z7=0}const Wb="p_";function A_(e){return e&&e.gradient}function J7(e,t,n){const i=e.gradient;let r=e.id,s=i==="radial"?Wb:"";return r||(r=e.id="gradient_"+Z7++,i==="radial"?(e.x1=Zo(e.x1,.5),e.y1=Zo(e.y1,.5),e.r1=Zo(e.r1,0),e.x2=Zo(e.x2,.5),e.y2=Zo(e.y2,.5),e.r2=Zo(e.r2,.5),s=Wb):(e.x1=Zo(e.x1,0),e.y1=Zo(e.y1,0),e.x2=Zo(e.x2,1),e.y2=Zo(e.y2,0))),t[r]=e,"url("+(n||"")+"#"+s+r+")"}function Zo(e,t){return e??t}function eq(e,t){var n=[],i;return i={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(r,s){return n.push({offset:r,color:s}),i}}}const $z={basis:{curve:DCe},"basis-closed":{curve:kCe},"basis-open":{curve:PCe},bundle:{curve:MCe,tension:"beta",value:.85},cardinal:{curve:TCe,tension:"tension",value:0},"cardinal-open":{curve:_Ce,tension:"tension",value:0},"cardinal-closed":{curve:ICe,tension:"tension",value:0},"catmull-rom":{curve:OCe,tension:"alpha",value:.5},"catmull-rom-closed":{curve:LCe,tension:"alpha",value:.5},"catmull-rom-open":{curve:NCe,tension:"alpha",value:.5},linear:{curve:e_},"linear-closed":{curve:$Ce},monotone:{horizontal:GCe,vertical:BCe},natural:{curve:zCe},step:{curve:HCe},"step-after":{curve:WCe},"step-before":{curve:VCe}};function D_(e,t,n){var i=Ae($z,e)&&$z[e],r=null;return i&&(r=i.curve||i[t||"vertical"],i.tension&&n!=null&&(r=r[i.tension](n))),r}const Owe={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},Lwe=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,Nwe=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,$we=/^((\s+,?\s*)|(,\s*))/,Bwe=/^[01]/;function fp(e){const t=[];return(e.match(Lwe)||[]).forEach(i=>{let r=i[0];const s=r.toLowerCase(),o=Owe[s],a=Gwe(s,o,i.slice(1).trim()),l=a.length;if(l<o||l&&l%o!==0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([r,...a.slice(0,o)]),l!==o){s==="m"&&(r=r==="M"?"L":"l");for(let u=o;u<l;u+=o)t.push([r,...a.slice(u,u+o)])}}),t}function Gwe(e,t,n){const i=[];for(let r=0;t&&r<n.length;)for(let s=0;s<t;++s){const o=e==="a"&&(s===3||s===4)?Bwe:Nwe,a=n.slice(r).match(o);if(a===null)throw Error("Invalid SVG path, incorrect parameter type");r+=a[0].length,i.push(+a[0]);const l=n.slice(r).match($we);l!==null&&(r+=l[0].length)}return i}const ic=Math.PI/180,zwe=1e-14,gd=Math.PI/2,da=Math.PI*2,af=Math.sqrt(3)/2;var dA={},hA={},tq=[].join;function Hwe(e,t,n,i,r,s,o,a,l){const u=tq.call(arguments);if(dA[u])return dA[u];const c=o*ic,d=Math.sin(c),h=Math.cos(c);n=Math.abs(n),i=Math.abs(i);const p=h*(a-e)*.5+d*(l-t)*.5,g=h*(l-t)*.5-d*(a-e)*.5;let m=p*p/(n*n)+g*g/(i*i);m>1&&(m=Math.sqrt(m),n*=m,i*=m);const C=h/n,y=d/n,b=-d/i,S=h/i,x=C*a+y*l,E=b*a+S*l,A=C*e+y*t,F=b*e+S*t;let D=1/((A-x)*(A-x)+(F-E)*(F-E))-.25;D<0&&(D=0);let M=Math.sqrt(D);s==r&&(M=-M);const O=.5*(x+A)-M*(F-E),B=.5*(E+F)+M*(A-x),H=Math.atan2(E-B,x-O);let L=Math.atan2(F-B,A-O)-H;L<0&&s===1?L+=da:L>0&&s===0&&(L-=da);const G=Math.ceil(Math.abs(L/(gd+.001))),q=[];for(let V=0;V<G;++V){const U=H+V*L/G,ie=H+(V+1)*L/G;q[V]=[O,B,U,ie,n,i,d,h]}return dA[u]=q}function Vwe(e){const t=tq.call(e);if(hA[t])return hA[t];var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7];const c=u*o,d=-l*a,h=l*o,p=u*a,g=Math.cos(r),m=Math.sin(r),C=Math.cos(s),y=Math.sin(s),b=.5*(s-r),S=Math.sin(b*.5),x=8/3*S*S/Math.sin(b),E=n+g-x*m,A=i+m+x*g,F=n+C,P=i+y,D=F+x*y,M=P-x*C;return hA[t]=[c*E+d*A,h*E+p*A,c*D+d*M,h*D+p*M,c*F+d*P,h*F+p*P]}const bs=["l",0,0,0,0,0,0,0];function Wwe(e,t,n){const i=bs[0]=e[0];if(i==="a"||i==="A")bs[1]=t*e[1],bs[2]=n*e[2],bs[3]=e[3],bs[4]=e[4],bs[5]=e[5],bs[6]=t*e[6],bs[7]=n*e[7];else if(i==="h"||i==="H")bs[1]=t*e[1];else if(i==="v"||i==="V")bs[1]=n*e[1];else for(var r=1,s=e.length;r<s;++r)bs[r]=(r%2==1?t:n)*e[r];return bs}function Xv(e,t,n,i,r,s){var o,a=null,l=0,u=0,c=0,d=0,h,p,g,m,C=0,y=0;n==null&&(n=0),i==null&&(i=0),r==null&&(r=1),s==null&&(s=r),e.beginPath&&e.beginPath();for(var b=0,S=t.length;b<S;++b){switch(o=t[b],(r!==1||s!==1)&&(o=Wwe(o,r,s)),o[0]){case"l":l+=o[1],u+=o[2],e.lineTo(l+n,u+i);break;case"L":l=o[1],u=o[2],e.lineTo(l+n,u+i);break;case"h":l+=o[1],e.lineTo(l+n,u+i);break;case"H":l=o[1],e.lineTo(l+n,u+i);break;case"v":u+=o[1],e.lineTo(l+n,u+i);break;case"V":u=o[1],e.lineTo(l+n,u+i);break;case"m":l+=o[1],u+=o[2],C=l,y=u,e.moveTo(l+n,u+i);break;case"M":l=o[1],u=o[2],C=l,y=u,e.moveTo(l+n,u+i);break;case"c":h=l+o[5],p=u+o[6],c=l+o[3],d=u+o[4],e.bezierCurveTo(l+o[1]+n,u+o[2]+i,c+n,d+i,h+n,p+i),l=h,u=p;break;case"C":l=o[5],u=o[6],c=o[3],d=o[4],e.bezierCurveTo(o[1]+n,o[2]+i,c+n,d+i,l+n,u+i);break;case"s":h=l+o[3],p=u+o[4],c=2*l-c,d=2*u-d,e.bezierCurveTo(c+n,d+i,l+o[1]+n,u+o[2]+i,h+n,p+i),c=l+o[1],d=u+o[2],l=h,u=p;break;case"S":h=o[3],p=o[4],c=2*l-c,d=2*u-d,e.bezierCurveTo(c+n,d+i,o[1]+n,o[2]+i,h+n,p+i),l=h,u=p,c=o[1],d=o[2];break;case"q":h=l+o[3],p=u+o[4],c=l+o[1],d=u+o[2],e.quadraticCurveTo(c+n,d+i,h+n,p+i),l=h,u=p;break;case"Q":h=o[3],p=o[4],e.quadraticCurveTo(o[1]+n,o[2]+i,h+n,p+i),l=h,u=p,c=o[1],d=o[2];break;case"t":h=l+o[1],p=u+o[2],a[0].match(/[QqTt]/)===null?(c=l,d=u):a[0]==="t"?(c=2*l-g,d=2*u-m):a[0]==="q"&&(c=2*l-c,d=2*u-d),g=c,m=d,e.quadraticCurveTo(c+n,d+i,h+n,p+i),l=h,u=p,c=l+o[1],d=u+o[2];break;case"T":h=o[1],p=o[2],c=2*l-c,d=2*u-d,e.quadraticCurveTo(c+n,d+i,h+n,p+i),l=h,u=p;break;case"a":Bz(e,l+n,u+i,[o[1],o[2],o[3],o[4],o[5],o[6]+l+n,o[7]+u+i]),l+=o[6],u+=o[7];break;case"A":Bz(e,l+n,u+i,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+i]),l=o[6],u=o[7];break;case"z":case"Z":l=C,u=y,e.closePath();break}a=o}}function Bz(e,t,n,i){const r=Hwe(i[5],i[6],i[0],i[1],i[3],i[4],i[2],t,n);for(let s=0;s<r.length;++s){const o=Vwe(r[s]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}const Gz=.5773502691896257,zz={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,da)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/2.5;e.moveTo(-n,-i),e.lineTo(-n,i),e.lineTo(-i,i),e.lineTo(-i,n),e.lineTo(i,n),e.lineTo(i,i),e.lineTo(n,i),e.lineTo(n,-i),e.lineTo(i,-i),e.lineTo(i,-n),e.lineTo(-i,-n),e.lineTo(-i,-i),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),i=-n/2;e.rect(i,i,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/7,r=n/2.5,s=n/8;e.moveTo(-i,n),e.lineTo(i,n),e.lineTo(i,-s),e.lineTo(r,-s),e.lineTo(0,-n),e.lineTo(-r,-s),e.lineTo(-i,-s),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,i=af*n,r=i-n*Gz,s=n/4;e.moveTo(0,-i-r),e.lineTo(-s,i-r),e.lineTo(s,i-r),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,i=af*n,r=i-n*Gz;e.moveTo(0,-i-r),e.lineTo(-n,i-r),e.lineTo(n,i-r),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,i=af*n;e.moveTo(0,-i),e.lineTo(-n,i),e.lineTo(n,i),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,i=af*n;e.moveTo(0,i),e.lineTo(-n,-i),e.lineTo(n,-i),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,i=af*n;e.moveTo(i,0),e.lineTo(-i,-n),e.lineTo(-i,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,i=af*n;e.moveTo(-i,0),e.lineTo(i,-n),e.lineTo(i,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function nq(e){return Ae(zz,e)?zz[e]:Uwe(e)}var fA={};function Uwe(e){if(!Ae(fA,e)){const t=fp(e);fA[e]={draw:function(n,i){Xv(n,t,0,0,Math.sqrt(i)/2)}}}return fA[e]}const wu=.448084975506;function qwe(e){return e.x}function jwe(e){return e.y}function Kwe(e){return e.width}function Ywe(e){return e.height}function sl(e){return typeof e=="function"?e:()=>+e}function Xy(e,t,n){return Math.max(t,Math.min(e,n))}function iq(){var e=qwe,t=jwe,n=Kwe,i=Ywe,r=sl(0),s=r,o=r,a=r,l=null;function u(c,d,h){var p,g=d??+e.call(this,c),m=h??+t.call(this,c),C=+n.call(this,c),y=+i.call(this,c),b=Math.min(C,y)/2,S=Xy(+r.call(this,c),0,b),x=Xy(+s.call(this,c),0,b),E=Xy(+o.call(this,c),0,b),A=Xy(+a.call(this,c),0,b);if(l||(l=p=ix()),S<=0&&x<=0&&E<=0&&A<=0)l.rect(g,m,C,y);else{var F=g+C,P=m+y;l.moveTo(g+S,m),l.lineTo(F-x,m),l.bezierCurveTo(F-wu*x,m,F,m+wu*x,F,m+x),l.lineTo(F,P-A),l.bezierCurveTo(F,P-wu*A,F-wu*A,P,F-A,P),l.lineTo(g+E,P),l.bezierCurveTo(g+wu*E,P,g,P-wu*E,g,P-E),l.lineTo(g,m+S),l.bezierCurveTo(g,m+wu*S,g+wu*S,m,g+S,m),l.closePath()}if(p)return l=null,p+""||null}return u.x=function(c){return arguments.length?(e=sl(c),u):e},u.y=function(c){return arguments.length?(t=sl(c),u):t},u.width=function(c){return arguments.length?(n=sl(c),u):n},u.height=function(c){return arguments.length?(i=sl(c),u):i},u.cornerRadius=function(c,d,h,p){return arguments.length?(r=sl(c),s=d!=null?sl(d):r,a=h!=null?sl(h):r,o=p!=null?sl(p):s,u):r},u.context=function(c){return arguments.length?(l=c??null,u):l},u}function rq(){var e,t,n,i,r=null,s,o,a,l;function u(d,h,p){const g=p/2;if(s){var m=a-h,C=d-o;if(m||C){var y=Math.hypot(m,C),b=(m/=y)*l,S=(C/=y)*l,x=Math.atan2(C,m);r.moveTo(o-b,a-S),r.lineTo(d-m*g,h-C*g),r.arc(d,h,g,x-Math.PI,x),r.lineTo(o+b,a+S),r.arc(o,a,l,x,x+Math.PI)}else r.arc(d,h,g,0,da);r.closePath()}else s=1;o=d,a=h,l=g}function c(d){var h,p=d.length,g,m=!1,C;for(r==null&&(r=C=ix()),h=0;h<=p;++h)!(h<p&&i(g=d[h],h,d))===m&&(m=!m)&&(s=0),m&&u(+e(g,h,d),+t(g,h,d),+n(g,h,d));if(C)return r=null,C+""||null}return c.x=function(d){return arguments.length?(e=d,c):e},c.y=function(d){return arguments.length?(t=d,c):t},c.size=function(d){return arguments.length?(n=d,c):n},c.defined=function(d){return arguments.length?(i=d,c):i},c.context=function(d){return arguments.length?(d==null?r=null:r=d,c):r},c}function eC(e,t){return e??t}const tC=e=>e.x||0,nC=e=>e.y||0,Xwe=e=>e.width||0,Qwe=e=>e.height||0,Zwe=e=>(e.x||0)+(e.width||0),Jwe=e=>(e.y||0)+(e.height||0),ebe=e=>e.startAngle||0,tbe=e=>e.endAngle||0,nbe=e=>e.padAngle||0,ibe=e=>e.innerRadius||0,rbe=e=>e.outerRadius||0,sbe=e=>e.cornerRadius||0,obe=e=>eC(e.cornerRadiusTopLeft,e.cornerRadius)||0,abe=e=>eC(e.cornerRadiusTopRight,e.cornerRadius)||0,lbe=e=>eC(e.cornerRadiusBottomRight,e.cornerRadius)||0,ube=e=>eC(e.cornerRadiusBottomLeft,e.cornerRadius)||0,cbe=e=>eC(e.size,64),dbe=e=>e.size||1,Cx=e=>e.defined!==!1,hbe=e=>nq(e.shape||"circle"),fbe=ECe().startAngle(ebe).endAngle(tbe).padAngle(nbe).innerRadius(ibe).outerRadius(rbe).cornerRadius(sbe),pbe=T9().x(tC).y1(nC).y0(Jwe).defined(Cx),gbe=T9().y(nC).x1(tC).x0(Zwe).defined(Cx),mbe=M9().x(tC).y(nC).defined(Cx),vbe=iq().x(tC).y(nC).width(Xwe).height(Qwe).cornerRadius(obe,abe,lbe,ube),Cbe=ACe().type(hbe).size(cbe),ybe=rq().x(tC).y(nC).defined(Cx).size(dbe);function k_(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function wbe(e,t){return fbe.context(e)(t)}function bbe(e,t){const n=t[0],i=n.interpolate||"linear";return(n.orient==="horizontal"?gbe:pbe).curve(D_(i,n.orient,n.tension)).context(e)(t)}function Sbe(e,t){const n=t[0],i=n.interpolate||"linear";return mbe.curve(D_(i,n.orient,n.tension)).context(e)(t)}function ag(e,t,n,i){return vbe.context(e)(t,n,i)}function xbe(e,t){return(t.mark.shape||t.shape).context(e)(t)}function Rbe(e,t){return Cbe.context(e)(t)}function Ebe(e,t){return ybe.context(e)(t)}var sq=1;function oq(){sq=1}function P_(e,t,n){var i=t.clip,r=e._defs,s=t.clip_id||(t.clip_id="clip"+sq++),o=r.clipping[s]||(r.clipping[s]={id:s});return ot(i)?o.path=i(null):k_(n)?o.path=ag(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+s+")"}function Bn(e){this.clear(),e&&this.union(e)}Bn.prototype={clone(){return new Bn(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,i){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),i<t?(this.y2=t,this.y1=i):(this.y1=t,this.y2=i),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const i=this.rotatedPoints(e,t,n);return this.clear().add(i[0],i[1]).add(i[2],i[3]).add(i[4],i[5]).add(i[6],i[7])},rotatedPoints(e,t,n){var{x1:i,y1:r,x2:s,y2:o}=this,a=Math.cos(e),l=Math.sin(e),u=t-t*a+n*l,c=n-t*l-n*a;return[a*i-l*r+u,l*i+a*r+c,a*i-l*o+u,l*i+a*o+c,a*s-l*r+u,l*s+a*r+c,a*s-l*o+u,l*s+a*o+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function yx(e){this.mark=e,this.bounds=this.bounds||new Bn}function wx(e){yx.call(this,e),this.items=this.items||[]}me(wx,yx);class aq{constructor(t){this._pending=0,this._loader=t||U1()}pending(){return this._pending}sanitizeURL(t){const n=this;return Hz(n),n._loader.sanitize(t,{context:"href"}).then(i=>(hm(n),i)).catch(()=>(hm(n),null))}loadImage(t){const n=this,i=UCe();return Hz(n),n._loader.sanitize(t,{context:"image"}).then(r=>{const s=r.href;if(!s||!i)throw{url:s};const o=new i,a=Ae(r,"crossOrigin")?r.crossOrigin:"anonymous";return a!=null&&(o.crossOrigin=a),o.onload=()=>hm(n),o.onerror=()=>hm(n),o.src=s,o}).catch(r=>(hm(n),{complete:!1,width:0,height:0,src:r&&r.url||""}))}ready(){const t=this;return new Promise(n=>{function i(r){t.pending()?setTimeout(()=>{i(!0)},10):n(r)}i(!1)})}}function Hz(e){e._pending+=1}function hm(e){e._pending-=1}function Zl(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const i=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(i+(n?Fbe(t,i):0))}return e}function Fbe(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const Abe=da-1e-8;let bx,jw,Kw,Sd,nP,Yw,iP,rP;const _u=(e,t)=>bx.add(e,t),Xw=(e,t)=>_u(jw=e,Kw=t),Vz=e=>_u(e,bx.y1),Wz=e=>_u(bx.x1,e),md=(e,t)=>nP*e+iP*t,vd=(e,t)=>Yw*e+rP*t,pA=(e,t)=>_u(md(e,t),vd(e,t)),gA=(e,t)=>Xw(md(e,t),vd(e,t));function iC(e,t){return bx=e,t?(Sd=t*ic,nP=rP=Math.cos(Sd),Yw=Math.sin(Sd),iP=-Yw):(nP=rP=1,Sd=Yw=iP=0),Dbe}const Dbe={beginPath(){},closePath(){},moveTo:gA,lineTo:gA,rect(e,t,n,i){Sd?(pA(e+n,t),pA(e+n,t+i),pA(e,t+i),gA(e,t)):(_u(e+n,t+i),Xw(e,t))},quadraticCurveTo(e,t,n,i){const r=md(e,t),s=vd(e,t),o=md(n,i),a=vd(n,i);Uz(jw,r,o,Vz),Uz(Kw,s,a,Wz),Xw(o,a)},bezierCurveTo(e,t,n,i,r,s){const o=md(e,t),a=vd(e,t),l=md(n,i),u=vd(n,i),c=md(r,s),d=vd(r,s);qz(jw,o,l,c,Vz),qz(Kw,a,u,d,Wz),Xw(c,d)},arc(e,t,n,i,r,s){if(i+=Sd,r+=Sd,jw=n*Math.cos(r)+e,Kw=n*Math.sin(r)+t,Math.abs(r-i)>Abe)_u(e-n,t-n),_u(e+n,t+n);else{const o=u=>_u(n*Math.cos(u)+e,n*Math.sin(u)+t);let a,l;if(o(i),o(r),r!==i)if(i=i%da,i<0&&(i+=da),r=r%da,r<0&&(r+=da),r<i&&(s=!s,a=i,i=r,r=a),s)for(r-=da,a=i-i%gd,l=0;l<4&&a>r;++l,a-=gd)o(a);else for(a=i-i%gd+gd,l=0;l<4&&a<r;++l,a=a+gd)o(a)}}};function Uz(e,t,n,i){const r=(e-t)/(e+n-2*t);0<r&&r<1&&i(e+(t-e)*r)}function qz(e,t,n,i,r){const s=i-e+3*t-3*n,o=e+n-2*t,a=e-t;let l=0,u=0,c;Math.abs(s)>zwe?(c=o*o+a*s,c>=0&&(c=Math.sqrt(c),l=(-o+c)/s,u=(-o-c)/s)):l=.5*a/o,0<l&&l<1&&r(jz(l,e,t,n,i)),0<u&&u<1&&r(jz(u,e,t,n,i))}function jz(e,t,n,i,r){const s=1-e,o=s*s,a=e*e;return o*s*t+3*o*e*n+3*s*a*i+a*e*r}var Ku=(Ku=ju(1,1))?Ku.getContext("2d"):null;const sP=new Bn;function M_(e){return function(t,n){if(!Ku)return!0;e(Ku,t),sP.clear().union(t.bounds).intersect(n).round();const{x1:i,y1:r,x2:s,y2:o}=sP;for(let a=r;a<=o;++a)for(let l=i;l<=s;++l)if(Ku.isPointInPath(l,a))return!0;return!1}}function T_(e,t){return t.contains(e.x||0,e.y||0)}function lq(e,t){const n=e.x||0,i=e.y||0,r=e.width||0,s=e.height||0;return t.intersects(sP.set(n,i,n+r,i+s))}function uq(e,t){const n=e.x||0,i=e.y||0,r=e.x2!=null?e.x2:n,s=e.y2!=null?e.y2:i;return Ff(t,n,i,r,s)}function Ff(e,t,n,i,r){const{x1:s,y1:o,x2:a,y2:l}=e,u=i-t,c=r-n;let d=0,h=1,p,g,m,C;for(C=0;C<4;++C){if(C===0&&(p=-u,g=-(s-t)),C===1&&(p=u,g=a-t),C===2&&(p=-c,g=-(o-n)),C===3&&(p=c,g=l-n),Math.abs(p)<1e-10&&g<0)return!1;if(m=g/p,p<0){if(m>h)return!1;m>d&&(d=m)}else if(p>0){if(m<d)return!1;m<h&&(h=m)}}return!0}function pp(e,t){e.globalCompositeOperation=t.blend||"source-over"}function oo(e,t){return e??t}function Kz(e,t){const n=t.length;for(let i=0;i<n;++i)e.addColorStop(t[i].offset,t[i].color);return e}function kbe(e,t,n){const i=n.width(),r=n.height();let s;if(t.gradient==="radial")s=e.createRadialGradient(n.x1+oo(t.x1,.5)*i,n.y1+oo(t.y1,.5)*r,Math.max(i,r)*oo(t.r1,0),n.x1+oo(t.x2,.5)*i,n.y1+oo(t.y2,.5)*r,Math.max(i,r)*oo(t.r2,.5));else{const o=oo(t.x1,0),a=oo(t.y1,0),l=oo(t.x2,1),u=oo(t.y2,0);if(o===l||a===u||i===r)s=e.createLinearGradient(n.x1+o*i,n.y1+a*r,n.x1+l*i,n.y1+u*r);else{const c=ju(Math.ceil(i),Math.ceil(r)),d=c.getContext("2d");return d.scale(i,r),d.fillStyle=Kz(d.createLinearGradient(o,a,l,u),t.stops),d.fillRect(0,0,i,r),e.createPattern(c,"no-repeat")}}return Kz(s,t.stops)}function cq(e,t,n){return A_(n)?kbe(e,n,t.bounds):n}function Ub(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=cq(e,t,t.fill),!0):!1}var Pbe=[];function gp(e,t,n){var i=(i=t.strokeWidth)!=null?i:1;return i<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=cq(e,t,t.stroke),e.lineWidth=i,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||Pbe),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function Mbe(e,t){return e.zindex-t.zindex||e.index-t.index}function I_(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],i,r,s;for(r=0,s=t.length;r<s;++r)i=t[r],i.index=r,i.zindex&&n.push(i);return e.zdirty=!1,e.zitems=n.sort(Mbe)}function Do(e,t){var n=e.items,i,r;if(!n||!n.length)return;const s=I_(e);if(s&&s.length){for(i=0,r=n.length;i<r;++i)n[i].zindex||t(n[i]);n=s}for(i=0,r=n.length;i<r;++i)t(n[i])}function qb(e,t){var n=e.items,i,r;if(!n||!n.length)return null;const s=I_(e);for(s&&s.length&&(n=s),r=n.length;--r>=0;)if(i=t(n[r]))return i;if(n===s){for(n=e.items,r=n.length;--r>=0;)if(!n[r].zindex&&(i=t(n[r])))return i}return null}function __(e){return function(t,n,i){Do(n,r=>{(!i||i.intersects(r.bounds))&&dq(e,t,r,r)})}}function Tbe(e){return function(t,n,i){n.items.length&&(!i||i.intersects(n.bounds))&&dq(e,t,n.items[0],n.items)}}function dq(e,t,n,i){var r=n.opacity==null?1:n.opacity;r!==0&&(e(t,i)||(pp(t,n),n.fill&&Ub(t,n,r)&&t.fill(),n.stroke&&gp(t,n,r)&&t.stroke()))}function Sx(e){return e=e||zs,function(t,n,i,r,s,o){return i*=t.pixelRatio,r*=t.pixelRatio,qb(n,a=>{const l=a.bounds;if(!(l&&!l.contains(s,o)||!l)&&e(t,a,i,r,s,o))return a})}}function rC(e,t){return function(n,i,r,s){var o=Array.isArray(i)?i[0]:i,a=t??o.fill,l=o.stroke&&n.isPointInStroke,u,c;return l&&(u=o.strokeWidth,c=o.strokeCap,n.lineWidth=u??1,n.lineCap=c??"butt"),e(n,i)?!1:a&&n.isPointInPath(r,s)||l&&n.isPointInStroke(r,s)}}function O_(e){return Sx(rC(e))}function Pd(e,t){return"translate("+e+","+t+")"}function L_(e){return"rotate("+e+")"}function Ibe(e,t){return"scale("+e+","+t+")"}function hq(e){return Pd(e.x||0,e.y||0)}function _be(e){return Pd(e.x||0,e.y||0)+(e.angle?" "+L_(e.angle):"")}function Obe(e){return Pd(e.x||0,e.y||0)+(e.angle?" "+L_(e.angle):"")+(e.scaleX||e.scaleY?" "+Ibe(e.scaleX||1,e.scaleY||1):"")}function N_(e,t,n){function i(o,a){o("transform",_be(a)),o("d",t(null,a))}function r(o,a){return t(iC(o,a.angle),a),Zl(o,a).translate(a.x||0,a.y||0)}function s(o,a){var l=a.x||0,u=a.y||0,c=a.angle||0;o.translate(l,u),c&&o.rotate(c*=ic),o.beginPath(),t(o,a),c&&o.rotate(-c),o.translate(-l,-u)}return{type:e,tag:"path",nested:!1,attr:i,bound:r,draw:__(s),pick:O_(s),isect:n||M_(s)}}var Lbe=N_("arc",wbe);function Nbe(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],i=e[0].orient==="horizontal"?"y":"x",r=e.length,s=1/0,o,a;--r>=0;)e[r].defined!==!1&&(a=Math.abs(e[r][i]-n),a<s&&(s=a,o=e[r]));return o}function $be(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),i=e.length,r,s,o;--i>=0;)if(e[i].defined!==!1&&(r=e[i].x-t[0],s=e[i].y-t[1],o=r*r+s*s,o<n))return e[i];return null}function Bbe(e,t){for(var n=e.length,i,r,s;--n>=0;)if(e[n].defined!==!1&&(i=e[n].x-t[0],r=e[n].y-t[1],s=i*i+r*r,i=e[n].size||1,s<i*i))return e[n];return null}function $_(e,t,n){function i(l,u){var c=u.mark.items;c.length&&l("d",t(null,c))}function r(l,u){var c=u.items;return c.length===0?l:(t(iC(l),c),Zl(l,c[0]))}function s(l,u){l.beginPath(),t(l,u)}const o=rC(s);function a(l,u,c,d,h,p){var g=u.items,m=u.bounds;return!g||!g.length||m&&!m.contains(h,p)?null:(c*=l.pixelRatio,d*=l.pixelRatio,o(l,g,c,d)?g[0]:null)}return{type:e,tag:"path",nested:!0,attr:i,bound:r,draw:Tbe(s),pick:a,isect:T_,tip:n}}var Gbe=$_("area",bbe,Nbe);function zbe(e,t){var n=t.clip;e.save(),ot(n)?(e.beginPath(),n(e),e.clip()):fq(e,t.group)}function fq(e,t){e.beginPath(),k_(t)?ag(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function pq(e){const t=oo(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function Hbe(e,t){e("transform",hq(t))}function gq(e,t){const n=pq(t);e("d",ag(null,t,n,n))}function Vbe(e,t){e("class","background"),e("aria-hidden",!0),gq(e,t)}function Wbe(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?gq(e,t):e("d","")}function Ube(e,t,n){const i=t.clip?P_(n,t,t):null;e("clip-path",i)}function qbe(e,t){if(!t.clip&&t.items){const n=t.items,i=n.length;for(let r=0;r<i;++r)e.union(n[r].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),Zl(e,t),e.translate(t.x||0,t.y||0)}function Qv(e,t,n,i){const r=pq(t);e.beginPath(),ag(e,t,(n||0)+r,(i||0)+r)}const jbe=rC(Qv),Kbe=rC(Qv,!1),Ybe=rC(Qv,!0);function Xbe(e,t,n,i){Do(t,r=>{const s=r.x||0,o=r.y||0,a=r.strokeForeground,l=r.opacity==null?1:r.opacity;(r.stroke||r.fill)&&l&&(Qv(e,r,s,o),pp(e,r),r.fill&&Ub(e,r,l)&&e.fill(),r.stroke&&!a&&gp(e,r,l)&&e.stroke()),e.save(),e.translate(s,o),r.clip&&fq(e,r),n&&n.translate(-s,-o),Do(r,u=>{(u.marktype==="group"||i==null||i.includes(u.marktype))&&this.draw(e,u,n,i)}),n&&n.translate(s,o),e.restore(),a&&r.stroke&&l&&(Qv(e,r,s,o),pp(e,r),gp(e,r,l)&&e.stroke())})}function Qbe(e,t,n,i,r,s){if(t.bounds&&!t.bounds.contains(r,s)||!t.items)return null;const o=n*e.pixelRatio,a=i*e.pixelRatio;return qb(t,l=>{let u,c,d;const h=l.bounds;if(h&&!h.contains(r,s))return;c=l.x||0,d=l.y||0;const p=c+(l.width||0),g=d+(l.height||0),m=l.clip;if(m&&(r<c||r>p||s<d||s>g))return;if(e.save(),e.translate(c,d),c=r-c,d=s-d,m&&k_(l)&&!Ybe(e,l,o,a))return e.restore(),null;const C=l.strokeForeground,y=t.interactive!==!1;return y&&C&&l.stroke&&Kbe(e,l,o,a)?(e.restore(),l):(u=qb(l,b=>Zbe(b,c,d)?this.pick(b,n,i,c,d):null),!u&&y&&(l.fill||!C&&l.stroke)&&jbe(e,l,o,a)&&(u=l),e.restore(),u||null)})}function Zbe(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var Jbe={type:"group",tag:"g",nested:!1,attr:Hbe,bound:qbe,draw:Xbe,pick:Qbe,isect:lq,content:Ube,background:Vbe,foreground:Wbe},Zv={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function B_(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(i=>{e.image=i,e.image.url=e.url})),n}function G_(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function z_(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function xx(e,t){return e==="center"?t/2:e==="right"?t:0}function Rx(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function eSe(e,t,n){const i=B_(t,n),r=G_(t,i),s=z_(t,i),o=(t.x||0)-xx(t.align,r),a=(t.y||0)-Rx(t.baseline,s),l=!i.src&&i.toDataURL?i.toDataURL():i.src||"";e("href",l,Zv["xmlns:xlink"],"xlink:href"),e("transform",Pd(o,a)),e("width",r),e("height",s),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function tSe(e,t){const n=t.image,i=G_(t,n),r=z_(t,n),s=(t.x||0)-xx(t.align,i),o=(t.y||0)-Rx(t.baseline,r);return e.set(s,o,s+i,o+r)}function nSe(e,t,n){Do(t,i=>{if(n&&!n.intersects(i.bounds))return;const r=B_(i,this);let s=G_(i,r),o=z_(i,r);if(s===0||o===0)return;let a=(i.x||0)-xx(i.align,s),l=(i.y||0)-Rx(i.baseline,o),u,c,d,h;i.aspect!==!1&&(c=r.width/r.height,d=i.width/i.height,c===c&&d===d&&c!==d&&(d<c?(h=s/c,l+=(o-h)/2,o=h):(h=o*c,a+=(s-h)/2,s=h))),(r.complete||r.toDataURL)&&(pp(e,i),e.globalAlpha=(u=i.opacity)!=null?u:1,e.imageSmoothingEnabled=i.smooth!==!1,e.drawImage(r,a,l,s,o))})}var iSe={type:"image",tag:"image",nested:!1,attr:eSe,bound:tSe,draw:nSe,pick:Sx(),isect:zs,get:B_,xOffset:xx,yOffset:Rx},rSe=$_("line",Sbe,$be);function sSe(e,t){var n=t.scaleX||1,i=t.scaleY||1;(n!==1||i!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",Obe(t)),e("d",t.path)}function Qw(e,t){var n=t.path;if(n==null)return!0;var i=t.x||0,r=t.y||0,s=t.scaleX||1,o=t.scaleY||1,a=(t.angle||0)*ic,l=t.pathCache;(!l||l.path!==n)&&((t.pathCache=l=fp(n)).path=n),a&&e.rotate&&e.translate?(e.translate(i,r),e.rotate(a),Xv(e,l,0,0,s,o),e.rotate(-a),e.translate(-i,-r)):Xv(e,l,i,r,s,o)}function oSe(e,t){return Qw(iC(e,t.angle),t)?e.set(0,0,0,0):Zl(e,t,!0)}var aSe={type:"path",tag:"path",nested:!1,attr:sSe,bound:oSe,draw:__(Qw),pick:O_(Qw),isect:M_(Qw)};function lSe(e,t){e("d",ag(null,t))}function uSe(e,t){var n,i;return Zl(e.set(n=t.x||0,i=t.y||0,n+t.width||0,i+t.height||0),t)}function Yz(e,t){e.beginPath(),ag(e,t)}var cSe={type:"rect",tag:"path",nested:!1,attr:lSe,bound:uSe,draw:__(Yz),pick:O_(Yz),isect:lq};function dSe(e,t){e("transform",hq(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function hSe(e,t){var n,i;return Zl(e.set(n=t.x||0,i=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:i),t)}function mq(e,t,n){var i,r,s,o;return t.stroke&&gp(e,t,n)?(i=t.x||0,r=t.y||0,s=t.x2!=null?t.x2:i,o=t.y2!=null?t.y2:r,e.beginPath(),e.moveTo(i,r),e.lineTo(s,o),!0):!1}function fSe(e,t,n){Do(t,i=>{if(!(n&&!n.intersects(i.bounds))){var r=i.opacity==null?1:i.opacity;r&&mq(e,i,r)&&(pp(e,i),e.stroke())}})}function pSe(e,t,n,i){return e.isPointInStroke?mq(e,t,1)&&e.isPointInStroke(n,i):!1}var gSe={type:"rule",tag:"line",nested:!1,attr:dSe,bound:hSe,draw:fSe,pick:Sx(pSe),isect:uq},mSe=N_("shape",xbe),vSe=N_("symbol",Rbe,T_);const Xz=S8();var is={height:Na,measureWidth:H_,estimateWidth:jb,width:jb,canvas:vq};vq(!0);function vq(e){is.width=e&&Ku?H_:jb}function jb(e,t){return Cq(sc(e,t),Na(e))}function Cq(e,t){return~~(.8*e.length*t)}function H_(e,t){return Na(e)<=0||!(t=sc(e,t))?0:yq(t,Ex(e))}function yq(e,t){const n=`(${t}) ${e}`;let i=Xz.get(n);return i===void 0&&(Ku.font=t,i=Ku.measureText(e).width,Xz.set(n,i)),i}function Na(e){return e.fontSize!=null?+e.fontSize||0:11}function rc(e){return e.lineHeight!=null?e.lineHeight:Na(e)+2}function CSe(e){return ne(e)?e.length>1?e:e[0]:e}function sC(e){return CSe(e.lineBreak&&e.text&&!ne(e.text)?e.text.split(e.lineBreak):e.text)}function V_(e){const t=sC(e);return(ne(t)?t.length-1:0)*rc(e)}function sc(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?wSe(e,n):n}function ySe(e){if(is.width===H_){const t=Ex(e);return n=>yq(n,t)}else if(is.width===jb){const t=Na(e);return n=>Cq(n,t)}else return t=>is.width(e,t)}function wSe(e,t){var n=+e.limit,i=ySe(e);if(i(t)<n)return t;var r=e.ellipsis||"",s=e.dir==="rtl",o=0,a=t.length,l;if(n-=i(r),s){for(;o<a;)l=o+a>>>1,i(t.slice(l))>n?o=l+1:a=l;return r+t.slice(o)}else{for(;o<a;)l=1+(o+a>>>1),i(t.slice(0,l))<n?o=l:a=l-1;return t.slice(0,o)+r}}function oC(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Ex(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+Na(e)+"px "+oC(e,t)}function W_(e){var t=e.baseline,n=Na(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*rc(e):t==="line-bottom"?.29*n-.5*rc(e):0)}const bSe={left:"start",center:"middle",right:"end"},fv=new Bn;function Fx(e){var t=e.x||0,n=e.y||0,i=e.radius||0,r;return i&&(r=(e.theta||0)-gd,t+=i*Math.cos(r),n+=i*Math.sin(r)),fv.x1=t,fv.y1=n,fv}function SSe(e,t){var n=t.dx||0,i=(t.dy||0)+W_(t),r=Fx(t),s=r.x1,o=r.y1,a=t.angle||0,l;e("text-anchor",bSe[t.align]||"start"),a?(l=Pd(s,o)+" "+L_(a),(n||i)&&(l+=" "+Pd(n,i))):l=Pd(s+n,o+i),e("transform",l)}function U_(e,t,n){var i=is.height(t),r=t.align,s=Fx(t),o=s.x1,a=s.y1,l=t.dx||0,u=(t.dy||0)+W_(t)-Math.round(.8*i),c=sC(t),d;if(ne(c)?(i+=rc(t)*(c.length-1),d=c.reduce((h,p)=>Math.max(h,is.width(t,p)),0)):d=is.width(t,c),r==="center"?l-=d/2:r==="right"&&(l-=d),e.set(l+=o,u+=a,l+d,u+i),t.angle&&!n)e.rotate(t.angle*ic,o,a);else if(n===2)return e.rotatedPoints(t.angle*ic,o,a);return e}function xSe(e,t,n){Do(t,i=>{var r=i.opacity==null?1:i.opacity,s,o,a,l,u,c,d;if(!(n&&!n.intersects(i.bounds)||r===0||i.fontSize<=0||i.text==null||i.text.length===0)){if(e.font=Ex(i),e.textAlign=i.align||"left",s=Fx(i),o=s.x1,a=s.y1,i.angle&&(e.save(),e.translate(o,a),e.rotate(i.angle*ic),o=a=0),o+=i.dx||0,a+=(i.dy||0)+W_(i),c=sC(i),pp(e,i),ne(c))for(u=rc(i),l=0;l<c.length;++l)d=sc(i,c[l]),i.fill&&Ub(e,i,r)&&e.fillText(d,o,a),i.stroke&&gp(e,i,r)&&e.strokeText(d,o,a),a+=u;else d=sc(i,c),i.fill&&Ub(e,i,r)&&e.fillText(d,o,a),i.stroke&&gp(e,i,r)&&e.strokeText(d,o,a);i.angle&&e.restore()}})}function RSe(e,t,n,i,r,s){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var o=Fx(t),a=o.x1,l=o.y1,u=U_(fv,t,1),c=-t.angle*ic,d=Math.cos(c),h=Math.sin(c),p=d*r-h*s+(a-d*a+h*l),g=h*r+d*s+(l-h*a-d*l);return u.contains(p,g)}function ESe(e,t){const n=U_(fv,e,2);return Ff(t,n[0],n[1],n[2],n[3])||Ff(t,n[0],n[1],n[4],n[5])||Ff(t,n[4],n[5],n[6],n[7])||Ff(t,n[2],n[3],n[6],n[7])}var FSe={type:"text",tag:"text",nested:!1,attr:SSe,bound:U_,draw:xSe,pick:Sx(RSe),isect:ESe},ASe=$_("trail",Ebe,Bbe),us={arc:Lbe,area:Gbe,group:Jbe,image:iSe,line:rSe,path:aSe,rect:cSe,rule:gSe,shape:mSe,symbol:vSe,text:FSe,trail:ASe};function oP(e,t,n){var i=us[e.mark.marktype],r=t||i.bound;return i.nested&&(e=e.mark),r(e.bounds||(e.bounds=new Bn),e,n)}var Qz={mark:null};function wq(e,t,n){var i=us[e.marktype],r=i.bound,s=e.items,o=s&&s.length,a,l,u,c;if(i.nested)return o?u=s[0]:(Qz.mark=e,u=Qz),c=oP(u,r,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new Bn,o)for(a=0,l=s.length;a<l;++a)t.union(oP(s[a],r,n));return e.bounds=t}const DSe=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function bq(e,t){return JSON.stringify(e,DSe,t)}function Sq(e){const t=typeof e=="string"?JSON.parse(e):e;return xq(t)}function xq(e){var t=e.marktype,n=e.items,i,r,s;if(n)for(r=0,s=n.length;r<s;++r)i=t?"mark":"group",n[r][i]=e,n[r].zindex&&(n[r][i].zdirty=!0),(t||i)==="group"&&xq(n[r]);return t&&wq(e),e}class Rq{constructor(t){arguments.length?this.root=Sq(t):(this.root=Zz({marktype:"group",name:"root",role:"frame"}),this.root.items=[new wx(this.root)])}toJSON(t){return bq(this.root,t||0)}mark(t,n,i){n=n||this.root.items[0];const r=Zz(t,n);return n.items[i]=r,r.zindex&&(r.group.zdirty=!0),r}}function Zz(e,t){const n={bounds:new Bn,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function Ou(e,t,n){return!e&&typeof document<"u"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function q_(e,t){t=t.toLowerCase();for(var n=e.childNodes,i=0,r=n.length;i<r;++i)if(n[i].tagName.toLowerCase()===t)return n[i]}function Wn(e,t,n,i){var r=e.childNodes[t],s;return(!r||r.tagName.toLowerCase()!==n.toLowerCase())&&(s=r||null,r=Ou(e.ownerDocument,n,i),e.insertBefore(r,s)),r}function Fs(e,t){for(var n=e.childNodes,i=n.length;i>t;)e.removeChild(n[--i]);return e}function Eq(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function Ax(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function kSe(e,t,n,i){var r=e&&e.mark,s,o;if(r&&(s=us[r.marktype]).tip){for(o=Ax(t,n),o[0]-=i[0],o[1]-=i[1];e=e.mark.group;)o[0]-=e.x||0,o[1]-=e.y||0;e=s.tip(r.items,o)}return e}let j_=class{constructor(t,n){this._active=null,this._handlers={},this._loader=t||U1(),this._tooltip=n||PSe}initialize(t,n,i){return this._el=t,this._obj=i||null,this.origin(n)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()}scene(t){return arguments.length?(this._scene=t,this):this._scene}on(){}off(){}_handlerIndex(t,n,i){for(let r=t?t.length:0;--r>=0;)if(t[r].type===n&&(!i||t[r].handler===i))return r;return-1}handlers(t){const n=this._handlers,i=[];if(t)i.push(...n[this.eventName(t)]);else for(const r in n)i.push(...n[r]);return i}eventName(t){const n=t.indexOf(".");return n<0?t:t.slice(0,n)}handleHref(t,n,i){this._loader.sanitize(i,{context:"href"}).then(r=>{const s=new MouseEvent(t.type,t),o=Ou(null,"a");for(const a in r)o.setAttribute(a,r[a]);o.dispatchEvent(s)}).catch(()=>{})}handleTooltip(t,n,i){if(n&&n.tooltip!=null){n=kSe(n,t,this.canvas(),this._origin);const r=i&&n&&n.tooltip||null;this._tooltip.call(this._obj,this,t,n,r)}}getItemBoundingClientRect(t){const n=this.canvas();if(!n)return;const i=n.getBoundingClientRect(),r=this._origin,s=t.bounds,o=s.width(),a=s.height();let l=s.x1+r[0]+i.left,u=s.y1+r[1]+i.top;for(;t.mark&&(t=t.mark.group);)l+=t.x||0,u+=t.y||0;return{x:l,y:u,width:o,height:a,left:l,top:u,right:l+o,bottom:u+a}}};function PSe(e,t,n,i){e.element().setAttribute("title",i||"")}class aC{constructor(t){this._el=null,this._bgcolor=null,this._loader=new aq(t)}initialize(t,n,i,r,s){return this._el=t,this.resize(n,i,r,s)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}background(t){return arguments.length===0?this._bgcolor:(this._bgcolor=t,this)}resize(t,n,i,r){return this._width=t,this._height=n,this._origin=i||[0,0],this._scale=r||1,this}dirty(){}render(t,n){const i=this;return i._call=function(){i._render(t,n)},i._call(),i._call=null,i}_render(){}renderAsync(t,n){const i=this.render(t,n);return this._ready?this._ready.then(()=>i):Promise.resolve(i)}_load(t,n){var i=this,r=i._loader[t](n);if(!i._ready){const s=i._call;i._ready=i._loader.ready().then(o=>{o&&s(),i._ready=null})}return r}sanitizeURL(t){return this._load("sanitizeURL",t)}loadImage(t){return this._load("loadImage",t)}}const MSe="keydown",TSe="keypress",ISe="keyup",Fq="dragenter",Zw="dragleave",Aq="dragover",aP="pointerdown",_Se="pointerup",Kb="pointermove",Jw="pointerout",Dq="pointerover",lP="mousedown",OSe="mouseup",kq="mousemove",Yb="mouseout",Pq="mouseover",Xb="click",LSe="dblclick",NSe="wheel",Mq="mousewheel",Qb="touchstart",Zb="touchmove",Jb="touchend",$Se=[MSe,TSe,ISe,Fq,Zw,Aq,aP,_Se,Kb,Jw,Dq,lP,OSe,kq,Yb,Pq,Xb,LSe,NSe,Mq,Qb,Zb,Jb],uP=Kb,pv=Yb,cP=Xb;class lC extends j_{constructor(t,n){super(t,n),this._down=null,this._touch=null,this._first=!0,this._events={},this.events=$Se,this.pointermove=eH([Kb,kq],[Dq,Pq],[Jw,Yb]),this.dragover=eH([Aq],[Fq],[Zw]),this.pointerout=tH([Jw,Yb]),this.dragleave=tH([Zw])}initialize(t,n,i){return this._canvas=t&&q_(t,"canvas"),[Xb,lP,aP,Kb,Jw,Zw].forEach(r=>Jz(this,r)),super.initialize(t,n,i)}canvas(){return this._canvas}context(){return this._canvas.getContext("2d")}DOMMouseScroll(t){this.fire(Mq,t)}pointerdown(t){this._down=this._active,this.fire(aP,t)}mousedown(t){this._down=this._active,this.fire(lP,t)}click(t){this._down===this._active&&(this.fire(Xb,t),this._down=null)}touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(Qb,t,!0)}touchmove(t){this.fire(Zb,t,!0)}touchend(t){this.fire(Jb,t,!0),this._touch=null}fire(t,n,i){const r=i?this._touch:this._active,s=this._handlers[t];if(n.vegaType=t,t===cP&&r&&r.href?this.handleHref(n,r,r.href):(t===uP||t===pv)&&this.handleTooltip(n,r,t!==pv),s)for(let o=0,a=s.length;o<a;++o)s[o].handler.call(this._obj,n,r)}on(t,n){const i=this.eventName(t),r=this._handlers;return this._handlerIndex(r[i],t,n)<0&&(Jz(this,t),(r[i]||(r[i]=[])).push({type:t,handler:n})),this}off(t,n){const i=this.eventName(t),r=this._handlers[i],s=this._handlerIndex(r,t,n);return s>=0&&r.splice(s,1),this}pickEvent(t){const n=Ax(t,this._canvas),i=this._origin;return this.pick(this._scene,n[0],n[1],n[0]-i[0],n[1]-i[1])}pick(t,n,i,r,s){const o=this.context();return us[t.marktype].pick.call(this,o,t,n,i,r,s)}}const BSe=e=>e===Qb||e===Zb||e===Jb?[Qb,Zb,Jb]:[e];function Jz(e,t){BSe(t).forEach(n=>GSe(e,n))}function GSe(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?i=>e[t](i):i=>e.fire(t,i)))}function qm(e,t,n){t.forEach(i=>e.fire(i,n))}function eH(e,t,n){return function(i){const r=this._active,s=this.pickEvent(i);s===r?qm(this,e,i):((!r||!r.exit)&&qm(this,n,i),this._active=s,qm(this,t,i),qm(this,e,i))}}function tH(e){return function(t){qm(this,e,t),this._active=null}}function zSe(){return typeof window<"u"&&window.devicePixelRatio||1}function HSe(e,t,n,i,r,s){const o=typeof HTMLElement<"u"&&e instanceof HTMLElement&&e.parentNode!=null,a=e.getContext("2d"),l=o?zSe():r;e.width=t*l,e.height=n*l;for(const u in s)a[u]=s[u];return o&&l!==1&&(e.style.width=t+"px",e.style.height=n+"px"),a.pixelRatio=l,a.setTransform(l,0,0,l,l*i[0],l*i[1]),e}class eS extends aC{constructor(t){super(t),this._options={},this._redraw=!1,this._dirty=new Bn,this._tempb=new Bn}initialize(t,n,i,r,s,o){return this._options=o||{},this._canvas=this._options.externalContext?null:ju(1,1,this._options.type),t&&this._canvas&&(Fs(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),super.initialize(t,n,i,r,s)}resize(t,n,i,r){if(super.resize(t,n,i,r),this._canvas)HSe(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const s=this._options.externalContext;s||te("CanvasRenderer is missing a valid canvas or context"),s.scale(this._scale,this._scale),s.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this}canvas(){return this._canvas}context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)}dirty(t){const n=this._tempb.clear().union(t.bounds);let i=t.mark.group;for(;i;)n.translate(i.x||0,i.y||0),i=i.mark.group;this._dirty.union(n)}_render(t,n){const i=this.context(),r=this._origin,s=this._width,o=this._height,a=this._dirty,l=VSe(r,s,o);i.save();const u=this._redraw||a.empty()?(this._redraw=!1,l.expand(1)):WSe(i,l.intersect(a),r);return this.clear(-r[0],-r[1],s,o),this.draw(i,t,u,n),i.restore(),a.clear(),this}draw(t,n,i,r){if(n.marktype!=="group"&&r!=null&&!r.includes(n.marktype))return;const s=us[n.marktype];n.clip&&zbe(t,n),s.draw.call(this,t,n,i,r),n.clip&&t.restore()}clear(t,n,i,r){const s=this._options,o=this.context();s.type!=="pdf"&&!s.externalContext&&o.clearRect(t,n,i,r),this._bgcolor!=null&&(o.fillStyle=this._bgcolor,o.fillRect(t,n,i,r))}}const VSe=(e,t,n)=>new Bn().set(0,0,t,n).translate(-e[0],-e[1]);function WSe(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}class Tq extends j_{constructor(t,n){super(t,n);const i=this;i._hrefHandler=mA(i,(r,s)=>{s&&s.href&&i.handleHref(r,s,s.href)}),i._tooltipHandler=mA(i,(r,s)=>{i.handleTooltip(r,s,r.type!==pv)})}initialize(t,n,i){let r=this._svg;return r&&(r.removeEventListener(cP,this._hrefHandler),r.removeEventListener(uP,this._tooltipHandler),r.removeEventListener(pv,this._tooltipHandler)),this._svg=r=t&&q_(t,"svg"),r&&(r.addEventListener(cP,this._hrefHandler),r.addEventListener(uP,this._tooltipHandler),r.addEventListener(pv,this._tooltipHandler)),super.initialize(t,n,i)}canvas(){return this._svg}on(t,n){const i=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[i],t,n)<0){const o={type:t,handler:n,listener:mA(this,n)};(r[i]||(r[i]=[])).push(o),this._svg&&this._svg.addEventListener(i,o.listener)}return this}off(t,n){const i=this.eventName(t),r=this._handlers[i],s=this._handlerIndex(r,t,n);return s>=0&&(this._svg&&this._svg.removeEventListener(i,r[s].listener),r.splice(s,1)),this}}const mA=(e,t)=>n=>{let i=n.target.__data__;i=Array.isArray(i)?i[0]:i,n.vegaType=n.type,t.call(e._obj,n,i)},Iq="aria-hidden",K_="aria-label",Y_="role",X_="aria-roledescription",_q="graphics-object",Q_="graphics-symbol",Oq=(e,t,n)=>({[Y_]:e,[X_]:t,[K_]:n||void 0}),USe=Fo(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),nH={axis:{desc:"axis",caption:KSe},legend:{desc:"legend",caption:YSe},"title-text":{desc:"title",caption:e=>`Title text '${rH(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${rH(e)}'`}},iH={ariaRole:Y_,ariaRoleDescription:X_,description:K_};function Lq(e,t){const n=t.aria===!1;if(e(Iq,n||void 0),n||t.description==null)for(const i in iH)e(iH[i],void 0);else{const i=t.mark.marktype;e(K_,t.description),e(Y_,t.ariaRole||(i==="group"?_q:Q_)),e(X_,t.ariaRoleDescription||`${i} mark`)}}function Nq(e){return e.aria===!1?{[Iq]:!0}:USe[e.role]?null:nH[e.role]?jSe(e,nH[e.role]):qSe(e)}function qSe(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(i=>i.description!=null&&i.aria!==!1);return Oq(n?_q:Q_,`${t} mark container`,e.description)}function jSe(e,t){try{const n=e.items[0],i=t.caption||(()=>"");return Oq(t.role||Q_,t.desc,n.description||i(n))}catch{return null}}function rH(e){return xe(e.text).join(" ")}function KSe(e){const t=e.datum,n=e.orient,i=t.title?$q(e):null,r=e.context,s=r.scales[t.scale].value,o=r.dataflow.locale(),a=s.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(i?` titled '${i}'`:"")+` for a ${hp(a)?"discrete":a} scale with ${Q7(o,s,e)}`}function YSe(e){const t=e.datum,n=t.title?$q(e):null,i=`${t.type||""} legend`.trim(),r=t.scales,s=Object.keys(r),o=e.context,a=o.scales[r[s[0]]].value,l=o.dataflow.locale();return QSe(i)+(n?` titled '${n}'`:"")+` for ${XSe(s)} with ${Q7(l,a,e)}`}function $q(e){try{return xe(wt(e.items).items[0].text).join(" ")}catch{return null}}function XSe(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+wt(e)}function QSe(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const Bq=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),ZSe=e=>Bq(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function Z_(){let e="",t="",n="";const i=[],r=()=>t=n="",s=l=>{t&&(e+=`${t}>${n}`,r()),i.push(l)},o=(l,u)=>(u!=null&&(t+=` ${l}="${ZSe(u)}"`),a),a={open(l){s(l),t="<"+l;for(var u=arguments.length,c=new Array(u>1?u-1:0),d=1;d<u;d++)c[d-1]=arguments[d];for(const h of c)for(const p in h)o(p,h[p]);return a},close(){const l=i.pop();return t?e+=t+(n?`>${n}</${l}>`:"/>"):e+=`</${l}>`,r(),a},attr:o,text:l=>(n+=Bq(l),a),toString:()=>e};return a}const Gq=e=>zq(Z_(),e)+"";function zq(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,i=n.length;for(let r=0;r<i;++r)e.attr(n[r].name,n[r].value)}if(t.hasChildNodes()){const n=t.childNodes;for(const i of n)i.nodeType===3?e.text(i.nodeValue):zq(e,i)}return e.close()}const tS={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},nS={blend:"mix-blend-mode"},Hq={fill:"none","stroke-miterlimit":10},fm=0,sH="http://www.w3.org/2000/xmlns/",Vn=Zv.xmlns;class J_ extends aC{constructor(t){super(t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}initialize(t,n,i,r,s){return this._defs={},this._clearDefs(),t&&(this._svg=Wn(t,0,"svg",Vn),this._svg.setAttributeNS(sH,"xmlns",Vn),this._svg.setAttributeNS(sH,"xmlns:xlink",Zv["xmlns:xlink"]),this._svg.setAttribute("version",Zv.version),this._svg.setAttribute("class","marks"),Fs(t,1),this._root=Wn(this._svg,fm,"g",Vn),Lu(this._root,Hq),Fs(this._svg,fm+1)),this.background(this._bgcolor),super.initialize(t,n,i,r,s)}background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),super.background(...arguments)}resize(t,n,i,r){return super.resize(t,n,i,r),this._svg&&(Lu(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this}canvas(){return this._svg}svg(){const t=this._svg,n=this._bgcolor;if(!t)return null;let i;n&&(t.removeAttribute("style"),i=Wn(t,fm,"rect",Vn),Lu(i,{width:this._width,height:this._height,fill:n}));const r=Gq(t);return n&&(t.removeChild(i),this._svg.style.setProperty("background-color",n)),r}_render(t,n){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t,void 0,n),Fs(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this}dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))}isDirty(t){return this._dirtyAll||!t._svg||!t._svg.ownerSVGElement||t.dirty===this._dirtyID}_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const n=++this._dirtyID;let i,r,s,o,a,l,u;for(a=0,l=t.length;a<l;++a)if(i=t[a],r=i.mark,r.marktype!==s&&(s=r.marktype,o=us[s]),r.zdirty&&r.dirty!==n&&(this._dirtyAll=!1,oH(i,n),r.items.forEach(c=>{c.dirty=n})),!r.zdirty){if(i.exit){o.nested&&r.items.length?(u=r.items[0],u._svg&&this._update(o,u._svg,u)):i._svg&&(u=i._svg.parentNode,u&&u.removeChild(i._svg)),i._svg=null;continue}i=o.nested?r.items[0]:i,i._update!==n&&(!i._svg||!i._svg.ownerSVGElement?(this._dirtyAll=!1,oH(i,n)):this._update(o,i._svg,i),i._update=n)}return!this._dirtyAll}mark(t,n,i,r){if(!this.isDirty(n))return n._svg;const s=this._svg,o=n.marktype,a=us[o],l=n.interactive===!1?"none":null,u=a.tag==="g",c=aH(n,t,i,"g",s);if(o!=="group"&&r!=null&&!r.includes(o))return Fs(c,0),n._svg;c.setAttribute("class",Eq(n));const d=Nq(n);for(const m in d)Yi(c,m,d[m]);u||Yi(c,"pointer-events",l),Yi(c,"clip-path",n.clip?P_(this,n,n.group):null);let h=null,p=0;const g=m=>{const C=this.isDirty(m),y=aH(m,c,h,a.tag,s);C&&(this._update(a,y,m),u&&t1e(this,y,m,r)),h=y,++p};return a.nested?n.items.length&&g(n.items[0]):Do(n,g),Fs(c,p),c}_update(t,n,i){Sl=n,Ti=n.__values__,Lq(gv,i),t.attr(gv,i,this);const r=i1e[t.type];r&&r.call(this,t,n,i),Sl&&this.style(Sl,i)}style(t,n){if(n!=null){for(const i in tS){let r=i==="font"?oC(n):n[i];if(r===Ti[i])continue;const s=tS[i];r==null?t.removeAttribute(s):(A_(r)&&(r=J7(r,this._defs.gradient,Vq())),t.setAttribute(s,r+"")),Ti[i]=r}for(const i in nS)eb(t,nS[i],n[i])}}defs(){const t=this._svg,n=this._defs;let i=n.el,r=0;for(const s in n.gradient)i||(n.el=i=Wn(t,fm+1,"defs",Vn)),r=JSe(i,n.gradient[s],r);for(const s in n.clipping)i||(n.el=i=Wn(t,fm+1,"defs",Vn)),r=e1e(i,n.clipping[s],r);i&&(r===0?(t.removeChild(i),n.el=null):Fs(i,r))}_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}}function oH(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function JSe(e,t,n){let i,r,s;if(t.gradient==="radial"){let o=Wn(e,n++,"pattern",Vn);Lu(o,{id:Wb+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),o=Wn(o,0,"rect",Vn),Lu(o,{width:1,height:1,fill:`url(${Vq()}#${t.id})`}),e=Wn(e,n++,"radialGradient",Vn),Lu(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=Wn(e,n++,"linearGradient",Vn),Lu(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(i=0,r=t.stops.length;i<r;++i)s=Wn(e,i,"stop",Vn),s.setAttribute("offset",t.stops[i].offset),s.setAttribute("stop-color",t.stops[i].color);return Fs(e,i),n}function e1e(e,t,n){let i;return e=Wn(e,n,"clipPath",Vn),e.setAttribute("id",t.id),t.path?(i=Wn(e,0,"path",Vn),i.setAttribute("d",t.path)):(i=Wn(e,0,"rect",Vn),Lu(i,{x:0,y:0,width:t.width,height:t.height})),Fs(e,1),n+1}function t1e(e,t,n,i){t=t.lastChild.previousSibling;let r,s=0;Do(n,o=>{r=e.mark(t,o,r,i),++s}),Fs(t,1+s)}function aH(e,t,n,i,r){let s=e._svg,o;if(!s&&(o=t.ownerDocument,s=Ou(o,i,Vn),e._svg=s,e.mark&&(s.__data__=e,s.__values__={fill:"default"},i==="g"))){const a=Ou(o,"path",Vn);s.appendChild(a),a.__data__=e;const l=Ou(o,"g",Vn);s.appendChild(l),l.__data__=e;const u=Ou(o,"path",Vn);s.appendChild(u),u.__data__=e,u.__values__={fill:"default"}}return(s.ownerSVGElement!==r||n1e(s,n))&&t.insertBefore(s,n?n.nextSibling:t.firstChild),s}function n1e(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let Sl=null,Ti=null;const i1e={group(e,t,n){const i=Sl=t.childNodes[2];Ti=i.__values__,e.foreground(gv,n,this),Ti=t.__values__,Sl=t.childNodes[1],e.content(gv,n,this);const r=Sl=t.childNodes[0];e.background(gv,n,this);const s=n.mark.interactive===!1?"none":null;if(s!==Ti.events&&(Yi(i,"pointer-events",s),Yi(r,"pointer-events",s),Ti.events=s),n.strokeForeground&&n.stroke){const o=n.fill;Yi(i,"display",null),this.style(r,n),Yi(r,"stroke",null),o&&(n.fill=null),Ti=i.__values__,this.style(i,n),o&&(n.fill=o),Sl=null}else Yi(i,"display","none")},image(e,t,n){n.smooth===!1?(eb(t,"image-rendering","optimizeSpeed"),eb(t,"image-rendering","pixelated")):eb(t,"image-rendering",null)},text(e,t,n){const i=sC(n);let r,s,o,a;ne(i)?(s=i.map(l=>sc(n,l)),r=s.join(`
`),r!==Ti.text&&(Fs(t,0),o=t.ownerDocument,a=rc(n),s.forEach((l,u)=>{const c=Ou(o,"tspan",Vn);c.__data__=n,c.textContent=l,u&&(c.setAttribute("x",0),c.setAttribute("dy",a)),t.appendChild(c)}),Ti.text=r)):(s=sc(n,i),s!==Ti.text&&(t.textContent=s,Ti.text=s)),Yi(t,"font-family",oC(n)),Yi(t,"font-size",Na(n)+"px"),Yi(t,"font-style",n.fontStyle),Yi(t,"font-variant",n.fontVariant),Yi(t,"font-weight",n.fontWeight)}};function gv(e,t,n){t!==Ti[e]&&(n?r1e(Sl,e,t,n):Yi(Sl,e,t),Ti[e]=t)}function eb(e,t,n){n!==Ti[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),Ti[t]=n)}function Lu(e,t){for(const n in t)Yi(e,n,t[n])}function Yi(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function r1e(e,t,n,i){n!=null?e.setAttributeNS(i,t,n):e.removeAttributeNS(i,t)}function Vq(){let e;return typeof window>"u"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}class Wq extends aC{constructor(t){super(t),this._text=null,this._defs={gradient:{},clipping:{}}}svg(){return this._text}_render(t){const n=Z_();n.open("svg",it({},Zv,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const i=this._bgcolor;return i&&i!=="transparent"&&i!=="none"&&n.open("rect",{width:this._width,height:this._height,fill:i}).close(),n.open("g",Hq,{transform:"translate("+this._origin+")"}),this.mark(n,t),n.close(),this.defs(n),this._text=n.close()+"",this}mark(t,n){const i=us[n.marktype],r=i.tag,s=[Lq,i.attr];t.open("g",{class:Eq(n),"clip-path":n.clip?P_(this,n,n.group):null},Nq(n),{"pointer-events":r!=="g"&&n.interactive===!1?"none":null});const o=a=>{const l=this.href(a);if(l&&t.open("a",l),t.open(r,this.attr(n,a,s,r!=="g"?r:null)),r==="text"){const u=sC(a);if(ne(u)){const c={x:0,dy:rc(a)};for(let d=0;d<u.length;++d)t.open("tspan",d?c:null).text(sc(a,u[d])).close()}else t.text(sc(a,u))}else if(r==="g"){const u=a.strokeForeground,c=a.fill,d=a.stroke;u&&d&&(a.stroke=null),t.open("path",this.attr(n,a,i.background,"bgrect")).close(),t.open("g",this.attr(n,a,i.content)),Do(a,h=>this.mark(t,h)),t.close(),u&&d?(c&&(a.fill=null),a.stroke=d,t.open("path",this.attr(n,a,i.foreground,"bgrect")).close(),c&&(a.fill=c)):t.open("path",this.attr(n,a,i.foreground,"bgfore")).close()}t.close(),l&&t.close()};return i.nested?n.items&&n.items.length&&o(n.items[0]):Do(n,o),t.close()}href(t){const n=t.href;let i;if(n){if(i=this._hrefs&&this._hrefs[n])return i;this.sanitizeURL(n).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[n]=r})}return null}attr(t,n,i,r){const s={},o=(a,l,u,c)=>{s[c||a]=l};return Array.isArray(i)?i.forEach(a=>a(o,n,this)):i(o,n,this),r&&s1e(s,n,t,r,this._defs),s}defs(t){const n=this._defs.gradient,i=this._defs.clipping;if(Object.keys(n).length+Object.keys(i).length!==0){t.open("defs");for(const s in n){const o=n[s],a=o.stops;o.gradient==="radial"?(t.open("pattern",{id:Wb+s,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+s+")"}).close(),t.close(),t.open("radialGradient",{id:s,fx:o.x1,fy:o.y1,fr:o.r1,cx:o.x2,cy:o.y2,r:o.r2})):t.open("linearGradient",{id:s,x1:o.x1,x2:o.x2,y1:o.y1,y2:o.y2});for(let l=0;l<a.length;++l)t.open("stop",{offset:a[l].offset,"stop-color":a[l].color}).close();t.close()}for(const s in i){const o=i[s];t.open("clipPath",{id:s}),o.path?t.open("path",{d:o.path}).close():t.open("rect",{x:0,y:0,width:o.width,height:o.height}).close(),t.close()}t.close()}}}function s1e(e,t,n,i,r){let s;if(t==null||(i==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),i==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;i==="image"&&t.smooth===!1&&(s=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),i==="text"&&(e["font-family"]=oC(t),e["font-size"]=Na(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const o in tS){let a=t[o];const l=tS[o];a==="transparent"&&(l==="fill"||l==="stroke")||a!=null&&(A_(a)&&(a=J7(a,r.gradient,"")),e[l]=a)}for(const o in nS){const a=t[o];a!=null&&(s=s||[],s.push(`${nS[o]}: ${a};`))}return s&&(e.style=s.join(" ")),e}const uo={svgMarkTypes:["text"],svgOnTop:!0,debug:!1};function o1e(e){uo.svgMarkTypes=e.svgMarkTypes??["text"],uo.svgOnTop=e.svgOnTop??!0,uo.debug=e.debug??!1}class dP extends aC{constructor(t){super(t),this._svgRenderer=new J_(t),this._canvasRenderer=new eS(t)}initialize(t,n,i,r,s){this._root_el=Wn(t,0,"div");const o=Wn(this._root_el,0,"div"),a=Wn(this._root_el,1,"div");return this._root_el.style.position="relative",uo.debug||(o.style.height="100%",a.style.position="absolute",a.style.top="0",a.style.left="0",a.style.height="100%",a.style.width="100%"),this._svgEl=uo.svgOnTop?a:o,this._canvasEl=uo.svgOnTop?o:a,this._svgEl.style.pointerEvents="none",this._canvasRenderer.initialize(this._canvasEl,n,i,r,s),this._svgRenderer.initialize(this._svgEl,n,i,r,s),super.initialize(t,n,i,r,s)}dirty(t){return uo.svgMarkTypes.includes(t.mark.marktype)?this._svgRenderer.dirty(t):this._canvasRenderer.dirty(t),this}_render(t,n){const r=(n??["arc","area","image","line","path","rect","rule","shape","symbol","text","trail"]).filter(s=>!uo.svgMarkTypes.includes(s));this._svgRenderer.render(t,uo.svgMarkTypes),this._canvasRenderer.render(t,r)}resize(t,n,i,r){return super.resize(t,n,i,r),this._svgRenderer.resize(t,n,i,r),this._canvasRenderer.resize(t,n,i,r),this}background(t){return uo.svgOnTop?this._canvasRenderer.background(t):this._svgRenderer.background(t),this}}class Uq extends lC{constructor(t,n){super(t,n)}initialize(t,n,i){const r=Wn(Wn(t,0,"div"),uo.svgOnTop?0:1,"div");return super.initialize(r,n,i)}}const qq="canvas",jq="hybrid",Kq="png",Yq="svg",Xq="none",Nu={Canvas:qq,PNG:Kq,SVG:Yq,Hybrid:jq,None:Xq},Kd={};Kd[qq]=Kd[Kq]={renderer:eS,headless:eS,handler:lC};Kd[Yq]={renderer:J_,headless:Wq,handler:Tq};Kd[jq]={renderer:dP,headless:dP,handler:Uq};Kd[Xq]={};function Dx(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(Kd[e]=t,this):Kd[e]}function Qq(e,t,n){const i=[],r=new Bn().union(t),s=e.marktype;return s?Zq(e,r,n,i):s==="group"?Jq(e,r,n,i):te("Intersect scene must be mark node or group item.")}function Zq(e,t,n,i){if(a1e(e,t,n)){const r=e.items,s=e.marktype,o=r.length;let a=0;if(s==="group")for(;a<o;++a)Jq(r[a],t,n,i);else for(const l=us[s].isect;a<o;++a){const u=r[a];ej(u,t,l)&&i.push(u)}}return i}function a1e(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function Jq(e,t,n,i){n&&n(e.mark)&&ej(e,t,us.group.isect)&&i.push(e);const r=e.items,s=r&&r.length;if(s){const o=e.x||0,a=e.y||0;t.translate(-o,-a);for(let l=0;l<s;++l)Zq(r[l],t,n,i);t.translate(o,a)}return i}function ej(e,t,n){const i=e.bounds;return t.encloses(i)||t.intersects(i)&&n(e,t)}const vA=new Bn;function tj(e){const t=e.clip;if(ot(t))t(iC(vA.clear()));else if(t)vA.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(vA)}const l1e=1e-9;function e2(e,t,n){return e===t?!0:n==="path"?nj(e,t):e instanceof Date&&t instanceof Date?+e==+t:kt(e)&&kt(t)?Math.abs(e-t)<=l1e:!e||!t||!be(e)&&!be(t)?e==t:u1e(e,t)}function nj(e,t){return e2(fp(e),fp(t))}function u1e(e,t){var n=Object.keys(e),i=Object.keys(t),r,s;if(n.length!==i.length)return!1;for(n.sort(),i.sort(),s=n.length-1;s>=0;s--)if(n[s]!=i[s])return!1;for(s=n.length-1;s>=0;s--)if(r=n[s],!e2(e[r],t[r],r))return!1;return typeof e==typeof t}function c1e(){oq(),_we()}const mp="top",mo="left",vo="right",oc="bottom",d1e="top-left",h1e="top-right",f1e="bottom-left",p1e="bottom-right",t2="start",hP="middle",Qi="end",g1e="x",m1e="y",kx="group",n2="axis",i2="title",v1e="frame",C1e="scope",r2="legend",ij="row-header",rj="row-footer",sj="row-title",oj="column-header",aj="column-footer",lj="column-title",y1e="padding",w1e="symbol",uj="fit",cj="fit-x",dj="fit-y",b1e="pad",s2="none",Qy="all",fP="each",o2="flush",$u="column",Bu="row";function hj(e){Q.call(this,null,e)}me(hj,Q,{transform(e,t){const n=t.dataflow,i=e.mark,r=i.marktype,s=us[r],o=s.bound;let a=i.bounds,l;if(s.nested)i.items.length&&n.dirty(i.items[0]),a=Zy(i,o),i.items.forEach(u=>{u.bounds.clear().union(a)});else if(r===kx||e.modified())switch(t.visit(t.MOD,u=>n.dirty(u)),a.clear(),i.items.forEach(u=>a.union(Zy(u,o))),i.role){case n2:case r2:case i2:t.reflow()}else l=t.changed(t.REM),t.visit(t.ADD,u=>{a.union(Zy(u,o))}),t.visit(t.MOD,u=>{l=l||a.alignsWith(u.bounds),n.dirty(u),a.union(Zy(u,o))}),l&&(a.clear(),i.items.forEach(u=>a.union(u.bounds)));return tj(i),t.modifies("bounds")}});function Zy(e,t,n){return t(e.bounds.clear(),e,n)}const lH=":vega_identifier:";function a2(e){Q.call(this,0,e)}a2.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};me(a2,Q,{transform(e,t){const n=S1e(t.dataflow),i=e.as;let r=n.value;return t.visit(t.ADD,s=>s[i]=s[i]||++r),n.set(this.value=r),t}});function S1e(e){return e._signals[lH]||(e._signals[lH]=e.add(0))}function fj(e){Q.call(this,null,e)}me(fj,Q,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,x1e(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const i=n.marktype===kx?wx:yx;return t.visit(t.ADD,r=>i.call(r,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function x1e(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function pj(e){Q.call(this,null,e)}const uH={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((i,r)=>!r||!gj(n.bounds,i.bounds,t)?(n=i,1):i.opacity=0)}},gj=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),cH=(e,t)=>{for(var n=1,i=e.length,r=e[0].bounds,s;n<i;r=s,++n)if(gj(r,s=e[n].bounds,t))return!0},R1e=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},E1e=(e,t,n)=>{var i=e.range(),r=new Bn;return t===mp||t===oc?r.set(i[0],-1/0,i[1],1/0):r.set(-1/0,i[0],1/0,i[1]),r.expand(n||1),s=>r.encloses(s.bounds)},dH=e=>(e.forEach(t=>t.opacity=1),e),hH=(e,t)=>e.reflow(t.modified()).modifies("opacity");me(pj,Q,{transform(e,t){const n=uH[e.method]||uH.parity,i=e.separation||0;let r=t.materialize(t.SOURCE).source,s,o;if(!r||!r.length)return;if(!e.method)return e.modified("method")&&(dH(r),t=hH(t,e)),t;if(r=r.filter(R1e),!r.length)return;if(e.sort&&(r=r.slice().sort(e.sort)),s=dH(r),t=hH(t,e),s.length>=3&&cH(s,i)){do s=n(s,i);while(s.length>=3&&cH(s,i));s.length<3&&!wt(r).opacity&&(s.length>1&&(wt(s).opacity=0),wt(r).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(o=E1e(e.boundScale,e.boundOrient,+e.boundTolerance),r.forEach(l=>{o(l)||(l.opacity=0)}));const a=s[0].mark.bounds.clear();return r.forEach(l=>{l.opacity&&a.union(l.bounds)}),t}});function mj(e){Q.call(this,null,e)}me(mj,Q,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,i=>n.dirty(i)),t.fields&&t.fields.zindex){const i=t.source&&t.source[0];i&&(i.mark.zdirty=!0)}}});const Mi=new Bn;function Af(e,t,n){return e[t]===n?0:(e[t]=n,1)}function F1e(e){var t=e.items[0].orient;return t===mo||t===vo}function A1e(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function D1e(e,t,n,i){var r=t.items[0],s=r.datum,o=r.translate!=null?r.translate:.5,a=r.orient,l=A1e(s),u=r.range,c=r.offset,d=r.position,h=r.minExtent,p=r.maxExtent,g=s.title&&r.items[l[2]].items[0],m=r.titlePadding,C=r.bounds,y=g&&V_(g),b=0,S=0,x,E;switch(Mi.clear().union(C),C.clear(),(x=l[0])>-1&&C.union(r.items[x].bounds),(x=l[1])>-1&&C.union(r.items[x].bounds),a){case mp:b=d||0,S=-c,E=Math.max(h,Math.min(p,-C.y1)),C.add(0,-E).add(u,0),g&&Jy(e,g,E,m,y,0,-1,C);break;case mo:b=-c,S=d||0,E=Math.max(h,Math.min(p,-C.x1)),C.add(-E,0).add(0,u),g&&Jy(e,g,E,m,y,1,-1,C);break;case vo:b=n+c,S=d||0,E=Math.max(h,Math.min(p,C.x2)),C.add(0,0).add(E,u),g&&Jy(e,g,E,m,y,1,1,C);break;case oc:b=d||0,S=i+c,E=Math.max(h,Math.min(p,C.y2)),C.add(0,0).add(u,E),g&&Jy(e,g,E,m,0,0,1,C);break;default:b=r.x,S=r.y}return Zl(C.translate(b,S),r),Af(r,"x",b+o)|Af(r,"y",S+o)&&(r.bounds=Mi,e.dirty(r),r.bounds=C,e.dirty(r)),r.mark.bounds.clear().union(C)}function Jy(e,t,n,i,r,s,o,a){const l=t.bounds;if(t.auto){const u=o*(n+r+i);let c=0,d=0;e.dirty(t),s?c=(t.x||0)-(t.x=u):d=(t.y||0)-(t.y=u),t.mark.bounds.clear().union(l.translate(-c,-d)),e.dirty(t)}a.union(l)}const fH=(e,t)=>Math.floor(Math.min(e,t)),pH=(e,t)=>Math.ceil(Math.max(e,t));function k1e(e){var t=e.items,n=t.length,i=0,r,s;const o={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;i<n;++i)if(r=t[i],s=r.items,r.marktype===kx)switch(r.role){case n2:case r2:case i2:break;case ij:o.rowheaders.push(...s);break;case rj:o.rowfooters.push(...s);break;case oj:o.colheaders.push(...s);break;case aj:o.colfooters.push(...s);break;case sj:o.rowtitle=s[0];break;case lj:o.coltitle=s[0];break;default:o.marks.push(...s)}return o}function P1e(e){return new Bn().set(0,0,e.width||0,e.height||0)}function M1e(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function sn(e,t,n){const i=be(e)?e[t]:e;return i??(n!==void 0?n:0)}function gH(e){return e<0?Math.ceil(-e):0}function vj(e,t,n){var i=!n.nodirty,r=n.bounds===o2?P1e:M1e,s=Mi.set(0,0,0,0),o=sn(n.align,$u),a=sn(n.align,Bu),l=sn(n.padding,$u),u=sn(n.padding,Bu),c=n.columns||t.length,d=c<=0?1:Math.ceil(t.length/c),h=t.length,p=Array(h),g=Array(c),m=0,C=Array(h),y=Array(d),b=0,S=Array(h),x=Array(h),E=Array(h),A,F,P,D,M,O,B,H,N,L,G;for(F=0;F<c;++F)g[F]=0;for(F=0;F<d;++F)y[F]=0;for(F=0;F<h;++F)O=t[F],M=E[F]=r(O),O.x=O.x||0,S[F]=0,O.y=O.y||0,x[F]=0,P=F%c,D=~~(F/c),m=Math.max(m,B=Math.ceil(M.x2)),b=Math.max(b,H=Math.ceil(M.y2)),g[P]=Math.max(g[P],B),y[D]=Math.max(y[D],H),p[F]=l+gH(M.x1),C[F]=u+gH(M.y1),i&&e.dirty(t[F]);for(F=0;F<h;++F)F%c===0&&(p[F]=0),F<c&&(C[F]=0);if(o===fP)for(P=1;P<c;++P){for(G=0,F=P;F<h;F+=c)G<p[F]&&(G=p[F]);for(F=P;F<h;F+=c)p[F]=G+g[P-1]}else if(o===Qy){for(G=0,F=0;F<h;++F)F%c&&G<p[F]&&(G=p[F]);for(F=0;F<h;++F)F%c&&(p[F]=G+m)}else for(o=!1,P=1;P<c;++P)for(F=P;F<h;F+=c)p[F]+=g[P-1];if(a===fP)for(D=1;D<d;++D){for(G=0,F=D*c,A=F+c;F<A;++F)G<C[F]&&(G=C[F]);for(F=D*c;F<A;++F)C[F]=G+y[D-1]}else if(a===Qy){for(G=0,F=c;F<h;++F)G<C[F]&&(G=C[F]);for(F=c;F<h;++F)C[F]=G+b}else for(a=!1,D=1;D<d;++D)for(F=D*c,A=F+c;F<A;++F)C[F]+=y[D-1];for(N=0,F=0;F<h;++F)N=p[F]+(F%c?N:0),S[F]+=N-t[F].x;for(P=0;P<c;++P)for(L=0,F=P;F<h;F+=c)L+=C[F],x[F]+=L-t[F].y;if(o&&sn(n.center,$u)&&d>1)for(F=0;F<h;++F)M=o===Qy?m:g[F%c],N=M-E[F].x2-t[F].x-S[F],N>0&&(S[F]+=N/2);if(a&&sn(n.center,Bu)&&c!==1)for(F=0;F<h;++F)M=a===Qy?b:y[~~(F/c)],L=M-E[F].y2-t[F].y-x[F],L>0&&(x[F]+=L/2);for(F=0;F<h;++F)s.union(E[F].translate(S[F],x[F]));switch(N=sn(n.anchor,g1e),L=sn(n.anchor,m1e),sn(n.anchor,$u)){case Qi:N-=s.width();break;case hP:N-=s.width()/2}switch(sn(n.anchor,Bu)){case Qi:L-=s.height();break;case hP:L-=s.height()/2}for(N=Math.round(N),L=Math.round(L),s.clear(),F=0;F<h;++F)t[F].mark.bounds.clear();for(F=0;F<h;++F)O=t[F],O.x+=S[F]+=N,O.y+=x[F]+=L,s.union(O.mark.bounds.union(O.bounds.translate(S[F],x[F]))),i&&e.dirty(O);return s}function T1e(e,t,n){var i=k1e(t),r=i.marks,s=n.bounds===o2?I1e:_1e,o=n.offset,a=n.columns||r.length,l=a<=0?1:Math.ceil(r.length/a),u=l*a,c,d,h,p,g,m,C;const y=vj(e,r,n);y.empty()&&y.set(0,0,0,0),i.rowheaders&&(m=sn(n.headerBand,Bu,null),c=ew(e,i.rowheaders,r,a,l,-sn(o,"rowHeader"),fH,0,s,"x1",0,a,1,m)),i.colheaders&&(m=sn(n.headerBand,$u,null),d=ew(e,i.colheaders,r,a,a,-sn(o,"columnHeader"),fH,1,s,"y1",0,1,a,m)),i.rowfooters&&(m=sn(n.footerBand,Bu,null),h=ew(e,i.rowfooters,r,a,l,sn(o,"rowFooter"),pH,0,s,"x2",a-1,a,1,m)),i.colfooters&&(m=sn(n.footerBand,$u,null),p=ew(e,i.colfooters,r,a,a,sn(o,"columnFooter"),pH,1,s,"y2",u-a,1,a,m)),i.rowtitle&&(g=sn(n.titleAnchor,Bu),C=sn(o,"rowTitle"),C=g===Qi?h+C:c-C,m=sn(n.titleBand,Bu,.5),mH(e,i.rowtitle,C,0,y,m)),i.coltitle&&(g=sn(n.titleAnchor,$u),C=sn(o,"columnTitle"),C=g===Qi?p+C:d-C,m=sn(n.titleBand,$u,.5),mH(e,i.coltitle,C,1,y,m))}function I1e(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function _1e(e,t){return e.bounds[t]}function ew(e,t,n,i,r,s,o,a,l,u,c,d,h,p){var g=n.length,m=0,C=0,y,b,S,x,E,A,F,P,D;if(!g)return m;for(y=c;y<g;y+=d)n[y]&&(m=o(m,l(n[y],u)));if(!t.length)return m;for(t.length>r&&(e.warn("Grid headers exceed limit: "+r),t=t.slice(0,r)),m+=s,b=0,x=t.length;b<x;++b)e.dirty(t[b]),t[b].mark.bounds.clear();for(y=c,b=0,x=t.length;b<x;++b,y+=d){for(A=t[b],E=A.mark.bounds,S=y;S>=0&&(F=n[S])==null;S-=h);a?(P=p==null?F.x:Math.round(F.bounds.x1+p*F.bounds.width()),D=m):(P=m,D=p==null?F.y:Math.round(F.bounds.y1+p*F.bounds.height())),E.union(A.bounds.translate(P-(A.x||0),D-(A.y||0))),A.x=P,A.y=D,e.dirty(A),C=o(C,E[u])}return C}function mH(e,t,n,i,r,s){if(t){e.dirty(t);var o=n,a=n;i?o=Math.round(r.x1+s*r.width()):a=Math.round(r.y1+s*r.height()),t.bounds.translate(o-(t.x||0),a-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=o,t.y=a,e.dirty(t)}}function O1e(e,t){const n=e[t]||{};return(i,r)=>n[i]!=null?n[i]:e[i]!=null?e[i]:r}function L1e(e,t){let n=-1/0;return e.forEach(i=>{i.offset!=null&&(n=Math.max(n,i.offset))}),n>-1/0?n:t}function N1e(e,t,n,i,r,s,o){const a=O1e(n,t),l=L1e(e,a("offset",0)),u=a("anchor",t2),c=u===Qi?1:u===hP?.5:0,d={align:fP,bounds:a("bounds",o2),columns:a("direction")==="vertical"?1:e.length,padding:a("margin",8),center:a("center"),nodirty:!0};switch(t){case mo:d.anchor={x:Math.floor(i.x1)-l,column:Qi,y:c*(o||i.height()+2*i.y1),row:u};break;case vo:d.anchor={x:Math.ceil(i.x2)+l,y:c*(o||i.height()+2*i.y1),row:u};break;case mp:d.anchor={y:Math.floor(r.y1)-l,row:Qi,x:c*(s||r.width()+2*r.x1),column:u};break;case oc:d.anchor={y:Math.ceil(r.y2)+l,x:c*(s||r.width()+2*r.x1),column:u};break;case d1e:d.anchor={x:l,y:l};break;case h1e:d.anchor={x:s-l,y:l,column:Qi};break;case f1e:d.anchor={x:l,y:o-l,row:Qi};break;case p1e:d.anchor={x:s-l,y:o-l,column:Qi,row:Qi};break}return d}function $1e(e,t){var n=t.items[0],i=n.datum,r=n.orient,s=n.bounds,o=n.x,a=n.y,l,u;return n._bounds?n._bounds.clear().union(s):n._bounds=s.clone(),s.clear(),G1e(e,n,n.items[0].items[0]),s=B1e(n,s),l=2*n.padding,u=2*n.padding,s.empty()||(l=Math.ceil(s.width()+l),u=Math.ceil(s.height()+u)),i.type===w1e&&z1e(n.items[0].items[0].items[0].items),r!==s2&&(n.x=o=0,n.y=a=0),n.width=l,n.height=u,Zl(s.set(o,a,o+l,a+u),n),n.mark.bounds.clear().union(s),n}function B1e(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function G1e(e,t,n){var i=t.padding,r=i-n.x,s=i-n.y;if(!t.datum.title)(r||s)&&pm(e,n,r,s);else{var o=t.items[1].items[0],a=o.anchor,l=t.titlePadding||0,u=i-o.x,c=i-o.y;switch(o.orient){case mo:r+=Math.ceil(o.bounds.width())+l;break;case vo:case oc:break;default:s+=o.bounds.height()+l}switch((r||s)&&pm(e,n,r,s),o.orient){case mo:c+=lf(t,n,o,a,1,1);break;case vo:u+=lf(t,n,o,Qi,0,0)+l,c+=lf(t,n,o,a,1,1);break;case oc:u+=lf(t,n,o,a,0,0),c+=lf(t,n,o,Qi,-1,0,1)+l;break;default:u+=lf(t,n,o,a,0,0)}(u||c)&&pm(e,o,u,c),(u=Math.round(o.bounds.x1-i))<0&&(pm(e,n,-u,0),pm(e,o,-u,0))}}function lf(e,t,n,i,r,s,o){const a=e.datum.type!=="symbol",l=n.datum.vgrad,u=a&&(s||!l)&&!o?t.items[0]:t,c=u.bounds[r?"y2":"x2"]-e.padding,d=l&&s?c:0,h=l&&s?0:c,p=r<=0?0:V_(n);return Math.round(i===t2?d:i===Qi?h-p:.5*(c-p))}function pm(e,t,n,i){t.x+=n,t.y+=i,t.bounds.translate(n,i),t.mark.bounds.translate(n,i),e.dirty(t)}function z1e(e){const t=e.reduce((n,i)=>(n[i.column]=Math.max(i.bounds.x2-i.x,n[i.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function H1e(e,t,n,i,r){var s=t.items[0],o=s.frame,a=s.orient,l=s.anchor,u=s.offset,c=s.padding,d=s.items[0].items[0],h=s.items[1]&&s.items[1].items[0],p=a===mo||a===vo?i:n,g=0,m=0,C=0,y=0,b=0,S;if(o!==kx?a===mo?(g=r.y2,p=r.y1):a===vo?(g=r.y1,p=r.y2):(g=r.x1,p=r.x2):a===mo&&(g=i,p=0),S=l===t2?g:l===Qi?p:(g+p)/2,h&&h.text){switch(a){case mp:case oc:b=d.bounds.height()+c;break;case mo:y=d.bounds.width()+c;break;case vo:y=-d.bounds.width()-c;break}Mi.clear().union(h.bounds),Mi.translate(y-(h.x||0),b-(h.y||0)),Af(h,"x",y)|Af(h,"y",b)&&(e.dirty(h),h.bounds.clear().union(Mi),h.mark.bounds.clear().union(Mi),e.dirty(h)),Mi.clear().union(h.bounds)}else Mi.clear();switch(Mi.union(d.bounds),a){case mp:m=S,C=r.y1-Mi.height()-u;break;case mo:m=r.x1-Mi.width()-u,C=S;break;case vo:m=r.x2+Mi.width()+u,C=S;break;case oc:m=S,C=r.y2+u;break;default:m=s.x,C=s.y}return Af(s,"x",m)|Af(s,"y",C)&&(Mi.translate(m,C),e.dirty(s),s.bounds.clear().union(Mi),t.bounds.clear().union(Mi),e.dirty(s)),s.bounds}function Cj(e){Q.call(this,null,e)}me(Cj,Q,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(i=>{e.layout&&T1e(n,i,e.layout),W1e(n,i,e)}),V1e(e.mark.group)?t.reflow():t}});function V1e(e){return e&&e.mark.role!=="legend-entry"}function W1e(e,t,n){var i=t.items,r=Math.max(0,t.width||0),s=Math.max(0,t.height||0),o=new Bn().set(0,0,r,s),a=o.clone(),l=o.clone(),u=[],c,d,h,p,g,m;for(g=0,m=i.length;g<m;++g)switch(d=i[g],d.role){case n2:p=F1e(d)?a:l,p.union(D1e(e,d,r,s));break;case i2:c=d;break;case r2:u.push($1e(e,d));break;case v1e:case C1e:case ij:case rj:case sj:case oj:case aj:case lj:a.union(d.bounds),l.union(d.bounds);break;default:o.union(d.bounds)}if(u.length){const C={};u.forEach(y=>{h=y.orient||vo,h!==s2&&(C[h]||(C[h]=[])).push(y)});for(const y in C){const b=C[y];vj(e,b,N1e(b,y,n.legends,a,l,r,s))}u.forEach(y=>{const b=y.bounds;if(b.equals(y._bounds)||(y.bounds=y._bounds,e.dirty(y),y.bounds=b,e.dirty(y)),n.autosize&&(n.autosize.type===uj||n.autosize.type===cj||n.autosize.type===dj))switch(y.orient){case mo:case vo:o.add(b.x1,0).add(b.x2,0);break;case mp:case oc:o.add(0,b.y1).add(0,b.y2)}else o.union(b)})}o.union(a).union(l),c&&o.union(H1e(e,c,r,s,o)),t.clip&&o.set(0,0,t.width||0,t.height||0),U1e(e,t,o,n)}function U1e(e,t,n,i){const r=i.autosize||{},s=r.type;if(e._autosize<1||!s)return;let o=e._width,a=e._height,l=Math.max(0,t.width||0),u=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),d=Math.max(0,Math.ceil(-n.y1));const h=Math.max(0,Math.ceil(n.x2-l)),p=Math.max(0,Math.ceil(n.y2-c));if(r.contains===y1e){const g=e.padding();o-=g.left+g.right,a-=g.top+g.bottom}s===s2?(u=0,d=0,l=o,c=a):s===uj?(l=Math.max(0,o-u-h),c=Math.max(0,a-d-p)):s===cj?(l=Math.max(0,o-u-h),a=c+d+p):s===dj?(o=l+u+h,c=Math.max(0,a-d-p)):s===b1e&&(o=l+u+h,a=c+d+p),e._resizeView(o,a,l,c,[u,d],r.resize)}const q1e=Object.freeze(Object.defineProperty({__proto__:null,bound:hj,identifier:a2,mark:fj,overlap:pj,render:mj,viewlayout:Cj},Symbol.toStringTag,{value:"Module"}));function yj(e){Q.call(this,null,e)}me(yj,Q,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,s=e.scale,o=e.count==null?e.values?e.values.length:10:e.count,a=E_(s,o,e.minstep),l=e.format||q7(n,s,a,e.formatSpecifier,e.formatType,!!e.values),u=e.values?U7(s,e.values,a):F_(s,a);return r&&(i.rem=r),r=u.map((c,d)=>It({index:d/(u.length-1||1),value:c,label:l(c)})),e.extra&&r.length&&r.push(It({index:-1,extra:{value:r[0].value},label:""})),i.source=r,i.add=r,this.value=r,i}});function wj(e){Q.call(this,null,e)}function j1e(){return It({})}function K1e(e){const t=Zp().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}me(wj,Q,{transform(e,t){var n=t.dataflow,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.item||j1e,s=e.key||$e,o=this.value;return ne(i.encode)&&(i.encode=null),o&&(e.modified("key")||t.modified(s))&&te("DataJoin does not support modified key function or fields."),o||(t=t.addAll(),this.value=o=K1e(s)),t.visit(t.ADD,a=>{const l=s(a);let u=o.get(l);u?u.exit?(o.empty--,i.add.push(u)):i.mod.push(u):(u=r(a),o.set(l,u),i.add.push(u)),u.datum=a,u.exit=!1}),t.visit(t.MOD,a=>{const l=s(a),u=o.get(l);u&&(u.datum=a,i.mod.push(u))}),t.visit(t.REM,a=>{const l=s(a),u=o.get(l);a===u.datum&&!u.exit&&(i.rem.push(u),u.exit=!0,++o.empty)}),t.changed(t.ADD_MOD)&&i.modifies("datum"),(t.clean()||e.clean&&o.empty>n.cleanThreshold)&&n.runAfter(o.clean),i}});function bj(e){Q.call(this,null,e)}me(bj,Q,{transform(e,t){var n=t.fork(t.ADD_REM),i=e.mod||!1,r=e.encoders,s=t.encode;if(ne(s))if(n.changed()||s.every(d=>r[d]))s=s[0],n.encode=null;else return t.StopPropagation;var o=s==="enter",a=r.update||xu,l=r.enter||xu,u=r.exit||xu,c=(s&&!o?r[s]:a)||xu;if(t.changed(t.ADD)&&(t.visit(t.ADD,d=>{l(d,e),a(d,e)}),n.modifies(l.output),n.modifies(a.output),c!==xu&&c!==a&&(t.visit(t.ADD,d=>{c(d,e)}),n.modifies(c.output))),t.changed(t.REM)&&u!==xu&&(t.visit(t.REM,d=>{u(d,e)}),n.modifies(u.output)),o||c!==xu){const d=t.MOD|(e.modified()?t.REFLOW:0);o?(t.visit(d,h=>{const p=l(h,e)||i;(c(h,e)||p)&&n.mod.push(h)}),n.mod.length&&n.modifies(l.output)):t.visit(d,h=>{(c(h,e)||i)&&n.mod.push(h)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});function Sj(e){Q.call(this,[],e)}me(Sj,Q,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,s=e.type||qw,o=e.scale,a=+e.limit,l=E_(o,e.count==null?5:e.count,e.minstep),u=!!e.values||s===qw,c=e.format||X7(n,o,l,s,e.formatSpecifier,e.formatType,u),d=e.values||Y7(o,l),h,p,g,m,C;return r&&(i.rem=r),s===qw?(a&&d.length>a?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),r=d.slice(0,a-1),C=!0):r=d,ot(g=e.size)?(!e.values&&o(r[0])===0&&(r=r.slice(1)),m=r.reduce((y,b)=>Math.max(y,g(b,e)),0)):g=Hi(m=g||8),r=r.map((y,b)=>It({index:b,label:c(y,b,r),value:y,offset:m,size:g(y,e)})),C&&(C=d[r.length],r.push(It({index:r.length,label:`${d.length-r.length} entries`,value:C,offset:m,size:g(C,e)})))):s===bwe?(h=o.domain(),p=H7(o,h[0],wt(h)),d.length<3&&!e.values&&h[0]!==wt(h)&&(d=[h[0],wt(h)]),r=d.map((y,b)=>It({index:b,label:c(y,b,d),value:y,perc:p(y)}))):(g=d.length-1,p=Twe(o),r=d.map((y,b)=>It({index:b,label:c(y,b,d),value:y,perc:b?p(y):0,perc2:b===g?1:p(d[b+1])}))),i.source=r,i.add=r,this.value=r,i}});const Y1e=e=>e.source.x,X1e=e=>e.source.y,Q1e=e=>e.target.x,Z1e=e=>e.target.y;function l2(e){Q.call(this,{},e)}l2.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};me(l2,Q,{transform(e,t){var n=e.sourceX||Y1e,i=e.sourceY||X1e,r=e.targetX||Q1e,s=e.targetY||Z1e,o=e.as||"path",a=e.orient||"vertical",l=e.shape||"line",u=vH.get(l+"-"+a)||vH.get(l);return u||te("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[o]=u(n(c),i(c),r(c),s(c))}),t.reflow(e.modified()).modifies(o)}});const xj=(e,t,n,i)=>"M"+e+","+t+"L"+n+","+i,J1e=(e,t,n,i)=>xj(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),Rj=(e,t,n,i)=>{var r=n-e,s=i-t,o=Math.hypot(r,s)/2,a=180*Math.atan2(s,r)/Math.PI;return"M"+e+","+t+"A"+o+","+o+" "+a+" 0 1 "+n+","+i},exe=(e,t,n,i)=>Rj(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),Ej=(e,t,n,i)=>{const r=n-e,s=i-t,o=.2*(r+s),a=.2*(s-r);return"M"+e+","+t+"C"+(e+o)+","+(t+a)+" "+(n+a)+","+(i-o)+" "+n+","+i},txe=(e,t,n,i)=>Ej(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),nxe=(e,t,n,i)=>"M"+e+","+t+"V"+i+"H"+n,ixe=(e,t,n,i)=>"M"+e+","+t+"H"+n+"V"+i,rxe=(e,t,n,i)=>{const r=Math.cos(e),s=Math.sin(e),o=Math.cos(n),a=Math.sin(n),l=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*r+","+t*s+"A"+t+","+t+" 0 0,"+(l?1:0)+" "+t*o+","+t*a+"L"+i*o+","+i*a},sxe=(e,t,n,i)=>{const r=(e+n)/2;return"M"+e+","+t+"C"+r+","+t+" "+r+","+i+" "+n+","+i},oxe=(e,t,n,i)=>{const r=(t+i)/2;return"M"+e+","+t+"C"+e+","+r+" "+n+","+r+" "+n+","+i},axe=(e,t,n,i)=>{const r=Math.cos(e),s=Math.sin(e),o=Math.cos(n),a=Math.sin(n),l=(t+i)/2;return"M"+t*r+","+t*s+"C"+l*r+","+l*s+" "+l*o+","+l*a+" "+i*o+","+i*a},vH=Zp({line:xj,"line-radial":J1e,arc:Rj,"arc-radial":exe,curve:Ej,"curve-radial":txe,"orthogonal-horizontal":nxe,"orthogonal-vertical":ixe,"orthogonal-radial":rxe,"diagonal-horizontal":sxe,"diagonal-vertical":oxe,"diagonal-radial":axe});function u2(e){Q.call(this,null,e)}u2.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};me(u2,Q,{transform(e,t){var n=e.as||["startAngle","endAngle"],i=n[0],r=n[1],s=e.field||Kp,o=e.startAngle||0,a=e.endAngle!=null?e.endAngle:2*Math.PI,l=t.source,u=l.map(s),c=u.length,d=o,h=(a-o)/$8(u),p=Ar(c),g,m,C;for(e.sort&&p.sort((y,b)=>u[y]-u[b]),g=0;g<c;++g)C=u[p[g]],m=l[p[g]],m[i]=d,m[r]=d+=C*h;return this.value=u,t.reflow(e.modified()).modifies(n)}});const lxe=5;function uxe(e){const t=e.type;return!e.bins&&(t===cp||t===X0||t===Q0)}function Fj(e){return S_(e)&&e!==wa}const cxe=Fo(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function Aj(e){Q.call(this,null,e),this.modified(!0)}me(Aj,Q,{transform(e,t){var n=t.dataflow,i=this.value,r=dxe(e);(!i||r!==i.type)&&(this.value=i=Mt(r)());for(r in e)if(!cxe[r]){if(r==="padding"&&Fj(i.type))continue;ot(i[r])?i[r](e[r]):n.warn("Unsupported scale property: "+r)}return vxe(i,e,mxe(i,e,fxe(i,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function dxe(e){var t=e.type,n="",i;return t===wa?wa+"-"+cp:(hxe(e)&&(i=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=i===2?wa+"-":i===3?og+"-":""),(n+t||cp).toLowerCase())}function hxe(e){const t=e.type;return S_(t)&&t!==qd&&t!==jd&&(e.scheme||e.range&&e.range.length&&e.range.every(Re))}function fxe(e,t,n){const i=pxe(e,t.domainRaw,n);if(i>-1)return i;var r=t.domain,s=e.type,o=t.zero||t.zero===void 0&&uxe(e),a,l;if(!r)return 0;if((o||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(a=(r=r.slice()).length-1||1,o&&(r[0]>0&&(r[0]=0),r[a]<0&&(r[a]=0)),t.domainMin!=null&&(r[0]=t.domainMin),t.domainMax!=null&&(r[a]=t.domainMax),t.domainMid!=null)){l=t.domainMid;const u=l>r[a]?a+1:l<r[0]?0:a;u!==a&&n.warn("Scale domainMid exceeds domain min or max.",l),r.splice(u,0,l)}return Fj(s)&&t.padding&&r[0]!==wt(r)&&(r=gxe(s,r,t.range,t.padding,t.exponent,t.constant)),e.domain(Dj(s,r,n)),s===C_&&e.unknown(t.domainImplicit?Uk:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&E_(e,t.nice)||null),r.length}function pxe(e,t,n){return t?(e.domain(Dj(e.type,t,n)),t.length):-1}function gxe(e,t,n,i,r,s){var o=Math.abs(wt(n)-n[0]),a=o/(o-2*i),l=e===$l?HT(t,null,a):e===Q0?Fb(t,null,a,.5):e===X0?Fb(t,null,a,r||1):e===px?VT(t,null,a,s||1):zT(t,null,a);return t=t.slice(),t[0]=l[0],t[t.length-1]=l[1],t}function Dj(e,t,n){if(N7(e)){var i=Math.abs(t.reduce((r,s)=>r+(s<0?-1:s>0?1:0),0));i!==t.length&&n.warn("Log scale domain includes zero: "+ge(t))}return t}function mxe(e,t,n){let i=t.bins;if(i&&!ne(i)){const r=e.domain(),s=r[0],o=wt(r),a=i.step;let l=i.start==null?s:i.start,u=i.stop==null?o:i.stop;a||te("Scale bins parameter missing step property."),l<s&&(l=a*Math.ceil(s/a)),u>o&&(u=a*Math.floor(o/a)),i=Ar(l,u+a/2,a)}return i?e.bins=i:e.bins&&delete e.bins,e.type===y_&&(i?!t.domain&&!t.domainRaw&&(e.domain(i),n=i.length):e.bins=e.domain()),n}function vxe(e,t,n){var i=e.type,r=t.round||!1,s=t.range;if(t.rangeStep!=null)s=Cxe(i,t,n);else if(t.scheme&&(s=yxe(i,t,n),ot(s))){if(e.interpolator)return e.interpolator(s);te(`Scale type ${i} does not support interpolating color schemes.`)}if(s&&$7(i))return e.interpolator(vx(pP(s,t.reverse),t.interpolate,t.interpolateGamma));s&&t.interpolate&&e.interpolate?e.interpolate(x_(t.interpolate,t.interpolateGamma)):ot(e.round)?e.round(r):ot(e.rangeRound)&&e.interpolate(r?K0:Sc),s&&e.range(pP(s,t.reverse))}function Cxe(e,t,n){e!==M7&&e!==Jk&&te("Only band and point scales support rangeStep.");var i=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,r=e===Jk?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*v_(n,r,i)]}function yxe(e,t,n){var i=t.schemeExtent,r,s;return ne(t.scheme)?s=vx(t.scheme,t.interpolate,t.interpolateGamma):(r=t.scheme.toLowerCase(),s=R_(r),s||te(`Unrecognized scheme name: ${t.scheme}`)),n=e===mx?n+1:e===y_?n-1:e===dp||e===gx?+t.schemeCount||lxe:n,$7(e)?CH(s,i,t.reverse):ot(s)?z7(CH(s,i),n):e===C_?s:s.slice(0,n)}function CH(e,t,n){return ot(e)&&(t||n)?G7(e,pP(t||[0,1],n)):e}function pP(e,t){return t?e.slice().reverse():e}function kj(e){Q.call(this,null,e)}me(kj,Q,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(yh(e.sort)),this.modified(n),t}});const yH="zero",Pj="center",Mj="normalize",Tj=["y0","y1"];function c2(e){Q.call(this,null,e)}c2.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:yH,values:[yH,Pj,Mj]},{name:"as",type:"string",array:!0,length:2,default:Tj}]};me(c2,Q,{transform(e,t){var n=e.as||Tj,i=n[0],r=n[1],s=yh(e.sort),o=e.field||Kp,a=e.offset===Pj?wxe:e.offset===Mj?bxe:Sxe,l,u,c,d;for(l=xxe(t.source,e.groupby,s,o),u=0,c=l.length,d=l.max;u<c;++u)a(l[u],d,o,i,r);return t.reflow(e.modified()).modifies(n)}});function wxe(e,t,n,i,r){for(var s=(t-e.sum)/2,o=e.length,a=0,l;a<o;++a)l=e[a],l[i]=s,l[r]=s+=Math.abs(n(l))}function bxe(e,t,n,i,r){for(var s=1/e.sum,o=0,a=e.length,l=0,u=0,c;l<a;++l)c=e[l],c[i]=o,c[r]=o=s*(u+=Math.abs(n(c)))}function Sxe(e,t,n,i,r){for(var s=0,o=0,a=e.length,l=0,u,c;l<a;++l)c=e[l],u=+n(c),u<0?(c[i]=o,c[r]=o+=u):(c[i]=s,c[r]=s+=u)}function xxe(e,t,n,i){var r=[],s=m=>m(c),o,a,l,u,c,d,h,p,g;if(t==null)r.push(e.slice());else for(o={},a=0,l=e.length;a<l;++a)c=e[a],d=t.map(s),h=o[d],h||(o[d]=h=[],r.push(h)),h.push(c);for(d=0,g=0,u=r.length;d<u;++d){for(h=r[d],a=0,p=0,l=h.length;a<l;++a)p+=Math.abs(i(h[a]));h.sum=p,p>g&&(g=p),n&&h.sort(n)}return r.max=g,r}const Rxe=Object.freeze(Object.defineProperty({__proto__:null,axisticks:yj,datajoin:wj,encode:bj,legendentries:Sj,linkpath:l2,pie:u2,scale:Aj,sortitems:kj,stack:c2},Symbol.toStringTag,{value:"Module"}));var He=1e-6,gP=1e-12,dt=Math.PI,bn=dt/2,iS=dt/4,ur=dt*2,kn=180/dt,ut=dt/180,yt=Math.abs,lg=Math.atan,Ws=Math.atan2,Ge=Math.cos,tw=Math.ceil,Ij=Math.exp,mP=Math.hypot,rS=Math.log,CA=Math.pow,Be=Math.sin,Ms=Math.sign||function(e){return e>0?1:e<0?-1:0},cr=Math.sqrt,d2=Math.tan;function _j(e){return e>1?0:e<-1?dt:Math.acos(e)}function _r(e){return e>1?bn:e<-1?-bn:Math.asin(e)}function vi(){}function sS(e,t){e&&bH.hasOwnProperty(e.type)&&bH[e.type](e,t)}var wH={Feature:function(e,t){sS(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)sS(n[i].geometry,t)}},bH={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)e=n[i],t.point(e[0],e[1],e[2])},LineString:function(e,t){vP(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)vP(n[i],t,0)},Polygon:function(e,t){SH(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)SH(n[i],t)},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)sS(n[i],t)}};function vP(e,t,n){var i=-1,r=e.length-n,s;for(t.lineStart();++i<r;)s=e[i],t.point(s[0],s[1],s[2]);t.lineEnd()}function SH(e,t){var n=-1,i=e.length;for(t.polygonStart();++n<i;)vP(e[n],t,1);t.polygonEnd()}function gl(e,t){e&&wH.hasOwnProperty(e.type)?wH[e.type](e,t):sS(e,t)}var oS=new or,aS=new or,Oj,Lj,CP,yP,wP,ka={point:vi,lineStart:vi,lineEnd:vi,polygonStart:function(){oS=new or,ka.lineStart=Exe,ka.lineEnd=Fxe},polygonEnd:function(){var e=+oS;aS.add(e<0?ur+e:e),this.lineStart=this.lineEnd=this.point=vi},sphere:function(){aS.add(ur)}};function Exe(){ka.point=Axe}function Fxe(){Nj(Oj,Lj)}function Axe(e,t){ka.point=Nj,Oj=e,Lj=t,e*=ut,t*=ut,CP=e,yP=Ge(t=t/2+iS),wP=Be(t)}function Nj(e,t){e*=ut,t*=ut,t=t/2+iS;var n=e-CP,i=n>=0?1:-1,r=i*n,s=Ge(t),o=Be(t),a=wP*o,l=yP*s+a*Ge(r),u=a*i*Be(r);oS.add(Ws(u,l)),CP=e,yP=s,wP=o}function Dxe(e){return aS=new or,gl(e,ka),aS*2}function lS(e){return[Ws(e[1],e[0]),_r(e[2])]}function Yd(e){var t=e[0],n=e[1],i=Ge(n);return[i*Ge(t),i*Be(t),Be(n)]}function nw(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function vp(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function yA(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function iw(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function uS(e){var t=cr(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var cn,Rr,vn,Xr,cd,$j,Bj,Bf,mv,Du,Bl,dl={point:bP,lineStart:xH,lineEnd:RH,polygonStart:function(){dl.point=zj,dl.lineStart=kxe,dl.lineEnd=Pxe,mv=new or,ka.polygonStart()},polygonEnd:function(){ka.polygonEnd(),dl.point=bP,dl.lineStart=xH,dl.lineEnd=RH,oS<0?(cn=-(vn=180),Rr=-(Xr=90)):mv>He?Xr=90:mv<-1e-6&&(Rr=-90),Bl[0]=cn,Bl[1]=vn},sphere:function(){cn=-(vn=180),Rr=-(Xr=90)}};function bP(e,t){Du.push(Bl=[cn=e,vn=e]),t<Rr&&(Rr=t),t>Xr&&(Xr=t)}function Gj(e,t){var n=Yd([e*ut,t*ut]);if(Bf){var i=vp(Bf,n),r=[i[1],-i[0],0],s=vp(r,i);uS(s),s=lS(s);var o=e-cd,a=o>0?1:-1,l=s[0]*kn*a,u,c=yt(o)>180;c^(a*cd<l&&l<a*e)?(u=s[1]*kn,u>Xr&&(Xr=u)):(l=(l+360)%360-180,c^(a*cd<l&&l<a*e)?(u=-s[1]*kn,u<Rr&&(Rr=u)):(t<Rr&&(Rr=t),t>Xr&&(Xr=t))),c?e<cd?Yr(cn,e)>Yr(cn,vn)&&(vn=e):Yr(e,vn)>Yr(cn,vn)&&(cn=e):vn>=cn?(e<cn&&(cn=e),e>vn&&(vn=e)):e>cd?Yr(cn,e)>Yr(cn,vn)&&(vn=e):Yr(e,vn)>Yr(cn,vn)&&(cn=e)}else Du.push(Bl=[cn=e,vn=e]);t<Rr&&(Rr=t),t>Xr&&(Xr=t),Bf=n,cd=e}function xH(){dl.point=Gj}function RH(){Bl[0]=cn,Bl[1]=vn,dl.point=bP,Bf=null}function zj(e,t){if(Bf){var n=e-cd;mv.add(yt(n)>180?n+(n>0?360:-360):n)}else $j=e,Bj=t;ka.point(e,t),Gj(e,t)}function kxe(){ka.lineStart()}function Pxe(){zj($j,Bj),ka.lineEnd(),yt(mv)>He&&(cn=-(vn=180)),Bl[0]=cn,Bl[1]=vn,Bf=null}function Yr(e,t){return(t-=e)<0?t+360:t}function Mxe(e,t){return e[0]-t[0]}function EH(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function Txe(e){var t,n,i,r,s,o,a;if(Xr=vn=-(cn=Rr=1/0),Du=[],gl(e,dl),n=Du.length){for(Du.sort(Mxe),t=1,i=Du[0],s=[i];t<n;++t)r=Du[t],EH(i,r[0])||EH(i,r[1])?(Yr(i[0],r[1])>Yr(i[0],i[1])&&(i[1]=r[1]),Yr(r[0],i[1])>Yr(i[0],i[1])&&(i[0]=r[0])):s.push(i=r);for(o=-1/0,n=s.length-1,t=0,i=s[n];t<=n;i=r,++t)r=s[t],(a=Yr(i[1],r[0]))>o&&(o=a,cn=r[0],vn=i[1])}return Du=Bl=null,cn===1/0||Rr===1/0?[[NaN,NaN],[NaN,NaN]]:[[cn,Rr],[vn,Xr]]}var jm,cS,dS,hS,fS,pS,gS,mS,SP,xP,RP,Hj,Vj,Zi,Ji,er,Co={sphere:vi,point:h2,lineStart:FH,lineEnd:AH,polygonStart:function(){Co.lineStart=Oxe,Co.lineEnd=Lxe},polygonEnd:function(){Co.lineStart=FH,Co.lineEnd=AH}};function h2(e,t){e*=ut,t*=ut;var n=Ge(t);uC(n*Ge(e),n*Be(e),Be(t))}function uC(e,t,n){++jm,dS+=(e-dS)/jm,hS+=(t-hS)/jm,fS+=(n-fS)/jm}function FH(){Co.point=Ixe}function Ixe(e,t){e*=ut,t*=ut;var n=Ge(t);Zi=n*Ge(e),Ji=n*Be(e),er=Be(t),Co.point=_xe,uC(Zi,Ji,er)}function _xe(e,t){e*=ut,t*=ut;var n=Ge(t),i=n*Ge(e),r=n*Be(e),s=Be(t),o=Ws(cr((o=Ji*s-er*r)*o+(o=er*i-Zi*s)*o+(o=Zi*r-Ji*i)*o),Zi*i+Ji*r+er*s);cS+=o,pS+=o*(Zi+(Zi=i)),gS+=o*(Ji+(Ji=r)),mS+=o*(er+(er=s)),uC(Zi,Ji,er)}function AH(){Co.point=h2}function Oxe(){Co.point=Nxe}function Lxe(){Wj(Hj,Vj),Co.point=h2}function Nxe(e,t){Hj=e,Vj=t,e*=ut,t*=ut,Co.point=Wj;var n=Ge(t);Zi=n*Ge(e),Ji=n*Be(e),er=Be(t),uC(Zi,Ji,er)}function Wj(e,t){e*=ut,t*=ut;var n=Ge(t),i=n*Ge(e),r=n*Be(e),s=Be(t),o=Ji*s-er*r,a=er*i-Zi*s,l=Zi*r-Ji*i,u=mP(o,a,l),c=_r(u),d=u&&-c/u;SP.add(d*o),xP.add(d*a),RP.add(d*l),cS+=c,pS+=c*(Zi+(Zi=i)),gS+=c*(Ji+(Ji=r)),mS+=c*(er+(er=s)),uC(Zi,Ji,er)}function $xe(e){jm=cS=dS=hS=fS=pS=gS=mS=0,SP=new or,xP=new or,RP=new or,gl(e,Co);var t=+SP,n=+xP,i=+RP,r=mP(t,n,i);return r<gP&&(t=pS,n=gS,i=mS,cS<He&&(t=dS,n=hS,i=fS),r=mP(t,n,i),r<gP)?[NaN,NaN]:[Ws(n,t)*kn,_r(i/r)*kn]}function EP(e,t){function n(i,r){return i=e(i,r),t(i[0],i[1])}return e.invert&&t.invert&&(n.invert=function(i,r){return i=t.invert(i,r),i&&e.invert(i[0],i[1])}),n}function FP(e,t){return yt(e)>dt&&(e-=Math.round(e/ur)*ur),[e,t]}FP.invert=FP;function Uj(e,t,n){return(e%=ur)?t||n?EP(kH(e),PH(t,n)):kH(e):t||n?PH(t,n):FP}function DH(e){return function(t,n){return t+=e,yt(t)>dt&&(t-=Math.round(t/ur)*ur),[t,n]}}function kH(e){var t=DH(e);return t.invert=DH(-e),t}function PH(e,t){var n=Ge(e),i=Be(e),r=Ge(t),s=Be(t);function o(a,l){var u=Ge(l),c=Ge(a)*u,d=Be(a)*u,h=Be(l),p=h*n+c*i;return[Ws(d*r-p*s,c*n-h*i),_r(p*r+d*s)]}return o.invert=function(a,l){var u=Ge(l),c=Ge(a)*u,d=Be(a)*u,h=Be(l),p=h*r-d*s;return[Ws(d*r+h*s,c*n+p*i),_r(p*n-c*i)]},o}function Bxe(e){e=Uj(e[0]*ut,e[1]*ut,e.length>2?e[2]*ut:0);function t(n){return n=e(n[0]*ut,n[1]*ut),n[0]*=kn,n[1]*=kn,n}return t.invert=function(n){return n=e.invert(n[0]*ut,n[1]*ut),n[0]*=kn,n[1]*=kn,n},t}function Gxe(e,t,n,i,r,s){if(n){var o=Ge(t),a=Be(t),l=i*n;r==null?(r=t+i*ur,s=t-l/2):(r=MH(o,r),s=MH(o,s),(i>0?r<s:r>s)&&(r+=i*ur));for(var u,c=r;i>0?c>s:c<s;c-=l)u=lS([o,-a*Ge(c),-a*Be(c)]),e.point(u[0],u[1])}}function MH(e,t){t=Yd(t),t[0]-=e,uS(t);var n=_j(-t[1]);return((-t[2]<0?-n:n)+ur-He)%ur}function qj(){var e=[],t;return{point:function(n,i,r){t.push([n,i,r])},lineStart:function(){e.push(t=[])},lineEnd:vi,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function tb(e,t){return yt(e[0]-t[0])<He&&yt(e[1]-t[1])<He}function rw(e,t,n,i){this.x=e,this.z=t,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function jj(e,t,n,i,r){var s=[],o=[],a,l;if(e.forEach(function(g){if(!((m=g.length-1)<=0)){var m,C=g[0],y=g[m],b;if(tb(C,y)){if(!C[2]&&!y[2]){for(r.lineStart(),a=0;a<m;++a)r.point((C=g[a])[0],C[1]);r.lineEnd();return}y[0]+=2*He}s.push(b=new rw(C,g,null,!0)),o.push(b.o=new rw(C,null,b,!1)),s.push(b=new rw(y,g,null,!1)),o.push(b.o=new rw(y,null,b,!0))}}),!!s.length){for(o.sort(t),TH(s),TH(o),a=0,l=o.length;a<l;++a)o[a].e=n=!n;for(var u=s[0],c,d;;){for(var h=u,p=!0;h.v;)if((h=h.n)===u)return;c=h.z,r.lineStart();do{if(h.v=h.o.v=!0,h.e){if(p)for(a=0,l=c.length;a<l;++a)r.point((d=c[a])[0],d[1]);else i(h.x,h.n.x,1,r);h=h.n}else{if(p)for(c=h.p.z,a=c.length-1;a>=0;--a)r.point((d=c[a])[0],d[1]);else i(h.x,h.p.x,-1,r);h=h.p}h=h.o,c=h.z,p=!p}while(!h.v);r.lineEnd()}}}function TH(e){if(t=e.length){for(var t,n=0,i=e[0],r;++n<t;)i.n=r=e[n],r.p=i,i=r;i.n=r=e[0],r.p=i}}function wA(e){return yt(e[0])<=dt?e[0]:Ms(e[0])*((yt(e[0])+dt)%ur-dt)}function zxe(e,t){var n=wA(t),i=t[1],r=Be(i),s=[Be(n),-Ge(n),0],o=0,a=0,l=new or;r===1?i=bn+He:r===-1&&(i=-bn-He);for(var u=0,c=e.length;u<c;++u)if(h=(d=e[u]).length)for(var d,h,p=d[h-1],g=wA(p),m=p[1]/2+iS,C=Be(m),y=Ge(m),b=0;b<h;++b,g=x,C=A,y=F,p=S){var S=d[b],x=wA(S),E=S[1]/2+iS,A=Be(E),F=Ge(E),P=x-g,D=P>=0?1:-1,M=D*P,O=M>dt,B=C*A;if(l.add(Ws(B*D*Be(M),y*F+B*Ge(M))),o+=O?P+D*ur:P,O^g>=n^x>=n){var H=vp(Yd(p),Yd(S));uS(H);var N=vp(s,H);uS(N);var L=(O^P>=0?-1:1)*_r(N[2]);(i>L||i===L&&(H[0]||H[1]))&&(a+=O^P>=0?1:-1)}}return(o<-1e-6||o<He&&l<-1e-12)^a&1}function Kj(e,t,n,i){return function(r){var s=t(r),o=qj(),a=t(o),l=!1,u,c,d,h={point:p,lineStart:m,lineEnd:C,polygonStart:function(){h.point=y,h.lineStart=b,h.lineEnd=S,c=[],u=[]},polygonEnd:function(){h.point=p,h.lineStart=m,h.lineEnd=C,c=N8(c);var x=zxe(u,i);c.length?(l||(r.polygonStart(),l=!0),jj(c,Vxe,x,n,r)):x&&(l||(r.polygonStart(),l=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),l&&(r.polygonEnd(),l=!1),c=u=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function p(x,E){e(x,E)&&r.point(x,E)}function g(x,E){s.point(x,E)}function m(){h.point=g,s.lineStart()}function C(){h.point=p,s.lineEnd()}function y(x,E){d.push([x,E]),a.point(x,E)}function b(){a.lineStart(),d=[]}function S(){y(d[0][0],d[0][1]),a.lineEnd();var x=a.clean(),E=o.result(),A,F=E.length,P,D,M;if(d.pop(),u.push(d),d=null,!!F){if(x&1){if(D=E[0],(P=D.length-1)>0){for(l||(r.polygonStart(),l=!0),r.lineStart(),A=0;A<P;++A)r.point((M=D[A])[0],M[1]);r.lineEnd()}return}F>1&&x&2&&E.push(E.pop().concat(E.shift())),c.push(E.filter(Hxe))}}return h}}function Hxe(e){return e.length>1}function Vxe(e,t){return((e=e.x)[0]<0?e[1]-bn-He:bn-e[1])-((t=t.x)[0]<0?t[1]-bn-He:bn-t[1])}const IH=Kj(function(){return!0},Wxe,qxe,[-dt,-bn]);function Wxe(e){var t=NaN,n=NaN,i=NaN,r;return{lineStart:function(){e.lineStart(),r=1},point:function(s,o){var a=s>0?dt:-dt,l=yt(s-t);yt(l-dt)<He?(e.point(t,n=(n+o)/2>0?bn:-bn),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(a,n),e.point(s,n),r=0):i!==a&&l>=dt&&(yt(t-i)<He&&(t-=i*He),yt(s-a)<He&&(s-=a*He),n=Uxe(t,n,s,o),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(a,n),r=0),e.point(t=s,n=o),i=a},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-r}}}function Uxe(e,t,n,i){var r,s,o=Be(e-n);return yt(o)>He?lg((Be(t)*(s=Ge(i))*Be(n)-Be(i)*(r=Ge(t))*Be(e))/(r*s*o)):(t+i)/2}function qxe(e,t,n,i){var r;if(e==null)r=n*bn,i.point(-dt,r),i.point(0,r),i.point(dt,r),i.point(dt,0),i.point(dt,-r),i.point(0,-r),i.point(-dt,-r),i.point(-dt,0),i.point(-dt,r);else if(yt(e[0]-t[0])>He){var s=e[0]<t[0]?dt:-dt;r=n*s/2,i.point(-s,r),i.point(0,r),i.point(s,r)}else i.point(t[0],t[1])}function jxe(e){var t=Ge(e),n=2*ut,i=t>0,r=yt(t)>He;function s(c,d,h,p){Gxe(p,e,n,h,c,d)}function o(c,d){return Ge(c)*Ge(d)>t}function a(c){var d,h,p,g,m;return{lineStart:function(){g=p=!1,m=1},point:function(C,y){var b=[C,y],S,x=o(C,y),E=i?x?0:u(C,y):x?u(C+(C<0?dt:-dt),y):0;if(!d&&(g=p=x)&&c.lineStart(),x!==p&&(S=l(d,b),(!S||tb(d,S)||tb(b,S))&&(b[2]=1)),x!==p)m=0,x?(c.lineStart(),S=l(b,d),c.point(S[0],S[1])):(S=l(d,b),c.point(S[0],S[1],2),c.lineEnd()),d=S;else if(r&&d&&i^x){var A;!(E&h)&&(A=l(b,d,!0))&&(m=0,i?(c.lineStart(),c.point(A[0][0],A[0][1]),c.point(A[1][0],A[1][1]),c.lineEnd()):(c.point(A[1][0],A[1][1]),c.lineEnd(),c.lineStart(),c.point(A[0][0],A[0][1],3)))}x&&(!d||!tb(d,b))&&c.point(b[0],b[1]),d=b,p=x,h=E},lineEnd:function(){p&&c.lineEnd(),d=null},clean:function(){return m|(g&&p)<<1}}}function l(c,d,h){var p=Yd(c),g=Yd(d),m=[1,0,0],C=vp(p,g),y=nw(C,C),b=C[0],S=y-b*b;if(!S)return!h&&c;var x=t*y/S,E=-t*b/S,A=vp(m,C),F=iw(m,x),P=iw(C,E);yA(F,P);var D=A,M=nw(F,D),O=nw(D,D),B=M*M-O*(nw(F,F)-1);if(!(B<0)){var H=cr(B),N=iw(D,(-M-H)/O);if(yA(N,F),N=lS(N),!h)return N;var L=c[0],G=d[0],q=c[1],V=d[1],U;G<L&&(U=L,L=G,G=U);var ie=G-L,pe=yt(ie-dt)<He,K=pe||ie<He;if(!pe&&V<q&&(U=q,q=V,V=U),K?pe?q+V>0^N[1]<(yt(N[0]-L)<He?q:V):q<=N[1]&&N[1]<=V:ie>dt^(L<=N[0]&&N[0]<=G)){var Fe=iw(D,(-M+H)/O);return yA(Fe,F),[N,lS(Fe)]}}}function u(c,d){var h=i?e:dt-e,p=0;return c<-h?p|=1:c>h&&(p|=2),d<-h?p|=4:d>h&&(p|=8),p}return Kj(o,a,s,i?[0,-e]:[-dt,e-dt])}function Kxe(e,t,n,i,r,s){var o=e[0],a=e[1],l=t[0],u=t[1],c=0,d=1,h=l-o,p=u-a,g;if(g=n-o,!(!h&&g>0)){if(g/=h,h<0){if(g<c)return;g<d&&(d=g)}else if(h>0){if(g>d)return;g>c&&(c=g)}if(g=r-o,!(!h&&g<0)){if(g/=h,h<0){if(g>d)return;g>c&&(c=g)}else if(h>0){if(g<c)return;g<d&&(d=g)}if(g=i-a,!(!p&&g>0)){if(g/=p,p<0){if(g<c)return;g<d&&(d=g)}else if(p>0){if(g>d)return;g>c&&(c=g)}if(g=s-a,!(!p&&g<0)){if(g/=p,p<0){if(g>d)return;g>c&&(c=g)}else if(p>0){if(g<c)return;g<d&&(d=g)}return c>0&&(e[0]=o+c*h,e[1]=a+c*p),d<1&&(t[0]=o+d*h,t[1]=a+d*p),!0}}}}}var sw=1e9,ow=-1e9;function Yj(e,t,n,i){function r(u,c){return e<=u&&u<=n&&t<=c&&c<=i}function s(u,c,d,h){var p=0,g=0;if(u==null||(p=o(u,d))!==(g=o(c,d))||l(u,c)<0^d>0)do h.point(p===0||p===3?e:n,p>1?i:t);while((p=(p+d+4)%4)!==g);else h.point(c[0],c[1])}function o(u,c){return yt(u[0]-e)<He?c>0?0:3:yt(u[0]-n)<He?c>0?2:1:yt(u[1]-t)<He?c>0?1:0:c>0?3:2}function a(u,c){return l(u.x,c.x)}function l(u,c){var d=o(u,1),h=o(c,1);return d!==h?d-h:d===0?c[1]-u[1]:d===1?u[0]-c[0]:d===2?u[1]-c[1]:c[0]-u[0]}return function(u){var c=u,d=qj(),h,p,g,m,C,y,b,S,x,E,A,F={point:P,lineStart:B,lineEnd:H,polygonStart:M,polygonEnd:O};function P(L,G){r(L,G)&&c.point(L,G)}function D(){for(var L=0,G=0,q=p.length;G<q;++G)for(var V=p[G],U=1,ie=V.length,pe=V[0],K,Fe,Je=pe[0],Me=pe[1];U<ie;++U)K=Je,Fe=Me,pe=V[U],Je=pe[0],Me=pe[1],Fe<=i?Me>i&&(Je-K)*(i-Fe)>(Me-Fe)*(e-K)&&++L:Me<=i&&(Je-K)*(i-Fe)<(Me-Fe)*(e-K)&&--L;return L}function M(){c=d,h=[],p=[],A=!0}function O(){var L=D(),G=A&&L,q=(h=N8(h)).length;(G||q)&&(u.polygonStart(),G&&(u.lineStart(),s(null,null,1,u),u.lineEnd()),q&&jj(h,a,L,s,u),u.polygonEnd()),c=u,h=p=g=null}function B(){F.point=N,p&&p.push(g=[]),E=!0,x=!1,b=S=NaN}function H(){h&&(N(m,C),y&&x&&d.rejoin(),h.push(d.result())),F.point=P,x&&c.lineEnd()}function N(L,G){var q=r(L,G);if(p&&g.push([L,G]),E)m=L,C=G,y=q,E=!1,q&&(c.lineStart(),c.point(L,G));else if(q&&x)c.point(L,G);else{var V=[b=Math.max(ow,Math.min(sw,b)),S=Math.max(ow,Math.min(sw,S))],U=[L=Math.max(ow,Math.min(sw,L)),G=Math.max(ow,Math.min(sw,G))];Kxe(V,U,e,t,n,i)?(x||(c.lineStart(),c.point(V[0],V[1])),c.point(U[0],U[1]),q||c.lineEnd(),A=!1):q&&(c.lineStart(),c.point(L,G),A=!1)}b=L,S=G,x=q}return F}}function _H(e,t,n){var i=Ar(e,t-He,n).concat(t);return function(r){return i.map(function(s){return[r,s]})}}function OH(e,t,n){var i=Ar(e,t-He,n).concat(t);return function(r){return i.map(function(s){return[s,r]})}}function Yxe(){var e,t,n,i,r,s,o,a,l=10,u=l,c=90,d=360,h,p,g,m,C=2.5;function y(){return{type:"MultiLineString",coordinates:b()}}function b(){return Ar(tw(i/c)*c,n,c).map(g).concat(Ar(tw(a/d)*d,o,d).map(m)).concat(Ar(tw(t/l)*l,e,l).filter(function(S){return yt(S%c)>He}).map(h)).concat(Ar(tw(s/u)*u,r,u).filter(function(S){return yt(S%d)>He}).map(p))}return y.lines=function(){return b().map(function(S){return{type:"LineString",coordinates:S}})},y.outline=function(){return{type:"Polygon",coordinates:[g(i).concat(m(o).slice(1),g(n).reverse().slice(1),m(a).reverse().slice(1))]}},y.extent=function(S){return arguments.length?y.extentMajor(S).extentMinor(S):y.extentMinor()},y.extentMajor=function(S){return arguments.length?(i=+S[0][0],n=+S[1][0],a=+S[0][1],o=+S[1][1],i>n&&(S=i,i=n,n=S),a>o&&(S=a,a=o,o=S),y.precision(C)):[[i,a],[n,o]]},y.extentMinor=function(S){return arguments.length?(t=+S[0][0],e=+S[1][0],s=+S[0][1],r=+S[1][1],t>e&&(S=t,t=e,e=S),s>r&&(S=s,s=r,r=S),y.precision(C)):[[t,s],[e,r]]},y.step=function(S){return arguments.length?y.stepMajor(S).stepMinor(S):y.stepMinor()},y.stepMajor=function(S){return arguments.length?(c=+S[0],d=+S[1],y):[c,d]},y.stepMinor=function(S){return arguments.length?(l=+S[0],u=+S[1],y):[l,u]},y.precision=function(S){return arguments.length?(C=+S,h=_H(s,r,90),p=OH(t,e,C),g=_H(a,o,90),m=OH(i,n,C),y):C},y.extentMajor([[-180,-90+He],[180,90-He]]).extentMinor([[-180,-80-He],[180,80+He]])}const Jv=e=>e;var bA=new or,AP=new or,Xj,Qj,DP,kP,ml={point:vi,lineStart:vi,lineEnd:vi,polygonStart:function(){ml.lineStart=Xxe,ml.lineEnd=Zxe},polygonEnd:function(){ml.lineStart=ml.lineEnd=ml.point=vi,bA.add(yt(AP)),AP=new or},result:function(){var e=bA/2;return bA=new or,e}};function Xxe(){ml.point=Qxe}function Qxe(e,t){ml.point=Zj,Xj=DP=e,Qj=kP=t}function Zj(e,t){AP.add(kP*e-DP*t),DP=e,kP=t}function Zxe(){Zj(Xj,Qj)}var Cp=1/0,vS=Cp,e0=-Cp,CS=e0,yS={point:Jxe,lineStart:vi,lineEnd:vi,polygonStart:vi,polygonEnd:vi,result:function(){var e=[[Cp,vS],[e0,CS]];return e0=CS=-(vS=Cp=1/0),e}};function Jxe(e,t){e<Cp&&(Cp=e),e>e0&&(e0=e),t<vS&&(vS=t),t>CS&&(CS=t)}var PP=0,MP=0,Km=0,wS=0,bS=0,Df=0,TP=0,IP=0,Ym=0,Jj,eK,ha,fa,Ds={point:Xd,lineStart:LH,lineEnd:NH,polygonStart:function(){Ds.lineStart=nRe,Ds.lineEnd=iRe},polygonEnd:function(){Ds.point=Xd,Ds.lineStart=LH,Ds.lineEnd=NH},result:function(){var e=Ym?[TP/Ym,IP/Ym]:Df?[wS/Df,bS/Df]:Km?[PP/Km,MP/Km]:[NaN,NaN];return PP=MP=Km=wS=bS=Df=TP=IP=Ym=0,e}};function Xd(e,t){PP+=e,MP+=t,++Km}function LH(){Ds.point=eRe}function eRe(e,t){Ds.point=tRe,Xd(ha=e,fa=t)}function tRe(e,t){var n=e-ha,i=t-fa,r=cr(n*n+i*i);wS+=r*(ha+e)/2,bS+=r*(fa+t)/2,Df+=r,Xd(ha=e,fa=t)}function NH(){Ds.point=Xd}function nRe(){Ds.point=rRe}function iRe(){tK(Jj,eK)}function rRe(e,t){Ds.point=tK,Xd(Jj=ha=e,eK=fa=t)}function tK(e,t){var n=e-ha,i=t-fa,r=cr(n*n+i*i);wS+=r*(ha+e)/2,bS+=r*(fa+t)/2,Df+=r,r=fa*e-ha*t,TP+=r*(ha+e),IP+=r*(fa+t),Ym+=r*3,Xd(ha=e,fa=t)}function nK(e){this._context=e}nK.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,ur);break}}},result:vi};var _P=new or,SA,iK,rK,Xm,Qm,t0={point:vi,lineStart:function(){t0.point=sRe},lineEnd:function(){SA&&sK(iK,rK),t0.point=vi},polygonStart:function(){SA=!0},polygonEnd:function(){SA=null},result:function(){var e=+_P;return _P=new or,e}};function sRe(e,t){t0.point=sK,iK=Xm=e,rK=Qm=t}function sK(e,t){Xm-=e,Qm-=t,_P.add(cr(Xm*Xm+Qm*Qm)),Xm=e,Qm=t}let $H,SS,BH,GH;class zH{constructor(t){this._append=t==null?oK:oRe(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==BH||this._append!==SS){const i=this._radius,r=this._;this._="",this._append`m0,${i}a${i},${i} 0 1,1 0,${-2*i}a${i},${i} 0 1,1 0,${2*i}z`,BH=i,SS=this._append,GH=this._,this._=r}this._+=GH;break}}}result(){const t=this._;return this._="",t.length?t:null}}function oK(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function oRe(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return oK;if(t!==$H){const n=10**t;$H=t,SS=function(r){let s=1;this._+=r[0];for(const o=r.length;s<o;++s)this._+=Math.round(arguments[s]*n)/n+r[s]}}return SS}function aK(e,t){let n=3,i=4.5,r,s;function o(a){return a&&(typeof i=="function"&&s.pointRadius(+i.apply(this,arguments)),gl(a,r(s))),s.result()}return o.area=function(a){return gl(a,r(ml)),ml.result()},o.measure=function(a){return gl(a,r(t0)),t0.result()},o.bounds=function(a){return gl(a,r(yS)),yS.result()},o.centroid=function(a){return gl(a,r(Ds)),Ds.result()},o.projection=function(a){return arguments.length?(r=a==null?(e=null,Jv):(e=a).stream,o):e},o.context=function(a){return arguments.length?(s=a==null?(t=null,new zH(n)):new nK(t=a),typeof i!="function"&&s.pointRadius(i),o):t},o.pointRadius=function(a){return arguments.length?(i=typeof a=="function"?a:(s.pointRadius(+a),+a),o):i},o.digits=function(a){if(!arguments.length)return n;if(a==null)n=null;else{const l=Math.floor(a);if(!(l>=0))throw new RangeError(`invalid digits: ${a}`);n=l}return t===null&&(s=new zH(n)),o},o.projection(e).digits(n).context(t)}function Px(e){return function(t){var n=new OP;for(var i in e)n[i]=e[i];return n.stream=t,n}}function OP(){}OP.prototype={constructor:OP,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function f2(e,t,n){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),i!=null&&e.clipExtent(null),gl(n,e.stream(yS)),t(yS.result()),i!=null&&e.clipExtent(i),e}function Mx(e,t,n){return f2(e,function(i){var r=t[1][0]-t[0][0],s=t[1][1]-t[0][1],o=Math.min(r/(i[1][0]-i[0][0]),s/(i[1][1]-i[0][1])),a=+t[0][0]+(r-o*(i[1][0]+i[0][0]))/2,l=+t[0][1]+(s-o*(i[1][1]+i[0][1]))/2;e.scale(150*o).translate([a,l])},n)}function p2(e,t,n){return Mx(e,[[0,0],t],n)}function g2(e,t,n){return f2(e,function(i){var r=+t,s=r/(i[1][0]-i[0][0]),o=(r-s*(i[1][0]+i[0][0]))/2,a=-s*i[0][1];e.scale(150*s).translate([o,a])},n)}function m2(e,t,n){return f2(e,function(i){var r=+t,s=r/(i[1][1]-i[0][1]),o=-s*i[0][0],a=(r-s*(i[1][1]+i[0][1]))/2;e.scale(150*s).translate([o,a])},n)}var HH=16,aRe=Ge(30*ut);function VH(e,t){return+t?uRe(e,t):lRe(e)}function lRe(e){return Px({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function uRe(e,t){function n(i,r,s,o,a,l,u,c,d,h,p,g,m,C){var y=u-i,b=c-r,S=y*y+b*b;if(S>4*t&&m--){var x=o+h,E=a+p,A=l+g,F=cr(x*x+E*E+A*A),P=_r(A/=F),D=yt(yt(A)-1)<He||yt(s-d)<He?(s+d)/2:Ws(E,x),M=e(D,P),O=M[0],B=M[1],H=O-i,N=B-r,L=b*H-y*N;(L*L/S>t||yt((y*H+b*N)/S-.5)>.3||o*h+a*p+l*g<aRe)&&(n(i,r,s,o,a,l,O,B,D,x/=F,E/=F,A,m,C),C.point(O,B),n(O,B,D,x,E,A,u,c,d,h,p,g,m,C))}}return function(i){var r,s,o,a,l,u,c,d,h,p,g,m,C={point:y,lineStart:b,lineEnd:x,polygonStart:function(){i.polygonStart(),C.lineStart=E},polygonEnd:function(){i.polygonEnd(),C.lineStart=b}};function y(P,D){P=e(P,D),i.point(P[0],P[1])}function b(){d=NaN,C.point=S,i.lineStart()}function S(P,D){var M=Yd([P,D]),O=e(P,D);n(d,h,c,p,g,m,d=O[0],h=O[1],c=P,p=M[0],g=M[1],m=M[2],HH,i),i.point(d,h)}function x(){C.point=y,i.lineEnd()}function E(){b(),C.point=A,C.lineEnd=F}function A(P,D){S(r=P,D),s=d,o=h,a=p,l=g,u=m,C.point=S}function F(){n(d,h,c,p,g,m,s,o,r,a,l,u,HH,i),C.lineEnd=x,x()}return C}}var cRe=Px({point:function(e,t){this.stream.point(e*ut,t*ut)}});function dRe(e){return Px({point:function(t,n){var i=e(t,n);return this.stream.point(i[0],i[1])}})}function hRe(e,t,n,i,r){function s(o,a){return o*=i,a*=r,[t+e*o,n-e*a]}return s.invert=function(o,a){return[(o-t)/e*i,(n-a)/e*r]},s}function WH(e,t,n,i,r,s){if(!s)return hRe(e,t,n,i,r);var o=Ge(s),a=Be(s),l=o*e,u=a*e,c=o/e,d=a/e,h=(a*n-o*t)/e,p=(a*t+o*n)/e;function g(m,C){return m*=i,C*=r,[l*m-u*C+t,n-u*m-l*C]}return g.invert=function(m,C){return[i*(c*m-d*C+h),r*(p-d*m-c*C)]},g}function $a(e){return lK(function(){return e})()}function lK(e){var t,n=150,i=480,r=250,s=0,o=0,a=0,l=0,u=0,c,d=0,h=1,p=1,g=null,m=IH,C=null,y,b,S,x=Jv,E=.5,A,F,P,D,M;function O(L){return P(L[0]*ut,L[1]*ut)}function B(L){return L=P.invert(L[0],L[1]),L&&[L[0]*kn,L[1]*kn]}O.stream=function(L){return D&&M===L?D:D=cRe(dRe(c)(m(A(x(M=L)))))},O.preclip=function(L){return arguments.length?(m=L,g=void 0,N()):m},O.postclip=function(L){return arguments.length?(x=L,C=y=b=S=null,N()):x},O.clipAngle=function(L){return arguments.length?(m=+L?jxe(g=L*ut):(g=null,IH),N()):g*kn},O.clipExtent=function(L){return arguments.length?(x=L==null?(C=y=b=S=null,Jv):Yj(C=+L[0][0],y=+L[0][1],b=+L[1][0],S=+L[1][1]),N()):C==null?null:[[C,y],[b,S]]},O.scale=function(L){return arguments.length?(n=+L,H()):n},O.translate=function(L){return arguments.length?(i=+L[0],r=+L[1],H()):[i,r]},O.center=function(L){return arguments.length?(s=L[0]%360*ut,o=L[1]%360*ut,H()):[s*kn,o*kn]},O.rotate=function(L){return arguments.length?(a=L[0]%360*ut,l=L[1]%360*ut,u=L.length>2?L[2]%360*ut:0,H()):[a*kn,l*kn,u*kn]},O.angle=function(L){return arguments.length?(d=L%360*ut,H()):d*kn},O.reflectX=function(L){return arguments.length?(h=L?-1:1,H()):h<0},O.reflectY=function(L){return arguments.length?(p=L?-1:1,H()):p<0},O.precision=function(L){return arguments.length?(A=VH(F,E=L*L),N()):cr(E)},O.fitExtent=function(L,G){return Mx(O,L,G)},O.fitSize=function(L,G){return p2(O,L,G)},O.fitWidth=function(L,G){return g2(O,L,G)},O.fitHeight=function(L,G){return m2(O,L,G)};function H(){var L=WH(n,0,0,h,p,d).apply(null,t(s,o)),G=WH(n,i-L[0],r-L[1],h,p,d);return c=Uj(a,l,u),F=EP(t,G),P=EP(c,F),A=VH(F,E),N()}function N(){return D=M=null,O}return function(){return t=e.apply(this,arguments),O.invert=t.invert&&B,H()}}function v2(e){var t=0,n=dt/3,i=lK(e),r=i(t,n);return r.parallels=function(s){return arguments.length?i(t=s[0]*ut,n=s[1]*ut):[t*kn,n*kn]},r}function fRe(e){var t=Ge(e);function n(i,r){return[i*t,Be(r)/t]}return n.invert=function(i,r){return[i/t,_r(r*t)]},n}function pRe(e,t){var n=Be(e),i=(n+Be(t))/2;if(yt(i)<He)return fRe(e);var r=1+n*(2*i-n),s=cr(r)/i;function o(a,l){var u=cr(r-2*i*Be(l))/i;return[u*Be(a*=i),s-u*Ge(a)]}return o.invert=function(a,l){var u=s-l,c=Ws(a,yt(u))*Ms(u);return u*i<0&&(c-=dt*Ms(a)*Ms(u)),[c/i,_r((r-(a*a+u*u)*i*i)/(2*i))]},o}function xS(){return v2(pRe).scale(155.424).center([0,33.6442])}function uK(){return xS().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function gRe(e){var t=e.length;return{point:function(n,i){for(var r=-1;++r<t;)e[r].point(n,i)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function mRe(){var e,t,n=uK(),i,r=xS().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s,o=xS().rotate([157,0]).center([-3,19.9]).parallels([8,18]),a,l,u={point:function(h,p){l=[h,p]}};function c(h){var p=h[0],g=h[1];return l=null,i.point(p,g),l||(s.point(p,g),l)||(a.point(p,g),l)}c.invert=function(h){var p=n.scale(),g=n.translate(),m=(h[0]-g[0])/p,C=(h[1]-g[1])/p;return(C>=.12&&C<.234&&m>=-.425&&m<-.214?r:C>=.166&&C<.234&&m>=-.214&&m<-.115?o:n).invert(h)},c.stream=function(h){return e&&t===h?e:e=gRe([n.stream(t=h),r.stream(h),o.stream(h)])},c.precision=function(h){return arguments.length?(n.precision(h),r.precision(h),o.precision(h),d()):n.precision()},c.scale=function(h){return arguments.length?(n.scale(h),r.scale(h*.35),o.scale(h),c.translate(n.translate())):n.scale()},c.translate=function(h){if(!arguments.length)return n.translate();var p=n.scale(),g=+h[0],m=+h[1];return i=n.translate(h).clipExtent([[g-.455*p,m-.238*p],[g+.455*p,m+.238*p]]).stream(u),s=r.translate([g-.307*p,m+.201*p]).clipExtent([[g-.425*p+He,m+.12*p+He],[g-.214*p-He,m+.234*p-He]]).stream(u),a=o.translate([g-.205*p,m+.212*p]).clipExtent([[g-.214*p+He,m+.166*p+He],[g-.115*p-He,m+.234*p-He]]).stream(u),d()},c.fitExtent=function(h,p){return Mx(c,h,p)},c.fitSize=function(h,p){return p2(c,h,p)},c.fitWidth=function(h,p){return g2(c,h,p)},c.fitHeight=function(h,p){return m2(c,h,p)};function d(){return e=t=null,c}return c.scale(1070)}function cK(e){return function(t,n){var i=Ge(t),r=Ge(n),s=e(i*r);return s===1/0?[2,0]:[s*r*Be(t),s*Be(n)]}}function cC(e){return function(t,n){var i=cr(t*t+n*n),r=e(i),s=Be(r),o=Ge(r);return[Ws(t*s,i*o),_r(i&&n*s/i)]}}var dK=cK(function(e){return cr(2/(1+e))});dK.invert=cC(function(e){return 2*_r(e/2)});function vRe(){return $a(dK).scale(124.75).clipAngle(180-.001)}var hK=cK(function(e){return(e=_j(e))&&e/Be(e)});hK.invert=cC(function(e){return e});function CRe(){return $a(hK).scale(79.4188).clipAngle(180-.001)}function Tx(e,t){return[e,rS(d2((bn+t)/2))]}Tx.invert=function(e,t){return[e,2*lg(Ij(t))-bn]};function yRe(){return fK(Tx).scale(961/ur)}function fK(e){var t=$a(e),n=t.center,i=t.scale,r=t.translate,s=t.clipExtent,o=null,a,l,u;t.scale=function(d){return arguments.length?(i(d),c()):i()},t.translate=function(d){return arguments.length?(r(d),c()):r()},t.center=function(d){return arguments.length?(n(d),c()):n()},t.clipExtent=function(d){return arguments.length?(d==null?o=a=l=u=null:(o=+d[0][0],a=+d[0][1],l=+d[1][0],u=+d[1][1]),c()):o==null?null:[[o,a],[l,u]]};function c(){var d=dt*i(),h=t(Bxe(t.rotate()).invert([0,0]));return s(o==null?[[h[0]-d,h[1]-d],[h[0]+d,h[1]+d]]:e===Tx?[[Math.max(h[0]-d,o),a],[Math.min(h[0]+d,l),u]]:[[o,Math.max(h[1]-d,a)],[l,Math.min(h[1]+d,u)]])}return c()}function aw(e){return d2((bn+e)/2)}function wRe(e,t){var n=Ge(e),i=e===t?Be(e):rS(n/Ge(t))/rS(aw(t)/aw(e)),r=n*CA(aw(e),i)/i;if(!i)return Tx;function s(o,a){r>0?a<-bn+He&&(a=-bn+He):a>bn-He&&(a=bn-He);var l=r/CA(aw(a),i);return[l*Be(i*o),r-l*Ge(i*o)]}return s.invert=function(o,a){var l=r-a,u=Ms(i)*cr(o*o+l*l),c=Ws(o,yt(l))*Ms(l);return l*i<0&&(c-=dt*Ms(o)*Ms(l)),[c/i,2*lg(CA(r/u,1/i))-bn]},s}function bRe(){return v2(wRe).scale(109.5).parallels([30,30])}function RS(e,t){return[e,t]}RS.invert=RS;function SRe(){return $a(RS).scale(152.63)}function xRe(e,t){var n=Ge(e),i=e===t?Be(e):(n-Ge(t))/(t-e),r=n/i+e;if(yt(i)<He)return RS;function s(o,a){var l=r-a,u=i*o;return[l*Be(u),r-l*Ge(u)]}return s.invert=function(o,a){var l=r-a,u=Ws(o,yt(l))*Ms(l);return l*i<0&&(u-=dt*Ms(o)*Ms(l)),[u/i,r-Ms(i)*cr(o*o+l*l)]},s}function RRe(){return v2(xRe).scale(131.154).center([0,13.9389])}var vv=1.340264,Cv=-.081106,yv=893e-6,wv=.003796,ES=cr(3)/2,ERe=12;function pK(e,t){var n=_r(ES*Be(t)),i=n*n,r=i*i*i;return[e*Ge(n)/(ES*(vv+3*Cv*i+r*(7*yv+9*wv*i))),n*(vv+Cv*i+r*(yv+wv*i))]}pK.invert=function(e,t){for(var n=t,i=n*n,r=i*i*i,s=0,o,a,l;s<ERe&&(a=n*(vv+Cv*i+r*(yv+wv*i))-t,l=vv+3*Cv*i+r*(7*yv+9*wv*i),n-=o=a/l,i=n*n,r=i*i*i,!(yt(o)<gP));++s);return[ES*e*(vv+3*Cv*i+r*(7*yv+9*wv*i))/Ge(n),_r(Be(n)/ES)]};function FRe(){return $a(pK).scale(177.158)}function gK(e,t){var n=Ge(t),i=Ge(e)*n;return[n*Be(e)/i,Be(t)/i]}gK.invert=cC(lg);function ARe(){return $a(gK).scale(144.049).clipAngle(60)}function DRe(){var e=1,t=0,n=0,i=1,r=1,s=0,o,a,l=null,u,c,d,h=1,p=1,g=Px({point:function(x,E){var A=S([x,E]);this.stream.point(A[0],A[1])}}),m=Jv,C,y;function b(){return h=e*i,p=e*r,C=y=null,S}function S(x){var E=x[0]*h,A=x[1]*p;if(s){var F=A*o-E*a;E=E*o+A*a,A=F}return[E+t,A+n]}return S.invert=function(x){var E=x[0]-t,A=x[1]-n;if(s){var F=A*o+E*a;E=E*o-A*a,A=F}return[E/h,A/p]},S.stream=function(x){return C&&y===x?C:C=g(m(y=x))},S.postclip=function(x){return arguments.length?(m=x,l=u=c=d=null,b()):m},S.clipExtent=function(x){return arguments.length?(m=x==null?(l=u=c=d=null,Jv):Yj(l=+x[0][0],u=+x[0][1],c=+x[1][0],d=+x[1][1]),b()):l==null?null:[[l,u],[c,d]]},S.scale=function(x){return arguments.length?(e=+x,b()):e},S.translate=function(x){return arguments.length?(t=+x[0],n=+x[1],b()):[t,n]},S.angle=function(x){return arguments.length?(s=x%360*ut,a=Be(s),o=Ge(s),b()):s*kn},S.reflectX=function(x){return arguments.length?(i=x?-1:1,b()):i<0},S.reflectY=function(x){return arguments.length?(r=x?-1:1,b()):r<0},S.fitExtent=function(x,E){return Mx(S,x,E)},S.fitSize=function(x,E){return p2(S,x,E)},S.fitWidth=function(x,E){return g2(S,x,E)},S.fitHeight=function(x,E){return m2(S,x,E)},S}function mK(e,t){var n=t*t,i=n*n;return[e*(.8707-.131979*n+i*(-.013791+i*(.003971*n-.001529*i))),t*(1.007226+n*(.015085+i*(-.044475+.028874*n-.005916*i)))]}mK.invert=function(e,t){var n=t,i=25,r;do{var s=n*n,o=s*s;n-=r=(n*(1.007226+s*(.015085+o*(-.044475+.028874*s-.005916*o)))-t)/(1.007226+s*(.015085*3+o*(-.044475*7+.028874*9*s-.005916*11*o)))}while(yt(r)>He&&--i>0);return[e/(.8707+(s=n*n)*(-.131979+s*(-.013791+s*s*s*(.003971-.001529*s)))),n]};function kRe(){return $a(mK).scale(175.295)}function vK(e,t){return[Ge(t)*Be(e),Be(t)]}vK.invert=cC(_r);function PRe(){return $a(vK).scale(249.5).clipAngle(90+He)}function CK(e,t){var n=Ge(t),i=1+Ge(e)*n;return[n*Be(e)/i,Be(t)/i]}CK.invert=cC(function(e){return 2*lg(e)});function MRe(){return $a(CK).scale(250).clipAngle(142)}function yK(e,t){return[rS(d2((bn+t)/2)),-e]}yK.invert=function(e,t){return[-t,2*lg(Ij(e))-bn]};function TRe(){var e=fK(yK),t=e.center,n=e.rotate;return e.center=function(i){return arguments.length?t([-i[1],i[0]]):(i=t(),[i[1],-i[0]])},e.rotate=function(i){return arguments.length?n([i[0],i[1],i.length>2?i[2]+90:90]):(i=n(),[i[0],i[1],i[2]-90])},n([0,0,90]).scale(159.155)}var IRe=Math.abs,LP=Math.cos,FS=Math.sin,_Re=1e-6,wK=Math.PI,NP=wK/2,UH=ORe(2);function qH(e){return e>1?NP:e<-1?-NP:Math.asin(e)}function ORe(e){return e>0?Math.sqrt(e):0}function LRe(e,t){var n=e*FS(t),i=30,r;do t-=r=(t+FS(t)-n)/(1+LP(t));while(IRe(r)>_Re&&--i>0);return t/2}function NRe(e,t,n){function i(r,s){return[e*r*LP(s=LRe(n,s)),t*FS(s)]}return i.invert=function(r,s){return s=qH(s/t),[r/(e*LP(s)),qH((2*s+FS(2*s))/n)]},i}var $Re=NRe(UH/NP,UH,wK);function BRe(){return $a($Re).scale(169.529)}const GRe=aK(),$P=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function zRe(e,t){return function n(){const i=t();return i.type=e,i.path=aK().projection(i),i.copy=i.copy||function(){const r=n();return $P.forEach(s=>{i[s]&&r[s](i[s]())}),r.path.pointRadius(i.path.pointRadius()),r},O7(i)}}function C2(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(AS[e]=zRe(e,t),this):AS[e]||null}function bK(e){return e&&e.path||GRe}const AS={albers:uK,albersusa:mRe,azimuthalequalarea:vRe,azimuthalequidistant:CRe,conicconformal:bRe,conicequalarea:xS,conicequidistant:RRe,equalEarth:FRe,equirectangular:SRe,gnomonic:ARe,identity:DRe,mercator:yRe,mollweide:BRe,naturalEarth1:kRe,orthographic:PRe,stereographic:MRe,transversemercator:TRe};for(const e in AS)C2(e,AS[e]);function HRe(){}const ol=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function SK(){var e=1,t=1,n=a;function i(l,u){return u.map(c=>r(l,c))}function r(l,u){var c=[],d=[];return s(l,u,h=>{n(h,l,u),VRe(h)>0?c.push([h]):d.push(h)}),d.forEach(h=>{for(var p=0,g=c.length,m;p<g;++p)if(WRe((m=c[p])[0],h)!==-1){m.push(h);return}}),{type:"MultiPolygon",value:u,coordinates:c}}function s(l,u,c){var d=[],h=[],p,g,m,C,y,b;for(p=g=-1,C=l[0]>=u,ol[C<<1].forEach(S);++p<e-1;)m=C,C=l[p+1]>=u,ol[m|C<<1].forEach(S);for(ol[C<<0].forEach(S);++g<t-1;){for(p=-1,C=l[g*e+e]>=u,y=l[g*e]>=u,ol[C<<1|y<<2].forEach(S);++p<e-1;)m=C,C=l[g*e+e+p+1]>=u,b=y,y=l[g*e+p+1]>=u,ol[m|C<<1|y<<2|b<<3].forEach(S);ol[C|y<<3].forEach(S)}for(p=-1,y=l[g*e]>=u,ol[y<<2].forEach(S);++p<e-1;)b=y,y=l[g*e+p+1]>=u,ol[y<<2|b<<3].forEach(S);ol[y<<3].forEach(S);function S(x){var E=[x[0][0]+p,x[0][1]+g],A=[x[1][0]+p,x[1][1]+g],F=o(E),P=o(A),D,M;(D=h[F])?(M=d[P])?(delete h[D.end],delete d[M.start],D===M?(D.ring.push(A),c(D.ring)):d[D.start]=h[M.end]={start:D.start,end:M.end,ring:D.ring.concat(M.ring)}):(delete h[D.end],D.ring.push(A),h[D.end=P]=D):(D=d[P])?(M=h[F])?(delete d[D.start],delete h[M.end],D===M?(D.ring.push(A),c(D.ring)):d[M.start]=h[D.end]={start:M.start,end:D.end,ring:M.ring.concat(D.ring)}):(delete d[D.start],D.ring.unshift(E),d[D.start=F]=D):d[F]=h[P]={start:F,end:P,ring:[E,A]}}}function o(l){return l[0]*2+l[1]*(e+1)*4}function a(l,u,c){l.forEach(d=>{var h=d[0],p=d[1],g=h|0,m=p|0,C,y=u[m*e+g];h>0&&h<e&&g===h&&(C=u[m*e+g-1],d[0]=h+(c-C)/(y-C)-.5),p>0&&p<t&&m===p&&(C=u[(m-1)*e+g],d[1]=p+(c-C)/(y-C)-.5)})}return i.contour=r,i.size=function(l){if(!arguments.length)return[e,t];var u=Math.floor(l[0]),c=Math.floor(l[1]);return u>=0&&c>=0||te("invalid size"),e=u,t=c,i},i.smooth=function(l){return arguments.length?(n=l?a:HRe,i):n===a},i}function VRe(e){for(var t=0,n=e.length,i=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)i+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return i}function WRe(e,t){for(var n=-1,i=t.length,r;++n<i;)if(r=URe(e,t[n]))return r;return 0}function URe(e,t){for(var n=t[0],i=t[1],r=-1,s=0,o=e.length,a=o-1;s<o;a=s++){var l=e[s],u=l[0],c=l[1],d=e[a],h=d[0],p=d[1];if(qRe(l,d,t))return 0;c>i!=p>i&&n<(h-u)*(i-c)/(p-c)+u&&(r=-r)}return r}function qRe(e,t,n){var i;return jRe(e,t,n)&&KRe(e[i=+(e[0]===t[0])],n[i],t[i])}function jRe(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function KRe(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function xK(e,t,n){return function(i){var r=Ea(i),s=n?Math.min(r[0],0):r[0],o=r[1],a=o-s,l=t?Ju(s,o,e):a/(e+1);return Ar(s+l,o,l)}}function y2(e){Q.call(this,null,e)}y2.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};me(y2,Q,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=e.field||zi,s=SK().smooth(e.smooth!==!1),o=e.thresholds||YRe(i,r,e),a=e.as===null?null:e.as||"contour",l=[];return i.forEach(u=>{const c=r(u),d=s.size([c.width,c.height])(c.values,ne(o)?o:o(c.values));XRe(d,c,u,e),d.forEach(h=>{l.push(K1(u,It(a!=null?{[a]:h}:h)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}});function YRe(e,t,n){const i=xK(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?i:i(e.map(r=>Ad(t(r).values)))}function XRe(e,t,n,i){let r=i.scale||t.scale,s=i.translate||t.translate;if(ot(r)&&(r=r(n,i)),ot(s)&&(s=s(n,i)),(r===1||r==null)&&!s)return;const o=(kt(r)?r:r[0])||1,a=(kt(r)?r:r[1])||1,l=s&&s[0]||0,u=s&&s[1]||0;e.forEach(RK(t,o,a,l,u))}function RK(e,t,n,i,r){const s=e.x1||0,o=e.y1||0,a=t*n<0;function l(d){d.forEach(u)}function u(d){a&&d.reverse(),d.forEach(c)}function c(d){d[0]=(d[0]-s)*t+i,d[1]=(d[1]-o)*n+r}return function(d){return d.coordinates.forEach(l),d}}function jH(e,t,n){const i=e>=0?e:fI(t,n);return Math.round((Math.sqrt(4*i*i+1)-1)/2)}function xA(e){return ot(e)?e:Hi(+e)}function EK(){var e=l=>l[0],t=l=>l[1],n=Kp,i=[-1,-1],r=960,s=500,o=2;function a(l,u){const c=jH(i[0],l,e)>>o,d=jH(i[1],l,t)>>o,h=c?c+2:0,p=d?d+2:0,g=2*h+(r>>o),m=2*p+(s>>o),C=new Float32Array(g*m),y=new Float32Array(g*m);let b=C;l.forEach(x=>{const E=h+(+e(x)>>o),A=p+(+t(x)>>o);E>=0&&E<g&&A>=0&&A<m&&(C[E+A*g]+=+n(x))}),c>0&&d>0?(uf(g,m,C,y,c),cf(g,m,y,C,d),uf(g,m,C,y,c),cf(g,m,y,C,d),uf(g,m,C,y,c),cf(g,m,y,C,d)):c>0?(uf(g,m,C,y,c),uf(g,m,y,C,c),uf(g,m,C,y,c),b=y):d>0&&(cf(g,m,C,y,d),cf(g,m,y,C,d),cf(g,m,C,y,d),b=y);const S=u?Math.pow(2,-2*o):1/$8(b);for(let x=0,E=g*m;x<E;++x)b[x]*=S;return{values:b,scale:1<<o,width:g,height:m,x1:h,y1:p,x2:h+(r>>o),y2:p+(s>>o)}}return a.x=function(l){return arguments.length?(e=xA(l),a):e},a.y=function(l){return arguments.length?(t=xA(l),a):t},a.weight=function(l){return arguments.length?(n=xA(l),a):n},a.size=function(l){if(!arguments.length)return[r,s];var u=+l[0],c=+l[1];return u>=0&&c>=0||te("invalid size"),r=u,s=c,a},a.cellSize=function(l){return arguments.length?((l=+l)>=1||te("invalid cell size"),o=Math.floor(Math.log(l)/Math.LN2),a):1<<o},a.bandwidth=function(l){return arguments.length?(l=xe(l),l.length===1&&(l=[+l[0],+l[0]]),l.length!==2&&te("invalid bandwidth"),i=l,a):i},a}function uf(e,t,n,i,r){const s=(r<<1)+1;for(let o=0;o<t;++o)for(let a=0,l=0;a<e+r;++a)a<e&&(l+=n[a+o*e]),a>=r&&(a>=s&&(l-=n[a-s+o*e]),i[a-r+o*e]=l/Math.min(a+1,e-1+s-a,s))}function cf(e,t,n,i,r){const s=(r<<1)+1;for(let o=0;o<e;++o)for(let a=0,l=0;a<t+r;++a)a<t&&(l+=n[o+a*e]),a>=r&&(a>=s&&(l-=n[o+(a-s)*e]),i[o+(a-r)*e]=l/Math.min(a+1,t-1+s-a,s))}function w2(e){Q.call(this,null,e)}w2.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const QRe=["x","y","weight","size","cellSize","bandwidth"];function FK(e,t){return QRe.forEach(n=>t[n]!=null?e[n](t[n]):0),e}me(w2,Q,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=ZRe(i,e.groupby),s=(e.groupby||[]).map(xn),o=FK(EK(),e),a=e.as||"grid",l=[];function u(c,d){for(let h=0;h<s.length;++h)c[s[h]]=d[h];return c}return l=r.map(c=>It(u({[a]:o(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}});function ZRe(e,t){var n=[],i=c=>c(a),r,s,o,a,l,u;if(t==null)n.push(e);else for(r={},s=0,o=e.length;s<o;++s)a=e[s],l=t.map(i),u=r[l],u||(r[l]=u=[],u.dims=l,n.push(u)),u.push(a);return n}function b2(e){Q.call(this,null,e)}b2.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};me(b2,Q,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=SK().smooth(e.smooth!==!1),r=e.values,s=e.thresholds||xK(e.count||10,e.nice,!!r),o=e.size,a,l;return r||(r=t.materialize(t.SOURCE).source,a=FK(EK(),e)(r,!0),l=RK(a,a.scale||1,a.scale||1,0,0),o=[a.width,a.height],r=a.values),s=ne(s)?s:s(r),r=i.size(o)(r,s),l&&r.forEach(l),this.value&&(n.rem=this.value),this.value=n.source=n.add=(r||[]).map(It),n}});const BP="Feature",S2="FeatureCollection",JRe="MultiPoint";function x2(e){Q.call(this,null,e)}x2.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};me(x2,Q,{transform(e,t){var n=this._features,i=this._points,r=e.fields,s=r&&r[0],o=r&&r[1],a=e.geojson||!r&&zi,l=t.ADD,u;u=e.modified()||t.changed(t.REM)||t.modified(Li(a))||s&&t.modified(Li(s))||o&&t.modified(Li(o)),(!this.value||u)&&(l=t.SOURCE,this._features=n=[],this._points=i=[]),a&&t.visit(l,c=>n.push(a(c))),s&&o&&(t.visit(l,c=>{var d=s(c),h=o(c);d!=null&&h!=null&&(d=+d)===d&&(h=+h)===h&&i.push([d,h])}),n=n.concat({type:BP,geometry:{type:JRe,coordinates:i}})),this.value={type:S2,features:n}}});function R2(e){Q.call(this,null,e)}R2.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};me(R2,Q,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.field||zi,s=e.as||"path",o=n.SOURCE;!i||e.modified()?(this.value=i=bK(e.projection),n.materialize().reflow()):o=r===zi||t.modified(r.fields)?n.ADD_MOD:n.ADD;const a=eEe(i,e.pointRadius);return n.visit(o,l=>l[s]=i(r(l))),i.pointRadius(a),n.modifies(s)}});function eEe(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function E2(e){Q.call(this,null,e)}E2.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};me(E2,Q,{transform(e,t){var n=e.projection,i=e.fields[0],r=e.fields[1],s=e.as||["x","y"],o=s[0],a=s[1],l;function u(c){const d=n([i(c),r(c)]);d?(c[o]=d[0],c[a]=d[1]):(c[o]=void 0,c[a]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,u):(l=t.modified(i.fields)||t.modified(r.fields),t.visit(l?t.ADD_MOD:t.ADD,u)),t.modifies(s)}});function F2(e){Q.call(this,null,e)}F2.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};me(F2,Q,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.as||"shape",s=n.ADD;return(!i||e.modified())&&(this.value=i=tEe(bK(e.projection),e.field||Gs("datum"),e.pointRadius),n.materialize().reflow(),s=n.SOURCE),n.visit(s,o=>o[r]=i),n.modifies(r)}});function tEe(e,t,n){const i=n==null?r=>e(t(r)):r=>{var s=e.pointRadius(),o=e.pointRadius(n)(t(r));return e.pointRadius(s),o};return i.context=r=>(e.context(r),i),i}function A2(e){Q.call(this,[],e),this.generator=Yxe()}A2.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};me(A2,Q,{transform(e,t){var n=this.value,i=this.generator,r;if(!n.length||e.modified())for(const s in e)ot(i[s])&&i[s](e[s]);return r=i(),n.length?t.mod.push(IU(n[0],r)):t.add.push(It(r)),n[0]=r,t}});function D2(e){Q.call(this,null,e)}D2.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};me(D2,Q,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,i=e.resolve==="shared",r=e.field||zi,s=iEe(e.opacity,e),o=nEe(e.color,e),a=e.as||"image",l={$x:0,$y:0,$value:0,$max:i?Ad(n.map(u=>Ad(r(u).values))):0};return n.forEach(u=>{const c=r(u),d=it({},u,l);i||(d.$max=Ad(c.values||[])),u[a]=rEe(c,d,o.dep?o:Hi(o(d)),s.dep?s:Hi(s(d)))}),t.reflow(!0).modifies(a)}});function nEe(e,t){let n;return ot(e)?(n=i=>nc(e(i,t)),n.dep=AK(e)):n=Hi(nc(e||"#888")),n}function iEe(e,t){let n;return ot(e)?(n=i=>e(i,t),n.dep=AK(e)):e?n=Hi(e):(n=i=>i.$value/i.$max||0,n.dep=!0),n}function AK(e){if(!ot(e))return!1;const t=Fo(Li(e));return t.$x||t.$y||t.$value||t.$max}function rEe(e,t,n,i){const r=e.width,s=e.height,o=e.x1||0,a=e.y1||0,l=e.x2||r,u=e.y2||s,c=e.values,d=c?C=>c[C]:Tu,h=ju(l-o,u-a),p=h.getContext("2d"),g=p.getImageData(0,0,l-o,u-a),m=g.data;for(let C=a,y=0;C<u;++C){t.$y=C-a;for(let b=o,S=C*r;b<l;++b,y+=4){t.$x=b-o,t.$value=d(b+S);const x=n(t);m[y+0]=x.r,m[y+1]=x.g,m[y+2]=x.b,m[y+3]=~~(255*i(t))}}return p.putImageData(g,0,0),h}function DK(e){Q.call(this,null,e),this.modified(!0)}me(DK,Q,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=oEe(e.type),$P.forEach(i=>{e[i]!=null&&KH(n,i,e[i])})):$P.forEach(i=>{e.modified(i)&&KH(n,i,e[i])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&sEe(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function sEe(e,t){const n=aEe(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function oEe(e){const t=C2((e||"mercator").toLowerCase());return t||te("Unrecognized projection type: "+e),t()}function KH(e,t,n){ot(e[t])&&e[t](n)}function aEe(e){return e=xe(e),e.length===1?e[0]:{type:S2,features:e.reduce((t,n)=>t.concat(lEe(n)),[])}}function lEe(e){return e.type===S2?e.features:xe(e).filter(t=>t!=null).map(t=>t.type===BP?t:{type:BP,geometry:t})}const uEe=Object.freeze(Object.defineProperty({__proto__:null,contour:b2,geojson:x2,geopath:R2,geopoint:E2,geoshape:F2,graticule:A2,heatmap:D2,isocontour:y2,kde2d:w2,projection:DK},Symbol.toStringTag,{value:"Module"}));function cEe(e,t){var n,i=1;e==null&&(e=0),t==null&&(t=0);function r(){var s,o=n.length,a,l=0,u=0;for(s=0;s<o;++s)a=n[s],l+=a.x,u+=a.y;for(l=(l/o-e)*i,u=(u/o-t)*i,s=0;s<o;++s)a=n[s],a.x-=l,a.y-=u}return r.initialize=function(s){n=s},r.x=function(s){return arguments.length?(e=+s,r):e},r.y=function(s){return arguments.length?(t=+s,r):t},r.strength=function(s){return arguments.length?(i=+s,r):i},r}function dEe(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return kK(this.cover(t,n),t,n,e)}function kK(e,t,n,i){if(isNaN(t)||isNaN(n))return e;var r,s=e._root,o={data:i},a=e._x0,l=e._y0,u=e._x1,c=e._y1,d,h,p,g,m,C,y,b;if(!s)return e._root=o,e;for(;s.length;)if((m=t>=(d=(a+u)/2))?a=d:u=d,(C=n>=(h=(l+c)/2))?l=h:c=h,r=s,!(s=s[y=C<<1|m]))return r[y]=o,e;if(p=+e._x.call(null,s.data),g=+e._y.call(null,s.data),t===p&&n===g)return o.next=s,r?r[y]=o:e._root=o,e;do r=r?r[y]=new Array(4):e._root=new Array(4),(m=t>=(d=(a+u)/2))?a=d:u=d,(C=n>=(h=(l+c)/2))?l=h:c=h;while((y=C<<1|m)===(b=(g>=h)<<1|p>=d));return r[b]=s,r[y]=o,e}function hEe(e){var t,n,i=e.length,r,s,o=new Array(i),a=new Array(i),l=1/0,u=1/0,c=-1/0,d=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(s=+this._y.call(null,t))||(o[n]=r,a[n]=s,r<l&&(l=r),r>c&&(c=r),s<u&&(u=s),s>d&&(d=s));if(l>c||u>d)return this;for(this.cover(l,u).cover(c,d),n=0;n<i;++n)kK(this,o[n],a[n],e[n]);return this}function fEe(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,i=this._y0,r=this._x1,s=this._y1;if(isNaN(n))r=(n=Math.floor(e))+1,s=(i=Math.floor(t))+1;else{for(var o=r-n||1,a=this._root,l,u;n>e||e>=r||i>t||t>=s;)switch(u=(t<i)<<1|e<n,l=new Array(4),l[u]=a,a=l,o*=2,u){case 0:r=n+o,s=i+o;break;case 1:n=r-o,s=i+o;break;case 2:r=n+o,i=s-o;break;case 3:n=r-o,i=s-o;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=i,this._x1=r,this._y1=s,this}function pEe(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function gEe(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function nr(e,t,n,i,r){this.node=e,this.x0=t,this.y0=n,this.x1=i,this.y1=r}function mEe(e,t,n){var i,r=this._x0,s=this._y0,o,a,l,u,c=this._x1,d=this._y1,h=[],p=this._root,g,m;for(p&&h.push(new nr(p,r,s,c,d)),n==null?n=1/0:(r=e-n,s=t-n,c=e+n,d=t+n,n*=n);g=h.pop();)if(!(!(p=g.node)||(o=g.x0)>c||(a=g.y0)>d||(l=g.x1)<r||(u=g.y1)<s))if(p.length){var C=(o+l)/2,y=(a+u)/2;h.push(new nr(p[3],C,y,l,u),new nr(p[2],o,y,C,u),new nr(p[1],C,a,l,y),new nr(p[0],o,a,C,y)),(m=(t>=y)<<1|e>=C)&&(g=h[h.length-1],h[h.length-1]=h[h.length-1-m],h[h.length-1-m]=g)}else{var b=e-+this._x.call(null,p.data),S=t-+this._y.call(null,p.data),x=b*b+S*S;if(x<n){var E=Math.sqrt(n=x);r=e-E,s=t-E,c=e+E,d=t+E,i=p.data}}return i}function vEe(e){if(isNaN(c=+this._x.call(null,e))||isNaN(d=+this._y.call(null,e)))return this;var t,n=this._root,i,r,s,o=this._x0,a=this._y0,l=this._x1,u=this._y1,c,d,h,p,g,m,C,y;if(!n)return this;if(n.length)for(;;){if((g=c>=(h=(o+l)/2))?o=h:l=h,(m=d>=(p=(a+u)/2))?a=p:u=p,t=n,!(n=n[C=m<<1|g]))return this;if(!n.length)break;(t[C+1&3]||t[C+2&3]||t[C+3&3])&&(i=t,y=C)}for(;n.data!==e;)if(r=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,r?(s?r.next=s:delete r.next,this):t?(s?t[C]=s:delete t[C],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(i?i[y]=n:this._root=n),this):(this._root=s,this)}function CEe(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function yEe(){return this._root}function wEe(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function bEe(e){var t=[],n,i=this._root,r,s,o,a,l;for(i&&t.push(new nr(i,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(i=n.node,s=n.x0,o=n.y0,a=n.x1,l=n.y1)&&i.length){var u=(s+a)/2,c=(o+l)/2;(r=i[3])&&t.push(new nr(r,u,c,a,l)),(r=i[2])&&t.push(new nr(r,s,c,u,l)),(r=i[1])&&t.push(new nr(r,u,o,a,c)),(r=i[0])&&t.push(new nr(r,s,o,u,c))}return this}function SEe(e){var t=[],n=[],i;for(this._root&&t.push(new nr(this._root,this._x0,this._y0,this._x1,this._y1));i=t.pop();){var r=i.node;if(r.length){var s,o=i.x0,a=i.y0,l=i.x1,u=i.y1,c=(o+l)/2,d=(a+u)/2;(s=r[0])&&t.push(new nr(s,o,a,c,d)),(s=r[1])&&t.push(new nr(s,c,a,l,d)),(s=r[2])&&t.push(new nr(s,o,d,c,u)),(s=r[3])&&t.push(new nr(s,c,d,l,u))}n.push(i)}for(;i=n.pop();)e(i.node,i.x0,i.y0,i.x1,i.y1);return this}function xEe(e){return e[0]}function REe(e){return arguments.length?(this._x=e,this):this._x}function EEe(e){return e[1]}function FEe(e){return arguments.length?(this._y=e,this):this._y}function k2(e,t,n){var i=new P2(t??xEe,n??EEe,NaN,NaN,NaN,NaN);return e==null?i:i.addAll(e)}function P2(e,t,n,i,r,s){this._x=e,this._y=t,this._x0=n,this._y0=i,this._x1=r,this._y1=s,this._root=void 0}function YH(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var hr=k2.prototype=P2.prototype;hr.copy=function(){var e=new P2(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,i;if(!t)return e;if(!t.length)return e._root=YH(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var r=0;r<4;++r)(i=t.source[r])&&(i.length?n.push({source:i,target:t.target[r]=new Array(4)}):t.target[r]=YH(i));return e};hr.add=dEe;hr.addAll=hEe;hr.cover=fEe;hr.data=pEe;hr.extent=gEe;hr.find=mEe;hr.remove=vEe;hr.removeAll=CEe;hr.root=yEe;hr.size=wEe;hr.visit=bEe;hr.visitAfter=SEe;hr.x=REe;hr.y=FEe;function rr(e){return function(){return e}}function Gu(e){return(e()-.5)*1e-6}function AEe(e){return e.x+e.vx}function DEe(e){return e.y+e.vy}function kEe(e){var t,n,i,r=1,s=1;typeof e!="function"&&(e=rr(e==null?1:+e));function o(){for(var u,c=t.length,d,h,p,g,m,C,y=0;y<s;++y)for(d=k2(t,AEe,DEe).visitAfter(a),u=0;u<c;++u)h=t[u],m=n[h.index],C=m*m,p=h.x+h.vx,g=h.y+h.vy,d.visit(b);function b(S,x,E,A,F){var P=S.data,D=S.r,M=m+D;if(P){if(P.index>h.index){var O=p-P.x-P.vx,B=g-P.y-P.vy,H=O*O+B*B;H<M*M&&(O===0&&(O=Gu(i),H+=O*O),B===0&&(B=Gu(i),H+=B*B),H=(M-(H=Math.sqrt(H)))/H*r,h.vx+=(O*=H)*(M=(D*=D)/(C+D)),h.vy+=(B*=H)*M,P.vx-=O*(M=1-M),P.vy-=B*M)}return}return x>p+M||A<p-M||E>g+M||F<g-M}}function a(u){if(u.data)return u.r=n[u.data.index];for(var c=u.r=0;c<4;++c)u[c]&&u[c].r>u.r&&(u.r=u[c].r)}function l(){if(t){var u,c=t.length,d;for(n=new Array(c),u=0;u<c;++u)d=t[u],n[d.index]=+e(d,u,t)}}return o.initialize=function(u,c){t=u,i=c,l()},o.iterations=function(u){return arguments.length?(s=+u,o):s},o.strength=function(u){return arguments.length?(r=+u,o):r},o.radius=function(u){return arguments.length?(e=typeof u=="function"?u:rr(+u),l(),o):e},o}function PEe(e){return e.index}function XH(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function MEe(e){var t=PEe,n=d,i,r=rr(30),s,o,a,l,u,c=1;e==null&&(e=[]);function d(C){return 1/Math.min(a[C.source.index],a[C.target.index])}function h(C){for(var y=0,b=e.length;y<c;++y)for(var S=0,x,E,A,F,P,D,M;S<b;++S)x=e[S],E=x.source,A=x.target,F=A.x+A.vx-E.x-E.vx||Gu(u),P=A.y+A.vy-E.y-E.vy||Gu(u),D=Math.sqrt(F*F+P*P),D=(D-s[S])/D*C*i[S],F*=D,P*=D,A.vx-=F*(M=l[S]),A.vy-=P*M,E.vx+=F*(M=1-M),E.vy+=P*M}function p(){if(o){var C,y=o.length,b=e.length,S=new Map(o.map((E,A)=>[t(E,A,o),E])),x;for(C=0,a=new Array(y);C<b;++C)x=e[C],x.index=C,typeof x.source!="object"&&(x.source=XH(S,x.source)),typeof x.target!="object"&&(x.target=XH(S,x.target)),a[x.source.index]=(a[x.source.index]||0)+1,a[x.target.index]=(a[x.target.index]||0)+1;for(C=0,l=new Array(b);C<b;++C)x=e[C],l[C]=a[x.source.index]/(a[x.source.index]+a[x.target.index]);i=new Array(b),g(),s=new Array(b),m()}}function g(){if(o)for(var C=0,y=e.length;C<y;++C)i[C]=+n(e[C],C,e)}function m(){if(o)for(var C=0,y=e.length;C<y;++C)s[C]=+r(e[C],C,e)}return h.initialize=function(C,y){o=C,u=y,p()},h.links=function(C){return arguments.length?(e=C,p(),h):e},h.id=function(C){return arguments.length?(t=C,h):t},h.iterations=function(C){return arguments.length?(c=+C,h):c},h.strength=function(C){return arguments.length?(n=typeof C=="function"?C:rr(+C),g(),h):n},h.distance=function(C){return arguments.length?(r=typeof C=="function"?C:rr(+C),m(),h):r},h}var TEe={value:()=>{}};function PK(){for(var e=0,t=arguments.length,n={},i;e<t;++e){if(!(i=arguments[e]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new nb(n)}function nb(e){this._=e}function IEe(e,t){return e.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}nb.prototype=PK.prototype={constructor:nb,on:function(e,t){var n=this._,i=IEe(e+"",n),r,s=-1,o=i.length;if(arguments.length<2){for(;++s<o;)if((r=(e=i[s]).type)&&(r=_Ee(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(r=(e=i[s]).type)n[r]=QH(n[r],e.name,t);else if(t==null)for(r in n)n[r]=QH(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new nb(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,s;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],i=0,r=s.length;i<r;++i)s[i].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],r=0,s=i.length;r<s;++r)i[r].value.apply(t,n)}};function _Ee(e,t){for(var n=0,i=e.length,r;n<i;++n)if((r=e[n]).name===t)return r.value}function QH(e,t,n){for(var i=0,r=e.length;i<r;++i)if(e[i].name===t){e[i]=TEe,e=e.slice(0,i).concat(e.slice(i+1));break}return n!=null&&e.push({name:t,value:n}),e}var yp=0,Zm=0,gm=0,MK=1e3,DS,Jm,kS=0,Qd=0,Ix=0,n0=typeof performance=="object"&&performance.now?performance:Date,TK=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function M2(){return Qd||(TK(OEe),Qd=n0.now()+Ix)}function OEe(){Qd=0}function PS(){this._call=this._time=this._next=null}PS.prototype=IK.prototype={constructor:PS,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?M2():+n)+(t==null?0:+t),!this._next&&Jm!==this&&(Jm?Jm._next=this:DS=this,Jm=this),this._call=e,this._time=n,GP()},stop:function(){this._call&&(this._call=null,this._time=1/0,GP())}};function IK(e,t,n){var i=new PS;return i.restart(e,t,n),i}function LEe(){M2(),++yp;for(var e=DS,t;e;)(t=Qd-e._time)>=0&&e._call.call(void 0,t),e=e._next;--yp}function ZH(){Qd=(kS=n0.now())+Ix,yp=Zm=0;try{LEe()}finally{yp=0,$Ee(),Qd=0}}function NEe(){var e=n0.now(),t=e-kS;t>MK&&(Ix-=t,kS=e)}function $Ee(){for(var e,t=DS,n,i=1/0;t;)t._call?(i>t._time&&(i=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:DS=n);Jm=e,GP(i)}function GP(e){if(!yp){Zm&&(Zm=clearTimeout(Zm));var t=e-Qd;t>24?(e<1/0&&(Zm=setTimeout(ZH,e-n0.now()-Ix)),gm&&(gm=clearInterval(gm))):(gm||(kS=n0.now(),gm=setInterval(NEe,MK)),yp=1,TK(ZH))}}function BEe(e,t,n){var i=new PS,r=t;return t==null?(i.restart(e,t,n),i):(i._restart=i.restart,i.restart=function(s,o,a){o=+o,a=a==null?M2():+a,i._restart(function l(u){u+=r,i._restart(l,r+=o,a),s(u)},o,a)},i.restart(e,t,n),i)}const GEe=1664525,zEe=1013904223,JH=4294967296;function HEe(){let e=1;return()=>(e=(GEe*e+zEe)%JH)/JH}function VEe(e){return e.x}function WEe(e){return e.y}var UEe=10,qEe=Math.PI*(3-Math.sqrt(5));function jEe(e){var t,n=1,i=.001,r=1-Math.pow(i,1/300),s=0,o=.6,a=new Map,l=IK(d),u=PK("tick","end"),c=HEe();e==null&&(e=[]);function d(){h(),u.call("tick",t),n<i&&(l.stop(),u.call("end",t))}function h(m){var C,y=e.length,b;m===void 0&&(m=1);for(var S=0;S<m;++S)for(n+=(s-n)*r,a.forEach(function(x){x(n)}),C=0;C<y;++C)b=e[C],b.fx==null?b.x+=b.vx*=o:(b.x=b.fx,b.vx=0),b.fy==null?b.y+=b.vy*=o:(b.y=b.fy,b.vy=0);return t}function p(){for(var m=0,C=e.length,y;m<C;++m){if(y=e[m],y.index=m,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var b=UEe*Math.sqrt(.5+m),S=m*qEe;y.x=b*Math.cos(S),y.y=b*Math.sin(S)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function g(m){return m.initialize&&m.initialize(e,c),m}return p(),t={tick:h,restart:function(){return l.restart(d),t},stop:function(){return l.stop(),t},nodes:function(m){return arguments.length?(e=m,p(),a.forEach(g),t):e},alpha:function(m){return arguments.length?(n=+m,t):n},alphaMin:function(m){return arguments.length?(i=+m,t):i},alphaDecay:function(m){return arguments.length?(r=+m,t):+r},alphaTarget:function(m){return arguments.length?(s=+m,t):s},velocityDecay:function(m){return arguments.length?(o=1-m,t):1-o},randomSource:function(m){return arguments.length?(c=m,a.forEach(g),t):c},force:function(m,C){return arguments.length>1?(C==null?a.delete(m):a.set(m,g(C)),t):a.get(m)},find:function(m,C,y){var b=0,S=e.length,x,E,A,F,P;for(y==null?y=1/0:y*=y,b=0;b<S;++b)F=e[b],x=m-F.x,E=C-F.y,A=x*x+E*E,A<y&&(P=F,y=A);return P},on:function(m,C){return arguments.length>1?(u.on(m,C),t):u.on(m)}}}function KEe(){var e,t,n,i,r=rr(-30),s,o=1,a=1/0,l=.81;function u(p){var g,m=e.length,C=k2(e,VEe,WEe).visitAfter(d);for(i=p,g=0;g<m;++g)t=e[g],C.visit(h)}function c(){if(e){var p,g=e.length,m;for(s=new Array(g),p=0;p<g;++p)m=e[p],s[m.index]=+r(m,p,e)}}function d(p){var g=0,m,C,y=0,b,S,x;if(p.length){for(b=S=x=0;x<4;++x)(m=p[x])&&(C=Math.abs(m.value))&&(g+=m.value,y+=C,b+=C*m.x,S+=C*m.y);p.x=b/y,p.y=S/y}else{m=p,m.x=m.data.x,m.y=m.data.y;do g+=s[m.data.index];while(m=m.next)}p.value=g}function h(p,g,m,C){if(!p.value)return!0;var y=p.x-t.x,b=p.y-t.y,S=C-g,x=y*y+b*b;if(S*S/l<x)return x<a&&(y===0&&(y=Gu(n),x+=y*y),b===0&&(b=Gu(n),x+=b*b),x<o&&(x=Math.sqrt(o*x)),t.vx+=y*p.value*i/x,t.vy+=b*p.value*i/x),!0;if(p.length||x>=a)return;(p.data!==t||p.next)&&(y===0&&(y=Gu(n),x+=y*y),b===0&&(b=Gu(n),x+=b*b),x<o&&(x=Math.sqrt(o*x)));do p.data!==t&&(S=s[p.data.index]*i/x,t.vx+=y*S,t.vy+=b*S);while(p=p.next)}return u.initialize=function(p,g){e=p,n=g,c()},u.strength=function(p){return arguments.length?(r=typeof p=="function"?p:rr(+p),c(),u):r},u.distanceMin=function(p){return arguments.length?(o=p*p,u):Math.sqrt(o)},u.distanceMax=function(p){return arguments.length?(a=p*p,u):Math.sqrt(a)},u.theta=function(p){return arguments.length?(l=p*p,u):Math.sqrt(l)},u}function YEe(e){var t=rr(.1),n,i,r;typeof e!="function"&&(e=rr(e==null?0:+e));function s(a){for(var l=0,u=n.length,c;l<u;++l)c=n[l],c.vx+=(r[l]-c.x)*i[l]*a}function o(){if(n){var a,l=n.length;for(i=new Array(l),r=new Array(l),a=0;a<l;++a)i[a]=isNaN(r[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return s.initialize=function(a){n=a,o()},s.strength=function(a){return arguments.length?(t=typeof a=="function"?a:rr(+a),o(),s):t},s.x=function(a){return arguments.length?(e=typeof a=="function"?a:rr(+a),o(),s):e},s}function XEe(e){var t=rr(.1),n,i,r;typeof e!="function"&&(e=rr(e==null?0:+e));function s(a){for(var l=0,u=n.length,c;l<u;++l)c=n[l],c.vy+=(r[l]-c.y)*i[l]*a}function o(){if(n){var a,l=n.length;for(i=new Array(l),r=new Array(l),a=0;a<l;++a)i[a]=isNaN(r[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return s.initialize=function(a){n=a,o()},s.strength=function(a){return arguments.length?(t=typeof a=="function"?a:rr(+a),o(),s):t},s.y=function(a){return arguments.length?(e=typeof a=="function"?a:rr(+a),o(),s):e},s}const eV={center:cEe,collide:kEe,nbody:KEe,link:MEe,x:YEe,y:XEe},ev="forces",zP=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],QEe=["static","iterations"],_K=["x","y","vx","vy"];function T2(e){Q.call(this,null,e)}T2.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30,expr:!0},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:_K}]};me(T2,Q,{transform(e,t){var n=this.value,i=t.changed(t.ADD_REM),r=e.modified(zP),s=e.iterations||300;if(n?(i&&(t.modifies("index"),n.nodes(t.source)),(r||t.changed(t.MOD))&&OK(n,e,0,t)):(this.value=n=JEe(t.source,e),n.on("tick",ZEe(t.dataflow,this)),e.static||(i=!0,n.tick()),t.modifies("index")),r||i||e.modified(QEe)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/s)),e.static)for(n.stop();--s>=0;)n.tick();else if(n.stopped()&&n.restart(),!i)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let a=this._argops,l=0,u=a.length,c;l<u;++l)if(c=a[l],!(c.name!==ev||c.op._argval.force!=="link")){for(var i=c.op._argops,r=0,s=i.length,o;r<s;++r)if(i[r].name==="links"&&(o=i[r].op.source)){n.pulse(o,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(_K)}});function ZEe(e,t){return()=>e.touch(t).run()}function JEe(e,t){const n=jEe(e),i=n.stop,r=n.restart;let s=!1;return n.stopped=()=>s,n.restart=()=>(s=!1,r()),n.stop=()=>(s=!0,i()),OK(n,t,!0).on("end",()=>s=!0)}function OK(e,t,n,i){var r=xe(t.forces),s,o,a,l;for(s=0,o=zP.length;s<o;++s)a=zP[s],a!==ev&&t.modified(a)&&e[a](t[a]);for(s=0,o=r.length;s<o;++s)l=ev+s,a=n||t.modified(ev,s)?tFe(r[s]):i&&eFe(r[s],i)?e.force(l):null,a&&e.force(l,a);for(o=e.numForces||0;s<o;++s)e.force(ev+s,null);return e.numForces=r.length,e}function eFe(e,t){var n,i;for(n in e)if(ot(i=e[n])&&t.modified(Li(i)))return 1;return 0}function tFe(e){var t,n;Ae(eV,e.force)||te("Unrecognized force: "+e.force),t=eV[e.force]();for(n in e)ot(t[n])&&nFe(t[n],e[n],e);return t}function nFe(e,t,n){e(ot(t)?i=>t(i,n):t)}const iFe=Object.freeze(Object.defineProperty({__proto__:null,force:T2},Symbol.toStringTag,{value:"Module"}));function rFe(e,t){return e.parent===t.parent?1:2}function sFe(e){return e.reduce(oFe,0)/e.length}function oFe(e,t){return e+t.x}function aFe(e){return 1+e.reduce(lFe,0)}function lFe(e,t){return Math.max(e,t.y)}function uFe(e){for(var t;t=e.children;)e=t[0];return e}function cFe(e){for(var t;t=e.children;)e=t[t.length-1];return e}function dFe(){var e=rFe,t=1,n=1,i=!1;function r(s){var o,a=0;s.eachAfter(function(h){var p=h.children;p?(h.x=sFe(p),h.y=aFe(p)):(h.x=o?a+=e(h,o):0,h.y=0,o=h)});var l=uFe(s),u=cFe(s),c=l.x-e(l,u)/2,d=u.x+e(u,l)/2;return s.eachAfter(i?function(h){h.x=(h.x-s.x)*t,h.y=(s.y-h.y)*n}:function(h){h.x=(h.x-c)/(d-c)*t,h.y=(1-(s.y?h.y/s.y:1))*n})}return r.separation=function(s){return arguments.length?(e=s,r):e},r.size=function(s){return arguments.length?(i=!1,t=+s[0],n=+s[1],r):i?null:[t,n]},r.nodeSize=function(s){return arguments.length?(i=!0,t=+s[0],n=+s[1],r):i?[t,n]:null},r}function hFe(e){var t=0,n=e.children,i=n&&n.length;if(!i)t=1;else for(;--i>=0;)t+=n[i].value;e.value=t}function fFe(){return this.eachAfter(hFe)}function pFe(e,t){let n=-1;for(const i of this)e.call(t,i,++n,this);return this}function gFe(e,t){for(var n=this,i=[n],r,s,o=-1;n=i.pop();)if(e.call(t,n,++o,this),r=n.children)for(s=r.length-1;s>=0;--s)i.push(r[s]);return this}function mFe(e,t){for(var n=this,i=[n],r=[],s,o,a,l=-1;n=i.pop();)if(r.push(n),s=n.children)for(o=0,a=s.length;o<a;++o)i.push(s[o]);for(;n=r.pop();)e.call(t,n,++l,this);return this}function vFe(e,t){let n=-1;for(const i of this)if(e.call(t,i,++n,this))return i}function CFe(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,i=t.children,r=i&&i.length;--r>=0;)n+=i[r].value;t.value=n})}function yFe(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function wFe(e){for(var t=this,n=bFe(t,e),i=[t];t!==n;)t=t.parent,i.push(t);for(var r=i.length;e!==n;)i.splice(r,0,e),e=e.parent;return i}function bFe(e,t){if(e===t)return e;var n=e.ancestors(),i=t.ancestors(),r=null;for(e=n.pop(),t=i.pop();e===t;)r=e,e=n.pop(),t=i.pop();return r}function SFe(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function xFe(){return Array.from(this)}function RFe(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function EFe(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*FFe(){var e=this,t,n=[e],i,r,s;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,i=e.children)for(r=0,s=i.length;r<s;++r)n.push(i[r]);while(n.length)}function I2(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=kFe)):t===void 0&&(t=DFe);for(var n=new wp(e),i,r=[n],s,o,a,l;i=r.pop();)if((o=t(i.data))&&(l=(o=Array.from(o)).length))for(i.children=o,a=l-1;a>=0;--a)r.push(s=o[a]=new wp(o[a])),s.parent=i,s.depth=i.depth+1;return n.eachBefore(LK)}function AFe(){return I2(this).eachBefore(PFe)}function DFe(e){return e.children}function kFe(e){return Array.isArray(e)?e[1]:null}function PFe(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function LK(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function wp(e){this.data=e,this.depth=this.height=0,this.parent=null}wp.prototype=I2.prototype={constructor:wp,count:fFe,each:pFe,eachAfter:mFe,eachBefore:gFe,find:vFe,sum:CFe,sort:yFe,path:wFe,ancestors:SFe,descendants:xFe,leaves:RFe,links:EFe,copy:AFe,[Symbol.iterator]:FFe};function ib(e){return e==null?null:NK(e)}function NK(e){if(typeof e!="function")throw new Error;return e}function Cd(){return 0}function wf(e){return function(){return e}}const MFe=1664525,TFe=1013904223,tV=4294967296;function IFe(){let e=1;return()=>(e=(MFe*e+TFe)%tV)/tV}function _Fe(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function OFe(e,t){let n=e.length,i,r;for(;n;)r=t()*n--|0,i=e[n],e[n]=e[r],e[r]=i;return e}function LFe(e,t){for(var n=0,i=(e=OFe(Array.from(e),t)).length,r=[],s,o;n<i;)s=e[n],o&&$K(o,s)?++n:(o=$Fe(r=NFe(r,s)),n=0);return o}function NFe(e,t){var n,i;if(RA(t,e))return[t];for(n=0;n<e.length;++n)if(lw(t,e[n])&&RA(tv(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(i=n+1;i<e.length;++i)if(lw(tv(e[n],e[i]),t)&&lw(tv(e[n],t),e[i])&&lw(tv(e[i],t),e[n])&&RA(BK(e[n],e[i],t),e))return[e[n],e[i],t];throw new Error}function lw(e,t){var n=e.r-t.r,i=t.x-e.x,r=t.y-e.y;return n<0||n*n<i*i+r*r}function $K(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function RA(e,t){for(var n=0;n<t.length;++n)if(!$K(e,t[n]))return!1;return!0}function $Fe(e){switch(e.length){case 1:return BFe(e[0]);case 2:return tv(e[0],e[1]);case 3:return BK(e[0],e[1],e[2])}}function BFe(e){return{x:e.x,y:e.y,r:e.r}}function tv(e,t){var n=e.x,i=e.y,r=e.r,s=t.x,o=t.y,a=t.r,l=s-n,u=o-i,c=a-r,d=Math.sqrt(l*l+u*u);return{x:(n+s+l/d*c)/2,y:(i+o+u/d*c)/2,r:(d+r+a)/2}}function BK(e,t,n){var i=e.x,r=e.y,s=e.r,o=t.x,a=t.y,l=t.r,u=n.x,c=n.y,d=n.r,h=i-o,p=i-u,g=r-a,m=r-c,C=l-s,y=d-s,b=i*i+r*r-s*s,S=b-o*o-a*a+l*l,x=b-u*u-c*c+d*d,E=p*g-h*m,A=(g*x-m*S)/(E*2)-i,F=(m*C-g*y)/E,P=(p*S-h*x)/(E*2)-r,D=(h*y-p*C)/E,M=F*F+D*D-1,O=2*(s+A*F+P*D),B=A*A+P*P-s*s,H=-(Math.abs(M)>1e-6?(O+Math.sqrt(O*O-4*M*B))/(2*M):B/O);return{x:i+A+F*H,y:r+P+D*H,r:H}}function nV(e,t,n){var i=e.x-t.x,r,s,o=e.y-t.y,a,l,u=i*i+o*o;u?(s=t.r+n.r,s*=s,l=e.r+n.r,l*=l,s>l?(r=(u+l-s)/(2*u),a=Math.sqrt(Math.max(0,l/u-r*r)),n.x=e.x-r*i-a*o,n.y=e.y-r*o+a*i):(r=(u+s-l)/(2*u),a=Math.sqrt(Math.max(0,s/u-r*r)),n.x=t.x+r*i-a*o,n.y=t.y+r*o+a*i)):(n.x=t.x+n.r,n.y=t.y)}function iV(e,t){var n=e.r+t.r-1e-6,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function rV(e){var t=e._,n=e.next._,i=t.r+n.r,r=(t.x*n.r+n.x*t.r)/i,s=(t.y*n.r+n.y*t.r)/i;return r*r+s*s}function uw(e){this._=e,this.next=null,this.previous=null}function GFe(e,t){if(!(s=(e=_Fe(e)).length))return 0;var n,i,r,s,o,a,l,u,c,d,h;if(n=e[0],n.x=0,n.y=0,!(s>1))return n.r;if(i=e[1],n.x=-i.r,i.x=n.r,i.y=0,!(s>2))return n.r+i.r;nV(i,n,r=e[2]),n=new uw(n),i=new uw(i),r=new uw(r),n.next=r.previous=i,i.next=n.previous=r,r.next=i.previous=n;e:for(l=3;l<s;++l){nV(n._,i._,r=e[l]),r=new uw(r),u=i.next,c=n.previous,d=i._.r,h=n._.r;do if(d<=h){if(iV(u._,r._)){i=u,n.next=i,i.previous=n,--l;continue e}d+=u._.r,u=u.next}else{if(iV(c._,r._)){n=c,n.next=i,i.previous=n,--l;continue e}h+=c._.r,c=c.previous}while(u!==c.next);for(r.previous=n,r.next=i,n.next=i.previous=i=r,o=rV(n);(r=r.next)!==i;)(a=rV(r))<o&&(n=r,o=a);i=n.next}for(n=[i._],r=i;(r=r.next)!==i;)n.push(r._);for(r=LFe(n,t),l=0;l<s;++l)n=e[l],n.x-=r.x,n.y-=r.y;return r.r}function zFe(e){return Math.sqrt(e.value)}function HFe(){var e=null,t=1,n=1,i=Cd;function r(s){const o=IFe();return s.x=t/2,s.y=n/2,e?s.eachBefore(sV(e)).eachAfter(EA(i,.5,o)).eachBefore(oV(1)):s.eachBefore(sV(zFe)).eachAfter(EA(Cd,1,o)).eachAfter(EA(i,s.r/Math.min(t,n),o)).eachBefore(oV(Math.min(t,n)/(2*s.r))),s}return r.radius=function(s){return arguments.length?(e=ib(s),r):e},r.size=function(s){return arguments.length?(t=+s[0],n=+s[1],r):[t,n]},r.padding=function(s){return arguments.length?(i=typeof s=="function"?s:wf(+s),r):i},r}function sV(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function EA(e,t,n){return function(i){if(r=i.children){var r,s,o=r.length,a=e(i)*t||0,l;if(a)for(s=0;s<o;++s)r[s].r+=a;if(l=GFe(r,n),a)for(s=0;s<o;++s)r[s].r-=a;i.r=l+a}}}function oV(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function GK(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function dC(e,t,n,i,r){for(var s=e.children,o,a=-1,l=s.length,u=e.value&&(i-t)/e.value;++a<l;)o=s[a],o.y0=n,o.y1=r,o.x0=t,o.x1=t+=o.value*u}function VFe(){var e=1,t=1,n=0,i=!1;function r(o){var a=o.height+1;return o.x0=o.y0=n,o.x1=e,o.y1=t/a,o.eachBefore(s(t,a)),i&&o.eachBefore(GK),o}function s(o,a){return function(l){l.children&&dC(l,l.x0,o*(l.depth+1)/a,l.x1,o*(l.depth+2)/a);var u=l.x0,c=l.y0,d=l.x1-n,h=l.y1-n;d<u&&(u=d=(u+d)/2),h<c&&(c=h=(c+h)/2),l.x0=u,l.y0=c,l.x1=d,l.y1=h}}return r.round=function(o){return arguments.length?(i=!!o,r):i},r.size=function(o){return arguments.length?(e=+o[0],t=+o[1],r):[e,t]},r.padding=function(o){return arguments.length?(n=+o,r):n},r}var WFe={depth:-1},aV={},FA={};function UFe(e){return e.id}function qFe(e){return e.parentId}function lV(){var e=UFe,t=qFe,n;function i(r){var s=Array.from(r),o=e,a=t,l,u,c,d,h,p,g,m,C=new Map;if(n!=null){const y=s.map((x,E)=>jFe(n(x,E,r))),b=y.map(uV),S=new Set(y).add("");for(const x of b)S.has(x)||(S.add(x),y.push(x),b.push(uV(x)),s.push(FA));o=(x,E)=>y[E],a=(x,E)=>b[E]}for(c=0,l=s.length;c<l;++c)u=s[c],p=s[c]=new wp(u),(g=o(u,c,r))!=null&&(g+="")&&(m=p.id=g,C.set(m,C.has(m)?aV:p)),(g=a(u,c,r))!=null&&(g+="")&&(p.parent=g);for(c=0;c<l;++c)if(p=s[c],g=p.parent){if(h=C.get(g),!h)throw new Error("missing: "+g);if(h===aV)throw new Error("ambiguous: "+g);h.children?h.children.push(p):h.children=[p],p.parent=h}else{if(d)throw new Error("multiple roots");d=p}if(!d)throw new Error("no root");if(n!=null){for(;d.data===FA&&d.children.length===1;)d=d.children[0],--l;for(let y=s.length-1;y>=0&&(p=s[y],p.data===FA);--y)p.data=null}if(d.parent=WFe,d.eachBefore(function(y){y.depth=y.parent.depth+1,--l}).eachBefore(LK),d.parent=null,l>0)throw new Error("cycle");return d}return i.id=function(r){return arguments.length?(e=ib(r),i):e},i.parentId=function(r){return arguments.length?(t=ib(r),i):t},i.path=function(r){return arguments.length?(n=ib(r),i):n},i}function jFe(e){e=`${e}`;let t=e.length;return HP(e,t-1)&&!HP(e,t-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function uV(e){let t=e.length;if(t<2)return"";for(;--t>1&&!HP(e,t););return e.slice(0,t)}function HP(e,t){if(e[t]==="/"){let n=0;for(;t>0&&e[--t]==="\\";)++n;if(!(n&1))return!0}return!1}function KFe(e,t){return e.parent===t.parent?1:2}function AA(e){var t=e.children;return t?t[0]:e.t}function DA(e){var t=e.children;return t?t[t.length-1]:e.t}function YFe(e,t,n){var i=n/(t.i-e.i);t.c-=i,t.s+=n,e.c+=i,t.z+=n,t.m+=n}function XFe(e){for(var t=0,n=0,i=e.children,r=i.length,s;--r>=0;)s=i[r],s.z+=t,s.m+=t,t+=s.s+(n+=s.c)}function QFe(e,t,n){return e.a.parent===t.parent?e.a:n}function rb(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}rb.prototype=Object.create(wp.prototype);function ZFe(e){for(var t=new rb(e,0),n,i=[t],r,s,o,a;n=i.pop();)if(s=n._.children)for(n.children=new Array(a=s.length),o=a-1;o>=0;--o)i.push(r=n.children[o]=new rb(s[o],o)),r.parent=n;return(t.parent=new rb(null,0)).children=[t],t}function JFe(){var e=KFe,t=1,n=1,i=null;function r(u){var c=ZFe(u);if(c.eachAfter(s),c.parent.m=-c.z,c.eachBefore(o),i)u.eachBefore(l);else{var d=u,h=u,p=u;u.eachBefore(function(b){b.x<d.x&&(d=b),b.x>h.x&&(h=b),b.depth>p.depth&&(p=b)});var g=d===h?1:e(d,h)/2,m=g-d.x,C=t/(h.x+g+m),y=n/(p.depth||1);u.eachBefore(function(b){b.x=(b.x+m)*C,b.y=b.depth*y})}return u}function s(u){var c=u.children,d=u.parent.children,h=u.i?d[u.i-1]:null;if(c){XFe(u);var p=(c[0].z+c[c.length-1].z)/2;h?(u.z=h.z+e(u._,h._),u.m=u.z-p):u.z=p}else h&&(u.z=h.z+e(u._,h._));u.parent.A=a(u,h,u.parent.A||d[0])}function o(u){u._.x=u.z+u.parent.m,u.m+=u.parent.m}function a(u,c,d){if(c){for(var h=u,p=u,g=c,m=h.parent.children[0],C=h.m,y=p.m,b=g.m,S=m.m,x;g=DA(g),h=AA(h),g&&h;)m=AA(m),p=DA(p),p.a=u,x=g.z+b-h.z-C+e(g._,h._),x>0&&(YFe(QFe(g,u,d),u,x),C+=x,y+=x),b+=g.m,C+=h.m,S+=m.m,y+=p.m;g&&!DA(p)&&(p.t=g,p.m+=b-y),h&&!AA(m)&&(m.t=h,m.m+=C-S,d=u)}return d}function l(u){u.x*=t,u.y=u.depth*n}return r.separation=function(u){return arguments.length?(e=u,r):e},r.size=function(u){return arguments.length?(i=!1,t=+u[0],n=+u[1],r):i?null:[t,n]},r.nodeSize=function(u){return arguments.length?(i=!0,t=+u[0],n=+u[1],r):i?[t,n]:null},r}function _x(e,t,n,i,r){for(var s=e.children,o,a=-1,l=s.length,u=e.value&&(r-n)/e.value;++a<l;)o=s[a],o.x0=t,o.x1=i,o.y0=n,o.y1=n+=o.value*u}var zK=(1+Math.sqrt(5))/2;function HK(e,t,n,i,r,s){for(var o=[],a=t.children,l,u,c=0,d=0,h=a.length,p,g,m=t.value,C,y,b,S,x,E,A;c<h;){p=r-n,g=s-i;do C=a[d++].value;while(!C&&d<h);for(y=b=C,E=Math.max(g/p,p/g)/(m*e),A=C*C*E,x=Math.max(b/A,A/y);d<h;++d){if(C+=u=a[d].value,u<y&&(y=u),u>b&&(b=u),A=C*C*E,S=Math.max(b/A,A/y),S>x){C-=u;break}x=S}o.push(l={value:C,dice:p<g,children:a.slice(c,d)}),l.dice?dC(l,n,i,r,m?i+=g*C/m:s):_x(l,n,i,m?n+=p*C/m:r,s),m-=C,c=d}return o}const VK=function e(t){function n(i,r,s,o,a){HK(t,i,r,s,o,a)}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(zK);function eAe(){var e=VK,t=!1,n=1,i=1,r=[0],s=Cd,o=Cd,a=Cd,l=Cd,u=Cd;function c(h){return h.x0=h.y0=0,h.x1=n,h.y1=i,h.eachBefore(d),r=[0],t&&h.eachBefore(GK),h}function d(h){var p=r[h.depth],g=h.x0+p,m=h.y0+p,C=h.x1-p,y=h.y1-p;C<g&&(g=C=(g+C)/2),y<m&&(m=y=(m+y)/2),h.x0=g,h.y0=m,h.x1=C,h.y1=y,h.children&&(p=r[h.depth+1]=s(h)/2,g+=u(h)-p,m+=o(h)-p,C-=a(h)-p,y-=l(h)-p,C<g&&(g=C=(g+C)/2),y<m&&(m=y=(m+y)/2),e(h,g,m,C,y))}return c.round=function(h){return arguments.length?(t=!!h,c):t},c.size=function(h){return arguments.length?(n=+h[0],i=+h[1],c):[n,i]},c.tile=function(h){return arguments.length?(e=NK(h),c):e},c.padding=function(h){return arguments.length?c.paddingInner(h).paddingOuter(h):c.paddingInner()},c.paddingInner=function(h){return arguments.length?(s=typeof h=="function"?h:wf(+h),c):s},c.paddingOuter=function(h){return arguments.length?c.paddingTop(h).paddingRight(h).paddingBottom(h).paddingLeft(h):c.paddingTop()},c.paddingTop=function(h){return arguments.length?(o=typeof h=="function"?h:wf(+h),c):o},c.paddingRight=function(h){return arguments.length?(a=typeof h=="function"?h:wf(+h),c):a},c.paddingBottom=function(h){return arguments.length?(l=typeof h=="function"?h:wf(+h),c):l},c.paddingLeft=function(h){return arguments.length?(u=typeof h=="function"?h:wf(+h),c):u},c}function tAe(e,t,n,i,r){var s=e.children,o,a=s.length,l,u=new Array(a+1);for(u[0]=l=o=0;o<a;++o)u[o+1]=l+=s[o].value;c(0,a,e.value,t,n,i,r);function c(d,h,p,g,m,C,y){if(d>=h-1){var b=s[d];b.x0=g,b.y0=m,b.x1=C,b.y1=y;return}for(var S=u[d],x=p/2+S,E=d+1,A=h-1;E<A;){var F=E+A>>>1;u[F]<x?E=F+1:A=F}x-u[E-1]<u[E]-x&&d+1<E&&--E;var P=u[E]-S,D=p-P;if(C-g>y-m){var M=p?(g*D+C*P)/p:C;c(d,E,P,g,m,M,y),c(E,h,D,M,m,C,y)}else{var O=p?(m*D+y*P)/p:y;c(d,E,P,g,m,C,O),c(E,h,D,g,O,C,y)}}}function nAe(e,t,n,i,r){(e.depth&1?_x:dC)(e,t,n,i,r)}const iAe=function e(t){function n(i,r,s,o,a){if((l=i._squarify)&&l.ratio===t)for(var l,u,c,d,h=-1,p,g=l.length,m=i.value;++h<g;){for(u=l[h],c=u.children,d=u.value=0,p=c.length;d<p;++d)u.value+=c[d].value;u.dice?dC(u,r,s,o,m?s+=(a-s)*u.value/m:a):_x(u,r,s,m?r+=(o-r)*u.value/m:o,a),m-=u.value}else i._squarify=l=HK(t,i,r,s,o,a),l.ratio=t}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(zK);function VP(e,t,n){const i={};return e.each(r=>{const s=r.data;n(s)&&(i[t(s)]=r)}),e.lookup=i,e}function _2(e){Q.call(this,null,e)}_2.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const rAe=e=>e.values;me(_2,Q,{transform(e,t){t.source||te("Nest transform requires an upstream data source.");var n=e.generate,i=e.modified(),r=t.clone(),s=this.value;return(!s||i||t.changed())&&(s&&s.each(o=>{o.children&&j1(o.data)&&r.rem.push(o.data)}),this.value=s=I2({values:xe(e.keys).reduce((o,a)=>(o.key(a),o),sAe()).entries(r.source)},rAe),n&&s.each(o=>{o.children&&(o=It(o.data),r.add.push(o),r.source.push(o))}),VP(s,$e,$e)),r.source.root=s,r}});function sAe(){const e=[],t={entries:r=>i(n(r,0),0),key:r=>(e.push(r),t)};function n(r,s){if(s>=e.length)return r;const o=r.length,a=e[s++],l={},u={};let c=-1,d,h,p;for(;++c<o;)d=a(h=r[c])+"",(p=l[d])?p.push(h):l[d]=[h];for(d in l)u[d]=n(l[d],s);return u}function i(r,s){if(++s>e.length)return r;const o=[];for(const a in r)o.push({key:a,values:i(r[a],s)});return o}return t}function Jl(e){Q.call(this,null,e)}const oAe=(e,t)=>e.parent===t.parent?1:2;me(Jl,Q,{transform(e,t){(!t.source||!t.source.root)&&te(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),i=this.fields,r=t.source.root,s=e.as||i;e.field?r.sum(e.field):r.count(),e.sort&&r.sort(yh(e.sort,o=>o.data)),aAe(n,this.params,e),n.separation&&n.separation(e.separation!==!1?oAe:Kp);try{this.value=n(r)}catch(o){te(o)}return r.each(o=>lAe(o,i,s)),t.reflow(e.modified()).modifies(s).modifies("leaf")}});function aAe(e,t,n){for(let i,r=0,s=t.length;r<s;++r)i=t[r],i in n&&e[i](n[i])}function lAe(e,t,n){const i=e.data,r=t.length-1;for(let s=0;s<r;++s)i[n[s]]=e[t[s]];i[n[r]]=e.children?e.children.length:0}const WP=["x","y","r","depth","children"];function O2(e){Jl.call(this,e)}O2.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:WP.length,default:WP}]};me(O2,Jl,{layout:HFe,params:["radius","size","padding"],fields:WP});const UP=["x0","y0","x1","y1","depth","children"];function L2(e){Jl.call(this,e)}L2.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:UP.length,default:UP}]};me(L2,Jl,{layout:VFe,params:["size","round","padding"],fields:UP});function N2(e){Q.call(this,null,e)}N2.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};me(N2,Q,{transform(e,t){t.source||te("Stratify transform requires an upstream data source.");let n=this.value;const i=e.modified(),r=t.fork(t.ALL).materialize(t.SOURCE),s=!n||i||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return r.source=r.source.slice(),s&&(n=r.source.length?VP(lV().id(e.key).parentId(e.parentKey)(r.source),e.key,zs):VP(lV()([{}]),e.key,e.key)),r.source.root=this.value=n,r}});const cV={tidy:JFe,cluster:dFe},qP=["x","y","depth","children"];function $2(e){Jl.call(this,e)}$2.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:qP.length,default:qP}]};me($2,Jl,{layout(e){const t=e||"tidy";if(Ae(cV,t))return cV[t]();te("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:qP});function B2(e){Q.call(this,[],e)}B2.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};me(B2,Q,{transform(e,t){const n=this.value,i=t.source&&t.source.root,r=t.fork(t.NO_SOURCE),s={};return i||te("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(r.rem=n,t.visit(t.SOURCE,o=>s[$e(o)]=1),i.each(o=>{const a=o.data,l=o.parent&&o.parent.data;l&&s[$e(a)]&&s[$e(l)]&&r.add.push(It({source:l,target:a}))}),this.value=r.add):t.changed(t.MOD)&&(t.visit(t.MOD,o=>s[$e(o)]=1),n.forEach(o=>{(s[$e(o.source)]||s[$e(o.target)])&&r.mod.push(o)})),r}});const dV={binary:tAe,dice:dC,slice:_x,slicedice:nAe,squarify:VK,resquarify:iAe},jP=["x0","y0","x1","y1","depth","children"];function G2(e){Jl.call(this,e)}G2.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:jP.length,default:jP}]};me(G2,Jl,{layout(){const e=eAe();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{Ae(dV,t)?e.tile(dV[t]):te("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:jP});const uAe=Object.freeze(Object.defineProperty({__proto__:null,nest:_2,pack:O2,partition:L2,stratify:N2,tree:$2,treelinks:B2,treemap:G2},Symbol.toStringTag,{value:"Module"})),kA=4278190080;function cAe(e,t){const n=e.bitmap();return(t||[]).forEach(i=>n.set(e(i.boundary[0]),e(i.boundary[3]))),[n,void 0]}function dAe(e,t,n,i,r){const s=e.width,o=e.height,a=i||r,l=ju(s,o).getContext("2d"),u=ju(s,o).getContext("2d"),c=a&&ju(s,o).getContext("2d");n.forEach(P=>sb(l,P,!1)),sb(u,t,!1),a&&sb(c,t,!0);const d=PA(l,s,o),h=PA(u,s,o),p=a&&PA(c,s,o),g=e.bitmap(),m=a&&e.bitmap();let C,y,b,S,x,E,A,F;for(y=0;y<o;++y)for(C=0;C<s;++C)x=y*s+C,E=d[x]&kA,F=h[x]&kA,A=a&&p[x]&kA,(E||A||F)&&(b=e(C),S=e(y),!r&&(E||F)&&g.set(b,S),a&&(E||A)&&m.set(b,S));return[g,m]}function PA(e,t,n){return new Uint32Array(e.getImageData(0,0,t,n).data.buffer)}function sb(e,t,n){if(!t.length)return;const i=t[0].mark.marktype;i==="group"?t.forEach(r=>{r.items.forEach(s=>sb(e,s.items,n))}):us[i].draw(e,{items:n?t.map(hAe):t})}function hAe(e){const t=K1(e,{});return t.stroke&&t.strokeOpacity!==0||t.fill&&t.fillOpacity!==0?{...t,strokeOpacity:1,stroke:"#000",fillOpacity:0}:t}const al=5,qi=31,i0=32,ku=new Uint32Array(i0+1),fo=new Uint32Array(i0+1);fo[0]=0;ku[0]=~fo[0];for(let e=1;e<=i0;++e)fo[e]=fo[e-1]<<1|1,ku[e]=~fo[e];function fAe(e,t){const n=new Uint32Array(~~((e*t+i0)/i0));function i(s,o){n[s]|=o}function r(s,o){n[s]&=o}return{array:n,get:(s,o)=>{const a=o*e+s;return n[a>>>al]&1<<(a&qi)},set:(s,o)=>{const a=o*e+s;i(a>>>al,1<<(a&qi))},clear:(s,o)=>{const a=o*e+s;r(a>>>al,~(1<<(a&qi)))},getRange:(s,o,a,l)=>{let u=l,c,d,h,p;for(;u>=o;--u)if(c=u*e+s,d=u*e+a,h=c>>>al,p=d>>>al,h===p){if(n[h]&ku[c&qi]&fo[(d&qi)+1])return!0}else{if(n[h]&ku[c&qi]||n[p]&fo[(d&qi)+1])return!0;for(let g=h+1;g<p;++g)if(n[g])return!0}return!1},setRange:(s,o,a,l)=>{let u,c,d,h,p;for(;o<=l;++o)if(u=o*e+s,c=o*e+a,d=u>>>al,h=c>>>al,d===h)i(d,ku[u&qi]&fo[(c&qi)+1]);else for(i(d,ku[u&qi]),i(h,fo[(c&qi)+1]),p=d+1;p<h;++p)i(p,4294967295)},clearRange:(s,o,a,l)=>{let u,c,d,h,p;for(;o<=l;++o)if(u=o*e+s,c=o*e+a,d=u>>>al,h=c>>>al,d===h)r(d,fo[u&qi]|ku[(c&qi)+1]);else for(r(d,fo[u&qi]),r(h,ku[(c&qi)+1]),p=d+1;p<h;++p)r(p,0)},outOfBounds:(s,o,a,l)=>s<0||o<0||l>=t||a>=e}}function pAe(e,t,n){const i=Math.max(1,Math.sqrt(e*t/1e6)),r=~~((e+2*n+i)/i),s=~~((t+2*n+i)/i),o=a=>~~((a+n)/i);return o.invert=a=>a*i-n,o.bitmap=()=>fAe(r,s),o.ratio=i,o.padding=n,o.width=e,o.height=t,o}function gAe(e,t,n,i){const r=e.width,s=e.height;return function(o){const a=o.datum.datum.items[i].items,l=a.length,u=o.datum.fontSize,c=is.width(o.datum,o.datum.text);let d=0,h,p,g,m,C,y,b;for(let S=0;S<l;++S)h=a[S].x,g=a[S].y,p=a[S].x2===void 0?h:a[S].x2,m=a[S].y2===void 0?g:a[S].y2,C=(h+p)/2,y=(g+m)/2,b=Math.abs(p-h+m-g),b>=d&&(d=b,o.x=C,o.y=y);return C=c/2,y=u/2,h=o.x-C,p=o.x+C,g=o.y-y,m=o.y+y,o.align="center",h<0&&p<=r?o.align="left":0<=h&&r<p&&(o.align="right"),o.baseline="middle",g<0&&m<=s?o.baseline="top":0<=g&&s<m&&(o.baseline="bottom"),!0}}function MS(e,t,n,i,r,s){let o=n/2;return e-o<0||e+o>r||t-(o=i/2)<0||t+o>s}function zu(e,t,n,i,r,s,o,a){const l=r*s/(i*2),u=e(t-l),c=e(t+l),d=e(n-(s=s/2)),h=e(n+s);return o.outOfBounds(u,d,c,h)||o.getRange(u,d,c,h)||a&&a.getRange(u,d,c,h)}function mAe(e,t,n,i){const r=e.width,s=e.height,o=t[0],a=t[1];function l(u,c,d,h,p){const g=e.invert(u),m=e.invert(c);let C=d,y=s,b;if(!MS(g,m,h,p,r,s)&&!zu(e,g,m,p,h,C,o,a)&&!zu(e,g,m,p,h,p,o,null)){for(;y-C>=1;)b=(C+y)/2,zu(e,g,m,p,h,b,o,a)?y=b:C=b;if(C>d)return[g,m,C,!0]}}return function(u){const c=u.datum.datum.items[i].items,d=c.length,h=u.datum.fontSize,p=is.width(u.datum,u.datum.text);let g=n?h:0,m=!1,C=!1,y=0,b,S,x,E,A,F,P,D,M,O,B,H,N,L,G,q,V;for(let U=0;U<d;++U){for(b=c[U].x,x=c[U].y,S=c[U].x2===void 0?b:c[U].x2,E=c[U].y2===void 0?x:c[U].y2,b>S&&(V=b,b=S,S=V),x>E&&(V=x,x=E,E=V),M=e(b),B=e(S),O=~~((M+B)/2),H=e(x),L=e(E),N=~~((H+L)/2),P=O;P>=M;--P)for(D=N;D>=H;--D)q=l(P,D,g,p,h),q&&([u.x,u.y,g,m]=q);for(P=O;P<=B;++P)for(D=N;D<=L;++D)q=l(P,D,g,p,h),q&&([u.x,u.y,g,m]=q);!m&&!n&&(G=Math.abs(S-b+E-x),A=(b+S)/2,F=(x+E)/2,G>=y&&!MS(A,F,p,h,r,s)&&!zu(e,A,F,h,p,h,o,null)&&(y=G,u.x=A,u.y=F,C=!0))}return m||C?(A=p/2,F=h/2,o.setRange(e(u.x-A),e(u.y-F),e(u.x+A),e(u.y+F)),u.align="center",u.baseline="middle",!0):!1}}const vAe=[-1,-1,1,1],CAe=[-1,1,-1,1];function yAe(e,t,n,i){const r=e.width,s=e.height,o=t[0],a=t[1],l=e.bitmap();return function(u){const c=u.datum.datum.items[i].items,d=c.length,h=u.datum.fontSize,p=is.width(u.datum,u.datum.text),g=[];let m=n?h:0,C=!1,y=!1,b=0,S,x,E,A,F,P,D,M,O,B,H,N;for(let L=0;L<d;++L){for(S=c[L].x,E=c[L].y,x=c[L].x2===void 0?S:c[L].x2,A=c[L].y2===void 0?E:c[L].y2,g.push([e((S+x)/2),e((E+A)/2)]);g.length;)if([D,M]=g.pop(),!(o.get(D,M)||a.get(D,M)||l.get(D,M))){l.set(D,M);for(let G=0;G<4;++G)F=D+vAe[G],P=M+CAe[G],l.outOfBounds(F,P,F,P)||g.push([F,P]);if(F=e.invert(D),P=e.invert(M),O=m,B=s,!MS(F,P,p,h,r,s)&&!zu(e,F,P,h,p,O,o,a)&&!zu(e,F,P,h,p,h,o,null)){for(;B-O>=1;)H=(O+B)/2,zu(e,F,P,h,p,H,o,a)?B=H:O=H;O>m&&(u.x=F,u.y=P,m=O,C=!0)}}!C&&!n&&(N=Math.abs(x-S+A-E),F=(S+x)/2,P=(E+A)/2,N>=b&&!MS(F,P,p,h,r,s)&&!zu(e,F,P,h,p,h,o,null)&&(b=N,u.x=F,u.y=P,y=!0))}return C||y?(F=p/2,P=h/2,o.setRange(e(u.x-F),e(u.y-P),e(u.x+F),e(u.y+P)),u.align="center",u.baseline="middle",!0):!1}}const wAe=["right","center","left"],bAe=["bottom","middle","top"];function SAe(e,t,n,i){const r=e.width,s=e.height,o=t[0],a=t[1],l=i.length;return function(u){const c=u.boundary,d=u.datum.fontSize;if(c[2]<0||c[5]<0||c[0]>r||c[3]>s)return!1;let h=u.textWidth??0,p,g,m,C,y,b,S,x,E,A,F,P,D,M,O;for(let B=0;B<l;++B){if(p=(n[B]&3)-1,g=(n[B]>>>2&3)-1,m=p===0&&g===0||i[B]<0,C=p&&g?Math.SQRT1_2:1,y=i[B]<0?-1:1,b=c[1+p]+i[B]*p*C,F=c[4+g]+y*d*g/2+i[B]*g*C,x=F-d/2,E=F+d/2,P=e(b),M=e(x),O=e(E),!h)if(hV(P,P,M,O,o,a,b,b,x,E,c,m))h=is.width(u.datum,u.datum.text);else continue;if(A=b+y*h*p/2,b=A-h/2,S=A+h/2,P=e(b),D=e(S),hV(P,D,M,O,o,a,b,S,x,E,c,m))return u.x=p?p*y<0?S:b:A,u.y=g?g*y<0?E:x:F,u.align=wAe[p*y+1],u.baseline=bAe[g*y+1],o.setRange(P,M,D,O),!0}return!1}}function hV(e,t,n,i,r,s,o,a,l,u,c,d){return!(r.outOfBounds(e,n,t,i)||(d&&s||r).getRange(e,n,t,i))}const MA=0,TA=4,IA=8,_A=0,OA=1,LA=2,xAe={"top-left":MA+_A,top:MA+OA,"top-right":MA+LA,left:TA+_A,middle:TA+OA,right:TA+LA,"bottom-left":IA+_A,bottom:IA+OA,"bottom-right":IA+LA},RAe={naive:gAe,"reduced-search":mAe,floodfill:yAe};function EAe(e,t,n,i,r,s,o,a,l,u,c){if(!e.length)return e;const d=Math.max(i.length,r.length),h=FAe(i,d),p=AAe(r,d),g=DAe(e[0].datum),m=g==="group"&&e[0].datum.items[l].marktype,C=m==="area",y=kAe(g,m,a,l),b=u===null||u===1/0,S=C&&c==="naive";let x=-1,E=-1;const A=e.map(M=>{const O=b?is.width(M,M.text):void 0;return x=Math.max(x,O),E=Math.max(E,M.fontSize),{datum:M,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y(M),textWidth:O}});u=u===null||u===1/0?Math.max(x,E)+Math.max(...i):u;const F=pAe(t[0],t[1],u);let P;if(!S){n&&A.sort((B,H)=>n(B.datum,H.datum));let M=!1;for(let B=0;B<p.length&&!M;++B)M=p[B]===5||h[B]<0;const O=(g&&o||C)&&e.map(B=>B.datum);P=s.length||O?dAe(F,O||[],s,M,C):cAe(F,o&&A)}const D=C?RAe[c](F,P,o,l):SAe(F,P,p,h);return A.forEach(M=>M.opacity=+D(M)),A}function FAe(e,t){const n=new Float64Array(t),i=e.length;for(let r=0;r<i;++r)n[r]=e[r]||0;for(let r=i;r<t;++r)n[r]=n[i-1];return n}function AAe(e,t){const n=new Int8Array(t),i=e.length;for(let r=0;r<i;++r)n[r]|=xAe[e[r]];for(let r=i;r<t;++r)n[r]=n[i-1];return n}function DAe(e){return e&&e.mark&&e.mark.marktype}function kAe(e,t,n,i){const r=s=>[s.x,s.x,s.x,s.y,s.y,s.y];return e?e==="line"||e==="area"?s=>r(s.datum):t==="line"?s=>{const o=s.datum.items[i].items;return r(o.length?o[n==="start"?0:o.length-1]:{x:NaN,y:NaN})}:s=>{const o=s.datum.bounds;return[o.x1,(o.x1+o.x2)/2,o.x2,o.y1,(o.y1+o.y2)/2,o.y2]}:r}const KP=["x","y","opacity","align","baseline"],WK=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function z2(e){Q.call(this,null,e)}z2.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:WK},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:KP.length,default:KP}]};me(z2,Q,{transform(e,t){function n(s){const o=e[s];return ot(o)&&t.modified(o.fields)}const i=e.modified();if(!(i||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&te("Size parameter should be specified as a [width, height] array.");const r=e.as||KP;return EAe(t.materialize(t.SOURCE).source||[],e.size,e.sort,xe(e.offset==null?1:e.offset),xe(e.anchor||WK),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding===void 0?0:e.padding,e.method||"naive").forEach(s=>{const o=s.datum;o[r[0]]=s.x,o[r[1]]=s.y,o[r[2]]=s.opacity,o[r[3]]=s.align,o[r[4]]=s.baseline}),t.reflow(i).modifies(r)}});const PAe=Object.freeze(Object.defineProperty({__proto__:null,label:z2},Symbol.toStringTag,{value:"Module"}));function UK(e,t){var n=[],i=function(c){return c(a)},r,s,o,a,l,u;if(t==null)n.push(e);else for(r={},s=0,o=e.length;s<o;++s)a=e[s],l=t.map(i),u=r[l],u||(r[l]=u=[],u.dims=l,n.push(u)),u.push(a);return n}function H2(e){Q.call(this,null,e)}H2.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};me(H2,Q,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=UK(i,e.groupby),s=(e.groupby||[]).map(xn),o=s.length,a=e.as||[xn(e.x),xn(e.y)],l=[];r.forEach(u=>{QU(u,e.x,e.y,e.bandwidth||.3).forEach(c=>{const d={};for(let h=0;h<o;++h)d[s[h]]=u.dims[h];d[a[0]]=c[0],d[a[1]]=c[1],l.push(It(d))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});const YP={constant:EI,linear:FI,log:jU,exp:KU,pow:YU,quad:AI,poly:XU},MAe=(e,t)=>e==="poly"?t:e==="quad"?2:1;function V2(e){Q.call(this,null,e)}V2.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(YP)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};me(V2,Q,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=UK(i,e.groupby),s=(e.groupby||[]).map(xn),o=e.method||"linear",a=e.order==null?3:e.order,l=MAe(o,a),u=e.as||[xn(e.x),xn(e.y)],c=YP[o],d=[];let h=e.extent;Ae(YP,o)||te("Invalid regression method: "+o),h!=null&&o==="log"&&h[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),h=null),r.forEach(p=>{if(p.length<=l){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const m=c(p,e.x,e.y,a);if(e.params){d.push(It({keys:p.dims,coef:m.coef,rSquared:m.rSquared}));return}const C=h||Ea(p,e.x),y=b=>{const S={};for(let x=0;x<s.length;++x)S[s[x]]=p.dims[x];S[u[0]]=b[0],S[u[1]]=b[1],d.push(It(S))};o==="linear"||o==="constant"?C.forEach(b=>y([b,m.predict(b)])):tx(m.predict,C,25,200).forEach(y)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=d}return n}});const TAe=Object.freeze(Object.defineProperty({__proto__:null,loess:H2,regression:V2},Symbol.toStringTag,{value:"Module"})),Al=11102230246251565e-32,ki=134217729,IAe=(3+8*Al)*Al;function NA(e,t,n,i,r){let s,o,a,l,u=t[0],c=i[0],d=0,h=0;c>u==c>-u?(s=u,u=t[++d]):(s=c,c=i[++h]);let p=0;if(d<e&&h<n)for(c>u==c>-u?(o=u+s,a=s-(o-u),u=t[++d]):(o=c+s,a=s-(o-c),c=i[++h]),s=o,a!==0&&(r[p++]=a);d<e&&h<n;)c>u==c>-u?(o=s+u,l=o-s,a=s-(o-l)+(u-l),u=t[++d]):(o=s+c,l=o-s,a=s-(o-l)+(c-l),c=i[++h]),s=o,a!==0&&(r[p++]=a);for(;d<e;)o=s+u,l=o-s,a=s-(o-l)+(u-l),u=t[++d],s=o,a!==0&&(r[p++]=a);for(;h<n;)o=s+c,l=o-s,a=s-(o-l)+(c-l),c=i[++h],s=o,a!==0&&(r[p++]=a);return(s!==0||p===0)&&(r[p++]=s),p}function _Ae(e,t){let n=t[0];for(let i=1;i<e;i++)n+=t[i];return n}function hC(e){return new Float64Array(e)}const OAe=(3+16*Al)*Al,LAe=(2+12*Al)*Al,NAe=(9+64*Al)*Al*Al,df=hC(4),fV=hC(8),pV=hC(12),gV=hC(16),ji=hC(4);function $Ae(e,t,n,i,r,s,o){let a,l,u,c,d,h,p,g,m,C,y,b,S,x,E,A,F,P;const D=e-r,M=n-r,O=t-s,B=i-s;x=D*B,h=ki*D,p=h-(h-D),g=D-p,h=ki*B,m=h-(h-B),C=B-m,E=g*C-(x-p*m-g*m-p*C),A=O*M,h=ki*O,p=h-(h-O),g=O-p,h=ki*M,m=h-(h-M),C=M-m,F=g*C-(A-p*m-g*m-p*C),y=E-F,d=E-y,df[0]=E-(y+d)+(d-F),b=x+y,d=b-x,S=x-(b-d)+(y-d),y=S-A,d=S-y,df[1]=S-(y+d)+(d-A),P=b+y,d=P-b,df[2]=b-(P-d)+(y-d),df[3]=P;let H=_Ae(4,df),N=LAe*o;if(H>=N||-H>=N||(d=e-D,a=e-(D+d)+(d-r),d=n-M,u=n-(M+d)+(d-r),d=t-O,l=t-(O+d)+(d-s),d=i-B,c=i-(B+d)+(d-s),a===0&&l===0&&u===0&&c===0)||(N=NAe*o+IAe*Math.abs(H),H+=D*c+B*a-(O*u+M*l),H>=N||-H>=N))return H;x=a*B,h=ki*a,p=h-(h-a),g=a-p,h=ki*B,m=h-(h-B),C=B-m,E=g*C-(x-p*m-g*m-p*C),A=l*M,h=ki*l,p=h-(h-l),g=l-p,h=ki*M,m=h-(h-M),C=M-m,F=g*C-(A-p*m-g*m-p*C),y=E-F,d=E-y,ji[0]=E-(y+d)+(d-F),b=x+y,d=b-x,S=x-(b-d)+(y-d),y=S-A,d=S-y,ji[1]=S-(y+d)+(d-A),P=b+y,d=P-b,ji[2]=b-(P-d)+(y-d),ji[3]=P;const L=NA(4,df,4,ji,fV);x=D*c,h=ki*D,p=h-(h-D),g=D-p,h=ki*c,m=h-(h-c),C=c-m,E=g*C-(x-p*m-g*m-p*C),A=O*u,h=ki*O,p=h-(h-O),g=O-p,h=ki*u,m=h-(h-u),C=u-m,F=g*C-(A-p*m-g*m-p*C),y=E-F,d=E-y,ji[0]=E-(y+d)+(d-F),b=x+y,d=b-x,S=x-(b-d)+(y-d),y=S-A,d=S-y,ji[1]=S-(y+d)+(d-A),P=b+y,d=P-b,ji[2]=b-(P-d)+(y-d),ji[3]=P;const G=NA(L,fV,4,ji,pV);x=a*c,h=ki*a,p=h-(h-a),g=a-p,h=ki*c,m=h-(h-c),C=c-m,E=g*C-(x-p*m-g*m-p*C),A=l*u,h=ki*l,p=h-(h-l),g=l-p,h=ki*u,m=h-(h-u),C=u-m,F=g*C-(A-p*m-g*m-p*C),y=E-F,d=E-y,ji[0]=E-(y+d)+(d-F),b=x+y,d=b-x,S=x-(b-d)+(y-d),y=S-A,d=S-y,ji[1]=S-(y+d)+(d-A),P=b+y,d=P-b,ji[2]=b-(P-d)+(y-d),ji[3]=P;const q=NA(G,pV,4,ji,gV);return gV[q-1]}function cw(e,t,n,i,r,s){const o=(t-s)*(n-r),a=(e-r)*(i-s),l=o-a,u=Math.abs(o+a);return Math.abs(l)>=OAe*u?l:-$Ae(e,t,n,i,r,s,u)}const mV=Math.pow(2,-52),dw=new Uint32Array(512);class TS{static from(t,n=VAe,i=WAe){const r=t.length,s=new Float64Array(r*2);for(let o=0;o<r;o++){const a=t[o];s[2*o]=n(a),s[2*o+1]=i(a)}return new TS(s)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const i=Math.max(2*n-5,0);this._triangles=new Uint32Array(i*3),this._halfedges=new Int32Array(i*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:i,_hullTri:r,_hullHash:s}=this,o=t.length>>1;let a=1/0,l=1/0,u=-1/0,c=-1/0;for(let D=0;D<o;D++){const M=t[2*D],O=t[2*D+1];M<a&&(a=M),O<l&&(l=O),M>u&&(u=M),O>c&&(c=O),this._ids[D]=D}const d=(a+u)/2,h=(l+c)/2;let p,g,m;for(let D=0,M=1/0;D<o;D++){const O=$A(d,h,t[2*D],t[2*D+1]);O<M&&(p=D,M=O)}const C=t[2*p],y=t[2*p+1];for(let D=0,M=1/0;D<o;D++){if(D===p)continue;const O=$A(C,y,t[2*D],t[2*D+1]);O<M&&O>0&&(g=D,M=O)}let b=t[2*g],S=t[2*g+1],x=1/0;for(let D=0;D<o;D++){if(D===p||D===g)continue;const M=zAe(C,y,b,S,t[2*D],t[2*D+1]);M<x&&(m=D,x=M)}let E=t[2*m],A=t[2*m+1];if(x===1/0){for(let O=0;O<o;O++)this._dists[O]=t[2*O]-t[0]||t[2*O+1]-t[1];kf(this._ids,this._dists,0,o-1);const D=new Uint32Array(o);let M=0;for(let O=0,B=-1/0;O<o;O++){const H=this._ids[O],N=this._dists[H];N>B&&(D[M++]=H,B=N)}this.hull=D.subarray(0,M),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(cw(C,y,b,S,E,A)<0){const D=g,M=b,O=S;g=m,b=E,S=A,m=D,E=M,A=O}const F=HAe(C,y,b,S,E,A);this._cx=F.x,this._cy=F.y;for(let D=0;D<o;D++)this._dists[D]=$A(t[2*D],t[2*D+1],F.x,F.y);kf(this._ids,this._dists,0,o-1),this._hullStart=p;let P=3;i[p]=n[m]=g,i[g]=n[p]=m,i[m]=n[g]=p,r[p]=0,r[g]=1,r[m]=2,s.fill(-1),s[this._hashKey(C,y)]=p,s[this._hashKey(b,S)]=g,s[this._hashKey(E,A)]=m,this.trianglesLen=0,this._addTriangle(p,g,m,-1,-1,-1);for(let D=0,M,O;D<this._ids.length;D++){const B=this._ids[D],H=t[2*B],N=t[2*B+1];if(D>0&&Math.abs(H-M)<=mV&&Math.abs(N-O)<=mV||(M=H,O=N,B===p||B===g||B===m))continue;let L=0;for(let ie=0,pe=this._hashKey(H,N);ie<this._hashSize&&(L=s[(pe+ie)%this._hashSize],!(L!==-1&&L!==i[L]));ie++);L=n[L];let G=L,q;for(;q=i[G],cw(H,N,t[2*G],t[2*G+1],t[2*q],t[2*q+1])>=0;)if(G=q,G===L){G=-1;break}if(G===-1)continue;let V=this._addTriangle(G,B,i[G],-1,-1,r[G]);r[B]=this._legalize(V+2),r[G]=V,P++;let U=i[G];for(;q=i[U],cw(H,N,t[2*U],t[2*U+1],t[2*q],t[2*q+1])<0;)V=this._addTriangle(U,B,q,r[B],-1,r[U]),r[B]=this._legalize(V+2),i[U]=U,P--,U=q;if(G===L)for(;q=n[G],cw(H,N,t[2*q],t[2*q+1],t[2*G],t[2*G+1])<0;)V=this._addTriangle(q,B,G,-1,r[G],r[q]),this._legalize(V+2),r[q]=V,i[G]=G,P--,G=q;this._hullStart=n[B]=G,i[G]=n[U]=B,i[B]=U,s[this._hashKey(H,N)]=B,s[this._hashKey(t[2*G],t[2*G+1])]=G}this.hull=new Uint32Array(P);for(let D=0,M=this._hullStart;D<P;D++)this.hull[D]=M,M=i[M];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(BAe(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:i,coords:r}=this;let s=0,o=0;for(;;){const a=i[t],l=t-t%3;if(o=l+(t+2)%3,a===-1){if(s===0)break;t=dw[--s];continue}const u=a-a%3,c=l+(t+1)%3,d=u+(a+2)%3,h=n[o],p=n[t],g=n[c],m=n[d];if(GAe(r[2*h],r[2*h+1],r[2*p],r[2*p+1],r[2*g],r[2*g+1],r[2*m],r[2*m+1])){n[t]=m,n[a]=h;const y=i[d];if(y===-1){let S=this._hullStart;do{if(this._hullTri[S]===d){this._hullTri[S]=t;break}S=this._hullPrev[S]}while(S!==this._hullStart)}this._link(t,y),this._link(a,i[o]),this._link(o,d);const b=u+(a+1)%3;s<dw.length&&(dw[s++]=b)}else{if(s===0)break;t=dw[--s]}}return o}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,i,r,s,o){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=n,this._triangles[a+2]=i,this._link(a,r),this._link(a+1,s),this._link(a+2,o),this.trianglesLen+=3,a}}function BAe(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function $A(e,t,n,i){const r=e-n,s=t-i;return r*r+s*s}function GAe(e,t,n,i,r,s,o,a){const l=e-o,u=t-a,c=n-o,d=i-a,h=r-o,p=s-a,g=l*l+u*u,m=c*c+d*d,C=h*h+p*p;return l*(d*C-m*p)-u*(c*C-m*h)+g*(c*p-d*h)<0}function zAe(e,t,n,i,r,s){const o=n-e,a=i-t,l=r-e,u=s-t,c=o*o+a*a,d=l*l+u*u,h=.5/(o*u-a*l),p=(u*c-a*d)*h,g=(o*d-l*c)*h;return p*p+g*g}function HAe(e,t,n,i,r,s){const o=n-e,a=i-t,l=r-e,u=s-t,c=o*o+a*a,d=l*l+u*u,h=.5/(o*u-a*l),p=e+(u*c-a*d)*h,g=t+(o*d-l*c)*h;return{x:p,y:g}}function kf(e,t,n,i){if(i-n<=20)for(let r=n+1;r<=i;r++){const s=e[r],o=t[s];let a=r-1;for(;a>=n&&t[e[a]]>o;)e[a+1]=e[a--];e[a+1]=s}else{const r=n+i>>1;let s=n+1,o=i;mm(e,r,s),t[e[n]]>t[e[i]]&&mm(e,n,i),t[e[s]]>t[e[i]]&&mm(e,s,i),t[e[n]]>t[e[s]]&&mm(e,n,s);const a=e[s],l=t[a];for(;;){do s++;while(t[e[s]]<l);do o--;while(t[e[o]]>l);if(o<s)break;mm(e,s,o)}e[n+1]=e[o],e[o]=a,i-s+1>=o-n?(kf(e,t,s,i),kf(e,t,n,o-1)):(kf(e,t,n,o-1),kf(e,t,s,i))}}function mm(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function VAe(e){return e[0]}function WAe(e){return e[1]}const vV=1e-6;class xd{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,i){t=+t,n=+n,i=+i;const r=t+i,s=n;if(i<0)throw new Error("negative radius");this._x1===null?this._+=`M${r},${s}`:(Math.abs(this._x1-r)>vV||Math.abs(this._y1-s)>vV)&&(this._+="L"+r+","+s),i&&(this._+=`A${i},${i},0,1,1,${t-i},${n}A${i},${i},0,1,1,${this._x1=r},${this._y1=s}`)}rect(t,n,i,r){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+i}v${+r}h${-i}Z`}value(){return this._||null}}class XP{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}let UAe=class{constructor(t,[n,i,r,s]=[0,0,960,500]){if(!((r=+r)>=(n=+n))||!((s=+s)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=r,this.xmin=n,this.ymax=s,this.ymin=i,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:i},vectors:r}=this;let s,o;const a=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let m=0,C=0,y=i.length,b,S;m<y;m+=3,C+=2){const x=i[m]*2,E=i[m+1]*2,A=i[m+2]*2,F=t[x],P=t[x+1],D=t[E],M=t[E+1],O=t[A],B=t[A+1],H=D-F,N=M-P,L=O-F,G=B-P,q=(H*G-N*L)*2;if(Math.abs(q)<1e-9){if(s===void 0){s=o=0;for(const U of n)s+=t[U*2],o+=t[U*2+1];s/=n.length,o/=n.length}const V=1e9*Math.sign((s-F)*G-(o-P)*L);b=(F+O)/2-V*G,S=(P+B)/2+V*L}else{const V=1/q,U=H*H+N*N,ie=L*L+G*G;b=F+(G*U-N*ie)*V,S=P+(H*ie-L*U)*V}a[C]=b,a[C+1]=S}let l=n[n.length-1],u,c=l*4,d,h=t[2*l],p,g=t[2*l+1];r.fill(0);for(let m=0;m<n.length;++m)l=n[m],u=c,d=h,p=g,c=l*4,h=t[2*l],g=t[2*l+1],r[u+2]=r[c]=p-g,r[u+3]=r[c+1]=h-d}render(t){const n=t==null?t=new xd:void 0,{delaunay:{halfedges:i,inedges:r,hull:s},circumcenters:o,vectors:a}=this;if(s.length<=1)return null;for(let c=0,d=i.length;c<d;++c){const h=i[c];if(h<c)continue;const p=Math.floor(c/3)*2,g=Math.floor(h/3)*2,m=o[p],C=o[p+1],y=o[g],b=o[g+1];this._renderSegment(m,C,y,b,t)}let l,u=s[s.length-1];for(let c=0;c<s.length;++c){l=u,u=s[c];const d=Math.floor(r[u]/3)*2,h=o[d],p=o[d+1],g=l*4,m=this._project(h,p,a[g+2],a[g+3]);m&&this._renderSegment(h,p,m[0],m[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new xd:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const i=n==null?n=new xd:void 0,r=this._clip(t);if(r===null||!r.length)return;n.moveTo(r[0],r[1]);let s=r.length;for(;r[0]===r[s-2]&&r[1]===r[s-1]&&s>1;)s-=2;for(let o=2;o<s;o+=2)(r[o]!==r[o-2]||r[o+1]!==r[o-1])&&n.lineTo(r[o],r[o+1]);return n.closePath(),i&&i.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,i=t.length/2;n<i;++n){const r=this.cellPolygon(n);r&&(r.index=n,yield r)}}cellPolygon(t){const n=new XP;return this.renderCell(t,n),n.value()}_renderSegment(t,n,i,r,s){let o;const a=this._regioncode(t,n),l=this._regioncode(i,r);a===0&&l===0?(s.moveTo(t,n),s.lineTo(i,r)):(o=this._clipSegment(t,n,i,r,a,l))&&(s.moveTo(o[0],o[1]),s.lineTo(o[2],o[3]))}contains(t,n,i){return n=+n,n!==n||(i=+i,i!==i)?!1:this.delaunay._step(t,n,i)===t}*neighbors(t){const n=this._clip(t);if(n)for(const i of this.delaunay.neighbors(t)){const r=this._clip(i);if(r){e:for(let s=0,o=n.length;s<o;s+=2)for(let a=0,l=r.length;a<l;a+=2)if(n[s]===r[a]&&n[s+1]===r[a+1]&&n[(s+2)%o]===r[(a+l-2)%l]&&n[(s+3)%o]===r[(a+l-1)%l]){yield i;break e}}}}_cell(t){const{circumcenters:n,delaunay:{inedges:i,halfedges:r,triangles:s}}=this,o=i[t];if(o===-1)return null;const a=[];let l=o;do{const u=Math.floor(l/3);if(a.push(n[u*2],n[u*2+1]),l=l%3===2?l-2:l+1,s[l]!==t)break;l=r[l]}while(l!==o&&l!==-1);return a}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:i}=this,r=t*4;return this._simplify(i[r]||i[r+1]?this._clipInfinite(t,n,i[r],i[r+1],i[r+2],i[r+3]):this._clipFinite(t,n))}_clipFinite(t,n){const i=n.length;let r=null,s,o,a=n[i-2],l=n[i-1],u,c=this._regioncode(a,l),d,h=0;for(let p=0;p<i;p+=2)if(s=a,o=l,a=n[p],l=n[p+1],u=c,c=this._regioncode(a,l),u===0&&c===0)d=h,h=0,r?r.push(a,l):r=[a,l];else{let g,m,C,y,b;if(u===0){if((g=this._clipSegment(s,o,a,l,u,c))===null)continue;[m,C,y,b]=g}else{if((g=this._clipSegment(a,l,s,o,c,u))===null)continue;[y,b,m,C]=g,d=h,h=this._edgecode(m,C),d&&h&&this._edge(t,d,h,r,r.length),r?r.push(m,C):r=[m,C]}d=h,h=this._edgecode(y,b),d&&h&&this._edge(t,d,h,r,r.length),r?r.push(y,b):r=[y,b]}if(r)d=h,h=this._edgecode(r[0],r[1]),d&&h&&this._edge(t,d,h,r,r.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return r}_clipSegment(t,n,i,r,s,o){const a=s<o;for(a&&([t,n,i,r,s,o]=[i,r,t,n,o,s]);;){if(s===0&&o===0)return a?[i,r,t,n]:[t,n,i,r];if(s&o)return null;let l,u,c=s||o;c&8?(l=t+(i-t)*(this.ymax-n)/(r-n),u=this.ymax):c&4?(l=t+(i-t)*(this.ymin-n)/(r-n),u=this.ymin):c&2?(u=n+(r-n)*(this.xmax-t)/(i-t),l=this.xmax):(u=n+(r-n)*(this.xmin-t)/(i-t),l=this.xmin),s?(t=l,n=u,s=this._regioncode(t,n)):(i=l,r=u,o=this._regioncode(i,r))}}_clipInfinite(t,n,i,r,s,o){let a=Array.from(n),l;if((l=this._project(a[0],a[1],i,r))&&a.unshift(l[0],l[1]),(l=this._project(a[a.length-2],a[a.length-1],s,o))&&a.push(l[0],l[1]),a=this._clipFinite(t,a))for(let u=0,c=a.length,d,h=this._edgecode(a[c-2],a[c-1]);u<c;u+=2)d=h,h=this._edgecode(a[u],a[u+1]),d&&h&&(u=this._edge(t,d,h,a,u),c=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,n,i,r,s){for(;n!==i;){let o,a;switch(n){case 5:n=4;continue;case 4:n=6,o=this.xmax,a=this.ymin;break;case 6:n=2;continue;case 2:n=10,o=this.xmax,a=this.ymax;break;case 10:n=8;continue;case 8:n=9,o=this.xmin,a=this.ymax;break;case 9:n=1;continue;case 1:n=5,o=this.xmin,a=this.ymin;break}(r[s]!==o||r[s+1]!==a)&&this.contains(t,o,a)&&(r.splice(s,0,o,a),s+=2)}return s}_project(t,n,i,r){let s=1/0,o,a,l;if(r<0){if(n<=this.ymin)return null;(o=(this.ymin-n)/r)<s&&(l=this.ymin,a=t+(s=o)*i)}else if(r>0){if(n>=this.ymax)return null;(o=(this.ymax-n)/r)<s&&(l=this.ymax,a=t+(s=o)*i)}if(i>0){if(t>=this.xmax)return null;(o=(this.xmax-t)/i)<s&&(a=this.xmax,l=n+(s=o)*r)}else if(i<0){if(t<=this.xmin)return null;(o=(this.xmin-t)/i)<s&&(a=this.xmin,l=n+(s=o)*r)}return[a,l]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}_simplify(t){if(t&&t.length>4){for(let n=0;n<t.length;n+=2){const i=(n+2)%t.length,r=(n+4)%t.length;(t[n]===t[i]&&t[i]===t[r]||t[n+1]===t[i+1]&&t[i+1]===t[r+1])&&(t.splice(i,2),n-=2)}t.length||(t=null)}return t}};const qAe=2*Math.PI,hf=Math.pow;function jAe(e){return e[0]}function KAe(e){return e[1]}function YAe(e){const{triangles:t,coords:n}=e;for(let i=0;i<t.length;i+=3){const r=2*t[i],s=2*t[i+1],o=2*t[i+2];if((n[o]-n[r])*(n[s+1]-n[r+1])-(n[s]-n[r])*(n[o+1]-n[r+1])>1e-10)return!1}return!0}function XAe(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class W2{static from(t,n=jAe,i=KAe,r){return new W2("length"in t?QAe(t,n,i,r):Float64Array.from(ZAe(t,n,i,r)))}constructor(t){this._delaunator=new TS(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&YAe(t)){this.collinear=Int32Array.from({length:n.length/2},(h,p)=>p).sort((h,p)=>n[2*h]-n[2*p]||n[2*h+1]-n[2*p+1]);const l=this.collinear[0],u=this.collinear[this.collinear.length-1],c=[n[2*l],n[2*l+1],n[2*u],n[2*u+1]],d=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let h=0,p=n.length/2;h<p;++h){const g=XAe(n[2*h],n[2*h+1],d);n[2*h]=g[0],n[2*h+1]=g[1]}this._delaunator=new TS(n)}else delete this.collinear;const i=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let l=0,u=i.length;l<u;++l){const c=s[l%3===2?l-2:l+1];(i[l]===-1||o[c]===-1)&&(o[c]=l)}for(let l=0,u=r.length;l<u;++l)a[r[l]]=l;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],o[r[0]]=1,r.length===2&&(o[r[1]]=0,this.triangles[1]=r[1],this.triangles[2]=r[1]))}voronoi(t){return new UAe(this,t)}*neighbors(t){const{inedges:n,hull:i,_hullIndex:r,halfedges:s,triangles:o,collinear:a}=this;if(a){const d=a.indexOf(t);d>0&&(yield a[d-1]),d<a.length-1&&(yield a[d+1]);return}const l=n[t];if(l===-1)return;let u=l,c=-1;do{if(yield c=o[u],u=u%3===2?u-2:u+1,o[u]!==t)return;if(u=s[u],u===-1){const d=i[(r[t]+1)%i.length];d!==c&&(yield d);return}}while(u!==l)}find(t,n,i=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const r=i;let s;for(;(s=this._step(i,t,n))>=0&&s!==i&&s!==r;)i=s;return s}_step(t,n,i){const{inedges:r,hull:s,_hullIndex:o,halfedges:a,triangles:l,points:u}=this;if(r[t]===-1||!u.length)return(t+1)%(u.length>>1);let c=t,d=hf(n-u[t*2],2)+hf(i-u[t*2+1],2);const h=r[t];let p=h;do{let g=l[p];const m=hf(n-u[g*2],2)+hf(i-u[g*2+1],2);if(m<d&&(d=m,c=g),p=p%3===2?p-2:p+1,l[p]!==t)break;if(p=a[p],p===-1){if(p=s[(o[t]+1)%s.length],p!==g&&hf(n-u[p*2],2)+hf(i-u[p*2+1],2)<d)return p;break}}while(p!==h);return c}render(t){const n=t==null?t=new xd:void 0,{points:i,halfedges:r,triangles:s}=this;for(let o=0,a=r.length;o<a;++o){const l=r[o];if(l<o)continue;const u=s[o]*2,c=s[l]*2;t.moveTo(i[u],i[u+1]),t.lineTo(i[c],i[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n){n===void 0&&(!t||typeof t.moveTo!="function")&&(n=t,t=null),n=n==null?2:+n;const i=t==null?t=new xd:void 0,{points:r}=this;for(let s=0,o=r.length;s<o;s+=2){const a=r[s],l=r[s+1];t.moveTo(a+n,l),t.arc(a,l,n,0,qAe)}return i&&i.value()}renderHull(t){const n=t==null?t=new xd:void 0,{hull:i,points:r}=this,s=i[0]*2,o=i.length;t.moveTo(r[s],r[s+1]);for(let a=1;a<o;++a){const l=2*i[a];t.lineTo(r[l],r[l+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new XP;return this.renderHull(t),t.value()}renderTriangle(t,n){const i=n==null?n=new xd:void 0,{points:r,triangles:s}=this,o=s[t*=3]*2,a=s[t+1]*2,l=s[t+2]*2;return n.moveTo(r[o],r[o+1]),n.lineTo(r[a],r[a+1]),n.lineTo(r[l],r[l+1]),n.closePath(),i&&i.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,i=t.length/3;n<i;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new XP;return this.renderTriangle(t,n),n.value()}}function QAe(e,t,n,i){const r=e.length,s=new Float64Array(r*2);for(let o=0;o<r;++o){const a=e[o];s[o*2]=t.call(i,a,o,e),s[o*2+1]=n.call(i,a,o,e)}return s}function*ZAe(e,t,n,i){let r=0;for(const s of e)yield t.call(i,s,r,e),yield n.call(i,s,r,e),++r}function U2(e){Q.call(this,null,e)}U2.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const JAe=[-1e5,-1e5,1e5,1e5];me(U2,Q,{transform(e,t){const n=e.as||"path",i=t.source;if(!i||!i.length)return t;let r=e.size;r=r?[0,0,r[0],r[1]]:(r=e.extent)?[r[0][0],r[0][1],r[1][0],r[1][1]]:JAe;const s=this.value=W2.from(i,e.x,e.y).voronoi(r);for(let o=0,a=i.length;o<a;++o){const l=s.cellPolygon(o);i[o][n]=l&&!tDe(l)?eDe(l):null}return t.reflow(e.modified()).modifies(n)}});function eDe(e){const t=e[0][0],n=e[0][1];let i=e.length-1;for(;e[i][0]===t&&e[i][1]===n;--i);return"M"+e.slice(0,i+1).join("L")+"Z"}function tDe(e){return e.length===2&&e[0][0]===e[1][0]&&e[0][1]===e[1][1]}const nDe=Object.freeze(Object.defineProperty({__proto__:null,voronoi:U2},Symbol.toStringTag,{value:"Module"}));var BA=Math.PI/180,nv=64,ob=2048;function iDe(){var e=[256,256],t,n,i,r,s,o,a,l=qK,u=[],c=Math.random,d={};d.layout=function(){for(var g=h(ju()),m=uDe((e[0]>>5)*e[1]),C=null,y=u.length,b=-1,S=[],x=u.map(A=>({text:t(A),font:n(A),style:r(A),weight:s(A),rotate:o(A),size:~~(i(A)+1e-14),padding:a(A),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:A})).sort((A,F)=>F.size-A.size);++b<y;){var E=x[b];E.x=e[0]*(c()+.5)>>1,E.y=e[1]*(c()+.5)>>1,rDe(g,E,x,b),E.hasText&&p(m,E,C)&&(S.push(E),C?oDe(C,E):C=[{x:E.x+E.x0,y:E.y+E.y0},{x:E.x+E.x1,y:E.y+E.y1}],E.x-=e[0]>>1,E.y-=e[1]>>1)}return S};function h(g){g.width=g.height=1;var m=Math.sqrt(g.getContext("2d").getImageData(0,0,1,1).data.length>>2);g.width=(nv<<5)/m,g.height=ob/m;var C=g.getContext("2d");return C.fillStyle=C.strokeStyle="red",C.textAlign="center",{context:C,ratio:m}}function p(g,m,C){for(var y=m.x,b=m.y,S=Math.hypot(e[0],e[1]),x=l(e),E=c()<.5?1:-1,A=-E,F,P,D;(F=x(A+=E))&&(P=~~F[0],D=~~F[1],!(Math.min(Math.abs(P),Math.abs(D))>=S));)if(m.x=y+P,m.y=b+D,!(m.x+m.x0<0||m.y+m.y0<0||m.x+m.x1>e[0]||m.y+m.y1>e[1])&&(!C||!sDe(m,g,e[0]))&&(!C||aDe(m,C))){for(var M=m.sprite,O=m.width>>5,B=e[0]>>5,H=m.x-(O<<4),N=H&127,L=32-N,G=m.y1-m.y0,q=(m.y+m.y0)*B+(H>>5),V,U=0;U<G;U++){V=0;for(var ie=0;ie<=O;ie++)g[q+ie]|=V<<L|(ie<O?(V=M[U*O+ie])>>>N:0);q+=B}return m.sprite=null,!0}return!1}return d.words=function(g){return arguments.length?(u=g,d):u},d.size=function(g){return arguments.length?(e=[+g[0],+g[1]],d):e},d.font=function(g){return arguments.length?(n=Jc(g),d):n},d.fontStyle=function(g){return arguments.length?(r=Jc(g),d):r},d.fontWeight=function(g){return arguments.length?(s=Jc(g),d):s},d.rotate=function(g){return arguments.length?(o=Jc(g),d):o},d.text=function(g){return arguments.length?(t=Jc(g),d):t},d.spiral=function(g){return arguments.length?(l=cDe[g]||g,d):l},d.fontSize=function(g){return arguments.length?(i=Jc(g),d):i},d.padding=function(g){return arguments.length?(a=Jc(g),d):a},d.random=function(g){return arguments.length?(c=g,d):c},d}function rDe(e,t,n,i){if(!t.sprite){var r=e.context,s=e.ratio;r.clearRect(0,0,(nv<<5)/s,ob/s);var o=0,a=0,l=0,u=n.length,c,d,h,p,g;for(--i;++i<u;){if(t=n[i],r.save(),r.font=t.style+" "+t.weight+" "+~~((t.size+1)/s)+"px "+t.font,c=r.measureText(t.text+"m").width*s,h=t.size<<1,t.rotate){var m=Math.sin(t.rotate*BA),C=Math.cos(t.rotate*BA),y=c*C,b=c*m,S=h*C,x=h*m;c=Math.max(Math.abs(y+x),Math.abs(y-x))+31>>5<<5,h=~~Math.max(Math.abs(b+S),Math.abs(b-S))}else c=c+31>>5<<5;if(h>l&&(l=h),o+c>=nv<<5&&(o=0,a+=l,l=0),a+h>=ob)break;r.translate((o+(c>>1))/s,(a+(h>>1))/s),t.rotate&&r.rotate(t.rotate*BA),r.fillText(t.text,0,0),t.padding&&(r.lineWidth=2*t.padding,r.strokeText(t.text,0,0)),r.restore(),t.width=c,t.height=h,t.xoff=o,t.yoff=a,t.x1=c>>1,t.y1=h>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,o+=c}for(var E=r.getImageData(0,0,(nv<<5)/s,ob/s).data,A=[];--i>=0;)if(t=n[i],!!t.hasText){for(c=t.width,d=c>>5,h=t.y1-t.y0,p=0;p<h*d;p++)A[p]=0;if(o=t.xoff,o==null)return;a=t.yoff;var F=0,P=-1;for(g=0;g<h;g++){for(p=0;p<c;p++){var D=d*g+(p>>5),M=E[(a+g)*(nv<<5)+(o+p)<<2]?1<<31-p%32:0;A[D]|=M,F|=M}F?P=g:(t.y0++,h--,g--,a++)}t.y1=t.y0+P,t.sprite=A.slice(0,(t.y1-t.y0)*d)}}}function sDe(e,t,n){n>>=5;for(var i=e.sprite,r=e.width>>5,s=e.x-(r<<4),o=s&127,a=32-o,l=e.y1-e.y0,u=(e.y+e.y0)*n+(s>>5),c,d=0;d<l;d++){c=0;for(var h=0;h<=r;h++)if((c<<a|(h<r?(c=i[d*r+h])>>>o:0))&t[u+h])return!0;u+=n}return!1}function oDe(e,t){var n=e[0],i=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>i.x&&(i.x=t.x+t.x1),t.y+t.y1>i.y&&(i.y=t.y+t.y1)}function aDe(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function qK(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function lDe(e){var t=4,n=t*e[0]/e[1],i=0,r=0;return function(s){var o=s<0?-1:1;switch(Math.sqrt(1+4*o*s)-o&3){case 0:i+=n;break;case 1:r+=t;break;case 2:i-=n;break;default:r-=t;break}return[i,r]}}function uDe(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function Jc(e){return typeof e=="function"?e:function(){return e}}var cDe={archimedean:qK,rectangular:lDe};const jK=["x","y","font","fontSize","fontStyle","fontWeight","angle"],dDe=["text","font","rotate","fontSize","fontStyle","fontWeight"];function q2(e){Q.call(this,iDe(),e)}q2.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:jK}]};me(q2,Q,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&te("Wordcloud size dimensions must be non-zero.");function n(g){const m=e[g];return ot(m)&&t.modified(m.fields)}const i=e.modified();if(!(i||t.changed(t.ADD_REM)||dDe.some(n)))return;const r=t.materialize(t.SOURCE).source,s=this.value,o=e.as||jK;let a=e.fontSize||14,l;if(ot(a)?l=e.fontSizeRange:a=Hi(a),l){const g=a,m=Mt("sqrt")().domain(Ea(r,g)).range(l);a=C=>m(g(C))}r.forEach(g=>{g[o[0]]=NaN,g[o[1]]=NaN,g[o[3]]=0});const u=s.words(r).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(a).random(Vs).layout(),c=s.size(),d=c[0]>>1,h=c[1]>>1,p=u.length;for(let g=0,m,C;g<p;++g)m=u[g],C=m.datum,C[o[0]]=m.x+d,C[o[1]]=m.y+h,C[o[2]]=m.font,C[o[3]]=m.size,C[o[4]]=m.style,C[o[5]]=m.weight,C[o[6]]=m.rotate;return t.reflow(i).modifies(o)}});const hDe=Object.freeze(Object.defineProperty({__proto__:null,wordcloud:q2},Symbol.toStringTag,{value:"Module"})),fDe=e=>new Uint8Array(e),pDe=e=>new Uint16Array(e),bv=e=>new Uint32Array(e);function gDe(){let e=8,t=[],n=bv(0),i=hw(0,e),r=hw(0,e);return{data:()=>t,seen:()=>n=mDe(n,t.length),add(s){for(let o=0,a=t.length,l=s.length,u;o<l;++o)u=s[o],u._index=a++,t.push(u)},remove(s,o){const a=t.length,l=Array(a-s),u=t;let c,d,h;for(d=0;!o[d]&&d<a;++d)l[d]=t[d],u[d]=d;for(h=d;d<a;++d)c=t[d],o[d]?u[d]=-1:(u[d]=h,i[h]=i[d],r[h]=r[d],l[h]=c,c._index=h++),i[d]=0;return t=l,u},size:()=>t.length,curr:()=>i,prev:()=>r,reset:s=>r[s]=i[s],all:()=>e<257?255:e<65537?65535:4294967295,set(s,o){i[s]|=o},clear(s,o){i[s]&=~o},resize(s,o){const a=i.length;(s>a||o>e)&&(e=Math.max(o,e),i=hw(s,e,i),r=hw(s,e))}}}function mDe(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function hw(e,t,n){const i=(t<257?fDe:t<65537?pDe:bv)(e);return n&&i.set(n),i}function CV(e,t,n){const i=1<<t;return{one:i,zero:~i,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(r,s){const o=this,a=o.bisect(o.range,r.value),l=r.index,u=a[0],c=a[1],d=l.length;let h;for(h=0;h<u;++h)s[l[h]]|=i;for(h=c;h<d;++h)s[l[h]]|=i;return o}}}function yV(){let e=bv(0),t=[],n=0;function i(a,l,u){if(!l.length)return[];const c=n,d=l.length,h=bv(d);let p=Array(d),g,m,C;for(C=0;C<d;++C)p[C]=a(l[C]),h[C]=C;if(p=vDe(p,h),c)g=t,m=e,t=Array(c+d),e=bv(c+d),CDe(u,g,m,c,p,h,d,t,e);else{if(u>0)for(C=0;C<d;++C)h[C]+=u;t=p,e=h}return n=c+d,{index:h,value:p}}function r(a,l){const u=n;let c,d,h;for(d=0;!l[e[d]]&&d<u;++d);for(h=d;d<u;++d)l[c=e[d]]||(e[h]=c,t[h]=t[d],++h);n=u-a}function s(a){for(let l=0,u=n;l<u;++l)e[l]=a[e[l]]}function o(a,l){let u;return l?u=l.length:(l=t,u=n),[bge(l,a[0],0,u),Zu(l,a[1],0,u)]}return{insert:i,remove:r,bisect:o,reindex:s,index:()=>e,size:()=>n}}function vDe(e,t){return e.sort.call(t,(n,i)=>{const r=e[n],s=e[i];return r<s?-1:r>s?1:0}),Rge(e,t)}function CDe(e,t,n,i,r,s,o,a,l){let u=0,c=0,d;for(d=0;u<i&&c<o;++d)t[u]<r[c]?(a[d]=t[u],l[d]=n[u++]):(a[d]=r[c],l[d]=s[c++]+e);for(;u<i;++u,++d)a[d]=t[u],l[d]=n[u];for(;c<o;++c,++d)a[d]=r[c],l[d]=s[c]+e}function j2(e){Q.call(this,gDe(),e),this._indices=null,this._dims=null}j2.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};me(j2,Q,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(i=>t.modified(i.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,i=e.query,r=this._indices={},s=this._dims=[],o=i.length;let a=0,l,u;for(;a<o;++a)l=n[a].fname,u=r[l]||(r[l]=yV()),s.push(CV(u,a,i[a]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),i=e.fields,r=e.query,s=this._indices,o=this._dims,a=this.value,l=a.curr(),u=a.prev(),c=a.all(),d=n.rem=n.add,h=n.mod,p=r.length,g={};let m,C,y,b,S,x,E,A,F;if(u.set(l),t.rem.length&&(S=this.remove(e,t,n)),t.add.length&&a.add(t.add),t.mod.length)for(x={},b=t.mod,E=0,A=b.length;E<A;++E)x[b[E]._index]=1;for(E=0;E<p;++E)F=i[E],(!o[E]||e.modified("fields",E)||t.modified(F.fields))&&(y=F.fname,(m=g[y])||(s[y]=C=yV(),g[y]=m=C.insert(F,t.source,0)),o[E]=CV(C,E,r[E]).onAdd(m,l));for(E=0,A=a.data().length;E<A;++E)S[E]||(u[E]!==l[E]?d.push(E):x[E]&&l[E]!==c&&h.push(E));return a.mask=(1<<p)-1,n},eval(e,t){const n=t.materialize().fork(),i=this._dims.length;let r=0;return t.rem.length&&(this.remove(e,t,n),r|=(1<<i)-1),e.modified("query")&&!e.modified("fields")&&(r|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),r|=(1<<i)-1),t.mod.length&&(this.modify(t,n),r|=(1<<i)-1),this.value.mask=r,n},insert(e,t,n){const i=t.add,r=this.value,s=this._dims,o=this._indices,a=e.fields,l={},u=n.add,c=r.size()+i.length,d=s.length;let h=r.size(),p,g,m;r.resize(c,d),r.add(i);const C=r.curr(),y=r.prev(),b=r.all();for(p=0;p<d;++p)g=a[p].fname,m=l[g]||(l[g]=o[g].insert(a[p],i,h)),s[p].onAdd(m,C);for(;h<c;++h)y[h]=b,C[h]!==b&&u.push(h)},modify(e,t){const n=t.mod,i=this.value,r=i.curr(),s=i.all(),o=e.mod;let a,l,u;for(a=0,l=o.length;a<l;++a)u=o[a]._index,r[u]!==s&&n.push(u)},remove(e,t,n){const i=this._indices,r=this.value,s=r.curr(),o=r.prev(),a=r.all(),l={},u=n.rem,c=t.rem;let d,h,p,g;for(d=0,h=c.length;d<h;++d)p=c[d]._index,l[p]=1,o[p]=g=s[p],s[p]=a,g!==a&&u.push(p);for(p in i)i[p].remove(h,l);return this.reindex(t,h,l),l},reindex(e,t,n){const i=this._indices,r=this.value;e.runAfter(()=>{const s=r.remove(t,n);for(const o in i)i[o].reindex(s)})},update(e,t,n){const i=this._dims,r=e.query,s=t.stamp,o=i.length;let a=0,l,u;for(n.filters=0,u=0;u<o;++u)e.modified("query",u)&&(l=u,++a);if(a===1)a=i[l].one,this.incrementOne(i[l],r[l],n.add,n.rem);else for(u=0,a=0;u<o;++u)e.modified("query",u)&&(a|=i[u].one,this.incrementAll(i[u],r[u],s,n.add),n.rem=n.add);return a},incrementAll(e,t,n,i){const r=this.value,s=r.seen(),o=r.curr(),a=r.prev(),l=e.index(),u=e.bisect(e.range),c=e.bisect(t),d=c[0],h=c[1],p=u[0],g=u[1],m=e.one;let C,y,b;if(d<p)for(C=d,y=Math.min(p,h);C<y;++C)b=l[C],s[b]!==n&&(a[b]=o[b],s[b]=n,i.push(b)),o[b]^=m;else if(d>p)for(C=p,y=Math.min(d,g);C<y;++C)b=l[C],s[b]!==n&&(a[b]=o[b],s[b]=n,i.push(b)),o[b]^=m;if(h>g)for(C=Math.max(d,g),y=h;C<y;++C)b=l[C],s[b]!==n&&(a[b]=o[b],s[b]=n,i.push(b)),o[b]^=m;else if(h<g)for(C=Math.max(p,h),y=g;C<y;++C)b=l[C],s[b]!==n&&(a[b]=o[b],s[b]=n,i.push(b)),o[b]^=m;e.range=t.slice()},incrementOne(e,t,n,i){const r=this.value,s=r.curr(),o=e.index(),a=e.bisect(e.range),l=e.bisect(t),u=l[0],c=l[1],d=a[0],h=a[1],p=e.one;let g,m,C;if(u<d)for(g=u,m=Math.min(d,c);g<m;++g)C=o[g],s[C]^=p,n.push(C);else if(u>d)for(g=d,m=Math.min(u,h);g<m;++g)C=o[g],s[C]^=p,i.push(C);if(c>h)for(g=Math.max(u,h),m=c;g<m;++g)C=o[g],s[C]^=p,n.push(C);else if(c<h)for(g=Math.max(d,c),m=h;g<m;++g)C=o[g],s[C]^=p,i.push(C);e.range=t.slice()}});function K2(e){Q.call(this,null,e)}K2.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};me(K2,Q,{transform(e,t){const n=~(e.ignore||0),i=e.filter,r=i.mask;if(!(r&n))return t.StopPropagation;const s=t.fork(t.ALL),o=i.data(),a=i.curr(),l=i.prev(),u=c=>a[c]&n?null:o[c];return s.filter(s.MOD,u),r&r-1?(s.filter(s.ADD,c=>{const d=a[c]&n;return!d&&d^l[c]&n?o[c]:null}),s.filter(s.REM,c=>{const d=a[c]&n;return d&&!(d^(d^l[c]&n))?o[c]:null})):(s.filter(s.ADD,u),s.filter(s.REM,c=>(a[c]&n)===r?o[c]:null)),s.filter(s.SOURCE,c=>u(c._index))}});const yDe=Object.freeze(Object.defineProperty({__proto__:null,crossfilter:j2,resolvefilter:K2},Symbol.toStringTag,{value:"Module"})),wDe="RawCode",Zd="Literal",bDe="Property",SDe="Identifier",xDe="ArrayExpression",RDe="BinaryExpression",KK="CallExpression",EDe="ConditionalExpression",FDe="LogicalExpression",ADe="MemberExpression",DDe="ObjectExpression",kDe="UnaryExpression";function $o(e){this.type=e}$o.prototype.visit=function(e){let t,n,i;if(e(this))return 1;for(t=PDe(this),n=0,i=t.length;n<i;++n)if(t[n].visit(e))return 1};function PDe(e){switch(e.type){case xDe:return e.elements;case RDe:case FDe:return[e.left,e.right];case KK:return[e.callee].concat(e.arguments);case EDe:return[e.test,e.consequent,e.alternate];case ADe:return[e.object,e.property];case DDe:return e.properties;case bDe:return[e.key,e.value];case kDe:return[e.argument];case SDe:case Zd:case wDe:default:return[]}}var Ba,Te,J,$i,Bt,Ox=1,fC=2,Jd=3,Rc=4,Lx=5,xh=6,xr=7,pC=8,MDe=9;Ba={};Ba[Ox]="Boolean";Ba[fC]="<end>";Ba[Jd]="Identifier";Ba[Rc]="Keyword";Ba[Lx]="Null";Ba[xh]="Numeric";Ba[xr]="Punctuator";Ba[pC]="String";Ba[MDe]="RegularExpression";var TDe="ArrayExpression",IDe="BinaryExpression",_De="CallExpression",ODe="ConditionalExpression",YK="Identifier",LDe="Literal",NDe="LogicalExpression",$De="MemberExpression",BDe="ObjectExpression",GDe="Property",zDe="UnaryExpression",ni="Unexpected token %0",HDe="Unexpected number",VDe="Unexpected string",WDe="Unexpected identifier",UDe="Unexpected reserved word",qDe="Unexpected end of input",QP="Invalid regular expression",GA="Invalid regular expression: missing /",XK="Octal literals are not allowed in strict mode.",jDe="Duplicate data property in object literal not allowed in strict mode",Ci="ILLEGAL",r0="Disabled.",KDe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),YDe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function Nx(e,t){if(!e)throw new Error("ASSERT: "+t)}function hl(e){return e>=48&&e<=57}function Y2(e){return"0123456789abcdefABCDEF".includes(e)}function Sv(e){return"01234567".includes(e)}function XDe(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].includes(e)}function s0(e){return e===10||e===13||e===8232||e===8233}function gC(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&KDe.test(String.fromCharCode(e))}function IS(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&YDe.test(String.fromCharCode(e))}const QDe={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function QK(){for(;J<$i;){const e=Te.charCodeAt(J);if(XDe(e)||s0(e))++J;else break}}function ZP(e){var t,n,i,r=0;for(n=e==="u"?4:2,t=0;t<n;++t)J<$i&&Y2(Te[J])?(i=Te[J++],r=r*16+"0123456789abcdef".indexOf(i.toLowerCase())):Dt({},ni,Ci);return String.fromCharCode(r)}function ZDe(){var e,t,n,i;for(e=Te[J],t=0,e==="}"&&Dt({},ni,Ci);J<$i&&(e=Te[J++],!!Y2(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&Dt({},ni,Ci),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,i=(t-65536&1023)+56320,String.fromCharCode(n,i))}function ZK(){var e,t;for(e=Te.charCodeAt(J++),t=String.fromCharCode(e),e===92&&(Te.charCodeAt(J)!==117&&Dt({},ni,Ci),++J,e=ZP("u"),(!e||e==="\\"||!gC(e.charCodeAt(0)))&&Dt({},ni,Ci),t=e);J<$i&&(e=Te.charCodeAt(J),!!IS(e));)++J,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),Te.charCodeAt(J)!==117&&Dt({},ni,Ci),++J,e=ZP("u"),(!e||e==="\\"||!IS(e.charCodeAt(0)))&&Dt({},ni,Ci),t+=e);return t}function JDe(){var e,t;for(e=J++;J<$i;){if(t=Te.charCodeAt(J),t===92)return J=e,ZK();if(IS(t))++J;else break}return Te.slice(e,J)}function eke(){var e,t,n;return e=J,t=Te.charCodeAt(J)===92?ZK():JDe(),t.length===1?n=Jd:QDe.hasOwnProperty(t)?n=Rc:t==="null"?n=Lx:t==="true"||t==="false"?n=Ox:n=Jd,{type:n,value:t,start:e,end:J}}function zA(){var e=J,t=Te.charCodeAt(J),n,i=Te[J],r,s,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++J,{type:xr,value:String.fromCharCode(t),start:e,end:J};default:if(n=Te.charCodeAt(J+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return J+=2,{type:xr,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:J};case 33:case 61:return J+=2,Te.charCodeAt(J)===61&&++J,{type:xr,value:Te.slice(e,J),start:e,end:J}}}if(o=Te.substr(J,4),o===">>>=")return J+=4,{type:xr,value:o,start:e,end:J};if(s=o.substr(0,3),s===">>>"||s==="<<="||s===">>=")return J+=3,{type:xr,value:s,start:e,end:J};if(r=s.substr(0,2),i===r[1]&&"+-<>&|".includes(i)||r==="=>")return J+=2,{type:xr,value:r,start:e,end:J};if(r==="//"&&Dt({},ni,Ci),"<>=!+-*%&|^/".includes(i))return++J,{type:xr,value:i,start:e,end:J};Dt({},ni,Ci)}function tke(e){let t="";for(;J<$i&&Y2(Te[J]);)t+=Te[J++];return t.length===0&&Dt({},ni,Ci),gC(Te.charCodeAt(J))&&Dt({},ni,Ci),{type:xh,value:parseInt("0x"+t,16),start:e,end:J}}function nke(e){let t="0"+Te[J++];for(;J<$i&&Sv(Te[J]);)t+=Te[J++];return(gC(Te.charCodeAt(J))||hl(Te.charCodeAt(J)))&&Dt({},ni,Ci),{type:xh,value:parseInt(t,8),octal:!0,start:e,end:J}}function wV(){var e,t,n;if(n=Te[J],Nx(hl(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=J,e="",n!=="."){if(e=Te[J++],n=Te[J],e==="0"){if(n==="x"||n==="X")return++J,tke(t);if(Sv(n))return nke(t);n&&hl(n.charCodeAt(0))&&Dt({},ni,Ci)}for(;hl(Te.charCodeAt(J));)e+=Te[J++];n=Te[J]}if(n==="."){for(e+=Te[J++];hl(Te.charCodeAt(J));)e+=Te[J++];n=Te[J]}if(n==="e"||n==="E")if(e+=Te[J++],n=Te[J],(n==="+"||n==="-")&&(e+=Te[J++]),hl(Te.charCodeAt(J)))for(;hl(Te.charCodeAt(J));)e+=Te[J++];else Dt({},ni,Ci);return gC(Te.charCodeAt(J))&&Dt({},ni,Ci),{type:xh,value:parseFloat(e),start:t,end:J}}function ike(){var e="",t,n,i,r,s=!1;for(t=Te[J],Nx(t==="'"||t==='"',"String literal must starts with a quote"),n=J,++J;J<$i;)if(i=Te[J++],i===t){t="";break}else if(i==="\\")if(i=Te[J++],!i||!s0(i.charCodeAt(0)))switch(i){case"u":case"x":Te[J]==="{"?(++J,e+=ZDe()):e+=ZP(i);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Sv(i)?(r="01234567".indexOf(i),r!==0&&(s=!0),J<$i&&Sv(Te[J])&&(s=!0,r=r*8+"01234567".indexOf(Te[J++]),"0123".includes(i)&&J<$i&&Sv(Te[J])&&(r=r*8+"01234567".indexOf(Te[J++]))),e+=String.fromCharCode(r)):e+=i;break}else i==="\r"&&Te[J]===`
`&&++J;else{if(s0(i.charCodeAt(0)))break;e+=i}return t!==""&&Dt({},ni,Ci),{type:pC,value:e,octal:s,start:n,end:J}}function rke(e,t){let n=e;t.includes("u")&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(i,r)=>{if(parseInt(r,16)<=1114111)return"x";Dt({},QP)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{Dt({},QP)}try{return new RegExp(e,t)}catch{return null}}function ske(){var e,t,n,i,r;for(e=Te[J],Nx(e==="/","Regular expression literal must start with a slash"),t=Te[J++],n=!1,i=!1;J<$i;)if(e=Te[J++],t+=e,e==="\\")e=Te[J++],s0(e.charCodeAt(0))&&Dt({},GA),t+=e;else if(s0(e.charCodeAt(0)))Dt({},GA);else if(n)e==="]"&&(n=!1);else if(e==="/"){i=!0;break}else e==="["&&(n=!0);return i||Dt({},GA),r=t.substr(1,t.length-2),{value:r,literal:t}}function oke(){var e,t,n;for(t="",n="";J<$i&&(e=Te[J],!!IS(e.charCodeAt(0)));)++J,e==="\\"&&J<$i?Dt({},ni,Ci):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Dt({},QP,n),{value:n,literal:t}}function ake(){var e,t,n,i;return Bt=null,QK(),e=J,t=ske(),n=oke(),i=rke(t.value,n.value),{literal:t.literal+n.literal,value:i,regex:{pattern:t.value,flags:n.value},start:e,end:J}}function lke(e){return e.type===Jd||e.type===Rc||e.type===Ox||e.type===Lx}function JK(){if(QK(),J>=$i)return{type:fC,start:J,end:J};const e=Te.charCodeAt(J);return gC(e)?eke():e===40||e===41||e===59?zA():e===39||e===34?ike():e===46?hl(Te.charCodeAt(J+1))?wV():zA():hl(e)?wV():zA()}function Fr(){const e=Bt;return J=e.end,Bt=JK(),J=e.end,e}function eY(){const e=J;Bt=JK(),J=e}function uke(e){const t=new $o(TDe);return t.elements=e,t}function bV(e,t,n){const i=new $o(e==="||"||e==="&&"?NDe:IDe);return i.operator=e,i.left=t,i.right=n,i}function cke(e,t){const n=new $o(_De);return n.callee=e,n.arguments=t,n}function dke(e,t,n){const i=new $o(ODe);return i.test=e,i.consequent=t,i.alternate=n,i}function X2(e){const t=new $o(YK);return t.name=e,t}function iv(e){const t=new $o(LDe);return t.value=e.value,t.raw=Te.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function SV(e,t,n){const i=new $o($De);return i.computed=e==="[",i.object=t,i.property=n,i.computed||(n.member=!0),i}function hke(e){const t=new $o(BDe);return t.properties=e,t}function xV(e,t,n){const i=new $o(GDe);return i.key=t,i.value=n,i.kind=e,i}function fke(e,t){const n=new $o(zDe);return n.operator=e,n.argument=t,n.prefix=!0,n}function Dt(e,t){var n,i=Array.prototype.slice.call(arguments,2),r=t.replace(/%(\d)/g,(s,o)=>(Nx(o<i.length,"Message reference must be in range"),i[o]));throw n=new Error(r),n.index=J,n.description=r,n}function $x(e){e.type===fC&&Dt(e,qDe),e.type===xh&&Dt(e,HDe),e.type===pC&&Dt(e,VDe),e.type===Jd&&Dt(e,WDe),e.type===Rc&&Dt(e,UDe),Dt(e,ni,e.value)}function Bi(e){const t=Fr();(t.type!==xr||t.value!==e)&&$x(t)}function Jt(e){return Bt.type===xr&&Bt.value===e}function HA(e){return Bt.type===Rc&&Bt.value===e}function pke(){const e=[];for(J=Bt.start,Bi("[");!Jt("]");)Jt(",")?(Fr(),e.push(null)):(e.push(eh()),Jt("]")||Bi(","));return Fr(),uke(e)}function RV(){J=Bt.start;const e=Fr();return e.type===pC||e.type===xh?(e.octal&&Dt(e,XK),iv(e)):X2(e.value)}function gke(){var e,t,n,i;if(J=Bt.start,e=Bt,e.type===Jd)return n=RV(),Bi(":"),i=eh(),xV("init",n,i);if(e.type===fC||e.type===xr)$x(e);else return t=RV(),Bi(":"),i=eh(),xV("init",t,i)}function mke(){var e=[],t,n,i,r={},s=String;for(J=Bt.start,Bi("{");!Jt("}");)t=gke(),t.key.type===YK?n=t.key.name:n=s(t.key.value),i="$"+n,Object.prototype.hasOwnProperty.call(r,i)?Dt({},jDe):r[i]=!0,e.push(t),Jt("}")||Bi(",");return Bi("}"),hke(e)}function vke(){Bi("(");const e=Q2();return Bi(")"),e}const Cke={if:1};function yke(){var e,t,n;if(Jt("("))return vke();if(Jt("["))return pke();if(Jt("{"))return mke();if(e=Bt.type,J=Bt.start,e===Jd||Cke[Bt.value])n=X2(Fr().value);else if(e===pC||e===xh)Bt.octal&&Dt(Bt,XK),n=iv(Fr());else{if(e===Rc)throw new Error(r0);e===Ox?(t=Fr(),t.value=t.value==="true",n=iv(t)):e===Lx?(t=Fr(),t.value=null,n=iv(t)):Jt("/")||Jt("/=")?(n=iv(ake()),eY()):$x(Fr())}return n}function wke(){const e=[];if(Bi("("),!Jt(")"))for(;J<$i&&(e.push(eh()),!Jt(")"));)Bi(",");return Bi(")"),e}function bke(){J=Bt.start;const e=Fr();return lke(e)||$x(e),X2(e.value)}function Ske(){return Bi("."),bke()}function xke(){Bi("[");const e=Q2();return Bi("]"),e}function Rke(){var e,t,n;for(e=yke();;)if(Jt("."))n=Ske(),e=SV(".",e,n);else if(Jt("("))t=wke(),e=cke(e,t);else if(Jt("["))n=xke(),e=SV("[",e,n);else break;return e}function EV(){const e=Rke();if(Bt.type===xr&&(Jt("++")||Jt("--")))throw new Error(r0);return e}function ab(){var e,t;if(Bt.type!==xr&&Bt.type!==Rc)t=EV();else{if(Jt("++")||Jt("--"))throw new Error(r0);if(Jt("+")||Jt("-")||Jt("~")||Jt("!"))e=Fr(),t=ab(),t=fke(e.value,t);else{if(HA("delete")||HA("void")||HA("typeof"))throw new Error(r0);t=EV()}}return t}function FV(e){let t=0;if(e.type!==xr&&e.type!==Rc)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function Eke(){var e,t,n,i,r,s,o,a,l,u;if(e=Bt,l=ab(),i=Bt,r=FV(i),r===0)return l;for(i.prec=r,Fr(),t=[e,Bt],o=ab(),s=[l,i,o];(r=FV(Bt))>0;){for(;s.length>2&&r<=s[s.length-2].prec;)o=s.pop(),a=s.pop().value,l=s.pop(),t.pop(),n=bV(a,l,o),s.push(n);i=Fr(),i.prec=r,s.push(i),t.push(Bt),n=ab(),s.push(n)}for(u=s.length-1,n=s[u],t.pop();u>1;)t.pop(),n=bV(s[u-1].value,s[u-2],n),u-=2;return n}function eh(){var e,t,n;return e=Eke(),Jt("?")&&(Fr(),t=eh(),Bi(":"),n=eh(),e=dke(e,t,n)),e}function Q2(){const e=eh();if(Jt(","))throw new Error(r0);return e}function Z2(e){Te=e,J=0,$i=Te.length,Bt=null,eY();const t=Q2();if(Bt.type!==fC)throw new Error("Unexpect token after expression.");return t}var tY={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function nY(e){function t(o,a,l,u){let c=e(a[0]);return l&&(c=l+"("+c+")",l.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+o+(u<0?"":u===0?"()":"("+a.slice(1).map(e).join(",")+")")}function n(o,a,l){return u=>t(o,u,a,l)}const i="new Date",r="String",s="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(o){o.length<3&&te("Missing arguments to clamp function."),o.length>3&&te("Too many arguments to clamp function.");const a=o.map(e);return"Math.max("+a[1]+", Math.min("+a[2]+","+a[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:i,date:n("getDate",i,0),day:n("getDay",i,0),year:n("getFullYear",i,0),month:n("getMonth",i,0),hours:n("getHours",i,0),minutes:n("getMinutes",i,0),seconds:n("getSeconds",i,0),milliseconds:n("getMilliseconds",i,0),time:n("getTime",i,0),timezoneoffset:n("getTimezoneOffset",i,0),utcdate:n("getUTCDate",i,0),utcday:n("getUTCDay",i,0),utcyear:n("getUTCFullYear",i,0),utcmonth:n("getUTCMonth",i,0),utchours:n("getUTCHours",i,0),utcminutes:n("getUTCMinutes",i,0),utcseconds:n("getUTCSeconds",i,0),utcmilliseconds:n("getUTCMilliseconds",i,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",r,0),lower:n("toLowerCase",r,0),substring:n("substring",r),split:n("split",r),trim:n("trim",r,0),regexp:s,test:n("test",s),if:function(o){o.length<3&&te("Missing arguments to if function."),o.length>3&&te("Too many arguments to if function.");const a=o.map(e);return"("+a[0]+"?"+a[1]+":"+a[2]+")"}}}function Fke(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function iY(e){e=e||{};const t=e.allowed?Fo(e.allowed):{},n=e.forbidden?Fo(e.forbidden):{},i=e.constants||tY,r=(e.functions||nY)(d),s=e.globalvar,o=e.fieldvar,a=ot(s)?s:g=>`${s}["${g}"]`;let l={},u={},c=0;function d(g){if(Re(g))return g;const m=h[g.type];return m==null&&te("Unsupported type: "+g.type),m(g)}const h={Literal:g=>g.raw,Identifier:g=>{const m=g.name;return c>0?m:Ae(n,m)?te("Illegal identifier: "+m):Ae(i,m)?i[m]:Ae(t,m)?m:(l[m]=1,a(m))},MemberExpression:g=>{const m=!g.computed,C=d(g.object);m&&(c+=1);const y=d(g.property);return C===o&&(u[Fke(y)]=1),m&&(c-=1),C+(m?"."+y:"["+y+"]")},CallExpression:g=>{g.callee.type!=="Identifier"&&te("Illegal callee type: "+g.callee.type);const m=g.callee.name,C=g.arguments,y=Ae(r,m)&&r[m];return y||te("Unrecognized function: "+m),ot(y)?y(C):y+"("+C.map(d).join(",")+")"},ArrayExpression:g=>"["+g.elements.map(d).join(",")+"]",BinaryExpression:g=>"("+d(g.left)+" "+g.operator+" "+d(g.right)+")",UnaryExpression:g=>"("+g.operator+d(g.argument)+")",ConditionalExpression:g=>"("+d(g.test)+"?"+d(g.consequent)+":"+d(g.alternate)+")",LogicalExpression:g=>"("+d(g.left)+g.operator+d(g.right)+")",ObjectExpression:g=>"{"+g.properties.map(d).join(",")+"}",Property:g=>{c+=1;const m=d(g.key);return c-=1,m+":"+d(g.value)}};function p(g){const m={code:d(g),globals:Object.keys(l),fields:Object.keys(u)};return l={},u={},m}return p.functions=r,p.constants=i,p}const AV=Symbol("vega_selection_getter");function rY(e){return(!e.getter||!e.getter[AV])&&(e.getter=Gs(e.field),e.getter[AV]=!0),e.getter}const J2="intersect",DV="union",Ake="vlMulti",Dke="vlPoint",kV="or",kke="and",ua="_vgsid_",o0=Gs(ua),Pke="E",Mke="R",Tke="R-E",Ike="R-LE",_ke="R-RE",Oke="E-LT",Lke="E-LTE",Nke="E-GT",$ke="E-GTE",Bke="E-VALID",Gke="E-ONE",_S="index:unit";function PV(e,t){for(var n=t.fields,i=t.values,r=n.length,s=0,o,a;s<r;++s)if(a=n[s],o=rY(a)(e),Wu(o)&&(o=_i(o)),Wu(i[s])&&(i[s]=_i(i[s])),ne(i[s])&&Wu(i[s][0])&&(i[s]=i[s].map(_i)),a.type===Pke){if(ne(i[s])?!i[s].includes(o):o!==i[s])return!1}else if(a.type===Mke){if(!Ef(o,i[s]))return!1}else if(a.type===_ke){if(!Ef(o,i[s],!0,!1))return!1}else if(a.type===Tke){if(!Ef(o,i[s],!1,!1))return!1}else if(a.type===Ike){if(!Ef(o,i[s],!1,!0))return!1}else if(a.type===Oke){if(o>=i[s])return!1}else if(a.type===Lke){if(o>i[s])return!1}else if(a.type===Nke){if(o<=i[s])return!1}else if(a.type===$ke){if(o<i[s])return!1}else if(a.type===Bke){if(o===null||isNaN(o))return!1}else if(a.type===Gke&&i[s].indexOf(o)===-1)return!1;return!0}function zke(e,t,n){for(var i=this.context.data[e],r=i?i.values.value:[],s=i?i[_S]&&i[_S].value:void 0,o=n===J2,a=r.length,l=0,u,c,d,h,p;l<a;++l)if(u=r[l],s&&o){if(c=c||{},d=c[h=u.unit]||0,d===-1)continue;if(p=PV(t,u),c[h]=p?-1:++d,p&&s.size===1)return!0;if(!p&&d===s.get(h).count)return!1}else if(p=PV(t,u),o^p)return p;return a&&o}const sY=Jp(o0),Hke=sY.left,Vke=sY.right;function Wke(e,t,n){const i=this.context.data[e],r=i?i.values.value:[],s=i?i[_S]&&i[_S].value:void 0,o=n===J2,a=o0(t),l=Hke(r,a);if(l===r.length||o0(r[l])!==a)return!1;if(s&&o){if(s.size===1)return!0;if(Vke(r,a)-l<s.size)return!1}return!0}function Uke(e,t){return e.map(n=>it(t.fields?{values:t.fields.map(i=>rY(i)(n.datum))}:{[ua]:o0(n.datum)},t))}function qke(e,t,n,i){for(var r=this.context.data[e],s=r?r.values.value:[],o={},a={},l={},u,c,d,h,p,g,m,C,y,b,S=s.length,x=0,E,A;x<S;++x)if(u=s[x],h=u.unit,c=u.fields,d=u.values,c&&d){for(E=0,A=c.length;E<A;++E)p=c[E],m=o[p.field]||(o[p.field]={}),C=m[h]||(m[h]=[]),l[p.field]=y=p.type.charAt(0),b=VA[`${y}_union`],m[h]=b(C,xe(d[E]));n&&(C=a[h]||(a[h]=[]),C.push(xe(d).reduce((F,P,D)=>(F[c[D].field]=P,F),{})))}else p=ua,g=o0(u),m=o[p]||(o[p]={}),C=m[h]||(m[h]=[]),C.push(g),n&&(C=a[h]||(a[h]=[]),C.push({[ua]:g}));if(t=t||DV,o[ua]?o[ua]=VA[`${ua}_${t}`](...Object.values(o[ua])):Object.keys(o).forEach(F=>{o[F]=Object.keys(o[F]).map(P=>o[F][P]).reduce((P,D)=>P===void 0?D:VA[`${l[F]}_${t}`](P,D))}),s=Object.keys(a),n&&s.length){const F=i?Dke:Ake;o[F]=t===DV?{[kV]:s.reduce((P,D)=>(P.push(...a[D]),P),[])}:{[kke]:s.map(P=>({[kV]:a[P]}))}}return o}var VA={[`${ua}_union`]:Ige,[`${ua}_intersect`]:Mge,E_union:function(e,t){if(!e.length)return t;for(var n=0,i=t.length;n<i;++n)e.includes(t[n])||e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.includes(n)):t},R_union:function(e,t){var n=_i(t[0]),i=_i(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<i&&(e[1]=i),e):[n,i]},R_intersect:function(e,t){var n=_i(t[0]),i=_i(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?i<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>i&&(e[1]=i),e):[n,i]}};const jke=":",Kke="@";function eO(e,t,n,i){t[0].type!==Zd&&te("First argument to selection functions must be a string literal.");const r=t[0].value,s=t.length>=2&&wt(t).value,o="unit",a=Kke+o,l=jke+r;s===J2&&!Ae(i,a)&&(i[a]=n.getData(r).indataRef(n,o)),Ae(i,l)||(i[l]=n.getData(r).tuplesRef())}function oY(e){const t=this.context.data[e];return t?t.values.value:[]}function Yke(e,t,n){const i=this.context.data[e]["index:"+t],r=i?i.value.get(n):void 0;return r&&r.count}function Xke(e,t){const n=this.context.dataflow,i=this.context.data[e],r=i.input;return n.pulse(r,n.changeset().remove(zs).insert(t)),1}function Qke(e,t,n){if(e){const i=this.context.dataflow,r=e.mark.source;i.pulse(r,i.changeset().encode(e,t))}return n!==void 0?n:e}const mC=e=>function(t,n){const i=this.context.dataflow.locale();return t===null?"null":i[e](n)(t)},Zke=mC("format"),aY=mC("timeFormat"),Jke=mC("utcFormat"),ePe=mC("timeParse"),tPe=mC("utcParse"),fw=new Date(2e3,0,1);function Bx(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(fw.setYear(2e3),fw.setMonth(e),fw.setDate(t),aY.call(this,fw,n))}function nPe(e){return Bx.call(this,e,1,"%B")}function iPe(e){return Bx.call(this,e,1,"%b")}function rPe(e){return Bx.call(this,0,2+e,"%A")}function sPe(e){return Bx.call(this,0,2+e,"%a")}const oPe=":",aPe="@",JP="%",lY="$";function tO(e,t,n,i){t[0].type!==Zd&&te("First argument to data functions must be a string literal.");const r=t[0].value,s=oPe+r;if(!Ae(s,i))try{i[s]=n.getData(r).tuplesRef()}catch{}}function lPe(e,t,n,i){t[0].type!==Zd&&te("First argument to indata must be a string literal."),t[1].type!==Zd&&te("Second argument to indata must be a string literal.");const r=t[0].value,s=t[1].value,o=aPe+s;Ae(o,i)||(i[o]=n.getData(r).indataRef(n,s))}function ar(e,t,n,i){if(t[0].type===Zd)MV(n,i,t[0].value);else for(e in n.scales)MV(n,i,e)}function MV(e,t,n){const i=JP+n;if(!Ae(t,i))try{t[i]=e.scaleRef(n)}catch{}}function Ga(e,t){if(Re(e)){const n=t.scales[e];return n&&fwe(n.value)?n.value:void 0}}function uPe(e,t,n){t.__bandwidth=r=>r&&r.bandwidth?r.bandwidth():0,n._bandwidth=ar,n._range=ar,n._scale=ar;const i=r=>"_["+(r.type===Zd?ge(JP+r.value):ge(JP)+"+"+e(r))+"]";return{_bandwidth:r=>`this.__bandwidth(${i(r[0])})`,_range:r=>`${i(r[0])}.range()`,_scale:r=>`${i(r[0])}(${e(r[1])})`}}function nO(e,t){return function(n,i,r){if(n){const s=Ga(n,(r||this).context);return s&&s.path[e](i)}else return t(i)}}const cPe=nO("area",Dxe),dPe=nO("bounds",Txe),hPe=nO("centroid",$xe);function fPe(e,t){const n=Ga(e,(t||this).context);return n&&n.scale()}function pPe(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function iO(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(i){e.warn(i)}return n[n.length-1]}function gPe(){return iO(this.context.dataflow,"warn",arguments)}function mPe(){return iO(this.context.dataflow,"info",arguments)}function vPe(){return iO(this.context.dataflow,"debug",arguments)}function WA(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function eM(e){const t=nc(e),n=WA(t.r),i=WA(t.g),r=WA(t.b);return .2126*n+.7152*i+.0722*r}function CPe(e,t){const n=eM(e),i=eM(t),r=Math.max(n,i),s=Math.min(n,i);return(r+.05)/(s+.05)}function yPe(){const e=[].slice.call(arguments);return e.unshift({}),it(...e)}function uY(e,t){return e===t||e!==e&&t!==t?!0:ne(e)?ne(t)&&e.length===t.length?wPe(e,t):!1:be(e)&&be(t)?cY(e,t):!1}function wPe(e,t){for(let n=0,i=e.length;n<i;++n)if(!uY(e[n],t[n]))return!1;return!0}function cY(e,t){for(const n in e)if(!uY(e[n],t[n]))return!1;return!0}function TV(e){return t=>cY(e,t)}function bPe(e,t,n,i,r,s){const o=this.context.dataflow,a=this.context.data[e],l=a.input,u=o.stamp();let c=a.changes,d,h;if(o._trigger===!1||!(l.value.length||t||i))return 0;if((!c||c.stamp<u)&&(a.changes=c=o.changeset(),c.stamp=u,o.runAfter(()=>{a.modified=!0,o.pulse(l,c).run()},!0,1)),n&&(d=n===!0?zs:ne(n)||j1(n)?n:TV(n),c.remove(d)),t&&c.insert(t),i&&(d=TV(i),l.value.some(d)?c.remove(d):c.insert(i)),r)for(h in s)c.modify(r,h,s[h]);return 1}function SPe(e){const t=e.touches,n=t[0].clientX-t[1].clientX,i=t[0].clientY-t[1].clientY;return Math.hypot(n,i)}function xPe(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const IV={};function RPe(e,t){const n=IV[t]||(IV[t]=Gs(t));return ne(e)?e.map(n):n(e)}function Gx(e){return ne(e)||ArrayBuffer.isView(e)?e:null}function rO(e){return Gx(e)||(Re(e)?e:null)}function EPe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return Gx(e).join(...n)}function FPe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return rO(e).indexOf(...n)}function APe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return rO(e).lastIndexOf(...n)}function DPe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return rO(e).slice(...n)}function kPe(e,t,n){return ot(n)&&te("Function argument passed to replace."),String(e).replace(t,n)}function PPe(e){return Gx(e).slice().reverse()}function MPe(e){return Gx(e).slice().sort(Qp)}function TPe(e,t,n){return v_(e||0,t||0,n||0)}function IPe(e,t){const n=Ga(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function _Pe(e,t){const n=Ga(e,(t||this).context);return n?n.copy():void 0}function OPe(e,t){const n=Ga(e,(t||this).context);return n?n.domain():[]}function LPe(e,t,n){const i=Ga(e,(n||this).context);return i?ne(t)?(i.invertRange||i.invert)(t):(i.invert||i.invertExtent)(t):void 0}function NPe(e,t){const n=Ga(e,(t||this).context);return n&&n.range?n.range():[]}function $Pe(e,t,n){const i=Ga(e,(n||this).context);return i?i(t):void 0}function BPe(e,t,n,i,r){let s=typeof e=="string"?Ga(e,(r||this).context):e;const o=eq(t,n);let a=s.domain(),l=a[0],u=wt(a),c=zi;return u-l?c=H7(s,l,u):s=(s.interpolator?Mt("sequential")().interpolator(s.interpolator()):Mt("linear")().interpolate(s.interpolate()).range(s.range())).domain([l=0,u=1]),s.ticks&&(a=s.ticks(+i||15),l!==a[0]&&a.unshift(l),u!==wt(a)&&a.push(u)),a.forEach(d=>o.stop(c(d),s(d))),o}function GPe(e,t,n){const i=Ga(e,(n||this).context);return function(r){return i?i.path.context(r)(t):""}}function zPe(e){let t=null;return function(n){return n?Xv(n,t=t||fp(e)):e}}const dY=e=>e.data;function hY(e,t){const n=oY.call(t,e);return n.root&&n.root.lookup||{}}function HPe(e,t,n){const i=hY(e,this),r=i[t],s=i[n];return r&&s?r.path(s).map(dY):void 0}function VPe(e,t){const n=hY(e,this)[t];return n?n.ancestors().map(dY):void 0}const fY=()=>typeof window<"u"&&window||null;function WPe(){const e=fY();return e?e.screen:{}}function UPe(){const e=fY();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function qPe(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function pY(e,t,n){if(!e)return[];const[i,r]=e,s=new Bn().set(i[0],i[1],r[0],r[1]),o=n||this.context.dataflow.scenegraph().root;return Qq(o,s,jPe(t))}function jPe(e){let t=null;if(e){const n=xe(e.marktype),i=xe(e.markname);t=r=>(!n.length||n.some(s=>r.marktype===s))&&(!i.length||i.some(s=>r.name===s))}return t}function KPe(e,t,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5;e=xe(e);const r=e[e.length-1];return r===void 0||Math.hypot(r[0]-t,r[1]-n)>i?[...e,[t,n]]:e}function YPe(e){return xe(e).reduce((t,n,i)=>{let[r,s]=n;return t+=i==0?`M ${r},${s} `:i===e.length-1?" Z":`L ${r},${s} `},"")}function XPe(e,t,n){const{x:i,y:r,mark:s}=n,o=new Bn().set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[l,u]of t)l<o.x1&&(o.x1=l),l>o.x2&&(o.x2=l),u<o.y1&&(o.y1=u),u>o.y2&&(o.y2=u);return o.translate(i,r),pY([[o.x1,o.y1],[o.x2,o.y2]],e,s).filter(l=>QPe(l.x,l.y,t))}function QPe(e,t,n){let i=0;for(let r=0,s=n.length-1;r<n.length;s=r++){const[o,a]=n[s],[l,u]=n[r];u>t!=a>t&&e<(o-l)*(t-u)/(a-u)+l&&i++}return i&1}const a0={random(){return Vs()},cumulativeNormal:Z1,cumulativeLogNormal:yI,cumulativeUniform:xI,densityNormal:pI,densityLogNormal:CI,densityUniform:SI,quantileNormal:J1,quantileLogNormal:wI,quantileUniform:RI,sampleNormal:Q1,sampleLogNormal:vI,sampleUniform:bI,isArray:ne,isBoolean:yc,isDate:Wu,isDefined(e){return e!==void 0},isNumber:kt,isObject:be,isRegExp:w8,isString:Re,isTuple:j1,isValid(e){return e!=null&&e===e},toBoolean:jT,toDate(e){return KT(e)},toNumber:_i,toString:YT,indexof:FPe,join:EPe,lastindexof:APe,replace:kPe,reverse:PPe,sort:MPe,slice:DPe,flush:C8,lerp:b8,merge:yPe,pad:R8,peek:wt,pluck:RPe,span:H0,inrange:Ef,truncate:E8,rgb:nc,lab:zb,hcl:Hb,hsl:Bb,luminance:eM,contrast:CPe,sequence:Ar,format:Zke,utcFormat:Jke,utcParse:tPe,utcOffset:rU,utcSequence:aU,timeFormat:aY,timeParse:ePe,timeOffset:iU,timeSequence:oU,timeUnitSpecifier:q8,monthFormat:nPe,monthAbbrevFormat:iPe,dayFormat:rPe,dayAbbrevFormat:sPe,quarter:p8,utcquarter:g8,week:K8,utcweek:Q8,dayofyear:j8,utcdayofyear:X8,warn:gPe,info:mPe,debug:vPe,extent(e){return Ea(e)},inScope:pPe,intersect:pY,clampRange:m8,pinchDistance:SPe,pinchAngle:xPe,screen:WPe,containerSize:qPe,windowSize:UPe,bandspace:TPe,setdata:Xke,pathShape:zPe,panLinear:c8,panLog:d8,panPow:h8,panSymlog:f8,zoomLinear:zT,zoomLog:HT,zoomPow:Fb,zoomSymlog:VT,encode:Qke,modify:bPe,lassoAppend:KPe,lassoPath:YPe,intersectLasso:XPe},ZPe=["view","item","group","xy","x","y"],JPe="event.vega.",gY="this.",sO={},mY={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${ge(lY+e)}]`,functions:eMe,constants:tY,visitors:sO},tM=iY(mY);function eMe(e){const t=nY(e);ZPe.forEach(n=>t[n]=JPe+n);for(const n in a0)t[n]=gY+n;return it(t,uPe(e,a0,sO)),t}function In(e,t,n){return arguments.length===1?a0[e]:(a0[e]=t,n&&(sO[e]=n),tM&&(tM.functions[e]=gY+e),this)}In("bandwidth",IPe,ar);In("copy",_Pe,ar);In("domain",OPe,ar);In("range",NPe,ar);In("invert",LPe,ar);In("scale",$Pe,ar);In("gradient",BPe,ar);In("geoArea",cPe,ar);In("geoBounds",dPe,ar);In("geoCentroid",hPe,ar);In("geoShape",GPe,ar);In("geoScale",fPe,ar);In("indata",Yke,lPe);In("data",oY,tO);In("treePath",HPe,tO);In("treeAncestors",VPe,tO);In("vlSelectionTest",zke,eO);In("vlSelectionIdTest",Wke,eO);In("vlSelectionResolve",qke,eO);In("vlSelectionTuples",Uke);function Pa(e,t){const n={};let i;try{e=Re(e)?e:ge(e)+"",i=Z2(e)}catch{te("Expression parse error: "+e)}i.visit(s=>{if(s.type!==KK)return;const o=s.callee.name,a=mY.visitors[o];a&&a(o,s.arguments,t,n)});const r=tM(i);return r.globals.forEach(s=>{const o=lY+s;!Ae(n,o)&&t.getSignal(s)&&(n[o]=t.signalRef(s))}),{$expr:it({code:r.code},t.options.ast?{ast:i}:null),$fields:r.fields,$params:n}}function tMe(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(i=>t.parseOperator(i)),n.forEach(i=>t.parseOperatorParameters(i)),(e.streams||[]).forEach(i=>t.parseStream(i)),(e.updates||[]).forEach(i=>t.parseUpdate(i)),t.resolve()}const nMe=Fo(["rule"]),_V=Fo(["group","image","rect"]);function iMe(e,t){let n="";return nMe[t]||(e.x2&&(e.x?(_V[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(_V[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function oO(e){return(e+"").toLowerCase()}function rMe(e){return oO(e)==="operator"}function sMe(e){return oO(e)==="collect"}function vm(e,t,n){n.endsWith(";")||(n="return("+n+");");const i=Function(...t.concat(n));return e&&e.functions?i.bind(e.functions):i}function oMe(e,t,n,i){return`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${n}
  : (u > v || v == null) && u != null ? ${i}
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}
  : v !== v && u === u ? ${i} : `}var aMe={operator:(e,t)=>vm(e,["_"],t.code),parameter:(e,t)=>vm(e,["datum","_"],t.code),event:(e,t)=>vm(e,["event"],t.code),handler:(e,t)=>{const n=`var datum=event.item&&event.item.datum;return ${t.code};`;return vm(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:i}=t;let r="var o=item,datum=o.datum,m=0,$;";for(const s in i){const o="o["+ge(s)+"]";r+=`$=${i[s].code};if(${o}!==$)${o}=$,m=1;`}return r+=iMe(i,n),r+="return m;",vm(e,["item","_"],r)},codegen:{get(e){const t=`[${e.map(ge).join("][")}]`,n=Function("_",`return _${t};`);return n.path=t,n},comparator(e,t){let n;const i=(s,o)=>{const a=t[o];let l,u;return s.path?(l=`a${s.path}`,u=`b${s.path}`):((n=n||{})["f"+o]=s,l=`this.f${o}(a)`,u=`this.f${o}(b)`),oMe(l,u,-a,a)},r=Function("a","b","var u, v; return "+e.map(i).join("")+"0;");return n?r.bind(n):r}}};function lMe(e){const t=this;rMe(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function uMe(e){const t=this;if(e.params){const n=t.get(e.id);n||te("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function cMe(e,t){t=t||{};const n=this;for(const i in e){const r=e[i];t[i]=ne(r)?r.map(s=>OV(s,n,t)):OV(r,n,t)}return t}function OV(e,t,n){if(!e||!be(e))return e;for(let i=0,r=LV.length,s;i<r;++i)if(s=LV[i],Ae(e,s.key))return s.parse(e,t,n);return e}var LV=[{key:"$ref",parse:dMe},{key:"$key",parse:fMe},{key:"$expr",parse:hMe},{key:"$field",parse:pMe},{key:"$encode",parse:mMe},{key:"$compare",parse:gMe},{key:"$context",parse:vMe},{key:"$subflow",parse:CMe},{key:"$tupleid",parse:yMe}];function dMe(e,t){return t.get(e.$ref)||te("Operator not defined: "+e.$ref)}function hMe(e,t,n){e.$params&&t.parseParameters(e.$params,n);const i="e:"+e.$expr.code;return t.fn[i]||(t.fn[i]=$r(t.parameterExpression(e.$expr),e.$fields))}function fMe(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=qT(e.$key,e.$flat,t.expr.codegen))}function pMe(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=Gs(e.$field,e.$name,t.expr.codegen))}function gMe(e,t){const n="c:"+e.$compare+"_"+e.$order,i=xe(e.$compare).map(r=>r&&r.$tupleid?$e:r);return t.fn[n]||(t.fn[n]=WT(i,e.$order,t.expr.codegen))}function mMe(e,t){const n=e.$encode,i={};for(const r in n){const s=n[r];i[r]=$r(t.encodeExpression(s.$expr),s.$fields),i[r].output=s.$output}return i}function vMe(e,t){return t}function CMe(e,t){const n=e.$subflow;return function(i,r,s){const o=t.fork().parse(n),a=o.get(n.operators[0].id),l=o.signals.parent;return l&&l.set(s),a.detachSubflow=()=>t.detach(o),a}}function yMe(){return $e}function wMe(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,i=e.stream!=null?t.get(e.stream):void 0,r;e.source?i=t.events(e.source,e.type,n):e.merge&&(r=e.merge.map(s=>t.get(s)),i=r[0].merge.apply(r[0],r.slice(1))),e.between&&(r=e.between.map(s=>t.get(s)),i=i.between(r[0],r[1])),e.filter&&(i=i.filter(n)),e.throttle!=null&&(i=i.throttle(+e.throttle)),e.debounce!=null&&(i=i.debounce(+e.debounce)),i==null&&te("Invalid stream definition: "+JSON.stringify(e)),e.consume&&i.consume(!0),t.stream(e,i)}function bMe(e){var t=this,n=be(n=e.source)?n.$ref:n,i=t.get(n),r=null,s=e.update,o=void 0;i||te("Source not defined: "+e.source),r=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),s&&s.$expr&&(s.$params&&(o=t.parseParameters(s.$params)),s=t.handlerExpression(s.$expr)),t.update(e,i,r,s,o)}const SMe={skip:!0};function xMe(e){var t=this,n={};if(e.signals){var i=n.signals={};Object.keys(t.signals).forEach(s=>{const o=t.signals[s];e.signals(s,o)&&(i[s]=o.value)})}if(e.data){var r=n.data={};Object.keys(t.data).forEach(s=>{const o=t.data[s];e.data(s,o)&&(r[s]=o.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(s=>s.getState(e))),n}function RMe(e){var t=this,n=t.dataflow,i=e.data,r=e.signals;Object.keys(r||{}).forEach(s=>{n.update(t.signals[s],r[s],SMe)}),Object.keys(i||{}).forEach(s=>{n.pulse(t.data[s].input,n.changeset().remove(zs).insert(i[s]))}),(e.subcontext||[]).forEach((s,o)=>{const a=t.subcontext[o];a&&a.setState(s)})}function vY(e,t,n,i){return new CY(e,t,n,i)}function CY(e,t,n,i){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=i||aMe,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function NV(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}CY.prototype=NV.prototype={fork(){const e=new NV(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,i=n.dataflow,r=e.value;if(n.set(e.id,t),sMe(e.type)&&r&&(r.$ingest?i.ingest(t,r.$ingest,r.$format):r.$request?i.preload(t,r.$request,r.$format):i.pulse(t,i.changeset().insert(r))),e.root&&(n.root=t),e.parent){let s=n.get(e.parent.$ref);s?(i.connect(s,[t]),t.targets().add(s)):(n.unresolved=n.unresolved||[]).push(()=>{s=n.get(e.parent.$ref),i.connect(s,[t]),t.targets().add(s)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const s in e.data){const o=n.data[s]||(n.data[s]={});e.data[s].forEach(a=>o[a]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[oO(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,i,r){this.dataflow.on(t,n,i,r,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:tMe,parseOperator:lMe,parseOperatorParameters:uMe,parseParameters:cMe,parseStream:wMe,parseUpdate:bMe,getState:xMe,setState:RMe};function EMe(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),yY(t,e.description()))}function yY(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function FMe(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const UA="default";function AMe(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:UA,item:null}));e.on(e.events("view","pointermove"),t,(n,i)=>{const r=t.value,s=r?Re(r)?r:r.user:UA,o=i.item&&i.item.cursor||null;return r&&s===r.user&&o==r.item?r:{user:s,item:o}}),e.add(null,function(n){let i=n.cursor,r=this.value;return Re(i)||(r=i.item,i=i.user),nM(e,i&&i!==UA?i:r||i),r},{cursor:t})}function nM(e,t){const n=e.globalCursor()?typeof document<"u"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function OS(e,t){var n=e._runtime.data;return Ae(n,t)||te("Unrecognized data set: "+t),n[t]}function DMe(e,t){return arguments.length<2?OS(this,e).values.value:zx.call(this,e,wh().remove(zs).insert(t))}function zx(e,t){_U(t)||te("Second argument to changes must be a changeset.");const n=OS(this,e);return n.modified=!0,this.pulse(n.input,t)}function kMe(e,t){return zx.call(this,e,wh().insert(t))}function PMe(e,t){return zx.call(this,e,wh().remove(t))}function wY(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function bY(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function Hx(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function MMe(e){var t=Hx(e),n=wY(e),i=bY(e);e._renderer.background(e.background()),e._renderer.resize(n,i,t),e._handler.origin(t),e._resizeListeners.forEach(r=>{try{r(n,i)}catch(s){e.error(s)}})}function TMe(e,t,n){var i=e._renderer,r=i&&i.canvas(),s,o,a;return r&&(a=Hx(e),o=t.changedTouches?t.changedTouches[0]:t,s=Ax(o,r),s[0]-=a[0],s[1]-=a[1]),t.dataflow=e,t.item=n,t.vega=IMe(e,n,s),t}function IMe(e,t,n){const i=t?t.mark.marktype==="group"?t:t.mark.group:null;function r(o){var a=i,l;if(o){for(l=t;l;l=l.mark.group)if(l.mark.name===o){a=l;break}}return a&&a.mark&&a.mark.interactive?a:{}}function s(o){if(!o)return n;Re(o)&&(o=r(o));const a=n.slice();for(;o;)a[0]-=o.x||0,a[1]-=o.y||0,o=o.mark&&o.mark.group;return a}return{view:Hi(e),item:Hi(t||{}),group:r,xy:s,x:o=>s(o)[0],y:o=>s(o)[1]}}const $V="view",_Me="timer",OMe="window",LMe={trap:!1};function NMe(e){const t=it({defaults:{}},e),n=(i,r)=>{r.forEach(s=>{ne(i[s])&&(i[s]=Fo(i[s]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function SY(e,t,n,i){e._eventListeners.push({type:n,sources:xe(t),handler:i})}function $Me(e,t){var n=e._eventConfig.defaults,i=n.prevent,r=n.allow;return i===!1||r===!0?!1:i===!0||r===!1?!0:i?i[t]:r?!r[t]:e.preventDefault()}function pw(e,t,n){const i=e._eventConfig&&e._eventConfig[t];return i===!1||be(i)&&!i[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function BMe(e,t,n){var i=this,r=new X1(n),s=function(u,c){i.runAsync(null,()=>{e===$V&&$Me(i,t)&&u.preventDefault(),r.receive(TMe(i,u,c))})},o;if(e===_Me)pw(i,"timer",t)&&i.timer(s,t);else if(e===$V)pw(i,"view",t)&&i.addEventListener(t,s,LMe);else if(e===OMe?pw(i,"window",t)&&typeof window<"u"&&(o=[window]):typeof document<"u"&&pw(i,"selector",t)&&(o=Array.from(document.querySelectorAll(e))),!o)i.warn("Can not resolve event source: "+e);else{for(var a=0,l=o.length;a<l;++a)o[a].addEventListener(t,s);SY(i,o,t,s)}return r}function BV(e){return e.item}function GV(e){return e.item.mark.source}function zV(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function GMe(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","pointerover",BV),GV,zV(e)),this.on(this.events("view","pointerout",BV),GV,zV(t)),this}function zMe(){var e=this._tooltip,t=this._timers,n=this._handler.handlers(),i=this._eventListeners,r,s,o,a,l;for(r=t.length;--r>=0;)t[r].stop();for(r=i.length;--r>=0;)for(o=i[r],s=o.sources.length;--s>=0;)o.sources[s].removeEventListener(o.type,o.handler);for(e&&e.call(this,this._handler,null,null,null),r=n.length;--r>=0;)l=n[r].type,a=n[r].handler,this._handler.off(l,a);return this}function rs(e,t,n){const i=document.createElement(e);for(const r in t)i.setAttribute(r,t[r]);return n!=null&&(i.textContent=n),i}const HMe="vega-bind",VMe="vega-bind-name",WMe="vega-bind-radio";function UMe(e,t,n){if(!t)return;const i=n.param;let r=n.state;return r||(r=n.state={elements:null,active:!1,set:null,update:o=>{o!=e.signal(i.signal)&&e.runAsync(null,()=>{r.source=!0,e.signal(i.signal,o)})}},i.debounce&&(r.update=UT(i.debounce,r.update))),(i.input==null&&i.element?qMe:KMe)(r,t,i,e),r.active||(e.on(e._signals[i.signal],null,()=>{r.source?r.source=!1:r.set(e.signal(i.signal))}),r.active=!0),r}function qMe(e,t,n,i){const r=n.event||"input",s=()=>e.update(t.value);i.signal(n.signal,t.value),t.addEventListener(r,s),SY(i,t,r,s),e.set=o=>{t.value=o,t.dispatchEvent(jMe(r))}}function jMe(e){return typeof Event<"u"?new Event(e):{type:e}}function KMe(e,t,n,i){const r=i.signal(n.signal),s=rs("div",{class:HMe}),o=n.input==="radio"?s:s.appendChild(rs("label"));o.appendChild(rs("span",{class:VMe},n.name||n.signal)),t.appendChild(s);let a=YMe;switch(n.input){case"checkbox":a=XMe;break;case"select":a=QMe;break;case"radio":a=ZMe;break;case"range":a=JMe;break}a(e,o,n,r)}function YMe(e,t,n,i){const r=rs("input");for(const s in n)s!=="signal"&&s!=="element"&&r.setAttribute(s==="input"?"type":s,n[s]);r.setAttribute("name",n.signal),r.value=i,t.appendChild(r),r.addEventListener("input",()=>e.update(r.value)),e.elements=[r],e.set=s=>r.value=s}function XMe(e,t,n,i){const r={type:"checkbox",name:n.signal};i&&(r.checked=!0);const s=rs("input",r);t.appendChild(s),s.addEventListener("change",()=>e.update(s.checked)),e.elements=[s],e.set=o=>s.checked=!!o||null}function QMe(e,t,n,i){const r=rs("select",{name:n.signal}),s=n.labels||[];n.options.forEach((o,a)=>{const l={value:o};LS(o,i)&&(l.selected=!0),r.appendChild(rs("option",l,(s[a]||o)+""))}),t.appendChild(r),r.addEventListener("change",()=>{e.update(n.options[r.selectedIndex])}),e.elements=[r],e.set=o=>{for(let a=0,l=n.options.length;a<l;++a)if(LS(n.options[a],o)){r.selectedIndex=a;return}}}function ZMe(e,t,n,i){const r=rs("span",{class:WMe}),s=n.labels||[];t.appendChild(r),e.elements=n.options.map((o,a)=>{const l={type:"radio",name:n.signal,value:o};LS(o,i)&&(l.checked=!0);const u=rs("input",l);u.addEventListener("change",()=>e.update(o));const c=rs("label",{},(s[a]||o)+"");return c.prepend(u),r.appendChild(c),u}),e.set=o=>{const a=e.elements,l=a.length;for(let u=0;u<l;++u)LS(a[u].value,o)&&(a[u].checked=!0)}}function JMe(e,t,n,i){i=i!==void 0?i:(+n.max+ +n.min)/2;const r=n.max!=null?n.max:Math.max(100,+i)||100,s=n.min||Math.min(0,r,+i)||0,o=n.step||Ju(s,r,100),a=rs("input",{type:"range",name:n.signal,min:s,max:r,step:o});a.value=i;const l=rs("span",{},+i);t.appendChild(a),t.appendChild(l);const u=()=>{l.textContent=a.value,e.update(+a.value)};a.addEventListener("input",u),a.addEventListener("change",u),e.elements=[a],e.set=c=>{a.value=c,l.textContent=c}}function LS(e,t){return e===t||e+""==t+""}function xY(e,t,n,i,r,s){return t=t||new i(e.loader()),t.initialize(n,wY(e),bY(e),Hx(e),r,s).background(e.background())}function aO(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function eTe(e,t,n,i){const r=new i(e.loader(),aO(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,Hx(e),e);return t&&t.handlers().forEach(s=>{r.on(s.type,s.handler)}),r}function tTe(e,t){const n=this,i=n._renderType,r=n._eventConfig.bind,s=Dx(i);e=n._el=e?qA(n,e,!0):null,EMe(n),s||n.error("Unrecognized renderer type: "+i);const o=s.handler||lC,a=e?s.renderer:s.headless;return n._renderer=a?xY(n,n._renderer,e,a):null,n._handler=eTe(n,n._handler,e,o),n._redraw=!0,e&&r!=="none"&&(t=t?n._elBind=qA(n,t,!0):e.appendChild(rs("form",{class:"vega-bindings"})),n._bind.forEach(l=>{l.param.element&&r!=="container"&&(l.element=qA(n,l.param.element,!!l.param.input))}),n._bind.forEach(l=>{UMe(n,l.element||t,l)})),n}function qA(e,t,n){if(typeof t=="string")if(typeof document<"u"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.textContent=""}catch(i){t=null,e.error(i)}return t}const Cm=e=>+e||0,nTe=e=>({top:e,bottom:e,left:e,right:e});function HV(e){return be(e)?{top:Cm(e.top),bottom:Cm(e.bottom),left:Cm(e.left),right:Cm(e.right)}:nTe(Cm(e))}async function lO(e,t,n,i){const r=Dx(t),s=r&&r.headless;return s||te("Unrecognized renderer type: "+t),await e.runAsync(),xY(e,null,null,s,n,i).renderAsync(e._scenegraph.root)}async function iTe(e,t){e!==Nu.Canvas&&e!==Nu.SVG&&e!==Nu.PNG&&te("Unrecognized image type: "+e);const n=await lO(this,e,t);return e===Nu.SVG?rTe(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function rTe(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function sTe(e,t){return(await lO(this,Nu.Canvas,e,t)).canvas()}async function oTe(e){return(await lO(this,Nu.SVG,e)).svg()}function aTe(e,t,n){return vY(e,ap,a0,n).parse(t)}function lTe(e){var t=this._runtime.scales;return Ae(t,e)||te("Unrecognized scale or projection: "+e),t[e].value}var RY="width",EY="height",uO="padding",VV={skip:!0};function FY(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===uO?i.left+i.right:0)}function AY(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===uO?i.top+i.bottom:0)}function uTe(e){var t=e._signals,n=t[RY],i=t[EY],r=t[uO];function s(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,a=>{e._width=a.size,e._viewWidth=FY(e,a.size),s()},{size:n}),e._resizeHeight=e.add(null,a=>{e._height=a.size,e._viewHeight=AY(e,a.size),s()},{size:i});const o=e.add(null,s,{pad:r});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=i.rank+1,o.rank=r.rank+1}function cTe(e,t,n,i,r,s){this.runAfter(o=>{let a=0;o._autosize=0,o.width()!==n&&(a=1,o.signal(RY,n,VV),o._resizeWidth.skip(!0)),o.height()!==i&&(a=1,o.signal(EY,i,VV),o._resizeHeight.skip(!0)),o._viewWidth!==e&&(o._resize=1,o._viewWidth=e),o._viewHeight!==t&&(o._resize=1,o._viewHeight=t),(o._origin[0]!==r[0]||o._origin[1]!==r[1])&&(o._resize=1,o._origin=r),a&&o.run("enter"),s&&o.runAfter(l=>l.resize())},!1,1)}function dTe(e){return this._runtime.getState(e||{data:hTe,signals:fTe,recurse:!0})}function hTe(e,t){return t.modified&&ne(t.input.value)&&!e.startsWith("_:vega:_")}function fTe(e,t){return!(e==="parent"||t instanceof ap.proxy)}function pTe(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function gTe(e,t){function n(i){e({timestamp:Date.now(),elapsed:i})}this._timers.push(BEe(n,t))}function mTe(e,t,n,i){const r=e.element();r&&r.setAttribute("title",vTe(i))}function vTe(e){return e==null?"":ne(e)?DY(e):be(e)&&!Wu(e)?CTe(e):e+""}function CTe(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(ne(n)?DY(n):kY(n))}).join(`
`)}function DY(e){return"["+e.map(kY).join(", ")+"]"}function kY(e){return ne(e)?"[]":be(e)&&!Wu(e)?"{}":e}function yTe(){if(this.renderer()==="canvas"&&this._renderer._canvas){let e=null;const t=()=>{e?.();const n=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);n.addEventListener("change",t),e=()=>{n.removeEventListener("change",t)},this._renderer._canvas.getContext("2d").pixelRatio=window.devicePixelRatio||1,this._redraw=!0,this._resize=1,this.resize().runAsync()};t()}}function PY(e,t){const n=this;if(t=t||{},Lf.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const s=it({},e.locale,t.locale);n.locale(RU(s.number,s.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||Nu.Canvas,n._scenegraph=new Rq;const i=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||mTe,n._redraw=!0,n._handler=new lC().scene(i),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=NMe(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const r=aTe(n,e,t.expr);n._runtime=r,n._signals=r.signals,n._bind=(e.bindings||[]).map(s=>({state:null,param:it({},s)})),r.root&&r.root.set(i),i.source=r.data.root.input,n.pulse(r.data.root.input,n.changeset().insert(i.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=FY(n,n._width),n._viewHeight=AY(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,uTe(n),FMe(n),AMe(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind),t.watchPixelRatio&&n._watchPixelRatio()}function gw(e,t){return Ae(e._signals,t)?e._signals[t]:te("Unrecognized signal name: "+ge(t))}function MY(e,t){const n=(e._targets||[]).filter(i=>i._update&&i._update.handler===t);return n.length?n[0]:null}function WV(e,t,n,i){let r=MY(n,i);return r||(r=aO(e,()=>i(t,n.value)),r.handler=i,e.on(n,null,r)),e}function UV(e,t,n){const i=MY(t,n);return i&&t._targets.remove(i),e}me(PY,Lf,{async evaluate(e,t,n){if(await Lf.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,MMe(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(i){this.error(i)}return n&&Ww(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&yY(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const i=gw(this,e);return arguments.length===1?i.value:this.update(i,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",HV(e)):HV(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(Dx(e)||te("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(Lf.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(gw(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:cTe,addEventListener(e,t,n){let i=t;return n&&n.trap===!1||(i=aO(this,t),i.raw=t),this._handler.on(e,i),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),i=n.length,r,s;--i>=0;)if(s=n[i].type,r=n[i].handler,e===s&&(t===r||t===r.raw)){this._handler.off(s,r);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.includes(e)||t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return WV(this,e,gw(this,e),t)},removeSignalListener(e,t){return UV(this,gw(this,e),t)},addDataListener(e,t){return WV(this,e,OS(this,e).values,t)},removeDataListener(e,t){return UV(this,OS(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=nM(this,null);this._globalCursor=!!e,t&&nM(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:gTe,events:BMe,finalize:zMe,hover:GMe,data:DMe,change:zx,insert:kMe,remove:PMe,scale:lTe,initialize:tTe,toImageURL:iTe,toCanvas:sTe,toSVG:oTe,getState:dTe,setState:pTe,_watchPixelRatio:yTe});const wTe="view",NS="[",$S="]",TY="{",IY="}",bTe=":",_Y=",",STe="@",xTe=">",RTe=/[[\]{}]/,ETe={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let OY,LY;function Ec(e,t,n){return OY=t||wTe,LY=n||ETe,NY(e.trim()).map(iM)}function FTe(e){return LY[e]}function xv(e,t,n,i,r){const s=e.length;let o=0,a;for(;t<s;++t){if(a=e[t],!o&&a===n)return t;r&&r.indexOf(a)>=0?--o:i&&i.indexOf(a)>=0&&++o}return t}function NY(e){const t=[],n=e.length;let i=0,r=0;for(;r<n;)r=xv(e,r,_Y,NS+TY,$S+IY),t.push(e.substring(i,r).trim()),i=++r;if(t.length===0)throw"Empty event selector: "+e;return t}function iM(e){return e[0]==="["?ATe(e):DTe(e)}function ATe(e){const t=e.length;let n=1,i;if(n=xv(e,n,$S,NS,$S),n===t)throw"Empty between selector: "+e;if(i=NY(e.substring(1,n)),i.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==xTe)throw"Expected '>' after between selector: "+e;i=i.map(iM);const r=iM(e.slice(1).trim());return r.between?{between:i,stream:r}:(r.between=i,r)}function DTe(e){const t={source:OY},n=[];let i=[0,0],r=0,s=0,o=e.length,a=0,l,u;if(e[o-1]===IY){if(a=e.lastIndexOf(TY),a>=0){try{i=kTe(e.substring(a+1,o-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,a).trim(),o=e.length}else throw"Unmatched right brace: "+e;a=0}if(!o)throw e;if(e[0]===STe&&(r=++a),l=xv(e,a,bTe),l<o&&(n.push(e.substring(s,l).trim()),s=a=++l),a=xv(e,a,NS),a===o)n.push(e.substring(s,o).trim());else if(n.push(e.substring(s,a).trim()),u=[],s=++a,s===o)throw"Unmatched left bracket: "+e;for(;a<o;){if(a=xv(e,a,$S),a===o)throw"Unmatched left bracket: "+e;if(u.push(e.substring(s,a).trim()),a<o-1&&e[++a]!==NS)throw"Expected left bracket: "+e;s=++a}if(!(o=n.length)||RTe.test(n[o-1]))throw"Invalid event selector: "+e;return o>1?(t.type=n[1],r?t.markname=n[0].slice(1):FTe(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),u!=null&&(t.filter=u),i[0]&&(t.throttle=i[0]),i[1]&&(t.debounce=i[1]),t}function kTe(e){const t=e.split(_Y);if(!e.length||t.length>2)throw e;return t.map(n=>{const i=+n;if(i!==i)throw e;return i})}function PTe(e){return be(e)?e:{type:e||"pad"}}const ym=e=>+e||0,MTe=e=>({top:e,bottom:e,left:e,right:e});function TTe(e){return be(e)?e.signal?e:{top:ym(e.top),bottom:ym(e.bottom),left:ym(e.left),right:ym(e.right)}:MTe(ym(e))}const ii=e=>be(e)&&!ne(e)?it({},e):{value:e};function qV(e,t,n,i){return n!=null?(be(n)&&!ne(n)||ne(n)&&n.length&&be(n[0])?e.update[t]=n:e[i||"enter"][t]={value:n},1):0}function xi(e,t,n){for(const i in t)qV(e,i,t[i]);for(const i in n)qV(e,i,n[i],"update")}function ug(e,t,n){for(const i in t)n&&Ae(n,i)||(e[i]=it(e[i]||{},t[i]));return e}function bf(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const cO="mark",dO="frame",hO="scope",ITe="axis",_Te="axis-domain",OTe="axis-grid",LTe="axis-label",NTe="axis-tick",$Te="axis-title",BTe="legend",GTe="legend-band",zTe="legend-entry",HTe="legend-gradient",$Y="legend-label",VTe="legend-symbol",WTe="legend-title",UTe="title",qTe="title-text",jTe="title-subtitle";function KTe(e,t,n,i,r){const s={},o={};let a,l,u,c;l="lineBreak",t==="text"&&r[l]!=null&&!bf(l,e)&&jA(s,l,r[l]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),c=n===dO?r.group:n===cO?it({},r.mark,r[t]):null;for(l in c)u=bf(l,e)||(l==="fill"||l==="stroke")&&(bf("fill",e)||bf("stroke",e)),u||jA(s,l,c[l]);xe(i).forEach(d=>{const h=r.style&&r.style[d];for(const p in h)bf(p,e)||jA(s,p,h[p])}),e=it({},e);for(l in s)c=s[l],c.signal?(a=a||{})[l]=c:o[l]=c;return e.enter=it(o,e.enter),a&&(e.update=it(a,e.update)),e}function jA(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const BY=e=>Re(e)?ge(e):e.signal?`(${e.signal})`:GY(e);function Vx(e){if(e.gradient!=null)return XTe(e);let t=e.signal?`(${e.signal})`:e.color?YTe(e.color):e.field!=null?GY(e.field):e.value!==void 0?ge(e.value):void 0;return e.scale!=null&&(t=QTe(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t=`pow(${t},${lb(e.exponent)})`),e.mult!=null&&(t+=`*${lb(e.mult)}`),e.offset!=null&&(t+=`+${lb(e.offset)}`),e.round&&(t=`round(${t})`),t}const mw=(e,t,n,i)=>`(${e}(${[t,n,i].map(Vx).join(",")})+'')`;function YTe(e){return e.c?mw("hcl",e.h,e.c,e.l):e.h||e.s?mw("hsl",e.h,e.s,e.l):e.l||e.a?mw("lab",e.l,e.a,e.b):e.r||e.g||e.b?mw("rgb",e.r,e.g,e.b):null}function XTe(e){const t=[e.start,e.stop,e.count].map(n=>n==null?null:ge(n));for(;t.length&&wt(t)==null;)t.pop();return t.unshift(BY(e.gradient)),`gradient(${t.join(",")})`}function lb(e){return be(e)?"("+Vx(e)+")":e}function GY(e){return zY(be(e)?e:{datum:e})}function zY(e){let t,n,i;if(e.signal)t="datum",i=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(i=e.parent,t+=".datum"):i=e.group}else e.datum?(t="datum",i=e.datum):te("Invalid field reference: "+ge(e));return e.signal||(i=Re(i)?La(i).map(ge).join("]["):zY(i)),t+"["+i+"]"}function QTe(e,t){const n=BY(e.scale);return e.range!=null?t=`lerp(_range(${n}), ${+e.range})`:(t!==void 0&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(+e.band==1?"":"*"+lb(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),t==null&&(t="0")),t}function ZTe(e){let t="";return e.forEach(n=>{const i=Vx(n);t+=n.test?`(${n.test})?${i}:`:i}),wt(t)===":"&&(t+="null"),t}function HY(e,t,n,i,r,s){const o={};s=s||{},s.encoders={$encode:o},e=KTe(e,t,n,i,r.config);for(const a in e)o[a]=JTe(e[a],t,s,r);return s}function JTe(e,t,n,i){const r={},s={};for(const o in e)e[o]!=null&&(r[o]=tIe(eIe(e[o]),i,n,s));return{$expr:{marktype:t,channels:r},$fields:Object.keys(s),$output:Object.keys(e)}}function eIe(e){return ne(e)?ZTe(e):Vx(e)}function tIe(e,t,n,i){const r=Pa(e,t);return r.$fields.forEach(s=>i[s]=1),it(n,r.$params),r.$expr}const nIe="outer",iIe=["value","update","init","react","bind"];function jV(e,t){te(e+' for "outer" push: '+ge(t))}function VY(e,t){const n=e.name;if(e.push===nIe)t.signals[n]||jV("No prior signal definition",n),iIe.forEach(i=>{e[i]!==void 0&&jV("Invalid property ",i)});else{const i=t.addSignal(n,e.value);e.react===!1&&(i.react=!1),e.bind&&t.addBinding(n,e.bind)}}function rM(e,t,n,i){this.id=-1,this.type=e,this.value=t,this.params=n,i&&(this.parent=i)}function Wx(e,t,n,i){return new rM(e,t,n,i)}function BS(e,t){return Wx("operator",e,t)}function Ne(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function l0(e,t){return t?{$field:e,$name:t}:{$field:e}}const sM=l0("key");function KV(e,t){return{$compare:e,$order:t}}function rIe(e,t){const n={$key:e};return t&&(n.$flat=!0),n}const sIe="ascending",oIe="descending";function aIe(e){return be(e)?(e.order===oIe?"-":"+")+Ux(e.op,e.field):""}function Ux(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const fO="scope",oM="view";function Kn(e){return e&&e.signal}function lIe(e){return e&&e.expr}function ub(e){if(Kn(e))return!0;if(be(e)){for(const t in e)if(ub(e[t]))return!0}return!1}function co(e,t){return e??t}function Md(e){return e&&e.signal||e}const YV="timer";function u0(e,t){return(e.merge?cIe:e.stream?dIe:e.type?hIe:te("Invalid stream specification: "+ge(e)))(e,t)}function uIe(e){return e===fO?oM:e||oM}function cIe(e,t){const n=e.merge.map(r=>u0(r,t)),i=pO({merge:n},e,t);return t.addStream(i).id}function dIe(e,t){const n=u0(e.stream,t),i=pO({stream:n},e,t);return t.addStream(i).id}function hIe(e,t){let n;e.type===YV?(n=t.event(YV,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(uIe(e.source),e.type);const i=pO({stream:n},e,t);return Object.keys(i).length===1?n:t.addStream(i).id}function pO(e,t,n){let i=t.between;return i&&(i.length!==2&&te('Stream "between" parameter must have 2 entries: '+ge(t)),e.between=[u0(i[0],n),u0(i[1],n)]),i=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&i.push(fIe(t.marktype,t.markname,t.markrole)),t.source===fO&&i.push("inScope(event.item)"),i.length&&(e.filter=Pa("("+i.join(")&&(")+")",n).$expr),(i=t.throttle)!=null&&(e.throttle=+i),(i=t.debounce)!=null&&(e.debounce=+i),t.consume&&(e.consume=!0),e}function fIe(e,t,n){const i="event.item";return i+(e&&e!=="*"?"&&"+i+".mark.marktype==='"+e+"'":"")+(n?"&&"+i+".mark.role==='"+n+"'":"")+(t?"&&"+i+".mark.name==='"+t+"'":"")}const pIe={code:"_.$value",ast:{type:"Identifier",value:"value"}};function gIe(e,t,n){const i=e.encode,r={target:n};let s=e.events,o=e.update,a=[];s||te("Signal update missing events specification."),Re(s)&&(s=Ec(s,t.isSubscope()?fO:oM)),s=xe(s).filter(l=>l.signal||l.scale?(a.push(l),0):1),a.length>1&&(a=[vIe(a)]),s.length&&a.push(s.length>1?{merge:s}:s[0]),i!=null&&(o&&te("Signal encode and update are mutually exclusive."),o="encode(item(),"+ge(i)+")"),r.update=Re(o)?Pa(o,t):o.expr!=null?Pa(o.expr,t):o.value!=null?o.value:o.signal!=null?{$expr:pIe,$params:{$value:t.signalRef(o.signal)}}:te("Invalid signal update specification."),e.force&&(r.options={force:!0}),a.forEach(l=>t.addUpdate(it(mIe(l,t),r)))}function mIe(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):u0(e,t)}}function vIe(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function CIe(e,t){const n=t.getSignal(e.name);let i=e.update;e.init&&(i?te("Signals can not include both init and update expressions."):(i=e.init,n.initonly=!0)),i&&(i=Pa(i,t),n.update=i.$expr,n.params=i.$params),e.on&&e.on.forEach(r=>gIe(r,t,n.id))}const Wt=e=>(t,n,i)=>Wx(e,n,t||void 0,i),WY=Wt("aggregate"),yIe=Wt("axisticks"),UY=Wt("bound"),Bo=Wt("collect"),XV=Wt("compare"),wIe=Wt("datajoin"),qY=Wt("encode"),bIe=Wt("expression"),SIe=Wt("facet"),xIe=Wt("field"),RIe=Wt("key"),EIe=Wt("legendentries"),FIe=Wt("load"),AIe=Wt("mark"),DIe=Wt("multiextent"),kIe=Wt("multivalues"),PIe=Wt("overlap"),MIe=Wt("params"),jY=Wt("prefacet"),TIe=Wt("projection"),IIe=Wt("proxy"),_Ie=Wt("relay"),KY=Wt("render"),OIe=Wt("scale"),Rh=Wt("sieve"),LIe=Wt("sortitems"),YY=Wt("viewlayout"),NIe=Wt("values");let $Ie=0;const XY={min:"min",max:"max",count:"sum"};function BIe(e,t){const n=e.type||"linear";L7(n)||te("Unrecognized scale type: "+ge(n)),t.addScale(e.name,{type:n,domain:void 0})}function GIe(e,t){const n=t.getScale(e.name).params;let i;n.domain=QY(e.domain,e,t),e.range!=null&&(n.range=JY(e,t,n)),e.interpolate!=null&&XIe(e.interpolate,n),e.nice!=null&&(n.nice=YIe(e.nice,t)),e.bins!=null&&(n.bins=KIe(e.bins,t));for(i in e)Ae(n,i)||i==="name"||(n[i]=Ts(e[i],t))}function Ts(e,t){return be(e)?e.signal?t.signalRef(e.signal):te("Unsupported object: "+ge(e)):e}function cb(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>Ts(n,t))}function qx(e){te("Can not find data set: "+ge(e))}function QY(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&te("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(ne(e)?zIe:e.fields?VIe:HIe)(e,t,n)}function zIe(e,t,n){return e.map(i=>Ts(i,n))}function HIe(e,t,n){const i=n.getData(e.data);return i||qx(e.data),hp(t.type)?i.valuesRef(n,e.field,ZY(e.sort,!1)):B7(t.type)?i.domainRef(n,e.field):i.extentRef(n,e.field)}function VIe(e,t,n){const i=e.data,r=e.fields.reduce((s,o)=>(o=Re(o)?{data:i,field:o}:ne(o)||o.signal?WIe(o,n):o,s.push(o),s),[]);return(hp(t.type)?UIe:B7(t.type)?qIe:jIe)(e,n,r)}function WIe(e,t){const n="_:vega:_"+$Ie++,i=Bo({});if(ne(e))i.value={$ingest:e};else if(e.signal){const r="setdata("+ge(n)+","+e.signal+")";i.params.input=t.signalRef(r)}return t.addDataPipeline(n,[i,Rh({})]),{data:n,field:"data"}}function UIe(e,t,n){const i=ZY(e.sort,!0);let r,s;const o=n.map(u=>{const c=t.getData(u.data);return c||qx(u.data),c.countsRef(t,u.field,i)}),a={groupby:sM,pulse:o};i&&(r=i.op||"count",s=i.field?Ux(r,i.field):"count",a.ops=[XY[r]],a.fields=[t.fieldRef(s)],a.as=[s]),r=t.add(WY(a));const l=t.add(Bo({pulse:Ne(r)}));return s=t.add(NIe({field:sM,sort:t.sortRef(i),pulse:Ne(l)})),Ne(s)}function ZY(e,t){return e&&(!e.field&&!e.op?be(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?te("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!XY[e.op]&&te("Multiple domain scales can not be sorted using "+e.op)),e}function qIe(e,t,n){const i=n.map(r=>{const s=t.getData(r.data);return s||qx(r.data),s.domainRef(t,r.field)});return Ne(t.add(kIe({values:i})))}function jIe(e,t,n){const i=n.map(r=>{const s=t.getData(r.data);return s||qx(r.data),s.extentRef(t,r.field)});return Ne(t.add(DIe({extents:i})))}function KIe(e,t){return e.signal||ne(e)?cb(e,t):t.objectProperty(e)}function YIe(e,t){return e.signal?t.signalRef(e.signal):be(e)?{interval:Ts(e.interval),step:Ts(e.step)}:Ts(e)}function XIe(e,t){t.interpolate=Ts(e.type||e),e.gamma!=null&&(t.interpolateGamma=Ts(e.gamma))}function JY(e,t,n){const i=t.config.range;let r=e.range;if(r.signal)return t.signalRef(r.signal);if(Re(r)){if(i&&Ae(i,r))return e=it({},e,{range:i[r]}),JY(e,t,n);r==="width"?r=[0,{signal:"width"}]:r==="height"?r=hp(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:te("Unrecognized scale range value: "+ge(r))}else if(r.scheme){n.scheme=ne(r.scheme)?cb(r.scheme,t):Ts(r.scheme,t),r.extent&&(n.schemeExtent=cb(r.extent,t)),r.count&&(n.schemeCount=Ts(r.count,t));return}else if(r.step){n.rangeStep=Ts(r.step,t);return}else{if(hp(e.type)&&!ne(r))return QY(r,e,t);ne(r)||te("Unsupported range type: "+ge(r))}return r.map(s=>(ne(s)?cb:Ts)(s,t))}function QIe(e,t){const n=t.config.projection||{},i={};for(const r in e)r!=="name"&&(i[r]=aM(e[r],r,t));for(const r in n)i[r]==null&&(i[r]=aM(n[r],r,t));t.addProjection(e.name,i)}function aM(e,t,n){return ne(e)?e.map(i=>aM(i,t,n)):be(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:te("Unsupported parameter object: "+ge(e)):e}const Go="top",cg="left",dg="right",ac="bottom",eX="center",ZIe="vertical",JIe="start",e_e="middle",t_e="end",lM="index",gO="label",n_e="offset",bp="perc",i_e="perc2",Ls="value",vC="guide-label",mO="guide-title",r_e="group-title",s_e="group-subtitle",QV="symbol",db="gradient",uM="discrete",cM="size",o_e="shape",a_e="fill",l_e="stroke",u_e="strokeWidth",c_e="strokeDash",d_e="opacity",vO=[cM,o_e,a_e,l_e,u_e,c_e,d_e],CC={name:1,style:1,interactive:1},St={value:0},Ns={value:1},jx="group",tX="rect",CO="rule",h_e="symbol",Eh="text";function c0(e){return e.type=jx,e.interactive=e.interactive||!1,e}function Br(e,t){const n=(i,r)=>co(e[i],co(t[i],r));return n.isVertical=i=>ZIe===co(e.direction,t.direction||(i?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>co(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>co(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>co(e.columns,co(t.columns,+n.isVertical(!0))),n}function nX(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function f_e(e,t,n){const i=t.config.style[n];return i&&i[e]}function Kx(e,t,n){return`item.anchor === '${JIe}' ? ${e} : item.anchor === '${t_e}' ? ${t} : ${n}`}const yO=Kx(ge(cg),ge(dg),ge(eX));function p_e(e){const t=e("tickBand");let n=e("tickOffset"),i,r;return t?t.signal?(i={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},r={signal:`(${t.signal}) === 'extent'`},be(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : ${n}`})):t==="extent"?(i=1,r=!0,n=0):(i=.5,r=!1):(i=e("bandPosition"),r=e("tickExtra")),{extra:r,band:i,offset:n}}function iX(e,t){return t?e?be(e)?Object.assign({},e,{offset:iX(e.offset,t)}):{value:e,offset:t}:t:e}function cs(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=ug(e.encode,t,CC)):e.interactive=!1,e}function g_e(e,t,n,i){const r=Br(e,n),s=r.isVertical(),o=r.gradientThickness(),a=r.gradientLength();let l,u,c,d,h;s?(u=[0,1],c=[0,0],d=o,h=a):(u=[0,0],c=[1,0],d=a,h=o);const p={enter:l={opacity:St,x:St,y:St,width:ii(d),height:ii(h)},update:it({},l,{opacity:Ns,fill:{gradient:t,start:u,stop:c}}),exit:{opacity:St}};return xi(p,{stroke:r("gradientStrokeColor"),strokeWidth:r("gradientStrokeWidth")},{opacity:r("gradientOpacity")}),cs({type:tX,role:HTe,encode:p},i)}function m_e(e,t,n,i,r){const s=Br(e,n),o=s.isVertical(),a=s.gradientThickness(),l=s.gradientLength();let u,c,d,h,p="";o?(u="y",d="y2",c="x",h="width",p="1-"):(u="x",d="x2",c="y",h="height");const g={opacity:St,fill:{scale:t,field:Ls}};g[u]={signal:p+"datum."+bp,mult:l},g[c]=St,g[d]={signal:p+"datum."+i_e,mult:l},g[h]=ii(a);const m={enter:g,update:it({},g,{opacity:Ns}),exit:{opacity:St}};return xi(m,{stroke:s("gradientStrokeColor"),strokeWidth:s("gradientStrokeWidth")},{opacity:s("gradientOpacity")}),cs({type:tX,role:GTe,key:Ls,from:r,encode:m},i)}const v_e=`datum.${bp}<=0?"${cg}":datum.${bp}>=1?"${dg}":"${eX}"`,C_e=`datum.${bp}<=0?"${ac}":datum.${bp}>=1?"${Go}":"${e_e}"`;function ZV(e,t,n,i){const r=Br(e,t),s=r.isVertical(),o=ii(r.gradientThickness()),a=r.gradientLength();let l=r("labelOverlap"),u,c,d,h,p="";const g={enter:u={opacity:St},update:c={opacity:Ns,text:{field:gO}},exit:{opacity:St}};return xi(g,{fill:r("labelColor"),fillOpacity:r("labelOpacity"),font:r("labelFont"),fontSize:r("labelFontSize"),fontStyle:r("labelFontStyle"),fontWeight:r("labelFontWeight"),limit:co(e.labelLimit,t.gradientLabelLimit)}),s?(u.align={value:"left"},u.baseline=c.baseline={signal:C_e},d="y",h="x",p="1-"):(u.align=c.align={signal:v_e},u.baseline={value:"top"},d="x",h="y"),u[d]=c[d]={signal:p+"datum."+bp,mult:a},u[h]=c[h]=o,o.offset=co(e.labelOffset,t.gradientLabelOffset)||0,l=l?{separation:r("labelSeparation"),method:l,order:"datum."+lM}:void 0,cs({type:Eh,role:$Y,style:vC,key:Ls,from:i,encode:g,overlap:l},n)}function y_e(e,t,n,i,r){const s=Br(e,t),o=n.entries,a=!!(o&&o.interactive),l=o?o.name:void 0,u=s("clipHeight"),c=s("symbolOffset"),d={data:"value"},h=`(${r}) ? datum.${n_e} : datum.${cM}`,p=u?ii(u):{field:cM},g=`datum.${lM}`,m=`max(1, ${r})`;let C,y,b,S,x;p.mult=.5,C={enter:y={opacity:St,x:{signal:h,mult:.5,offset:c},y:p},update:b={opacity:Ns,x:y.x,y:y.y},exit:{opacity:St}};let E=null,A=null;e.fill||(E=t.symbolBaseFillColor,A=t.symbolBaseStrokeColor),xi(C,{fill:s("symbolFillColor",E),shape:s("symbolType"),size:s("symbolSize"),stroke:s("symbolStrokeColor",A),strokeDash:s("symbolDash"),strokeDashOffset:s("symbolDashOffset"),strokeWidth:s("symbolStrokeWidth")},{opacity:s("symbolOpacity")}),vO.forEach(M=>{e[M]&&(b[M]=y[M]={scale:e[M],field:Ls})});const F=cs({type:h_e,role:VTe,key:Ls,from:d,clip:u?!0:void 0,encode:C},n.symbols),P=ii(c);P.offset=s("labelOffset"),C={enter:y={opacity:St,x:{signal:h,offset:P},y:p},update:b={opacity:Ns,text:{field:gO},x:y.x,y:y.y},exit:{opacity:St}},xi(C,{align:s("labelAlign"),baseline:s("labelBaseline"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontStyle:s("labelFontStyle"),fontWeight:s("labelFontWeight"),limit:s("labelLimit")});const D=cs({type:Eh,role:$Y,style:vC,key:Ls,from:d,encode:C},n.labels);return C={enter:{noBound:{value:!u},width:St,height:u?ii(u):St,opacity:St},exit:{opacity:St},update:b={opacity:Ns,row:{signal:null},column:{signal:null}}},s.isVertical(!0)?(S=`ceil(item.mark.items.length / ${m})`,b.row.signal=`${g}%${S}`,b.column.signal=`floor(${g} / ${S})`,x={field:["row",g]}):(b.row.signal=`floor(${g} / ${m})`,b.column.signal=`${g} % ${m}`,x={field:g}),b.column.signal=`(${r})?${b.column.signal}:${g}`,i={facet:{data:i,name:"value",groupby:lM}},c0({role:hO,from:i,encode:ug(C,o,CC),marks:[F,D],name:l,interactive:a,sort:x})}function w_e(e,t){const n=Br(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const wO='item.orient === "left"',bO='item.orient === "right"',Yx=`(${wO} || ${bO})`,b_e=`datum.vgrad && ${Yx}`,S_e=Kx('"top"','"bottom"','"middle"'),x_e=Kx('"right"','"left"','"center"'),R_e=`datum.vgrad && ${bO} ? (${x_e}) : (${Yx} && !(datum.vgrad && ${wO})) ? "left" : ${yO}`,E_e=`item._anchor || (${Yx} ? "middle" : "start")`,F_e=`${b_e} ? (${wO} ? -90 : 90) : 0`,A_e=`${Yx} ? (datum.vgrad ? (${bO} ? "bottom" : "top") : ${S_e}) : "top"`;function D_e(e,t,n,i){const r=Br(e,t),s={enter:{opacity:St},update:{opacity:Ns,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:St}};return xi(s,{orient:r("titleOrient"),_anchor:r("titleAnchor"),anchor:{signal:E_e},angle:{signal:F_e},align:{signal:R_e},baseline:{signal:A_e},text:e.title,fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),baseline:r("titleBaseline")}),cs({type:Eh,role:WTe,style:mO,from:i,encode:s},n)}function k_e(e,t){let n;return be(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+JV(e.path)+")":e.sphere&&(n="geoShape("+JV(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function JV(e){return be(e)&&e.signal?e.signal:ge(e)}function rX(e){const t=e.role||"";return t.startsWith("axis")||t.startsWith("legend")||t.startsWith("title")?t:e.type===jx?hO:t||cO}function P_e(e){return{marktype:e.type,name:e.name||void 0,role:e.role||rX(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function M_e(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function SO(e,t){const n=NU(e.type);n||te("Unrecognized transform type: "+ge(e.type));const i=Wx(n.type.toLowerCase(),null,sX(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(i)),i.metadata=n.metadata||{},i}function sX(e,t,n){const i={},r=e.params.length;for(let s=0;s<r;++s){const o=e.params[s];i[o.name]=T_e(o,t,n)}return i}function T_e(e,t,n){const i=e.type,r=t[e.name];if(i==="index")return I_e(e,t,n);if(r===void 0){e.required&&te("Missing required "+ge(t.type)+" parameter: "+ge(e.name));return}else{if(i==="param")return __e(e,t,n);if(i==="projection")return n.projectionRef(t[e.name])}return e.array&&!Kn(r)?r.map(s=>e5(e,s,n)):e5(e,r,n)}function e5(e,t,n){const i=e.type;if(Kn(t))return n5(i)?te("Expression references can not be signals."):KA(i)?n.fieldRef(t):i5(i)?n.compareRef(t):n.signalRef(t.signal);{const r=e.expr||KA(i);return r&&O_e(t)?n.exprRef(t.expr,t.as):r&&L_e(t)?l0(t.field,t.as):n5(i)?Pa(t,n):N_e(i)?Ne(n.getData(t).values):KA(i)?l0(t):i5(i)?n.compareRef(t):t}}function I_e(e,t,n){return Re(t.from)||te('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function __e(e,t,n){const i=t[e.name];return e.array?(ne(i)||te("Expected an array of sub-parameters. Instead: "+ge(i)),i.map(r=>t5(e,r,n))):t5(e,i,n)}function t5(e,t,n){const i=e.params.length;let r;for(let o=0;o<i;++o){r=e.params[o];for(const a in r.key)if(r.key[a]!==t[a]){r=null;break}if(r)break}r||te("Unsupported parameter: "+ge(t));const s=it(sX(r,t,n),r.key);return Ne(n.add(MIe(s)))}const O_e=e=>e&&e.expr,L_e=e=>e&&e.field,N_e=e=>e==="data",n5=e=>e==="expr",KA=e=>e==="field",i5=e=>e==="compare";function $_e(e,t,n){let i,r,s,o,a;return e?(i=e.facet)&&(t||te("Only group marks can be faceted."),i.field!=null?o=a=hb(i,n):(e.data?a=Ne(n.getData(e.data).aggregate):(s=SO(it({type:"aggregate",groupby:xe(i.groupby)},i.aggregate),n),s.params.key=n.keyRef(i.groupby),s.params.pulse=hb(i,n),o=a=Ne(n.add(s))),r=n.keyRef(i.groupby,!0))):o=Ne(n.add(Bo(null,[{}]))),o||(o=hb(e,n)),{key:r,pulse:o,parent:a}}function hb(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:Ne(t.getData(e.data).output)}function th(e,t,n,i,r){this.scope=e,this.input=t,this.output=n,this.values=i,this.aggregate=r,this.index={}}th.fromEntries=function(e,t){const n=t.length,i=t[n-1],r=t[n-2];let s=t[0],o=null,a=1;for(s&&s.type==="load"&&(s=t[1]),e.add(t[0]);a<n;++a)t[a].params.pulse=Ne(t[a-1]),e.add(t[a]),t[a].type==="aggregate"&&(o=t[a]);return new th(e,s,r,i,o)};function oX(e){return Re(e)?e:null}function r5(e,t,n){const i=Ux(n.op,n.field);let r;if(t.ops){for(let s=0,o=t.as.length;s<o;++s)if(t.as[s]===i)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((r=n.op.signal)?e.signalRef(r):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(i))}function wm(e,t,n,i,r,s,o){const a=t[n]||(t[n]={}),l=aIe(s);let u=oX(r),c,d;if(u!=null&&(e=t.scope,u=u+(l?"|"+l:""),c=a[u]),!c){const h=s?{field:sM,pulse:t.countsRef(e,r,s)}:{field:e.fieldRef(r),pulse:Ne(t.output)};l&&(h.sort=e.sortRef(s)),d=e.add(Wx(i,void 0,h)),o&&(t.index[r]=d),c=Ne(d),u!=null&&(a[u]=c)}return c}th.prototype={countsRef(e,t,n){const i=this,r=i.counts||(i.counts={}),s=oX(t);let o,a,l;return s!=null&&(e=i.scope,o=r[s]),o?n&&n.field&&r5(e,o.agg.params,n):(l={groupby:e.fieldRef(t,"key"),pulse:Ne(i.output)},n&&n.field&&r5(e,l,n),a=e.add(WY(l)),o=e.add(Bo({pulse:Ne(a)})),o={agg:a,ref:Ne(o)},s!=null&&(r[s]=o)),o.ref},tuplesRef(){return Ne(this.values)},extentRef(e,t){return wm(e,this,"extent","extent",t,!1)},domainRef(e,t){return wm(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return wm(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return wm(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return wm(e,this,"indata","tupleindex",t,!0,!0)}};function B_e(e,t,n){const i=e.from.facet,r=i.name,s=hb(i,t);let o;i.name||te("Facet must have a name: "+ge(i)),i.data||te("Facet must reference a data set: "+ge(i)),i.field?o=t.add(jY({field:t.fieldRef(i.field),pulse:s})):i.groupby?o=t.add(SIe({key:t.keyRef(i.groupby),group:Ne(t.proxy(n.parent)),pulse:s})):te("Facet must specify groupby or field: "+ge(i));const a=t.fork(),l=a.add(Bo()),u=a.add(Rh({pulse:Ne(l)}));a.addData(r,new th(a,l,l,u)),a.addSignal("parent",null),o.params.subflow={$subflow:a.parse(e).toRuntime()}}function G_e(e,t,n){const i=t.add(jY({pulse:n.pulse})),r=t.fork();r.add(Rh()),r.addSignal("parent",null),i.params.subflow={$subflow:r.parse(e).toRuntime()}}function aX(e,t,n){const i=e.remove,r=e.insert,s=e.toggle,o=e.modify,a=e.values,l=t.add(BS()),u="if("+e.trigger+',modify("'+n+'",'+[r,i,s,o,a].map(d=>d??"null").join(",")+"),0)",c=Pa(u,t);l.update=c.$expr,l.params=c.$params}function Xx(e,t){const n=rX(e),i=e.type===jx,r=e.from&&e.from.facet,s=e.overlap;let o=e.layout||n===hO||n===dO,a,l,u,c,d,h,p;const g=n===cO||o||r,m=$_e(e.from,i,t);l=t.add(wIe({key:m.key||(e.key?l0(e.key):void 0),pulse:m.pulse,clean:!i}));const C=Ne(l);l=u=t.add(Bo({pulse:C})),l=t.add(AIe({markdef:P_e(e),interactive:M_e(e.interactive,t),clip:k_e(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:Ne(l)}));const y=Ne(l);l=c=t.add(qY(HY(e.encode,e.type,n,e.style,t,{mod:!1,pulse:y}))),l.params.parent=t.encode(),e.transform&&e.transform.forEach(A=>{const F=SO(A,t),P=F.metadata;(P.generates||P.changes)&&te("Mark transforms should not generate new data."),P.nomod||(c.params.mod=!0),F.params.pulse=Ne(l),t.add(l=F)}),e.sort&&(l=t.add(LIe({sort:t.compareRef(e.sort),pulse:Ne(l)})));const b=Ne(l);(r||o)&&(o=t.add(YY({layout:t.objectProperty(e.layout),legends:t.legends,mark:y,pulse:b})),h=Ne(o));const S=t.add(UY({mark:y,pulse:h||b}));p=Ne(S),i&&(g&&(a=t.operators,a.pop(),o&&a.pop()),t.pushState(b,h||p,C),r?B_e(e,t,m):g?G_e(e,t,m):t.parse(e),t.popState(),g&&(o&&a.push(o),a.push(S))),s&&(p=z_e(s,p,t));const x=t.add(KY({pulse:p})),E=t.add(Rh({pulse:Ne(x)},void 0,t.parent()));e.name!=null&&(d=e.name,t.addData(d,new th(t,u,x,E)),e.on&&e.on.forEach(A=>{(A.insert||A.remove||A.toggle)&&te("Marks only support modify triggers."),aX(A,t,d)}))}function z_e(e,t,n){const i=e.method,r=e.bound,s=e.separation,o={separation:Kn(s)?n.signalRef(s.signal):s,method:Kn(i)?n.signalRef(i.signal):i,pulse:t};if(e.order&&(o.sort=n.compareRef({field:e.order})),r){const a=r.tolerance;o.boundTolerance=Kn(a)?n.signalRef(a.signal):+a,o.boundScale=n.scaleRef(r.scale),o.boundOrient=r.orient}return Ne(n.add(PIe(o)))}function H_e(e,t){const n=t.config.legend,i=e.encode||{},r=Br(e,n),s=i.legend||{},o=s.name||void 0,a=s.interactive,l=s.style,u={};let c=0,d,h,p;vO.forEach(S=>e[S]?(u[S]=e[S],c=c||e[S]):0),c||te("Missing valid scale for legend.");const g=V_e(e,t.scaleType(c)),m={title:e.title!=null,scales:u,type:g,vgrad:g!=="symbol"&&r.isVertical()},C=Ne(t.add(Bo(null,[m]))),y={enter:{x:{value:0},y:{value:0}}},b=Ne(t.add(EIe(h={type:g,scale:t.scaleRef(c),count:t.objectProperty(r("tickCount")),limit:t.property(r("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return g===db?(p=[g_e(e,c,n,i.gradient),ZV(e,n,i.labels,b)],h.count=h.count||t.signalRef(`max(2,2*floor((${Md(r.gradientLength())})/100))`)):g===uM?p=[m_e(e,c,n,i.gradient,b),ZV(e,n,i.labels,b)]:(d=w_e(e,n),p=[y_e(e,n,i,b,Md(d.columns))],h.size=q_e(e,t,p[0].marks)),p=[c0({role:zTe,from:C,encode:y,marks:p,layout:d,interactive:a})],m.title&&p.push(D_e(e,n,i.title,C)),Xx(c0({role:BTe,from:C,encode:ug(U_e(r,e,n),s,CC),marks:p,aria:r("aria"),description:r("description"),zindex:r("zindex"),name:o,interactive:a,style:l}),t)}function V_e(e,t){let n=e.type||QV;return!e.type&&W_e(e)===1&&(e.fill||e.stroke)&&(n=S_(t)?db:eP(t)?uM:QV),n!==db?n:eP(t)?uM:db}function W_e(e){return vO.reduce((t,n)=>t+(e[n]?1:0),0)}function U_e(e,t,n){const i={enter:{},update:{}};return xi(i,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),i}function q_e(e,t,n){const i=Md(s5("size",e,n)),r=Md(s5("strokeWidth",e,n)),s=Md(j_e(n[1].encode,t,vC));return Pa(`max(ceil(sqrt(${i})+${r}),${s})`,t)}function s5(e,t,n){return t[e]?`scale("${t[e]}",datum)`:nX(e,n[0].encode)}function j_e(e,t,n){return nX("fontSize",e)||f_e("fontSize",t,n)}const K_e=`item.orient==="${cg}"?-90:item.orient==="${dg}"?90:0`;function Y_e(e,t){e=Re(e)?{text:e}:e;const n=Br(e,t.config.title),i=e.encode||{},r=i.group||{},s=r.name||void 0,o=r.interactive,a=r.style,l=[],u={},c=Ne(t.add(Bo(null,[u])));return l.push(Z_e(e,n,X_e(e),c)),e.subtitle&&l.push(J_e(e,n,i.subtitle,c)),Xx(c0({role:UTe,from:c,encode:Q_e(n,r),marks:l,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:s,interactive:o,style:a}),t)}function X_e(e){const t=e.encode;return t&&t.title||it({name:e.name,interactive:e.interactive,style:e.style},t)}function Q_e(e,t){const n={enter:{},update:{}};return xi(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:yO},angle:{signal:K_e},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),ug(n,t,CC)}function Z_e(e,t,n,i){const r={value:0},s=e.text,o={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return xi(o,{text:s,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),cs({type:Eh,role:qTe,style:r_e,from:i,encode:o},n)}function J_e(e,t,n,i){const r={value:0},s=e.subtitle,o={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return xi(o,{text:s,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),cs({type:Eh,role:jTe,style:s_e,from:i,encode:o},n)}function e2e(e,t){const n=[];e.transform&&e.transform.forEach(i=>{n.push(SO(i,t))}),e.on&&e.on.forEach(i=>{aX(i,t,e.name)}),t.addDataPipeline(e.name,t2e(e,t,n))}function t2e(e,t,n){const i=[];let r=null,s=!1,o=!1,a,l,u,c,d;for(e.values?Kn(e.values)||ub(e.format)?(i.push(o5(t,e)),i.push(r=ed())):i.push(r=ed({$ingest:e.values,$format:e.format})):e.url?ub(e.url)||ub(e.format)?(i.push(o5(t,e)),i.push(r=ed())):i.push(r=ed({$request:e.url,$format:e.format})):e.source&&(r=a=xe(e.source).map(h=>Ne(t.getData(h).output)),i.push(null)),l=0,u=n.length;l<u;++l)c=n[l],d=c.metadata,!r&&!d.source&&i.push(r=ed()),i.push(c),d.generates&&(o=!0),d.modifies&&!o&&(s=!0),d.source?r=c:d.changes&&(r=null);return a&&(u=a.length-1,i[0]=_Ie({derive:s,pulse:u?a:a[0]}),(s||u)&&i.splice(1,0,ed())),r||i.push(ed()),i.push(Rh({})),i}function ed(e){const t=Bo({},e);return t.metadata={source:!0},t}function o5(e,t){return FIe({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const lX=e=>e===ac||e===Go,Qx=(e,t,n)=>Kn(e)?s2e(e.signal,t,n):e===cg||e===Go?t:n,ri=(e,t,n)=>Kn(e)?i2e(e.signal,t,n):lX(e)?t:n,xo=(e,t,n)=>Kn(e)?r2e(e.signal,t,n):lX(e)?n:t,uX=(e,t,n)=>Kn(e)?o2e(e.signal,t,n):e===Go?{value:t}:{value:n},n2e=(e,t,n)=>Kn(e)?a2e(e.signal,t,n):e===dg?{value:t}:{value:n},i2e=(e,t,n)=>cX(`${e} === '${Go}' || ${e} === '${ac}'`,t,n),r2e=(e,t,n)=>cX(`${e} !== '${Go}' && ${e} !== '${ac}'`,t,n),s2e=(e,t,n)=>xO(`${e} === '${cg}' || ${e} === '${Go}'`,t,n),o2e=(e,t,n)=>xO(`${e} === '${Go}'`,t,n),a2e=(e,t,n)=>xO(`${e} === '${dg}'`,t,n),cX=(e,t,n)=>(t=t!=null?ii(t):t,n=n!=null?ii(n):n,a5(t)&&a5(n)?(t=t?t.signal||ge(t.value):null,n=n?n.signal||ge(n.value):null,{signal:`${e} ? (${t}) : (${n})`}):[it({test:e},t)].concat(n||[])),a5=e=>e==null||Object.keys(e).length===1,xO=(e,t,n)=>({signal:`${e} ? (${Pf(t)}) : (${Pf(n)})`}),l2e=(e,t,n,i,r)=>({signal:(i!=null?`${e} === '${cg}' ? (${Pf(i)}) : `:"")+(n!=null?`${e} === '${ac}' ? (${Pf(n)}) : `:"")+(r!=null?`${e} === '${dg}' ? (${Pf(r)}) : `:"")+(t!=null?`${e} === '${Go}' ? (${Pf(t)}) : `:"")+"(null)"}),Pf=e=>Kn(e)?e.signal:e==null?null:ge(e),u2e=(e,t)=>t===0?0:Kn(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t},Gf=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function ff(e,t,n,i){let r;if(t&&Ae(t,e))return t[e];if(Ae(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":r="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":r=e[5].toLowerCase()+e.slice(6)}return i[mO][r]}else if(e.startsWith("label")){switch(e){case"labelColor":r="fill";break;case"labelFont":case"labelFontSize":r=e[5].toLowerCase()+e.slice(6)}return i[vC][r]}return null}function l5(e){const t={};for(const n of e)if(n)for(const i in n)t[i]=1;return Object.keys(t)}function c2e(e,t){var n=t.config,i=n.style,r=n.axis,s=t.scaleType(e.scale)==="band"&&n.axisBand,o=e.orient,a,l,u;if(Kn(o)){const d=l5([n.axisX,n.axisY]),h=l5([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);a={};for(u of d)a[u]=ri(o,ff(u,n.axisX,r,i),ff(u,n.axisY,r,i));l={};for(u of h)l[u]=l2e(o.signal,ff(u,n.axisTop,r,i),ff(u,n.axisBottom,r,i),ff(u,n.axisLeft,r,i),ff(u,n.axisRight,r,i))}else a=o===Go||o===ac?n.axisX:n.axisY,l=n["axis"+o[0].toUpperCase()+o.slice(1)];return a||l||s?it({},r,a,l,s):r}function d2e(e,t,n,i){const r=Br(e,t),s=e.orient;let o,a;const l={enter:o={opacity:St},update:a={opacity:Ns},exit:{opacity:St}};xi(l,{stroke:r("domainColor"),strokeCap:r("domainCap"),strokeDash:r("domainDash"),strokeDashOffset:r("domainDashOffset"),strokeWidth:r("domainWidth"),strokeOpacity:r("domainOpacity")});const u=u5(e,0),c=u5(e,1);return o.x=a.x=ri(s,u,St),o.x2=a.x2=ri(s,c),o.y=a.y=xo(s,u,St),o.y2=a.y2=xo(s,c),cs({type:CO,role:_Te,from:i,encode:l},n)}function u5(e,t){return{scale:e.scale,range:t}}function h2e(e,t,n,i,r){const s=Br(e,t),o=e.orient,a=e.gridScale,l=Qx(o,1,-1),u=f2e(e.offset,l);let c,d,h;const p={enter:c={opacity:St},update:h={opacity:Ns},exit:d={opacity:St}};xi(p,{stroke:s("gridColor"),strokeCap:s("gridCap"),strokeDash:s("gridDash"),strokeDashOffset:s("gridDashOffset"),strokeOpacity:s("gridOpacity"),strokeWidth:s("gridWidth")});const g={scale:e.scale,field:Ls,band:r.band,extra:r.extra,offset:r.offset,round:s("tickRound")},m=ri(o,{signal:"height"},{signal:"width"}),C=a?{scale:a,range:0,mult:l,offset:u}:{value:0,offset:u},y=a?{scale:a,range:1,mult:l,offset:u}:it(m,{mult:l,offset:u});return c.x=h.x=ri(o,g,C),c.y=h.y=xo(o,g,C),c.x2=h.x2=xo(o,y),c.y2=h.y2=ri(o,y),d.x=ri(o,g),d.y=xo(o,g),cs({type:CO,role:OTe,key:Ls,from:i,encode:p},n)}function f2e(e,t){if(t!==1)if(!be(e))e=Kn(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);else{let n=e=it({},e);for(;n.mult!=null;)if(be(n.mult))n=n.mult=it({},n.mult);else return n.mult=Kn(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n.mult=t}return e}function p2e(e,t,n,i,r,s){const o=Br(e,t),a=e.orient,l=Qx(a,-1,1);let u,c,d;const h={enter:u={opacity:St},update:d={opacity:Ns},exit:c={opacity:St}};xi(h,{stroke:o("tickColor"),strokeCap:o("tickCap"),strokeDash:o("tickDash"),strokeDashOffset:o("tickDashOffset"),strokeOpacity:o("tickOpacity"),strokeWidth:o("tickWidth")});const p=ii(r);p.mult=l;const g={scale:e.scale,field:Ls,band:s.band,extra:s.extra,offset:s.offset,round:o("tickRound")};return d.y=u.y=ri(a,St,g),d.y2=u.y2=ri(a,p),c.x=ri(a,g),d.x=u.x=xo(a,St,g),d.x2=u.x2=xo(a,p),c.y=xo(a,g),cs({type:CO,role:NTe,key:Ls,from:i,encode:h},n)}function YA(e,t,n,i,r){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+i+","+r+")"}}function g2e(e,t,n,i,r,s){const o=Br(e,t),a=e.orient,l=e.scale,u=Qx(a,-1,1),c=Md(o("labelFlush")),d=Md(o("labelFlushOffset")),h=o("labelAlign"),p=o("labelBaseline");let g=c===0||!!c,m;const C=ii(r);C.mult=u,C.offset=ii(o("labelPadding")||0),C.offset.mult=u;const y={scale:l,field:Ls,band:.5,offset:iX(s.offset,o("labelOffset"))},b=ri(a,g?YA(l,c,'"left"','"right"','"center"'):{value:"center"},n2e(a,"left","right")),S=ri(a,uX(a,"bottom","top"),g?YA(l,c,'"top"','"bottom"','"middle"'):{value:"middle"}),x=YA(l,c,`-(${d})`,d,0);g=g&&d;const E={opacity:St,x:ri(a,y,C),y:xo(a,y,C)},A={enter:E,update:m={opacity:Ns,text:{field:gO},x:E.x,y:E.y,align:b,baseline:S},exit:{opacity:St,x:E.x,y:E.y}};xi(A,{dx:!h&&g?ri(a,x):null,dy:!p&&g?xo(a,x):null}),xi(A,{angle:o("labelAngle"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontWeight:o("labelFontWeight"),fontStyle:o("labelFontStyle"),limit:o("labelLimit"),lineHeight:o("labelLineHeight")},{align:h,baseline:p});const F=o("labelBound");let P=o("labelOverlap");return P=P||F?{separation:o("labelSeparation"),method:P,order:"datum.index",bound:F?{scale:l,orient:a,tolerance:F}:null}:void 0,m.align!==b&&(m.align=Gf(m.align,b)),m.baseline!==S&&(m.baseline=Gf(m.baseline,S)),cs({type:Eh,role:LTe,style:vC,key:Ls,from:i,encode:A,overlap:P},n)}function m2e(e,t,n,i){const r=Br(e,t),s=e.orient,o=Qx(s,-1,1);let a,l;const u={enter:a={opacity:St,anchor:ii(r("titleAnchor",null)),align:{signal:yO}},update:l=it({},a,{opacity:Ns,text:ii(e.title)}),exit:{opacity:St}},c={signal:`lerp(range("${e.scale}"), ${Kx(0,1,.5)})`};return l.x=ri(s,c),l.y=xo(s,c),a.angle=ri(s,St,u2e(o,90)),a.baseline=ri(s,uX(s,ac,Go),{value:ac}),l.angle=a.angle,l.baseline=a.baseline,xi(u,{fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),angle:r("titleAngle"),baseline:r("titleBaseline")}),v2e(r,s,u,n),u.update.align=Gf(u.update.align,a.align),u.update.angle=Gf(u.update.angle,a.angle),u.update.baseline=Gf(u.update.baseline,a.baseline),cs({type:Eh,role:$Te,style:mO,from:i,encode:u},n)}function v2e(e,t,n,i){const r=(a,l)=>a!=null?(n.update[l]=Gf(ii(a),n.update[l]),!1):!bf(l,i),s=r(e("titleX"),"x"),o=r(e("titleY"),"y");n.enter.auto=o===s?ii(o):ri(t,ii(o),ii(s))}function C2e(e,t){const n=c2e(e,t),i=e.encode||{},r=i.axis||{},s=r.name||void 0,o=r.interactive,a=r.style,l=Br(e,n),u=p_e(l),c={scale:e.scale,ticks:!!l("ticks"),labels:!!l("labels"),grid:!!l("grid"),domain:!!l("domain"),title:e.title!=null},d=Ne(t.add(Bo({},[c]))),h=Ne(t.add(yIe({scale:t.scaleRef(e.scale),extra:t.property(u.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),p=[];let g;return c.grid&&p.push(h2e(e,n,i.grid,h,u)),c.ticks&&(g=l("tickSize"),p.push(p2e(e,n,i.ticks,h,g,u))),c.labels&&(g=c.ticks?g:0,p.push(g2e(e,n,i.labels,h,g,u))),c.domain&&p.push(d2e(e,n,i.domain,d)),c.title&&p.push(m2e(e,n,i.title,d)),Xx(c0({role:ITe,from:d,encode:ug(y2e(l,e),r,CC),marks:p,aria:l("aria"),description:l("description"),zindex:l("zindex"),name:s,interactive:o,style:a}),t)}function y2e(e,t){const n={enter:{},update:{}};return xi(n,{orient:e("orient"),offset:e("offset")||0,position:co(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function dX(e,t,n){const i=xe(e.signals),r=xe(e.scales);return n||i.forEach(s=>VY(s,t)),xe(e.projections).forEach(s=>QIe(s,t)),r.forEach(s=>BIe(s,t)),xe(e.data).forEach(s=>e2e(s,t)),r.forEach(s=>GIe(s,t)),(n||i).forEach(s=>CIe(s,t)),xe(e.axes).forEach(s=>C2e(s,t)),xe(e.marks).forEach(s=>Xx(s,t)),xe(e.legends).forEach(s=>H_e(s,t)),e.title&&Y_e(e.title,t),t.parseLambdas(),t}const w2e=e=>ug({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function b2e(e,t){const n=t.config,i=Ne(t.root=t.add(BS())),r=S2e(e,n);r.forEach(u=>VY(u,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const s=t.add(Bo()),o=t.add(qY(HY(w2e(e.encode),jx,dO,e.style,t,{pulse:Ne(s)}))),a=t.add(YY({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:i,pulse:Ne(o)}));t.operators.pop(),t.pushState(Ne(o),Ne(a),null),dX(e,t,r),t.operators.push(a);let l=t.add(UY({mark:i,pulse:Ne(a)}));return l=t.add(KY({pulse:Ne(l)})),l=t.add(Rh({pulse:Ne(l)})),t.addData("root",new th(t,s,s,l)),t}function bm(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function S2e(e,t){const n=o=>co(e[o],t[o]),i=[bm("background",n("background")),bm("autosize",PTe(n("autosize"))),bm("padding",TTe(n("padding"))),bm("width",n("width")||0),bm("height",n("height")||0)],r=i.reduce((o,a)=>(o[a.name]=a,o),{}),s={};return xe(e.signals).forEach(o=>{Ae(r,o.name)?o=it(r[o.name],o):i.push(o),s[o.name]=o}),xe(t.signals).forEach(o=>{!Ae(s,o.name)&&!Ae(r,o.name)&&i.push(o)}),i}function hX(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function c5(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}hX.prototype=c5.prototype={parse(e){return dX(e,this)},fork(){return new c5(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof rM?Ne(e):e;return this.add(IIe({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(i,r,s){let o,a;i&&(o=i.data||(i.data={}),a=o[r]||(o[r]=[]),a.push(s))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const i in t.index)n(t.index[i],e,"index:"+i)}return this},pushState(e,t,n){this._encode.push(Ne(this.add(Rh({pulse:e})))),this._parent.push(t),this._lookup.push(n?Ne(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return wt(this._parent)},encode(){return wt(this._encode)},lookup(){return wt(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(Re(e))return l0(e,t);e.signal||te("Unsupported field reference: "+ge(e));const n=e.signal;let i=this.field[n];if(!i){const r={name:this.signalRef(n)};t&&(r.as=t),this.field[n]=i=Ne(this.add(xIe(r)))}return i},compareRef(e){let t=!1;const n=s=>Kn(s)?(t=!0,this.signalRef(s.signal)):lIe(s)?(t=!0,this.exprRef(s.expr)):s,i=xe(e.field).map(n),r=xe(e.order).map(n);return t?Ne(this.add(XV({fields:i,orders:r}))):KV(i,r)},keyRef(e,t){let n=!1;const i=s=>Kn(s)?(n=!0,Ne(r[s.signal])):s,r=this.signals;return e=xe(e).map(i),n?Ne(this.add(RIe({fields:e,flat:t}))):rIe(e,t)},sortRef(e){if(!e)return e;const t=Ux(e.op,e.field),n=e.order||sIe;return n.signal?Ne(this.add(XV({fields:t,orders:this.signalRef(n.signal)}))):KV(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const i=this.id();this.streams.push({id:i,source:e,type:t}),this.events[n]=i}return this.events[n]},hasOwnSignal(e){return Ae(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&te("Duplicate signal name: "+ge(e));const n=t instanceof rM?t:this.add(BS(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||te("Unrecognized signal name: "+ge(e)),this.signals[e]},signalRef(e){return this.signals[e]?Ne(this.signals[e]):(Ae(this.lambdas,e)||(this.lambdas[e]=this.add(BS(null))),Ne(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const i=e[t],r=Pa(i,this),s=this.lambdas[i];s.params=r.$params,s.update=r.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!be(e)?e:this.signalRef(e.signal||RO(e))},exprRef(e,t){const n={expr:Pa(e,this)};return t&&(n.expr.$name=t),Ne(this.add(bIe(n)))},addBinding(e,t){this.bindings||te("Nested signals do not support binding: "+ge(e)),this.bindings.push(it({signal:e},t))},addScaleProj(e,t){Ae(this.scales,e)&&te("Duplicate scale or projection name: "+ge(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,OIe(t))},addProjection(e,t){this.addScaleProj(e,TIe(t))},getScale(e){return this.scales[e]||te("Unrecognized scale name: "+ge(e)),this.scales[e]},scaleRef(e){return Ne(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return Ae(this.data,e)&&te("Duplicate data set name: "+ge(e)),this.data[e]=t},getData(e){return this.data[e]||te("Undefined data set name: "+ge(e)),this.data[e]},addDataPipeline(e,t){return Ae(this.data,e)&&te("Duplicate data set name: "+ge(e)),this.addData(e,th.fromEntries(this,t))}};function RO(e){return(ne(e)?x2e:R2e)(e)}function x2e(e){const t=e.length;let n="[";for(let i=0;i<t;++i){const r=e[i];n+=(i>0?",":"")+(be(r)?r.signal||RO(r):ge(r))}return n+"]"}function R2e(e){let t="{",n=0,i,r;for(i in e)r=e[i],t+=(++n>1?",":"")+ge(i)+":"+(be(r)?r.signal||RO(r):ge(r));return t+"}"}function E2e(){const e="sans-serif",i="#4c78a8",r="#000",s="#888",o="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:i},area:{fill:i},image:null,line:{stroke:i,strokeWidth:2},path:{stroke:i},rect:{fill:i},rule:{stroke:r},shape:{stroke:i},symbol:{fill:i,size:64},text:{fill:r,font:e,fontSize:11},trail:{fill:i,size:2},style:{"guide-label":{fill:r,font:e,fontSize:10},"guide-title":{fill:r,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:r,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:r,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:o},view:{fill:"transparent"}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:s,grid:!1,gridWidth:1,gridColor:o,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:s,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:o,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:s,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function F2e(e,t,n){return be(e)||te("Input Vega specification must be an object."),t=Yp(E2e(),t,e.config),b2e(e,new hX(t,n)).toRuntime()}var A2e="5.31.0";it(ap,pCe,q1e,Rxe,uEe,iFe,PAe,uAe,TAe,nDe,hDe,yDe);const D2e=Object.freeze(Object.defineProperty({__proto__:null,Bounds:Bn,CanvasHandler:lC,CanvasRenderer:eS,DATE:Ir,DAY:Ii,DAYOFYEAR:Da,Dataflow:Lf,Debug:s8,Error:$T,EventStream:X1,Gradient:eq,GroupItem:wx,HOURS:as,Handler:j_,HybridHandler:Uq,HybridRenderer:dP,Info:r8,Item:yx,MILLISECONDS:Ao,MINUTES:ls,MONTH:Ni,Marks:us,MultiPulse:uI,None:i8,Operator:qt,Parameters:Y1,Pulse:qu,QUARTER:Tr,RenderType:Nu,Renderer:aC,ResourceLoader:aq,SECONDS:Hs,SVGHandler:Tq,SVGRenderer:J_,SVGStringRenderer:Wq,Scenegraph:Rq,TIME_UNITS:JT,Transform:Q,View:PY,WEEK:qn,Warn:BT,YEAR:wi,accessor:$r,accessorFields:Li,accessorName:xn,array:xe,ascending:Qp,bandwidthNRD:fI,bin:GU,bootstrapCI:zU,boundClip:tj,boundContext:iC,boundItem:oP,boundMark:wq,boundStroke:Zl,changeset:wh,clampRange:m8,codegenExpression:iY,compare:WT,constant:Hi,cumulativeLogNormal:yI,cumulativeNormal:Z1,cumulativeUniform:xI,dayofyear:j8,debounce:UT,defaultLocale:rI,definition:NU,densityLogNormal:CI,densityNormal:pI,densityUniform:SI,domChild:Wn,domClear:Fs,domCreate:Ou,domFind:q_,dotbin:HU,error:te,expressionFunction:In,extend:it,extent:Ea,extentIndex:v8,falsy:xu,fastmap:Zp,field:Gs,flush:C8,font:Ex,fontFamily:oC,fontSize:Na,format:Vw,formatLocale:Tb,formats:aI,hasOwnProperty:Ae,id:z0,identity:zi,inferType:FU,inferTypes:AU,ingest:It,inherits:me,inrange:Ef,interpolate:x_,interpolateColors:vx,interpolateRange:G7,intersect:Qq,intersectBoxLine:Ff,intersectPath:M_,intersectPoint:T_,intersectRule:uq,isArray:ne,isBoolean:yc,isDate:Wu,isFunction:ot,isIterable:y8,isNumber:kt,isObject:be,isRegExp:w8,isString:Re,isTuple:j1,key:qT,lerp:b8,lineHeight:rc,loader:U1,locale:RU,logger:GT,lruCache:S8,markup:Z_,merge:x8,mergeConfig:Yp,multiLineOffset:V_,one:Kp,pad:R8,panLinear:c8,panLog:d8,panPow:h8,panSymlog:f8,parse:F2e,parseExpression:Z2,parseSelector:Ec,path:ix,pathCurves:D_,pathEqual:nj,pathParse:fp,pathRectangle:iq,pathRender:Xv,pathSymbols:nq,pathTrail:rq,peek:wt,point:Ax,projection:C2,quantileLogNormal:wI,quantileNormal:J1,quantileUniform:RI,quantiles:dI,quantizeInterpolator:z7,quarter:p8,quartiles:hI,get random(){return Vs},randomInteger:C0e,randomKDE:mI,randomLCG:v0e,randomLogNormal:WU,randomMixture:UU,randomNormal:gI,randomUniform:qU,read:PU,regressionConstant:EI,regressionExp:KU,regressionLinear:FI,regressionLoess:QU,regressionLog:jU,regressionPoly:XU,regressionPow:YU,regressionQuad:AI,renderModule:Dx,repeat:$m,resetDefaultLocale:pve,resetSVGClipId:oq,resetSVGDefIds:c1e,responseType:kU,runtimeContext:vY,sampleCurve:tx,sampleLogNormal:vI,sampleNormal:Q1,sampleUniform:bI,scale:Mt,sceneEqual:e2,sceneFromJSON:Sq,scenePickVisit:qb,sceneToJSON:bq,sceneVisit:Do,sceneZOrder:I_,scheme:R_,serializeXML:Gq,setHybridRendererOptions:o1e,setRandom:g0e,span:H0,splitAccessPath:La,stringValue:ge,textMetrics:is,timeBin:cU,timeFloor:eU,timeFormatLocale:Wv,timeInterval:ng,timeOffset:iU,timeSequence:oU,timeUnitSpecifier:q8,timeUnits:eI,toBoolean:jT,toDate:KT,toNumber:_i,toSet:Fo,toString:YT,transform:$U,transforms:ap,truncate:E8,truthy:zs,tupleid:$e,typeParsers:zk,utcFloor:tU,utcInterval:ig,utcOffset:rU,utcSequence:aU,utcdayofyear:X8,utcquarter:g8,utcweek:Q8,version:A2e,visitArray:Fu,week:K8,writeConfig:Xp,zero:Tu,zoomLinear:zT,zoomLog:HT,zoomPow:Fb,zoomSymlog:VT},Symbol.toStringTag,{value:"Module"}));function k2e(e,t,n){let i;t.x2&&(t.x?(n&&e.x>e.x2&&(i=e.x,e.x=e.x2,e.x2=i),e.width=e.x2-e.x):e.x=e.x2-(e.width||0)),t.xc&&(e.x=e.xc-(e.width||0)/2),t.y2&&(t.y?(n&&e.y>e.y2&&(i=e.y,e.y=e.y2,e.y2=i),e.height=e.y2-e.y):e.y=e.y2-(e.height||0)),t.yc&&(e.y=e.yc-(e.height||0)/2)}var P2e={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},M2e={"*":(e,t)=>e*t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,">":(e,t)=>e>t,"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,">=":(e,t)=>e>=t,"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,"===":(e,t)=>e===t,"!==":(e,t)=>e!==t,"&":(e,t)=>e&t,"|":(e,t)=>e|t,"^":(e,t)=>e^t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t},T2e={"+":e=>+e,"-":e=>-e,"~":e=>~e,"!":e=>!e};const I2e=Array.prototype.slice,td=(e,t,n)=>{const i=n?n(t[0]):t[0];return i[e].apply(i,I2e.call(t,1))},_2e=(e,t,n,i,r,s,o)=>new Date(e,t||0,n??1,i||0,r||0,s||0,o||0);var O2e={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(e,t,n)=>Math.max(t,Math.min(n,e)),now:Date.now,utc:Date.UTC,datetime:_2e,date:e=>new Date(e).getDate(),day:e=>new Date(e).getDay(),year:e=>new Date(e).getFullYear(),month:e=>new Date(e).getMonth(),hours:e=>new Date(e).getHours(),minutes:e=>new Date(e).getMinutes(),seconds:e=>new Date(e).getSeconds(),milliseconds:e=>new Date(e).getMilliseconds(),time:e=>new Date(e).getTime(),timezoneoffset:e=>new Date(e).getTimezoneOffset(),utcdate:e=>new Date(e).getUTCDate(),utcday:e=>new Date(e).getUTCDay(),utcyear:e=>new Date(e).getUTCFullYear(),utcmonth:e=>new Date(e).getUTCMonth(),utchours:e=>new Date(e).getUTCHours(),utcminutes:e=>new Date(e).getUTCMinutes(),utcseconds:e=>new Date(e).getUTCSeconds(),utcmilliseconds:e=>new Date(e).getUTCMilliseconds(),length:e=>e.length,join:function(){return td("join",arguments)},indexof:function(){return td("indexOf",arguments)},lastindexof:function(){return td("lastIndexOf",arguments)},slice:function(){return td("slice",arguments)},reverse:e=>e.slice().reverse(),sort:e=>e.slice().sort(Qp),parseFloat,parseInt,upper:e=>String(e).toUpperCase(),lower:e=>String(e).toLowerCase(),substring:function(){return td("substring",arguments,String)},split:function(){return td("split",arguments,String)},replace:function(){return td("replace",arguments,String)},trim:e=>String(e).trim(),regexp:RegExp,test:(e,t)=>RegExp(e).test(t)};const L2e=["view","item","group","xy","x","y"],dM=new Set([Function,eval,setTimeout,setInterval]);typeof setImmediate=="function"&&dM.add(setImmediate);const N2e={Literal:(e,t)=>t.value,Identifier:(e,t)=>{const n=t.name;return e.memberDepth>0?n:n==="datum"?e.datum:n==="event"?e.event:n==="item"?e.item:P2e[n]||e.params["$"+n]},MemberExpression:(e,t)=>{const n=!t.computed,i=e(t.object);n&&(e.memberDepth+=1);const r=e(t.property);if(n&&(e.memberDepth-=1),dM.has(i[r])){console.error(`Prevented interpretation of member "${r}" which could lead to insecure code execution`);return}return i[r]},CallExpression:(e,t)=>{const n=t.arguments;let i=t.callee.name;return i.startsWith("_")&&(i=i.slice(1)),i==="if"?e(n[0])?e(n[1]):e(n[2]):(e.fn[i]||O2e[i]).apply(e.fn,n.map(e))},ArrayExpression:(e,t)=>t.elements.map(e),BinaryExpression:(e,t)=>M2e[t.operator](e(t.left),e(t.right)),UnaryExpression:(e,t)=>T2e[t.operator](e(t.argument)),ConditionalExpression:(e,t)=>e(t.test)?e(t.consequent):e(t.alternate),LogicalExpression:(e,t)=>t.operator==="&&"?e(t.left)&&e(t.right):e(t.left)||e(t.right),ObjectExpression:(e,t)=>t.properties.reduce((n,i)=>{e.memberDepth+=1;const r=e(i.key);return e.memberDepth-=1,dM.has(e(i.value))?console.error(`Prevented interpretation of property "${r}" which could lead to insecure code execution`):n[r]=e(i.value),n},{})};function Sm(e,t,n,i,r,s){const o=a=>N2e[a.type](o,a);return o.memberDepth=0,o.fn=Object.create(t),o.params=n,o.datum=i,o.event=r,o.item=s,L2e.forEach(a=>o.fn[a]=function(){return r.vega[a](...arguments)}),o(e)}var $2e={operator(e,t){const n=t.ast,i=e.functions;return r=>Sm(n,i,r)},parameter(e,t){const n=t.ast,i=e.functions;return(r,s)=>Sm(n,i,s,r)},event(e,t){const n=t.ast,i=e.functions;return r=>Sm(n,i,void 0,void 0,r)},handler(e,t){const n=t.ast,i=e.functions;return(r,s)=>{const o=s.item&&s.item.datum;return Sm(n,i,r,o,s)}},encode(e,t){const{marktype:n,channels:i}=t,r=e.functions,s=n==="group"||n==="image"||n==="rect";return(o,a)=>{const l=o.datum;let u=0,c;for(const d in i)c=Sm(i[d].ast,r,a,l,void 0,o),o[d]!==c&&(o[d]=c,u=1);return n!=="rule"&&k2e(o,i,s),u}}};const B2e="5.23.0",G2e={version:B2e};function EO(e){return ue(e,"or")}function FO(e){return ue(e,"and")}function AO(e){return ue(e,"not")}function fb(e,t){if(AO(e))fb(e.not,t);else if(FO(e))for(const n of e.and)fb(n,t);else if(EO(e))for(const n of e.or)fb(n,t);else t(e)}function zf(e,t){return AO(e)?{not:zf(e.not,t)}:FO(e)?{and:e.and.map(n=>zf(n,t))}:EO(e)?{or:e.or.map(n=>zf(n,t))}:t(e)}const Ke=structuredClone;function fX(e){throw new Error(e)}function Sp(e,t){const n={};for(const i of t)Ae(e,i)&&(n[i]=e[i]);return n}function Pr(e,t){const n={...e};for(const i of t)delete n[i];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>Vt(e)).join(",")})`};function gt(e){if(kt(e))return e;const t=Re(e)?e:Vt(e);if(t.length<250)return t;let n=0;for(let i=0;i<t.length;i++){const r=t.charCodeAt(i);n=(n<<5)-n+r,n=n&n}return n}function hM(e){return e===!1||e===null}function ht(e,t){return e.includes(t)}function xp(e,t){let n=0;for(const[i,r]of e.entries())if(t(r,i,n++))return!0;return!1}function DO(e,t){let n=0;for(const[i,r]of e.entries())if(!t(r,i,n++))return!1;return!0}function pX(e,...t){for(const n of t)z2e(e,n??{});return e}function z2e(e,t){for(const n of le(t))Xp(e,n,t[n],!0)}function ga(e,t){const n=[],i={};let r;for(const s of e)r=t(s),!(r in i)&&(i[r]=1,n.push(s));return n}function H2e(e,t){const n=le(e),i=le(t);if(n.length!==i.length)return!1;for(const r of n)if(e[r]!==t[r])return!1;return!0}function gX(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function kO(e,t){for(const n of e)if(t.has(n))return!0;return!1}function fM(e){const t=new Set;for(const n of e){const r=La(n).map((o,a)=>a===0?o:`[${o}]`),s=r.map((o,a)=>r.slice(0,a+1).join(""));for(const o of s)t.add(o)}return t}function PO(e,t){return e===void 0||t===void 0?!0:kO(fM(e),fM(t))}function Ht(e){return le(e).length===0}const le=Object.keys,bi=Object.values,lc=Object.entries;function d0(e){return e===!0||e===!1}function an(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function Rv(e,t){return AO(e)?`!(${Rv(e.not,t)})`:FO(e)?`(${e.and.map(n=>Rv(n,t)).join(") && (")})`:EO(e)?`(${e.or.map(n=>Rv(n,t)).join(") || (")})`:t(e)}function GS(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&GS(e[n],t)&&delete e[n],Ht(e)}function yC(e){return e.charAt(0).toUpperCase()+e.substr(1)}function MO(e,t="datum"){const n=La(e),i=[];for(let r=1;r<=n.length;r++){const s=`[${n.slice(0,r).map(ge).join("][")}]`;i.push(`${t}${s}`)}return i.join(" && ")}function mX(e,t="datum"){return`${t}[${ge(La(e).join("."))}]`}function $t(e){return`datum['${e.replaceAll("'","\\'")}']`}function V2e(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function Us(e){return`${La(e).map(V2e).join("\\.")}`}function nh(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function hg(e){return`${La(e).join(".")}`}function Rp(e){return e?La(e).length:0}function Mn(...e){return e.find(t=>t!==void 0)}let vX=42;function CX(e){const t=++vX;return e?String(e)+t:t}function W2e(){vX=42}function yX(e){return wX(e)?e:`__${e}`}function wX(e){return e.startsWith("__")}function h0(e){if(e!==void 0)return(e%360+360)%360}function Zx(e){return kt(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}const d5=Object.getPrototypeOf(structuredClone({}));function ts(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor.name!==t.constructor.name)return!1;let n,i;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(i=n;i--!==0;)if(!ts(e[i],t[i]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const s of e.entries())if(!t.has(s[0]))return!1;for(const s of e.entries())if(!ts(s[1],t.get(s[0])))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const s of e.entries())if(!t.has(s[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(n=e.length,n!=t.length)return!1;for(i=n;i--!==0;)if(e[i]!==t[i])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&e.valueOf!==d5.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&e.toString!==d5.toString)return e.toString()===t.toString();const r=Object.keys(e);if(n=r.length,n!==Object.keys(t).length)return!1;for(i=n;i--!==0;)if(!Object.prototype.hasOwnProperty.call(t,r[i]))return!1;for(i=n;i--!==0;){const s=r[i];if(!ts(e[s],t[s]))return!1}return!0}return e!==e&&t!==t}function Vt(e){const t=[];return function n(i){if(i&&i.toJSON&&typeof i.toJSON=="function"&&(i=i.toJSON()),i===void 0)return;if(typeof i=="number")return isFinite(i)?""+i:"null";if(typeof i!="object")return JSON.stringify(i);let r,s;if(Array.isArray(i)){for(s="[",r=0;r<i.length;r++)r&&(s+=","),s+=n(i[r])||"null";return s+"]"}if(i===null)return"null";if(t.includes(i))throw new TypeError("Converting circular structure to JSON");const o=t.push(i)-1,a=Object.keys(i).sort();for(s="",r=0;r<a.length;r++){const l=a[r],u=n(i[l]);u&&(s&&(s+=","),s+=JSON.stringify(l)+":"+u)}return t.splice(o,1),`{${s}}`}(e)}function ue(e,t){return be(e)&&Ae(e,t)&&e[t]!==void 0}const Dl="row",kl="column",Jx="facet",ln="x",li="y",zo="x2",za="y2",Fc="xOffset",fg="yOffset",Ho="radius",eu="radius2",Ys="theta",tu="theta2",Vo="latitude",Wo="longitude",Uo="latitude2",qs="longitude2",Ac="time",Or="color",Ha="fill",Va="stroke",Lr="shape",nu="size",Fh="angle",iu="opacity",Dc="fillOpacity",kc="strokeOpacity",Pc="strokeWidth",Mc="strokeDash",wC="text",Ep="order",bC="detail",eR="key",ih="tooltip",tR="href",nR="url",iR="description",U2e={x:1,y:1,x2:1,y2:1},bX={theta:1,theta2:1,radius:1,radius2:1};function SX(e){return Ae(bX,e)}const TO={longitude:1,longitude2:1,latitude:1,latitude2:1};function xX(e){switch(e){case Vo:return"y";case Uo:return"y2";case Wo:return"x";case qs:return"x2"}}function RX(e){return Ae(TO,e)}const q2e=le(TO),IO={...U2e,...bX,...TO,xOffset:1,yOffset:1,color:1,fill:1,stroke:1,time:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1};function Hf(e){return e===Or||e===Ha||e===Va}const EX={row:1,column:1,facet:1},Is=le(EX),_O={...IO,...EX},j2e=le(_O),{order:Dlt,detail:klt,tooltip:Plt,...K2e}=_O,{row:Mlt,column:Tlt,facet:Ilt,...Y2e}=K2e;function X2e(e){return Ae(Y2e,e)}function FX(e){return Ae(_O,e)}const Q2e=[zo,za,Uo,qs,tu,eu];function AX(e){return Ah(e)!==e}function Ah(e){switch(e){case zo:return ln;case za:return li;case Uo:return Vo;case qs:return Wo;case tu:return Ys;case eu:return Ho}return e}function uc(e){if(SX(e))switch(e){case Ys:return"startAngle";case tu:return"endAngle";case Ho:return"outerRadius";case eu:return"innerRadius"}return e}function Wa(e){switch(e){case ln:return zo;case li:return za;case Vo:return Uo;case Wo:return qs;case Ys:return tu;case Ho:return eu}}function Nr(e){switch(e){case ln:case zo:return"width";case li:case za:return"height"}}function DX(e){switch(e){case ln:return"xOffset";case li:return"yOffset";case zo:return"x2Offset";case za:return"y2Offset";case Ys:return"thetaOffset";case Ho:return"radiusOffset";case tu:return"theta2Offset";case eu:return"radius2Offset"}}function OO(e){switch(e){case ln:return"xOffset";case li:return"yOffset"}}function Z2e(e){switch(e){case"xOffset":return"x";case"yOffset":return"y"}}const J2e=le(IO),{x:_lt,y:Olt,x2:Llt,y2:Nlt,xOffset:$lt,yOffset:Blt,latitude:Glt,longitude:zlt,latitude2:Hlt,longitude2:Vlt,theta:Wlt,theta2:Ult,radius:qlt,radius2:jlt,...LO}=IO,eOe=le(LO),NO={x:1,y:1},ru=le(NO);function Tn(e){return Ae(NO,e)}const $O={theta:1,radius:1},tOe=le($O);function rR(e){return e==="width"?ln:li}const kX={xOffset:1,yOffset:1};function SC(e){return Ae(kX,e)}const nOe={time:1};function XA(e){return e in nOe}const{text:Klt,tooltip:Ylt,href:Xlt,url:Qlt,description:Zlt,detail:Jlt,key:eut,order:tut,...PX}=LO,iOe=le(PX);function rOe(e){return Ae(LO,e)}function sOe(e){switch(e){case Or:case Ha:case Va:case nu:case Lr:case iu:case Pc:case Mc:return!0;case Dc:case kc:case Fh:case Ac:return!1}}const MX={...NO,...$O,...kX,...PX},BO=le(MX);function Ua(e){return Ae(MX,e)}function oOe(e,t){return lOe(e)[t]}const TX={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:nut,...aOe}=TX;function lOe(e){switch(e){case Or:case Ha:case Va:case iR:case bC:case eR:case ih:case tR:case Ep:case iu:case Dc:case kc:case Pc:case Jx:case Dl:case kl:return TX;case ln:case li:case Fc:case fg:case Vo:case Wo:case Ac:return aOe;case zo:case za:case Uo:case qs:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case nu:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case Mc:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case Lr:return{point:"always",geoshape:"always"};case wC:return{text:"always"};case Fh:return{point:"always",square:"always",text:"always"};case nR:return{image:"always"};case Ys:return{text:"always",arc:"always"};case Ho:return{text:"always",arc:"always"};case tu:case eu:return{arc:"always"}}}function QA(e){switch(e){case ln:case li:case Ys:case Ho:case Fc:case fg:case nu:case Fh:case Pc:case iu:case Dc:case kc:case Ac:case zo:case za:case tu:case eu:return;case Jx:case Dl:case kl:case Lr:case Mc:case wC:case ih:case tR:case nR:case iR:return"discrete";case Or:case Ha:case Va:return"flexible";case Vo:case Wo:case Uo:case qs:case bC:case eR:case Ep:return}}const uOe={argmax:1,argmin:1,average:1,count:1,distinct:1,exponential:1,exponentialb:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},cOe={count:1,min:1,max:1};function Gl(e){return ue(e,"argmin")}function Tc(e){return ue(e,"argmax")}function GO(e){return Re(e)&&Ae(uOe,e)}const dOe=new Set(["count","valid","missing","distinct"]);function sR(e){return Re(e)&&dOe.has(e)}function hOe(e){return Re(e)&&ht(["min","max"],e)}const fOe=new Set(["count","sum","distinct","valid","missing"]),pOe=new Set(["mean","average","median","q1","q3","min","max"]);function IX(e){return yc(e)&&(e=vR(e,void 0)),"bin"+le(e).map(t=>oR(e[t])?an(`_${t}_${lc(e[t])}`):an(`_${t}_${e[t]}`)).join("")}function Qt(e){return e===!0||Dh(e)&&!e.binned}function fi(e){return e==="binned"||Dh(e)&&e.binned===!0}function Dh(e){return be(e)}function oR(e){return ue(e,"param")}function h5(e){switch(e){case Dl:case kl:case nu:case Or:case Ha:case Va:case Pc:case iu:case Dc:case kc:case Lr:return 6;case Mc:return 4;default:return 10}}function xC(e){return ue(e,"expr")}function pi(e,{level:t}={level:0}){const n=le(e||{}),i={};for(const r of n)i[r]=t===0?Qr(e[r]):pi(e[r],{level:t-1});return i}function _X(e){const{anchor:t,frame:n,offset:i,orient:r,angle:s,limit:o,color:a,subtitleColor:l,subtitleFont:u,subtitleFontSize:c,subtitleFontStyle:d,subtitleFontWeight:h,subtitleLineHeight:p,subtitlePadding:g,...m}=e,C={...m,...a?{fill:a}:{}},y={...t?{anchor:t}:{},...n?{frame:n}:{},...i?{offset:i}:{},...r?{orient:r}:{},...s!==void 0?{angle:s}:{},...o!==void 0?{limit:o}:{}},b={...l?{subtitleColor:l}:{},...u?{subtitleFont:u}:{},...c?{subtitleFontSize:c}:{},...d?{subtitleFontStyle:d}:{},...h?{subtitleFontWeight:h}:{},...p?{subtitleLineHeight:p}:{},...g?{subtitlePadding:g}:{}},S=Sp(e,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:C,subtitleMarkConfig:S,nonMarkTitleProperties:y,subtitle:b}}function Pu(e){return Re(e)||ne(e)&&Re(e[0])}function Ie(e){return ue(e,"signal")}function kh(e){return ue(e,"step")}function gOe(e){return ne(e)?!1:ue(e,"fields")&&!ue(e,"data")}function mOe(e){return ne(e)?!1:ue(e,"fields")&&ue(e,"data")}function xl(e){return ne(e)?!1:ue(e,"field")&&ue(e,"data")}const vOe={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1},COe=le(vOe),yOe={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},pM=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function OX(e){const t=ne(e.condition)?e.condition.map(f5):f5(e.condition);return{...Qr(e),condition:t}}function Qr(e){if(xC(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function f5(e){if(xC(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function en(e){if(xC(e)){const{expr:t,...n}=e;return{signal:t,...n}}return Ie(e)?e:e!==void 0?{value:e}:void 0}function wOe(e){return Ie(e)?e.signal:ge(e)}function p5(e){return Ie(e)?e.signal:ge(e.value)}function yo(e){return Ie(e)?e.signal:e==null?null:ge(e)}function bOe(e,t,n){for(const i of n){const r=Ma(i,t.markDef,t.config);r!==void 0&&(e[i]=en(r))}return e}function LX(e){return[].concat(e.type,e.style??[])}function zt(e,t,n,i={}){const{vgChannel:r,ignoreVgConfig:s}=i;return r&&ue(t,r)?t[r]:t[e]!==void 0?t[e]:s&&(!r||r===e)?void 0:Ma(e,t,n,i)}function Ma(e,t,n,{vgChannel:i}={}){const r=gM(e,t,n.style);return Mn(i?r:void 0,r,i?n[t.type][i]:void 0,n[t.type][e],i?n.mark[i]:n.mark[e])}function gM(e,t,n){return NX(e,LX(t),n)}function NX(e,t,n){t=xe(t);let i;for(const r of t){const s=n[r];ue(s,e)&&(i=s[e])}return i}function $X(e,t){return xe(e).reduce((n,i)=>(n.field.push(ye(i,t)),n.order.push(i.sort??"ascending"),n),{field:[],order:[]})}function BX(e,t){const n=[...e];return t.forEach(i=>{for(const r of n)if(ts(r,i))return;n.push(i)}),n}function GX(e,t){return ts(e,t)||!t?e:e?[...xe(e),...xe(t)].join(", "):t}function zX(e,t){const n=e.value,i=t.value;if(n==null||i===null)return{explicit:e.explicit,value:null};if((Pu(n)||Ie(n))&&(Pu(i)||Ie(i)))return{explicit:e.explicit,value:GX(n,i)};if(Pu(n)||Ie(n))return{explicit:e.explicit,value:n};if(Pu(i)||Ie(i))return{explicit:e.explicit,value:i};if(!Pu(n)&&!Ie(n)&&!Pu(i)&&!Ie(i))return{explicit:e.explicit,value:BX(n,i)};throw new Error("It should never reach here")}function zO(e){return`Invalid specification ${Vt(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const SOe='Autosize "fit" only works for single views and layered views.';function g5(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function m5(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function v5(e){return e?`Dropping "fit-${e}" because spec has discrete ${Nr(e)}.`:'Dropping "fit" because spec has discrete size.'}function HO(e){return`Unknown field for ${e}. Cannot calculate view size.`}function C5(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function xOe(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function ROe(e){return`The "nearest" transform is not supported for ${e} marks.`}function HX(e){return`Selection not supported for ${e} yet.`}function EOe(e){return`Cannot find a selection named "${e}".`}const FOe="Scale bindings are currently only supported for scales with unbinned, continuous domains.",AOe="Sequntial scales are deprecated. The available quantitative scale type values are linear, log, pow, sqrt, symlog, time and utc",DOe="Legend bindings are only supported for selections over an individual field or encoding channel.";function kOe(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}function POe(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}const MOe="The same selection must be used to override scale domains in a layered view.",TOe='Interval selections should be initialized using "x", "y", "longitude", or "latitude" keys.';function IOe(e){return`Unknown repeated value "${e}".`}function y5(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const _Oe="Multiple timer selections in one unit spec are not supported. Ignoring all but the first.",VO="Animation involving facet, layer, or concat is currently unsupported.";function OOe(e){return`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${ge(e)}.`}function LOe(e,t,n,i){return(e.length?"Multiple ":"No ")+`matching ${ge(t)} encoding found for selection ${ge(n.param)}. Using "field": ${ge(i)}.`}const NOe="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function $Oe(e){return`Unrecognized parse "${e}".`}function w5(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}const BOe="Attempt to add the same child twice.";function GOe(e){return`Ignoring an invalid transform: ${Vt(e)}.`}const zOe='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function b5(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function HOe(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${Vt(t)} is overridden by a child projection ${Vt(n)}.`}const VOe="Arc marks uses theta channel rather than angle, replacing angle with theta.";function WOe(e){return`${e}Offset dropped because ${e} is continuous`}function UOe(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${Vt(n)}}.`}function VX(e){return`Invalid field type "${e}".`}function qOe(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function jOe(e){return`Invalid aggregation operator "${e}".`}function WX(e,t){const{fill:n,stroke:i}=t;return`Dropping color ${e} as the plot also has ${n&&i?"fill and stroke":n?"fill":"stroke"}.`}function KOe(e){return`Position range does not support relative band size for ${e}.`}function mM(e,t){return`Dropping ${Vt(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const YOe="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function aR(e,t,n){return`${e} dropped as it is incompatible with "${t}".`}function XOe(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function QOe(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function ZOe(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function JOe(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function ZA(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function eLe(e){return`The ${e} for range marks cannot be an expression`}function tLe(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function nLe(e,t){return`Specified orient "${e}" overridden with "${t}".`}function iLe(e){return`Cannot use the scale property "${e}" with non-color channel.`}function rLe(e){return`Cannot use the relative band size with ${e} scale.`}function sLe(e){return`Using unaggregated domain with raw field has no effect (${Vt(e)}).`}function oLe(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function aLe(e){return`Unaggregated domain is currently unsupported for log scale (${Vt(e)}).`}function lLe(e){return`Cannot apply size to non-oriented mark "${e}".`}function uLe(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function cLe(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function UX(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function qX(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function dLe(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${Vt(n)} and ${Vt(i)}). Using ${Vt(n)}.`}function hLe(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${Vt(n)} and ${Vt(i)}). Using the union of the two domains.`}function fLe(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function pLe(e){return`Dropping sort property ${Vt(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const S5="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",gLe="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",mLe="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",vLe="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function CLe(e){return`Cannot stack "${e}" if there is already "${e}2".`}function yLe(e){return`Stack is applied to a non-linear scale (${e}).`}function wLe(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function zS(e,t){return`Invalid ${e}: ${Vt(t)}.`}function bLe(e){return`Dropping day from datetime ${Vt(e)} as day cannot be combined with other units.`}function SLe(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function xLe(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function RLe(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function x5(e){return`1D error band does not support ${e}.`}function jX(e){return`Channel ${e} is required for "binned" bin.`}function ELe(e){return`Channel ${e} should not be used with "binned" bin.`}function FLe(e){return`Domain for ${e} is required for threshold scale.`}const KX=GT(BT);let rh=KX;function ALe(e){return rh=e,rh}function DLe(){return rh=KX,rh}function WO(...e){rh.error(...e)}function he(...e){rh.warn(...e)}function kLe(...e){rh.debug(...e)}function Ph(e){if(e&&be(e)){for(const t of qO)if(ue(e,t))return!0}return!1}const YX=["january","february","march","april","may","june","july","august","september","october","november","december"],PLe=YX.map(e=>e.substr(0,3)),XX=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],MLe=XX.map(e=>e.substr(0,3));function TLe(e){if(Zx(e)&&(e=+e),kt(e))return e>4&&he(zS("quarter",e)),e-1;throw new Error(zS("quarter",e))}function ILe(e){if(Zx(e)&&(e=+e),kt(e))return e-1;{const t=e.toLowerCase(),n=YX.indexOf(t);if(n!==-1)return n;const i=t.substr(0,3),r=PLe.indexOf(i);if(r!==-1)return r;throw new Error(zS("month",e))}}function _Le(e){if(Zx(e)&&(e=+e),kt(e))return e%7;{const t=e.toLowerCase(),n=XX.indexOf(t);if(n!==-1)return n;const i=t.substr(0,3),r=MLe.indexOf(i);if(r!==-1)return r;throw new Error(zS("day",e))}}function UO(e,t){const n=[];if(t&&e.day!==void 0&&le(e).length>1&&(he(bLe(e)),e=Ke(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const i=t?ILe(e.month):e.month;n.push(i)}else if(e.quarter!==void 0){const i=t?TLe(e.quarter):e.quarter;n.push(kt(i)?i*3:`${i}*3`)}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const i=t?_Le(e.day):e.day;n.push(kt(i)?i+1:`${i}+1`)}else n.push(1);for(const i of["hours","minutes","seconds","milliseconds"]){const r=e[i];n.push(typeof r>"u"?0:r)}return n}function sh(e){const n=UO(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function OLe(e){const n=UO(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function LLe(e){const t=UO(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}const QX={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},qO=le(QX);function NLe(e){return Ae(QX,e)}function Mh(e){return be(e)?e.binned:ZX(e)}function ZX(e){return e&&e.startsWith("binned")}function jO(e){return e.startsWith("utc")}function $Le(e){return e.substring(3)}const BLe={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function lR(e){return qO.filter(t=>eQ(e,t))}function JX(e){const t=lR(e);return t[t.length-1]}function eQ(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function GLe(e,t,{end:n}={end:!1}){const i=MO(t),r=jO(e)?"utc":"";function s(l){return l==="quarter"?`(${r}quarter(${i})-1)`:`${r}${l}(${i})`}let o;const a={};for(const l of qO)eQ(e,l)&&(a[l]=s(l),o=l);return n&&(a[o]+="+1"),OLe(a)}function tQ(e){if(!e)return;const t=lR(e);return`timeUnitSpecifier(${Vt(t)}, ${Vt(BLe)})`}function zLe(e,t,n){if(!e)return;const i=tQ(e);return`${n||jO(e)?"utc":"time"}Format(${t}, ${i})`}function si(e){if(!e)return;let t;return Re(e)?ZX(e)?t={unit:e.substring(6),binned:!0}:t={unit:e}:be(e)&&(t={...e,...e.unit?{unit:e.unit}:{}}),jO(t.unit)&&(t.utc=!0,t.unit=$Le(t.unit)),t}function HLe(e){const{utc:t,...n}=si(e);return n.unit?(t?"utc":"")+le(n).map(i=>an(`${i==="unit"?"":`_${i}_`}${n[i]}`)).join(""):(t?"utc":"")+"timeunit"+le(n).map(i=>an(`_${i}_${n[i]}`)).join("")}function nQ(e,t=n=>n){const n=si(e),i=JX(n.unit);if(i&&i!=="day"){const r={year:2001,month:1,date:1,hours:0,minutes:0,seconds:0,milliseconds:0},{step:s,part:o}=iQ(i,n.step),a={...r,[o]:+r[o]+s};return`${t(sh(a))} - ${t(sh(r))}`}}const VLe={year:1,month:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1};function WLe(e){return Ae(VLe,e)}function iQ(e,t=1){if(WLe(e))return{part:e,step:t};switch(e){case"day":case"dayofyear":return{part:"date",step:t};case"quarter":return{part:"month",step:t*3};case"week":return{part:"date",step:t*7}}}function ULe(e){return ue(e,"param")}function KO(e){return!!e?.field&&e.equal!==void 0}function YO(e){return!!e?.field&&e.lt!==void 0}function XO(e){return!!e?.field&&e.lte!==void 0}function QO(e){return!!e?.field&&e.gt!==void 0}function ZO(e){return!!e?.field&&e.gte!==void 0}function JO(e){if(e?.field){if(ne(e.range)&&e.range.length===2)return!0;if(Ie(e.range))return!0}return!1}function eL(e){return!!e?.field&&(ne(e.oneOf)||ne(e.in))}function qLe(e){return!!e?.field&&e.valid!==void 0}function rQ(e){return eL(e)||KO(e)||JO(e)||YO(e)||QO(e)||XO(e)||ZO(e)}function na(e,t){return CR(e,{timeUnit:t,wrapTime:!0})}function jLe(e,t){return e.map(n=>na(n,t))}function sQ(e,t=!0){const{field:n}=e,i=si(e.timeUnit),{unit:r,binned:s}=i||{},o=ye(e,{expr:"datum"}),a=r?`time(${s?o:GLe(r,n)})`:o;if(KO(e))return`${a}===${na(e.equal,r)}`;if(YO(e)){const l=e.lt;return`${a}<${na(l,r)}`}else if(QO(e)){const l=e.gt;return`${a}>${na(l,r)}`}else if(XO(e)){const l=e.lte;return`${a}<=${na(l,r)}`}else if(ZO(e)){const l=e.gte;return`${a}>=${na(l,r)}`}else{if(eL(e))return`indexof([${jLe(e.oneOf,r).join(",")}], ${a}) !== -1`;if(qLe(e))return uR(a,e.valid);if(JO(e)){const{range:l}=pi(e),u=Ie(l)?{signal:`${l.signal}[0]`}:l[0],c=Ie(l)?{signal:`${l.signal}[1]`}:l[1];if(u!==null&&c!==null&&t)return"inrange("+a+", ["+na(u,r)+", "+na(c,r)+"])";const d=[];return u!==null&&d.push(`${a} >= ${na(u,r)}`),c!==null&&d.push(`${a} <= ${na(c,r)}`),d.length>0?d.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${Vt(e)}`)}function uR(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function KLe(e){return rQ(e)&&e.timeUnit?{...e,timeUnit:si(e.timeUnit)}:e}const RC={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};function YLe(e){return e==="quantitative"||e==="temporal"}function oQ(e){return e==="ordinal"||e==="nominal"}const oh=RC.quantitative,tL=RC.ordinal,Fp=RC.temporal,nL=RC.nominal,pg=RC.geojson;function XLe(e){if(e)switch(e=e.toLowerCase(),e){case"q":case oh:return"quantitative";case"t":case Fp:return"temporal";case"o":case tL:return"ordinal";case"n":case nL:return"nominal";case pg:return"geojson"}}const gi={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",TIME:"time",UTC:"utc",POINT:"point",BAND:"band"},vM={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function QLe(e,t){const n=vM[e],i=vM[t];return n===i||n==="ordinal-position"&&i==="time"||i==="ordinal-position"&&n==="time"}const ZLe={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function R5(e){return ZLe[e]}const aQ=new Set(["linear","log","pow","sqrt","symlog"]),lQ=new Set([...aQ,"time","utc"]);function uQ(e){return aQ.has(e)}const cQ=new Set(["quantile","quantize","threshold"]),JLe=new Set([...lQ,...cQ,"sequential","identity"]),eNe=new Set(["ordinal","bin-ordinal","point","band"]);function oi(e){return eNe.has(e)}function ko(e){return JLe.has(e)}function ma(e){return lQ.has(e)}function Ap(e){return cQ.has(e)}const tNe={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,tickBandPaddingInner:.25,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:4,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4,zero:!0,framesPerSecond:2,animationDuration:5};function nNe(e){return!Re(e)&&ue(e,"name")}function dQ(e){return ue(e,"param")}function iNe(e){return ue(e,"unionWith")}function rNe(e){return be(e)&&"field"in e}const sNe={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,domainRaw:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},{type:iut,domain:rut,range:sut,rangeMax:out,rangeMin:aut,scheme:lut,...oNe}=sNe,aNe=le(oNe);function CM(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return ma(e)||e==="band"||e==="point";case"padding":case"rangeMin":case"rangeMax":return ma(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return e==="band";case"domainMax":case"domainMid":case"domainMin":case"domainRaw":case"clamp":return ma(e);case"nice":return ma(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return ko(e)&&!ht(["log","time","utc","threshold","quantile"],e)}}function hQ(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return Hf(e)?void 0:iLe(t);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"domainRaw":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}function lNe(e,t){return ht([tL,nL],t)?e===void 0||oi(e):t===Fp?ht([gi.TIME,gi.UTC,void 0],e):t===oh?uQ(e)||Ap(e)||e===void 0:!0}function uNe(e,t,n=!1){if(!Ua(e))return!1;switch(e){case ln:case li:case Fc:case fg:case Ys:case Ho:return ma(t)||t==="band"?!0:t==="point"?!n:!1;case Ac:return ht(["linear","band"],t);case nu:case Pc:case iu:case Dc:case kc:case Fh:return ma(t)||Ap(t)||ht(["band","point","ordinal"],t);case Or:case Ha:case Va:return t!=="band";case Mc:case Lr:return t==="ordinal"||Ap(t)}}function cNe(e){return be(e)&&"value"in e}const fr={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},fQ=fr.arc,cR=fr.area,dR=fr.bar,dNe=fr.image,hR=fr.line,fR=fr.point,hNe=fr.rect,HS=fr.rule,pQ=fr.text,iL=fr.tick,fNe=fr.trail,rL=fr.circle,sL=fr.square,gQ=fr.geoshape;function Ic(e){return["line","area","trail"].includes(e)}function f0(e){return["rect","bar","image","arc","tick"].includes(e)}const pNe=new Set(le(fr));function Ta(e){return ue(e,"type")}const gNe=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],mNe=["fill","fillOpacity"],vNe=[...gNe,...mNe],CNe={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1},E5=le(CNe),JA=["binSpacing","continuousBandSize","discreteBandSize","minBandSize"],yNe={area:["line","point"],bar:JA,rect:JA,line:["point"],tick:["bandSize","thickness",...JA]},wNe={color:"#4c78a8",invalid:"break-paths-show-path-domains",timeUnitBandSize:1},bNe={mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1},mQ=le(bNe);function ah(e){return ue(e,"band")}const SNe={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},xNe=5,oL={binSpacing:0,continuousBandSize:xNe,minBandSize:.25,timeUnitBandPosition:.5},RNe={...oL,binSpacing:1},ENe={...oL,thickness:1};function FNe(e){return Ta(e)?e.type:e}function vQ(e,{isPath:t}){return e===void 0||e==="break-paths-show-path-domains"?t?"break-paths-show-domains":"filter":e===null?"show":e}function aL({markDef:e,config:t,scaleChannel:n,scaleType:i,isCountAggregate:r}){if(!i||!ko(i)||r)return"always-valid";const s=vQ(zt("invalid",e,t),{isPath:Ic(e.type)});return t.scale?.invalid?.[n]!==void 0?"show":s}function ANe(e){return e==="break-paths-filter-domains"||e==="break-paths-show-domains"}function CQ({scaleName:e,scale:t,mode:n}){const i=`domain('${e}')`;if(!t||!e)return;const r=`${i}[0]`,s=`peek(${i})`,o=t.domainHasZero();return o==="definitely"?{scale:e,value:0}:o==="maybe"?{signal:`scale('${e}', inrange(0, ${i}) ? 0 : ${n==="zeroOrMin"?r:s})`}:{signal:`scale('${e}', ${n==="zeroOrMin"?r:s})`}}function yQ({scaleChannel:e,channelDef:t,scale:n,scaleName:i,markDef:r,config:s}){const o=n?.get("type"),a=Mo(t),l=sR(a?.aggregate),u=aL({scaleChannel:e,markDef:r,config:s,scaleType:o,isCountAggregate:l});if(a&&u==="show"){const c=s.scale.invalid?.[e]??"zero-or-min";return{test:uR(ye(a,{expr:"datum"}),!1),...DNe(c,n,i)}}}function DNe(e,t,n){if(cNe(e)){const{value:i}=e;return Ie(i)?{signal:i.signal}:{value:i}}return CQ({scale:t,scaleName:n,mode:"zeroOrMin"})}function lL(e){const{channel:t,channelDef:n,markDef:i,scale:r,scaleName:s,config:o}=e,a=Ah(t),l=uL(e),u=yQ({scaleChannel:a,channelDef:n,scale:r,scaleName:s,markDef:i,config:o});return u!==void 0?[u,l]:l}function kNe(e){const{datum:t}=e;return Ph(t)?sh(t):`${Vt(t)}`}function Td(e,t,n,i){const r={};if(t&&(r.scale=t),qa(e)){const{datum:s}=e;Ph(s)?r.signal=sh(s):Ie(s)?r.signal=s.signal:xC(s)?r.signal=s.expr:r.value=s}else r.field=ye(e,n);if(i){const{offset:s,band:o}=i;s&&(r.offset=s),o&&(r.band=o)}return r}function VS({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:i,startSuffix:r,endSuffix:s="end",bandPosition:o=.5}){const a=!Ie(o)&&0<o&&o<1?"datum":void 0,l=ye(t,{expr:a,suffix:r}),u=n!==void 0?ye(n,{expr:a}):ye(t,{suffix:s,expr:a}),c={};if(o===0||o===1){c.scale=e;const d=o===0?l:u;c.field=d}else{const d=Ie(o)?`(1-${o.signal}) * ${l} + ${o.signal} * ${u}`:`${1-o} * ${l} + ${o} * ${u}`;c.signal=`scale("${e}", ${d})`}return i&&(c.offset=i),c}function PNe({scaleName:e,fieldDef:t}){const n=ye(t,{expr:"datum"}),i=ye(t,{expr:"datum",suffix:"end"});return`abs(scale("${e}", ${i}) - scale("${e}", ${n}))`}function uL({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:s,scale:o,stack:a,offset:l,defaultRef:u,bandPosition:c}){if(t){if(Xe(t)){const d=o?.get("type");if(dr(t)){c??(c=cc({fieldDef:t,fieldDef2:n,markDef:i,config:r}));const{bin:h,timeUnit:p,type:g}=t;if(Qt(h)||c&&p&&g===Fp)return a?.impute?Td(t,s,{binSuffix:"mid"},{offset:l}):c&&!oi(d)?VS({scaleName:s,fieldOrDatumDef:t,bandPosition:c,offset:l}):Td(t,s,kC(t,e)?{binSuffix:"range"}:{},{offset:l});if(fi(h)){if(fe(n))return VS({scaleName:s,fieldOrDatumDef:t,fieldOrDatumDef2:n,bandPosition:c,offset:l});he(jX(e===ln?zo:za))}}return Td(t,s,oi(d)?{binSuffix:"range"}:{},{offset:l,band:d==="band"?c??t.bandPosition??.5:void 0})}else if(Po(t)){const d=t.value,h=l?{offset:l}:{};return{...Ev(e,d),...h}}}return ot(u)&&(u=u()),u&&{...u,...l?{offset:l}:{}}}function Ev(e,t){return ht(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:ht(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:en(t)}function lh(e){return e&&e!=="number"&&e!=="time"}function wQ(e,t,n){return`${e}(${t}${n?`, ${Vt(n)}`:""})`}const MNe="  ";function cL({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:s}){if(lh(n))return wo({fieldOrDatumDef:e,format:t,formatType:n,expr:i,config:s});const o=bQ(e,i,r),a=Dp(e);if(t===void 0&&n===void 0&&s.customFormatTypes){if(a==="quantitative"){if(r&&s.normalizedNumberFormatType)return wo({fieldOrDatumDef:e,format:s.normalizedNumberFormat,formatType:s.normalizedNumberFormatType,expr:i,config:s});if(s.numberFormatType)return wo({fieldOrDatumDef:e,format:s.numberFormat,formatType:s.numberFormatType,expr:i,config:s})}if(a==="temporal"&&s.timeFormatType&&fe(e)&&e.timeUnit===void 0)return wo({fieldOrDatumDef:e,format:s.timeFormat,formatType:s.timeFormatType,expr:i,config:s})}if(Pp(e)){const l=INe({field:o,timeUnit:fe(e)?si(e.timeUnit)?.unit:void 0,format:t,formatType:s.timeFormatType,rawTimeFormat:s.timeFormat,isUTCScale:Th(e)&&e.scale?.type===gi.UTC});return l?{signal:l}:void 0}if(t=yM({type:a,specifiedFormat:t,config:s,normalizeStack:r}),fe(e)&&Qt(e.bin)){const l=ye(e,{expr:i,binSuffix:"end"});return{signal:EC(o,l,t,n,s)}}else return t||Dp(e)==="quantitative"?{signal:`${RQ(o,t)}`}:{signal:`isValid(${o}) ? ${o} : ""+${o}`}}function bQ(e,t,n){return fe(e)?n?`${ye(e,{expr:t,suffix:"end"})}-${ye(e,{expr:t,suffix:"start"})}`:ye(e,{expr:t}):kNe(e)}function wo({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:s,field:o}){if(o??(o=bQ(e,i,r)),o!=="datum.value"&&fe(e)&&Qt(e.bin)){const a=ye(e,{expr:i,binSuffix:"end"});return{signal:EC(o,a,t,n,s)}}return{signal:wQ(n,o,t)}}function SQ(e,t,n,i,r,s){if(!(Re(i)&&lh(i))&&!(n===void 0&&i===void 0&&r.customFormatTypes&&Dp(e)==="quantitative"&&(r.normalizedNumberFormatType&&kp(e)&&e.stack==="normalize"||r.numberFormatType))){if(kp(e)&&e.stack==="normalize"&&r.normalizedNumberFormat)return yM({type:"quantitative",config:r,normalizeStack:!0});if(Pp(e)){const o=fe(e)?si(e.timeUnit)?.unit:void 0;return o===void 0&&r.customFormatTypes&&r.timeFormatType?void 0:TNe({specifiedFormat:n,timeUnit:o,config:r,omitTimeFormatConfig:s})}return yM({type:t,specifiedFormat:n,config:r})}}function xQ(e,t,n){if(e&&(Ie(e)||e==="number"||e==="time"))return e;if(Pp(t)&&n!=="time"&&n!=="utc")return fe(t)&&si(t?.timeUnit)?.utc?"utc":"time"}function yM({type:e,specifiedFormat:t,config:n,normalizeStack:i}){if(Re(t))return t;if(e===oh)return i?n.normalizedNumberFormat:n.numberFormat}function TNe({specifiedFormat:e,timeUnit:t,config:n,omitTimeFormatConfig:i}){return e||(t?{signal:tQ(t)}:i?void 0:n.timeFormat)}function RQ(e,t){return`format(${e}, "${t||""}")`}function F5(e,t,n,i){return lh(n)?wQ(n,e,t):RQ(e,(Re(t)?t:void 0)??i.numberFormat)}function EC(e,t,n,i,r){if(n===void 0&&i===void 0&&r.customFormatTypes&&r.numberFormatType)return EC(e,t,r.numberFormat,r.numberFormatType,r);const s=F5(e,n,i,r),o=F5(t,n,i,r);return`${uR(e,!1)} ? "null" : ${s} + "${MNe}" + ${o}`}function INe({field:e,timeUnit:t,format:n,formatType:i,rawTimeFormat:r,isUTCScale:s}){return!t||n?!t&&i?`${i}(${e}, '${n}')`:(n=Re(n)?n:r,`${s?"utc":"time"}Format(${e}, '${n}')`):zLe(t,e,s)}const pR="min",_Ne={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function A5(e){return Ae(_Ne,e)}function ONe(e){return ue(e,"encoding")}function Pl(e){return e&&(e.op==="count"||ue(e,"field"))}function EQ(e){return e&&ne(e)}function FC(e){return ue(e,"row")||ue(e,"column")}function dL(e){return ue(e,"header")}function gR(e){return ue(e,"facet")}function LNe(e){return ue(e,"param")}function NNe(e){return!Re(e)&&ue(e,"repeat")}function D5(e){const{field:t,timeUnit:n,bin:i,aggregate:r}=e;return{...n?{timeUnit:n}:{},...i?{bin:i}:{},...r?{aggregate:r}:{},field:t}}function hL(e){return ue(e,"sort")}function cc({fieldDef:e,fieldDef2:t,markDef:n,config:i}){if(Xe(e)&&e.bandPosition!==void 0)return e.bandPosition;if(fe(e)){const{timeUnit:r,bin:s}=e;if(r&&!t)return Ma("timeUnitBandPosition",n,i);if(Qt(s))return .5}}function FQ({channel:e,fieldDef:t,fieldDef2:n,markDef:i,config:r,scaleType:s,useVlSizeChannel:o}){const a=Nr(e),l=zt(o?"size":a,i,r,{vgChannel:a});if(l!==void 0)return l;if(fe(t)){const{timeUnit:u,bin:c}=t;if(u&&!n)return{band:Ma("timeUnitBandSize",i,r)};if(Qt(c)&&!oi(s))return{band:1}}if(f0(i.type))return s?oi(s)?r[i.type]?.discreteBandSize||{band:1}:r[i.type]?.continuousBandSize:r[i.type]?.discreteBandSize}function AQ(e,t,n,i){return Qt(e.bin)||e.timeUnit&&dr(e)&&e.type==="temporal"?cc({fieldDef:e,fieldDef2:t,markDef:n,config:i})!==void 0:!1}function DQ(e){return ue(e,"sort")&&!ue(e,"field")}function AC(e){return ue(e,"condition")}function mR(e){const t=e?.condition;return!!t&&!ne(t)&&fe(t)}function DC(e){const t=e?.condition;return!!t&&!ne(t)&&Xe(t)}function $Ne(e){const t=e?.condition;return!!t&&(ne(t)||Po(t))}function fe(e){return ue(e,"field")||e?.aggregate==="count"}function Dp(e){return e?.type}function qa(e){return ue(e,"datum")}function Hu(e){return dr(e)&&!US(e)||WS(e)}function k5(e){return dr(e)&&e.type==="quantitative"&&!e.bin||WS(e)}function WS(e){return qa(e)&&kt(e.datum)}function Xe(e){return fe(e)||qa(e)}function dr(e){return e&&(ue(e,"field")||e.aggregate==="count")&&ue(e,"type")}function Po(e){return ue(e,"value")}function Th(e){return ue(e,"scale")||ue(e,"sort")}function kp(e){return ue(e,"axis")||ue(e,"stack")||ue(e,"impute")}function kQ(e){return ue(e,"legend")}function PQ(e){return ue(e,"format")||ue(e,"formatType")}function BNe(e){return Pr(e,["legend","axis","header","scale"])}function GNe(e){return ue(e,"op")}function ye(e,t={}){let n=e.field;const i=t.prefix;let r=t.suffix,s="";if(HNe(e))n=yX("count");else{let o;if(!t.nofn)if(GNe(e))o=e.op;else{const{bin:a,aggregate:l,timeUnit:u}=e;Qt(a)?(o=IX(a),r=(t.binSuffix??"")+(t.suffix??"")):l?Tc(l)?(s=`["${n}"]`,n=`argmax_${l.argmax}`):Gl(l)?(s=`["${n}"]`,n=`argmin_${l.argmin}`):o=String(l):u&&!Mh(u)&&(o=HLe(u),r=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+(t.suffix??""))}o&&(n=n?`${o}_${n}`:o)}return r&&(n=`${n}_${r}`),i&&(n=`${i}_${n}`),t.forAs?hg(n):t.expr?mX(n,t.expr)+s:Us(n)+s}function US(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return fe(e)&&!!e.bin;case"temporal":return!1}throw new Error(VX(e.type))}function zNe(e){return Th(e)&&Ap(e.scale?.type)}function HNe(e){return e.aggregate==="count"}function VNe(e,t){const{field:n,bin:i,timeUnit:r,aggregate:s}=e;if(s==="count")return t.countTitle;if(Qt(i))return`${n} (binned)`;if(r&&!Mh(r)){const o=si(r)?.unit;if(o)return`${n} (${lR(o).join("-")})`}else if(s)return Tc(s)?`${n} for max ${s.argmax}`:Gl(s)?`${n} for min ${s.argmin}`:`${yC(s)} of ${n}`;return n}function WNe(e){const{aggregate:t,bin:n,timeUnit:i,field:r}=e;if(Tc(t))return`${r} for argmax(${t.argmax})`;if(Gl(t))return`${r} for argmin(${t.argmin})`;const s=i&&!Mh(i)?si(i):void 0,o=t||s?.unit||s?.maxbins&&"timeunit"||Qt(n)&&"bin";return o?`${o.toUpperCase()}(${r})`:r}const MQ=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return WNe(e);default:return VNe(e,t)}};let TQ=MQ;function IQ(e){TQ=e}function UNe(){IQ(MQ)}function Vf(e,t,{allowDisabling:n,includeDefault:i=!0}){const r=fL(e)?.title;if(!fe(e))return r??e.title;const s=e,o=i?pL(s,t):void 0;return n?Mn(r,s.title,o):r??s.title??o}function fL(e){if(kp(e)&&e.axis)return e.axis;if(kQ(e)&&e.legend)return e.legend;if(dL(e)&&e.header)return e.header}function pL(e,t){return TQ(e,t)}function qS(e){if(PQ(e)){const{format:t,formatType:n}=e;return{format:t,formatType:n}}else{const t=fL(e)??{},{format:n,formatType:i}=t;return{format:n,formatType:i}}}function qNe(e,t){switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(hL(e)&&ne(e.sort))return"ordinal";const{aggregate:n,bin:i,timeUnit:r}=e;if(r)return"temporal";if(i||n&&!Tc(n)&&!Gl(n))return"quantitative";if(Th(e)&&e.scale?.type)switch(vM[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}function Mo(e){if(fe(e))return e;if(mR(e))return e.condition}function jn(e){if(Xe(e))return e;if(DC(e))return e.condition}function _Q(e,t,n,i={}){if(Re(e)||kt(e)||yc(e)){const r=Re(e)?"string":kt(e)?"number":"boolean";return he(UOe(t,r,e)),{value:e}}return Xe(e)?jS(e,t,n,i):DC(e)?{...e,condition:jS(e.condition,t,n,i)}:e}function jS(e,t,n,i){if(PQ(e)){const{format:r,formatType:s,...o}=e;if(lh(s)&&!n.customFormatTypes)return he(b5(t)),jS(o,t,n,i)}else{const r=kp(e)?"axis":kQ(e)?"legend":dL(e)?"header":null;if(r&&e[r]){const{format:s,formatType:o,...a}=e[r];if(lh(o)&&!n.customFormatTypes)return he(b5(t)),jS({...e,[r]:a},t,n,i)}}return fe(e)?gL(e,t,i):jNe(e)}function jNe(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=kt(n)?"quantitative":Re(n)?"nominal":Ph(n)?"temporal":void 0,{...e,type:t}}function gL(e,t,{compositeMark:n=!1}={}){const{aggregate:i,timeUnit:r,bin:s,field:o}=e,a={...e};if(!n&&i&&!GO(i)&&!Tc(i)&&!Gl(i)&&(he(jOe(i)),delete a.aggregate),r&&(a.timeUnit=si(r)),o&&(a.field=`${o}`),Qt(s)&&(a.bin=vR(s,t)),fi(s)&&!Tn(t)&&he(ELe(t)),dr(a)){const{type:l}=a,u=XLe(l);l!==u&&(a.type=u),l!=="quantitative"&&sR(i)&&(he(qOe(l,i)),a.type="quantitative")}else if(!AX(t)){const l=qNe(a,t);a.type=l}if(dr(a)){const{compatible:l,warning:u}=KNe(a,t)||{};l===!1&&he(u)}if(hL(a)&&Re(a.sort)){const{sort:l}=a;if(A5(l))return{...a,sort:{encoding:l}};const u=l.substring(1);if(l.charAt(0)==="-"&&A5(u))return{...a,sort:{encoding:u,order:"descending"}}}if(dL(a)){const{header:l}=a;if(l){const{orient:u,...c}=l;if(u)return{...a,header:{...c,labelOrient:l.labelOrient||u,titleOrient:l.titleOrient||u}}}}return a}function vR(e,t){return yc(e)?{maxbins:h5(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?{...e,maxbins:h5(t)}:e}const pf={compatible:!0};function KNe(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case Dl:case kl:case Jx:return US(e)?pf:{compatible:!1,warning:QOe(t)};case ln:case li:case Fc:case fg:case Or:case Ha:case Va:case wC:case bC:case eR:case ih:case tR:case nR:case Fh:case Ys:case Ho:case iR:return pf;case Wo:case qs:case Vo:case Uo:return n!==oh?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:pf;case iu:case Dc:case kc:case Pc:case nu:case tu:case eu:case zo:case za:case Ac:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:pf;case Lr:case Mc:return!US(e)&&!zNe(e)?{compatible:!1,warning:ZOe(t)}:pf;case Ep:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:pf}}function Pp(e){const{formatType:t}=qS(e);return t==="time"||!t&&YNe(e)}function YNe(e){return e&&(e.type==="temporal"||fe(e)&&!!e.timeUnit)}function CR(e,{timeUnit:t,type:n,wrapTime:i,undefinedIfExprNotRequired:r}){const s=t&&si(t)?.unit;let o=s||n==="temporal",a;return xC(e)?a=e.expr:Ie(e)?a=e.signal:Ph(e)?(o=!0,a=sh(e)):(Re(e)||kt(e))&&o&&(a=`datetime(${Vt(e)})`,NLe(s)&&(kt(e)&&e<1e4||Re(e)&&isNaN(Date.parse(e)))&&(a=sh({[s]:e}))),a?i&&o?`time(${a})`:a:r?void 0:Vt(e)}function OQ(e,t){const{type:n}=e;return t.map(i=>{const r=fe(e)&&!Mh(e.timeUnit)?e.timeUnit:void 0,s=CR(i,{timeUnit:r,type:n,undefinedIfExprNotRequired:!0});return s!==void 0?{signal:s}:i})}function kC(e,t){return Qt(e.bin)?Ua(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}const P5={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function PC(e){return e?.condition}const LQ=["domain","grid","labels","ticks","title"],XNe={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},NQ={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},QNe={...NQ,style:1,labelExpr:1,encoding:1};function M5(e){return Ae(QNe,e)}const ZNe={axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1},$Q=le(ZNe);function su(e){return ue(e,"mark")}class yR{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return su(t)?FNe(t.mark)===this.name:!1}}function Id(e,t){const n=e&&e[t];return n?ne(n)?xp(n,i=>!!i.field):fe(n)||mR(n):!1}function BQ(e,t){const n=e&&e[t];return n?ne(n)?xp(n,i=>!!i.field):fe(n)||qa(n)||DC(n):!1}function GQ(e,t){if(Tn(t)){const n=e[t];if((fe(n)||qa(n))&&(oQ(n.type)||fe(n)&&n.timeUnit)){const i=OO(t);return BQ(e,i)}}return!1}function zQ(e){return xp(j2e,t=>{if(Id(e,t)){const n=e[t];if(ne(n))return xp(n,i=>!!i.aggregate);{const i=Mo(n);return i&&!!i.aggregate}}return!1})}function HQ(e,t){const n=[],i=[],r=[],s=[],o={};return mL(e,(a,l)=>{if(fe(a)){const{field:u,aggregate:c,bin:d,timeUnit:h,...p}=a;if(c||h||d){const m=fL(a)?.title;let C=ye(a,{forAs:!0});const y={...m?[]:{title:Vf(a,t,{allowDisabling:!0})},...p,field:C};if(c){let b;if(Tc(c)?(b="argmax",C=ye({op:"argmax",field:c.argmax},{forAs:!0}),y.field=`${C}.${u}`):Gl(c)?(b="argmin",C=ye({op:"argmin",field:c.argmin},{forAs:!0}),y.field=`${C}.${u}`):c!=="boxplot"&&c!=="errorbar"&&c!=="errorband"&&(b=c),b){const S={op:b,as:C};u&&(S.field=u),s.push(S)}}else if(n.push(C),dr(a)&&Qt(d)){if(i.push({bin:d,field:u,as:C}),n.push(ye(a,{binSuffix:"end"})),kC(a,l)&&n.push(ye(a,{binSuffix:"range"})),Tn(l)){const b={field:`${C}_end`};o[`${l}2`]=b}y.bin="binned",AX(l)||(y.type=oh)}else if(h&&!Mh(h)){r.push({timeUnit:h,field:u,as:C});const b=dr(a)&&a.type!==Fp&&"time";b&&(l===wC||l===ih?y.formatType=b:rOe(l)?y.legend={formatType:b,...y.legend}:Tn(l)&&(y.axis={formatType:b,...y.axis}))}o[l]=y}else n.push(u),o[l]=e[l]}else o[l]=e[l]}),{bins:i,timeUnits:r,aggregate:s,groupby:n,encoding:o}}function JNe(e,t,n){const i=oOe(t,n);if(i){if(i==="binned"){const r=e[t===zo?ln:li];return!!(fe(r)&&fe(e[t])&&fi(r.bin))}}else return!1;return!0}function e$e(e,t,n,i){const r={};for(const s of le(e))FX(s)||he(XOe(s));for(let s of J2e){if(!e[s])continue;const o=e[s];if(SC(s)){const a=Z2e(s),l=r[a];if(fe(l)&&YLe(l.type)&&fe(o)&&!l.timeUnit){he(WOe(a));continue}}if(s==="angle"&&t==="arc"&&!e.theta&&(he(VOe),s=Ys),!JNe(e,s,t)){he(aR(s,t));continue}if(s===nu&&t==="line"&&Mo(e[s])?.aggregate){he(YOe);continue}if(s===Or&&(n?"fill"in e:"stroke"in e)){he(WX("encoding",{fill:"fill"in e,stroke:"stroke"in e}));continue}if(s===bC||s===Ep&&!ne(o)&&!Po(o)||s===ih&&ne(o)){if(o){if(s===Ep){const a=e[s];if(DQ(a)){r[s]=a;continue}}r[s]=xe(o).reduce((a,l)=>(fe(l)?a.push(gL(l,s)):he(mM(l,s)),a),[])}}else{if(s===ih&&o===null)r[s]=null;else if(!fe(o)&&!qa(o)&&!Po(o)&&!AC(o)&&!Ie(o)){he(mM(o,s));continue}r[s]=_Q(o,s,i)}}return r}function wR(e,t){const n={};for(const i of le(e)){const r=_Q(e[i],i,t,{compositeMark:!0});n[i]=r}return n}function t$e(e){const t=[];for(const n of le(e))if(Id(e,n)){const i=e[n],r=xe(i);for(const s of r)fe(s)?t.push(s):mR(s)&&t.push(s.condition)}return t}function mL(e,t,n){if(e)for(const i of le(e)){const r=e[i];if(ne(r))for(const s of r)t.call(n,s,i);else t.call(n,r,i)}}function n$e(e,t,n,i){return e?le(e).reduce((r,s)=>{const o=e[s];return ne(o)?o.reduce((a,l)=>t.call(i,a,l,s),r):t.call(i,r,o,s)},n):n}function VQ(e,t){return le(t).reduce((n,i)=>{switch(i){case ln:case li:case tR:case iR:case nR:case zo:case za:case Fc:case fg:case Ys:case tu:case Ho:case eu:case Ac:case Vo:case Wo:case Uo:case qs:case wC:case Lr:case Fh:case ih:return n;case Ep:if(e==="line"||e==="trail")return n;case bC:case eR:{const r=t[i];if(ne(r)||fe(r))for(const s of xe(r))s.aggregate||n.push(ye(s,{}));return n}case nu:if(e==="trail")return n;case Or:case Ha:case Va:case iu:case Dc:case kc:case Mc:case Pc:{const r=Mo(t[i]);return r&&!r.aggregate&&n.push(ye(r,{})),n}}},[])}function i$e(e){const{tooltip:t,...n}=e;if(!t)return{filteredEncoding:n};let i,r;if(ne(t)){for(const s of t)s.aggregate?(i||(i=[]),i.push(s)):(r||(r=[]),r.push(s));i&&(n.tooltip=i)}else t.aggregate?n.tooltip=t:r=t;return ne(r)&&r.length===1&&(r=r[0]),{customTooltipWithoutAggregatedField:r,filteredEncoding:n}}function wM(e,t,n,i=!0){if("tooltip"in n)return{tooltip:n.tooltip};const r=e.map(({fieldPrefix:o,titlePrefix:a})=>{const l=i?` of ${vL(t)}`:"";return{field:o+t.field,type:t.type,title:Ie(a)?{signal:`${a}"${escape(l)}"`}:a+l}}),s=t$e(n).map(BNe);return{tooltip:[...r,...ga(s,gt)]}}function vL(e){const{title:t,field:n}=e;return Mn(t,n)}function CL(e,t,n,i,r){const{scale:s,axis:o}=n;return({partName:a,mark:l,positionPrefix:u,endPositionPrefix:c=void 0,extraEncoding:d={}})=>{const h=vL(n);return WQ(e,a,r,{mark:l,encoding:{[t]:{field:`${u}_${n.field}`,type:n.type,...h!==void 0?{title:h}:{},...s!==void 0?{scale:s}:{},...o!==void 0?{axis:o}:{}},...Re(c)?{[`${t}2`]:{field:`${c}_${n.field}`}}:{},...i,...d}})}}function WQ(e,t,n,i){const{clip:r,color:s,opacity:o}=e,a=e.type;return e[t]||e[t]===void 0&&n[t]?[{...i,mark:{...n[t],...r?{clip:r}:{},...s?{color:s}:{},...o?{opacity:o}:{},...Ta(i.mark)?i.mark:{type:i.mark},style:`${a}-${String(t)}`,...yc(e[t])?{}:e[t]}}]:[]}function UQ(e,t,n){const{encoding:i}=e,r=t==="vertical"?"y":"x",s=i[r],o=i[`${r}2`],a=i[`${r}Error`],l=i[`${r}Error2`];return{continuousAxisChannelDef:vw(s,n),continuousAxisChannelDef2:vw(o,n),continuousAxisChannelDefError:vw(a,n),continuousAxisChannelDefError2:vw(l,n),continuousAxis:r}}function vw(e,t){if(e?.aggregate){const{aggregate:n,...i}=e;return n!==t&&he(RLe(n,t)),i}else return e}function qQ(e,t){const{mark:n,encoding:i}=e,{x:r,y:s}=i;if(Ta(n)&&n.orient)return n.orient;if(Hu(r)){if(Hu(s)){const o=fe(r)&&r.aggregate,a=fe(s)&&s.aggregate;if(!o&&a===t)return"vertical";if(!a&&o===t)return"horizontal";if(o===t&&a===t)throw new Error("Both x and y cannot have aggregate");return Pp(s)&&!Pp(r)?"horizontal":"vertical"}return"horizontal"}else{if(Hu(s))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}}const KS="boxplot",r$e=["box","median","outliers","rule","ticks"],s$e=new yR(KS,KQ);function jQ(e){return kt(e)?"tukey":e}function KQ(e,{config:t}){e={...e,encoding:wR(e.encoding,t)};const{mark:n,encoding:i,params:r,projection:s,...o}=e,a=Ta(n)?n:{type:n};r&&he(HX("boxplot"));const l=a.extent??t.boxplot.extent,u=zt("size",a,t),c=a.invalid,d=jQ(l),{bins:h,timeUnits:p,transform:g,continuousAxisChannelDef:m,continuousAxis:C,groupby:y,aggregate:b,encodingWithoutContinuousAxis:S,ticksOrient:x,boxOrient:E,customTooltipWithoutAggregatedField:A}=o$e(e,l,t),F=hg(m.field),{color:P,size:D,...M}=S,O=Gc=>CL(a,C,m,Gc,t.boxplot),B=O(M),H=O(S),N=(be(t.boxplot.box)?t.boxplot.box.color:t.mark.color)||"#4c78a8",L=O({...M,...D?{size:D}:{},color:{condition:{test:`${$t(`lower_box_${m.field}`)} >= ${$t(`upper_box_${m.field}`)}`,...P||{value:N}}}}),G=wM([{fieldPrefix:d==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:d==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],m,S),q={type:"tick",color:"black",opacity:1,orient:x,invalid:c,aria:!1},V=d==="min-max"?G:wM([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],m,S),U=[...B({partName:"rule",mark:{type:"rule",invalid:c,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:V}),...B({partName:"rule",mark:{type:"rule",invalid:c,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:V}),...B({partName:"ticks",mark:q,positionPrefix:"lower_whisker",extraEncoding:V}),...B({partName:"ticks",mark:q,positionPrefix:"upper_whisker",extraEncoding:V})],ie=[...d!=="tukey"?U:[],...H({partName:"box",mark:{type:"bar",...u?{size:u}:{},orient:E,invalid:c,ariaRoleDescription:"box"},positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:G}),...L({partName:"median",mark:{type:"tick",invalid:c,...be(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{},...u?{size:u}:{},orient:x,aria:!1},positionPrefix:"mid_box",extraEncoding:G})];if(d==="min-max")return{...o,transform:(o.transform??[]).concat(g),layer:ie};const pe=$t(`lower_box_${m.field}`),K=$t(`upper_box_${m.field}`),Fe=`(${K} - ${pe})`,Je=`${pe} - ${l} * ${Fe}`,Me=`${K} + ${l} * ${Fe}`,De=$t(m.field),xt={joinaggregate:YQ(m.field),groupby:y},En={transform:[{filter:`(${Je} <= ${De}) && (${De} <= ${Me})`},{aggregate:[{op:"min",field:m.field,as:`lower_whisker_${F}`},{op:"max",field:m.field,as:`upper_whisker_${F}`},{op:"min",field:`lower_box_${m.field}`,as:`lower_box_${F}`},{op:"max",field:`upper_box_${m.field}`,as:`upper_box_${F}`},...b],groupby:y}],layer:U},{tooltip:Se,...je}=M,{scale:et,axis:ce}=m,On=vL(m),rt=Pr(ce,["title"]),gn=WQ(a,"outliers",t.boxplot,{transform:[{filter:`(${De} < ${Je}) || (${De} > ${Me})`}],mark:"point",encoding:{[C]:{field:m.field,type:m.type,...On!==void 0?{title:On}:{},...et!==void 0?{scale:et}:{},...Ht(rt)?{}:{axis:rt}},...je,...P?{color:P}:{},...A?{tooltip:A}:{}}})[0];let Ln;const Nn=[...h,...p,xt];return gn?Ln={transform:Nn,layer:[gn,En]}:(Ln=En,Ln.transform.unshift(...Nn)),{...o,layer:[Ln,{transform:g,layer:ie}]}}function YQ(e){const t=hg(e);return[{op:"q1",field:e,as:`lower_box_${t}`},{op:"q3",field:e,as:`upper_box_${t}`}]}function o$e(e,t,n){const i=qQ(e,KS),{continuousAxisChannelDef:r,continuousAxis:s}=UQ(e,i,KS),o=r.field,a=hg(o),l=jQ(t),u=[...YQ(o),{op:"median",field:o,as:`mid_box_${a}`},{op:"min",field:o,as:(l==="min-max"?"lower_whisker_":"min_")+a},{op:"max",field:o,as:(l==="min-max"?"upper_whisker_":"max_")+a}],c=l==="min-max"||l==="tukey"?[]:[{calculate:`${$t(`upper_box_${a}`)} - ${$t(`lower_box_${a}`)}`,as:`iqr_${a}`},{calculate:`min(${$t(`upper_box_${a}`)} + ${$t(`iqr_${a}`)} * ${t}, ${$t(`max_${a}`)})`,as:`upper_whisker_${a}`},{calculate:`max(${$t(`lower_box_${a}`)} - ${$t(`iqr_${a}`)} * ${t}, ${$t(`min_${a}`)})`,as:`lower_whisker_${a}`}],{[s]:d,...h}=e.encoding,{customTooltipWithoutAggregatedField:p,filteredEncoding:g}=i$e(h),{bins:m,timeUnits:C,aggregate:y,groupby:b,encoding:S}=HQ(g,n),x=i==="vertical"?"horizontal":"vertical",E=i,A=[...m,...C,{aggregate:[...y,...u],groupby:b},...c];return{bins:m,timeUnits:C,transform:A,groupby:b,aggregate:y,continuousAxisChannelDef:r,continuousAxis:s,encodingWithoutContinuousAxis:S,ticksOrient:x,boxOrient:E,customTooltipWithoutAggregatedField:p}}const yL="errorbar",a$e=["ticks","rule"],l$e=new yR(yL,XQ);function XQ(e,{config:t}){e={...e,encoding:wR(e.encoding,t)};const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:s,ticksOrient:o,markDef:a,outerSpec:l,tooltipEncoding:u}=QQ(e,yL,t);delete s.size;const c=CL(a,r,i,s,t.errorbar),d=a.thickness,h=a.size,p={type:"tick",orient:o,aria:!1,...d!==void 0?{thickness:d}:{},...h!==void 0?{size:h}:{}},g=[...c({partName:"ticks",mark:p,positionPrefix:"lower",extraEncoding:u}),...c({partName:"ticks",mark:p,positionPrefix:"upper",extraEncoding:u}),...c({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar",...d!==void 0?{size:d}:{}},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u})];return{...l,transform:n,...g.length>1?{layer:g}:{...g[0]}}}function u$e(e,t){const{encoding:n}=e;if(c$e(n))return{orient:qQ(e,t),inputType:"raw"};const i=d$e(n),r=h$e(n),s=n.x,o=n.y;if(i){if(r)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const a=n.x2,l=n.y2;if(Xe(a)&&Xe(l))throw new Error(`${t} cannot have both x2 and y2`);if(Xe(a)){if(Hu(s))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(Xe(l)){if(Hu(o))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const a=n.xError,l=n.xError2,u=n.yError,c=n.yError2;if(Xe(l)&&!Xe(a))throw new Error(`${t} cannot have xError2 without xError`);if(Xe(c)&&!Xe(u))throw new Error(`${t} cannot have yError2 without yError`);if(Xe(a)&&Xe(u))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(Xe(a)){if(Hu(s))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(Xe(u)){if(Hu(o))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function c$e(e){return(Xe(e.x)||Xe(e.y))&&!Xe(e.x2)&&!Xe(e.y2)&&!Xe(e.xError)&&!Xe(e.xError2)&&!Xe(e.yError)&&!Xe(e.yError2)}function d$e(e){return Xe(e.x2)||Xe(e.y2)}function h$e(e){return Xe(e.xError)||Xe(e.xError2)||Xe(e.yError)||Xe(e.yError2)}function QQ(e,t,n){const{mark:i,encoding:r,params:s,projection:o,...a}=e,l=Ta(i)?i:{type:i};s&&he(HX(t));const{orient:u,inputType:c}=u$e(e,t),{continuousAxisChannelDef:d,continuousAxisChannelDef2:h,continuousAxisChannelDefError:p,continuousAxisChannelDefError2:g,continuousAxis:m}=UQ(e,u,t),{errorBarSpecificAggregate:C,postAggregateCalculates:y,tooltipSummary:b,tooltipTitleWithFieldName:S}=f$e(l,d,h,p,g,c,t,n),{[m]:x,[m==="x"?"x2":"y2"]:E,[m==="x"?"xError":"yError"]:A,[m==="x"?"xError2":"yError2"]:F,...P}=r,{bins:D,timeUnits:M,aggregate:O,groupby:B,encoding:H}=HQ(P,n),N=[...O,...C],L=c!=="raw"?[]:B,G=wM(b,d,H,S);return{transform:[...a.transform??[],...D,...M,...N.length===0?[]:[{aggregate:N,groupby:L}],...y],groupby:L,continuousAxisChannelDef:d,continuousAxis:m,encodingWithoutContinuousAxis:H,ticksOrient:u==="vertical"?"horizontal":"vertical",markDef:l,outerSpec:a,tooltipEncoding:G}}function f$e(e,t,n,i,r,s,o,a){let l=[],u=[];const c=t.field;let d,h=!1;if(s==="raw"){const p=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":a.errorbar.center,g=e.extent?e.extent:p==="mean"?"stderr":"iqr";if(p==="median"!=(g==="iqr")&&he(xLe(p,g,o)),g==="stderr"||g==="stdev")l=[{op:g,field:c,as:`extent_${c}`},{op:p,field:c,as:`center_${c}`}],u=[{calculate:`${$t(`center_${c}`)} + ${$t(`extent_${c}`)}`,as:`upper_${c}`},{calculate:`${$t(`center_${c}`)} - ${$t(`extent_${c}`)}`,as:`lower_${c}`}],d=[{fieldPrefix:"center_",titlePrefix:yC(p)},{fieldPrefix:"upper_",titlePrefix:T5(p,g,"+")},{fieldPrefix:"lower_",titlePrefix:T5(p,g,"-")}],h=!0;else{let m,C,y;g==="ci"?(m="mean",C="ci0",y="ci1"):(m="median",C="q1",y="q3"),l=[{op:C,field:c,as:`lower_${c}`},{op:y,field:c,as:`upper_${c}`},{op:m,field:c,as:`center_${c}`}],d=[{fieldPrefix:"upper_",titlePrefix:Vf({field:c,aggregate:y,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:Vf({field:c,aggregate:C,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:Vf({field:c,aggregate:m,type:"quantitative"},a,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&he(SLe(e.center,e.extent)),s==="aggregated-upper-lower"?(d=[],u=[{calculate:$t(n.field),as:`upper_${c}`},{calculate:$t(c),as:`lower_${c}`}]):s==="aggregated-error"&&(d=[{fieldPrefix:"",titlePrefix:c}],u=[{calculate:`${$t(c)} + ${$t(i.field)}`,as:`upper_${c}`}],r?u.push({calculate:`${$t(c)} + ${$t(r.field)}`,as:`lower_${c}`}):u.push({calculate:`${$t(c)} - ${$t(i.field)}`,as:`lower_${c}`}));for(const p of u)d.push({fieldPrefix:p.as.substring(0,6),titlePrefix:nh(nh(p.calculate,"datum['",""),"']","")})}return{postAggregateCalculates:u,errorBarSpecificAggregate:l,tooltipSummary:d,tooltipTitleWithFieldName:h}}function T5(e,t,n){return`${yC(e)} ${n} ${t}`}const wL="errorband",p$e=["band","borders"],g$e=new yR(wL,ZQ);function ZQ(e,{config:t}){e={...e,encoding:wR(e.encoding,t)};const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:s,markDef:o,outerSpec:a,tooltipEncoding:l}=QQ(e,wL,t),u=o,c=CL(u,r,i,s,t.errorband),d=e.encoding.x!==void 0&&e.encoding.y!==void 0;let h={type:d?"area":"rect"},p={type:d?"line":"rule"};const g={...u.interpolate?{interpolate:u.interpolate}:{},...u.tension&&u.interpolate?{tension:u.tension}:{}};return d?(h={...h,...g,ariaRoleDescription:"errorband"},p={...p,...g,aria:!1}):u.interpolate?he(x5("interpolate")):u.tension&&he(x5("tension")),{...a,transform:n,layer:[...c({partName:"band",mark:h,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l}),...c({partName:"borders",mark:p,positionPrefix:"lower",extraEncoding:l}),...c({partName:"borders",mark:p,positionPrefix:"upper",extraEncoding:l})]}}const JQ={};function bL(e,t,n){const i=new yR(e,t);JQ[e]={normalizer:i,parts:n}}function m$e(){return le(JQ)}bL(KS,KQ,r$e);bL(yL,XQ,a$e);bL(wL,ZQ,p$e);const v$e=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],eZ={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},tZ={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},C$e=le(eZ),y$e=le(tZ),w$e={header:1,headerRow:1,headerColumn:1,headerFacet:1},nZ=le(w$e),iZ=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],b$e={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},S$e={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},To="_vgsid_",x$e={point:{on:"click",fields:[To],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[pointerdown, window:pointerup] > window:pointermove!",encodings:["x","y"],translate:"[pointerdown, window:pointerup] > window:pointermove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function SL(e){return e==="legend"||!!e?.legend}function eD(e){return SL(e)&&be(e)}function xL(e){return!!e?.select}function rZ(e){const t=[];for(const n of e||[]){if(xL(n))continue;const{expr:i,bind:r,...s}=n;if(r&&i){const o={...s,bind:r,init:i};t.push(o)}else{const o={...s,...i?{update:i}:{},...r?{bind:r}:{}};t.push(o)}}return t}function R$e(e){return bR(e)||EL(e)||RL(e)}function RL(e){return ue(e,"concat")}function bR(e){return ue(e,"vconcat")}function EL(e){return ue(e,"hconcat")}function sZ({step:e,offsetIsDiscrete:t}){return t?e.for??"offset":"position"}function Ia(e){return ue(e,"step")}function I5(e){return ue(e,"view")||ue(e,"width")||ue(e,"height")}const _5=20,E$e={align:1,bounds:1,center:1,columns:1,spacing:1},F$e=le(E$e);function A$e(e,t,n){const i=n[t],r={},{spacing:s,columns:o}=i;s!==void 0&&(r.spacing=s),o!==void 0&&(gR(e)&&!FC(e.facet)||RL(e))&&(r.columns=o),bR(e)&&(r.columns=1);for(const a of F$e)if(e[a]!==void 0)if(a==="spacing"){const l=e[a];r[a]=kt(l)?l:{row:l.row??s,column:l.column??s}}else r[a]=e[a];return r}function bM(e,t){return e[t]??e[t==="width"?"continuousWidth":"continuousHeight"]}function SM(e,t){const n=YS(e,t);return Ia(n)?n.step:oZ}function YS(e,t){const n=e[t]??e[t==="width"?"discreteWidth":"discreteHeight"];return Mn(n,{step:e.step})}const oZ=20,D$e={continuousWidth:200,continuousHeight:200,step:oZ},k$e={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:D$e,mark:wNe,arc:{},area:{},bar:RNe,circle:{},geoshape:{},image:{},line:{},point:{},rect:oL,rule:{color:"black"},square:{},text:{color:"black"},tick:ENe,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:tNe,projection:{},legend:b$e,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:x$e,style:{},title:{},facet:{spacing:_5},concat:{spacing:_5},normalizedNumberFormat:".0%"},ll=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],O5={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},L5={blue:ll[0],orange:ll[1],red:ll[2],teal:ll[3],green:ll[4],yellow:ll[5],purple:ll[6],pink:ll[7],brown:ll[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function P$e(e={}){return{signals:[{name:"color",value:be(e)?{...L5,...e}:L5}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function M$e(e){return{signals:[{name:"fontSize",value:be(e)?{...O5,...e}:O5}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function T$e(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function aZ(e){const t=le(e||{}),n={};for(const i of t){const r=e[i];n[i]=PC(r)?OX(r):Qr(r)}return n}function I$e(e){const t=le(e),n={};for(const i of t)n[i]=aZ(e[i]);return n}const _$e=[...mQ,...$Q,...nZ,"background","padding","legend","lineBreak","scale","style","title","view"];function lZ(e={}){const{color:t,font:n,fontSize:i,selection:r,...s}=e,o=Yp({},Ke(k$e),n?T$e(n):{},t?P$e(t):{},i?M$e(i):{},s||{});r&&Xp(o,"selection",r,!0);const a=Pr(o,_$e);for(const l of["background","lineBreak","padding"])o[l]&&(a[l]=Qr(o[l]));for(const l of mQ)o[l]&&(a[l]=pi(o[l]));for(const l of $Q)o[l]&&(a[l]=aZ(o[l]));for(const l of nZ)o[l]&&(a[l]=pi(o[l]));if(o.legend&&(a.legend=pi(o.legend)),o.scale){const{invalid:l,...u}=o.scale,c=pi(l,{level:1});a.scale={...pi(u),...le(c).length>0?{invalid:c}:{}}}return o.style&&(a.style=I$e(o.style)),o.title&&(a.title=pi(o.title)),o.view&&(a.view=pi(o.view)),a}const O$e=new Set(["view",...pNe]),L$e=["color","fontSize","background","padding","facet","concat","numberFormat","numberFormatType","normalizedNumberFormat","normalizedNumberFormatType","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],N$e={view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"],...yNe};function $$e(e){e=Ke(e);for(const t of L$e)delete e[t];if(e.axis)for(const t in e.axis)PC(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of v$e)delete e.legend[t];if(e.mark){for(const t of E5)delete e.mark[t];e.mark.tooltip&&be(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(rZ(e.params)),delete e.params);for(const t of O$e){for(const i of E5)delete e[t][i];const n=N$e[t];if(n)for(const i of n)delete e[t][i];G$e(e,t)}for(const t of m$e())delete e[t];B$e(e);for(const t in e)be(e[t])&&Ht(e[t])&&delete e[t];return Ht(e)?void 0:e}function B$e(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:i}=_X(e.title);Ht(t)||(e.style["group-title"]={...e.style["group-title"],...t}),Ht(n)||(e.style["group-subtitle"]={...e.style["group-subtitle"],...n}),Ht(i)?delete e.title:e.title=i}function G$e(e,t,n,i){const r=e[t];t==="view"&&(n="cell");const s={...r,...e.style[n??t]};Ht(s)||(e.style[n??t]=s),delete e[t]}function SR(e){return ue(e,"layer")}function z$e(e){return ue(e,"repeat")}function H$e(e){return!ne(e.repeat)&&ue(e.repeat,"layer")}class FL{map(t,n){return gR(t)?this.mapFacet(t,n):z$e(t)?this.mapRepeat(t,n):EL(t)?this.mapHConcat(t,n):bR(t)?this.mapVConcat(t,n):RL(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(SR(t))return this.mapLayer(t,n);if(su(t))return this.mapUnit(t,n);throw new Error(zO(t))}mapLayer(t,n){return{...t,layer:t.layer.map(i=>this.mapLayerOrUnit(i,n))}}mapHConcat(t,n){return{...t,hconcat:t.hconcat.map(i=>this.map(i,n))}}mapVConcat(t,n){return{...t,vconcat:t.vconcat.map(i=>this.map(i,n))}}mapConcat(t,n){const{concat:i,...r}=t;return{...r,concat:i.map(s=>this.map(s,n))}}mapFacet(t,n){return{...t,spec:this.map(t.spec,n)}}mapRepeat(t,n){return{...t,spec:this.map(t.spec,n)}}}const V$e={zero:1,center:1,normalize:1};function W$e(e){return Ae(V$e,e)}const U$e=new Set([fQ,dR,cR,HS,fR,rL,sL,hR,pQ,iL]),q$e=new Set([dR,cR,fQ]);function gf(e){return fe(e)&&Dp(e)==="quantitative"&&!e.bin}function N5(e,t,{orient:n,type:i}){const r=t==="x"?"y":"radius",s=t==="x"&&["bar","area"].includes(i),o=e[t],a=e[r];if(fe(o)&&fe(a))if(gf(o)&&gf(a)){if(o.stack)return t;if(a.stack)return r;const l=fe(o)&&!!o.aggregate,u=fe(a)&&!!a.aggregate;if(l!==u)return l?t:r;if(s){if(n==="vertical")return r;if(n==="horizontal")return t}}else{if(gf(o))return t;if(gf(a))return r}else{if(gf(o))return s&&n==="vertical"?void 0:t;if(gf(a))return s&&n==="horizontal"?void 0:r}}function j$e(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function uZ(e,t){const n=Ta(e)?e:{type:e},i=n.type;if(!U$e.has(i))return null;const r=N5(t,"x",n)||N5(t,"theta",n);if(!r)return null;const s=t[r],o=fe(s)?ye(s,{}):void 0,a=j$e(r),l=[],u=new Set;if(t[a]){const m=t[a],C=fe(m)?ye(m,{}):void 0;C&&C!==o&&(l.push(a),u.add(C))}const c=a==="x"?"xOffset":"yOffset",d=t[c],h=fe(d)?ye(d,{}):void 0;h&&h!==o&&(l.push(c),u.add(h));const p=eOe.reduce((m,C)=>{if(C!=="tooltip"&&Id(t,C)){const y=t[C];for(const b of xe(y)){const S=Mo(b);if(S.aggregate)continue;const x=ye(S,{});(!x||!u.has(x))&&m.push({channel:C,fieldDef:S})}}return m},[]);let g;return s.stack!==void 0?yc(s.stack)?g=s.stack?"zero":null:g=s.stack:q$e.has(i)&&(g="zero"),!g||!W$e(g)||zQ(t)&&p.length===0?null:(s?.scale?.type&&s?.scale?.type!==gi.LINEAR&&s?.stack&&he(yLe(s.scale.type)),Xe(t[Wa(r)])?(s.stack!==void 0&&he(CLe(r)),null):(fe(s)&&s.aggregate&&!fOe.has(s.aggregate)&&he(wLe(s.aggregate)),{groupbyChannels:l,groupbyFields:u,fieldChannel:r,impute:s.impute===null?!1:Ic(i),stackBy:p,offset:g}))}function cZ(e,t,n){const i=pi(e),r=zt("orient",i,n);if(i.orient=Q$e(i.type,t,r),r!==void 0&&r!==i.orient&&he(nLe(i.orient,r)),i.type==="bar"&&i.orient){const l=zt("cornerRadiusEnd",i,n);if(l!==void 0){const u=i.orient==="horizontal"&&t.x2||i.orient==="vertical"&&t.y2?["cornerRadius"]:SNe[i.orient];for(const c of u)i[c]=l;i.cornerRadiusEnd!==void 0&&delete i.cornerRadiusEnd}}const s=zt("opacity",i,n),o=zt("fillOpacity",i,n);return s===void 0&&o===void 0&&(i.opacity=Y$e(i.type,t)),zt("cursor",i,n)===void 0&&(i.cursor=K$e(i,t,n)),i}function K$e(e,t,n){return t.href||e.href||zt("href",e,n)?"pointer":e.cursor}function Y$e(e,t){if(ht([fR,iL,rL,sL],e)&&!zQ(t))return .7}function X$e(e,t,{graticule:n}){if(n)return!1;const i=Ma("filled",e,t),r=e.type;return Mn(i,r!==fR&&r!==hR&&r!==HS)}function Q$e(e,t,n){switch(e){case fR:case rL:case sL:case pQ:case hNe:case dNe:return}const{x:i,y:r,x2:s,y2:o}=t;switch(e){case dR:if(fe(i)&&(fi(i.bin)||fe(r)&&r.aggregate&&!i.aggregate))return"vertical";if(fe(r)&&(fi(r.bin)||fe(i)&&i.aggregate&&!r.aggregate))return"horizontal";if(o||s){if(n)return n;if(!s)return(fe(i)&&i.type===oh&&!Qt(i.bin)||WS(i))&&fe(r)&&fi(r.bin)?"horizontal":"vertical";if(!o)return(fe(r)&&r.type===oh&&!Qt(r.bin)||WS(r))&&fe(i)&&fi(i.bin)?"vertical":"horizontal"}case HS:if(s&&!(fe(i)&&fi(i.bin))&&o&&!(fe(r)&&fi(r.bin)))return;case cR:if(o)return fe(r)&&fi(r.bin)?"horizontal":"vertical";if(s)return fe(i)&&fi(i.bin)?"vertical":"horizontal";if(e===HS){if(i&&!r)return"vertical";if(r&&!i)return"horizontal"}case hR:case iL:{const a=k5(i),l=k5(r);if(n)return n;if(a&&!l)return e!=="tick"?"horizontal":"vertical";if(!a&&l)return e!=="tick"?"vertical":"horizontal";if(a&&l)return"vertical";{const u=dr(i)&&i.type===Fp,c=dr(r)&&r.type===Fp;if(u&&!c)return"vertical";if(!u&&c)return"horizontal"}return}}return"vertical"}function Z$e(e){const{point:t,line:n,...i}=e;return le(i).length>1?i:i.type}function J$e(e){for(const t of["line","area","rule","trail"])e[t]&&(e={...e,[t]:Pr(e[t],["point","line"])});return e}function tD(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?be(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?be(t.point)?t.point:{}:void 0}function $5(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class eBe{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(su(t)){const{mark:i,encoding:r}=t,s=Ta(i)?i:{type:i};switch(s.type){case"line":case"rule":case"trail":return!!tD(s,n[s.type],r);case"area":return!!tD(s,n[s.type],r)||!!$5(s,n[s.type])}}return!1}run(t,n,i){const{config:r}=n,{params:s,projection:o,mark:a,name:l,encoding:u,...c}=t,d=wR(u,r),h=Ta(a)?a:{type:a},p=tD(h,r[h.type],d),g=h.type==="area"&&$5(h,r[h.type]),m=[{name:l,...s?{params:s}:{},mark:Z$e({...h.type==="area"&&h.opacity===void 0&&h.fillOpacity===void 0?{opacity:.7}:{},...h}),encoding:Pr(d,["shape"])}],C=uZ(cZ(h,d,r),d);let y=d;if(C){const{fieldChannel:b,offset:S}=C;y={...d,[b]:{...d[b],...S?{stack:S}:{}}}}return y=Pr(y,["y2","x2"]),g&&m.push({...o?{projection:o}:{},mark:{type:"line",...Sp(h,["clip","interpolate","tension","tooltip"]),...g},encoding:y}),p&&m.push({...o?{projection:o}:{},mark:{type:"point",opacity:1,filled:!0,...Sp(h,["clip","tooltip"]),...p},encoding:y}),i({...c,layer:m},{...n,config:J$e(r)})}}function tBe(e,t){return t?FC(e)?hZ(e,t):dZ(e,t):e}function nD(e,t){return t?hZ(e,t):e}function xM(e,t,n){const i=t[e];if(NNe(i)){if(i.repeat in n)return{...t,[e]:n[i.repeat]};he(IOe(i.repeat));return}return t}function dZ(e,t){if(e=xM("field",e,t),e!==void 0){if(e===null)return null;if(hL(e)&&Pl(e.sort)){const n=xM("field",e.sort,t);e={...e,...n?{sort:n}:{}}}return e}}function B5(e,t){if(fe(e))return dZ(e,t);{const n=xM("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function G5(e,t){if(Xe(e)){const n=B5(e,t);if(n)return n;if(AC(e))return{condition:e.condition}}else{if(DC(e)){const n=B5(e.condition,t);if(n)return{...e,condition:n};{const{condition:i,...r}=e;return r}}return e}}function hZ(e,t){const n={};for(const i in e)if(ue(e,i)){const r=e[i];if(ne(r))n[i]=r.map(s=>G5(s,t)).filter(s=>s);else{const s=G5(r,t);s!==void 0&&(n[i]=s)}}return n}class nBe{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(su(t)){const{encoding:n,mark:i}=t;if(i==="line"||Ta(i)&&i.type==="line")for(const r of Q2e){const s=Ah(r),o=n[s];if(n[r]&&(fe(o)&&!fi(o.bin)||qa(o)))return!0}}return!1}run(t,n,i){const{encoding:r,mark:s}=t;return he(tLe(!!r.x2,!!r.y2)),i({...t,mark:be(s)?{...s,type:"rule"}:"rule"},n)}}class iBe extends FL{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[s$e,l$e,g$e,new eBe,new nBe]}map(t,n){if(su(t)){const i=Id(t.encoding,Dl),r=Id(t.encoding,kl),s=Id(t.encoding,Jx);if(i||r||s)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:i,parentProjection:r}=n,s=nD(t.encoding,n.repeater),o={...t,...t.name?{name:[n.repeaterPrefix,t.name].filter(l=>l).join("_")}:{},...s?{encoding:s}:{}};if(i||r)return this.mapUnitWithParentEncodingOrProjection(o,n);const a=this.mapLayerOrUnit.bind(this);for(const l of this.nonFacetUnitNormalizers)if(l.hasMatchingType(o,n.config))return l.run(o,n,a);return o}mapRepeat(t,n){return H$e(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:i,spec:r,...s}=t,{row:o,column:a,layer:l}=i,{repeater:u={},repeaterPrefix:c=""}=n;return o||a?this.mapRepeat({...t,repeat:{...o?{row:o}:{},...a?{column:a}:{}},spec:{repeat:{layer:l},spec:r}},n):{...s,layer:l.map(d=>{const h={...u,layer:d},p=`${(r.name?`${r.name}_`:"")+c}child__layer_${an(d)}`,g=this.mapLayerOrUnit(r,{...n,repeater:h,repeaterPrefix:p});return g.name=p,g})}}mapNonLayerRepeat(t,n){const{repeat:i,spec:r,data:s,...o}=t;!ne(i)&&t.columns&&(t=Pr(t,["columns"]),he(y5("repeat")));const a=[],{repeater:l={},repeaterPrefix:u=""}=n,c=!ne(i)&&i.row||[l?l.row:null],d=!ne(i)&&i.column||[l?l.column:null],h=ne(i)&&i||[l?l.repeat:null];for(const g of h)for(const m of c)for(const C of d){const y={repeat:g,row:m,column:C,layer:l.layer},b=(r.name?`${r.name}_`:"")+u+"child__"+(ne(i)?`${an(g)}`:(i.row?`row_${an(m)}`:"")+(i.column?`column_${an(C)}`:"")),S=this.map(r,{...n,repeater:y,repeaterPrefix:b});S.name=b,a.push(Pr(S,["data"]))}const p=ne(i)?t.columns:i.column?i.column.length:1;return{data:r.data??s,align:"all",...o,columns:p,concat:a}}mapFacet(t,n){const{facet:i}=t;return FC(i)&&t.columns&&(t=Pr(t,["columns"]),he(y5("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:i,projection:r}=t,{parentEncoding:s,parentProjection:o,config:a}=n,l=H5({parentProjection:o,projection:r}),u=z5({parentEncoding:s,encoding:nD(i,n.repeater)});return this.mapUnit({...t,...l?{projection:l}:{},...u?{encoding:u}:{}},{config:a})}mapFacetedUnit(t,n){const{row:i,column:r,facet:s,...o}=t.encoding,{mark:a,width:l,projection:u,height:c,view:d,params:h,encoding:p,...g}=t,{facetMapping:m,layout:C}=this.getFacetMappingAndLayout({row:i,column:r,facet:s},n),y=nD(o,n.repeater);return this.mapFacet({...g,...C,facet:m,spec:{...l?{width:l}:{},...c?{height:c}:{},...d?{view:d}:{},...u?{projection:u}:{},mark:a,encoding:y,...h?{params:h}:{}}},n)}getFacetMappingAndLayout(t,n){const{row:i,column:r,facet:s}=t;if(i||r){s&&he(JOe([...i?[Dl]:[],...r?[kl]:[]]));const o={},a={};for(const l of[Dl,kl]){const u=t[l];if(u){const{align:c,center:d,spacing:h,columns:p,...g}=u;o[l]=g;for(const m of["align","center","spacing"])u[m]!==void 0&&(a[m]??(a[m]={}),a[m][l]=u[m])}}return{facetMapping:o,layout:a}}else{const{align:o,center:a,spacing:l,columns:u,...c}=s;return{facetMapping:tBe(c,n.repeater),layout:{...o?{align:o}:{},...a?{center:a}:{},...l?{spacing:l}:{},...u?{columns:u}:{}}}}}mapLayer(t,{parentEncoding:n,parentProjection:i,...r}){const{encoding:s,projection:o,...a}=t,l={...r,parentEncoding:z5({parentEncoding:n,encoding:s,layer:!0}),parentProjection:H5({parentProjection:i,projection:o})};return super.mapLayer({...a,...t.name?{name:[l.repeaterPrefix,t.name].filter(u=>u).join("_")}:{}},l)}}function z5({parentEncoding:e,encoding:t={},layer:n}){let i={};if(e){const r=new Set([...le(e),...le(t)]);for(const s of r){const o=t[s],a=e[s];if(Xe(o)){const l={...a,...o};i[s]=l}else DC(o)?i[s]={...o,condition:{...a,...o.condition}}:o||o===null?i[s]=o:(n||Po(a)||Ie(a)||Xe(a)||ne(a))&&(i[s]=a)}}else i=t;return!i||Ht(i)?void 0:i}function H5(e){const{parentProjection:t,projection:n}=e;return t&&n&&he(HOe({parentProjection:t,projection:n})),n??t}function AL(e){return ue(e,"filter")}function rBe(e){return ue(e,"stop")}function fZ(e){return ue(e,"lookup")}function sBe(e){return ue(e,"data")}function oBe(e){return ue(e,"param")}function aBe(e){return ue(e,"pivot")}function lBe(e){return ue(e,"density")}function uBe(e){return ue(e,"quantile")}function cBe(e){return ue(e,"regression")}function dBe(e){return ue(e,"loess")}function hBe(e){return ue(e,"sample")}function fBe(e){return ue(e,"window")}function pBe(e){return ue(e,"joinaggregate")}function gBe(e){return ue(e,"flatten")}function mBe(e){return ue(e,"calculate")}function pZ(e){return ue(e,"bin")}function vBe(e){return ue(e,"impute")}function CBe(e){return ue(e,"timeUnit")}function yBe(e){return ue(e,"aggregate")}function wBe(e){return ue(e,"stack")}function bBe(e){return ue(e,"fold")}function SBe(e){return ue(e,"extent")&&!ue(e,"density")&&!ue(e,"regression")}function xBe(e){return e.map(t=>AL(t)?{filter:zf(t.filter,KLe)}:t)}class RBe extends FL{map(t,n){return n.emptySelections??(n.emptySelections={}),n.selectionPredicates??(n.selectionPredicates={}),t=V5(t,n),super.map(t,n)}mapLayerOrUnit(t,n){if(t=V5(t,n),t.encoding){const i={};for(const[r,s]of lc(t.encoding))i[r]=gZ(s,n);t={...t,encoding:i}}return super.mapLayerOrUnit(t,n)}mapUnit(t,n){const{selection:i,...r}=t;return i?{...r,params:lc(i).map(([s,o])=>{const{init:a,bind:l,empty:u,...c}=o;c.type==="single"?(c.type="point",c.toggle=!1):c.type==="multi"&&(c.type="point"),n.emptySelections[s]=u!=="none";for(const d of bi(n.selectionPredicates[s]??{}))d.empty=u!=="none";return{name:s,value:a,select:c,bind:l}})}:t}}function V5(e,t){const{transform:n,...i}=e;if(n){const r=n.map(s=>{if(AL(s))return{filter:RM(s,t)};if(pZ(s)&&Dh(s.bin))return{...s,bin:mZ(s.bin)};if(fZ(s)){const{selection:o,...a}=s.from;return o?{...s,from:{param:o,...a}}:s}return s});return{...i,transform:r}}return e}function gZ(e,t){const n=Ke(e);if(fe(n)&&Dh(n.bin)&&(n.bin=mZ(n.bin)),Th(n)&&n.scale?.domain?.selection){const{selection:i,...r}=n.scale.domain;n.scale.domain={...r,...i?{param:i}:{}}}if(AC(n))if(ne(n.condition))n.condition=n.condition.map(i=>{const{selection:r,param:s,test:o,...a}=i;return s?i:{...a,test:RM(i,t)}});else{const{selection:i,param:r,test:s,...o}=gZ(n.condition,t);n.condition=r?n.condition:{...o,test:RM(n.condition,t)}}return n}function mZ(e){const t=e.extent;if(t?.selection){const{selection:n,...i}=t;return{...e,extent:{...i,param:n}}}return e}function RM(e,t){const n=i=>zf(i,r=>{var s;const o=t.emptySelections[r]??!0,a={param:r,empty:o};return(s=t.selectionPredicates)[r]??(s[r]=[]),t.selectionPredicates[r].push(a),a});return e.selection?n(e.selection):zf(e.test||e.filter,i=>i.selection?n(i.selection):i)}class EM extends FL{map(t,n){const i=n.selections??[];if(t.params&&!su(t)){const r=[];for(const s of t.params)xL(s)?i.push(s):r.push(s);t.params=r}return n.selections=i,super.map(t,n)}mapUnit(t,n){const i=n.selections;if(!i||!i.length)return t;const r=(n.path??[]).concat(t.name),s=[];for(const o of i)if(!o.views||!o.views.length)s.push(o);else for(const a of o.views)(Re(a)&&(a===t.name||r.includes(a))||ne(a)&&a.map(l=>r.indexOf(l)).every((l,u,c)=>l!==-1&&(u===0||l>c[u-1])))&&s.push(o);return s.length&&(t.params=s),t}}for(const e of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=EM.prototype[e];EM.prototype[e]=function(n,i){return t.call(this,n,EBe(n,i))}}function EBe(e,t){return e.name?{...t,path:(t.path??[]).concat(e.name)}:t}function vZ(e,t){t===void 0&&(t=lZ(e.config));const n=kBe(e,t),{width:i,height:r}=e,s=PBe(n,{width:i,height:r,autosize:e.autosize},t);return{...n,...s?{autosize:s}:{}}}const FBe=new iBe,ABe=new RBe,DBe=new EM;function kBe(e,t={}){const n={config:t};return DBe.map(FBe.map(ABe.map(e,n),n),n)}function W5(e){return Re(e)?{type:e}:e??{}}function PBe(e,t,n){let{width:i,height:r}=t;const s=su(e)||SR(e),o={};s?i=="container"&&r=="container"?(o.type="fit",o.contains="padding"):i=="container"?(o.type="fit-x",o.contains="padding"):r=="container"&&(o.type="fit-y",o.contains="padding"):(i=="container"&&(he(g5("width")),i=void 0),r=="container"&&(he(g5("height")),r=void 0));const a={type:"pad",...o,...n?W5(n.autosize):{},...W5(e.autosize)};if(a.type==="fit"&&!s&&(he(SOe),a.type="pad"),i=="container"&&!(a.type=="fit"||a.type=="fit-x")&&he(m5("width")),r=="container"&&!(a.type=="fit"||a.type=="fit-y")&&he(m5("height")),!ts(a,{type:"pad"}))return a}function MBe(e){return["fit","fit-x","fit-y"].includes(e)}function TBe(e){return e?`fit-${rR(e)}`:"fit"}const IBe=["background","padding"];function U5(e,t){const n={};for(const i of IBe)e&&e[i]!==void 0&&(n[i]=Qr(e[i]));return t&&(n.params=e.params),n}class ou{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new ou(Ke(this.explicit),Ke(this.implicit))}combine(){return{...this.explicit,...this.implicit}}get(t){return Mn(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,{value:n,explicit:i}){n!==void 0&&this.set(t,n,i)}set(t,n,i){return delete this[i?"implicit":"explicit"][t],this[i?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,{explicit:n,implicit:i}){n[t]!==void 0?this.set(t,n[t],!0):i[t]!==void 0&&this.set(t,i[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of le(t.combine())){const i=t.getWithExplicit(n);this.setWithExplicit(n,i)}}}function la(e){return{explicit:!0,value:e}}function Kr(e){return{explicit:!1,value:e}}function CZ(e){return(t,n,i,r)=>{const s=e(t.value,n.value);return s>0?t:s<0?n:xR(t,n,i,r)}}function xR(e,t,n,i){return e.explicit&&t.explicit&&he(dLe(n,i,e.value,t.value)),e}function dc(e,t,n,i,r=xR){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:ts(e.value,t.value)?e:r(e,t,n,i)}class _Be extends ou{constructor(t={},n={},i=!1){super(t,n),this.explicit=t,this.implicit=n,this.parseNothing=i}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function Mp(e){return ue(e,"url")}function p0(e){return ue(e,"values")}function yZ(e){return ue(e,"name")&&!Mp(e)&&!p0(e)&&!Yu(e)}function Yu(e){return e&&(wZ(e)||bZ(e)||DL(e))}function wZ(e){return ue(e,"sequence")}function bZ(e){return ue(e,"sphere")}function DL(e){return ue(e,"graticule")}var fn;(function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup",e[e.PreFilterInvalid=5]="PreFilterInvalid",e[e.PostFilterInvalid=6]="PostFilterInvalid"})(fn||(fn={}));function SZ({invalid:e,isPath:t}){switch(vQ(e,{isPath:t})){case"filter":return{marks:"exclude-invalid-values",scales:"exclude-invalid-values"};case"break-paths-show-domains":return{marks:t?"include-invalid-values":"exclude-invalid-values",scales:"include-invalid-values"};case"break-paths-filter-domains":return{marks:t?"include-invalid-values":"exclude-invalid-values",scales:"exclude-invalid-values"};case"show":return{marks:"include-invalid-values",scales:"include-invalid-values"}}}function OBe(e){const{marks:t,scales:n}=SZ(e);return t===n?fn.Main:n==="include-invalid-values"?fn.PreFilterInvalid:fn.PostFilterInvalid}class Gt{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.includes(t)){he(BOe);return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const r of this._children)r.parent=t;this._children=[],t.removeChild(this);const i=t.parent.removeChild(t);this._parent=n,n.addChild(this,i),t.parent=this}}class Mr extends Gt{clone(){const t=new this.constructor;return t.debugName=`clone_${this.debugName}`,t._source=this._source,t._name=`clone_${this._name}`,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}constructor(t,n,i,r){super(t,n),this.type=i,this.refCounts=r,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${CX()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}function iD(e){return e.as!==void 0}function q5(e){return`${e}_end`}class ba extends Gt{clone(){return new ba(null,Ke(this.timeUnits))}constructor(t,n){super(t),this.timeUnits=n}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,s,o)=>{const{field:a,timeUnit:l}=s;if(l){let u;if(Mh(l)){if(hn(n)){const{mark:c,markDef:d,config:h}=n,p=cc({fieldDef:s,markDef:d,config:h});(f0(c)||p)&&(u={timeUnit:si(l),field:a})}}else u={as:ye(s,{forAs:!0}),field:a,timeUnit:l};if(hn(n)){const{mark:c,markDef:d,config:h}=n,p=cc({fieldDef:s,markDef:d,config:h});f0(c)&&Tn(o)&&p!==.5&&(u.rectBandPosition=p)}u&&(r[gt(u)]=u)}return r},{});return Ht(i)?null:new ba(t,i)}static makeFromTransform(t,n){const{timeUnit:i,...r}={...n},s=si(i),o={...r,timeUnit:s};return new ba(t,{[gt(o)]:o})}merge(t){this.timeUnits={...this.timeUnits};for(const n in t.timeUnits)this.timeUnits[n]||(this.timeUnits[n]=t.timeUnits[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}removeFormulas(t){const n={};for(const[i,r]of lc(this.timeUnits)){const s=iD(r)?r.as:`${r.field}_end`;t.has(s)||(n[i]=r)}this.timeUnits=n}producedFields(){return new Set(bi(this.timeUnits).map(t=>iD(t)?t.as:q5(t.field)))}dependentFields(){return new Set(bi(this.timeUnits).map(t=>t.field))}hash(){return`TimeUnit ${gt(this.timeUnits)}`}assemble(){const t=[];for(const n of bi(this.timeUnits)){const{rectBandPosition:i}=n,r=si(n.timeUnit);if(iD(n)){const{field:s,as:o}=n,{unit:a,utc:l,...u}=r,c=[o,`${o}_end`];t.push({field:Us(s),type:"timeunit",...a?{units:lR(a)}:{},...l?{timezone:"utc"}:{},...u,as:c}),t.push(...j5(c,i,r))}else if(n){const{field:s}=n,o=s.replaceAll("\\.","."),a=xZ({timeUnit:r,field:o}),l=q5(o);t.push({type:"formula",expr:a,as:l}),t.push(...j5([o,l],i,r))}}return t}}const RR="offsetted_rect_start",ER="offsetted_rect_end";function xZ({timeUnit:e,field:t,reverse:n}){const{unit:i,utc:r}=e,s=JX(i),{part:o,step:a}=iQ(s,e.step);return`${r?"utcOffset":"timeOffset"}('${o}', ${$t(t)}, ${n?-a:a})`}function j5([e,t],n,i){if(n!==void 0&&n!==.5){const r=$t(e),s=$t(t);return[{type:"formula",expr:K5([xZ({timeUnit:i,field:e,reverse:!0}),r],n+.5),as:`${e}_${RR}`},{type:"formula",expr:K5([r,s],n+.5),as:`${e}_${ER}`}]}return[]}function K5([e,t],n){return`${1-n} * ${e} + ${n} * ${t}`}const MC="_tuple_fields";class LBe{constructor(...t){this.items=t,this.hasChannel={},this.hasField={},this.hasSelectionId=!1}}const NBe={defined:()=>!0,parse:(e,t,n)=>{const i=t.name,r=t.project??(t.project=new LBe),s={},o={},a=new Set,l=(g,m)=>{const C=m==="visual"?g.channel:g.field;let y=an(`${i}_${C}`);for(let b=1;a.has(y);b++)y=an(`${i}_${C}_${b}`);return a.add(y),{[m]:y}},u=t.type,c=e.config.selection[u],d=n.value!==void 0?xe(n.value):null;let{fields:h,encodings:p}=be(n.select)?n.select:{};if(!h&&!p&&d){for(const g of d)if(be(g))for(const m of le(g))X2e(m)?(p||(p=[])).push(m):u==="interval"?(he(TOe),p=c.encodings):(h??(h=[])).push(m)}!h&&!p&&(p=c.encodings,"fields"in c&&(h=c.fields));for(const g of p??[]){const m=e.fieldDef(g);if(m){let C=m.field;if(m.aggregate){he(xOe(g,m.aggregate));continue}else if(!C){he(C5(g));continue}if(m.timeUnit&&!Mh(m.timeUnit)){C=e.vgField(g);const y={timeUnit:m.timeUnit,as:C,field:m.field};o[gt(y)]=y}if(!s[C]){const y=u==="interval"&&Ua(g)&&ko(e.getScaleComponent(g).get("type"))?"R":m.bin?"R-RE":"E",b={field:C,channel:g,type:y,index:r.items.length};b.signals={...l(b,"data"),...l(b,"visual")},r.items.push(s[C]=b),r.hasField[C]=s[C],r.hasSelectionId=r.hasSelectionId||C===To,RX(g)?(b.geoChannel=g,b.channel=xX(g),r.hasChannel[b.channel]=s[C]):r.hasChannel[g]=s[C]}}else he(C5(g))}for(const g of h??[]){if(r.hasField[g])continue;const m={type:"E",field:g,index:r.items.length};m.signals={...l(m,"data")},r.items.push(m),r.hasField[g]=m,r.hasSelectionId=r.hasSelectionId||g===To}d&&(t.init=d.map(g=>r.items.map(m=>be(g)?g[m.geoChannel||m.channel]!==void 0?g[m.geoChannel||m.channel]:g[m.field]:g))),Ht(o)||(r.timeUnit=new ba(null,o))},signals:(e,t,n)=>{const i=t.name+MC;return n.filter(s=>s.name===i).length>0||t.project.hasSelectionId?n:n.concat({name:i,value:t.project.items.map(AZ)})}},RZ="_curr",pb="anim_value",Sf="anim_clock",FM="eased_anim_clock",EZ="min_extent",FZ="max_range_extent",rD="last_tick_at",sD="is_playing",$Be=1/60*1e3,BBe=(e,t)=>[{name:FM,update:Sf},{name:`${e}_domain`,init:`domain('${t}')`},{name:EZ,init:`extent(${e}_domain)[0]`},{name:FZ,init:`extent(range('${t}'))[1]`},{name:pb,update:`invert('${t}', ${FM})`}],GBe={defined:e=>e.type==="point",topLevelSignals:(e,t,n)=>(Sa(t)&&(n=n.concat([{name:Sf,init:"0",on:[{events:{type:"timer",throttle:$Be},update:`${sD} ? (${Sf} + (now() - ${rD}) > ${FZ} ? 0 : ${Sf} + (now() - ${rD})) : ${Sf}`}]},{name:rD,init:"now()",on:[{events:[{signal:Sf},{signal:sD}],update:"now()"}]},{name:sD,init:"true"}])),n),signals:(e,t,n)=>{const i=t.name,r=i+MC,s=t.project,o="(item().isVoronoi ? datum.datum : datum)",a=bi(e.component.selection??{}).reduce((c,d)=>d.type==="interval"?c.concat(d.name+Wf):c,[]).map(c=>`indexof(item().mark.name, '${c}') < 0`).join(" && "),l=`datum && item().mark.marktype !== 'group' && indexof(item().mark.role, 'legend') < 0${a?` && ${a}`:""}`;let u=`unit: ${_d(e)}, `;if(t.project.hasSelectionId)u+=`${To}: ${o}[${ge(To)}]`;else if(Sa(t))u+=`fields: ${r}, values: [${pb} ? ${pb} : ${EZ}]`;else{const c=s.items.map(d=>e.fieldDef(d.channel)?.bin?`[${o}[${ge(e.vgField(d.channel,{}))}], ${o}[${ge(e.vgField(d.channel,{binSuffix:"end"}))}]]`:`${o}[${ge(d.field)}]`).join(", ");u+=`fields: ${r}, values: [${c}]`}if(Sa(t))return n.concat(BBe(t.name,e.scaleName(Ac)),[{name:i+Hl,on:[{events:[{signal:FM},{signal:pb}],update:`{${u}}`,force:!0}]}]);{const c=t.events;return n.concat([{name:i+Hl,on:c?[{events:c,update:`${l} ? {${u}} : null`,force:!0}]:[]}])}}};function AZ(e){const{signals:t,hasLegend:n,index:i,...r}=e;return r.field=Us(r.field),r}function uh(e,t=!0,n=zi){if(ne(e)){const i=e.map(r=>uh(r,t,n));return t?`[${i.join(", ")}]`:i}else if(Ph(e))return n(t?sh(e):LLe(e));return t?n(Vt(e)):e}function zBe(e,t){for(const n of bi(e.component.selection??{})){const i=n.name;let r=`${i}${Hl}, ${n.resolve==="global"?"true":`{unit: ${_d(e)}}`}`;for(const s of AR)s.defined(n)&&(s.signals&&(t=s.signals(e,n,t)),s.modifyExpr&&(r=s.modifyExpr(e,n,r)));t.push({name:i+pGe,on:[{events:{signal:n.name+Hl},update:`modify(${ge(n.name+ch)}, ${r})`}]})}return kL(t)}function HBe(e,t){if(e.component.selection&&le(e.component.selection).length){const n=ge(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:Ec("pointermove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return kL(t)}function VBe(e,t){let n=!1;for(const i of bi(e.component.selection??{})){const r=i.name,s=ge(r+ch);if(t.filter(a=>a.name===r).length===0){const a=i.resolve==="global"?"union":i.resolve,l=i.type==="point"?", true, true)":")";t.push({name:i.name,update:`${WZ}(${s}, ${ge(a)}${l}`})}n=!0;for(const a of AR)a.defined(i)&&a.topLevelSignals&&(t=a.topLevelSignals(e,i,t))}return n&&t.filter(r=>r.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"pointermove",update:"isTuple(group()) ? group() : unit"}]}),kL(t)}function WBe(e,t){const n=[],i=[],r=_d(e,{escape:!1});for(const s of bi(e.component.selection??{})){const o={name:s.name+ch};if(s.project.hasSelectionId&&(o.transform=[{type:"collect",sort:{field:To}}]),s.init){const l=s.project.items.map(AZ);o.values=s.project.hasSelectionId?s.init.map(u=>({unit:r,[To]:uh(u,!1)[0]})):s.init.map(u=>({unit:r,fields:l,values:uh(u,!1)}))}if([...n,...t].filter(l=>l.name===s.name+ch).length||n.push(o),Sa(s)&&t.length){const l=e.lookupDataSource(e.getDataName(fn.Main)),u=t.find(d=>d.name===l),c=u.transform.find(d=>d.type==="filter"&&d.expr.includes("vlSelectionTest"));if(c){u.transform=u.transform.filter(h=>h!==c);const d={name:u.name+RZ,source:u.name,transform:[c]};i.push(d)}}}return n.concat(t,i)}function DZ(e,t){for(const n of bi(e.component.selection??{}))for(const i of AR)i.defined(n)&&i.marks&&(t=i.marks(e,n,t));return t}function UBe(e,t){for(const n of e.children)hn(n)&&(t=DZ(n,t));return t}function qBe(e,t,n,i){const r=YZ(e,t.param,t);return{signal:ko(n.get("type"))&&ne(i)&&i[0]>i[1]?`isValid(${r}) && reverse(${r})`:r}}function kL(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}const Ml={defined:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const i of t.project.items){const r=i.channel;if(!Ua(r))continue;const s=e.getScaleComponent(r),o=s?s.get("type"):void 0;if(o=="sequential"&&he(AOe),!s||!ko(o)){he(FOe);continue}s.set("selectionExtent",{param:t.name,field:i.field},!0),n.push(i)}},topLevelSignals:(e,t,n)=>{const i=t.scales.filter(o=>n.filter(a=>a.name===o.signals.data).length===0);if(!e.parent||DM(e)||i.length===0)return n;const r=n.find(o=>o.name===t.name);let s=r.update;if(s.includes(WZ))r.update=`{${i.map(o=>`${ge(Us(o.field))}: ${o.signals.data}`).join(", ")}}`;else{for(const o of i){const a=`${ge(Us(o.field))}: ${o.signals.data}`;s.includes(a)||(s=`${s.substring(0,s.length-1)}, ${a}}`)}r.update=s}return n.concat(i.map(o=>({name:o.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!DM(e))for(const i of t.scales){const r=n.find(s=>s.name===i.signals.data);r.push="outer",delete r.value,delete r.update}return n}};function AM(e,t){return`domain(${ge(e.scaleName(t))})`}function DM(e){return e.parent&&yg(e.parent)&&(!e.parent.parent||DM(e.parent.parent))}const Wf="_brush",kZ="_scale_trigger",xm="geo_interval_init_tick",PZ="_init",jBe="_center",KBe={defined:e=>e.type==="interval",parse:(e,t,n)=>{var i;if(e.hasProjection){const r={...be(n.select)?n.select:{}};r.fields=[To],r.encodings||(r.encodings=n.value?le(n.value):[Wo,Vo]),n.select={type:"interval",...r}}if(t.translate&&!Ml.defined(t)){const r=`!event.item || event.item.mark.name !== ${ge(t.name+Wf)}`;for(const s of t.events){if(!s.between){he(`${s} is not an ordered event stream for interval selections.`);continue}const o=xe((i=s.between[0]).filter??(i.filter=[]));o.includes(r)||o.push(r)}}},signals:(e,t,n)=>{const i=t.name,r=i+Hl,s=bi(t.project.hasChannel).filter(a=>a.channel===ln||a.channel===li),o=t.init?t.init[0]:null;if(n.push(...s.reduce((a,l)=>a.concat(YBe(e,t,l,o&&o[l.index])),[])),e.hasProjection){const a=ge(e.projectionName()),l=e.projectionName()+jBe,{x:u,y:c}=t.project.hasChannel,d=u&&u.signals.visual,h=c&&c.signals.visual,p=u?o&&o[u.index]:`${l}[0]`,g=c?o&&o[c.index]:`${l}[1]`,m=E=>e.getSizeSignalRef(E).signal,C=`[[${d?d+"[0]":"0"}, ${h?h+"[0]":"0"}],[${d?d+"[1]":m("width")}, ${h?h+"[1]":m("height")}]]`;o&&(n.unshift({name:i+PZ,init:`[scale(${a}, [${u?p[0]:p}, ${c?g[0]:g}]), scale(${a}, [${u?p[1]:p}, ${c?g[1]:g}])]`}),(!u||!c)&&(n.find(A=>A.name===l)||n.unshift({name:l,update:`invert(${a}, [${m("width")}/2, ${m("height")}/2])`})));const y=`intersect(${C}, {markname: ${ge(e.getName("marks"))}}, unit.mark)`,b=`{unit: ${_d(e)}}`,S=`vlSelectionTuples(${y}, ${b})`,x=s.map(E=>E.signals.visual);return n.concat({name:r,on:[{events:[...x.length?[{signal:x.join(" || ")}]:[],...o?[{signal:xm}]:[]],update:S}]})}else{if(!Ml.defined(t)){const u=i+kZ,c=s.map(d=>{const h=d.channel,{data:p,visual:g}=d.signals,m=ge(e.scaleName(h)),C=e.getScaleComponent(h).get("type"),y=ko(C)?"+":"";return`(!isArray(${p}) || (${y}invert(${m}, ${g})[0] === ${y}${p}[0] && ${y}invert(${m}, ${g})[1] === ${y}${p}[1]))`});c.length&&n.push({name:u,value:{},on:[{events:s.map(d=>({scale:e.scaleName(d.channel)})),update:c.join(" && ")+` ? ${u} : {}`}]})}const a=s.map(u=>u.signals.data),l=`unit: ${_d(e)}, fields: ${i+MC}, values`;return n.concat({name:r,...o?{init:`{${l}: ${uh(o)}}`}:{},...a.length?{on:[{events:[{signal:a.join(" || ")}],update:`${a.join(" && ")} ? {${l}: [${a}]} : null`}]}:{}})}},topLevelSignals:(e,t,n)=>(hn(e)&&e.hasProjection&&t.init&&(n.filter(r=>r.name===xm).length||n.unshift({name:xm,value:null,on:[{events:"timer{1}",update:`${xm} === null ? {} : ${xm}`}]})),n),marks:(e,t,n)=>{const i=t.name,{x:r,y:s}=t.project.hasChannel,o=r?.signals.visual,a=s?.signals.visual,l=`data(${ge(t.name+ch)})`;if(Ml.defined(t)||!r&&!s)return n;const u={x:r!==void 0?{signal:`${o}[0]`}:{value:0},y:s!==void 0?{signal:`${a}[0]`}:{value:0},x2:r!==void 0?{signal:`${o}[1]`}:{field:{group:"width"}},y2:s!==void 0?{signal:`${a}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const C of le(u))u[C]=[{test:`${l}.length && ${l}[0].unit === ${_d(e)}`,...u[C]},{value:0}];const{fill:c,fillOpacity:d,cursor:h,...p}=t.mark,g=le(p).reduce((C,y)=>(C[y]=[{test:[r!==void 0&&`${o}[0] !== ${o}[1]`,s!==void 0&&`${a}[0] !== ${a}[1]`].filter(b=>b).join(" && "),value:p[y]},{value:null}],C),{}),m=h??(t.translate?"move":null);return[{name:`${i+Wf}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:c},fillOpacity:{value:d}},update:u}},...n,{name:i+Wf,type:"rect",clip:!0,encode:{enter:{...m?{cursor:{value:m}}:{},fill:{value:"transparent"}},update:{...u,...g}}}]}};function YBe(e,t,n,i){const r=!e.hasProjection,s=n.channel,o=n.signals.visual,a=ge(r?e.scaleName(s):e.projectionName()),l=h=>`scale(${a}, ${h})`,u=e.getSizeSignalRef(s===ln?"width":"height").signal,c=`${s}(unit)`,d=t.events.reduce((h,p)=>[...h,{events:p.between[0],update:`[${c}, ${c}]`},{events:p,update:`[${o}[0], clamp(${c}, 0, ${u})]`}],[]);if(r){const h=n.signals.data,p=Ml.defined(t),g=e.getScaleComponent(s),m=g?g.get("type"):void 0,C=i?{init:uh(i,!0,l)}:{value:[]};return d.push({events:{signal:t.name+kZ},update:ko(m)?`[${l(`${h}[0]`)}, ${l(`${h}[1]`)}]`:"[0, 0]"}),p?[{name:h,on:[]}]:[{name:o,...C,on:d},{name:h,...i?{init:uh(i)}:{},on:[{events:{signal:o},update:`${o}[0] === ${o}[1] ? null : invert(${a}, ${o})`}]}]}else{const h=s===ln?0:1,p=t.name+PZ,g=i?{init:`[${p}[0][${h}], ${p}[1][${h}]]`}:{value:[]};return[{name:o,...g,on:d}]}}function gg({model:e,channelDef:t,vgChannel:n,invalidValueRef:i,mainRefFn:r}){const s=AC(t)&&t.condition;let o=[];s&&(o=xe(s).map(u=>{const c=r(u);if(LNe(u)){const{param:d,empty:h}=u;return{test:KZ(e,{param:d,empty:h}),...c}}else return{test:ZS(e,u.test),...c}})),i!==void 0&&o.push(i);const a=r(t);return a!==void 0&&o.push(a),o.length>1||o.length===1&&o[0].test?{[n]:o}:o.length===1?{[n]:o[0]}:{}}function PL(e,t="text"){const n=e.encoding[t];return gg({model:e,channelDef:n,vgChannel:t,mainRefFn:i=>FR(i,e.config),invalidValueRef:void 0})}function FR(e,t,n="datum"){if(e){if(Po(e))return en(e.value);if(Xe(e)){const{format:i,formatType:r}=qS(e);return cL({fieldOrDatumDef:e,format:i,formatType:r,expr:n,config:t})}}}function MZ(e,t={}){const{encoding:n,markDef:i,config:r,stack:s}=e,o=n.tooltip;if(ne(o))return{tooltip:Y5({tooltip:o},s,r,t)};{const a=t.reactiveGeom?"datum.datum":"datum";return gg({model:e,channelDef:o,vgChannel:"tooltip",mainRefFn:u=>{const c=FR(u,r,a);if(c)return c;if(u===null)return;let d=zt("tooltip",i,r);if(d===!0&&(d={content:"encoding"}),Re(d))return{value:d};if(be(d))return Ie(d)?d:d.content==="encoding"?Y5(n,s,r,t):{signal:a}},invalidValueRef:void 0})}}function TZ(e,t,n,{reactiveGeom:i}={}){const r={...n,...n.tooltipFormat},s=new Set,o=i?"datum.datum":"datum",a=[];function l(c,d){const h=Ah(d),p=dr(c)?c:{...c,type:e[h].type},g=p.title||pL(p,r),m=xe(g).join(", ").replaceAll(/"/g,'\\"');let C;if(Tn(d)){const y=d==="x"?"x2":"y2",b=Mo(e[y]);if(fi(p.bin)&&b){const S=ye(p,{expr:o}),x=ye(b,{expr:o}),{format:E,formatType:A}=qS(p);C=EC(S,x,E,A,r),s.add(y)}}if((Tn(d)||d===Ys||d===Ho)&&t&&t.fieldChannel===d&&t.offset==="normalize"){const{format:y,formatType:b}=qS(p);C=cL({fieldOrDatumDef:p,format:y,formatType:b,expr:o,config:r,normalizeStack:!0}).signal}C??(C=FR(p,r,o).signal),a.push({channel:d,key:m,value:C})}mL(e,(c,d)=>{fe(c)?l(c,d):mR(c)&&l(c.condition,d)});const u={};for(const{channel:c,key:d,value:h}of a)!s.has(c)&&!u[d]&&(u[d]=h);return u}function Y5(e,t,n,{reactiveGeom:i}={}){const r=TZ(e,t,n,{reactiveGeom:i}),s=lc(r).map(([o,a])=>`"${o}": ${a}`);return s.length>0?{signal:`{${s.join(", ")}}`}:void 0}function XBe(e){const{markDef:t,config:n}=e,i=zt("aria",t,n);return i===!1?{}:{...i?{aria:i}:{},...QBe(e),...ZBe(e)}}function QBe(e){const{mark:t,markDef:n,config:i}=e;if(i.aria===!1)return{};const r=zt("ariaRoleDescription",n,i);return r!=null?{ariaRoleDescription:{value:r}}:Ae(yOe,t)?{}:{ariaRoleDescription:{value:t}}}function ZBe(e){const{encoding:t,markDef:n,config:i,stack:r}=e,s=t.description;if(s)return gg({model:e,channelDef:s,vgChannel:"description",mainRefFn:l=>FR(l,e.config),invalidValueRef:void 0});const o=zt("description",n,i);if(o!=null)return{description:en(o)};if(i.aria===!1)return{};const a=TZ(t,r,i);if(!Ht(a))return{description:{signal:lc(a).map(([l,u],c)=>`"${c>0?"; ":""}${l}: " + (${u})`).join(" + ")}}}function mi(e,t,n={}){const{markDef:i,encoding:r,config:s}=t,{vgChannel:o}=n;let{defaultRef:a,defaultValue:l}=n;const u=r[e];a===void 0&&(l??(l=zt(e,i,s,{vgChannel:o,ignoreVgConfig:!AC(u)})),l!==void 0&&(a=en(l)));const c={markDef:i,config:s,scaleName:t.scaleName(e),scale:t.getScaleComponent(e)},d=yQ({...c,scaleChannel:e,channelDef:u});return gg({model:t,channelDef:u,vgChannel:o??e,invalidValueRef:d,mainRefFn:p=>uL({...c,channel:e,channelDef:p,stack:null,defaultRef:a})})}function IZ(e,t={filled:void 0}){const{markDef:n,encoding:i,config:r}=e,{type:s}=n,o=t.filled??zt("filled",n,r),a=ht(["bar","point","circle","square","geoshape"],s)?"transparent":void 0,l=zt(o===!0?"color":void 0,n,r,{vgChannel:"fill"})??r.mark[o===!0&&"color"]??a,u=zt(o===!1?"color":void 0,n,r,{vgChannel:"stroke"})??r.mark[o===!1&&"color"],c=o?"fill":"stroke",d={...l?{fill:en(l)}:{},...u?{stroke:en(u)}:{}};return n.color&&(o?n.fill:n.stroke)&&he(WX("property",{fill:"fill"in n,stroke:"stroke"in n})),{...d,...mi("color",e,{vgChannel:c,defaultValue:o?l:u}),...mi("fill",e,{defaultValue:i.fill?l:void 0}),...mi("stroke",e,{defaultValue:i.stroke?u:void 0})}}function JBe(e){const{encoding:t,mark:n}=e,i=t.order;return!Ic(n)&&Po(i)?gg({model:e,channelDef:i,vgChannel:"zindex",mainRefFn:r=>en(r.value),invalidValueRef:void 0}):{}}function Tp({channel:e,markDef:t,encoding:n={},model:i,bandPosition:r}){const s=`${e}Offset`,o=t[s],a=n[s];if((s==="xOffset"||s==="yOffset")&&a)return{offsetType:"encoding",offset:uL({channel:s,channelDef:a,markDef:t,config:i?.config,scaleName:i.scaleName(s),scale:i.getScaleComponent(s),stack:null,defaultRef:en(o),bandPosition:r})};const l=t[s];return l?{offsetType:"visual",offset:l}:{}}function sr(e,t,{defaultPos:n,vgChannel:i}){const{encoding:r,markDef:s,config:o,stack:a}=t,l=r[e],u=r[Wa(e)],c=t.scaleName(e),d=t.getScaleComponent(e),{offset:h,offsetType:p}=Tp({channel:e,markDef:s,encoding:r,model:t,bandPosition:.5}),g=ML({model:t,defaultPos:n,channel:e,scaleName:c,scale:d}),m=!l&&Tn(e)&&(r.latitude||r.longitude)?{field:t.getName(e)}:eGe({channel:e,channelDef:l,channel2Def:u,markDef:s,config:o,scaleName:c,scale:d,stack:a,offset:h,defaultRef:g,bandPosition:p==="encoding"?0:void 0});return m?{[i||e]:m}:void 0}function eGe(e){const{channel:t,channelDef:n,scaleName:i,stack:r,offset:s,markDef:o}=e;if(Xe(n)&&r&&t===r.fieldChannel){if(fe(n)){let a=n.bandPosition;if(a===void 0&&o.type==="text"&&(t==="radius"||t==="theta")&&(a=.5),a!==void 0)return VS({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",bandPosition:a,offset:s})}return Td(n,i,{suffix:"end"},{offset:s})}return lL(e)}function ML({model:e,defaultPos:t,channel:n,scaleName:i,scale:r}){const{markDef:s,config:o}=e;return()=>{const a=Ah(n),l=uc(n),u=zt(n,s,o,{vgChannel:l});if(u!==void 0)return Ev(n,u);switch(t){case"zeroOrMin":return X5({scaleName:i,scale:r,mode:"zeroOrMin",mainChannel:a,config:o});case"zeroOrMax":return X5({scaleName:i,scale:r,mode:{zeroOrMax:{widthSignal:e.width.signal,heightSignal:e.height.signal}},mainChannel:a,config:o});case"mid":return{...e[Nr(n)],mult:.5}}}}function X5({mainChannel:e,config:t,...n}){const i=CQ(n),{mode:r}=n;if(i)return i;switch(e){case"radius":{if(r==="zeroOrMin")return{value:0};const{widthSignal:s,heightSignal:o}=r.zeroOrMax;return{signal:`min(${s},${o})/2`}}case"theta":return r==="zeroOrMin"?{value:0}:{signal:"2*PI"};case"x":return r==="zeroOrMin"?{value:0}:{field:{group:"width"}};case"y":return r==="zeroOrMin"?{field:{group:"height"}}:{value:0}}}const tGe={left:"x",center:"xc",right:"x2"},nGe={top:"y",middle:"yc",bottom:"y2"};function _Z(e,t,n,i="middle"){if(e==="radius"||e==="theta")return uc(e);const r=e==="x"?"align":"baseline",s=zt(r,t,n);let o;return Ie(s)?(he(eLe(r)),o=void 0):o=s,e==="x"?tGe[o||(i==="top"?"left":"center")]:nGe[o||i]}function XS(e,t,{defaultPos:n,defaultPos2:i,range:r}){return r?OZ(e,t,{defaultPos:n,defaultPos2:i}):sr(e,t,{defaultPos:n})}function OZ(e,t,{defaultPos:n,defaultPos2:i}){const{markDef:r,config:s}=t,o=Wa(e),a=Nr(e),l=iGe(t,i,o),u=l[a]?_Z(e,r,s):uc(e);return{...sr(e,t,{defaultPos:n,vgChannel:u}),...l}}function iGe(e,t,n){const{encoding:i,mark:r,markDef:s,stack:o,config:a}=e,l=Ah(n),u=Nr(n),c=uc(n),d=i[l],h=e.scaleName(l),p=e.getScaleComponent(l),{offset:g}=n in i||n in s?Tp({channel:n,markDef:s,encoding:i,model:e}):Tp({channel:l,markDef:s,encoding:i,model:e});if(!d&&(n==="x2"||n==="y2")&&(i.latitude||i.longitude)){const C=Nr(n),y=e.markDef[C];return y!=null?{[C]:{value:y}}:{[c]:{field:e.getName(n)}}}const m=rGe({channel:n,channelDef:d,channel2Def:i[n],markDef:s,config:a,scaleName:h,scale:p,stack:o,offset:g,defaultRef:void 0});return m!==void 0?{[c]:m}:Cw(n,s)||Cw(n,{[n]:gM(n,s,a.style),[u]:gM(u,s,a.style)})||Cw(n,a[r])||Cw(n,a.mark)||{[c]:ML({model:e,defaultPos:t,channel:n,scaleName:h,scale:p})()}}function rGe({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:s,scale:o,stack:a,offset:l,defaultRef:u}){return Xe(t)&&a&&e.charAt(0)===a.fieldChannel.charAt(0)?Td(t,s,{suffix:"start"},{offset:l}):lL({channel:e,channelDef:n,scaleName:s,scale:o,stack:a,markDef:i,config:r,offset:l,defaultRef:u})}function Cw(e,t){const n=Nr(e),i=uc(e);if(t[i]!==void 0)return{[i]:Ev(e,t[i])};if(t[e]!==void 0)return{[i]:Ev(e,t[e])};if(t[n]){const r=t[n];if(ah(r))he(KOe(n));else return{[n]:Ev(e,r)}}}function zl(e,t){const{config:n,encoding:i,markDef:r}=e,s=r.type,o=Wa(t),a=Nr(t),l=i[t],u=i[o],c=e.getScaleComponent(t),d=c?c.get("type"):void 0,h=r.orient,p=i[a]??i.size??zt("size",r,n,{vgChannel:a}),g=DX(t),m=s==="bar"&&(t==="x"?h==="vertical":h==="horizontal")||s==="tick"&&(t==="y"?h==="vertical":h==="horizontal");return fe(l)&&(Qt(l.bin)||fi(l.bin)||l.timeUnit&&!u)&&!(p&&!ah(p))&&!i[g]&&!oi(d)?aGe({fieldDef:l,fieldDef2:u,channel:t,model:e}):(Xe(l)&&oi(d)||m)&&!u?oGe(l,t,e):OZ(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function sGe(e,t,n,i,r,s,o){if(ah(r))if(n){const l=n.get("type");if(l==="band"){let u=`bandwidth('${t}')`;r.band!==1&&(u=`${r.band} * ${u}`);const c=Ma("minBandSize",{type:o},i);return{signal:c?`max(${yo(c)}, ${u})`:u}}else r.band!==1&&(he(rLe(l)),r=void 0)}else return{mult:r.band,field:{group:e}};else{if(Ie(r))return r;if(r)return{value:r}}if(n){const l=n.get("range");if(kh(l)&&kt(l.step))return{value:l.step-2}}if(!s){const{bandPaddingInner:l,barBandPaddingInner:u,rectBandPaddingInner:c,tickBandPaddingInner:d}=i.scale,h=Mn(l,o==="tick"?d:o==="bar"?u:c);if(Ie(h))return{signal:`(1 - (${h.signal})) * ${e}`};if(kt(h))return{signal:`${1-h} * ${e}`}}return{value:SM(i.view,e)-2}}function oGe(e,t,n){const{markDef:i,encoding:r,config:s,stack:o}=n,a=i.orient,l=n.scaleName(t),u=n.getScaleComponent(t),c=Nr(t),d=Wa(t),h=DX(t),p=n.scaleName(h),g=n.getScaleComponent(OO(t)),m=i.type==="tick"||a==="horizontal"&&t==="y"||a==="vertical"&&t==="x";let C;(r.size||i.size)&&(m?C=mi("size",n,{vgChannel:c,defaultRef:en(i.size)}):he(lLe(i.type)));const y=!!C,b=FQ({channel:t,fieldDef:e,markDef:i,config:s,scaleType:(u||g)?.get("type"),useVlSizeChannel:m});C=C||{[c]:sGe(c,p||l,g||u,s,b,!!e,i.type)};const S=(u||g)?.get("type")==="band"&&ah(b)&&!y?"top":"middle",x=_Z(t,i,s,S),E=x==="xc"||x==="yc",{offset:A,offsetType:F}=Tp({channel:t,markDef:i,encoding:r,model:n,bandPosition:E?.5:0}),P=lL({channel:t,channelDef:e,markDef:i,config:s,scaleName:l,scale:u,stack:o,offset:A,defaultRef:ML({model:n,defaultPos:"mid",channel:t,scaleName:l,scale:u}),bandPosition:E?F==="encoding"?0:.5:Ie(b)?{signal:`(1-${b})/2`}:ah(b)?(1-b.band)/2:0});if(c)return{[x]:P,...C};{const D=uc(d),M=C[c],O=A?{...M,offset:A}:M;return{[x]:P,[D]:ne(P)?[P[0],{...P[1],offset:O}]:{...P,offset:O}}}}function Q5(e,t,n,i,r,s,o){if(SX(e))return 0;const a=e==="x"||e==="y2",l=a?-t/2:t/2;if(Ie(n)||Ie(r)||Ie(i)||s){const u=yo(n),c=yo(r),d=yo(i),h=yo(s),g=s?`(${o} < ${h} ? ${a?"":"-"}0.5 * (${h} - (${o})) : ${l})`:l,m=d?`${d} + `:"",C=u?`(${u} ? -1 : 1) * `:"",y=c?`(${c} + ${g})`:g;return{signal:m+C+y}}else return r=r||0,i+(n?-r-l:+r+l)}function aGe({fieldDef:e,fieldDef2:t,channel:n,model:i}){const{config:r,markDef:s,encoding:o}=i,a=i.getScaleComponent(n),l=i.scaleName(n),u=a?a.get("type"):void 0,c=a.get("reverse"),d=FQ({channel:n,fieldDef:e,markDef:s,config:r,scaleType:u}),p=i.component.axes[n]?.[0]?.get("translate")??.5,g=Tn(n)?zt("binSpacing",s,r)??0:0,m=Wa(n),C=uc(n),y=uc(m),b=Ma("minBandSize",s,r),{offset:S}=Tp({channel:n,markDef:s,encoding:o,model:i,bandPosition:0}),{offset:x}=Tp({channel:m,markDef:s,encoding:o,model:i,bandPosition:0}),E=PNe({fieldDef:e,scaleName:l}),A=Q5(n,g,c,p,S,b,E),F=Q5(m,g,c,p,x??S,b,E),P=Ie(d)?{signal:`(1-${d.signal})/2`}:ah(d)?(1-d.band)/2:.5,D=cc({fieldDef:e,fieldDef2:t,markDef:s,config:r});if(Qt(e.bin)||e.timeUnit){const M=e.timeUnit&&D!==.5;return{[y]:Z5({fieldDef:e,scaleName:l,bandPosition:P,offset:F,useRectOffsetField:M}),[C]:Z5({fieldDef:e,scaleName:l,bandPosition:Ie(P)?{signal:`1-${P.signal}`}:1-P,offset:A,useRectOffsetField:M})}}else if(fi(e.bin)){const M=Td(e,l,{},{offset:F});if(fe(t))return{[y]:M,[C]:Td(t,l,{},{offset:A})};if(Dh(e.bin)&&e.bin.step)return{[y]:M,[C]:{signal:`scale("${l}", ${ye(e,{expr:"datum"})} + ${e.bin.step})`,offset:A}}}he(jX(m))}function Z5({fieldDef:e,scaleName:t,bandPosition:n,offset:i,useRectOffsetField:r}){return VS({scaleName:t,fieldOrDatumDef:e,bandPosition:n,offset:i,...r?{startSuffix:RR,endSuffix:ER}:{}})}const lGe=new Set(["aria","width","height"]);function Xs(e,t){const{fill:n=void 0,stroke:i=void 0}=t.color==="include"?IZ(e):{};return{...uGe(e.markDef,t),...J5("fill",n),...J5("stroke",i),...mi("opacity",e),...mi("fillOpacity",e),...mi("strokeOpacity",e),...mi("strokeWidth",e),...mi("strokeDash",e),...JBe(e),...MZ(e),...PL(e,"href"),...XBe(e)}}function J5(e,t){return t?{[e]:t}:{}}function uGe(e,t){return COe.reduce((n,i)=>(!lGe.has(i)&&ue(e,i)&&t[i]!=="ignore"&&(n[i]=en(e[i])),n),{})}function TL(e){const{config:t,markDef:n}=e,i=new Set;if(e.forEachFieldDef((r,s)=>{let o;if(!Ua(s)||!(o=e.getScaleType(s)))return;const a=sR(r.aggregate),l=aL({scaleChannel:s,markDef:n,config:t,scaleType:o,isCountAggregate:a});if(ANe(l)){const u=e.vgField(s,{expr:"datum",binSuffix:e.stack?.impute?"mid":void 0});u&&i.add(u)}}),i.size>0)return{defined:{signal:[...i].map(s=>uR(s,!0)).join(" && ")}}}function e6(e,t){if(t!==void 0)return{[e]:en(t)}}const oD="voronoi",LZ={defined:e=>e.type==="point"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(oD)},marks:(e,t,n)=>{const{x:i,y:r}=t.project.hasChannel,s=e.mark;if(Ic(s))return he(ROe(s)),n;const o={name:e.getName(oD),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0},...MZ(e,{reactiveGeom:!0})}},transform:[{type:"voronoi",x:{expr:i||!r?"datum.datum.x || 0":"0"},y:{expr:r||!i?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let a=0,l=!1;return n.forEach((u,c)=>{const d=u.name??"";d===e.component.mark[0].name?a=c:d.includes(oD)&&(l=!0)}),l||n.splice(a+1,0,o),n}},NZ={defined:e=>e.type==="point"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!SL(e.bind),parse:(e,t,n)=>UZ(t,n),topLevelSignals:(e,t,n)=>{const i=t.name,r=t.project,s=t.bind,o=t.init&&t.init[0],a=LZ.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return r.items.forEach((l,u)=>{const c=an(`${i}_${l.field}`);n.filter(h=>h.name===c).length||n.unshift({name:c,...o?{init:uh(o[u])}:{value:null},on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${a}[${ge(l.field)}] : null`}]:[],bind:s[l.field]??s[l.channel]??s})}),n},signals:(e,t,n)=>{const i=t.name,r=t.project,s=n.find(u=>u.name===i+Hl),o=i+MC,a=r.items.map(u=>an(`${i}_${u.field}`)),l=a.map(u=>`${u} !== null`).join(" && ");return a.length&&(s.update=`${l} ? {fields: ${o}, values: [${a.join(", ")}]} : null`),delete s.value,delete s.on,n}},QS="_toggle",$Z={defined:e=>e.type==="point"&&!Sa(e)&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+QS,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+Hl,i=t.name+QS;return`${i} ? null : ${n}, `+(t.resolve==="global"?`${i} ? null : true, `:`${i} ? null : {unit: ${_d(e)}}, `)+`${i} ? ${n} : null`}},cGe={defined:e=>e.clear!==void 0&&e.clear!==!1&&!Sa(e),parse:(e,t)=>{t.clear&&(t.clear=Re(t.clear)?Ec(t.clear,"view"):t.clear)},topLevelSignals:(e,t,n)=>{if(NZ.defined(t))for(const i of t.project.items){const r=n.findIndex(s=>s.name===an(`${t.name}_${i.field}`));r!==-1&&n[r].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function i(r,s){r!==-1&&n[r].on&&n[r].on.push({events:t.clear,update:s})}if(t.type==="interval")for(const r of t.project.items){const s=n.findIndex(o=>o.name===r.signals.visual);if(i(s,"[0, 0]"),s===-1){const o=n.findIndex(a=>a.name===r.signals.data);i(o,"null")}}else{let r=n.findIndex(s=>s.name===t.name+Hl);i(r,"null"),$Z.defined(t)&&(r=n.findIndex(s=>s.name===t.name+QS),i(r,"false"))}return n}},BZ={defined:e=>{const t=e.resolve==="global"&&e.bind&&SL(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==To;return t&&!n&&he(DOe),t&&n},parse:(e,t,n)=>{const i=Ke(n);if(i.select=Re(i.select)?{type:i.select,toggle:t.toggle}:{...i.select,toggle:t.toggle},UZ(t,i),be(n.select)&&(n.select.on||n.select.clear)){const o='event.item && indexof(event.item.mark.role, "legend") < 0';for(const a of t.events)a.filter=xe(a.filter??[]),a.filter.includes(o)||a.filter.push(o)}const r=eD(t.bind)?t.bind.legend:"click",s=Re(r)?Ec(r,"view"):xe(r);t.bind={legend:{merge:s}}},topLevelSignals:(e,t,n)=>{const i=t.name,r=eD(t.bind)&&t.bind.legend,s=o=>a=>{const l=Ke(a);return l.markname=o,l};for(const o of t.project.items){if(!o.hasLegend)continue;const a=`${an(o.field)}_legend`,l=`${i}_${a}`;if(n.filter(c=>c.name===l).length===0){const c=r.merge.map(s(`${a}_symbols`)).concat(r.merge.map(s(`${a}_labels`))).concat(r.merge.map(s(`${a}_entries`)));n.unshift({name:l,...t.init?{}:{value:null},on:[{events:c,update:"isDefined(datum.value) ? datum.value : item().items[0].items[0].datum.value",force:!0},{events:r.merge,update:`!event.item || !datum ? null : ${l}`,force:!0}]})}}return n},signals:(e,t,n)=>{const i=t.name,r=t.project,s=n.find(h=>h.name===i+Hl),o=i+MC,a=r.items.filter(h=>h.hasLegend).map(h=>an(`${i}_${an(h.field)}_legend`)),u=`${a.map(h=>`${h} !== null`).join(" && ")} ? {fields: ${o}, values: [${a.join(", ")}]} : null`;t.events&&a.length>0?s.on.push({events:a.map(h=>({signal:h})),update:u}):a.length>0&&(s.update=u,delete s.value,delete s.on);const c=n.find(h=>h.name===i+QS),d=eD(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push({...c.on[0],events:d}):c.on[0].events=d),n}};function dGe(e,t,n){const i=e.fieldDef(t)?.field;for(const r of bi(e.component.selection??{})){const s=r.project.hasField[i]??r.project.hasChannel[t];if(s&&BZ.defined(r)){const o=n.get("selections")??[];o.push(r.name),n.set("selections",o,!1),s.hasLegend=!0}}}const GZ="_translate_anchor",zZ="_translate_delta",hGe={defined:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const i=t.name,r=Ml.defined(t),s=i+GZ,{x:o,y:a}=t.project.hasChannel;let l=Ec(t.translate,"scope");return r||(l=l.map(u=>(u.between[0].markname=i+Wf,u))),n.push({name:s,value:{},on:[{events:l.map(u=>u.between[0]),update:"{x: x(unit), y: y(unit)"+(o!==void 0?`, extent_x: ${r?AM(e,ln):`slice(${o.signals.visual})`}`:"")+(a!==void 0?`, extent_y: ${r?AM(e,li):`slice(${a.signals.visual})`}`:"")+"}"}]},{name:i+zZ,value:{},on:[{events:l,update:`{x: ${s}.x - x(unit), y: ${s}.y - y(unit)}`}]}),o!==void 0&&t6(e,t,o,"width",n),a!==void 0&&t6(e,t,a,"height",n),n}};function t6(e,t,n,i,r){const s=t.name,o=s+GZ,a=s+zZ,l=n.channel,u=Ml.defined(t),c=r.find(E=>E.name===n.signals[u?"data":"visual"]),d=e.getSizeSignalRef(i).signal,h=e.getScaleComponent(l),p=h&&h.get("type"),g=h&&h.get("reverse"),m=u?l===ln?g?"":"-":g?"-":"":"",C=`${o}.extent_${l}`,y=`${m}${a}.${l} / ${u?`${d}`:`span(${C})`}`,b=!u||!h?"panLinear":p==="log"?"panLog":p==="symlog"?"panSymlog":p==="pow"?"panPow":"panLinear",S=u?p==="pow"?`, ${h.get("exponent")??1}`:p==="symlog"?`, ${h.get("constant")??1}`:"":"",x=`${b}(${C}, ${y}${S})`;c.on.push({events:{signal:a},update:u?x:`clampRange(${x}, 0, ${d})`})}const HZ="_zoom_anchor",VZ="_zoom_delta",fGe={defined:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const i=t.name,r=Ml.defined(t),s=i+VZ,{x:o,y:a}=t.project.hasChannel,l=ge(e.scaleName(ln)),u=ge(e.scaleName(li));let c=Ec(t.zoom,"scope");return r||(c=c.map(d=>(d.markname=i+Wf,d))),n.push({name:i+HZ,on:[{events:c,update:r?"{"+[l?`x: invert(${l}, x(unit))`:"",u?`y: invert(${u}, y(unit))`:""].filter(d=>d).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:s,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),o!==void 0&&n6(e,t,o,"width",n),a!==void 0&&n6(e,t,a,"height",n),n}};function n6(e,t,n,i,r){const s=t.name,o=n.channel,a=Ml.defined(t),l=r.find(b=>b.name===n.signals[a?"data":"visual"]),u=e.getSizeSignalRef(i).signal,c=e.getScaleComponent(o),d=c&&c.get("type"),h=a?AM(e,o):l.name,p=s+VZ,g=`${s}${HZ}.${o}`,m=!a||!c?"zoomLinear":d==="log"?"zoomLog":d==="symlog"?"zoomSymlog":d==="pow"?"zoomPow":"zoomLinear",C=a?d==="pow"?`, ${c.get("exponent")??1}`:d==="symlog"?`, ${c.get("constant")??1}`:"":"",y=`${m}(${h}, ${g}, ${p}${C})`;l.on.push({events:{signal:p},update:a?y:`clampRange(${y}, 0, ${u})`})}const ch="_store",Hl="_tuple",pGe="_modify",WZ="vlSelectionResolve",AR=[GBe,KBe,NBe,$Z,NZ,Ml,BZ,cGe,hGe,fGe,LZ];function gGe(e){let t=e.parent;for(;t&&!ss(t);)t=t.parent;return t}function _d(e,{escape:t}={escape:!0}){let n=t?ge(e.name):e.name;const i=gGe(e);if(i){const{facet:r}=i;for(const s of Is)r[s]&&(n+=` + '__facet_${s}_' + (facet[${ge(i.vgField(s))}])`)}return n}function IL(e){return bi(e.component.selection??{}).reduce((t,n)=>t||n.project.hasSelectionId,!1)}function UZ(e,t){(Re(t.select)||!t.select.on)&&delete e.events,(Re(t.select)||!t.select.clear)&&delete e.clear,(Re(t.select)||!t.select.toggle)&&delete e.toggle}function Sa(e){return e.events?.find(t=>"type"in t&&t.type==="timer")}function kM(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...kM(e.object)),t.push(...kM(e.property))),t)}function qZ(e){return e.object.type==="MemberExpression"?qZ(e.object):e.object.name==="datum"}function jZ(e){const t=Z2(e),n=new Set;return t.visit(i=>{i.type==="MemberExpression"&&qZ(i)&&n.add(kM(i).slice(1).join("."))}),n}class mg extends Gt{clone(){return new mg(null,this.model,Ke(this.filter))}constructor(t,n,i){super(t),this.model=n,this.filter=i,this.expr=ZS(this.model,this.filter,this),this._dependentFields=jZ(this.expr)}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function mGe(e,t){const n={},i=e.config.selection;if(!t||!t.length)return n;let r=0;for(const s of t){const o=an(s.name),a=s.select,l=Re(a)?a:a.type,u=be(a)?Ke(a):{type:l},c=i[l];for(const p in c)p==="fields"||p==="encodings"||(p==="mark"&&(u.mark={...c.mark,...u.mark}),(u[p]===void 0||u[p]===!0)&&(u[p]=Ke(c[p]??u[p])));const d=n[o]={...u,name:o,type:l,init:s.value,bind:s.bind,events:Re(u.on)?Ec(u.on,"scope"):xe(Ke(u.on))};if(Sa(d)&&(r++,r>1)){delete n[o];continue}const h=Ke(s);for(const p of AR)p.defined(d)&&p.parse&&p.parse(e,d,h)}return r>1&&he(_Oe),n}function KZ(e,t,n,i="datum"){const r=Re(t)?t:t.param,s=an(r),o=ge(s+ch);let a;try{a=e.getSelectionComponent(s,r)}catch{return`!!${s}`}if(a.project.timeUnit){const h=n??e.component.data.raw,p=a.project.timeUnit.clone();h.parent?p.insertAsParentOf(h):h.parent=p}const l=a.project.hasSelectionId?"vlSelectionIdTest(":"vlSelectionTest(",u=a.resolve==="global"?")":`, ${ge(a.resolve)})`,c=`${l}${o}, ${i}${u}`,d=`length(data(${o}))`;return t.empty===!1?`${d} && ${c}`:`!${d} || ${c}`}function YZ(e,t,n){const i=an(t),r=n.encoding;let s=n.field,o;try{o=e.getSelectionComponent(i,t)}catch{return i}if(!r&&!s)s=o.project.items[0].field,o.project.items.length>1&&he(OOe(s));else if(r&&!s){const a=o.project.items.filter(l=>l.channel===r);!a.length||a.length>1?(s=o.project.items[0].field,he(LOe(a,r,n,s))):s=a[0].field}return`${o.name}[${ge(Us(s))}]`}function vGe(e,t){for(const[n,i]of lc(e.component.selection??{})){const r=e.getName(`lookup_${n}`);e.component.data.outputNodes[r]=i.materialized=new Mr(new mg(t,e,{param:n}),r,fn.Lookup,e.component.data.outputNodeRefCounts)}}function ZS(e,t,n){return Rv(t,i=>Re(i)?i:ULe(i)?KZ(e,i,n):sQ(i))}function CGe(e,t){if(e)return ne(e)&&!Pu(e)?e.map(n=>pL(n,t)).join(", "):e}function aD(e,t,n,i){var r,s;e.encode??(e.encode={}),(r=e.encode)[t]??(r[t]={}),(s=e.encode[t]).update??(s.update={}),e.encode[t].update[n]=i}function rv(e,t,n,i={header:!1}){const{disable:r,orient:s,scale:o,labelExpr:a,title:l,zindex:u,...c}=e.combine();if(!r){for(const d in c){const h=d,p=XNe[h],g=c[h];if(p&&p!==t&&p!=="both")delete c[h];else if(PC(g)){const{condition:m,...C}=g,y=xe(m),b=P5[h];if(b){const{vgProp:S,part:x}=b,E=[...y.map(A=>{const{test:F,...P}=A;return{test:ZS(null,F),...P}}),C];aD(c,x,S,E),delete c[h]}else if(b===null){const S={signal:y.map(x=>{const{test:E,...A}=x;return`${ZS(null,E)} ? ${p5(A)} : `}).join("")+p5(C)};c[h]=S}}else if(Ie(g)){const m=P5[h];if(m){const{vgProp:C,part:y}=m;aD(c,y,C,g),delete c[h]}}ht(["labelAlign","labelBaseline"],h)&&c[h]===null&&delete c[h]}if(t==="grid"){if(!c.grid)return;if(c.encode){const{grid:d}=c.encode;c.encode={...d?{grid:d}:{}},Ht(c.encode)&&delete c.encode}return{scale:o,orient:s,...c,domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:Mn(u,0)}}else{if(!i.header&&e.mainExtracted)return;if(a!==void 0){let h=a;c.encode?.labels?.update&&Ie(c.encode.labels.update.text)&&(h=nh(a,"datum.label",c.encode.labels.update.text.signal)),aD(c,"labels","text",{signal:h})}if(c.labelAlign===null&&delete c.labelAlign,c.encode){for(const h of LQ)e.hasAxisPart(h)||delete c.encode[h];Ht(c.encode)&&delete c.encode}const d=CGe(l,n);return{scale:o,orient:s,grid:!1,...d?{title:d}:{},...c,...n.aria===!1?{aria:!1}:{},zindex:Mn(u,0)}}}}function XZ(e){const{axes:t}=e.component,n=[];for(const i of ru)if(t[i]){for(const r of t[i])if(!r.get("disable")&&!r.get("gridScale")){const s=i==="x"?"height":"width",o=e.getSizeSignalRef(s).signal;s!==o&&n.push({name:s,update:o})}}return n}function yGe(e,t){const{x:n=[],y:i=[]}=e;return[...n.map(r=>rv(r,"grid",t)),...i.map(r=>rv(r,"grid",t)),...n.map(r=>rv(r,"main",t)),...i.map(r=>rv(r,"main",t))].filter(r=>r)}function i6(e,t,n,i){return Object.assign.apply(null,[{},...e.map(r=>{if(r==="axisOrient"){const s=n==="x"?"bottom":"left",o=t[n==="x"?"axisBottom":"axisLeft"]||{},a=t[n==="x"?"axisTop":"axisRight"]||{},l=new Set([...le(o),...le(a)]),u={};for(const c of l.values())u[c]={signal:`${i.signal} === "${s}" ? ${yo(o[c])} : ${yo(a[c])}`};return u}return t[r]})])}function wGe(e,t,n,i){const r=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:uQ(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],s=e==="x"?"axisX":"axisY",o=Ie(n)?"axisOrient":`axis${yC(n)}`,a=[...r,...r.map(u=>s+u.substr(4))],l=["axis",o,s];return{vlOnlyAxisConfig:i6(a,i,e,n),vgAxisConfig:i6(l,i,e,n),axisConfigStyle:bGe([...l,...a],i)}}function bGe(e,t){const n=[{}];for(const i of e){let r=t[i]?.style;if(r){r=xe(r);for(const s of r)n.push(t.style[s])}}return Object.assign.apply(null,n)}function PM(e,t,n,i={}){const r=NX(e,n,t);if(r!==void 0)return{configFrom:"style",configValue:r};for(const s of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(i[s]?.[e]!==void 0)return{configFrom:s,configValue:i[s][e]};return{}}const r6={scale:({model:e,channel:t})=>e.scaleName(t),format:({format:e})=>e,formatType:({formatType:e})=>e,grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>t.grid??SGe(n,e),gridScale:({model:e,channel:t})=>xGe(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelAlign||ZZ(t,n,i),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelBaseline||QZ(t,n,i),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>e.labelFlush??EGe(t.type,n),labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>e.labelOverlap??FGe(t.type,n,fe(t)&&!!t.timeUnit,fe(t)?t.sort:void 0),orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:i,scaleType:r})=>{const s=e==="x"?"width":e==="y"?"height":void 0,o=s?t.getSizeSignalRef(s):void 0;return n.tickCount??DGe({fieldOrDatumDef:i,scaleType:r,size:o,values:n.values})},tickMinStep:kGe,title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const i=JZ(t,n);if(i!==void 0)return i;const r=t.typedFieldDef(n),s=n==="x"?"x2":"y2",o=t.fieldDef(s);return BX(r?[D5(r)]:[],fe(o)?[D5(o)]:[])},values:({axis:e,fieldOrDatumDef:t})=>PGe(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>e.zindex??MGe(n,t)};function SGe(e,t){return!oi(e)&&fe(t)&&!Qt(t?.bin)&&!fi(t?.bin)}function xGe(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function RGe(e,t,n,i,r){const s=t?.labelAngle;if(s!==void 0)return Ie(s)?s:h0(s);{const{configValue:o}=PM("labelAngle",i,t?.style,r);return o!==void 0?h0(o):n===ln&&ht([nL,tL],e.type)&&!(fe(e)&&e.timeUnit)?270:void 0}}function MM(e){return`(((${e.signal} % 360) + 360) % 360)`}function QZ(e,t,n,i){if(e!==void 0)if(n==="x"){if(Ie(e)){const r=MM(e),s=Ie(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${r} && ${r} < 135) || (225 < ${r} && ${r} < 315) ? "middle" :(${r} <= 45 || 315 <= ${r}) === ${s} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(Ie(t)){const r=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${r} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(Ie(e)){const r=MM(e),s=Ie(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${r} <= 45 || 315 <= ${r} || (135 <= ${r} && ${r} <= 225) ? ${i?'"middle"':"null"} : (45 <= ${r} && ${r} <= 135) === ${s} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return i?"middle":null;if(Ie(t)){const r=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${r} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function ZZ(e,t,n){if(e===void 0)return;const i=n==="x",r=i?0:90,s=i?"bottom":"left";if(Ie(e)){const o=MM(e),a=Ie(t)?`(${t.signal} === "${s}")`:t===s;return{signal:`(${r?`(${o} + 90)`:o} % 180 === 0) ? ${i?null:'"center"'} :(${r} < ${o} && ${o} < ${180+r}) === ${a} ? "left" : "right"`}}if((e+r)%180===0)return i?null:"center";if(Ie(t)){const o=r<e&&e<180+r?"===":"!==";return{signal:`${`${t.signal} ${o} "${s}"`} ? "left" : "right"`}}return(r<e&&e<180+r)==(t===s)?"left":"right"}function EGe(e,t){if(t==="x"&&ht(["quantitative","temporal"],e))return!0}function FGe(e,t,n,i){if(n&&!be(i)||e!=="nominal"&&e!=="ordinal")return t==="log"||t==="symlog"?"greedy":!0}function AGe(e){return e==="x"?"bottom":"left"}function DGe({fieldOrDatumDef:e,scaleType:t,size:n,values:i}){if(!i&&!oi(t)&&t!=="log"){if(fe(e)){if(Qt(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&ht(["month","hours","day","quarter"],si(e.timeUnit)?.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function kGe({format:e,fieldOrDatumDef:t}){if(e==="d")return 1;if(fe(t)){const{timeUnit:n}=t;if(n){const i=nQ(n);if(i)return{signal:i}}}}function JZ(e,t){const n=t==="x"?"x2":"y2",i=e.fieldDef(t),r=e.fieldDef(n),s=i?i.title:void 0,o=r?r.title:void 0;if(s&&o)return GX(s,o);if(s)return s;if(o)return o;if(s!==void 0)return s;if(o!==void 0)return o}function PGe(e,t){const n=e.values;if(ne(n))return OQ(t,n);if(Ie(n))return n}function MGe(e,t){return e==="rect"&&US(t)?1:0}class Ip extends Gt{clone(){return new Ip(null,Ke(this.transform))}constructor(t,n){super(t),this.transform=n,this._dependentFields=jZ(this.transform.calculate)}static parseAllForSortIndex(t,n){return n.forEachFieldDef((i,r)=>{if(Th(i)&&EQ(i.sort)){const{field:s,timeUnit:o}=i,a=i.sort,l=a.map((u,c)=>`${sQ({field:s,timeUnit:o,equal:u})} ? ${c} : `).join("")+a.length;t=new Ip(t,{calculate:l,as:_p(i,r,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${gt(this.transform)}`}}function _p(e,t,n){return ye(e,{prefix:t,suffix:"sort_index",...n})}function DR(e,t){return ht(["top","bottom"],t)?"column":ht(["left","right"],t)||e==="row"?"row":"column"}function Op(e,t,n,i){const r=i==="row"?n.headerRow:i==="column"?n.headerColumn:n.headerFacet;return Mn((t||{})[e],r[e],n.header[e])}function kR(e,t,n,i){const r={};for(const s of e){const o=Op(s,t||{},n,i);o!==void 0&&(r[s]=o)}return r}const _L=["row","column"],OL=["header","footer"];function TGe(e,t){const n=e.component.layoutHeaders[t].title,i=e.config?e.config:void 0,r=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:s,titleAngle:o,titleOrient:a}=kR(["titleAnchor","titleAngle","titleOrient"],r.header,i,t),l=DR(t,a),u=h0(o);return{name:`${t}-title`,type:"group",role:`${l}-title`,title:{text:n,...t==="row"?{orient:"left"}:{},style:"guide-title",...tJ(u,l),...eJ(l,u,s),...nJ(i,r,t,C$e,eZ)}}}function eJ(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const i=ZZ(t,e==="row"?"left":"top",e==="row"?"y":"x");return i?{align:i}:{}}function tJ(e,t){const n=QZ(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function IGe(e,t){const n=e.component.layoutHeaders[t],i=[];for(const r of OL)if(n[r])for(const s of n[r]){const o=OGe(e,t,r,n,s);o!=null&&i.push(o)}return i}function _Ge(e,t){const{sort:n}=e;return Pl(n)?{field:ye(n,{expr:"datum"}),order:n.order??"ascending"}:ne(n)?{field:_p(e,t,{expr:"datum"}),order:"ascending"}:{field:ye(e,{expr:"datum"}),order:n??"ascending"}}function TM(e,t,n){const{format:i,formatType:r,labelAngle:s,labelAnchor:o,labelOrient:a,labelExpr:l}=kR(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),u=cL({fieldOrDatumDef:e,format:i,formatType:r,expr:"parent",config:n}).signal,c=DR(t,a);return{text:{signal:l?nh(nh(l,"datum.label",u),"datum.value",ye(e,{expr:"parent"})):u},...t==="row"?{orient:"left"}:{},style:"guide-label",frame:"group",...tJ(s,c),...eJ(c,s,o),...nJ(n,e,t,y$e,tZ)}}function OGe(e,t,n,i,r){if(r){let s=null;const{facetFieldDef:o}=i,a=e.config?e.config:void 0;if(o&&r.labels){const{labelOrient:d}=kR(["labelOrient"],o.header,a,t);(t==="row"&&!ht(["top","bottom"],d)||t==="column"&&!ht(["left","right"],d))&&(s=TM(o,t,a))}const l=ss(e)&&!FC(e.facet),u=r.axes,c=u?.length>0;if(s||c){const d=t==="row"?"height":"width";return{name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`,...i.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:_Ge(o,t)}:{},...c&&l?{from:{data:e.getName(`facet_domain_${t}`)}}:{},...s?{title:s}:{},...r.sizeSignal?{encode:{update:{[d]:r.sizeSignal}}}:{},...c?{axes:u}:{}}}}return null}const LGe={column:{start:0,end:1},row:{start:1,end:0}};function NGe(e,t){return LGe[t][e]}function $Ge(e,t){const n={};for(const i of Is){const r=e[i];if(r?.facetFieldDef){const{titleAnchor:s,titleOrient:o}=kR(["titleAnchor","titleOrient"],r.facetFieldDef.header,t,i),a=DR(i,o),l=NGe(s,a);l!==void 0&&(n[a]=l)}}return Ht(n)?void 0:n}function nJ(e,t,n,i,r){const s={};for(const o of i){if(!r[o])continue;const a=Op(o,t?.header,e,n);a!==void 0&&(s[r[o]]=a)}return s}function LL(e){return[...yw(e,"width"),...yw(e,"height"),...yw(e,"childWidth"),...yw(e,"childHeight")]}function yw(e,t){const n=t==="width"?"x":"y",i=e.component.layoutSize.get(t);if(!i||i==="merged")return[];const r=e.getSizeSignalRef(t).signal;if(i==="step"){const s=e.getScaleComponent(n);if(s){const o=s.get("type"),a=s.get("range");if(oi(o)&&kh(a)){const l=e.scaleName(n);return ss(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[s6(l,a)]:[s6(l,a),{name:r,update:iJ(l,s,`domain('${l}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(i=="container"){const s=r.endsWith("width"),o=s?"containerSize()[0]":"containerSize()[1]",a=bM(e.config.view,s?"width":"height"),l=`isFinite(${o}) ? ${o} : ${a}`;return[{name:r,init:l,on:[{update:l,events:"window:resize"}]}]}else return[{name:r,value:i}]}function s6(e,t){const n=`${e}_step`;return Ie(t.step)?{name:n,update:t.step.signal}:{name:n,value:t.step}}function iJ(e,t,n){const i=t.get("type"),r=t.get("padding"),s=Mn(t.get("paddingOuter"),r);let o=t.get("paddingInner");return o=i==="band"?o!==void 0?o:r:1,`bandspace(${n}, ${yo(o)}, ${yo(s)}) * ${e}_step`}function rJ(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function sJ(e,t){return le(e).reduce((n,i)=>({...n,...gg({model:t,channelDef:e[i],vgChannel:i,mainRefFn:r=>en(r.value),invalidValueRef:void 0})}),{})}function oJ(e,t){if(ss(t))return e==="theta"?"independent":"shared";if(yg(t))return"shared";if(VL(t))return Tn(e)||e==="theta"||e==="radius"?"independent":"shared";throw new Error("invalid model type for resolve")}function NL(e,t){const n=e.scale[t],i=Tn(t)?"axis":"legend";return n==="independent"?(e[i][t]==="shared"&&he(fLe(t)),"independent"):e[i][t]||"shared"}const BGe={...S$e,disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1},aJ=le(BGe);class GGe extends ou{}const o6={symbols:zGe,gradient:HGe,labels:VGe,entries:WGe};function zGe(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r,legendType:s}){if(s!=="symbol")return;const{markDef:o,encoding:a,config:l,mark:u}=n,c=o.filled&&u!=="trail";let d={...bOe({},n,vNe),...IZ(n,{filled:c})};const h=r.get("symbolOpacity")??l.legend.symbolOpacity,p=r.get("symbolFillColor")??l.legend.symbolFillColor,g=r.get("symbolStrokeColor")??l.legend.symbolStrokeColor,m=h===void 0?lJ(a.opacity)??o.opacity:void 0;if(d.fill){if(i==="fill"||c&&i===Or)delete d.fill;else if(ue(d.fill,"field"))p?delete d.fill:(d.fill=en(l.legend.symbolBaseFillColor??"black"),d.fillOpacity=en(m??1));else if(ne(d.fill)){const C=IM(a.fill??a.color)??o.fill??(c&&o.color);C&&(d.fill=en(C))}}if(d.stroke){if(i==="stroke"||!c&&i===Or)delete d.stroke;else if(ue(d.stroke,"field")||g)delete d.stroke;else if(ne(d.stroke)){const C=Mn(IM(a.stroke||a.color),o.stroke,c?o.color:void 0);C&&(d.stroke={value:C})}}if(i!==iu){const C=fe(t)&&cJ(n,r,t);C?d.opacity=[{test:C,...en(m??1)},en(l.legend.unselectedOpacity)]:m&&(d.opacity=en(m))}return d={...d,...e},Ht(d)?void 0:d}function HGe(e,{model:t,legendType:n,legendCmpt:i}){if(n!=="gradient")return;const{config:r,markDef:s,encoding:o}=t;let a={};const u=(i.get("gradientOpacity")??r.legend.gradientOpacity)===void 0?lJ(o.opacity)||s.opacity:void 0;return u&&(a.opacity=en(u)),a={...a,...e},Ht(a)?void 0:a}function VGe(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r}){const s=n.legend(i)||{},o=n.config,a=fe(t)?cJ(n,r,t):void 0,l=a?[{test:a,value:1},{value:o.legend.unselectedOpacity}]:void 0,{format:u,formatType:c}=s;let d;lh(c)?d=wo({fieldOrDatumDef:t,field:"datum.value",format:u,formatType:c,config:o}):u===void 0&&c===void 0&&o.customFormatTypes&&(t.type==="quantitative"&&o.numberFormatType?d=wo({fieldOrDatumDef:t,field:"datum.value",format:o.numberFormat,formatType:o.numberFormatType,config:o}):t.type==="temporal"&&o.timeFormatType&&fe(t)&&t.timeUnit===void 0&&(d=wo({fieldOrDatumDef:t,field:"datum.value",format:o.timeFormat,formatType:o.timeFormatType,config:o})));const h={...l?{opacity:l}:{},...d?{text:d}:{},...e};return Ht(h)?void 0:h}function WGe(e,{legendCmpt:t}){return t.get("selections")?.length?{...e,fill:{value:"transparent"}}:e}function lJ(e){return uJ(e,(t,n)=>Math.max(t,n.value))}function IM(e){return uJ(e,(t,n)=>Mn(t,n.value))}function uJ(e,t){if($Ne(e))return xe(e.condition).reduce(t,e.value);if(Po(e))return e.value}function cJ(e,t,n){const i=t.get("selections");if(!i?.length)return;const r=ge(n.field);return i.map(s=>`(!length(data(${ge(an(s)+ch)})) || (${s}[${r}] && indexof(${s}[${r}], datum.value) >= 0))`).join(" || ")}const a6={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:i,formatType:r}=t;return SQ(e,e.type,i,r,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return xQ(i,t,n)},gradientLength:e=>{const{legend:t,legendConfig:n}=e;return t.gradientLength??n.gradientLength??QGe(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>e.labelOverlap??t.labelOverlap??ZGe(n),symbolType:({legend:e,markDef:t,channel:n,encoding:i})=>e.symbolType??qGe(t.type,n,i.shape,t.shape),title:({fieldOrDatumDef:e,config:t})=>Vf(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(Hf(n)&&ma(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>UGe(t,e)};function UGe(e,t){const n=e.values;if(ne(n))return OQ(t,n);if(Ie(n))return n}function qGe(e,t,n,i){if(t!=="shape"){const r=IM(n)??i;if(r)return r}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function jGe(e){const{legend:t}=e;return Mn(t.type,KGe(e))}function KGe({channel:e,timeUnit:t,scaleType:n}){if(Hf(e)){if(ht(["quarter","month","day"],t))return"symbol";if(ma(n))return"gradient"}return"symbol"}function YGe({legendConfig:e,legendType:t,orient:n,legend:i}){return i.direction??e[t?"gradientDirection":"symbolDirection"]??XGe(n,t)}function XGe(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function QGe({legendConfig:e,model:t,direction:n,orient:i,scaleType:r}){const{gradientHorizontalMaxLength:s,gradientHorizontalMinLength:o,gradientVerticalMaxLength:a,gradientVerticalMinLength:l}=e;if(ma(r))return n==="horizontal"?i==="top"||i==="bottom"?l6(t,"width",o,s):o:l6(t,"height",l,a)}function l6(e,t,n,i){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${i})`}}function ZGe(e){if(ht(["quantile","threshold","log","symlog"],e))return"greedy"}function dJ(e){const t=hn(e)?JGe(e):i3e(e);return e.component.legends=t,t}function JGe(e){const{encoding:t}=e,n={};for(const i of[Or,...iZ]){const r=jn(t[i]);!r||!e.getScaleComponent(i)||i===Lr&&fe(r)&&r.type===pg||(n[i]=n3e(e,i))}return n}function e3e(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function t3e(e,t,n,i){switch(t){case"disable":return n!==void 0;case"values":return!!n?.values;case"title":if(t==="title"&&e===i?.title)return!0}return e===(n||{})[t]}function n3e(e,t){let n=e.legend(t);const{markDef:i,encoding:r,config:s}=e,o=s.legend,a=new GGe({},e3e(e,t));dGe(e,t,a);const l=n!==void 0?!n:o.disable;if(a.set("disable",l,n!==void 0),l)return a;n=n||{};const u=e.getScaleComponent(t).get("type"),c=jn(r[t]),d=fe(c)?si(c.timeUnit)?.unit:void 0,h=n.orient||s.legend.orient||"right",p=jGe({legend:n,channel:t,timeUnit:d,scaleType:u}),g=YGe({legend:n,legendType:p,orient:h,legendConfig:o}),m={legend:n,channel:t,model:e,markDef:i,encoding:r,fieldOrDatumDef:c,legendConfig:o,config:s,scaleType:u,orient:h,legendType:p,direction:g};for(const x of aJ){if(p==="gradient"&&x.startsWith("symbol")||p==="symbol"&&x.startsWith("gradient"))continue;const E=x in a6?a6[x](m):n[x];if(E!==void 0){const A=t3e(E,x,n,e.fieldDef(t));(A||s.legend[x]===void 0)&&a.set(x,E,A)}}const C=n?.encoding??{},y=a.get("selections"),b={},S={fieldOrDatumDef:c,model:e,channel:t,legendCmpt:a,legendType:p};for(const x of["labels","legend","title","symbols","gradient","entries"]){const E=sJ(C[x]??{},e),A=x in o6?o6[x](E,S):E;A!==void 0&&!Ht(A)&&(b[x]={...y?.length&&fe(c)?{name:`${an(c.field)}_legend_${x}`}:{},...y?.length?{interactive:!!y}:{},update:A})}return Ht(b)||a.set("encode",b,!!n?.encoding),a}function i3e(e){const{legends:t,resolve:n}=e.component;for(const i of e.children){dJ(i);for(const r of le(i.component.legends))n.legend[r]=NL(e.component.resolve,r),n.legend[r]==="shared"&&(t[r]=hJ(t[r],i.component.legends[r]),t[r]||(n.legend[r]="independent",delete t[r]))}for(const i of le(t))for(const r of e.children)r.component.legends[i]&&n.legend[i]==="shared"&&delete r.component.legends[i];return t}function hJ(e,t){if(!e)return t.clone();const n=e.getWithExplicit("orient"),i=t.getWithExplicit("orient");if(n.explicit&&i.explicit&&n.value!==i.value)return;let r=!1;for(const s of aJ){const o=dc(e.getWithExplicit(s),t.getWithExplicit(s),s,"legend",(a,l)=>{switch(s){case"symbolType":return r3e(a,l);case"title":return zX(a,l);case"type":return r=!0,Kr("symbol")}return xR(a,l,s,"legend")});e.setWithExplicit(s,o)}return r&&(e.implicit?.encode?.gradient&&GS(e.implicit,["encode","gradient"]),e.explicit?.encode?.gradient&&GS(e.explicit,["encode","gradient"])),e}function r3e(e,t){return t.value==="circle"?t:e}function s3e(e,t,n,i){var r,s;e.encode??(e.encode={}),(r=e.encode)[t]??(r[t]={}),(s=e.encode[t]).update??(s.update={}),e.encode[t].update[n]=i}function fJ(e){const t=e.component.legends,n={};for(const r of le(t)){const s=e.getScaleComponent(r),o=Vt(s.get("domains"));if(n[o])for(const a of n[o])hJ(a,t[r])||n[o].push(t[r]);else n[o]=[t[r].clone()]}return bi(n).flat().map(r=>o3e(r,e.config)).filter(r=>r!==void 0)}function o3e(e,t){const{disable:n,labelExpr:i,selections:r,...s}=e.combine();if(!n){if(t.aria===!1&&s.aria==null&&(s.aria=!1),s.encode?.symbols){const o=s.encode.symbols.update;o.fill&&o.fill.value!=="transparent"&&!o.stroke&&!s.stroke&&(o.stroke={value:"transparent"});for(const a of iZ)s[a]&&delete o[a]}if(s.title||delete s.title,i!==void 0){let o=i;s.encode?.labels?.update&&Ie(s.encode.labels.update.text)&&(o=nh(i,"datum.label",s.encode.labels.update.text.signal)),s3e(s,"labels","text",{signal:o})}return s}}function a3e(e){return yg(e)||VL(e)?l3e(e):pJ(e)}function l3e(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),pJ(e))}function pJ(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:i}=n;if(t.data){const r={signal:`[${t.size.map(o=>o.signal).join(", ")}]`},s=t.data.reduce((o,a)=>{const l=Ie(a)?a.signal:`data('${e.lookupDataSource(a)}')`;return ht(o,l)||o.push(l),o},[]);if(s.length<=0)throw new Error("Projection's fit didn't find any data sources");return[{name:i,size:r,fit:{signal:s.length>1?`[${s.join(", ")}]`:s[0]},...n}]}else return[{name:i,translate:{signal:"[width / 2, height / 2]"},...n}]}const u3e=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class gJ extends ou{constructor(t,n,i,r){super({...n},{name:t}),this.specifiedProjection=n,this.size=i,this.data=r,this.merged=!1}get isFit(){return!!this.data}}function mJ(e){e.component.projection=hn(e)?c3e(e):f3e(e)}function c3e(e){if(e.hasProjection){const t=pi(e.specifiedProjection),n=!(t&&(t.scale!=null||t.translate!=null)),i=n?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,r=n?d3e(e):void 0,s=new gJ(e.projectionName(!0),{...pi(e.config.projection),...t},i,r);return s.get("type")||s.set("type","equalEarth",!1),s}}function d3e(e){const t=[],{encoding:n}=e;for(const i of[[Wo,Vo],[qs,Uo]])(jn(n[i[0]])||jn(n[i[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(Lr)&&e.typedFieldDef(Lr).type===pg&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(fn.Main)),t}function h3e(e,t){const n=DO(u3e,r=>!!(!Ae(e.explicit,r)&&!Ae(t.explicit,r)||Ae(e.explicit,r)&&Ae(t.explicit,r)&&ts(e.get(r),t.get(r))));if(ts(e.size,t.size)){if(n)return e;if(ts(e.explicit,{}))return t;if(ts(t.explicit,{}))return e}return null}function f3e(e){if(e.children.length===0)return;let t;for(const i of e.children)mJ(i);const n=DO(e.children,i=>{const r=i.component.projection;if(r)if(t){const s=h3e(t,r);return s&&(t=s),!!s}else return t=r,!0;else return!0});if(t&&n){const i=e.projectionName(!0),r=new gJ(i,t.specifiedProjection,t.size,Ke(t.data));for(const s of e.children){const o=s.component.projection;o&&(o.isFit&&r.data.push(...s.component.projection.data),s.renameProjection(o.get("name"),i),o.merged=!0)}return r}}function p3e(e,t,n,i){if(kC(t,n)){const r=hn(e)?e.axis(n)??e.legend(n)??{}:{},s=ye(t,{expr:"datum"}),o=ye(t,{expr:"datum",binSuffix:"end"});return{formulaAs:ye(t,{binSuffix:"range",forAs:!0}),formula:EC(s,o,r.format,r.formatType,i)}}return{}}function vJ(e,t){return`${IX(e)}_${t}`}function g3e(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function $L(e,t,n){const i=vR(n,void 0)??{},r=vJ(i,t);return e.getName(`${r}_bins`)}function m3e(e){return"as"in e}function u6(e,t,n){let i,r;m3e(e)?i=Re(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:i=[ye(e,{forAs:!0}),ye(e,{binSuffix:"end",forAs:!0})];const s={...vR(t,void 0)},o=vJ(s,e.field),{signal:a,extentSignal:l}=g3e(n,o);if(oR(s.extent)){const c=s.extent;r=YZ(n,c.param,c),delete s.extent}const u={bin:s,field:e.field,as:[i],...a?{signal:a}:{},...l?{extentSignal:l}:{},...r?{span:r}:{}};return{key:o,binComponent:u}}class xa extends Gt{clone(){return new xa(null,Ke(this.bins))}constructor(t,n){super(t),this.bins=n}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,s,o)=>{if(dr(s)&&Qt(s.bin)){const{key:a,binComponent:l}=u6(s,s.bin,n);r[a]={...l,...r[a],...p3e(n,s,o,n.config)}}return r},{});return Ht(i)?null:new xa(t,i)}static makeFromTransform(t,n,i){const{key:r,binComponent:s}=u6(n,n.bin,i);return new xa(t,{[r]:s})}merge(t,n){for(const i of le(t.bins))i in this.bins?(n(t.bins[i].signal,this.bins[i].signal),this.bins[i].as=ga([...this.bins[i].as,...t.bins[i].as],gt)):this.bins[i]=t.bins[i];for(const i of t.children)t.removeChild(i),i.parent=this;t.remove()}producedFields(){return new Set(bi(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(bi(this.bins).map(t=>t.field))}hash(){return`Bin ${gt(this.bins)}`}assemble(){return bi(this.bins).flatMap(t=>{const n=[],[i,...r]=t.as,{extent:s,...o}=t.bin,a={type:"bin",field:Us(t.field),as:i,signal:t.signal,...oR(s)?{extent:null}:{extent:s},...t.span?{span:{signal:`span(${t.span})`}}:{},...o};!s&&t.extentSignal&&(n.push({type:"extent",field:Us(t.field),signal:t.extentSignal}),a.extent={signal:t.extentSignal}),n.push(a);for(const l of r)for(let u=0;u<2;u++)n.push({type:"formula",expr:ye({field:i[u]},{expr:"datum"}),as:l[u]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}function v3e(e,t,n,i){const r=hn(i)?i.encoding[Wa(t)]:void 0;if(dr(n)&&hn(i)&&AQ(n,r,i.markDef,i.config)){e.add(ye(n,{})),e.add(ye(n,{suffix:"end"}));const{mark:s,markDef:o,config:a}=i,l=cc({fieldDef:n,markDef:o,config:a});f0(s)&&l!==.5&&Tn(t)&&(e.add(ye(n,{suffix:RR})),e.add(ye(n,{suffix:ER}))),n.bin&&kC(n,t)&&e.add(ye(n,{binSuffix:"range"}))}else if(RX(t)){const s=xX(t);e.add(i.getName(s))}else e.add(ye(n));return Th(n)&&rNe(n.scale?.range)&&e.add(n.scale.range.field),e}function C3e(e,t){for(const n of le(t)){const i=t[n];for(const r of le(i))n in e?e[n][r]=new Set([...e[n][r]??[],...i[r]]):e[n]={[r]:i[r]}}}class Ro extends Gt{clone(){return new Ro(null,new Set(this.dimensions),Ke(this.measures))}constructor(t,n,i){super(t),this.dimensions=n,this.measures=i}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let i=!1;n.forEachFieldDef(o=>{o.aggregate&&(i=!0)});const r={},s=new Set;return!i||(n.forEachFieldDef((o,a)=>{const{aggregate:l,field:u}=o;if(l)if(l==="count")r["*"]??(r["*"]={}),r["*"].count=new Set([ye(o,{forAs:!0})]);else{if(Gl(l)||Tc(l)){const c=Gl(l)?"argmin":"argmax",d=l[c];r[d]??(r[d]={}),r[d][c]=new Set([ye({op:c,field:d},{forAs:!0})])}else r[u]??(r[u]={}),r[u][l]=new Set([ye(o,{forAs:!0})]);Ua(a)&&n.scaleDomain(a)==="unaggregated"&&(r[u]??(r[u]={}),r[u].min=new Set([ye({field:u,aggregate:"min"},{forAs:!0})]),r[u].max=new Set([ye({field:u,aggregate:"max"},{forAs:!0})]))}else v3e(s,a,o,n)}),s.size+le(r).length===0)?null:new Ro(t,s,r)}static makeFromTransform(t,n){var i;const r=new Set,s={};for(const o of n.aggregate){const{op:a,field:l,as:u}=o;a&&(a==="count"?(s["*"]??(s["*"]={}),s["*"].count=new Set([u||ye(o,{forAs:!0})])):(s[l]??(s[l]={}),(i=s[l])[a]??(i[a]=new Set),s[l][a].add(u||ye(o,{forAs:!0}))))}for(const o of n.groupby??[])r.add(o);return r.size+le(s).length===0?null:new Ro(t,r,s)}merge(t){return gX(this.dimensions,t.dimensions)?(C3e(this.measures,t.measures),!0):(kLe("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...le(this.measures)])}producedFields(){const t=new Set;for(const n of le(this.measures))for(const i of le(this.measures[n])){const r=this.measures[n][i];r.size===0?t.add(`${i}_${n}`):r.forEach(t.add,t)}return t}hash(){return`Aggregate ${gt({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],i=[];for(const s of le(this.measures))for(const o of le(this.measures[s]))for(const a of this.measures[s][o])i.push(a),t.push(o),n.push(s==="*"?null:Us(s));return{type:"aggregate",groupby:[...this.dimensions].map(Us),ops:t,fields:n,as:i}}}class vg extends Gt{constructor(t,n,i,r){super(t),this.model=n,this.name=i,this.data=r;for(const s of Is){const o=n.facet[s];if(o){const{bin:a,sort:l}=o;this[s]={name:n.getName(`${s}_domain`),fields:[ye(o),...Qt(a)?[ye(o,{binSuffix:"end"})]:[]],...Pl(l)?{sortField:l}:ne(l)?{sortIndexField:_p(o,s)}:{}}}}this.childModel=n.child}hash(){let t="Facet";for(const n of Is)this[n]&&(t+=` ${n.charAt(0)}:${gt(this[n])}`);return t}get fields(){const t=[];for(const n of Is)this[n]?.fields&&t.push(...this[n].fields);return t}dependentFields(){const t=new Set(this.fields);for(const n of Is)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of ru){const i=this.childModel.component.scales[n];if(i&&!i.merged){const r=i.get("type"),s=i.get("range");if(oi(r)&&kh(s)){const o=PR(this.childModel,n),a=HL(o);a?t[n]=a:he(HO(n))}}}return t}assembleRowColumnHeaderData(t,n,i){const r={row:"y",column:"x",facet:void 0}[t],s=[],o=[],a=[];r&&i&&i[r]&&(n?(s.push(`distinct_${i[r]}`),o.push("max")):(s.push(i[r]),o.push("distinct")),a.push(`distinct_${i[r]}`));const{sortField:l,sortIndexField:u}=this[t];if(l){const{op:c=pR,field:d}=l;s.push(d),o.push(c),a.push(ye(l,{forAs:!0}))}else u&&(s.push(u),o.push("max"),a.push(u));return{name:this[t].name,source:n??this.data,transform:[{type:"aggregate",groupby:this[t].fields,...s.length?{fields:s,ops:o,as:a}:{}}]}}assembleFacetHeaderData(t){const{columns:n}=this.model.layout,{layoutHeaders:i}=this.model.component,r=[],s={};for(const l of _L){for(const u of OL){const c=(i[l]&&i[l][u])??[];for(const d of c)if(d.axes?.length>0){s[l]=!0;break}}if(s[l]){const u=`length(data("${this.facet.name}"))`,c=l==="row"?n?{signal:`ceil(${u} / ${n})`}:1:n?{signal:`min(${u}, ${n})`}:{signal:u};r.push({name:`${this.facet.name}_${l}`,transform:[{type:"sequence",start:0,stop:c}]})}}const{row:o,column:a}=s;return(o||a)&&r.unshift(this.assembleRowColumnHeaderData("facet",null,t)),r}assemble(){const t=[];let n=null;const i=this.getChildIndependentFieldsWithStep(),{column:r,row:s,facet:o}=this;if(r&&s&&(i.x||i.y)){n=`cross_${this.column.name}_${this.row.name}`;const a=[].concat(i.x??[],i.y??[]),l=a.map(()=>"distinct");t.push({name:n,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:a,ops:l}]})}for(const a of[kl,Dl])this[a]&&t.push(this.assembleRowColumnHeaderData(a,n,i));if(o){const a=this.assembleFacetHeaderData(i);a&&t.push(...a)}return t}}function c6(e){return e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e}function y3e(e,t){const n=MO(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.startsWith("date:")){const i=c6(t.slice(5,t.length));return`timeParse(${n},'${i}')`}else if(t.startsWith("utc:")){const i=c6(t.slice(4,t.length));return`utcParse(${n},'${i}')`}else return he($Oe(t)),null}function w3e(e){const t={};return fb(e.filter,n=>{if(rQ(n)){let i=null;KO(n)?i=Qr(n.equal):XO(n)?i=Qr(n.lte):YO(n)?i=Qr(n.lt):QO(n)?i=Qr(n.gt):ZO(n)?i=Qr(n.gte):JO(n)?i=n.range[0]:eL(n)&&(i=(n.oneOf??n.in)[0]),i&&(Ph(i)?t[n.field]="date":kt(i)?t[n.field]="number":Re(i)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function b3e(e){const t={};function n(i){Pp(i)?t[i.field]="date":i.type==="quantitative"&&hOe(i.aggregate)?t[i.field]="number":Rp(i.field)>1?i.field in t||(t[i.field]="flatten"):Th(i)&&Pl(i.sort)&&Rp(i.sort.field)>1&&(i.sort.field in t||(t[i.sort.field]="flatten"))}if((hn(e)||ss(e))&&e.forEachFieldDef((i,r)=>{if(dr(i))n(i);else{const s=Ah(r),o=e.fieldDef(s);n({...i,type:o.type})}}),hn(e)){const{mark:i,markDef:r,encoding:s}=e;if(Ic(i)&&!e.encoding.order){const o=r.orient==="horizontal"?"y":"x",a=s[o];fe(a)&&a.type==="quantitative"&&!(a.field in t)&&(t[a.field]="number")}}return t}function S3e(e){const t={};if(hn(e)&&e.component.selection)for(const n of le(e.component.selection)){const i=e.component.selection[n];for(const r of i.project.items)!r.channel&&Rp(r.field)>1&&(t[r.field]="flatten")}return t}class Oi extends Gt{clone(){return new Oi(null,Ke(this._parse))}constructor(t,n){super(t),this._parse=n}hash(){return`Parse ${gt(this._parse)}`}static makeExplicit(t,n,i){let r={};const s=n.data;return!Yu(s)&&s?.format?.parse&&(r=s.format.parse),this.makeWithAncestors(t,r,{},i)}static makeWithAncestors(t,n,i,r){for(const a of le(i)){const l=r.getWithExplicit(a);l.value!==void 0&&(l.explicit||l.value===i[a]||l.value==="derived"||i[a]==="flatten"?delete i[a]:he(w5(a,i[a],l.value)))}for(const a of le(n)){const l=r.get(a);l!==void 0&&(l===n[a]?delete n[a]:he(w5(a,n[a],l)))}const s=new ou(n,i);r.copyAll(s);const o={};for(const a of le(s.combine())){const l=s.get(a);l!==null&&(o[a]=l)}return le(o).length===0||r.parseNothing?null:new Oi(t,o)}get parse(){return this._parse}merge(t){this._parse={...this._parse,...t.parse},t.remove()}assembleFormatParse(){const t={};for(const n of le(this._parse)){const i=this._parse[n];Rp(n)===1&&(t[n]=i)}return t}producedFields(){return new Set(le(this._parse))}dependentFields(){return new Set(le(this._parse))}assembleTransforms(t=!1){return le(this._parse).filter(n=>t?Rp(n)>1:!0).map(n=>{const i=y3e(n,this._parse[n]);return i?{type:"formula",expr:i,as:hg(n)}:null}).filter(n=>n!==null)}}class hc extends Gt{clone(){return new hc(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([To])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:To}}}class TC extends Gt{clone(){return new TC(null,this.params)}constructor(t,n){super(t),this.params=n}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${gt(this.params)}`}assemble(){return{type:"graticule",...this.params===!0?{}:this.params}}}class IC extends Gt{clone(){return new IC(null,this.params)}constructor(t,n){super(t),this.params=n}dependentFields(){return new Set}producedFields(){return new Set([this.params.as??"data"])}hash(){return`Hash ${gt(this.params)}`}assemble(){return{type:"sequence",...this.params}}}class dh extends Gt{constructor(t){super(null),t??(t={name:"source"});let n;if(Yu(t)||(n=t.format?{...Pr(t.format,["parse"])}:{}),p0(t))this._data={values:t.values};else if(Mp(t)){if(this._data={url:t.url},!n.type){let i=/(?:\.([^.]+))?$/.exec(t.url)[1];ht(["json","csv","tsv","dsv","topojson"],i)||(i="json"),n.type=i}}else bZ(t)?this._data={values:[{type:"Sphere"}]}:(yZ(t)||Yu(t))&&(this._data={});this._generator=Yu(t),t.name&&(this._name=t.name),n&&!Ht(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return{name:this._name,...this._data,transform:[]}}}var d6=function(e,t,n,i,r){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?r.call(e,n):r?r.value=n:t.set(e,n),n},x3e=function(e,t,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(e):i?i.value:t.get(e)},sv;function BL(e){return e instanceof dh||e instanceof TC||e instanceof IC}class GL{constructor(){sv.set(this,void 0),d6(this,sv,!1,"f")}setModified(){d6(this,sv,!0,"f")}get modifiedFlag(){return x3e(this,sv,"f")}}sv=new WeakMap;class Ih extends GL{getNodeDepths(t,n,i){i.set(t,n);for(const r of t.children)this.getNodeDepths(r,n+1,i);return i}optimize(t){const i=[...this.getNodeDepths(t,0,new Map).entries()].sort((r,s)=>s[1]-r[1]);for(const r of i)this.run(r[0]);return this.modifiedFlag}}class zL extends GL{optimize(t){this.run(t);for(const n of t.children)this.optimize(n);return this.modifiedFlag}}class R3e extends zL{mergeNodes(t,n){const i=n.shift();for(const r of n)t.removeChild(r),r.parent=i,r.remove()}run(t){const n=t.children.map(r=>r.hash()),i={};for(let r=0;r<n.length;r++)i[n[r]]===void 0?i[n[r]]=[t.children[r]]:i[n[r]].push(t.children[r]);for(const r of le(i))i[r].length>1&&(this.setModified(),this.mergeNodes(t,i[r]))}}class E3e extends zL{constructor(t){super(),this.requiresSelectionId=t&&IL(t)}run(t){t instanceof hc&&(this.requiresSelectionId&&(BL(t.parent)||t.parent instanceof Ro||t.parent instanceof Oi)||(this.setModified(),t.remove()))}}class F3e extends GL{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,n){let i=new Set;t instanceof ba&&(i=t.producedFields(),kO(i,n)&&(this.setModified(),t.removeFormulas(n),t.producedFields.length===0&&t.remove()));for(const r of t.children)this.run(r,new Set([...n,...i]))}}class A3e extends zL{constructor(){super()}run(t){t instanceof Mr&&!t.isRequired()&&(this.setModified(),t.remove())}}class D3e extends Ih{run(t){if(!BL(t)&&!(t.numChildren()>1)){for(const n of t.children)if(n instanceof Oi)if(t instanceof Oi)this.setModified(),t.merge(n);else{if(PO(t.producedFields(),n.dependentFields()))continue;this.setModified(),n.swapWithParent()}}}}class k3e extends Ih{run(t){const n=[...t.children],i=t.children.filter(r=>r instanceof Oi);if(t.numChildren()>1&&i.length>=1){const r={},s=new Set;for(const o of i){const a=o.parse;for(const l of le(a))l in r?r[l]!==a[l]&&s.add(l):r[l]=a[l]}for(const o of s)delete r[o];if(!Ht(r)){this.setModified();const o=new Oi(t,r);for(const a of n){if(a instanceof Oi)for(const l of le(r))delete a.parse[l];t.removeChild(a),a.parent=o,a instanceof Oi&&le(a.parse).length===0&&a.remove()}}}}}class P3e extends Ih{run(t){t instanceof Mr||t.numChildren()>0||t instanceof vg||t instanceof dh||(this.setModified(),t.remove())}}class M3e extends Ih{run(t){const n=t.children.filter(r=>r instanceof ba),i=n.pop();for(const r of n)this.setModified(),i.merge(r)}}class T3e extends Ih{run(t){const n=t.children.filter(r=>r instanceof Ro),i={};for(const r of n){const s=gt(r.groupBy);s in i||(i[s]=[]),i[s].push(r)}for(const r of le(i)){const s=i[r];if(s.length>1){const o=s.pop();for(const a of s)o.merge(a)&&(t.removeChild(a),a.parent=o,a.remove(),this.setModified())}}}}class I3e extends Ih{constructor(t){super(),this.model=t}run(t){const n=!(BL(t)||t instanceof mg||t instanceof Oi||t instanceof hc),i=[],r=[];for(const s of t.children)s instanceof xa&&(n&&!PO(t.producedFields(),s.dependentFields())?i.push(s):r.push(s));if(i.length>0){const s=i.pop();for(const o of i)s.merge(o,this.model.renameSignal.bind(this.model));this.setModified(),t instanceof xa?t.merge(s,this.model.renameSignal.bind(this.model)):s.swapWithParent()}if(r.length>1){const s=r.pop();for(const o of r)s.merge(o,this.model.renameSignal.bind(this.model));this.setModified()}}}class _3e extends Ih{run(t){const n=[...t.children];if(!xp(n,o=>o instanceof Mr)||t.numChildren()<=1)return;const r=[];let s;for(const o of n)if(o instanceof Mr){let a=o;for(;a.numChildren()===1;){const[l]=a.children;if(l instanceof Mr)a=l;else break}r.push(...a.children),s?(t.removeChild(o),o.parent=s.parent,s.parent.removeChild(s),s.parent=a,this.setModified()):s=a}else r.push(o);if(r.length){this.setModified();for(const o of r)o.parent.removeChild(o),o.parent=s}}}class _h extends Gt{clone(){return new _h(null,Ke(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=ga(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){return t.as??ye(t)}hash(){return`JoinAggregateTransform ${gt(this.transform)}`}assemble(){const t=[],n=[],i=[];for(const s of this.transform.joinaggregate)n.push(s.op),i.push(this.getDefaultName(s)),t.push(s.field===void 0?null:s.field);const r=this.transform.groupby;return{type:"joinaggregate",as:i,ops:n,fields:t,...r!==void 0?{groupby:r}:{}}}}class Lp extends Gt{clone(){return new Lp(null,{...this.filter})}constructor(t,n){super(t),this.filter=n}static make(t,n,i){const{config:r,markDef:s}=n,{marks:o,scales:a}=i;if(o==="include-invalid-values"&&a==="include-invalid-values")return null;const l=n.reduceFieldDef((u,c,d)=>{const h=Ua(d)&&n.getScaleComponent(d);if(h){const p=h.get("type"),{aggregate:g}=c,m=aL({scaleChannel:d,markDef:s,config:r,scaleType:p,isCountAggregate:sR(g)});m!=="show"&&m!=="always-valid"&&(u[c.field]=c)}return u},{});return le(l).length?new Lp(t,l):null}dependentFields(){return new Set(le(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${gt(this.filter)}`}assemble(){const t=le(this.filter).reduce((n,i)=>{const r=this.filter[i],s=ye(r,{expr:"datum"});return r!==null&&(r.type==="temporal"?n.push(`(isDate(${s}) || (${_M(s)}))`):r.type==="quantitative"&&n.push(_M(s))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}function _M(e){return`isValid(${e}) && isFinite(+${e})`}function O3e(e){return e.stack.stackBy.reduce((t,n)=>{const i=n.fieldDef,r=ye(i);return r&&t.push(r),t},[])}function L3e(e){return ne(e)&&e.every(t=>Re(t))&&e.length>1}class Tl extends Gt{clone(){return new Tl(null,Ke(this._stack))}constructor(t,n){super(t),this._stack=n}static makeFromTransform(t,n){const{stack:i,groupby:r,as:s,offset:o="zero"}=n,a=[],l=[];if(n.sort!==void 0)for(const d of n.sort)a.push(d.field),l.push(Mn(d.order,"ascending"));const u={field:a,order:l};let c;return L3e(s)?c=s:Re(s)?c=[s,`${s}_end`]:c=[`${n.stack}_start`,`${n.stack}_end`],new Tl(t,{dimensionFieldDefs:[],stackField:i,groupby:r,offset:o,sort:u,facetby:[],as:c})}static makeFromEncoding(t,n){const i=n.stack,{encoding:r}=n;if(!i)return null;const{groupbyChannels:s,fieldChannel:o,offset:a,impute:l}=i,u=s.map(p=>{const g=r[p];return Mo(g)}).filter(p=>!!p),c=O3e(n),d=n.encoding.order;let h;if(ne(d)||fe(d))h=$X(d);else{const p=DQ(d)?d.sort:o==="y"?"descending":"ascending";h=c.reduce((g,m)=>(g.field.includes(m)||(g.field.push(m),g.order.push(p)),g),{field:[],order:[]})}return new Tl(t,{dimensionFieldDefs:u,stackField:n.vgField(o),facetby:[],stackby:c,sort:h,offset:a,impute:l,as:[n.vgField(o,{suffix:"start",forAs:!0}),n.vgField(o,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${gt(this._stack)}`}getGroupbyFields(){const{dimensionFieldDefs:t,impute:n,groupby:i}=this._stack;return t.length>0?t.map(r=>r.bin?n?[ye(r,{binSuffix:"mid"})]:[ye(r,{}),ye(r,{binSuffix:"end"})]:[ye(r)]).flat():i??[]}assemble(){const t=[],{facetby:n,dimensionFieldDefs:i,stackField:r,stackby:s,sort:o,offset:a,impute:l,as:u}=this._stack;if(l)for(const c of i){const{bandPosition:d=.5,bin:h}=c;if(h){const p=ye(c,{expr:"datum"}),g=ye(c,{expr:"datum",binSuffix:"end"});t.push({type:"formula",expr:`${_M(p)} ? ${d}*${p}+${1-d}*${g} : ${p}`,as:ye(c,{binSuffix:"mid",forAs:!0})})}t.push({type:"impute",field:r,groupby:[...s,...n],key:ye(c,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:r,sort:o,as:u,offset:a}),t}}class Cg extends Gt{clone(){return new Cg(null,Ke(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=ga(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return(this.transform.groupby??[]).forEach(t.add,t),(this.transform.sort??[]).forEach(n=>t.add(n.field)),this.transform.window.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){return t.as??ye(t)}hash(){return`WindowTransform ${gt(this.transform)}`}assemble(){const t=[],n=[],i=[],r=[];for(const d of this.transform.window)n.push(d.op),i.push(this.getDefaultName(d)),r.push(d.param===void 0?null:d.param),t.push(d.field===void 0?null:d.field);const s=this.transform.frame,o=this.transform.groupby;if(s&&s[0]===null&&s[1]===null&&n.every(d=>GO(d)))return{type:"joinaggregate",as:i,ops:n,fields:t,...o!==void 0?{groupby:o}:{}};const a=[],l=[];if(this.transform.sort!==void 0)for(const d of this.transform.sort)a.push(d.field),l.push(d.order??"ascending");const u={field:a,order:l},c=this.transform.ignorePeers;return{type:"window",params:r,as:i,ops:n,fields:t,sort:u,...c!==void 0?{ignorePeers:c}:{},...o!==void 0?{groupby:o}:{},...s!==void 0?{frame:s}:{}}}}function N3e(e){function t(n){if(!(n instanceof vg)){const i=n.clone();if(i instanceof Mr){const r=LM+i.getSource();i.setSource(r),e.model.component.data.outputNodes[r]=i}else(i instanceof Ro||i instanceof Tl||i instanceof Cg||i instanceof _h)&&i.addDimensions(e.fields);for(const r of n.children.flatMap(t))r.parent=i;return[i]}return n.children.flatMap(t)}return t}function OM(e){if(e instanceof vg)if(e.numChildren()===1&&!(e.children[0]instanceof Mr)){const t=e.children[0];(t instanceof Ro||t instanceof Tl||t instanceof Cg||t instanceof _h)&&t.addDimensions(e.fields),t.swapWithParent(),OM(e)}else{const t=e.model.component.data.main;CJ(t);const n=N3e(e),i=e.children.map(n).flat();for(const r of i)r.parent=t}else e.children.map(OM)}function CJ(e){if(e instanceof Mr&&e.type===fn.Main&&e.numChildren()===1){const t=e.children[0];t instanceof vg||(t.swapWithParent(),CJ(e))}}const LM="scale_",ww=5;function NM(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return!1;if(!NM(t.children))return!1}return!0}function so(e,t){let n=!1;for(const i of t)n=e.optimize(i)||n;return n}function h6(e,t,n){let i=e.sources,r=!1;return r=so(new A3e,i)||r,r=so(new E3e(t),i)||r,i=i.filter(s=>s.numChildren()>0),r=so(new P3e,i)||r,i=i.filter(s=>s.numChildren()>0),n||(r=so(new D3e,i)||r,r=so(new I3e(t),i)||r,r=so(new F3e,i)||r,r=so(new k3e,i)||r,r=so(new T3e,i)||r,r=so(new M3e,i)||r,r=so(new R3e,i)||r,r=so(new _3e,i)||r),e.sources=i,r}function $3e(e,t){NM(e.sources);let n=0,i=0;for(let r=0;r<ww&&h6(e,t,!0);r++)n++;e.sources.map(OM);for(let r=0;r<ww&&h6(e,t,!1);r++)i++;NM(e.sources),Math.max(n,i)===ww&&he(`Maximum optimization runs(${ww}) reached.`)}class Jn{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new Jn(()=>t(n))}}function yJ(e){hn(e)?B3e(e):G3e(e)}function B3e(e){const t=e.component.scales;for(const n of le(t)){const i=H3e(e,n);if(t[n].setWithExplicit("domains",i),W3e(e,n),e.component.data.isFaceted){let s=e;for(;!ss(s)&&s.parent;)s=s.parent;if(s.component.resolve.scale[n]==="shared")for(const a of i.value)xl(a)&&(a.data=LM+a.data.replace(LM,""))}}}function G3e(e){for(const n of e.children)yJ(n);const t=e.component.scales;for(const n of le(t)){let i,r=null;for(const s of e.children){const o=s.component.scales[n];if(o){i===void 0?i=o.getWithExplicit("domains"):i=dc(i,o.getWithExplicit("domains"),"domains","scale",$M);const a=o.get("selectionExtent");r&&a&&r.param!==a.param&&he(MOe),r=a}}t[n].setWithExplicit("domains",i),r&&t[n].set("selectionExtent",r,!0)}}function z3e(e,t,n,i){if(e==="unaggregated"){const{valid:r,reason:s}=f6(t,n);if(!r){he(s);return}}else if(e===void 0&&i.useUnaggregatedDomain){const{valid:r}=f6(t,n);if(r)return"unaggregated"}return e}function H3e(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:i}=e,r=z3e(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return r!==e.scaleDomain(t)&&(e.specifiedScales[t]={...e.specifiedScales[t],domain:r}),t==="x"&&jn(i.x2)?jn(i.x)?dc(Eu(n,r,e,"x"),Eu(n,r,e,"x2"),"domain","scale",$M):Eu(n,r,e,"x2"):t==="y"&&jn(i.y2)?jn(i.y)?dc(Eu(n,r,e,"y"),Eu(n,r,e,"y2"),"domain","scale",$M):Eu(n,r,e,"y2"):Eu(n,r,e,t)}function V3e(e,t,n){return e.map(i=>({signal:`{data: ${CR(i,{timeUnit:n,type:t})}}`}))}function lD(e,t,n){const i=si(n)?.unit;return t==="temporal"||i?V3e(e,t,i):[e]}function Eu(e,t,n,i){const{encoding:r,markDef:s,mark:o,config:a,stack:l}=n,u=jn(r[i]),{type:c}=u,d=u.timeUnit,h=OBe({invalid:Ma("invalid",s,a),isPath:Ic(o)});if(iNe(t)){const m=Eu(e,void 0,n,i),C=lD(t.unionWith,c,d);return la([...C,...m.value])}else{if(Ie(t))return la([t]);if(t&&t!=="unaggregated"&&!dQ(t))return la(lD(t,c,d))}if(l&&i===l.fieldChannel){if(l.offset==="normalize")return Kr([[0,1]]);const m=n.requestDataName(h);return Kr([{data:m,field:n.vgField(i,{suffix:"start"})},{data:m,field:n.vgField(i,{suffix:"end"})}])}const p=Ua(i)&&fe(u)?U3e(n,i,e):void 0;if(qa(u)){const m=lD([u.datum],c,d);return Kr(m)}const g=u;if(t==="unaggregated"){const{field:m}=u;return Kr([{data:n.requestDataName(h),field:ye({field:m,aggregate:"min"})},{data:n.requestDataName(h),field:ye({field:m,aggregate:"max"})}])}else if(Qt(g.bin)){if(oi(e))return Kr(e==="bin-ordinal"?[]:[{data:d0(p)?n.requestDataName(h):n.requestDataName(fn.Raw),field:n.vgField(i,kC(g,i)?{binSuffix:"range"}:{}),sort:p===!0||!be(p)?{field:n.vgField(i,{}),op:"min"}:p}]);{const{bin:m}=g;if(Qt(m)){const C=$L(n,g.field,m);return Kr([new Jn(()=>{const y=n.getSignalName(C);return`[${y}.start, ${y}.stop]`})])}else return Kr([{data:n.requestDataName(h),field:n.vgField(i,{})}])}}else if(g.timeUnit&&ht(["time","utc"],e)){const m=r[Wa(i)];if(AQ(g,m,s,a)){const C=n.requestDataName(h),y=cc({fieldDef:g,fieldDef2:m,markDef:s,config:a}),b=f0(o)&&y!==.5&&Tn(i);return Kr([{data:C,field:n.vgField(i,b?{suffix:RR}:{})},{data:C,field:n.vgField(i,{suffix:b?ER:"end"})}])}}return Kr(p?[{data:d0(p)?n.requestDataName(h):n.requestDataName(fn.Raw),field:n.vgField(i),sort:p}]:[{data:n.requestDataName(h),field:n.vgField(i)}])}function uD(e,t){const{op:n,field:i,order:r}=e;return{op:n??(t?"sum":pR),...i?{field:Us(i)}:{},...r?{order:r}:{}}}function W3e(e,t){const n=e.component.scales[t],i=e.specifiedScales[t].domain,r=e.fieldDef(t)?.bin,s=dQ(i)?i:void 0,o=Dh(r)&&oR(r.extent)?r.extent:void 0;(s||o)&&n.set("selectionExtent",s??o,!0)}function U3e(e,t,n){if(!oi(n))return;const i=e.fieldDef(t),r=i.sort;if(EQ(r))return{op:"min",field:_p(i,t),order:"ascending"};const{stack:s}=e,o=s?new Set([...s.groupbyFields,...s.stackBy.map(a=>a.fieldDef.field)]):void 0;if(Pl(r)){const a=s&&!o.has(r.field);return uD(r,a)}else if(ONe(r)){const{encoding:a,order:l}=r,u=e.fieldDef(a),{aggregate:c,field:d}=u,h=s&&!o.has(d);if(Gl(c)||Tc(c))return uD({field:ye(u),order:l},h);if(GO(c)||!c)return uD({op:c,field:d,order:l},h)}else{if(r==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(ht(["ascending",void 0],r))return!0}}function f6(e,t){const{aggregate:n,type:i}=e;return n?Re(n)&&!pOe.has(n)?{valid:!1,reason:oLe(n)}:i==="quantitative"&&t==="log"?{valid:!1,reason:aLe(e)}:{valid:!0}:{valid:!1,reason:sLe(e)}}function $M(e,t,n,i){return e.explicit&&t.explicit&&he(hLe(n,i,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function q3e(e){const t=ga(e.map(o=>{if(xl(o)){const{sort:a,...l}=o;return l}return o}),gt),n=ga(e.map(o=>{if(xl(o)){const a=o.sort;return a!==void 0&&!d0(a)&&("op"in a&&a.op==="count"&&delete a.field,a.order==="ascending"&&delete a.order),a}}).filter(o=>o!==void 0),gt);if(t.length===0)return;if(t.length===1){const o=e[0];if(xl(o)&&n.length>0){let a=n[0];if(n.length>1){he(S5);const l=n.filter(u=>be(u)&&"op"in u&&u.op!=="min");n.every(u=>be(u)&&"op"in u)&&l.length===1?a=l[0]:a=!0}else if(be(a)&&"field"in a){const l=a.field;o.field===l&&(a=a.order?{order:a.order}:!0)}return{...o,sort:a}}return o}const i=ga(n.map(o=>d0(o)||!("op"in o)||Re(o.op)&&Ae(cOe,o.op)?o:(he(pLe(o)),!0)),gt);let r;i.length===1?r=i[0]:i.length>1&&(he(S5),r=!0);const s=ga(e.map(o=>xl(o)?o.data:null),o=>o);return s.length===1&&s[0]!==null?{data:s[0],fields:t.map(a=>a.field),...r?{sort:r}:{}}:{fields:t,...r?{sort:r}:{}}}function HL(e){if(xl(e)&&Re(e.field))return e.field;if(gOe(e)){let t;for(const n of e.fields)if(xl(n)&&Re(n.field)){if(!t)t=n.field;else if(t!==n.field)return he(gLe),t}return he(mLe),t}else if(mOe(e)){he(vLe);const t=e.fields[0];return Re(t)?t:void 0}}function PR(e,t){const i=e.component.scales[t].get("domains").map(r=>(xl(r)&&(r.data=e.lookupDataSource(r.data)),r));return q3e(i)}function wJ(e){return yg(e)||VL(e)?e.children.reduce((t,n)=>t.concat(wJ(n)),p6(e)):p6(e)}function p6(e){return le(e.component.scales).reduce((t,n)=>{const i=e.component.scales[n];if(i.merged)return t;const r=i.combine(),{name:s,type:o,selectionExtent:a,domains:l,range:u,reverse:c,...d}=r,h=j3e(r.range,s,n,e),p=PR(e,n),g=a?qBe(e,a,i,p):null;return t.push({name:s,type:o,...p?{domain:p}:{},...g?{domainRaw:g}:{},range:h,...c!==void 0?{reverse:c}:{},...d}),t},[])}function j3e(e,t,n,i){if(Tn(n)){if(kh(e))return{step:{signal:`${t}_step`}}}else if(be(e)&&xl(e))return{...e,data:i.lookupDataSource(e.data)};return e}class bJ extends ou{constructor(t,n){super({},{name:t}),this.merged=!1,this.setWithExplicit("type",n)}domainHasZero(){const t=this.get("type");if(ht([gi.LOG,gi.TIME,gi.UTC],t))return"definitely-not";const n=this.get("zero");if(n===!0||n===void 0&&ht([gi.LINEAR,gi.SQRT,gi.POW],t))return"definitely";const i=this.get("domains");if(i.length>0){let r=!1,s=!1,o=!1;for(const a of i){if(ne(a)){const l=a[0],u=a[a.length-1];if(kt(l)&&kt(u))if(l<=0&&u>=0){r=!0;continue}else{s=!0;continue}}o=!0}if(r)return"definitely";if(s&&!o)return"definitely-not"}return"maybe"}}const K3e=["range","scheme"];function Y3e(e){const t=e.component.scales;for(const n of BO){const i=t[n];if(!i)continue;const r=X3e(n,e);i.setWithExplicit("range",r)}}function g6(e,t){const n=e.fieldDef(t);if(n?.bin){const{bin:i,field:r}=n,s=Nr(t),o=e.getName(s);if(be(i)&&i.binned&&i.step!==void 0)return new Jn(()=>{const a=e.scaleName(t),l=`(domain("${a}")[1] - domain("${a}")[0]) / ${i.step}`;return`${e.getSignalName(o)} / (${l})`});if(Qt(i)){const a=$L(e,r,i);return new Jn(()=>{const l=e.getSignalName(a),u=`(${l}.stop - ${l}.start) / ${l}.step`;return`${e.getSignalName(o)} / (${u})`})}}}function X3e(e,t){const n=t.specifiedScales[e],{size:i}=t,s=t.getScaleComponent(e).get("type");for(const d of K3e)if(n[d]!==void 0){const h=CM(s,d),p=hQ(e,d);if(!h)he(UX(s,d,e));else if(p)he(p);else switch(d){case"range":{const g=n.range;if(ne(g)){if(Tn(e))return la(g.map(m=>{if(m==="width"||m==="height"){const C=t.getName(m),y=t.getSignalName.bind(t);return Jn.fromName(y,C)}return m}))}else if(be(g))return la({data:t.requestDataName(fn.Main),field:g.field,sort:{op:"min",field:t.vgField(e)}});return la(g)}case"scheme":return la(Q3e(n[d]))}}const o=e===ln||e==="xOffset"?"width":"height",a=i[o];if(Ia(a)){if(Tn(e))if(oi(s)){const d=xJ(a,t,e);if(d)return la({step:d})}else he(qX(o));else if(SC(e)){const d=e===Fc?"x":"y";if(t.getScaleComponent(d).get("type")==="band"){const g=RJ(a,s);if(g)return la(g)}}}const{rangeMin:l,rangeMax:u}=n,c=Z3e(e,t);return(l!==void 0||u!==void 0)&&CM(s,"rangeMin")&&ne(c)&&c.length===2?la([l??c[0],u??c[1]]):Kr(c)}function Q3e(e){return nNe(e)?{scheme:e.name,...Pr(e,["name"])}:{scheme:e}}function SJ(e,t,n,{center:i}={}){const r=Nr(e),s=t.getName(r),o=t.getSignalName.bind(t);return e===li&&ko(n)?i?[Jn.fromName(a=>`${o(a)}/2`,s),Jn.fromName(a=>`-${o(a)}/2`,s)]:[Jn.fromName(o,s),0]:i?[Jn.fromName(a=>`-${o(a)}/2`,s),Jn.fromName(a=>`${o(a)}/2`,s)]:[0,Jn.fromName(o,s)]}function Z3e(e,t){const{size:n,config:i,mark:r,encoding:s}=t,{type:o}=jn(s[e]),l=t.getScaleComponent(e).get("type"),{domain:u,domainMid:c}=t.specifiedScales[e];switch(e){case ln:case li:{if(ht(["point","band"],l)){const d=EJ(e,n,i.view);if(Ia(d))return{step:xJ(d,t,e)}}return SJ(e,t,l)}case Fc:case fg:return J3e(e,t,l);case nu:{const d=nze(r,i),h=ize(r,n,t,i);return Ap(l)?tze(d,h,eze(l,i,u,e)):[d,h]}case Ys:return[0,Math.PI*2];case Fh:return[0,360];case Ho:return[0,new Jn(()=>{const d=t.getSignalName(ss(t.parent)?"child_width":"width"),h=t.getSignalName(ss(t.parent)?"child_height":"height");return`min(${d},${h})/2`})];case Ac:return{step:1e3/i.scale.framesPerSecond};case Pc:return[i.scale.minStrokeWidth,i.scale.maxStrokeWidth];case Mc:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case Lr:return"symbol";case Or:case Ha:case Va:return l==="ordinal"?o==="nominal"?"category":"ordinal":c!==void 0?"diverging":r==="rect"||r==="geoshape"?"heatmap":"ramp";case iu:case Dc:case kc:return[i.scale.minOpacity,i.scale.maxOpacity]}}function xJ(e,t,n){const{encoding:i}=t,r=t.getScaleComponent(n),s=OO(n),o=i[s];if(sZ({step:e,offsetIsDiscrete:Xe(o)&&oQ(o.type)})==="offset"&&BQ(i,s)){const l=t.getScaleComponent(s);let c=`domain('${t.scaleName(s)}').length`;if(l.get("type")==="band"){const h=l.get("paddingInner")??l.get("padding")??0,p=l.get("paddingOuter")??l.get("padding")??0;c=`bandspace(${c}, ${h}, ${p})`}const d=r.get("paddingInner")??r.get("padding");return{signal:`${e.step} * ${c} / (1-${wOe(d)})`}}else return e.step}function RJ(e,t){if(sZ({step:e,offsetIsDiscrete:oi(t)})==="offset")return{step:e.step}}function J3e(e,t,n){const i=e===Fc?"x":"y",r=t.getScaleComponent(i);if(!r)return SJ(i,t,n,{center:!0});const s=r.get("type"),o=t.scaleName(i),{markDef:a,config:l}=t;if(s==="band"){const u=EJ(i,t.size,t.config.view);if(Ia(u)){const c=RJ(u,n);if(c)return c}return[0,{signal:`bandwidth('${o}')`}]}else{const u=t.encoding[i];if(fe(u)&&u.timeUnit){const c=nQ(u.timeUnit,g=>`scale('${o}', ${g})`),d=t.config.scale.bandWithNestedOffsetPaddingInner,h=cc({fieldDef:u,markDef:a,config:l})-.5,p=h!==0?` + ${h}`:"";if(d){const g=Ie(d)?`${d.signal}/2`+p:`${d/2+h}`,m=Ie(d)?`(1 - ${d.signal}/2)`+p:`${1-d/2+h}`;return[{signal:`${g} * (${c})`},{signal:`${m} * (${c})`}]}return[0,{signal:c}]}return fX(`Cannot use ${e} scale if ${i} scale is not discrete.`)}}function EJ(e,t,n){const i=e===ln?"width":"height",r=t[i];return r||YS(n,i)}function eze(e,t,n,i){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&ne(n)?n.length+1:(he(FLe(i)),3)}}function tze(e,t,n){const i=()=>{const r=yo(t),s=yo(e),o=`(${r} - ${s}) / (${n} - 1)`;return`sequence(${s}, ${r} + ${o}, ${o})`};return Ie(t)?new Jn(i):{signal:i()}}function nze(e,t){switch(e){case"bar":case"tick":return t.scale.minBandSize;case"line":case"trail":case"rule":return t.scale.minStrokeWidth;case"text":return t.scale.minFontSize;case"point":case"square":case"circle":return t.scale.minSize}throw new Error(aR("size",e))}const m6=.95;function ize(e,t,n,i){const r={x:g6(n,"x"),y:g6(n,"y")};switch(e){case"bar":case"tick":{if(i.scale.maxBandSize!==void 0)return i.scale.maxBandSize;const s=v6(t,r,i.view);return kt(s)?s-1:new Jn(()=>`${s.signal} - 1`)}case"line":case"trail":case"rule":return i.scale.maxStrokeWidth;case"text":return i.scale.maxFontSize;case"point":case"square":case"circle":{if(i.scale.maxSize)return i.scale.maxSize;const s=v6(t,r,i.view);return kt(s)?Math.pow(m6*s,2):new Jn(()=>`pow(${m6} * ${s.signal}, 2)`)}}throw new Error(aR("size",e))}function v6(e,t,n){const i=Ia(e.width)?e.width.step:SM(n,"width"),r=Ia(e.height)?e.height.step:SM(n,"height");return t.x||t.y?new Jn(()=>`min(${[t.x?t.x.signal:i,t.y?t.y.signal:r].join(", ")})`):Math.min(i,r)}function FJ(e,t){hn(e)?rze(e,t):DJ(e,t)}function rze(e,t){const n=e.component.scales,{config:i,encoding:r,markDef:s,specifiedScales:o}=e;for(const a of le(n)){const l=o[a],u=n[a],c=e.getScaleComponent(a),d=jn(r[a]),h=l[t],p=c.get("type"),g=c.get("padding"),m=c.get("paddingInner"),C=CM(p,t),y=hQ(a,t);if(h!==void 0&&(C?y&&he(y):he(UX(p,t,a))),C&&y===void 0)if(h!==void 0){const b=d.timeUnit,S=d.type;switch(t){case"domainMax":case"domainMin":Ph(l[t])||S==="temporal"||b?u.set(t,{signal:CR(l[t],{type:S,timeUnit:b})},!0):u.set(t,l[t],!0);break;default:u.copyKeyFromObject(t,l)}}else{const b=ue(C6,t)?C6[t]({model:e,channel:a,fieldOrDatumDef:d,scaleType:p,scalePadding:g,scalePaddingInner:m,domain:l.domain,domainMin:l.domainMin,domainMax:l.domainMax,markDef:s,config:i,hasNestedOffsetScale:GQ(r,a),hasSecondaryRangeChannel:!!r[Wa(a)]}):i.scale[t];b!==void 0&&u.set(t,b,!1)}}}const C6={bins:({model:e,fieldOrDatumDef:t})=>fe(t)?sze(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>oze(e,t.type),nice:({scaleType:e,channel:t,domain:n,domainMin:i,domainMax:r,fieldOrDatumDef:s})=>aze(e,t,n,i,r,s),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:i,config:r})=>lze(e,t,r.scale,n,i,r.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,scaleType:i,config:r,hasNestedOffsetScale:s})=>uze(e,t,n.type,i,r.scale,s),paddingOuter:({scalePadding:e,channel:t,scaleType:n,scalePaddingInner:i,config:r,hasNestedOffsetScale:s})=>cze(e,t,n,i,r.scale,s),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:i})=>{const r=fe(e)?e.sort:void 0;return dze(t,r,n,i.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:i,scaleType:r,config:s,hasSecondaryRangeChannel:o})=>hze(e,t,n,i,r,s.scale,o)};function AJ(e){hn(e)?Y3e(e):DJ(e,"range")}function DJ(e,t){const n=e.component.scales;for(const i of e.children)t==="range"?AJ(i):FJ(i,t);for(const i of le(n)){let r;for(const s of e.children){const o=s.component.scales[i];if(o){const a=o.getWithExplicit(t);r=dc(r,a,t,"scale",CZ((l,u)=>{switch(t){case"range":return l.step&&u.step?l.step-u.step:0}return 0}))}}n[i].setWithExplicit(t,r)}}function sze(e,t){const n=t.bin;if(Qt(n)){const i=$L(e,t.field,n);return new Jn(()=>e.getSignalName(i))}else if(fi(n)&&Dh(n)&&n.step!==void 0)return{step:n.step}}function oze(e,t){if(ht([Or,Ha,Va],e)&&t!=="nominal")return"hcl"}function aze(e,t,n,i,r,s){if(!(Mo(s)?.bin||ne(n)||r!=null||i!=null||ht([gi.TIME,gi.UTC],e)))return Tn(t)?!0:void 0}function lze(e,t,n,i,r,s){if(Tn(e)){if(ma(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:o,orient:a}=r;if(o==="bar"&&!(fe(i)&&(i.bin||i.timeUnit))&&(a==="vertical"&&e==="x"||a==="horizontal"&&e==="y"))return s.continuousBandSize}if(t===gi.POINT)return n.pointPadding}}function uze(e,t,n,i,r,s=!1){if(e===void 0){if(Tn(t)){const{bandPaddingInner:o,barBandPaddingInner:a,rectBandPaddingInner:l,tickBandPaddingInner:u,bandWithNestedOffsetPaddingInner:c}=r;return s?c:Mn(o,n==="bar"?a:n==="tick"?u:l)}else if(SC(t)&&i===gi.BAND)return r.offsetBandPaddingInner}}function cze(e,t,n,i,r,s=!1){if(e===void 0){if(Tn(t)){const{bandPaddingOuter:o,bandWithNestedOffsetPaddingOuter:a}=r;if(s)return a;if(n===gi.BAND)return Mn(o,Ie(i)?{signal:`${i.signal}/2`}:i/2)}else if(SC(t)){if(n===gi.POINT)return .5;if(n===gi.BAND)return r.offsetBandPaddingOuter}}}function dze(e,t,n,i){if(n==="x"&&i.xReverse!==void 0)return ko(e)&&t==="descending"?Ie(i.xReverse)?{signal:`!${i.xReverse.signal}`}:!i.xReverse:i.xReverse;if(ko(e)&&t==="descending")return!0}function hze(e,t,n,i,r,s,o){if(!!n&&n!=="unaggregated"&&ko(r)){if(ne(n)){const l=n[0],u=n[n.length-1];if(kt(l)&&l<=0&&kt(u)&&u>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!Ap(r))return!0;if(!(fe(t)&&t.bin)&&ht([...ru,...tOe],e)){const{orient:l,type:u}=i;return ht(["bar","area","line","trail"],u)&&(l==="horizontal"&&e==="y"||l==="vertical"&&e==="x")?!1:ht(["bar","area"],u)&&!o?!0:s?.zero}return!1}function fze(e,t,n,i,r=!1){const s=pze(t,n,i,r),{type:o}=e;return Ua(t)?o!==void 0?uNe(t,o)?fe(n)&&!lNe(o,n.type)?(he(cLe(o,s)),s):o:(he(uLe(t,o,s)),s):s:null}function pze(e,t,n,i){switch(t.type){case"nominal":case"ordinal":{if(Hf(e)||QA(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&he(ZA(e,"ordinal")),"ordinal";if(XA(e))return"band";if(Tn(e)||SC(e)){if(ht(["rect","bar","image","rule","tick"],n.type)||i)return"band"}else if(n.type==="arc"&&e in $O)return"band";const r=n[Nr(e)];return ah(r)||kp(t)&&t.axis?.tickBand?"band":"point"}case"temporal":return Hf(e)?"time":QA(e)==="discrete"?(he(ZA(e,"temporal")),"ordinal"):fe(t)&&t.timeUnit&&si(t.timeUnit).utc?"utc":XA(e)?"band":"time";case"quantitative":return Hf(e)?fe(t)&&Qt(t.bin)?"bin-ordinal":"linear":QA(e)==="discrete"?(he(ZA(e,"quantitative")),"ordinal"):XA(e)?"band":"linear";case"geojson":return}throw new Error(VX(t.type))}function gze(e,{ignoreRange:t}={}){kJ(e),yJ(e);for(const n of aNe)FJ(e,n);t||AJ(e)}function kJ(e){hn(e)?e.component.scales=mze(e):e.component.scales=Cze(e)}function mze(e){const{encoding:t,mark:n,markDef:i}=e,r={};for(const s of BO){const o=jn(t[s]);if(o&&n===gQ&&s===Lr&&o.type===pg)continue;let a=o&&o.scale;if(o&&a!==null&&a!==!1){a??(a={});const l=GQ(t,s),u=fze(a,s,o,i,l);r[s]=new bJ(e.scaleName(`${s}`,!0),{value:u,explicit:a.type===u})}}return r}const vze=CZ((e,t)=>R5(e)-R5(t));function Cze(e){var t;const n=e.component.scales={},i={},r=e.component.resolve;for(const s of e.children){kJ(s);for(const o of le(s.component.scales))if((t=r.scale)[o]??(t[o]=oJ(o,e)),r.scale[o]==="shared"){const a=i[o],l=s.component.scales[o].getWithExplicit("type");a?QLe(a.value,l.value)?i[o]=dc(a,l,"type","scale",vze):(r.scale[o]="independent",delete i[o]):i[o]=l}}for(const s of le(i)){const o=e.scaleName(s,!0),a=i[s];n[s]=new bJ(o,a);for(const l of e.children){const u=l.component.scales[s];u&&(l.renameScale(u.get("name"),o),u.merged=!0)}}return n}class cD{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function hn(e){return e?.type==="unit"}function ss(e){return e?.type==="facet"}function VL(e){return e?.type==="concat"}function yg(e){return e?.type==="layer"}class WL{constructor(t,n,i,r,s,o,a){this.type=n,this.parent=i,this.config=s,this.parent=i,this.config=s,this.view=pi(a),this.name=t.name??r,this.title=Pu(t.title)?{text:t.title}:t.title?pi(t.title):void 0,this.scaleNameMap=i?i.scaleNameMap:new cD,this.projectionNameMap=i?i.projectionNameMap:new cD,this.signalNameMap=i?i.signalNameMap:new cD,this.data=t.data,this.description=t.description,this.transforms=xBe(t.transform??[]),this.layout=n==="layer"||n==="unit"?{}:A$e(t,n,s),this.component={data:{sources:i?i.component.data.sources:[],outputNodes:i?i.component.data.outputNodes:{},outputNodeRefCounts:i?i.component.data.outputNodeRefCounts:{},isFaceted:gR(t)||i?.component.data.isFaceted&&t.data===void 0},layoutSize:new ou,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:{scale:{},axis:{},legend:{},...o?Ke(o):{}},selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){gze(this)}parseProjection(){mJ(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){dJ(this)}assembleEncodeFromView(t){const{style:n,...i}=t,r={};for(const s of le(i)){const o=i[s];o!==void 0&&(r[s]=en(o))}return r}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=en(this.description)),this.type==="unit"||this.type==="layer")?{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height"),...n}:Ht(n)?void 0:n}assembleLayout(){if(!this.layout)return;const{spacing:t,...n}=this.layout,{component:i,config:r}=this,s=$Ge(i.layoutHeaders,r);return{padding:t,...this.assembleDefaultLayout(),...n,...s?{titleBand:s}:{}}}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const i of Is)t[i].title&&n.push(TGe(this,i));for(const i of _L)n=n.concat(IGe(this,i));return n}assembleAxes(){return yGe(this.component.axes,this.config)}assembleLegends(){return fJ(this)}assembleProjections(){return a3e(this)}assembleTitle(){const{encoding:t,...n}=this.title??{},i={..._X(this.config.title).nonMarkTitleProperties,...n,...t?{encode:{update:t}}:{}};if(i.text)return ht(["unit","layer"],this.type)?ht(["middle",void 0],i.anchor)&&(i.frame??(i.frame="group")):i.anchor??(i.anchor="start"),Ht(i)?void 0:i}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const i=this.assembleLayout();i&&(n.layout=i),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const r=!this.parent||ss(this.parent)?wJ(this):[];r.length>0&&(n.scales=r);const s=this.assembleAxes();s.length>0&&(n.axes=s);const o=this.assembleLegends();return o.length>0&&(n.legends=o),n}getName(t){return an((this.name?`${this.name}_`:"")+t)}getDataName(t){return this.getName(fn[t].toLowerCase())}requestDataName(t){const n=this.getDataName(t),i=this.component.data.outputNodeRefCounts;return i[n]=(i[n]||0)+1,n}getSizeSignalRef(t){if(ss(this.parent)){const n=rJ(t),i=rR(n),r=this.component.scales[i];if(r&&!r.merged){const s=r.get("type"),o=r.get("range");if(oi(s)&&kh(o)){const a=r.get("name"),l=PR(this,i),u=HL(l);if(u){const c=ye({aggregate:"distinct",field:u},{expr:"datum"});return{signal:iJ(a,r,c)}}else return he(HO(i)),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(FX(t)&&Ua(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getScaleType(t){const n=this.getScaleComponent(t);return n?n.get("type"):void 0}getSelectionComponent(t,n){let i=this.component.selection[t];if(!i&&this.parent&&(i=this.parent.getSelectionComponent(t,n)),!i)throw new Error(EOe(n));return i}hasAxisOrientSignalRef(){return this.component.axes.x?.some(t=>t.hasOrientSignalRef())||this.component.axes.y?.some(t=>t.hasOrientSignalRef())}}class PJ extends WL{vgField(t,n={}){const i=this.fieldDef(t);if(i)return ye(i,n)}reduceFieldDef(t,n){return n$e(this.getMapping(),(i,r,s)=>{const o=Mo(r);return o?t(i,o,s):i},n)}forEachFieldDef(t,n){mL(this.getMapping(),(i,r)=>{const s=Mo(i);s&&t(s,r)},n)}}class MR extends Gt{clone(){return new MR(null,Ke(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ke(n);const i=this.transform.as??[void 0,void 0];this.transform.as=[i[0]??"value",i[1]??"density"];const r=this.transform.resolve??"shared";this.transform.resolve=r}dependentFields(){return new Set([this.transform.density,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${gt(this.transform)}`}assemble(){const{density:t,...n}=this.transform,i={type:"kde",field:t,...n};return i.resolve=this.transform.resolve,i}}class TR extends Gt{clone(){return new TR(null,Ke(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ke(n)}dependentFields(){return new Set([this.transform.extent])}producedFields(){return new Set([])}hash(){return`ExtentTransform ${gt(this.transform)}`}assemble(){const{extent:t,param:n}=this.transform;return{type:"extent",field:t,signal:n}}}class IR extends Gt{clone(){return new IR(this.parent,Ke(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ke(n);const{flatten:i,as:r=[]}=this.transform;this.transform.as=i.map((s,o)=>r[o]??s)}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${gt(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class _R extends Gt{clone(){return new _R(null,Ke(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ke(n);const i=this.transform.as??[void 0,void 0];this.transform.as=[i[0]??"key",i[1]??"value"]}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${gt(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class Uf extends Gt{clone(){return new Uf(null,Ke(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let i=0;for(const r of[[Wo,Vo],[qs,Uo]]){const s=r.map(o=>{const a=jn(n.encoding[o]);return fe(a)?a.field:qa(a)?{expr:`${a.datum}`}:Po(a)?{expr:`${a.value}`}:void 0});(s[0]||s[1])&&(t=new Uf(t,s,null,n.getName(`geojson_${i++}`)))}if(n.channelHasField(Lr)){const r=n.typedFieldDef(Lr);r.type===pg&&(t=new Uf(t,null,r.field,n.getName(`geojson_${i++}`)))}return t}constructor(t,n,i,r){super(t),this.fields=n,this.geojson=i,this.signal=r}dependentFields(){const t=(this.fields??[]).filter(Re);return new Set([...this.geojson?[this.geojson]:[],...t])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${gt(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],{type:"geojson",...this.fields?{fields:this.fields}:{},...this.geojson?{geojson:this.geojson}:{},signal:this.signal}]}}class g0 extends Gt{clone(){return new g0(null,this.projection,Ke(this.fields),Ke(this.as))}constructor(t,n,i,r){super(t),this.projection=n,this.fields=i,this.as=r}static parseAll(t,n){if(!n.projectionName())return t;for(const i of[[Wo,Vo],[qs,Uo]]){const r=i.map(o=>{const a=jn(n.encoding[o]);return fe(a)?a.field:qa(a)?{expr:`${a.datum}`}:Po(a)?{expr:`${a.value}`}:void 0}),s=i[0]===qs?"2":"";(r[0]||r[1])&&(t=new g0(t,n.projectionName(),r,[n.getName(`x${s}`),n.getName(`y${s}`)]))}return t}dependentFields(){return new Set(this.fields.filter(Re))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${gt(this.fields)} ${gt(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class Od extends Gt{clone(){return new Od(null,Ke(this.transform))}constructor(t,n){super(t),this.transform=n}dependentFields(){return new Set([this.transform.impute,this.transform.key,...this.transform.groupby??[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:i,step:r}=t;return{signal:`sequence(${[n,i,...r?[r]:[]].join(",")})`}}static makeFromTransform(t,n){return new Od(t,n)}static makeFromEncoding(t,n){const i=n.encoding,r=i.x,s=i.y;if(fe(r)&&fe(s)){const o=r.impute?r:s.impute?s:void 0;if(o===void 0)return;const a=r.impute?s:s.impute?r:void 0,{method:l,value:u,frame:c,keyvals:d}=o.impute,h=VQ(n.mark,i);return new Od(t,{impute:o.field,key:a.field,...l?{method:l}:{},...u!==void 0?{value:u}:{},...c?{frame:c}:{},...d!==void 0?{keyvals:d}:{},...h.length?{groupby:h}:{}})}return null}hash(){return`Impute ${gt(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:i,method:r,groupby:s,value:o,frame:a=[null,null]}=this.transform,l={type:"impute",field:t,key:n,...i?{keyvals:rBe(i)?this.processSequence(i):i}:{},method:"value",...s?{groupby:s}:{},value:!r||r==="value"?o:null};if(r&&r!=="value"){const u={type:"window",as:[`imputed_${t}_value`],ops:[r],fields:[t],frame:a,ignorePeers:!1,...s?{groupby:s}:{}},c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[l,u,c]}else return[l]}}class OR extends Gt{clone(){return new OR(null,Ke(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ke(n);const i=this.transform.as??[void 0,void 0];this.transform.as=[i[0]??n.on,i[1]??n.loess]}dependentFields(){return new Set([this.transform.loess,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${gt(this.transform)}`}assemble(){const{loess:t,on:n,...i}=this.transform;return{type:"loess",x:n,y:t,...i}}}class m0 extends Gt{clone(){return new m0(null,Ke(this.transform),this.secondary)}constructor(t,n,i){super(t),this.transform=n,this.secondary=i}static make(t,n,i,r){const s=n.component.data.sources,{from:o}=i;let a=null;if(sBe(o)){let l=IJ(o.data,s);l||(l=new dh(o.data),s.push(l));const u=n.getName(`lookup_${r}`);a=new Mr(l,u,fn.Lookup,n.component.data.outputNodeRefCounts),n.component.data.outputNodes[u]=a}else if(oBe(o)){const l=o.param;i={as:l,...i};let u;try{u=n.getSelectionComponent(an(l),l)}catch{throw new Error(kOe(l))}if(a=u.materialized,!a)throw new Error(POe(l))}return new m0(t,i,a.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?xe(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${gt({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t={values:this.transform.from.fields,...this.transform.as?{as:xe(this.transform.as)}:{}};else{let n=this.transform.as;Re(n)||(he(zOe),n="_lookup"),t={as:[n]}}return{type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup],...t,...this.transform.default?{default:this.transform.default}:{}}}}class LR extends Gt{clone(){return new LR(null,Ke(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ke(n);const i=this.transform.as??[void 0,void 0];this.transform.as=[i[0]??"prob",i[1]??"value"]}dependentFields(){return new Set([this.transform.quantile,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${gt(this.transform)}`}assemble(){const{quantile:t,...n}=this.transform;return{type:"quantile",field:t,...n}}}class NR extends Gt{clone(){return new NR(null,Ke(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ke(n);const i=this.transform.as??[void 0,void 0];this.transform.as=[i[0]??n.on,i[1]??n.regression]}dependentFields(){return new Set([this.transform.regression,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${gt(this.transform)}`}assemble(){const{regression:t,on:n,...i}=this.transform;return{type:"regression",x:n,y:t,...i}}}class $R extends Gt{clone(){return new $R(null,Ke(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=ga((this.transform.groupby??[]).concat(t),n=>n)}producedFields(){}dependentFields(){return new Set([this.transform.pivot,this.transform.value,...this.transform.groupby??[]])}hash(){return`PivotTransform ${gt(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:i,limit:r,op:s}=this.transform;return{type:"pivot",field:t,value:n,...r!==void 0?{limit:r}:{},...s!==void 0?{op:s}:{},...i!==void 0?{groupby:i}:{}}}}class BR extends Gt{clone(){return new BR(null,Ke(this.transform))}constructor(t,n){super(t),this.transform=n}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${gt(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function MJ(e){let t=0;function n(i,r){if(i instanceof dh&&!i.isGenerator&&!Mp(i.data)&&(e.push(r),r={name:null,source:r.name,transform:[]}),i instanceof Oi&&(i.parent instanceof dh&&!r.source?(r.format={...r.format,parse:i.assembleFormatParse()},r.transform.push(...i.assembleTransforms(!0))):r.transform.push(...i.assembleTransforms())),i instanceof vg){r.name||(r.name=`data_${t++}`),!r.source||r.transform.length>0?(e.push(r),i.data=r.name):i.data=r.source,e.push(...i.assemble());return}switch((i instanceof TC||i instanceof IC||i instanceof Lp||i instanceof mg||i instanceof Ip||i instanceof g0||i instanceof Ro||i instanceof m0||i instanceof Cg||i instanceof _h||i instanceof _R||i instanceof IR||i instanceof MR||i instanceof OR||i instanceof LR||i instanceof NR||i instanceof hc||i instanceof BR||i instanceof $R||i instanceof TR)&&r.transform.push(i.assemble()),(i instanceof xa||i instanceof ba||i instanceof Od||i instanceof Tl||i instanceof Uf)&&r.transform.push(...i.assemble()),i instanceof Mr&&(r.source&&r.transform.length===0?i.setSource(r.source):i.parent instanceof Mr?i.setSource(r.name):(r.name||(r.name=`data_${t++}`),i.setSource(r.name),i.numChildren()===1&&(e.push(r),r={name:null,source:r.name,transform:[]}))),i.numChildren()){case 0:i instanceof Mr&&(!r.source||r.transform.length>0)&&e.push(r);break;case 1:n(i.children[0],r);break;default:{r.name||(r.name=`data_${t++}`);let s=r.name;!r.source||r.transform.length>0?e.push(r):s=r.source;for(const o of i.children)n(o,{name:null,source:s,transform:[]});break}}}return n}function yze(e){const t=[],n=MJ(t);for(const i of e.children)n(i,{source:e.name,name:null,transform:[]});return t}function wze(e,t){const n=[],i=MJ(n);let r=0;for(const o of e.sources){o.hasName()||(o.dataName=`source_${r++}`);const a=o.assemble();i(o,a)}for(const o of n)o.transform.length===0&&delete o.transform;let s=0;for(const[o,a]of n.entries())(a.transform??[]).length===0&&!a.source&&n.splice(s++,0,n.splice(o,1)[0]);for(const o of n)for(const a of o.transform??[])a.type==="lookup"&&(a.from=e.outputNodes[a.from].getSource());for(const o of n)o.name in t&&(o.values=t[o.name]);return n}function bze(e){return e==="top"||e==="left"||Ie(e)?"header":"footer"}function Sze(e){for(const t of Is)xze(e,t);y6(e,"x"),y6(e,"y")}function xze(e,t){const{facet:n,config:i,child:r,component:s}=e;if(e.channelHasField(t)){const o=n[t],a=Op("title",null,i,t);let l=Vf(o,i,{allowDisabling:!0,includeDefault:a===void 0||!!a});r.component.layoutHeaders[t].title&&(l=ne(l)?l.join(", "):l,l+=` / ${r.component.layoutHeaders[t].title}`,r.component.layoutHeaders[t].title=null);const u=Op("labelOrient",o.header,i,t),c=o.header!==null?Mn(o.header?.labels,i.header.labels,!0):!1,d=ht(["bottom","right"],u)?"footer":"header";s.layoutHeaders[t]={title:o.header!==null?l:null,facetFieldDef:o,[d]:t==="facet"?[]:[TJ(e,t,c)]}}}function TJ(e,t,n){const i=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(i)?e.child.getSizeSignalRef(i):void 0,axes:[]}}function y6(e,t){const{child:n}=e;if(n.component.axes[t]){const{layoutHeaders:i,resolve:r}=e.component;if(r.axis[t]=NL(r,t),r.axis[t]==="shared"){const s=t==="x"?"column":"row",o=i[s];for(const a of n.component.axes[t]){const l=bze(a.get("orient"));o[l]??(o[l]=[TJ(e,s,!1)]);const u=rv(a,"main",e.config,{header:!0});u&&o[l][0].axes.push(u),a.mainExtracted=!0}}}}function Rze(e){UL(e),JS(e,"width"),JS(e,"height")}function Eze(e){UL(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";JS(e,t),JS(e,n)}function UL(e){for(const t of e.children)t.parseLayoutSize()}function JS(e,t){const n=rJ(t),i=rR(n),r=e.component.resolve,s=e.component.layoutSize;let o;for(const a of e.children){const l=a.component.layoutSize.getWithExplicit(n),u=r.scale[i]??oJ(i,e);if(u==="independent"&&l.value==="step"){o=void 0;break}if(o){if(u==="independent"&&o.value!==l.value){o=void 0;break}o=dc(o,l,n,"")}else o=l}if(o){for(const a of e.children)e.renameSignal(a.getName(n),e.getName(t)),a.component.layoutSize.set(n,"merged",!1);s.setWithExplicit(t,o)}else s.setWithExplicit(t,{explicit:!1,value:void 0})}function Fze(e){const{size:t,component:n}=e;for(const i of ru){const r=Nr(i);if(t[r]){const s=t[r];n.layoutSize.set(r,Ia(s)?"step":s,!0)}else{const s=Aze(e,r);n.layoutSize.set(r,s,!1)}}}function Aze(e,t){const n=t==="width"?"x":"y",i=e.config,r=e.getScaleComponent(n);if(r){const s=r.get("type"),o=r.get("range");if(oi(s)){const a=YS(i.view,t);return kh(o)||Ia(a)?"step":a}else return bM(i.view,t)}else{if(e.hasProjection||e.mark==="arc")return bM(i.view,t);{const s=YS(i.view,t);return Ia(s)?s.step:s}}}function BM(e,t,n){return ye(t,{suffix:`by_${ye(e)}`,...n})}class Fv extends PJ{constructor(t,n,i,r){super(t,"facet",n,i,r,t.resolve),this.child=XL(t.spec,this,this.getName("child"),void 0,r),this.children=[this.child],this.facet=this.initFacet(t.facet)}initFacet(t){if(!FC(t))return{facet:this.initFacetFieldDef(t,"facet")};const n=le(t),i={};for(const r of n){if(![Dl,kl].includes(r)){he(aR(r,"facet"));break}const s=t[r];if(s.field===void 0){he(mM(s,r));break}i[r]=this.initFacetFieldDef(s,r)}return i}initFacetFieldDef(t,n){const i=gL(t,n);return i.header?i.header=pi(i.header):i.header===null&&(i.header=null),i}channelHasField(t){return ue(this.facet,t)}fieldDef(t){return this.facet[t]}parseData(){this.component.data=GR(this),this.child.parseData()}parseLayoutSize(){UL(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection,Object.values(this.component.selection).some(t=>Sa(t))&&WO(VO)}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),Sze(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){const t={};for(const n of Is)for(const i of OL){const r=this.component.layoutHeaders[n],s=r[i],{facetFieldDef:o}=r;if(o){const a=Op("titleOrient",o.header,this.config,n);if(["right","bottom"].includes(a)){const l=DR(n,a);t.titleAnchor??(t.titleAnchor={}),t.titleAnchor[l]="end"}}if(s?.[0]){const a=n==="row"?"height":"width",l=i==="header"?"headerBand":"footerBand";n!=="facet"&&!this.child.component.layoutSize.get(a)&&(t[l]??(t[l]={}),t[l][n]=.5),r.title&&(t.offset??(t.offset={}),t.offset[n==="row"?"rowTitle":"columnTitle"]=10)}}return t}assembleDefaultLayout(){const{column:t,row:n}=this.facet,i=t?this.columnDistinctSignal():n?1:void 0;let r="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(r="none"),{...this.getHeaderLayoutMixins(),...i?{columns:i}:{},bounds:"full",align:r}}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof Fv))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroupStyle(){}assembleGroup(t){return this.parent&&this.parent instanceof Fv?{...this.channelHasField("column")?{encode:{update:{columns:{field:ye(this.facet.column,{prefix:"distinct"})}}}}:{},...super.assembleGroup(t)}:super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],i=[];if(this.child instanceof Fv){if(this.child.channelHasField("column")){const r=ye(this.child.facet.column);t.push(r),n.push("distinct"),i.push(`distinct_${r}`)}}else for(const r of ru){const s=this.child.component.scales[r];if(s&&!s.merged){const o=s.get("type"),a=s.get("range");if(oi(o)&&kh(a)){const l=PR(this.child,r),u=HL(l);u?(t.push(u),n.push("distinct"),i.push(`distinct_${u}`)):he(HO(r))}}}return{fields:t,ops:n,as:i}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:i,column:r}=this.facet,{fields:s,ops:o,as:a}=this.getCardinalityAggregateForChild(),l=[];for(const c of Is){const d=this.facet[c];if(d){l.push(ye(d));const{bin:h,sort:p}=d;if(Qt(h)&&l.push(ye(d,{binSuffix:"end"})),Pl(p)){const{field:g,op:m=pR}=p,C=BM(d,p);i&&r?(s.push(C),o.push("max"),a.push(C)):(s.push(g),o.push(m),a.push(C))}else if(ne(p)){const g=_p(d,c);s.push(g),o.push("max"),a.push(g)}}}const u=!!i&&!!r;return{name:t,data:n,groupby:l,...u||s.length>0?{aggregate:{...u?{cross:u}:{},...s.length?{fields:s,ops:o,as:a}:{}}}:{}}}facetSortFields(t){const{facet:n}=this,i=n[t];return i?Pl(i.sort)?[BM(i,i.sort,{expr:"datum"})]:ne(i.sort)?[_p(i,t,{expr:"datum"})]:[ye(i,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,i=n[t];if(i){const{sort:r}=i;return[(Pl(r)?r.order:!ne(r)&&r)||"ascending"]}return[]}assembleLabelTitle(){const{facet:t,config:n}=this;if(t.facet)return TM(t.facet,"facet",n);const i={row:["top","bottom"],column:["left","right"]};for(const r of _L)if(t[r]){const s=Op("labelOrient",t[r]?.header,n,r);if(i[r].includes(s))return TM(t[r],r,n)}}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,i=yze(n),r=t.assembleGroupEncodeEntry(!1),s=this.assembleLabelTitle()||t.assembleTitle(),o=t.assembleGroupStyle();return[{name:this.getName("cell"),type:"group",...s?{title:s}:{},...o?{style:o}:{},from:{facet:this.assembleFacet()},sort:{field:Is.map(l=>this.facetSortFields(l)).flat(),order:Is.map(l=>this.facetSortOrder(l)).flat()},...i.length>0?{data:i}:{},...r?{encode:{update:r}}:{},...t.assembleGroup(HBe(this,[]))}]}getMapping(){return this.facet}}function Dze(e,t){const{row:n,column:i}=t;if(n&&i){let r=null;for(const s of[n,i])if(Pl(s.sort)){const{field:o,op:a=pR}=s.sort;e=r=new _h(e,{joinaggregate:[{op:a,field:o,as:BM(s,s.sort,{forAs:!0})}],groupby:[ye(s)]})}return r}return null}function IJ(e,t){for(const n of t){const i=n.data;if(e.name&&n.hasName()&&e.name!==n.dataName)continue;const r=e.format?.mesh,s=i.format?.feature;if(r&&s)continue;const o=e.format?.feature;if((o||s)&&o!==s)continue;const a=i.format?.mesh;if(!((r||a)&&r!==a)){if(p0(e)&&p0(i)){if(ts(e.values,i.values))return n}else if(Mp(e)&&Mp(i)){if(e.url===i.url)return n}else if(yZ(e)&&e.name===n.dataName)return n}}return null}function kze(e,t){if(e.data||!e.parent){if(e.data===null){const i=new dh({values:[]});return t.push(i),i}const n=IJ(e.data,t);if(n)return Yu(e.data)||(n.data.format=pX({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const i=new dh(e.data);return t.push(i),i}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function Pze(e,t,n){let i=0;for(const r of t.transforms){let s,o;if(mBe(r))o=e=new Ip(e,r),s="derived";else if(AL(r)){const a=w3e(r);o=e=Oi.makeWithAncestors(e,{},a,n)??e,e=new mg(e,t,r.filter)}else if(pZ(r))o=e=xa.makeFromTransform(e,r,t),s="number";else if(CBe(r))s="date",n.getWithExplicit(r.field).value===void 0&&(e=new Oi(e,{[r.field]:s}),n.set(r.field,s,!1)),o=e=ba.makeFromTransform(e,r);else if(yBe(r))o=e=Ro.makeFromTransform(e,r),s="number",IL(t)&&(e=new hc(e));else if(fZ(r))o=e=m0.make(e,t,r,i++),s="derived";else if(fBe(r))o=e=new Cg(e,r),s="number";else if(pBe(r))o=e=new _h(e,r),s="number";else if(wBe(r))o=e=Tl.makeFromTransform(e,r),s="derived";else if(bBe(r))o=e=new _R(e,r),s="derived";else if(SBe(r))o=e=new TR(e,r),s="derived";else if(gBe(r))o=e=new IR(e,r),s="derived";else if(aBe(r))o=e=new $R(e,r),s="derived";else if(hBe(r))e=new BR(e,r);else if(vBe(r))o=e=Od.makeFromTransform(e,r),s="derived";else if(lBe(r))o=e=new MR(e,r),s="derived";else if(uBe(r))o=e=new LR(e,r),s="derived";else if(cBe(r))o=e=new NR(e,r),s="derived";else if(dBe(r))o=e=new OR(e,r),s="derived";else{he(GOe(r));continue}if(o&&s!==void 0)for(const a of o.producedFields()??[])n.set(a,s,!1)}return e}function GR(e){let t=kze(e,e.component.data.sources);const{outputNodes:n,outputNodeRefCounts:i}=e.component.data,r=e.data,o=!(r&&(Yu(r)||Mp(r)||p0(r)))&&e.parent?e.parent.component.data.ancestorParse.clone():new _Be;Yu(r)?(wZ(r)?t=new IC(t,r.sequence):DL(r)&&(t=new TC(t,r.graticule)),o.parseNothing=!0):r?.format?.parse===null&&(o.parseNothing=!0),t=Oi.makeExplicit(t,e,o)??t,t=new hc(t);const a=e.parent&&yg(e.parent);(hn(e)||ss(e))&&a&&(t=xa.makeFromEncoding(t,e)??t),e.transforms.length>0&&(t=Pze(t,e,o));const l=S3e(e),u=b3e(e);t=Oi.makeWithAncestors(t,{},{...l,...u},o)??t,hn(e)&&(t=Uf.parseAll(t,e),t=g0.parseAll(t,e)),(hn(e)||ss(e))&&(a||(t=xa.makeFromEncoding(t,e)??t),t=ba.makeFromEncoding(t,e)??t,t=Ip.parseAllForSortIndex(t,e));const c=t=bw(fn.Raw,e,t);if(hn(e)){const C=Ro.makeFromEncoding(t,e);C&&(t=C,IL(e)&&(t=new hc(t))),t=Od.makeFromEncoding(t,e)??t,t=Tl.makeFromEncoding(t,e)??t}let d,h;if(hn(e)){const{markDef:C,mark:y,config:b}=e,S=zt("invalid",C,b),{marks:x,scales:E}=h=SZ({invalid:S,isPath:Ic(y)});x!==E&&E==="include-invalid-values"&&(d=t=bw(fn.PreFilterInvalid,e,t)),x==="exclude-invalid-values"&&(t=Lp.make(t,e,h)??t)}const p=t=bw(fn.Main,e,t);let g;if(hn(e)&&h){const{marks:C,scales:y}=h;C==="include-invalid-values"&&y==="exclude-invalid-values"&&(t=Lp.make(t,e,h)??t,g=t=bw(fn.PostFilterInvalid,e,t))}hn(e)&&vGe(e,p);let m=null;if(ss(e)){const C=e.getName("facet");t=Dze(t,e.facet)??t,m=new vg(t,e,C,p.getSource()),n[C]=m}return{...e.component.data,outputNodes:n,outputNodeRefCounts:i,raw:c,main:p,facetRoot:m,ancestorParse:o,preFilterInvalid:d,postFilterInvalid:g}}function bw(e,t,n){const{outputNodes:i,outputNodeRefCounts:r}=t.component.data,s=t.getDataName(e),o=new Mr(n,s,e,r);return i[s]=o,o}class Mze extends WL{constructor(t,n,i,r){super(t,"concat",n,i,r,t.resolve),(t.resolve?.axis?.x==="shared"||t.resolve?.axis?.y==="shared")&&he(NOe),this.children=this.getChildren(t).map((s,o)=>XL(s,this,this.getName(`concat_${o}`),void 0,r))}parseData(){this.component.data=GR(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of le(t.component.selection))this.component.selection[n]=t.component.selection[n]}Object.values(this.component.selection).some(t=>Sa(t))&&WO(VO)}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return bR(t)?t.vconcat:EL(t)?t.hconcat:t.concat}parseLayoutSize(){Eze(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=LL(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),i=t.assembleGroupStyle(),r=t.assembleGroupEncodeEntry(!1);return{type:"group",name:t.getName("group"),...n?{title:n}:{},...i?{style:i}:{},...r?{encode:{update:r}}:{},...t.assembleGroup()}})}assembleGroupStyle(){}assembleDefaultLayout(){const t=this.layout.columns;return{...t!=null?{columns:t}:{},bounds:"full",align:"each"}}}function Tze(e){return e===!1||e===null}const Ize={disable:1,gridScale:1,scale:1,...NQ,labelExpr:1,encode:1},_J=le(Ize);class qL extends ou{constructor(t={},n={},i=!1){super(),this.explicit=t,this.implicit=n,this.mainExtracted=i}clone(){return new qL(Ke(this.explicit),Ke(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!Tze(this.get(t))}hasOrientSignalRef(){return Ie(this.explicit.orient)}}function _ze(e,t,n){const{encoding:i,config:r}=e,s=jn(i[t])??jn(i[Wa(t)]),o=e.axis(t)||{},{format:a,formatType:l}=o;if(lh(l))return{text:wo({fieldOrDatumDef:s,field:"datum.value",format:a,formatType:l,config:r}),...n};if(a===void 0&&l===void 0&&r.customFormatTypes){if(Dp(s)==="quantitative"){if(kp(s)&&s.stack==="normalize"&&r.normalizedNumberFormatType)return{text:wo({fieldOrDatumDef:s,field:"datum.value",format:r.normalizedNumberFormat,formatType:r.normalizedNumberFormatType,config:r}),...n};if(r.numberFormatType)return{text:wo({fieldOrDatumDef:s,field:"datum.value",format:r.numberFormat,formatType:r.numberFormatType,config:r}),...n}}if(Dp(s)==="temporal"&&r.timeFormatType&&fe(s)&&!s.timeUnit)return{text:wo({fieldOrDatumDef:s,field:"datum.value",format:r.timeFormat,formatType:r.timeFormatType,config:r}),...n}}return n}function Oze(e){return ru.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[Hze(n,e)]),t),{})}const Lze={bottom:"top",top:"bottom",left:"right",right:"left"};function Nze(e){const{axes:t,resolve:n}=e.component,i={top:0,bottom:0,right:0,left:0};for(const r of e.children){r.parseAxesAndHeaders();for(const s of le(r.component.axes))n.axis[s]=NL(e.component.resolve,s),n.axis[s]==="shared"&&(t[s]=$ze(t[s],r.component.axes[s]),t[s]||(n.axis[s]="independent",delete t[s]))}for(const r of ru){for(const s of e.children)if(s.component.axes[r]){if(n.axis[r]==="independent"){t[r]=(t[r]??[]).concat(s.component.axes[r]);for(const o of s.component.axes[r]){const{value:a,explicit:l}=o.getWithExplicit("orient");if(!Ie(a)){if(i[a]>0&&!l){const u=Lze[a];i[a]>i[u]&&o.set("orient",u,!1)}i[a]++}}}delete s.component.axes[r]}if(n.axis[r]==="independent"&&t[r]&&t[r].length>1)for(const[s,o]of(t[r]||[]).entries())s>0&&o.get("grid")&&!o.explicit.grid&&(o.implicit.grid=!1)}}function $ze(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let i=0;i<n;i++){const r=e[i],s=t[i];if(!!r!=!!s)return;if(r&&s){const o=r.getWithExplicit("orient"),a=s.getWithExplicit("orient");if(o.explicit&&a.explicit&&o.value!==a.value)return;e[i]=Bze(r,s)}}}else return t.map(n=>n.clone());return e}function Bze(e,t){for(const n of _J){const i=dc(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(r,s)=>{switch(n){case"title":return zX(r,s);case"gridScale":return{explicit:r.explicit,value:Mn(r.value,s.value)}}return xR(r,s,n,"axis")});e.setWithExplicit(n,i)}return e}function Gze(e,t,n,i,r){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(Ie(n.labelAngle)?n.labelAngle:h0(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===JZ(i,r))return!0}return e===n[t]}const zze=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function Hze(e,t){let n=t.axis(e);const i=new qL,r=jn(t.encoding[e]),{mark:s,config:o}=t,a=n?.orient||o[e==="x"?"axisX":"axisY"]?.orient||o.axis?.orient||AGe(e),l=t.getScaleComponent(e).get("type"),u=wGe(e,l,a,t.config),c=n!==void 0?!n:PM("disable",o.style,n?.style,u).configValue;if(i.set("disable",c,n!==void 0),c)return i;n=n||{};const d=RGe(r,n,e,o.style,u),h=xQ(n.formatType,r,l),p=SQ(r,r.type,n.format,n.formatType,o,!0),g={fieldOrDatumDef:r,axis:n,channel:e,model:t,scaleType:l,orient:a,labelAngle:d,format:p,formatType:h,mark:s,config:o};for(const y of _J){const b=y in r6?r6[y](g):M5(y)?n[y]:void 0,S=b!==void 0,x=Gze(b,y,n,t,e);if(S&&x)i.set(y,b,x);else{const{configValue:E=void 0,configFrom:A=void 0}=M5(y)&&y!=="values"?PM(y,o.style,n.style,u):{},F=E!==void 0;S&&!F?i.set(y,b,x):(A!=="vgAxisConfig"||zze.has(y)&&F||PC(E)||Ie(E))&&i.set(y,E,!1)}}const m=n.encoding??{},C=LQ.reduce((y,b)=>{if(!i.hasAxisPart(b))return y;const S=sJ(m[b]??{},t),x=b==="labels"?_ze(t,e,S):S;return x!==void 0&&!Ht(x)&&(y[b]={update:x}),y},{});return Ht(C)||i.set("encode",C,!!n.encoding||n.labelAngle!==void 0),i}function Vze({encoding:e,size:t}){for(const n of ru){const i=Nr(n);Ia(t[i])&&Hu(e[n])&&(delete t[i],he(qX(i)))}return t}const Wze={vgMark:"arc",encodeEntry:e=>({...Xs(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...sr("x",e,{defaultPos:"mid"}),...sr("y",e,{defaultPos:"mid"}),...zl(e,"radius"),...zl(e,"theta")})},Uze={vgMark:"area",encodeEntry:e=>({...Xs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"}),...XS("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"}),...XS("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"}),...TL(e)})},qze={vgMark:"rect",encodeEntry:e=>({...Xs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...zl(e,"x"),...zl(e,"y")})},jze={vgMark:"shape",encodeEntry:e=>({...Xs(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})}),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[{type:"geoshape",projection:e.projectionName(),...n&&fe(n)&&n.type===pg?{field:ye(n,{expr:"datum"})}:{}}]}},Kze={vgMark:"image",encodeEntry:e=>({...Xs(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"}),...zl(e,"x"),...zl(e,"y"),...PL(e,"url")})},Yze={vgMark:"line",encodeEntry:e=>({...Xs(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...sr("x",e,{defaultPos:"mid"}),...sr("y",e,{defaultPos:"mid"}),...mi("size",e,{vgChannel:"strokeWidth"}),...TL(e)})},Xze={vgMark:"trail",encodeEntry:e=>({...Xs(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...sr("x",e,{defaultPos:"mid"}),...sr("y",e,{defaultPos:"mid"}),...mi("size",e),...TL(e)})};function jL(e,t){const{config:n}=e;return{...Xs(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...sr("x",e,{defaultPos:"mid"}),...sr("y",e,{defaultPos:"mid"}),...mi("size",e),...mi("angle",e),...Qze(e,n,t)}}function Qze(e,t,n){return n?{shape:{value:n}}:mi("shape",e)}const Zze={vgMark:"symbol",encodeEntry:e=>jL(e)},Jze={vgMark:"symbol",encodeEntry:e=>jL(e,"circle")},eHe={vgMark:"symbol",encodeEntry:e=>jL(e,"square")},tHe={vgMark:"rect",encodeEntry:e=>({...Xs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...zl(e,"x"),...zl(e,"y")})},nHe={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:{...Xs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...XS("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"}),...XS("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"}),...mi("size",e,{vgChannel:"strokeWidth"})}}},iHe={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return{...Xs(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"}),...sr("x",e,{defaultPos:"mid"}),...sr("y",e,{defaultPos:"mid"}),...PL(e),...mi("size",e,{vgChannel:"fontSize"}),...mi("angle",e),...e6("align",rHe(e.markDef,n,t)),...e6("baseline",sHe(e.markDef,n,t)),...sr("radius",e,{defaultPos:null}),...sr("theta",e,{defaultPos:null})}}};function rHe(e,t,n){if(zt("align",e,n)===void 0)return"center"}function sHe(e,t,n){if(zt("baseline",e,n)===void 0)return"middle"}const oHe={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,i=n.orient,r=i==="horizontal"?"x":"y",s=i==="horizontal"?"y":"x",o=i==="horizontal"?"height":"width";return{...Xs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...zl(e,r),...sr(s,e,{defaultPos:"mid",vgChannel:s==="y"?"yc":"xc"}),[o]:en(zt("thickness",n,t))}}},Sw={arc:Wze,area:Uze,bar:qze,circle:Jze,geoshape:jze,image:Kze,line:Yze,point:Zze,rect:tHe,rule:nHe,square:eHe,text:iHe,tick:oHe,trail:Xze};function aHe(e){if(ht([hR,cR,fNe],e.mark)){const t=VQ(e.mark,e.encoding);if(t.length>0)return lHe(e,t)}else if(e.mark===dR){const t=pM.some(n=>zt(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t)return uHe(e)}return KL(e)}const w6="faceted_path_";function lHe(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:w6+e.requestDataName(fn.Main),data:e.requestDataName(fn.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:KL(e,{fromPrefix:w6})}]}const b6="stack_group_";function uHe(e){const[t]=KL(e,{fromPrefix:b6}),n=e.scaleName(e.stack.fieldChannel),i=(u={})=>e.vgField(e.stack.fieldChannel,u),r=(u,c)=>{const d=[i({prefix:"min",suffix:"start",expr:c}),i({prefix:"max",suffix:"start",expr:c}),i({prefix:"min",suffix:"end",expr:c}),i({prefix:"max",suffix:"end",expr:c})];return`${u}(${d.map(h=>`scale('${n}',${h})`).join(",")})`};let s,o;e.stack.fieldChannel==="x"?(s={...Sp(t.encode.update,["y","yc","y2","height",...pM]),x:{signal:r("min","datum")},x2:{signal:r("max","datum")},clip:{value:!0}},o={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},t.encode.update={...Pr(t.encode.update,["y","yc","y2"]),height:{field:{group:"height"}}}):(s={...Sp(t.encode.update,["x","xc","x2","width"]),y:{signal:r("min","datum")},y2:{signal:r("max","datum")},clip:{value:!0}},o={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},t.encode.update={...Pr(t.encode.update,["x","xc","x2"]),width:{field:{group:"width"}}});for(const u of pM){const c=Ma(u,e.markDef,e.config);t.encode.update[u]?(s[u]=t.encode.update[u],delete t.encode.update[u]):c&&(s[u]=en(c)),c&&(t.encode.update[u]={value:0})}const a=[];if(e.stack.groupbyChannels?.length>0)for(const u of e.stack.groupbyChannels){const c=e.fieldDef(u),d=ye(c);d&&a.push(d),(c?.bin||c?.timeUnit)&&a.push(ye(c,{binSuffix:"end"}))}return s=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((u,c)=>{if(t.encode.update[c])return{...u,[c]:t.encode.update[c]};{const d=Ma(c,e.markDef,e.config);return d!==void 0?{...u,[c]:en(d)}:u}},s),s.stroke&&(s.strokeForeground={value:!0},s.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(fn.Main),name:b6+e.requestDataName(fn.Main),groupby:a,aggregate:{fields:[i({suffix:"start"}),i({suffix:"start"}),i({suffix:"end"}),i({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:s},marks:[{type:"group",encode:{update:o},marks:[t]}]}]}function cHe(e){const{encoding:t,stack:n,mark:i,markDef:r,config:s}=e,o=t.order;if(!(!ne(o)&&Po(o)&&hM(o.value)||!o&&hM(zt("order",r,s)))){if((ne(o)||fe(o))&&!n)return $X(o,{expr:"datum"});if(Ic(i)){const a=r.orient==="horizontal"?"y":"x",l=t[a];if(fe(l))return{field:a}}}}function KL(e,t={fromPrefix:""}){const{mark:n,markDef:i,encoding:r,config:s}=e,o=Mn(i.clip,dHe(e),hHe(e)),a=LX(i),l=r.key,u=cHe(e),c=fHe(e),d=zt("aria",i,s),h=Sw[n].postEncodingTransform?Sw[n].postEncodingTransform(e):null;return[{name:e.getName("marks"),type:Sw[n].vgMark,...o?{clip:o}:{},...a?{style:a}:{},...l?{key:l.field}:{},...u?{sort:u}:{},...c||{},...d===!1?{aria:d}:{},from:{data:t.fromPrefix+e.requestDataName(fn.Main)},encode:{update:Sw[n].encodeEntry(e)},...h?{transform:h}:{}}]}function dHe(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t?.get("selectionExtent")||n?.get("selectionExtent")?!0:void 0}function hHe(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function fHe(e){if(!e.component.selection)return null;const t=le(e.component.selection).length;let n=t,i=e.parent;for(;i&&n===0;)n=le(i.component.selection).length,i=i.parent;return n?{interactive:t>0||e.mark==="geoshape"||!!e.encoding.tooltip||!!e.markDef.tooltip}:null}class OJ extends PJ{constructor(t,n,i,r={},s){super(t,"unit",n,i,s,void 0,I5(t)?t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[],this.correctDataNames=u=>(u.from?.data&&(u.from.data=this.lookupDataSource(u.from.data),"time"in this.encoding&&(u.from.data=u.from.data+RZ)),u.from?.facet?.data&&(u.from.facet.data=this.lookupDataSource(u.from.facet.data)),u);const o=Ta(t.mark)?{...t.mark}:{type:t.mark},a=o.type;o.filled===void 0&&(o.filled=X$e(o,s,{graticule:t.data&&DL(t.data)}));const l=this.encoding=e$e(t.encoding||{},a,o.filled,s);this.markDef=cZ(o,l,s),this.size=Vze({encoding:l,size:I5(t)?{...r,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}}:r}),this.stack=uZ(this.markDef,l),this.specifiedScales=this.initScales(a,l),this.specifiedAxes=this.initAxes(l),this.specifiedLegends=this.initLegends(l),this.specifiedProjection=t.projection,this.selection=(t.params??[]).filter(u=>xL(u))}get hasProjection(){const{encoding:t}=this,n=this.mark===gQ,i=t&&q2e.some(r=>Xe(t[r]));return n||i}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return BO.reduce((i,r)=>{const s=jn(n[r]);return s&&(i[r]=this.initScale(s.scale??{})),i},{})}initScale(t){const{domain:n,range:i}=t,r=pi(t);return ne(n)&&(r.domain=n.map(Qr)),ne(i)&&(r.range=i.map(Qr)),r}initAxes(t){return ru.reduce((n,i)=>{const r=t[i];if(Xe(r)||i===ln&&Xe(t.x2)||i===li&&Xe(t.y2)){const s=Xe(r)?r.axis:void 0;n[i]=s&&this.initAxis({...s})}return n},{})}initAxis(t){const n=le(t),i={};for(const r of n){const s=t[r];i[r]=PC(s)?OX(s):Qr(s)}return i}initLegends(t){return iOe.reduce((n,i)=>{const r=jn(t[i]);if(r&&sOe(i)){const s=r.legend;n[i]=s&&pi(s)}return n},{})}parseData(){this.component.data=GR(this)}parseLayoutSize(){Fze(this)}parseSelections(){this.component.selection=mGe(this,this.selection)}parseMarkGroup(){this.component.mark=aHe(this)}parseAxesAndHeaders(){this.component.axes=Oze(this)}assembleSelectionTopLevelSignals(t){return VBe(this,t)}assembleSignals(){return[...XZ(this),...zBe(this,[])]}assembleSelectionData(t){return WBe(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return LL(this)}assembleMarks(){let t=this.component.mark??[];return(!this.parent||!yg(this.parent))&&(t=DZ(this,t)),t.map(this.correctDataNames)}assembleGroupStyle(){const{style:t}=this.view||{};return t!==void 0?t:this.encoding.x||this.encoding.y?"cell":"view"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return Id(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return Mo(n)}typedFieldDef(t){const n=this.fieldDef(t);return dr(n)?n:null}}class YL extends WL{constructor(t,n,i,r,s){super(t,"layer",n,i,s,t.resolve,t.view);const o={...r,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}};this.children=t.layer.map((a,l)=>{if(SR(a))return new YL(a,this,this.getName(`layer_${l}`),o,s);if(su(a))return new OJ(a,this,this.getName(`layer_${l}`),o,s);throw new Error(zO(a))})}parseData(){this.component.data=GR(this);for(const t of this.children)t.parseData()}parseLayoutSize(){Rze(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of le(t.component.selection))this.component.selection[n]=t.component.selection[n]}Object.values(this.component.selection).some(t=>Sa(t))&&WO(VO)}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){Nze(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),XZ(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),LL(this))}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleGroupStyle(){const t=new Set;for(const i of this.children)for(const r of xe(i.assembleGroupStyle()))t.add(r);const n=Array.from(t);return n.length>1?n:n.length===1?n[0]:void 0}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return UBe(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),fJ(this))}}function XL(e,t,n,i,r){if(gR(e))return new Fv(e,t,n,r);if(SR(e))return new YL(e,t,n,i,r);if(su(e))return new OJ(e,t,n,i,r);if(R$e(e))return new Mze(e,t,n,r);throw new Error(zO(e))}function pHe(e,t={}){t.logger&&ALe(t.logger),t.fieldTitle&&IQ(t.fieldTitle);try{const n=lZ(Yp(t.config,e.config)),i=vZ(e,n),r=XL(i,null,"",void 0,n);return r.parse(),$3e(r.component.data,r),{spec:mHe(r,gHe(e,i.autosize,n,r),e.datasets,e.usermeta),normalized:i}}finally{t.logger&&DLe(),t.fieldTitle&&UNe()}}function gHe(e,t,n,i){const r=i.component.layoutSize.get("width"),s=i.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},i.hasAxisOrientSignalRef()&&(t.resize=!0)):Re(t)&&(t={type:t}),r&&s&&MBe(t.type)){if(r==="step"&&s==="step")he(v5()),t.type="pad";else if(r==="step"||s==="step"){const o=r==="step"?"width":"height";he(v5(rR(o)));const a=o==="width"?"height":"width";t.type=TBe(a)}}return{...le(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t},...U5(n,!1),...U5(e,!0)}}function mHe(e,t,n={},i){const r=e.config?$$e(e.config):void 0,s=wze(e.component.data,n),o=e.assembleSelectionData(s),a=e.assembleProjections(),l=e.assembleTitle(),u=e.assembleGroupStyle(),c=e.assembleGroupEncodeEntry(!0);let d=e.assembleLayoutSignals();d=d.filter(g=>(g.name==="width"||g.name==="height")&&g.value!==void 0?(t[g.name]=+g.value,!1):!0);const{params:h,...p}=t;return{$schema:"https://vega.github.io/schema/vega/v5.json",...e.description?{description:e.description}:{},...p,...l?{title:l}:{},...u?{style:u}:{},...c?{encode:{update:c}}:{},data:o,...a.length>0?{projections:a}:{},...e.assembleGroup([...d,...e.assembleSelectionTopLevelSignals([]),...rZ(h)]),...r?{config:r}:{},...i?{usermeta:i}:{}}}const vHe=G2e.version,CHe=Object.freeze(Object.defineProperty({__proto__:null,accessPathDepth:Rp,accessPathWithDatum:MO,accessWithDatumToUnescapedPath:$t,compile:pHe,contains:ht,deepEqual:ts,deleteNestedProperty:GS,duplicate:Ke,entries:lc,every:DO,fieldIntersection:PO,flatAccessWithDatum:mX,getFirstDefined:Mn,hasIntersection:kO,hasProperty:ue,hash:gt,internalField:yX,isBoolean:d0,isEmpty:Ht,isEqual:H2e,isInternalField:wX,isNullOrFalse:hM,isNumeric:Zx,keys:le,logicalExpr:Rv,mergeDeep:pX,never:fX,normalize:vZ,normalizeAngle:h0,omit:Pr,pick:Sp,prefixGenerator:fM,removePathFromField:hg,replaceAll:nh,replacePathInField:Us,resetIdCounter:W2e,setEqual:gX,some:xp,stringify:Vt,titleCase:yC,unique:ga,uniqueId:CX,vals:bi,varName:an,version:vHe},Symbol.toStringTag,{value:"Module"}));function LJ(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var yHe="2.15.0",wHe={version:yHe};const mf="#fff",S6="#888",bHe={background:"#333",view:{stroke:S6},title:{color:mf,subtitleColor:mf},style:{"guide-label":{fill:mf},"guide-title":{fill:mf}},axis:{domainColor:mf,gridColor:S6,tickColor:mf}},nd="#4572a7",SHe={background:"#fff",arc:{fill:nd},area:{fill:nd},line:{stroke:nd,strokeWidth:2},path:{stroke:nd},rect:{fill:nd},shape:{stroke:nd},symbol:{fill:nd,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},id="#30a2da",dD="#cbcbcb",xHe="#999",RHe="#333",x6="#f0f0f0",R6="#333",EHe={arc:{fill:id},area:{fill:id},axis:{domainColor:dD,grid:!0,gridColor:dD,gridWidth:1,labelColor:xHe,labelFontSize:10,titleColor:RHe,tickColor:dD,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:x6,group:{fill:x6},legend:{labelColor:R6,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:R6,titleFontSize:14,titlePadding:10},line:{stroke:id,strokeWidth:2},path:{stroke:id,strokeWidth:.5},rect:{fill:id},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:id},bar:{binSpacing:2,fill:id,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},rd="#000",FHe={group:{fill:"#e5e5e5"},arc:{fill:rd},area:{fill:rd},line:{stroke:rd},path:{stroke:rd},rect:{fill:rd},shape:{stroke:rd},symbol:{fill:rd,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},AHe=22,DHe="normal",E6="Benton Gothic, sans-serif",F6=11.5,kHe="normal",sd="#82c6df",hD="Benton Gothic Bold, sans-serif",A6="normal",D6=13,Rm={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"]},PHe={background:"#ffffff",title:{anchor:"start",color:"#000000",font:hD,fontSize:AHe,fontWeight:DHe},arc:{fill:sd},area:{fill:sd},line:{stroke:sd,strokeWidth:2},path:{stroke:sd},rect:{fill:sd},shape:{stroke:sd},symbol:{fill:sd,size:30},axis:{labelFont:E6,labelFontSize:F6,labelFontWeight:kHe,titleFont:hD,titleFontSize:D6,titleFontWeight:A6},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:E6,labelFontSize:F6,symbolType:"square",titleFont:hD,titleFontSize:D6,titleFontWeight:A6},range:{category:Rm["category-6"],diverging:Rm["fireandice-6"],heatmap:Rm["fire-7"],ordinal:Rm["fire-7"],ramp:Rm["fire-7"]}},od="#ab5787",xw="#979797",MHe={background:"#f9f9f9",arc:{fill:od},area:{fill:od},line:{stroke:od},path:{stroke:od},rect:{fill:od},shape:{stroke:od},symbol:{fill:od,size:30},axis:{domainColor:xw,domainWidth:.5,gridWidth:.2,labelColor:xw,tickColor:xw,tickWidth:.2,titleColor:xw},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},ad="#3e5c69",THe={background:"#fff",arc:{fill:ad},area:{fill:ad},line:{stroke:ad},path:{stroke:ad},rect:{fill:ad},shape:{stroke:ad},symbol:{fill:ad},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},Ss="#1696d2",k6="#000000",IHe="#FFFFFF",Rw="Lato",fD="Lato",_He="Lato",OHe="#DEDDDD",LHe=18,Em={"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},NHe={background:IHe,title:{anchor:"start",fontSize:LHe,font:Rw},axisX:{domain:!0,domainColor:k6,domainWidth:1,grid:!1,labelFontSize:12,labelFont:fD,labelAngle:0,tickColor:k6,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:Rw},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:OHe,gridWidth:1,labelFontSize:12,labelFont:fD,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:Rw,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:fD,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:Rw,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:Em["six-groups-cat-1"],diverging:Em["diverging-colors"],heatmap:Em["diverging-colors"],ordinal:Em["six-groups-seq"],ramp:Em["shades-blue"]},area:{fill:Ss},rect:{fill:Ss},line:{color:Ss,stroke:Ss,strokeWidth:5},trail:{color:Ss,stroke:Ss,strokeWidth:0,size:1},path:{stroke:Ss,strokeWidth:.5},point:{filled:!0},text:{font:_He,color:Ss,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:Ss,stroke:null}},arc:{fill:Ss},shape:{stroke:Ss},symbol:{fill:Ss,size:30}},ld="#3366CC",P6="#ccc",Ew="Arial, sans-serif",$He={arc:{fill:ld},area:{fill:ld},path:{stroke:ld},rect:{fill:ld},shape:{stroke:ld},symbol:{stroke:ld},circle:{fill:ld},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:Ew,fontSize:12},"guide-title":{font:Ew,fontSize:12},"group-title":{font:Ew,fontSize:12}},title:{font:Ew,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:P6,tickColor:P6,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},QL=e=>e*(1/3+1),M6=QL(9),T6=QL(10),I6=QL(12),Fm="Segoe UI",_6="wf_standard-font, helvetica, arial, sans-serif",O6="#252423",Am="#605E5C",L6="transparent",BHe="#C8C6C4",ao="#118DFF",GHe="#12239E",zHe="#E66C37",HHe="#6B007B",VHe="#E044A7",WHe="#744EC2",UHe="#D9B300",qHe="#D64550",NJ=ao,$J="#DEEFFF",N6=[$J,NJ],jHe=[$J,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",NJ],KHe={view:{stroke:L6},background:L6,font:Fm,header:{titleFont:_6,titleFontSize:I6,titleColor:O6,labelFont:Fm,labelFontSize:T6,labelColor:Am},axis:{ticks:!1,grid:!1,domain:!1,labelColor:Am,labelFontSize:M6,titleFont:_6,titleColor:O6,titleFontSize:I6,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:BHe,gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:ao},line:{stroke:ao,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:Fm,fontSize:M6,fill:Am},arc:{fill:ao},area:{fill:ao,line:!0,opacity:.6},path:{stroke:ao},rect:{fill:ao},point:{fill:ao,filled:!0,size:75},shape:{stroke:ao},symbol:{fill:ao,strokeWidth:1.5,size:50},legend:{titleFont:Fm,titleFontWeight:"bold",titleColor:Am,labelFont:Fm,labelFontSize:T6,labelColor:Am,symbolType:"circle",symbolSize:75},range:{category:[ao,GHe,zHe,HHe,VHe,WHe,UHe,qHe],diverging:N6,heatmap:N6,ordinal:jHe}},pD='IBM Plex Sans,system-ui,-apple-system,BlinkMacSystemFont,".sfnstext-regular",sans-serif',YHe='IBM Plex Sans Condensed, system-ui, -apple-system, BlinkMacSystemFont, ".SFNSText-Regular", sans-serif',gD=400,Fw={textPrimary:{g90:"#f4f4f4",g100:"#f4f4f4",white:"#161616",g10:"#161616"},textSecondary:{g90:"#c6c6c6",g100:"#c6c6c6",white:"#525252",g10:"#525252"},layerAccent01:{white:"#e0e0e0",g10:"#e0e0e0",g90:"#525252",g100:"#393939"},gridBg:{white:"#ffffff",g10:"#ffffff",g90:"#161616",g100:"#161616"}},XHe=["#8a3ffc","#33b1ff","#007d79","#ff7eb6","#fa4d56","#fff1f1","#6fdc8c","#4589ff","#d12771","#d2a106","#08bdba","#bae6ff","#ba4e00","#d4bbff"],QHe=["#6929c4","#1192e8","#005d5d","#9f1853","#fa4d56","#570408","#198038","#002d9c","#ee538b","#b28600","#009d9a","#012749","#8a3800","#a56eff"];function zR({theme:e,background:t}){const n=["white","g10"].includes(e)?"light":"dark",i=Fw.gridBg[e],r=Fw.textPrimary[e],s=Fw.textSecondary[e],o=n==="dark"?XHe:QHe,a=n==="dark"?"#d4bbff":"#6929c4";return{background:t,arc:{fill:a},area:{fill:a},path:{stroke:a},rect:{fill:a},shape:{stroke:a},symbol:{stroke:a},circle:{fill:a},view:{fill:i,stroke:i},group:{fill:i},title:{color:r,anchor:"start",dy:-15,fontSize:16,font:pD,fontWeight:600},axis:{labelColor:s,labelFontSize:12,labelFont:YHe,labelFontWeight:gD,titleColor:r,titleFontWeight:600,titleFontSize:12,grid:!0,gridColor:Fw.layerAccent01[e],labelAngle:0},axisX:{titlePadding:10},axisY:{titlePadding:2.5},style:{"guide-label":{font:pD,fill:s,fontWeight:gD},"guide-title":{font:pD,fill:s,fontWeight:gD}},range:{category:o,diverging:["#750e13","#a2191f","#da1e28","#fa4d56","#ff8389","#ffb3b8","#ffd7d9","#fff1f1","#e5f6ff","#bae6ff","#82cfff","#33b1ff","#1192e8","#0072c3","#00539a","#003a6d"],heatmap:["#f6f2ff","#e8daff","#d4bbff","#be95ff","#a56eff","#8a3ffc","#6929c4","#491d8b","#31135e","#1c0f30"]}}}const ZHe=zR({theme:"white",background:"#ffffff"}),JHe=zR({theme:"g10",background:"#f4f4f4"}),eVe=zR({theme:"g90",background:"#262626"}),tVe=zR({theme:"g100",background:"#161616"}),nVe=wHe.version,iVe=Object.freeze(Object.defineProperty({__proto__:null,carbong10:JHe,carbong100:tVe,carbong90:eVe,carbonwhite:ZHe,dark:bHe,excel:SHe,fivethirtyeight:EHe,ggplot2:FHe,googlecharts:$He,latimes:PHe,powerbi:KHe,quartz:MHe,urbaninstitute:NHe,version:nVe,vox:THe},Symbol.toStringTag,{value:"Module"}));function rVe(e,t,n,i){if(ne(e))return`[${e.map(r=>t(Re(r)?r:$6(r,n))).join(", ")}]`;if(be(e)){let r="";const{title:s,image:o,...a}=e;s&&(r+=`<h2>${t(s)}</h2>`),o&&(r+=`<img src="${new URL(t(o),i||location.href).href}">`);const l=Object.keys(a);if(l.length>0){r+="<table>";for(const u of l){let c=a[u];c!==void 0&&(be(c)&&(c=$6(c,n)),r+=`<tr><td class="key">${t(u)}</td><td class="value">${t(c)}</td></tr>`)}r+="</table>"}return r||"{}"}return t(e)}function sVe(e){const t=[];return function(n,i){if(typeof i!="object"||i===null)return i;const r=t.indexOf(this)+1;return t.length=r,t.length>e?"[Object]":t.indexOf(i)>=0?"[Circular]":(t.push(i),i)}}function $6(e,t){return JSON.stringify(e,sVe(t))}var oVe=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black;
}
#vg-tooltip-element.visible {
  visibility: visible;
}
#vg-tooltip-element h2 {
  margin-top: 0;
  margin-bottom: 10px;
  font-size: 13px;
}
#vg-tooltip-element table {
  border-spacing: 0;
}
#vg-tooltip-element table tr {
  border: none;
}
#vg-tooltip-element table tr td {
  overflow: hidden;
  text-overflow: ellipsis;
  padding-top: 2px;
  padding-bottom: 2px;
}
#vg-tooltip-element table tr td.key {
  color: #808080;
  max-width: 150px;
  text-align: right;
  padding-right: 4px;
}
#vg-tooltip-element table tr td.value {
  display: block;
  max-width: 300px;
  max-height: 7em;
  text-align: left;
}
#vg-tooltip-element.dark-theme {
  background-color: rgba(32, 32, 32, 0.9);
  border: 1px solid #f5f5f5;
  color: white;
}
#vg-tooltip-element.dark-theme td.key {
  color: #bfbfbf;
}
`;const BJ="vg-tooltip-element",aVe={offsetX:10,offsetY:10,id:BJ,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:lVe,maxDepth:2,formatTooltip:rVe,baseURL:"",anchor:"cursor",position:["top","bottom","left","right","top-left","top-right","bottom-left","bottom-right"]};function lVe(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function uVe(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return oVe.toString().replace(BJ,e)}function GJ(e,t,{offsetX:n,offsetY:i}){const r=zJ({x1:e.clientX,x2:e.clientX,y1:e.clientY,y2:e.clientY},t,n,i),s=["bottom-right","bottom-left","top-right","top-left"];for(const o of s)if(HJ(r[o],t))return r[o];return r["top-left"]}function cVe(e,t,n,i,r){const{position:s,offsetX:o,offsetY:a}=r,l=e._el.getBoundingClientRect(),u=e._origin,c=dVe(l,u,n),d=zJ(c,i,o,a),h=Array.isArray(s)?s:[s];for(const p of h)if(HJ(d[p],i)&&!hVe(t,d[p],i))return d[p];return GJ(t,i,r)}function dVe(e,t,n){const i=n.isVoronoi?n.datum.bounds:n.bounds;let r=e.left+t[0]+i.x1,s=e.top+t[1]+i.y1,o=n;for(;o.mark.group;)o=o.mark.group,r+=o.x??0,s+=o.y??0;const a=i.x2-i.x1,l=i.y2-i.y1;return{x1:r,x2:r+a,y1:s,y2:s+l}}function zJ(e,t,n,i){const r=(e.x1+e.x2)/2,s=(e.y1+e.y2)/2,o=e.x1-t.width-n,a=r-t.width/2,l=e.x2+n,u=e.y1-t.height-i,c=s-t.height/2,d=e.y2+i;return{top:{x:a,y:u},bottom:{x:a,y:d},left:{x:o,y:c},right:{x:l,y:c},"top-left":{x:o,y:u},"top-right":{x:l,y:u},"bottom-left":{x:o,y:d},"bottom-right":{x:l,y:d}}}function HJ(e,t){return e.x>=0&&e.y>=0&&e.x+t.width<=window.innerWidth&&e.y+t.height<=window.innerHeight}function hVe(e,t,n){return e.clientX>=t.x&&e.clientX<=t.x+n.width&&e.clientY>=t.y&&e.clientY<=t.y+n.height}class fVe{constructor(t){this.options={...aVe,...t};const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const i=document.createElement("style");i.setAttribute("id",this.options.styleId),i.innerHTML=uVe(n);const r=document.head;r.childNodes.length>0?r.insertBefore(i,r.childNodes[0]):r.appendChild(i)}}tooltipHandler(t,n,i,r){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),(document.fullscreenElement??document.body).appendChild(this.el)),r==null||r===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=this.options.formatTooltip(r,this.options.sanitize,this.options.maxDepth,this.options.baseURL),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:s,y:o}=this.options.anchor==="mark"?cVe(t,n,i,this.el.getBoundingClientRect(),this.options):GJ(n,this.el.getBoundingClientRect(),this.options);this.el.style.top=`${o}px`,this.el.style.left=`${s}px`}}var mD={};/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var pVe=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var s in r)r.hasOwnProperty(s)&&(i[s]=r[s])},e(t,n)};return function(t,n){e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),gVe=Object.prototype.hasOwnProperty;function GM(e,t){return gVe.call(e,t)}function zM(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var i=[];for(var r in e)GM(e,r)&&i.push(r);return i}function ns(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function HM(e){for(var t=0,n=e.length,i;t<n;){if(i=e.charCodeAt(t),i>=48&&i<=57){t++;continue}return!1}return!0}function dd(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function VJ(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function VM(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(VM(e[t]))return!0}else if(typeof e=="object"){for(var i=zM(e),r=i.length,s=0;s<r;s++)if(VM(e[i[s]]))return!0}}return!1}function B6(e,t){var n=[e];for(var i in t){var r=typeof t[i]=="object"?JSON.stringify(t[i],null,2):t[i];typeof r<"u"&&n.push(i+": "+r)}return n.join(`
`)}var WJ=function(e){pVe(t,e);function t(n,i,r,s,o){var a=this.constructor,l=e.call(this,B6(n,{name:i,index:r,operation:s,tree:o}))||this;return l.name=i,l.index=r,l.operation=s,l.tree=o,Object.setPrototypeOf(l,a.prototype),l.message=B6(n,{name:i,index:r,operation:s,tree:o}),l}return t}(Error),Cn=WJ,mVe=ns,Mf={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var i=e[t];return delete e[t],{newDocument:n,removed:i}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:function(e,t,n){var i=e1(n,this.path);i&&(i=ns(i));var r=Ld(n,{op:"remove",path:this.from}).removed;return Ld(n,{op:"add",path:this.path,value:r}),{newDocument:n,removed:i}},copy:function(e,t,n){var i=e1(n,this.from);return Ld(n,{op:"add",path:this.path,value:ns(i)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:v0(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},vVe={add:function(e,t,n){return HM(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var i=e.splice(t,1);return{newDocument:n,removed:i[0]}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:Mf.move,copy:Mf.copy,test:Mf.test,_get:Mf._get};function e1(e,t){if(t=="")return e;var n={op:"_get",path:t};return Ld(e,n),n.value}function Ld(e,t,n,i,r,s){if(n===void 0&&(n=!1),i===void 0&&(i=!0),r===void 0&&(r=!0),s===void 0&&(s=0),n&&(typeof n=="function"?n(t,0,e,t.path):t1(t,0)),t.path===""){var o={newDocument:e};if(t.op==="add")return o.newDocument=t.value,o;if(t.op==="replace")return o.newDocument=t.value,o.removed=e,o;if(t.op==="move"||t.op==="copy")return o.newDocument=e1(e,t.from),t.op==="move"&&(o.removed=e),o;if(t.op==="test"){if(o.test=v0(e,t.value),o.test===!1)throw new Cn("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o.newDocument=e,o}else{if(t.op==="remove")return o.removed=e,o.newDocument=null,o;if(t.op==="_get")return t.value=e,o;if(n)throw new Cn("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,t,e);return o}}else{i||(e=ns(e));var a=t.path||"",l=a.split("/"),u=e,c=1,d=l.length,h=void 0,p=void 0,g=void 0;for(typeof n=="function"?g=n:g=t1;;){if(p=l[c],p&&p.indexOf("~")!=-1&&(p=VJ(p)),r&&(p=="__proto__"||p=="prototype"&&c>0&&l[c-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&h===void 0&&(u[p]===void 0?h=l.slice(0,c).join("/"):c==d-1&&(h=t.path),h!==void 0&&g(t,0,e,h)),c++,Array.isArray(u)){if(p==="-")p=u.length;else{if(n&&!HM(p))throw new Cn("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,t,e);HM(p)&&(p=~~p)}if(c>=d){if(n&&t.op==="add"&&p>u.length)throw new Cn("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,t,e);var o=vVe[t.op].call(t,u,p,e);if(o.test===!1)throw new Cn("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o}}else if(c>=d){var o=Mf[t.op].call(t,u,p,e);if(o.test===!1)throw new Cn("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o}if(u=u[p],n&&c<d&&(!u||typeof u!="object"))throw new Cn("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",s,t,e)}}}function HR(e,t,n,i,r){if(i===void 0&&(i=!0),r===void 0&&(r=!0),n&&!Array.isArray(t))throw new Cn("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");i||(e=ns(e));for(var s=new Array(t.length),o=0,a=t.length;o<a;o++)s[o]=Ld(e,t[o],n,!0,r,o),e=s[o].newDocument;return s.newDocument=e,s}function CVe(e,t,n){var i=Ld(e,t);if(i.test===!1)throw new Cn("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return i.newDocument}function t1(e,t,n,i){if(typeof e!="object"||e===null||Array.isArray(e))throw new Cn("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(Mf[e.op]){if(typeof e.path!="string")throw new Cn("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new Cn('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new Cn("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new Cn("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&VM(e.value))throw new Cn("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var r=e.path.split("/").length,s=i.split("/").length;if(r!==s+1&&r!==s)throw new Cn("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==i)throw new Cn("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var o={op:"_get",path:e.from,value:void 0},a=UJ([o],n);if(a&&a.name==="OPERATION_PATH_UNRESOLVABLE")throw new Cn("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new Cn("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function UJ(e,t,n){try{if(!Array.isArray(e))throw new Cn("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)HR(ns(t),ns(e),n||!0);else{n=n||t1;for(var i=0;i<e.length;i++)n(e[i],i,t,void 0)}}catch(r){if(r instanceof Cn)return r;throw r}}function v0(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),i=Array.isArray(t),r,s,o;if(n&&i){if(s=e.length,s!=t.length)return!1;for(r=s;r--!==0;)if(!v0(e[r],t[r]))return!1;return!0}if(n!=i)return!1;var a=Object.keys(e);if(s=a.length,s!==Object.keys(t).length)return!1;for(r=s;r--!==0;)if(!t.hasOwnProperty(a[r]))return!1;for(r=s;r--!==0;)if(o=a[r],!v0(e[o],t[o]))return!1;return!0}return e!==e&&t!==t}var yVe=Object.freeze({__proto__:null,JsonPatchError:Cn,_areEquals:v0,applyOperation:Ld,applyPatch:HR,applyReducer:CVe,deepClone:mVe,getValueByPointer:e1,validate:UJ,validator:t1});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */var ZL=new WeakMap,wVe=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),bVe=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function SVe(e){return ZL.get(e)}function xVe(e,t){return e.observers.get(t)}function RVe(e,t){e.observers.delete(t.callback)}function EVe(e,t){t.unobserve()}function FVe(e,t){var n=[],i,r=SVe(e);if(!r)r=new wVe(e),ZL.set(e,r);else{var s=xVe(r,t);i=s&&s.observer}if(i)return i;if(i={},r.value=ns(e),t){i.callback=t,i.next=null;var o=function(){WM(i)},a=function(){clearTimeout(i.next),i.next=setTimeout(o)};typeof window<"u"&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return i.patches=n,i.object=e,i.unobserve=function(){WM(i),clearTimeout(i.next),RVe(r,i),typeof window<"u"&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},r.observers.set(t,new bVe(t,i)),i}function WM(e,t){t===void 0&&(t=!1);var n=ZL.get(e.object);JL(n.value,e.object,e.patches,"",t),e.patches.length&&HR(n.value,e.patches);var i=e.patches;return i.length>0&&(e.patches=[],e.callback&&e.callback(i)),i}function JL(e,t,n,i,r){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var s=zM(t),o=zM(e),a=!1,l=o.length-1;l>=0;l--){var u=o[l],c=e[u];if(GM(t,u)&&!(t[u]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var d=t[u];typeof c=="object"&&c!=null&&typeof d=="object"&&d!=null&&Array.isArray(c)===Array.isArray(d)?JL(c,d,n,i+"/"+dd(u),r):c!==d&&(r&&n.push({op:"test",path:i+"/"+dd(u),value:ns(c)}),n.push({op:"replace",path:i+"/"+dd(u),value:ns(d)}))}else Array.isArray(e)===Array.isArray(t)?(r&&n.push({op:"test",path:i+"/"+dd(u),value:ns(c)}),n.push({op:"remove",path:i+"/"+dd(u)}),a=!0):(r&&n.push({op:"test",path:i,value:e}),n.push({op:"replace",path:i,value:t}))}if(!(!a&&s.length==o.length))for(var l=0;l<s.length;l++){var u=s[l];!GM(e,u)&&t[u]!==void 0&&n.push({op:"add",path:i+"/"+dd(u),value:ns(t[u])})}}}function AVe(e,t,n){n===void 0&&(n=!1);var i=[];return JL(e,t,i,"",n),i}var DVe=Object.freeze({__proto__:null,compare:AVe,generate:WM,observe:FVe,unobserve:EVe});Object.assign({},yVe,DVe,{JsonPatchError:WJ,deepClone:ns,escapePathComponent:dd,unescapePathComponent:VJ});function kVe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var vD,G6;function PVe(){if(G6)return vD;G6=1;class e{constructor(){this.max=1e3,this.map=new Map}get(n){const i=this.map.get(n);if(i!==void 0)return this.map.delete(n),this.map.set(n,i),i}delete(n){return this.map.delete(n)}set(n,i){if(!this.delete(n)&&i!==void 0){if(this.map.size>=this.max){const s=this.map.keys().next().value;this.delete(s)}this.map.set(n,i)}return this}}return vD=e,vD}var CD,z6;function eN(){if(z6)return CD;z6=1;const e=Object.freeze({loose:!0}),t=Object.freeze({});return CD=i=>i?typeof i!="object"?e:i:t,CD}var Aw={exports:{}},yD,H6;function tN(){if(H6)return yD;H6=1;const e="2.0.0",t=256,n=Number.MAX_SAFE_INTEGER||9007199254740991,i=16,r=t-6;return yD={MAX_LENGTH:t,MAX_SAFE_COMPONENT_LENGTH:i,MAX_SAFE_BUILD_LENGTH:r,MAX_SAFE_INTEGER:n,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:e,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},yD}var wD,V6;function VR(){return V6||(V6=1,wD=typeof process=="object"&&mD&&mD.NODE_DEBUG&&/\bsemver\b/i.test(mD.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{}),wD}var W6;function nN(){return W6||(W6=1,function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:r}=tN(),s=VR();t=e.exports={};const o=t.re=[],a=t.safeRe=[],l=t.src=[],u=t.t={};let c=0;const d="[a-zA-Z0-9-]",h=[["\\s",1],["\\d",r],[d,i]],p=m=>{for(const[C,y]of h)m=m.split(`${C}*`).join(`${C}{0,${y}}`).split(`${C}+`).join(`${C}{1,${y}}`);return m},g=(m,C,y)=>{const b=p(C),S=c++;s(m,S,C),u[m]=S,l[S]=C,o[S]=new RegExp(C,y?"g":void 0),a[S]=new RegExp(b,y?"g":void 0)};g("NUMERICIDENTIFIER","0|[1-9]\\d*"),g("NUMERICIDENTIFIERLOOSE","\\d+"),g("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${d}*`),g("MAINVERSION",`(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})`),g("MAINVERSIONLOOSE",`(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})`),g("PRERELEASEIDENTIFIER",`(?:${l[u.NUMERICIDENTIFIER]}|${l[u.NONNUMERICIDENTIFIER]})`),g("PRERELEASEIDENTIFIERLOOSE",`(?:${l[u.NUMERICIDENTIFIERLOOSE]}|${l[u.NONNUMERICIDENTIFIER]})`),g("PRERELEASE",`(?:-(${l[u.PRERELEASEIDENTIFIER]}(?:\\.${l[u.PRERELEASEIDENTIFIER]})*))`),g("PRERELEASELOOSE",`(?:-?(${l[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[u.PRERELEASEIDENTIFIERLOOSE]})*))`),g("BUILDIDENTIFIER",`${d}+`),g("BUILD",`(?:\\+(${l[u.BUILDIDENTIFIER]}(?:\\.${l[u.BUILDIDENTIFIER]})*))`),g("FULLPLAIN",`v?${l[u.MAINVERSION]}${l[u.PRERELEASE]}?${l[u.BUILD]}?`),g("FULL",`^${l[u.FULLPLAIN]}$`),g("LOOSEPLAIN",`[v=\\s]*${l[u.MAINVERSIONLOOSE]}${l[u.PRERELEASELOOSE]}?${l[u.BUILD]}?`),g("LOOSE",`^${l[u.LOOSEPLAIN]}$`),g("GTLT","((?:<|>)?=?)"),g("XRANGEIDENTIFIERLOOSE",`${l[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),g("XRANGEIDENTIFIER",`${l[u.NUMERICIDENTIFIER]}|x|X|\\*`),g("XRANGEPLAIN",`[v=\\s]*(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:${l[u.PRERELEASE]})?${l[u.BUILD]}?)?)?`),g("XRANGEPLAINLOOSE",`[v=\\s]*(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:${l[u.PRERELEASELOOSE]})?${l[u.BUILD]}?)?)?`),g("XRANGE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAIN]}$`),g("XRANGELOOSE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAINLOOSE]}$`),g("COERCEPLAIN",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?`),g("COERCE",`${l[u.COERCEPLAIN]}(?:$|[^\\d])`),g("COERCEFULL",l[u.COERCEPLAIN]+`(?:${l[u.PRERELEASE]})?(?:${l[u.BUILD]})?(?:$|[^\\d])`),g("COERCERTL",l[u.COERCE],!0),g("COERCERTLFULL",l[u.COERCEFULL],!0),g("LONETILDE","(?:~>?)"),g("TILDETRIM",`(\\s*)${l[u.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",g("TILDE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAIN]}$`),g("TILDELOOSE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAINLOOSE]}$`),g("LONECARET","(?:\\^)"),g("CARETTRIM",`(\\s*)${l[u.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",g("CARET",`^${l[u.LONECARET]}${l[u.XRANGEPLAIN]}$`),g("CARETLOOSE",`^${l[u.LONECARET]}${l[u.XRANGEPLAINLOOSE]}$`),g("COMPARATORLOOSE",`^${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]})$|^$`),g("COMPARATOR",`^${l[u.GTLT]}\\s*(${l[u.FULLPLAIN]})$|^$`),g("COMPARATORTRIM",`(\\s*)${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]}|${l[u.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",g("HYPHENRANGE",`^\\s*(${l[u.XRANGEPLAIN]})\\s+-\\s+(${l[u.XRANGEPLAIN]})\\s*$`),g("HYPHENRANGELOOSE",`^\\s*(${l[u.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[u.XRANGEPLAINLOOSE]})\\s*$`),g("STAR","(<|>)?=?\\s*\\*"),g("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),g("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(Aw,Aw.exports)),Aw.exports}var bD,U6;function MVe(){if(U6)return bD;U6=1;const e=/^[0-9]+$/,t=(i,r)=>{const s=e.test(i),o=e.test(r);return s&&o&&(i=+i,r=+r),i===r?0:s&&!o?-1:o&&!s?1:i<r?-1:1};return bD={compareIdentifiers:t,rcompareIdentifiers:(i,r)=>t(r,i)},bD}var SD,q6;function iN(){if(q6)return SD;q6=1;const e=VR(),{MAX_LENGTH:t,MAX_SAFE_INTEGER:n}=tN(),{safeRe:i,t:r}=nN(),s=eN(),{compareIdentifiers:o}=MVe();class a{constructor(u,c){if(c=s(c),u instanceof a){if(u.loose===!!c.loose&&u.includePrerelease===!!c.includePrerelease)return u;u=u.version}else if(typeof u!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof u}".`);if(u.length>t)throw new TypeError(`version is longer than ${t} characters`);e("SemVer",u,c),this.options=c,this.loose=!!c.loose,this.includePrerelease=!!c.includePrerelease;const d=u.trim().match(c.loose?i[r.LOOSE]:i[r.FULL]);if(!d)throw new TypeError(`Invalid Version: ${u}`);if(this.raw=u,this.major=+d[1],this.minor=+d[2],this.patch=+d[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");d[4]?this.prerelease=d[4].split(".").map(h=>{if(/^[0-9]+$/.test(h)){const p=+h;if(p>=0&&p<n)return p}return h}):this.prerelease=[],this.build=d[5]?d[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(u){if(e("SemVer.compare",this.version,this.options,u),!(u instanceof a)){if(typeof u=="string"&&u===this.version)return 0;u=new a(u,this.options)}return u.version===this.version?0:this.compareMain(u)||this.comparePre(u)}compareMain(u){return u instanceof a||(u=new a(u,this.options)),o(this.major,u.major)||o(this.minor,u.minor)||o(this.patch,u.patch)}comparePre(u){if(u instanceof a||(u=new a(u,this.options)),this.prerelease.length&&!u.prerelease.length)return-1;if(!this.prerelease.length&&u.prerelease.length)return 1;if(!this.prerelease.length&&!u.prerelease.length)return 0;let c=0;do{const d=this.prerelease[c],h=u.prerelease[c];if(e("prerelease compare",c,d,h),d===void 0&&h===void 0)return 0;if(h===void 0)return 1;if(d===void 0)return-1;if(d===h)continue;return o(d,h)}while(++c)}compareBuild(u){u instanceof a||(u=new a(u,this.options));let c=0;do{const d=this.build[c],h=u.build[c];if(e("build compare",c,d,h),d===void 0&&h===void 0)return 0;if(h===void 0)return 1;if(d===void 0)return-1;if(d===h)continue;return o(d,h)}while(++c)}inc(u,c,d){switch(u){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",c,d);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",c,d);break;case"prepatch":this.prerelease.length=0,this.inc("patch",c,d),this.inc("pre",c,d);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",c,d),this.inc("pre",c,d);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const h=Number(d)?1:0;if(!c&&d===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[h];else{let p=this.prerelease.length;for(;--p>=0;)typeof this.prerelease[p]=="number"&&(this.prerelease[p]++,p=-2);if(p===-1){if(c===this.prerelease.join(".")&&d===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(h)}}if(c){let p=[c,h];d===!1&&(p=[c]),o(this.prerelease[0],c)===0?isNaN(this.prerelease[1])&&(this.prerelease=p):this.prerelease=p}break}default:throw new Error(`invalid increment argument: ${u}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return SD=a,SD}var xD,j6;function wg(){if(j6)return xD;j6=1;const e=iN();return xD=(n,i,r)=>new e(n,r).compare(new e(i,r)),xD}var RD,K6;function TVe(){if(K6)return RD;K6=1;const e=wg();return RD=(n,i,r)=>e(n,i,r)===0,RD}var ED,Y6;function IVe(){if(Y6)return ED;Y6=1;const e=wg();return ED=(n,i,r)=>e(n,i,r)!==0,ED}var FD,X6;function _Ve(){if(X6)return FD;X6=1;const e=wg();return FD=(n,i,r)=>e(n,i,r)>0,FD}var AD,Q6;function OVe(){if(Q6)return AD;Q6=1;const e=wg();return AD=(n,i,r)=>e(n,i,r)>=0,AD}var DD,Z6;function LVe(){if(Z6)return DD;Z6=1;const e=wg();return DD=(n,i,r)=>e(n,i,r)<0,DD}var kD,J6;function NVe(){if(J6)return kD;J6=1;const e=wg();return kD=(n,i,r)=>e(n,i,r)<=0,kD}var PD,eW;function $Ve(){if(eW)return PD;eW=1;const e=TVe(),t=IVe(),n=_Ve(),i=OVe(),r=LVe(),s=NVe();return PD=(a,l,u,c)=>{switch(l){case"===":return typeof a=="object"&&(a=a.version),typeof u=="object"&&(u=u.version),a===u;case"!==":return typeof a=="object"&&(a=a.version),typeof u=="object"&&(u=u.version),a!==u;case"":case"=":case"==":return e(a,u,c);case"!=":return t(a,u,c);case">":return n(a,u,c);case">=":return i(a,u,c);case"<":return r(a,u,c);case"<=":return s(a,u,c);default:throw new TypeError(`Invalid operator: ${l}`)}},PD}var MD,tW;function BVe(){if(tW)return MD;tW=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(c,d){if(d=n(d),c instanceof t){if(c.loose===!!d.loose)return c;c=c.value}c=c.trim().split(/\s+/).join(" "),o("comparator",c,d),this.options=d,this.loose=!!d.loose,this.parse(c),this.semver===e?this.value="":this.value=this.operator+this.semver.version,o("comp",this)}parse(c){const d=this.options.loose?i[r.COMPARATORLOOSE]:i[r.COMPARATOR],h=c.match(d);if(!h)throw new TypeError(`Invalid comparator: ${c}`);this.operator=h[1]!==void 0?h[1]:"",this.operator==="="&&(this.operator=""),h[2]?this.semver=new a(h[2],this.options.loose):this.semver=e}toString(){return this.value}test(c){if(o("Comparator.test",c,this.options.loose),this.semver===e||c===e)return!0;if(typeof c=="string")try{c=new a(c,this.options)}catch{return!1}return s(c,this.operator,this.semver,this.options)}intersects(c,d){if(!(c instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new l(c.value,d).test(this.value):c.operator===""?c.value===""?!0:new l(this.value,d).test(c.semver):(d=n(d),d.includePrerelease&&(this.value==="<0.0.0-0"||c.value==="<0.0.0-0")||!d.includePrerelease&&(this.value.startsWith("<0.0.0")||c.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&c.operator.startsWith(">")||this.operator.startsWith("<")&&c.operator.startsWith("<")||this.semver.version===c.semver.version&&this.operator.includes("=")&&c.operator.includes("=")||s(this.semver,"<",c.semver,d)&&this.operator.startsWith(">")&&c.operator.startsWith("<")||s(this.semver,">",c.semver,d)&&this.operator.startsWith("<")&&c.operator.startsWith(">")))}}MD=t;const n=eN(),{safeRe:i,t:r}=nN(),s=$Ve(),o=VR(),a=iN(),l=qJ();return MD}var TD,nW;function qJ(){if(nW)return TD;nW=1;const e=/\s+/g;class t{constructor(L,G){if(G=r(G),L instanceof t)return L.loose===!!G.loose&&L.includePrerelease===!!G.includePrerelease?L:new t(L.raw,G);if(L instanceof s)return this.raw=L.value,this.set=[[L]],this.formatted=void 0,this;if(this.options=G,this.loose=!!G.loose,this.includePrerelease=!!G.includePrerelease,this.raw=L.trim().replace(e," "),this.set=this.raw.split("||").map(q=>this.parseRange(q.trim())).filter(q=>q.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const q=this.set[0];if(this.set=this.set.filter(V=>!m(V[0])),this.set.length===0)this.set=[q];else if(this.set.length>1){for(const V of this.set)if(V.length===1&&C(V[0])){this.set=[V];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let L=0;L<this.set.length;L++){L>0&&(this.formatted+="||");const G=this.set[L];for(let q=0;q<G.length;q++)q>0&&(this.formatted+=" "),this.formatted+=G[q].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(L){const q=((this.options.includePrerelease&&p)|(this.options.loose&&g))+":"+L,V=i.get(q);if(V)return V;const U=this.options.loose,ie=U?l[u.HYPHENRANGELOOSE]:l[u.HYPHENRANGE];L=L.replace(ie,B(this.options.includePrerelease)),o("hyphen replace",L),L=L.replace(l[u.COMPARATORTRIM],c),o("comparator trim",L),L=L.replace(l[u.TILDETRIM],d),o("tilde trim",L),L=L.replace(l[u.CARETTRIM],h),o("caret trim",L);let pe=L.split(" ").map(Me=>b(Me,this.options)).join(" ").split(/\s+/).map(Me=>O(Me,this.options));U&&(pe=pe.filter(Me=>(o("loose invalid filter",Me,this.options),!!Me.match(l[u.COMPARATORLOOSE])))),o("range list",pe);const K=new Map,Fe=pe.map(Me=>new s(Me,this.options));for(const Me of Fe){if(m(Me))return[Me];K.set(Me.value,Me)}K.size>1&&K.has("")&&K.delete("");const Je=[...K.values()];return i.set(q,Je),Je}intersects(L,G){if(!(L instanceof t))throw new TypeError("a Range is required");return this.set.some(q=>y(q,G)&&L.set.some(V=>y(V,G)&&q.every(U=>V.every(ie=>U.intersects(ie,G)))))}test(L){if(!L)return!1;if(typeof L=="string")try{L=new a(L,this.options)}catch{return!1}for(let G=0;G<this.set.length;G++)if(H(this.set[G],L,this.options))return!0;return!1}}TD=t;const n=PVe(),i=new n,r=eN(),s=BVe(),o=VR(),a=iN(),{safeRe:l,t:u,comparatorTrimReplace:c,tildeTrimReplace:d,caretTrimReplace:h}=nN(),{FLAG_INCLUDE_PRERELEASE:p,FLAG_LOOSE:g}=tN(),m=N=>N.value==="<0.0.0-0",C=N=>N.value==="",y=(N,L)=>{let G=!0;const q=N.slice();let V=q.pop();for(;G&&q.length;)G=q.every(U=>V.intersects(U,L)),V=q.pop();return G},b=(N,L)=>(o("comp",N,L),N=A(N,L),o("caret",N),N=x(N,L),o("tildes",N),N=P(N,L),o("xrange",N),N=M(N,L),o("stars",N),N),S=N=>!N||N.toLowerCase()==="x"||N==="*",x=(N,L)=>N.trim().split(/\s+/).map(G=>E(G,L)).join(" "),E=(N,L)=>{const G=L.loose?l[u.TILDELOOSE]:l[u.TILDE];return N.replace(G,(q,V,U,ie,pe)=>{o("tilde",N,q,V,U,ie,pe);let K;return S(V)?K="":S(U)?K=`>=${V}.0.0 <${+V+1}.0.0-0`:S(ie)?K=`>=${V}.${U}.0 <${V}.${+U+1}.0-0`:pe?(o("replaceTilde pr",pe),K=`>=${V}.${U}.${ie}-${pe} <${V}.${+U+1}.0-0`):K=`>=${V}.${U}.${ie} <${V}.${+U+1}.0-0`,o("tilde return",K),K})},A=(N,L)=>N.trim().split(/\s+/).map(G=>F(G,L)).join(" "),F=(N,L)=>{o("caret",N,L);const G=L.loose?l[u.CARETLOOSE]:l[u.CARET],q=L.includePrerelease?"-0":"";return N.replace(G,(V,U,ie,pe,K)=>{o("caret",N,V,U,ie,pe,K);let Fe;return S(U)?Fe="":S(ie)?Fe=`>=${U}.0.0${q} <${+U+1}.0.0-0`:S(pe)?U==="0"?Fe=`>=${U}.${ie}.0${q} <${U}.${+ie+1}.0-0`:Fe=`>=${U}.${ie}.0${q} <${+U+1}.0.0-0`:K?(o("replaceCaret pr",K),U==="0"?ie==="0"?Fe=`>=${U}.${ie}.${pe}-${K} <${U}.${ie}.${+pe+1}-0`:Fe=`>=${U}.${ie}.${pe}-${K} <${U}.${+ie+1}.0-0`:Fe=`>=${U}.${ie}.${pe}-${K} <${+U+1}.0.0-0`):(o("no pr"),U==="0"?ie==="0"?Fe=`>=${U}.${ie}.${pe}${q} <${U}.${ie}.${+pe+1}-0`:Fe=`>=${U}.${ie}.${pe}${q} <${U}.${+ie+1}.0-0`:Fe=`>=${U}.${ie}.${pe} <${+U+1}.0.0-0`),o("caret return",Fe),Fe})},P=(N,L)=>(o("replaceXRanges",N,L),N.split(/\s+/).map(G=>D(G,L)).join(" ")),D=(N,L)=>{N=N.trim();const G=L.loose?l[u.XRANGELOOSE]:l[u.XRANGE];return N.replace(G,(q,V,U,ie,pe,K)=>{o("xRange",N,q,V,U,ie,pe,K);const Fe=S(U),Je=Fe||S(ie),Me=Je||S(pe),De=Me;return V==="="&&De&&(V=""),K=L.includePrerelease?"-0":"",Fe?V===">"||V==="<"?q="<0.0.0-0":q="*":V&&De?(Je&&(ie=0),pe=0,V===">"?(V=">=",Je?(U=+U+1,ie=0,pe=0):(ie=+ie+1,pe=0)):V==="<="&&(V="<",Je?U=+U+1:ie=+ie+1),V==="<"&&(K="-0"),q=`${V+U}.${ie}.${pe}${K}`):Je?q=`>=${U}.0.0${K} <${+U+1}.0.0-0`:Me&&(q=`>=${U}.${ie}.0${K} <${U}.${+ie+1}.0-0`),o("xRange return",q),q})},M=(N,L)=>(o("replaceStars",N,L),N.trim().replace(l[u.STAR],"")),O=(N,L)=>(o("replaceGTE0",N,L),N.trim().replace(l[L.includePrerelease?u.GTE0PRE:u.GTE0],"")),B=N=>(L,G,q,V,U,ie,pe,K,Fe,Je,Me,De)=>(S(q)?G="":S(V)?G=`>=${q}.0.0${N?"-0":""}`:S(U)?G=`>=${q}.${V}.0${N?"-0":""}`:ie?G=`>=${G}`:G=`>=${G}${N?"-0":""}`,S(Fe)?K="":S(Je)?K=`<${+Fe+1}.0.0-0`:S(Me)?K=`<${Fe}.${+Je+1}.0-0`:De?K=`<=${Fe}.${Je}.${Me}-${De}`:N?K=`<${Fe}.${Je}.${+Me+1}-0`:K=`<=${K}`,`${G} ${K}`.trim()),H=(N,L,G)=>{for(let q=0;q<N.length;q++)if(!N[q].test(L))return!1;if(L.prerelease.length&&!G.includePrerelease){for(let q=0;q<N.length;q++)if(o(N[q].semver),N[q].semver!==s.ANY&&N[q].semver.prerelease.length>0){const V=N[q].semver;if(V.major===L.major&&V.minor===L.minor&&V.patch===L.patch)return!0}return!1}return!0};return TD}var ID,iW;function GVe(){if(iW)return ID;iW=1;const e=qJ();return ID=(n,i,r)=>{try{i=new e(i,r)}catch{return!1}return i.test(n)},ID}var zVe=GVe(),jJ=kVe(zVe);function HVe(e,t,n){const i=e.open(t),r=250,{origin:s}=new URL(t);let o=40;function a(u){u.source===i&&(o=0,e.removeEventListener("message",a,!1))}e.addEventListener("message",a,!1);function l(){o<=0||(i.postMessage(n,s),setTimeout(l,r),o-=1)}setTimeout(l,r)}var VVe=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box;
}
.vega-embed.has-actions {
  padding-right: 38px;
}
.vega-embed details:not([open]) > :not(summary) {
  display: none !important;
}
.vega-embed summary {
  list-style: none;
  position: absolute;
  top: 0;
  right: 0;
  padding: 6px;
  z-index: 1000;
  background: white;
  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
  color: #1b1e23;
  border: 1px solid #aaa;
  border-radius: 999px;
  opacity: 0.2;
  transition: opacity 0.4s ease-in;
  cursor: pointer;
  line-height: 0px;
}
.vega-embed summary::-webkit-details-marker {
  display: none;
}
.vega-embed summary:active {
  box-shadow: #aaa 0px 0px 0px 1px inset;
}
.vega-embed summary svg {
  width: 14px;
  height: 14px;
}
.vega-embed details[open] summary {
  opacity: 0.7;
}
.vega-embed:hover summary, .vega-embed:focus-within summary {
  opacity: 1 !important;
  transition: opacity 0.2s ease;
}
.vega-embed .vega-actions {
  position: absolute;
  z-index: 1001;
  top: 35px;
  right: -9px;
  display: flex;
  flex-direction: column;
  padding-bottom: 8px;
  padding-top: 8px;
  border-radius: 4px;
  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
  border: 1px solid #d9d9d9;
  background: white;
  animation-duration: 0.15s;
  animation-name: scale-in;
  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
  text-align: left;
}
.vega-embed .vega-actions a {
  padding: 8px 16px;
  font-family: sans-serif;
  font-size: 14px;
  font-weight: 600;
  white-space: nowrap;
  color: #434a56;
  text-decoration: none;
}
.vega-embed .vega-actions a:hover, .vega-embed .vega-actions a:focus {
  background-color: #f7f7f9;
  color: black;
}
.vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
  content: "";
  display: inline-block;
  position: absolute;
}
.vega-embed .vega-actions::before {
  left: auto;
  right: 14px;
  top: -16px;
  border: 8px solid rgba(0, 0, 0, 0);
  border-bottom-color: #d9d9d9;
}
.vega-embed .vega-actions::after {
  left: auto;
  right: 15px;
  top: -14px;
  border: 7px solid rgba(0, 0, 0, 0);
  border-bottom-color: #fff;
}
.vega-embed .chart-wrapper.fit-x {
  width: 100%;
}
.vega-embed .chart-wrapper.fit-y {
  height: 100%;
}

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px;
}

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}
`;function KJ(e,...t){for(const n of t)WVe(e,n);return e}function WVe(e,t){for(const n of Object.keys(t))Xp(e,n,t[n],!0)}const ia=D2e;let C0=CHe;const rW=typeof window<"u"?window:void 0;C0===void 0&&rW?.vl?.compile&&(C0=rW.vl);const UVe={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},qVe={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},ov={vega:"Vega","vega-lite":"Vega-Lite"},n1={vega:ia.version,"vega-lite":C0?C0.version:"not available"},jVe={vega:e=>e,"vega-lite":(e,t)=>C0.compile(e,{config:t}).spec},KVe=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,YVe="chart-wrapper";function XVe(e){return typeof e=="function"}function sW(e,t,n,i){const r=`<html><head>${t}</head><body><pre><code class="json">`,s=`</code></pre>${n}</body></html>`,o=window.open("");o.document.write(r+e+s),o.document.title=`${ov[i]} JSON Source`}function QVe(e,t){if(e.$schema){const n=LJ(e.$schema);t&&t!==n.library&&console.warn(`The given visualization spec is written in ${ov[n.library]}, but mode argument sets ${ov[t]??t}.`);const i=n.library;return jJ(n1[i],`^${n.version.slice(1)}`)||console.warn(`The input spec uses ${ov[i]} ${n.version}, but the current version of ${ov[i]} is v${n1[i]}.`),i}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t??"vega"}function YJ(e){return!!(e&&"load"in e)}function oW(e){return YJ(e)?e:ia.loader(e)}function ZVe(e){const t=e.usermeta?.embedOptions??{};return Re(t.defaultStyle)&&(t.defaultStyle=!1),t}async function JVe(e,t,n={}){let i,r;Re(t)?(r=oW(n.loader),i=JSON.parse(await r.load(t))):i=t;const s=ZVe(i),o=s.loader;(!r||o)&&(r=oW(n.loader??o));const a=await aW(s,r),l=await aW(n,r),u={...KJ(l,a),config:Yp(l.config??{},a.config??{})};return await t5e(e,i,u,r)}async function aW(e,t){const n=Re(e.config)?JSON.parse(await t.load(e.config)):e.config??{},i=Re(e.patch)?JSON.parse(await t.load(e.patch)):e.patch;return{...e,...i?{patch:i}:{},...n?{config:n}:{}}}function e5e(e){const t=e.getRootNode?e.getRootNode():document;return t instanceof ShadowRoot?{root:t,rootContainer:t}:{root:document,rootContainer:document.head??document.body}}async function t5e(e,t,n={},i){const r=n.theme?Yp(iVe[n.theme],n.config??{}):n.config,s=yc(n.actions)?n.actions:KJ({},UVe,n.actions??{}),o={...qVe,...n.i18n},a=n.renderer??"canvas",l=n.logLevel??ia.Warn,u=n.downloadFileName??"visualization",c=typeof e=="string"?document.querySelector(e):e;if(!c)throw new Error(`${e} does not exist`);if(n.defaultStyle!==!1){const E="vega-embed-style",{root:A,rootContainer:F}=e5e(c);if(!A.getElementById(E)){const P=document.createElement("style");P.id=E,P.innerHTML=n.defaultStyle===void 0||n.defaultStyle===!0?VVe.toString():n.defaultStyle,F.appendChild(P)}}const d=QVe(t,n.mode);let h=jVe[d](t,r);if(d==="vega-lite"&&h.$schema){const E=LJ(h.$schema);jJ(n1.vega,`^${E.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${E.version}, but current version is v${n1.vega}.`)}c.classList.add("vega-embed"),s&&c.classList.add("has-actions"),c.innerHTML="";let p=c;if(s){const E=document.createElement("div");E.classList.add(YVe),c.appendChild(E),p=E}const g=n.patch;if(g&&(h=g instanceof Function?g(h):HR(h,g,!0,!1).newDocument),n.formatLocale&&ia.formatLocale(n.formatLocale),n.timeFormatLocale&&ia.timeFormatLocale(n.timeFormatLocale),n.expressionFunctions)for(const E in n.expressionFunctions){const A=n.expressionFunctions[E];"fn"in A?ia.expressionFunction(E,A.fn,A.visitor):A instanceof Function&&ia.expressionFunction(E,A)}const{ast:m}=n,C=ia.parse(h,d==="vega-lite"?{}:r,{ast:m}),y=new(n.viewClass||ia.View)(C,{loader:i,logLevel:l,renderer:a,...m?{expr:ia.expressionInterpreter??n.expr??$2e}:{}});if(y.addSignalListener("autosize",(E,A)=>{const{type:F}=A;F=="fit-x"?(p.classList.add("fit-x"),p.classList.remove("fit-y")):F=="fit-y"?(p.classList.remove("fit-x"),p.classList.add("fit-y")):F=="fit"?p.classList.add("fit-x","fit-y"):p.classList.remove("fit-x","fit-y")}),n.tooltip!==!1){const{loader:E,tooltip:A}=n,F=E&&!YJ(E)?E?.baseURL:void 0,P=XVe(A)?A:new fVe({baseURL:F,...A===!0?{}:A}).call;y.tooltip(P)}let{hover:b}=n;if(b===void 0&&(b=d==="vega"),b){const{hoverSet:E,updateSet:A}=typeof b=="boolean"?{}:b;y.hover(E,A)}n&&(n.width!=null&&y.width(n.width),n.height!=null&&y.height(n.height),n.padding!=null&&y.padding(n.padding)),await y.initialize(p,n.bind).runAsync();let S;if(s!==!1){let E=c;if(n.defaultStyle!==!1||n.forceActionsMenu){const F=document.createElement("details");F.title=o.CLICK_TO_VIEW_ACTIONS,c.append(F),E=F;const P=document.createElement("summary");P.innerHTML=KVe,F.append(P),S=D=>{F.contains(D.target)||F.removeAttribute("open")},document.addEventListener("click",S)}const A=document.createElement("div");if(E.append(A),A.classList.add("vega-actions"),s===!0||s.export!==!1){for(const F of["svg","png"])if(s===!0||s.export===!0||s.export[F]){const P=o[`${F.toUpperCase()}_ACTION`],D=document.createElement("a"),M=be(n.scaleFactor)?n.scaleFactor[F]:n.scaleFactor;D.text=P,D.href="#",D.target="_blank",D.download=`${u}.${F}`,D.addEventListener("mousedown",async function(O){O.preventDefault();const B=await y.toImageURL(F,M);this.href=B}),A.append(D)}}if(s===!0||s.source!==!1){const F=document.createElement("a");F.text=o.SOURCE_ACTION,F.href="#",F.addEventListener("click",function(P){sW(WF(t),n.sourceHeader??"",n.sourceFooter??"",d),P.preventDefault()}),A.append(F)}if(d==="vega-lite"&&(s===!0||s.compiled!==!1)){const F=document.createElement("a");F.text=o.COMPILED_ACTION,F.href="#",F.addEventListener("click",function(P){sW(WF(h),n.sourceHeader??"",n.sourceFooter??"","vega"),P.preventDefault()}),A.append(F)}if(s===!0||s.editor!==!1){const F=n.editorUrl??"https://vega.github.io/editor/",P=document.createElement("a");P.text=o.EDITOR_ACTION,P.href="#",P.addEventListener("click",function(D){HVe(window,F,{config:r,mode:g?"vega":d,renderer:a,spec:WF(g?h:t)}),D.preventDefault()}),A.append(P)}}function x(){S&&document.removeEventListener("click",S),y.finalize()}return{view:y,spec:t,vgSpec:h,finalize:x,embedOptions:n}}const n5e={key:0,class:"error-message"},i5e=mh({__name:"VegaLite",props:{spec:{type:String,required:!0}},setup(e){const t=e,n=Qe(),i=Qe();function r(){let s;try{s=JSON.parse(t.spec)}catch(o){o instanceof Error?(console.error("Error parsing spec",o),i.value="Error parsing spec: "+o.message):(console.error("Error parsing spec: Non-error value",o),i.value="Error parsing spec: Unknown error"),n.value.innerHTML="";return}JVe(n.value,s).then(o=>{console.log("Chart rendered successfully"),i.value=null}).catch(o=>{console.error("Error rendering chart",o),i.value="Error rendering chart: "+o.toString(),n.value.innerHTML=""})}return Cc(()=>{r()}),Yt(()=>t.spec,r),(s,o)=>(Dn(),hi(Gv,null,[K4("div",{ref_key:"vegaContainer",ref:n,class:"vega-chart-container"},null,512),i.value?(Dn(),hi("div",n5e,O1(i.value),1)):Ek("",!0)],64))}}),r5e=L1(i5e,[["__scopeId","data-v-bd58cf71"]]);var av={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var s5e=av.exports,lW;function o5e(){return lW||(lW=1,function(e,t){(function(){var n,i="4.17.21",r=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",a="Invalid `variable` option passed into `_.template`",l="__lodash_hash_undefined__",u=500,c="__lodash_placeholder__",d=1,h=2,p=4,g=1,m=2,C=1,y=2,b=4,S=8,x=16,E=32,A=64,F=128,P=256,D=512,M=30,O="...",B=800,H=16,N=1,L=2,G=3,q=1/0,V=9007199254740991,U=17976931348623157e292,ie=NaN,pe=4294967295,K=pe-1,Fe=pe>>>1,Je=[["ary",F],["bind",C],["bindKey",y],["curry",S],["curryRight",x],["flip",D],["partial",E],["partialRight",A],["rearg",P]],Me="[object Arguments]",De="[object Array]",xt="[object AsyncFunction]",En="[object Boolean]",Se="[object Date]",je="[object DOMException]",et="[object Error]",ce="[object Function]",On="[object GeneratorFunction]",rt="[object Map]",gn="[object Number]",Ln="[object Null]",Nn="[object Object]",Gc="[object Promise]",mse="[object Proxy]",Lg="[object RegExp]",eo="[object Set]",Ng="[object String]",qC="[object Symbol]",vse="[object Undefined]",$g="[object WeakMap]",Cse="[object WeakSet]",Bg="[object ArrayBuffer]",Hh="[object DataView]",gE="[object Float32Array]",mE="[object Float64Array]",vE="[object Int8Array]",CE="[object Int16Array]",yE="[object Int32Array]",wE="[object Uint8Array]",bE="[object Uint8ClampedArray]",SE="[object Uint16Array]",xE="[object Uint32Array]",yse=/\b__p \+= '';/g,wse=/\b(__p \+=) '' \+/g,bse=/(__e\(.*?\)|\b__t\)) \+\n'';/g,A$=/&(?:amp|lt|gt|quot|#39);/g,D$=/[&<>"']/g,Sse=RegExp(A$.source),xse=RegExp(D$.source),Rse=/<%-([\s\S]+?)%>/g,Ese=/<%([\s\S]+?)%>/g,k$=/<%=([\s\S]+?)%>/g,Fse=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ase=/^\w*$/,Dse=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,RE=/[\\^$.*+?()[\]{}|]/g,kse=RegExp(RE.source),EE=/^\s+/,Pse=/\s/,Mse=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Tse=/\{\n\/\* \[wrapped with (.+)\] \*/,Ise=/,? & /,_se=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ose=/[()=,{}\[\]\/\s]/,Lse=/\\(\\)?/g,Nse=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,P$=/\w*$/,$se=/^[-+]0x[0-9a-f]+$/i,Bse=/^0b[01]+$/i,Gse=/^\[object .+?Constructor\]$/,zse=/^0o[0-7]+$/i,Hse=/^(?:0|[1-9]\d*)$/,Vse=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,jC=/($^)/,Wse=/['\n\r\u2028\u2029\\]/g,KC="\\ud800-\\udfff",Use="\\u0300-\\u036f",qse="\\ufe20-\\ufe2f",jse="\\u20d0-\\u20ff",M$=Use+qse+jse,T$="\\u2700-\\u27bf",I$="a-z\\xdf-\\xf6\\xf8-\\xff",Kse="\\xac\\xb1\\xd7\\xf7",Yse="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Xse="\\u2000-\\u206f",Qse=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",_$="A-Z\\xc0-\\xd6\\xd8-\\xde",O$="\\ufe0e\\ufe0f",L$=Kse+Yse+Xse+Qse,FE="[']",Zse="["+KC+"]",N$="["+L$+"]",YC="["+M$+"]",$$="\\d+",Jse="["+T$+"]",B$="["+I$+"]",G$="[^"+KC+L$+$$+T$+I$+_$+"]",AE="\\ud83c[\\udffb-\\udfff]",eoe="(?:"+YC+"|"+AE+")",z$="[^"+KC+"]",DE="(?:\\ud83c[\\udde6-\\uddff]){2}",kE="[\\ud800-\\udbff][\\udc00-\\udfff]",Vh="["+_$+"]",H$="\\u200d",V$="(?:"+B$+"|"+G$+")",toe="(?:"+Vh+"|"+G$+")",W$="(?:"+FE+"(?:d|ll|m|re|s|t|ve))?",U$="(?:"+FE+"(?:D|LL|M|RE|S|T|VE))?",q$=eoe+"?",j$="["+O$+"]?",noe="(?:"+H$+"(?:"+[z$,DE,kE].join("|")+")"+j$+q$+")*",ioe="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",roe="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",K$=j$+q$+noe,soe="(?:"+[Jse,DE,kE].join("|")+")"+K$,ooe="(?:"+[z$+YC+"?",YC,DE,kE,Zse].join("|")+")",aoe=RegExp(FE,"g"),loe=RegExp(YC,"g"),PE=RegExp(AE+"(?="+AE+")|"+ooe+K$,"g"),uoe=RegExp([Vh+"?"+B$+"+"+W$+"(?="+[N$,Vh,"$"].join("|")+")",toe+"+"+U$+"(?="+[N$,Vh+V$,"$"].join("|")+")",Vh+"?"+V$+"+"+W$,Vh+"+"+U$,roe,ioe,$$,soe].join("|"),"g"),coe=RegExp("["+H$+KC+M$+O$+"]"),doe=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,hoe=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],foe=-1,Zt={};Zt[gE]=Zt[mE]=Zt[vE]=Zt[CE]=Zt[yE]=Zt[wE]=Zt[bE]=Zt[SE]=Zt[xE]=!0,Zt[Me]=Zt[De]=Zt[Bg]=Zt[En]=Zt[Hh]=Zt[Se]=Zt[et]=Zt[ce]=Zt[rt]=Zt[gn]=Zt[Nn]=Zt[Lg]=Zt[eo]=Zt[Ng]=Zt[$g]=!1;var jt={};jt[Me]=jt[De]=jt[Bg]=jt[Hh]=jt[En]=jt[Se]=jt[gE]=jt[mE]=jt[vE]=jt[CE]=jt[yE]=jt[rt]=jt[gn]=jt[Nn]=jt[Lg]=jt[eo]=jt[Ng]=jt[qC]=jt[wE]=jt[bE]=jt[SE]=jt[xE]=!0,jt[et]=jt[ce]=jt[$g]=!1;var poe={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},goe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},moe={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},voe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Coe=parseFloat,yoe=parseInt,Y$=typeof Ly=="object"&&Ly&&Ly.Object===Object&&Ly,woe=typeof self=="object"&&self&&self.Object===Object&&self,ui=Y$||woe||Function("return this")(),ME=t&&!t.nodeType&&t,zc=ME&&!0&&e&&!e.nodeType&&e,X$=zc&&zc.exports===ME,TE=X$&&Y$.process,fs=function(){try{var W=zc&&zc.require&&zc.require("util").types;return W||TE&&TE.binding&&TE.binding("util")}catch{}}(),Q$=fs&&fs.isArrayBuffer,Z$=fs&&fs.isDate,J$=fs&&fs.isMap,eB=fs&&fs.isRegExp,tB=fs&&fs.isSet,nB=fs&&fs.isTypedArray;function Gr(W,ee,Y){switch(Y.length){case 0:return W.call(ee);case 1:return W.call(ee,Y[0]);case 2:return W.call(ee,Y[0],Y[1]);case 3:return W.call(ee,Y[0],Y[1],Y[2])}return W.apply(ee,Y)}function boe(W,ee,Y,ke){for(var Ze=-1,Tt=W==null?0:W.length;++Ze<Tt;){var Gn=W[Ze];ee(ke,Gn,Y(Gn),W)}return ke}function ps(W,ee){for(var Y=-1,ke=W==null?0:W.length;++Y<ke&&ee(W[Y],Y,W)!==!1;);return W}function Soe(W,ee){for(var Y=W==null?0:W.length;Y--&&ee(W[Y],Y,W)!==!1;);return W}function iB(W,ee){for(var Y=-1,ke=W==null?0:W.length;++Y<ke;)if(!ee(W[Y],Y,W))return!1;return!0}function cu(W,ee){for(var Y=-1,ke=W==null?0:W.length,Ze=0,Tt=[];++Y<ke;){var Gn=W[Y];ee(Gn,Y,W)&&(Tt[Ze++]=Gn)}return Tt}function XC(W,ee){var Y=W==null?0:W.length;return!!Y&&Wh(W,ee,0)>-1}function IE(W,ee,Y){for(var ke=-1,Ze=W==null?0:W.length;++ke<Ze;)if(Y(ee,W[ke]))return!0;return!1}function rn(W,ee){for(var Y=-1,ke=W==null?0:W.length,Ze=Array(ke);++Y<ke;)Ze[Y]=ee(W[Y],Y,W);return Ze}function du(W,ee){for(var Y=-1,ke=ee.length,Ze=W.length;++Y<ke;)W[Ze+Y]=ee[Y];return W}function _E(W,ee,Y,ke){var Ze=-1,Tt=W==null?0:W.length;for(ke&&Tt&&(Y=W[++Ze]);++Ze<Tt;)Y=ee(Y,W[Ze],Ze,W);return Y}function xoe(W,ee,Y,ke){var Ze=W==null?0:W.length;for(ke&&Ze&&(Y=W[--Ze]);Ze--;)Y=ee(Y,W[Ze],Ze,W);return Y}function OE(W,ee){for(var Y=-1,ke=W==null?0:W.length;++Y<ke;)if(ee(W[Y],Y,W))return!0;return!1}var Roe=LE("length");function Eoe(W){return W.split("")}function Foe(W){return W.match(_se)||[]}function rB(W,ee,Y){var ke;return Y(W,function(Ze,Tt,Gn){if(ee(Ze,Tt,Gn))return ke=Tt,!1}),ke}function QC(W,ee,Y,ke){for(var Ze=W.length,Tt=Y+(ke?1:-1);ke?Tt--:++Tt<Ze;)if(ee(W[Tt],Tt,W))return Tt;return-1}function Wh(W,ee,Y){return ee===ee?$oe(W,ee,Y):QC(W,sB,Y)}function Aoe(W,ee,Y,ke){for(var Ze=Y-1,Tt=W.length;++Ze<Tt;)if(ke(W[Ze],ee))return Ze;return-1}function sB(W){return W!==W}function oB(W,ee){var Y=W==null?0:W.length;return Y?$E(W,ee)/Y:ie}function LE(W){return function(ee){return ee==null?n:ee[W]}}function NE(W){return function(ee){return W==null?n:W[ee]}}function aB(W,ee,Y,ke,Ze){return Ze(W,function(Tt,Gn,Ut){Y=ke?(ke=!1,Tt):ee(Y,Tt,Gn,Ut)}),Y}function Doe(W,ee){var Y=W.length;for(W.sort(ee);Y--;)W[Y]=W[Y].value;return W}function $E(W,ee){for(var Y,ke=-1,Ze=W.length;++ke<Ze;){var Tt=ee(W[ke]);Tt!==n&&(Y=Y===n?Tt:Y+Tt)}return Y}function BE(W,ee){for(var Y=-1,ke=Array(W);++Y<W;)ke[Y]=ee(Y);return ke}function koe(W,ee){return rn(ee,function(Y){return[Y,W[Y]]})}function lB(W){return W&&W.slice(0,hB(W)+1).replace(EE,"")}function zr(W){return function(ee){return W(ee)}}function GE(W,ee){return rn(ee,function(Y){return W[Y]})}function Gg(W,ee){return W.has(ee)}function uB(W,ee){for(var Y=-1,ke=W.length;++Y<ke&&Wh(ee,W[Y],0)>-1;);return Y}function cB(W,ee){for(var Y=W.length;Y--&&Wh(ee,W[Y],0)>-1;);return Y}function Poe(W,ee){for(var Y=W.length,ke=0;Y--;)W[Y]===ee&&++ke;return ke}var Moe=NE(poe),Toe=NE(goe);function Ioe(W){return"\\"+voe[W]}function _oe(W,ee){return W==null?n:W[ee]}function Uh(W){return coe.test(W)}function Ooe(W){return doe.test(W)}function Loe(W){for(var ee,Y=[];!(ee=W.next()).done;)Y.push(ee.value);return Y}function zE(W){var ee=-1,Y=Array(W.size);return W.forEach(function(ke,Ze){Y[++ee]=[Ze,ke]}),Y}function dB(W,ee){return function(Y){return W(ee(Y))}}function hu(W,ee){for(var Y=-1,ke=W.length,Ze=0,Tt=[];++Y<ke;){var Gn=W[Y];(Gn===ee||Gn===c)&&(W[Y]=c,Tt[Ze++]=Y)}return Tt}function ZC(W){var ee=-1,Y=Array(W.size);return W.forEach(function(ke){Y[++ee]=ke}),Y}function Noe(W){var ee=-1,Y=Array(W.size);return W.forEach(function(ke){Y[++ee]=[ke,ke]}),Y}function $oe(W,ee,Y){for(var ke=Y-1,Ze=W.length;++ke<Ze;)if(W[ke]===ee)return ke;return-1}function Boe(W,ee,Y){for(var ke=Y+1;ke--;)if(W[ke]===ee)return ke;return ke}function qh(W){return Uh(W)?zoe(W):Roe(W)}function to(W){return Uh(W)?Hoe(W):Eoe(W)}function hB(W){for(var ee=W.length;ee--&&Pse.test(W.charAt(ee)););return ee}var Goe=NE(moe);function zoe(W){for(var ee=PE.lastIndex=0;PE.test(W);)++ee;return ee}function Hoe(W){return W.match(PE)||[]}function Voe(W){return W.match(uoe)||[]}var Woe=function W(ee){ee=ee==null?ui:jh.defaults(ui.Object(),ee,jh.pick(ui,hoe));var Y=ee.Array,ke=ee.Date,Ze=ee.Error,Tt=ee.Function,Gn=ee.Math,Ut=ee.Object,HE=ee.RegExp,Uoe=ee.String,gs=ee.TypeError,JC=Y.prototype,qoe=Tt.prototype,Kh=Ut.prototype,ey=ee["__core-js_shared__"],ty=qoe.toString,Nt=Kh.hasOwnProperty,joe=0,fB=function(){var f=/[^.]+$/.exec(ey&&ey.keys&&ey.keys.IE_PROTO||"");return f?"Symbol(src)_1."+f:""}(),ny=Kh.toString,Koe=ty.call(Ut),Yoe=ui._,Xoe=HE("^"+ty.call(Nt).replace(RE,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),iy=X$?ee.Buffer:n,fu=ee.Symbol,ry=ee.Uint8Array,pB=iy?iy.allocUnsafe:n,sy=dB(Ut.getPrototypeOf,Ut),gB=Ut.create,mB=Kh.propertyIsEnumerable,oy=JC.splice,vB=fu?fu.isConcatSpreadable:n,zg=fu?fu.iterator:n,Hc=fu?fu.toStringTag:n,ay=function(){try{var f=jc(Ut,"defineProperty");return f({},"",{}),f}catch{}}(),Qoe=ee.clearTimeout!==ui.clearTimeout&&ee.clearTimeout,Zoe=ke&&ke.now!==ui.Date.now&&ke.now,Joe=ee.setTimeout!==ui.setTimeout&&ee.setTimeout,ly=Gn.ceil,uy=Gn.floor,VE=Ut.getOwnPropertySymbols,eae=iy?iy.isBuffer:n,CB=ee.isFinite,tae=JC.join,nae=dB(Ut.keys,Ut),zn=Gn.max,Fi=Gn.min,iae=ke.now,rae=ee.parseInt,yB=Gn.random,sae=JC.reverse,WE=jc(ee,"DataView"),Hg=jc(ee,"Map"),UE=jc(ee,"Promise"),Yh=jc(ee,"Set"),Vg=jc(ee,"WeakMap"),Wg=jc(Ut,"create"),cy=Vg&&new Vg,Xh={},oae=Kc(WE),aae=Kc(Hg),lae=Kc(UE),uae=Kc(Yh),cae=Kc(Vg),dy=fu?fu.prototype:n,Ug=dy?dy.valueOf:n,wB=dy?dy.toString:n;function I(f){if(mn(f)&&!tt(f)&&!(f instanceof pt)){if(f instanceof ms)return f;if(Nt.call(f,"__wrapped__"))return bG(f)}return new ms(f)}var Qh=function(){function f(){}return function(v){if(!un(v))return{};if(gB)return gB(v);f.prototype=v;var w=new f;return f.prototype=n,w}}();function hy(){}function ms(f,v){this.__wrapped__=f,this.__actions__=[],this.__chain__=!!v,this.__index__=0,this.__values__=n}I.templateSettings={escape:Rse,evaluate:Ese,interpolate:k$,variable:"",imports:{_:I}},I.prototype=hy.prototype,I.prototype.constructor=I,ms.prototype=Qh(hy.prototype),ms.prototype.constructor=ms;function pt(f){this.__wrapped__=f,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=pe,this.__views__=[]}function dae(){var f=new pt(this.__wrapped__);return f.__actions__=mr(this.__actions__),f.__dir__=this.__dir__,f.__filtered__=this.__filtered__,f.__iteratees__=mr(this.__iteratees__),f.__takeCount__=this.__takeCount__,f.__views__=mr(this.__views__),f}function hae(){if(this.__filtered__){var f=new pt(this);f.__dir__=-1,f.__filtered__=!0}else f=this.clone(),f.__dir__*=-1;return f}function fae(){var f=this.__wrapped__.value(),v=this.__dir__,w=tt(f),R=v<0,k=w?f.length:0,_=Ele(0,k,this.__views__),$=_.start,z=_.end,j=z-$,re=R?z:$-1,se=this.__iteratees__,ae=se.length,Ee=0,_e=Fi(j,this.__takeCount__);if(!w||!R&&k==j&&_e==j)return WB(f,this.__actions__);var We=[];e:for(;j--&&Ee<_e;){re+=v;for(var at=-1,Ue=f[re];++at<ae;){var ft=se[at],vt=ft.iteratee,Wr=ft.type,Ui=vt(Ue);if(Wr==L)Ue=Ui;else if(!Ui){if(Wr==N)continue e;break e}}We[Ee++]=Ue}return We}pt.prototype=Qh(hy.prototype),pt.prototype.constructor=pt;function Vc(f){var v=-1,w=f==null?0:f.length;for(this.clear();++v<w;){var R=f[v];this.set(R[0],R[1])}}function pae(){this.__data__=Wg?Wg(null):{},this.size=0}function gae(f){var v=this.has(f)&&delete this.__data__[f];return this.size-=v?1:0,v}function mae(f){var v=this.__data__;if(Wg){var w=v[f];return w===l?n:w}return Nt.call(v,f)?v[f]:n}function vae(f){var v=this.__data__;return Wg?v[f]!==n:Nt.call(v,f)}function Cae(f,v){var w=this.__data__;return this.size+=this.has(f)?0:1,w[f]=Wg&&v===n?l:v,this}Vc.prototype.clear=pae,Vc.prototype.delete=gae,Vc.prototype.get=mae,Vc.prototype.has=vae,Vc.prototype.set=Cae;function Xa(f){var v=-1,w=f==null?0:f.length;for(this.clear();++v<w;){var R=f[v];this.set(R[0],R[1])}}function yae(){this.__data__=[],this.size=0}function wae(f){var v=this.__data__,w=fy(v,f);if(w<0)return!1;var R=v.length-1;return w==R?v.pop():oy.call(v,w,1),--this.size,!0}function bae(f){var v=this.__data__,w=fy(v,f);return w<0?n:v[w][1]}function Sae(f){return fy(this.__data__,f)>-1}function xae(f,v){var w=this.__data__,R=fy(w,f);return R<0?(++this.size,w.push([f,v])):w[R][1]=v,this}Xa.prototype.clear=yae,Xa.prototype.delete=wae,Xa.prototype.get=bae,Xa.prototype.has=Sae,Xa.prototype.set=xae;function Qa(f){var v=-1,w=f==null?0:f.length;for(this.clear();++v<w;){var R=f[v];this.set(R[0],R[1])}}function Rae(){this.size=0,this.__data__={hash:new Vc,map:new(Hg||Xa),string:new Vc}}function Eae(f){var v=Ey(this,f).delete(f);return this.size-=v?1:0,v}function Fae(f){return Ey(this,f).get(f)}function Aae(f){return Ey(this,f).has(f)}function Dae(f,v){var w=Ey(this,f),R=w.size;return w.set(f,v),this.size+=w.size==R?0:1,this}Qa.prototype.clear=Rae,Qa.prototype.delete=Eae,Qa.prototype.get=Fae,Qa.prototype.has=Aae,Qa.prototype.set=Dae;function Wc(f){var v=-1,w=f==null?0:f.length;for(this.__data__=new Qa;++v<w;)this.add(f[v])}function kae(f){return this.__data__.set(f,l),this}function Pae(f){return this.__data__.has(f)}Wc.prototype.add=Wc.prototype.push=kae,Wc.prototype.has=Pae;function no(f){var v=this.__data__=new Xa(f);this.size=v.size}function Mae(){this.__data__=new Xa,this.size=0}function Tae(f){var v=this.__data__,w=v.delete(f);return this.size=v.size,w}function Iae(f){return this.__data__.get(f)}function _ae(f){return this.__data__.has(f)}function Oae(f,v){var w=this.__data__;if(w instanceof Xa){var R=w.__data__;if(!Hg||R.length<r-1)return R.push([f,v]),this.size=++w.size,this;w=this.__data__=new Qa(R)}return w.set(f,v),this.size=w.size,this}no.prototype.clear=Mae,no.prototype.delete=Tae,no.prototype.get=Iae,no.prototype.has=_ae,no.prototype.set=Oae;function bB(f,v){var w=tt(f),R=!w&&Yc(f),k=!w&&!R&&Cu(f),_=!w&&!R&&!k&&tf(f),$=w||R||k||_,z=$?BE(f.length,Uoe):[],j=z.length;for(var re in f)(v||Nt.call(f,re))&&!($&&(re=="length"||k&&(re=="offset"||re=="parent")||_&&(re=="buffer"||re=="byteLength"||re=="byteOffset")||tl(re,j)))&&z.push(re);return z}function SB(f){var v=f.length;return v?f[nF(0,v-1)]:n}function Lae(f,v){return Fy(mr(f),Uc(v,0,f.length))}function Nae(f){return Fy(mr(f))}function qE(f,v,w){(w!==n&&!io(f[v],w)||w===n&&!(v in f))&&Za(f,v,w)}function qg(f,v,w){var R=f[v];(!(Nt.call(f,v)&&io(R,w))||w===n&&!(v in f))&&Za(f,v,w)}function fy(f,v){for(var w=f.length;w--;)if(io(f[w][0],v))return w;return-1}function $ae(f,v,w,R){return pu(f,function(k,_,$){v(R,k,w(k),$)}),R}function xB(f,v){return f&&Yo(v,Zn(v),f)}function Bae(f,v){return f&&Yo(v,Cr(v),f)}function Za(f,v,w){v=="__proto__"&&ay?ay(f,v,{configurable:!0,enumerable:!0,value:w,writable:!0}):f[v]=w}function jE(f,v){for(var w=-1,R=v.length,k=Y(R),_=f==null;++w<R;)k[w]=_?n:AF(f,v[w]);return k}function Uc(f,v,w){return f===f&&(w!==n&&(f=f<=w?f:w),v!==n&&(f=f>=v?f:v)),f}function vs(f,v,w,R,k,_){var $,z=v&d,j=v&h,re=v&p;if(w&&($=k?w(f,R,k,_):w(f)),$!==n)return $;if(!un(f))return f;var se=tt(f);if(se){if($=Ale(f),!z)return mr(f,$)}else{var ae=Ai(f),Ee=ae==ce||ae==On;if(Cu(f))return jB(f,z);if(ae==Nn||ae==Me||Ee&&!k){if($=j||Ee?{}:hG(f),!z)return j?mle(f,Bae($,f)):gle(f,xB($,f))}else{if(!jt[ae])return k?f:{};$=Dle(f,ae,z)}}_||(_=new no);var _e=_.get(f);if(_e)return _e;_.set(f,$),zG(f)?f.forEach(function(Ue){$.add(vs(Ue,v,w,Ue,f,_))}):BG(f)&&f.forEach(function(Ue,ft){$.set(ft,vs(Ue,v,w,ft,f,_))});var We=re?j?fF:hF:j?Cr:Zn,at=se?n:We(f);return ps(at||f,function(Ue,ft){at&&(ft=Ue,Ue=f[ft]),qg($,ft,vs(Ue,v,w,ft,f,_))}),$}function Gae(f){var v=Zn(f);return function(w){return RB(w,f,v)}}function RB(f,v,w){var R=w.length;if(f==null)return!R;for(f=Ut(f);R--;){var k=w[R],_=v[k],$=f[k];if($===n&&!(k in f)||!_($))return!1}return!0}function EB(f,v,w){if(typeof f!="function")throw new gs(o);return Jg(function(){f.apply(n,w)},v)}function jg(f,v,w,R){var k=-1,_=XC,$=!0,z=f.length,j=[],re=v.length;if(!z)return j;w&&(v=rn(v,zr(w))),R?(_=IE,$=!1):v.length>=r&&(_=Gg,$=!1,v=new Wc(v));e:for(;++k<z;){var se=f[k],ae=w==null?se:w(se);if(se=R||se!==0?se:0,$&&ae===ae){for(var Ee=re;Ee--;)if(v[Ee]===ae)continue e;j.push(se)}else _(v,ae,R)||j.push(se)}return j}var pu=ZB(Ko),FB=ZB(YE,!0);function zae(f,v){var w=!0;return pu(f,function(R,k,_){return w=!!v(R,k,_),w}),w}function py(f,v,w){for(var R=-1,k=f.length;++R<k;){var _=f[R],$=v(_);if($!=null&&(z===n?$===$&&!Vr($):w($,z)))var z=$,j=_}return j}function Hae(f,v,w,R){var k=f.length;for(w=st(w),w<0&&(w=-w>k?0:k+w),R=R===n||R>k?k:st(R),R<0&&(R+=k),R=w>R?0:VG(R);w<R;)f[w++]=v;return f}function AB(f,v){var w=[];return pu(f,function(R,k,_){v(R,k,_)&&w.push(R)}),w}function ci(f,v,w,R,k){var _=-1,$=f.length;for(w||(w=Ple),k||(k=[]);++_<$;){var z=f[_];v>0&&w(z)?v>1?ci(z,v-1,w,R,k):du(k,z):R||(k[k.length]=z)}return k}var KE=JB(),DB=JB(!0);function Ko(f,v){return f&&KE(f,v,Zn)}function YE(f,v){return f&&DB(f,v,Zn)}function gy(f,v){return cu(v,function(w){return nl(f[w])})}function qc(f,v){v=mu(v,f);for(var w=0,R=v.length;f!=null&&w<R;)f=f[Xo(v[w++])];return w&&w==R?f:n}function kB(f,v,w){var R=v(f);return tt(f)?R:du(R,w(f))}function Vi(f){return f==null?f===n?vse:Ln:Hc&&Hc in Ut(f)?Rle(f):Nle(f)}function XE(f,v){return f>v}function Vae(f,v){return f!=null&&Nt.call(f,v)}function Wae(f,v){return f!=null&&v in Ut(f)}function Uae(f,v,w){return f>=Fi(v,w)&&f<zn(v,w)}function QE(f,v,w){for(var R=w?IE:XC,k=f[0].length,_=f.length,$=_,z=Y(_),j=1/0,re=[];$--;){var se=f[$];$&&v&&(se=rn(se,zr(v))),j=Fi(se.length,j),z[$]=!w&&(v||k>=120&&se.length>=120)?new Wc($&&se):n}se=f[0];var ae=-1,Ee=z[0];e:for(;++ae<k&&re.length<j;){var _e=se[ae],We=v?v(_e):_e;if(_e=w||_e!==0?_e:0,!(Ee?Gg(Ee,We):R(re,We,w))){for($=_;--$;){var at=z[$];if(!(at?Gg(at,We):R(f[$],We,w)))continue e}Ee&&Ee.push(We),re.push(_e)}}return re}function qae(f,v,w,R){return Ko(f,function(k,_,$){v(R,w(k),_,$)}),R}function Kg(f,v,w){v=mu(v,f),f=mG(f,v);var R=f==null?f:f[Xo(ys(v))];return R==null?n:Gr(R,f,w)}function PB(f){return mn(f)&&Vi(f)==Me}function jae(f){return mn(f)&&Vi(f)==Bg}function Kae(f){return mn(f)&&Vi(f)==Se}function Yg(f,v,w,R,k){return f===v?!0:f==null||v==null||!mn(f)&&!mn(v)?f!==f&&v!==v:Yae(f,v,w,R,Yg,k)}function Yae(f,v,w,R,k,_){var $=tt(f),z=tt(v),j=$?De:Ai(f),re=z?De:Ai(v);j=j==Me?Nn:j,re=re==Me?Nn:re;var se=j==Nn,ae=re==Nn,Ee=j==re;if(Ee&&Cu(f)){if(!Cu(v))return!1;$=!0,se=!1}if(Ee&&!se)return _||(_=new no),$||tf(f)?uG(f,v,w,R,k,_):Sle(f,v,j,w,R,k,_);if(!(w&g)){var _e=se&&Nt.call(f,"__wrapped__"),We=ae&&Nt.call(v,"__wrapped__");if(_e||We){var at=_e?f.value():f,Ue=We?v.value():v;return _||(_=new no),k(at,Ue,w,R,_)}}return Ee?(_||(_=new no),xle(f,v,w,R,k,_)):!1}function Xae(f){return mn(f)&&Ai(f)==rt}function ZE(f,v,w,R){var k=w.length,_=k,$=!R;if(f==null)return!_;for(f=Ut(f);k--;){var z=w[k];if($&&z[2]?z[1]!==f[z[0]]:!(z[0]in f))return!1}for(;++k<_;){z=w[k];var j=z[0],re=f[j],se=z[1];if($&&z[2]){if(re===n&&!(j in f))return!1}else{var ae=new no;if(R)var Ee=R(re,se,j,f,v,ae);if(!(Ee===n?Yg(se,re,g|m,R,ae):Ee))return!1}}return!0}function MB(f){if(!un(f)||Tle(f))return!1;var v=nl(f)?Xoe:Gse;return v.test(Kc(f))}function Qae(f){return mn(f)&&Vi(f)==Lg}function Zae(f){return mn(f)&&Ai(f)==eo}function Jae(f){return mn(f)&&Ty(f.length)&&!!Zt[Vi(f)]}function TB(f){return typeof f=="function"?f:f==null?yr:typeof f=="object"?tt(f)?OB(f[0],f[1]):_B(f):e3(f)}function JE(f){if(!Zg(f))return nae(f);var v=[];for(var w in Ut(f))Nt.call(f,w)&&w!="constructor"&&v.push(w);return v}function ele(f){if(!un(f))return Lle(f);var v=Zg(f),w=[];for(var R in f)R=="constructor"&&(v||!Nt.call(f,R))||w.push(R);return w}function eF(f,v){return f<v}function IB(f,v){var w=-1,R=vr(f)?Y(f.length):[];return pu(f,function(k,_,$){R[++w]=v(k,_,$)}),R}function _B(f){var v=gF(f);return v.length==1&&v[0][2]?pG(v[0][0],v[0][1]):function(w){return w===f||ZE(w,f,v)}}function OB(f,v){return vF(f)&&fG(v)?pG(Xo(f),v):function(w){var R=AF(w,f);return R===n&&R===v?DF(w,f):Yg(v,R,g|m)}}function my(f,v,w,R,k){f!==v&&KE(v,function(_,$){if(k||(k=new no),un(_))tle(f,v,$,w,my,R,k);else{var z=R?R(yF(f,$),_,$+"",f,v,k):n;z===n&&(z=_),qE(f,$,z)}},Cr)}function tle(f,v,w,R,k,_,$){var z=yF(f,w),j=yF(v,w),re=$.get(j);if(re){qE(f,w,re);return}var se=_?_(z,j,w+"",f,v,$):n,ae=se===n;if(ae){var Ee=tt(j),_e=!Ee&&Cu(j),We=!Ee&&!_e&&tf(j);se=j,Ee||_e||We?tt(z)?se=z:Fn(z)?se=mr(z):_e?(ae=!1,se=jB(j,!0)):We?(ae=!1,se=KB(j,!0)):se=[]:em(j)||Yc(j)?(se=z,Yc(z)?se=WG(z):(!un(z)||nl(z))&&(se=hG(j))):ae=!1}ae&&($.set(j,se),k(se,j,R,_,$),$.delete(j)),qE(f,w,se)}function LB(f,v){var w=f.length;if(w)return v+=v<0?w:0,tl(v,w)?f[v]:n}function NB(f,v,w){v.length?v=rn(v,function(_){return tt(_)?function($){return qc($,_.length===1?_[0]:_)}:_}):v=[yr];var R=-1;v=rn(v,zr(Ve()));var k=IB(f,function(_,$,z){var j=rn(v,function(re){return re(_)});return{criteria:j,index:++R,value:_}});return Doe(k,function(_,$){return ple(_,$,w)})}function nle(f,v){return $B(f,v,function(w,R){return DF(f,R)})}function $B(f,v,w){for(var R=-1,k=v.length,_={};++R<k;){var $=v[R],z=qc(f,$);w(z,$)&&Xg(_,mu($,f),z)}return _}function ile(f){return function(v){return qc(v,f)}}function tF(f,v,w,R){var k=R?Aoe:Wh,_=-1,$=v.length,z=f;for(f===v&&(v=mr(v)),w&&(z=rn(f,zr(w)));++_<$;)for(var j=0,re=v[_],se=w?w(re):re;(j=k(z,se,j,R))>-1;)z!==f&&oy.call(z,j,1),oy.call(f,j,1);return f}function BB(f,v){for(var w=f?v.length:0,R=w-1;w--;){var k=v[w];if(w==R||k!==_){var _=k;tl(k)?oy.call(f,k,1):sF(f,k)}}return f}function nF(f,v){return f+uy(yB()*(v-f+1))}function rle(f,v,w,R){for(var k=-1,_=zn(ly((v-f)/(w||1)),0),$=Y(_);_--;)$[R?_:++k]=f,f+=w;return $}function iF(f,v){var w="";if(!f||v<1||v>V)return w;do v%2&&(w+=f),v=uy(v/2),v&&(f+=f);while(v);return w}function lt(f,v){return wF(gG(f,v,yr),f+"")}function sle(f){return SB(nf(f))}function ole(f,v){var w=nf(f);return Fy(w,Uc(v,0,w.length))}function Xg(f,v,w,R){if(!un(f))return f;v=mu(v,f);for(var k=-1,_=v.length,$=_-1,z=f;z!=null&&++k<_;){var j=Xo(v[k]),re=w;if(j==="__proto__"||j==="constructor"||j==="prototype")return f;if(k!=$){var se=z[j];re=R?R(se,j,z):n,re===n&&(re=un(se)?se:tl(v[k+1])?[]:{})}qg(z,j,re),z=z[j]}return f}var GB=cy?function(f,v){return cy.set(f,v),f}:yr,ale=ay?function(f,v){return ay(f,"toString",{configurable:!0,enumerable:!1,value:PF(v),writable:!0})}:yr;function lle(f){return Fy(nf(f))}function Cs(f,v,w){var R=-1,k=f.length;v<0&&(v=-v>k?0:k+v),w=w>k?k:w,w<0&&(w+=k),k=v>w?0:w-v>>>0,v>>>=0;for(var _=Y(k);++R<k;)_[R]=f[R+v];return _}function ule(f,v){var w;return pu(f,function(R,k,_){return w=v(R,k,_),!w}),!!w}function vy(f,v,w){var R=0,k=f==null?R:f.length;if(typeof v=="number"&&v===v&&k<=Fe){for(;R<k;){var _=R+k>>>1,$=f[_];$!==null&&!Vr($)&&(w?$<=v:$<v)?R=_+1:k=_}return k}return rF(f,v,yr,w)}function rF(f,v,w,R){var k=0,_=f==null?0:f.length;if(_===0)return 0;v=w(v);for(var $=v!==v,z=v===null,j=Vr(v),re=v===n;k<_;){var se=uy((k+_)/2),ae=w(f[se]),Ee=ae!==n,_e=ae===null,We=ae===ae,at=Vr(ae);if($)var Ue=R||We;else re?Ue=We&&(R||Ee):z?Ue=We&&Ee&&(R||!_e):j?Ue=We&&Ee&&!_e&&(R||!at):_e||at?Ue=!1:Ue=R?ae<=v:ae<v;Ue?k=se+1:_=se}return Fi(_,K)}function zB(f,v){for(var w=-1,R=f.length,k=0,_=[];++w<R;){var $=f[w],z=v?v($):$;if(!w||!io(z,j)){var j=z;_[k++]=$===0?0:$}}return _}function HB(f){return typeof f=="number"?f:Vr(f)?ie:+f}function Hr(f){if(typeof f=="string")return f;if(tt(f))return rn(f,Hr)+"";if(Vr(f))return wB?wB.call(f):"";var v=f+"";return v=="0"&&1/f==-1/0?"-0":v}function gu(f,v,w){var R=-1,k=XC,_=f.length,$=!0,z=[],j=z;if(w)$=!1,k=IE;else if(_>=r){var re=v?null:wle(f);if(re)return ZC(re);$=!1,k=Gg,j=new Wc}else j=v?[]:z;e:for(;++R<_;){var se=f[R],ae=v?v(se):se;if(se=w||se!==0?se:0,$&&ae===ae){for(var Ee=j.length;Ee--;)if(j[Ee]===ae)continue e;v&&j.push(ae),z.push(se)}else k(j,ae,w)||(j!==z&&j.push(ae),z.push(se))}return z}function sF(f,v){return v=mu(v,f),f=mG(f,v),f==null||delete f[Xo(ys(v))]}function VB(f,v,w,R){return Xg(f,v,w(qc(f,v)),R)}function Cy(f,v,w,R){for(var k=f.length,_=R?k:-1;(R?_--:++_<k)&&v(f[_],_,f););return w?Cs(f,R?0:_,R?_+1:k):Cs(f,R?_+1:0,R?k:_)}function WB(f,v){var w=f;return w instanceof pt&&(w=w.value()),_E(v,function(R,k){return k.func.apply(k.thisArg,du([R],k.args))},w)}function oF(f,v,w){var R=f.length;if(R<2)return R?gu(f[0]):[];for(var k=-1,_=Y(R);++k<R;)for(var $=f[k],z=-1;++z<R;)z!=k&&(_[k]=jg(_[k]||$,f[z],v,w));return gu(ci(_,1),v,w)}function UB(f,v,w){for(var R=-1,k=f.length,_=v.length,$={};++R<k;){var z=R<_?v[R]:n;w($,f[R],z)}return $}function aF(f){return Fn(f)?f:[]}function lF(f){return typeof f=="function"?f:yr}function mu(f,v){return tt(f)?f:vF(f,v)?[f]:wG(_t(f))}var cle=lt;function vu(f,v,w){var R=f.length;return w=w===n?R:w,!v&&w>=R?f:Cs(f,v,w)}var qB=Qoe||function(f){return ui.clearTimeout(f)};function jB(f,v){if(v)return f.slice();var w=f.length,R=pB?pB(w):new f.constructor(w);return f.copy(R),R}function uF(f){var v=new f.constructor(f.byteLength);return new ry(v).set(new ry(f)),v}function dle(f,v){var w=v?uF(f.buffer):f.buffer;return new f.constructor(w,f.byteOffset,f.byteLength)}function hle(f){var v=new f.constructor(f.source,P$.exec(f));return v.lastIndex=f.lastIndex,v}function fle(f){return Ug?Ut(Ug.call(f)):{}}function KB(f,v){var w=v?uF(f.buffer):f.buffer;return new f.constructor(w,f.byteOffset,f.length)}function YB(f,v){if(f!==v){var w=f!==n,R=f===null,k=f===f,_=Vr(f),$=v!==n,z=v===null,j=v===v,re=Vr(v);if(!z&&!re&&!_&&f>v||_&&$&&j&&!z&&!re||R&&$&&j||!w&&j||!k)return 1;if(!R&&!_&&!re&&f<v||re&&w&&k&&!R&&!_||z&&w&&k||!$&&k||!j)return-1}return 0}function ple(f,v,w){for(var R=-1,k=f.criteria,_=v.criteria,$=k.length,z=w.length;++R<$;){var j=YB(k[R],_[R]);if(j){if(R>=z)return j;var re=w[R];return j*(re=="desc"?-1:1)}}return f.index-v.index}function XB(f,v,w,R){for(var k=-1,_=f.length,$=w.length,z=-1,j=v.length,re=zn(_-$,0),se=Y(j+re),ae=!R;++z<j;)se[z]=v[z];for(;++k<$;)(ae||k<_)&&(se[w[k]]=f[k]);for(;re--;)se[z++]=f[k++];return se}function QB(f,v,w,R){for(var k=-1,_=f.length,$=-1,z=w.length,j=-1,re=v.length,se=zn(_-z,0),ae=Y(se+re),Ee=!R;++k<se;)ae[k]=f[k];for(var _e=k;++j<re;)ae[_e+j]=v[j];for(;++$<z;)(Ee||k<_)&&(ae[_e+w[$]]=f[k++]);return ae}function mr(f,v){var w=-1,R=f.length;for(v||(v=Y(R));++w<R;)v[w]=f[w];return v}function Yo(f,v,w,R){var k=!w;w||(w={});for(var _=-1,$=v.length;++_<$;){var z=v[_],j=R?R(w[z],f[z],z,w,f):n;j===n&&(j=f[z]),k?Za(w,z,j):qg(w,z,j)}return w}function gle(f,v){return Yo(f,mF(f),v)}function mle(f,v){return Yo(f,cG(f),v)}function yy(f,v){return function(w,R){var k=tt(w)?boe:$ae,_=v?v():{};return k(w,f,Ve(R,2),_)}}function Zh(f){return lt(function(v,w){var R=-1,k=w.length,_=k>1?w[k-1]:n,$=k>2?w[2]:n;for(_=f.length>3&&typeof _=="function"?(k--,_):n,$&&Wi(w[0],w[1],$)&&(_=k<3?n:_,k=1),v=Ut(v);++R<k;){var z=w[R];z&&f(v,z,R,_)}return v})}function ZB(f,v){return function(w,R){if(w==null)return w;if(!vr(w))return f(w,R);for(var k=w.length,_=v?k:-1,$=Ut(w);(v?_--:++_<k)&&R($[_],_,$)!==!1;);return w}}function JB(f){return function(v,w,R){for(var k=-1,_=Ut(v),$=R(v),z=$.length;z--;){var j=$[f?z:++k];if(w(_[j],j,_)===!1)break}return v}}function vle(f,v,w){var R=v&C,k=Qg(f);function _(){var $=this&&this!==ui&&this instanceof _?k:f;return $.apply(R?w:this,arguments)}return _}function eG(f){return function(v){v=_t(v);var w=Uh(v)?to(v):n,R=w?w[0]:v.charAt(0),k=w?vu(w,1).join(""):v.slice(1);return R[f]()+k}}function Jh(f){return function(v){return _E(ZG(QG(v).replace(aoe,"")),f,"")}}function Qg(f){return function(){var v=arguments;switch(v.length){case 0:return new f;case 1:return new f(v[0]);case 2:return new f(v[0],v[1]);case 3:return new f(v[0],v[1],v[2]);case 4:return new f(v[0],v[1],v[2],v[3]);case 5:return new f(v[0],v[1],v[2],v[3],v[4]);case 6:return new f(v[0],v[1],v[2],v[3],v[4],v[5]);case 7:return new f(v[0],v[1],v[2],v[3],v[4],v[5],v[6])}var w=Qh(f.prototype),R=f.apply(w,v);return un(R)?R:w}}function Cle(f,v,w){var R=Qg(f);function k(){for(var _=arguments.length,$=Y(_),z=_,j=ef(k);z--;)$[z]=arguments[z];var re=_<3&&$[0]!==j&&$[_-1]!==j?[]:hu($,j);if(_-=re.length,_<w)return sG(f,v,wy,k.placeholder,n,$,re,n,n,w-_);var se=this&&this!==ui&&this instanceof k?R:f;return Gr(se,this,$)}return k}function tG(f){return function(v,w,R){var k=Ut(v);if(!vr(v)){var _=Ve(w,3);v=Zn(v),w=function(z){return _(k[z],z,k)}}var $=f(v,w,R);return $>-1?k[_?v[$]:$]:n}}function nG(f){return el(function(v){var w=v.length,R=w,k=ms.prototype.thru;for(f&&v.reverse();R--;){var _=v[R];if(typeof _!="function")throw new gs(o);if(k&&!$&&Ry(_)=="wrapper")var $=new ms([],!0)}for(R=$?R:w;++R<w;){_=v[R];var z=Ry(_),j=z=="wrapper"?pF(_):n;j&&CF(j[0])&&j[1]==(F|S|E|P)&&!j[4].length&&j[9]==1?$=$[Ry(j[0])].apply($,j[3]):$=_.length==1&&CF(_)?$[z]():$.thru(_)}return function(){var re=arguments,se=re[0];if($&&re.length==1&&tt(se))return $.plant(se).value();for(var ae=0,Ee=w?v[ae].apply(this,re):se;++ae<w;)Ee=v[ae].call(this,Ee);return Ee}})}function wy(f,v,w,R,k,_,$,z,j,re){var se=v&F,ae=v&C,Ee=v&y,_e=v&(S|x),We=v&D,at=Ee?n:Qg(f);function Ue(){for(var ft=arguments.length,vt=Y(ft),Wr=ft;Wr--;)vt[Wr]=arguments[Wr];if(_e)var Ui=ef(Ue),Ur=Poe(vt,Ui);if(R&&(vt=XB(vt,R,k,_e)),_&&(vt=QB(vt,_,$,_e)),ft-=Ur,_e&&ft<re){var An=hu(vt,Ui);return sG(f,v,wy,Ue.placeholder,w,vt,An,z,j,re-ft)}var ro=ae?w:this,rl=Ee?ro[f]:f;return ft=vt.length,z?vt=$le(vt,z):We&&ft>1&&vt.reverse(),se&&j<ft&&(vt.length=j),this&&this!==ui&&this instanceof Ue&&(rl=at||Qg(rl)),rl.apply(ro,vt)}return Ue}function iG(f,v){return function(w,R){return qae(w,f,v(R),{})}}function by(f,v){return function(w,R){var k;if(w===n&&R===n)return v;if(w!==n&&(k=w),R!==n){if(k===n)return R;typeof w=="string"||typeof R=="string"?(w=Hr(w),R=Hr(R)):(w=HB(w),R=HB(R)),k=f(w,R)}return k}}function cF(f){return el(function(v){return v=rn(v,zr(Ve())),lt(function(w){var R=this;return f(v,function(k){return Gr(k,R,w)})})})}function Sy(f,v){v=v===n?" ":Hr(v);var w=v.length;if(w<2)return w?iF(v,f):v;var R=iF(v,ly(f/qh(v)));return Uh(v)?vu(to(R),0,f).join(""):R.slice(0,f)}function yle(f,v,w,R){var k=v&C,_=Qg(f);function $(){for(var z=-1,j=arguments.length,re=-1,se=R.length,ae=Y(se+j),Ee=this&&this!==ui&&this instanceof $?_:f;++re<se;)ae[re]=R[re];for(;j--;)ae[re++]=arguments[++z];return Gr(Ee,k?w:this,ae)}return $}function rG(f){return function(v,w,R){return R&&typeof R!="number"&&Wi(v,w,R)&&(w=R=n),v=il(v),w===n?(w=v,v=0):w=il(w),R=R===n?v<w?1:-1:il(R),rle(v,w,R,f)}}function xy(f){return function(v,w){return typeof v=="string"&&typeof w=="string"||(v=ws(v),w=ws(w)),f(v,w)}}function sG(f,v,w,R,k,_,$,z,j,re){var se=v&S,ae=se?$:n,Ee=se?n:$,_e=se?_:n,We=se?n:_;v|=se?E:A,v&=~(se?A:E),v&b||(v&=-4);var at=[f,v,k,_e,ae,We,Ee,z,j,re],Ue=w.apply(n,at);return CF(f)&&vG(Ue,at),Ue.placeholder=R,CG(Ue,f,v)}function dF(f){var v=Gn[f];return function(w,R){if(w=ws(w),R=R==null?0:Fi(st(R),292),R&&CB(w)){var k=(_t(w)+"e").split("e"),_=v(k[0]+"e"+(+k[1]+R));return k=(_t(_)+"e").split("e"),+(k[0]+"e"+(+k[1]-R))}return v(w)}}var wle=Yh&&1/ZC(new Yh([,-0]))[1]==q?function(f){return new Yh(f)}:IF;function oG(f){return function(v){var w=Ai(v);return w==rt?zE(v):w==eo?Noe(v):koe(v,f(v))}}function Ja(f,v,w,R,k,_,$,z){var j=v&y;if(!j&&typeof f!="function")throw new gs(o);var re=R?R.length:0;if(re||(v&=-97,R=k=n),$=$===n?$:zn(st($),0),z=z===n?z:st(z),re-=k?k.length:0,v&A){var se=R,ae=k;R=k=n}var Ee=j?n:pF(f),_e=[f,v,w,R,k,se,ae,_,$,z];if(Ee&&Ole(_e,Ee),f=_e[0],v=_e[1],w=_e[2],R=_e[3],k=_e[4],z=_e[9]=_e[9]===n?j?0:f.length:zn(_e[9]-re,0),!z&&v&(S|x)&&(v&=-25),!v||v==C)var We=vle(f,v,w);else v==S||v==x?We=Cle(f,v,z):(v==E||v==(C|E))&&!k.length?We=yle(f,v,w,R):We=wy.apply(n,_e);var at=Ee?GB:vG;return CG(at(We,_e),f,v)}function aG(f,v,w,R){return f===n||io(f,Kh[w])&&!Nt.call(R,w)?v:f}function lG(f,v,w,R,k,_){return un(f)&&un(v)&&(_.set(v,f),my(f,v,n,lG,_),_.delete(v)),f}function ble(f){return em(f)?n:f}function uG(f,v,w,R,k,_){var $=w&g,z=f.length,j=v.length;if(z!=j&&!($&&j>z))return!1;var re=_.get(f),se=_.get(v);if(re&&se)return re==v&&se==f;var ae=-1,Ee=!0,_e=w&m?new Wc:n;for(_.set(f,v),_.set(v,f);++ae<z;){var We=f[ae],at=v[ae];if(R)var Ue=$?R(at,We,ae,v,f,_):R(We,at,ae,f,v,_);if(Ue!==n){if(Ue)continue;Ee=!1;break}if(_e){if(!OE(v,function(ft,vt){if(!Gg(_e,vt)&&(We===ft||k(We,ft,w,R,_)))return _e.push(vt)})){Ee=!1;break}}else if(!(We===at||k(We,at,w,R,_))){Ee=!1;break}}return _.delete(f),_.delete(v),Ee}function Sle(f,v,w,R,k,_,$){switch(w){case Hh:if(f.byteLength!=v.byteLength||f.byteOffset!=v.byteOffset)return!1;f=f.buffer,v=v.buffer;case Bg:return!(f.byteLength!=v.byteLength||!_(new ry(f),new ry(v)));case En:case Se:case gn:return io(+f,+v);case et:return f.name==v.name&&f.message==v.message;case Lg:case Ng:return f==v+"";case rt:var z=zE;case eo:var j=R&g;if(z||(z=ZC),f.size!=v.size&&!j)return!1;var re=$.get(f);if(re)return re==v;R|=m,$.set(f,v);var se=uG(z(f),z(v),R,k,_,$);return $.delete(f),se;case qC:if(Ug)return Ug.call(f)==Ug.call(v)}return!1}function xle(f,v,w,R,k,_){var $=w&g,z=hF(f),j=z.length,re=hF(v),se=re.length;if(j!=se&&!$)return!1;for(var ae=j;ae--;){var Ee=z[ae];if(!($?Ee in v:Nt.call(v,Ee)))return!1}var _e=_.get(f),We=_.get(v);if(_e&&We)return _e==v&&We==f;var at=!0;_.set(f,v),_.set(v,f);for(var Ue=$;++ae<j;){Ee=z[ae];var ft=f[Ee],vt=v[Ee];if(R)var Wr=$?R(vt,ft,Ee,v,f,_):R(ft,vt,Ee,f,v,_);if(!(Wr===n?ft===vt||k(ft,vt,w,R,_):Wr)){at=!1;break}Ue||(Ue=Ee=="constructor")}if(at&&!Ue){var Ui=f.constructor,Ur=v.constructor;Ui!=Ur&&"constructor"in f&&"constructor"in v&&!(typeof Ui=="function"&&Ui instanceof Ui&&typeof Ur=="function"&&Ur instanceof Ur)&&(at=!1)}return _.delete(f),_.delete(v),at}function el(f){return wF(gG(f,n,RG),f+"")}function hF(f){return kB(f,Zn,mF)}function fF(f){return kB(f,Cr,cG)}var pF=cy?function(f){return cy.get(f)}:IF;function Ry(f){for(var v=f.name+"",w=Xh[v],R=Nt.call(Xh,v)?w.length:0;R--;){var k=w[R],_=k.func;if(_==null||_==f)return k.name}return v}function ef(f){var v=Nt.call(I,"placeholder")?I:f;return v.placeholder}function Ve(){var f=I.iteratee||MF;return f=f===MF?TB:f,arguments.length?f(arguments[0],arguments[1]):f}function Ey(f,v){var w=f.__data__;return Mle(v)?w[typeof v=="string"?"string":"hash"]:w.map}function gF(f){for(var v=Zn(f),w=v.length;w--;){var R=v[w],k=f[R];v[w]=[R,k,fG(k)]}return v}function jc(f,v){var w=_oe(f,v);return MB(w)?w:n}function Rle(f){var v=Nt.call(f,Hc),w=f[Hc];try{f[Hc]=n;var R=!0}catch{}var k=ny.call(f);return R&&(v?f[Hc]=w:delete f[Hc]),k}var mF=VE?function(f){return f==null?[]:(f=Ut(f),cu(VE(f),function(v){return mB.call(f,v)}))}:_F,cG=VE?function(f){for(var v=[];f;)du(v,mF(f)),f=sy(f);return v}:_F,Ai=Vi;(WE&&Ai(new WE(new ArrayBuffer(1)))!=Hh||Hg&&Ai(new Hg)!=rt||UE&&Ai(UE.resolve())!=Gc||Yh&&Ai(new Yh)!=eo||Vg&&Ai(new Vg)!=$g)&&(Ai=function(f){var v=Vi(f),w=v==Nn?f.constructor:n,R=w?Kc(w):"";if(R)switch(R){case oae:return Hh;case aae:return rt;case lae:return Gc;case uae:return eo;case cae:return $g}return v});function Ele(f,v,w){for(var R=-1,k=w.length;++R<k;){var _=w[R],$=_.size;switch(_.type){case"drop":f+=$;break;case"dropRight":v-=$;break;case"take":v=Fi(v,f+$);break;case"takeRight":f=zn(f,v-$);break}}return{start:f,end:v}}function Fle(f){var v=f.match(Tse);return v?v[1].split(Ise):[]}function dG(f,v,w){v=mu(v,f);for(var R=-1,k=v.length,_=!1;++R<k;){var $=Xo(v[R]);if(!(_=f!=null&&w(f,$)))break;f=f[$]}return _||++R!=k?_:(k=f==null?0:f.length,!!k&&Ty(k)&&tl($,k)&&(tt(f)||Yc(f)))}function Ale(f){var v=f.length,w=new f.constructor(v);return v&&typeof f[0]=="string"&&Nt.call(f,"index")&&(w.index=f.index,w.input=f.input),w}function hG(f){return typeof f.constructor=="function"&&!Zg(f)?Qh(sy(f)):{}}function Dle(f,v,w){var R=f.constructor;switch(v){case Bg:return uF(f);case En:case Se:return new R(+f);case Hh:return dle(f,w);case gE:case mE:case vE:case CE:case yE:case wE:case bE:case SE:case xE:return KB(f,w);case rt:return new R;case gn:case Ng:return new R(f);case Lg:return hle(f);case eo:return new R;case qC:return fle(f)}}function kle(f,v){var w=v.length;if(!w)return f;var R=w-1;return v[R]=(w>1?"& ":"")+v[R],v=v.join(w>2?", ":" "),f.replace(Mse,`{
/* [wrapped with `+v+`] */
`)}function Ple(f){return tt(f)||Yc(f)||!!(vB&&f&&f[vB])}function tl(f,v){var w=typeof f;return v=v??V,!!v&&(w=="number"||w!="symbol"&&Hse.test(f))&&f>-1&&f%1==0&&f<v}function Wi(f,v,w){if(!un(w))return!1;var R=typeof v;return(R=="number"?vr(w)&&tl(v,w.length):R=="string"&&v in w)?io(w[v],f):!1}function vF(f,v){if(tt(f))return!1;var w=typeof f;return w=="number"||w=="symbol"||w=="boolean"||f==null||Vr(f)?!0:Ase.test(f)||!Fse.test(f)||v!=null&&f in Ut(v)}function Mle(f){var v=typeof f;return v=="string"||v=="number"||v=="symbol"||v=="boolean"?f!=="__proto__":f===null}function CF(f){var v=Ry(f),w=I[v];if(typeof w!="function"||!(v in pt.prototype))return!1;if(f===w)return!0;var R=pF(w);return!!R&&f===R[0]}function Tle(f){return!!fB&&fB in f}var Ile=ey?nl:OF;function Zg(f){var v=f&&f.constructor,w=typeof v=="function"&&v.prototype||Kh;return f===w}function fG(f){return f===f&&!un(f)}function pG(f,v){return function(w){return w==null?!1:w[f]===v&&(v!==n||f in Ut(w))}}function _le(f){var v=Py(f,function(R){return w.size===u&&w.clear(),R}),w=v.cache;return v}function Ole(f,v){var w=f[1],R=v[1],k=w|R,_=k<(C|y|F),$=R==F&&w==S||R==F&&w==P&&f[7].length<=v[8]||R==(F|P)&&v[7].length<=v[8]&&w==S;if(!(_||$))return f;R&C&&(f[2]=v[2],k|=w&C?0:b);var z=v[3];if(z){var j=f[3];f[3]=j?XB(j,z,v[4]):z,f[4]=j?hu(f[3],c):v[4]}return z=v[5],z&&(j=f[5],f[5]=j?QB(j,z,v[6]):z,f[6]=j?hu(f[5],c):v[6]),z=v[7],z&&(f[7]=z),R&F&&(f[8]=f[8]==null?v[8]:Fi(f[8],v[8])),f[9]==null&&(f[9]=v[9]),f[0]=v[0],f[1]=k,f}function Lle(f){var v=[];if(f!=null)for(var w in Ut(f))v.push(w);return v}function Nle(f){return ny.call(f)}function gG(f,v,w){return v=zn(v===n?f.length-1:v,0),function(){for(var R=arguments,k=-1,_=zn(R.length-v,0),$=Y(_);++k<_;)$[k]=R[v+k];k=-1;for(var z=Y(v+1);++k<v;)z[k]=R[k];return z[v]=w($),Gr(f,this,z)}}function mG(f,v){return v.length<2?f:qc(f,Cs(v,0,-1))}function $le(f,v){for(var w=f.length,R=Fi(v.length,w),k=mr(f);R--;){var _=v[R];f[R]=tl(_,w)?k[_]:n}return f}function yF(f,v){if(!(v==="constructor"&&typeof f[v]=="function")&&v!="__proto__")return f[v]}var vG=yG(GB),Jg=Joe||function(f,v){return ui.setTimeout(f,v)},wF=yG(ale);function CG(f,v,w){var R=v+"";return wF(f,kle(R,Ble(Fle(R),w)))}function yG(f){var v=0,w=0;return function(){var R=iae(),k=H-(R-w);if(w=R,k>0){if(++v>=B)return arguments[0]}else v=0;return f.apply(n,arguments)}}function Fy(f,v){var w=-1,R=f.length,k=R-1;for(v=v===n?R:v;++w<v;){var _=nF(w,k),$=f[_];f[_]=f[w],f[w]=$}return f.length=v,f}var wG=_le(function(f){var v=[];return f.charCodeAt(0)===46&&v.push(""),f.replace(Dse,function(w,R,k,_){v.push(k?_.replace(Lse,"$1"):R||w)}),v});function Xo(f){if(typeof f=="string"||Vr(f))return f;var v=f+"";return v=="0"&&1/f==-1/0?"-0":v}function Kc(f){if(f!=null){try{return ty.call(f)}catch{}try{return f+""}catch{}}return""}function Ble(f,v){return ps(Je,function(w){var R="_."+w[0];v&w[1]&&!XC(f,R)&&f.push(R)}),f.sort()}function bG(f){if(f instanceof pt)return f.clone();var v=new ms(f.__wrapped__,f.__chain__);return v.__actions__=mr(f.__actions__),v.__index__=f.__index__,v.__values__=f.__values__,v}function Gle(f,v,w){(w?Wi(f,v,w):v===n)?v=1:v=zn(st(v),0);var R=f==null?0:f.length;if(!R||v<1)return[];for(var k=0,_=0,$=Y(ly(R/v));k<R;)$[_++]=Cs(f,k,k+=v);return $}function zle(f){for(var v=-1,w=f==null?0:f.length,R=0,k=[];++v<w;){var _=f[v];_&&(k[R++]=_)}return k}function Hle(){var f=arguments.length;if(!f)return[];for(var v=Y(f-1),w=arguments[0],R=f;R--;)v[R-1]=arguments[R];return du(tt(w)?mr(w):[w],ci(v,1))}var Vle=lt(function(f,v){return Fn(f)?jg(f,ci(v,1,Fn,!0)):[]}),Wle=lt(function(f,v){var w=ys(v);return Fn(w)&&(w=n),Fn(f)?jg(f,ci(v,1,Fn,!0),Ve(w,2)):[]}),Ule=lt(function(f,v){var w=ys(v);return Fn(w)&&(w=n),Fn(f)?jg(f,ci(v,1,Fn,!0),n,w):[]});function qle(f,v,w){var R=f==null?0:f.length;return R?(v=w||v===n?1:st(v),Cs(f,v<0?0:v,R)):[]}function jle(f,v,w){var R=f==null?0:f.length;return R?(v=w||v===n?1:st(v),v=R-v,Cs(f,0,v<0?0:v)):[]}function Kle(f,v){return f&&f.length?Cy(f,Ve(v,3),!0,!0):[]}function Yle(f,v){return f&&f.length?Cy(f,Ve(v,3),!0):[]}function Xle(f,v,w,R){var k=f==null?0:f.length;return k?(w&&typeof w!="number"&&Wi(f,v,w)&&(w=0,R=k),Hae(f,v,w,R)):[]}function SG(f,v,w){var R=f==null?0:f.length;if(!R)return-1;var k=w==null?0:st(w);return k<0&&(k=zn(R+k,0)),QC(f,Ve(v,3),k)}function xG(f,v,w){var R=f==null?0:f.length;if(!R)return-1;var k=R-1;return w!==n&&(k=st(w),k=w<0?zn(R+k,0):Fi(k,R-1)),QC(f,Ve(v,3),k,!0)}function RG(f){var v=f==null?0:f.length;return v?ci(f,1):[]}function Qle(f){var v=f==null?0:f.length;return v?ci(f,q):[]}function Zle(f,v){var w=f==null?0:f.length;return w?(v=v===n?1:st(v),ci(f,v)):[]}function Jle(f){for(var v=-1,w=f==null?0:f.length,R={};++v<w;){var k=f[v];R[k[0]]=k[1]}return R}function EG(f){return f&&f.length?f[0]:n}function eue(f,v,w){var R=f==null?0:f.length;if(!R)return-1;var k=w==null?0:st(w);return k<0&&(k=zn(R+k,0)),Wh(f,v,k)}function tue(f){var v=f==null?0:f.length;return v?Cs(f,0,-1):[]}var nue=lt(function(f){var v=rn(f,aF);return v.length&&v[0]===f[0]?QE(v):[]}),iue=lt(function(f){var v=ys(f),w=rn(f,aF);return v===ys(w)?v=n:w.pop(),w.length&&w[0]===f[0]?QE(w,Ve(v,2)):[]}),rue=lt(function(f){var v=ys(f),w=rn(f,aF);return v=typeof v=="function"?v:n,v&&w.pop(),w.length&&w[0]===f[0]?QE(w,n,v):[]});function sue(f,v){return f==null?"":tae.call(f,v)}function ys(f){var v=f==null?0:f.length;return v?f[v-1]:n}function oue(f,v,w){var R=f==null?0:f.length;if(!R)return-1;var k=R;return w!==n&&(k=st(w),k=k<0?zn(R+k,0):Fi(k,R-1)),v===v?Boe(f,v,k):QC(f,sB,k,!0)}function aue(f,v){return f&&f.length?LB(f,st(v)):n}var lue=lt(FG);function FG(f,v){return f&&f.length&&v&&v.length?tF(f,v):f}function uue(f,v,w){return f&&f.length&&v&&v.length?tF(f,v,Ve(w,2)):f}function cue(f,v,w){return f&&f.length&&v&&v.length?tF(f,v,n,w):f}var due=el(function(f,v){var w=f==null?0:f.length,R=jE(f,v);return BB(f,rn(v,function(k){return tl(k,w)?+k:k}).sort(YB)),R});function hue(f,v){var w=[];if(!(f&&f.length))return w;var R=-1,k=[],_=f.length;for(v=Ve(v,3);++R<_;){var $=f[R];v($,R,f)&&(w.push($),k.push(R))}return BB(f,k),w}function bF(f){return f==null?f:sae.call(f)}function fue(f,v,w){var R=f==null?0:f.length;return R?(w&&typeof w!="number"&&Wi(f,v,w)?(v=0,w=R):(v=v==null?0:st(v),w=w===n?R:st(w)),Cs(f,v,w)):[]}function pue(f,v){return vy(f,v)}function gue(f,v,w){return rF(f,v,Ve(w,2))}function mue(f,v){var w=f==null?0:f.length;if(w){var R=vy(f,v);if(R<w&&io(f[R],v))return R}return-1}function vue(f,v){return vy(f,v,!0)}function Cue(f,v,w){return rF(f,v,Ve(w,2),!0)}function yue(f,v){var w=f==null?0:f.length;if(w){var R=vy(f,v,!0)-1;if(io(f[R],v))return R}return-1}function wue(f){return f&&f.length?zB(f):[]}function bue(f,v){return f&&f.length?zB(f,Ve(v,2)):[]}function Sue(f){var v=f==null?0:f.length;return v?Cs(f,1,v):[]}function xue(f,v,w){return f&&f.length?(v=w||v===n?1:st(v),Cs(f,0,v<0?0:v)):[]}function Rue(f,v,w){var R=f==null?0:f.length;return R?(v=w||v===n?1:st(v),v=R-v,Cs(f,v<0?0:v,R)):[]}function Eue(f,v){return f&&f.length?Cy(f,Ve(v,3),!1,!0):[]}function Fue(f,v){return f&&f.length?Cy(f,Ve(v,3)):[]}var Aue=lt(function(f){return gu(ci(f,1,Fn,!0))}),Due=lt(function(f){var v=ys(f);return Fn(v)&&(v=n),gu(ci(f,1,Fn,!0),Ve(v,2))}),kue=lt(function(f){var v=ys(f);return v=typeof v=="function"?v:n,gu(ci(f,1,Fn,!0),n,v)});function Pue(f){return f&&f.length?gu(f):[]}function Mue(f,v){return f&&f.length?gu(f,Ve(v,2)):[]}function Tue(f,v){return v=typeof v=="function"?v:n,f&&f.length?gu(f,n,v):[]}function SF(f){if(!(f&&f.length))return[];var v=0;return f=cu(f,function(w){if(Fn(w))return v=zn(w.length,v),!0}),BE(v,function(w){return rn(f,LE(w))})}function AG(f,v){if(!(f&&f.length))return[];var w=SF(f);return v==null?w:rn(w,function(R){return Gr(v,n,R)})}var Iue=lt(function(f,v){return Fn(f)?jg(f,v):[]}),_ue=lt(function(f){return oF(cu(f,Fn))}),Oue=lt(function(f){var v=ys(f);return Fn(v)&&(v=n),oF(cu(f,Fn),Ve(v,2))}),Lue=lt(function(f){var v=ys(f);return v=typeof v=="function"?v:n,oF(cu(f,Fn),n,v)}),Nue=lt(SF);function $ue(f,v){return UB(f||[],v||[],qg)}function Bue(f,v){return UB(f||[],v||[],Xg)}var Gue=lt(function(f){var v=f.length,w=v>1?f[v-1]:n;return w=typeof w=="function"?(f.pop(),w):n,AG(f,w)});function DG(f){var v=I(f);return v.__chain__=!0,v}function zue(f,v){return v(f),f}function Ay(f,v){return v(f)}var Hue=el(function(f){var v=f.length,w=v?f[0]:0,R=this.__wrapped__,k=function(_){return jE(_,f)};return v>1||this.__actions__.length||!(R instanceof pt)||!tl(w)?this.thru(k):(R=R.slice(w,+w+(v?1:0)),R.__actions__.push({func:Ay,args:[k],thisArg:n}),new ms(R,this.__chain__).thru(function(_){return v&&!_.length&&_.push(n),_}))});function Vue(){return DG(this)}function Wue(){return new ms(this.value(),this.__chain__)}function Uue(){this.__values__===n&&(this.__values__=HG(this.value()));var f=this.__index__>=this.__values__.length,v=f?n:this.__values__[this.__index__++];return{done:f,value:v}}function que(){return this}function jue(f){for(var v,w=this;w instanceof hy;){var R=bG(w);R.__index__=0,R.__values__=n,v?k.__wrapped__=R:v=R;var k=R;w=w.__wrapped__}return k.__wrapped__=f,v}function Kue(){var f=this.__wrapped__;if(f instanceof pt){var v=f;return this.__actions__.length&&(v=new pt(this)),v=v.reverse(),v.__actions__.push({func:Ay,args:[bF],thisArg:n}),new ms(v,this.__chain__)}return this.thru(bF)}function Yue(){return WB(this.__wrapped__,this.__actions__)}var Xue=yy(function(f,v,w){Nt.call(f,w)?++f[w]:Za(f,w,1)});function Que(f,v,w){var R=tt(f)?iB:zae;return w&&Wi(f,v,w)&&(v=n),R(f,Ve(v,3))}function Zue(f,v){var w=tt(f)?cu:AB;return w(f,Ve(v,3))}var Jue=tG(SG),ece=tG(xG);function tce(f,v){return ci(Dy(f,v),1)}function nce(f,v){return ci(Dy(f,v),q)}function ice(f,v,w){return w=w===n?1:st(w),ci(Dy(f,v),w)}function kG(f,v){var w=tt(f)?ps:pu;return w(f,Ve(v,3))}function PG(f,v){var w=tt(f)?Soe:FB;return w(f,Ve(v,3))}var rce=yy(function(f,v,w){Nt.call(f,w)?f[w].push(v):Za(f,w,[v])});function sce(f,v,w,R){f=vr(f)?f:nf(f),w=w&&!R?st(w):0;var k=f.length;return w<0&&(w=zn(k+w,0)),Iy(f)?w<=k&&f.indexOf(v,w)>-1:!!k&&Wh(f,v,w)>-1}var oce=lt(function(f,v,w){var R=-1,k=typeof v=="function",_=vr(f)?Y(f.length):[];return pu(f,function($){_[++R]=k?Gr(v,$,w):Kg($,v,w)}),_}),ace=yy(function(f,v,w){Za(f,w,v)});function Dy(f,v){var w=tt(f)?rn:IB;return w(f,Ve(v,3))}function lce(f,v,w,R){return f==null?[]:(tt(v)||(v=v==null?[]:[v]),w=R?n:w,tt(w)||(w=w==null?[]:[w]),NB(f,v,w))}var uce=yy(function(f,v,w){f[w?0:1].push(v)},function(){return[[],[]]});function cce(f,v,w){var R=tt(f)?_E:aB,k=arguments.length<3;return R(f,Ve(v,4),w,k,pu)}function dce(f,v,w){var R=tt(f)?xoe:aB,k=arguments.length<3;return R(f,Ve(v,4),w,k,FB)}function hce(f,v){var w=tt(f)?cu:AB;return w(f,My(Ve(v,3)))}function fce(f){var v=tt(f)?SB:sle;return v(f)}function pce(f,v,w){(w?Wi(f,v,w):v===n)?v=1:v=st(v);var R=tt(f)?Lae:ole;return R(f,v)}function gce(f){var v=tt(f)?Nae:lle;return v(f)}function mce(f){if(f==null)return 0;if(vr(f))return Iy(f)?qh(f):f.length;var v=Ai(f);return v==rt||v==eo?f.size:JE(f).length}function vce(f,v,w){var R=tt(f)?OE:ule;return w&&Wi(f,v,w)&&(v=n),R(f,Ve(v,3))}var Cce=lt(function(f,v){if(f==null)return[];var w=v.length;return w>1&&Wi(f,v[0],v[1])?v=[]:w>2&&Wi(v[0],v[1],v[2])&&(v=[v[0]]),NB(f,ci(v,1),[])}),ky=Zoe||function(){return ui.Date.now()};function yce(f,v){if(typeof v!="function")throw new gs(o);return f=st(f),function(){if(--f<1)return v.apply(this,arguments)}}function MG(f,v,w){return v=w?n:v,v=f&&v==null?f.length:v,Ja(f,F,n,n,n,n,v)}function TG(f,v){var w;if(typeof v!="function")throw new gs(o);return f=st(f),function(){return--f>0&&(w=v.apply(this,arguments)),f<=1&&(v=n),w}}var xF=lt(function(f,v,w){var R=C;if(w.length){var k=hu(w,ef(xF));R|=E}return Ja(f,R,v,w,k)}),IG=lt(function(f,v,w){var R=C|y;if(w.length){var k=hu(w,ef(IG));R|=E}return Ja(v,R,f,w,k)});function _G(f,v,w){v=w?n:v;var R=Ja(f,S,n,n,n,n,n,v);return R.placeholder=_G.placeholder,R}function OG(f,v,w){v=w?n:v;var R=Ja(f,x,n,n,n,n,n,v);return R.placeholder=OG.placeholder,R}function LG(f,v,w){var R,k,_,$,z,j,re=0,se=!1,ae=!1,Ee=!0;if(typeof f!="function")throw new gs(o);v=ws(v)||0,un(w)&&(se=!!w.leading,ae="maxWait"in w,_=ae?zn(ws(w.maxWait)||0,v):_,Ee="trailing"in w?!!w.trailing:Ee);function _e(An){var ro=R,rl=k;return R=k=n,re=An,$=f.apply(rl,ro),$}function We(An){return re=An,z=Jg(ft,v),se?_e(An):$}function at(An){var ro=An-j,rl=An-re,t3=v-ro;return ae?Fi(t3,_-rl):t3}function Ue(An){var ro=An-j,rl=An-re;return j===n||ro>=v||ro<0||ae&&rl>=_}function ft(){var An=ky();if(Ue(An))return vt(An);z=Jg(ft,at(An))}function vt(An){return z=n,Ee&&R?_e(An):(R=k=n,$)}function Wr(){z!==n&&qB(z),re=0,R=j=k=z=n}function Ui(){return z===n?$:vt(ky())}function Ur(){var An=ky(),ro=Ue(An);if(R=arguments,k=this,j=An,ro){if(z===n)return We(j);if(ae)return qB(z),z=Jg(ft,v),_e(j)}return z===n&&(z=Jg(ft,v)),$}return Ur.cancel=Wr,Ur.flush=Ui,Ur}var wce=lt(function(f,v){return EB(f,1,v)}),bce=lt(function(f,v,w){return EB(f,ws(v)||0,w)});function Sce(f){return Ja(f,D)}function Py(f,v){if(typeof f!="function"||v!=null&&typeof v!="function")throw new gs(o);var w=function(){var R=arguments,k=v?v.apply(this,R):R[0],_=w.cache;if(_.has(k))return _.get(k);var $=f.apply(this,R);return w.cache=_.set(k,$)||_,$};return w.cache=new(Py.Cache||Qa),w}Py.Cache=Qa;function My(f){if(typeof f!="function")throw new gs(o);return function(){var v=arguments;switch(v.length){case 0:return!f.call(this);case 1:return!f.call(this,v[0]);case 2:return!f.call(this,v[0],v[1]);case 3:return!f.call(this,v[0],v[1],v[2])}return!f.apply(this,v)}}function xce(f){return TG(2,f)}var Rce=cle(function(f,v){v=v.length==1&&tt(v[0])?rn(v[0],zr(Ve())):rn(ci(v,1),zr(Ve()));var w=v.length;return lt(function(R){for(var k=-1,_=Fi(R.length,w);++k<_;)R[k]=v[k].call(this,R[k]);return Gr(f,this,R)})}),RF=lt(function(f,v){var w=hu(v,ef(RF));return Ja(f,E,n,v,w)}),NG=lt(function(f,v){var w=hu(v,ef(NG));return Ja(f,A,n,v,w)}),Ece=el(function(f,v){return Ja(f,P,n,n,n,v)});function Fce(f,v){if(typeof f!="function")throw new gs(o);return v=v===n?v:st(v),lt(f,v)}function Ace(f,v){if(typeof f!="function")throw new gs(o);return v=v==null?0:zn(st(v),0),lt(function(w){var R=w[v],k=vu(w,0,v);return R&&du(k,R),Gr(f,this,k)})}function Dce(f,v,w){var R=!0,k=!0;if(typeof f!="function")throw new gs(o);return un(w)&&(R="leading"in w?!!w.leading:R,k="trailing"in w?!!w.trailing:k),LG(f,v,{leading:R,maxWait:v,trailing:k})}function kce(f){return MG(f,1)}function Pce(f,v){return RF(lF(v),f)}function Mce(){if(!arguments.length)return[];var f=arguments[0];return tt(f)?f:[f]}function Tce(f){return vs(f,p)}function Ice(f,v){return v=typeof v=="function"?v:n,vs(f,p,v)}function _ce(f){return vs(f,d|p)}function Oce(f,v){return v=typeof v=="function"?v:n,vs(f,d|p,v)}function Lce(f,v){return v==null||RB(f,v,Zn(v))}function io(f,v){return f===v||f!==f&&v!==v}var Nce=xy(XE),$ce=xy(function(f,v){return f>=v}),Yc=PB(function(){return arguments}())?PB:function(f){return mn(f)&&Nt.call(f,"callee")&&!mB.call(f,"callee")},tt=Y.isArray,Bce=Q$?zr(Q$):jae;function vr(f){return f!=null&&Ty(f.length)&&!nl(f)}function Fn(f){return mn(f)&&vr(f)}function Gce(f){return f===!0||f===!1||mn(f)&&Vi(f)==En}var Cu=eae||OF,zce=Z$?zr(Z$):Kae;function Hce(f){return mn(f)&&f.nodeType===1&&!em(f)}function Vce(f){if(f==null)return!0;if(vr(f)&&(tt(f)||typeof f=="string"||typeof f.splice=="function"||Cu(f)||tf(f)||Yc(f)))return!f.length;var v=Ai(f);if(v==rt||v==eo)return!f.size;if(Zg(f))return!JE(f).length;for(var w in f)if(Nt.call(f,w))return!1;return!0}function Wce(f,v){return Yg(f,v)}function Uce(f,v,w){w=typeof w=="function"?w:n;var R=w?w(f,v):n;return R===n?Yg(f,v,n,w):!!R}function EF(f){if(!mn(f))return!1;var v=Vi(f);return v==et||v==je||typeof f.message=="string"&&typeof f.name=="string"&&!em(f)}function qce(f){return typeof f=="number"&&CB(f)}function nl(f){if(!un(f))return!1;var v=Vi(f);return v==ce||v==On||v==xt||v==mse}function $G(f){return typeof f=="number"&&f==st(f)}function Ty(f){return typeof f=="number"&&f>-1&&f%1==0&&f<=V}function un(f){var v=typeof f;return f!=null&&(v=="object"||v=="function")}function mn(f){return f!=null&&typeof f=="object"}var BG=J$?zr(J$):Xae;function jce(f,v){return f===v||ZE(f,v,gF(v))}function Kce(f,v,w){return w=typeof w=="function"?w:n,ZE(f,v,gF(v),w)}function Yce(f){return GG(f)&&f!=+f}function Xce(f){if(Ile(f))throw new Ze(s);return MB(f)}function Qce(f){return f===null}function Zce(f){return f==null}function GG(f){return typeof f=="number"||mn(f)&&Vi(f)==gn}function em(f){if(!mn(f)||Vi(f)!=Nn)return!1;var v=sy(f);if(v===null)return!0;var w=Nt.call(v,"constructor")&&v.constructor;return typeof w=="function"&&w instanceof w&&ty.call(w)==Koe}var FF=eB?zr(eB):Qae;function Jce(f){return $G(f)&&f>=-9007199254740991&&f<=V}var zG=tB?zr(tB):Zae;function Iy(f){return typeof f=="string"||!tt(f)&&mn(f)&&Vi(f)==Ng}function Vr(f){return typeof f=="symbol"||mn(f)&&Vi(f)==qC}var tf=nB?zr(nB):Jae;function ede(f){return f===n}function tde(f){return mn(f)&&Ai(f)==$g}function nde(f){return mn(f)&&Vi(f)==Cse}var ide=xy(eF),rde=xy(function(f,v){return f<=v});function HG(f){if(!f)return[];if(vr(f))return Iy(f)?to(f):mr(f);if(zg&&f[zg])return Loe(f[zg]());var v=Ai(f),w=v==rt?zE:v==eo?ZC:nf;return w(f)}function il(f){if(!f)return f===0?f:0;if(f=ws(f),f===q||f===-1/0){var v=f<0?-1:1;return v*U}return f===f?f:0}function st(f){var v=il(f),w=v%1;return v===v?w?v-w:v:0}function VG(f){return f?Uc(st(f),0,pe):0}function ws(f){if(typeof f=="number")return f;if(Vr(f))return ie;if(un(f)){var v=typeof f.valueOf=="function"?f.valueOf():f;f=un(v)?v+"":v}if(typeof f!="string")return f===0?f:+f;f=lB(f);var w=Bse.test(f);return w||zse.test(f)?yoe(f.slice(2),w?2:8):$se.test(f)?ie:+f}function WG(f){return Yo(f,Cr(f))}function sde(f){return f?Uc(st(f),-9007199254740991,V):f===0?f:0}function _t(f){return f==null?"":Hr(f)}var ode=Zh(function(f,v){if(Zg(v)||vr(v)){Yo(v,Zn(v),f);return}for(var w in v)Nt.call(v,w)&&qg(f,w,v[w])}),UG=Zh(function(f,v){Yo(v,Cr(v),f)}),_y=Zh(function(f,v,w,R){Yo(v,Cr(v),f,R)}),ade=Zh(function(f,v,w,R){Yo(v,Zn(v),f,R)}),lde=el(jE);function ude(f,v){var w=Qh(f);return v==null?w:xB(w,v)}var cde=lt(function(f,v){f=Ut(f);var w=-1,R=v.length,k=R>2?v[2]:n;for(k&&Wi(v[0],v[1],k)&&(R=1);++w<R;)for(var _=v[w],$=Cr(_),z=-1,j=$.length;++z<j;){var re=$[z],se=f[re];(se===n||io(se,Kh[re])&&!Nt.call(f,re))&&(f[re]=_[re])}return f}),dde=lt(function(f){return f.push(n,lG),Gr(qG,n,f)});function hde(f,v){return rB(f,Ve(v,3),Ko)}function fde(f,v){return rB(f,Ve(v,3),YE)}function pde(f,v){return f==null?f:KE(f,Ve(v,3),Cr)}function gde(f,v){return f==null?f:DB(f,Ve(v,3),Cr)}function mde(f,v){return f&&Ko(f,Ve(v,3))}function vde(f,v){return f&&YE(f,Ve(v,3))}function Cde(f){return f==null?[]:gy(f,Zn(f))}function yde(f){return f==null?[]:gy(f,Cr(f))}function AF(f,v,w){var R=f==null?n:qc(f,v);return R===n?w:R}function wde(f,v){return f!=null&&dG(f,v,Vae)}function DF(f,v){return f!=null&&dG(f,v,Wae)}var bde=iG(function(f,v,w){v!=null&&typeof v.toString!="function"&&(v=ny.call(v)),f[v]=w},PF(yr)),Sde=iG(function(f,v,w){v!=null&&typeof v.toString!="function"&&(v=ny.call(v)),Nt.call(f,v)?f[v].push(w):f[v]=[w]},Ve),xde=lt(Kg);function Zn(f){return vr(f)?bB(f):JE(f)}function Cr(f){return vr(f)?bB(f,!0):ele(f)}function Rde(f,v){var w={};return v=Ve(v,3),Ko(f,function(R,k,_){Za(w,v(R,k,_),R)}),w}function Ede(f,v){var w={};return v=Ve(v,3),Ko(f,function(R,k,_){Za(w,k,v(R,k,_))}),w}var Fde=Zh(function(f,v,w){my(f,v,w)}),qG=Zh(function(f,v,w,R){my(f,v,w,R)}),Ade=el(function(f,v){var w={};if(f==null)return w;var R=!1;v=rn(v,function(_){return _=mu(_,f),R||(R=_.length>1),_}),Yo(f,fF(f),w),R&&(w=vs(w,d|h|p,ble));for(var k=v.length;k--;)sF(w,v[k]);return w});function Dde(f,v){return jG(f,My(Ve(v)))}var kde=el(function(f,v){return f==null?{}:nle(f,v)});function jG(f,v){if(f==null)return{};var w=rn(fF(f),function(R){return[R]});return v=Ve(v),$B(f,w,function(R,k){return v(R,k[0])})}function Pde(f,v,w){v=mu(v,f);var R=-1,k=v.length;for(k||(k=1,f=n);++R<k;){var _=f==null?n:f[Xo(v[R])];_===n&&(R=k,_=w),f=nl(_)?_.call(f):_}return f}function Mde(f,v,w){return f==null?f:Xg(f,v,w)}function Tde(f,v,w,R){return R=typeof R=="function"?R:n,f==null?f:Xg(f,v,w,R)}var KG=oG(Zn),YG=oG(Cr);function Ide(f,v,w){var R=tt(f),k=R||Cu(f)||tf(f);if(v=Ve(v,4),w==null){var _=f&&f.constructor;k?w=R?new _:[]:un(f)?w=nl(_)?Qh(sy(f)):{}:w={}}return(k?ps:Ko)(f,function($,z,j){return v(w,$,z,j)}),w}function _de(f,v){return f==null?!0:sF(f,v)}function Ode(f,v,w){return f==null?f:VB(f,v,lF(w))}function Lde(f,v,w,R){return R=typeof R=="function"?R:n,f==null?f:VB(f,v,lF(w),R)}function nf(f){return f==null?[]:GE(f,Zn(f))}function Nde(f){return f==null?[]:GE(f,Cr(f))}function $de(f,v,w){return w===n&&(w=v,v=n),w!==n&&(w=ws(w),w=w===w?w:0),v!==n&&(v=ws(v),v=v===v?v:0),Uc(ws(f),v,w)}function Bde(f,v,w){return v=il(v),w===n?(w=v,v=0):w=il(w),f=ws(f),Uae(f,v,w)}function Gde(f,v,w){if(w&&typeof w!="boolean"&&Wi(f,v,w)&&(v=w=n),w===n&&(typeof v=="boolean"?(w=v,v=n):typeof f=="boolean"&&(w=f,f=n)),f===n&&v===n?(f=0,v=1):(f=il(f),v===n?(v=f,f=0):v=il(v)),f>v){var R=f;f=v,v=R}if(w||f%1||v%1){var k=yB();return Fi(f+k*(v-f+Coe("1e-"+((k+"").length-1))),v)}return nF(f,v)}var zde=Jh(function(f,v,w){return v=v.toLowerCase(),f+(w?XG(v):v)});function XG(f){return kF(_t(f).toLowerCase())}function QG(f){return f=_t(f),f&&f.replace(Vse,Moe).replace(loe,"")}function Hde(f,v,w){f=_t(f),v=Hr(v);var R=f.length;w=w===n?R:Uc(st(w),0,R);var k=w;return w-=v.length,w>=0&&f.slice(w,k)==v}function Vde(f){return f=_t(f),f&&xse.test(f)?f.replace(D$,Toe):f}function Wde(f){return f=_t(f),f&&kse.test(f)?f.replace(RE,"\\$&"):f}var Ude=Jh(function(f,v,w){return f+(w?"-":"")+v.toLowerCase()}),qde=Jh(function(f,v,w){return f+(w?" ":"")+v.toLowerCase()}),jde=eG("toLowerCase");function Kde(f,v,w){f=_t(f),v=st(v);var R=v?qh(f):0;if(!v||R>=v)return f;var k=(v-R)/2;return Sy(uy(k),w)+f+Sy(ly(k),w)}function Yde(f,v,w){f=_t(f),v=st(v);var R=v?qh(f):0;return v&&R<v?f+Sy(v-R,w):f}function Xde(f,v,w){f=_t(f),v=st(v);var R=v?qh(f):0;return v&&R<v?Sy(v-R,w)+f:f}function Qde(f,v,w){return w||v==null?v=0:v&&(v=+v),rae(_t(f).replace(EE,""),v||0)}function Zde(f,v,w){return(w?Wi(f,v,w):v===n)?v=1:v=st(v),iF(_t(f),v)}function Jde(){var f=arguments,v=_t(f[0]);return f.length<3?v:v.replace(f[1],f[2])}var ehe=Jh(function(f,v,w){return f+(w?"_":"")+v.toLowerCase()});function the(f,v,w){return w&&typeof w!="number"&&Wi(f,v,w)&&(v=w=n),w=w===n?pe:w>>>0,w?(f=_t(f),f&&(typeof v=="string"||v!=null&&!FF(v))&&(v=Hr(v),!v&&Uh(f))?vu(to(f),0,w):f.split(v,w)):[]}var nhe=Jh(function(f,v,w){return f+(w?" ":"")+kF(v)});function ihe(f,v,w){return f=_t(f),w=w==null?0:Uc(st(w),0,f.length),v=Hr(v),f.slice(w,w+v.length)==v}function rhe(f,v,w){var R=I.templateSettings;w&&Wi(f,v,w)&&(v=n),f=_t(f),v=_y({},v,R,aG);var k=_y({},v.imports,R.imports,aG),_=Zn(k),$=GE(k,_),z,j,re=0,se=v.interpolate||jC,ae="__p += '",Ee=HE((v.escape||jC).source+"|"+se.source+"|"+(se===k$?Nse:jC).source+"|"+(v.evaluate||jC).source+"|$","g"),_e="//# sourceURL="+(Nt.call(v,"sourceURL")?(v.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++foe+"]")+`
`;f.replace(Ee,function(Ue,ft,vt,Wr,Ui,Ur){return vt||(vt=Wr),ae+=f.slice(re,Ur).replace(Wse,Ioe),ft&&(z=!0,ae+=`' +
__e(`+ft+`) +
'`),Ui&&(j=!0,ae+=`';
`+Ui+`;
__p += '`),vt&&(ae+=`' +
((__t = (`+vt+`)) == null ? '' : __t) +
'`),re=Ur+Ue.length,Ue}),ae+=`';
`;var We=Nt.call(v,"variable")&&v.variable;if(!We)ae=`with (obj) {
`+ae+`
}
`;else if(Ose.test(We))throw new Ze(a);ae=(j?ae.replace(yse,""):ae).replace(wse,"$1").replace(bse,"$1;"),ae="function("+(We||"obj")+`) {
`+(We?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(z?", __e = _.escape":"")+(j?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ae+`return __p
}`;var at=JG(function(){return Tt(_,_e+"return "+ae).apply(n,$)});if(at.source=ae,EF(at))throw at;return at}function she(f){return _t(f).toLowerCase()}function ohe(f){return _t(f).toUpperCase()}function ahe(f,v,w){if(f=_t(f),f&&(w||v===n))return lB(f);if(!f||!(v=Hr(v)))return f;var R=to(f),k=to(v),_=uB(R,k),$=cB(R,k)+1;return vu(R,_,$).join("")}function lhe(f,v,w){if(f=_t(f),f&&(w||v===n))return f.slice(0,hB(f)+1);if(!f||!(v=Hr(v)))return f;var R=to(f),k=cB(R,to(v))+1;return vu(R,0,k).join("")}function uhe(f,v,w){if(f=_t(f),f&&(w||v===n))return f.replace(EE,"");if(!f||!(v=Hr(v)))return f;var R=to(f),k=uB(R,to(v));return vu(R,k).join("")}function che(f,v){var w=M,R=O;if(un(v)){var k="separator"in v?v.separator:k;w="length"in v?st(v.length):w,R="omission"in v?Hr(v.omission):R}f=_t(f);var _=f.length;if(Uh(f)){var $=to(f);_=$.length}if(w>=_)return f;var z=w-qh(R);if(z<1)return R;var j=$?vu($,0,z).join(""):f.slice(0,z);if(k===n)return j+R;if($&&(z+=j.length-z),FF(k)){if(f.slice(z).search(k)){var re,se=j;for(k.global||(k=HE(k.source,_t(P$.exec(k))+"g")),k.lastIndex=0;re=k.exec(se);)var ae=re.index;j=j.slice(0,ae===n?z:ae)}}else if(f.indexOf(Hr(k),z)!=z){var Ee=j.lastIndexOf(k);Ee>-1&&(j=j.slice(0,Ee))}return j+R}function dhe(f){return f=_t(f),f&&Sse.test(f)?f.replace(A$,Goe):f}var hhe=Jh(function(f,v,w){return f+(w?" ":"")+v.toUpperCase()}),kF=eG("toUpperCase");function ZG(f,v,w){return f=_t(f),v=w?n:v,v===n?Ooe(f)?Voe(f):Foe(f):f.match(v)||[]}var JG=lt(function(f,v){try{return Gr(f,n,v)}catch(w){return EF(w)?w:new Ze(w)}}),fhe=el(function(f,v){return ps(v,function(w){w=Xo(w),Za(f,w,xF(f[w],f))}),f});function phe(f){var v=f==null?0:f.length,w=Ve();return f=v?rn(f,function(R){if(typeof R[1]!="function")throw new gs(o);return[w(R[0]),R[1]]}):[],lt(function(R){for(var k=-1;++k<v;){var _=f[k];if(Gr(_[0],this,R))return Gr(_[1],this,R)}})}function ghe(f){return Gae(vs(f,d))}function PF(f){return function(){return f}}function mhe(f,v){return f==null||f!==f?v:f}var vhe=nG(),Che=nG(!0);function yr(f){return f}function MF(f){return TB(typeof f=="function"?f:vs(f,d))}function yhe(f){return _B(vs(f,d))}function whe(f,v){return OB(f,vs(v,d))}var bhe=lt(function(f,v){return function(w){return Kg(w,f,v)}}),She=lt(function(f,v){return function(w){return Kg(f,w,v)}});function TF(f,v,w){var R=Zn(v),k=gy(v,R);w==null&&!(un(v)&&(k.length||!R.length))&&(w=v,v=f,f=this,k=gy(v,Zn(v)));var _=!(un(w)&&"chain"in w)||!!w.chain,$=nl(f);return ps(k,function(z){var j=v[z];f[z]=j,$&&(f.prototype[z]=function(){var re=this.__chain__;if(_||re){var se=f(this.__wrapped__),ae=se.__actions__=mr(this.__actions__);return ae.push({func:j,args:arguments,thisArg:f}),se.__chain__=re,se}return j.apply(f,du([this.value()],arguments))})}),f}function xhe(){return ui._===this&&(ui._=Yoe),this}function IF(){}function Rhe(f){return f=st(f),lt(function(v){return LB(v,f)})}var Ehe=cF(rn),Fhe=cF(iB),Ahe=cF(OE);function e3(f){return vF(f)?LE(Xo(f)):ile(f)}function Dhe(f){return function(v){return f==null?n:qc(f,v)}}var khe=rG(),Phe=rG(!0);function _F(){return[]}function OF(){return!1}function Mhe(){return{}}function The(){return""}function Ihe(){return!0}function _he(f,v){if(f=st(f),f<1||f>V)return[];var w=pe,R=Fi(f,pe);v=Ve(v),f-=pe;for(var k=BE(R,v);++w<f;)v(w);return k}function Ohe(f){return tt(f)?rn(f,Xo):Vr(f)?[f]:mr(wG(_t(f)))}function Lhe(f){var v=++joe;return _t(f)+v}var Nhe=by(function(f,v){return f+v},0),$he=dF("ceil"),Bhe=by(function(f,v){return f/v},1),Ghe=dF("floor");function zhe(f){return f&&f.length?py(f,yr,XE):n}function Hhe(f,v){return f&&f.length?py(f,Ve(v,2),XE):n}function Vhe(f){return oB(f,yr)}function Whe(f,v){return oB(f,Ve(v,2))}function Uhe(f){return f&&f.length?py(f,yr,eF):n}function qhe(f,v){return f&&f.length?py(f,Ve(v,2),eF):n}var jhe=by(function(f,v){return f*v},1),Khe=dF("round"),Yhe=by(function(f,v){return f-v},0);function Xhe(f){return f&&f.length?$E(f,yr):0}function Qhe(f,v){return f&&f.length?$E(f,Ve(v,2)):0}return I.after=yce,I.ary=MG,I.assign=ode,I.assignIn=UG,I.assignInWith=_y,I.assignWith=ade,I.at=lde,I.before=TG,I.bind=xF,I.bindAll=fhe,I.bindKey=IG,I.castArray=Mce,I.chain=DG,I.chunk=Gle,I.compact=zle,I.concat=Hle,I.cond=phe,I.conforms=ghe,I.constant=PF,I.countBy=Xue,I.create=ude,I.curry=_G,I.curryRight=OG,I.debounce=LG,I.defaults=cde,I.defaultsDeep=dde,I.defer=wce,I.delay=bce,I.difference=Vle,I.differenceBy=Wle,I.differenceWith=Ule,I.drop=qle,I.dropRight=jle,I.dropRightWhile=Kle,I.dropWhile=Yle,I.fill=Xle,I.filter=Zue,I.flatMap=tce,I.flatMapDeep=nce,I.flatMapDepth=ice,I.flatten=RG,I.flattenDeep=Qle,I.flattenDepth=Zle,I.flip=Sce,I.flow=vhe,I.flowRight=Che,I.fromPairs=Jle,I.functions=Cde,I.functionsIn=yde,I.groupBy=rce,I.initial=tue,I.intersection=nue,I.intersectionBy=iue,I.intersectionWith=rue,I.invert=bde,I.invertBy=Sde,I.invokeMap=oce,I.iteratee=MF,I.keyBy=ace,I.keys=Zn,I.keysIn=Cr,I.map=Dy,I.mapKeys=Rde,I.mapValues=Ede,I.matches=yhe,I.matchesProperty=whe,I.memoize=Py,I.merge=Fde,I.mergeWith=qG,I.method=bhe,I.methodOf=She,I.mixin=TF,I.negate=My,I.nthArg=Rhe,I.omit=Ade,I.omitBy=Dde,I.once=xce,I.orderBy=lce,I.over=Ehe,I.overArgs=Rce,I.overEvery=Fhe,I.overSome=Ahe,I.partial=RF,I.partialRight=NG,I.partition=uce,I.pick=kde,I.pickBy=jG,I.property=e3,I.propertyOf=Dhe,I.pull=lue,I.pullAll=FG,I.pullAllBy=uue,I.pullAllWith=cue,I.pullAt=due,I.range=khe,I.rangeRight=Phe,I.rearg=Ece,I.reject=hce,I.remove=hue,I.rest=Fce,I.reverse=bF,I.sampleSize=pce,I.set=Mde,I.setWith=Tde,I.shuffle=gce,I.slice=fue,I.sortBy=Cce,I.sortedUniq=wue,I.sortedUniqBy=bue,I.split=the,I.spread=Ace,I.tail=Sue,I.take=xue,I.takeRight=Rue,I.takeRightWhile=Eue,I.takeWhile=Fue,I.tap=zue,I.throttle=Dce,I.thru=Ay,I.toArray=HG,I.toPairs=KG,I.toPairsIn=YG,I.toPath=Ohe,I.toPlainObject=WG,I.transform=Ide,I.unary=kce,I.union=Aue,I.unionBy=Due,I.unionWith=kue,I.uniq=Pue,I.uniqBy=Mue,I.uniqWith=Tue,I.unset=_de,I.unzip=SF,I.unzipWith=AG,I.update=Ode,I.updateWith=Lde,I.values=nf,I.valuesIn=Nde,I.without=Iue,I.words=ZG,I.wrap=Pce,I.xor=_ue,I.xorBy=Oue,I.xorWith=Lue,I.zip=Nue,I.zipObject=$ue,I.zipObjectDeep=Bue,I.zipWith=Gue,I.entries=KG,I.entriesIn=YG,I.extend=UG,I.extendWith=_y,TF(I,I),I.add=Nhe,I.attempt=JG,I.camelCase=zde,I.capitalize=XG,I.ceil=$he,I.clamp=$de,I.clone=Tce,I.cloneDeep=_ce,I.cloneDeepWith=Oce,I.cloneWith=Ice,I.conformsTo=Lce,I.deburr=QG,I.defaultTo=mhe,I.divide=Bhe,I.endsWith=Hde,I.eq=io,I.escape=Vde,I.escapeRegExp=Wde,I.every=Que,I.find=Jue,I.findIndex=SG,I.findKey=hde,I.findLast=ece,I.findLastIndex=xG,I.findLastKey=fde,I.floor=Ghe,I.forEach=kG,I.forEachRight=PG,I.forIn=pde,I.forInRight=gde,I.forOwn=mde,I.forOwnRight=vde,I.get=AF,I.gt=Nce,I.gte=$ce,I.has=wde,I.hasIn=DF,I.head=EG,I.identity=yr,I.includes=sce,I.indexOf=eue,I.inRange=Bde,I.invoke=xde,I.isArguments=Yc,I.isArray=tt,I.isArrayBuffer=Bce,I.isArrayLike=vr,I.isArrayLikeObject=Fn,I.isBoolean=Gce,I.isBuffer=Cu,I.isDate=zce,I.isElement=Hce,I.isEmpty=Vce,I.isEqual=Wce,I.isEqualWith=Uce,I.isError=EF,I.isFinite=qce,I.isFunction=nl,I.isInteger=$G,I.isLength=Ty,I.isMap=BG,I.isMatch=jce,I.isMatchWith=Kce,I.isNaN=Yce,I.isNative=Xce,I.isNil=Zce,I.isNull=Qce,I.isNumber=GG,I.isObject=un,I.isObjectLike=mn,I.isPlainObject=em,I.isRegExp=FF,I.isSafeInteger=Jce,I.isSet=zG,I.isString=Iy,I.isSymbol=Vr,I.isTypedArray=tf,I.isUndefined=ede,I.isWeakMap=tde,I.isWeakSet=nde,I.join=sue,I.kebabCase=Ude,I.last=ys,I.lastIndexOf=oue,I.lowerCase=qde,I.lowerFirst=jde,I.lt=ide,I.lte=rde,I.max=zhe,I.maxBy=Hhe,I.mean=Vhe,I.meanBy=Whe,I.min=Uhe,I.minBy=qhe,I.stubArray=_F,I.stubFalse=OF,I.stubObject=Mhe,I.stubString=The,I.stubTrue=Ihe,I.multiply=jhe,I.nth=aue,I.noConflict=xhe,I.noop=IF,I.now=ky,I.pad=Kde,I.padEnd=Yde,I.padStart=Xde,I.parseInt=Qde,I.random=Gde,I.reduce=cce,I.reduceRight=dce,I.repeat=Zde,I.replace=Jde,I.result=Pde,I.round=Khe,I.runInContext=W,I.sample=fce,I.size=mce,I.snakeCase=ehe,I.some=vce,I.sortedIndex=pue,I.sortedIndexBy=gue,I.sortedIndexOf=mue,I.sortedLastIndex=vue,I.sortedLastIndexBy=Cue,I.sortedLastIndexOf=yue,I.startCase=nhe,I.startsWith=ihe,I.subtract=Yhe,I.sum=Xhe,I.sumBy=Qhe,I.template=rhe,I.times=_he,I.toFinite=il,I.toInteger=st,I.toLength=VG,I.toLower=she,I.toNumber=ws,I.toSafeInteger=sde,I.toString=_t,I.toUpper=ohe,I.trim=ahe,I.trimEnd=lhe,I.trimStart=uhe,I.truncate=che,I.unescape=dhe,I.uniqueId=Lhe,I.upperCase=hhe,I.upperFirst=kF,I.each=kG,I.eachRight=PG,I.first=EG,TF(I,function(){var f={};return Ko(I,function(v,w){Nt.call(I.prototype,w)||(f[w]=v)}),f}(),{chain:!1}),I.VERSION=i,ps(["bind","bindKey","curry","curryRight","partial","partialRight"],function(f){I[f].placeholder=I}),ps(["drop","take"],function(f,v){pt.prototype[f]=function(w){w=w===n?1:zn(st(w),0);var R=this.__filtered__&&!v?new pt(this):this.clone();return R.__filtered__?R.__takeCount__=Fi(w,R.__takeCount__):R.__views__.push({size:Fi(w,pe),type:f+(R.__dir__<0?"Right":"")}),R},pt.prototype[f+"Right"]=function(w){return this.reverse()[f](w).reverse()}}),ps(["filter","map","takeWhile"],function(f,v){var w=v+1,R=w==N||w==G;pt.prototype[f]=function(k){var _=this.clone();return _.__iteratees__.push({iteratee:Ve(k,3),type:w}),_.__filtered__=_.__filtered__||R,_}}),ps(["head","last"],function(f,v){var w="take"+(v?"Right":"");pt.prototype[f]=function(){return this[w](1).value()[0]}}),ps(["initial","tail"],function(f,v){var w="drop"+(v?"":"Right");pt.prototype[f]=function(){return this.__filtered__?new pt(this):this[w](1)}}),pt.prototype.compact=function(){return this.filter(yr)},pt.prototype.find=function(f){return this.filter(f).head()},pt.prototype.findLast=function(f){return this.reverse().find(f)},pt.prototype.invokeMap=lt(function(f,v){return typeof f=="function"?new pt(this):this.map(function(w){return Kg(w,f,v)})}),pt.prototype.reject=function(f){return this.filter(My(Ve(f)))},pt.prototype.slice=function(f,v){f=st(f);var w=this;return w.__filtered__&&(f>0||v<0)?new pt(w):(f<0?w=w.takeRight(-f):f&&(w=w.drop(f)),v!==n&&(v=st(v),w=v<0?w.dropRight(-v):w.take(v-f)),w)},pt.prototype.takeRightWhile=function(f){return this.reverse().takeWhile(f).reverse()},pt.prototype.toArray=function(){return this.take(pe)},Ko(pt.prototype,function(f,v){var w=/^(?:filter|find|map|reject)|While$/.test(v),R=/^(?:head|last)$/.test(v),k=I[R?"take"+(v=="last"?"Right":""):v],_=R||/^find/.test(v);k&&(I.prototype[v]=function(){var $=this.__wrapped__,z=R?[1]:arguments,j=$ instanceof pt,re=z[0],se=j||tt($),ae=function(ft){var vt=k.apply(I,du([ft],z));return R&&Ee?vt[0]:vt};se&&w&&typeof re=="function"&&re.length!=1&&(j=se=!1);var Ee=this.__chain__,_e=!!this.__actions__.length,We=_&&!Ee,at=j&&!_e;if(!_&&se){$=at?$:new pt(this);var Ue=f.apply($,z);return Ue.__actions__.push({func:Ay,args:[ae],thisArg:n}),new ms(Ue,Ee)}return We&&at?f.apply(this,z):(Ue=this.thru(ae),We?R?Ue.value()[0]:Ue.value():Ue)})}),ps(["pop","push","shift","sort","splice","unshift"],function(f){var v=JC[f],w=/^(?:push|sort|unshift)$/.test(f)?"tap":"thru",R=/^(?:pop|shift)$/.test(f);I.prototype[f]=function(){var k=arguments;if(R&&!this.__chain__){var _=this.value();return v.apply(tt(_)?_:[],k)}return this[w](function($){return v.apply(tt($)?$:[],k)})}}),Ko(pt.prototype,function(f,v){var w=I[v];if(w){var R=w.name+"";Nt.call(Xh,R)||(Xh[R]=[]),Xh[R].push({name:v,func:w})}}),Xh[wy(n,y).name]=[{name:"wrapper",func:n}],pt.prototype.clone=dae,pt.prototype.reverse=hae,pt.prototype.value=fae,I.prototype.at=Hue,I.prototype.chain=Vue,I.prototype.commit=Wue,I.prototype.next=Uue,I.prototype.plant=jue,I.prototype.reverse=Kue,I.prototype.toJSON=I.prototype.valueOf=I.prototype.value=Yue,I.prototype.first=I.prototype.head,zg&&(I.prototype[zg]=que),I},jh=Woe();zc?((zc.exports=jh)._=jh,ME._=jh):ui._=jh}).call(s5e)}(av,av.exports)),av.exports}var UM=o5e();function uW(e){const{field:t,type:n}=e;return`${t}${n}`}const qr={quantitative:[0,1],unknownQuantitative:0,quantitativeColor:e=>swe((e+.15)/1.15),unknownColor:"#EB10E0",nominalColor:P7},a5e={class:"cell-container"},l5e={key:0,class:"empty-cell pos-absolute"},u5e=mh({__name:"UDICellRenderer",props:{params:{}},setup(e){const t=e,n=Le(()=>{if(!t.params.udiColumnMapping)return[];const o=t.params.udiColumnMapping.map(c=>c.layer),l=[...new Set(o)].map(c=>{const h=t.params.udiColumnMapping.filter(g=>g.layer===c).filter(g=>{const m=t.params.data?.[g.field];return m!==null&&typeof m<"u"}).map(g=>g.mark),p=[...new Set(h)];return{layer:c,marks:p}}),u=[];for(const c of l)for(const d of c.marks)u.push({layer:c.layer,mark:d});return u}),i=Le(()=>{if(!t.params.udiColumnMapping)return{};const o=Object.groupBy(t.params.udiColumnMapping,l=>l.layer),a={};for(const l of Object.keys(o)){const u=o[l];if(!u)continue;const c=Object.groupBy(u,d=>d.mark);a[l]=c}return a});function r(o){if(!t.params.udiColumnMapping)return null;const a=i.value[o]?.text;if(!a)return null;const l=a.find(u=>u.encoding==="text");return l?t.params.data?.[l.field]:null}function s(o,a){if(!t.params.udiColumnMapping)return null;const l=i.value[o]?.[a];if(!l)return null;const u={};for(const c of l){const d=t.params.data?.[c.field];if(typeof d!="number"&&typeof d!="string"&&d!==null&&typeof d<"u")throw new Error(`Invalid data type for field ${c.field}: ${typeof d}`);const h=c.domain;let p=[0,1],g=["unknown"];switch("min"in h&&"max"in h?p=[h.min,h.max]:g=h.values,c.encoding){case"color":{let m;c.type==="quantitative"?m=hx(qr.quantitativeColor).domain(p).unknown(qr.unknownColor):m=q0(qr.nominalColor).domain(g).range(qr.nominalColor).unknown(qr.unknownColor);const C=m(d);c.mark==="text"?u.color=C:c.mark==="line"?u.borderColor=C:u.backgroundColor=C;break}case"x":{let C=hv().domain(p).range(qr.quantitative).unknown(qr.unknownQuantitative)(d)*100;C<0&&(C=0),c.mark==="text"?(u.left=`${C}%`,u.transform=`translate(-${C}%, -50%)`):c.mark==="bar"?u.width=`${C}%`:c.mark==="point"?u.left=`${C}%`:c.mark==="line"&&(u.height="100%",u.left=`${C}%`,u.width=0,u.borderTopWidth=0,u.borderBottomWidth=0);break}case"y":{const m=hv().domain(p).range(qr.quantitative).unknown(qr.unknownQuantitative)(d),C=m*100;c.mark==="text"?(u.top=`${100-C}%`,u.transform=`translateY(-${100-C}%)`):c.mark==="bar"?u.height=`${m*100}%`:c.mark==="point"?u.top=`${100-C}%`:c.mark==="line"&&(u.top=`${100-C}%`,u.borderLeftWidth=0,u.borderRightWidth=0);break}case"yOffset":{const m=qk().domain(g).range(qr.quantitative)(d)??0,C=1/g.length;c.mark==="bar"?(u.bottom=`${m*100}%`,u.height=`${C*100}%`):c.mark==="line"&&(u.top=`${100-(m+C/2)*100}%`,u.height=0,u.borderLeftWidth=0,u.borderRightWidth=0);break}case"xOffset":{const m=qk().domain(g).range(qr.quantitative)(d)??0,C=1/g.length;c.mark==="bar"?(u.left=`${m*100}%`,u.width=`${C*100}%`):c.mark==="line"&&(u.height="100%",u.left=`${(m+C/2)*100}%`,u.width=0,u.borderTopWidth=0,u.borderBottomWidth=0);break}case"size":{const m=hv().domain(p).range(qr.quantitative).unknown(qr.unknownQuantitative)(d);if(c.mark==="rect")u.width=`${m*100}%`,u.height=`${m*100}%`,u.left=`${(1-m)*50}%`,u.bottom=`${(1-m)*50}%`;else if(c.mark==="point"){let C=0;m>0&&(C=Math.sqrt(m));const y=16;u.width=`${C*y}px`,u.height=`${C*y}px`}break}}}return u}return(o,a)=>(Dn(),hi("div",a5e,[(Dn(!0),hi(Gv,null,mfe(n.value,({layer:l,mark:u})=>(Dn(),hi(Gv,{key:u},[u==="text"?(Dn(),hi("div",{key:0,style:tm(s(l,u)),class:"pos-absolute text"},O1(r(l)),5)):u==="bar"?(Dn(),hi("div",{key:1,style:tm(s(l,u)),class:"pos-absolute bar"},null,4)):u==="rect"?(Dn(),hi("div",{key:2,style:tm(s(l,u)),class:"pos-absolute rect"},null,4)):u==="point"?(Dn(),hi("div",{key:3,style:tm(s(l,u)),class:"pos-absolute point"},null,4)):u==="line"?(Dn(),hi("div",{key:4,style:tm(s(l,u)),class:"pos-absolute line"},null,4)):Ek("",!0)],64))),128)),n.value.length===0?(Dn(),hi("div",l5e,"")):Ek("",!0)]))}}),c5e=L1(u5e,[["__scopeId","data-v-4ca9b009"]]);var hh=class{constructor(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}setFrameworkOverrides(e){this.frameworkOverrides=e}getListeners(e,t,n){const i=t?this.allAsyncListeners:this.allSyncListeners;let r=i.get(e);return!r&&n&&(r=new Set,i.set(e,r)),r}noRegisteredListenersExist(){return this.allSyncListeners.size===0&&this.allAsyncListeners.size===0&&this.globalSyncListeners.size===0&&this.globalAsyncListeners.size===0}addEventListener(e,t,n=!1){this.getListeners(e,n,!0).add(t)}removeEventListener(e,t,n=!1){const i=this.getListeners(e,n,!1);i&&(i.delete(t),i.size===0&&(n?this.allAsyncListeners:this.allSyncListeners).delete(e))}addGlobalListener(e,t=!1){(t?this.globalAsyncListeners:this.globalSyncListeners).add(e)}removeGlobalListener(e,t=!1){(t?this.globalAsyncListeners:this.globalSyncListeners).delete(e)}dispatchEvent(e){const t=e;this.dispatchToListeners(t,!0),this.dispatchToListeners(t,!1),this.firedEvents[t.type]=!0}dispatchEventOnce(e){this.firedEvents[e.type]||this.dispatchEvent(e)}dispatchToListeners(e,t){const n=e.type;if(t&&"event"in e){const a=e.event;a instanceof Event&&(e.eventPath=a.composedPath())}const i=(a,l)=>a.forEach(u=>{if(!l.has(u))return;const c=this.frameworkOverrides?()=>this.frameworkOverrides.wrapIncoming(()=>u(e)):()=>u(e);t?this.dispatchAsync(c):c()}),r=this.getListeners(n,t,!1)??new Set,s=new Set(r);s.size>0&&i(s,r),new Set(t?this.globalAsyncListeners:this.globalSyncListeners).forEach(a=>{const l=this.frameworkOverrides?()=>this.frameworkOverrides.wrapIncoming(()=>a(n,e)):()=>a(n,e);t?this.dispatchAsync(l):l()})}dispatchAsync(e){if(this.asyncFunctionsQueue.push(e),!this.scheduled){const t=()=>{window.setTimeout(this.flushAsyncQueue.bind(this),0)};this.frameworkOverrides?this.frameworkOverrides.wrapIncoming(t):t(),this.scheduled=!0}}flushAsyncQueue(){this.scheduled=!1;const e=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[],e.forEach(t=>t())}};function d5e(e,t){return t}function XJ(e){return e?.getLocaleTextFunc()??d5e}function au(e,t,n){n==null||typeof n=="string"&&n==""?QJ(e,t):Qs(e,t,n)}function Qs(e,t,n){e.setAttribute(ZJ(t),n.toString())}function QJ(e,t){e.removeAttribute(ZJ(t))}function ZJ(e){return`aria-${e}`}function Vl(e,t){t?e.setAttribute("role",t):e.removeAttribute("role")}function h5e(e){let t;return e==="asc"?t="ascending":e==="desc"?t="descending":e==="mixed"?t="other":t="none",t}function f5e(e){return e.getAttribute("aria-label")}function WR(e,t){au(e,"label",t)}function qM(e,t){au(e,"labelledby",t)}function JJ(e,t){au(e,"live",t)}function p5e(e,t){au(e,"atomic",t)}function g5e(e,t){au(e,"relevant",t)}function m5e(e,t){au(e,"disabled",t)}function eee(e,t){au(e,"hidden",t)}function jM(e,t){Qs(e,"expanded",t)}function v5e(e,t){Qs(e,"setsize",t)}function C5e(e,t){Qs(e,"posinset",t)}function y5e(e,t){Qs(e,"multiselectable",t)}function w5e(e,t){Qs(e,"rowcount",t)}function rN(e,t){Qs(e,"rowindex",t)}function b5e(e,t){Qs(e,"rowspan",t)}function S5e(e,t){Qs(e,"colcount",t)}function tee(e,t){Qs(e,"colindex",t)}function x5e(e,t){Qs(e,"colspan",t)}function R5e(e,t){Qs(e,"sort",t)}function E5e(e){QJ(e,"sort")}function KM(e,t){au(e,"selected",t)}function F5e(e,t){au(e,"controls",t.id),qM(t,e.id)}function sN(e,t){return t===void 0?e("ariaIndeterminate","indeterminate"):t===!0?e("ariaChecked","checked"):e("ariaUnchecked","unchecked")}var _D,OD,LD,ND,YM,XM,$D;function Oh(){return _D===void 0&&(_D=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),_D}function nee(){return OD===void 0&&(OD=/(firefox)/i.test(navigator.userAgent)),OD}function iee(){return LD===void 0&&(LD=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),LD}function Nd(){return ND===void 0&&(ND=/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1),ND}function QM(e){if(!e)return null;const t=e.tabIndex,n=e.getAttribute("tabIndex");return t===-1&&(n===null||n===""&&!nee())?null:t.toString()}function A5e(){if($D!==void 0)return $D;if(!document.body)return-1;let e=1e6;const t=nee()?6e6:1e9,n=document.createElement("div");for(document.body.appendChild(n);;){const i=e*2;if(n.style.height=i+"px",i>t||n.clientHeight!==i)break;e=i}return document.body.removeChild(n),$D=e,e}function D5e(){return XM==null&&ree(),XM}function ree(){const e=document.body,t=document.createElement("div");t.style.width=t.style.height="100px",t.style.opacity="0",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",t.style.position="absolute",e.appendChild(t);let n=t.offsetWidth-t.clientWidth;n===0&&t.clientWidth===0&&(n=null),t.parentNode&&t.parentNode.removeChild(t),n!=null&&(XM=n,YM=n===0)}function see(){return YM==null&&ree(),YM}var k5e="[tabindex], input, select, button, textarea, [href]",oee="[disabled], .ag-disabled:not(.ag-button), .ag-disabled *";function oN(e){const t=Element.prototype.matches||Element.prototype.msMatchesSelector,i=t.call(e,"input, select, button, textarea"),r=t.call(e,oee),s=Io(e);return i&&!r&&s}function tn(e,t,n={}){const{skipAriaHidden:i}=n;e.classList.toggle("ag-hidden",!t),i||eee(e,!t)}function P5e(e,t,n={}){const{skipAriaHidden:i}=n;e.classList.toggle("ag-invisible",!t),i||eee(e,!t)}function y0(e,t){const n="disabled",i=t?s=>s.setAttribute(n,""):s=>s.removeAttribute(n);i(e);const r=e.querySelectorAll("input")??[];for(const s of r)i(s)}function $d(e,t,n){let i=0;for(;e;){if(e.classList.contains(t))return!0;if(e=e.parentElement,typeof n=="number"){if(++i>n)break}else if(e===n)break}return!1}function Lh(e){const{height:t,width:n,borderTopWidth:i,borderRightWidth:r,borderBottomWidth:s,borderLeftWidth:o,paddingTop:a,paddingRight:l,paddingBottom:u,paddingLeft:c,marginTop:d,marginRight:h,marginBottom:p,marginLeft:g,boxSizing:m}=window.getComputedStyle(e);return{height:parseFloat(t||"0"),width:parseFloat(n||"0"),borderTopWidth:parseFloat(i||"0"),borderRightWidth:parseFloat(r||"0"),borderBottomWidth:parseFloat(s||"0"),borderLeftWidth:parseFloat(o||"0"),paddingTop:parseFloat(a||"0"),paddingRight:parseFloat(l||"0"),paddingBottom:parseFloat(u||"0"),paddingLeft:parseFloat(c||"0"),marginTop:parseFloat(d||"0"),marginRight:parseFloat(h||"0"),marginBottom:parseFloat(p||"0"),marginLeft:parseFloat(g||"0"),boxSizing:m}}function aN(e){const t=Lh(e);return t.boxSizing==="border-box"?t.height-t.paddingTop-t.paddingBottom:t.height}function w0(e){const t=Lh(e);return t.boxSizing==="border-box"?t.width-t.paddingLeft-t.paddingRight:t.width}function aee(e){const{height:t,marginBottom:n,marginTop:i}=Lh(e);return Math.floor(t+n+i)}function i1(e){const{width:t,marginLeft:n,marginRight:i}=Lh(e);return Math.floor(t+n+i)}function lee(e){const t=e.getBoundingClientRect(),{borderTopWidth:n,borderLeftWidth:i,borderRightWidth:r,borderBottomWidth:s}=Lh(e);return{top:t.top+(n||0),left:t.left+(i||0),right:t.right+(r||0),bottom:t.bottom+(s||0)}}function r1(e,t){let n=e.scrollLeft;return t&&(n=Math.abs(n)),n}function s1(e,t,n){n&&(t*=-1),e.scrollLeft=t}function Gi(e){for(;e&&e.firstChild;)e.removeChild(e.firstChild)}function _s(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function uee(e){return!!e.offsetParent}function Io(e){const t=e;return t.checkVisibility?t.checkVisibility({checkVisibilityCSS:!0}):!(!uee(e)||window.getComputedStyle(e).visibility!=="visible")}function UR(e){const t=document.createElement("div");return t.innerHTML=(e||"").trim(),t.firstChild}function cee(e,t,n){n&&n.nextSibling===t||(e.firstChild?n?n.nextSibling?e.insertBefore(t,n.nextSibling):e.appendChild(t):e.firstChild&&e.firstChild!==t&&e.insertAdjacentElement("afterbegin",t):e.appendChild(t))}function dee(e,t){for(let n=0;n<t.length;n++){const i=t[n],r=e.children[n];r!==i&&e.insertBefore(i,r)}}function M5e(e){return e.replace(/[A-Z]/g,t=>`-${t.toLocaleLowerCase()}`)}function _C(e,t){if(t)for(const n of Object.keys(t)){const i=t[n];if(!n||!n.length||i==null)continue;const r=M5e(n),s=i.toString(),o=s.replace(/\s*!important/g,""),a=o.length!=s.length?"important":void 0;e.style.setProperty(r,o,a)}}function T5e(e){return e.clientWidth<e.scrollWidth}function I5e(e){return e.clientHeight<e.scrollHeight}function o1(e,t){t==="flex"?(e.style.removeProperty("width"),e.style.removeProperty("minWidth"),e.style.removeProperty("maxWidth"),e.style.flex="1 1 auto"):Ra(e,t)}function Ra(e,t){t=lN(t),e.style.width=t,e.style.maxWidth=t,e.style.minWidth=t}function Av(e,t){t=lN(t),e.style.height=t,e.style.maxHeight=t,e.style.minHeight=t}function lN(e){return typeof e=="number"?`${e}px`:e}function uN(e){return e instanceof Node||e instanceof HTMLElement}function $s(e,t,n){n==null||n===""?e.removeAttribute(t):e.setAttribute(t,n.toString())}function _c(e,t,n){const r=See(e).ResizeObserver,s=r?new r(n):null;return s?.observe(t),()=>s?.disconnect()}function lu(e,t){const n=See(e);n.requestAnimationFrame?n.requestAnimationFrame(t):n.webkitRequestAnimationFrame?n.webkitRequestAnimationFrame(t):n.setTimeout(t,0)}var hee="data-ref",BD;function cW(){return BD??(BD=document.createTextNode(" ")),BD.cloneNode()}function Sn(e){const{attrs:t,children:n,cls:i,ref:r,role:s,tag:o}=e,a=document.createElement(o);if(i&&(a.className=i),r&&a.setAttribute(hee,r),s&&a.setAttribute("role",s),t)for(const l of Object.keys(t))a.setAttribute(l,t[l]);if(n)if(typeof n=="string")a.textContent=n;else{let l=!0;for(const u of n)u&&(typeof u=="string"?(a.appendChild(document.createTextNode(u)),l=!1):(l&&(a.appendChild(cW()),l=!1),a.append(Sn(u)),a.appendChild(cW())))}return a}function Il(e){return e==null||e===""?null:e}function Ce(e){return e!=null&&e!==""}function Xt(e){return!Ce(e)}function ZM(e){return e!=null&&typeof e.toString=="function"?e.toString():null}function b0(e,t){const n=e?JSON.stringify(e):null,i=t?JSON.stringify(t):null;return n===i}function _5e(e,t,n=!1){const i=e==null,r=t==null;if(e&&e.toNumber&&(e=e.toNumber()),t&&t.toNumber&&(t=t.toNumber()),i&&r)return 0;if(i)return-1;if(r)return 1;function s(o,a){return o>a?1:o<a?-1:0}if(typeof e!="string"||!n)return s(e,t);try{return e.localeCompare(t)}catch{return s(e,t)}}var fee="https://www.ag-grid.com",dW={};function pee(e,t){dW[t]||(e(),dW[t]=!0)}function fc(e,t,...n){e.get("debug")&&console.log("AG Grid: "+t,...n)}function Dv(e,...t){pee(()=>console.warn("AG Grid: "+e,...t),e+t?.join(""))}function qf(e,...t){pee(()=>console.error("AG Grid: "+e,...t),e+t?.join(""))}var O5e={pending:!1,funcs:[]},L5e={pending:!1,funcs:[]};function JM(e,t="setTimeout",n){const i=t==="raf"?L5e:O5e;if(i.funcs.push(e),i.pending)return;i.pending=!0;const r=()=>{const s=i.funcs.slice();i.funcs.length=0,i.pending=!1,s.forEach(o=>o())};t==="raf"?lu(n,r):window.setTimeout(r,0)}function yi(e,t,n){let i;return function(...r){const s=this;window.clearTimeout(i),i=window.setTimeout(function(){e.isAlive()&&t.apply(s,r)},n)}}function hW(e,t){let n=0;return function(...i){const r=this,s=Date.now();s-n<t||(n=s,e.apply(r,i))}}function N5e(e,t,n=100,i){const r=Date.now();let s=null,o=!1;const a=()=>{const l=Date.now()-r>n;(e()||l)&&(t(),o=!0,s!=null&&(window.clearInterval(s),s=null))};a(),o||(s=window.setInterval(a,10))}var we="33.2.4",fW=2e3,pW=100,gee="_version_",mee=null,Bd=`${fee}/javascript-data-grid`;function $5e(e){mee=e}function B5e(e){Bd=e}function vee(e,t,n){return mee?.getConsoleMessage(e,t)??[V5e(e,t,n)]}function cN(e,t,n,i){e(`error #${t}`,...vee(t,n,i))}function G5e(e){if(!e)return String(e);const t={};for(const n of Object.keys(e))typeof e[n]!="object"&&typeof e[n]!="function"&&(t[n]=e[n]);return JSON.stringify(t)}function z5e(e){let t=e;return e instanceof Error?t=e.toString():typeof e=="object"&&(t=G5e(e)),t}function a1(e){return e===void 0?"undefined":e===null?"null":e}function eT(e,t){return`${e}?${t.toString()}`}function H5e(e,t,n){const i=Array.from(t.entries()).sort((s,o)=>o[1].length-s[1].length);let r=eT(e,t);for(const[s,o]of i){if(s===gee)continue;const a=r.length-n;if(a<=0)break;const l="...",u=a+l.length,c=o.length-u>pW?o.slice(0,o.length-u)+l:o.slice(0,pW)+l;t.set(s,c),r=eT(e,t)}return r}function Cee(e,t){const n=new URLSearchParams;if(n.append(gee,we),t)for(const s of Object.keys(t))n.append(s,z5e(t[s]));const i=`${Bd}/errors/${e}`,r=eT(i,n);return r.length<=fW?r:H5e(i,n,fW)}var V5e=(e,t,n)=>{const i=Cee(e,t);return`${n?n+` 
`:""}Visit ${i}${n?"":` 
  Alternatively register the ValidationModule to see the full message in the console.`}`};function de(...e){cN(Dv,e[0],e[1])}function Ft(...e){cN(qf,e[0],e[1])}function tT(e,t,n){cN(qf,e,t,n)}function W5e(e,t){const n=t[0];return`error #${n} `+vee(n,t[1],e).join(" ")}function Xu(...e){return W5e(void 0,e)}function yee(e,t){return e.get("rowModelType")===t}function tr(e,t){return yee(e,"clientSide")}function bg(e,t){return yee(e,"serverSide")}function Si(e,t){return e.get("domLayout")===t}function Gd(e){return u1(e)!==void 0}function wee(e){return typeof e.get("getRowHeight")=="function"}function U5e(e,t){return t?!e.get("enableStrictPivotColumnOrder"):e.get("maintainColumnOrder")}function Np(e,t,n=!1,i){const{gos:r,environment:s}=e;if(i==null&&(i=s.getDefaultRowHeight()),wee(r)){if(n)return{height:i,estimated:!0};const l={node:t,data:t.data},u=r.getCallback("getRowHeight")(l);if(nT(u))return u===0&&de(23),{height:Math.max(1,u),estimated:!1}}if(t.detail&&r.get("masterDetail"))return q5e(r);const o=r.get("rowHeight");return{height:o&&nT(o)?o:i,estimated:!1}}function q5e(e){if(e.get("detailRowAutoHeight"))return{height:1,estimated:!1};const t=e.get("detailRowHeight");return nT(t)?{height:t,estimated:!1}:{height:300,estimated:!1}}function zd(e){const{environment:t,gos:n}=e,i=n.get("rowHeight");if(!i||Xt(i))return t.getDefaultRowHeight();const r=t.refreshRowHeightVariable();return r!==-1?r:(de(24),t.getDefaultRowHeight())}function nT(e){return!isNaN(e)&&typeof e=="number"&&isFinite(e)}function bee(e,t,n){const i=t[e.getDomDataKey()];return i?i[n]:void 0}function fh(e,t,n,i){const r=e.getDomDataKey();let s=t[r];Xt(s)&&(s={},t[r]=s),s[n]=i}function Pn(e){const{gos:t,eGridDiv:n}=e;let i=null;const r=t.get("getDocument");return r&&Ce(r)?i=r():n&&(i=n.ownerDocument),i&&Ce(i)?i:document}function See(e){return Pn(e).defaultView||window}function S0(e){return e.eGridDiv.getRootNode()}function nn(e){return S0(e).activeElement}function dN(e){let t=null,n=null;try{t=Pn(e).fullscreenElement}catch{}finally{t||(t=S0(e));const i=t.querySelector("body");i?n=i:t instanceof ShadowRoot?n=t:t instanceof Document?n=t?.documentElement:n=t}return n}function j5e(e){return dN(e)?.clientWidth??(window.innerHeight||-1)}function K5e(e){return dN(e)?.clientHeight??(window.innerHeight||-1)}function Y5e(e,t,n){const r=e.getBoundingClientRect().height,s=j5e(n)-2,o=K5e(n)-2;if(!e.offsetParent)return;const l=lee(e.offsetParent),{clientY:u,clientX:c}=t;let d=u-l.top-r/2,h=c-l.left-10;const p=Pn(n),g=p.defaultView||window,m=g.pageYOffset||p.documentElement.scrollTop,C=g.pageXOffset||p.documentElement.scrollLeft;s>0&&h+e.clientWidth>s+C&&(h=s+C-e.clientWidth),h<0&&(h=0),o>0&&d+e.clientHeight>o+m&&(d=o+m-e.clientHeight),d<0&&(d=0),e.style.left=`${h}px`,e.style.top=`${d}px`}function xee(e){const t=Pn(e),n=nn(e);return n===null||n===t.body}function jf(e){return e.get("ensureDomOrder")?!1:e.get("animateRows")}function Ree(e){return!(e.get("paginateChildRows")||e.get("groupHideOpenParents")||Si(e,"print"))}function pa(e){return!e.get("autoGroupColumnDef")?.comparator&&!e.get("treeData")}function iT(e){const t=e.get("groupAggFiltering");if(typeof t=="function")return e.getCallback("groupAggFiltering");if(t===!0)return()=>!0}function X5e(e){return e.get("groupHideOpenParents")?!0:e.get("groupDisplayType")==="multipleColumns"}function hN(e,t){return t?!1:e.get("groupDisplayType")==="groupRows"}function $p(e){const t=e.getCallback("getRowId");return t===void 0?t:n=>{let i=t(n);return typeof i!="string"&&(de(25,{id:i}),i=String(i)),i}}function Q5e(e,t){const n=e.get("groupHideParentOfSingleChild");return!!(n===!0||n==="leafGroupsOnly"&&t.leafGroup||e.get("groupRemoveSingleChildren")||e.get("groupRemoveLowestSingleChildren")&&t.leafGroup)}function Z5e(e){const t=e.get("maxConcurrentDatasourceRequests");return t>0?t:void 0}function Kf(e){return e?.checkboxes??!0}function gb(e){return e?.mode==="multiRow"&&(e.headerCheckbox??!0)}function l1(e){if(typeof e=="object")return e.checkboxLocation??"selectionColumn"}function GD(e){return e?.hideDisabledCheckboxes??!1}function J5e(e){return typeof e.get("rowSelection")!="string"}function Wl(e){const t=e.get("cellSelection");return t!==void 0?!!t:e.get("enableRangeSelection")}function Eee(e){const t=e.get("rowSelection")??"single";if(typeof t=="string"){const n=e.get("suppressRowClickSelection"),i=e.get("suppressRowDeselection");return n&&i?!1:n?"enableDeselection":i?"enableSelection":!0}return t.mode==="singleRow"||t.mode==="multiRow"?t.enableClickSelection??!1:!1}function e6e(e){const t=Eee(e);return t===!0||t==="enableSelection"}function t6e(e){const t=Eee(e);return t===!0||t==="enableDeselection"}function rT(e){const t=e.get("rowSelection");return typeof t=="string"?e.get("isRowSelectable"):t?.isRowSelectable}function u1(e){const t="beanName"in e&&e.beanName==="gos"?e.get("rowSelection"):e.rowSelection;if(typeof t=="string")switch(t){case"multiple":return"multiRow";case"single":return"singleRow";default:return}switch(t?.mode){case"multiRow":case"singleRow":return t.mode;default:return}}function x0(e){return u1(e)==="multiRow"}function n6e(e){const t=e.get("rowSelection");return typeof t=="string"?e.get("rowMultiSelectWithClick"):t?.enableSelectionWithoutKeys??!1}function c1(e){const t=e.get("rowSelection");if(typeof t=="string"){const n=e.get("groupSelectsChildren"),i=e.get("groupSelectsFiltered");return n&&i?"filteredDescendants":n?"descendants":"self"}return t?.mode==="multiRow"?t.groupSelects:void 0}function Fee(e,t=!0){const n=e.get("rowSelection");return typeof n!="object"?t?"all":void 0:n.mode==="multiRow"?n.selectAll:"all"}function R0(e){const t=c1(e);return t==="descendants"||t==="filteredDescendants"}function gW(e){const t=e.get("rowSelection");return typeof t=="object"&&t.masterSelects||"self"}function zD(e){return e.isModuleRegistered("SetFilter")&&!e.get("suppressSetFilterByDefault")}function Zr(e){return e.get("columnMenu")==="legacy"}function i6e(e){return!Zr(e)}function fN(e){return!e||e.length<2?e:"on"+e[0].toUpperCase()+e.substring(1)}function r6e(e,t,n){typeof e!="object"&&(e={});const i={...e};return n.forEach(r=>{const s=t[r];typeof s<"u"&&(i[r]=s)}),i}function s6e(e,t){if(!e)return;const n={};let i=!1;if(Object.keys(e).forEach(o=>{n[o]=e[o],i=!0}),!i)return;const r={type:"gridOptionsChanged",options:n};t.dispatchEvent(r);const s={type:"componentStateChanged",...n};t.dispatchEvent(s)}function ze(e,t){return e.addGridCommonParams(t)}function o6e(e){return e.get("treeData")?e.get("treeDataParentIdField")?"treeSelfRef":e.get("treeDataChildrenField")?"treeNested":"treePath":"group"}var Aee="__ag_Grid_Stop_Propagation",a6e=["touchstart","touchend","touchmove","touchcancel","scroll"],l6e=["wheel"],HD={};function Bp(e){e[Aee]=!0}function _l(e){return e[Aee]===!0}var Dee=(()=>{const e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return n=>{if(typeof HD[n]=="boolean")return HD[n];const i=document.createElement(e[n]||"div");return n="on"+n,HD[n]=n in i}})();function kee(e,t,n){let i=t;for(;i;){const r=bee(e,i,n);if(r)return r;i=i.parentElement}return null}function u6e(e,t){return!t||!e?!1:d6e(t).indexOf(e)>=0}function c6e(e){const t=[];let n=e.target;for(;n;)t.push(n),n=n.parentElement;return t}function d6e(e){const t=e;return t.path?t.path:t.composedPath?t.composedPath():c6e(t)}function h6e(e,t,n,i){const r=Pee(n);let s;r!=null&&(s={passive:r}),e&&e.addEventListener&&e.addEventListener(t,n,i,s)}var Pee=e=>{const t=a6e.includes(e),n=l6e.includes(e);if(t)return!0;if(n)return!1},Z=class{constructor(){this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.propertyListenerId=0,this.lastChangeSetIdLookup={},this.isAlive=()=>!this.destroyed}preWireBeans(e){this.beans=e,this.stubContext=e.context,this.eventSvc=e.eventSvc,this.gos=e.gos}destroy(){const{destroyFunctions:e}=this;for(let t=0;t<e.length;t++)e[t]();e.length=0,this.destroyed=!0,this.dispatchLocalEvent({type:"destroyed"})}addEventListener(e,t,n){this.localEventService||(this.localEventService=new hh),this.localEventService.addEventListener(e,t,n)}removeEventListener(e,t,n){this.localEventService?.removeEventListener(e,t,n)}dispatchLocalEvent(e){this.localEventService?.dispatchEvent(e)}addManagedElementListeners(e,t){return this._setupListeners(e,t)}addManagedEventListeners(e){return this._setupListeners(this.eventSvc,e)}addManagedListeners(e,t){return this._setupListeners(e,t)}_setupListeners(e,t){const n=[];for(const i of Object.keys(t)){const r=t[i];r&&n.push(this._setupListener(e,i,r))}return n}_setupListener(e,t,n){if(this.destroyed)return()=>null;let i;return f6e(e)?(e.__addEventListener(t,n),i=()=>(e.__removeEventListener(t,n),null)):(e instanceof HTMLElement?h6e(this.beans.frameworkOverrides,e,t,n):e.addEventListener(t,n),i=()=>(e.removeEventListener(t,n),null)),this.destroyFunctions.push(i),()=>(i(),this.destroyFunctions=this.destroyFunctions.filter(r=>r!==i),null)}setupGridOptionListener(e,t){const{gos:n}=this;n.addPropertyEventListener(e,t);const i=()=>(n.removePropertyEventListener(e,t),null);return this.destroyFunctions.push(i),()=>(i(),this.destroyFunctions=this.destroyFunctions.filter(r=>r!==i),null)}addManagedPropertyListener(e,t){return this.destroyed?()=>null:this.setupGridOptionListener(e,t)}addManagedPropertyListeners(e,t){if(this.destroyed)return;const n=e.join("-")+this.propertyListenerId++,i=r=>{if(r.changeSet){if(r.changeSet&&r.changeSet.id===this.lastChangeSetIdLookup[n])return;this.lastChangeSetIdLookup[n]=r.changeSet.id}const s={type:"gridPropertyChanged",changeSet:r.changeSet,source:r.source};t(s)};e.forEach(r=>this.setupGridOptionListener(r,i))}getLocaleTextFunc(){return XJ(this.beans.localeSvc)}addDestroyFunc(e){this.isAlive()?this.destroyFunctions.push(e):e()}createOptionalManagedBean(e,t){return e?this.createManagedBean(e,t):void 0}createManagedBean(e,t){const n=this.createBean(e,t);return this.addDestroyFunc(this.destroyBean.bind(this,e,t)),n}createBean(e,t,n){return(t||this.stubContext).createBean(e,n)}destroyBean(e,t){return(t||this.stubContext).destroyBean(e)}destroyBeans(e,t){return(t||this.stubContext).destroyBeans(e)}};function f6e(e){return e.__addEventListener!==void 0}var Mee=new Set(["__proto__","constructor","prototype"]);function p6e(e,t){if(e!=null){if(Array.isArray(e)){for(let n=0;n<e.length;n++)t(n.toString(),e[n]);return}for(const n of Object.keys(e))t(n,e[n])}}function lr(e,t,n=!0,i=!1){Ce(t)&&p6e(t,(r,s)=>{if(Mee.has(r))return;let o=e[r];o!==s&&(i&&o==null&&s!=null&&typeof s=="object"&&s.constructor===Object&&(o={},e[r]=o),mW(s)&&mW(o)&&!Array.isArray(o)?lr(o,s,n,i):(n||s!==void 0)&&(e[r]=s))})}function kv(e,t,n){if(!t||!e)return;if(!n)return e[t];const i=t.split(".");let r=e;for(let s=0;s<i.length;s++){if(r==null)return;r=r[i[s]]}return r}function mW(e){return typeof e=="object"&&e!==null}var g6e=/[&<>"']/g,m6e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Ol(e,t){if(e==null)return null;const n=e.toString().toString();return t?n:n.replace(g6e,i=>m6e[i])}var v6e={resizable:!0,sortable:!0},C6e=0;function Tee(){return C6e++}function pc(e){return e instanceof pN}var pN=class extends Z{constructor(e,t,n,i){super(),this.colDef=e,this.userProvidedColDef=t,this.colId=n,this.primary=i,this.isColumn=!0,this.instanceId=Tee(),this.autoHeaderHeight=null,this.moving=!1,this.menuVisible=!1,this.lastLeftPinned=!1,this.firstRightPinned=!1,this.filterActive=!1,this.colEventSvc=new hh,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.flex=null,this.colIdSanitised=Ol(n)}destroy(){super.destroy(),this.beans.rowSpanSvc?.deregister(this)}getInstanceId(){return this.instanceId}setState(){const{colDef:e,beans:{sortSvc:t,pinnedCols:n,colFlex:i}}=this;t?.initCol(this);const r=e.hide;r!==void 0?this.visible=!r:this.visible=!e.initialHide,n?.initCol(this),i?.initCol(this)}setColDef(e,t,n){const i=e.spanRows!==this.colDef.spanRows;this.colDef=e,this.userProvidedColDef=t,this.initMinAndMaxWidths(),this.initDotNotation(),this.initTooltip(),i&&(this.beans.rowSpanSvc?.deregister(this),this.initRowSpan()),this.dispatchColEvent("colDefChanged",n)}getUserProvidedColDef(){return this.userProvidedColDef}getParent(){return this.parent}getOriginalParent(){return this.originalParent}postConstruct(){this.setState(),this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip(),this.initRowSpan()}initDotNotation(){const{gos:e,colDef:{field:t,tooltipField:n}}=this,i=e.get("suppressFieldDotNotation");this.fieldContainsDots=Ce(t)&&t.indexOf(".")>=0&&!i,this.tooltipFieldContainsDots=Ce(n)&&n.indexOf(".")>=0&&!i}initMinAndMaxWidths(){const e=this.colDef;this.minWidth=e.minWidth??this.beans.environment.getDefaultColumnMinWidth(),this.maxWidth=e.maxWidth??Number.MAX_SAFE_INTEGER}initTooltip(){this.beans.tooltipSvc?.initCol(this)}initRowSpan(){this.colDef.spanRows&&this.beans.rowSpanSvc?.register(this)}resetActualWidth(e){const t=this.calculateColInitialWidth(this.colDef);this.setActualWidth(t,e,!0)}calculateColInitialWidth(e){let t;const n=e.width,i=e.initialWidth;return n!=null?t=n:i!=null?t=i:t=200,Math.max(Math.min(t,this.maxWidth),this.minWidth)}isEmptyGroup(){return!1}isRowGroupDisplayed(e){return this.beans.showRowGroupCols?.isRowGroupDisplayed(this,e)??!1}isPrimary(){return this.primary}isFilterAllowed(){return!!this.colDef.filter}isFieldContainsDots(){return this.fieldContainsDots}isTooltipEnabled(){return this.tooltipEnabled}isTooltipFieldContainsDots(){return this.tooltipFieldContainsDots}getHighlighted(){return this.highlighted}__addEventListener(e,t){this.colEventSvc.addEventListener(e,t)}__removeEventListener(e,t){this.colEventSvc.removeEventListener(e,t)}addEventListener(e,t){this.frameworkEventListenerService=this.beans.frameworkOverrides.createLocalEventListenerWrapper?.(this.frameworkEventListenerService,this.colEventSvc);const n=this.frameworkEventListenerService?.wrap(t)??t;this.colEventSvc.addEventListener(e,n)}removeEventListener(e,t){const n=this.frameworkEventListenerService?.unwrap(t)??t;this.colEventSvc.removeEventListener(e,n)}createColumnFunctionCallbackParams(e){return ze(this.gos,{node:e,data:e.data,column:this,colDef:this.colDef})}isSuppressNavigable(e){return this.beans.cellNavigation?.isSuppressNavigable(this,e)??!1}isCellEditable(e){return this.beans.editSvc?.isCellEditable(this,e)??!1}isSuppressFillHandle(){return!!this.colDef.suppressFillHandle}isAutoHeight(){return!!this.colDef.autoHeight}isAutoHeaderHeight(){return!!this.colDef.autoHeaderHeight}isRowDrag(e){return this.isColumnFunc(e,this.colDef.rowDrag)}isDndSource(e){return this.isColumnFunc(e,this.colDef.dndSource)}isCellCheckboxSelection(e){return this.beans.selectionSvc?.isCellCheckboxSelection(this,e)??!1}isSuppressPaste(e){return this.isColumnFunc(e,this.colDef?.suppressPaste??null)}isResizable(){return!!this.getColDefValue("resizable")}getColDefValue(e){return this.colDef[e]??v6e[e]}isColumnFunc(e,t){if(typeof t=="boolean")return t;if(typeof t=="function"){const n=this.createColumnFunctionCallbackParams(e);return t(n)}return!1}createColumnEvent(e,t){return ze(this.gos,{type:e,column:this,columns:[this],source:t})}isMoving(){return this.moving}getSort(){return this.sort}isSortable(){return!!this.getColDefValue("sortable")}isSortAscending(){return this.sort==="asc"}isSortDescending(){return this.sort==="desc"}isSortNone(){return Xt(this.sort)}isSorting(){return Ce(this.sort)}getSortIndex(){return this.sortIndex}isMenuVisible(){return this.menuVisible}getAggFunc(){return this.aggFunc}getLeft(){return this.left}getOldLeft(){return this.oldLeft}getRight(){return this.left+this.actualWidth}setLeft(e,t){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchColEvent("leftChanged",t))}isFilterActive(){return this.filterActive}isHovered(){return de(261),!!this.beans.colHover?.isHovered(this)}setFirstRightPinned(e,t){this.firstRightPinned!==e&&(this.firstRightPinned=e,this.dispatchColEvent("firstRightPinnedChanged",t))}setLastLeftPinned(e,t){this.lastLeftPinned!==e&&(this.lastLeftPinned=e,this.dispatchColEvent("lastLeftPinnedChanged",t))}isFirstRightPinned(){return this.firstRightPinned}isLastLeftPinned(){return this.lastLeftPinned}isPinned(){return this.pinned==="left"||this.pinned==="right"}isPinnedLeft(){return this.pinned==="left"}isPinnedRight(){return this.pinned==="right"}getPinned(){return this.pinned}setVisible(e,t){const n=e===!0;this.visible!==n&&(this.visible=n,this.dispatchColEvent("visibleChanged",t)),this.dispatchStateUpdatedEvent("hide")}isVisible(){return this.visible}isSpanHeaderHeight(){return!this.getColDef().suppressSpanHeaderHeight}getColumnGroupPaddingInfo(){let e=this.getParent();if(!e||!e.isPadding())return{numberOfParents:0,isSpanningTotal:!1};const t=e.getPaddingLevel()+1;let n=!0;for(;e;){if(!e.isPadding()){n=!1;break}e=e.getParent()}return{numberOfParents:t,isSpanningTotal:n}}getColDef(){return this.colDef}getDefinition(){return this.colDef}getColumnGroupShow(){return this.colDef.columnGroupShow}getColId(){return this.colId}getId(){return this.colId}getUniqueId(){return this.colId}getActualWidth(){return this.actualWidth}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){const t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}createBaseColDefParams(e){return ze(this.gos,{node:e,data:e.data,colDef:this.colDef,column:this})}getColSpan(e){if(Xt(this.colDef.colSpan))return 1;const t=this.createBaseColDefParams(e),n=this.colDef.colSpan(t);return Math.max(n,1)}getRowSpan(e){if(Xt(this.colDef.rowSpan))return 1;const t=this.createBaseColDefParams(e),n=this.colDef.rowSpan(t);return Math.max(n,1)}setActualWidth(e,t,n=!1){e=Math.max(e,this.minWidth),e=Math.min(e,this.maxWidth),this.actualWidth!==e&&(this.actualWidth=e,this.flex!=null&&t!=="flex"&&t!=="gridInitializing"&&(this.flex=null),n||this.fireColumnWidthChangedEvent(t)),this.dispatchStateUpdatedEvent("width")}fireColumnWidthChangedEvent(e){this.dispatchColEvent("widthChanged",e)}isGreaterThanMax(e){return e>this.maxWidth}getMinWidth(){return this.minWidth}getMaxWidth(){return this.maxWidth}getFlex(){return this.flex}isRowGroupActive(){return this.rowGroupActive}isPivotActive(){return this.pivotActive}isAnyFunctionActive(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()}isAnyFunctionAllowed(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()}isValueActive(){return this.aggregationActive}isAllowPivot(){return this.colDef.enablePivot===!0}isAllowValue(){return this.colDef.enableValue===!0}isAllowRowGroup(){return this.colDef.enableRowGroup===!0}dispatchColEvent(e,t,n){const i=this.createColumnEvent(e,t);n&&lr(i,n),this.colEventSvc.dispatchEvent(i)}dispatchStateUpdatedEvent(e){this.colEventSvc.dispatchEvent({type:"columnStateUpdated",key:e})}};function Xi(e){return e instanceof mb}var mb=class extends Z{constructor(e,t,n,i){super(),this.colGroupDef=e,this.groupId=t,this.padding=n,this.level=i,this.isColumn=!1,this.expandable=!1,this.instanceId=Tee(),this.expandableListenerRemoveCallback=null,this.expanded=!!e?.openByDefault}destroy(){this.expandableListenerRemoveCallback&&this.reset(null,void 0),super.destroy()}reset(e,t){this.colGroupDef=e,this.level=t,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0}getInstanceId(){return this.instanceId}getOriginalParent(){return this.originalParent}getLevel(){return this.level}isVisible(){return this.children?this.children.some(e=>e.isVisible()):!1}isPadding(){return this.padding}setExpanded(e){this.expanded=e===void 0?!1:e,this.dispatchLocalEvent({type:"expandedChanged"})}isExpandable(){return this.expandable}isExpanded(){return this.expanded}getGroupId(){return this.groupId}getId(){return this.getGroupId()}setChildren(e){this.children=e}getChildren(){return this.children}getColGroupDef(){return this.colGroupDef}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}addLeafColumns(e){this.children&&this.children.forEach(t=>{pc(t)?e.push(t):Xi(t)&&t.addLeafColumns(e)})}getColumnGroupShow(){const e=this.colGroupDef;if(e)return e.columnGroupShow}setupExpandable(){this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();const e=this.onColumnVisibilityChanged.bind(this);this.getLeafColumns().forEach(t=>t.__addEventListener("visibleChanged",e)),this.expandableListenerRemoveCallback=()=>{this.getLeafColumns().forEach(t=>t.__removeEventListener("visibleChanged",e)),this.expandableListenerRemoveCallback=null}}setExpandable(){if(this.isPadding())return;let e=!1,t=!1,n=!1;const i=this.findChildrenRemovingPadding();for(let s=0,o=i.length;s<o;s++){const a=i[s];if(!a.isVisible())continue;const l=a.getColumnGroupShow();l==="open"?(e=!0,n=!0):l==="closed"?(t=!0,n=!0):(e=!0,t=!0)}const r=e&&t&&n;this.expandable!==r&&(this.expandable=r,this.dispatchLocalEvent({type:"expandableChanged"}))}findChildrenRemovingPadding(){const e=[],t=n=>{n.forEach(i=>{Xi(i)&&i.isPadding()?t(i.children):e.push(i)})};return t(this.children),e}onColumnVisibilityChanged(){this.setExpandable()}},y6e={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}},w6e=class{constructor(){this.existingKeys={}}addExistingKeys(e){for(let t=0;t<e.length;t++)this.existingKeys[e[t]]=!0}getUniqueKey(e,t){e=ZM(e);let n=0;for(;;){let i=e??t;if(i?n!==0&&(i+="_"+n):i=n,!this.existingKeys[i])return this.existingKeys[i]=!0,String(i);n++}}},vW=Object.freeze([]);function Lt(e){if(e?.length)return e[e.length-1]}function Nh(e,t,n){return e==null&&t==null?!0:e!=null&&t!=null&&e.length===t.length&&e.every((i,r)=>n?n(i,t[r]):t[r]===i)}function Dw(e,t){if(e)for(const n of e)t(n)}function _o(e,t){const n=e.indexOf(t);n>=0&&e.splice(n,1)}function CW(e,t,n){for(let i=0;i<t.length;i++)_o(e,t[i]);for(let i=t.length-1;i>=0;i--)e.splice(n,0,t[i])}var qR="ag-Grid-AutoColumn",Iee="ag-Grid-SelectionColumn",b6e="ag-Grid-RowNumbersColumn";function _ee(e){const t=[],n=i=>{for(let r=0;r<i.length;r++){const s=i[r];pc(s)?t.push(s):Xi(s)&&n(s.getChildren())}};return n(e),t}function fl(e){return e.reduce((t,n)=>t+n.getActualWidth(),0)}function d1(e,t,n){const i={};if(!t)return;Ll(null,t,s=>{i[s.getInstanceId()]=s}),n&&Ll(null,n,s=>{i[s.getInstanceId()]=null});const r=Object.values(i).filter(s=>s!=null);e.context.destroyBeans(r)}function gN(e){return e.getId().startsWith(qR)}function Ul(e){return(typeof e=="string"?e:"getColId"in e?e.getColId():e.colId)?.startsWith(Iee)??!1}function Gp(e){return(typeof e=="string"?e:"getColId"in e?e.getColId():e.colId)?.startsWith(b6e)??!1}function h1(e){let t=[];return e instanceof Array?t=e:typeof e=="string"&&(t=e.split(",")),t}function S6e(e,t){return Nh(e,t,(n,i)=>n.getColId()===i.getColId())}function x6e(e){e.map={},e.list.forEach(t=>e.map[t.getId()]=t)}function Yf(e){return e==="gridOptionsUpdated"?"gridOptionsChanged":e}function Oee(e,t){const n=e===t,i=e.getColDef()===t,r=e.getColId()==t;return n||i||r}var R6e=(e,t)=>(n,i)=>{const r={value1:void 0,value2:void 0};let s=!1;return e&&(e[n]!==void 0&&(r.value1=e[n],s=!0),Ce(i)&&e[i]!==void 0&&(r.value2=e[i],s=!0)),!s&&t&&(t[n]!==void 0&&(r.value1=t[n]),Ce(i)&&t[i]!==void 0&&(r.value2=t[i])),r};function E6e(e,t=null,n,i,r){const s=new w6e,{existingCols:o,existingGroups:a,existingColKeys:l}=F6e(i);s.addExistingKeys(l);const u=Lee(e,t,0,n,o,s,a,r),{colGroupSvc:c}=e,d=c?.findMaxDepth(u,0)??0,h=c?c.balanceColumnTree(u,0,d,s):u;return Ll(null,h,(g,m)=>{Xi(g)&&g.setupExpandable(),g.originalParent=m}),{columnTree:h,treeDept:d}}function F6e(e){const t=[],n=[],i=[];return e&&Ll(null,e,r=>{if(Xi(r)){const s=r;n.push(s)}else{const s=r;i.push(s.getId()),t.push(s)}}),{existingCols:t,existingGroups:n,existingColKeys:i}}function Lee(e,t,n,i,r,s,o,a){if(!t)return[];const{colGroupSvc:l}=e,u=new Array(t.length);for(let c=0;c<u.length;c++){const d=t[c];l&&T6e(d)?u[c]=l.createProvidedColumnGroup(i,d,n,r,s,o,a):u[c]=A6e(e,i,d,r,s,a)}return u}function A6e(e,t,n,i,r,s){const o=k6e(n,i);o&&i?.splice(o.idx,1);let a=o?.column;if(a){const l=sT(e,n,a.getColId());a.setColDef(l,n,s),D6e(e,a,l,s)}else{const l=r.getUniqueKey(n.colId,n.field),u=sT(e,n,l);a=new pN(u,n,l,t),e.context.createBean(a)}return e.dataTypeSvc?.addColumnListeners(a),a}function Nee(e,t,n,i,r,s,o,a){const{sortSvc:l,pinnedCols:u,colFlex:c}=e;n!==void 0&&t.setVisible(!n,a),l&&(l.updateColSort(t,i,a),r!==void 0&&l.setColSortIndex(t,r)),s!==void 0&&u?.setColPinned(t,s),o!==void 0&&c?.setColFlex(t,o)}function D6e(e,t,n,i){Nee(e,t,n.hide,n.sort,n.sortIndex,n.pinned,n.flex,i);const r=t.getFlex();if(!(r!=null&&r>0))if(n.width!=null)t.setActualWidth(n.width,i);else{const s=t.getActualWidth();t.setActualWidth(s,i)}}function k6e(e,t){if(t)for(let n=0;n<t.length;n++){const i=t[n].getUserProvidedColDef();if(!i)continue;if(e.colId!=null){if(t[n].getId()===e.colId)return{idx:n,column:t[n]};continue}if(e.field!=null){if(i.field===e.field)return{idx:n,column:t[n]};continue}if(i===e)return{idx:n,column:t[n]}}}function sT(e,t,n,i){const{gos:r,dataTypeSvc:s,validation:o}=e,a={},l=r.get("defaultColDef");lr(a,l,!1,!0);const u=P6e(e,a,t,n);u&&M6e(e,u,a),lr(a,t,!1,!0);const c=r.get("autoGroupColumnDef"),d=pa(r);return t.rowGroup&&c&&d&&lr(a,{sort:c.sort,initialSort:c.initialSort},!1,!0),s?.validateColDef(a),o?.validateColDef(a,n,i),a}function P6e(e,t,n,i){const r=e.dataTypeSvc?.updateColDefAndGetColumnType(t,n,i),s=n.type??r??t.type;return t.type=s,s?h1(s):void 0}function M6e(e,t,n){if(!t.length)return;const i=Object.assign({},y6e),r=e.gos.get("columnTypes")||{};for(const s of Object.keys(r)){const o=r[s];s in i?de(34,{key:s}):(o.type&&de(35),i[s]=o)}t.forEach(s=>{const o=i[s.trim()];o?lr(n,o,!1,!0):de(36,{t:s})})}function T6e(e){return e.children!==void 0}function Ll(e,t,n){if(t)for(let i=0;i<t.length;i++){const r=t[i];Xi(r)&&Ll(r,r.getChildren(),n),n(r,e)}}function $ee(e,t){const n=[],i=[],r=[];return e.forEach(o=>{const a=o.getColDef().lockPosition;a==="right"?r.push(o):a==="left"||a===!0?n.push(o):i.push(o)}),t.get("enableRtl")?[...r,...i,...n]:[...n,...i,...r]}function Bee(e,t){let n=!0;return Ll(null,t,i=>{if(!Xi(i))return;const r=i,s=r.getColGroupDef();if(!(s&&s.marryChildren))return;const a=[];r.getLeafColumns().forEach(h=>{const p=e.indexOf(h);a.push(p)});const l=Math.max.apply(Math,a),u=Math.min.apply(Math,a),c=l-u,d=r.getLeafColumns().length-1;c>d&&(n=!1)}),n}function Gee(e,t){if(!e||e.length==0)return;const n=t(e[0]);for(let i=1;i<e.length;i++)if(n!==t(e[i]))return;return n}function zee(e,t,n){if(!t.length)return;const i=t.length===1?t[0]:null,r=Gee(t,s=>s.getPinned());e.dispatchEvent({type:"columnPinned",pinned:r??null,columns:t,column:i,source:n})}function I6e(e,t,n){if(!t.length)return;const i=t.length===1?t[0]:null,r=Gee(t,s=>s.isVisible());e.dispatchEvent({type:"columnVisible",visible:r,columns:t,column:i,source:n})}function _6e(e,t,n,i){e.dispatchEvent({type:t,columns:n,column:n&&n.length==1?n[0]:null,source:i})}function zp(e,t,n,i,r=null){t?.length&&e.dispatchEvent({type:"columnResized",columns:t,column:t.length===1?t[0]:null,flexColumns:r,finished:n,source:i})}function os(e,t,n){const{colModel:i,rowGroupColsSvc:r,pivotColsSvc:s,autoColSvc:o,selectionColSvc:a,colAnimation:l,visibleCols:u,pivotResultCols:c,environment:d,valueColsSvc:h,eventSvc:p,gos:g}=e,m=i.getColDefCols()||[];if(!m?.length)return!1;if(t?.state&&!t.state.forEach)return de(32),!1;const C=(x,E,A,F,P)=>{if(!x)return;const D=R6e(E,t.defaultState),M=D("flex").value1;if(Nee(e,x,D("hide").value1,D("sort").value1,D("sortIndex").value1,D("pinned").value1,M,n),M==null){const O=D("width").value1;if(O!=null){const B=x.getColDef().minWidth??d.getDefaultColumnMinWidth();B!=null&&O>=B&&x.setActualWidth(O,n)}}P||!x.isPrimary()||(h?.syncColumnWithState(x,n,D),r?.syncColumnWithState(x,n,D,A),s?.syncColumnWithState(x,n,D,F))},y=(x,E,A)=>{const F=Hee(e,n),P=E.slice(),D={},M={},O=[],B=[],H=[];let N=0;const L=r?.columns.slice()??[],G=s?.columns.slice()??[];x.forEach(U=>{const ie=U.colId;if(ie.startsWith(qR)){O.push(U),H.push(U);return}if(Ul(ie)){B.push(U),H.push(U);return}const K=A(ie);K?(C(K,U,D,M,!1),_o(P,K)):(H.push(U),N+=1)});const q=U=>C(U,null,D,M,!1);P.forEach(q),r?.sortColumns(yW.bind(r,D,L)),s?.sortColumns(yW.bind(s,M,G)),i.refreshCols(!1);const V=(U,ie,pe=[])=>{ie.forEach(K=>{const Fe=U(K.colId);_o(pe,Fe),C(Fe,K,null,null,!0)}),pe.forEach(q)};return V(U=>o?.getColumn(U)??null,O,o?.getColumns()?.slice()),V(U=>a?.getColumn(U)??null,B,a?.getColumns()?.slice()),L6e(t,i,g),u.refresh(n),p.dispatchEvent({type:"columnEverythingChanged",source:n}),F(),{unmatchedAndAutoStates:H,unmatchedCount:N}};l?.start();let{unmatchedAndAutoStates:b,unmatchedCount:S}=y(t.state||[],m,x=>i.getColDefCol(x));if(b.length>0||Ce(t.defaultState)){const x=c?.getPivotResultCols()?.list??[];S=y(b,x,E=>c?.getPivotResultCol(E)??null).unmatchedCount}return l?.finish(),S===0}function O6e(e,t){const{colModel:n,autoColSvc:i,selectionColSvc:r}=e,s=n.getColDefCols();if(!s?.length)return;const o=n.getColDefColTree(),a=_ee(o),l=[];let u=1e3,c=1e3;const d=C=>{const y=Vee(C);Xt(y.rowGroupIndex)&&y.rowGroup&&(y.rowGroupIndex=u++),Xt(y.pivotIndex)&&y.pivot&&(y.pivotIndex=c++),l.push(y)};i?.getColumns()?.forEach(d),r?.getColumns()?.forEach(d),a?.forEach(d),os(e,{state:l},t);const h=i?.getColumns()??[],m=[...r?.getColumns()??[],...h,...s].map(C=>({colId:C.colId}));os(e,{state:m,applyOrder:!0},t)}function Hee(e,t){const{rowGroupColsSvc:n,pivotColsSvc:i,valueColsSvc:r,colModel:s,sortSvc:o,eventSvc:a}=e,l={rowGroupColumns:n?.columns.slice()??[],pivotColumns:i?.columns.slice()??[],valueColumns:r?.columns.slice()??[]},u=E0(e),c={};return u.forEach(d=>{c[d.colId]=d}),()=>{const d=(A,F,P,D)=>{const M=F.map(D),O=P.map(D);if(Nh(M,O))return;const H=new Set(F);P.forEach(L=>{H.delete(L)||H.add(L)});const N=[...H];a.dispatchEvent({type:A,columns:N,column:N.length===1?N[0]:null,source:t})},h=A=>{const F=[];return s.forAllCols(P=>{const D=c[P.getColId()];D&&A(D,P)&&F.push(P)}),F},p=A=>A.getColId();d("columnRowGroupChanged",l.rowGroupColumns,n?.columns??[],p),d("columnPivotChanged",l.pivotColumns,i?.columns??[],p);const m=h((A,F)=>{const P=A.aggFunc!=null,D=P!=F.isValueActive(),M=P&&A.aggFunc!=F.getAggFunc();return D||M});m.length>0&&_6e(a,"columnValueChanged",m,t),zp(a,h((A,F)=>A.width!=F.getActualWidth()),!0,t),zee(a,h((A,F)=>A.pinned!=F.getPinned()),t),I6e(a,h((A,F)=>A.hide==F.isVisible()),t);const x=h((A,F)=>A.sort!=F.getSort()||A.sortIndex!=F.getSortIndex());x.length>0&&o?.dispatchSortChangedEvents(t,x);const E=E0(e);$6e(u,E,t,s,a)}}function E0(e){const{colModel:t,rowGroupColsSvc:n,pivotColsSvc:i}=e,r=t.getColDefCols();if(Xt(r)||!t.isAlive())return[];const s=n?.columns,o=i?.columns,a=[],l=c=>{const d=c.isRowGroupActive()&&s?s.indexOf(c):null,h=c.isPivotActive()&&o?o.indexOf(c):null,p=c.isValueActive()?c.getAggFunc():null,g=c.getSort()!=null?c.getSort():null,m=c.getSortIndex()!=null?c.getSortIndex():null;a.push({colId:c.getColId(),width:c.getActualWidth(),hide:!c.isVisible(),pinned:c.getPinned(),sort:g,sortIndex:m,aggFunc:p,rowGroup:c.isRowGroupActive(),rowGroupIndex:d,pivot:c.isPivotActive(),pivotIndex:h,flex:c.getFlex()??null})};t.forAllCols(c=>l(c));const u=new Map(t.getCols().map((c,d)=>[c.getColId(),d]));return a.sort((c,d)=>{const h=u.has(c.colId)?u.get(c.colId):-1,p=u.has(d.colId)?u.get(d.colId):-1;return h-p}),a}function Vee(e){const t=(g,m)=>g??m??null,n=e.getColDef(),i=t(n.sort,n.initialSort),r=t(n.sortIndex,n.initialSortIndex),s=t(n.hide,n.initialHide),o=t(n.pinned,n.initialPinned),a=t(n.width,n.initialWidth),l=t(n.flex,n.initialFlex);let u=t(n.rowGroupIndex,n.initialRowGroupIndex),c=t(n.rowGroup,n.initialRowGroup);u==null&&(c==null||c==!1)&&(u=null,c=null);let d=t(n.pivotIndex,n.initialPivotIndex),h=t(n.pivot,n.initialPivot);d==null&&(h==null||h==!1)&&(d=null,h=null);const p=t(n.aggFunc,n.initialAggFunc);return{colId:e.getColId(),sort:i,sortIndex:r,hide:s,pinned:o,width:a,flex:l,rowGroup:c,rowGroupIndex:u,pivot:h,pivotIndex:d,aggFunc:p}}function L6e(e,t,n){if(!e.applyOrder||!e.state)return;const i=[];e.state.forEach(r=>{r.colId!=null&&i.push(r.colId)}),N6e(t.cols,i,t,n)}function N6e(e,t,n,i){if(e==null)return;let r=[];const s={};t.forEach(a=>{if(s[a])return;const l=e.map[a];l&&(r.push(l),s[a]=!0)});let o=0;if(e.list.forEach(a=>{const l=a.getColId();if(s[l]!=null)return;l.startsWith(qR)?r.splice(o++,0,a):r.push(a)}),r=$ee(r,i),!Bee(r,n.getColTree())){de(39);return}e.list=r}function $6e(e,t,n,i,r){const s={};t.forEach(c=>s[c.colId]=c);const o={};e.forEach(c=>{s[c.colId]&&(o[c.colId]=!0)});const a=e.filter(c=>o[c.colId]),l=t.filter(c=>o[c.colId]),u=[];l.forEach((c,d)=>{const h=a&&a[d];if(h&&h.colId!==c.colId){const p=i.getCol(h.colId);p&&u.push(p)}}),u.length&&r.dispatchEvent({type:"columnMoved",columns:u,column:u.length===1?u[0]:null,finished:!0,source:n})}var yW=(e,t,n,i)=>{const r=e[n.getId()],s=e[i.getId()],o=r!=null,a=s!=null;if(o&&a)return r-s;if(o)return-1;if(a)return 1;const l=t.indexOf(n),u=t.indexOf(i),c=l>=0,d=u>=0;return c&&d?l-u:c?-1:1},B6e=class extends Z{constructor(){super(...arguments),this.beanName="colModel",this.pivotMode=!1,this.ready=!1,this.changeEventsDispatching=!1}postConstruct(){this.pivotMode=this.gos.get("pivotMode"),this.addManagedPropertyListeners(["groupDisplayType","treeData","treeDataDisplayType","groupHideOpenParents"],e=>this.refreshAll(Yf(e.source))),this.addManagedPropertyListeners(["defaultColDef","defaultColGroupDef","columnTypes","suppressFieldDotNotation"],this.recreateColumnDefs.bind(this)),this.addManagedPropertyListener("pivotMode",e=>this.setPivotMode(this.gos.get("pivotMode"),Yf(e.source)))}createColsFromColDefs(e){const{beans:t}=this,{valueCache:n,colAutosize:i,rowGroupColsSvc:r,pivotColsSvc:s,valueColsSvc:o,visibleCols:a,colViewport:l,eventSvc:u}=t,c=this.colDefs?Hee(t,e):void 0;n?.expire();const d=this.colDefCols?.list,h=this.colDefCols?.tree,p=E6e(t,this.colDefs,!0,h,e);d1(t,this.colDefCols?.tree,p.columnTree);const g=p.columnTree,m=p.treeDept,C=_ee(g),y={};C.forEach(b=>y[b.getId()]=b),this.colDefCols={tree:g,treeDepth:m,list:C,map:y},r?.extractCols(e,d),s?.extractCols(e,d),o?.extractCols(e,d),this.ready=!0,this.refreshCols(!0),a.refresh(e),l.checkViewportColumns(),u.dispatchEvent({type:"columnEverythingChanged",source:e}),c&&(this.changeEventsDispatching=!0,c(),this.changeEventsDispatching=!1),u.dispatchEvent({type:"newColumnsLoaded",source:e}),e==="gridInitializing"&&i?.applyAutosizeStrategy()}refreshCols(e){if(!this.colDefCols)return;const t=this.cols?.tree;this.saveColOrder();const{autoColSvc:n,selectionColSvc:i,rowNumbersSvc:r,quickFilter:s,pivotResultCols:o,showRowGroupCols:a,rowAutoHeight:l,visibleCols:u,colViewport:c,eventSvc:d}=this.beans,h=this.selectCols(o,this.colDefCols);this.createColumnsForService([n,i,r],h);const p=U5e(this.gos,this.showingPivotResult);(!e||p)&&this.restoreColOrder(h),this.positionLockedCols(h),a?.refresh(),s?.refreshCols(),this.setColSpanActive(),l?.setAutoHeightActive(h),u.clear(),c.clear(),!Nh(t,this.cols.tree)&&d.dispatchEvent({type:"gridColumnsChanged"})}createColumnsForService(e,t){for(const n of e)n&&(n.createColumns(t,i=>{this.lastOrder=i(this.lastOrder),this.lastPivotOrder=i(this.lastPivotOrder)}),n.addColumns(t))}selectCols(e,t){const n=e?.getPivotResultCols()??null;this.showingPivotResult=n!=null;const{map:i,list:r,tree:s,treeDepth:o}=n??t;return this.cols={list:r.slice(),map:{...i},tree:s.slice(),treeDepth:o},n&&(n.list.some(l=>this.cols?.map[l.getColId()]!==void 0)||(this.lastPivotOrder=null)),this.cols}getColsToShow(){if(!this.cols)return[];const e=this.isPivotMode()&&!this.showingPivotResult,t=this.beans.valueColsSvc?.columns;return this.cols.list.filter(i=>{const r=gN(i);if(e){const s=t?.includes(i);return r||s}else return r||i.isVisible()})}refreshAll(e){this.ready&&(this.refreshCols(!1),this.beans.visibleCols.refresh(e))}setColsVisible(e,t=!1,n){os(this.beans,{state:e.map(i=>({colId:typeof i=="string"?i:i.getColId(),hide:!t}))},n)}restoreColOrder(e){const t=this.showingPivotResult?this.lastPivotOrder:this.lastOrder;if(!t)return;const n=new Map(t.map((u,c)=>[u,c]));if(!e.list.some(u=>n.has(u)))return;const r=new Map(e.list.map(u=>[u,!0])),s=t.filter(u=>r.has(u)),o=new Map(s.map(u=>[u,!0])),a=e.list.filter(u=>!o.has(u)),l=s.slice();a.forEach(u=>{let c=u.getOriginalParent();if(!c){l.push(u);return}const d=[];for(;!d.length&&c;)c.getLeafColumns().forEach(m=>{const C=l.indexOf(m)>=0,y=d.indexOf(m)<0;C&&y&&d.push(m)}),c=c.getOriginalParent();if(!d.length){l.push(u);return}const h=d.map(g=>l.indexOf(g)),p=Math.max(...h);l.splice(p+1,0,u)}),e.list=l}positionLockedCols(e){e.list=$ee(e.list,this.gos)}saveColOrder(){this.showingPivotResult?this.lastPivotOrder=this.cols?.list??null:this.lastOrder=this.cols?.list??null}getColumnDefs(){return this.colDefCols?this.beans.colDefFactory?.getColumnDefs(this.colDefCols.list,this.showingPivotResult,this.lastOrder,this.cols?.list??[]):void 0}setColSpanActive(){this.colSpanActive=!!this.cols?.list.some(e=>e.getColDef().colSpan!=null)}isPivotMode(){return this.pivotMode}setPivotMode(e,t){if(e===this.pivotMode||(this.pivotMode=e,!this.ready))return;this.refreshCols(!1);const{visibleCols:n,eventSvc:i}=this.beans;n.refresh(t),i.dispatchEvent({type:"columnPivotModeChanged"})}isPivotActive(){const e=this.beans.pivotColsSvc?.columns;return this.pivotMode&&!!e?.length}recreateColumnDefs(e){if(!this.cols)return;this.beans.autoColSvc?.updateColumns(e);const t=Yf(e.source);this.createColsFromColDefs(t)}setColumnDefs(e,t){this.colDefs=e,this.createColsFromColDefs(t)}destroy(){d1(this.beans,this.colDefCols?.tree),super.destroy()}getColTree(){return this.cols?.tree??[]}getColDefColTree(){return this.colDefCols?.tree??[]}getColDefCols(){return this.colDefCols?.list??null}getCols(){return this.cols?.list??[]}forAllCols(e){const{pivotResultCols:t,autoColSvc:n,selectionColSvc:i}=this.beans;Dw(this.colDefCols?.list,e),Dw(n?.columns?.list,e),Dw(i?.columns?.list,e),Dw(t?.getPivotResultCols()?.list,e)}getColsForKeys(e){return e?e.map(t=>this.getCol(t)).filter(t=>t!=null):[]}getColDefCol(e){return this.colDefCols?.list?this.getColFromCollection(e,this.colDefCols):null}getCol(e){return e==null?null:this.getColFromCollection(e,this.cols)}getColFromCollection(e,t){if(t==null)return null;const{map:n,list:i}=t;if(typeof e=="string"&&n[e])return n[e];for(let r=0;r<i.length;r++)if(Oee(i[r],e))return i[r];return this.beans.autoColSvc?.getColumn(e)??this.beans.selectionColSvc?.getColumn(e)??null}},Wee=class{constructor(){this.existingIds={}}getInstanceIdForKey(e){const t=this.existingIds[e];let n;return typeof t!="number"?n=0:n=t+1,this.existingIds[e]=n,n}};function OC(e,t,n){return n&&e.addDestroyFunc(()=>t.destroyBean(n)),n??e}var Uee=class{constructor(e){this.cssClassStates={},this.getGui=e}addCssClass(e){this.addOrRemoveCssClass(e,!0)}removeCssClass(e){this.addOrRemoveCssClass(e,!1)}containsCssClass(e){const t=this.getGui();return t?t.classList.contains(e):!1}addOrRemoveCssClass(e,t){if(!e)return;if(e.indexOf(" ")>=0){const i=(e||"").split(" ");if(i.length>1){i.forEach(r=>this.addOrRemoveCssClass(r,t));return}}if(this.cssClassStates[e]!==t&&e.length){const i=this.getGui();i&&i.classList.toggle(e,t),this.cssClassStates[e]=t}}},G6e=0,ve=null,At=class extends Z{constructor(e,t){super(),this.suppressDataRefValidation=!1,this.displayed=!0,this.visible=!0,this.compId=G6e++,this.cssClassManager=new Uee(()=>this.eGui),this.componentSelectors=new Map((t??[]).map(n=>[n.selector,n])),e&&this.setTemplate(e)}preConstruct(){this.wireTemplate(this.getGui());const e="component-"+Object.getPrototypeOf(this)?.constructor?.name;this.css?.forEach(t=>this.beans.environment.addGlobalCSS(t,e))}wireTemplate(e,t){e&&this.gos&&(this.applyElementsToComponent(e),this.createChildComponentsFromTags(e,t))}getCompId(){return this.compId}getDataRefAttribute(e){return e.getAttribute?e.getAttribute(hee):null}applyElementsToComponent(e,t,n,i=null){if(t===void 0&&(t=this.getDataRefAttribute(e)),t){const r=this[t];if(r===ve)this[t]=i??e;else{const s=n&&n[t];if(!this.suppressDataRefValidation&&!s)throw new Error(`data-ref: ${t} on ${this.constructor.name} with ${r}`)}}}createChildComponentsFromTags(e,t){const n=[];for(const i of e.childNodes??[])n.push(i);n.forEach(i=>{if(!(i instanceof HTMLElement))return;const r=this.createComponentFromElement(i,s=>{const o=s.getGui();if(o)for(const a of i.attributes??[])o.setAttribute(a.name,a.value)},t);if(r){if(r.addItems&&i.children.length){this.createChildComponentsFromTags(i,t);const s=Array.prototype.slice.call(i.children);r.addItems(s)}this.swapComponentForNode(r,e,i)}else i.childNodes&&this.createChildComponentsFromTags(i,t)})}createComponentFromElement(e,t,n){const i=e.nodeName,r=this.getDataRefAttribute(e),s=i.indexOf("AG-")===0,o=s?this.componentSelectors.get(i):null;let a=null;if(o){const l=n&&r?n[r]:void 0;a=new o.component(l),a.setParentComponent(this),this.createBean(a,null,t)}else if(s)throw new Error(`selector: ${i}`);return this.applyElementsToComponent(e,r,n,a),a}swapComponentForNode(e,t,n){const i=e.getGui();t.replaceChild(i,n),t.insertBefore(document.createComment(n.nodeName),i),this.addDestroyFunc(this.destroyBean.bind(this,e))}activateTabIndex(e){const t=this.gos.get("tabIndex");e||(e=[]),e.length||e.push(this.getGui()),e.forEach(n=>n.setAttribute("tabindex",t.toString()))}setTemplate(e,t,n){let i;typeof e=="string"||e==null?i=UR(e):i=Sn(e),this.setTemplateFromElement(i,t,n)}setTemplateFromElement(e,t,n,i=!1){if(this.eGui=e,this.suppressDataRefValidation=i,t)for(let r=0;r<t.length;r++){const s=t[r];this.componentSelectors.set(s.selector,s)}this.wireTemplate(e,n)}getGui(){return this.eGui}getFocusableElement(){return this.eGui}getAriaElement(){return this.getFocusableElement()}setParentComponent(e){this.parentComponent=e}getParentComponent(){return this.parentComponent}setGui(e){this.eGui=e}queryForHtmlElement(e){return this.eGui.querySelector(e)}getContainerAndElement(e,t){let n=t;return e==null?null:(n||(n=this.eGui),uN(e)?{element:e,parent:n}:{element:e.getGui(),parent:n})}prependChild(e,t){const{element:n,parent:i}=this.getContainerAndElement(e,t)||{};!n||!i||i.insertAdjacentElement("afterbegin",n)}appendChild(e,t){const{element:n,parent:i}=this.getContainerAndElement(e,t)||{};!n||!i||i.appendChild(n)}isDisplayed(){return this.displayed}setVisible(e,t={}){if(e!==this.visible){this.visible=e;const{skipAriaHidden:n}=t;P5e(this.eGui,e,{skipAriaHidden:n})}}setDisplayed(e,t={}){if(e!==this.displayed){this.displayed=e;const{skipAriaHidden:n}=t;tn(this.eGui,e,{skipAriaHidden:n});const i={type:"displayChanged",visible:this.displayed};this.dispatchLocalEvent(i)}}destroy(){this.parentComponent&&(this.parentComponent=void 0),super.destroy()}addGuiEventListener(e,t,n){this.eGui.addEventListener(e,t,n),this.addDestroyFunc(()=>this.eGui.removeEventListener(e,t))}addCssClass(e){this.cssClassManager.addCssClass(e)}removeCssClass(e){this.cssClassManager.removeCssClass(e)}containsCssClass(e){return this.cssClassManager.containsCssClass(e)}addOrRemoveCssClass(e,t){this.cssClassManager.addOrRemoveCssClass(e,t)}registerCSS(e){this.css||(this.css=[]),this.css.push(e)}},ir=class lv{constructor(t){this.status=0,this.resolution=null,this.waiters=[],t(n=>this.onDone(n),n=>this.onReject(n))}static all(t){return t.length?new lv(n=>{let i=t.length;const r=new Array(i);t.forEach((s,o)=>{s.then(a=>{r[o]=a,i--,i===0&&n(r)})})}):lv.resolve()}static resolve(t=null){return new lv(n=>n(t))}then(t){return new lv(n=>{this.status===1?n(t(this.resolution)):this.waiters.push(i=>n(t(i)))})}onDone(t){this.status=1,this.resolution=t,this.waiters.forEach(n=>n(t))}onReject(t){}};function z6e(e){return e?e.prototype&&"getGui"in e.prototype:!1}function qee(e,t,n,i){const{name:r}=n;let s,o,a,l,u,c;if(t){const d=t,h=d[r+"Selector"],p=h?h(i):null,g=m=>{typeof m=="string"?s=m:m!=null&&m!==!0&&(e.isFrameworkComponent(m)?a=m:o=m)};p?(g(p.component),l=p.params,u=p.popup,c=p.popupPosition):g(d[r])}return{compName:s,jsComp:o,fwComp:a,paramsFromSelector:l,popupFromSelector:u,popupPositionFromSelector:c}}var H6e=class extends Z{constructor(){super(...arguments),this.beanName="userCompFactory"}wireBeans(e){this.agCompUtils=e.agCompUtils,this.registry=e.registry,this.frameworkCompWrapper=e.frameworkCompWrapper,this.gridOptions=e.gridOptions}getCompDetailsFromGridOptions(e,t,n,i=!1){return this.getCompDetails(this.gridOptions,e,t,n,i)}getCompDetails(e,t,n,i,r=!1){const{name:s,cellRenderer:o}=t;let{compName:a,jsComp:l,fwComp:u,paramsFromSelector:c,popupFromSelector:d,popupPositionFromSelector:h}=qee(this.beans.frameworkOverrides,e,t,i),p;const g=b=>{const S=this.registry.getUserComponent(s,b);S&&(l=S.componentFromFramework?void 0:S.component,u=S.componentFromFramework?S.component:void 0,p=S.params)};if(a!=null&&g(a),l==null&&u==null&&n!=null&&g(n),l&&o&&!z6e(l)&&(l=this.agCompUtils?.adaptFunction(t,l)),!l&&!u){const{validation:b}=this.beans;r&&(a!==n||!n)?a?b?.isProvidedUserComp(a)||Ft(50,{compName:a}):n?b||Ft(260,{...this.gos.getModuleErrorParams(),propName:s,compName:n}):Ft(216,{name:s}):n&&!b&&Ft(146,{comp:n});return}const m=this.mergeParams(e,t,i,c,p),C=l==null,y=l??u;return{componentFromFramework:C,componentClass:y,params:m,type:t,popupFromSelector:d,popupPositionFromSelector:h,newAgStackInstance:()=>this.newAgStackInstance(y,C,m,t)}}newAgStackInstance(e,t,n,i){const r=!t;let s;r?s=new e:s=this.frameworkCompWrapper.wrap(e,i.mandatoryMethods,i.optionalMethods,i),this.createBean(s);const o=s.init?.(n);return o==null?ir.resolve(s):o.then(()=>s)}mergeParams(e,t,n,i=null,r){const s={...n,...r},o=e,a=o&&o[t.name+"Params"];if(typeof a=="function"){const l=a(n);lr(s,l)}else typeof a=="object"&&lr(s,a);return lr(s,i),s}},V6e={name:"dateComponent",mandatoryMethods:["getDate","setDate"],optionalMethods:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled","refresh"]},W6e={name:"dragAndDropImageComponent",mandatoryMethods:["setIcon","setLabel"]},U6e={name:"headerComponent",optionalMethods:["refresh"]},q6e={name:"innerHeaderComponent"},j6e={name:"innerHeaderGroupComponent"},K6e={name:"headerGroupComponent"},Y6e={name:"cellRenderer",optionalMethods:["refresh","afterGuiAttached"],cellRenderer:!0},X6e={name:"loadingCellRenderer",cellRenderer:!0},Q6e={name:"cellEditor",mandatoryMethods:["getValue"],optionalMethods:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached","refresh"]},Z6e={name:"loadingOverlayComponent",optionalMethods:["refresh"]},J6e={name:"noRowsOverlayComponent",optionalMethods:["refresh"]},eWe={name:"tooltipComponent"},mN={name:"filter",mandatoryMethods:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethods:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged","refresh"]},tWe={name:"floatingFilterComponent",mandatoryMethods:["onParentModelChanged"],optionalMethods:["afterGuiAttached","refresh"]},nWe={name:"fullWidthCellRenderer",optionalMethods:["refresh","afterGuiAttached"],cellRenderer:!0},iWe={name:"loadingCellRenderer",cellRenderer:!0},rWe={name:"groupRowRenderer",optionalMethods:["afterGuiAttached"],cellRenderer:!0},sWe={name:"detailCellRenderer",optionalMethods:["refresh"],cellRenderer:!0};function oWe(e,t){return e.getCompDetailsFromGridOptions(W6e,"agDragAndDropImage",t,!0)}function aWe(e,t,n){return e.getCompDetails(t,U6e,"agColumnHeader",n)}function lWe(e,t,n){return e.getCompDetails(t,q6e,void 0,n)}function uWe(e,t){const n=t.columnGroup.getColGroupDef();return e.getCompDetails(n,K6e,"agColumnGroupHeader",t)}function cWe(e,t,n){return e.getCompDetails(t,j6e,void 0,n)}function dWe(e,t){return e.getCompDetailsFromGridOptions(nWe,void 0,t,!0)}function hWe(e,t){return e.getCompDetailsFromGridOptions(iWe,"agLoadingCellRenderer",t,!0)}function fWe(e,t){return e.getCompDetailsFromGridOptions(rWe,"agGroupRowRenderer",t,!0)}function pWe(e,t){return e.getCompDetailsFromGridOptions(sWe,"agDetailCellRenderer",t,!0)}function wW(e,t,n){return e.getCompDetails(t,Y6e,void 0,n)}function gWe(e,t,n){return e.getCompDetails(t,X6e,"agSkeletonCellRenderer",n,!0)}function bW(e,t,n){return e.getCompDetails(t,Q6e,"agCellEditor",n,!0)}function mWe(e,t,n,i){return e.getCompDetails(t,mN,i,n,!0)}function vWe(e,t,n){return e.getCompDetails(t,V6e,"agDateInput",n,!0)}function CWe(e,t){return e.getCompDetailsFromGridOptions(Z6e,"agLoadingOverlay",t,!0)}function yWe(e,t){return e.getCompDetailsFromGridOptions(J6e,"agNoRowsOverlay",t,!0)}function wWe(e,t){return e.getCompDetails(t.colDef,eWe,"agTooltipComponent",t,!0)}function bWe(e,t,n,i){return e.getCompDetails(t,tWe,i,n)}function SWe(e,t){return qee(e,t,mN)}function xWe(e,t,n){return e.mergeParams(t,mN,n)}function F0(e){const t=e;return t!=null&&t.getFrameworkComponentInstance!=null?t.getFrameworkComponentInstance():e}var jee=new Set,f1={},Xf={},vb,Kee=!1,RWe=!1;function EWe(e){const[t,n]=e.version.split(".")||[],[i,r]=vb.split(".")||[];return t===i&&n===r}function FWe(e){vb||(vb=e.version);const t=n=>`You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. ${n} Please update all modules to the same version.`;if(e.version?EWe(e)||qf(t(`'${e.moduleName}' is version ${e.version} but the other modules are version ${vb}.`)):qf(t(`'${e.moduleName}' is incompatible.`)),e.validate){const n=e.validate();n.isValid||qf(`${n.message}`)}}function A0(e,t){FWe(e);const n=e.rowModels??["all"];jee.add(e);let i;t!==void 0?(Kee=!0,Xf[t]===void 0&&(Xf[t]={}),i=Xf[t]):i=f1,n.forEach(r=>{i[r]===void 0&&(i[r]={}),i[r][e.moduleName]=e}),e.dependsOn&&e.dependsOn.forEach(r=>A0(r,t))}function AWe(e){delete Xf[e]}function Yee(e,t,n){const i=r=>!!f1[r]?.[e]||!!Xf[t]?.[r]?.[e];return i(n)||i("all")}function vN(){return Kee}function DWe(e,t){const n=Xf[e]??{};return[...Object.values(f1.all??{}),...Object.values(n.all??{}),...Object.values(f1[t]??{}),...Object.values(n[t]??{})]}function kWe(){return new Set(jee)}function PWe(){return RWe}var Xee=class{static register(e){A0(e,void 0)}static registerModules(e){e.forEach(t=>A0(t,void 0))}},MWe=class{constructor(e){this.beans={},this.createdBeans=[],this.destroyed=!1,!(!e||!e.beanClasses)&&(this.beanDestroyComparator=e.beanDestroyComparator,this.init(e))}init(e){for(const t of Object.keys(e.providedBeanInstances))this.beans[t]=e.providedBeanInstances[t];e.beanClasses.forEach(t=>{const n=new t;n.beanName?this.beans[n.beanName]=n:console.error(`Bean ${t.name} is missing beanName`),this.createdBeans.push(n)}),e.derivedBeans?.forEach(t=>{const{beanName:n,bean:i}=t(this);this.beans[n]=i,this.createdBeans.push(i)}),e.beanInitComparator&&this.createdBeans.sort(e.beanInitComparator),this.initBeans(this.createdBeans)}getBeanInstances(){return Object.values(this.beans)}createBean(e,t){if(!e)throw Error("null bean");return this.initBeans([e],t),e}initBeans(e,t){e.forEach(n=>{n.preWireBeans?.(this.beans),n.wireBeans?.(this.beans)}),e.forEach(n=>n.preConstruct?.()),t&&e.forEach(t),e.forEach(n=>n.postConstruct?.())}getBeans(){return this.beans}getBean(e){return this.beans[e]}destroy(){if(this.destroyed)return;this.destroyed=!0;const e=this.getBeanInstances();this.beanDestroyComparator&&e.sort(this.beanDestroyComparator),this.destroyBeans(e),this.beans={},this.createdBeans=[]}destroyBean(e){e?.destroy?.()}destroyBeans(e){if(e)for(let t=0;t<e.length;t++)this.destroyBean(e[t]);return[]}isDestroyed(){return this.destroyed}},TWe=class extends MWe{init(e){this.gridId=e.gridId,this.beans.context=this,this.destroyCallback=e.destroyCallback,super.init(e)}destroy(){super.destroy(),AWe(this.gridId),this.destroyCallback?.()}getGridId(){return this.gridId}},IWe="ag-column-first",_We="ag-column-last";function Qee(e,t,n,i){return Xt(e)?[]:LWe(e.headerClass,e,t,n,i)}function Zee(e,t,n){e.addOrRemoveCssClass(IWe,n.isColAtEdge(t,"first")),e.addOrRemoveCssClass(_We,n.isColAtEdge(t,"last"))}function OWe(e,t,n,i){return ze(t,{colDef:e,column:n,columnGroup:i})}function LWe(e,t,n,i,r){if(Xt(e))return[];let s;if(typeof e=="function"){const o=OWe(t,n,i,r);s=e(o)}else s=e;return typeof s=="string"?[s]:Array.isArray(s)?[...s]:[]}var X={BACKSPACE:"Backspace",TAB:"Tab",ENTER:"Enter",ESCAPE:"Escape",SPACE:" ",LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown",DELETE:"Delete",F2:"F2",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",PAGE_HOME:"Home",PAGE_END:"End",A:"KeyA",C:"KeyC",D:"KeyD",V:"KeyV",X:"KeyX",Y:"KeyY",Z:"KeyZ"},oT=!1,p1=0;function NWe(e){p1>0||(e.addEventListener("keydown",g1),e.addEventListener("mousedown",g1))}function $We(e){p1>0||(e.removeEventListener("keydown",g1),e.removeEventListener("mousedown",g1))}function g1(e){const t=oT,n=e.type==="keydown";n&&(e.ctrlKey||e.metaKey||e.altKey)||t!==n&&(oT=n)}function BWe(e){const t=Pn(e);return NWe(t),p1++,()=>{p1--,$We(t)}}function GWe(){return oT}function zWe(e,t,n){t.addManagedElementListeners(n,{keydown:i=>{if(!i.defaultPrevented&&i.key===X.TAB){const r=i.shiftKey;$h(e,n,!1,r)||Hp(e,r)&&i.preventDefault()}}})}function Qf(e,t,n=!1){const i=k5e;let r=oee;t&&(r+=", "+t),n&&(r+=', [tabindex="-1"]');const s=Array.prototype.slice.apply(e.querySelectorAll(i)).filter(l=>Io(l)),o=Array.prototype.slice.apply(e.querySelectorAll(r));return o.length?((l,u)=>l.filter(c=>u.indexOf(c)===-1))(s,o):s}function ph(e,t=!1,n=!1,i=!1){const r=Qf(e,i?".ag-tab-guard":null,n),s=t?Lt(r):r[0];return s?(s.focus({preventScroll:!0}),!0):!1}function $h(e,t,n,i){const r=Qf(t,n?':not([tabindex="-1"])':null),s=nn(e);let o;n?o=r.findIndex(l=>l.contains(s)):o=r.indexOf(s);const a=o+(i?-1:1);return a<0||a>=r.length?null:r[a]}function Jee(e,t=5){let n=0;for(;e&&QM(e)===null&&++n<=t;)e=e.parentElement;return QM(e)===null?null:e}function HWe(e,t){return e.ctrlsSvc.get("gridCtrl").focusInnerElement(t)}function Hd(e){return e.gos.get("suppressHeaderFocus")||!!e.overlays?.isExclusive()}function jR(e){return e.gos.get("suppressCellFocus")||!!e.overlays?.isExclusive()}function Hp(e,t,n=!1){const i=e.ctrlsSvc.get("gridCtrl");return!n&&i.focusNextInnerContainer(t)?!0:((n||!t&&!i.isDetailGrid())&&i.forceFocusOutOfContainer(t),!1)}function VWe(e,t=!1){return e===X.DELETE?!0:!t&&e===X.BACKSPACE?iee():!1}var WWe=class extends Z{constructor(e,t,n,i){super(),this.cellCtrl=e,this.rowNode=n,this.rowCtrl=i,this.beans=t}init(){this.eGui=this.cellCtrl.eGui}onKeyDown(e){const t=e.key;switch(t){case X.ENTER:this.onEnterKeyDown(e);break;case X.F2:this.onF2KeyDown(e);break;case X.ESCAPE:this.onEscapeKeyDown(e);break;case X.TAB:this.onTabKeyDown(e);break;case X.BACKSPACE:case X.DELETE:this.onBackspaceOrDeleteKeyDown(t,e);break;case X.DOWN:case X.UP:case X.RIGHT:case X.LEFT:this.onNavigationKeyDown(e,t);break}}onNavigationKeyDown(e,t){if(!this.cellCtrl.editing){if(e.shiftKey&&this.cellCtrl.isRangeSelectionEnabled())this.onShiftRangeSelect(e);else{const n=this.cellCtrl.getFocusedCellPosition();this.beans.navigation?.navigateToNextCell(e,t,n,!0)}e.preventDefault()}}onShiftRangeSelect(e){const{rangeSvc:t,navigation:n}=this.beans;if(!t)return;const i=t.extendLatestRangeInDirection(e);i&&n?.ensureCellVisible(i)}onTabKeyDown(e){this.beans.navigation?.onTabKeyDown(this.cellCtrl,e)}onBackspaceOrDeleteKeyDown(e,t){const{cellCtrl:n,beans:i,rowNode:r}=this,{gos:s,rangeSvc:o,eventSvc:a}=i;if(!n.editing){if(a.dispatchEvent({type:"keyShortcutChangedCellStart"}),VWe(e,s.get("enableCellEditingOnBackspace"))){if(o&&Wl(s))o.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"});else if(n.isCellEditable()){const{column:l}=n,u=this.beans.valueSvc.getDeleteValue(l,r);r.setDataValue(l,u,"cellClear")}}else i.editSvc?.startRowOrCellEdit(n,e,t);a.dispatchEvent({type:"keyShortcutChangedCellEnd"})}}onEnterKeyDown(e){const{cellCtrl:t,beans:n}=this;if(t.editing||this.rowCtrl.editing)this.beans.editSvc?.stopRowOrCellEdit(t,!1,!1,e.shiftKey);else if(n.gos.get("enterNavigatesVertically")){const i=e.shiftKey?X.UP:X.DOWN;n.navigation?.navigateToNextCell(null,i,t.cellPosition,!1)}else n.editSvc?.startRowOrCellEdit(t,X.ENTER,e),t.editing&&e.preventDefault()}onF2KeyDown(e){const{cellCtrl:t,beans:n}=this;t.editing||n.editSvc?.startRowOrCellEdit(t,X.F2,e)}onEscapeKeyDown(e){const{cellCtrl:t,beans:n}=this;t.editing&&n.editSvc?.stopRowOrCellEdit(t,!0)}processCharacter(e){if(e.target!==this.eGui||this.cellCtrl.editing)return;const i=e.key;i===X.SPACE?this.onSpaceKeyDown(e):this.beans.editSvc?.startRowOrCellEdit(this.cellCtrl,i,e)&&e.preventDefault()}onSpaceKeyDown(e){const{gos:t}=this.beans;!this.cellCtrl.editing&&Gd(t)&&this.beans.selectionSvc?.handleSelectionEvent(e,this.rowNode,"spaceKey"),e.preventDefault()}destroy(){super.destroy()}},UWe=class extends Z{constructor(e,t,n){super(),this.cellCtrl=e,this.column=n,this.beans=t}onMouseEvent(e,t){if(!_l(t))switch(e){case"click":this.onCellClicked(t);break;case"mousedown":case"touchstart":this.onMouseDown(t);break;case"dblclick":this.onCellDoubleClicked(t);break;case"mouseout":this.onMouseOut(t);break;case"mouseover":this.onMouseOver(t);break}}onCellClicked(e){if(this.beans.touchSvc?.handleCellDoubleClick(this,e))return;const{eventSvc:t,rangeSvc:n,gos:i,editSvc:r}=this.beans,s=e.ctrlKey||e.metaKey;n&&s&&n.getCellRangeCount(this.cellCtrl.cellPosition)>1&&n.intersectLastRange(!0);const o=this.cellCtrl.createEvent(e,"cellClicked");t.dispatchEvent(o);const a=this.column.getColDef();a.onCellClicked&&window.setTimeout(()=>{this.beans.frameworkOverrides.wrapOutgoing(()=>{a.onCellClicked(o)})},0),(i.get("singleClickEdit")||a.singleClickEdit)&&!i.get("suppressClickEdit")&&!(e.shiftKey&&n?.getCellRanges().length!=0)&&r?.startRowOrCellEdit(this.cellCtrl,void 0,e)}onCellDoubleClicked(e){const{column:t,beans:n,cellCtrl:i}=this,{eventSvc:r,frameworkOverrides:s,gos:o,editSvc:a}=n,l=t.getColDef(),u=i.createEvent(e,"cellDoubleClicked");r.dispatchEvent(u),typeof l.onCellDoubleClicked=="function"&&window.setTimeout(()=>{s.wrapOutgoing(()=>{l.onCellDoubleClicked(u)})},0),!o.get("singleClickEdit")&&!o.get("suppressClickEdit")&&a?.startRowOrCellEdit(i,null,e)}onMouseDown(e){const{ctrlKey:t,metaKey:n,shiftKey:i}=e,r=e.target,{cellCtrl:s,beans:o}=this,{eventSvc:a,rangeSvc:l,rowNumbersSvc:u,focusSvc:c,gos:d}=o;if(this.isRightClickInExistingRange(e))return;const h=l&&!l.isEmpty(),p=this.containsWidget(r),{cellPosition:g}=s,m=Gp(g.column);if(u&&m&&!u.handleMouseDownOnCell(g,e)){l&&e.preventDefault(),e.stopImmediatePropagation();return}if(!i||!h){const y=d.get("enableCellTextSelection")&&e.defaultPrevented,b=(Oh()||y)&&!s.editing&&!oN(r)&&!p;s.focusCell(b)}if(i&&h&&!c.isCellFocused(g)){e.preventDefault();const C=c.getFocusedCell();if(C){const{column:y,rowIndex:b,rowPinned:S}=C,E=o.rowRenderer.getRowByPosition({rowIndex:b,rowPinned:S})?.getCellCtrl(y);E?.editing&&E.stopEditing(),c.setFocusedCell({column:y,rowIndex:b,rowPinned:S,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}}if(!p){if(l)if(m&&e.preventDefault(),i)l.extendLatestRangeToCell(g);else{const C=t||n;l.setRangeToCell(g,C)}a.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseDown"))}}isRightClickInExistingRange(e){const{rangeSvc:t}=this.beans;if(t){const n=t.isCellInAnyRange(this.cellCtrl.cellPosition),i=e.button===2||e.ctrlKey&&this.beans.gos.get("allowContextMenuWithControlKey");if(n&&i)return!0}return!1}containsWidget(e){return $d(e,"ag-selection-checkbox",3)||$d(e,"ag-drag-handle",3)}onMouseOut(e){if(this.mouseStayingInsideCell(e))return;const{eventSvc:t,colHover:n}=this.beans;t.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOut")),n?.clearMouseOver()}onMouseOver(e){if(this.mouseStayingInsideCell(e))return;const{eventSvc:t,colHover:n}=this.beans;t.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOver")),n?.setMouseOver([this.column])}mouseStayingInsideCell(e){if(!e.target||!e.relatedTarget)return!1;const t=this.cellCtrl.eGui,n=t.contains(e.target),i=t.contains(e.relatedTarget);return n&&i}destroy(){super.destroy()}},qWe=class extends Z{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.column=e.column,this.rowNode=e.rowNode}setupRowSpan(){this.rowSpan=this.column.getRowSpan(this.rowNode),this.addManagedListeners(this.beans.eventSvc,{newColumnsLoaded:()=>this.onNewColumnsLoaded()})}init(){this.eSetLeft=this.cellCtrl.getRootElement(),this.eContent=this.cellCtrl.eGui;const e=this.cellCtrl.getCellSpan();e||(this.setupColSpan(),this.setupRowSpan()),this.onLeftChanged(),this.onWidthChanged(),e||this._legacyApplyRowSpan(),e&&(this.refreshSpanHeight(e),this.addManagedListeners(this.beans.eventSvc,{paginationChanged:this.refreshSpanHeight.bind(this,e),recalculateRowBounds:this.refreshSpanHeight.bind(this,e)}))}refreshSpanHeight(e){const t=e.getCellHeight();t!=null&&(this.eContent.style.height=`${t}px`)}onNewColumnsLoaded(){const e=this.column.getRowSpan(this.rowNode);this.rowSpan!==e&&(this.rowSpan=e,this._legacyApplyRowSpan(!0))}onDisplayColumnsChanged(){const e=this.getColSpanningList();Nh(this.colsSpanning,e)||(this.colsSpanning=e,this.onWidthChanged(),this.onLeftChanged())}setupColSpan(){this.column.getColDef().colSpan!=null&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListeners(this.beans.eventSvc,{displayedColumnsChanged:this.onDisplayColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onWidthChanged.bind(this)}))}onWidthChanged(){if(!this.eContent)return;const e=this.getCellWidth();this.eContent.style.width=`${e}px`}getCellWidth(){return this.colsSpanning?this.colsSpanning.reduce((e,t)=>e+t.getActualWidth(),0):this.column.getActualWidth()}getColSpanningList(){const{column:e,rowNode:t}=this,n=e.getColSpan(t),i=[];if(n===1)i.push(e);else{let r=e;const s=e.getPinned();for(let o=0;r&&o<n&&(i.push(r),r=this.beans.visibleCols.getColAfter(r),!(!r||Xt(r)||s!==r.getPinned()));o++);}return i}onLeftChanged(){if(!this.eSetLeft)return;const e=this.modifyLeftForPrintLayout(this.getCellLeft());this.eSetLeft.style.left=e+"px"}getCellLeft(){let e;return this.beans.gos.get("enableRtl")&&this.colsSpanning?e=Lt(this.colsSpanning):e=this.column,e.getLeft()}modifyLeftForPrintLayout(e){if(!this.cellCtrl.printLayout||this.column.getPinned()==="left")return e;const{visibleCols:t}=this.beans,n=t.getColsLeftWidth();if(this.column.getPinned()==="right"){const i=t.bodyWidth;return n+i+(e||0)}return n+(e||0)}_legacyApplyRowSpan(e){if(this.rowSpan===1&&!e)return;const n=zd(this.beans)*this.rowSpan;this.eContent.style.height=`${n}px`,this.eContent.style.zIndex="1"}destroy(){super.destroy()}},jWe="ag-cell",KWe="ag-cell-auto-height",YWe="ag-cell-normal-height",XWe="ag-cell-focus",QWe="ag-cell-first-right-pinned",ZWe="ag-cell-last-left-pinned",JWe="ag-cell-not-inline-editing",e4e="ag-cell-wrap-text",m1="cellCtrl";function ete(e,t){return kee(e,t,m1)}var t4e=0,Pv=class extends Z{constructor(e,t,n,i){super(),this.column=e,this.rowNode=t,this.rowCtrl=i,this.rangeFeature=void 0,this.positionFeature=void 0,this.customStyleFeature=void 0,this.tooltipFeature=void 0,this.mouseListener=void 0,this.keyboardListener=void 0,this.suppressRefreshCell=!1,this.onCompAttachedFuncs=[],this.onEditorAttachedFuncs=[],this.focusEventWhileNotReady=null,this.hasBeenFocused=!1,this.beans=n;const{colId:r,colIdSanitised:s}=e;this.instanceId=r+"-"+t4e++,this.colIdSanitised=s,this.createCellPosition(),this.updateAndFormatValue(!1)}addFeatures(){const{beans:e}=this;this.positionFeature=new qWe(this,e),this.customStyleFeature=e.cellStyles?.createCellCustomStyleFeature(this,e),this.mouseListener=new UWe(this,e,this.column),this.keyboardListener=new WWe(this,e,this.rowNode,this.rowCtrl),this.column.isTooltipEnabled()&&this.enableTooltipFeature();const{rangeSvc:t}=e;t&&Wl(e.gos)&&(this.rangeFeature=t.createCellRangeFeature(e,this))}isCellSpanning(){return!1}getCellSpan(){}removeFeatures(){const e=this.beans.context;this.positionFeature=e.destroyBean(this.positionFeature),this.customStyleFeature=e.destroyBean(this.customStyleFeature),this.mouseListener=e.destroyBean(this.mouseListener),this.keyboardListener=e.destroyBean(this.keyboardListener),this.rangeFeature=e.destroyBean(this.rangeFeature),this.disableTooltipFeature()}enableTooltipFeature(e,t){this.tooltipFeature=this.beans.tooltipSvc?.enableCellTooltipFeature(this,e,t)}disableTooltipFeature(){this.tooltipFeature=this.beans.context.destroyBean(this.tooltipFeature)}setComp(e,t,n,i,r,s,o){this.comp=e,this.eGui=t,this.printLayout=r,o??(o=this),this.addDomData(o),this.addFeatures(),o.addDestroyFunc(()=>this.removeFeatures()),this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.setupFocus(),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),this.setupAutoHeight(i,o),this.refreshFirstAndLastStyles(),this.refreshAriaColIndex(),this.positionFeature?.init(),this.customStyleFeature?.setComp(e),this.tooltipFeature?.refreshTooltip(),this.keyboardListener?.init(),this.rangeFeature?.setComp(e),s&&this.isCellEditable()?this.beans.editSvc?.startEditing(this):this.showValue(!1,!0),this.onCompAttachedFuncs.length&&(this.onCompAttachedFuncs.forEach(a=>a()),this.onCompAttachedFuncs=[])}setupAutoHeight(e,t){this.isAutoHeight=this.beans.rowAutoHeight?.setupCellAutoHeight(this,e,t)??!1}getCellAriaRole(){return this.column.getColDef().cellAriaRole??"gridcell"}isCellRenderer(){const e=this.column.getColDef();return e.cellRenderer!=null||e.cellRendererSelector!=null}getValueToDisplay(){return this.valueFormatted??this.value}showValue(e,t){const{beans:n,column:i,rowNode:r,rangeFeature:s}=this,{userCompFactory:o}=n,a=this.getValueToDisplay();let l;const u=r.stub&&r.groupData?.[i.getId()]==null,c=i.getColDef();if(u||this.isCellRenderer()){const d=this.createCellRendererParams();!u||Gp(i)?l=wW(o,c,d):l=gWe(o,c,d)}if(!l&&!u&&n.findSvc?.isMatch(r,i)){const d=this.createCellRendererParams();l=wW(o,{...i.getColDef(),cellRenderer:"agFindCellRenderer"},d)}this.comp.setRenderDetails(l,a,e),!t&&s&&lu(n,()=>s?.refreshHandle())}setupControlComps(){const e=this.column.getColDef();this.includeSelection=this.isIncludeControl(this.isCheckboxSelection(e)),this.includeRowDrag=this.isIncludeControl(e.rowDrag),this.includeDndSource=this.isIncludeControl(e.dndSource),this.comp.setIncludeSelection(this.includeSelection),this.comp.setIncludeDndSource(this.includeDndSource),this.comp.setIncludeRowDrag(this.includeRowDrag)}isForceWrapper(){return this.beans.gos.get("enableCellTextSelection")||this.column.isAutoHeight()}isIncludeControl(e){return this.rowNode.rowPinned!=null?!1:typeof e=="function"||e===!0}isCheckboxSelection(e){const{rowSelection:t,groupDisplayType:n}=this.beans.gridOptions,i=l1(t),r=Ul(this.column);return n==="custom"&&i!=="selectionColumn"&&r?!1:e.checkboxSelection||r&&typeof t=="object"&&Kf(t)}refreshShouldDestroy(){const e=this.column.getColDef(),t=this.includeSelection!=this.isIncludeControl(this.isCheckboxSelection(e)),n=this.includeRowDrag!=this.isIncludeControl(e.rowDrag),i=this.includeDndSource!=this.isIncludeControl(e.dndSource),r=this.isAutoHeight!=this.column.isAutoHeight();return t||n||i||r}onPopupEditorClosed(){this.editing&&this.beans.editSvc?.stopRowOrCellEdit(this)}stopEditing(e=!1){return this.beans.editSvc?.stopEditing(this,e)??!1}createCellRendererParams(){const{value:e,valueFormatted:t,column:n,rowNode:i,comp:r,eGui:s,beans:{valueSvc:o,gos:a}}=this;return ze(a,{value:e,valueFormatted:t,getValue:()=>o.getValueForDisplay(n,i),setValue:u=>o.setValue(i,n,u),formatValue:this.formatValue.bind(this),data:i.data,node:i,pinned:n.getPinned(),colDef:n.getColDef(),column:n,refreshCell:this.refreshCell.bind(this),eGridCell:s,eParentOfValue:r.getParentOfValue(),registerRowDragger:(u,c,d,h)=>this.registerRowDragger(u,c,h),setTooltip:(u,c)=>{a.assertModuleRegistered("Tooltip",3),this.tooltipFeature&&this.disableTooltipFeature(),this.enableTooltipFeature(u,c),this.tooltipFeature?.refreshTooltip()}})}onCellChanged(e){e.column===this.column&&this.refreshCell({})}refreshOrDestroyCell(e){this.refreshShouldDestroy()?this.rowCtrl?.recreateCell(this):this.refreshCell(e)}refreshCell(e){if(this.suppressRefreshCell||this.editing)return;const t=this.column.getColDef(),n=e!=null&&!!e.newData,i=e!=null&&!!e.suppressFlash,r=t.field==null&&t.valueGetter==null&&t.showRowGroup==null,s=e&&e.forceRefresh||r||n,o=!!this.comp,a=this.updateAndFormatValue(o),l=s||a;if(o){if(l){this.showValue(n,!1);const u=this.beans.filterManager?.isSuppressFlashingCellsBecauseFiltering();!i&&!u&&t.enableCellChangeFlash&&this.beans.cellFlashSvc?.flashCell(this),this.customStyleFeature?.applyUserStyles(),this.customStyleFeature?.applyClassesFromColDef()}this.tooltipFeature?.refreshTooltip(),this.customStyleFeature?.applyCellClassRules()}}isCellEditable(){return this.column.isCellEditable(this.rowNode)}formatValue(e){return this.callValueFormatter(e)??e}callValueFormatter(e){return this.beans.valueSvc.formatValue(this.column,this.rowNode,e)}updateAndFormatValue(e){const t=this.value,n=this.valueFormatted;return this.value=this.beans.valueSvc.getValueForDisplay(this.column,this.rowNode),this.valueFormatted=this.callValueFormatter(this.value),e?!this.valuesAreEqual(t,this.value)||this.valueFormatted!=n:!0}valuesAreEqual(e,t){const n=this.column.getColDef();return n.equals?n.equals(e,t):e===t}addDomData(e){const t=this.eGui;fh(this.beans.gos,t,m1,this),e.addDestroyFunc(()=>fh(this.beans.gos,t,m1,null))}createEvent(e,t){const{rowNode:n,column:i,value:r,beans:s}=this;return ze(s.gos,{type:t,node:n,data:n.data,value:r,column:i,colDef:i.getColDef(),rowPinned:n.rowPinned,event:e,rowIndex:n.rowIndex})}processCharacter(e){this.keyboardListener?.processCharacter(e)}onKeyDown(e){this.keyboardListener?.onKeyDown(e)}onMouseEvent(e,t){this.mouseListener?.onMouseEvent(e,t)}getColSpanningList(){return this.positionFeature.getColSpanningList()}onLeftChanged(){this.comp&&this.positionFeature?.onLeftChanged()}onDisplayedColumnsChanged(){this.eGui&&(this.refreshAriaColIndex(),this.refreshFirstAndLastStyles())}refreshFirstAndLastStyles(){const{comp:e,column:t,beans:n}=this;Zee(e,t,n.visibleCols)}refreshAriaColIndex(){const e=this.beans.visibleCols.getAriaColIndex(this.column);tee(this.eGui,e)}onWidthChanged(){return this.positionFeature?.onWidthChanged()}getRowPosition(){const{rowIndex:e,rowPinned:t}=this.cellPosition;return{rowIndex:e,rowPinned:t}}updateRangeBordersIfRangeCount(){this.comp&&this.rangeFeature?.updateRangeBordersIfRangeCount()}onCellSelectionChanged(){this.comp&&this.rangeFeature?.onCellSelectionChanged()}isRangeSelectionEnabled(){return this.rangeFeature!=null}focusCell(e=!1){this.beans.focusSvc.setFocusedCell({...this.getFocusedCellPosition(),forceBrowserFocus:e})}restoreFocus(e=!1){if(!this.comp||this.editing||!this.isCellFocused()||!this.beans.focusSvc.shouldTakeFocus())return;const t=()=>{if(!this.isAlive())return;const n=this.comp.getFocusableElement();this.isCellFocused()&&n.focus({preventScroll:!0})};if(e){setTimeout(t,0);return}t()}onRowIndexChanged(){this.createCellPosition(),this.onCellFocused(),this.restoreFocus(),this.rangeFeature?.onCellSelectionChanged()}onSuppressCellFocusChanged(e){const t=this.eGui;t&&(Gp(this.column)&&(e=!0),$s(t,"tabindex",e?void 0:-1))}onFirstRightPinnedChanged(){if(!this.comp)return;const e=this.column.isFirstRightPinned();this.comp.addOrRemoveCssClass(QWe,e)}onLastLeftPinnedChanged(){if(!this.comp)return;const e=this.column.isLastLeftPinned();this.comp.addOrRemoveCssClass(ZWe,e)}checkCellFocused(){return this.beans.focusSvc.isCellFocused(this.cellPosition)}isCellFocused(){const e=this.checkCellFocused();return this.hasBeenFocused||(this.hasBeenFocused=e),e}setupFocus(){this.restoreFocus(!0),this.onCellFocused(this.focusEventWhileNotReady??void 0)}onCellFocused(e){const{beans:t}=this;if(jR(t))return;if(!this.comp){e&&(this.focusEventWhileNotReady=e);return}const n=this.isCellFocused();if(this.comp.addOrRemoveCssClass(XWe,n),n&&e&&e.forceBrowserFocus){let r=this.comp.getFocusableElement();if(this.editing){const s=Qf(r,null,!0);s.length&&(r=s[0])}r.focus({preventScroll:!!e.preventScrollOnBrowserFocus})}const i=t.gos.get("editType")==="fullRow";!n&&!i&&this.editing&&t.editSvc?.stopRowOrCellEdit(this),n&&this.rowCtrl.announceDescription()}createCellPosition(){const{rowIndex:e,rowPinned:t}=this.rowNode;this.cellPosition={rowIndex:e,rowPinned:Il(t),column:this.column}}setInlineEditingCss(){this.beans.editSvc?.setInlineEditingCss(this.rowCtrl)}applyStaticCssClasses(){const{comp:e}=this;e.addOrRemoveCssClass(jWe,!0),e.addOrRemoveCssClass(JWe,!0);const t=this.column.isAutoHeight()==!0;e.addOrRemoveCssClass(KWe,t),e.addOrRemoveCssClass(YWe,!t)}onColumnHover(){this.beans.colHover?.onCellColumnHover(this.column,this.comp)}onColDefChanged(){this.comp&&(this.column.isTooltipEnabled()?(this.disableTooltipFeature(),this.enableTooltipFeature()):this.disableTooltipFeature(),this.setWrapText(),this.editing?this.beans.editSvc?.handleColDefChanged(this):this.refreshOrDestroyCell({forceRefresh:!0,suppressFlash:!0}))}setWrapText(){const e=this.column.getColDef().wrapText==!0;this.comp.addOrRemoveCssClass(e4e,e)}dispatchCellContextMenuEvent(e){const t=this.column.getColDef(),n=this.createEvent(e,"cellContextMenu"),{beans:i}=this;i.eventSvc.dispatchEvent(n),t.onCellContextMenu&&window.setTimeout(()=>{i.frameworkOverrides.wrapOutgoing(()=>{t.onCellContextMenu(n)})},0)}getCellRenderer(){return this.comp?.getCellRenderer()??null}destroy(){this.onCompAttachedFuncs=[],this.onEditorAttachedFuncs=[],this.isCellFocused()&&this.hasBrowserFocus()&&this.beans.focusSvc.attemptToRecoverFocus(),super.destroy()}hasBrowserFocus(){return this.eGui?.contains(nn(this.beans))??!1}createSelectionCheckbox(){const e=this.beans.selectionSvc?.createCheckboxSelectionComponent();if(e)return this.beans.context.createBean(e),e.init({rowNode:this.rowNode,column:this.column}),e}createDndSource(){const e=this.beans.registry.createDynamicBean("dndSourceComp",!1,this.rowNode,this.column,this.eGui);return e&&this.beans.context.createBean(e),e}registerRowDragger(e,t,n){if(this.customRowDragComp){this.customRowDragComp.setDragElement(e,t);return}const i=this.createRowDragComp(e,t,n);i&&(this.customRowDragComp=i,this.addDestroyFunc(()=>{this.beans.context.destroyBean(i),this.customRowDragComp=null}))}createRowDragComp(e,t,n){const i=this.beans.rowDragSvc?.createRowDragCompForCell(this.rowNode,this.column,()=>this.value,e,t,n);if(i)return this.beans.context.createBean(i),i}cellEditorAttached(){this.onEditorAttachedFuncs.forEach(e=>e()),this.onEditorAttachedFuncs=[]}setFocusedCellPosition(e){}getFocusedCellPosition(){return this.cellPosition}refreshAriaRowIndex(){}getRootElement(){return this.eGui}},tte="__ag_grid_instance";function nte(e,t){t[tte]=e.gridInstanceId}function D0(e,t){return ite(e,t.target)}function ite(e,t){let n=t;for(;n;){const i=n[tte];if(Ce(i))return i===e.gridInstanceId;n=n.parentElement}return!1}function n4e(e,t){return ete(e,t.target)?.getFocusedCellPosition()??null}function VD(e,t){const n=Si(e.gos,"normal"),i=t;let r,s;if(i.clientX!=null||i.clientY!=null?(r=i.clientX,s=i.clientY):(r=i.x,s=i.y),n){const o=e.ctrlsSvc.getScrollFeature(),a=o.getVScrollPosition(),l=o.getHScrollPosition();r+=l.left,s+=a.top}return{x:r,y:s}}var i4e=class extends Z{constructor(){super(...arguments),this.beanName="dragAndDrop",this.dragSourceAndParamsList=[],this.dropTargets=[]}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.dragSvc=e.dragSvc,this.environment=e.environment,this.userCompFactory=e.userCompFactory}addDragSource(e,t=!1){const n={eElement:e.eElement,dragStartPixels:e.dragStartPixels,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),onDragCancel:this.onDragCancel.bind(this),includeTouch:t};this.dragSourceAndParamsList.push({params:n,dragSource:e}),this.dragSvc.addDragSource(n)}getDragAndDropImageComponent(){const{dragAndDropImageComp:e}=this;return!e||!e.comp?null:e.comp}removeDragSource(e){const{dragSourceAndParamsList:t,dragSvc:n}=this,i=t.find(r=>r.dragSource===e);i&&(n.removeDragSource(i.params),_o(t,i))}destroy(){const{dragSourceAndParamsList:e,dragSvc:t,dropTargets:n}=this;e.forEach(i=>t.removeDragSource(i.params)),e.length=0,n.length=0,this.clearDragAndDropProperties(),super.destroy()}nudge(){this.dragging&&this.onDragging(this.eventLastTime,!0)}onDragStart(e,t){this.dragging=!0,this.dragSource=e,this.eventLastTime=t,this.dragItem=e.getDragItem(),e.onDragStarted?.(),this.createDragAndDropImageComponent()}onDragStop(e){this.dragSource?.onDragStopped?.();const{lastDropTarget:t}=this;if(t?.onDragStop){const n=this.createDropTargetEvent(t,e,null,null,!1);t.onDragStop(n)}this.clearDragAndDropProperties()}onDragCancel(){const{dragSource:e,lastDropTarget:t}=this;e?.onDragCancelled?.(),t?.onDragCancel&&t.onDragCancel(this.createDropTargetEvent(t,this.eventLastTime,null,null,!1)),this.clearDragAndDropProperties()}clearDragAndDropProperties(){this.eventLastTime=null,this.dragging=!1,this.lastDropTarget=void 0,this.dragItem=null,this.dragSource=null,this.removeDragAndDropImageComponent()}onDragging(e,t=!1){const n=this.getHorizontalDirection(e),i=this.getVerticalDirection(e);this.eventLastTime=e,this.positionDragAndDropImageComp(e);const r=this.dropTargets.filter(c=>this.isMouseOnDropTarget(e,c)),s=this.findCurrentDropTarget(e,r),{lastDropTarget:o,dragSource:a,dragAndDropImageComp:l,dragItem:u}=this;if(s!==o){if(this.leaveLastTargetIfExists(e,n,i,t),o!==null&&s===null&&a?.onGridExit?.(u),o===null&&s!==null&&a?.onGridEnter?.(u),this.enterDragTargetIfExists(s,e,n,i,t),s&&l){const{comp:c,promise:d}=l;c?c.setIcon(s.getIconName?s.getIconName():null,!1):d.then(h=>{h&&h.setIcon(s.getIconName?s.getIconName():null,!1)})}this.lastDropTarget=s}else if(s&&s.onDragging){const c=this.createDropTargetEvent(s,e,n,i,t);s.onDragging(c)}}getAllContainersFromDropTarget(e){const t=e.getSecondaryContainers?e.getSecondaryContainers():null,n=[[e.getContainer()]];return t?n.concat(t):n}isMouseOnDropTarget(e,t){const n=this.getAllContainersFromDropTarget(t);let i=!1;const r=(a,l)=>{for(const u of l){const{width:c,height:d,left:h,right:p,top:g,bottom:m}=u.getBoundingClientRect();if(c===0||d===0)return!1;const C=a.clientX>=h&&a.clientX<p,y=a.clientY>=g&&a.clientY<m;if(!C||!y)return!1}return!0};for(const a of n)if(r(e,a)){i=!0;break}const{eElement:s,type:o}=this.dragSource;return t.targetContainsSource&&!t.getContainer().contains(s)?!1:i&&t.isInterestedIn(o,s)}findCurrentDropTarget(e,t){const n=t.length;if(n===0)return null;if(n===1)return t[0];const r=S0(this.beans).elementsFromPoint(e.clientX,e.clientY);for(const s of r)for(const o of t)if(this.getAllContainersFromDropTarget(o).flatMap(l=>l).indexOf(s)!==-1)return o;return null}enterDragTargetIfExists(e,t,n,i,r){if(e&&e.onDragEnter){const s=this.createDropTargetEvent(e,t,n,i,r);e.onDragEnter(s)}}leaveLastTargetIfExists(e,t,n,i){const{lastDropTarget:r}=this;if(!r)return;if(r.onDragLeave){const o=this.createDropTargetEvent(r,e,t,n,i);r.onDragLeave(o)}const s=this.getDragAndDropImageComponent();s&&s.setIcon(null,!1)}addDropTarget(e){this.dropTargets.push(e)}removeDropTarget(e){this.dropTargets=this.dropTargets.filter(t=>t.getContainer()!==e.getContainer())}hasExternalDropZones(){return this.dropTargets.some(e=>e.external)}findExternalZone(e){return this.dropTargets.filter(n=>n.external).find(n=>n.getContainer()===e.getContainer())||null}isDropZoneWithinThisGrid(e){const n=this.ctrlsSvc.getGridBodyCtrl().eGridBody,{dropZoneTarget:i}=e;return n.contains(i)}getHorizontalDirection(e){const t=this.eventLastTime?.clientX,n=e.clientX;return t===n?null:t>n?"left":"right"}getVerticalDirection(e){const t=this.eventLastTime?.clientY,n=e.clientY;return t===n?null:t>n?"up":"down"}createDropTargetEvent(e,t,n,i,r){const s=e.getContainer(),o=s.getBoundingClientRect(),{dragItem:a,dragSource:l,gos:u}=this,c=t.clientX-o.left,d=t.clientY-o.top;return ze(u,{event:t,x:c,y:d,vDirection:i,hDirection:n,dragSource:l,fromNudge:r,dragItem:a,dropZoneTarget:s})}positionDragAndDropImageComp(e){const t=this.getDragAndDropImageComponent();t&&Y5e(t.getGui(),e,this.beans)}removeDragAndDropImageComponent(){const{dragAndDropImageComp:e}=this;if(e){const{comp:t}=e;if(t){const n=t.getGui();this.dragAndDropImageParent?.removeChild(n),this.destroyBean(t)}}this.dragAndDropImageComp=null}createDragAndDropImageComponent(){const{dragSource:e,gos:t,userCompFactory:n}=this;if(!e)return;const i=oWe(n,ze(t,{dragSource:e}));if(!i)return;const r=i.newAgStackInstance();this.dragAndDropImageComp={promise:r},r.then(s=>{!s||!this.isAlive()||(this.processDragAndDropImageComponent(s),this.dragAndDropImageComp.comp=s)})}processDragAndDropImageComponent(e){const{dragSource:t,environment:n}=this;if(!t)return;const i=e.getGui();i.style.setProperty("position","absolute"),i.style.setProperty("z-index","9999"),nte(this.gos,i),n.applyThemeClasses(i),e.setIcon(null,!1);let{dragItemName:r}=t;typeof r=="function"&&(r=r()),e.setLabel(r||""),i.style.top="20px",i.style.left="20px";const s=dN(this.beans);this.dragAndDropImageParent=s,s?s.appendChild(i):de(54)}registerGridDropTarget(e,t){const n={getContainer:e,isInterestedIn:i=>i===1||i===0,getIconName:()=>"notAllowed"};this.addDropTarget(n),t.addDestroyFunc(()=>this.removeDropTarget(n))}},r4e=class{constructor(e){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=e.scrollContainer,this.scrollHorizontally=e.scrollAxis.indexOf("x")!==-1,this.scrollVertically=e.scrollAxis.indexOf("y")!==-1,this.scrollByTick=e.scrollByTick!=null?e.scrollByTick:20,e.onScrollCallback&&(this.onScrollCallback=e.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=e.getVerticalPosition,this.setVerticalPosition=e.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=e.getHorizontalPosition,this.setHorizontalPosition=e.setHorizontalPosition),this.shouldSkipVerticalScroll=e.shouldSkipVerticalScroll||(()=>!1),this.shouldSkipHorizontalScroll=e.shouldSkipHorizontalScroll||(()=>!1)}check(e,t=!1){const n=t||this.shouldSkipVerticalScroll();if(n&&this.shouldSkipHorizontalScroll())return;const i=this.scrollContainer.getBoundingClientRect(),r=this.scrollByTick;this.tickLeft=e.clientX<i.left+r,this.tickRight=e.clientX>i.right-r,this.tickUp=e.clientY<i.top+r&&!n,this.tickDown=e.clientY>i.bottom-r&&!n,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}ensureTickingStarted(){this.tickingInterval===null&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)}doTick(){this.tickCount++;const e=this.tickCount>20?200:this.tickCount>10?80:40;if(this.scrollVertically){const t=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(t-e),this.tickDown&&this.setVerticalPosition(t+e)}if(this.scrollHorizontally){const t=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(t-e),this.tickRight&&this.setHorizontalPosition(t+e)}this.onScrollCallback&&this.onScrollCallback()}ensureCleared(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)}};function s4e(e){const{rowIndex:t,rowPinned:n,column:i}=e;return`${t}.${n??"null"}.${i.getId()}`}function rte(e,t){const n=e.column===t.column,i=e.rowPinned===t.rowPinned,r=e.rowIndex===t.rowIndex;return n&&i&&r}function o4e(e,t){switch(e.rowPinned){case"top":if(t.rowPinned!=="top")return!0;break;case"bottom":if(t.rowPinned!=="bottom")return!1;break;default:if(Ce(t.rowPinned))return t.rowPinned!=="top";break}return e.rowIndex<t.rowIndex}function a4e(e,t){return!e&&!t?!0:e&&!t||!e&&t?!1:e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned}function l4e(e){let t=0,n;const{pinnedRowModel:i,rowModel:r,pageBounds:s}=e;return i?.getPinnedTopRowCount()?n="top":r.getRowCount()?(n=null,t=s.getFirstRow()):i?.getPinnedBottomRowCount()&&(n="bottom"),n===void 0?null:{rowIndex:t,rowPinned:n}}function u4e(e){let t,n=null;const{pinnedRowModel:i,pageBounds:r}=e,s=i?.getPinnedBottomRowCount(),o=i?.getPinnedTopRowCount();return s?(n="bottom",t=s-1):e.rowModel.getRowCount()?(n=null,t=r.getLastRow()):o&&(n="top",t=o-1),t===void 0?null:{rowIndex:t,rowPinned:n}}function v1(e,t){switch(t.rowPinned){case"top":return e.pinnedRowModel?.getPinnedTopRow(t.rowIndex);case"bottom":return e.pinnedRowModel?.getPinnedBottomRow(t.rowIndex);default:return e.rowModel.getRow(t.rowIndex)}}function Tf(e,t){const n=e.spannedRowRenderer?.getCellByPosition(t);if(n)return n;const i=e.rowRenderer.getRowByPosition(t);return i?i.getCellCtrl(t.column):null}function C1(e,t){const{rowIndex:n,rowPinned:i}=t,{pageBounds:r,pinnedRowModel:s,rowModel:o}=e;if(n===0)return i==="top"?null:i==="bottom"&&o.isRowsToRender()?{rowIndex:r.getLastRow(),rowPinned:null}:s?.isRowsToRender("top")?{rowIndex:s.getPinnedTopRowCount()-1,rowPinned:"top"}:null;const a=i?void 0:o.getRow(n);return ste(e,a,!0)??{rowIndex:n-1,rowPinned:i}}function SW(e,t){const{rowIndex:n,rowPinned:i}=t,{pageBounds:r,pinnedRowModel:s,rowModel:o}=e;if(c4e(e,t))return i==="bottom"?null:i==="top"&&o.isRowsToRender()?{rowIndex:r.getFirstRow(),rowPinned:null}:s?.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;const a=i?void 0:o.getRow(n);return ste(e,a)??{rowIndex:n+1,rowPinned:i}}function ste(e,t,n){const{gos:i,rowRenderer:r}=e;if(!t?.sticky||!Ree(i))return;const s=n?r.getStickyTopRowCtrls():r.getStickyBottomRowCtrls();let o;for(let a=0;a<s.length;a++)if(s[a].rowNode.rowIndex===t.rowIndex){o=s[a+(n?-1:1)];break}return o?{rowIndex:o.rowNode.rowIndex,rowPinned:null}:void 0}function c4e(e,t){const{rowPinned:n,rowIndex:i}=t,{pinnedRowModel:r,pageBounds:s}=e;return n==="top"?(r?.getPinnedTopRowCount()??0)-1<=i:n==="bottom"?(r?.getPinnedBottomRowCount()??0)-1<=i:s.getLastRow()<=i}var d4e=class extends Z{constructor(e){super(),this.eContainer=e}postConstruct(){const{rowModel:e,gos:t,ctrlsSvc:n}=this.beans;tr(t)&&(this.clientSideRowModel=e),n.whenReady(this,i=>{const r=i.gridBodyCtrl;this.autoScrollService=new r4e({scrollContainer:r.eBodyViewport,scrollAxis:"y",getVerticalPosition:()=>r.scrollFeature.getVScrollPosition().top,setVerticalPosition:s=>r.scrollFeature.setVerticalScrollPosition(s),onScrollCallback:()=>{this.onDragging(this.lastDraggingEvent)}})})}getContainer(){return this.eContainer}isInterestedIn(e){return e===2}getIconName(){return this.gos.get("rowDragManaged")&&this.shouldPreventRowMove()?"notAllowed":"move"}shouldPreventRowMove(){const{rowGroupColsSvc:e,filterManager:t,sortSvc:n}=this.beans;return!!((e?.columns??[]).length||t?.isAnyFilterPresent()||n?.isSortActive())}getRowNodes(e){if(!this.isFromThisGrid(e))return e.dragItem.rowNodes||[];const t=e.dragItem.rowNode;if(this.gos.get("rowDragMultiRow")){const i=[...this.beans.selectionSvc?.getSelectedNodes()??[]].sort((r,s)=>r.rowIndex==null||s.rowIndex==null?0:this.getRowIndexNumber(r)-this.getRowIndexNumber(s));if(i.indexOf(t)!==-1)return i}return[t]}onDragEnter(e){e.dragItem.rowNodes=this.getRowNodes(e),this.dispatchGridEvent("rowDragEnter",e),this.getRowNodes(e).forEach(t=>{this.setRowNodeDragging(t,!0)}),this.onEnterOrDragging(e)}onDragging(e){this.onEnterOrDragging(e)}isFromThisGrid(e){const{dragSourceDomDataKey:t}=e.dragSource;return t===this.gos.getDomDataKey()}onEnterOrDragging(e){this.dispatchGridEvent("rowDragMove",e),this.lastDraggingEvent=e;const t=VD(this.beans,e).y;this.gos.get("rowDragManaged")&&this.doManagedDrag(e,t),this.autoScrollService.check(e.event)}doManagedDrag(e,t){const{dragAndDrop:n,gos:i}=this.beans,r=this.isFromThisGrid(e),s=i.get("rowDragManaged"),o=e.dragItem.rowNodes;s&&this.shouldPreventRowMove()||(i.get("suppressMoveWhenRowDragging")||!r?n.isDropZoneWithinThisGrid(e)&&this.clientSideRowModel.highlightRowAtPixel(o[0],t):this.moveRows(o,t))}getRowIndexNumber(e){const t=e.getRowIndexString();return parseInt(Lt(t.split("-")),10)}moveRowAndClearHighlight(e){const t=this.clientSideRowModel,n=t.getLastHighlightedRowNode(),i=n&&n.highlighted==="Below",r=VD(this.beans,e).y,s=e.dragItem.rowNodes;let o=i?1:0;if(this.isFromThisGrid(e))s.forEach(a=>{a.rowTop<r&&(o-=1)}),this.moveRows(s,r,o);else{const a=$p(this.gos);let l=t.getRowIndexAtPixel(r)+1;t.getHighlightPosition(r)==="Above"&&l--,t.updateRowData({add:s.filter(u=>!t.getRowNode(a?.({data:u.data,level:0,rowPinned:u.rowPinned})??u.data.id)).map(u=>u.data),addIndex:l})}this.clearRowHighlight()}clearRowHighlight(){this.clientSideRowModel.highlightRowAtPixel(null)}moveRows(e,t,n=0){const i=this.beans.focusSvc,r=i.getFocusedCell(),s=r&&Tf(this.beans,r);this.clientSideRowModel.ensureRowsAtPixel(e,t,n)&&(s?s.focusCell():i.clearFocusedCell())}addRowDropZone(e){if(!e.getContainer()){de(55);return}const t=this.beans.dragAndDrop;if(t.findExternalZone(e)){de(56);return}let n={getContainer:e.getContainer};e.fromGrid?n=e:(e.onDragEnter&&(n.onDragEnter=r=>{e.onDragEnter(this.draggingToRowDragEvent("rowDragEnter",r))}),e.onDragLeave&&(n.onDragLeave=r=>{e.onDragLeave(this.draggingToRowDragEvent("rowDragLeave",r))}),e.onDragging&&(n.onDragging=r=>{e.onDragging(this.draggingToRowDragEvent("rowDragMove",r))}),e.onDragStop&&(n.onDragStop=r=>{e.onDragStop(this.draggingToRowDragEvent("rowDragEnd",r))}),e.onDragCancel&&(n.onDragCancel=r=>{e.onDragCancel(this.draggingToRowDragEvent("rowDragCancel",r))}));const i={isInterestedIn:r=>r===2,getIconName:()=>"move",external:!0,...n};t.addDropTarget(i),this.addDestroyFunc(()=>t.removeDropTarget(i))}getRowDropZone(e){const t=this.getContainer.bind(this),n=this.onDragEnter.bind(this),i=this.onDragLeave.bind(this),r=this.onDragging.bind(this),s=this.onDragStop.bind(this),o=this.onDragCancel.bind(this);let a;return e?a={getContainer:t,onDragEnter:e.onDragEnter?l=>{n(l),e.onDragEnter(this.draggingToRowDragEvent("rowDragEnter",l))}:n,onDragLeave:e.onDragLeave?l=>{i(l),e.onDragLeave(this.draggingToRowDragEvent("rowDragLeave",l))}:i,onDragging:e.onDragging?l=>{r(l),e.onDragging(this.draggingToRowDragEvent("rowDragMove",l))}:r,onDragStop:e.onDragStop?l=>{s(l),e.onDragStop(this.draggingToRowDragEvent("rowDragEnd",l))}:s,onDragCancel:e.onDragCancel?l=>{o(l),e.onDragCancel(this.draggingToRowDragEvent("rowDragCancel",l))}:o,fromGrid:!0}:a={getContainer:t,onDragEnter:n,onDragLeave:i,onDragging:r,onDragStop:s,onDragCancel:o,fromGrid:!0},a}draggingToRowDragEvent(e,t){const n=this.beans,{pageBounds:i,rowModel:r,gos:s}=n,o=VD(n,t).y,a=o>i.getCurrentPageHeight();let l=-1,u;return a||(l=r.getRowIndexAtPixel(o),u=r.getRow(l)),ze(s,{type:e,event:t.event,node:t.dragItem.rowNode,nodes:t.dragItem.rowNodes,overIndex:l,overNode:u,y:o,vDirection:t.vDirection})}dispatchGridEvent(e,t){const n=this.draggingToRowDragEvent(e,t);this.eventSvc.dispatchEvent(n)}onDragLeave(e){this.dispatchGridEvent("rowDragLeave",e),this.stopDragging(e),this.gos.get("rowDragManaged")&&this.clearRowHighlight()}onDragStop(e){this.dispatchGridEvent("rowDragEnd",e),this.stopDragging(e);const{dragAndDrop:t,gos:n}=this.beans;n.get("rowDragManaged")&&(n.get("suppressMoveWhenRowDragging")||!this.isFromThisGrid(e))&&t.isDropZoneWithinThisGrid(e)&&this.moveRowAndClearHighlight(e)}onDragCancel(e){this.dispatchGridEvent("rowDragCancel",e),this.stopDragging(e);const{dragAndDrop:t,gos:n}=this.beans;n.get("rowDragManaged")&&(n.get("suppressMoveWhenRowDragging")||!this.isFromThisGrid(e))&&t.isDropZoneWithinThisGrid(e)&&this.clearRowHighlight()}stopDragging(e){this.autoScrollService.ensureCleared(),this.getRowNodes(e).forEach(t=>{this.setRowNodeDragging(t,!1)})}setRowNodeDragging(e,t){e.dragging!==t&&(e.dragging=t,e.dispatchRowEvent("draggingChanged"))}};function ote(e,t,n){if(n===0)return!1;const i=Math.abs(e.clientX-t.clientX),r=Math.abs(e.clientY-t.clientY);return Math.max(i,r)<=n}var h4e=class extends Z{constructor(){super(...arguments),this.beanName="dragSvc",this.dragEndFunctions=[],this.dragSources=[]}destroy(){const{dragSources:e}=this;e.forEach(this.removeListener.bind(this)),e.length=0,super.destroy()}removeListener(e){const t=e.dragSource.eElement,n=e.mouseDownListener;if(t.removeEventListener("mousedown",n),e.touchEnabled){const i=e.touchStartListener;t.removeEventListener("touchstart",i,{passive:!0})}}removeDragSource(e){const{dragSources:t}=this,n=t.find(i=>i.dragSource===e);n&&(this.removeListener(n),_o(t,n))}addDragSource(e){const t=this.onMouseDown.bind(this,e),{eElement:n,includeTouch:i,stopPropagationForTouch:r}=e;n.addEventListener("mousedown",t);let s=null;const o=this.gos.get("suppressTouch");i&&!o&&(s=a=>{oN(a.target)||(r&&a.stopPropagation(),this.onTouchStart(e,a))},n.addEventListener("touchstart",s,{passive:!1})),this.dragSources.push({dragSource:e,mouseDownListener:t,touchStartListener:s,touchEnabled:!!i})}onTouchStart(e,t){this.currentDragParams=e,this.dragging=!1;const n=t.touches[0];this.touchLastTime=n,this.touchStart=n;const i=l=>this.onTouchMove(l,e.eElement),r=l=>this.onTouchUp(l,e.eElement),s=l=>{l.cancelable&&l.preventDefault()},o=t.target,a=[{target:S0(this.beans),type:"touchmove",listener:s,options:{passive:!1}},{target:o,type:"touchmove",listener:i,options:{passive:!0}},{target:o,type:"touchend",listener:r,options:{passive:!0}},{target:o,type:"touchcancel",listener:r,options:{passive:!0}}];this.addTemporaryEvents(a),e.dragStartPixels===0&&this.onCommonMove(n,this.touchStart,e.eElement)}onMouseDown(e,t){const n=t;if(e.skipMouseEvent&&e.skipMouseEvent(t)||n._alreadyProcessedByDragService||(n._alreadyProcessedByDragService=!0,t.button!==0))return;this.shouldPreventMouseEvent(t)&&t.preventDefault(),this.currentDragParams=e,this.dragging=!1,this.mouseStartEvent=t,this.startTarget=t.target;const i=u=>this.onMouseMove(u,e.eElement),r=u=>this.onMouseUp(u,e.eElement),s=u=>u.preventDefault(),o=u=>{u.key===X.ESCAPE&&this.cancelDrag(e.eElement)},a=S0(this.beans),l=[{target:a,type:"mousemove",listener:i},{target:a,type:"mouseup",listener:r},{target:a,type:"contextmenu",listener:s},{target:a,type:"keydown",listener:o}];this.addTemporaryEvents(l),e.dragStartPixels===0&&this.onMouseMove(t,e.eElement)}addTemporaryEvents(e){e.forEach(t=>{const{target:n,type:i,listener:r,options:s}=t;n.addEventListener(i,r,s)}),this.dragEndFunctions.push(()=>{e.forEach(t=>{const{target:n,type:i,listener:r,options:s}=t;n.removeEventListener(i,r,s)})})}isEventNearStartEvent(e,t){const{dragStartPixels:n}=this.currentDragParams,i=Ce(n)?n:4;return ote(e,t,i)}getFirstActiveTouch(e){for(let t=0;t<e.length;t++)if(e[t].identifier===this.touchStart.identifier)return e[t];return null}onCommonMove(e,t,n){if(!this.dragging){if(this.isEventNearStartEvent(e,t))return;if(this.dragging=!0,this.eventSvc.dispatchEvent({type:"dragStarted",target:n}),this.currentDragParams.onDragStart(t),!this.currentDragParams){this.dragging=!1;return}this.currentDragParams.onDragging(t)}this.currentDragParams?.onDragging(e)}onTouchMove(e,t){const n=this.getFirstActiveTouch(e.touches);n&&this.onCommonMove(n,this.touchStart,t)}onMouseMove(e,t){Oh()&&Pn(this.beans).getSelection()?.removeAllRanges(),this.shouldPreventMouseEvent(e)&&e.preventDefault(),this.onCommonMove(e,this.mouseStartEvent,t)}shouldPreventMouseEvent(e){const{gos:t}=this,n=t.get("enableCellTextSelection"),i=e.type==="mousemove",r=s=>!!s.target?.tagName.toLocaleLowerCase()?.match("^a$|textarea|input|select|button");return n&&i&&e.cancelable&&D0(t,e)&&!r(e)}onTouchUp(e,t){let n=this.getFirstActiveTouch(e.changedTouches);n||(n=this.touchLastTime),this.onUpCommon(n,t)}onMouseUp(e,t){this.onUpCommon(e,t)}onUpCommon(e,t){this.dragging&&(this.dragging=!1,this.currentDragParams.onDragStop(e),this.eventSvc.dispatchEvent({type:"dragStopped",target:t})),this.resetDragProperties()}cancelDrag(e){this.eventSvc.dispatchEvent({type:"dragCancelled",target:e}),this.currentDragParams?.onDragCancel?.(),this.resetDragProperties()}resetDragProperties(){this.mouseStartEvent=null,this.startTarget=null,this.touchStart=null,this.touchLastTime=null,this.currentDragParams=null;const{dragEndFunctions:e}=this;e.forEach(t=>t()),e.length=0}};function ate(e,t){return e+"_"+t}function dn(e){return e instanceof lte}var lte=class extends Z{constructor(e,t,n,i){super(),this.providedColumnGroup=e,this.groupId=t,this.partId=n,this.pinned=i,this.isColumn=!1,this.displayedChildren=[],this.autoHeaderHeight=null,this.parent=null}reset(){this.parent=null,this.children=null,this.displayedChildren=null}getParent(){return this.parent}getUniqueId(){return ate(this.groupId,this.partId)}isEmptyGroup(){return this.displayedChildren.length===0}isMoving(){const e=this.getProvidedColumnGroup().getLeafColumns();return!e||e.length===0?!1:e.every(t=>t.isMoving())}checkLeft(){if(this.displayedChildren.forEach(e=>{dn(e)&&e.checkLeft()}),this.displayedChildren.length>0)if(this.gos.get("enableRtl")){const t=Lt(this.displayedChildren).getLeft();this.setLeft(t)}else{const e=this.displayedChildren[0].getLeft();this.setLeft(e)}else this.setLeft(null)}getLeft(){return this.left}getOldLeft(){return this.oldLeft}setLeft(e){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchLocalEvent({type:"leftChanged"}))}getPinned(){return this.pinned}getGroupId(){return this.groupId}getPartId(){return this.partId}getActualWidth(){let e=0;return this.displayedChildren?.forEach(t=>{e+=t.getActualWidth()}),e}isResizable(){if(!this.displayedChildren)return!1;let e=!1;return this.displayedChildren.forEach(t=>{t.isResizable()&&(e=!0)}),e}getMinWidth(){let e=0;return this.displayedChildren.forEach(t=>{e+=t.getMinWidth()}),e}addChild(e){this.children||(this.children=[]),this.children.push(e)}getDisplayedChildren(){return this.displayedChildren}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}getDisplayedLeafColumns(){const e=[];return this.addDisplayedLeafColumns(e),e}getDefinition(){return this.providedColumnGroup.getColGroupDef()}getColGroupDef(){return this.providedColumnGroup.getColGroupDef()}isPadding(){return this.providedColumnGroup.isPadding()}isExpandable(){return this.providedColumnGroup.isExpandable()}isExpanded(){return this.providedColumnGroup.isExpanded()}setExpanded(e){this.providedColumnGroup.setExpanded(e)}isAutoHeaderHeight(){return!!this.getColGroupDef()?.autoHeaderHeight}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){const t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}addDisplayedLeafColumns(e){this.displayedChildren.forEach(t=>{pc(t)?e.push(t):dn(t)&&t.addDisplayedLeafColumns(e)})}addLeafColumns(e){this.children.forEach(t=>{pc(t)?e.push(t):dn(t)&&t.addLeafColumns(e)})}getChildren(){return this.children}getColumnGroupShow(){return this.providedColumnGroup.getColumnGroupShow()}getProvidedColumnGroup(){return this.providedColumnGroup}getPaddingLevel(){const e=this.getParent();return!this.isPadding()||!e||!e.isPadding()?0:1+e.getPaddingLevel()}calculateDisplayedColumns(){this.displayedChildren=[];let e=this;for(;e!=null&&e.isPadding();)e=e.getParent();if(!(e?e.getProvidedColumnGroup().isExpandable():!1)){this.displayedChildren=this.children,this.dispatchLocalEvent({type:"displayedChildrenChanged"});return}this.children.forEach(n=>{if(dn(n)&&(!n.displayedChildren||!n.displayedChildren.length))return;switch(n.getColumnGroupShow()){case"open":e.getProvidedColumnGroup().isExpanded()&&this.displayedChildren.push(n);break;case"closed":e.getProvidedColumnGroup().isExpanded()||this.displayedChildren.push(n);break;default:this.displayedChildren.push(n);break}}),this.dispatchLocalEvent({type:"displayedChildrenChanged"})}},aT="row-group-",ute="t-",cte="b-",f4e=0,Vp=class{constructor(e){this.master=!1,this.detail=void 0,this.rowIndex=null,this.key=null,this.sourceRowIndex=-1,this.childrenMapped={},this.treeNode=null,this.treeNodeFlags=0,this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=f4e++,this.alreadyRendered=!1,this.highlighted=null,this.hovered=!1,this.__selected=!1,this.beans=e}setData(e){this.setDataCommon(e,!1)}updateData(e){this.setDataCommon(e,!0)}setDataCommon(e,t){const{valueCache:n,selectionSvc:i,eventSvc:r}=this.beans,s=this.data;this.data=e,n?.onDataChanged(),this.updateDataOnDetailNode(),i?.updateRowSelectable(this),this.resetQuickFilterAggregateText();const o=this.createDataChangedEvent(e,s,t);this.__localEventService?.dispatchEvent(o),r.dispatchEvent({type:"rowNodeDataChanged",node:this})}updateDataOnDetailNode(){this.detailNode&&(this.detailNode.data=this.data)}createDataChangedEvent(e,t,n){return{type:"dataChanged",node:this,oldData:t,newData:e,update:n}}getRowIndexString(){return this.rowIndex==null?(Ft(13),null):this.rowPinned==="top"?ute+this.rowIndex:this.rowPinned==="bottom"?cte+this.rowIndex:this.rowIndex.toString()}setDataAndId(e,t){const{selectionSvc:n}=this.beans,i=n?.createDaemonNode?.(this),r=this.data;this.data=e,this.updateDataOnDetailNode(),this.setId(t),n&&(n.updateRowSelectable(this),n.syncInRowNode(this,i));const s=this.createDataChangedEvent(e,r,!1);this.__localEventService?.dispatchEvent(s)}setId(e){const t=$p(this.beans.gos);if(t)if(this.data){const n=this.parent?.getRoute()??[];this.id=t({data:this.data,parentKeys:n.length>0?n:void 0,level:this.level,rowPinned:this.rowPinned}),this.id.startsWith(aT)&&Ft(14,{groupPrefix:aT})}else this.id=void 0;else this.id=e}setRowTop(e){this.oldRowTop=this.rowTop,this.rowTop!==e&&(this.rowTop=e,this.dispatchRowEvent("topChanged"),this.setDisplayed(e!==null))}clearRowTopAndRowIndex(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)}setHovered(e){this.hovered=e}isHovered(){return this.hovered}setRowHeight(e,t=!1){this.rowHeight=e,this.rowHeightEstimated=t,this.dispatchRowEvent("heightChanged")}setExpanded(e,t,n){this.beans.expansionSvc?.setExpanded(this,e,t,n)}setDataValue(e,t,n){const{colModel:i,valueSvc:r,gos:s,selectionSvc:o}=this.beans,a=typeof e!="string"?e:i.getCol(e)??i.getColDefCol(e);if(!a)return!1;const l=r.getValueForDisplay(a,this);if(s.get("readOnlyEdit")){const{beans:{eventSvc:c},data:d,rowIndex:h,rowPinned:p}=this;return c.dispatchEvent({type:"cellEditRequest",event:null,rowIndex:h,rowPinned:p,column:a,colDef:a.colDef,data:d,node:this,oldValue:l,newValue:t,value:t,source:n}),!1}const u=r.setValue(this,a,t,n);return this.dispatchCellChangedEvent(a,t,l),o?.updateRowSelectable(this),u}updateHasChildren(){let e=this.group&&!this.footer||this.childrenAfterGroup&&this.childrenAfterGroup.length>0;const{rowChildrenSvc:t}=this.beans;t&&(e=t.getHasChildrenValue(this)),e!==this.__hasChildren&&(this.__hasChildren=!!e,this.dispatchRowEvent("hasChildrenChanged"))}hasChildren(){return this.__hasChildren==null&&this.updateHasChildren(),this.__hasChildren}dispatchCellChangedEvent(e,t,n){const i={type:"cellChanged",node:this,column:e,newValue:t,oldValue:n};this.__localEventService?.dispatchEvent(i)}resetQuickFilterAggregateText(){this.quickFilterAggregateText=null}isExpandable(){return this.beans.expansionSvc?.isExpandable(this)??!1}isSelected(){return this.footer?this.sibling.isSelected():this.__selected}depthFirstSearch(e){this.childrenAfterGroup?.forEach(t=>t.depthFirstSearch(e)),e(this)}dispatchRowEvent(e){this.__localEventService?.dispatchEvent({type:e,node:this})}setSelected(e,t=!1,n="api"){this.beans.selectionSvc?.setNodesSelected({nodes:[this],newValue:e,clearSelection:t,source:n})}isRowPinned(){return!!this.rowPinned}__addEventListener(e,t){this.__localEventService||(this.__localEventService=new hh),this.__localEventService.addEventListener(e,t)}__removeEventListener(e,t){this.removeLocalListener(e,t)}addEventListener(e,t){this.beans.validation?.checkRowEvents(e),this.__localEventService||(this.__localEventService=new hh),this.frameworkEventListenerService=this.beans.frameworkOverrides.createLocalEventListenerWrapper?.(this.frameworkEventListenerService,this.__localEventService);const n=this.frameworkEventListenerService?.wrap(t)??t;this.__localEventService.addEventListener(e,n)}removeEventListener(e,t){const n=this.frameworkEventListenerService?.unwrap(t)??t;this.removeLocalListener(e,n)}removeLocalListener(e,t){this.__localEventService?.removeEventListener(e,t),this.__localEventService?.noRegisteredListenersExist()&&(this.__localEventService=null)}isFullWidthCell(){if(de(61),this.detail)return!0;const e=this.beans.gos.getCallback("isFullWidthRow");return e?e({rowNode:this}):!1}getRoute(){if(this.level===-1)return[];if(this.key==null)return;const e=[];let t=this;for(;t&&t.key!=null;)e.push(t.key),t=t.parent;return e.reverse()}setFirstChild(e){this.firstChild!==e&&(this.firstChild=e,this.dispatchRowEvent("firstChildChanged"))}setDisplayed(e){this.displayed!==e&&(this.displayed=e,this.dispatchRowEvent("displayedChanged"))}setRowIndex(e){this.rowIndex!==e&&(this.rowIndex=e,this.dispatchRowEvent("rowIndexChanged"))}setAllChildrenCount(e){this.allChildrenCount!==e&&(this.allChildrenCount=e,this.dispatchRowEvent("allChildrenCountChanged"))}setUiLevel(e){this.uiLevel!==e&&(this.uiLevel=e,this.dispatchRowEvent("uiLevelChanged"))}};function p4e(e,t,n){return ze(t,{type:n,node:e,data:e.data,rowIndex:e.rowIndex,rowPinned:e.rowPinned})}var g4e={tag:"div",cls:"ag-filter"},m4e=class extends At{constructor(e,t){super(g4e),this.column=e,this.source=t,this.filterWrapper=null}postConstruct(){this.createFilter(!0),this.addManagedEventListeners({filterDestroyed:this.onFilterDestroyed.bind(this)})}hasFilter(){return!!this.filterWrapper}getFilter(){return this.filterWrapper?.filterPromise??null}afterInit(){return this.filterWrapper?.filterPromise?.then(()=>{})??ir.resolve()}afterGuiAttached(e){this.filterWrapper?.filterPromise?.then(t=>{t?.afterGuiAttached?.(e)})}afterGuiDetached(){this.filterWrapper?.filterPromise?.then(e=>{e?.afterGuiDetached?.()})}createFilter(e){const{column:t,source:n}=this;this.filterWrapper=this.beans.filterManager?.getOrCreateFilterWrapper(t)??null,this.filterWrapper?.filterPromise&&this.filterWrapper.filterPromise.then(i=>{const r=i.getGui();Ce(r)||de(69,{guiFromFilter:r}),this.appendChild(r),e&&this.eventSvc.dispatchEvent({type:"filterOpened",column:t,source:n,eGui:this.getGui()})})}onFilterDestroyed(e){(e.source==="api"||e.source==="paramsUpdated")&&e.column.getId()===this.column.getId()&&this.beans.colModel.getColDefCol(this.column)&&(Gi(this.getGui()),this.createFilter())}destroy(){this.filterWrapper=null,super.destroy()}},dte="ag-resizer-wrapper",bu=(e,t)=>({tag:"div",ref:`${e}Resizer`,cls:`ag-resizer ag-resizer-${t}`}),v4e={tag:"div",cls:dte,children:[bu("eTopLeft","topLeft"),bu("eTop","top"),bu("eTopRight","topRight"),bu("eRight","right"),bu("eBottomRight","bottomRight"),bu("eBottom","bottom"),bu("eBottomLeft","bottomLeft"),bu("eLeft","left")]},C4e=class extends Z{constructor(e,t){super(),this.element=e,this.dragStartPosition={x:0,y:0},this.position={x:0,y:0},this.lastSize={width:-1,height:-1},this.positioned=!1,this.resizersAdded=!1,this.resizeListeners=[],this.boundaryEl=null,this.isResizing=!1,this.isMoving=!1,this.resizable={},this.movable=!1,this.currentResizer=null,this.config=Object.assign({},{popup:!1},t)}wireBeans(e){this.popupSvc=e.popupSvc,this.dragSvc=e.dragSvc}center(){const{clientHeight:e,clientWidth:t}=this.offsetParent,n=t/2-this.getWidth()/2,i=e/2-this.getHeight()/2;this.offsetElement(n,i)}initialisePosition(){if(this.positioned)return;const{centered:e,forcePopupParentAsOffsetParent:t,minWidth:n,width:i,minHeight:r,height:s,x:o,y:a}=this.config;this.offsetParent||this.setOffsetParent();let l=0,u=0;const c=Io(this.element);if(c){const d=this.findBoundaryElement(),h=window.getComputedStyle(d);if(h.minWidth!=null){const p=d.offsetWidth-this.element.offsetWidth;u=parseInt(h.minWidth,10)-p}if(h.minHeight!=null){const p=d.offsetHeight-this.element.offsetHeight;l=parseInt(h.minHeight,10)-p}}if(this.minHeight=r||l,this.minWidth=n||u,i&&this.setWidth(i),s&&this.setHeight(s),(!i||!s)&&this.refreshSize(),e)this.center();else if(o||a)this.offsetElement(o,a);else if(c&&t){let d=this.boundaryEl,h=!0;if(d||(d=this.findBoundaryElement(),h=!1),d){const p=parseFloat(d.style.top),g=parseFloat(d.style.left);h?this.offsetElement(isNaN(g)?0:g,isNaN(p)?0:p):this.setPosition(g,p)}}this.positioned=!!this.offsetParent}isPositioned(){return this.positioned}getPosition(){return this.position}setMovable(e,t){if(!this.config.popup||e===this.movable)return;this.movable=e;const n=this.moveElementDragListener||{eElement:t,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};e?(this.dragSvc?.addDragSource(n),this.moveElementDragListener=n):(this.dragSvc?.removeDragSource(n),this.moveElementDragListener=void 0)}setResizable(e){if(this.clearResizeListeners(),e?this.addResizers():this.removeResizers(),typeof e=="boolean"){if(e===!1)return;e={topLeft:e,top:e,topRight:e,right:e,bottomRight:e,bottom:e,bottomLeft:e,left:e}}Object.keys(e).forEach(t=>{const i=!!e[t],r=this.getResizerElement(t),s={dragStartPixels:0,eElement:r,onDragStart:o=>this.onResizeStart(o,t),onDragging:this.onResize.bind(this),onDragStop:o=>this.onResizeEnd(o,t)};(i||!this.isAlive()&&!i)&&(i?(this.dragSvc?.addDragSource(s),this.resizeListeners.push(s),r.style.pointerEvents="all"):r.style.pointerEvents="none",this.resizable[t]=i)})}removeSizeFromEl(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")}restoreLastSize(){this.element.style.flex="0 0 auto";const{height:e,width:t}=this.lastSize;t!==-1&&(this.element.style.width=`${t}px`),e!==-1&&(this.element.style.height=`${e}px`)}getHeight(){return this.element.offsetHeight}setHeight(e){const{popup:t}=this.config,n=this.element;let i=!1;if(typeof e=="string"&&e.indexOf("%")!==-1)Av(n,e),e=aee(n),i=!0;else if(e=Math.max(this.minHeight,e),this.positioned){const r=this.getAvailableHeight();r&&e>r&&(e=r)}this.getHeight()!==e&&(i?(n.style.maxHeight="unset",n.style.minHeight="unset"):t?Av(n,e):(n.style.height=`${e}px`,n.style.flex="0 0 auto",this.lastSize.height=typeof e=="number"?e:parseFloat(e)))}getAvailableHeight(){const{popup:e,forcePopupParentAsOffsetParent:t}=this.config;this.positioned||this.initialisePosition();const{clientHeight:n}=this.offsetParent;if(!n)return null;const i=this.element.getBoundingClientRect(),r=this.offsetParent.getBoundingClientRect(),s=e?this.position.y:i.top,o=e?0:r.top;let a=0;if(t){const u=this.element.parentElement;if(u){const{bottom:c}=u.getBoundingClientRect();a=c-i.bottom}}return n+o-s-a}getWidth(){return this.element.offsetWidth}setWidth(e){const t=this.element,{popup:n}=this.config;let i=!1;if(typeof e=="string"&&e.indexOf("%")!==-1)Ra(t,e),e=i1(t),i=!0;else if(this.positioned){e=Math.max(this.minWidth,e);const{clientWidth:r}=this.offsetParent,s=n?this.position.x:this.element.getBoundingClientRect().left;r&&e+s>r&&(e=r-s)}this.getWidth()!==e&&(i?(t.style.maxWidth="unset",t.style.minWidth="unset"):this.config.popup?Ra(t,e):(t.style.width=`${e}px`,t.style.flex=" unset",this.lastSize.width=typeof e=="number"?e:parseFloat(e)))}offsetElement(e=0,t=0){const{forcePopupParentAsOffsetParent:n}=this.config,i=n?this.boundaryEl:this.element;i&&(this.popupSvc?.positionPopup({ePopup:i,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:()=>({x:e,y:t})}),this.setPosition(parseFloat(i.style.left),parseFloat(i.style.top)))}constrainSizeToAvailableHeight(e){if(!this.config.forcePopupParentAsOffsetParent)return;const t=()=>{const n=this.getAvailableHeight();this.element.style.setProperty("max-height",`${n}px`)};e&&this.popupSvc?this.resizeObserverSubscriber=_c(this.beans,this.popupSvc?.getPopupParent(),t):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}setPosition(e,t){this.position.x=e,this.position.y=t}updateDragStartPosition(e,t){this.dragStartPosition={x:e,y:t}}calculateMouseMovement(e){const{e:t,isLeft:n,isTop:i,anywhereWithin:r,topBuffer:s}=e,o=t.clientX-this.dragStartPosition.x,a=t.clientY-this.dragStartPosition.y,l=this.shouldSkipX(t,!!n,!!r,o)?0:o,u=this.shouldSkipY(t,!!i,s,a)?0:a;return{movementX:l,movementY:u}}shouldSkipX(e,t,n,i){const r=this.element.getBoundingClientRect(),s=this.offsetParent.getBoundingClientRect(),o=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.x:r.left;let l=a<=0&&s.left>=e.clientX||s.right<=e.clientX&&s.right<=o.right;return l?!0:(t?l=i<0&&e.clientX>a+s.left||i>0&&e.clientX<a+s.left:n?l=i<0&&e.clientX>o.right||i>0&&e.clientX<a+s.left:l=i<0&&e.clientX>o.right||i>0&&e.clientX<o.right,l)}shouldSkipY(e,t,n=0,i){const r=this.element.getBoundingClientRect(),s=this.offsetParent.getBoundingClientRect(),o=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.y:r.top;let l=a<=0&&s.top>=e.clientY||s.bottom<=e.clientY&&s.bottom<=o.bottom;return l?!0:(t?l=i<0&&e.clientY>a+s.top+n||i>0&&e.clientY<a+s.top:l=i<0&&e.clientY>o.bottom||i>0&&e.clientY<o.bottom,l)}createResizeMap(){const e=t=>({element:this.element.querySelector(`[data-ref=${t}Resizer]`)});this.resizerMap={topLeft:e("eTopLeft"),top:e("eTop"),topRight:e("eTopRight"),right:e("eRight"),bottomRight:e("eBottomRight"),bottom:e("eBottom"),bottomLeft:e("eBottomLeft"),left:e("eLeft")}}addResizers(){if(this.resizersAdded)return;const e=this.element;e&&(e.appendChild(Sn(v4e)),this.createResizeMap(),this.resizersAdded=!0)}removeResizers(){this.resizerMap=void 0;const e=this.element.querySelector(`.${dte}`);e&&this.element.removeChild(e),this.resizersAdded=!1}getResizerElement(e){return this.resizerMap[e].element}onResizeStart(e,t){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!t.match(/top/i),isRight:!!t.match(/right/i),isBottom:!!t.match(/bottom/i),isLeft:!!t.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[t].element.classList.add("ag-active");const{popup:n,forcePopupParentAsOffsetParent:i}=this.config;!n&&!i&&this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(e.clientX,e.clientY)}getSiblings(){const t=this.element.parentElement;return t?Array.prototype.slice.call(t.children).filter(n=>!n.classList.contains("ag-hidden")):null}getMinSizeOfSiblings(){const e=this.getSiblings()||[];let t=0,n=0;for(let i=0;i<e.length;i++){const r=e[i],s=!!r.style.flex&&r.style.flex!=="0 0 auto";if(r===this.element)continue;let o=this.minHeight||0,a=this.minWidth||0;if(s){const l=window.getComputedStyle(r);l.minHeight&&(o=parseInt(l.minHeight,10)),l.minWidth&&(a=parseInt(l.minWidth,10))}else o=r.offsetHeight,a=r.offsetWidth;t+=o,n+=a}return{height:t,width:n}}applySizeToSiblings(e){let t=null;const n=this.getSiblings();if(n){for(let i=0;i<n.length;i++){const r=n[i];r!==t&&(e?r.style.height=`${r.offsetHeight}px`:r.style.width=`${r.offsetWidth}px`,r.style.flex="0 0 auto",r===this.element&&(t=n[i+1]))}t&&(t.style.removeProperty("height"),t.style.removeProperty("min-height"),t.style.removeProperty("max-height"),t.style.flex="1 1 auto")}}isResizable(){return Object.values(this.resizable).some(e=>e)}onResize(e){if(!this.isResizing||!this.currentResizer)return;const{popup:t,forcePopupParentAsOffsetParent:n}=this.config,{isTop:i,isRight:r,isBottom:s,isLeft:o}=this.currentResizer,a=r||o,l=s||i,{movementX:u,movementY:c}=this.calculateMouseMovement({e,isLeft:o,isTop:i}),d=this.position.x,h=this.position.y;let p=0,g=0;if(a&&u){const m=o?-1:1,C=this.getWidth(),y=C+u*m;let b=!1;o&&(p=C-y,(d+p<=0||y<=this.minWidth)&&(b=!0,p=0)),b||this.setWidth(y)}if(l&&c){const m=i?-1:1,C=this.getHeight(),y=C+c*m;let b=!1;i?(g=C-y,(h+g<=0||y<=this.minHeight)&&(b=!0,g=0)):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&C<y&&this.getMinSizeOfSiblings().height+y>this.element.parentElement.offsetHeight&&(b=!0),b||this.setHeight(y)}this.updateDragStartPosition(e.clientX,e.clientY),((t||n)&&p||g)&&this.offsetElement(d+p,h+g)}onResizeEnd(e,t){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null,this.element.classList.remove("ag-resizing"),this.resizerMap[t].element.classList.remove("ag-active"),this.dispatchLocalEvent({type:"resize"})}refreshSize(){const e=this.element;this.config.popup&&(this.config.width||this.setWidth(e.offsetWidth),this.config.height||this.setHeight(e.offsetHeight))}onMoveStart(e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(e.clientX,e.clientY)}onMove(e){if(!this.isMoving)return;const{x:t,y:n}=this.position;let i;this.config.calculateTopBuffer&&(i=this.config.calculateTopBuffer());const{movementX:r,movementY:s}=this.calculateMouseMovement({e,isTop:!0,anywhereWithin:!0,topBuffer:i});this.offsetElement(t+r,n+s),this.updateDragStartPosition(e.clientX,e.clientY)}onMoveEnd(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")}setOffsetParent(){this.config.forcePopupParentAsOffsetParent&&this.popupSvc?this.offsetParent=this.popupSvc.getPopupParent():this.offsetParent=this.element.offsetParent}findBoundaryElement(){let e=this.element;for(;e;){if(window.getComputedStyle(e).position!=="static")return e;e=e.parentElement}return this.element}clearResizeListeners(){for(;this.resizeListeners.length;){const e=this.resizeListeners.pop();this.dragSvc?.removeDragSource(e)}}destroy(){super.destroy(),this.moveElementDragListener&&this.dragSvc?.removeDragSource(this.moveElementDragListener),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()}},y4e="ag-focus-managed",Sg=class extends Z{constructor(e,t={}){super(),this.eFocusable=e,this.callbacks=t,this.callbacks={shouldStopEventPropagation:()=>!1,onTabKeyDown:n=>{if(n.defaultPrevented)return;const i=$h(this.beans,this.eFocusable,!1,n.shiftKey);i&&(i.focus(),n.preventDefault())},...t}}postConstruct(){const{eFocusable:e,callbacks:{onFocusIn:t,onFocusOut:n}}=this;e.classList.add(y4e),this.addKeyDownListeners(e),t&&this.addManagedElementListeners(e,{focusin:t}),n&&this.addManagedElementListeners(e,{focusout:n})}addKeyDownListeners(e){this.addManagedElementListeners(e,{keydown:t=>{if(t.defaultPrevented||_l(t))return;const{callbacks:n}=this;if(n.shouldStopEventPropagation(t)){Bp(t);return}t.key===X.TAB?n.onTabKeyDown(t):n.handleKeyDown&&n.handleKeyDown(t)}})}},hte={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose one",equals:"Equals",notEqual:"Does not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"Between",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equal to",greaterThanOrEqual:"Greater than or equal to",contains:"Contains",notContains:"Does not contain",startsWith:"Begins with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",before:"Before",after:"After",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd"};function CN(e,t){const{debounceMs:n}=e;return y1(e)?(n!=null&&de(71),0):n??t}function y1(e){return(e.buttons?.indexOf("apply")??-1)>=0}var w4e=class extends At{constructor(e){super(),this.filterNameKey=e,this.applyActive=!1,this.hidePopup=null,this.debouncePending=!1,this.appliedModel=null,this.eFilterBody=ve,this.buttonListeners=[],this.defaultDebounceMs=0}postConstruct(){this.resetTemplate(),this.createManagedBean(new Sg(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=new C4e(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}),this.createBean(this.positionableFeature)}handleKeyDown(e){}getFilterTitle(){return this.translate(this.filterNameKey)}isFilterActive(){return!!this.appliedModel}resetTemplate(e){let t=this.getGui();t?.removeEventListener("submit",this.onFormSubmit);const n={tag:"form",cls:"ag-filter-wrapper",children:[{tag:"div",ref:"eFilterBody",cls:`ag-filter-body-wrapper ag-${this.getCssIdentifier()}-body-wrapper`,children:[this.createBodyTemplate()]}]};this.setTemplate(n,this.getAgComponents(),e),t=this.getGui(),t?.addEventListener("submit",this.onFormSubmit)}isReadOnly(){return!!this.params.readOnly}init(e){this.setParams(e),this.resetUiToDefaults(!0).then(()=>{this.updateUiVisibility(),this.setupOnBtApplyDebounce()})}setParams(e){this.params=e,this.applyActive=y1(e),this.resetButtonsPanel(e)}updateParams(e){this.params=e,this.applyActive=y1(e),this.resetUiToActiveModel(this.getModel(),()=>{this.updateUiVisibility(),this.setupOnBtApplyDebounce()})}resetButtonsPanel(e,t){const{buttons:n,readOnly:i}=t??{},{buttons:r,readOnly:s}=e;if(i===s&&b0(n,r))return;const o=r&&r.length>0&&!this.isReadOnly();if(this.eButtonsPanel?(Gi(this.eButtonsPanel),this.buttonListeners.forEach(u=>u()),this.buttonListeners=[]):o&&(this.eButtonsPanel=Sn({tag:"div",cls:"ag-filter-apply-panel"})),!o){this.eButtonsPanel&&_s(this.eButtonsPanel);return}const a=document.createDocumentFragment(),l=u=>{let c;const d=u?this.translate(`${u}Filter`):void 0;switch(u){case"apply":c=g=>this.onBtApply(!1,!1,g);break;case"clear":c=()=>this.onBtClear();break;case"reset":c=()=>this.onBtReset();break;case"cancel":c=g=>{this.onBtCancel(g)};break;default:de(75);return}const p=UR(`<button
                    type="${u==="apply"?"submit":"button"}"
                    data-ref="${u}FilterButton"
                    class="ag-button ag-standard-button ag-filter-apply-panel-button"
                >${d}
                </button>`);this.buttonListeners.push(...this.addManagedElementListeners(p,{click:c})),a.append(p)};r.forEach(u=>l(u)),this.eButtonsPanel.append(a),this.getGui().appendChild(this.eButtonsPanel)}setupOnBtApplyDebounce(){const e=CN(this.params,this.defaultDebounceMs),t=yi(this,this.checkApplyDebounce.bind(this),e);this.onBtApplyDebounce=()=>{this.debouncePending=!0,t()}}checkApplyDebounce(){this.debouncePending&&(this.debouncePending=!1,this.onBtApply())}getModel(){return this.appliedModel??null}setModel(e){return(e!=null?this.setModelIntoUi(e):this.resetUiToDefaults()).then(()=>{this.updateUiVisibility(),this.applyModel("api")})}onBtCancel(e){this.resetUiToActiveModel(this.getModel(),()=>{this.handleCancelEnd(e)})}handleCancelEnd(e){this.params.closeOnApply&&this.close(e)}resetUiToActiveModel(e,t){const n=()=>{this.onUiChanged(!1,"prevent"),t?.()};e!=null?this.setModelIntoUi(e).then(n):this.resetUiToDefaults().then(n)}onBtClear(){this.resetUiToDefaults().then(()=>this.onUiChanged())}onBtReset(){this.onBtClear(),this.onBtApply()}applyModel(e="api"){const t=this.getModelFromUi();if(!this.isModelValid(t))return!1;const n=this.appliedModel;return this.appliedModel=t,!this.areModelsEqual(n,t)}isModelValid(e){return!0}onFormSubmit(e){e.preventDefault()}onBtApply(e=!1,t=!1,n){n&&n.preventDefault(),this.applyModel(t?"rowDataUpdated":"ui")&&this.params.filterChangedCallback({afterFloatingFilter:e,afterDataChange:t,source:"columnFilter"});const{closeOnApply:i}=this.params;i&&this.applyActive&&!e&&!t&&this.close(n)}onNewRowsLoaded(){}close(e){if(!this.hidePopup)return;const t=e,n=t&&t.key;let i;(n==="Enter"||n==="Space")&&(i={keyboardEvent:t}),this.hidePopup(i),this.hidePopup=null}onUiChanged(e=!1,t){if(this.updateUiVisibility(),this.params.filterModifiedCallback(),this.applyActive&&!this.isReadOnly()){const n=this.isModelValid(this.getModelFromUi()),i=this.queryForHtmlElement('[data-ref="applyFilterButton"]');i&&y0(i,!n)}e&&!t||t==="immediately"?this.onBtApply(e):(!this.applyActive&&!t||t==="debounce")&&this.onBtApplyDebounce()}afterGuiAttached(e){e&&(this.hidePopup=e.hidePopup),this.refreshFilterResizer(e?.container)}refreshFilterResizer(e){const{positionableFeature:t,gos:n}=this;if(!t||e==="toolPanel")return;e==="floatingFilter"||e==="columnFilter"?(t.restoreLastSize(),t.setResizable(n.get("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(t.removeSizeFromEl(),t.setResizable(!1)),t.constrainSizeToAvailableHeight(!0)}afterGuiDetached(){this.checkApplyDebounce(),this.positionableFeature?.constrainSizeToAvailableHeight(!1)}refresh(e){const t=this.params;return this.params=e,this.resetButtonsPanel(e,t),!0}destroy(){const e=this.getGui();e&&e.removeEventListener("submit",this.onFormSubmit),this.hidePopup=null,this.positionableFeature&&(this.positionableFeature=this.destroyBean(this.positionableFeature)),this.appliedModel=null,super.destroy()}translate(e){return this.getLocaleTextFunc()(e,hte[e])}getCellValue(e){return this.params.getValue(e)}getPositionableElement(){return this.eFilterBody}};function b4e(e,t,n){if(t==null)return null;let i=null;const{compName:r,jsComp:s,fwComp:o}=SWe(e,t);return r?i={agSetColumnFilter:"agSetColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"}[r]:s==null&&o==null&&t.filter===!0&&(i=n()),i}var po={AUTO_HEIGHT:"ag-layout-auto-height",NORMAL:"ag-layout-normal",PRINT:"ag-layout-print"},yN=class extends Z{constructor(e){super(),this.view=e}postConstruct(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()}updateLayoutClasses(){const e=this.gos.get("domLayout"),t={autoHeight:e==="autoHeight",normal:e==="normal",print:e==="print"},n=t.autoHeight?po.AUTO_HEIGHT:t.print?po.PRINT:po.NORMAL;this.view.updateLayoutClasses(n,t)}},Su="Viewport",xW="fakeVScrollComp",RW=["fakeHScrollComp","centerHeader","topCenter","bottomCenter","stickyTopCenter","stickyBottomCenter"],EW=100,WD=150,S4e=class extends Z{constructor(e){super(),this.lastScrollSource=[null,null],this.scrollLeft=-1,this.nextScrollTop=-1,this.scrollTop=-1,this.lastOffsetHeight=-1,this.lastScrollTop=-1,this.lastIsHorizontalScrollShowing=!1,this.scrollTimer=0,this.isVerticalPositionInvalidated=!0,this.isHorizontalPositionInvalidated=!0,this.eBodyViewport=e,this.resetLastHScrollDebounced=yi(this,()=>this.lastScrollSource[1]=null,WD),this.resetLastVScrollDebounced=yi(this,()=>this.lastScrollSource[0]=null,WD)}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.animationFrameSvc=e.animationFrameSvc,this.visibleCols=e.visibleCols}destroy(){super.destroy(),window.clearTimeout(this.scrollTimer)}postConstruct(){this.enableRtl=this.gos.get("enableRtl");const e=this.invalidateVerticalScroll.bind(this),t=this.invalidateHorizontalScroll.bind(this);this.addManagedEventListeners({displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this),gridSizeChanged:e,scrollGapChanged:t}),this.addManagedElementListeners(this.eBodyViewport,{scroll:e}),this.ctrlsSvc.whenReady(this,n=>{this.centerRowsCtrl=n.center,this.onDisplayedColumnsWidthChanged(),this.addScrollListener()})}invalidateHorizontalScroll(){this.isHorizontalPositionInvalidated=!0}invalidateVerticalScroll(){this.isVerticalPositionInvalidated=!0}addScrollListener(){this.addHorizontalScrollListeners(),this.addVerticalScrollListeners()}addHorizontalScrollListeners(){this.addManagedElementListeners(this.centerRowsCtrl.eViewport,{scroll:this.onHScroll.bind(this,Su)});for(const e of RW){const t=this.ctrlsSvc.get(e);this.registerScrollPartner(t,this.onHScroll.bind(this,e))}}addVerticalScrollListeners(){const e=this.ctrlsSvc.get("fakeVScrollComp"),t=this.gos.get("debounceVerticalScrollbar"),n=t?yi(this,this.onVScroll.bind(this,Su),EW):this.onVScroll.bind(this,Su),i=t?yi(this,this.onVScroll.bind(this,xW),EW):this.onVScroll.bind(this,xW);this.addManagedElementListeners(this.eBodyViewport,{scroll:n}),this.registerScrollPartner(e,i)}registerScrollPartner(e,t){e.onScrollCallback(t)}onDisplayedColumnsWidthChanged(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()}horizontallyScrollHeaderCenterAndFloatingCenter(e){this.centerRowsCtrl!=null&&(e===void 0&&(e=this.centerRowsCtrl.getCenterViewportScrollLeft()),this.setScrollLeftForAllContainersExceptCurrent(Math.abs(e)))}setScrollLeftForAllContainersExceptCurrent(e){for(const t of[...RW,Su]){if(this.lastScrollSource[1]===t)continue;const n=this.getViewportForSource(t);s1(n,e,this.enableRtl)}}getViewportForSource(e){return e===Su?this.centerRowsCtrl.eViewport:this.ctrlsSvc.get(e).eViewport}isControllingScroll(e,t){return this.lastScrollSource[t]==null?(t===0?this.lastScrollSource[0]=e:this.lastScrollSource[1]=e,!0):this.lastScrollSource[t]===e}onHScroll(e){if(!this.isControllingScroll(e,1))return;const t=this.centerRowsCtrl.eViewport,{scrollLeft:n}=t;if(this.shouldBlockScrollUpdate(1,n,!0))return;const i=r1(this.getViewportForSource(e),this.enableRtl);this.doHorizontalScroll(i),this.resetLastHScrollDebounced()}onVScroll(e){if(!this.isControllingScroll(e,0))return;let t;if(e===Su?t=this.eBodyViewport.scrollTop:t=this.ctrlsSvc.get("fakeVScrollComp").getScrollPosition(),this.shouldBlockScrollUpdate(0,t,!0))return;const{animationFrameSvc:n}=this;n?.setScrollTop(t),this.nextScrollTop=t,e===Su?this.ctrlsSvc.get("fakeVScrollComp").setScrollPosition(t):this.eBodyViewport.scrollTop=t,n?.active?n.schedule():this.scrollGridIfNeeded(!0),this.resetLastVScrollDebounced()}doHorizontalScroll(e){const t=this.ctrlsSvc.get("fakeHScrollComp").getScrollPosition();this.scrollLeft===e&&e===t||(this.scrollLeft=e,this.fireScrollEvent(1),this.horizontallyScrollHeaderCenterAndFloatingCenter(e),this.centerRowsCtrl.onHorizontalViewportChanged(!0))}fireScrollEvent(e){const t={type:"bodyScroll",direction:e===1?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.eventSvc.dispatchEvent(t),window.clearTimeout(this.scrollTimer),this.scrollTimer=window.setTimeout(()=>{this.scrollTimer=0,this.eventSvc.dispatchEvent({...t,type:"bodyScrollEnd"})},WD)}shouldBlockScrollUpdate(e,t,n=!1){return n&&!Nd()?!1:e===0?this.shouldBlockVerticalScroll(t):this.shouldBlockHorizontalScroll(t)}shouldBlockVerticalScroll(e){const t=aN(this.eBodyViewport),{scrollHeight:n}=this.eBodyViewport;return e<0||e+t>n}shouldBlockHorizontalScroll(e){const t=this.centerRowsCtrl.getCenterWidth(),{scrollWidth:n}=this.centerRowsCtrl.eViewport;if(this.enableRtl){if(e>0)return!0}else if(e<0)return!0;return Math.abs(e)+t>n}redrawRowsAfterScroll(){this.fireScrollEvent(0)}checkScrollLeft(){this.scrollLeft!==this.centerRowsCtrl.getCenterViewportScrollLeft()&&this.onHScroll(Su)}scrollGridIfNeeded(e=!1){const t=this.scrollTop!=this.nextScrollTop;return t&&(this.scrollTop=this.nextScrollTop,e&&this.invalidateVerticalScroll(),this.redrawRowsAfterScroll()),t}setHorizontalScrollPosition(e,t=!1){const i=this.centerRowsCtrl.eViewport.scrollWidth-this.centerRowsCtrl.getCenterWidth();!t&&this.shouldBlockScrollUpdate(1,e)&&(this.enableRtl?e=e>0?0:i:e=Math.min(Math.max(e,0),i)),s1(this.centerRowsCtrl.eViewport,Math.abs(e),this.enableRtl),this.doHorizontalScroll(e)}setVerticalScrollPosition(e){this.invalidateVerticalScroll(),this.eBodyViewport.scrollTop=e}getVScrollPosition(){if(!this.isVerticalPositionInvalidated){const{lastOffsetHeight:n,lastScrollTop:i}=this;return{top:i,bottom:i+n}}this.isVerticalPositionInvalidated=!1;const{scrollTop:e,offsetHeight:t}=this.eBodyViewport;return this.lastScrollTop=e,this.lastOffsetHeight=t,{top:e,bottom:e+t}}getApproximateVScollPosition(){return this.lastScrollTop>=0&&this.lastOffsetHeight>=0?{top:this.scrollTop,bottom:this.scrollTop+this.lastOffsetHeight}:this.getVScrollPosition()}getHScrollPosition(){return this.centerRowsCtrl.getHScrollPosition()}isHorizontalScrollShowing(){return this.isHorizontalPositionInvalidated&&(this.lastIsHorizontalScrollShowing=this.centerRowsCtrl.isHorizontalScrollShowing(),this.isHorizontalPositionInvalidated=!1),this.lastIsHorizontalScrollShowing}scrollHorizontally(e){const t=this.centerRowsCtrl.eViewport.scrollLeft;return this.setHorizontalScrollPosition(t+e),this.centerRowsCtrl.eViewport.scrollLeft-t}scrollToTop(){this.eBodyViewport.scrollTop=0}ensureNodeVisible(e,t=null){const{rowModel:n}=this.beans,i=n.getRowCount();let r=-1;for(let s=0;s<i;s++){const o=n.getRow(s);if(typeof e=="function"){if(o&&e(o)){r=s;break}}else if(e===o||e===o.data){r=s;break}}r>=0&&this.ensureIndexVisible(r,t)}ensureIndexVisible(e,t){if(Si(this.gos,"print"))return;const{rowModel:n}=this.beans,i=n.getRowCount();if(typeof e!="number"||e<0||e>=i){de(88,{index:e});return}const{frameworkOverrides:r,pageBounds:s,rowContainerHeight:o,rowRenderer:a}=this.beans;r.wrapIncoming(()=>{const l=this.ctrlsSvc.getGridBodyCtrl(),u=n.getRow(e);let c,d,h=0;this.invalidateVerticalScroll();do{const{stickyTopHeight:p,stickyBottomHeight:g}=l,m=u.rowTop,C=u.rowHeight,y=s.getPixelOffset(),b=u.rowTop-y,S=b+u.rowHeight,x=this.getVScrollPosition(),E=o.divStretchOffset,A=x.top+E,F=x.bottom+E,P=F-A,D=o.getScrollPositionForPixel(b),M=o.getScrollPositionForPixel(S-P),O=Math.min((D+M)/2,b),B=A+p>b,H=F-g<S;let N=null;t==="top"?N=D-p:t==="bottom"?N=M+g:t==="middle"?N=O:B?N=D-p:H&&(N=M+g),N!==null&&(this.setVerticalScrollPosition(N),a.redraw({afterScroll:!0})),c=m!==u.rowTop||C!==u.rowHeight,d=p!==l.stickyTopHeight||g!==l.stickyBottomHeight,h++}while((c||d)&&h<10);this.animationFrameSvc?.flushAllFrames()})}ensureColumnVisible(e,t="auto"){const{colModel:n,frameworkOverrides:i}=this.beans,r=n.getCol(e);if(!r||r.isPinned()||!this.visibleCols.isColDisplayed(r))return;const s=this.getPositionedHorizontalScroll(r,t);i.wrapIncoming(()=>{s!==null&&this.centerRowsCtrl.setCenterViewportScrollLeft(s),this.centerRowsCtrl.onHorizontalViewportChanged(),this.animationFrameSvc?.flushAllFrames()})}getPositionedHorizontalScroll(e,t){const{columnBeforeStart:n,columnAfterEnd:i}=this.isColumnOutsideViewport(e),r=this.centerRowsCtrl.getCenterWidth()<e.getActualWidth(),s=this.centerRowsCtrl.getCenterWidth(),o=this.enableRtl;let a=(o?n:i)||r,l=o?i:n;t!=="auto"&&(a=t==="start",l=t==="end");const u=t==="middle";if(a||l||u){const{colLeft:c,colMiddle:d,colRight:h}=this.getColumnBounds(e);return u?d-s/2:a?o?h:c:o?c-s:h-s}return null}isColumnOutsideViewport(e){const{start:t,end:n}=this.getViewportBounds(),{colLeft:i,colRight:r}=this.getColumnBounds(e),s=this.enableRtl,o=s?t>r:n<r,a=s?n<i:t>i;return{columnBeforeStart:o,columnAfterEnd:a}}getColumnBounds(e){const t=this.enableRtl,n=this.visibleCols.bodyWidth,i=e.getActualWidth(),r=e.getLeft(),s=t?-1:1,o=t?n-r:r,a=o+i*s,l=o+i/2*s;return{colLeft:o,colMiddle:l,colRight:a}}getViewportBounds(){const e=this.centerRowsCtrl.getCenterWidth(),t=this.centerRowsCtrl.getCenterViewportScrollLeft(),n=t,i=e+t;return{start:n,end:i,width:e}}},wN=class extends Z{constructor(e,t=!1){super(),this.callback=e,this.addSpacer=t}postConstruct(){const e=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",e),this.addManagedEventListeners({columnContainerWidthChanged:e,displayedColumnsChanged:e,leftPinnedWidthChanged:e}),this.addSpacer&&this.addManagedEventListeners({rightPinnedWidthChanged:e,scrollVisibilityChanged:e,scrollbarWidthChanged:e}),this.setWidth()}setWidth(){const e=Si(this.gos,"print"),{visibleCols:t,scrollVisibleSvc:n}=this.beans,i=t.bodyWidth,r=t.getColsLeftWidth(),s=t.getDisplayedColumnsRightWidth();let o;e?o=i+r+s:(o=i,this.addSpacer&&(this.gos.get("enableRtl")?r:s)===0&&n.verticalScrollShowing&&(o+=n.getScrollbarWidth())),this.callback(o)}},x4e=class extends Z{constructor(e){super(),this.centerContainerCtrl=e}wireBeans(e){this.scrollVisibleSvc=e.scrollVisibleSvc}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.listenForResize()}),this.addManagedEventListeners({scrollbarWidthChanged:this.onScrollbarWidthChanged.bind(this)}),this.addManagedPropertyListeners(["alwaysShowHorizontalScroll","alwaysShowVerticalScroll"],()=>{this.checkViewportAndScrolls()})}listenForResize(){const{beans:e,centerContainerCtrl:t,gridBodyCtrl:n}=this,i=()=>{lu(e,()=>{this.onCenterViewportResized()})};t.registerViewportResizeListener(i),n.registerBodyViewportResizeListener(i)}onScrollbarWidthChanged(){this.checkViewportAndScrolls()}onCenterViewportResized(){if(this.scrollVisibleSvc.updateScrollGap(),this.centerContainerCtrl.isViewportInTheDOMTree()){const{pinnedCols:e,colFlex:t}=this.beans;e?.keepPinnedColumnsNarrowerThanViewport(),this.checkViewportAndScrolls();const n=this.centerContainerCtrl.getCenterWidth();n!==this.centerWidth&&(this.centerWidth=n,t?.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0}checkViewportAndScrolls(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.scrollFeature.checkScrollLeft()}getBodyHeight(){return this.bodyHeight}checkBodyHeight(){const e=this.gridBodyCtrl.eBodyViewport,t=aN(e);this.bodyHeight!==t&&(this.bodyHeight=t,this.eventSvc.dispatchEvent({type:"bodyHeightChanged"}))}updateScrollVisibleService(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)}updateScrollVisibleServiceImpl(){const e={horizontalScrollShowing:this.centerContainerCtrl.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleSvc.setScrollsVisible(e)}onHorizontalViewportChanged(){const e=this.centerContainerCtrl.getCenterWidth(),t=this.centerContainerCtrl.getViewportScrollLeft();this.beans.colViewport.setScrollPosition(e,t)}};function bN(e,t,n,i,r,s){if(n==null&&t==null)return;const o={},a={},l=(u,c)=>{u.split(" ").forEach(d=>{d.trim()!=""&&c(d)})};if(n){const u=Object.keys(n);for(let c=0;c<u.length;c++){const d=u[c],h=n[d];let p;typeof h=="string"?p=e?e.evaluate(h,i):!0:typeof h=="function"&&(p=h(i)),l(d,g=>{p?o[g]=!0:a[g]=!0})}}t&&s&&Object.keys(t).forEach(u=>l(u,c=>{o[c]||(a[c]=!0)})),s&&Object.keys(a).forEach(s),Object.keys(o).forEach(r)}function FW(e){if(e.group)return e.level;const t=e.parent;return t?t.level+1:0}var R4e=class extends Z{constructor(){super(...arguments),this.beanName="rowStyleSvc"}processClassesFromGridOptions(e,t){const n=this.gos,i=o=>{typeof o=="string"?e.push(o):Array.isArray(o)&&o.forEach(a=>e.push(a))},r=n.get("rowClass");r&&i(r);const s=n.getCallback("getRowClass");if(s){const o={data:t.data,node:t,rowIndex:t.rowIndex},a=s(o);i(a)}}preProcessRowClassRules(e,t){this.processRowClassRules(t,n=>{e.push(n)},()=>{})}processRowClassRules(e,t,n){const{gos:i,expressionSvc:r}=this.beans,s=ze(i,{data:e.data,node:e,rowIndex:e.rowIndex});bN(r,void 0,i.get("rowClassRules"),s,t,n)}processStylesFromGridOptions(e){const t=this.gos,n=t.get("rowStyle"),i=t.getCallback("getRowStyle");let r;if(i){const s={data:e.data,node:e,rowIndex:e.rowIndex};r=i(s)}if(r||n)return Object.assign({},n,r)}},E4e=0,w1="renderedRow",b1=class extends Z{constructor(e,t,n,i,r){super(),this.rowNode=e,this.useAnimationFrameForCreate=i,this.printLayout=r,this.allRowGuis=[],this.active=!0,this.centerCellCtrls={list:[],map:{}},this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}},this.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.rowDragComps=[],this.lastMouseDownOnDragger=!1,this.emptyStyle={},this.updateColumnListsPending=!1,this.rowId=null,this.businessKey=null,this.beans=t,this.gos=t.gos,this.paginationPage=t.pagination?.getCurrentPage()??0,this.suppressRowTransform=this.gos.get("suppressRowTransform"),this.instanceId=e.id+"-"+E4e++,this.rowId=Ol(e.id),this.initRowBusinessKey(),this.rowFocused=t.focusSvc.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned),this.rowLevel=FW(this.rowNode),this.setRowType(),this.setAnimateFlags(n),this.rowStyles=this.processStylesFromGridOptions(),this.addListeners()}initRowBusinessKey(){this.businessKeyForNodeFunc=this.gos.get("getBusinessKeyForNode"),this.updateRowBusinessKey()}updateRowBusinessKey(){if(typeof this.businessKeyForNodeFunc!="function")return;const e=this.businessKeyForNodeFunc(this.rowNode);this.businessKey=Ol(e)}updateGui(e,t){e==="left"?this.leftGui=t:e==="right"?this.rightGui=t:e==="fullWidth"?this.fullWidthGui=t:this.centerGui=t}setComp(e,t,n,i){const{context:r,focusSvc:s}=this.beans;i=OC(this,r,i);const o={rowComp:e,element:t,containerType:n,compBean:i};this.allRowGuis.push(o),this.updateGui(n,o),this.initialiseRowComp(o);const a=this.rowNode,l=this.rowType==="FullWidthLoading"||a.stub,u=!a.data&&this.beans.rowModel.getType()==="infinite";!l&&!u&&!a.rowPinned&&this.beans.rowRenderer.dispatchFirstDataRenderedEvent();const c=this.fullWidthGui?.element;c&&!this.editing&&s.isRowFocused(a.rowIndex,a.rowPinned)&&s.shouldTakeFocus()&&setTimeout(()=>c.focus({preventScroll:!0}),0)}unsetComp(e){this.allRowGuis=this.allRowGuis.filter(t=>t.containerType!==e),this.updateGui(e,void 0)}isCacheable(){return this.rowType==="FullWidthDetail"&&this.gos.get("keepDetailRows")}setCached(e){const t=e?"none":"";this.allRowGuis.forEach(n=>n.element.style.display=t)}initialiseRowComp(e){const t=this.gos;this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.listenOnDomOrder(e),this.onRowHeightChanged(e),this.updateRowIndexes(e),this.setFocusedClasses(e),this.setStylesFromGridOptions(!1,e),Gd(t)&&this.rowNode.selectable&&this.onRowSelected(e),this.updateColumnLists(!this.useAnimationFrameForCreate);const n=e.rowComp;this.getInitialRowClasses(e.containerType).forEach(r=>n.addOrRemoveCssClass(r,!0)),this.executeSlideAndFadeAnimations(e),this.rowNode.group&&jM(e.element,this.rowNode.expanded==!0),this.setRowCompRowId(n),this.setRowCompRowBusinessKey(n),fh(t,e.element,w1,this),e.compBean.addDestroyFunc(()=>fh(t,e.element,w1,null)),this.useAnimationFrameForCreate?this.beans.animationFrameSvc.createTask(this.addHoverFunctionality.bind(this,e),this.rowNode.rowIndex,"p2",!1):this.addHoverFunctionality(e),this.isFullWidth()&&this.setupFullWidth(e),t.get("rowDragEntireRow")&&this.addRowDraggerToRow(e),this.useAnimationFrameForCreate&&this.beans.animationFrameSvc.addDestroyTask(()=>{this.isAlive()&&e.rowComp.addOrRemoveCssClass("ag-after-created",!0)}),this.executeProcessRowPostCreateFunc()}setRowCompRowBusinessKey(e){this.businessKey!=null&&e.setRowBusinessKey(this.businessKey)}setRowCompRowId(e){const t=Ol(this.rowNode.id);this.rowId=t,t!=null&&e.setRowId(t)}executeSlideAndFadeAnimations(e){const{containerType:t}=e;this.slideInAnimation[t]&&(JM(()=>{this.onTopChanged()}),this.slideInAnimation[t]=!1),this.fadeInAnimation[t]&&(JM(()=>{e.rowComp.addOrRemoveCssClass("ag-opacity-zero",!1)}),this.fadeInAnimation[t]=!1)}addRowDraggerToRow(e){const t=this.beans.rowDragSvc?.createRowDragCompForRow(this.rowNode,e.element);if(!t)return;const n=this.createBean(t,this.beans.context);this.rowDragComps.push(n),e.compBean.addDestroyFunc(()=>{this.rowDragComps=this.rowDragComps.filter(i=>i!==n),this.destroyBean(n,this.beans.context)})}setupFullWidth(e){const t=this.getPinnedForContainer(e.containerType),n=this.createFullWidthCompDetails(e.element,t);e.rowComp.showFullWidth(n)}getFullWidthCellRenderers(){return this.gos.get("embedFullWidthRows")?this.allRowGuis.map(e=>e?.rowComp?.getFullWidthCellRenderer()):[this.fullWidthGui?.rowComp?.getFullWidthCellRenderer()]}executeProcessRowPostCreateFunc(){const e=this.gos.getCallback("processRowPostCreate");if(!e||!this.areAllContainersReady())return;const t={eRow:this.centerGui.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)};e(t)}areAllContainersReady(){const{leftGui:e,centerGui:t,rightGui:n,beans:{visibleCols:i}}=this,r=!!e||!i.isPinningLeft(),s=!!t,o=!!n||!i.isPinningRight();return r&&s&&o}isNodeFullWidthCell(){if(this.rowNode.detail)return!0;const e=this.beans.gos.getCallback("isFullWidthRow");return e?e({rowNode:this.rowNode}):!1}setRowType(){const e=this.rowNode.stub&&!this.gos.get("suppressServerSideFullWidthLoadingRow")&&!this.gos.get("groupHideOpenParents"),t=this.isNodeFullWidthCell(),n=this.gos.get("masterDetail")&&this.rowNode.detail,i=this.beans.colModel.isPivotMode(),s=!!this.rowNode.group&&!this.rowNode.footer&&hN(this.gos,i);e?this.rowType="FullWidthLoading":n?this.rowType="FullWidthDetail":t?this.rowType="FullWidth":s?this.rowType="FullWidthGroup":this.rowType="Normal"}updateColumnLists(e=!1,t=!1){if(this.isFullWidth())return;const{animationFrameSvc:n}=this.beans;if(!n?.active||e||this.printLayout){this.updateColumnListsImpl(t);return}this.updateColumnListsPending||(n.createTask(()=>{this.active&&this.updateColumnListsImpl(!0)},this.rowNode.rowIndex,"p1",!1),this.updateColumnListsPending=!0)}getNewCellCtrl(e){if(!this.beans.rowSpanSvc?.isCellSpanning(e,this.rowNode))return new Pv(e,this.rowNode,this.beans,this)}isCorrectCtrlForSpan(e){return!this.beans.rowSpanSvc?.isCellSpanning(e.column,this.rowNode)}createCellCtrls(e,t,n=null){const i={list:[],map:{}},r=(u,c,d)=>{d!=null?i.list.splice(d,0,c):i.list.push(c),i.map[u]=c},s=[];for(const u of t){const c=u.getInstanceId();let d=e.map[c];d&&!this.isCorrectCtrlForSpan(d)&&(d.destroy(),d=void 0),d||(d=this.getNewCellCtrl(u)),d&&r(c,d)}for(const u of e.list){const c=u.column.getInstanceId();if(i.map[c]!=null)continue;!this.isCellEligibleToBeRemoved(u,n)?s.push([c,u]):u.destroy()}if(s.length)for(const[u,c]of s){const d=i.list.findIndex(p=>p.column.getLeft()>c.column.getLeft()),h=d===-1?void 0:Math.max(d-1,0);r(u,c,h)}const{focusSvc:o,visibleCols:a}=this.beans,l=o.getFocusedCell();if(l&&l.column.getPinned()==n){const u=l.column.getInstanceId();if(!i.map[u]&&a.allCols.includes(l.column)){const d=this.createFocusedCellCtrl();if(d){const h=i.list.findIndex(g=>g.column.getLeft()>d.column.getLeft()),p=h===-1?void 0:Math.max(h-1,0);r(u,d,p)}}}return i}createFocusedCellCtrl(){const{focusSvc:e,rowSpanSvc:t}=this.beans,n=e.getFocusedCell();if(!n)return;const i=t?.getCellSpan(n.column,this.rowNode);if(i){if(i.firstNode!==this.rowNode||!i.doesSpanContain(n))return}else if(!e.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned))return;return this.getNewCellCtrl(n.column)}updateColumnListsImpl(e){this.updateColumnListsPending=!1,this.createAllCellCtrls(),this.setCellCtrls(e)}setCellCtrls(e){this.allRowGuis.forEach(t=>{const n=this.getCellCtrlsForContainer(t.containerType);t.rowComp.setCellCtrls(n,e)})}getCellCtrlsForContainer(e){switch(e){case"left":return this.leftCellCtrls.list;case"right":return this.rightCellCtrls.list;case"fullWidth":return[];case"center":return this.centerCellCtrls.list}}createAllCellCtrls(){const e=this.beans.colViewport,t=this.beans.visibleCols;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,t.allCols),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{const n=e.getColsWithinViewport(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,n);const i=t.getLeftColsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,i,"left");const r=t.getRightColsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,r,"right")}}isCellEligibleToBeRemoved(e,t){const{column:r}=e;if(r.getPinned()!=t||!this.isCorrectCtrlForSpan(e))return!0;const{editing:s}=e,{visibleCols:o}=this.beans,a=e.isCellFocused();return s||a?!(o.allCols.indexOf(r)>=0):!0}getDomOrder(){return this.gos.get("ensureDomOrder")||Si(this.gos,"print")}listenOnDomOrder(e){const t=()=>{e.rowComp.setDomOrder(this.getDomOrder())};e.compBean.addManagedPropertyListeners(["domLayout","ensureDomOrder"],t)}setAnimateFlags(e){if(this.rowNode.sticky||!e)return;const t=Ce(this.rowNode.oldRowTop),{visibleCols:n}=this.beans,i=n.isPinningLeft(),r=n.isPinningRight();if(t){const{slideInAnimation:s}=this;if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){s.fullWidth=!0;return}s.center=!0,s.left=i,s.right=r}else{const{fadeInAnimation:s}=this;if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){s.fullWidth=!0;return}s.center=!0,s.left=i,s.right=r}}isFullWidth(){return this.rowType!=="Normal"}refreshFullWidth(){const e=(o,a)=>o?o.rowComp.refreshFullWidth(()=>this.createFullWidthCompDetails(o.element,a).params):!0,t=e(this.fullWidthGui,null),n=e(this.centerGui,null),i=e(this.leftGui,"left"),r=e(this.rightGui,"right");return t&&n&&i&&r}addListeners(){this.addManagedListeners(this.rowNode,{heightChanged:()=>this.onRowHeightChanged(),rowSelected:()=>this.onRowSelected(),rowIndexChanged:this.onRowIndexChanged.bind(this),topChanged:this.onTopChanged.bind(this),...this.beans.expansionSvc?.getRowExpandedListeners(this)??{}}),this.rowNode.detail&&this.addManagedListeners(this.rowNode.parent,{dataChanged:this.onRowNodeDataChanged.bind(this)}),this.addManagedListeners(this.rowNode,{dataChanged:this.onRowNodeDataChanged.bind(this),cellChanged:this.postProcessCss.bind(this),rowHighlightChanged:this.onRowNodeHighlightChanged.bind(this),draggingChanged:this.postProcessRowDragging.bind(this),uiLevelChanged:this.onUiLevelChanged.bind(this)}),this.addManagedListeners(this.beans.eventSvc,{paginationPixelOffsetChanged:this.onPaginationPixelOffsetChanged.bind(this),heightScaleChanged:this.onTopChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),virtualColumnsChanged:this.onVirtualColumnsChanged.bind(this),cellFocused:this.onCellFocusChanged.bind(this),cellFocusCleared:this.onCellFocusChanged.bind(this),paginationChanged:this.onPaginationChanged.bind(this),modelUpdated:this.refreshFirstAndLastRowStyles.bind(this),columnMoved:()=>this.updateColumnLists()}),this.beans.rowSpanSvc&&this.addManagedListeners(this.beans.rowSpanSvc,{spannedCellsUpdated:({pinned:e})=>{e&&!this.rowNode.rowPinned||this.updateColumnLists()}}),this.addDestroyFunc(()=>{this.rowDragComps=this.destroyBeans(this.rowDragComps,this.beans.context),this.tooltipFeature=this.destroyBean(this.tooltipFeature,this.beans.context)}),this.addManagedPropertyListeners(["rowStyle","getRowStyle","rowClass","getRowClass","rowClassRules"],this.postProcessCss.bind(this)),this.addManagedPropertyListener("rowDragEntireRow",()=>{if(this.gos.get("rowDragEntireRow")){this.allRowGuis.forEach(t=>{this.addRowDraggerToRow(t)});return}this.rowDragComps=this.destroyBeans(this.rowDragComps,this.beans.context)}),this.addListenersForCellComps()}addListenersForCellComps(){this.addManagedListeners(this.rowNode,{rowIndexChanged:()=>{this.getAllCellCtrls().forEach(e=>e.onRowIndexChanged())},cellChanged:e=>{this.getAllCellCtrls().forEach(t=>t.onCellChanged(e))}})}onRowNodeDataChanged(e){if(this.isFullWidth()!==!!this.isNodeFullWidthCell()){this.beans.rowRenderer.redrawRow(this.rowNode);return}if(this.isFullWidth()){this.refreshFullWidth()||this.beans.rowRenderer.redrawRow(this.rowNode);return}this.getAllCellCtrls().forEach(n=>n.refreshCell({suppressFlash:!e.update,newData:!e.update})),this.allRowGuis.forEach(n=>{this.setRowCompRowId(n.rowComp),this.updateRowBusinessKey(),this.setRowCompRowBusinessKey(n.rowComp)}),this.onRowSelected(),this.postProcessCss()}postProcessCss(){this.setStylesFromGridOptions(!0),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.postProcessRowDragging()}onRowNodeHighlightChanged(){const e=this.rowNode.highlighted;this.allRowGuis.forEach(t=>{const n=e==="Above",i=e==="Below";t.rowComp.addOrRemoveCssClass("ag-row-highlight-above",n),t.rowComp.addOrRemoveCssClass("ag-row-highlight-below",i)})}postProcessRowDragging(){const e=this.rowNode.dragging;this.allRowGuis.forEach(t=>t.rowComp.addOrRemoveCssClass("ag-row-dragging",e))}onDisplayedColumnsChanged(){this.updateColumnLists(!0),this.beans.rowAutoHeight?.requestCheckAutoHeight()}onVirtualColumnsChanged(){this.updateColumnLists(!1,!0)}getRowPosition(){return{rowPinned:Il(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}}onKeyboardNavigate(e){const t=this.findFullWidthInfoForEvent(e);if(!t)return;const{rowGui:n,column:i}=t;if(!(n.element===e.target))return;const o=this.rowNode,{focusSvc:a,navigation:l}=this.beans,u=a.getFocusedCell(),c={rowIndex:o.rowIndex,rowPinned:o.rowPinned,column:u?.column??i};l?.navigateToNextCell(e,e.key,c,!0),e.preventDefault()}onTabKeyDown(e){if(e.defaultPrevented||_l(e))return;const t=this.allRowGuis.find(a=>a.element.contains(e.target)),n=t?t.element:null,i=n===e.target,r=nn(this.beans);let s=!1;n&&r&&(s=n.contains(r)&&r.classList.contains("ag-cell"));let o=null;!i&&!s&&(o=$h(this.beans,n,!1,e.shiftKey)),(this.isFullWidth()&&i||!o)&&this.beans.navigation?.onTabKeyDown(this,e)}getFullWidthElement(){return this.fullWidthGui?this.fullWidthGui.element:null}getRowYPosition(){const e=this.allRowGuis.find(t=>Io(t.element))?.element;return e?e.getBoundingClientRect().top:0}onSuppressCellFocusChanged(e){const t=this.isFullWidth()&&e?void 0:-1;this.allRowGuis.forEach(n=>{$s(n.element,"tabindex",t)})}onFullWidthRowFocused(e){const t=this.rowNode,n=e?this.isFullWidth()&&e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned:!1;let i;if(this.fullWidthGui)i=this.fullWidthGui.element;else{const s=this.beans.colModel.getCol(e?.column)?.pinned;s?i=s==="right"?this.rightGui?.element:this.leftGui?.element:i=this.centerGui?.element}i&&(i.classList.toggle("ag-full-width-focus",n),n&&e?.forceBrowserFocus&&i.focus({preventScroll:!0}))}recreateCell(e){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,e),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,e),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,e),e.destroy(),this.updateColumnLists()}removeCellCtrl(e,t){const n={list:[],map:{}};return e.list.forEach(i=>{i!==t&&(n.list.push(i),n.map[i.column.getInstanceId()]=i)}),n}onMouseEvent(e,t){switch(e){case"dblclick":this.onRowDblClick(t);break;case"click":this.onRowClick(t);break;case"touchstart":case"mousedown":this.onRowMouseDown(t);break}}createRowEvent(e,t){const{rowNode:n}=this;return ze(this.gos,{type:e,node:n,data:n.data,rowIndex:n.rowIndex,rowPinned:n.rowPinned,event:t})}createRowEventWithSource(e,t){const n=this.createRowEvent(e,t);return n.source=this,n}onRowDblClick(e){_l(e)||this.beans.eventSvc.dispatchEvent(this.createRowEventWithSource("rowDoubleClicked",e))}findFullWidthInfoForEvent(e){if(!e)return;const t=this.findFullWidthRowGui(e.target),n=this.getColumnForFullWidth(t);if(!(!t||!n))return{rowGui:t,column:n}}findFullWidthRowGui(e){return this.allRowGuis.find(t=>t.element.contains(e))}getColumnForFullWidth(e){const{visibleCols:t}=this.beans;switch(e?.containerType){case"center":return t.centerCols[0];case"left":return t.leftCols[0];case"right":return t.rightCols[0];default:return t.allCols[0]}}onRowMouseDown(e){if(this.lastMouseDownOnDragger=$d(e.target,"ag-row-drag",3),!this.isFullWidth())return;const t=this.rowNode,{rangeSvc:n,focusSvc:i}=this.beans;n?.removeAllCellRanges();const r=this.findFullWidthInfoForEvent(e);if(!r)return;const{rowGui:s,column:o}=r,a=s.element,l=e.target;let u=e.defaultPrevented||Oh();a&&a.contains(l)&&oN(l)&&(u=!1),i.setFocusedCell({rowIndex:t.rowIndex,column:o,rowPinned:t.rowPinned,forceBrowserFocus:u})}onRowClick(e){if(_l(e)||this.lastMouseDownOnDragger)return;const{eventSvc:n,selectionSvc:i}=this.beans;n.dispatchEvent(this.createRowEventWithSource("rowClicked",e)),i?.handleSelectionEvent(e,this.rowNode,"rowClicked")}setupDetailRowAutoHeight(e){this.rowType==="FullWidthDetail"&&this.beans.masterDetailSvc?.setupDetailRowAutoHeight(this,e)}createFullWidthCompDetails(e,t){const{gos:n,rowNode:i}=this,r=ze(n,{fullWidth:!0,data:i.data,node:i,value:i.key,valueFormatted:i.key,eGridCell:e,eParentOfValue:e,pinned:t,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:(o,a,l,u)=>this.addFullWidthRowDragging(o,a,l,u),setTooltip:(o,a)=>{n.assertModuleRegistered("Tooltip",3),this.refreshRowTooltip(o,a)}}),s=this.beans.userCompFactory;switch(this.rowType){case"FullWidthDetail":return pWe(s,r);case"FullWidthGroup":return r.value=i.groupValue,r.valueFormatted=i.rowGroupColumn?this.beans.valueSvc.formatValue(i.rowGroupColumn,i,r.value):r.value,fWe(s,r);case"FullWidthLoading":return hWe(s,r);default:return dWe(s,r)}}refreshRowTooltip(e,t){this.fullWidthGui&&(this.tooltipFeature=this.beans.tooltipSvc?.refreshRowTooltip(this.tooltipFeature,this,e,t))}addFullWidthRowDragging(e,t,n="",i){const{rowDragSvc:r,context:s}=this.beans;if(!r||!this.isFullWidth())return;const o=r.createRowDragComp(()=>n,this.rowNode,void 0,e,t,i);this.createBean(o,s),this.addDestroyFunc(()=>{this.destroyBean(o,s)})}onUiLevelChanged(){const e=FW(this.rowNode);if(this.rowLevel!=e){const t="ag-row-level-"+e,n="ag-row-level-"+this.rowLevel;this.allRowGuis.forEach(i=>{i.rowComp.addOrRemoveCssClass(t,!0),i.rowComp.addOrRemoveCssClass(n,!1)})}this.rowLevel=e}isFirstRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBounds.getFirstRow()}isLastRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBounds.getLastRow()}refreshFirstAndLastRowStyles(){const e=this.isFirstRowOnPage(),t=this.isLastRowOnPage();this.firstRowOnPage!==e&&(this.firstRowOnPage=e,this.allRowGuis.forEach(n=>n.rowComp.addOrRemoveCssClass("ag-row-first",e))),this.lastRowOnPage!==t&&(this.lastRowOnPage=t,this.allRowGuis.forEach(n=>n.rowComp.addOrRemoveCssClass("ag-row-last",t)))}getAllCellCtrls(){return this.leftCellCtrls.list.length===0&&this.rightCellCtrls.list.length===0?this.centerCellCtrls.list:[...this.centerCellCtrls.list,...this.leftCellCtrls.list,...this.rightCellCtrls.list]}postProcessClassesFromGridOptions(){const e=[];this.beans.rowStyleSvc?.processClassesFromGridOptions(e,this.rowNode),e.length&&e.forEach(t=>{this.allRowGuis.forEach(n=>n.rowComp.addOrRemoveCssClass(t,!0))})}postProcessRowClassRules(){this.beans.rowStyleSvc?.processRowClassRules(this.rowNode,e=>{this.allRowGuis.forEach(t=>t.rowComp.addOrRemoveCssClass(e,!0))},e=>{this.allRowGuis.forEach(t=>t.rowComp.addOrRemoveCssClass(e,!1))})}setStylesFromGridOptions(e,t){e&&(this.rowStyles=this.processStylesFromGridOptions()),this.forEachGui(t,n=>n.rowComp.setUserStyles(this.rowStyles))}getPinnedForContainer(e){return e==="left"||e==="right"?e:null}getInitialRowClasses(e){const t=this.getPinnedForContainer(e),n=this.isFullWidth(),{rowNode:i,beans:r}=this,s=[];s.push("ag-row"),s.push(this.rowFocused?"ag-row-focus":"ag-row-no-focus"),this.fadeInAnimation[e]&&s.push("ag-opacity-zero"),s.push(i.rowIndex%2===0?"ag-row-even":"ag-row-odd"),i.isRowPinned()&&s.push("ag-row-pinned"),i.isSelected()&&s.push("ag-row-selected"),i.footer&&s.push("ag-row-footer"),s.push("ag-row-level-"+this.rowLevel),i.stub&&s.push("ag-row-loading"),n&&s.push("ag-full-width-row"),r.expansionSvc?.addExpandedCss(s,i),i.dragging&&s.push("ag-row-dragging");const{rowStyleSvc:o}=r;return o&&(o.processClassesFromGridOptions(s,i),o.preProcessRowClassRules(s,i)),s.push(this.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),this.isFirstRowOnPage()&&s.push("ag-row-first"),this.isLastRowOnPage()&&s.push("ag-row-last"),n&&(t==="left"&&s.push("ag-cell-last-left-pinned"),t==="right"&&s.push("ag-cell-first-right-pinned")),s}processStylesFromGridOptions(){return this.beans.rowStyleSvc?.processStylesFromGridOptions(this.rowNode)??this.emptyStyle}onRowSelected(e){this.beans.selectionSvc?.onRowCtrlSelected(this,t=>{(t===this.centerGui||t===this.fullWidthGui)&&this.announceDescription()},e)}announceDescription(){this.beans.selectionSvc?.announceAriaRowSelection(this.rowNode)}addHoverFunctionality(e){if(!this.active)return;const{element:t,compBean:n}=e,{rowNode:i,beans:r,gos:s}=this;n.addManagedListeners(t,{mouseenter:()=>i.dispatchRowEvent("mouseEnter"),mouseleave:()=>i.dispatchRowEvent("mouseLeave")}),n.addManagedListeners(i,{mouseEnter:()=>{!r.dragSvc?.dragging&&!s.get("suppressRowHoverHighlight")&&(t.classList.add("ag-row-hover"),i.setHovered(!0))},mouseLeave:()=>{this.resetHoveredStatus(t)}})}resetHoveredStatus(e){const t=e?[e]:this.allRowGuis.map(n=>n.element);for(const n of t)n.classList.remove("ag-row-hover");this.rowNode.setHovered(!1)}roundRowTopToBounds(e){const t=this.beans.ctrlsSvc.getScrollFeature().getApproximateVScollPosition(),n=this.applyPaginationOffset(t.top,!0)-100,i=this.applyPaginationOffset(t.bottom,!0)+100;return Math.min(Math.max(n,e),i)}forEachGui(e,t){e?t(e):this.allRowGuis.forEach(t)}isRowRendered(){return this.allRowGuis.length>0}onRowHeightChanged(e){if(this.rowNode.rowHeight==null)return;const t=this.rowNode.rowHeight,n=this.beans.environment.getDefaultRowHeight(),r=wee(this.gos)?Np(this.beans,this.rowNode).height:void 0,s=r?`${Math.min(n,r)-2}px`:void 0;this.forEachGui(e,o=>{o.element.style.height=`${t}px`,s&&o.element.style.setProperty("--ag-line-height",s)})}destroyFirstPass(e=!1){this.active=!1;const{rowNode:t}=this;if(!e&&jf(this.gos)&&!t.sticky)if(t.rowTop!=null){const r=this.roundRowTopToBounds(t.rowTop);this.setRowTop(r)}else this.allRowGuis.forEach(r=>r.rowComp.addOrRemoveCssClass("ag-opacity-zero",!0));this.fullWidthGui?.element.contains(nn(this.beans))&&this.beans.focusSvc.attemptToRecoverFocus(),t.setHovered(!1);const n=this.createRowEvent("virtualRowRemoved");this.dispatchLocalEvent(n),this.beans.eventSvc.dispatchEvent(n),super.destroy()}destroySecondPass(){this.allRowGuis.length=0,this.beans.editSvc?.stopRowEditing(this);const e=t=>(t.list.forEach(n=>n.destroy()),{list:[],map:{}});this.centerCellCtrls=e(this.centerCellCtrls),this.leftCellCtrls=e(this.leftCellCtrls),this.rightCellCtrls=e(this.rightCellCtrls)}setFocusedClasses(e){this.forEachGui(e,t=>{t.rowComp.addOrRemoveCssClass("ag-row-focus",this.rowFocused),t.rowComp.addOrRemoveCssClass("ag-row-no-focus",!this.rowFocused)})}onCellFocusChanged(){const{focusSvc:e,editSvc:t}=this.beans,n=e.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);n!==this.rowFocused&&(this.rowFocused=n,this.setFocusedClasses()),!n&&this.editing&&t?.stopRowEditing(this,!1)}onPaginationChanged(){const e=this.beans.pagination?.getCurrentPage()??0;this.paginationPage!==e&&(this.paginationPage=e,this.onTopChanged()),this.refreshFirstAndLastRowStyles()}onTopChanged(){this.setRowTop(this.rowNode.rowTop)}onPaginationPixelOffsetChanged(){this.onTopChanged()}applyPaginationOffset(e,t=!1){if(this.rowNode.isRowPinned()||this.rowNode.sticky)return e;const n=this.beans.pageBounds.getPixelOffset();return e+n*(t?1:-1)}setRowTop(e){if(!this.printLayout&&Ce(e)){const t=this.applyPaginationOffset(e),r=`${this.rowNode.isRowPinned()||this.rowNode.sticky?t:this.beans.rowContainerHeight.getRealPixelPosition(t)}px`;this.setRowTopStyle(r)}}getInitialRowTop(e){return this.suppressRowTransform?this.getInitialRowTopShared(e):void 0}getInitialTransform(e){return this.suppressRowTransform?void 0:`translateY(${this.getInitialRowTopShared(e)})`}getInitialRowTopShared(e){if(this.printLayout)return"";const t=this.rowNode;let n;if(t.sticky)n=t.stickyRowTop;else{const i=this.slideInAnimation[e]?this.roundRowTopToBounds(t.oldRowTop):t.rowTop,r=this.applyPaginationOffset(i);n=t.isRowPinned()?r:this.beans.rowContainerHeight.getRealPixelPosition(r)}return n+"px"}setRowTopStyle(e){this.allRowGuis.forEach(t=>this.suppressRowTransform?t.rowComp.setTop(e):t.rowComp.setTransform(`translateY(${e})`))}getCellCtrl(e,t=!1){let n=null;return this.getAllCellCtrls().forEach(i=>{i.column==e&&(n=i)}),n!=null||t||this.getAllCellCtrls().forEach(i=>{i.getColSpanningList().indexOf(e)>=0&&(n=i)}),n}onRowIndexChanged(){this.rowNode.rowIndex!=null&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())}updateRowIndexes(e){const t=this.rowNode.getRowIndexString();if(t===null)return;const n=(this.beans.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0)+(this.beans.filterManager?.getHeaderRowCount()??0),i=this.rowNode.rowIndex%2===0,r=n+this.rowNode.rowIndex+1;this.forEachGui(e,s=>{s.rowComp.setRowIndex(t),s.rowComp.addOrRemoveCssClass("ag-row-even",i),s.rowComp.addOrRemoveCssClass("ag-row-odd",!i),rN(s.element,r)})}};function fte(e){return e.altKey||e.ctrlKey||e.metaKey?!1:e.key?.length===1}function lT(e,t,n,i,r){const s=i?i.getColDef().suppressKeyboardEvent:void 0;if(!s)return!1;const o=ze(e,{event:t,editing:r,column:i,node:n,data:n.data,colDef:i.getColDef()});return!!(s&&s(o))}function F4e(e){const{pinnedRowModel:t,rowModel:n}=e,[i,r]=[t?.isEmpty("top")??!0,t?.isEmpty("bottom")??!0],s=i?null:"top";let o,a;r?(o=null,a=n.getRowCount()-1):(o="bottom",a=t?.getPinnedBottomRowCount()??-1);const{visibleCols:l,rangeSvc:u}=e,c=l.allCols;!u||!c?.length||u.setCellRange({rowStartIndex:0,rowStartPinned:s,rowEndIndex:a,rowEndPinned:o})}var A4e=65,D4e=67,k4e=86,P4e=68,M4e=90,T4e=89;function I4e(e){const{keyCode:t}=e;let n;switch(t){case A4e:n=X.A;break;case D4e:n=X.C;break;case k4e:n=X.V;break;case P4e:n=X.D;break;case M4e:n=X.Z;break;case T4e:n=X.Y;break;default:n=e.code}return n}var _4e=class extends Z{constructor(e){super(),this.element=e}postConstruct(){this.addKeyboardListeners(),this.addMouseListeners(),this.beans.touchSvc?.mockRowContextMenu(this)}addKeyboardListeners(){const e="keydown",t=this.processKeyboardEvent.bind(this,e);this.addManagedElementListeners(this.element,{[e]:t})}addMouseListeners(){["dblclick","contextmenu","mouseover","mouseout","click",Dee("touchstart")?"touchstart":"mousedown"].forEach(n=>{const i=this.processMouseEvent.bind(this,n);this.addManagedElementListeners(this.element,{[n]:i})})}processMouseEvent(e,t){if(!D0(this.gos,t)||_l(t))return;const{cellCtrl:n,rowCtrl:i}=this.getControlsForEventTarget(t.target);e==="contextmenu"?(n?.column&&n.dispatchCellContextMenuEvent(t),this.beans.contextMenuSvc?.handleContextMenuMouseEvent(t,void 0,i,n)):(n&&n.onMouseEvent(e,t),i&&i.onMouseEvent(e,t))}getControlsForEventTarget(e){const{gos:t}=this;return{cellCtrl:ete(t,e),rowCtrl:kee(t,e,w1)}}processKeyboardEvent(e,t){const{cellCtrl:n,rowCtrl:i}=this.getControlsForEventTarget(t.target);t.defaultPrevented||(n?this.processCellKeyboardEvent(n,e,t):i&&i.isFullWidth()&&this.processFullWidthRowKeyboardEvent(i,e,t))}processCellKeyboardEvent(e,t,n){const{rowNode:i,column:r,editing:s}=e;!lT(this.gos,n,i,r,s)&&t==="keydown"&&(!s&&this.beans.navigation?.handlePageScrollingKey(n)||e.onKeyDown(n),this.doGridOperations(n,e.editing),fte(n)&&e.processCharacter(n)),t==="keydown"&&this.eventSvc.dispatchEvent(e.createEvent(n,"cellKeyDown"))}processFullWidthRowKeyboardEvent(e,t,n){const{rowNode:i}=e,{focusSvc:r,navigation:s}=this.beans,o=r.getFocusedCell(),a=o&&o.column;if(!lT(this.gos,n,i,a,!1)){const u=n.key;if(t==="keydown")switch(u){case X.PAGE_HOME:case X.PAGE_END:case X.PAGE_UP:case X.PAGE_DOWN:s?.handlePageScrollingKey(n,!0);break;case X.LEFT:case X.RIGHT:if(!this.gos.get("embedFullWidthRows"))break;case X.UP:case X.DOWN:e.onKeyboardNavigate(n);break;case X.TAB:e.onTabKeyDown(n);break}}t==="keydown"&&this.eventSvc.dispatchEvent(e.createRowEvent("cellKeyDown",n))}doGridOperations(e,t){if(!e.ctrlKey&&!e.metaKey||t||!D0(this.gos,e))return;const n=I4e(e),{clipboardSvc:i,undoRedo:r}=this.beans;if(n===X.A)return this.onCtrlAndA(e);if(n===X.C)return this.onCtrlAndC(i,e);if(n===X.D)return this.onCtrlAndD(i,e);if(n===X.V)return this.onCtrlAndV(i,e);if(n===X.X)return this.onCtrlAndX(i,e);if(n===X.Y)return this.onCtrlAndY(r);if(n===X.Z)return this.onCtrlAndZ(r,e)}onCtrlAndA(e){const{beans:{rowModel:t,rangeSvc:n,selectionSvc:i},gos:r}=this;n&&Wl(r)&&t.isRowsToRender()?F4e(this.beans):i&&i?.selectAllRowNodes({source:"keyboardSelectAll",selectAll:Fee(r)}),e.preventDefault()}onCtrlAndC(e,t){if(!e||this.gos.get("enableCellTextSelection"))return;const{cellCtrl:n,rowCtrl:i}=this.getControlsForEventTarget(t.target);n?.editing||i?.editing||(t.preventDefault(),e.copyToClipboard())}onCtrlAndX(e,t){if(!e||this.gos.get("enableCellTextSelection")||this.gos.get("suppressCutToClipboard"))return;const{cellCtrl:n,rowCtrl:i}=this.getControlsForEventTarget(t.target);n?.editing||i?.editing||(t.preventDefault(),e.cutToClipboard(void 0,"ui"))}onCtrlAndV(e,t){const{cellCtrl:n,rowCtrl:i}=this.getControlsForEventTarget(t.target);n?.editing||i?.editing||e&&!this.gos.get("suppressClipboardPaste")&&e.pasteFromClipboard()}onCtrlAndD(e,t){e&&!this.gos.get("suppressClipboardPaste")&&e.copyRangeDown(),t.preventDefault()}onCtrlAndZ(e,t){!this.gos.get("undoRedoCellEditing")||!e||(t.preventDefault(),t.shiftKey?e.redo("ui"):e.undo("ui"))}onCtrlAndY(e){e?.redo("ui")}},pte=class extends Z{constructor(e,t){super(),this.eContainer=e,this.eViewport=t}postConstruct(){this.addManagedEventListeners({rowContainerHeightChanged:this.onHeightChanged.bind(this,this.beans.rowContainerHeight)})}onHeightChanged(e){const t=e.uiContainerHeight,n=t!=null?`${t}px`:"";this.eContainer.style.height=n,this.eViewport&&(this.eViewport.style.height=n)}},kw=e=>e.topRowCtrls,Pw=e=>e.getStickyTopRowCtrls(),Mw=e=>e.getStickyBottomRowCtrls(),Tw=e=>e.bottomRowCtrls,Iw=e=>e.allRowCtrls,UD=e=>e.getCtrls("top"),qD=e=>e.getCtrls("center"),jD=e=>e.getCtrls("bottom"),O4e={center:{type:"center",name:"center-cols",getRowCtrls:Iw,getSpannedRowCtrls:qD},left:{type:"left",name:"pinned-left-cols",pinnedType:"left",getRowCtrls:Iw,getSpannedRowCtrls:qD},right:{type:"right",name:"pinned-right-cols",pinnedType:"right",getRowCtrls:Iw,getSpannedRowCtrls:qD},fullWidth:{type:"fullWidth",name:"full-width",fullWidth:!0,getRowCtrls:Iw},topCenter:{type:"center",name:"floating-top",getRowCtrls:kw,getSpannedRowCtrls:UD},topLeft:{type:"left",name:"pinned-left-floating",container:"ag-pinned-left-floating-top",pinnedType:"left",getRowCtrls:kw,getSpannedRowCtrls:UD},topRight:{type:"right",name:"pinned-right-floating",container:"ag-pinned-right-floating-top",pinnedType:"right",getRowCtrls:kw,getSpannedRowCtrls:UD},topFullWidth:{type:"fullWidth",name:"floating-top-full-width",fullWidth:!0,getRowCtrls:kw},stickyTopCenter:{type:"center",name:"sticky-top",getRowCtrls:Pw},stickyTopLeft:{type:"left",name:"pinned-left-sticky-top",container:"ag-pinned-left-sticky-top",pinnedType:"left",getRowCtrls:Pw},stickyTopRight:{type:"right",name:"pinned-right-sticky-top",container:"ag-pinned-right-sticky-top",pinnedType:"right",getRowCtrls:Pw},stickyTopFullWidth:{type:"fullWidth",name:"sticky-top-full-width",fullWidth:!0,getRowCtrls:Pw},stickyBottomCenter:{type:"center",name:"sticky-bottom",getRowCtrls:Mw},stickyBottomLeft:{type:"left",name:"pinned-left-sticky-bottom",container:"ag-pinned-left-sticky-bottom",pinnedType:"left",getRowCtrls:Mw},stickyBottomRight:{type:"right",name:"pinned-right-sticky-bottom",container:"ag-pinned-right-sticky-bottom",pinnedType:"right",getRowCtrls:Mw},stickyBottomFullWidth:{type:"fullWidth",name:"sticky-bottom-full-width",fullWidth:!0,getRowCtrls:Mw},bottomCenter:{type:"center",name:"floating-bottom",getRowCtrls:Tw,getSpannedRowCtrls:jD},bottomLeft:{type:"left",name:"pinned-left-floating-bottom",container:"ag-pinned-left-floating-bottom",pinnedType:"left",getRowCtrls:Tw,getSpannedRowCtrls:jD},bottomRight:{type:"right",name:"pinned-right-floating-bottom",container:"ag-pinned-right-floating-bottom",pinnedType:"right",getRowCtrls:Tw,getSpannedRowCtrls:jD},bottomFullWidth:{type:"fullWidth",name:"floating-bottom-full-width",fullWidth:!0,getRowCtrls:Tw}};function gte(e){return`ag-${LC(e).name}-viewport`}function Cb(e){const t=LC(e);return t.container??`ag-${t.name}-container`}function L4e(e){return`ag-${LC(e).name}-spanned-cells-container`}function LC(e){return O4e[e]}var N4e=["topCenter","topLeft","topRight"],$4e=["bottomCenter","bottomLeft","bottomRight"],B4e=["center","left","right"],G4e=["center","left","right","fullWidth"],z4e=["stickyTopCenter","stickyBottomCenter","center","topCenter","bottomCenter"],H4e=["left","bottomLeft","topLeft","stickyTopLeft","stickyBottomLeft"],V4e=["right","bottomRight","topRight","stickyTopRight","stickyBottomRight"],mte=["stickyTopCenter","stickyTopLeft","stickyTopRight"],vte=["stickyBottomCenter","stickyBottomLeft","stickyBottomRight"],W4e=[...mte,"stickyTopFullWidth",...vte,"stickyBottomFullWidth"],U4e=[...N4e,...$4e,...B4e,...mte,...vte],q4e=class extends Z{constructor(e){super(),this.name=e,this.visible=!0,this.EMPTY_CTRLS=[],this.options=LC(e)}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.forContainers(["center"],()=>{this.viewportSizeFeature=this.createManagedBean(new x4e(this)),this.addManagedEventListeners({stickyTopOffsetChanged:this.onStickyTopOffsetChanged.bind(this)})})}onStickyTopOffsetChanged(e){this.comp.setOffsetTop(`${e.offset}px`)}registerWithCtrlsService(){this.options.fullWidth||this.beans.ctrlsSvc.register(this.name,this)}forContainers(e,t){e.indexOf(this.name)>=0&&t()}setComp(e,t,n,i){this.comp=e,this.eContainer=t,this.eSpannedContainer=n,this.eViewport=i,this.createManagedBean(new _4e(this.eViewport??this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder();const{pinnedCols:r,rangeSvc:s}=this.beans,o=()=>this.onPinnedWidthChanged();this.forContainers(H4e,()=>{this.pinnedWidthFeature=this.createOptionalManagedBean(r?.createPinnedWidthFeature(!0,this.eContainer,this.eSpannedContainer)),this.addManagedEventListeners({leftPinnedWidthChanged:o})}),this.forContainers(V4e,()=>{this.pinnedWidthFeature=this.createOptionalManagedBean(r?.createPinnedWidthFeature(!1,this.eContainer,this.eSpannedContainer)),this.addManagedEventListeners({rightPinnedWidthChanged:o})}),this.forContainers(G4e,()=>this.createManagedBean(new pte(this.eContainer,this.name==="center"?i:void 0))),s&&this.forContainers(U4e,()=>this.createManagedBean(s.createDragListenerFeature(this.eContainer))),this.forContainers(z4e,()=>this.createManagedBean(new wN(a=>this.comp.setContainerWidth(`${a}px`)))),this.visible=this.isContainerVisible(),this.addListeners(),this.registerWithCtrlsService()}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}addListeners(){const{spannedRowRenderer:e,gos:t}=this.beans;this.addManagedEventListeners({displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onDisplayedColumnsChanged.bind(this),displayedRowsChanged:n=>this.onDisplayedRowsChanged(n.afterScroll)}),this.onDisplayedColumnsChanged(),this.onDisplayedRowsChanged(),e&&this.options.getSpannedRowCtrls&&t.get("enableCellSpan")&&this.addManagedListeners(e,{spannedRowsUpdated:()=>{const n=this.options.getSpannedRowCtrls(e);n&&this.comp.setSpannedRowCtrls(n,!1)}})}listenOnDomOrder(){if(W4e.indexOf(this.name)>=0){this.comp.setDomOrder(!0);return}const t=()=>{const n=this.gos.get("ensureDomOrder"),i=Si(this.gos,"print");this.comp.setDomOrder(n||i)};this.addManagedPropertyListener("domLayout",t),t()}onDisplayedColumnsChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}addPreventScrollWhileDragging(){const{dragSvc:e}=this.beans;if(!e)return;const t=n=>{e.dragging&&n.cancelable&&n.preventDefault()};this.eContainer.addEventListener("touchmove",t,{passive:!1}),this.addDestroyFunc(()=>this.eContainer.removeEventListener("touchmove",t))}onHorizontalViewportChanged(e=!1){const t=this.getCenterWidth(),n=this.getCenterViewportScrollLeft();this.beans.colViewport.setScrollPosition(t,n,e)}hasHorizontalScrollGap(){return this.eContainer.clientWidth-this.eViewport.clientWidth<0}hasVerticalScrollGap(){return this.eContainer.clientHeight-this.eViewport.clientHeight<0}getCenterWidth(){return w0(this.eViewport)}getCenterViewportScrollLeft(){return r1(this.eViewport,this.enableRtl)}registerViewportResizeListener(e){const t=_c(this.beans,this.eViewport,e);this.addDestroyFunc(()=>t())}isViewportInTheDOMTree(){return uee(this.eViewport)}getViewportScrollLeft(){return r1(this.eViewport,this.enableRtl)}isHorizontalScrollShowing(){return this.gos.get("alwaysShowHorizontalScroll")||T5e(this.eViewport)}setHorizontalScroll(e){this.comp.setHorizontalScroll(e)}getHScrollPosition(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}}setCenterViewportScrollLeft(e){s1(this.eViewport,e,this.enableRtl)}isContainerVisible(){return!(this.options.pinnedType!=null)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0}onPinnedWidthChanged(){const e=this.isContainerVisible();this.visible!=e&&(this.visible=e,this.onDisplayedRowsChanged())}onDisplayedRowsChanged(e=!1){const t=this.options.getRowCtrls(this.beans.rowRenderer);if(!this.visible||t.length===0){this.comp.setRowCtrls({rowCtrls:this.EMPTY_CTRLS});return}const n=Si(this.gos,"print"),r=this.gos.get("embedFullWidthRows")||n,s=t.filter(o=>{const a=o.isFullWidth();return this.options.fullWidth?!r&&a:r||!a});this.comp.setRowCtrls({rowCtrls:s,useFlushSync:e})}},Cte="ag-force-vertical-scroll",j4e="ag-selectable",K4e="ag-column-moving",Y4e=class extends Z{constructor(){super(...arguments),this.stickyTopHeight=0,this.stickyBottomHeight=0}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.colModel=e.colModel,this.scrollVisibleSvc=e.scrollVisibleSvc,this.pinnedRowModel=e.pinnedRowModel,this.filterManager=e.filterManager,this.rowGroupColsSvc=e.rowGroupColsSvc}setComp(e,t,n,i,r,s,o){this.comp=e,this.eGridBody=t,this.eBodyViewport=n,this.eTop=i,this.eBottom=r,this.eStickyTop=s,this.eStickyBottom=o,this.eCenterColsViewport=n.querySelector(`.${gte("center")}`),this.eFullWidthContainer=n.querySelector(`.${Cb("fullWidth")}`),this.eStickyTopFullWidthContainer=s.querySelector(`.${Cb("stickyTopFullWidth")}`),this.eStickyBottomFullWidthContainer=o.querySelector(`.${Cb("stickyBottomFullWidth")}`),this.setCellTextSelection(this.gos.get("enableCellTextSelection")),this.addManagedPropertyListener("enableCellTextSelection",a=>this.setCellTextSelection(a.currentValue)),this.createManagedBean(new yN(this.comp)),this.scrollFeature=this.createManagedBean(new S4e(this.eBodyViewport)),this.beans.rowDragSvc?.setupRowDrag(this.eBodyViewport,this),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([i,n,r,s,o]),this.setGridRootRole(),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.updateScrollingClasses(),this.filterManager?.setupAdvFilterHeaderComp(i),this.ctrlsSvc.register("gridBodyCtrl",this)}addEventListeners(){const e=this.setFloatingHeights.bind(this),t=this.setGridRootRole.bind(this);this.addManagedEventListeners({gridColumnsChanged:this.onGridColumnsChanged.bind(this),scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this),scrollGapChanged:this.updateScrollingClasses.bind(this),pinnedRowDataChanged:e,pinnedHeightChanged:e,headerHeightChanged:this.setStickyTopOffsetTop.bind(this),columnRowGroupChanged:t,columnPivotChanged:t}),this.addManagedPropertyListener("treeData",t)}onGridColumnsChanged(){const e=this.beans.colModel.getCols();this.comp.setColumnCount(e.length)}onScrollVisibilityChanged(){const{scrollVisibleSvc:e}=this,t=e.verticalScrollShowing;this.setVerticalScrollPaddingVisible(t),this.setStickyWidth(t),this.setStickyBottomOffsetBottom();const n=t&&e.getScrollbarWidth()||0,i=see()?16:0,r=`calc(100% + ${n+i}px)`;lu(this.beans,()=>this.comp.setBodyViewportWidth(r)),this.updateScrollingClasses()}setGridRootRole(){const{rowGroupColsSvc:e,colModel:t}=this;let n=this.gos.get("treeData");if(!n){const i=t.isPivotMode();n=(e?e.columns.length:0)>=(i?2:1)}this.comp.setGridRootRole(n?"treegrid":"grid")}addFocusListeners(e){e.forEach(t=>{this.addManagedElementListeners(t,{focusin:n=>{const{target:i}=n,r=$d(i,"ag-root",t);t.classList.toggle("ag-has-focus",!r)},focusout:n=>{const{target:i,relatedTarget:r}=n,s=t.contains(r),o=$d(r,"ag-root",t);$d(i,"ag-root",t)||(!s||o)&&t.classList.remove("ag-has-focus")}})})}setColumnMovingCss(e){this.comp.setColumnMovingCss(K4e,e)}setCellTextSelection(e=!1){this.comp.setCellSelectableCss(j4e,e)}updateScrollingClasses(){const{eGridBody:{classList:e},scrollVisibleSvc:t}=this;e.toggle("ag-body-vertical-content-no-gap",!t.verticalScrollGap),e.toggle("ag-body-horizontal-content-no-gap",!t.horizontalScrollGap)}disableBrowserDragging(){this.addManagedElementListeners(this.eGridBody,{dragstart:e=>{if(e.target instanceof HTMLImageElement)return e.preventDefault(),!1}})}addStopEditingWhenGridLosesFocus(){this.beans.editSvc?.addStopEditingWhenGridLosesFocus([this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop,this.eStickyBottom])}updateRowCount(){const e=(this.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0)+(this.filterManager?.getHeaderRowCount()??0),{rowModel:t}=this.beans,n=t.isLastRowIndexKnown()?t.getRowCount():-1,i=n===-1?-1:e+n;this.comp.setRowCount(i)}registerBodyViewportResizeListener(e){this.comp.registerBodyViewportResizeListener(e)}setVerticalScrollPaddingVisible(e){const t=e?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(t)}isVerticalScrollShowing(){const e=this.gos.get("alwaysShowVerticalScroll"),t=e?Cte:null,n=Si(this.gos,"normal");return this.comp.setAlwaysVerticalScrollClass(t,e),e||n&&I5e(this.eBodyViewport)}setupRowAnimationCssClass(){const{rowContainerHeight:e,environment:t}=this.beans;let n=t.sizesMeasured;const i=()=>{const r=n&&jf(this.gos)&&!e.stretching,s=r?"ag-row-animation":"ag-row-no-animation";this.comp.setRowAnimationCssOnBodyViewport(s,r)};i(),this.addManagedEventListeners({heightScaleChanged:i}),this.addManagedPropertyListener("animateRows",i),this.addManagedEventListeners({gridStylesChanged:()=>{!n&&t.sizesMeasured&&(n=!0,i())}})}addBodyViewportListener(){const{popupSvc:e,touchSvc:t}=this.beans,n=this.onBodyViewportContextMenu.bind(this);this.addManagedElementListeners(this.eBodyViewport,{contextmenu:n}),t?.mockBodyContextMenu(this,n),this.addManagedElementListeners(this.eBodyViewport,{wheel:this.onBodyViewportWheel.bind(this,e)}),this.addManagedElementListeners(this.eStickyTop,{wheel:this.onStickyWheel.bind(this)}),this.addManagedElementListeners(this.eStickyBottom,{wheel:this.onStickyWheel.bind(this)}),this.addFullWidthContainerWheelListener()}addFullWidthContainerWheelListener(){this.addManagedElementListeners(this.eFullWidthContainer,{wheel:e=>this.onFullWidthContainerWheel(e)})}onFullWidthContainerWheel(e){const{deltaX:t,deltaY:n,shiftKey:i}=e;(i||Math.abs(t)>Math.abs(n))&&D0(this.gos,e)&&this.scrollGridBodyToMatchEvent(e)}onStickyWheel(e){const{deltaX:t,deltaY:n,shiftKey:i}=e,r=i||Math.abs(t)>Math.abs(n),s=e.target;r?(this.eStickyTopFullWidthContainer.contains(s)||this.eStickyBottomFullWidthContainer.contains(s))&&this.scrollGridBodyToMatchEvent(e):(e.preventDefault(),this.scrollVertically(n))}scrollGridBodyToMatchEvent(e){const{deltaX:t,deltaY:n}=e;e.preventDefault(),this.eCenterColsViewport.scrollBy({left:t||n})}onBodyViewportContextMenu(e,t,n){if(!e&&!n)return;this.gos.get("preventDefaultOnContextMenu")&&(e||n).preventDefault();const{target:i}=e||t;(i===this.eBodyViewport||i===this.ctrlsSvc.get("center").eViewport)&&this.beans.contextMenuSvc?.showContextMenu({mouseEvent:e,touchEvent:n,value:null,anchorToElement:this.eGridBody,source:"ui"})}onBodyViewportWheel(e,t){this.gos.get("suppressScrollWhenPopupsAreOpen")&&e?.hasAnchoredPopup()&&t.preventDefault()}scrollVertically(e){const t=this.eBodyViewport.scrollTop;return this.scrollFeature.setVerticalScrollPosition(t+e),this.eBodyViewport.scrollTop-t}setFloatingHeights(){const{pinnedRowModel:e}=this,t=e?.getPinnedTopTotalHeight()??0,n=e?.getPinnedBottomTotalHeight()??0;this.comp.setTopHeight(t),this.comp.setBottomHeight(n),this.comp.setTopInvisible(t<=0),this.comp.setBottomInvisible(n<=0),this.setStickyTopOffsetTop(),this.setStickyBottomOffsetBottom()}setStickyTopHeight(e=0){this.comp.setStickyTopHeight(`${e}px`),this.stickyTopHeight=e}setStickyBottomHeight(e=0){this.comp.setStickyBottomHeight(`${e}px`),this.stickyBottomHeight=e}setStickyWidth(e){if(!e)this.comp.setStickyTopWidth("100%"),this.comp.setStickyBottomWidth("100%");else{const t=this.scrollVisibleSvc.getScrollbarWidth();this.comp.setStickyTopWidth(`calc(100% - ${t}px)`),this.comp.setStickyBottomWidth(`calc(100% - ${t}px)`)}}setStickyTopOffsetTop(){const t=this.ctrlsSvc.get("gridHeaderCtrl").headerHeight+(this.filterManager?.getHeaderHeight()??0),n=this.pinnedRowModel?.getPinnedTopTotalHeight()??0;let i=0;t>0&&(i+=t),n>0&&(i+=n),i>0&&(i+=1),this.comp.setStickyTopTop(`${i}px`)}setStickyBottomOffsetBottom(){const{pinnedRowModel:e,scrollVisibleSvc:t,comp:n}=this,i=e?.getPinnedBottomTotalHeight()??0,s=t.horizontalScrollShowing&&t.getScrollbarWidth()||0,o=i+s;n.setStickyBottomBottom(`${o}px`)}},yte=class extends At{constructor(e,t){super(),this.direction=t,this.eViewport=ve,this.eContainer=ve,this.hideTimeout=0,this.setTemplate(e)}postConstruct(){this.addManagedEventListeners({scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this)}),this.onScrollVisibilityChanged(),this.addOrRemoveCssClass("ag-apple-scrollbar",iee()||Nd())}destroy(){super.destroy(),window.clearTimeout(this.hideTimeout)}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.invisibleScrollbar=see(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))}addActiveListenerToggles(){const e=this.getGui(),t=()=>this.addOrRemoveCssClass("ag-scrollbar-active",!0),n=()=>this.addOrRemoveCssClass("ag-scrollbar-active",!1);this.addManagedListeners(e,{mouseenter:t,mousedown:t,touchstart:t,mouseleave:n,touchend:n})}onScrollVisibilityChanged(){this.invisibleScrollbar===void 0&&this.initialiseInvisibleScrollbar(),lu(this.beans,()=>this.setScrollVisible())}hideAndShowInvisibleScrollAsNeeded(){this.addManagedEventListeners({bodyScroll:e=>{e.direction===this.direction&&(this.hideTimeout&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=0),this.addOrRemoveCssClass("ag-scrollbar-scrolling",!0))},bodyScrollEnd:()=>{this.hideTimeout=window.setTimeout(()=>{this.addOrRemoveCssClass("ag-scrollbar-scrolling",!1),this.hideTimeout=0},400)}})}attemptSettingScrollPosition(e){const t=this.eViewport;N5e(()=>Io(t),()=>this.setScrollPosition(e),100)}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}},X4e={tag:"div",cls:"ag-body-horizontal-scroll",attrs:{"aria-hidden":"true"},children:[{tag:"div",ref:"eLeftSpacer",cls:"ag-horizontal-left-spacer"},{tag:"div",ref:"eViewport",cls:"ag-body-horizontal-scroll-viewport",children:[{tag:"div",ref:"eContainer",cls:"ag-body-horizontal-scroll-container"}]},{tag:"div",ref:"eRightSpacer",cls:"ag-horizontal-right-spacer"}]},Q4e=class extends yte{constructor(){super(X4e,"horizontal"),this.eLeftSpacer=ve,this.eRightSpacer=ve,this.setScrollVisibleDebounce=0}wireBeans(e){this.visibleCols=e.visibleCols,this.scrollVisibleSvc=e.scrollVisibleSvc}postConstruct(){super.postConstruct();const e=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e,pinnedRowDataChanged:this.refreshCompBottom.bind(this)}),this.addManagedPropertyListener("domLayout",e),this.beans.ctrlsSvc.register("fakeHScrollComp",this),this.createManagedBean(new wN(t=>this.eContainer.style.width=`${t}px`)),this.addManagedPropertyListeners(["suppressHorizontalScroll"],this.onScrollVisibilityChanged.bind(this))}destroy(){window.clearTimeout(this.setScrollVisibleDebounce),super.destroy()}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.enableRtl=this.gos.get("enableRtl"),super.initialiseInvisibleScrollbar(),this.invisibleScrollbar&&this.refreshCompBottom())}refreshCompBottom(){if(!this.invisibleScrollbar)return;const e=this.beans.pinnedRowModel?.getPinnedBottomTotalHeight()??0;this.getGui().style.bottom=`${e}px`}onScrollVisibilityChanged(){super.onScrollVisibilityChanged(),this.setFakeHScrollSpacerWidths()}setFakeHScrollSpacerWidths(){const e=this.scrollVisibleSvc.verticalScrollShowing;let t=this.visibleCols.getDisplayedColumnsRightWidth();const n=!this.enableRtl&&e,i=this.scrollVisibleSvc.getScrollbarWidth();n&&(t+=i),Ra(this.eRightSpacer,t),this.eRightSpacer.classList.toggle("ag-scroller-corner",t<=i);let r=this.visibleCols.getColsLeftWidth();this.enableRtl&&e&&(r+=i),Ra(this.eLeftSpacer,r),this.eLeftSpacer.classList.toggle("ag-scroller-corner",r<=i)}setScrollVisible(){const e=this.scrollVisibleSvc.horizontalScrollShowing,t=this.invisibleScrollbar,n=this.gos.get("suppressHorizontalScroll"),i=e&&this.scrollVisibleSvc.getScrollbarWidth()||0,s=n?0:i===0&&t?16:i,o=()=>{this.setScrollVisibleDebounce=0,this.addOrRemoveCssClass("ag-scrollbar-invisible",t),Av(this.getGui(),s),Av(this.eViewport,s),Av(this.eContainer,s),s||this.eContainer.style.setProperty("min-height","1px"),this.setVisible(e,{skipAriaHidden:!0})};window.clearTimeout(this.setScrollVisibleDebounce),e?this.setScrollVisibleDebounce=window.setTimeout(o,100):o()}getScrollPosition(){return r1(this.eViewport,this.enableRtl)}setScrollPosition(e){Io(this.eViewport)||this.attemptSettingScrollPosition(e),s1(this.eViewport,e,this.enableRtl)}},Z4e={selector:"AG-FAKE-HORIZONTAL-SCROLL",component:Q4e},J4e={tag:"div",cls:"ag-body-vertical-scroll",attrs:{"aria-hidden":"true"},children:[{tag:"div",ref:"eViewport",cls:"ag-body-vertical-scroll-viewport",children:[{tag:"div",ref:"eContainer",cls:"ag-body-vertical-scroll-container"}]}]},e8e=class extends yte{constructor(){super(J4e,"vertical")}postConstruct(){super.postConstruct(),this.createManagedBean(new pte(this.eContainer));const{ctrlsSvc:e}=this.beans;e.register("fakeVScrollComp",this),this.addManagedEventListeners({rowContainerHeightChanged:this.onRowContainerHeightChanged.bind(this,e)})}setScrollVisible(){const{scrollVisibleSvc:e}=this.beans,t=e.verticalScrollShowing,n=this.invisibleScrollbar,i=t&&e.getScrollbarWidth()||0,r=i===0&&n?16:i;this.addOrRemoveCssClass("ag-scrollbar-invisible",n),Ra(this.getGui(),r),Ra(this.eViewport,r),Ra(this.eContainer,r),this.setDisplayed(t,{skipAriaHidden:!0})}onRowContainerHeightChanged(e){const n=e.getGridBodyCtrl().eBodyViewport,i=this.getScrollPosition(),r=n.scrollTop;i!=r&&this.setScrollPosition(r,!0)}getScrollPosition(){return this.eViewport.scrollTop}setScrollPosition(e,t){!t&&!Io(this.eViewport)&&this.attemptSettingScrollPosition(e),this.eViewport.scrollTop=e}},t8e={selector:"AG-FAKE-VERTICAL-SCROLL",component:e8e};function n8e(e){return e.cols?e.cols.treeDepth+1:-1}function va(e){return e.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0}function SN(e){const t=[],n=e.ctrlsSvc.getHeaderRowContainerCtrls();for(const i of n){if(!i)continue;const r=i.getGroupRowCount()||0;for(let s=0;s<r;s++){const o=i.getGroupRowCtrlAtIndex(s),a=t[s];if(o){const l=i8e(e,o);(a==null||l>a)&&(t[s]=l)}}}return t}function i8e(e,t){let i=e.colModel.isPivotMode()?s8e(e):bte(e);const r=t.getHeaderCellCtrls();for(const s of r){const{column:o}=s,a=o.getAutoHeaderHeight();a!=null&&a>i&&o.isAutoHeaderHeight()&&(i=a)}return i}function xN(e){let n=e.colModel.isPivotMode()?r8e(e):NC(e);return e.colModel.forAllCols(i=>{const r=i.getAutoHeaderHeight();r!=null&&r>n&&i.isAutoHeaderHeight()&&(n=r)}),n}function NC(e){return e.gos.get("headerHeight")??e.environment.getDefaultHeaderHeight()}function wte(e){return e.gos.get("floatingFiltersHeight")??NC(e)}function bte(e){return e.gos.get("groupHeaderHeight")??NC(e)}function r8e(e){return e.gos.get("pivotHeaderHeight")??NC(e)}function s8e(e){return e.gos.get("pivotGroupHeaderHeight")??bte(e)}var o8e=class extends Z{setComp(e,t,n){this.comp=e,this.eGui=t;const{beans:i}=this,{headerNavigation:r,touchSvc:s,ctrlsSvc:o}=i;r&&this.createManagedBean(new Sg(n,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedEventListeners({columnPivotModeChanged:this.onPivotModeChanged.bind(this,i),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this,i)}),this.onPivotModeChanged(i),this.setupHeaderHeight();const a=this.onHeaderContextMenu.bind(this);this.addManagedElementListeners(this.eGui,{contextmenu:a}),s?.mockHeaderContextMenu(this,a),o.register("gridHeaderCtrl",this)}setupHeaderHeight(){const e=this.setHeaderHeight.bind(this);e(),this.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],e),this.addManagedEventListeners({displayedColumnsChanged:e,columnHeaderHeightChanged:e,columnGroupHeaderHeightChanged:()=>lu(this.beans,()=>e()),gridStylesChanged:e,advancedFilterEnabledChanged:e})}setHeaderHeight(){const{beans:e}=this;let t=0;const n=SN(e).reduce((s,o)=>s+o,0),i=xN(e);if(e.filterManager?.hasFloatingFilters()&&(t+=wte(e)),t+=n,t+=i,this.headerHeight===t)return;this.headerHeight=t;const r=`${t+1}px`;this.comp.setHeightAndMinHeight(r),this.eventSvc.dispatchEvent({type:"headerHeightChanged"})}onPivotModeChanged(e){const t=e.colModel.isPivotMode();this.comp.addOrRemoveCssClass("ag-pivot-on",t),this.comp.addOrRemoveCssClass("ag-pivot-off",!t)}onDisplayedColumnsChanged(e){const n=e.visibleCols.allCols.some(i=>i.isSpanHeaderHeight());this.comp.addOrRemoveCssClass("ag-header-allow-overflow",n)}onTabKeyDown(e){const t=this.gos.get("enableRtl"),n=e.shiftKey,i=n!==t?"LEFT":"RIGHT",{beans:r}=this,{headerNavigation:s,focusSvc:o}=r;(s.navigateHorizontally(i,!0,e)||!n&&o.focusOverlay(!1)||Hp(r,n,!0))&&e.preventDefault()}handleKeyDown(e){let t=null;const{headerNavigation:n}=this.beans;switch(e.key){case X.LEFT:t="LEFT";case X.RIGHT:{Ce(t)||(t="RIGHT"),n.navigateHorizontally(t,!1,e)&&e.preventDefault();break}case X.UP:t="UP";case X.DOWN:{Ce(t)||(t="DOWN"),n.navigateVertically(t,null,e)&&e.preventDefault();break}default:return}}onFocusOut(e){const{relatedTarget:t}=e,{eGui:n,beans:i}=this;!t&&n.contains(nn(i))||n.contains(t)||(i.focusSvc.focusedHeader=null)}onHeaderContextMenu(e,t,n){const{menuSvc:i,ctrlsSvc:r}=this.beans;if(!e&&!n||!i?.isHeaderContextMenuEnabled())return;const{target:s}=e??t;(s===this.eGui||s===r.getHeaderRowContainerCtrl()?.eViewport)&&i.showHeaderContextMenu(void 0,e,n)}},RN=class extends At{constructor(e,t){super(e),this.ctrl=t}getCtrl(){return this.ctrl}},a8e={tag:"div",cls:"ag-header-cell",role:"columnheader",children:[{tag:"div",ref:"eResize",cls:"ag-header-cell-resize",role:"presentation"},{tag:"div",ref:"eHeaderCompWrapper",cls:"ag-header-cell-comp-wrapper",role:"presentation"}]},l8e=class extends RN{constructor(e){super(a8e,e),this.eResize=ve,this.eHeaderCompWrapper=ve,this.headerCompVersion=0}postConstruct(){const e=this.getGui();((r,s)=>{s!=null&&s!=""?e.setAttribute(r,s):e.removeAttribute(r)})("col-id",this.ctrl.column.getColId());const n={setWidth:r=>e.style.width=r,addOrRemoveCssClass:(r,s)=>this.addOrRemoveCssClass(r,s),setUserStyles:r=>_C(e,r),setAriaSort:r=>r?R5e(e,r):E5e(e),setUserCompDetails:r=>this.setUserCompDetails(r),getUserCompInstance:()=>this.headerComp};this.ctrl.setComp(n,this.getGui(),this.eResize,this.eHeaderCompWrapper,void 0);const i=this.ctrl.getSelectAllGui();i&&this.eResize.insertAdjacentElement("afterend",i)}destroy(){this.destroyHeaderComp(),super.destroy()}destroyHeaderComp(){this.headerComp&&(this.eHeaderCompWrapper.removeChild(this.headerCompGui),this.headerComp=this.destroyBean(this.headerComp),this.headerCompGui=void 0)}setUserCompDetails(e){this.headerCompVersion++;const t=this.headerCompVersion;e.newAgStackInstance().then(n=>this.afterCompCreated(t,n))}afterCompCreated(e,t){if(e!=this.headerCompVersion||!this.isAlive()){this.destroyBean(t);return}this.destroyHeaderComp(),this.headerComp=t,this.headerCompGui=t.getGui(),this.eHeaderCompWrapper.appendChild(this.headerCompGui),this.ctrl.setDragSource(this.getGui())}},u8e={tag:"div",cls:"ag-header-group-cell",role:"columnheader",children:[{tag:"div",ref:"eHeaderCompWrapper",cls:"ag-header-cell-comp-wrapper",role:"presentation"},{tag:"div",ref:"eResize",cls:"ag-header-cell-resize",role:"presentation"}]},c8e=class extends RN{constructor(e){super(u8e,e),this.eResize=ve,this.eHeaderCompWrapper=ve}postConstruct(){const e=this.getGui(),t=(i,r)=>r!=null?e.setAttribute(i,r):e.removeAttribute(i);e.setAttribute("col-id",this.ctrl.column.getUniqueId());const n={addOrRemoveCssClass:(i,r)=>this.addOrRemoveCssClass(i,r),setUserStyles:i=>_C(e,i),setHeaderWrapperHidden:i=>{i?this.eHeaderCompWrapper.style.setProperty("display","none"):this.eHeaderCompWrapper.style.removeProperty("display")},setHeaderWrapperMaxHeight:i=>{i!=null?this.eHeaderCompWrapper.style.setProperty("max-height",`${i}px`):this.eHeaderCompWrapper.style.removeProperty("max-height"),this.eHeaderCompWrapper.classList.toggle("ag-header-cell-comp-wrapper-limited-height",i!=null)},setResizableDisplayed:i=>tn(this.eResize,i),setWidth:i=>e.style.width=i,setAriaExpanded:i=>t("aria-expanded",i),setUserCompDetails:i=>this.setUserCompDetails(i),getUserCompInstance:()=>this.headerGroupComp};this.ctrl.setComp(n,e,this.eResize,this.eHeaderCompWrapper,void 0)}setUserCompDetails(e){e.newAgStackInstance().then(t=>this.afterHeaderCompCreated(t))}afterHeaderCompCreated(e){const t=()=>this.destroyBean(e);if(!this.isAlive()){t();return}const n=this.getGui(),i=e.getGui();this.eHeaderCompWrapper.appendChild(i),this.addDestroyFunc(t),this.headerGroupComp=e,this.ctrl.setDragSource(n)}addOrRemoveHeaderWrapperStyle(e,t){const{eHeaderCompWrapper:n}=this;t?n.style.setProperty(e,t):n.style.removeProperty(e)}},d8e={tag:"div",cls:"ag-header-cell ag-floating-filter",role:"gridcell",children:[{tag:"div",ref:"eFloatingFilterBody",role:"presentation"},{tag:"div",ref:"eButtonWrapper",cls:"ag-floating-filter-button ag-hidden",role:"presentation",children:[{tag:"button",ref:"eButtonShowMainFilter",cls:"ag-button ag-floating-filter-button-button",attrs:{type:"button",tabindex:"-1"}}]}]},h8e=class extends RN{constructor(e){super(d8e,e),this.eFloatingFilterBody=ve,this.eButtonWrapper=ve,this.eButtonShowMainFilter=ve}postConstruct(){const e=this.getGui(),t={addOrRemoveCssClass:(n,i)=>this.addOrRemoveCssClass(n,i),setUserStyles:n=>_C(e,n),addOrRemoveBodyCssClass:(n,i)=>this.eFloatingFilterBody.classList.toggle(n,i),setButtonWrapperDisplayed:n=>tn(this.eButtonWrapper,n),setCompDetails:n=>this.setCompDetails(n),getFloatingFilterComp:()=>this.compPromise,setWidth:n=>e.style.width=n,setMenuIcon:n=>this.eButtonShowMainFilter.appendChild(n)};this.ctrl.setComp(t,e,this.eButtonShowMainFilter,this.eFloatingFilterBody,void 0)}setCompDetails(e){if(!e){this.destroyFloatingFilterComp(),this.compPromise=null;return}this.compPromise=e.newAgStackInstance(),this.compPromise.then(t=>this.afterCompCreated(t))}destroy(){this.destroyFloatingFilterComp(),super.destroy()}destroyFloatingFilterComp(){this.floatingFilterComp&&(this.eFloatingFilterBody.removeChild(this.floatingFilterComp.getGui()),this.floatingFilterComp=this.destroyBean(this.floatingFilterComp))}afterCompCreated(e){if(e){if(!this.isAlive()){this.destroyBean(e);return}this.destroyFloatingFilterComp(),this.floatingFilterComp=e,this.eFloatingFilterBody.appendChild(e.getGui()),e.afterGuiAttached&&e.afterGuiAttached()}}},f8e=class extends At{constructor(e){super({tag:"div",cls:e.headerRowClass,role:"row"}),this.ctrl=e,this.headerComps={}}postConstruct(){rN(this.getGui(),this.ctrl.getAriaRowIndex());const e={setHeight:t=>this.getGui().style.height=t,setTop:t=>this.getGui().style.top=t,setHeaderCtrls:(t,n)=>this.setHeaderCtrls(t,n),setWidth:t=>this.getGui().style.width=t};this.ctrl.setComp(e,void 0)}destroy(){this.setHeaderCtrls([],!1),super.destroy()}setHeaderCtrls(e,t){if(!this.isAlive())return;const n=this.headerComps;if(this.headerComps={},e.forEach(i=>{const r=i.instanceId;let s=n[r];delete n[r],s==null&&(s=this.createHeaderComp(i),this.getGui().appendChild(s.getGui())),this.headerComps[r]=s}),Object.values(n).forEach(i=>{this.getGui().removeChild(i.getGui()),this.destroyBean(i)}),t){const i=Object.values(this.headerComps);i.sort((s,o)=>{const a=s.getCtrl().column.getLeft(),l=o.getCtrl().column.getLeft();return a-l});const r=i.map(s=>s.getGui());dee(this.getGui(),r)}}createHeaderComp(e){let t;switch(this.ctrl.type){case"group":t=new c8e(e);break;case"filter":t=new h8e(e);break;default:t=new l8e(e);break}return this.createBean(t),t.setParentComponent(this),t}},EN=class extends Z{constructor(e,t,n,i){super(),this.columnOrGroup=e,this.eCell=t,this.colsSpanning=i,this.columnOrGroup=e,this.ariaEl=t.querySelector("[role=columnheader]")||t,this.beans=n}setColsSpanning(e){this.colsSpanning=e,this.onLeftChanged()}getColumnOrGroup(){const{beans:e,colsSpanning:t}=this;return e.gos.get("enableRtl")&&t?Lt(t):this.columnOrGroup}postConstruct(){const e=this.onLeftChanged.bind(this);this.addManagedListeners(this.columnOrGroup,{leftChanged:e}),this.setLeftFirstTime(),this.addManagedEventListeners({displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}setLeftFirstTime(){const{gos:e,colAnimation:t}=this.beans,n=e.get("suppressColumnMoveAnimation"),i=Ce(this.columnOrGroup.getOldLeft());t?.isActive()&&i&&!n?this.animateInLeft():this.onLeftChanged()}animateInLeft(){const e=this.getColumnOrGroup(),t=this.modifyLeftForPrintLayout(e,e.getOldLeft()),n=this.modifyLeftForPrintLayout(e,e.getLeft());this.setLeft(t),this.actualLeft=n,this.beans.colAnimation.executeNextVMTurn(()=>{this.actualLeft===n&&this.setLeft(n)})}onLeftChanged(){const e=this.getColumnOrGroup(),t=e.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(e,t),this.setLeft(this.actualLeft)}modifyLeftForPrintLayout(e,t){const{gos:n,visibleCols:i}=this.beans;if(!Si(n,"print")||e.getPinned()==="left")return t;const s=i.getColsLeftWidth();if(e.getPinned()==="right"){const o=i.bodyWidth;return s+o+t}return s+t}setLeft(e){if(Ce(e)&&(this.eCell.style.left=`${e}px`),dn(this.columnOrGroup)){const t=this.columnOrGroup.getLeafColumns();if(!t.length)return;t.length>1&&x5e(this.ariaEl,t.length)}}},p8e=0,Ste="headerCtrl",FN=class extends Z{constructor(e,t){super(),this.column=e,this.rowCtrl=t,this.resizeToggleTimeout=0,this.resizeMultiplier=1,this.resizeFeature=null,this.lastFocusEvent=null,this.dragSource=null,this.instanceId=e.getUniqueId()+"-"+p8e++}postConstruct(){const e=this.refreshTabIndex.bind(this);this.addManagedPropertyListeners(["suppressHeaderFocus"],e),this.addManagedEventListeners({overlayExclusiveChanged:e})}shouldStopEventPropagation(e){const{headerRowIndex:t,column:n}=this.beans.focusSvc.focusedHeader,i=n.getDefinition(),r=i&&i.suppressHeaderKeyboardEvent;if(!Ce(r))return!1;const s=ze(this.gos,{colDef:i,column:n,headerRowIndex:t,event:e});return!!r(s)}getWrapperHasFocus(){return nn(this.beans)===this.eGui}setGui(e,t){this.eGui=e,this.addDomData(t),t.addManagedListeners(this.beans.eventSvc,{displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this)}),t.addManagedElementListeners(this.eGui,{focus:this.onGuiFocus.bind(this)}),this.onDisplayedColumnsChanged(),this.refreshTabIndex()}refreshHeaderStyles(){const e=this.column.getDefinition();if(!e)return;const{headerStyle:t}=e;let n;if(typeof t=="function"){const i=this.getHeaderClassParams();n=t(i)}else n=t;n&&this.comp.setUserStyles(n)}onGuiFocus(){this.eventSvc.dispatchEvent({type:"headerFocused",column:this.column})}setupAutoHeight(e){const{wrapperElement:t,checkMeasuringCallback:n,compBean:i}=e,{beans:r}=this,s=d=>{if(!this.isAlive()||!i.isAlive())return;const{paddingTop:h,paddingBottom:p,borderBottomWidth:g,borderTopWidth:m}=Lh(this.eGui),C=h+p+g+m,b=t.offsetHeight+C;if(d<5){const S=Pn(r),x=!S||!S.contains(t),E=b==0;if(x||E){JM(()=>s(d+1),"raf",r);return}}this.setColHeaderHeight(this.column,b)};let o=!1,a;const l=()=>{const d=this.column.isAutoHeaderHeight();d&&!o&&u(),!d&&o&&c()},u=()=>{o=!0,s(0),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!0),a=_c(this.beans,t,()=>s(0))},c=()=>{o=!1,a&&a(),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!1),a=void 0};l(),i.addDestroyFunc(()=>c()),i.addManagedListeners(this.column,{widthChanged:()=>o&&s(0)}),i.addManagedEventListeners({sortChanged:()=>{o&&window.setTimeout(()=>s(0))}}),n&&n(l)}onDisplayedColumnsChanged(){const{comp:e,column:t,beans:n,eGui:i}=this;!e||!t||!i||(Zee(e,t,n.visibleCols),tee(i,n.visibleCols.getAriaColIndex(t)))}addResizeAndMoveKeyboardListeners(e){e.addManagedListeners(this.eGui,{keydown:this.onGuiKeyDown.bind(this),keyup:this.onGuiKeyUp.bind(this)})}refreshTabIndex(){const e=Hd(this.beans);this.eGui&&$s(this.eGui,"tabindex",e?null:"-1")}onGuiKeyDown(e){const t=nn(this.beans),n=e.key===X.LEFT||e.key===X.RIGHT;if(this.isResizing&&(e.preventDefault(),e.stopImmediatePropagation()),t!==this.eGui||!e.shiftKey&&!e.altKey||((this.isResizing||n)&&(e.preventDefault(),e.stopImmediatePropagation()),!n))return;const r=e.key===X.LEFT!==this.gos.get("enableRtl")?"left":"right";if(e.altKey){this.isResizing=!0,this.resizeMultiplier+=1;const s=this.getViewportAdjustedResizeDiff(e);this.resizeHeader(s,e.shiftKey),this.resizeFeature?.toggleColumnResizing(!0)}else this.moveHeader(r)}moveHeader(e){this.beans.colMoves?.moveHeader(e,this.eGui,this.column,this.rowCtrl.pinned,this)}getViewportAdjustedResizeDiff(e){const t=this.getResizeDiff(e),{pinnedCols:n}=this.beans;return n?n.getHeaderResizeDiff(t,this.column):t}getResizeDiff(e){const{gos:t,column:n}=this;let i=e.key===X.LEFT!==t.get("enableRtl");const r=n.getPinned(),s=t.get("enableRtl");return r&&s!==(r==="right")&&(i=!i),(i?-1:1)*this.resizeMultiplier}onGuiKeyUp(){this.isResizing&&(this.resizeToggleTimeout&&(window.clearTimeout(this.resizeToggleTimeout),this.resizeToggleTimeout=0),this.isResizing=!1,this.resizeMultiplier=1,this.resizeToggleTimeout=window.setTimeout(()=>{this.resizeFeature?.toggleColumnResizing(!1)},150))}handleKeyDown(e){const t=this.getWrapperHasFocus();switch(e.key){case X.PAGE_DOWN:case X.PAGE_UP:case X.PAGE_HOME:case X.PAGE_END:t&&e.preventDefault()}}addDomData(e){const t=Ste,{eGui:n,gos:i}=this;fh(i,n,t,this),e.addDestroyFunc(()=>fh(i,n,t,null))}focus(e){const{eGui:t}=this;return t?(this.lastFocusEvent=e||null,t.focus(),!0):!1}focusThis(){this.beans.focusSvc.focusedHeader={headerRowIndex:this.rowCtrl.rowIndex,column:this.column}}removeDragSource(){this.dragSource&&(this.beans.dragAndDrop?.removeDragSource(this.dragSource),this.dragSource=null)}handleContextMenuMouseEvent(e,t,n){const i=e??t,{menuSvc:r,gos:s}=this.beans;s.get("preventDefaultOnContextMenu")&&i.preventDefault(),r?.isHeaderContextMenuEnabled(n)&&r.showHeaderContextMenu(n,e,t),this.dispatchColumnMouseEvent("columnHeaderContextMenu",n)}dispatchColumnMouseEvent(e,t){this.eventSvc.dispatchEvent({type:e,column:t})}setColHeaderHeight(e,t){if(!e.setAutoHeaderHeight(t))return;const{eventSvc:n}=this;e.isColumn?n.dispatchEvent({type:"columnHeaderHeightChanged",column:e,columns:[e],source:"autosizeColumnHeaderHeight"}):n.dispatchEvent({type:"columnGroupHeaderHeightChanged",columnGroup:e,source:"autosizeColumnGroupHeaderHeight"})}clearComponent(){this.removeDragSource(),this.resizeFeature=null,this.comp=null,this.eGui=null}destroy(){super.destroy(),this.column=null,this.lastFocusEvent=null,this.rowCtrl=null}},g8e=class extends FN{constructor(){super(...arguments),this.refreshFunctions={},this.userHeaderClasses=new Set,this.ariaDescriptionProperties=new Map}setComp(e,t,n,i,r){this.comp=e;const{rowCtrl:s,column:o,beans:a}=this,{colResize:l,context:u,colHover:c,rangeSvc:d}=a,h=OC(this,u,r);this.setGui(t,h),this.updateState(),this.setupWidth(h),this.setupMovingCss(h),this.setupMenuClass(h),this.setupSortableClass(h),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight({wrapperElement:i,checkMeasuringCallback:g=>this.setRefreshFunction("measuring",g),compBean:h}),this.addColumnHoverListener(h),this.setupFilterClass(h),this.setupStylesFromColDef(),this.setupClassesFromColDef(),this.setupTooltip(),this.addActiveHeaderMouseListeners(h),this.setupSelectAll(h),this.setupUserComp(),this.refreshAria(),l?this.resizeFeature=h.createManagedBean(l.createResizeFeature(s.pinned,o,n,e,this)):tn(n,!1),c?.createHoverFeature(h,[o],t),d?.createRangeHighlightFeature(h,o,e),h.createManagedBean(new EN(o,t,a)),h.createManagedBean(new Sg(t,{shouldStopEventPropagation:g=>this.shouldStopEventPropagation(g),onTabKeyDown:()=>null,handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addResizeAndMoveKeyboardListeners(h),h.addManagedPropertyListeners(["suppressMovableColumns","suppressMenuHide","suppressAggFuncInHeader","enableAdvancedFilter"],()=>this.refresh()),h.addManagedListeners(o,{colDefChanged:()=>this.refresh()}),h.addManagedListeners(o,{headerHighlightChanged:this.onHeaderHighlightChanged.bind(this)});const p=()=>this.checkDisplayName();h.addManagedEventListeners({columnValueChanged:p,columnRowGroupChanged:p,columnPivotChanged:p,headerHeightChanged:this.onHeaderHeightChanged.bind(this)}),h.addDestroyFunc(()=>{this.refreshFunctions={},this.selectAllFeature=null,this.dragSourceElement=void 0,this.userCompDetails=null,this.userHeaderClasses.clear(),this.ariaDescriptionProperties.clear(),this.clearComponent()})}resizeHeader(e,t){this.beans.colResize?.resizeHeader(this.column,e,t)}getHeaderClassParams(){const{column:e,beans:t}=this,n=e.colDef;return ze(t.gos,{colDef:n,column:e,floatingFilter:!1})}setupUserComp(){const e=this.lookupUserCompDetails();e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setUserCompDetails(e)}lookupUserCompDetails(){const e=this.createParams(),t=this.column.getColDef();return aWe(this.beans.userCompFactory,t,e)}createParams(){const{menuSvc:e,sortSvc:t,colFilter:n,gos:i}=this.beans;return ze(i,{column:this.column,displayName:this.displayName,enableSorting:this.column.isSortable(),enableMenu:this.menuEnabled,enableFilterButton:this.openFilterEnabled&&!!e?.isHeaderFilterButtonEnabled(this.column),enableFilterIcon:!!n&&(!this.openFilterEnabled||Zr(this.gos)),showColumnMenu:(s,o)=>{e?.showColumnMenu({column:this.column,buttonElement:s,positionBy:"button",onClosedCallback:o})},showColumnMenuAfterMouseClick:(s,o)=>{e?.showColumnMenu({column:this.column,mouseEvent:s,positionBy:"mouse",onClosedCallback:o})},showFilter:s=>{e?.showFilterMenu({column:this.column,buttonElement:s,containerType:"columnFilter",positionBy:"button"})},progressSort:s=>{t?.progressSort(this.column,!!s,"uiColumnSorted")},setSort:(s,o)=>{t?.setSortForColumn(this.column,s,!!o,"uiColumnSorted")},eGridHeader:this.eGui,setTooltip:(s,o)=>{i.assertModuleRegistered("Tooltip",3),this.setupTooltip(s,o)}})}setupSelectAll(e){const{selectionSvc:t}=this.beans;t&&(this.selectAllFeature=e.createManagedBean(t.createSelectAllFeature(this.column)),this.selectAllFeature.setComp(this))}getSelectAllGui(){return this.selectAllFeature?.getCheckboxGui()}handleKeyDown(e){super.handleKeyDown(e),e.key===X.SPACE&&this.selectAllFeature?.onSpaceKeyDown(e),e.key===X.ENTER&&this.onEnterKeyDown(e),e.key===X.DOWN&&e.altKey&&this.showMenuOnKeyPress(e,!1)}onEnterKeyDown(e){e.ctrlKey||e.metaKey?this.showMenuOnKeyPress(e,!0):this.sortable&&this.beans.sortSvc?.progressSort(this.column,e.shiftKey,"uiColumnSorted")}showMenuOnKeyPress(e,t){const n=this.comp.getUserCompInstance();AW(n)&&n.onMenuKeyboardShortcut(t)&&e.preventDefault()}onFocusIn(e){this.eGui.contains(e.relatedTarget)||(this.focusThis(),this.announceAriaDescription()),GWe()&&this.setActiveHeader(!0)}onFocusOut(e){this.eGui.contains(e.relatedTarget)||this.setActiveHeader(!1)}setupTooltip(e,t){this.tooltipFeature=this.beans.tooltipSvc?.setupHeaderTooltip(this.tooltipFeature,this,e,t)}setupStylesFromColDef(){this.setRefreshFunction("headerStyles",this.refreshHeaderStyles.bind(this)),this.refreshHeaderStyles()}setupClassesFromColDef(){const e=()=>{const t=this.column.getColDef(),n=Qee(t,this.gos,this.column,null),i=this.userHeaderClasses;this.userHeaderClasses=new Set(n),n.forEach(r=>{i.has(r)?i.delete(r):this.comp.addOrRemoveCssClass(r,!0)}),i.forEach(r=>this.comp.addOrRemoveCssClass(r,!1))};this.setRefreshFunction("headerClasses",e),e()}setDragSource(e){this.dragSourceElement=e,this.removeDragSource(),!(!e||!this.draggable)&&(this.dragSource=this.beans.colMoves?.setDragSourceForHeader(e,this.column,this.displayName)??null)}updateState(){const{menuSvc:e}=this.beans;this.menuEnabled=!!e?.isColumnMenuInHeaderEnabled(this.column),this.openFilterEnabled=!!e?.isFilterMenuInHeaderEnabled(this.column),this.sortable=this.column.isSortable(),this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()}setRefreshFunction(e,t){this.refreshFunctions[e]=t}refresh(){this.updateState(),this.refreshHeaderComp(),this.refreshAria(),Object.values(this.refreshFunctions).forEach(e=>e())}refreshHeaderComp(){const e=this.lookupUserCompDetails();if(!e)return;(this.comp.getUserCompInstance()!=null&&this.userCompDetails.componentClass==e.componentClass?this.attemptHeaderCompRefresh(e.params):!1)?this.setDragSource(this.dragSourceElement):this.setCompDetails(e)}attemptHeaderCompRefresh(e){const t=this.comp.getUserCompInstance();return!t||!t.refresh?!1:t.refresh(e)}calculateDisplayName(){return this.beans.colNames.getDisplayNameForColumn(this.column,"header",!0)}checkDisplayName(){this.displayName!==this.calculateDisplayName()&&this.refresh()}workOutDraggable(){const e=this.column.getColDef();return!!(!this.gos.get("suppressMovableColumns")&&!e.suppressMovable&&!e.lockPosition)||!!e.enableRowGroup||!!e.enablePivot}setupWidth(e){const t=()=>{const n=this.column.getActualWidth();this.comp.setWidth(`${n}px`)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupMovingCss(e){const t=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-moving",this.column.isMoving())};e.addManagedListeners(this.column,{movingChanged:t}),t()}setupMenuClass(e){const t=()=>{this.comp?.addOrRemoveCssClass("ag-column-menu-visible",this.column.isMenuVisible())};e.addManagedListeners(this.column,{menuVisibleChanged:t}),t()}setupSortableClass(e){const t=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-sortable",!!this.sortable)};t(),this.setRefreshFunction("updateSortable",t),e.addManagedEventListeners({sortChanged:this.refreshAriaSort.bind(this)})}setupFilterClass(e){const t=()=>{const n=this.column.isFilterActive();this.comp.addOrRemoveCssClass("ag-header-cell-filtered",n),this.refreshAria()};e.addManagedListeners(this.column,{filterActiveChanged:t}),t()}setupWrapTextClass(){const e=()=>{const t=!!this.column.getColDef().wrapHeaderText;this.comp.addOrRemoveCssClass("ag-header-cell-wrap-text",t)};e(),this.setRefreshFunction("wrapText",e)}onHeaderHighlightChanged(){const e=this.column.getHighlighted(),t=e===0,n=e===1;this.comp.addOrRemoveCssClass("ag-header-highlight-before",t),this.comp.addOrRemoveCssClass("ag-header-highlight-after",n)}onDisplayedColumnsChanged(){super.onDisplayedColumnsChanged(),this.isAlive()&&this.onHeaderHeightChanged()}onHeaderHeightChanged(){this.refreshSpanHeaderHeight()}refreshSpanHeaderHeight(){const{eGui:e,column:t,comp:n,beans:i}=this,r=SN(this.beans),s=r.reduce((c,d)=>c+=d,0)===0;if(n.addOrRemoveCssClass("ag-header-parent-hidden",s),!t.isSpanHeaderHeight()){e.style.removeProperty("top"),e.style.removeProperty("height"),n.addOrRemoveCssClass("ag-header-span-height",!1),n.addOrRemoveCssClass("ag-header-span-total",!1);return}const{numberOfParents:o,isSpanningTotal:a}=this.column.getColumnGroupPaddingInfo();n.addOrRemoveCssClass("ag-header-span-height",o>0);const l=xN(i);if(o===0){n.addOrRemoveCssClass("ag-header-span-total",!1),e.style.setProperty("top","0px"),e.style.setProperty("height",`${l}px`);return}n.addOrRemoveCssClass("ag-header-span-total",a);let u=0;for(let c=0;c<o;c++)u+=r[r.length-1-c];e.style.setProperty("top",`${-u}px`),e.style.setProperty("height",`${l+u}px`)}refreshAriaSort(){if(this.sortable){const e=this.getLocaleTextFunc(),t=this.beans.sortSvc?.getDisplaySortForColumn(this.column)||null;this.comp.setAriaSort(h5e(t)),this.setAriaDescriptionProperty("sort",e("ariaSortableColumn","Press ENTER to sort"))}else this.comp.setAriaSort(),this.setAriaDescriptionProperty("sort",null)}refreshAriaMenu(){if(this.menuEnabled){const e=this.getLocaleTextFunc();this.setAriaDescriptionProperty("menu",e("ariaMenuColumn","Press ALT DOWN to open column menu"))}else this.setAriaDescriptionProperty("menu",null)}refreshAriaFilterButton(){if(this.openFilterEnabled&&!Zr(this.gos)){const e=this.getLocaleTextFunc();this.setAriaDescriptionProperty("filterButton",e("ariaFilterColumn","Press CTRL ENTER to open filter"))}else this.setAriaDescriptionProperty("filterButton",null)}refreshAriaFiltered(){const e=this.getLocaleTextFunc();this.column.isFilterActive()?this.setAriaDescriptionProperty("filter",e("ariaColumnFiltered","Column Filtered")):this.setAriaDescriptionProperty("filter",null)}setAriaDescriptionProperty(e,t){t!=null?this.ariaDescriptionProperties.set(e,t):this.ariaDescriptionProperties.delete(e)}announceAriaDescription(){if(!this.eGui.contains(nn(this.beans)))return;const e=Array.from(this.ariaDescriptionProperties.keys()).sort((t,n)=>t==="filter"?-1:n.charCodeAt(0)-t.charCodeAt(0)).map(t=>this.ariaDescriptionProperties.get(t)).join(". ");this.beans.ariaAnnounce?.announceValue(e,"columnHeader")}refreshAria(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaFilterButton(),this.refreshAriaFiltered()}addColumnHoverListener(e){this.beans.colHover?.addHeaderColumnHoverListener(e,this.comp,this.column)}addActiveHeaderMouseListeners(e){const t=r=>this.handleMouseOverChange(r.type==="mouseenter"),n=()=>{this.setActiveHeader(!0),this.dispatchColumnMouseEvent("columnHeaderClicked",this.column)},i=r=>this.handleContextMenuMouseEvent(r,void 0,this.column);e.addManagedListeners(this.eGui,{mouseenter:t,mouseleave:t,click:n,contextmenu:i})}handleMouseOverChange(e){this.setActiveHeader(e),this.eventSvc.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column})}setActiveHeader(e){this.comp.addOrRemoveCssClass("ag-header-active",e)}getAnchorElementForMenu(e){const t=this.comp.getUserCompInstance();return AW(t)?t.getAnchorElementForMenu(e):this.eGui}destroy(){this.tooltipFeature=this.destroyBean(this.tooltipFeature),super.destroy()}};function AW(e){return typeof e.getAnchorElementForMenu=="function"&&typeof e.onMenuKeyboardShortcut=="function"}var m8e=0,KD=class extends Z{constructor(e,t,n){super(),this.rowIndex=e,this.pinned=t,this.type=n,this.instanceId=m8e++,this.allCtrls=[];const i=n=="group"?"ag-header-row-column-group":n=="filter"?"ag-header-row-column-filter":"ag-header-row-column";this.headerRowClass=`ag-header-row ${i}`}postConstruct(){this.isPrintLayout=Si(this.gos,"print"),this.isEnsureDomOrder=this.gos.get("ensureDomOrder")}areCellsRendered(){return this.comp?this.allCtrls.every(e=>e.eGui!=null):!1}setComp(e,t,n=!0){this.comp=e,t=OC(this,this.beans.context,t),n&&(this.onRowHeightChanged(),this.onVirtualColumnsChanged()),this.setWidth(),this.addEventListeners(t)}getAriaRowIndex(){return this.rowIndex+1}addEventListeners(e){const t=this.onRowHeightChanged.bind(this),n=this.onDisplayedColumnsChanged.bind(this);e.addManagedEventListeners({columnResized:this.setWidth.bind(this),displayedColumnsChanged:n,virtualColumnsChanged:i=>this.onVirtualColumnsChanged(i.afterScroll),columnGroupHeaderHeightChanged:t,columnHeaderHeightChanged:t,gridStylesChanged:t,advancedFilterEnabledChanged:t}),e.addManagedPropertyListener("domLayout",n),e.addManagedPropertyListener("ensureDomOrder",i=>this.isEnsureDomOrder=i.currentValue),e.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],t)}onDisplayedColumnsChanged(){this.isPrintLayout=Si(this.gos,"print"),this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()}setWidth(){const e=this.getWidthForRow();this.comp.setWidth(`${e}px`)}getWidthForRow(){const{visibleCols:e}=this.beans;return this.isPrintLayout?this.pinned!=null?0:e.getContainerWidth("right")+e.getContainerWidth("left")+e.getContainerWidth(null):e.getContainerWidth(this.pinned)}onRowHeightChanged(){const{topOffset:e,rowHeight:t}=this.getTopAndHeight();this.comp.setTop(e+"px"),this.comp.setHeight(t+"px")}getTopAndHeight(){const{filterManager:e}=this.beans,t=[],n=SN(this.beans),i=xN(this.beans);t.push(...n),t.push(i),e?.hasFloatingFilters()&&t.push(wte(this.beans));let r=0;for(let o=0;o<this.rowIndex;o++)r+=t[o];const s=t[this.rowIndex];return{topOffset:r,rowHeight:s}}onVirtualColumnsChanged(e=!1){const t=this.getUpdatedHeaderCtrls(),n=this.isEnsureDomOrder||this.isPrintLayout;this.comp.setHeaderCtrls(t,n,e)}getUpdatedHeaderCtrls(){const e=this.ctrlsById;this.ctrlsById=new Map;const t=this.getColumnsInViewport();for(const i of t)this.recycleAndCreateHeaderCtrls(i,this.ctrlsById,e);const n=i=>{const{focusSvc:r,visibleCols:s}=this.beans;return r.isHeaderWrapperFocused(i)?s.isVisible(i.column):!1};if(e)for(const[i,r]of e)n(r)?this.ctrlsById.set(i,r):this.destroyBean(r);return this.allCtrls=Array.from(this.ctrlsById.values()),this.allCtrls}getHeaderCellCtrls(){return this.allCtrls}recycleAndCreateHeaderCtrls(e,t,n){if(e.isEmptyGroup())return;const i=e.getUniqueId();let r;if(n&&(r=n.get(i),n.delete(i)),r&&r.column!=e&&(this.destroyBean(r),r=void 0),r==null)switch(this.type){case"filter":{r=this.createBean(this.beans.registry.createDynamicBean("headerFilterCellCtrl",!0,e,this));break}case"group":r=this.createBean(this.beans.registry.createDynamicBean("headerGroupCellCtrl",!0,e,this));break;default:r=this.createBean(new g8e(e,this));break}t.set(i,r)}getColumnsInViewport(){return this.isPrintLayout?this.getColumnsInViewportPrintLayout():this.getColumnsInViewportNormalLayout()}getColumnsInViewportPrintLayout(){if(this.pinned!=null)return[];let e=[];const t=this.getActualDepth(),{colViewport:n}=this.beans;return["left",null,"right"].forEach(i=>{const r=n.getHeadersToRender(i,t);e=e.concat(r)}),e}getActualDepth(){return this.type=="filter"?this.rowIndex-1:this.rowIndex}getColumnsInViewportNormalLayout(){return this.beans.colViewport.getHeadersToRender(this.pinned,this.getActualDepth())}focusHeader(e,t){const n=this.allCtrls.find(r=>r.column==e);return n?n.focus(t):!1}destroy(){this.allCtrls=this.destroyBeans(this.allCtrls),this.ctrlsById=void 0,super.destroy()}},v8e=class extends Z{constructor(e){super(),this.pinned=e,this.hidden=!1,this.includeFloatingFilter=!1,this.groupsRowCtrls=[]}setComp(e,t){this.comp=e,this.eViewport=t;const{pinnedCols:n,ctrlsSvc:i,colModel:r,colMoves:s,filterManager:o}=this.beans;this.setupCenterWidth(),n?.setupHeaderPinnedWidth(this),this.setupDragAndDrop(s,this.eViewport);const a=this.onDisplayedColumnsChanged.bind(this,o);this.addManagedEventListeners({gridColumnsChanged:this.onGridColumnsChanged.bind(this),displayedColumnsChanged:a,advancedFilterEnabledChanged:a});const l=`${typeof this.pinned=="string"?this.pinned:"center"}Header`;i.register(l,this),r.ready&&this.refresh()}getAllCtrls(){const e=[...this.groupsRowCtrls];return this.columnsRowCtrl&&e.push(this.columnsRowCtrl),this.filtersRowCtrl&&e.push(this.filtersRowCtrl),e}refresh(e=!1){const{focusSvc:t,colModel:n,filterManager:i}=this.beans;let r=0;const s=t.getFocusHeaderToUseAfterRefresh(),o=()=>{const c=n8e(n)-1;this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls);for(let d=0;d<c;d++){const h=this.createBean(new KD(r++,this.pinned,"group"));this.groupsRowCtrls.push(h)}},a=()=>{const c=r++,d=!this.hidden&&(this.columnsRowCtrl==null||!e||this.columnsRowCtrl.rowIndex!==c);(d||this.hidden)&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),d&&(this.columnsRowCtrl=this.createBean(new KD(c,this.pinned,"column")))},l=()=>{this.includeFloatingFilter=!!i?.hasFloatingFilters()&&!this.hidden;const c=()=>{this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)};if(!this.includeFloatingFilter){c();return}const d=r++;if(this.filtersRowCtrl){const h=this.filtersRowCtrl.rowIndex!==d;(!e||h)&&c()}this.filtersRowCtrl||(this.filtersRowCtrl=this.createBean(new KD(d,this.pinned,"filter")))};o(),a(),l();const u=this.getAllCtrls();this.comp.setCtrls(u),this.restoreFocusOnHeader(t,s)}getHeaderCtrlForColumn(e){const t=n=>n?.getHeaderCellCtrls().find(i=>i.column===e);if(pc(e))return t(this.columnsRowCtrl);if(this.groupsRowCtrls.length!==0)for(let n=0;n<this.groupsRowCtrls.length;n++){const i=t(this.groupsRowCtrls[n]);if(i)return i}}getHtmlElementForColumnHeader(e){return this.getHeaderCtrlForColumn(e)?.eGui??null}getRowType(e){return this.getAllCtrls()[e]?.type}focusHeader(e,t,n){const r=this.getAllCtrls()[e];return r?r.focusHeader(t,n):!1}getGroupRowCount(){return this.groupsRowCtrls.length}getGroupRowCtrlAtIndex(e){return this.groupsRowCtrls[e]}getRowCount(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)}setHorizontalScroll(e){this.comp.setViewportScrollLeft(e)}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}destroy(){this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl),this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl),this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls),super.destroy()}setupDragAndDrop(e,t){const n=e?.createBodyDropTarget(this.pinned,t);n&&this.createManagedBean(n)}restoreFocusOnHeader(e,t){if(!t)return;const{column:n}=t;n.getPinned()==this.pinned&&e.focusHeaderPosition({headerPosition:t})}onGridColumnsChanged(){this.refresh(!0)}onDisplayedColumnsChanged(e){const t=!!e?.hasFloatingFilters()&&!this.hidden;this.includeFloatingFilter!==t&&this.refresh(!0)}setupCenterWidth(){this.pinned==null&&this.createManagedBean(new wN(e=>this.comp.setCenterWidth(`${e}px`),!0))}},C8e=class extends Z{constructor(){super(...arguments),this.beanName="menuSvc"}postConstruct(){const{enterpriseMenuFactory:e,filterMenuFactory:t}=this.beans;this.activeMenuFactory=e??t}showColumnMenu(e){this.showColumnMenuCommon(this.activeMenuFactory,e,"columnMenu")}showFilterMenu(e){const{enterpriseMenuFactory:t,filterMenuFactory:n}=this.beans,i=t&&Zr(this.gos)?t:n;this.showColumnMenuCommon(i,e,e.containerType,!0)}showHeaderContextMenu(e,t,n){this.activeMenuFactory?.showMenuAfterContextMenuEvent(e,t,n)}hidePopupMenu(){this.beans.contextMenuSvc?.hideActiveMenu(),this.activeMenuFactory?.hideActiveMenu()}isColumnMenuInHeaderEnabled(e){const{suppressHeaderMenuButton:t}=e.getColDef();return!t&&!!this.activeMenuFactory?.isMenuEnabled(e)&&(Zr(this.gos)||!!this.beans.enterpriseMenuFactory)}isFilterMenuInHeaderEnabled(e){return!e.getColDef().suppressHeaderFilterButton&&!!this.beans.filterManager?.isFilterAllowed(e)}isHeaderContextMenuEnabled(e){return!(e&&pc(e)?e.getColDef():e?.getColGroupDef())?.suppressHeaderContextMenu&&this.gos.get("columnMenu")==="new"}isHeaderMenuButtonAlwaysShowEnabled(){return this.isSuppressMenuHide()}isHeaderMenuButtonEnabled(){const e=!this.isSuppressMenuHide();return!(Nd()&&e)}isHeaderFilterButtonEnabled(e){return this.isFilterMenuInHeaderEnabled(e)&&!Zr(this.gos)&&!this.isFloatingFilterButtonDisplayed(e)}isFilterMenuItemEnabled(e){return!!this.beans.filterManager?.isFilterAllowed(e)&&!Zr(this.gos)&&!this.isFilterMenuInHeaderEnabled(e)&&!this.isFloatingFilterButtonDisplayed(e)}isFloatingFilterButtonEnabled(e){return!e.getColDef().suppressFloatingFilterButton}isFloatingFilterButtonDisplayed(e){return!!e.getColDef().floatingFilter&&this.isFloatingFilterButtonEnabled(e)}isSuppressMenuHide(){const e=this.gos,t=e.get("suppressMenuHide");return Zr(e)?e.exists("suppressMenuHide")?t:!1:t}showColumnMenuCommon(e,t,n,i){const{positionBy:r,onClosedCallback:s}=t,o=t.column;if(r==="button"){const{buttonElement:a}=t;e?.showMenuAfterButtonClick(o,a,n,s,i)}else if(r==="mouse"){const{mouseEvent:a}=t;e?.showMenuAfterMouseEvent(o,a,n,s,i)}else if(o){const a=this.beans,l=a.ctrlsSvc;l.getScrollFeature().ensureColumnVisible(o,"auto"),lu(a,()=>{const u=l.getHeaderRowContainerCtrl(o.getPinned())?.getHeaderCtrlForColumn(o);u&&e?.showMenuAfterButtonClick(o,u.getAnchorElementForMenu(i),n,s,!0)})}}};function DW(e,t,n){e.menuVisible!==t&&(e.menuVisible=t,e.dispatchColEvent("menuVisibleChanged",n))}var xte=class extends At{constructor(){super()}},y8e={tag:"span",cls:"ag-overlay-loading-center",attrs:{"aria-live":"polite","aria-atomic":"true"}},w8e=class extends xte{init(){const e=Il(this.gos.get("overlayLoadingTemplate")?.trim());if(this.setTemplate(e??y8e),!e){const t=this.getLocaleTextFunc();setTimeout(()=>{this.getGui().textContent=t("loadingOoo","Loading...")})}}},b8e={tag:"span",cls:"ag-overlay-no-rows-center"},S8e=class extends xte{init(){const e=Il(this.gos.get("overlayNoRowsTemplate")?.trim());if(this.setTemplate(e??b8e),!e){const t=this.getLocaleTextFunc();setTimeout(()=>{this.getGui().textContent=t("noRowsToShow","No Rows To Show")})}}};function x8e(e,t,n){const i=Os(e,t,n);if(i){const{className:s}=i;if(typeof s=="string"&&s.indexOf("ag-icon")>-1||typeof s=="object"&&s["ag-icon"])return i}const r=Sn({tag:"span"});return r.appendChild(i),r}function Os(e,t,n){let i=null;e==="smallDown"?de(262):e==="smallLeft"?de(263):e==="smallRight"&&de(264);const r=n&&n.getColDef().icons;if(r&&(i=r[e]),t.gos&&!i){const s=t.gos.get("icons");s&&(i=s[e])}if(i){let s;if(typeof i=="function")s=i();else if(typeof i=="string")s=i;else{de(38,{iconName:e});return}if(typeof s=="string")return UR(s);if(uN(s))return s;de(133,{iconName:e});return}else{const s=t.registry.getIcon(e);return s||t.validation?.validateIcon(e),Sn({tag:"span",cls:`ag-icon ag-icon-${s??e}`,role:"presentation",attrs:{unselectable:"on"}})}}var R8e=".ag-dnd-ghost{align-items:center;background-color:var(--ag-drag-and-drop-image-background-color);border:var(--ag-drag-and-drop-image-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-drag-and-drop-image-shadow);color:var(--ag-text-color);cursor:move;display:flex;font-weight:500;gap:var(--ag-cell-widget-spacing);height:var(--ag-header-height);overflow:hidden;padding-left:var(--ag-cell-horizontal-padding);padding-right:var(--ag-cell-horizontal-padding);text-overflow:ellipsis;transform:translateY(calc(var(--ag-spacing)*2));white-space:nowrap}",E8e={tag:"div",children:[{tag:"div",ref:"eGhost",cls:"ag-dnd-ghost ag-unselectable",children:[{tag:"span",ref:"eIcon",cls:"ag-dnd-ghost-icon ag-shake-left-to-right"},{tag:"div",ref:"eLabel",cls:"ag-dnd-ghost-label"}]}]},F8e=class extends At{constructor(){super(),this.dragSource=null,this.eIcon=ve,this.eLabel=ve,this.eGhost=ve,this.registerCSS(R8e)}postConstruct(){const e=t=>x8e(t,this.beans,null);this.dropIconMap={pinned:e("columnMovePin"),hide:e("columnMoveHide"),move:e("columnMoveMove"),left:e("columnMoveLeft"),right:e("columnMoveRight"),group:e("columnMoveGroup"),aggregate:e("columnMoveValue"),pivot:e("columnMovePivot"),notAllowed:e("dropNotAllowed")}}init(e){this.dragSource=e.dragSource,this.setTemplate(E8e),this.beans.environment.applyThemeClasses(this.eGhost)}destroy(){this.dragSource=null,super.destroy()}setIcon(e,t){const{eIcon:n,dragSource:i,dropIconMap:r,gos:s}=this;Gi(n);let o=null;e||(e=i?.getDefaultIconName?i.getDefaultIconName():"notAllowed"),o=r[e],n.classList.toggle("ag-shake-left-to-right",t),!(o===r.hide&&s.get("suppressDragLeaveHidesColumns"))&&o&&n.appendChild(o)}setLabel(e){this.eLabel.textContent=e}},A8e=".ag-label{white-space:nowrap}:where(.ag-ltr) .ag-label{margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-label{margin-left:var(--ag-spacing)}:where(.ag-label-align-right) .ag-label{order:1}:where(.ag-ltr) :where(.ag-label-align-right) .ag-label{margin-left:var(--ag-spacing)}:where(.ag-rtl) :where(.ag-label-align-right) .ag-label{margin-right:var(--ag-spacing)}.ag-label-align-right>*{flex:none}.ag-label-align-top{align-items:flex-start;flex-direction:column;>*{align-self:stretch}}.ag-label-ellipsis{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:where(.ag-label-align-top) .ag-label{margin-bottom:calc(var(--ag-spacing)*.5)}",D8e=class extends At{constructor(e,t,n){super(t,n),this.labelSeparator="",this.labelAlignment="left",this.disabled=!1,this.label="",this.config=e||{},this.registerCSS(A8e)}postConstruct(){this.addCssClass("ag-labeled"),this.eLabel.classList.add("ag-label");const{labelSeparator:e,label:t,labelWidth:n,labelAlignment:i,disabled:r}=this.config;r!=null&&this.setDisabled(r),e!=null&&this.setLabelSeparator(e),t!=null&&this.setLabel(t),n!=null&&this.setLabelWidth(n),this.setLabelAlignment(i||this.labelAlignment),this.refreshLabel()}refreshLabel(){const{label:e,eLabel:t}=this;Gi(t),typeof e=="string"?t.innerText=e+this.labelSeparator:e&&t.appendChild(e),e===""?(tn(t,!1),Vl(t,"presentation")):(tn(t,!0),Vl(t,null))}setLabelSeparator(e){return this.labelSeparator===e?this:(this.labelSeparator=e,this.label!=null&&this.refreshLabel(),this)}getLabelId(){const e=this.eLabel;return e.id=e.id||`ag-${this.getCompId()}-label`,e.id}getLabel(){return this.label}setLabel(e){return this.label===e?this:(this.label=e,this.refreshLabel(),this)}setLabelAlignment(e){const n=this.getGui().classList;return n.toggle("ag-label-align-left",e==="left"),n.toggle("ag-label-align-right",e==="right"),n.toggle("ag-label-align-top",e==="top"),this}setLabelEllipsis(e){return this.eLabel.classList.toggle("ag-label-ellipsis",e),this}setLabelWidth(e){return this.label==null?this:(o1(this.eLabel,e),this)}setDisabled(e){e=!!e;const t=this.getGui();return y0(t,e),t.classList.toggle("ag-disabled",e),this.disabled=e,this}isDisabled(){return!!this.disabled}},Rte=class extends D8e{constructor(e,t,n,i){super(e,t,n),this.className=i}postConstruct(){super.postConstruct();const{width:e,value:t,onValueChange:n}=this.config;e!=null&&this.setWidth(e),t!=null&&this.setValue(t),n!=null&&this.onValueChange(n),this.className&&this.addCssClass(this.className),this.refreshAriaLabelledBy()}setLabel(e){return super.setLabel(e),this.refreshAriaLabelledBy(),this}refreshAriaLabelledBy(){const e=this.getAriaElement(),t=this.getLabelId(),n=this.getLabel();n==null||n==""||f5e(e)!==null?qM(e,""):qM(e,t??"")}setAriaLabel(e){return WR(this.getAriaElement(),e),this.refreshAriaLabelledBy(),this}onValueChange(e){return this.addManagedListeners(this,{fieldValueChanged:()=>e(this.getValue())}),this}getWidth(){return this.getGui().clientWidth}setWidth(e){return Ra(this.getGui(),e),this}getPreviousValue(){return this.previousValue}getValue(){return this.value}setValue(e,t){return this.value===e?this:(this.previousValue=this.value,this.value=e,t||this.dispatchLocalEvent({type:"fieldValueChanged"}),this)}};function k8e(e){return{tag:"div",role:"presentation",children:[{tag:"div",ref:"eLabel",cls:"ag-input-field-label"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-input-wrapper",role:"presentation",children:[{tag:e,ref:"eInput",cls:"ag-input-field-input"}]}]}}var Rd=class extends Rte{constructor(e,t,n="text",i="input"){super(e,e?.template??k8e(i),[],t),this.inputType=n,this.displayFieldTag=i,this.eLabel=ve,this.eWrapper=ve,this.eInput=ve}postConstruct(){super.postConstruct(),this.setInputType();const{eLabel:e,eWrapper:t,eInput:n,className:i}=this;e.classList.add(`${i}-label`),t.classList.add(`${i}-input-wrapper`),n.classList.add(`${i}-input`),this.addCssClass("ag-input-field"),n.id=n.id||`ag-${this.getCompId()}-input`;const{inputName:r,inputWidth:s}=this.config;r!=null&&this.setInputName(r),s!=null&&this.setInputWidth(s),this.addInputListeners(),this.activateTabIndex([n])}addInputListeners(){this.addManagedElementListeners(this.eInput,{input:e=>this.setValue(e.target.value)})}setInputType(){this.displayFieldTag==="input"&&this.eInput.setAttribute("type",this.inputType)}getInputElement(){return this.eInput}setInputWidth(e){return o1(this.eWrapper,e),this}setInputName(e){return this.getInputElement().setAttribute("name",e),this}getFocusableElement(){return this.eInput}setMaxLength(e){const t=this.eInput;return t.maxLength=e,this}setInputPlaceholder(e){return $s(this.eInput,"placeholder",e),this}setInputAriaLabel(e){return WR(this.eInput,e),this.refreshAriaLabelledBy(),this}setDisabled(e){return y0(this.eInput,e),super.setDisabled(e)}setAutoComplete(e){if(e===!0)$s(this.eInput,"autocomplete",null);else{const t=typeof e=="string"?e:"off";$s(this.eInput,"autocomplete",t)}return this}},AN=class extends Rd{constructor(e,t="ag-checkbox",n="checkbox"){super(e,t,n),this.labelAlignment="right",this.selected=!1,this.readOnly=!1,this.passive=!1}postConstruct(){super.postConstruct();const{readOnly:e,passive:t}=this.config;typeof e=="boolean"&&this.setReadOnly(e),typeof t=="boolean"&&this.setPassive(t)}addInputListeners(){this.addManagedElementListeners(this.eInput,{click:this.onCheckboxClick.bind(this)}),this.addManagedElementListeners(this.eLabel,{click:this.toggle.bind(this)})}getNextValue(){return this.selected===void 0?!0:!this.selected}setPassive(e){this.passive=e}isReadOnly(){return this.readOnly}setReadOnly(e){this.eWrapper.classList.toggle("ag-disabled",e),this.eInput.disabled=e,this.readOnly=e}setDisabled(e){return this.eWrapper.classList.toggle("ag-disabled",e),super.setDisabled(e)}toggle(){if(this.eInput.disabled)return;const e=this.isSelected(),t=this.getNextValue();this.passive?this.dispatchChange(t,e):this.setValue(t)}getValue(){return this.isSelected()}setValue(e,t){return this.refreshSelectedClass(e),this.setSelected(e,t),this}setName(e){const t=this.getInputElement();return t.name=e,this}isSelected(){return this.selected}setSelected(e,t){if(this.isSelected()===e)return;this.previousValue=this.isSelected(),e=this.selected=typeof e=="boolean"?e:void 0;const n=this.eInput;n.checked=e,n.indeterminate=e===void 0,t||this.dispatchChange(this.selected,this.previousValue)}dispatchChange(e,t,n){this.dispatchLocalEvent({type:"fieldValueChanged",selected:e,previousValue:t,event:n});const i=this.getInputElement();this.eventSvc.dispatchEvent({type:"checkboxChanged",id:i.id,name:i.name,selected:e,previousValue:t})}onCheckboxClick(e){if(this.passive||this.eInput.disabled)return;const t=this.isSelected(),n=this.selected=e.target.checked;this.refreshSelectedClass(n),this.dispatchChange(n,t,e)}refreshSelectedClass(e){const t=this.eWrapper.classList;t.toggle("ag-checked",e===!0),t.toggle("ag-indeterminate",e==null)}},DN={selector:"AG-CHECKBOX",component:AN},P8e=".ag-checkbox-cell{height:100%}",M8e={tag:"div",cls:"ag-cell-wrapper ag-checkbox-cell",role:"presentation",children:[{tag:"ag-checkbox",ref:"eCheckbox",role:"presentation"}]},T8e=class extends At{constructor(){super(M8e,[DN]),this.eCheckbox=ve,this.registerCSS(P8e)}init(e){this.refresh(e);const{eCheckbox:t,beans:n}=this,i=t.getInputElement();i.setAttribute("tabindex","-1"),JJ(i,"polite"),this.addManagedListeners(i,{click:r=>{if(Bp(r),t.isDisabled())return;const s=t.getValue();this.onCheckboxChanged(s)},dblclick:r=>{Bp(r)}}),this.addManagedElementListeners(e.eGridCell,{keydown:r=>{if(r.key===X.SPACE&&!t.isDisabled()){e.eGridCell===nn(n)&&t.toggle();const s=t.getValue();this.onCheckboxChanged(s),r.preventDefault()}}})}refresh(e){return this.params=e,this.updateCheckbox(e),!0}updateCheckbox(e){let t,n=!0;const{value:i,column:r,node:s}=e;if(s.group&&r)if(typeof i=="boolean")t=i;else{const d=r.getColId();d.startsWith(qR)?t=i==null||i===""?void 0:i==="true":s.aggData&&s.aggData[d]!==void 0?t=i??void 0:n=!1}else t=i??void 0;const{eCheckbox:o}=this;if(!n){o.setDisplayed(!1);return}o.setValue(t);const a=e.disabled??!r?.isCellEditable(s);o.setDisabled(a);const l=this.getLocaleTextFunc(),u=sN(l,t),c=a?u:`${l("ariaToggleCellValue","Press SPACE to toggle cell value")} (${u})`;o.setInputAriaLabel(c)}onCheckboxChanged(e){const{eventSvc:t,params:n}=this,{column:i,node:r,value:s}=n,o={column:i,colDef:i.getColDef(),data:r.data,node:r,rowIndex:r.rowIndex,rowPinned:r.rowPinned,value:s};t.dispatchEvent({type:"cellEditingStarted",...o});const a=r.setDataValue(i,e,"edit");t.dispatchEvent({type:"cellEditingStopped",...o,oldValue:s,newValue:e,valueChanged:a}),a||this.updateCheckbox(n)}},I8e="ROOT_NODE_ID",_8e=class extends Z{constructor(){super(...arguments),this.nextId=0,this.allNodesMap={},this.rootNode=null}get treeData(){return!1}getRowNode(e){return this.allNodesMap[e]}extractRowData(){return this.rootNode?.allLeafChildren?.map(e=>e.data)}activate(e){this.rootNode=e,e.group=!0,e.level=-1,e.id=I8e,e.allLeafChildren=[],e.childrenAfterGroup=[],e.childrenAfterSort=[],e.childrenAfterAggFilter=[],e.childrenAfterFilter=[],this.updateRootSiblingArrays(e)}deactivate(){this.rootNode&&(this.allNodesMap={},this.rootNode=null)}destroy(){super.destroy(),this.allNodesMap={},this.rootNode=null}setNewRowData(e){const t=this.rootNode;t&&(this.dispatchRowDataUpdateStartedEvent(e),t.childrenAfterFilter=null,t.childrenAfterGroup=null,t.childrenAfterAggFilter=null,t.childrenAfterSort=null,t.childrenMapped=null,t.updateHasChildren(),this.allNodesMap={},this.nextId=0,this.loadNewRowData(e),this.updateRootSiblingArrays(t))}updateRootSiblingArrays(e){const t=e.sibling;t&&(t.childrenAfterFilter=e.childrenAfterFilter,t.childrenAfterGroup=e.childrenAfterGroup,t.childrenAfterAggFilter=e.childrenAfterAggFilter,t.childrenAfterSort=e.childrenAfterSort,t.childrenMapped=e.childrenMapped,t.allLeafChildren=e.allLeafChildren)}loadNewRowData(e){this.rootNode.allLeafChildren=e?.map((t,n)=>this.createRowNode(t,n))??[]}setImmutableRowData(e,t){const n=$p(this.gos),i=!this.gos.get("suppressMaintainUnsortedOrder"),r=e.changedRowNodes,s=new Set,o=this.rootNode,a=o.allLeafChildren,l=a.length;let u=!1,c=!1,d=!1,h=!1;for(let g=0,m=-1,C=t.length;g<C;g++){const y=t[g];let b=this.getRowNode(n({data:y,level:0}));if(!b)u=!0,b=this.createRowNode(y,-1),r.add(b);else{if(i){const S=b.sourceRowIndex;h||(h=S<=m||u),m=S}b.data!==y&&(d=!0,b.updateData(y),r.update(b))}s.add(b)}const p=[];for(let g=0;g<l;g++){const m=a[g];s.has(m)||(c=!0,m.isSelected()&&p.push(m),this.rowNodeDeleted(m),r.remove(m))}if(u||c||h){const g=new Array(s.size);let m=0;if(!i)for(let y=0;y<l;++y){const b=a[y];s.delete(b)&&(b.sourceRowIndex=m,g[m++]=b)}for(const y of s)y.sourceRowIndex=m,g[m++]=y;o.allLeafChildren=g;const C=o.sibling;C&&(C.allLeafChildren=g),e.rowNodesOrderChanged||(e.rowNodesOrderChanged=h)}(u||c||h||d)&&(this.deselectNodes(p),e.rowDataUpdated=!0)}rowNodeDeleted(e){e.clearRowTopAndRowIndex();const t=e.id,n=this.allNodesMap;n[t]===e&&delete n[t]}updateRowData(e,t){this.dispatchRowDataUpdateStartedEvent(e.add);const n={changedRowNodes:t,rowNodeTransaction:{remove:[],update:[],add:[]},rowsInserted:!1},i=[],r=$p(this.gos);return this.executeRemove(r,e,n,i),this.executeUpdate(r,e,n,i),this.executeAdd(e,n),this.deselectNodes(i),n}executeAdd(e,t){const n=e.add;if(!n?.length)return;let i=this.rootNode.allLeafChildren,r=i.length;if(typeof e.addIndex=="number"&&(r=this.sanitizeAddIndex(e.addIndex),r>0&&this.gos.get("treeData")&&this.gos.get("getDataPath"))){for(let d=0;d<i.length;d++)if(i[d]?.rowIndex==r-1){r=d+1;break}}const s=n.length,o=t.changedRowNodes,a=new Array(s);for(let c=0;c<s;c++){const d=this.createRowNode(n[c],r+c);o.add(d),a[c]=d}const l=this.rootNode;if(r<i.length){const c=i.slice(0,r),d=i.slice(r,i.length),h=c.length+a.length;for(let p=0,g=d.length;p<g;++p)d[p].sourceRowIndex=h+p;i=[...c,...a,...d],t.rowsInserted=!0}else i=i.concat(a);l.allLeafChildren=i;const u=l.sibling;u&&(u.allLeafChildren=i),t.rowNodeTransaction.add=a}executeRemove(e,t,{changedRowNodes:n,rowNodeTransaction:i},r){const{remove:s}=t;if(!s?.length)return;const o={};s.forEach(u=>{const c=this.lookupRowNode(e,u);c&&(c.isSelected()&&r.push(c),c.clearRowTopAndRowIndex(),o[c.id]=!0,delete this.allNodesMap[c.id],i.remove.push(c),n.remove(c))});const a=this.rootNode;a.allLeafChildren=a.allLeafChildren?.filter(u=>!o[u.id])??null,a.allLeafChildren?.forEach((u,c)=>{u.sourceRowIndex=c});const l=a.sibling;l&&(l.allLeafChildren=a.allLeafChildren)}executeUpdate(e,t,{changedRowNodes:n,rowNodeTransaction:i},r){const{update:s}=t;s?.length&&s.forEach(o=>{const a=this.lookupRowNode(e,o);a&&(a.updateData(o),!a.selectable&&a.isSelected()&&r.push(a),i.update.push(a),n.update(a))})}dispatchRowDataUpdateStartedEvent(e){this.eventSvc.dispatchEvent({type:"rowDataUpdateStarted",firstRowData:e?.length?e[0]:null})}deselectNodes(e){const t="rowDataChanged",n=this.beans.selectionSvc,i=e.length>0;i&&n?.setNodesSelected({newValue:!1,nodes:e,suppressFinishActions:!0,source:t}),n?.updateGroupsFromChildrenSelections?.(t),i&&this.eventSvc.dispatchEvent({type:"selectionChanged",source:t,selectedNodes:n?.getSelectedNodes()??null,serverSideState:null})}sanitizeAddIndex(e){const t=this.rootNode.allLeafChildren?.length??0;return e<0||e>=t||Number.isNaN(e)?t:Math.ceil(e)}createRowNode(e,t){const n=new Vp(this.beans);return n.parent=this.rootNode,n.level=0,n.group=!1,n.expanded=!1,n.sourceRowIndex=t,n.setDataAndId(e,String(this.nextId)),this.allNodesMap[n.id]&&de(2,{nodeId:n.id}),this.allNodesMap[n.id]=n,this.nextId++,n}lookupRowNode(e,t){let n;if(e){const i=e({data:t,level:0});if(n=this.allNodesMap[i],!n)return Ft(4,{id:i}),null}else if(n=this.rootNode?.allLeafChildren?.find(i=>i.data===t),!n)return Ft(5,{data:t}),null;return n||null}},O8e={tag:"div",cls:"ag-selection-checkbox",role:"presentation",children:[{tag:"ag-checkbox",ref:"eCheckbox",role:"presentation"}]},L8e=class extends At{constructor(){super(O8e,[DN]),this.eCheckbox=ve}postConstruct(){this.eCheckbox.setPassive(!0)}getCheckboxId(){return this.eCheckbox.getInputElement().id}onDataChanged(){this.onSelectionChanged()}onSelectableChanged(){this.showOrHideSelect()}onSelectionChanged(){const e=this.getLocaleTextFunc(),{rowNode:t,eCheckbox:n}=this,i=t.isSelected(),r=sN(e,i),[s,o]=t.selectable?["ariaRowToggleSelection","Press Space to toggle row selection"]:["ariaRowSelectionDisabled","Row Selection is disabled for this row"],a=e(s,o);n.setValue(i,!0),n.setInputAriaLabel(`${a} (${r})`)}init(e){if(this.rowNode=e.rowNode,this.column=e.column,this.overrides=e.overrides,this.onSelectionChanged(),this.addManagedListeners(this.eCheckbox.getInputElement(),{dblclick:Bp,click:i=>{Bp(i),this.beans.selectionSvc?.handleSelectionEvent(i,this.rowNode,"checkboxSelected")}}),this.addManagedListeners(this.rowNode,{rowSelected:this.onSelectionChanged.bind(this),dataChanged:this.onDataChanged.bind(this),selectableChanged:this.onSelectableChanged.bind(this)}),this.addManagedPropertyListener("rowSelection",({currentValue:i,previousValue:r})=>{const s=typeof i=="object"?GD(i):void 0,o=typeof r=="object"?GD(r):void 0;s!==o&&this.onSelectableChanged()}),rT(this.gos)||typeof this.getIsVisible()=="function"){const i=this.showOrHideSelect.bind(this);this.addManagedEventListeners({displayedColumnsChanged:i}),this.addManagedListeners(this.rowNode,{dataChanged:i,cellChanged:i}),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")}showOrHideSelect(){const{column:e,rowNode:t,overrides:n,gos:i}=this;let r=t.selectable;const s=this.getIsVisible();if(r)if(typeof s=="function"){const l=n?.callbackParams;if(!e)r=s({...l,node:t,data:t.data});else{const u=e.createColumnFunctionCallbackParams(t);r=s({...l,...u})}}else r=s??!1;const o=i.get("rowSelection");if(o&&typeof o!="string"?!GD(o):e?.getColDef().showDisabledCheckboxes){this.eCheckbox.setDisabled(!r),this.setVisible(!0),this.setDisplayed(!0);return}if(n?.removeHidden){this.setDisplayed(r);return}this.setVisible(r)}getIsVisible(){const e=this.overrides;if(e)return e.isVisible;const t=this.gos.get("rowSelection");return t&&typeof t!="string"?Kf(t):this.column?.getColDef()?.checkboxSelection}},N8e=class{constructor(e){this.rowModel=e,this.selectAll=!1,this.rootId=null,this.endId=null,this.cachedRange=[]}reset(){this.rootId=null,this.endId=null,this.cachedRange.length=0}setRoot(e){this.rootId=e.id,this.endId=null,this.cachedRange.length=0}setEndRange(e){this.endId=e.id,this.cachedRange.length=0}getRange(){if(this.cachedRange.length===0){const e=this.getRoot(),t=this.getEnd();if(e==null||t==null)return this.cachedRange;this.cachedRange=this.rowModel.getNodesInRangeForSelection(e,t)??[]}return this.cachedRange}isInRange(e){return this.rootId===null?!1:this.getRange().some(t=>t.id===e.id)}getRoot(e){return this.rootId?this.rowModel.getRowNode(this.rootId)??null:e?(this.setRoot(e),e):null}getEnd(){return this.endId?this.rowModel.getRowNode(this.endId)??null:null}truncate(e){const t=this.getRange();if(t.length===0)return{keep:[],discard:[]};const n=t[0].id===this.rootId,i=t.findIndex(r=>r.id===e.id);if(i>-1){const r=t.slice(0,i),s=t.slice(i+1);return this.setEndRange(e),n?{keep:r,discard:s}:{keep:s,discard:r}}else return{keep:t,discard:[]}}extend(e,t=!1){const n=this.getRoot();if(n==null){const r=this.getRange().slice();return t&&e.depthFirstSearch(s=>!s.group&&r.push(s)),r.push(e),this.setRoot(e),{keep:r,discard:[]}}const i=this.rowModel.getNodesInRangeForSelection(n,e);if(!i)return this.setRoot(e),{keep:[e],discard:[]};if(i.find(r=>r.id===this.endId))return this.setEndRange(e),{keep:this.getRange(),discard:[]};{const r=this.getRange().slice();return this.setEndRange(e),{keep:this.getRange(),discard:r}}}},$8e=class extends Z{constructor(e){super(),this.column=e,this.cbSelectAllVisible=!1,this.processingEventFromCheckbox=!1}onSpaceKeyDown(e){const t=this.cbSelectAll;t.isDisplayed()&&!t.getGui().contains(nn(this.beans))&&(e.preventDefault(),t.setValue(!t.getValue()))}getCheckboxGui(){return this.cbSelectAll.getGui()}setComp(e){this.headerCellCtrl=e;const t=this.createManagedBean(new AN);this.cbSelectAll=t,t.addCssClass("ag-header-select-all"),Vl(t.getGui(),"presentation"),this.showOrHideSelectAll(),this.addManagedEventListeners({newColumnsLoaded:()=>this.showOrHideSelectAll(),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),selectionChanged:this.onSelectionChanged.bind(this),paginationChanged:this.onSelectionChanged.bind(this),modelUpdated:this.onModelChanged.bind(this)}),this.addManagedPropertyListener("rowSelection",({currentValue:n,previousValue:i})=>{const r=s=>typeof s=="string"||!s||s.mode==="singleRow"?void 0:s.selectAll;r(n)!==r(i)&&this.showOrHideSelectAll()}),this.addManagedListeners(t,{fieldValueChanged:this.onCbSelectAll.bind(this)}),t.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()}onDisplayedColumnsChanged(e){this.isAlive()&&this.showOrHideSelectAll(e.source==="uiColumnMoved")}showOrHideSelectAll(e=!1){const t=this.isCheckboxSelection();this.cbSelectAllVisible=t,this.cbSelectAll.setDisplayed(t),t&&(this.checkRightRowModelType("selectAllCheckbox"),this.checkSelectionType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel(e)}onModelChanged(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}onSelectionChanged(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}updateStateOfCheckbox(){if(this.processingEventFromCheckbox)return;this.processingEventFromCheckbox=!0;const e=this.getSelectAllMode(),t=this.beans.selectionSvc,n=this.cbSelectAll,i=t.getSelectAllState(e);n.setValue(i);const r=t.hasNodesToSelect(e);n.setDisabled(!r),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}refreshSelectAllLabel(e=!1){const t=this.getLocaleTextFunc(),{headerCellCtrl:n,cbSelectAll:i,cbSelectAllVisible:r}=this,o=i.getValue()?t("ariaChecked","checked"):t("ariaUnchecked","unchecked"),a=t("ariaRowSelectAll","Press Space to toggle all rows selection");n.setAriaDescriptionProperty("selectAll",r?`${a} (${o})`:null),i.setInputAriaLabel(t("ariaHeaderSelection","Column with Header Selection")),e||n.announceAriaDescription()}checkSelectionType(e){return x0(this.gos)?!0:(de(128,{feature:e}),!1)}checkRightRowModelType(e){const{gos:t,rowModel:n}=this.beans;return tr(t)||bg(t)?!0:(de(129,{feature:e,rowModel:n.getType()}),!1)}onCbSelectAll(){if(this.processingEventFromCheckbox||!this.cbSelectAllVisible)return;const e=this.cbSelectAll.getValue(),t=this.getSelectAllMode();let n="uiSelectAll";t==="currentPage"?n="uiSelectAllCurrentPage":t==="filtered"&&(n="uiSelectAllFiltered");const i={source:n,selectAll:t},r=this.beans.selectionSvc;e?r.selectAllRowNodes(i):r.deselectAllRowNodes(i)}isCheckboxSelection(){const{column:e,gos:t,beans:n}=this,i=t.get("rowSelection"),r=e.getColDef(),{headerCheckboxSelection:s}=r;let o=!1;const a=typeof i=="object";if(a){const u=Ul(e),c=gN(e);(l1(i)==="autoGroupColumn"&&c||u&&n.selectionColSvc?.isSelectionColumnEnabled())&&(o=gb(i))}else typeof s=="function"?o=s(ze(t,{column:e,colDef:r})):o=!!s;const l=a?"headerCheckbox":"headerCheckboxSelection";return o&&this.checkRightRowModelType(l)&&this.checkSelectionType(l)}getSelectAllMode(){const e=Fee(this.gos,!1);if(e)return e;const{headerCheckboxSelectionCurrentPageOnly:t,headerCheckboxSelectionFilteredOnly:n}=this.column.getColDef();return t?"currentPage":n?"filtered":"all"}},B8e=class extends Z{postConstruct(){const{gos:e,beans:t}=this;this.selectionCtx=new N8e(t.rowModel),this.addManagedPropertyListeners(["isRowSelectable","rowSelection"],()=>{const n=rT(e);n!==this.isRowSelectable&&(this.isRowSelectable=n,this.updateSelectable())}),this.isRowSelectable=rT(e)}destroy(){super.destroy(),this.selectionCtx.reset()}createCheckboxSelectionComponent(){return new L8e}createSelectAllFeature(e){return new $8e(e)}isMultiSelect(){return x0(this.gos)}onRowCtrlSelected(e,t,n){const i=!!e.rowNode.isSelected();e.forEachGui(n,r=>{r.rowComp.addOrRemoveCssClass("ag-row-selected",i);const s=r.element;KM(s,i),s.contains(nn(this.beans))&&t(r)})}announceAriaRowSelection(e){if(this.isRowSelectionBlocked(e))return;const t=e.isSelected();if(!e.selectable)return;const i=this.getLocaleTextFunc()(t?"ariaRowDeselect":"ariaRowSelect",`Press SPACE to ${t?"deselect":"select"} this row`);this.beans.ariaAnnounce?.announceValue(i,"rowSelection")}isRowSelectionBlocked(e){return!e.selectable||!!e.rowPinned||!Gd(this.gos)}updateRowSelectable(e,t){const n=this.isRowSelectable?.(e)??!0;return this.setRowSelectable(e,n,t),n}setRowSelectable(e,t,n){if(e.selectable!==t){if(e.selectable=t,e.dispatchRowEvent("selectableChanged"),n)return;if(R0(this.gos)){const r=this.calculateSelectedFromChildren(e);this.setNodesSelected({nodes:[e],newValue:r??!1,source:"selectableChanged"});return}e.isSelected()&&!e.selectable&&this.setNodesSelected({nodes:[e],newValue:!1,source:"selectableChanged"})}}calculateSelectedFromChildren(e){let t=!1,n=!1;if(!e.childrenAfterGroup?.length)return e.selectable?e.__selected:null;for(let i=0;i<e.childrenAfterGroup.length;i++){const r=e.childrenAfterGroup[i];let s=r.isSelected();if(!r.selectable){const o=this.calculateSelectedFromChildren(r);if(o===null)continue;s=o}switch(s){case!0:t=!0;break;case!1:n=!0;break;default:return}}if(!(t&&n))return t?!0:n?!1:e.selectable?e.__selected:null}selectRowNode(e,t,n,i="api"){const r=!e.selectable&&t,s=e.__selected===t;if(r||s)return!1;e.__selected=t,e.dispatchRowEvent("rowSelected");const o=e.sibling;return o&&o.footer&&o.__localEventService&&o.dispatchRowEvent("rowSelected"),this.eventSvc.dispatchEvent({...p4e(e,this.gos,"rowSelected"),event:n||null,source:i}),!0}isCellCheckboxSelection(e,t){const n=this.gos.get("rowSelection");if(n&&typeof n!="string"){const i=Ul(e)&&Kf(n);return e.isColumnFunc(t,i)}else return e.isColumnFunc(t,e.colDef.checkboxSelection)}inferNodeSelections(e,t,n,i){const{gos:r,selectionCtx:s}=this,o=e.isSelected(),a=R0(r),l=e6e(r),u=t6e(r),c=this.isMultiSelect(),d=i==="rowClicked";if(d&&a&&e.group||d&&!(l||u))return null;if(t&&n&&c){const h=s.getRoot();if(h)if(h.isSelected()){const p=s.isInRange(e)?s.truncate(e):s.extend(e,a);return{deselect:p.discard,select:p.keep,reset:!1}}else{const p=s.extend(e,a);return{select:[],deselect:p.keep,reset:!1}}else return null}else if(t&&c){const h=s.selectAll?this.beans.rowModel.getRow(0):void 0,p=s.getRoot(h),g=s.isInRange(e)?s.truncate(e):s.extend(e,a);return{select:g.keep,deselect:g.discard,reset:s.selectAll||!!(p&&!p.isSelected())}}else{if(n)return s.setRoot(e),d&&o&&!u?null:{node:e,newValue:!o,clearSelection:!c};{s.setRoot(e);const h=n6e(r),p=c1(r)==="filteredDescendants",g=d&&(!h||!l);if(p&&o===void 0&&tr(r))return{node:e,newValue:!1,clearSelection:!c||g};if(d){const m=o?!h:l;return m===o&&!g||m&&!l||!m&&!u?null:{node:e,newValue:m,clearSelection:!c||g}}return{node:e,newValue:!o,clearSelection:!c||g}}}}},G8e=class extends AN{constructor(e){super(e,"ag-radio-button","radio")}isSelected(){return this.eInput.checked}toggle(){this.eInput.disabled||this.isSelected()||this.setValue(!0)}addInputListeners(){super.addInputListeners(),this.addManagedEventListeners({checkboxChanged:this.onChange.bind(this)})}onChange(e){const t=this.eInput;e.selected&&e.name&&t.name&&t.name===e.name&&e.id&&t.id!==e.id&&this.setValue(!1,!0)}},Bh=class extends Rd{constructor(e,t="ag-text-field",n="text"){super(e,t,n)}postConstruct(){super.postConstruct(),this.config.allowedCharPattern&&this.preventDisallowedCharacters()}setValue(e,t){const n=this.eInput;return n.value!==e&&(n.value=Ce(e)?e:""),super.setValue(e,t)}setStartValue(e){this.setValue(e,!0)}preventDisallowedCharacters(){const e=new RegExp(`[${this.config.allowedCharPattern}]`),t=n=>{fte(n)&&n.key&&!e.test(n.key)&&n.preventDefault()};this.addManagedListeners(this.eInput,{keydown:t,paste:n=>{const i=n.clipboardData?.getData("text");i&&i.split("").some(r=>!e.test(r))&&n.preventDefault()}})}},KR={selector:"AG-INPUT-TEXT-FIELD",component:Bh},z8e=class extends Rd{constructor(e){super(e,"ag-text-area",null,"textarea")}setValue(e,t){const n=super.setValue(e,t);return this.eInput.value=e,n}setCols(e){return this.eInput.cols=e,this}setRows(e){return this.eInput.rows=e,this}},H8e={selector:"AG-INPUT-TEXT-AREA",component:z8e},kN=class extends Bh{constructor(e){super(e,"ag-number-field","number")}postConstruct(){super.postConstruct();const e=this.eInput;this.addManagedListeners(e,{blur:()=>{const s=parseFloat(e.value),o=isNaN(s)?"":this.normalizeValue(s.toString());this.value!==o&&this.setValue(o)},wheel:this.onWheel.bind(this)}),e.step="any";const{precision:t,min:n,max:i,step:r}=this.config;typeof t=="number"&&this.setPrecision(t),typeof n=="number"&&this.setMin(n),typeof i=="number"&&this.setMax(i),typeof r=="number"&&this.setStep(r)}onWheel(e){nn(this.beans)===this.eInput&&e.preventDefault()}normalizeValue(e){if(e==="")return"";this.precision!=null&&(e=this.adjustPrecision(e));const t=parseFloat(e),{min:n,max:i}=this;return n!=null&&t<n?e=n.toString():i!=null&&t>i&&(e=i.toString()),e}adjustPrecision(e,t){const n=this.precision;if(n==null)return e;if(t){const r=parseFloat(e).toFixed(n);return parseFloat(r).toString()}const i=String(e).split(".");if(i.length>1){if(i[1].length<=n)return e;if(n>0)return`${i[0]}.${i[1].slice(0,n)}`}return i[0]}setMin(e){return this.min===e?this:(this.min=e,$s(this.eInput,"min",e),this)}setMax(e){return this.max===e?this:(this.max=e,$s(this.eInput,"max",e),this)}setPrecision(e){return this.precision=e,this}setStep(e){return this.step===e?this:(this.step=e,$s(this.eInput,"step",e),this)}setValue(e,t){return this.setValueOrInputValue(n=>super.setValue(n,t),()=>this,e)}setStartValue(e){return this.setValueOrInputValue(t=>super.setValue(t,!0),t=>{this.eInput.value=t},e)}setValueOrInputValue(e,t,n){if(Ce(n)){let i=this.isScientificNotation(n);if(i&&this.eInput.validity.valid)return e(n);if(!i){n=this.adjustPrecision(n);const r=this.normalizeValue(n);i=n!=r}if(i)return t(n)}return e(n)}getValue(){const e=this.eInput;if(!e.validity.valid)return;const t=e.value;return this.isScientificNotation(t)?this.adjustPrecision(t,!0):super.getValue()}isScientificNotation(e){return typeof e=="string"&&e.includes("e")}},V8e={selector:"AG-INPUT-NUMBER-FIELD",component:kN};function Mv(e,t){return e.toString().padStart(t,"0")}function Bs(e,t=!0,n="-"){if(!e)return null;let i=[e.getFullYear(),e.getMonth()+1,e.getDate()].map(r=>Mv(r,2)).join(n);return t&&(i+=" "+[e.getHours(),e.getMinutes(),e.getSeconds()].map(r=>Mv(r,2)).join(":")),i}var YD=e=>{if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"};function Tv(e,t="YYYY-MM-DD"){const n=Mv(e.getFullYear(),4),i=["January","February","March","April","May","June","July","August","September","October","November","December"],r=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],s={YYYY:()=>n.slice(n.length-4,n.length),YY:()=>n.slice(n.length-2,n.length),Y:()=>`${e.getFullYear()}`,MMMM:()=>i[e.getMonth()],MMM:()=>i[e.getMonth()].slice(0,3),MM:()=>Mv(e.getMonth()+1,2),Mo:()=>`${e.getMonth()+1}${YD(e.getMonth()+1)}`,M:()=>`${e.getMonth()+1}`,Do:()=>`${e.getDate()}${YD(e.getDate())}`,DD:()=>Mv(e.getDate(),2),D:()=>`${e.getDate()}`,dddd:()=>r[e.getDay()],ddd:()=>r[e.getDay()].slice(0,3),dd:()=>r[e.getDay()].slice(0,2),do:()=>`${e.getDay()}${YD(e.getDay())}`,d:()=>`${e.getDay()}`},o=new RegExp(Object.keys(s).join("|"),"g");return t.replace(o,a=>a in s?s[a]():a)}function kr(e){if(!e)return null;const[t,n]=e.split(" ");if(!t)return null;const i=t.split("-").map(d=>parseInt(d,10));if(i.filter(d=>!isNaN(d)).length!==3)return null;const[r,s,o]=i,a=new Date(r,s-1,o);if(a.getFullYear()!==r||a.getMonth()!==s-1||a.getDate()!==o)return null;if(!n||n==="00:00:00")return a;const[l,u,c]=n.split(":").map(d=>parseInt(d,10));return l>=0&&l<24&&a.setHours(l),u>=0&&u<60&&a.setMinutes(u),c>=0&&c<60&&a.setSeconds(c),a}var W8e=class extends Bh{constructor(e){super(e,"ag-date-field","date")}postConstruct(){super.postConstruct();const e=Oh();this.addManagedListeners(this.eInput,{wheel:this.onWheel.bind(this),mousedown:()=>{this.isDisabled()||e||this.eInput.focus()}}),this.eInput.step="any"}onWheel(e){nn(this.beans)===this.eInput&&e.preventDefault()}setMin(e){const t=e instanceof Date?Bs(e??null,!1)??void 0:e;return this.min===t?this:(this.min=t,$s(this.eInput,"min",t),this)}setMax(e){const t=e instanceof Date?Bs(e??null,!1)??void 0:e;return this.max===t?this:(this.max=t,$s(this.eInput,"max",t),this)}setStep(e){return this.step===e?this:(this.step=e,$s(this.eInput,"step",e),this)}getDate(){if(this.eInput.validity.valid)return kr(this.getValue())??void 0}setDate(e,t){this.setValue(Bs(e??null,!1),t)}},Ete={selector:"AG-INPUT-DATE-FIELD",component:W8e},U8e=1e3,q8e=1e3,kW=100,PW,_w=!1,j8e=class extends Z{constructor(e,t){super(),this.tooltipCtrl=e,this.getTooltipValue=t,this.interactionEnabled=!1,this.isInteractingWithTooltip=!1,this.state=0,this.tooltipInstanceCount=0,this.tooltipMouseTrack=!1}wireBeans(e){this.popupSvc=e.popupSvc,this.userCompFactory=e.userCompFactory}postConstruct(){this.gos.get("tooltipInteraction")&&(this.interactionEnabled=!0),this.tooltipTrigger=this.getTooltipTrigger(),this.tooltipMouseTrack=this.gos.get("tooltipMouseTrack");const e=this.tooltipCtrl.getGui();this.tooltipTrigger===0&&this.addManagedListeners(e,{mouseenter:this.onMouseEnter.bind(this),mouseleave:this.onMouseLeave.bind(this)}),this.tooltipTrigger===1&&this.addManagedListeners(e,{focusin:this.onFocusIn.bind(this),focusout:this.onFocusOut.bind(this)}),this.addManagedListeners(e,{mousemove:this.onMouseMove.bind(this)}),this.interactionEnabled||this.addManagedListeners(e,{mousedown:this.onMouseDown.bind(this),keydown:this.onKeyDown.bind(this)})}getGridOptionsTooltipDelay(e){const t=this.gos.get(e);return Math.max(200,t)}getTooltipDelay(e){return e==="show"?this.tooltipCtrl.getTooltipShowDelayOverride?.()??this.getGridOptionsTooltipDelay("tooltipShowDelay"):this.tooltipCtrl.getTooltipHideDelayOverride?.()??this.getGridOptionsTooltipDelay("tooltipHideDelay")}destroy(){this.setToDoNothing(),super.destroy()}getTooltipTrigger(){const e=this.gos.get("tooltipTrigger");return!e||e==="hover"?0:1}onMouseEnter(e){this.interactionEnabled&&this.interactiveTooltipTimeoutId&&(this.unlockService(),this.startHideTimeout()),!Nd()&&(_w?this.showTooltipTimeoutId=window.setTimeout(()=>{this.prepareToShowTooltip(e)},kW):this.prepareToShowTooltip(e))}onMouseMove(e){this.lastMouseEvent&&(this.lastMouseEvent=e),this.tooltipMouseTrack&&this.state===2&&this.tooltipComp&&this.positionTooltip()}onMouseDown(){this.setToDoNothing()}onMouseLeave(){this.interactionEnabled?this.lockService():this.setToDoNothing()}onFocusIn(){this.prepareToShowTooltip()}onFocusOut(e){const t=e.relatedTarget,n=this.tooltipCtrl.getGui(),i=this.tooltipComp?.getGui();this.isInteractingWithTooltip||n.contains(t)||this.interactionEnabled&&i?.contains(t)||this.setToDoNothing()}onKeyDown(){this.isInteractingWithTooltip&&(this.isInteractingWithTooltip=!1),this.setToDoNothing()}prepareToShowTooltip(e){if(this.state!=0||_w)return;let t=0;e&&(t=this.isLastTooltipHiddenRecently()?200:this.getTooltipDelay("show")),this.lastMouseEvent=e||null,this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),t),this.state=1}isLastTooltipHiddenRecently(){return Date.now()-PW<U8e}setToDoNothing(e){!e&&this.state===2&&this.hideTooltip(),this.onBodyScrollEventCallback&&(this.onBodyScrollEventCallback(),this.onBodyScrollEventCallback=void 0),this.onColumnMovedEventCallback&&(this.onColumnMovedEventCallback(),this.onColumnMovedEventCallback=void 0),this.onDocumentKeyDownCallback&&(this.onDocumentKeyDownCallback(),this.onDocumentKeyDownCallback=void 0),this.clearTimeouts(),this.state=0,this.lastMouseEvent=null}showTooltip(){const e=this.getTooltipValue(),t=this.tooltipCtrl;if(!Ce(e)||t.shouldDisplayTooltip&&!t.shouldDisplayTooltip()){this.setToDoNothing();return}const n=t.getRowNode?.(),i=ze(this.gos,{location:t.getLocation?.()??"UNKNOWN",colDef:t.getColDef?.(),column:t.getColumn?.(),rowIndex:t.getRowIndex?.(),node:n,data:n?.data,value:e,valueFormatted:t.getValueFormatted?.(),hideTooltipCallback:()=>this.hideTooltip(!0),...t.getAdditionalParams?.()??{}});this.state=2,this.tooltipInstanceCount++;const r=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);wWe(this.userCompFactory,i)?.newAgStackInstance().then(r)}hideTooltip(e){!e&&this.isInteractingWithTooltip||(this.tooltipComp&&(this.destroyTooltipComp(),PW=Date.now()),this.eventSvc.dispatchEvent({type:"tooltipHide",parentGui:this.tooltipCtrl.getGui()}),e&&(this.isInteractingWithTooltip=!1),this.setToDoNothing(!0))}newTooltipComponentCallback(e,t){if(this.state!==2||this.tooltipInstanceCount!==e){this.destroyBean(t);return}const i=t.getGui();this.tooltipComp=t,i.classList.contains("ag-tooltip")||i.classList.add("ag-tooltip-custom"),this.tooltipTrigger===0&&i.classList.add("ag-tooltip-animate"),this.interactionEnabled&&i.classList.add("ag-tooltip-interactive");const r=this.getLocaleTextFunc(),s=this.popupSvc?.addPopup({eChild:i,ariaLabel:r("ariaLabelTooltip","Tooltip")});if(s&&(this.tooltipPopupDestroyFunc=s.hideFunc),this.positionTooltip(),this.tooltipTrigger===1){const o=()=>this.setToDoNothing();[this.onBodyScrollEventCallback,this.onColumnMovedEventCallback]=this.addManagedEventListeners({bodyScroll:o,columnMoved:o})}this.interactionEnabled&&([this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener]=this.addManagedElementListeners(i,{mouseenter:this.onTooltipMouseEnter.bind(this),mouseleave:this.onTooltipMouseLeave.bind(this)}),[this.onDocumentKeyDownCallback]=this.addManagedElementListeners(Pn(this.beans),{keydown:o=>{i.contains(o?.target)||this.onKeyDown()}}),this.tooltipTrigger===1&&([this.tooltipFocusInListener,this.tooltipFocusOutListener]=this.addManagedElementListeners(i,{focusin:this.onTooltipFocusIn.bind(this),focusout:this.onTooltipFocusOut.bind(this)}))),this.eventSvc.dispatchEvent({type:"tooltipShow",tooltipGui:i,parentGui:this.tooltipCtrl.getGui()}),this.startHideTimeout()}onTooltipMouseEnter(){this.isInteractingWithTooltip=!0,this.unlockService()}onTooltipMouseLeave(){this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,this.lockService())}onTooltipFocusIn(){this.isInteractingWithTooltip=!0}isTooltipFocused(){const e=this.tooltipComp?.getGui(),t=nn(this.beans);return!!e&&e.contains(t)}onTooltipFocusOut(e){const t=this.tooltipCtrl.getGui();this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,t.contains(e.relatedTarget)?this.startHideTimeout():this.hideTooltip())}positionTooltip(){const e={type:"tooltip",ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack};this.lastMouseEvent?this.popupSvc?.positionPopupUnderMouseEvent({...e,mouseEvent:this.lastMouseEvent}):this.popupSvc?.positionPopupByComponent({...e,eventSource:this.tooltipCtrl.getGui(),position:"under",keepWithinBounds:!0,nudgeY:5})}destroyTooltipComp(){this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");const e=this.tooltipPopupDestroyFunc,t=this.tooltipComp,n=this.tooltipTrigger===0?q8e:0;window.setTimeout(()=>{e(),this.destroyBean(t)},n),this.clearTooltipListeners(),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0}clearTooltipListeners(){[this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener,this.tooltipFocusInListener,this.tooltipFocusOutListener].forEach(e=>{e&&e()}),this.tooltipMouseEnterListener=this.tooltipMouseLeaveListener=this.tooltipFocusInListener=this.tooltipFocusOutListener=null}lockService(){_w=!0,this.interactiveTooltipTimeoutId=window.setTimeout(()=>{this.unlockService(),this.setToDoNothing()},kW)}unlockService(){_w=!1,this.clearInteractiveTimeout()}startHideTimeout(){this.clearHideTimeout(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.getTooltipDelay("hide"))}clearShowTimeout(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0)}clearHideTimeout(){this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)}clearInteractiveTimeout(){this.interactiveTooltipTimeoutId&&(window.clearTimeout(this.interactiveTooltipTimeoutId),this.interactiveTooltipTimeoutId=void 0)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout(),this.clearInteractiveTimeout()}};function XD(e){return e.get("tooltipShowMode")==="whenTruncated"}function yb(e){return()=>{const t=e();return t?t.scrollWidth>t.clientWidth:!0}}var K8e=class extends Z{constructor(e,t){super(),this.ctrl=e,t&&(this.beans=t)}postConstruct(){this.refreshTooltip()}setBrowserTooltip(e){const t="title",n=this.ctrl.getGui();n&&(e!=null&&e!=""?n.setAttribute(t,e):n.removeAttribute(t))}updateTooltipText(){const{getTooltipValue:e}=this.ctrl;e&&(this.tooltip=e())}createTooltipFeatureIfNeeded(){this.tooltipManager==null&&(this.tooltipManager=this.createBean(new j8e(this.ctrl,()=>this.tooltip),this.beans.context))}setTooltipAndRefresh(e){this.tooltip=e,this.refreshTooltip()}refreshTooltip(){this.browserTooltips=this.beans.gos.get("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?(this.setBrowserTooltip(this.tooltip),this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context)):(this.setBrowserTooltip(null),this.createTooltipFeatureIfNeeded())}destroy(){this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context),super.destroy()}},Y8e=class extends At{constructor(e="default",t=!1){super({tag:"div",cls:`ag-list ag-${e}-list`}),this.cssIdentifier=e,this.unFocusable=t,this.activeClass="ag-active-item",this.options=[],this.itemEls=[]}postConstruct(){const e=this.getGui();this.addManagedElementListeners(e,{mouseleave:()=>this.clearHighlighted()}),!this.unFocusable&&this.addManagedElementListeners(e,{keydown:this.handleKeyDown.bind(this)})}handleKeyDown(e){const t=e.key;switch(t){case X.ENTER:if(!this.highlightedEl)this.setValue(this.getValue());else{const n=this.itemEls.indexOf(this.highlightedEl);this.setValueByIndex(n)}break;case X.DOWN:case X.UP:e.preventDefault(),this.navigate(t);break;case X.PAGE_DOWN:case X.PAGE_UP:case X.PAGE_HOME:case X.PAGE_END:e.preventDefault(),this.navigateToPage(t);break}}navigate(e){const t=e===X.DOWN;let n;const{itemEls:i,highlightedEl:r}=this;if(!r)n=i[t?0:i.length-1];else{let o=i.indexOf(r)+(t?1:-1);o=Math.min(Math.max(o,0),i.length-1),n=i[o]}this.highlightItem(n)}navigateToPage(e){const{itemEls:t,highlightedEl:n}=this;if(!n||t.length===0)return;const i=t.indexOf(n),r=this.options.length-1,s=t[0].clientHeight,o=Math.floor(this.getGui().clientHeight/s);let a=-1;e===X.PAGE_HOME?a=0:e===X.PAGE_END?a=r:e===X.PAGE_DOWN?a=Math.min(i+o,r):e===X.PAGE_UP&&(a=Math.max(i-o,0)),a!==-1&&this.highlightItem(t[a])}addOptions(e){return e.forEach(t=>this.addOption(t)),this}addOption(e){const{value:t,text:n}=e,i=n||t;return this.options.push({value:t,text:i}),this.renderOption(t,i),this.updateIndices(),this}clearOptions(){this.options=[],this.reset(!0),this.itemEls.forEach(e=>{_s(e)}),this.itemEls=[],this.refreshAriaRole()}refreshAriaRole(){const e=this.getGui();Vl(e,this.options.length===0?"presentation":"listbox")}updateIndices(){const e=this.getGui().querySelectorAll(".ag-list-item");this.refreshAriaRole(),e.forEach((t,n)=>{C5e(t,n+1),v5e(t,e.length)})}renderOption(e,t){const n=Pn(this.beans),i=n.createElement("div");Vl(i,"option"),i.classList.add("ag-list-item",`ag-${this.cssIdentifier}-list-item`);const r=n.createElement("span");i.appendChild(r),r.textContent=t,this.unFocusable||(i.tabIndex=-1),this.itemEls.push(i),this.addManagedListeners(i,{mouseover:()=>this.highlightItem(i),mousedown:s=>{s.preventDefault(),s.stopPropagation(),this.setValue(e)}}),this.createOptionalManagedBean(this.beans.registry.createDynamicBean("tooltipFeature",!1,{getTooltipValue:()=>t,getGui:()=>i,getLocation:()=>"UNKNOWN",shouldDisplayTooltip:()=>r.scrollWidth>r.clientWidth})),this.getGui().appendChild(i)}setValue(e,t){if(this.value===e)return this.fireItemSelected(),this;if(e==null)return this.reset(t),this;const n=this.options.findIndex(i=>i.value===e);if(n!==-1){const i=this.options[n];this.value=i.value,this.displayValue=i.text,this.highlightItem(this.itemEls[n]),t||this.fireChangeEvent()}return this}setValueByIndex(e){return this.setValue(this.options[e].value)}getValue(){return this.value}getDisplayValue(){return this.displayValue}refreshHighlighted(){this.clearHighlighted();const e=this.options.findIndex(t=>t.value===this.value);e!==-1&&this.highlightItem(this.itemEls[e])}reset(e){this.value=null,this.displayValue=null,this.clearHighlighted(),e||this.fireChangeEvent()}highlightItem(e){if(!Io(e))return;this.clearHighlighted(),this.highlightedEl=e,e.classList.add(this.activeClass),KM(e,!0);const t=this.getGui(),{scrollTop:n,clientHeight:i}=t,{offsetTop:r,offsetHeight:s}=e;(r+s>n+i||r<n)&&e.scrollIntoView({block:"nearest"}),this.unFocusable||e.focus()}clearHighlighted(){const e=this.highlightedEl;!e||!Io(e)||(e.classList.remove(this.activeClass),KM(e,!1),this.highlightedEl=null)}fireChangeEvent(){this.dispatchLocalEvent({type:"fieldValueChanged"}),this.fireItemSelected()}fireItemSelected(){this.dispatchLocalEvent({type:"selectedItem"})}},X8e=".ag-picker-field-display{flex:1 1 auto}.ag-picker-field{align-items:center;display:flex}.ag-picker-field-icon{border:0;cursor:pointer;display:flex;margin:0;padding:0}.ag-picker-field-wrapper{background-color:var(--ag-picker-button-background-color);border:var(--ag-picker-button-border);border-radius:5px;min-height:max(var(--ag-list-item-height),calc(var(--ag-spacing)*4));overflow:hidden;&:disabled{opacity:.5}&.ag-picker-has-focus,&:focus-within{background-color:var(--ag-picker-button-focus-background-color);border:var(--ag-picker-button-focus-border);box-shadow:var(--ag-focus-shadow)}}",Q8e={tag:"div",cls:"ag-picker-field",role:"presentation",children:[{tag:"div",ref:"eLabel"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-picker-field-wrapper ag-picker-collapsed",children:[{tag:"div",ref:"eDisplayField",cls:"ag-picker-field-display"},{tag:"div",ref:"eIcon",cls:"ag-picker-field-icon",attrs:{"aria-hidden":"true"}}]}]},Z8e=class extends Rte{constructor(e){if(super(e,e?.template||Q8e,e?.agComponents||[],e?.className),this.isPickerDisplayed=!1,this.skipClick=!1,this.pickerGap=4,this.hideCurrentPicker=null,this.eLabel=ve,this.eWrapper=ve,this.eDisplayField=ve,this.eIcon=ve,this.registerCSS(X8e),this.ariaRole=e?.ariaRole,this.onPickerFocusIn=this.onPickerFocusIn.bind(this),this.onPickerFocusOut=this.onPickerFocusOut.bind(this),!e)return;const{pickerGap:t,maxPickerHeight:n,variableWidth:i,minPickerWidth:r,maxPickerWidth:s}=e;t!=null&&(this.pickerGap=t),this.variableWidth=!!i,n!=null&&this.setPickerMaxHeight(n),r!=null&&this.setPickerMinWidth(r),s!=null&&this.setPickerMaxWidth(s)}postConstruct(){super.postConstruct(),this.setupAria();const e=`ag-${this.getCompId()}-display`;this.eDisplayField.setAttribute("id",e);const t=this.getAriaElement();this.addManagedElementListeners(t,{keydown:this.onKeyDown.bind(this)}),this.addManagedElementListeners(this.eLabel,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)}),this.addManagedElementListeners(this.eWrapper,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)});const{pickerIcon:n,inputWidth:i}=this.config;if(n){const r=Os(n,this.beans);r&&this.eIcon.appendChild(r)}i!=null&&this.setInputWidth(i)}setupAria(){const e=this.getAriaElement();e.setAttribute("tabindex",this.gos.get("tabIndex").toString()),jM(e,!1),this.ariaRole&&Vl(e,this.ariaRole)}onLabelOrWrapperMouseDown(e){if(e){const t=this.getFocusableElement();if(t!==this.eWrapper&&e?.target===t)return;e.preventDefault(),this.getFocusableElement().focus()}if(this.skipClick){this.skipClick=!1;return}this.isDisabled()||(this.isPickerDisplayed?this.hidePicker():this.showPicker())}onKeyDown(e){switch(e.key){case X.UP:case X.DOWN:case X.ENTER:case X.SPACE:e.preventDefault(),this.onLabelOrWrapperMouseDown();break;case X.ESCAPE:this.isPickerDisplayed&&(e.preventDefault(),e.stopPropagation(),this.hideCurrentPicker&&this.hideCurrentPicker());break}}showPicker(){this.isPickerDisplayed=!0,this.pickerComponent||(this.pickerComponent=this.createPickerComponent());const e=this.pickerComponent.getGui();e.addEventListener("focusin",this.onPickerFocusIn),e.addEventListener("focusout",this.onPickerFocusOut),this.hideCurrentPicker=this.renderAndPositionPicker(),this.toggleExpandedStyles(!0)}renderAndPositionPicker(){const e=this.pickerComponent.getGui();this.gos.get("suppressScrollWhenPopupsAreOpen")||([this.destroyMouseWheelFunc]=this.addManagedEventListeners({bodyScroll:()=>{this.hidePicker()}}));const t=this.getLocaleTextFunc(),{config:{pickerAriaLabelKey:n,pickerAriaLabelValue:i,modalPicker:r=!0},maxPickerHeight:s,minPickerWidth:o,maxPickerWidth:a,variableWidth:l,beans:u,eWrapper:c}=this,d={modal:r,eChild:e,closeOnEsc:!0,closedCallback:()=>{const m=xee(u);this.beforeHidePicker(),m&&this.isAlive()&&this.getFocusableElement().focus()},ariaLabel:t(n,i),anchorToElement:c};e.style.position="absolute";const h=u.popupSvc,p=h.addPopup(d);l?(o&&(e.style.minWidth=o),e.style.width=lN(i1(c)),a&&(e.style.maxWidth=a)):o1(e,a??i1(c));const g=s??`${aN(h.getPopupParent())}px`;return e.style.setProperty("max-height",g),this.alignPickerToComponent(),p.hideFunc}alignPickerToComponent(){if(!this.pickerComponent)return;const{pickerGap:e,config:{pickerType:t},beans:{popupSvc:n,gos:i},eWrapper:r,pickerComponent:s}=this,o=i.get("enableRtl")?"right":"left";n.positionPopupByComponent({type:t,eventSource:r,ePopup:s.getGui(),position:"under",alignSide:o,keepWithinBounds:!0,nudgeY:e})}beforeHidePicker(){this.destroyMouseWheelFunc&&(this.destroyMouseWheelFunc(),this.destroyMouseWheelFunc=void 0),this.toggleExpandedStyles(!1);const e=this.pickerComponent.getGui();e.removeEventListener("focusin",this.onPickerFocusIn),e.removeEventListener("focusout",this.onPickerFocusOut),this.isPickerDisplayed=!1,this.pickerComponent=void 0,this.hideCurrentPicker=null}toggleExpandedStyles(e){if(!this.isAlive())return;const t=this.getAriaElement();jM(t,e);const n=this.eWrapper.classList;n.toggle("ag-picker-expanded",e),n.toggle("ag-picker-collapsed",!e)}onPickerFocusIn(){this.togglePickerHasFocus(!0)}onPickerFocusOut(e){this.pickerComponent?.getGui().contains(e.relatedTarget)||this.togglePickerHasFocus(!1)}togglePickerHasFocus(e){this.pickerComponent&&this.eWrapper.classList.toggle("ag-picker-has-focus",e)}hidePicker(){this.hideCurrentPicker?.()}setInputWidth(e){return o1(this.eWrapper,e),this}getFocusableElement(){return this.eWrapper}setPickerGap(e){return this.pickerGap=e,this}setPickerMinWidth(e){return typeof e=="number"&&(e=`${e}px`),this.minPickerWidth=e??void 0,this}setPickerMaxWidth(e){return typeof e=="number"&&(e=`${e}px`),this.maxPickerWidth=e??void 0,this}setPickerMaxHeight(e){return typeof e=="number"&&(e=`${e}px`),this.maxPickerHeight=e??void 0,this}destroy(){this.hidePicker(),super.destroy()}},J8e=".ag-select{align-items:center;display:flex;&.ag-disabled{opacity:.5}}:where(.ag-select){.ag-picker-field-wrapper{cursor:default}&.ag-disabled .ag-picker-field-wrapper:focus{box-shadow:none}&:not(.ag-cell-editor,.ag-label-align-top){min-height:var(--ag-list-item-height)}.ag-picker-field-display{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ag-picker-field-icon{align-items:center;display:flex}}:where(.ag-ltr) :where(.ag-select){.ag-picker-field-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding)/2);padding-right:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-select){.ag-picker-field-wrapper{padding-left:var(--ag-spacing);padding-right:calc(var(--ag-cell-horizontal-padding)/2)}}",PN=class extends Z8e{constructor(e){super({pickerAriaLabelKey:"ariaLabelSelectField",pickerAriaLabelValue:"Select Field",pickerType:"ag-list",className:"ag-select",pickerIcon:"selectOpen",ariaRole:"combobox",...e}),this.registerCSS(J8e)}postConstruct(){this.tooltipFeature=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("tooltipFeature",!1,{shouldDisplayTooltip:yb(()=>this.eDisplayField),getGui:()=>this.getGui()})),super.postConstruct(),this.createListComponent(),this.eWrapper.tabIndex=this.gos.get("tabIndex");const{options:e,value:t,placeholder:n}=this.config;e!=null&&this.addOptions(e),t!=null&&this.setValue(t,!0),n&&t==null&&(this.eDisplayField.textContent=n),this.addManagedElementListeners(this.eWrapper,{focusout:this.onWrapperFocusOut.bind(this)})}onWrapperFocusOut(e){this.eWrapper.contains(e.relatedTarget)||this.hidePicker()}createListComponent(){const e=this.createBean(new Y8e("select",!0));this.listComponent=e,e.setParentComponent(this);const t=e.getAriaElement(),n=`ag-select-list-${e.getCompId()}`;t.setAttribute("id",n),F5e(this.getAriaElement(),t),e.addManagedElementListeners(e.getGui(),{mousedown:i=>{i?.preventDefault()}}),e.addManagedListeners(e,{selectedItem:()=>{this.hidePicker(),this.dispatchLocalEvent({type:"selectedItem"})},fieldValueChanged:()=>{this.listComponent&&(this.setValue(this.listComponent.getValue(),!1,!0),this.hidePicker())}})}createPickerComponent(){return this.listComponent}onKeyDown(e){const{key:t}=e;switch(t===X.TAB&&this.hidePicker(),t){case X.ENTER:case X.UP:case X.DOWN:case X.PAGE_UP:case X.PAGE_DOWN:case X.PAGE_HOME:case X.PAGE_END:e.preventDefault(),this.isPickerDisplayed?this.listComponent?.handleKeyDown(e):super.onKeyDown(e);break;case X.ESCAPE:super.onKeyDown(e);break;case X.SPACE:this.isPickerDisplayed?e.preventDefault():super.onKeyDown(e);break}}showPicker(){const e=this.listComponent;e&&(super.showPicker(),e.refreshHighlighted())}addOptions(e){return e.forEach(t=>this.addOption(t)),this}addOption(e){return this.listComponent.addOption(e),this}clearOptions(){return this.listComponent?.clearOptions(),this.setValue(void 0,!0),this}setValue(e,t,n){const{listComponent:i,config:{placeholder:r},eDisplayField:s,tooltipFeature:o}=this;if(this.value===e||!i)return this;if(n||i.setValue(e,!0),i.getValue()===this.getValue())return this;let l=i.getDisplayValue();return l==null&&r&&(l=r),s.textContent=l,o?.setTooltipAndRefresh(l??null),super.setValue(e,t)}destroy(){this.listComponent=this.destroyBean(this.listComponent),super.destroy()}},eUe={selector:"AG-SELECT",component:PN},QD={TAB_GUARD:"ag-tab-guard",TAB_GUARD_TOP:"ag-tab-guard-top",TAB_GUARD_BOTTOM:"ag-tab-guard-bottom"},tUe=class extends Z{constructor(e){super(),this.skipTabGuardFocus=!1,this.forcingFocusOut=!1,this.allowFocus=!1;const{comp:t,eTopGuard:n,eBottomGuard:i,focusTrapActive:r,forceFocusOutWhenTabGuardsAreEmpty:s,isFocusableContainer:o,focusInnerElement:a,onFocusIn:l,onFocusOut:u,shouldStopEventPropagation:c,onTabKeyDown:d,handleKeyDown:h,isEmpty:p,eFocusableElement:g}=e;this.comp=t,this.eTopGuard=n,this.eBottomGuard=i,this.providedFocusInnerElement=a,this.eFocusableElement=g,this.focusTrapActive=!!r,this.forceFocusOutWhenTabGuardsAreEmpty=!!s,this.isFocusableContainer=!!o,this.providedFocusIn=l,this.providedFocusOut=u,this.providedShouldStopEventPropagation=c,this.providedOnTabKeyDown=d,this.providedHandleKeyDown=h,this.providedIsEmpty=p}postConstruct(){this.createManagedBean(new Sg(this.eFocusableElement,{shouldStopEventPropagation:()=>this.shouldStopEventPropagation(),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e)})),this.activateTabGuards(),[this.eTopGuard,this.eBottomGuard].forEach(e=>this.addManagedElementListeners(e,{focus:this.onFocus.bind(this)}))}handleKeyDown(e){this.providedHandleKeyDown&&this.providedHandleKeyDown(e)}tabGuardsAreActive(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")}shouldStopEventPropagation(){return this.providedShouldStopEventPropagation?this.providedShouldStopEventPropagation():!1}activateTabGuards(){if(this.forcingFocusOut)return;const e=this.gos.get("tabIndex");this.comp.setTabIndex(e.toString())}deactivateTabGuards(){this.comp.setTabIndex()}onFocus(e){if(this.isFocusableContainer&&!this.eFocusableElement.contains(e.relatedTarget)&&!this.allowFocus){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}if(this.skipTabGuardFocus){this.skipTabGuardFocus=!1;return}if(this.forceFocusOutWhenTabGuardsAreEmpty&&(this.providedIsEmpty?this.providedIsEmpty():Qf(this.eFocusableElement,".ag-tab-guard").length===0)){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}if(this.isFocusableContainer&&this.eFocusableElement.contains(e.relatedTarget))return;const t=e.target===this.eBottomGuard;!(this.providedFocusInnerElement?this.providedFocusInnerElement(t):this.focusInnerElement(t))&&this.forceFocusOutWhenTabGuardsAreEmpty&&this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard)}findNextElementOutsideAndFocus(e){const t=Pn(this.beans),n=Qf(t.body,null,!0),i=n.indexOf(e?this.eTopGuard:this.eBottomGuard);if(i===-1)return;let r,s;e?(r=0,s=i):(r=i+1,s=n.length);const o=n.slice(r,s),a=this.gos.get("tabIndex");o.sort((l,u)=>{const c=parseInt(l.getAttribute("tabindex")||"0"),d=parseInt(u.getAttribute("tabindex")||"0");return d===a?1:c===a?-1:c===0?1:d===0?-1:c-d}),o[e?o.length-1:0]?.focus()}onFocusIn(e){this.focusTrapActive||this.forcingFocusOut||(this.providedFocusIn&&this.providedFocusIn(e),this.isFocusableContainer||this.deactivateTabGuards())}onFocusOut(e){this.focusTrapActive||(this.providedFocusOut&&this.providedFocusOut(e),this.eFocusableElement.contains(e.relatedTarget)||this.activateTabGuards())}onTabKeyDown(e){if(this.providedOnTabKeyDown){this.providedOnTabKeyDown(e);return}if(this.focusTrapActive||e.defaultPrevented)return;const t=this.tabGuardsAreActive();t&&this.deactivateTabGuards();const n=this.getNextFocusableElement(e.shiftKey);t&&setTimeout(()=>this.activateTabGuards(),0),n&&(n.focus(),e.preventDefault())}focusInnerElement(e=!1){const t=Qf(this.eFocusableElement);return this.tabGuardsAreActive()&&(t.splice(0,1),t.splice(t.length-1,1)),t.length?(t[e?t.length-1:0].focus({preventScroll:!0}),!0):!1}getNextFocusableElement(e){return $h(this.beans,this.eFocusableElement,!1,e)}forceFocusOutOfContainer(e=!1){if(this.forcingFocusOut)return;const t=e?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,this.forcingFocusOut=!0,t.focus(),window.setTimeout(()=>{this.forcingFocusOut=!1,this.activateTabGuards()})}isTabGuard(e,t){return e===this.eTopGuard&&!t||e===this.eBottomGuard&&(t??!0)}setAllowFocus(e){this.allowFocus=e}},nUe=class extends Z{constructor(e){super(),this.comp=e}initialiseTabGuard(e){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.comp.getFocusableElement();const{eTopGuard:t,eBottomGuard:n,eFocusableElement:i}=this,r=[t,n],s={setTabIndex:C=>{r.forEach(y=>C!=null?y.setAttribute("tabindex",C):y.removeAttribute("tabindex"))}};this.addTabGuards(t,n);const{focusTrapActive:o=!1,onFocusIn:a,onFocusOut:l,focusInnerElement:u,handleKeyDown:c,onTabKeyDown:d,shouldStopEventPropagation:h,isEmpty:p,forceFocusOutWhenTabGuardsAreEmpty:g,isFocusableContainer:m}=e;this.tabGuardCtrl=this.createManagedBean(new tUe({comp:s,focusTrapActive:o,eTopGuard:t,eBottomGuard:n,eFocusableElement:i,onFocusIn:a,onFocusOut:l,focusInnerElement:u,handleKeyDown:c,onTabKeyDown:d,shouldStopEventPropagation:h,isEmpty:p,forceFocusOutWhenTabGuardsAreEmpty:g,isFocusableContainer:m}))}getTabGuardCtrl(){return this.tabGuardCtrl}createTabGuard(e){const t=Pn(this.beans).createElement("div"),n=e==="top"?QD.TAB_GUARD_TOP:QD.TAB_GUARD_BOTTOM;return t.classList.add(QD.TAB_GUARD,n),Vl(t,"presentation"),t}addTabGuards(e,t){const n=this.eFocusableElement;n.insertAdjacentElement("afterbegin",e),n.insertAdjacentElement("beforeend",t)}removeAllChildrenExceptTabGuards(){const e=[this.eTopGuard,this.eBottomGuard];Gi(this.comp.getFocusableElement()),this.addTabGuards(...e)}forceFocusOutOfContainer(e=!1){this.tabGuardCtrl.forceFocusOutOfContainer(e)}appendChild(e,t,n){uN(t)||(t=t.getGui());const{eBottomGuard:i}=this;i?i.insertAdjacentElement("beforebegin",t):e(t,n)}destroy(){const{eTopGuard:e,eBottomGuard:t}=this;_s(e),_s(t),super.destroy()}},Fte=class extends At{initialiseTabGuard(e){this.tabGuardFeature=this.createManagedBean(new nUe(this)),this.tabGuardFeature.initialiseTabGuard(e)}forceFocusOutOfContainer(e=!1){this.tabGuardFeature.forceFocusOutOfContainer(e)}appendChild(e,t){this.tabGuardFeature.appendChild(super.appendChild.bind(this),e,t)}},xg=class extends At{isPopup(){return!0}setParentComponent(e){e.addCssClass("ag-has-popup"),super.setParentComponent(e)}destroy(){const e=this.parentComponent;e&&e.isAlive()&&e.getGui().classList.remove("ag-has-popup"),super.destroy()}},xf=class{constructor(e,t=!1){this.DOUBLE_TAP_MILLIS=500,this.destroyFuncs=[],this.touching=!1,this.localEventService=new hh,this.preventMouseClick=t;const n=this.onTouchStart.bind(this),i=this.onTouchMove.bind(this),r=this.onTouchEnd.bind(this);e.addEventListener("touchstart",n,{passive:!0}),e.addEventListener("touchmove",i,{passive:!0}),e.addEventListener("touchend",r,{passive:!1}),this.destroyFuncs.push(()=>{e.removeEventListener("touchstart",n,{passive:!0}),e.removeEventListener("touchmove",i,{passive:!0}),e.removeEventListener("touchend",r,{passive:!1})})}getActiveTouch(e){for(let t=0;t<e.length;t++)if(e[t].identifier===this.touchStart.identifier)return e[t];return null}addEventListener(e,t){this.localEventService.addEventListener(e,t)}removeEventListener(e,t){this.localEventService.removeEventListener(e,t)}onTouchStart(e){if(this.touching)return;this.touchStart=e.touches[0],this.touching=!0,this.moved=!1;const t=this.touchStart;window.setTimeout(()=>{const n=this.touchStart===t;if(this.touching&&n&&!this.moved){this.moved=!0;const i={type:"longTap",touchStart:this.touchStart,touchEvent:e};this.localEventService.dispatchEvent(i)}},500)}onTouchMove(e){if(!this.touching)return;const t=this.getActiveTouch(e.touches);if(!t)return;!ote(t,this.touchStart,4)&&(this.moved=!0)}onTouchEnd(e){if(this.touching){if(!this.moved){const t={type:"tap",touchStart:this.touchStart};this.localEventService.dispatchEvent(t),this.checkForDoubleTap()}this.preventMouseClick&&e.cancelable&&e.preventDefault(),this.touching=!1}}checkForDoubleTap(){const e=Date.now();if(this.lastTapTime&&this.lastTapTime>0)if(e-this.lastTapTime>this.DOUBLE_TAP_MILLIS){const n={type:"doubleTap",touchStart:this.touchStart};this.localEventService.dispatchEvent(n),this.lastTapTime=null}else this.lastTapTime=e;else this.lastTapTime=e}destroy(){this.destroyFuncs.forEach(e=>e())}},Ate=class{constructor(e="javascript"){this.frameworkName=e,this.renderingEngine="vanilla",this.batchFrameworkComps=!1,this.wrapIncoming=t=>t(),this.wrapOutgoing=t=>t(),this.baseDocLink=`${fee}/${this.frameworkName}-data-grid`,B5e(this.baseDocLink)}setInterval(e,t){return new ir(n=>{n(window.setInterval(e,t))})}addEventListener(e,t,n,i){let r={};if(typeof i=="object"?r=i:typeof i=="boolean"&&(r={capture:i}),r.passive==null){const s=Pee(t);s!=null&&(r.passive=s)}e.addEventListener(t,n,r)}frameworkComponent(e){return null}isFrameworkComponent(e){return!1}getDocLink(e){return`${this.baseDocLink}${e?`/${e}`:""}`}};function iUe(e){return{beanName:"gridApi",bean:e.getBean("apiFunctionSvc").api}}var rUe=["licenseManager","environment","eventSvc","gos","paginationAutoPageSizeSvc","apiFunctionSvc","gridApi","registry","agCompUtils","userCompFactory","rowContainerHeight","horizontalResizeSvc","localeSvc","pinnedRowModel","dragSvc","colGroupSvc","visibleCols","popupSvc","selectionSvc","colFilter","quickFilter","filterManager","colModel","headerNavigation","pageBounds","pagination","pageBoundsListener","rowSpanSvc","stickyRowSvc","rowRenderer","expressionSvc","alignedGridsSvc","navigation","valueCache","valueSvc","autoWidthCalc","filterMenuFactory","dragAndDrop","focusSvc","cellNavigation","cellStyles","scrollVisibleSvc","sortSvc","colHover","colAnimation","autoColSvc","selectionColSvc","changeDetectionSvc","animationFrameSvc","undoRedo","colDefFactory","rowStyleSvc","rowNodeBlockLoader","rowNodeSorter","ctrlsSvc","pinnedCols","dataTypeSvc","syncSvc","overlays","stateSvc","expansionSvc","apiEventSvc","ariaAnnounce","menuSvc","colMoves","colAutosize","colFlex","colResize","pivotColsSvc","valueColsSvc","rowGroupColsSvc","funcColsSvc","colNames","colViewport","pivotResultCols","showRowGroupCols","validation"],MW=Object.fromEntries(rUe.map((e,t)=>[e,t]));function sUe(e,t){const n=(e.beanName?MW[e.beanName]:void 0)??Number.MAX_SAFE_INTEGER,i=(t.beanName?MW[t.beanName]:void 0)??Number.MAX_SAFE_INTEGER;return n-i}function oUe(e,t){return e?.beanName==="gridDestroySvc"?-1:0}var aUe={tag:"div",cls:"ag-pinned-left-header",role:"rowgroup"},lUe={tag:"div",cls:"ag-pinned-right-header",role:"rowgroup"},uUe={tag:"div",cls:"ag-header-viewport",role:"presentation",attrs:{tabindex:"-1"},children:[{tag:"div",ref:"eCenterContainer",cls:"ag-header-container",role:"rowgroup"}]},ZD=class extends At{constructor(e){super(),this.eCenterContainer=ve,this.headerRowComps={},this.rowCompsList=[],this.pinned=e}postConstruct(){this.selectAndSetTemplate();const e={setDisplayed:n=>this.setDisplayed(n),setCtrls:n=>this.setCtrls(n),setCenterWidth:n=>this.eCenterContainer.style.width=n,setViewportScrollLeft:n=>this.getGui().scrollLeft=n,setPinnedContainerWidth:n=>{const i=this.getGui();i.style.width=n,i.style.maxWidth=n,i.style.minWidth=n}};this.createManagedBean(new v8e(this.pinned)).setComp(e,this.getGui())}selectAndSetTemplate(){const e=this.pinned=="left",t=this.pinned=="right",n=e?aUe:t?lUe:uUe;this.setTemplate(n),this.eRowContainer=this.eCenterContainer!==ve?this.eCenterContainer:this.getGui()}destroy(){this.setCtrls([]),super.destroy()}destroyRowComp(e){this.destroyBean(e),this.eRowContainer.removeChild(e.getGui())}setCtrls(e){const t=this.headerRowComps;this.headerRowComps={},this.rowCompsList=[];let n;const i=r=>{const s=r.getGui();s.parentElement!=this.eRowContainer&&this.eRowContainer.appendChild(s),n&&cee(this.eRowContainer,s,n),n=s};e.forEach(r=>{const s=r.instanceId,o=t[s];delete t[s];const a=o||this.createBean(new f8e(r));this.headerRowComps[s]=a,this.rowCompsList.push(a),i(a)}),Object.values(t).forEach(r=>this.destroyRowComp(r))}},cUe={tag:"div",cls:"ag-header",role:"presentation"},dUe=class extends At{constructor(){super(cUe)}postConstruct(){const e={addOrRemoveCssClass:(i,r)=>this.addOrRemoveCssClass(i,r),setHeightAndMinHeight:i=>{this.getGui().style.height=i,this.getGui().style.minHeight=i}};this.createManagedBean(new o8e).setComp(e,this.getGui(),this.getFocusableElement());const n=i=>{this.createManagedBean(i),this.appendChild(i)};n(new ZD("left")),n(new ZD(null)),n(new ZD("right"))}},hUe={selector:"AG-HEADER-ROOT",component:dUe},fUe=class extends At{constructor(e,t,n,i,r){super(),this.cellCtrl=t,this.rendererVersion=0,this.editorVersion=0,this.beans=e,this.column=t.column,this.rowNode=t.rowNode,this.eRow=i;const s=Sn({tag:"div",role:t.getCellAriaRole(),attrs:{"comp-id":`${this.getCompId()}`,"col-id":t.colIdSanitised}});this.eCell=s;let o;t.isCellSpanning()?(o=Sn({tag:"div",cls:"ag-spanned-cell-wrapper",role:"presentation"}),o.appendChild(s),this.setTemplateFromElement(o)):this.setTemplateFromElement(s),this.cellCssClassManager=new Uee(()=>s),this.forceWrapper=t.isForceWrapper(),this.refreshWrapper(!1);const a={addOrRemoveCssClass:(l,u)=>this.cellCssClassManager.addOrRemoveCssClass(l,u),setUserStyles:l=>_C(s,l),getFocusableElement:()=>s,setIncludeSelection:l=>this.includeSelection=l,setIncludeRowDrag:l=>this.includeRowDrag=l,setIncludeDndSource:l=>this.includeDndSource=l,setRenderDetails:(l,u,c)=>this.setRenderDetails(l,u,c),setEditDetails:(l,u,c)=>this.setEditDetails(l,u,c),getCellEditor:()=>this.cellEditor||null,getCellRenderer:()=>this.cellRenderer||null,getParentOfValue:()=>this.getParentOfValue()};t.setComp(a,s,o,this.eCellWrapper,n,r,void 0)}getParentOfValue(){return this.eCellValue??this.eCellWrapper??this.eCell}setRenderDetails(e,t,n){if(this.cellEditor&&!this.cellEditorPopupWrapper)return;this.firstRender=this.firstRender==null;const r=this.refreshWrapper(!1);this.refreshEditStyles(!1),e?!(n||r)&&this.refreshCellRenderer(e)||(this.destroyRenderer(),this.createCellRendererInstance(e)):(this.destroyRenderer(),this.insertValueWithoutCellRenderer(t))}setEditDetails(e,t,n){e?this.createCellEditorInstance(e,t,n):this.destroyEditor()}removeControls(){const e=this.beans.context;this.checkboxSelectionComp=e.destroyBean(this.checkboxSelectionComp),this.dndSourceComp=e.destroyBean(this.dndSourceComp),this.rowDraggingComp=e.destroyBean(this.rowDraggingComp)}refreshWrapper(e){const t=this.includeRowDrag||this.includeDndSource||this.includeSelection,n=t||this.forceWrapper,i=n&&this.eCellWrapper==null;i&&(this.eCellWrapper=Sn({tag:"div",cls:"ag-cell-wrapper",role:"presentation"}),this.eCell.appendChild(this.eCellWrapper));const r=!n&&this.eCellWrapper!=null;r&&(_s(this.eCellWrapper),this.eCellWrapper=void 0),this.cellCssClassManager.addOrRemoveCssClass("ag-cell-value",!n);const s=!e&&n,o=s&&this.eCellValue==null;o&&(this.eCellValue=Sn({tag:"span",cls:"ag-cell-value",role:"presentation"}),this.eCellWrapper.appendChild(this.eCellValue));const a=!s&&this.eCellValue!=null;a&&(_s(this.eCellValue),this.eCellValue=void 0);const l=i||r||o||a;return l&&this.removeControls(),!e&&t&&this.addControls(),l}addControls(){const{cellCtrl:e,eCellWrapper:t,eCellValue:n,includeRowDrag:i,includeDndSource:r,includeSelection:s}=this,o=a=>{a&&t.insertBefore(a.getGui(),n)};i&&this.rowDraggingComp==null&&(this.rowDraggingComp=e.createRowDragComp(),o(this.rowDraggingComp)),r&&this.dndSourceComp==null&&(this.dndSourceComp=e.createDndSource(),o(this.dndSourceComp)),s&&this.checkboxSelectionComp==null&&(this.checkboxSelectionComp=e.createSelectionCheckbox(),o(this.checkboxSelectionComp))}createCellEditorInstance(e,t,n){const i=this.editorVersion,r=e.newAgStackInstance(),{params:s}=e;r.then(a=>this.afterCellEditorCreated(i,a,s,t,n)),Xt(this.cellEditor)&&s.cellStartedEdit&&this.cellCtrl.focusCell(!0)}insertValueWithoutCellRenderer(e){const t=this.getParentOfValue();Gi(t);const n=e!=null?Ol(e,!0):null;n!=null&&(t.textContent=n)}destroyRenderer(){const{context:e}=this.beans;this.cellRenderer=e.destroyBean(this.cellRenderer),_s(this.cellRendererGui),this.cellRendererGui=null,this.rendererVersion++}destroyEditor(){const{context:e}=this.beans;(this.cellEditorPopupWrapper?.getGui().contains(nn(this.beans))||this.cellCtrl.hasBrowserFocus())&&this.eCell.focus({preventScroll:!0}),this.hideEditorPopup?.(),this.hideEditorPopup=void 0,this.cellEditor=e.destroyBean(this.cellEditor),this.cellEditorPopupWrapper=e.destroyBean(this.cellEditorPopupWrapper),_s(this.cellEditorGui),this.cellEditorGui=null,this.editorVersion++}refreshCellRenderer(e){if(this.cellRenderer?.refresh==null||this.cellRendererClass!==e.componentClass)return!1;const t=this.cellRenderer.refresh(e.params);return t===!0||t===void 0}createCellRendererInstance(e){const t=this.rendererVersion,{componentClass:n}=e,i=()=>{if(this.rendererVersion!==t||!this.isAlive())return;const o=e.newAgStackInstance(),a=this.afterCellRendererCreated.bind(this,t,n);o?.then(a)},{animationFrameSvc:r}=this.beans;r?.active&&this.firstRender?r.createTask(i,this.rowNode.rowIndex,"p2",e.componentFromFramework):i()}afterCellRendererCreated(e,t,n){if(!this.isAlive()||e!==this.rendererVersion){this.beans.context.destroyBean(n);return}this.cellRenderer=n,this.cellRendererClass=t;const r=n.getGui();if(this.cellRendererGui=r,r!=null){const s=this.getParentOfValue();Gi(s),s.appendChild(r)}}afterCellEditorCreated(e,t,n,i,r){const s=e!==this.editorVersion,{context:o}=this.beans;if(s){o.destroyBean(t);return}if(t.isCancelBeforeStart&&t.isCancelBeforeStart()){o.destroyBean(t),this.cellCtrl.stopEditing(!0);return}if(!t.getGui){de(97,{colId:this.column.getId()}),o.destroyBean(t);return}this.cellEditor=t,this.cellEditorGui=t.getGui();const l=i||t.isPopup!==void 0&&t.isPopup();l?this.addPopupCellEditor(n,r):this.addInCellEditor(),this.refreshEditStyles(!0,l),t.afterGuiAttached?.(),this.cellCtrl.cellEditorAttached()}refreshEditStyles(e,t){const{cellCssClassManager:n}=this;n.addOrRemoveCssClass("ag-cell-inline-editing",e&&!t),n.addOrRemoveCssClass("ag-cell-popup-editing",e&&!!t),n.addOrRemoveCssClass("ag-cell-not-inline-editing",!e||!!t),this.cellCtrl.setInlineEditingCss()}addInCellEditor(){const{eCell:e}=this;e.contains(nn(this.beans))&&e.focus(),this.destroyRenderer(),this.refreshWrapper(!0),Gi(this.getParentOfValue()),this.cellEditorGui&&this.getParentOfValue().appendChild(this.cellEditorGui)}addPopupCellEditor(e,t){const{gos:n,context:i,editSvc:r,popupSvc:s,localeSvc:o}=this.beans;n.get("editType")==="fullRow"&&de(98);const a=this.cellEditor;this.cellEditorPopupWrapper=i.createBean(r.createPopupEditorWrapper(e));const l=this.cellEditorPopupWrapper.getGui();this.cellEditorGui&&l.appendChild(this.cellEditorGui);const u=n.get("stopEditingWhenCellsLoseFocus"),c=t??a.getPopupPosition?.()??"over",d=n.get("enableRtl"),h={ePopup:l,column:this.column,rowNode:this.rowNode,type:"popupCellEditor",eventSource:this.eCell,position:c,alignSide:d?"right":"left",keepWithinBounds:!0},p=s.positionPopupByComponent.bind(s,h),g=XJ(o),m=s.addPopup({modal:u,eChild:l,closeOnEsc:!0,closedCallback:()=>{this.cellCtrl.onPopupEditorClosed()},anchorToElement:this.eCell,positionCallback:p,ariaLabel:g("ariaLabelCellEditor","Cell Editor")});m&&(this.hideEditorPopup=m.hideFunc)}detach(){this.eRow.removeChild(this.getGui())}destroy(){this.cellCtrl.stopEditing(),this.destroyRenderer(),this.destroyEditor(),this.removeControls(),super.destroy()}},pUe=class extends At{constructor(e,t,n){super(),this.cellComps=new Map,this.beans=t,this.rowCtrl=e;const i=Sn({tag:"div",role:"row",attrs:{"comp-id":`${this.getCompId()}`}});this.setInitialStyle(i,n),this.setTemplateFromElement(i);const r=i.style;this.domOrder=this.rowCtrl.getDomOrder();const s={setDomOrder:o=>this.domOrder=o,setCellCtrls:o=>this.setCellCtrls(o),showFullWidth:o=>this.showFullWidth(o),getFullWidthCellRenderer:()=>this.fullWidthCellRenderer,addOrRemoveCssClass:(o,a)=>this.addOrRemoveCssClass(o,a),setUserStyles:o=>_C(i,o),setTop:o=>r.top=o,setTransform:o=>r.transform=o,setRowIndex:o=>i.setAttribute("row-index",o),setRowId:o=>i.setAttribute("row-id",o),setRowBusinessKey:o=>i.setAttribute("row-business-key",o),refreshFullWidth:o=>this.fullWidthCellRenderer?.refresh?.(o())??!1};e.setComp(s,this.getGui(),n,void 0),this.addDestroyFunc(()=>{e.unsetComp(n)})}setInitialStyle(e,t){const n=this.rowCtrl.getInitialTransform(t);if(n)e.style.setProperty("transform",n);else{const i=this.rowCtrl.getInitialRowTop(t);i&&e.style.setProperty("top",i)}}showFullWidth(e){const t=i=>{if(this.isAlive()){const r=i.getGui();this.getGui().appendChild(r),this.rowCtrl.setupDetailRowAutoHeight(r),this.setFullWidthRowComp(i)}else this.beans.context.destroyBean(i)};e.newAgStackInstance().then(t)}setCellCtrls(e){const t=new Map(this.cellComps);for(const n of e){const i=n.instanceId;this.cellComps.has(i)?t.delete(i):this.newCellComp(n)}this.destroyCells(t),this.ensureDomOrder(e)}ensureDomOrder(e){if(!this.domOrder)return;const t=[];for(const n of e){const i=this.cellComps.get(n.instanceId);i&&t.push(i.getGui())}dee(this.getGui(),t)}newCellComp(e){const t=new fUe(this.beans,e,this.rowCtrl.printLayout,this.getGui(),this.rowCtrl.editing);this.cellComps.set(e.instanceId,t),this.getGui().appendChild(t.getGui())}destroy(){super.destroy(),this.destroyCells(this.cellComps)}setFullWidthRowComp(e){this.fullWidthCellRenderer=e,this.addDestroyFunc(()=>{this.fullWidthCellRenderer=this.beans.context.destroyBean(this.fullWidthCellRenderer)})}destroyCells(e){for(const t of e.values()){if(!t)return;const n=t.cellCtrl.instanceId;if(this.cellComps.get(n)!==t)return;t.detach(),t.destroy(),this.cellComps.delete(n)}}};function gUe(e,t,n){const i=!!n.gos.get("enableCellSpan")&&!!t.getSpannedRowCtrls,r={tag:"div",ref:"eContainer",cls:Cb(e),role:"rowgroup"};if(t.type==="center"||i){const s={tag:"div",ref:"eSpannedContainer",cls:`ag-spanning-container ${L4e(e)}`,role:"rowgroup"};return{tag:"div",ref:"eViewport",cls:`ag-viewport ${gte(e)}`,role:"presentation",children:[r,i?s:null]}}return r}var mUe=class extends At{constructor(e){super(),this.eViewport=ve,this.eContainer=ve,this.eSpannedContainer=ve,this.rowCompsNoSpan={},this.rowCompsWithSpan={},this.name=e?.name,this.options=LC(this.name)}postConstruct(){this.setTemplate(gUe(this.name,this.options,this.beans));const e={setHorizontalScroll:n=>this.eViewport.scrollLeft=n,setViewportHeight:n=>this.eViewport.style.height=n,setRowCtrls:({rowCtrls:n})=>this.setRowCtrls(n),setSpannedRowCtrls:n=>this.setRowCtrls(n,!0),setDomOrder:n=>{this.domOrder=n},setContainerWidth:n=>{this.eContainer.style.width=n,this.eSpannedContainer&&(this.eSpannedContainer.style.width=n)},setOffsetTop:n=>{const i=`translateY(${n})`;this.eContainer.style.transform=i,this.eSpannedContainer&&(this.eSpannedContainer.style.transform=i)}};this.createManagedBean(new q4e(this.name)).setComp(e,this.eContainer,this.eSpannedContainer,this.eViewport)}destroy(){this.setRowCtrls([]),this.setRowCtrls([],!0),super.destroy(),this.lastPlacedElement=null}setRowCtrls(e,t){const{beans:n,options:i}=this,r=t?this.eSpannedContainer:this.eContainer,s=t?{...this.rowCompsWithSpan}:{...this.rowCompsNoSpan},o={};t?this.rowCompsWithSpan=o:this.rowCompsNoSpan=o,this.lastPlacedElement=null;const a=[];for(const l of e){const u=l.instanceId,c=s[u];let d;if(c)d=c,delete s[u];else{if(!l.rowNode.displayed)continue;d=new pUe(l,n,i.type)}o[u]=d,a.push([d,!c])}this.removeOldRows(Object.values(s),r),this.addRowNodes(a,r)}addRowNodes(e,t){const{domOrder:n}=this;for(const[i,r]of e){const s=i.getGui();n?this.ensureDomOrder(s,t):r&&t.appendChild(s)}}removeOldRows(e,t){for(const n of e)t.removeChild(n.getGui()),n.destroy()}ensureDomOrder(e,t){cee(t,e,this.lastPlacedElement),this.lastPlacedElement=e}},vUe={selector:"AG-ROW-CONTAINER",component:mUe};function Dm(e,t){return t.map(n=>{const i=`e${n[0].toUpperCase()+n.substring(1)}RowContainer`;return e[i]={name:n},{tag:"ag-row-container",ref:i,attrs:{name:n}}})}function CUe(e){const t={},n={tag:"div",ref:"eGridRoot",cls:"ag-root ag-unselectable",children:[{tag:"ag-header-root"},{tag:"div",ref:"eTop",cls:"ag-floating-top",role:"presentation",children:Dm(t,["topLeft","topCenter","topRight","topFullWidth"])},{tag:"div",ref:"eBody",cls:"ag-body",role:"presentation",children:[{tag:"div",ref:"eBodyViewport",cls:"ag-body-viewport",role:"presentation",children:Dm(t,["left","center","right","fullWidth"])},{tag:"ag-fake-vertical-scroll"}]},{tag:"div",ref:"eStickyTop",cls:"ag-sticky-top",role:"presentation",children:Dm(t,["stickyTopLeft","stickyTopCenter","stickyTopRight","stickyTopFullWidth"])},{tag:"div",ref:"eStickyBottom",cls:"ag-sticky-bottom",role:"presentation",children:Dm(t,["stickyBottomLeft","stickyBottomCenter","stickyBottomRight","stickyBottomFullWidth"])},{tag:"div",ref:"eBottom",cls:"ag-floating-bottom",role:"presentation",children:Dm(t,["bottomLeft","bottomCenter","bottomRight","bottomFullWidth"])},{tag:"ag-fake-horizontal-scroll"},e?{tag:"ag-overlay-wrapper"}:null]};return{paramsMap:t,elementParams:n}}var yUe=class extends At{constructor(){super(...arguments),this.eGridRoot=ve,this.eBodyViewport=ve,this.eStickyTop=ve,this.eStickyBottom=ve,this.eTop=ve,this.eBottom=ve,this.eBody=ve}postConstruct(){const{overlays:e,rangeSvc:t}=this.beans,n=e?.getOverlayWrapperSelector(),{paramsMap:i,elementParams:r}=CUe(!!n);this.setTemplate(r,[...n?[n]:[],Z4e,t8e,hUe,vUe],i);const s=(a,l)=>{const u=`${a}px`;l.style.minHeight=u,l.style.height=u},o={setRowAnimationCssOnBodyViewport:(a,l)=>this.setRowAnimationCssOnBodyViewport(a,l),setColumnCount:a=>S5e(this.getGui(),a),setRowCount:a=>w5e(this.getGui(),a),setTopHeight:a=>s(a,this.eTop),setBottomHeight:a=>s(a,this.eBottom),setTopInvisible:a=>this.eTop.classList.toggle("ag-invisible",a),setBottomInvisible:a=>this.eBottom.classList.toggle("ag-invisible",a),setStickyTopHeight:a=>this.eStickyTop.style.height=a,setStickyTopTop:a=>this.eStickyTop.style.top=a,setStickyTopWidth:a=>this.eStickyTop.style.width=a,setStickyBottomHeight:a=>{this.eStickyBottom.style.height=a,this.eStickyBottom.classList.toggle("ag-invisible",a==="0px")},setStickyBottomBottom:a=>this.eStickyBottom.style.bottom=a,setStickyBottomWidth:a=>this.eStickyBottom.style.width=a,setColumnMovingCss:(a,l)=>this.addOrRemoveCssClass(a,l),updateLayoutClasses:(a,l)=>{const u=[this.eBodyViewport.classList,this.eBody.classList];for(const c of u)c.toggle(po.AUTO_HEIGHT,l.autoHeight),c.toggle(po.NORMAL,l.normal),c.toggle(po.PRINT,l.print);this.addOrRemoveCssClass(po.AUTO_HEIGHT,l.autoHeight),this.addOrRemoveCssClass(po.NORMAL,l.normal),this.addOrRemoveCssClass(po.PRINT,l.print)},setAlwaysVerticalScrollClass:(a,l)=>this.eBodyViewport.classList.toggle(Cte,l),registerBodyViewportResizeListener:a=>{const l=_c(this.beans,this.eBodyViewport,a);this.addDestroyFunc(()=>l())},setPinnedTopBottomOverflowY:a=>this.eTop.style.overflowY=this.eBottom.style.overflowY=a,setCellSelectableCss:(a,l)=>{[this.eTop,this.eBodyViewport,this.eBottom].forEach(u=>u.classList.toggle(a,l))},setBodyViewportWidth:a=>this.eBodyViewport.style.width=a,setGridRootRole:a=>Vl(this.eGridRoot,a)};this.ctrl=this.createManagedBean(new Y4e),this.ctrl.setComp(o,this.getGui(),this.eBodyViewport,this.eTop,this.eBottom,this.eStickyTop,this.eStickyBottom),(t&&Wl(this.gos)||x0(this.gos))&&y5e(this.getGui(),!0)}setRowAnimationCssOnBodyViewport(e,t){const n=this.eBodyViewport.classList;n.toggle("ag-row-animation",t),n.toggle("ag-row-no-animation",!t)}},wUe={selector:"AG-GRID-BODY",component:yUe},bUe=class extends Z{constructor(){super(...arguments),this.additionalFocusableContainers=new Set}setComp(e,t,n){this.view=e,this.eGridHostDiv=t,this.eGui=n,this.eGui.setAttribute("grid-id",this.beans.context.getGridId());const{dragAndDrop:i,ctrlsSvc:r}=this.beans;i?.registerGridDropTarget(()=>this.eGui,this),nte(this.gos,t),this.createManagedBean(new yN(this.view)),this.view.setRtlClass(this.gos.get("enableRtl")?"ag-rtl":"ag-ltr");const s=_c(this.beans,this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc(()=>s()),r.register("gridCtrl",this)}isDetailGrid(){return Jee(this.getGui())?.getAttribute("row-id")?.startsWith("detail")||!1}getOptionalSelectors(){const e=this.beans;return{paginationSelector:e.pagination?.getPaginationSelector(),gridHeaderDropZonesSelector:e.registry.getSelector("AG-GRID-HEADER-DROP-ZONES"),sideBarSelector:e.sideBar?.getSelector(),statusBarSelector:e.registry?.getSelector("AG-STATUS-BAR"),watermarkSelector:e.licenseManager?.getWatermarkSelector()}}onGridSizeChanged(){this.eventSvc.dispatchEvent({type:"gridSizeChanged",clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight})}destroyGridUi(){this.view.destroyGridUi()}getGui(){return this.eGui}setResizeCursor(e){this.view.setCursor(e?"ew-resize":null)}disableUserSelect(e){this.view.setUserSelect(e?"none":null)}focusNextInnerContainer(e){const t=this.getFocusableContainers(),{indexWithFocus:n,nextIndex:i}=this.getNextFocusableIndex(t,e);if(i<0||i>=t.length)return!1;if(i===0){if(n>0){const{visibleCols:r,focusSvc:s}=this.beans,o=r.allCols,a=Lt(o);if(s.focusGridView({column:a,backwards:!0}))return!0}return!1}return this.focusContainer(t[i],e)}focusInnerElement(e){const t=this.gos.getCallback("focusGridInnerElement");if(t&&t({fromBottom:!!e}))return!0;const n=this.getFocusableContainers(),{focusSvc:i,visibleCols:r}=this.beans,s=r.allCols;if(e){if(n.length>1)return this.focusContainer(Lt(n),e);const o=Lt(s);if(i.focusGridView({column:o,backwards:e}))return!0}if(this.gos.get("headerHeight")===0||Hd(this.beans)){if(i.focusGridView({column:s[0],backwards:e}))return!0;for(let o=1;o<n.length;o++)if(ph(n[o].getGui(),e))return!0;return!1}return i.focusFirstHeader()}forceFocusOutOfContainer(e=!1){this.view.forceFocusOutOfContainer(e)}addFocusableContainer(e){this.additionalFocusableContainers.add(e)}removeFocusableContainer(e){this.additionalFocusableContainers.delete(e)}allowFocusForNextCoreContainer(e){const t=this.view.getFocusableContainers(),{nextIndex:n,indexWithFocus:i}=this.getNextFocusableIndex(t,e);if(i===-1||n<0||n>=t.length)return;const r=t[n];r.setAllowFocus?.(!0),setTimeout(()=>{r.setAllowFocus?.(!1)})}isFocusable(){const e=this.beans;return!jR(e)||!Hd(e)||!!e.sideBar?.comp?.isDisplayed()}getNextFocusableIndex(e,t){const n=nn(this.beans),i=e.findIndex(s=>s.getGui().contains(n)),r=i+(t?-1:1);return{indexWithFocus:i,nextIndex:r}}focusContainer(e,t){e.setAllowFocus?.(!0);const n=ph(e.getGui(),t,!1,!0);return e.setAllowFocus?.(!1),n}getFocusableContainers(){return[...this.view.getFocusableContainers(),...this.additionalFocusableContainers]}destroy(){this.additionalFocusableContainers.clear(),super.destroy()}},SUe=class extends Fte{constructor(e){super(),this.gridBody=ve,this.sideBar=ve,this.pagination=ve,this.rootWrapperBody=ve,this.eGridDiv=e}postConstruct(){const e={destroyGridUi:()=>this.destroyBean(this),setRtlClass:s=>this.addCssClass(s),forceFocusOutOfContainer:this.forceFocusOutOfContainer.bind(this),updateLayoutClasses:this.updateLayoutClasses.bind(this),getFocusableContainers:this.getFocusableContainers.bind(this),setUserSelect:s=>{this.getGui().style.userSelect=s??"",this.getGui().style.webkitUserSelect=s??""},setCursor:s=>{this.getGui().style.cursor=s??""}},t=this.createManagedBean(new bUe),n=t.getOptionalSelectors(),i=this.createTemplate(n),r=[wUe,...Object.values(n).filter(s=>!!s)];this.setTemplate(i,r),t.setComp(e,this.eGridDiv,this.getGui()),this.insertGridIntoDom(),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:s=>t.focusInnerElement(s),forceFocusOutWhenTabGuardsAreEmpty:!0,isEmpty:()=>!t.isFocusable()})}insertGridIntoDom(){const e=this.getGui();this.eGridDiv.appendChild(e),this.addDestroyFunc(()=>{this.eGridDiv.removeChild(e),fc(this.gos,"Grid removed from DOM")})}updateLayoutClasses(e,t){const n=this.rootWrapperBody.classList,{AUTO_HEIGHT:i,NORMAL:r,PRINT:s}=po,{autoHeight:o,normal:a,print:l}=t;n.toggle(i,o),n.toggle(r,a),n.toggle(s,l),this.addOrRemoveCssClass(i,o),this.addOrRemoveCssClass(r,a),this.addOrRemoveCssClass(s,l)}createTemplate(e){const t=e.gridHeaderDropZonesSelector?{tag:"ag-grid-header-drop-zones"}:null,n=e.sideBarSelector?{tag:"ag-side-bar",ref:"sideBar"}:null,i=e.statusBarSelector?{tag:"ag-status-bar"}:null,r=e.watermarkSelector?{tag:"ag-watermark"}:null,s=e.paginationSelector?{tag:"ag-pagination",ref:"pagination"}:null;return{tag:"div",cls:"ag-root-wrapper",role:"presentation",children:[t,{tag:"div",ref:"rootWrapperBody",cls:"ag-root-wrapper-body",role:"presentation",children:[{tag:"ag-grid-body",ref:"gridBody"},n]},i,s,r]}}getFocusableElement(){return this.rootWrapperBody}forceFocusOutOfContainer(e=!1){if(!e&&this.pagination?.isDisplayed()){this.pagination.forceFocusOutOfContainer(e);return}super.forceFocusOutOfContainer(e)}getFocusableContainers(){const e=[this.gridBody];return[this.sideBar,this.pagination].forEach(t=>{t&&e.push(t)}),e.filter(t=>Io(t.getGui()))}},qe=(e,t)=>{for(const n of Object.keys(t))t[n]=e;return t},TW={dispatchEvent:"CommunityCore",...qe("CommunityCore",{destroy:0,getGridId:0,getGridOption:0,isDestroyed:0,setGridOption:0,updateGridOptions:0}),...qe("GridState",{getState:0}),...qe("SharedRowSelection",{setNodesSelected:0,selectAll:0,deselectAll:0,selectAllFiltered:0,deselectAllFiltered:0,selectAllOnCurrentPage:0,deselectAllOnCurrentPage:0,getSelectedNodes:0,getSelectedRows:0}),...qe("RowApi",{redrawRows:0,setRowNodeExpanded:0,getRowNode:0,addRenderedRowListener:0,getRenderedNodes:0,forEachNode:0,getFirstDisplayedRowIndex:0,getLastDisplayedRowIndex:0,getDisplayedRowAtIndex:0,getDisplayedRowCount:0}),...qe("ScrollApi",{getVerticalPixelRange:0,getHorizontalPixelRange:0,ensureColumnVisible:0,ensureIndexVisible:0,ensureNodeVisible:0}),...qe("KeyboardNavigation",{getFocusedCell:0,clearFocusedCell:0,setFocusedCell:0,tabToNextCell:0,tabToPreviousCell:0,setFocusedHeader:0}),...qe("EventApi",{addEventListener:0,addGlobalListener:0,removeEventListener:0,removeGlobalListener:0}),...qe("ValueCache",{expireValueCache:0}),...qe("CellApi",{getCellValue:0}),...qe("SharedMenu",{showColumnMenu:0,hidePopupMenu:0}),...qe("Sort",{onSortChanged:0}),...qe("PinnedRow",{getPinnedTopRowCount:0,getPinnedBottomRowCount:0,getPinnedTopRow:0,getPinnedBottomRow:0}),...qe("Overlay",{showLoadingOverlay:0,showNoRowsOverlay:0,hideOverlay:0}),...qe("RenderApi",{setGridAriaProperty:0,refreshCells:0,refreshHeader:0,isAnimationFrameQueueEmpty:0,flushAllAnimationFrames:0,getSizesForCurrentTheme:0,getCellRendererInstances:0}),...qe("HighlightChanges",{flashCells:0}),...qe("RowDrag",{addRowDropZone:0,removeRowDropZone:0,getRowDropZoneParams:0}),...qe("ColumnApi",{getColumnDefs:0,getColumnDef:0,getDisplayNameForColumn:0,getColumn:0,getColumns:0,applyColumnState:0,getColumnState:0,resetColumnState:0,isPinning:0,isPinningLeft:0,isPinningRight:0,getDisplayedColAfter:0,getDisplayedColBefore:0,setColumnsVisible:0,setColumnsPinned:0,getAllGridColumns:0,getDisplayedLeftColumns:0,getDisplayedCenterColumns:0,getDisplayedRightColumns:0,getAllDisplayedColumns:0,getAllDisplayedVirtualColumns:0}),...qe("ColumnAutoSize",{sizeColumnsToFit:0,autoSizeColumns:0,autoSizeAllColumns:0}),...qe("ColumnGroup",{setColumnGroupOpened:0,getColumnGroup:0,getProvidedColumnGroup:0,getDisplayNameForColumnGroup:0,getColumnGroupState:0,setColumnGroupState:0,resetColumnGroupState:0,getLeftDisplayedColumnGroups:0,getCenterDisplayedColumnGroups:0,getRightDisplayedColumnGroups:0,getAllDisplayedColumnGroups:0}),...qe("ColumnMove",{moveColumnByIndex:0,moveColumns:0}),...qe("ColumnResize",{setColumnWidths:0}),...qe("ColumnHover",{isColumnHovered:0}),...qe("EditCore",{getCellEditorInstances:0,getEditingCells:0,stopEditing:0,startEditingCell:0}),...qe("UndoRedoEdit",{undoCellEditing:0,redoCellEditing:0,getCurrentUndoSize:0,getCurrentRedoSize:0}),...qe("FilterCore",{isAnyFilterPresent:0,onFilterChanged:0}),...qe("ColumnFilter",{isColumnFilterPresent:0,getColumnFilterInstance:0,destroyFilter:0,setFilterModel:0,getFilterModel:0,getColumnFilterModel:0,setColumnFilterModel:0,showColumnFilter:0}),...qe("QuickFilter",{isQuickFilterPresent:0,getQuickFilter:0,resetQuickFilter:0}),...qe("Find",{findGetActiveMatch:0,findGetTotalMatches:0,findGoTo:0,findNext:0,findPrevious:0,findGetNumMatches:0,findGetParts:0,findClearActive:0,findRefresh:0}),...qe("Pagination",{paginationIsLastPageFound:0,paginationGetPageSize:0,paginationGetCurrentPage:0,paginationGetTotalPages:0,paginationGetRowCount:0,paginationGoToNextPage:0,paginationGoToPreviousPage:0,paginationGoToFirstPage:0,paginationGoToLastPage:0,paginationGoToPage:0}),...qe("CsrmSsrmSharedApi",{expandAll:0,collapseAll:0,onRowHeightChanged:0}),...qe("SsrmInfiniteSharedApi",{setRowCount:0,getCacheBlockState:0,isLastRowIndexKnown:0}),...qe("ClientSideRowModelApi",{onGroupExpandedOrCollapsed:0,refreshClientSideRowModel:0,isRowDataEmpty:0,forEachLeafNode:0,forEachNodeAfterFilter:0,forEachNodeAfterFilterAndSort:0,resetRowHeights:0,applyTransaction:0,applyTransactionAsync:0,flushAsyncTransactions:0,getBestCostNodeSelection:0}),...qe("CsvExport",{getDataAsCsv:0,exportDataAsCsv:0}),...qe("InfiniteRowModel",{refreshInfiniteCache:0,purgeInfiniteCache:0,getInfiniteRowCount:0}),...qe("AdvancedFilter",{getAdvancedFilterModel:0,setAdvancedFilterModel:0,showAdvancedFilterBuilder:0,hideAdvancedFilterBuilder:0}),...qe("IntegratedCharts",{getChartModels:0,getChartRef:0,getChartImageDataURL:0,downloadChart:0,openChartToolPanel:0,closeChartToolPanel:0,createRangeChart:0,createPivotChart:0,createCrossFilterChart:0,updateChart:0,restoreChart:0}),...qe("Clipboard",{copyToClipboard:0,cutToClipboard:0,copySelectedRowsToClipboard:0,copySelectedRangeToClipboard:0,copySelectedRangeDown:0,pasteFromClipboard:0}),...qe("ExcelExport",{getDataAsExcel:0,exportDataAsExcel:0,getSheetDataForExcel:0,getMultipleSheetsAsExcel:0,exportMultipleSheetsAsExcel:0}),...qe("SharedMasterDetail",{addDetailGridInfo:0,removeDetailGridInfo:0,getDetailGridInfo:0,forEachDetailGridInfo:0}),...qe("ContextMenu",{showContextMenu:0}),...qe("ColumnMenu",{showColumnChooser:0,hideColumnChooser:0}),...qe("CellSelection",{getCellRanges:0,addCellRange:0,clearRangeSelection:0,clearCellSelection:0}),...qe("SharedRowGrouping",{setRowGroupColumns:0,removeRowGroupColumns:0,addRowGroupColumns:0,getRowGroupColumns:0,moveRowGroupColumn:0}),...qe("SharedAggregation",{addAggFuncs:0,clearAggFuncs:0,setColumnAggFunc:0}),...qe("SharedPivot",{isPivotMode:0,getPivotResultColumn:0,setValueColumns:0,getValueColumns:0,removeValueColumns:0,addValueColumns:0,setPivotColumns:0,removePivotColumns:0,addPivotColumns:0,getPivotColumns:0,setPivotResultColumns:0,getPivotResultColumns:0}),...qe("ServerSideRowModelApi",{getServerSideSelectionState:0,setServerSideSelectionState:0,applyServerSideTransaction:0,applyServerSideTransactionAsync:0,applyServerSideRowData:0,retryServerSideLoads:0,flushServerSideAsyncTransactions:0,refreshServerSide:0,getServerSideGroupLevelState:0}),...qe("SideBar",{isSideBarVisible:0,setSideBarVisible:0,setSideBarPosition:0,openToolPanel:0,closeToolPanel:0,getOpenedToolPanel:0,refreshToolPanel:0,isToolPanelShowing:0,getToolPanelInstance:0,getSideBar:0}),...qe("StatusBar",{getStatusPanel:0})},JD={isDestroyed:()=>!0,destroy(){},preConstruct(){},postConstruct(){},preWireBeans(){},wireBeans(){}},xUe=(e,t)=>e.eventSvc.dispatchEvent(t),Dte=class{};Reflect.defineProperty(Dte,"name",{value:"GridApi"});var RUe=class extends Z{constructor(){super(),this.beanName="apiFunctionSvc",this.api=new Dte,this.fns={...JD,dispatchEvent:xUe},this.preDestroyLink="";const{api:e}=this;for(const t of Object.keys(TW))e[t]=this.makeApi(t)[t]}postConstruct(){this.preDestroyLink=this.beans.frameworkOverrides.getDocLink("grid-lifecycle/#grid-pre-destroyed")}addFunction(e,t){const{fns:n,beans:i}=this;n!==JD&&(n[e]=i?.validation?.validateApiFunction(e,t)??t)}makeApi(e){return{[e]:(...t)=>{const{beans:n,fns:{[e]:i}}=this;return i?i(n,...t):this.apiNotFound(e)}}}apiNotFound(e){const{beans:t,gos:n,preDestroyLink:i}=this;if(!t)de(26,{fnName:e,preDestroyLink:i});else{const r=TW[e];n.assertModuleRegistered(r,`api.${e}`)&&de(27,{fnName:e,module:r})}}destroy(){super.destroy(),this.fns=JD,this.beans=null}};function EUe(e){return e.context.getGridId()}function FUe(e){e.gridDestroySvc.destroy()}function AUe(e){return e.gridDestroySvc.destroyCalled}function DUe(e,t){return e.gos.get(t)}function kUe(e,t,n){kte(e,{[t]:n})}function kte(e,t){e.gos.updateGridOptions({options:t})}var PUe={tag:"div",cls:"ag-drag-handle ag-row-drag",attrs:{draggable:"true"}},MUe=class extends At{constructor(e,t,n){super(PUe),this.rowNode=e,this.column=t,this.eCell=n}postConstruct(){this.getGui().appendChild(Os("rowDrag",this.beans,null)),this.addGuiEventListener("mousedown",t=>{t.stopPropagation()}),this.addDragSource(),this.checkVisibility()}addDragSource(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))}onDragStart(e){const{rowNode:t,column:n,eCell:i,gos:r}=this,s=n.getColDef().dndSourceOnRowDrag,o=e.dataTransfer;if(o.setDragImage(i,0,0),s){const a=ze(r,{rowNode:t,dragEvent:e});s(a)}else try{const a=JSON.stringify(t.data);o.setData("application/json",a),o.setData("text/plain",a)}catch{}}checkVisibility(){const e=this.column.isDndSource(this.rowNode);this.setDisplayed(e)}};function TUe(e,t){e.rowDragSvc?.rowDragFeature?.addRowDropZone(t)}function IUe(e,t){const n=e.dragAndDrop?.findExternalZone(t);n&&e.dragAndDrop?.removeDropTarget(n)}function _Ue(e,t){return e.rowDragSvc?.rowDragFeature?.getRowDropZone(t)}var OUe=class extends Z{constructor(){super(...arguments),this.beanName="horizontalResizeSvc"}addResizeBar(e){const t={dragStartPixels:e.dragStartPixels||0,eElement:e.eResizeBar,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this,e),onDragging:this.onDragging.bind(this,e),onDragCancel:this.onDragStop.bind(this,e),includeTouch:!0,stopPropagationForTouch:!0},{dragSvc:n}=this.beans;return n.addDragSource(t),()=>n.removeDragSource(t)}onDragStart(e,t){this.dragStartX=t.clientX,this.setResizeIcons();const n=t instanceof MouseEvent&&t.shiftKey===!0;e.onResizeStart(n)}setResizeIcons(){const e=this.beans.ctrlsSvc.get("gridCtrl");e.setResizeCursor(!0),e.disableUserSelect(!0)}onDragStop(e){e.onResizeEnd(this.resizeAmount),this.resetIcons()}resetIcons(){const e=this.beans.ctrlsSvc.get("gridCtrl");e.setResizeCursor(!1),e.disableUserSelect(!1)}onDragging(e,t){this.resizeAmount=t.clientX-this.dragStartX,e.onResizing(this.resizeAmount)}},LUe={tag:"div",cls:"ag-drag-handle ag-row-drag",attrs:{"aria-hidden":"true"}},NUe=class extends At{constructor(e,t,n,i,r,s){super(),this.cellValueFn=e,this.rowNode=t,this.column=n,this.customGui=i,this.dragStartPixels=r,this.suppressVisibilityChange=s,this.dragSource=null}isCustomGui(){return this.customGui!=null}postConstruct(){const{beans:e,rowNode:t,column:n,gos:i}=this;if(this.customGui?this.setDragElement(this.customGui,this.dragStartPixels):(this.setTemplate(LUe),this.getGui().appendChild(Os("rowDrag",e,null)),this.addDragSource()),!this.suppressVisibilityChange){const r=i.get("rowDragManaged")?new BUe(this,t,n):new $Ue(this,t,n);this.createManagedBean(r,this.beans.context)}}setDragElement(e,t){this.setTemplateFromElement(e,void 0,void 0,!0),this.addDragSource(t)}getSelectedNodes(){const e=this.rowNode;if(!this.gos.get("rowDragMultiRow"))return[e];const n=this.beans.selectionSvc?.getSelectedNodes()??[];return n.indexOf(e)!==-1?n:[e]}getDragItem(){const{column:e,rowNode:t}=this;return{rowNode:t,rowNodes:this.getSelectedNodes(),columns:e?[e]:void 0,defaultTextValue:this.cellValueFn()}}getRowDragText(e){if(e){const t=e.getColDef();if(t.rowDragText)return t.rowDragText}return this.gos.get("rowDragText")}addDragSource(e=4){this.dragSource&&this.removeDragSource();const t=this.getGui();this.gos.get("enableCellTextSelection")&&(this.removeMouseDownListener(),this.mouseDownListener=this.addManagedElementListeners(t,{mousedown:i=>{i?.preventDefault()}})[0]);const n=this.getLocaleTextFunc();this.dragSource={type:2,eElement:t,dragItemName:()=>{const i=this.getDragItem(),r=i.rowNodes?.length||1,s=this.getRowDragText(this.column);return s?s(i,r):r===1?this.cellValueFn():`${r} ${n("rowDragRows","rows")}`},getDragItem:()=>this.getDragItem(),dragStartPixels:e,dragSourceDomDataKey:this.gos.getDomDataKey()},this.beans.dragAndDrop.addDragSource(this.dragSource,!0)}destroy(){this.removeDragSource(),this.removeMouseDownListener(),super.destroy()}removeDragSource(){this.dragSource&&(this.beans.dragAndDrop.removeDragSource(this.dragSource),this.dragSource=null)}removeMouseDownListener(){this.mouseDownListener&&(this.mouseDownListener(),this.mouseDownListener=void 0)}},Pte=class extends Z{constructor(e,t,n){super(),this.parent=e,this.rowNode=t,this.column=n}setDisplayedOrVisible(e){const t={skipAriaHidden:!0};if(e)this.parent.setDisplayed(!1,t);else{let n=!0,i=!1;const{column:r,rowNode:s,parent:o}=this;r&&(n=r.isRowDrag(s)||o.isCustomGui(),i=typeof r.getColDef().rowDrag=="function"),i?(o.setDisplayed(!0,t),o.setVisible(n,t)):(o.setDisplayed(n,t),o.setVisible(!0,t))}}},$Ue=class extends Pte{postConstruct(){this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this));const e=this.workOutVisibility.bind(this);this.addManagedListeners(this.rowNode,{dataChanged:e,cellChanged:e}),this.addManagedListeners(this.beans.eventSvc,{newColumnsLoaded:e}),this.workOutVisibility()}onSuppressRowDrag(){this.workOutVisibility()}workOutVisibility(){const e=this.gos.get("suppressRowDrag");this.setDisplayedOrVisible(e)}},BUe=class extends Pte{postConstruct(){const e=this.workOutVisibility.bind(this);this.addManagedListeners(this.beans.eventSvc,{sortChanged:e,filterChanged:e,columnRowGroupChanged:e,newColumnsLoaded:e}),this.addManagedListeners(this.rowNode,{dataChanged:e,cellChanged:e}),this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.workOutVisibility()}onSuppressRowDrag(){this.workOutVisibility()}workOutVisibility(){const{rowDragSvc:e,dragAndDrop:t,gos:n}=this.beans,i=e.rowDragFeature,r=i&&i.shouldPreventRowMove(),s=n.get("suppressRowDrag"),o=t.hasExternalDropZones(),a=r&&!o||s;this.setDisplayedOrVisible(a)}},GUe=class extends Z{constructor(){super(...arguments),this.beanName="rowDragSvc"}setupRowDrag(e,t){const n=t.createManagedBean(new d4e(e)),i=this.beans.dragAndDrop;i.addDropTarget(n),t.addDestroyFunc(()=>i.removeDropTarget(n)),this.rowDragFeature=n}createRowDragComp(e,t,n,i,r,s){return new NUe(e,t,n,i,r,s)}createRowDragCompForRow(e,t){if(Wl(this.gos))return;const n=this.getLocaleTextFunc();return this.createRowDragComp(()=>`1 ${n("rowDragRow","row")}`,e,void 0,t,void 0,!0)}createRowDragCompForCell(e,t,n,i,r,s){const o=this.gos;return o.get("rowDragManaged")&&(!tr(o)||o.get("pagination"))?void 0:this.createRowDragComp(n,e,t,i,r,s)}},Mte={moduleName:"Drag",version:we,beans:[h4e]},zUe={moduleName:"DragAndDrop",version:we,dynamicBeans:{dndSourceComp:MUe},icons:{rowDrag:"grip"}},Tte={moduleName:"SharedDragAndDrop",version:we,beans:[i4e],dependsOn:[Mte],userComponents:{agDragAndDropImage:F8e},icons:{columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",rowDrag:"grip"}},HUe={moduleName:"RowDrag",version:we,beans:[GUe],apiFunctions:{addRowDropZone:TUe,removeRowDropZone:IUe,getRowDropZoneParams:_Ue},dependsOn:[Tte]},VUe={moduleName:"HorizontalResize",version:we,beans:[OUe],dependsOn:[Mte]},WUe=":where(.ag-ltr) :where(.ag-column-moving){.ag-cell,.ag-header-cell,.ag-spanned-cell-wrapper{transition:left .2s}.ag-header-group-cell{transition:left .2s,width .2s}}:where(.ag-rtl) :where(.ag-column-moving){.ag-cell,.ag-header-cell,.ag-spanned-cell-wrapper{transition:right .2s}.ag-header-group-cell{transition:right .2s,width .2s}}",UUe=class extends Z{constructor(){super(...arguments),this.beanName="colAnimation",this.executeNextFuncs=[],this.executeLaterFuncs=[],this.active=!1,this.activeNext=!1,this.suppressAnimation=!1,this.animationThreadCount=0}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>this.gridBodyCtrl=e.gridBodyCtrl)}isActive(){return this.active&&!this.suppressAnimation}setSuppressAnimation(e){this.suppressAnimation=e}start(){if(this.active)return;const{gos:e}=this;e.get("suppressColumnMoveAnimation")||e.get("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0,this.activeNext=!0)}finish(){this.active&&this.flush(()=>this.activeNext=!1,()=>this.active=!1)}executeNextVMTurn(e){this.activeNext?this.executeNextFuncs.push(e):e()}executeLaterVMTurn(e){this.active?this.executeLaterFuncs.push(e):e()}ensureAnimationCssClassPresent(){this.animationThreadCount++;const e=this.animationThreadCount,{gridBodyCtrl:t}=this;t.setColumnMovingCss(!0),this.executeLaterFuncs.push(()=>{this.animationThreadCount===e&&t.setColumnMovingCss(!1)})}flush(e,t){const{executeNextFuncs:n,executeLaterFuncs:i}=this;if(n.length===0&&i.length===0){e(),t();return}const r=s=>{for(;s.length;){const o=s.pop();o&&o()}};this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e(),r(n)},0),window.setTimeout(()=>{t(),r(i)},200)})}};function qUe(e,t,n){e.colMoves?.moveColumnByIndex(t,n,"api")}function jUe(e,t,n){e.colMoves?.moveColumns(t,n,"api")}var KUe=class extends Z{constructor(e){super(),this.pinned=e,this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[]}onDragEnter(e){if(this.clearColumnsList(),this.gos.get("functionsReadOnly"))return;const t=e.dragItem.columns;t&&t.forEach(n=>{n.isPrimary()&&(n.isAnyFunctionActive()||(n.isAllowValue()?this.columnsToAggregate.push(n):n.isAllowRowGroup()?this.columnsToGroup.push(n):n.isAllowPivot()&&this.columnsToPivot.push(n)))})}getIconName(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?"pinned":"move":null}onDragLeave(e){this.clearColumnsList()}clearColumnsList(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0}onDragging(e){}onDragStop(e){const{valueColsSvc:t,rowGroupColsSvc:n,pivotColsSvc:i}=this.beans;this.columnsToAggregate.length>0&&t?.addColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&n?.addColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&i?.addColumns(this.columnsToPivot,"toolPanelDragAndDrop")}onDragCancel(){this.clearColumnsList()}};function YUe(e,t){!t||t.length<=1||t.filter(i=>e.indexOf(i)<0).length>0||t.sort((i,r)=>{const s=e.indexOf(i),o=e.indexOf(r);return s-o})}function Ite(e){const{isFromHeader:t,fromLeft:n,xPosition:i,fromEnter:r,fakeEvent:s,pinned:o,gos:a,colModel:l,colMoves:u,visibleCols:c}=e;let{allMovingColumns:d}=e;if(t){const E=[];d.forEach(A=>{let F=null,P=A.getParent();for(;P!=null&&P.getDisplayedLeafColumns().length===1;)F=P,P=P.getParent();F!=null?(!!F.getColGroupDef()?.marryChildren?F.getProvidedColumnGroup().getLeafColumns():F.getLeafColumns()).forEach(O=>{E.includes(O)||E.push(O)}):E.includes(A)||E.push(A)}),d=E}const h=d.slice();YUe(l.getCols(),h);const p=JUe({movingCols:h,draggingRight:n,xPosition:i,pinned:o,gos:a,colModel:l,visibleCols:c}),g=XUe(h,l);if(p.length===0)return;const m=p[0];let C=g!==null&&!r;if(t&&(C=g!==null),C&&!s&&(!n&&m>=g||n&&m<=g))return;const y=c.allCols,b=[];let S=null;for(let E=0;E<p.length;E++){const A=p[E],F=u.getProposedColumnOrder(h,A);if(!u.doesOrderPassRules(F))continue;const P=F.filter(M=>y.includes(M));if(S===null)S=P;else if(!Nh(P,S))break;const D=QUe(F);b.push({move:A,fragCount:D})}if(b.length===0)return;b.sort((E,A)=>E.fragCount-A.fragCount);const x=b[0].move;if(!(x>l.getCols().length-d.length))return{columns:d,toIndex:x}}function _te(e){const{columns:t,toIndex:n}=Ite(e)||{},{finished:i,colMoves:r}=e;return!t||n==null?null:(r.moveColumns(t,n,"uiColumnMoved",i),i?null:{columns:t,toIndex:n})}function XUe(e,t){const n=t.getCols(),i=e.map(l=>n.indexOf(l)).sort((l,u)=>l-u),r=i[0];return Lt(i)-r!==i.length-1?null:r}function QUe(e){function t(i){const r=[];let s=i.getOriginalParent();for(;s!=null;)r.push(s),s=s.getOriginalParent();return r}let n=0;for(let i=0;i<e.length-1;i++){let r=t(e[i]),s=t(e[i+1]);[r,s]=r.length>s.length?[r,s]:[s,r],r.forEach(o=>{s.indexOf(o)===-1&&n++})}return n}function ZUe(e,t){switch(t){case"left":return e.leftCols;case"right":return e.rightCols;default:return e.centerCols}}function JUe(e){const{movingCols:t,draggingRight:n,xPosition:i,pinned:r,gos:s,colModel:o,visibleCols:a}=e;if(s.get("suppressMovableColumns")||t.some(S=>S.getColDef().suppressMovable))return[];const u=ZUe(a,r),c=o.getCols(),d=u.filter(S=>t.includes(S)),h=u.filter(S=>!t.includes(S)),p=c.filter(S=>!t.includes(S));let g=0,m=i;if(n){let S=0;d.forEach(x=>S+=x.getActualWidth()),m-=S}if(m>0){for(let S=0;S<h.length;S++){const x=h[S];if(m-=x.getActualWidth(),m<0)break;g++}n&&g++}let C;if(g>0){const S=h[g-1];C=p.indexOf(S)+1}else C=p.indexOf(h[0]),C===-1&&(C=0);const y=[C],b=(S,x)=>S-x;if(n){let S=C+1;const x=c.length-1;for(;S<=x;)y.push(S),S++;y.sort(b)}else{let S=C;const x=c.length-1;let E=c[S];for(;S<=x&&u.indexOf(E)<0;)S++,y.push(S),E=c[S];S=C-1;const A=0;for(;S>=A;)y.push(S),S--;y.sort(b).reverse()}return y}function uT(e){const{pinned:t,fromKeyboard:n,gos:i,ctrlsSvc:r,useHeaderRow:s,skipScrollPadding:o}=e;let a=r.getHeaderRowContainerCtrl(t)?.eViewport,{x:l}=e;return a?(n&&(l-=a.getBoundingClientRect().left),i.get("enableRtl")&&(s&&(a=a.querySelector(".ag-header-row")),l=a.clientWidth-l),t==null&&!o&&(l+=r.get("center").getCenterViewportScrollLeft()),l):0}function ek(e,t){for(const n of e)n.moving=t,n.dispatchColEvent("movingChanged","uiColumnMoved")}var IW=7,cT=100,Ow=cT/2,e9e=5,t9e=100,n9e=class extends Z{constructor(e){super(),this.pinned=e,this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.isCenterContainer=!Ce(e)}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl})}getIconName(){const{pinned:e,lastDraggingEvent:t}=this,n=t?.dragItem.columns??[];for(const i of n){const r=i.getPinned();if(i.getColDef().lockPinned){if(r==e)return"move";continue}if(r===e||!e)return"move";if(!r&&e)return"pinned"}return"notAllowed"}onDragEnter(e){const t=e.dragItem,n=t.columns;if(e.dragSource.type===0)this.setColumnsVisible(n,!0,"uiColumnDragged");else{const r=t.visibleState,s=(n||[]).filter(o=>r[o.getId()]);this.setColumnsVisible(s,!0,"uiColumnDragged")}this.gos.get("suppressMoveWhenColumnDragging")||this.attemptToPinColumns(n,this.pinned),this.onDragging(e,!0,!0)}onDragging(e=this.lastDraggingEvent,t=!1,n=!1,i=!1){const{gos:r,ctrlsSvc:s}=this.beans,o=r.get("suppressMoveWhenColumnDragging");if(i&&!o){this.finishColumnMoving();return}if(this.lastDraggingEvent=e,!e||!i&&Xt(e.hDirection))return;const a=uT({x:e.x,pinned:this.pinned,gos:r,ctrlsSvc:s});t||this.checkCenterForScrolling(a),o?this.handleColumnDragWhileSuppressingMovement(e,t,n,a,i):this.handleColumnDragWhileAllowingMovement(e,t,n,a,i)}onDragLeave(){this.ensureIntervalCleared(),this.clearHighlighted(),this.lastMovedInfo=null}onDragStop(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null}onDragCancel(){this.clearHighlighted(),this.ensureIntervalCleared(),this.lastMovedInfo=null}setColumnsVisible(e,t,n){if(!e)return;const i=e.filter(r=>!r.getColDef().lockVisible);this.beans.colModel.setColsVisible(i,t,n)}finishColumnMoving(){this.clearHighlighted();const e=this.lastMovedInfo;if(!e)return;const{columns:t,toIndex:n}=e;this.beans.colMoves.moveColumns(t,n,"uiColumnMoved",!0)}handleColumnDragWhileSuppressingMovement(e,t,n,i,r){const s=this.getAllMovingColumns(e,!0);if(r){const o=this.isAttemptingToPin(s);o&&this.attemptToPinColumns(s,void 0,!0);const{fromLeft:a,xPosition:l}=this.getNormalisedXPositionInfo(s,o)||{};if(a==null||l==null){this.finishColumnMoving();return}this.moveColumnsAfterHighlight({allMovingColumns:s,xPosition:l,fromEnter:t,fakeEvent:n,fromLeft:a})}else{if(!this.beans.dragAndDrop.isDropZoneWithinThisGrid(e))return;this.highlightHoveredColumn(s,i)}}handleColumnDragWhileAllowingMovement(e,t,n,i,r){const s=this.getAllMovingColumns(e),o=this.normaliseDirection(e.hDirection)==="right",a=e.dragSource.type===1,l=this.getMoveColumnParams({allMovingColumns:s,isFromHeader:a,xPosition:i,fromLeft:o,fromEnter:t,fakeEvent:n}),u=_te({...l,finished:r});u&&(this.lastMovedInfo=u)}getAllMovingColumns(e,t=!1){const n=e.dragSource.getDragItem();let i=null;t?(i=n.columnsInSplit,i||(i=n.columns)):i=n.columns;const r=s=>s.getColDef().lockPinned?s.getPinned()==this.pinned:!0;return i?i.filter(r):[]}getMoveColumnParams(e){const{allMovingColumns:t,isFromHeader:n,xPosition:i,fromLeft:r,fromEnter:s,fakeEvent:o}=e,{gos:a,colModel:l,colMoves:u,visibleCols:c}=this.beans;return{allMovingColumns:t,isFromHeader:n,fromLeft:r,xPosition:i,pinned:this.pinned,fromEnter:s,fakeEvent:o,gos:a,colModel:l,colMoves:u,visibleCols:c}}highlightHoveredColumn(e,t){const{gos:n,colModel:i}=this.beans,r=n.get("enableRtl"),s=i.getCols().filter(c=>c.isVisible()&&c.getPinned()===this.pinned);let o=null,a=null,l=null;for(const c of s){if(a=c.getActualWidth(),o=this.getNormalisedColumnLeft(c,0,r),o!=null){const d=o+a;if(o<=t&&d>=t){l=c;break}}o=null,a=null}if(l)e.indexOf(l)!==-1&&(l=null);else{for(let c=s.length-1;c>=0;c--){const d=s[c],h=s[c].getParent();if(!h){l=d;break}const p=h?.getDisplayedLeafColumns();if(p.length){l=Lt(p);break}}if(!l)return;o=this.getNormalisedColumnLeft(l,0,r),a=l.getActualWidth()}if(this.lastHighlightedColumn?.column!==l&&this.clearHighlighted(),l==null||o==null||a==null)return;let u;t-o<a/2!==r?u=0:u=1,_W(l,u),this.lastHighlightedColumn={column:l,position:u}}getNormalisedXPositionInfo(e,t){const{gos:n,visibleCols:i}=this.beans,r=n.get("enableRtl"),{firstMovingCol:s,column:o,position:a}=this.getColumnMoveAndTargetInfo(e,t,r);if(!s||!o||a==null)return;const l=i.allCols,u=l.indexOf(s),c=l.indexOf(o),d=a===0!==r,h=u<c||u===c&&!d;let p=0;if(d?h&&(p-=1):h||(p+=1),c+p===u)return;const g=l[c+p];if(!g)return;const m=this.getNormalisedColumnLeft(g,20,r);return{fromLeft:h,xPosition:m}}getColumnMoveAndTargetInfo(e,t,n){const i=this.lastHighlightedColumn||{},{firstMovingCol:r,lastMovingCol:s}=i9e(e);if(!r||!s||i.column||!t)return{firstMovingCol:r,...i};const a=this.getPinDirection()==="left";return{firstMovingCol:r,position:a?1:0,column:a!==n?r:s}}normaliseDirection(e){if(this.gos.get("enableRtl"))switch(e){case"left":return"right";case"right":return"left"}return e}getNormalisedColumnLeft(e,t,n){const{gos:i,ctrlsSvc:r}=this.beans,s=e.getLeft();if(s==null)return null;const o=e.getActualWidth();return uT({x:n?s+o-t:s+t,pinned:e.getPinned(),useHeaderRow:n,skipScrollPadding:!0,gos:i,ctrlsSvc:r})}isAttemptingToPin(e){const t=this.needToMoveLeft||this.needToMoveRight,n=this.failedMoveAttempts>IW;return t&&n||e.some(i=>i.getPinned()!==this.pinned)}moveColumnsAfterHighlight(e){const{allMovingColumns:t,xPosition:n,fromEnter:i,fakeEvent:r,fromLeft:s}=e,o=this.getMoveColumnParams({allMovingColumns:t,isFromHeader:!0,xPosition:n,fromLeft:s,fromEnter:i,fakeEvent:r}),{columns:a,toIndex:l}=Ite(o)||{};a&&l!=null&&(this.lastMovedInfo={columns:a,toIndex:l}),this.finishColumnMoving()}clearHighlighted(){const{lastHighlightedColumn:e}=this;e&&(_W(e.column,null),this.lastHighlightedColumn=null)}checkCenterForScrolling(e){if(!this.isCenterContainer)return;const t=this.beans.ctrlsSvc.get("center"),n=t.getCenterViewportScrollLeft(),i=n+t.getCenterWidth();let r,s;this.gos.get("enableRtl")?(r=e<n+Ow,s=e>i-Ow):(s=e<n+Ow,r=e>i-Ow),this.needToMoveRight=r,this.needToMoveLeft=s,s||r?this.ensureIntervalStarted():this.ensureIntervalCleared()}ensureIntervalStarted(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),t9e),this.beans.dragAndDrop.getDragAndDropImageComponent()?.setIcon(this.needToMoveLeft?"left":"right",!0))}ensureIntervalCleared(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.failedMoveAttempts=0,this.beans.dragAndDrop.getDragAndDropImageComponent()?.setIcon(this.getIconName(),!1))}moveInterval(){let e;this.intervalCount++,e=10+this.intervalCount*e9e,e>cT&&(e=cT);let t=null;const n=this.gridBodyCon.scrollFeature;if(this.needToMoveLeft?t=n.scrollHorizontally(-e):this.needToMoveRight&&(t=n.scrollHorizontally(e)),t!==0)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;const{pinnedCols:i,dragAndDrop:r,gos:s}=this.beans;if(this.failedMoveAttempts<=IW+1||!i)return;if(r.getDragAndDropImageComponent()?.setIcon("pinned",!1),!s.get("suppressMoveWhenColumnDragging")){const o=this.lastDraggingEvent?.dragItem.columns;this.attemptToPinColumns(o,void 0,!0)}}}getPinDirection(){if(this.needToMoveLeft||this.pinned==="left")return"left";if(this.needToMoveRight||this.pinned==="right")return"right"}attemptToPinColumns(e,t,n=!1){const i=(e||[]).filter(o=>!o.getColDef().lockPinned);if(!i.length)return 0;n&&(t=this.getPinDirection());const{pinnedCols:r,dragAndDrop:s}=this.beans;return r?.setColsPinned(i,t,"uiColumnDragged"),n&&s.nudge(),i.length}destroy(){super.destroy(),this.lastDraggingEvent=null,this.clearHighlighted(),this.lastMovedInfo=null}};function _W(e,t){e.highlighted!==t&&(e.highlighted=t,e.dispatchColEvent("headerHighlightChanged","uiColumnMoved"))}function i9e(e){const t=e.length;let n,i;for(let r=0;r<t;r++){if(!n){const s=e[r];s.getLeft()!=null&&(n=s)}if(!i){const s=e[t-1-r];s.getLeft()!=null&&(i=s)}if(n&&i)break}return{firstMovingCol:n,lastMovingCol:i}}var r9e=class extends Z{constructor(e,t){super(),this.pinned=e,this.eContainer=t}postConstruct(){const{ctrlsSvc:e,dragAndDrop:t}=this.beans,n=this.pinned;e.whenReady(this,i=>{let r;const s=i.gridBodyCtrl.eBodyViewport;switch(n){case"left":r=[[s,i.left.eContainer],[i.bottomLeft.eContainer],[i.topLeft.eContainer]];break;case"right":r=[[s,i.right.eContainer],[i.bottomRight.eContainer],[i.topRight.eContainer]];break;default:r=[[s,i.center.eViewport],[i.bottomCenter.eViewport],[i.topCenter.eViewport]];break}this.eSecondaryContainers=r}),this.moveColumnFeature=this.createManagedBean(new n9e(n)),this.bodyDropPivotTarget=this.createManagedBean(new KUe(n)),t.addDropTarget(this),this.addDestroyFunc(()=>t.removeDropTarget(this))}isInterestedIn(e){return e===1||e===0&&this.gos.get("allowDragFromColumnsToolPanel")}getSecondaryContainers(){return this.eSecondaryContainers}getContainer(){return this.eContainer}getIconName(){return this.currentDropListener.getIconName()}isDropColumnInPivotMode(e){return this.beans.colModel.isPivotMode()&&e.dragSource.type===0}onDragEnter(e){this.currentDropListener=this.isDropColumnInPivotMode(e)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(e)}onDragLeave(e){this.currentDropListener.onDragLeave(e)}onDragging(e){this.currentDropListener.onDragging(e)}onDragStop(e){this.currentDropListener.onDragStop(e)}onDragCancel(){this.currentDropListener.onDragCancel()}},s9e=class extends Z{constructor(){super(...arguments),this.beanName="colMoves"}moveColumnByIndex(e,t,n){const i=this.beans.colModel.getCols();if(!i)return;const r=i[e];this.moveColumns([r],t,n)}moveColumns(e,t,n,i=!0){const{colModel:r,colAnimation:s,visibleCols:o,eventSvc:a}=this.beans,l=r.getCols();if(!l)return;if(t>l.length-e.length){de(30,{toIndex:t});return}s?.start();const u=r.getColsForKeys(e);this.doesMovePassRules(u,t)&&(CW(r.getCols(),u,t),o.refresh(n),a.dispatchEvent({type:"columnMoved",columns:u,column:u.length===1?u[0]:null,toIndex:t,finished:i,source:n})),s?.finish()}doesMovePassRules(e,t){const n=this.getProposedColumnOrder(e,t);return this.doesOrderPassRules(n)}doesOrderPassRules(e){const{colModel:t,gos:n}=this.beans;return!(!Bee(e,t.getColTree())||!(r=>{const s=u=>u?u==="left"||u===!0?-1:1:0,o=n.get("enableRtl");let a=o?1:-1,l=!0;return r.forEach(u=>{const c=s(u.getColDef().lockPosition);o?c>a&&(l=!1):c<a&&(l=!1),a=c}),l})(e))}getProposedColumnOrder(e,t){const i=this.beans.colModel.getCols().slice();return CW(i,e,t),i}createBodyDropTarget(e,t){return new r9e(e,t)}moveHeader(e,t,n,i,r){const{ctrlsSvc:s,gos:o,colModel:a,visibleCols:l,focusSvc:u}=this.beans,c=t.getBoundingClientRect(),d=c.left,h=dn(n),p=h?c.width:n.getActualWidth(),g=e==="left"!==o.get("enableRtl"),m=uT({x:g?d-20:d+p+20,pinned:i,fromKeyboard:!0,gos:o,ctrlsSvc:s}),C=u.focusedHeader;_te({allMovingColumns:h?n.getLeafColumns():[n],isFromHeader:!0,fromLeft:e==="right",xPosition:m,pinned:i,fromEnter:!1,fakeEvent:!1,gos:o,colModel:a,colMoves:this,visibleCols:l,finished:!0});let y;if(h){const b=n.getDisplayedLeafColumns();y=g?b[0]:Lt(b)}else y=n;if(s.getScrollFeature().ensureColumnVisible(y,"auto"),(!r.isAlive()||o.get("ensureDomOrder"))&&C){let b;if(h){const S=n.getGroupId(),x=n.getLeafColumns();if(!x.length)return;const E=x[0].getParent();if(!E)return;b=o9e(E,S)}else b=n;b&&u.focusHeaderPosition({headerPosition:{...C,column:b}})}}setDragSourceForHeader(e,t,n){const{gos:i,colModel:r,dragAndDrop:s,visibleCols:o}=this.beans;let a=!i.get("suppressDragLeaveHidesColumns");const l=dn(t),u=l?t.getProvidedColumnGroup().getLeafColumns():[t],d={type:1,eElement:e,getDefaultIconName:()=>a?"hide":"notAllowed",getDragItem:l?()=>l9e(t,o.allCols):()=>a9e(t),dragItemName:n,onDragStarted:()=>{a=!i.get("suppressDragLeaveHidesColumns"),ek(u,!0)},onDragStopped:()=>ek(u,!1),onDragCancelled:()=>ek(u,!1),onGridEnter:h=>{if(a){const{columns:p=[],visibleState:g}=h??{},m=l?y=>!g||g[y.getColId()]:()=>!0,C=p.filter(y=>!y.getColDef().lockVisible&&m(y));r.setColsVisible(C,!0,"uiColumnMoved")}},onGridExit:h=>{if(a){const p=h?.columns?.filter(g=>!g.getColDef().lockVisible)||[];r.setColsVisible(p,!1,"uiColumnMoved")}}};return s.addDragSource(d,!0),d}};function o9e(e,t){for(;e;){if(e.getGroupId()===t)return e;e=e.getParent()}}function a9e(e){const t={};return t[e.getId()]=e.isVisible(),{columns:[e],visibleState:t}}function l9e(e,t){const n=e.getProvidedColumnGroup().getLeafColumns(),i={};n.forEach(a=>i[a.getId()]=a.isVisible());const r=[];t.forEach(a=>{n.indexOf(a)>=0&&(r.push(a),_o(n,a))}),n.forEach(a=>r.push(a));const s=[],o=e.getLeafColumns();for(const a of r)o.indexOf(a)!==-1&&s.push(a);return{columns:r,columnsInSplit:s,visibleState:i}}var u9e={moduleName:"ColumnMove",version:we,beans:[s9e,UUe],apiFunctions:{moveColumnByIndex:qUe,moveColumns:jUe},dependsOn:[Tte],css:[WUe]},c9e=class extends Z{constructor(){super(...arguments),this.beanName="autoWidthCalc"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.centerRowContainerCtrl=e.center})}getPreferredWidthForColumn(e,t){const n=this.getHeaderCellForColumn(e);if(!n)return-1;const i=this.beans.rowRenderer.getAllCellsNotSpanningForColumn(e);return t||i.push(n),this.getPreferredWidthForElements(i)}getPreferredWidthForColumnGroup(e){const t=this.getHeaderCellForColumn(e);return t?this.getPreferredWidthForElements([t]):-1}getPreferredWidthForElements(e,t){const n=document.createElement("form");n.style.position="fixed";const i=this.centerRowContainerCtrl.eContainer;e.forEach(s=>this.cloneItemIntoDummy(s,n)),i.appendChild(n);const r=n.offsetWidth;return i.removeChild(n),t=t??this.gos.get("autoSizePadding"),r+t}getHeaderCellForColumn(e){let t=null;return this.beans.ctrlsSvc.getHeaderRowContainerCtrls().forEach(n=>{const i=n.getHtmlElementForColumnHeader(e);i!=null&&(t=i)}),t}cloneItemIntoDummy(e,t){const n=e.cloneNode(!0);n.style.width="",n.style.position="static",n.style.left="";const i=document.createElement("div"),r=i.classList;["ag-header-cell","ag-header-group-cell"].some(a=>n.classList.contains(a))?(r.add("ag-header","ag-header-row"),i.style.position="static"):r.add("ag-row");let o=e.parentElement;for(;o;){if(["ag-header-row","ag-row"].some(l=>o.classList.contains(l))){for(let l=0;l<o.classList.length;l++){const u=o.classList[l];u!="ag-row-position-absolute"&&r.add(u)}break}o=o.parentElement}i.appendChild(n),t.appendChild(i)}},Ote={moduleName:"AutoWidth",version:we,beans:[c9e]};function d9e(e,t,n=!0,i="api"){e.colResize?.setColumnWidths(t,!1,n,i)}var h9e=class extends Z{constructor(e,t,n,i){super(),this.comp=e,this.eResize=t,this.pinned=n,this.columnGroup=i}postConstruct(){if(!this.columnGroup.isResizable()){this.comp.setResizableDisplayed(!1);return}const{horizontalResizeSvc:e,gos:t,colAutosize:n}=this.beans,i=e.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});this.addDestroyFunc(i),!t.get("suppressAutoSize")&&n&&this.addDestroyFunc(n.addColumnGroupResize(this.eResize,this.columnGroup,()=>this.resizeLeafColumnsToFit("uiColumnResized")))}onResizeStart(e){const{columnsToResize:t,resizeStartWidth:n,resizeRatios:i,groupAfterColumns:r,groupAfterStartWidth:s,groupAfterRatios:o}=this.getInitialValues(e);this.resizeCols=t,this.resizeStartWidth=n,this.resizeRatios=i,this.resizeTakeFromCols=r,this.resizeTakeFromStartWidth=s,this.resizeTakeFromRatios=o,this.toggleColumnResizing(!0)}onResizing(e,t,n="uiColumnResized"){const i=this.normaliseDragChange(t),r=this.resizeStartWidth+i;this.resizeColumnsFromLocalValues(r,n,e)}getInitialValues(e){const t=l=>l.reduce((u,c)=>u+c.getActualWidth(),0),n=(l,u)=>l.map(c=>c.getActualWidth()/u),i=this.getColumnsToResize(),r=t(i),s=n(i,r),o={columnsToResize:i,resizeStartWidth:r,resizeRatios:s};let a=null;if(e&&(a=this.beans.colGroupSvc?.getGroupAtDirection(this.columnGroup,"After")??null),a){const l=a.getDisplayedLeafColumns(),u=o.groupAfterColumns=l.filter(d=>d.isResizable()),c=o.groupAfterStartWidth=t(u);o.groupAfterRatios=n(u,c)}else o.groupAfterColumns=void 0,o.groupAfterStartWidth=void 0,o.groupAfterRatios=void 0;return o}resizeLeafColumnsToFit(e){const t=this.beans.autoWidthCalc.getPreferredWidthForColumnGroup(this.columnGroup),n=this.getInitialValues();t>n.resizeStartWidth&&this.resizeColumns(n,t,e,!0)}resizeColumnsFromLocalValues(e,t,n=!0){if(!this.resizeCols||!this.resizeRatios)return;const i={columnsToResize:this.resizeCols,resizeStartWidth:this.resizeStartWidth,resizeRatios:this.resizeRatios,groupAfterColumns:this.resizeTakeFromCols,groupAfterStartWidth:this.resizeTakeFromStartWidth,groupAfterRatios:this.resizeTakeFromRatios};this.resizeColumns(i,e,t,n)}resizeColumns(e,t,n,i=!0){const{columnsToResize:r,resizeStartWidth:s,resizeRatios:o,groupAfterColumns:a,groupAfterStartWidth:l,groupAfterRatios:u}=e,c=[];if(c.push({columns:r,ratios:o,width:t}),a){const d=t-s;c.push({columns:a,ratios:u,width:l-d})}this.beans.colResize?.resizeColumnSets({resizeSets:c,finished:i,source:n}),i&&this.toggleColumnResizing(!1)}toggleColumnResizing(e){this.comp.addOrRemoveCssClass("ag-column-resizing",e)}getColumnsToResize(){return this.columnGroup.getDisplayedLeafColumns().filter(t=>t.isResizable())}normaliseDragChange(e){let t=e;return this.gos.get("enableRtl")?this.pinned!=="left"&&(t*=-1):this.pinned==="right"&&(t*=-1),t}destroy(){super.destroy(),this.resizeCols=void 0,this.resizeRatios=void 0,this.resizeTakeFromCols=void 0,this.resizeTakeFromRatios=void 0}},f9e=class extends Z{constructor(e,t,n,i,r){super(),this.pinned=e,this.column=t,this.eResize=n,this.comp=i,this.ctrl=r}postConstruct(){const e=[];let t,n;const i=()=>{if(tn(this.eResize,t),!t)return;const{horizontalResizeSvc:o,colAutosize:a}=this.beans,l=o.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});e.push(l),n&&a&&e.push(a.addColumnAutosize(this.eResize,this.column))},r=()=>{e.forEach(o=>o()),e.length=0},s=()=>{const o=this.column.isResizable(),a=!this.gos.get("suppressAutoSize")&&!this.column.getColDef().suppressAutoSize;(o!==t||a!==n)&&(t=o,n=a,r(),i())};s(),this.addDestroyFunc(r),this.ctrl.setRefreshFunction("resize",s)}onResizing(e,t){const{column:n,lastResizeAmount:i,resizeStartWidth:r,beans:s}=this,o=this.normaliseResizeAmount(t),a=r+o,l=[{key:n,newWidth:a}],{pinnedCols:u,ctrlsSvc:c,colResize:d}=s;if(this.column.getPinned()){const h=u?.leftWidth??0,p=u?.rightWidth??0,g=w0(c.getGridBodyCtrl().eBodyViewport)-50;if(h+p+(o-i)>g)return}this.lastResizeAmount=o,d?.setColumnWidths(l,this.resizeWithShiftKey,e,"uiColumnResized"),e&&this.toggleColumnResizing(!1)}onResizeStart(e){this.resizeStartWidth=this.column.getActualWidth(),this.lastResizeAmount=0,this.resizeWithShiftKey=e,this.toggleColumnResizing(!0)}toggleColumnResizing(e){this.comp.addOrRemoveCssClass("ag-column-resizing",e)}normaliseResizeAmount(e){let t=e;const n=this.pinned!=="left",i=this.pinned==="right";return this.gos.get("enableRtl")?n&&(t*=-1):i&&(t*=-1),t}},p9e=class extends Z{constructor(){super(...arguments),this.beanName="colResize"}setColumnWidths(e,t,n,i){const r=[],{colModel:s,gos:o,visibleCols:a}=this.beans;e.forEach(l=>{const u=s.getColDefCol(l.key)||s.getCol(l.key);if(!u)return;if(r.push({width:l.newWidth,ratios:[1],columns:[u]}),o.get("colResizeDefault")==="shift"&&(t=!t),t){const d=a.getColAfter(u);if(!d)return;const h=u.getActualWidth()-l.newWidth,p=d.getActualWidth()+h;r.push({width:p,ratios:[1],columns:[d]})}}),r.length!==0&&this.resizeColumnSets({resizeSets:r,finished:n,source:i})}resizeColumnSets(e){const{resizeSets:t,finished:n,source:i}=e;if(!(!t||t.every(c=>g9e(c)))){if(n){const c=t&&t.length>0?t[0].columns:null;zp(this.eventSvc,c,n,i)}return}const s=[],o=[];t.forEach(c=>{const{width:d,columns:h,ratios:p}=c,g={},m={};h.forEach(b=>o.push(b));let C=!0,y=0;for(;C;){if(y++,y>1e3){Ft(31);break}C=!1;const b=[];let S=0,x=d;h.forEach((A,F)=>{if(m[A.getId()])x-=g[A.getId()];else{b.push(A);const D=p[F];S+=D}});const E=1/S;b.forEach((A,F)=>{const P=F===b.length-1;let D;P?D=x:(D=Math.round(p[F]*d*E),x-=D);const M=A.getMinWidth(),O=A.getMaxWidth();D<M?(D=M,m[A.getId()]=!0,C=!0):O>0&&D>O&&(D=O,m[A.getId()]=!0,C=!0),g[A.getId()]=D})}h.forEach(b=>{const S=g[b.getId()];b.getActualWidth()!==S&&(b.setActualWidth(S,i),s.push(b))})});const a=s.length>0;let l=[];if(a){const{colFlex:c,visibleCols:d,colViewport:h}=this.beans;l=c?.refreshFlexedColumns({resizingCols:o,skipSetLeft:!0})??[],d.setLeftValues(i),d.updateBodyWidths(),h.checkViewportColumns()}const u=o.concat(l);(a||n)&&zp(this.eventSvc,u,n,i,l)}resizeHeader(e,t,n){if(!e.isResizable())return;const i=e.getActualWidth(),r=e.getMinWidth(),s=e.getMaxWidth(),o=Math.min(Math.max(i+t,r),s);this.setColumnWidths([{key:e,newWidth:o}],n,!0,"uiColumnResized")}createResizeFeature(e,t,n,i,r){return new f9e(e,t,n,i,r)}createGroupResizeFeature(e,t,n,i){return new h9e(e,t,n,i)}};function g9e(e){const{columns:t,width:n}=e;let i=0,r=0,s=!0;t.forEach(l=>{const u=l.getMinWidth();i+=u||0;const c=l.getMaxWidth();c>0?r+=c:s=!1});const o=n>=i,a=!s||n<=r;return o&&a}var m9e={moduleName:"ColumnResize",version:we,beans:[p9e],apiFunctions:{setColumnWidths:d9e},dependsOn:[VUe,Ote]},v9e=class extends Z{constructor(e,t){super(),this.removeChildListenersFuncs=[],this.columnGroup=t,this.comp=e}postConstruct(){this.addListenersToChildrenColumns(),this.addManagedListeners(this.columnGroup,{displayedChildrenChanged:this.onDisplayedChildrenChanged.bind(this)}),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))}addListenersToChildrenColumns(){this.removeListenersOnChildrenColumns();const e=this.onWidthChanged.bind(this);this.columnGroup.getLeafColumns().forEach(t=>{t.__addEventListener("widthChanged",e),t.__addEventListener("visibleChanged",e),this.removeChildListenersFuncs.push(()=>{t.__removeEventListener("widthChanged",e),t.__removeEventListener("visibleChanged",e)})})}removeListenersOnChildrenColumns(){this.removeChildListenersFuncs.forEach(e=>e()),this.removeChildListenersFuncs=[]}onDisplayedChildrenChanged(){this.addListenersToChildrenColumns(),this.onWidthChanged()}onWidthChanged(){const e=this.columnGroup.getActualWidth();this.comp.setWidth(`${e}px`),this.comp.addOrRemoveCssClass("ag-hidden",e===0)}},C9e=class extends FN{constructor(){super(...arguments),this.onSuppressColMoveChange=()=>{!this.isAlive()||this.isSuppressMoving()?this.removeDragSource():this.dragSource||this.setDragSource(this.eGui)}}setComp(e,t,n,i,r){const{column:s,beans:o}=this,{context:a,colNames:l,colHover:u,rangeSvc:c,colResize:d}=o;this.comp=e,r=OC(this,a,r),this.setGui(t,r),this.displayName=l.getDisplayNameForColumnGroup(s,"header"),this.refreshHeaderStyles(),this.addClasses(),this.setupMovingCss(r),this.setupExpandable(r),this.setupTooltip(),this.setupAutoHeight({wrapperElement:i,compBean:r}),this.setupUserComp(),this.addHeaderMouseListeners(r),this.addManagedPropertyListener("groupHeaderHeight",this.refreshMaxHeaderHeight.bind(this)),this.refreshMaxHeaderHeight();const h=this.rowCtrl.pinned,p=s.getProvidedColumnGroup().getLeafColumns();u?.createHoverFeature(r,p,t),c?.createRangeHighlightFeature(r,s,e),r.createManagedBean(new EN(s,t,o)),r.createManagedBean(new v9e(e,s)),d?this.resizeFeature=r.createManagedBean(d.createGroupResizeFeature(e,n,h,s)):e.setResizableDisplayed(!1),r.createManagedBean(new Sg(t,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:()=>{},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)})),this.addHighlightListeners(r,p),r.addManagedPropertyListener("suppressMovableColumns",this.onSuppressColMoveChange),this.addResizeAndMoveKeyboardListeners(r),r.addDestroyFunc(()=>this.clearComponent())}getHeaderClassParams(){const{column:e,beans:t}=this,n=e.getDefinition();return ze(t.gos,{colDef:n,columnGroup:e,floatingFilter:!1})}refreshMaxHeaderHeight(){const{gos:e,comp:t}=this,n=e.get("groupHeaderHeight");n!=null?n===0?t.setHeaderWrapperHidden(!0):t.setHeaderWrapperMaxHeight(n):(t.setHeaderWrapperHidden(!1),t.setHeaderWrapperMaxHeight(null))}addHighlightListeners(e,t){if(this.beans.gos.get("suppressMoveWhenColumnDragging"))for(const n of t)e.addManagedListeners(n,{headerHighlightChanged:this.onLeafColumnHighlightChanged.bind(this,n)})}onLeafColumnHighlightChanged(e){const t=this.column.getDisplayedLeafColumns(),n=t[0]===e,i=Lt(t)===e;if(!n&&!i)return;const r=e.getHighlighted(),s=!!this.rowCtrl.getHeaderCellCtrls().find(l=>l.column.isMoving());let o=!1,a=!1;if(s){const l=this.beans.gos.get("enableRtl"),u=r===1,c=r===0;n&&(l?a=u:o=c),i&&(l?o=c:a=u)}this.comp.addOrRemoveCssClass("ag-header-highlight-before",o),this.comp.addOrRemoveCssClass("ag-header-highlight-after",a)}resizeHeader(e,t){const{resizeFeature:n}=this;if(!n)return;const i=n.getInitialValues(t);n.resizeColumns(i,i.resizeStartWidth+e,"uiColumnResized",!0)}resizeLeafColumnsToFit(e){this.resizeFeature?.resizeLeafColumnsToFit(e)}setupUserComp(){const{colGroupSvc:e,userCompFactory:t,gos:n}=this.beans,i=ze(n,{displayName:this.displayName,columnGroup:this.column,setExpanded:s=>{e.setColumnGroupOpened(this.column.getProvidedColumnGroup(),s,"gridInitializing")},setTooltip:(s,o)=>{n.assertModuleRegistered("Tooltip",3),this.setupTooltip(s,o)}}),r=uWe(t,i);r&&this.comp.setUserCompDetails(r)}addHeaderMouseListeners(e){const t=r=>this.handleMouseOverChange(r.type==="mouseenter"),n=()=>this.dispatchColumnMouseEvent("columnHeaderClicked",this.column.getProvidedColumnGroup()),i=r=>this.handleContextMenuMouseEvent(r,void 0,this.column.getProvidedColumnGroup());e.addManagedListeners(this.eGui,{mouseenter:t,mouseleave:t,click:n,contextmenu:i})}handleMouseOverChange(e){this.eventSvc.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column.getProvidedColumnGroup()})}setupTooltip(e,t){this.tooltipFeature=this.beans.tooltipSvc?.setupHeaderGroupTooltip(this.tooltipFeature,this,e,t)}setupExpandable(e){const t=this.column.getProvidedColumnGroup();this.refreshExpanded();const n=this.refreshExpanded.bind(this);e.addManagedListeners(t,{expandedChanged:n,expandableChanged:n})}refreshExpanded(){const{column:e}=this;this.expandable=e.isExpandable();const t=e.isExpanded();this.expandable?this.comp.setAriaExpanded(t?"true":"false"):this.comp.setAriaExpanded(void 0),this.refreshHeaderStyles()}addClasses(){const{column:e}=this,t=e.getColGroupDef(),n=Qee(t,this.gos,null,e);e.isPadding()?(n.push("ag-header-group-cell-no-group"),e.getLeafColumns().every(r=>r.isSpanHeaderHeight())&&n.push("ag-header-span-height")):(n.push("ag-header-group-cell-with-group"),t?.wrapHeaderText&&n.push("ag-header-cell-wrap-text")),n.forEach(i=>this.comp.addOrRemoveCssClass(i,!0))}setupMovingCss(e){const{column:t}=this,i=t.getProvidedColumnGroup().getLeafColumns(),r=()=>this.comp.addOrRemoveCssClass("ag-header-cell-moving",t.isMoving());i.forEach(s=>{e.addManagedListeners(s,{movingChanged:r})}),r()}onFocusIn(e){this.eGui.contains(e.relatedTarget)||this.focusThis()}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();if(!(!this.expandable||!t)&&e.key===X.ENTER){const n=this.column,i=!n.isExpanded();this.beans.colGroupSvc.setColumnGroupOpened(n.getProvidedColumnGroup(),i,"uiColumnExpanded")}}setDragSource(e){!this.isAlive()||this.isSuppressMoving()||(this.removeDragSource(),e&&(this.dragSource=this.beans.colMoves?.setDragSourceForHeader(e,this.column,this.displayName)??null))}isSuppressMoving(){return this.gos.get("suppressMovableColumns")||this.column.getLeafColumns().some(e=>e.getColDef().suppressMovable||e.getColDef().lockPosition)}destroy(){this.tooltipFeature=this.destroyBean(this.tooltipFeature),super.destroy()}};function y9e(e,t,n){e.colGroupSvc?.setColumnGroupOpened(t,n,"api")}function w9e(e,t,n){return e.colGroupSvc?.getColumnGroup(t,n)??null}function b9e(e,t){return e.colGroupSvc?.getProvidedColGroup(t)??null}function S9e(e,t,n){return e.colNames.getDisplayNameForColumnGroup(t,n)||""}function x9e(e){return e.colGroupSvc?.getColumnGroupState()??[]}function R9e(e,t){e.colGroupSvc?.setColumnGroupState(t,"api")}function E9e(e){e.colGroupSvc?.resetColumnGroupState("api")}function F9e(e){return e.visibleCols.treeLeft}function A9e(e){return e.visibleCols.treeCenter}function D9e(e){return e.visibleCols.treeRight}function k9e(e){return e.visibleCols.getAllTrees()}function P9e(e,t){for(let n=0;n<t.length;n++){const i=e.indexOf(t[n]);i>=0&&(e[i]=e[e.length-1],e.pop())}}var M9e=class extends Z{constructor(){super(...arguments),this.beanName="visibleCols",this.colsAndGroupsMap={},this.leftCols=[],this.rightCols=[],this.centerCols=[],this.allCols=[],this.bodyWidth=0,this.leftWidth=0,this.rightWidth=0,this.isBodyWidthDirty=!0}refresh(e,t=!1){const{colModel:n,colGroupSvc:i,colViewport:r}=this.beans;t||this.buildTrees(n,i),i?.updateOpenClosedVisibility();const s=tk(this.treeLeft);this.leftCols=s,this.centerCols=tk(this.treeCenter);const o=tk(this.treeRight);this.rightCols=o,this.joinColsAriaOrder(n),this.joinCols(),this.setLeftValues(e),this.autoHeightCols=this.allCols.filter(a=>a.isAutoHeight()),this.beans.colFlex?.refreshFlexedColumns(),this.updateBodyWidths(),r.checkViewportColumns(!1),this.setFirstRightAndLastLeftPinned(n,s,o,e),this.eventSvc.dispatchEvent({type:"displayedColumnsChanged",source:e})}updateBodyWidths(){const e=fl(this.centerCols),t=fl(this.leftCols),n=fl(this.rightCols);this.isBodyWidthDirty=this.bodyWidth!==e,(this.bodyWidth!==e||this.leftWidth!==t||this.rightWidth!==n)&&(this.bodyWidth=e,this.leftWidth=t,this.rightWidth=n,this.eventSvc.dispatchEvent({type:"columnContainerWidthChanged"}),this.eventSvc.dispatchEvent({type:"displayedColumnsWidthChanged"}))}setLeftValues(e){this.setLeftValuesOfCols(e),this.setLeftValuesOfGroups()}setFirstRightAndLastLeftPinned(e,t,n,i){let r,s;this.gos.get("enableRtl")?(r=t?t[0]:null,s=n?Lt(n):null):(r=t?Lt(t):null,s=n?n[0]:null),e.getCols().forEach(o=>{o.setLastLeftPinned(o===r,i),o.setFirstRightPinned(o===s,i)})}buildTrees(e,t){const n=e.getColsToShow(),i=n.filter(l=>l.getPinned()=="left"),r=n.filter(l=>l.getPinned()=="right"),s=n.filter(l=>l.getPinned()!="left"&&l.getPinned()!="right"),o=new Wee,a=l=>t?t.createColumnGroups(l):l.columns;this.treeLeft=a({columns:i,idCreator:o,pinned:"left",oldDisplayedGroups:this.treeLeft}),this.treeRight=a({columns:r,idCreator:o,pinned:"right",oldDisplayedGroups:this.treeRight}),this.treeCenter=a({columns:s,idCreator:o,pinned:null,oldDisplayedGroups:this.treeCenter}),this.updateColsAndGroupsMap()}clear(){this.leftCols=[],this.rightCols=[],this.centerCols=[],this.allCols=[],this.ariaOrderColumns=[]}joinColsAriaOrder(e){const t=e.getCols(),n=[],i=[],r=[];for(const s of t){const o=s.getPinned();o?o===!0||o==="left"?n.push(s):r.push(s):i.push(s)}this.ariaOrderColumns=n.concat(i).concat(r)}getAriaColIndex(e){let t;return dn(e)?t=e.getLeafColumns()[0]:t=e,this.ariaOrderColumns.indexOf(t)+1}setLeftValuesOfGroups(){[this.treeLeft,this.treeRight,this.treeCenter].forEach(e=>{e.forEach(t=>{dn(t)&&t.checkLeft()})})}setLeftValuesOfCols(e){const{colModel:t}=this.beans;if(!t.getColDefCols())return;const i=t.getCols().slice(0),r=this.gos.get("enableRtl");[this.leftCols,this.rightCols,this.centerCols].forEach(s=>{if(r){let o=fl(s);s.forEach(a=>{o-=a.getActualWidth(),a.setLeft(o,e)})}else{let o=0;s.forEach(a=>{a.setLeft(o,e),o+=a.getActualWidth()})}P9e(i,s)}),i.forEach(s=>{s.setLeft(null,e)})}joinCols(){this.gos.get("enableRtl")?this.allCols=this.rightCols.concat(this.centerCols).concat(this.leftCols):this.allCols=this.leftCols.concat(this.centerCols).concat(this.rightCols)}getAllTrees(){return this.treeLeft&&this.treeRight&&this.treeCenter?this.treeLeft.concat(this.treeCenter).concat(this.treeRight):null}isColDisplayed(e){return this.allCols.indexOf(e)>=0}getLeftColsForRow(e){const{leftCols:t,beans:{colModel:n}}=this;return n.colSpanActive?this.getColsForRow(e,t):t}getRightColsForRow(e){const{rightCols:t,beans:{colModel:n}}=this;return n.colSpanActive?this.getColsForRow(e,t):t}getColsForRow(e,t,n,i){const r=[];let s=null;for(let o=0;o<t.length;o++){const a=t[o],l=t.length-o,u=Math.min(a.getColSpan(e),l),c=[a];if(u>1){const h=u-1;for(let p=1;p<=h;p++)c.push(t[o+p]);o+=h}let d;n?(d=!1,c.forEach(h=>{n(h)&&(d=!0)})):d=!0,d&&(r.length===0&&s&&(i&&i(a))&&r.push(s),r.push(a)),s=a}return r}getContainerWidth(e){switch(e){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}}getColBefore(e){const t=this.allCols,n=t.indexOf(e);return n>0?t[n-1]:null}isPinningLeft(){return this.leftCols.length>0}isPinningRight(){return this.rightCols.length>0}updateColsAndGroupsMap(){this.colsAndGroupsMap={};const e=t=>{this.colsAndGroupsMap[t.getUniqueId()]=t};Vd(this.treeCenter,!1,e),Vd(this.treeLeft,!1,e),Vd(this.treeRight,!1,e)}isVisible(e){return this.colsAndGroupsMap[e.getUniqueId()]===e}getFirstColumn(){const e=this.gos.get("enableRtl"),t=["leftCols","centerCols","rightCols"];e&&t.reverse();for(let n=0;n<t.length;n++){const i=this[t[n]];if(i.length)return e?Lt(i):i[0]}return null}getColAfter(e){const t=this.allCols,n=t.indexOf(e);return n<t.length-1?t[n+1]:null}getColsLeftWidth(){return fl(this.leftCols)}getDisplayedColumnsRightWidth(){return fl(this.rightCols)}isColAtEdge(e,t){const n=this.allCols;if(!n.length)return!1;const i=t==="first";let r;if(dn(e)){const s=e.getDisplayedLeafColumns();if(!s.length)return!1;r=i?s[0]:Lt(s)}else r=e;return(i?n[0]:Lt(n))===r}};function Vd(e,t,n){if(e)for(let i=0;i<e.length;i++){const r=e[i];if(dn(r)){const s=t?r.getDisplayedChildren():r.getChildren();Vd(s,t,n)}n(r)}}function tk(e){const t=[];return Vd(e,!0,n=>{pc(n)&&t.push(n)}),t}var T9e=class extends Z{constructor(){super(...arguments),this.beanName="colGroupSvc"}getColumnGroupState(){const e=[],t=this.beans.colModel.getColTree();return Ll(null,t,n=>{Xi(n)&&e.push({groupId:n.getGroupId(),open:n.isExpanded()})}),e}resetColumnGroupState(e){const t=this.beans.colModel.getColDefColTree();if(!t)return;const n=[];Ll(null,t,i=>{if(Xi(i)){const r=i.getColGroupDef(),s={groupId:i.getGroupId(),open:r?r.openByDefault:void 0};n.push(s)}}),this.setColumnGroupState(n,e)}setColumnGroupState(e,t){const{colModel:n,colAnimation:i,visibleCols:r,eventSvc:s}=this.beans;if(!n.getColTree().length)return;i?.start();const a=[];e.forEach(l=>{const u=l.groupId,c=l.open,d=this.getProvidedColGroup(u);d&&d.isExpanded()!==c&&(d.setExpanded(c),a.push(d))}),r.refresh(t,!0),a.length&&s.dispatchEvent({type:"columnGroupOpened",columnGroup:a.length===1?a[0]:void 0,columnGroups:a}),i?.finish()}setColumnGroupOpened(e,t,n){let i;Xi(e)?i=e.getId():i=e||"",this.setColumnGroupState([{groupId:i,open:t}],n)}getProvidedColGroup(e){let t=null;return Ll(null,this.beans.colModel.getColTree(),n=>{Xi(n)&&n.getId()===e&&(t=n)}),t}getGroupAtDirection(e,t){const n=e.getProvidedColumnGroup().getLevel()+e.getPaddingLevel(),i=e.getDisplayedLeafColumns(),r=t==="After"?Lt(i):i[0],s=`getCol${t}`;for(;;){const o=this.beans.visibleCols[s](r);if(!o)return null;const a=this.getColGroupAtLevel(o,n);if(a!==e)return a}}getColGroupAtLevel(e,t){let n=e.getParent(),i,r;for(;i=n.getProvidedColumnGroup().getLevel(),r=n.getPaddingLevel(),!(i+r<=t);)n=n.getParent();return n}updateOpenClosedVisibility(){const e=this.beans.visibleCols.getAllTrees();Vd(e,!1,t=>{dn(t)&&t.calculateDisplayedColumns()})}getColumnGroup(e,t){if(!e)return null;if(dn(e))return e;const n=this.beans.visibleCols.getAllTrees(),i=typeof t=="number";let r=null;return Vd(n,!1,s=>{if(dn(s)){const o=s;let a;i?a=e===o.getGroupId()&&t===o.getPartId():a=e===o.getGroupId(),a&&(r=o)}}),r}createColumnGroups(e){const{columns:t,idCreator:n,pinned:i,oldDisplayedGroups:r,isStandaloneStructure:s}=e,o=this.mapOldGroupsById(r),a=[];let l=t;for(;l.length;){const u=l;l=[];let c=0;const d=h=>{const p=c;c=h;const g=u[p],C=(dn(g)?g.getProvidedColumnGroup():g).getOriginalParent();if(C==null){for(let b=p;b<h;b++)a.push(u[b]);return}const y=this.createColumnGroup(C,n,o,i,s);for(let b=p;b<h;b++)y.addChild(u[b]);l.push(y)};for(let h=1;h<u.length;h++){const p=u[h],m=(dn(p)?p.getProvidedColumnGroup():p).getOriginalParent(),C=u[c],b=(dn(C)?C.getProvidedColumnGroup():C).getOriginalParent();m!==b&&d(h)}c<u.length&&d(u.length)}return s||this.setupParentsIntoCols(a,null),a}createProvidedColumnGroup(e,t,n,i,r,s,o){const a=r.getUniqueKey(t.groupId||null,null),l=this.createMergedColGroupDef(t,a),u=new mb(l,a,!1,n);this.createBean(u);const c=this.findExistingGroup(t,s);c&&s.splice(c.idx,1);const d=c?.group;d&&u.setExpanded(d.isExpanded());const h=Lee(this.beans,l.children,n+1,e,i,r,s,o);return u.setChildren(h),u}balanceColumnTree(e,t,n,i){const r=[];for(let s=0;s<e.length;s++){const o=e[s];if(Xi(o)){const a=o,l=this.balanceColumnTree(a.getChildren(),t+1,n,i);a.setChildren(l),r.push(a)}else{let a,l;for(let u=n-1;u>=t;u--){const c=i.getUniqueKey(null,null),d=this.createMergedColGroupDef(null,c),h=new mb(d,c,!0,t);this.createBean(h),l&&l.setChildren([h]),l=h,a||(a=l)}if(a&&l)if(r.push(a),e.some(c=>Xi(c))){l.setChildren([o]);continue}else{l.setChildren(e);break}r.push(o)}}return r}findDepth(e){let t=0,n=e;for(;n&&n[0]&&Xi(n[0]);)t++,n=n[0].getChildren();return t}findMaxDepth(e,t){let n=t;for(let i=0;i<e.length;i++){const r=e[i];if(Xi(r)){const s=r,o=this.findMaxDepth(s.getChildren(),t+1);n<o&&(n=o)}}return n}balanceTreeForAutoCols(e,t){const n=[];return e.forEach(i=>{let r=i;for(let s=t-1;s>=0;s--){const o=new mb(null,`FAKE_PATH_${i.getId()}}_${s}`,!0,s);this.createBean(o),o.setChildren([r]),r.originalParent=o,r=o}t===0&&(i.originalParent=null),n.push(r)}),n}createMergedColGroupDef(e,t){const n={},{gos:i,validation:r}=this.beans;return Object.assign(n,i.get("defaultColGroupDef")),Object.assign(n,e),r?.validateColDef(n,t),n}findExistingGroup(e,t){if(e.groupId!=null)for(let i=0;i<t.length;i++){const r=t[i];if(r.getColGroupDef()&&r.getId()===e.groupId)return{idx:i,group:r}}}createColumnGroup(e,t,n,i,r){const s=e.getGroupId(),o=t.getInstanceIdForKey(s),a=ate(s,o);let l=n[a];return l&&l.getProvidedColumnGroup()!==e&&(l=null),Ce(l)?l.reset():(l=new lte(e,s,o,i),r||this.createBean(l)),l}mapOldGroupsById(e){const t={},n=i=>{i.forEach(r=>{if(dn(r)){const s=r;t[r.getUniqueId()]=s,n(s.getChildren())}})};return e&&n(e),t}setupParentsIntoCols(e,t){e.forEach(n=>{if(n.parent=t,dn(n)){const i=n;this.setupParentsIntoCols(i.getChildren(),i)}})}},I9e={moduleName:"ColumnGroup",version:we,dynamicBeans:{headerGroupCellCtrl:C9e},beans:[T9e],apiFunctions:{getAllDisplayedColumnGroups:k9e,getCenterDisplayedColumnGroups:A9e,getColumnGroup:w9e,getColumnGroupState:x9e,getDisplayNameForColumnGroup:S9e,getLeftDisplayedColumnGroups:F9e,getProvidedColumnGroup:b9e,getRightDisplayedColumnGroups:D9e,resetColumnGroupState:E9e,setColumnGroupOpened:y9e,setColumnGroupState:R9e}},_9e={moduleName:"CheckboxCellRenderer",version:we,userComponents:{agCheckboxCellRenderer:T8e}};function O9e(e,t){const n=e.colModel.getColDefCol(t);return n?n.getColDef():null}function L9e(e){return e.colModel.getColumnDefs()}function N9e(e,t,n){return e.colNames.getDisplayNameForColumn(t,n)||""}function $9e(e,t){return e.colModel.getColDefCol(t)}function B9e(e){return e.colModel.getColDefCols()}function G9e(e,t){return os(e,t,"api")}function z9e(e){return E0(e)}function H9e(e){O6e(e,"api")}function V9e(e){return e.visibleCols.isPinningLeft()||e.visibleCols.isPinningRight()}function W9e(e){return e.visibleCols.isPinningLeft()}function U9e(e){return e.visibleCols.isPinningRight()}function q9e(e,t){return e.visibleCols.getColAfter(t)}function j9e(e,t){return e.visibleCols.getColBefore(t)}function K9e(e,t,n){e.colModel.setColsVisible(t,n,"api")}function Y9e(e,t,n){e.pinnedCols?.setColsPinned(t,n,"api")}function X9e(e){return e.colModel.getCols()}function Q9e(e){return e.visibleCols.leftCols}function Z9e(e){return e.visibleCols.centerCols}function J9e(e){return e.visibleCols.rightCols}function e7e(e){return e.visibleCols.allCols}function t7e(e){return e.colViewport.getViewportColumns()}function dT(e,t){if(!e)return;const n=e,i={};return Object.keys(n).forEach(r=>{if(t&&t.indexOf(r)>=0||Mee.has(r))return;const s=n[r];typeof s=="object"&&s!==null&&s.constructor===Object?i[r]=dT(s):i[r]=s}),i}var n7e=class extends Z{constructor(){super(...arguments),this.beanName="colDefFactory"}wireBeans(e){this.rowGroupColsSvc=e.rowGroupColsSvc,this.pivotColsSvc=e.pivotColsSvc}getColumnDefs(e,t,n,i){const r=e.slice();t?r.sort((a,l)=>n.indexOf(a)-n.indexOf(l)):n&&r.sort((a,l)=>i.indexOf(a)-i.indexOf(l));const s=this.rowGroupColsSvc?.columns,o=this.pivotColsSvc?.columns;return this.buildColumnDefs(r,s,o)}buildColumnDefs(e,t=[],n=[]){const i=[],r={};return e.forEach(s=>{const o=this.createDefFromColumn(s,t,n);let a=!0,l=o,u=s.getOriginalParent(),c=null;for(;u;){let d=null;if(u.isPadding()){u=u.getOriginalParent();continue}const h=r[u.getGroupId()];if(h){h.children.push(l),a=!1;break}if(d=this.createDefFromGroup(u),d&&(d.children=[l],r[d.groupId]=d,l=d,u=u.getOriginalParent()),u!=null&&c===u){a=!1;break}c=u}a&&i.push(l)}),i}createDefFromGroup(e){const t=dT(e.getColGroupDef(),["children"]);return t&&(t.groupId=e.getGroupId()),t}createDefFromColumn(e,t,n){const i=dT(e.getColDef());return i.colId=e.getColId(),i.width=e.getActualWidth(),i.rowGroup=e.isRowGroupActive(),i.rowGroupIndex=e.isRowGroupActive()?t.indexOf(e):null,i.pivot=e.isPivotActive(),i.pivotIndex=e.isPivotActive()?n.indexOf(e):null,i.aggFunc=e.isValueActive()?e.getAggFunc():null,i.hide=e.isVisible()?void 0:!0,i.pinned=e.isPinned()?e.getPinned():null,i.sort=e.getSort()?e.getSort():null,i.sortIndex=e.getSortIndex()!=null?e.getSortIndex():null,i}},i7e=class extends Z{constructor(){super(...arguments),this.beanName="colFlex"}refreshFlexedColumns(e={}){const t=e.source??"flex";e.viewportWidth!=null&&(this.flexViewportWidth=e.viewportWidth);const n=this.flexViewportWidth;if(!n)return[];const{visibleCols:i}=this.beans,r=i.centerCols;let s=-1;if(e.resizingCols){const g=new Set(e.resizingCols);for(let m=r.length-1;m>=0;m--)if(g.has(r[m])){s=m;break}}let o=!1;const a=r.map((g,m)=>{const C=g.getFlex(),y=C!=null&&C>0&&m>s;return o||(o=y),{col:g,isFlex:y,flex:Math.max(0,C??0),initialSize:g.getActualWidth(),min:g.getMinWidth(),max:g.getMaxWidth(),targetSize:0}});if(!o)return[];let l=a.length,u=a.reduce((g,m)=>g+m.flex,0),c=n;const d=(g,m)=>{g.frozenSize=m,g.col.setActualWidth(m,t),c-=m,u-=g.flex,l-=1},h=g=>g.frozenSize!=null;for(const g of a)g.isFlex||d(g,g.initialSize);for(;l>0;){const g=Math.round(u<1?c*u:c);let m,C=0,y=0;for(const x of a){if(h(x))continue;m=x,y+=g*(x.flex/u);const E=y-C,A=Math.round(E);x.targetSize=A,C+=A}m&&(m.targetSize+=g-C);let b=0;for(const x of a){if(h(x))continue;const E=x.targetSize,A=Math.min(Math.max(E,x.min),x.max);b+=A-E,x.violationType=A===E?void 0:A<E?"max":"min",x.targetSize=A}const S=b===0?"all":b>0?"min":"max";for(const x of a)h(x)||(S==="all"||x.violationType===S)&&d(x,x.targetSize)}e.skipSetLeft||i.setLeftValues(t),e.updateBodyWidths&&i.updateBodyWidths();const p=a.filter(g=>g.isFlex&&!g.violationType).map(g=>g.col);if(e.fireResizedEvent){const g=a.filter(C=>C.initialSize!==C.frozenSize).map(C=>C.col),m=a.filter(C=>C.flex).map(C=>C.col);zp(this.eventSvc,g,!0,t,m)}return p}initCol(e){const{flex:t,initialFlex:n}=e.colDef;t!==void 0?e.flex=t:n!==void 0&&(e.flex=n)}setColFlex(e,t){e.flex=t??null,e.dispatchStateUpdatedEvent("flex")}},r7e=class extends Z{constructor(){super(...arguments),this.beanName="dataTypeSvc",this.dataTypeDefinitions={},this.isPendingInference=!1,this.isColumnTypeOverrideInDataTypeDefinitions=!1,this.columnStateUpdatesPendingInference={},this.columnStateUpdateListenerDestroyFuncs=[]}wireBeans(e){this.colModel=e.colModel}postConstruct(){this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",e=>{this.processDataTypeDefinitions(),this.colModel.recreateColumnDefs(e)})}processDataTypeDefinitions(){const e=this.getDefaultDataTypes(),t={};this.dataTypeDefinitions=t;const n={};this.formatValueFuncs=n;const i=o=>a=>{const{column:l,node:u,value:c}=a;let d=l.getColDef().valueFormatter;return d===o.groupSafeValueFormatter&&(d=o.valueFormatter),this.beans.valueSvc.formatValue(l,u,c,d)};for(const o of Object.keys(e)){const a=e[o],l={...a,groupSafeValueFormatter:NW(a,this.gos)};t[o]=l,n[o]=i(l)}const r=this.gos.get("dataTypeDefinitions")??{},s={};this.dataTypeMatchers=s;for(const o of Object.keys(r)){const a=r[o],l=this.processDataTypeDefinition(a,r,[o],e);l&&(t[o]=l,a.dataTypeMatcher&&(s[o]=a.dataTypeMatcher),n[o]=i(l))}this.checkObjectValueHandlers(e),["dateString","text","number","boolean","date"].forEach(o=>{const a=s[o];a&&delete s[o],s[o]=a??e[o].dataTypeMatcher})}processDataTypeDefinition(e,t,n,i){let r;const s=e.extendsDataType;if(e.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),e.extendsDataType===e.baseDataType){let o=i[s];const a=t[s];if(o&&a&&(o=a),!LW(e,o,s))return;r=OW(o,e)}else{if(n.includes(s)){de(44);return}const o=t[s];if(!LW(e,o,s))return;const a=this.processDataTypeDefinition(o,t,[...n,s],i);if(!a)return;r=OW(a,e)}return{...r,groupSafeValueFormatter:NW(r,this.gos)}}updateColDefAndGetColumnType(e,t,n){let{cellDataType:i}=t;const{field:r}=t;if(i===void 0&&(i=e.cellDataType),(i==null||i===!0)&&(i=this.canInferCellDataType(e,t)?this.inferCellDataType(r,n):!1),!i){e.cellDataType=!1;return}const s=this.dataTypeDefinitions[i];if(!s){de(47,{cellDataType:i});return}return e.cellDataType=i,s.groupSafeValueFormatter&&(e.valueFormatter=s.groupSafeValueFormatter),s.valueParser&&(e.valueParser=s.valueParser),s.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(e,i,s,n),s.columnTypes}addColumnListeners(e){if(!this.isPendingInference)return;const t=this.columnStateUpdatesPendingInference[e.getColId()];if(!t)return;const n=i=>{t.add(i.key)};e.__addEventListener("columnStateUpdated",n),this.columnStateUpdateListenerDestroyFuncs.push(()=>e.__removeEventListener("columnStateUpdated",n))}canInferCellDataType(e,t){const{gos:n}=this;if(!tr(n))return!1;const i={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(nk(t,i))return!1;const r=t.type===null?e.type:t.type;if(r){const s=n.get("columnTypes")??{};if(h1(r).some(a=>{const l=s[a.trim()];return l&&nk(l,i)}))return!1}return!nk(e,i)}inferCellDataType(e,t){if(!e)return;let n;const i=this.getInitialData();if(i){const r=e.indexOf(".")>=0&&!this.gos.get("suppressFieldDotNotation");n=kv(i,e,r)}else this.initWaitForRowData(t);if(n!=null)return Object.keys(this.dataTypeMatchers).find(r=>this.dataTypeMatchers[r](n))??"object"}getInitialData(){const e=this.gos.get("rowData");if(e?.length)return e[0];if(this.initialData)return this.initialData;{const t=this.beans.rowModel.rootNode?.allLeafChildren;if(t?.length)return t[0].data}return null}initWaitForRowData(e){if(this.columnStateUpdatesPendingInference[e]=new Set,this.isPendingInference)return;this.isPendingInference=!0;const t=this.isColumnTypeOverrideInDataTypeDefinitions,{colAutosize:n,eventSvc:i}=this.beans;t&&n&&(n.shouldQueueResizeOperations=!0);const[r]=this.addManagedEventListeners({rowDataUpdateStarted:s=>{const{firstRowData:o}=s;o&&(r?.(),this.isPendingInference=!1,this.processColumnsPendingInference(o,t),this.columnStateUpdatesPendingInference={},t&&n?.processResizeOperations(),i.dispatchEvent({type:"dataTypesInferred"}))}})}processColumnsPendingInference(e,t){this.initialData=e;const n=[];this.destroyColumnStateUpdateListeners();const i={},r={};for(const s of Object.keys(this.columnStateUpdatesPendingInference)){const o=this.columnStateUpdatesPendingInference[s],a=this.colModel.getCol(s);if(!a)return;const l=a.getColDef();if(!this.resetColDefIntoCol(a,"cellDataTypeInferred"))return;const u=a.getColDef();if(t&&u.type&&u.type!==l.type){const c=o7e(a,o);c.rowGroup&&c.rowGroupIndex==null&&(i[s]=c),c.pivot&&c.pivotIndex==null&&(r[s]=c),n.push(c)}}t&&n.push(...this.generateColumnStateForRowGroupAndPivotIndexes(i,r)),n.length&&os(this.beans,{state:n},"cellDataTypeInferred"),this.initialData=null}generateColumnStateForRowGroupAndPivotIndexes(e,t){const n={},{rowGroupColsSvc:i,pivotColsSvc:r}=this.beans;return i?.restoreColumnOrder(n,e),r?.restoreColumnOrder(n,t),Object.values(n)}resetColDefIntoCol(e,t){const n=e.getUserProvidedColDef();if(!n)return!1;const i=sT(this.beans,n,e.getColId());return e.setColDef(i,n,t),!0}checkObjectValueHandlers(e){const t=this.dataTypeDefinitions.object,n=e.object;this.hasObjectValueParser=t.valueParser!==n.valueParser,this.hasObjectValueFormatter=t.valueFormatter!==n.valueFormatter}getDateStringTypeDefinition(e){const{dateString:t}=this.dataTypeDefinitions;return e?this.getDataTypeDefinition(e)??t:t}getDateParserFunction(e){return this.getDateStringTypeDefinition(e).dateParser}getDateFormatterFunction(e){return this.getDateStringTypeDefinition(e).dateFormatter}getDataTypeDefinition(e){const t=e.getColDef();if(t.cellDataType)return this.dataTypeDefinitions[t.cellDataType]}getBaseDataType(e){return this.getDataTypeDefinition(e)?.baseDataType}checkType(e,t){if(t==null)return!0;const n=this.getDataTypeDefinition(e)?.dataTypeMatcher;return n?n(t):!0}validateColDef(e){const t=n=>de(48,{property:n});if(e.cellDataType==="object"){const{object:n}=this.dataTypeDefinitions;e.valueFormatter===n.groupSafeValueFormatter&&!this.hasObjectValueFormatter&&t("Formatter"),e.editable&&e.valueParser===n.valueParser&&!this.hasObjectValueParser&&t("Parser")}}getFormatValue(e){return this.formatValueFuncs[e]}isColPendingInference(e){return this.isPendingInference&&!!this.columnStateUpdatesPendingInference[e]}setColDefPropertiesForBaseDataType(e,t,n,i){const r=this.formatValueFuncs[t];switch(n.baseDataType){case"number":{e.cellEditor="agNumberCellEditor";break}case"boolean":{e.cellEditor="agCheckboxCellEditor",e.cellRenderer="agCheckboxCellRenderer",e.getFindText=()=>null,e.suppressKeyboardEvent=s=>!!s.colDef.editable&&s.event.key===X.SPACE;break}case"date":{e.cellEditor="agDateCellEditor",e.keyCreator=r;break}case"dateString":{e.cellEditor="agDateStringCellEditor",e.keyCreator=r;break}case"object":{e.cellEditorParams={useFormatter:!0},e.comparator=(s,o)=>{const a=this.colModel.getColDefCol(i),l=a?.getColDef();if(!a||!l)return 0;const u=s==null?"":r({column:a,node:null,value:s}),c=o==null?"":r({column:a,node:null,value:o});return u===c?0:u>c?1:-1},e.keyCreator=r;break}}this.beans.filterManager?.setColDefPropertiesForDataType(e,n,r)}getDefaultDataTypes(){const e=n=>!!n.match("^\\d{4}-\\d{2}-\\d{2}$"),t=this.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:n=>n.newValue?.trim?.()===""?null:Number(n.newValue),valueFormatter:n=>n.value==null?"":typeof n.value!="number"||isNaN(n.value)?t("invalidNumber","Invalid Number"):String(n.value),dataTypeMatcher:n=>typeof n=="number"},text:{baseDataType:"text",valueParser:n=>n.newValue===""?null:ZM(n.newValue),dataTypeMatcher:n=>typeof n=="string"},boolean:{baseDataType:"boolean",valueParser:n=>n.newValue==null?n.newValue:n.newValue?.trim?.()===""?null:String(n.newValue).toLowerCase()==="true",valueFormatter:n=>n.value==null?"":String(n.value),dataTypeMatcher:n=>typeof n=="boolean"},date:{baseDataType:"date",valueParser:n=>kr(n.newValue==null?null:String(n.newValue)),valueFormatter:n=>n.value==null?"":!(n.value instanceof Date)||isNaN(n.value.getTime())?t("invalidDate","Invalid Date"):Bs(n.value,!1)??"",dataTypeMatcher:n=>n instanceof Date},dateString:{baseDataType:"dateString",dateParser:n=>kr(n)??void 0,dateFormatter:n=>Bs(n??null,!1)??void 0,valueParser:n=>e(String(n.newValue))?n.newValue:null,valueFormatter:n=>e(String(n.value))?n.value:"",dataTypeMatcher:n=>typeof n=="string"&&e(n)},object:{baseDataType:"object",valueParser:()=>null,valueFormatter:n=>ZM(n.value)??""}}}destroyColumnStateUpdateListeners(){this.columnStateUpdateListenerDestroyFuncs.forEach(e=>e()),this.columnStateUpdateListenerDestroyFuncs=[]}destroy(){this.dataTypeDefinitions={},this.dataTypeMatchers={},this.formatValueFuncs={},this.columnStateUpdatesPendingInference={},this.destroyColumnStateUpdateListeners(),super.destroy()}};function OW(e,t){const n={...e,...t};return e.columnTypes&&t.columnTypes&&t.appendColumnTypes&&(n.columnTypes=[...h1(e.columnTypes),...h1(t.columnTypes)]),n}function LW(e,t,n){return t?t.baseDataType!==e.baseDataType?(de(46),!1):!0:(de(45,{parentCellDataType:n}),!1)}function NW(e,t){if(e.valueFormatter)return n=>{if(n.node?.group){const i=(n.colDef.pivotValueColumn??n.column).getAggFunc();if(i){if(i==="first"||i==="last")return e.valueFormatter(n);if(e.baseDataType==="number"&&i!=="count"){if(typeof n.value=="number")return e.valueFormatter(n);if(typeof n.value=="object"){if(!n.value)return;if("toNumber"in n.value)return e.valueFormatter({...n,value:n.value.toNumber()});if("value"in n.value)return e.valueFormatter({...n,value:n.value.value})}}return}if(t.get("groupDisplayType")==="groupRows"&&!t.get("treeData"))return}else if(t.get("groupHideOpenParents")&&n.column.isRowGroupActive()&&typeof n.value=="string"&&!e.dataTypeMatcher?.(n.value))return;return e.valueFormatter(n)}}function s7e(e,t,n,i){if(!t[n])return!1;const r=e[n];return r===null?(t[n]=!1,!1):i===void 0?!!r:r===i}function nk(e,t){return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some(([n,i])=>s7e(e,t,n,i))}function o7e(e,t){const n=Vee(e);return t.forEach(i=>{delete n[i],i==="rowGroup"?delete n.rowGroupIndex:i==="pivot"&&delete n.pivotIndex}),n}var a7e={moduleName:"DataType",version:we,beans:[r7e],dependsOn:[_9e]},l7e={moduleName:"ColumnFlex",version:we,beans:[i7e]},u7e={moduleName:"ColumnApi",version:we,beans:[n7e],apiFunctions:{getColumnDef:O9e,getDisplayNameForColumn:N9e,getColumn:$9e,getColumns:B9e,applyColumnState:G9e,getColumnState:z9e,resetColumnState:H9e,isPinning:V9e,isPinningLeft:W9e,isPinningRight:U9e,getDisplayedColAfter:q9e,getDisplayedColBefore:j9e,setColumnsVisible:K9e,setColumnsPinned:Y9e,getAllGridColumns:X9e,getDisplayedLeftColumns:Q9e,getDisplayedCenterColumns:Z9e,getDisplayedRightColumns:J9e,getAllDisplayedColumns:e7e,getAllDisplayedVirtualColumns:t7e,getColumnDefs:L9e}};function c7e(e){if(!e||e==null)return null;const t=/([a-z])([A-Z])/g,n=/([A-Z]+)([A-Z])([a-z])/g;return e.replace(t,"$1 $2").replace(n,"$1 $2$3").replace(/\./g," ").split(" ").map(r=>r.substring(0,1).toUpperCase()+(r.length>1?r.substring(1,r.length):"")).join(" ")}var d7e=class extends Z{constructor(){super(...arguments),this.beanName="colNames"}getDisplayNameForColumn(e,t,n=!1){if(!e)return null;const i=this.getHeaderName(e.getColDef(),e,null,null,t),{aggColNameSvc:r}=this.beans;return n&&r?r.getHeaderName(e,i):i}getDisplayNameForProvidedColumnGroup(e,t,n){const i=t?.getColGroupDef();return i?this.getHeaderName(i,null,e,t,n):null}getDisplayNameForColumnGroup(e,t){return this.getDisplayNameForProvidedColumnGroup(e,e.getProvidedColumnGroup(),t)}getHeaderName(e,t,n,i,r){const s=e.headerValueGetter;if(s){const o=ze(this.gos,{colDef:e,column:t,columnGroup:n,providedColumnGroup:i,location:r});return typeof s=="function"?s(o):typeof s=="string"?this.beans.expressionSvc?.evaluate(s,o)??null:""}else{if(e.headerName!=null)return e.headerName;if(e.field)return c7e(e.field)}return""}},h7e=class extends Z{constructor(){super(...arguments),this.beanName="colViewport",this.colsWithinViewport=[],this.headerColsWithinViewport=[],this.colsWithinViewportHash="",this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={}}wireBeans(e){this.visibleCols=e.visibleCols,this.colModel=e.colModel}postConstruct(){this.suppressColumnVirtualisation=this.gos.get("suppressColumnVirtualisation")}setScrollPosition(e,t,n=!1){const{visibleCols:i}=this,r=i.isBodyWidthDirty;if(!(e===this.scrollWidth&&t===this.scrollPosition&&!r)){if(this.scrollWidth=e,this.scrollPosition=t,i.isBodyWidthDirty=!0,this.gos.get("enableRtl")){const o=i.bodyWidth;this.viewportLeft=o-t-e,this.viewportRight=o-t}else this.viewportLeft=t,this.viewportRight=e+t;this.colModel.ready&&this.checkViewportColumns(n)}}getHeadersToRender(e,t){let n;switch(e){case"left":n=this.rowsOfHeadersToRenderLeft[t];break;case"right":n=this.rowsOfHeadersToRenderRight[t];break;default:n=this.rowsOfHeadersToRenderCenter[t];break}return n||[]}extractViewportColumns(){const e=this.visibleCols.centerCols;this.isColumnVirtualisationSuppressed()?(this.colsWithinViewport=e,this.headerColsWithinViewport=e):(this.colsWithinViewport=e.filter(this.isColumnInRowViewport.bind(this)),this.headerColsWithinViewport=e.filter(this.isColumnInHeaderViewport.bind(this)))}isColumnVirtualisationSuppressed(){return this.suppressColumnVirtualisation||this.viewportRight===0}clear(e){this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},e||(this.colsWithinViewportHash="")}isColumnInHeaderViewport(e){return e.isAutoHeaderHeight()||f7e(e)?!0:this.isColumnInRowViewport(e)}isColumnInRowViewport(e){if(e.isAutoHeight())return!0;const t=e.getLeft()||0,n=t+e.getActualWidth(),i=this.viewportLeft-200,r=this.viewportRight+200,s=t<i&&n<i,o=t>r&&n>r;return!s&&!o}getViewportColumns(){const{leftCols:e,rightCols:t}=this.visibleCols;return this.colsWithinViewport.concat(e).concat(t)}getColsWithinViewport(e){if(!this.colModel.colSpanActive)return this.colsWithinViewport;const t=s=>{const o=s.getLeft();return Ce(o)&&o>this.viewportLeft},n=this.isColumnVirtualisationSuppressed()?void 0:this.isColumnInRowViewport.bind(this),{visibleCols:i}=this,r=i.centerCols;return i.getColsForRow(e,r,n,t)}checkViewportColumns(e=!1){this.extractViewport()&&this.eventSvc.dispatchEvent({type:"virtualColumnsChanged",afterScroll:e})}calculateHeaderRows(){this.clear(!0);const e={},{leftCols:t,rightCols:n,treeLeft:i,treeRight:r,treeCenter:s}=this.visibleCols;this.headerColsWithinViewport.concat(t).concat(n).forEach(l=>e[l.getId()]=!0);const a=(l,u,c)=>{let d=!1;for(let h=0;h<l.length;h++){const p=l[h];let g=!1;if(pc(p))g=e[p.getId()]===!0;else{const C=p.getDisplayedChildren();C&&(g=a(C,u,c+1))}g&&(d=!0,u[c]||(u[c]=[]),u[c].push(p))}return d};a(i,this.rowsOfHeadersToRenderLeft,0),a(r,this.rowsOfHeadersToRenderRight,0),a(s,this.rowsOfHeadersToRenderCenter,0)}extractViewport(){const e=i=>`${i.getId()}-${i.getPinned()||"normal"}`;this.extractViewportColumns();const t=this.getViewportColumns().map(e).join("#"),n=this.colsWithinViewportHash!==t;return n&&(this.colsWithinViewportHash=t,this.calculateHeaderRows()),n}};function f7e(e){for(;e;){if(e.isAutoHeaderHeight())return!0;e=e.getParent()}return!1}var p7e=class extends Z{constructor(){super(...arguments),this.beanName="agCompUtils"}adaptFunction(e,t){if(!e.cellRenderer)return null;class n{refresh(){return!1}getGui(){return this.eGui}init(r){const s=t(r),o=typeof s;if(o==="string"||o==="number"||o==="boolean"){this.eGui=UR("<span>"+s+"</span>");return}if(s==null){this.eGui=Sn({tag:"span"});return}this.eGui=s}}return n}},g7e={moduleName:"CellRendererFunction",version:we,beans:[p7e]},m7e=class extends Z{constructor(){super(...arguments),this.beanName="registry",this.agGridDefaults={},this.agGridDefaultParams={},this.jsComps={},this.dynamicBeans={},this.selectors={},this.icons={}}postConstruct(){const e=this.gos.get("components");if(e!=null)for(const t of Object.keys(e))this.jsComps[t]=e[t]}registerModule(e){const{icons:t,userComponents:n,dynamicBeans:i,selectors:r}=e;if(n){const s=(o,a,l)=>{this.agGridDefaults[o]=a,l&&(this.agGridDefaultParams[o]=l)};for(const o of Object.keys(n)){const a=n[o];typeof a=="object"?s(o,a.classImp,a.params):s(o,a)}}if(i)for(const s of Object.keys(i))this.dynamicBeans[s]=i[s];if(r?.forEach(s=>{this.selectors[s.selector]=s}),t)for(const s of Object.keys(t))this.icons[s]=t[s]}getUserComponent(e,t){const n=(a,l,u)=>({componentFromFramework:l,component:a,params:u}),{frameworkOverrides:i}=this.beans,r=i.frameworkComponent(t,this.gos.get("components"));if(r!=null)return n(r,!0);const s=this.jsComps[t];if(s){const a=i.isFrameworkComponent(s);return n(s,a)}const o=this.agGridDefaults[t];return o?n(o,!1,this.agGridDefaultParams[t]):(this.beans.validation?.missingUserComponent(e,t,this.agGridDefaults,this.jsComps),null)}createDynamicBean(e,t,...n){const i=this.dynamicBeans[e];if(i==null){if(t)throw new Error(Xu(256));return}return new i(...n)}getSelector(e){return this.selectors[e]}getIcon(e){return this.icons[e]}},v7e=23,C7e=class extends Z{constructor(){super(...arguments),this.beanName="ctrlsSvc",this.params={},this.ready=!1,this.readyCallbacks=[]}postConstruct(){this.addEventListener("ready",()=>{this.updateReady(),this.ready&&(this.readyCallbacks.forEach(e=>e(this.params)),this.readyCallbacks.length=0)},this.beans.frameworkOverrides.runWhenReadyAsync?.()??!1)}updateReady(){const e=Object.values(this.params);this.ready=e.length===v7e&&e.every(t=>t?.isAlive()??!1)}whenReady(e,t){this.ready?t(this.params):this.readyCallbacks.push(t),e.addDestroyFunc(()=>{const n=this.readyCallbacks.indexOf(t);n>=0&&this.readyCallbacks.splice(n,1)})}register(e,t){this.params[e]=t,this.updateReady(),this.ready&&this.dispatchLocalEvent({type:"ready"}),t.addDestroyFunc(()=>{this.updateReady()})}get(e){return this.params[e]}getGridBodyCtrl(){return this.params.gridBodyCtrl}getHeaderRowContainerCtrls(){const{leftHeader:e,centerHeader:t,rightHeader:n}=this.params;return[e,n,t]}getHeaderRowContainerCtrl(e){const t=this.params;switch(e){case"left":return t.leftHeader;case"right":return t.rightHeader;default:return t.centerHeader}}getScrollFeature(){return this.getGridBodyCtrl().scrollFeature}},y7e=':where(.ag-root-wrapper,.ag-popup,.ag-dnd-ghost,.ag-chart),:where(.ag-root-wrapper,.ag-popup,.ag-dnd-ghost,.ag-chart) :where([class^=ag-]){box-sizing:border-box;&:after,&:before{box-sizing:border-box}&:where(div,span,label):focus-visible{box-shadow:inset var(--ag-focus-shadow);outline:none}}:where(.ag-root-wrapper,.ag-popup,.ag-dnd-ghost,.ag-chart) :where([class^=ag-]) ::-ms-clear{display:none}.ag-aria-description-container{border:0;z-index:9999;clip:rect(1px,1px,1px,1px);height:1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px}.ag-hidden{display:none!important}.ag-invisible{visibility:hidden!important}.ag-unselectable{-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-selectable{-webkit-user-select:text;-moz-user-select:text;user-select:text}.ag-tab-guard{display:block;height:0;position:absolute;width:0}:where(.ag-virtual-list-viewport) .ag-tab-guard{position:sticky}.ag-tab-guard-top{top:1px}.ag-tab-guard-bottom{bottom:1px}.ag-shake-left-to-right{animation-direction:alternate;animation-duration:.2s;animation-iteration-count:infinite;animation-name:ag-shake-left-to-right}@keyframes ag-shake-left-to-right{0%{padding-left:6px;padding-right:2px}to{padding-left:2px;padding-right:6px}}.ag-body-horizontal-scroll-viewport,.ag-body-vertical-scroll-viewport,.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport,.ag-virtual-list-viewport{flex:1 1 auto;height:100%;min-width:0;overflow:hidden;position:relative}.ag-viewport{position:relative}.ag-spanning-container{position:absolute;top:0;z-index:1}.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport{overflow-x:auto;-ms-overflow-style:none!important;scrollbar-width:none!important;&::-webkit-scrollbar{display:none!important}}.ag-body-viewport{display:flex;overflow-x:hidden;&:where(.ag-layout-normal){overflow-y:auto;-webkit-overflow-scrolling:touch}}.ag-floating-bottom-container,.ag-floating-top-container,.ag-sticky-bottom-container,.ag-sticky-top-container{min-height:1px}.ag-center-cols-viewport{min-height:100%;width:100%}.ag-body-horizontal-scroll-viewport{overflow-x:scroll}.ag-body-vertical-scroll-viewport{overflow-y:scroll}.ag-virtual-list-viewport{overflow:auto;width:100%}.ag-body-container,.ag-body-horizontal-scroll-container,.ag-body-vertical-scroll-container,.ag-center-cols-container,.ag-floating-bottom-container,.ag-floating-bottom-full-width-container,.ag-floating-top-container,.ag-full-width-container,.ag-header-container,.ag-pinned-left-cols-container,.ag-pinned-right-cols-container,.ag-sticky-bottom-container,.ag-sticky-top-container,.ag-virtual-list-container{position:relative}.ag-floating-bottom-container,.ag-floating-top-container,.ag-header-container,.ag-pinned-left-floating-bottom,.ag-pinned-left-floating-top,.ag-pinned-right-floating-bottom,.ag-pinned-right-floating-top,.ag-sticky-bottom-container,.ag-sticky-top-container{height:100%;white-space:nowrap}.ag-center-cols-container,.ag-pinned-right-cols-container{display:block}.ag-body-horizontal-scroll-container{height:100%}.ag-body-vertical-scroll-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container,.ag-full-width-container,.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{pointer-events:none;position:absolute;top:0}:where(.ag-ltr) .ag-floating-bottom-full-width-container,:where(.ag-ltr) .ag-floating-top-full-width-container,:where(.ag-ltr) .ag-full-width-container,:where(.ag-ltr) .ag-sticky-bottom-full-width-container,:where(.ag-ltr) .ag-sticky-top-full-width-container{left:0}:where(.ag-rtl) .ag-floating-bottom-full-width-container,:where(.ag-rtl) .ag-floating-top-full-width-container,:where(.ag-rtl) .ag-full-width-container,:where(.ag-rtl) .ag-sticky-bottom-full-width-container,:where(.ag-rtl) .ag-sticky-top-full-width-container{right:0}.ag-full-width-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container{display:inline-block;height:100%;overflow:hidden;width:100%}.ag-virtual-list-container{overflow:hidden}.ag-body{display:flex;flex:1 1 auto;flex-direction:row!important;min-height:0;position:relative}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:flex;min-height:0;min-width:0;position:relative;&:where(.ag-scrollbar-invisible){bottom:0;position:absolute;&:where(.ag-apple-scrollbar){opacity:0;transition:opacity .4s;visibility:hidden;&:where(.ag-scrollbar-scrolling,.ag-scrollbar-active){opacity:1;visibility:visible}}}}.ag-body-horizontal-scroll{width:100%;&:where(.ag-scrollbar-invisible){left:0;right:0}}.ag-body-vertical-scroll{height:100%;&:where(.ag-scrollbar-invisible){top:0;z-index:10}}:where(.ag-ltr) .ag-body-vertical-scroll{&:where(.ag-scrollbar-invisible){right:0}}:where(.ag-rtl) .ag-body-vertical-scroll{&:where(.ag-scrollbar-invisible){left:0}}.ag-force-vertical-scroll{overflow-y:scroll!important}.ag-horizontal-left-spacer,.ag-horizontal-right-spacer{height:100%;min-width:0;overflow-x:scroll;&:where(.ag-scroller-corner){overflow-x:hidden}}:where(.ag-row-animation) .ag-row{transition:transform .4s,top .4s,opacity .2s;&:where(.ag-after-created){transition:transform .4s,top .4s,height .4s,opacity .2s}}:where(.ag-row-no-animation) .ag-row{transition:none}.ag-row-loading{align-items:center;display:flex}.ag-row-position-absolute{position:absolute}.ag-row-position-relative{position:relative}.ag-full-width-row{overflow:hidden;pointer-events:all}.ag-row-inline-editing{z-index:1}.ag-row-dragging{z-index:2}.ag-stub-cell{align-items:center;display:flex}.ag-cell{display:inline-block;height:100%;position:absolute;white-space:nowrap;&:focus-visible{box-shadow:none}}.ag-cell-value{flex:1 1 auto}.ag-cell-value,.ag-group-value{overflow:hidden;text-overflow:ellipsis}.ag-cell-wrap-text{white-space:normal;word-break:break-word}:where(.ag-cell) .ag-icon{display:inline-block;vertical-align:middle}.ag-floating-top{border-bottom:var(--ag-pinned-row-border)}.ag-floating-bottom,.ag-floating-top{display:flex;overflow:hidden;position:relative;white-space:nowrap;width:100%}.ag-floating-bottom{border-top:var(--ag-pinned-row-border)}.ag-sticky-bottom,.ag-sticky-top{background-color:var(--ag-background-color);display:flex;height:0;overflow:hidden;position:absolute;width:100%;z-index:1}.ag-opacity-zero{opacity:0!important}.ag-cell-label-container{align-items:center;display:flex;flex-direction:row-reverse;height:100%;justify-content:space-between;width:100%}:where(.ag-right-aligned-header){.ag-cell-label-container{flex-direction:row}.ag-header-cell-text{text-align:end}}.ag-column-group-icons{display:block;>*{cursor:pointer}}:where(.ag-ltr){direction:ltr;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row}}:where(.ag-rtl){direction:rtl;text-align:right;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row-reverse}.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{display:block}}:where(.ag-rtl){.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(180deg)}}:where(.ag-rtl){.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(-180deg)}}.ag-measurement-container{height:0;overflow:hidden;visibility:hidden;width:0}.ag-measurement-element-border{display:inline-block;&:before{border-left:var(--ag-internal-measurement-border);content:"";display:block}}.ag-group{position:relative;width:100%}.ag-group-title-bar{align-items:center;display:flex;padding:var(--ag-spacing)}.ag-group-title{display:inline;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:where(.ag-group-title-bar) .ag-group-title{cursor:default}.ag-group-toolbar{align-items:center;display:flex;padding:var(--ag-spacing)}.ag-group-container{display:flex}.ag-disabled .ag-group-container{pointer-events:none}.ag-disabled-group-container,.ag-disabled-group-title-bar{opacity:.5}.ag-group-container-horizontal{flex-flow:row wrap}.ag-group-container-vertical{flex-direction:column}.ag-group-title-bar-icon{cursor:pointer;flex:none}:where(.ag-ltr) .ag-group-title-bar-icon{margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-group-title-bar-icon{margin-left:var(--ag-spacing)}:where(.ag-group-item-alignment-stretch) .ag-group-item{align-items:stretch}:where(.ag-group-item-alignment-start) .ag-group-item{align-items:flex-start}:where(.ag-group-item-alignment-end) .ag-group-item{align-items:flex-end}.ag-popup-child{top:0;z-index:5;&:where(:not(.ag-tooltip-custom)){box-shadow:var(--ag-popup-shadow)}}.ag-popup-editor{position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-large-text-input{display:block}:where(.ag-ltr) .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-left:var(--ag-row-group-indent-size)}:where(.ag-rtl) .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-right:var(--ag-row-group-indent-size)}:where(.ag-ltr) .ag-row-group-leaf-indent{margin-left:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}:where(.ag-rtl) .ag-row-group-leaf-indent{margin-right:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}.ag-value-change-delta{padding:0 2px}.ag-value-change-delta-up{color:var(--ag-value-change-delta-up-color)}.ag-value-change-delta-down{color:var(--ag-value-change-delta-down-color)}.ag-value-change-value{background-color:transparent;border-radius:1px;padding-left:1px;padding-right:1px;transition:background-color 1s}.ag-value-change-value-highlight{background-color:var(--ag-value-change-value-highlight-background-color);transition:background-color .1s}.ag-cell-data-changed{background-color:var(--ag-value-change-value-highlight-background-color)!important}.ag-cell-data-changed-animation{background-color:transparent}.ag-cell-highlight{background-color:var(--ag-range-selection-highlight-color)!important}.ag-row,.ag-spanned-row{color:var(--ag-cell-text-color);font-family:var(--ag-cell-font-family);font-size:var(--ag-data-font-size);white-space:nowrap;--ag-internal-content-line-height:calc(min(var(--ag-row-height), var(--ag-line-height, 1000px)) - var(--ag-internal-row-border-width, 1px) - 2px)}.ag-row{background-color:var(--ag-background-color);border-bottom:var(--ag-row-border);height:var(--ag-row-height);width:100%}:where(.ag-body-vertical-content-no-gap>div>div>div,.ag-body-vertical-content-no-gap>div>div>div>div)>.ag-row-last{border-bottom-color:transparent}.ag-sticky-bottom{border-top:var(--ag-row-border);box-sizing:content-box!important}.ag-group-contracted,.ag-group-expanded{cursor:pointer}.ag-cell,.ag-full-width-row .ag-cell-wrapper.ag-row-group{border:1px solid transparent;line-height:var(--ag-internal-content-line-height);-webkit-font-smoothing:subpixel-antialiased}:where(.ag-ltr) .ag-cell{border-right:var(--ag-column-border)}:where(.ag-rtl) .ag-cell{border-left:var(--ag-column-border)}.ag-spanned-cell-wrapper{background-color:var(--ag-background-color);position:absolute}.ag-spanned-cell-wrapper>.ag-spanned-cell{display:block;position:relative}:where(.ag-ltr) :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-right-color:transparent}:where(.ag-rtl) :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-left-color:transparent}.ag-cell-wrapper{align-items:center;display:flex;>:where(:not(.ag-cell-value,.ag-group-value)){align-items:center;display:flex;height:var(--ag-internal-content-line-height)}&:where(.ag-row-group){align-items:flex-start}:where(.ag-full-width-row) &:where(.ag-row-group){align-items:center;height:100%}}:where(.ag-ltr) .ag-cell-wrapper{padding-left:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}:where(.ag-rtl) .ag-cell-wrapper{padding-right:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}:where(.ag-cell-wrap-text:not(.ag-cell-auto-height)) .ag-cell-wrapper{align-items:normal;height:100%;:where(.ag-cell-value){height:100%}}:where(.ag-ltr) .ag-row>.ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}:where(.ag-rtl) .ag-row>.ag-cell-wrapper.ag-row-group{padding-right:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-cell-focus:not(.ag-cell-range-selected):focus-within,.ag-cell-range-single-cell,.ag-cell-range-single-cell.ag-cell-range-handle,.ag-context-menu-open .ag-cell-focus:not(.ag-cell-range-selected),.ag-context-menu-open .ag-full-width-row.ag-row-focus .ag-cell-wrapper.ag-row-group,.ag-full-width-row.ag-row-focus:focus .ag-cell-wrapper.ag-row-group{border:1px solid;border-color:var(--ag-range-selection-border-color);border-style:var(--ag-range-selection-border-style);outline:initial}.ag-full-width-row.ag-row-focus:focus{box-shadow:none}:where(.ag-ltr) .ag-group-contracted,:where(.ag-ltr) .ag-group-expanded,:where(.ag-ltr) .ag-row-drag,:where(.ag-ltr) .ag-selection-checkbox{margin-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-group-contracted,:where(.ag-rtl) .ag-group-expanded,:where(.ag-rtl) .ag-row-drag,:where(.ag-rtl) .ag-selection-checkbox{margin-left:var(--ag-cell-widget-spacing)}:where(.ag-ltr) .ag-group-child-count{margin-left:3px}:where(.ag-rtl) .ag-group-child-count{margin-right:3px}.ag-row-highlight-above:after,.ag-row-highlight-below:after{background-color:var(--ag-range-selection-border-color);content:"";height:1px;position:absolute;width:calc(100% - 1px)}:where(.ag-ltr) .ag-row-highlight-above:after,:where(.ag-ltr) .ag-row-highlight-below:after{left:1px}:where(.ag-rtl) .ag-row-highlight-above:after,:where(.ag-rtl) .ag-row-highlight-below:after{right:1px}.ag-row-highlight-above:after{top:0}.ag-row-highlight-below:after{bottom:0}.ag-row-odd{background-color:var(--ag-odd-row-background-color)}.ag-row-selected:before{background-color:var(--ag-selected-row-background-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-full-width-row.ag-row-group:before,.ag-row-hover:not(.ag-full-width-row):before{background-color:var(--ag-row-hover-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-row-selected:before{background-color:var(--ag-row-hover-color);background-image:linear-gradient(var(--ag-selected-row-background-color),var(--ag-selected-row-background-color))}.ag-row.ag-full-width-row.ag-row-group>*{position:relative}.ag-column-hover{background-color:var(--ag-column-hover-color)}.ag-header-range-highlight{background-color:var(--ag-range-header-highlight-color)}.ag-right-aligned-cell{font-variant-numeric:tabular-nums}:where(.ag-ltr) .ag-right-aligned-cell{text-align:right}:where(.ag-rtl) .ag-right-aligned-cell{text-align:left}.ag-right-aligned-cell .ag-cell-value,.ag-right-aligned-cell .ag-group-value{margin-left:auto}:where(.ag-ltr) .ag-cell:not(.ag-cell-inline-editing),:where(.ag-ltr) .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level));padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}:where(.ag-rtl) .ag-cell:not(.ag-cell-inline-editing),:where(.ag-rtl) .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-row>.ag-cell-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}.ag-row-dragging{cursor:move;opacity:.5}.ag-details-row{background-color:var(--ag-background-color);padding:calc(var(--ag-spacing)*3.75)}.ag-layout-auto-height,.ag-layout-print{.ag-center-cols-container,.ag-center-cols-viewport{min-height:150px}}.ag-overlay-loading-wrapper{background-color:var(--ag-modal-overlay-background-color)}.ag-skeleton-container{align-content:center;height:100%;width:100%}.ag-skeleton-effect{animation:ag-skeleton-loading 1.5s ease-in-out .5s infinite;background-color:var(--ag-row-loading-skeleton-effect-color);border-radius:.25rem;height:1em;width:100%}:where(.ag-ltr) .ag-right-aligned-cell .ag-skeleton-effect{margin-left:auto}:where(.ag-rtl) .ag-right-aligned-cell .ag-skeleton-effect{margin-right:auto}@keyframes ag-skeleton-loading{0%{opacity:1}50%{opacity:.4}to{opacity:1}}.ag-loading{align-items:center;display:flex;height:100%}:where(.ag-ltr) .ag-loading{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-loading{padding-right:var(--ag-cell-horizontal-padding)}:where(.ag-ltr) .ag-loading-icon{padding-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-loading-icon{padding-left:var(--ag-cell-widget-spacing)}.ag-icon-loading{animation-duration:1s;animation-iteration-count:infinite;animation-name:spin;animation-timing-function:linear}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.ag-input-wrapper,.ag-picker-field-wrapper{align-items:center;display:flex;flex:1 1 auto;line-height:normal;position:relative}.ag-input-field{align-items:center;display:flex;flex-direction:row}.ag-input-field-input:where(:not([type=checkbox],[type=radio])){flex:1 1 auto;min-width:0;width:100%}.ag-header{background-color:var(--ag-header-background-color);border-bottom:var(--ag-header-row-border);color:var(--ag-header-text-color);display:flex;font-family:var(--ag-header-font-family);font-size:var(--ag-header-font-size);font-weight:var(--ag-header-font-weight);overflow:hidden;white-space:nowrap;width:100%}.ag-header-row{height:var(--ag-header-height);position:absolute}.ag-floating-filter-button-button,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,:where(.ag-header-cell-sortable) .ag-header-cell-label{cursor:pointer}:where(.ag-ltr) .ag-header-expand-icon{margin-left:4px}:where(.ag-rtl) .ag-header-expand-icon{margin-right:4px}.ag-header-row:where(:not(:first-child)){:where(.ag-header-cell:not(.ag-header-span-height.ag-header-span-total,.ag-header-parent-hidden),.ag-header-group-cell.ag-header-group-cell-with-group){border-top:var(--ag-header-row-border)}}.ag-header-row:where(:not(.ag-header-row-column-group)){overflow:hidden}:where(.ag-header.ag-header-allow-overflow) .ag-header-row{overflow:visible}.ag-header-cell{display:inline-flex;overflow:hidden}.ag-header-group-cell{contain:paint;display:flex}.ag-header-cell,.ag-header-group-cell{align-items:center;gap:var(--ag-cell-widget-spacing);height:100%;padding:0 var(--ag-cell-horizontal-padding);position:absolute}@property --ag-internal-moving-color{syntax:"<color>";inherits:false;initial-value:transparent}@property --ag-internal-hover-color{syntax:"<color>";inherits:false;initial-value:transparent}.ag-header-cell:where(:not(.ag-floating-filter)),.ag-header-group-cell{&:before{background-image:linear-gradient(var(--ag-internal-hover-color),var(--ag-internal-hover-color)),linear-gradient(var(--ag-internal-moving-color),var(--ag-internal-moving-color));content:"";inset:0;position:absolute;--ag-internal-moving-color:transparent;--ag-internal-hover-color:transparent;transition:--ag-internal-moving-color var(--ag-header-cell-background-transition-duration),--ag-internal-hover-color var(--ag-header-cell-background-transition-duration)}&:where(:hover):before{--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}&:where(.ag-header-cell-moving):before{--ag-internal-moving-color:var(--ag-header-cell-moving-background-color);--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}}:where(.ag-header-cell:not(.ag-floating-filter) *,.ag-header-group-cell *){position:relative;z-index:1}.ag-header-cell-menu-button:where(:not(.ag-header-menu-always-show)){opacity:0;transition:opacity .2s}.ag-header-cell-filter-button,:where(.ag-header-cell.ag-header-active) .ag-header-cell-menu-button{opacity:1}.ag-header-cell-label,.ag-header-group-cell-label{align-items:center;align-self:stretch;display:flex;flex:1 1 auto;overflow:hidden;padding:5px 0}:where(.ag-ltr) .ag-sort-indicator-icon{padding-left:var(--ag-spacing)}:where(.ag-rtl) .ag-sort-indicator-icon{padding-right:var(--ag-spacing)}.ag-header-cell-label{text-overflow:ellipsis}.ag-header-group-cell-label.ag-sticky-label{flex:none;max-width:100%;overflow:visible;position:sticky}:where(.ag-ltr) .ag-header-group-cell-label.ag-sticky-label{left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-header-group-cell-label.ag-sticky-label{right:var(--ag-cell-horizontal-padding)}.ag-header-cell-text,.ag-header-group-text{overflow:hidden;text-overflow:ellipsis}.ag-header-cell-text{word-break:break-word}.ag-header-cell-comp-wrapper{width:100%}:where(.ag-header-group-cell) .ag-header-cell-comp-wrapper{display:flex}:where(.ag-header-cell:not(.ag-header-cell-auto-height)) .ag-header-cell-comp-wrapper{align-items:center;display:flex;height:100%}.ag-header-cell-wrap-text .ag-header-cell-comp-wrapper{white-space:normal}.ag-header-cell-comp-wrapper-limited-height>*{overflow:hidden}:where(.ag-right-aligned-header) .ag-header-cell-label{flex-direction:row-reverse}:where(.ag-ltr) :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}:where(.ag-ltr) :where(.ag-header-cell.ag-right-aligned-header){.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-header-cell.ag-right-aligned-header){.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}.ag-header-cell:after,.ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{content:"";height:var(--ag-header-column-border-height);position:absolute;top:calc(50% - var(--ag-header-column-border-height)*.5);z-index:1}:where(.ag-ltr) .ag-header-cell:after,:where(.ag-ltr) .ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{border-right:var(--ag-header-column-border);right:0}:where(.ag-rtl) .ag-header-cell:after,:where(.ag-rtl) .ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{border-left:var(--ag-header-column-border);left:0}.ag-header-highlight-after:after,.ag-header-highlight-before:after{background-color:var(--ag-accent-color);content:"";height:100%;position:absolute;width:1px}:where(.ag-ltr) .ag-header-highlight-before:after{left:0}:where(.ag-rtl) .ag-header-highlight-before:after{right:0}:where(.ag-ltr) .ag-header-highlight-after:after{right:0;:where(.ag-pinned-left-header) &{right:1px}}:where(.ag-rtl) .ag-header-highlight-after:after{left:0;:where(.ag-pinned-left-header) &{left:1px}}.ag-header-cell-resize{align-items:center;cursor:ew-resize;display:flex;height:100%;position:absolute;top:0;width:8px;z-index:2;&:after{background-color:var(--ag-header-column-resize-handle-color);content:"";height:var(--ag-header-column-resize-handle-height);position:absolute;top:calc(50% - var(--ag-header-column-resize-handle-height)*.5);width:var(--ag-header-column-resize-handle-width);z-index:1}}:where(.ag-ltr) .ag-header-cell-resize{right:-3px;&:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}}:where(.ag-rtl) .ag-header-cell-resize{left:-3px;&:after{right:calc(50% - var(--ag-header-column-resize-handle-width))}}:where(.ag-header-cell.ag-header-span-height) .ag-header-cell-resize:after{height:calc(100% - var(--ag-spacing)*4);top:calc(var(--ag-spacing)*2)}.ag-header-group-cell-no-group:where(.ag-header-span-height){display:none}.ag-sort-indicator-container{display:flex;gap:var(--ag-spacing)}.ag-layout-print{&.ag-body{display:block;height:unset}&.ag-root-wrapper{display:inline-block}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:none}&.ag-force-vertical-scroll{overflow-y:visible!important}}@media print{.ag-root-wrapper.ag-layout-print{display:table;.ag-body-horizontal-scroll-viewport,.ag-body-viewport,.ag-center-cols-container,.ag-center-cols-viewport,.ag-root,.ag-root-wrapper-body,.ag-virtual-list-viewport{display:block!important;height:auto!important;overflow:hidden!important}.ag-cell,.ag-row{-moz-column-break-inside:avoid;break-inside:avoid}}}ag-grid,ag-grid-angular{display:block}.ag-chart,.ag-dnd-ghost,.ag-popup,.ag-root-wrapper{cursor:default;line-height:normal;white-space:normal;-webkit-font-smoothing:antialiased;background-color:var(--ag-background-color);color:var(--ag-text-color);color-scheme:var(--ag-browser-color-scheme);font-family:var(--ag-font-family);font-size:var(--ag-font-size);--ag-indentation-level:0}.ag-root-wrapper{border:var(--ag-wrapper-border);border-radius:var(--ag-wrapper-border-radius);display:flex;flex-direction:column;overflow:hidden;position:relative;&.ag-layout-normal{height:100%}}.ag-root-wrapper-body{display:flex;flex-direction:row;&.ag-layout-normal{flex:1 1 auto;height:0;min-height:0}}.ag-root{display:flex;flex-direction:column;position:relative;&.ag-layout-auto-height,&.ag-layout-normal{flex:1 1 auto;overflow:hidden;width:0}&.ag-layout-normal{height:100%}}.ag-drag-handle{color:var(--ag-drag-handle-color);cursor:grab}.ag-list-item,.ag-virtual-list-item{height:var(--ag-list-item-height)}.ag-virtual-list-item{position:absolute;width:100%}.ag-select-list{background-color:var(--ag-picker-list-background-color);border:var(--ag-picker-list-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);overflow:hidden auto}.ag-list-item{align-items:center;display:flex;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;&.ag-active-item{background-color:var(--ag-row-hover-color)}}.ag-select-list-item{cursor:default;-webkit-user-select:none;-moz-user-select:none;user-select:none;:where(span){overflow:hidden;text-overflow:ellipsis;white-space:nowrap}}:where(.ag-ltr) .ag-select-list-item{padding-left:calc(var(--ag-cell-horizontal-padding)/2)}:where(.ag-rtl) .ag-select-list-item{padding-right:calc(var(--ag-cell-horizontal-padding)/2)}.ag-list-item-hovered:after{background-color:var(--ag-accent-color);content:"";height:1px;left:0;position:absolute;right:0}.ag-item-highlight-top:after{top:0}.ag-item-highlight-bottom:after{bottom:0}:where(.ag-icon):before{align-items:center;background-color:currentcolor;color:inherit;content:"";display:flex;font-family:inherit;font-size:var(--ag-icon-size);font-style:normal;font-variant:normal;height:var(--ag-icon-size);justify-content:center;line-height:var(--ag-icon-size);-webkit-mask-size:contain;mask-size:contain;text-transform:none;width:var(--ag-icon-size)}.ag-icon{background-position:50%;background-repeat:no-repeat;background-size:contain;color:var(--ag-icon-color);display:block;height:var(--ag-icon-size);position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:var(--ag-icon-size)}.ag-column-select-column-group-readonly,.ag-column-select-column-readonly,.ag-disabled,[disabled]{.ag-icon{opacity:.5}&.ag-icon-grip{opacity:.35}}.ag-column-select-column-readonly{&.ag-icon-grip,.ag-icon-grip{opacity:.35}}.ag-chart-menu-icon,.ag-chart-settings-next,.ag-chart-settings-prev,.ag-column-group-icons,.ag-column-select-header-icon,.ag-filter-toolpanel-expand,.ag-floating-filter-button-button,.ag-group-title-bar-icon,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,.ag-panel-title-bar-button-icon,.ag-set-filter-group-icons,:where(.ag-group-contracted) .ag-icon,:where(.ag-group-expanded) .ag-icon{background-color:var(--ag-icon-button-background-color);border-radius:var(--ag-icon-button-border-radius);box-shadow:0 0 0 var(--ag-icon-button-background-spread) var(--ag-icon-button-background-color);color:var(--ag-icon-button-color);&:hover{background-color:var(--ag-icon-button-hover-background-color);box-shadow:0 0 0 var(--ag-icon-button-background-spread) var(--ag-icon-button-hover-background-color);color:var(--ag-icon-button-hover-color)}}.ag-filter-active{background-image:linear-gradient(var(--ag-icon-button-active-background-color),var(--ag-icon-button-active-background-color));border-radius:1px;outline:solid var(--ag-icon-button-background-spread) var(--ag-icon-button-active-background-color);position:relative;&:after{background-color:var(--ag-accent-color);border-radius:50%;content:"";height:6px;position:absolute;top:-1px;width:6px}:where(.ag-icon-filter){clip-path:path("M8,0C8,4.415 11.585,8 16,8L16,16L0,16L0,0L8,0Z");color:var(--ag-icon-button-active-color)}}:where(.ag-ltr) .ag-filter-active{&:after{right:-1px}}:where(.ag-rtl) .ag-filter-active{&:after{left:-1px}}.ag-menu{background-color:var(--ag-menu-background-color);border:var(--ag-menu-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-menu-shadow);color:var(--ag-menu-text-color);max-height:100%;overflow-y:auto}.ag-menu,.ag-resizer{position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-resizer{pointer-events:none;z-index:1}:where(.ag-resizer){&.ag-resizer-topLeft{cursor:nwse-resize;height:5px;left:0;top:0;width:5px}&.ag-resizer-top{cursor:ns-resize;height:5px;left:5px;right:5px;top:0}&.ag-resizer-topRight{cursor:nesw-resize;height:5px;right:0;top:0;width:5px}&.ag-resizer-right{bottom:5px;cursor:ew-resize;right:0;top:5px;width:5px}&.ag-resizer-bottomRight{bottom:0;cursor:nwse-resize;height:5px;right:0;width:5px}&.ag-resizer-bottom{bottom:0;cursor:ns-resize;height:5px;left:5px;right:5px}&.ag-resizer-bottomLeft{bottom:0;cursor:nesw-resize;height:5px;left:0;width:5px}&.ag-resizer-left{bottom:5px;cursor:ew-resize;left:0;top:5px;width:5px}}',MN=typeof window!="object"||!window?.document?.fonts?.forEach,hT=new WeakMap,Wp=(e,t,n,i,r,s)=>{if(MN)return;i&&(e=`@layer ${CSS.escape(i)} { ${e} }`);let o=hT.get(t);if(o||(o=[],hT.set(t,o)),o.find(c=>c.css===e))return;const a=document.createElement("style");s&&a.setAttribute("nonce",s),a.dataset.agGlobalCss=n,a.textContent=e;const l={css:e,el:a,priority:r};let u;for(const c of o){if(c.priority>r)break;u=c}if(u){u.el.insertAdjacentElement("afterend",a);const c=o.indexOf(u);o.splice(c+1,0,l)}else t.insertBefore(a,t.querySelector(":not(title, meta)")),o.push(l)},Lte=(e,t,n)=>{Wp(y7e,e,"core",t,0,n),Array.from(kWe()).sort((i,r)=>i.moduleName.localeCompare(r.moduleName)).forEach(i=>i.css?.forEach(r=>Wp(r,e,`module-${i.moduleName}`,t,0,n)))},fT=new Set,w7e=e=>{fT.add(e)},b7e=e=>{if(fT.delete(e),fT.size===0){hT=new WeakMap;for(const t of document.head.querySelectorAll("style[data-ag-global-css]"))t.remove()}},ql=e=>new Nte(e),Mu="$default",S7e=0,Nte=class{constructor({feature:e,params:t,modeParams:n={},css:i,cssImports:r}){this.feature=e,this.css=i,this.cssImports=r,this.modeParams={[Mu]:{...n[Mu]??{},...t??{}},...n}}use(e,t,n){let i=this._inject;if(i==null){let{css:r}=this;if(r){const s=`ag-theme-${this.feature??"part"}-${++S7e}`;typeof r=="function"&&(r=r()),r=`:where(.${s}) {
${r}
}
`;for(const o of this.cssImports??[])r=`@import url(${JSON.stringify(o)});
${r}`;i={css:r,class:s}}else i=!1;this._inject=i}return i&&e&&Wp(i.css,e,i.class,t,1,n),i?i.class:!1}},x7e=e=>e.replace(/[A-Z]/g,t=>`-${t}`).toLowerCase(),$te=e=>`--ag-${x7e(e)}`,_a=e=>`var(${$te(e)})`,R7e=(e,t,n)=>Math.max(t,Math.min(n,e)),E7e=e=>{const t=new Map;return n=>{const i=n;return t.has(i)||t.set(i,e(n)),t.get(i)}},ra=e=>({ref:"accentColor",mix:e}),Es=e=>({ref:"foregroundColor",mix:e}),bo=e=>({ref:"foregroundColor",mix:e,onto:"backgroundColor"}),F7e=e=>({ref:"foregroundColor",mix:e,onto:"headerBackgroundColor"}),Jr={ref:"backgroundColor"},km={ref:"foregroundColor"},Iu={ref:"accentColor"},S1={backgroundColor:"#fff",foregroundColor:"#181d1f",borderColor:Es(.15),chromeBackgroundColor:bo(.02),browserColorScheme:"light"},A7e={...S1,textColor:km,accentColor:"#2196f3",invalidColor:"#e02525",wrapperBorder:!0,rowBorder:!0,headerRowBorder:!0,footerRowBorder:{ref:"rowBorder"},columnBorder:{style:"solid",width:1,color:"transparent"},headerColumnBorder:!1,headerColumnBorderHeight:"100%",pinnedColumnBorder:!0,pinnedRowBorder:!0,sidePanelBorder:!0,sideBarPanelWidth:250,sideBarBackgroundColor:{ref:"chromeBackgroundColor"},sideButtonBarBackgroundColor:{ref:"sideBarBackgroundColor"},sideButtonBarTopPadding:0,sideButtonSelectedUnderlineWidth:2,sideButtonSelectedUnderlineColor:"transparent",sideButtonSelectedUnderlineTransitionDuration:0,sideButtonBackgroundColor:"transparent",sideButtonTextColor:{ref:"textColor"},sideButtonHoverBackgroundColor:{ref:"sideButtonBackgroundColor"},sideButtonHoverTextColor:{ref:"sideButtonTextColor"},sideButtonSelectedBackgroundColor:Jr,sideButtonSelectedTextColor:{ref:"sideButtonTextColor"},sideButtonBorder:"solid 1px transparent",sideButtonSelectedBorder:!0,sideButtonLeftPadding:{ref:"spacing"},sideButtonRightPadding:{ref:"spacing"},sideButtonVerticalPadding:{calc:"spacing * 3"},fontFamily:["-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu","Cantarell","Helvetica Neue","sans-serif"],headerBackgroundColor:{ref:"chromeBackgroundColor"},headerFontFamily:{ref:"fontFamily"},cellFontFamily:{ref:"fontFamily"},headerFontWeight:500,headerFontSize:{ref:"fontSize"},dataFontSize:{ref:"fontSize"},headerTextColor:{ref:"textColor"},headerCellHoverBackgroundColor:"transparent",headerCellMovingBackgroundColor:{ref:"headerCellHoverBackgroundColor"},headerCellBackgroundTransitionDuration:"0.2s",cellTextColor:{ref:"textColor"},subtleTextColor:{ref:"textColor",mix:.5},rangeSelectionBorderStyle:"solid",rangeSelectionBorderColor:Iu,rangeSelectionBackgroundColor:ra(.2),rangeSelectionChartBackgroundColor:"#0058FF1A",rangeSelectionChartCategoryBackgroundColor:"#00FF841A",rangeSelectionHighlightColor:ra(.5),rangeHeaderHighlightColor:F7e(.08),rowNumbersSelectedColor:ra(.5),rowHoverColor:ra(.08),columnHoverColor:ra(.05),selectedRowBackgroundColor:ra(.12),modalOverlayBackgroundColor:{ref:"backgroundColor",mix:.66},oddRowBackgroundColor:Jr,borderRadius:4,wrapperBorderRadius:8,cellHorizontalPadding:{calc:"spacing * 2 * cellHorizontalPaddingScale"},cellWidgetSpacing:{calc:"spacing * 1.5"},cellHorizontalPaddingScale:1,rowGroupIndentSize:{calc:"cellWidgetSpacing + iconSize"},valueChangeDeltaUpColor:"#43a047",valueChangeDeltaDownColor:"#e53935",valueChangeValueHighlightBackgroundColor:"#16a08580",spacing:8,fontSize:14,rowHeight:{calc:"max(iconSize, dataFontSize) + spacing * 3.25 * rowVerticalPaddingScale"},rowVerticalPaddingScale:1,headerHeight:{calc:"max(iconSize, dataFontSize) + spacing * 4 * headerVerticalPaddingScale"},headerVerticalPaddingScale:1,popupShadow:"0 0 16px #00000026",cardShadow:"0 1px 4px 1px #00000018",dropdownShadow:{ref:"cardShadow"},dragAndDropImageBackgroundColor:Jr,dragAndDropImageBorder:!0,dragAndDropImageShadow:{ref:"popupShadow"},dragHandleColor:Es(.7),focusShadow:{spread:3,color:ra(.5)},headerColumnResizeHandleHeight:"30%",headerColumnResizeHandleWidth:2,headerColumnResizeHandleColor:{ref:"borderColor"},widgetContainerHorizontalPadding:{calc:"spacing * 1.5"},widgetContainerVerticalPadding:{calc:"spacing * 1.5"},widgetHorizontalSpacing:{calc:"spacing * 1.5"},widgetVerticalSpacing:{ref:"spacing"},listItemHeight:{calc:"max(iconSize, dataFontSize) + widgetVerticalSpacing"},iconSize:16,iconColor:"inherit",iconButtonColor:{ref:"iconColor"},iconButtonBackgroundColor:"transparent",iconButtonBackgroundSpread:4,iconButtonBorderRadius:1,iconButtonHoverColor:{ref:"iconButtonColor"},iconButtonHoverBackgroundColor:Es(.1),iconButtonActiveColor:Iu,iconButtonActiveBackgroundColor:ra(.28),iconButtonActiveIndicatorColor:Iu,toggleButtonWidth:28,toggleButtonHeight:18,toggleButtonOnBackgroundColor:Iu,toggleButtonOffBackgroundColor:bo(.3),toggleButtonSwitchBackgroundColor:Jr,toggleButtonSwitchInset:2,menuBorder:{color:Es(.2)},menuBackgroundColor:bo(.03),menuTextColor:bo(.95),menuShadow:{ref:"popupShadow"},menuSeparatorColor:{ref:"borderColor"},setFilterIndentSize:{ref:"iconSize"},chartMenuPanelWidth:260,chartMenuLabelColor:Es(.8),dialogShadow:{ref:"popupShadow"},cellEditingBorder:{color:Iu},cellEditingShadow:{ref:"cardShadow"},dialogBorder:{color:Es(.2)},panelBackgroundColor:Jr,panelTitleBarBackgroundColor:{ref:"headerBackgroundColor"},panelTitleBarIconColor:{ref:"headerTextColor"},panelTitleBarTextColor:{ref:"headerTextColor"},panelTitleBarFontWeight:{ref:"headerFontWeight"},panelTitleBarBorder:!0,columnSelectIndentSize:{ref:"iconSize"},toolPanelSeparatorBorder:!0,tooltipBackgroundColor:{ref:"chromeBackgroundColor"},tooltipTextColor:{ref:"textColor"},tooltipBorder:!0,columnDropCellBackgroundColor:Es(.07),columnDropCellTextColor:{ref:"textColor"},columnDropCellDragHandleColor:{ref:"textColor"},columnDropCellBorder:{color:Es(.13)},selectCellBackgroundColor:Es(.07),selectCellBorder:{color:Es(.13)},advancedFilterBuilderButtonBarBorder:!0,advancedFilterBuilderIndentSize:{calc:"spacing * 2 + iconSize"},advancedFilterBuilderJoinPillColor:"#f08e8d",advancedFilterBuilderColumnPillColor:"#a6e194",advancedFilterBuilderOptionPillColor:"#f3c08b",advancedFilterBuilderValuePillColor:"#85c0e4",findMatchColor:km,findMatchBackgroundColor:"#ffff00",findActiveMatchColor:km,findActiveMatchBackgroundColor:"#ffa500",filterToolPanelGroupIndent:{ref:"spacing"},rowLoadingSkeletonEffectColor:Es(.15),statusBarLabelColor:km,statusBarLabelFontWeight:500,statusBarValueColor:km,statusBarValueFontWeight:500},D7e=":where(.ag-button){background:none;border:none;color:inherit;cursor:pointer;font-family:inherit;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0;text-indent:inherit;text-shadow:inherit;text-transform:inherit;word-spacing:inherit;&:disabled{cursor:default}&:focus-visible{box-shadow:var(--ag-focus-shadow);outline:none}}.ag-standard-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:var(--ag-button-background-color);border:var(--ag-button-border);border-radius:var(--ag-button-border-radius);color:var(--ag-button-text-color);cursor:pointer;font-weight:var(--ag-button-font-weight);padding:var(--ag-button-vertical-padding) var(--ag-button-horizontal-padding);&:hover{background-color:var(--ag-button-hover-background-color);border:var(--ag-button-hover-border);color:var(--ag-button-hover-text-color)}&:active{background-color:var(--ag-button-active-background-color);border:var(--ag-button-active-border);color:var(--ag-button-active-text-color)}&:disabled{background-color:var(--ag-button-disabled-background-color);border:var(--ag-button-disabled-border);color:var(--ag-button-disabled-text-color)}}",k7e={buttonTextColor:"inherit",buttonFontWeight:"normal",buttonBackgroundColor:"transparent",buttonBorder:!1,buttonBorderRadius:{ref:"borderRadius"},buttonHorizontalPadding:{calc:"spacing * 2"},buttonVerticalPadding:{ref:"spacing"},buttonHoverTextColor:{ref:"buttonTextColor"},buttonHoverBackgroundColor:{ref:"buttonBackgroundColor"},buttonHoverBorder:{ref:"buttonBorder"},buttonActiveTextColor:{ref:"buttonHoverTextColor"},buttonActiveBackgroundColor:{ref:"buttonHoverBackgroundColor"},buttonActiveBorder:{ref:"buttonHoverBorder"},buttonDisabledTextColor:{ref:"inputDisabledTextColor"},buttonDisabledBackgroundColor:{ref:"inputDisabledBackgroundColor"},buttonDisabledBorder:{ref:"inputDisabledBorder"}},P7e=()=>ql({feature:"buttonStyle",params:{...k7e,buttonBackgroundColor:Jr,buttonBorder:!0,buttonHoverBackgroundColor:{ref:"rowHoverColor"},buttonActiveBorder:{color:Iu}},css:D7e}),M7e=P7e(),T7e=".ag-column-drop-vertical-empty-message{align-items:center;border:1px dashed;border-color:var(--ag-border-color);display:flex;inset:0;justify-content:center;margin:calc(var(--ag-spacing)*1.5) calc(var(--ag-spacing)*2);overflow:hidden;padding:calc(var(--ag-spacing)*2);position:absolute}",I7e=()=>ql({feature:"columnDropStyle",css:T7e}),Bte=I7e(),_7e=["colorScheme","color","length","scale","borderStyle","border","shadow","image","fontFamily","fontWeight","duration"],O7e=E7e(e=>(e=e.toLowerCase(),_7e.find(t=>e.endsWith(t.toLowerCase()))??"length")),YR=e=>typeof e=="object"&&e?.ref?_a(e.ref):typeof e=="string"?e:typeof e=="number"?String(e):!1,TN=e=>{if(typeof e=="string")return e;if(e&&"ref"in e){const t=_a(e.ref);return e.mix==null?t:`color-mix(in srgb, ${e.onto?_a(e.onto):"transparent"}, ${t} ${R7e(e.mix*100,0,100)}%)`}return!1},L7e=YR,If=e=>typeof e=="string"?e:typeof e=="number"?`${e}px`:e&&"calc"in e?`calc(${e.calc.replace(/ ?[*/+] ?/g," $& ").replace(/-?\b[a-z][a-z0-9]*\b(?![-(])/gi,n=>n[0]==="-"?n:` ${_a(n)} `)})`:e&&"ref"in e?_a(e.ref):!1,N7e=YR,$7e=(e,t)=>typeof e=="string"?e:e===!0?"solid 1px var(--ag-border-color)":e===!1?t==="columnBorder"?"solid 1px transparent":"none":e&&"ref"in e?_a(e.ref):Gte(e.style??"solid")+" "+If(e.width??1)+" "+TN(e.color??{ref:"borderColor"}),B7e=e=>typeof e=="string"?e:e===!1?"none":e&&"ref"in e?_a(e.ref):[If(e.offsetX??0),If(e.offsetY??0),If(e.radius??0),If(e.spread??0),TN(e.color??{ref:"foregroundColor"})].join(" "),Gte=YR,zte=e=>typeof e=="string"?e.includes(",")?e:$W(e):e&&"googleFont"in e?zte(e.googleFont):e&&"ref"in e?_a(e.ref):Array.isArray(e)?e.map(t=>(typeof t=="object"&&"googleFont"in t&&(t=t.googleFont),$W(t))).join(", "):!1,$W=e=>/^[\w-]+$|\w\(/.test(e)?e:JSON.stringify(e),G7e=YR,Hte=e=>typeof e=="string"?e:e&&"url"in e?`url(${JSON.stringify(e.url)})`:e&&"svg"in e?Hte({url:`data:image/svg+xml,${encodeURIComponent(e.svg)}`}):e&&"ref"in e?_a(e.ref):!1,z7e=(e,t)=>typeof e=="string"?e:typeof e=="number"?(e>=10&&Ft(104,{value:e,param:t}),`${e}s`):e&&"ref"in e?_a(e.ref):!1,H7e={color:TN,colorScheme:L7e,length:If,scale:N7e,border:$7e,borderStyle:Gte,shadow:B7e,image:Hte,fontFamily:zte,fontWeight:G7e,duration:z7e},V7e=(e,t)=>{const n=O7e(e);return H7e[n](t,e)},W7e=()=>new Vte().withPart(M7e).withPart(Bte),Vte=class Wte{constructor(t=[]){this.parts=t}withPart(t){return typeof t=="function"&&(t=t()),t instanceof Nte?new Wte([...this.parts,t]):(tT(259,{part:t},"Invalid part"),this)}withoutPart(t){return this.withPart(ql({feature:t}))}withParams(t,n=Mu){return this.withPart(ql({modeParams:{[n]:t}}))}_startUse({styleContainer:t,cssLayer:n,nonce:i,loadThemeGoogleFonts:r}){if(MN)return;q7e(),Lte(t,n,i);const s=U7e(this);if(s.length>0)for(const o of s)r&&K7e(o,i);for(const o of this.parts)o.use(t,n,i)}_getCssClass(){return this._cssClassCache??(this._cssClassCache=BW(this.parts).map(t=>t.use(void 0,void 0,void 0)).filter(Boolean).join(" "))}_getModeParams(){let t=this._paramsCache;if(!t){const n={[Mu]:{...A7e}};for(const i of BW(this.parts))for(const r of Object.keys(i.modeParams)){const s=i.modeParams[r];if(s){const o=n[r]??(n[r]={}),a=new Set;for(const l of Object.keys(s)){const u=s[l];u!==void 0&&(o[l]=u,a.add(l))}if(r===Mu)for(const l of Object.keys(n)){const u=n[l];if(l!==Mu)for(const c of a)delete u[c]}}}this._paramsCache=t=n}return t}_getPerGridCss(t){const n="##SELECTOR##";let i=this._paramsCssCache;if(!i){let r="",s="";const o=this._getModeParams();for(const l of Object.keys(o)){const u=o[l];if(l!==Mu){const d=`:where([data-ag-theme-mode="${typeof CSS=="object"?CSS.escape(l):l}"]) & {
`;r+=d,s+=d}for(const c of Object.keys(u).sort()){const d=u[c],h=V7e(c,d);if(h===!1)Ft(107,{key:c,value:d});else{const p=$te(c),g=p.replace("--ag-","--ag-inherited-");r+=`	${p}: var(${g}, ${h});
`,s+=`	${g}: var(${p});
`}}l!==Mu&&(r+=`}
`,s+=`}
`)}let a=`${n} {
${r}}
`;a+=`:has(> ${n}):not(${n}) {
${s}}
`,this._paramsCssCache=i=a}return i.replaceAll(n,`:where(.${t})`)}},BW=e=>{const t=new Map;for(const i of e)t.set(i.feature,i);const n=[];for(const i of e)(!i.feature||t.get(i.feature)===i)&&n.push(i);return n},U7e=e=>{const t=new Set,n=s=>{if(Array.isArray(s))s.forEach(n);else{const o=s?.googleFont;typeof o=="string"&&t.add(o)}};return Object.values(e._getModeParams()).flatMap(s=>Object.values(s)).forEach(n),Array.from(t).sort()},GW=!1,q7e=()=>{if(!GW){GW=!0;for(const e of Array.from(document.head.querySelectorAll('style[data-ag-scope="legacy"]')))e.remove()}},j7e=new Set,K7e=async(e,t)=>{j7e.add(e);const n=`@import url('https://${Y7e}/css2?family=${encodeURIComponent(e)}:wght@100;200;300;400;500;600;700;800;900&display=swap');
`;Wp(n,document.head,`googleFont:${e}`,void 0,0,t)},Y7e="fonts.googleapis.com",X7e='.ag-checkbox-input-wrapper,.ag-radio-button-input-wrapper{background-color:var(--ag-checkbox-unchecked-background-color);border:solid var(--ag-checkbox-border-width) var(--ag-checkbox-unchecked-border-color);flex:none;height:var(--ag-icon-size);position:relative;width:var(--ag-icon-size);:where(input){-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:block;height:var(--ag-icon-size);margin:0;opacity:0;width:var(--ag-icon-size)}&:after{content:"";display:block;inset:0;-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;pointer-events:none;position:absolute}&:where(.ag-checked){background-color:var(--ag-checkbox-checked-background-color);border-color:var(--ag-checkbox-checked-border-color);&:after{background-color:var(--ag-checkbox-checked-shape-color)}}&:where(:focus-within,:active){box-shadow:var(--ag-focus-shadow)}&:where(.ag-disabled){filter:grayscale();opacity:.5}}.ag-checkbox-input-wrapper{border-radius:var(--ag-checkbox-border-radius);&:where(.ag-checked):after{-webkit-mask-image:var(--ag-checkbox-checked-shape-image);mask-image:var(--ag-checkbox-checked-shape-image)}&:where(.ag-indeterminate){background-color:var(--ag-checkbox-indeterminate-background-color);border-color:var(--ag-checkbox-indeterminate-border-color);&:after{background-color:var(--ag-checkbox-indeterminate-shape-color);-webkit-mask-image:var(--ag-checkbox-indeterminate-shape-image);mask-image:var(--ag-checkbox-indeterminate-shape-image)}}}.ag-radio-button-input-wrapper{border-radius:100%;&:where(.ag-checked):after{-webkit-mask-image:var(--ag-radio-checked-shape-image);mask-image:var(--ag-radio-checked-shape-image)}}',Q7e=()=>ql({feature:"checkboxStyle",params:{checkboxBorderWidth:1,checkboxBorderRadius:{ref:"borderRadius"},checkboxUncheckedBackgroundColor:Jr,checkboxUncheckedBorderColor:bo(.3),checkboxCheckedBackgroundColor:Iu,checkboxCheckedBorderColor:{ref:"checkboxCheckedBackgroundColor"},checkboxCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="7" fill="none"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.75" d="M1 3.5 3.5 6l5-5"/></svg>'},checkboxCheckedShapeColor:Jr,checkboxIndeterminateBackgroundColor:bo(.3),checkboxIndeterminateBorderColor:{ref:"checkboxIndeterminateBackgroundColor"},checkboxIndeterminateShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="2" fill="none"><rect width="10" height="2" fill="#000" rx="1"/></svg>'},checkboxIndeterminateShapeColor:Jr,radioCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="6" height="6" fill="none"><circle cx="3" cy="3" r="3" fill="#000"/></svg>'}},css:X7e}),Z7e=Q7e(),Ute=()=>({...S1,backgroundColor:"hsl(217, 0%, 17%)",foregroundColor:"#FFF",chromeBackgroundColor:bo(.05),rowHoverColor:ra(.15),selectedRowBackgroundColor:ra(.2),menuBackgroundColor:bo(.1),browserColorScheme:"dark",popupShadow:"0 0px 20px #000A",cardShadow:"0 1px 4px 1px #000A",advancedFilterBuilderJoinPillColor:"#7a3a37",advancedFilterBuilderColumnPillColor:"#355f2d",advancedFilterBuilderOptionPillColor:"#5a3168",advancedFilterBuilderValuePillColor:"#374c86",findMatchColor:Jr,findActiveMatchColor:Jr,checkboxUncheckedBorderColor:bo(.4),toggleButtonOffBackgroundColor:bo(.4)}),J7e=()=>({...Ute(),backgroundColor:"#1f2836"}),eqe=()=>ql({feature:"colorScheme",params:S1,modeParams:{light:S1,dark:Ute(),"dark-blue":J7e()}}),tqe=eqe(),qte={aggregation:'<path d="M18 7V4H6l6 8-6 8h12v-3"/>',arrows:'<polyline points="5 9 2 12 5 15"/><polyline points="9 5 12 2 15 5"/><polyline points="15 19 12 22 9 19"/><polyline points="19 9 22 12 19 15"/><line x1="2" x2="22" y1="12" y2="12"/><line x1="12" x2="12" y1="2" y2="22"/>',asc:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>',cancel:'<path d="m18 6-12 12"/><path d="m6 6 12 12"/>',chart:'<line x1="18" x2="18" y1="20" y2="10"/><line x1="12" x2="12" y1="20" y2="4"/><line x1="6" x2="6" y1="20" y2="14"/>',"color-picker":'<path d="m19 11-8-8-8.6 8.6a2 2 0 0 0 0 2.8l5.2 5.2c.8.8 2 .8 2.8 0L19 11Z"/><path d="m5 2 5 5"/><path d="M2 13h15"/><path d="M22 20a2 2 0 1 1-4 0c0-1.6 1.7-2.4 2-4 .3 1.6 2 2.4 2 4Z"/>',columns:'<path d="M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18"/>',contracted:'<path d="m9 18 6-6-6-6"/>',copy:'<rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/>',cross:'<path d="M18 6 6 18"/><path d="m6 6 12 12"/>',csv:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',cut:'<circle cx="6" cy="6" r="3"/><path d="M8.12 8.12 12 12"/><path d="M20 4 8.12 15.88"/><circle cx="6" cy="18" r="3"/><path d="M14.8 14.8 20 20"/>',desc:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',down:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',excel:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',expanded:'<path d="m15 18-6-6 6-6"/>',"eye-slash":'<path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"/><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"/><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"/><line x1="2" x2="22" y1="2" y2="22"/>',eye:'<path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/>',filter:'<path d="M3 6h18"/><path d="M7 12h10"/><path d="M10 18h4"/>',first:'<path d="m17 18-6-6 6-6"/><path d="M7 6v12"/>',group:'<path d="M16 12H3"/><path d="M16 18H3"/><path d="M10 6H3"/><path d="M21 18V8a2 2 0 0 0-2-2h-5"/><path d="m16 8-2-2 2-2"/>',last:'<path d="m7 18 6-6-6-6"/><path d="M17 6v12"/>',left:'<path d="m12 19-7-7 7-7"/><path d="M19 12H5"/>',linked:'<path d="M9 17H7A5 5 0 0 1 7 7h2"/><path d="M15 7h2a5 5 0 1 1 0 10h-2"/><line x1="8" x2="16" y1="12" y2="12"/>',loading:'<line x1="12" x2="12" y1="2" y2="6"/><line x1="12" x2="12" y1="18" y2="22"/><line x1="4.93" x2="7.76" y1="4.93" y2="7.76"/><line x1="16.24" x2="19.07" y1="16.24" y2="19.07"/><line x1="2" x2="6" y1="12" y2="12"/><line x1="18" x2="22" y1="12" y2="12"/><line x1="4.93" x2="7.76" y1="19.07" y2="16.24"/><line x1="16.24" x2="19.07" y1="7.76" y2="4.93"/>',maximize:'<polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" x2="14" y1="3" y2="10"/><line x1="3" x2="10" y1="21" y2="14"/>',menu:'<line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/>',"menu-alt":'<circle cx="12" cy="5" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="12" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="19" r="0.75" fill="#D9D9D9"/>',minimize:'<polyline points="4 14 10 14 10 20"/><polyline points="20 10 14 10 14 4"/><line x1="14" x2="21" y1="10" y2="3"/><line x1="3" x2="10" y1="21" y2="14"/>',minus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/>',next:'<path d="m9 18 6-6-6-6"/>',none:'<path d="m7 15 5 5 5-5"/><path d="m7 9 5-5 5 5"/>',"not-allowed":'<circle cx="12" cy="12" r="10"/><path d="m4.9 4.9 14.2 14.2"/>',paste:'<path d="M15 2H9a1 1 0 0 0-1 1v2c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V3c0-.6-.4-1-1-1Z"/><path d="M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2M16 4h2a2 2 0 0 1 2 2v2M11 14h10"/><path d="m17 10 4 4-4 4"/>',pin:'<line x1="12" x2="12" y1="17" y2="22"/><path d="M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z"/>',pivot:'<path d="M15 3v18"/><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M21 9H3"/><path d="M21 15H3"/>',plus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/><path d="M12 8v8"/>',previous:'<path d="m15 18-6-6 6-6"/>',right:'<path d="M5 12h14"/><path d="m12 5 7 7-7 7"/>',save:'<path d="M12 17V3"/><path d="m6 11 6 6 6-6"/><path d="M19 21H5"/>',"small-left":'<path d="m15 18-6-6 6-6"/>',"small-right":'<path d="m9 18 6-6-6-6"/>',tick:'<path d="M20 6 9 17l-5-5"/>',"tree-closed":'<path d="m9 18 6-6-6-6"/>',"tree-indeterminate":'<path d="M5 12h14"/>',"tree-open":'<path d="m6 9 6 6 6-6"/>',unlinked:'<path d="M9 17H7A5 5 0 0 1 7 7"/><path d="M15 7h2a5 5 0 0 1 4 8"/><line x1="8" x2="12" y1="12" y2="12"/><line x1="2" x2="22" y1="2" y2="22"/>',up:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>',grip:'<circle cx="5" cy="8" r="0.5"/><circle cx="12" cy="8" r="0.5"/><circle cx="19" cy="8" r="0.5"/><circle cx="5" cy="16" r="0.5"/><circle cx="12" cy="16" r="0.5"/><circle cx="19" cy="16" r="0.5"/><g stroke="none" fill="currentColor"><circle cx="5" cy="8" r="1"/><circle cx="12" cy="8" r="1"/><circle cx="19" cy="8" r="1"/><circle cx="5" cy="16" r="1"/><circle cx="12" cy="16" r="1"/><circle cx="19" cy="16" r="1"/></g>',settings:'<path d="M20 7h-9"/><path d="M14 17H5"/><circle cx="17" cy="17" r="3"/><circle cx="7" cy="7" r="3"/>'},jte={"small-down":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="black" stroke="none" viewBox="0 0 32 32"><path d="M7.334 10.667 16 21.334l8.667-10.667H7.334Z"/></svg>',"small-up":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="black" stroke="none" viewBox="0 0 32 32"><path d="M7.334 21.333 16 10.666l8.667 10.667H7.334Z"/></svg>'},nqe=(e={})=>{let t="";for(const n of[...Object.keys(qte),...Object.keys(jte)]){const i=iqe(n,e.strokeWidth);t+=`.ag-icon-${n}::before { mask-image: url('data:image/svg+xml,${encodeURIComponent(i)}'); }
`}return t},iqe=(e,t=1.5)=>{const n=jte[e];if(n)return n;const i=qte[e];if(!i)throw new Error(`Missing icon data for ${e}`);return`<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="black" stroke-width="${t}" viewBox="0 0 24 24"><style>* { vector-effect: non-scaling-stroke; }</style>`+i+"</svg>"},rqe=(e={})=>ql({feature:"iconSet",css:()=>nqe(e)}),sqe=rqe(),oqe=':where(.ag-input-field-input[type=number]:not(.ag-number-field-input-stepper)){-webkit-appearance:textfield;-moz-appearance:textfield;appearance:textfield;&::-webkit-inner-spin-button,&::-webkit-outer-spin-button{-webkit-appearance:none;appearance:none;margin:0}}:where(input.ag-input-field-input:not([type]),input.ag-input-field-input[type=text],input.ag-input-field-input[type=number],input.ag-input-field-input[type=tel],input.ag-input-field-input[type=date],input.ag-input-field-input[type=datetime-local],textarea.ag-input-field-input){background-color:var(--ag-input-background-color);border:var(--ag-input-border);border-radius:var(--ag-input-border-radius);color:var(--ag-input-text-color);font-family:inherit;font-size:inherit;line-height:inherit;margin:0;min-height:var(--ag-input-height);padding:0;&:where(:disabled){background-color:var(--ag-input-disabled-background-color);border:var(--ag-input-disabled-border);color:var(--ag-input-disabled-text-color)}&:where(:focus){background-color:var(--ag-input-focus-background-color);border:var(--ag-input-focus-border);box-shadow:var(--ag-input-focus-shadow);color:var(--ag-input-focus-text-color);outline:none}&:where(:invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&:where(.invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&::-moz-placeholder{color:var(--ag-input-placeholder-text-color)}&::placeholder{color:var(--ag-input-placeholder-text-color)}}:where(.ag-ltr) :where(input.ag-input-field-input:not([type]),input.ag-input-field-input[type=text],input.ag-input-field-input[type=number],input.ag-input-field-input[type=tel],input.ag-input-field-input[type=date],input.ag-input-field-input[type=datetime-local],textarea.ag-input-field-input){padding-left:var(--ag-input-padding-start)}:where(.ag-rtl) :where(input.ag-input-field-input:not([type]),input.ag-input-field-input[type=text],input.ag-input-field-input[type=number],input.ag-input-field-input[type=tel],input.ag-input-field-input[type=date],input.ag-input-field-input[type=datetime-local],textarea.ag-input-field-input){padding-right:var(--ag-input-padding-start)}:where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter){.ag-input-wrapper:before{background-color:currentcolor;color:var(--ag-input-icon-color);content:"";display:block;height:12px;-webkit-mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;opacity:.5;position:absolute;width:12px}}:where(.ag-ltr) :where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter){.ag-input-wrapper:before{margin-left:var(--ag-spacing)}.ag-number-field-input,.ag-text-field-input{padding-left:calc(var(--ag-spacing)*1.5 + 12px)}}:where(.ag-rtl) :where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter){.ag-input-wrapper:before{margin-right:var(--ag-spacing)}.ag-number-field-input,.ag-text-field-input{padding-right:calc(var(--ag-spacing)*1.5 + 12px)}}',aqe=":where(input.ag-input-field-input:not([type]),input.ag-input-field-input[type=text],input.ag-input-field-input[type=number],input.ag-input-field-input[type=tel],input.ag-input-field-input[type=date],input.ag-input-field-input[type=datetime-local],textarea.ag-input-field-input){&:focus{box-shadow:var(--ag-focus-shadow)}}",lqe={inputBackgroundColor:"transparent",inputBorder:!1,inputBorderRadius:0,inputTextColor:{ref:"textColor"},inputPlaceholderTextColor:{ref:"inputTextColor",mix:.5},inputPaddingStart:0,inputHeight:{calc:"max(iconSize, fontSize) + spacing * 2"},inputFocusBackgroundColor:{ref:"inputBackgroundColor"},inputFocusBorder:{ref:"inputBorder"},inputFocusShadow:"none",inputFocusTextColor:{ref:"inputTextColor"},inputDisabledBackgroundColor:{ref:"inputBackgroundColor"},inputDisabledBorder:{ref:"inputBorder"},inputDisabledTextColor:{ref:"inputTextColor"},inputInvalidBackgroundColor:{ref:"inputBackgroundColor"},inputInvalidBorder:{ref:"inputBorder"},inputInvalidTextColor:{ref:"inputTextColor"},inputIconColor:{ref:"inputTextColor"},pickerButtonBorder:!1,pickerButtonFocusBorder:{ref:"inputFocusBorder"},pickerButtonBackgroundColor:{ref:"backgroundColor"},pickerButtonFocusBackgroundColor:{ref:"backgroundColor"},pickerListBorder:!1,pickerListBackgroundColor:{ref:"backgroundColor"}},uqe=()=>ql({feature:"inputStyle",params:{...lqe,inputBackgroundColor:Jr,inputBorder:!0,inputBorderRadius:{ref:"borderRadius"},inputPaddingStart:{ref:"spacing"},inputFocusBorder:{color:Iu},inputFocusShadow:{ref:"focusShadow"},inputDisabledBackgroundColor:bo(.06),inputDisabledTextColor:{ref:"textColor",mix:.5},inputInvalidBorder:{color:{ref:"invalidColor"}},pickerButtonBorder:!0,pickerListBorder:!0},css:()=>oqe+aqe}),cqe=uqe(),dqe='.ag-tabs-header{background-color:var(--ag-tab-bar-background-color);border-bottom:var(--ag-tab-bar-border);display:flex;flex:1;gap:var(--ag-tab-spacing);padding:var(--ag-tab-bar-top-padding) var(--ag-tab-bar-horizontal-padding) 0}.ag-tabs-header-wrapper{display:flex}.ag-tabs-close-button-wrapper{align-items:center;border:0;display:flex;padding:var(--ag-spacing)}:where(.ag-ltr) .ag-tabs-close-button-wrapper{border-right:1px solid var(--ag-border-color)}:where(.ag-rtl) .ag-tabs-close-button-wrapper{border-left:1px solid var(--ag-border-color)}.ag-tabs-close-button{background-color:unset;border:0;cursor:pointer;padding:0}.ag-tab{align-items:center;background-color:var(--ag-tab-background-color);border-left:var(--ag-tab-selected-border-width) solid transparent;border-right:var(--ag-tab-selected-border-width) solid transparent;color:var(--ag-tab-text-color);cursor:pointer;display:flex;flex:1;justify-content:center;padding:var(--ag-tab-top-padding) var(--ag-tab-horizontal-padding) var(--ag-tab-bottom-padding);position:relative;&:hover{background-color:var(--ag-tab-hover-background-color);color:var(--ag-tab-hover-text-color)}&.ag-tab-selected{background-color:var(--ag-tab-selected-background-color);color:var(--ag-tab-selected-text-color)}&:after{background-color:var(--ag-tab-selected-underline-color);bottom:0;content:"";display:block;height:var(--ag-tab-selected-underline-width);left:0;opacity:0;position:absolute;right:0;transition:opacity var(--ag-tab-selected-underline-transition-duration)}&.ag-tab-selected:after{opacity:1}}:where(.ag-ltr) .ag-tab{&.ag-tab-selected{&:where(:not(:first-of-type)){border-left-color:var(--ag-tab-selected-border-color)}&:where(:not(:last-of-type)){border-right-color:var(--ag-tab-selected-border-color)}}}:where(.ag-rtl) .ag-tab{&.ag-tab-selected{&:where(:not(:first-of-type)){border-right-color:var(--ag-tab-selected-border-color)}&:where(:not(:last-of-type)){border-left-color:var(--ag-tab-selected-border-color)}}}',hqe={tabBarBackgroundColor:"transparent",tabBarHorizontalPadding:0,tabBarTopPadding:0,tabBackgroundColor:"transparent",tabTextColor:{ref:"textColor"},tabHorizontalPadding:{ref:"spacing"},tabTopPadding:{ref:"spacing"},tabBottomPadding:{ref:"spacing"},tabSpacing:"0",tabHoverBackgroundColor:{ref:"tabBackgroundColor"},tabHoverTextColor:{ref:"tabTextColor"},tabSelectedBackgroundColor:{ref:"tabBackgroundColor"},tabSelectedTextColor:{ref:"tabTextColor"},tabSelectedBorderWidth:1,tabSelectedBorderColor:"transparent",tabSelectedUnderlineColor:"transparent",tabSelectedUnderlineWidth:0,tabSelectedUnderlineTransitionDuration:0,tabBarBorder:!1},fqe=()=>ql({feature:"tabStyle",params:{...hqe,tabBarBorder:!0,tabBarBackgroundColor:Es(.05),tabTextColor:{ref:"textColor",mix:.7},tabSelectedTextColor:{ref:"textColor"},tabHoverTextColor:{ref:"textColor"},tabSelectedBorderColor:{ref:"borderColor"},tabSelectedBackgroundColor:Jr},css:dqe}),pqe=fqe(),gqe=()=>W7e().withPart(Z7e).withPart(tqe).withPart(sqe).withPart(pqe).withPart(cqe).withPart(Bte).withParams({fontFamily:[{googleFont:"IBM Plex Sans"},"-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu"]}),mqe=gqe(),vqe={cssName:"--ag-cell-horizontal-padding",changeKey:"cellHorizontalPaddingChanged",defaultValue:16},Cqe={cssName:"--ag-indentation-level",changeKey:"indentationLevelChanged",defaultValue:0,noWarn:!0,cacheDefault:!0},yqe={cssName:"--ag-row-group-indent-size",changeKey:"rowGroupIndentSizeChanged",defaultValue:0},zW={cssName:"--ag-row-height",changeKey:"rowHeightChanged",defaultValue:42},HW={cssName:"--ag-header-height",changeKey:"headerHeightChanged",defaultValue:48},VW={cssName:"--ag-list-item-height",changeKey:"listItemHeightChanged",defaultValue:24},ik={cssName:"--ag-row-border",changeKey:"rowBorderWidthChanged",defaultValue:1,border:!0},wqe=0,bqe=class extends Z{constructor(){super(...arguments),this.beanName="environment",this.sizeEls=new Map,this.lastKnownValues=new Map,this.sizesMeasured=!1,this.paramsClass=`ag-theme-params-${++wqe}`,this.globalCSS=[]}wireBeans(e){const{eGridDiv:t,gridOptions:n}=e;this.eGridDiv=t,this.eStyleContainer=n.themeStyleContainer??(t.getRootNode()===document?document.head:t),this.cssLayer=n.themeCssLayer,this.styleNonce=n.styleNonce}postConstruct(){this.addManagedPropertyListener("theme",()=>this.handleThemeGridOptionChange()),this.handleThemeGridOptionChange(),this.addManagedPropertyListener("rowHeight",()=>this.refreshRowHeightVariable()),this.getSizeEl(zW),this.getSizeEl(HW),this.getSizeEl(VW),this.getSizeEl(ik),this.refreshRowBorderWidthVariable(),this.addDestroyFunc(()=>b7e(this)),this.mutationObserver=new MutationObserver(()=>{this.fireGridStylesChangedEvent("themeChanged")}),this.addDestroyFunc(()=>this.mutationObserver.disconnect())}getDefaultRowHeight(){return this.getCSSVariablePixelValue(zW)}getDefaultHeaderHeight(){return this.getCSSVariablePixelValue(HW)}getDefaultCellHorizontalPadding(){return this.getCSSVariablePixelValue(vqe)}getDefaultIndentation(){return this.getCSSVariablePixelValue(Cqe)}getDefaultRowGroupIndentSize(){return this.getCSSVariablePixelValue(yqe)}getCellPaddingLeft(){const e=this.getDefaultCellHorizontalPadding(),t=this.getDefaultIndentation(),n=this.getDefaultRowGroupIndentSize();return e-1+n*t}getCellPaddingRight(){return this.getDefaultCellHorizontalPadding()-1}getCellPadding(){return this.getCellPaddingLeft()+this.getCellPaddingRight()}getDefaultColumnMinWidth(){return Math.min(36,this.getDefaultRowHeight())}getDefaultListItemHeight(){return this.getCSSVariablePixelValue(VW)}getRowBorderWidth(){return this.getCSSVariablePixelValue(ik)}applyThemeClasses(e){const{gridTheme:t}=this;let n="";if(t)n=`${this.paramsClass} ${t._getCssClass()}`;else{this.mutationObserver.disconnect();let i=this.eGridDiv;for(;i;){let r=!1;for(const s of Array.from(i.classList))s.startsWith("ag-theme-")&&(r=!0,n=n?`${n} ${s}`:s);r&&this.mutationObserver.observe(i,{attributes:!0,attributeFilter:["class"]}),i=i.parentElement}}for(const i of Array.from(e.classList))i.startsWith("ag-theme-")&&e.classList.remove(i);if(n){const i=e.className;e.className=i+(i?" ":"")+n}}refreshRowHeightVariable(){const{eGridDiv:e}=this,t=e.style.getPropertyValue("--ag-line-height").trim(),n=this.gos.get("rowHeight");if(n==null||isNaN(n)||!isFinite(n))return t!==null&&e.style.setProperty("--ag-line-height",null),-1;const i=`${n}px`;return t!=i?(e.style.setProperty("--ag-line-height",i),n):t!=""?parseFloat(t):-1}addGlobalCSS(e,t){this.gridTheme?Wp(e,this.eStyleContainer,t,this.cssLayer,0,this.styleNonce):this.globalCSS.push([e,t])}getCSSVariablePixelValue(e){const t=this.lastKnownValues.get(e);if(t!=null)return t;const n=this.measureSizeEl(e);return n==="detached"||n==="no-styles"?(e.cacheDefault&&this.lastKnownValues.set(e,e.defaultValue),e.defaultValue):(this.lastKnownValues.set(e,n),n)}measureSizeEl(e){const t=this.getSizeEl(e);if(t.offsetParent==null)return"detached";const n=t.offsetWidth;return n===rk?"no-styles":(this.sizesMeasured=!0,n)}getMeasurementContainer(){let e=this.eMeasurementContainer;return e||(e=this.eMeasurementContainer=Sn({tag:"div",cls:"ag-measurement-container"}),this.eGridDiv.appendChild(e)),e}getSizeEl(e){let t=this.sizeEls.get(e);if(t)return t;const n=this.getMeasurementContainer();t=Sn({tag:"div"});const{border:i,noWarn:r}=e;i?(t.className="ag-measurement-element-border",t.style.setProperty("--ag-internal-measurement-border",`var(${e.cssName}, solid ${rk}px)`)):t.style.width=`var(${e.cssName}, ${rk}px)`,n.appendChild(t),this.sizeEls.set(e,t);let s=this.measureSizeEl(e);s==="no-styles"&&!r&&de(9,{variable:e});const o=_c(this.beans,t,()=>{const a=this.measureSizeEl(e);a==="detached"||a==="no-styles"||(this.lastKnownValues.set(e,a),a!==s&&(s=a,this.fireGridStylesChangedEvent(e.changeKey)))});return this.addDestroyFunc(()=>o()),t}fireGridStylesChangedEvent(e){e==="rowBorderWidthChanged"&&this.refreshRowBorderWidthVariable(),this.eventSvc.dispatchEvent({type:"gridStylesChanged",[e]:!0})}refreshRowBorderWidthVariable(){const e=this.getCSSVariablePixelValue(ik);this.eGridDiv.style.setProperty("--ag-internal-row-border-width",`${e}px`)}handleThemeGridOptionChange(){const{gos:e,eGridDiv:t,globalCSS:n,gridTheme:i}=this,r=e.get("theme");let s;if(r==="legacy")s=void 0;else{const o=r??mqe;o instanceof Vte?s=o:Ft(240,{theme:o})}if(s!==i){if(s){w7e(this),Lte(this.eStyleContainer,this.cssLayer,this.styleNonce);for(const[a,l]of n)Wp(a,this.eStyleContainer,l,this.cssLayer,0,this.styleNonce);n.length=0}this.gridTheme=s,s?._startUse({loadThemeGoogleFonts:e.get("loadThemeGoogleFonts"),styleContainer:this.eStyleContainer,cssLayer:this.cssLayer,nonce:this.styleNonce});let o=this.eParamsStyle;if(!o){o=this.eParamsStyle=Sn({tag:"style"});const a=this.gos.get("styleNonce");a&&o.setAttribute("nonce",a),t.appendChild(o)}MN||(o.textContent=s?._getPerGridCss(this.paramsClass)||""),this.applyThemeClasses(t),this.fireGridStylesChangedEvent("themeChanged")}s&&getComputedStyle(this.getMeasurementContainer()).getPropertyValue("--ag-legacy-styles-loaded")&&Ft(r?106:239)}},rk=15538,Sqe=class extends Z{constructor(){super(...arguments),this.beanName="eventSvc",this.globalEventService=new hh}postConstruct(){const{globalListener:e,globalSyncListener:t}=this.beans;e&&this.addGlobalListener(e,!0),t&&this.addGlobalListener(t,!1)}addEventListener(e,t,n){this.globalEventService.addEventListener(e,t,n)}removeEventListener(e,t,n){this.globalEventService.removeEventListener(e,t,n)}addGlobalListener(e,t=!1){this.globalEventService.addGlobalListener(e,t)}removeGlobalListener(e,t=!1){this.globalEventService.removeGlobalListener(e,t)}dispatchLocalEvent(){}dispatchEvent(e){this.globalEventService.dispatchEvent(ze(this.gos,e))}dispatchEventOnce(e){this.globalEventService.dispatchEventOnce(ze(this.gos,e))}};function Kte(e){return e?e.getLeafColumns().some(t=>t.isSpanHeaderHeight()):!1}function pT(e,t){let n;if(dn(e)&&Kte(e)&&e.isPadding()){const i=e;n=i.getLeafColumns()[0];let r=n;for(;r!==i;)t++,r=r.getParent()}return{column:n||e,headerRowIndex:t}}var xqe=class extends Z{constructor(){super(...arguments),this.beanName="headerNavigation",this.currentHeaderRowWithoutSpan=-1}postConstruct(){const e=this.beans;e.ctrlsSvc.whenReady(this,n=>{this.gridBodyCon=n.gridBodyCtrl});const t=Pn(e);this.addManagedElementListeners(t,{mousedown:()=>{this.currentHeaderRowWithoutSpan=-1}})}getHeaderPositionForColumn(e,t){let n;const{colModel:i,colGroupSvc:r,ctrlsSvc:s}=this.beans;if(typeof e=="string"?(n=i.getCol(e),n||(n=r?.getColumnGroup(e)??null)):n=e,!n)return null;const a=s.getHeaderRowContainerCtrl()?.getAllCtrls(),l=Lt(a||[]).type==="filter",u=va(this.beans)-1;let c=-1,d=n;for(;d;)c++,d=d.getParent();let h=c;return t&&l&&h===u-1&&h++,h===-1?null:{headerRowIndex:h,column:n}}navigateVertically(e,t,n){const i=this.beans.focusSvc;if(t||(t=i.focusedHeader),!t)return!1;const{headerRowIndex:r}=t,s=t.column,o=va(this.beans),a=e==="UP",l=this.getHeaderRowType(r);let{headerRowIndex:u,column:c,headerRowIndexWithoutSpan:d}=a?Rqe(l,s,r):Eqe(l,s,r),h=!1;return u<0&&(u=0,c=s,h=!0),u>=o?(u=-1,this.currentHeaderRowWithoutSpan=-1):d!==void 0&&(this.currentHeaderRowWithoutSpan=d),!h&&!c?!1:i.focusHeaderPosition({headerPosition:{headerRowIndex:u,column:c},allowUserOverride:!0,event:n})}navigateHorizontally(e,t=!1,n){const{focusSvc:i,gos:r}=this.beans,s=i.focusedHeader;let o,a;this.currentHeaderRowWithoutSpan!==-1?s.headerRowIndex=this.currentHeaderRowWithoutSpan:this.currentHeaderRowWithoutSpan=s.headerRowIndex,e==="LEFT"!==r.get("enableRtl")?(a="Before",o=this.findHeader(s,a)):(a="After",o=this.findHeader(s,a));const l=r.getCallback("tabToNextHeader");if(t&&l){const u=i.focusHeaderPositionFromUserFunc({userFunc:l,headerPosition:o,direction:a});if(u){const{headerRowIndex:c}=i.focusedHeader||{};c!=null&&c!=s.headerRowIndex&&(this.currentHeaderRowWithoutSpan=c)}return u}return o||!t?i.focusHeaderPosition({headerPosition:o,direction:a,fromTab:t,allowUserOverride:!0,event:n}):this.focusNextHeaderRow(s,a,n)}focusNextHeaderRow(e,t,n){const i=e.headerRowIndex;let r=null,s;const o=this.beans;if(t==="Before"?i>0&&(s=i-1,this.currentHeaderRowWithoutSpan-=1,r=this.findColAtEdgeForHeaderRow(s,"end")):(s=i+1,this.currentHeaderRowWithoutSpan<va(o)?this.currentHeaderRowWithoutSpan+=1:this.currentHeaderRowWithoutSpan=-1,r=this.findColAtEdgeForHeaderRow(s,"start")),!r)return!1;const{column:a,headerRowIndex:l}=pT(r.column,r?.headerRowIndex);return o.focusSvc.focusHeaderPosition({headerPosition:{column:a,headerRowIndex:l},direction:t,fromTab:!0,allowUserOverride:!0,event:n})}scrollToColumn(e,t="After"){if(e.getPinned())return;let n;if(dn(e)){const i=e.getDisplayedLeafColumns();n=t==="Before"?Lt(i):i[0]}else n=e;this.gridBodyCon.scrollFeature.ensureColumnVisible(n)}findHeader(e,t){let n,i;const{colGroupSvc:r,visibleCols:s}=this.beans;if(dn(e.column)?n=r?.getGroupAtDirection(e.column,t)??void 0:(i=`getCol${t}`,n=s[i](e.column)),!n)return;const{headerRowIndex:o}=e;if(this.getHeaderRowType(o)!=="filter"){const u=[n];for(;n.getParent();)n=n.getParent(),u.push(n);n=u[Math.max(0,u.length-1-o)]}const{column:a,headerRowIndex:l}=pT(n,o);return{column:a,headerRowIndex:l}}getHeaderRowType(e){const t=this.beans.ctrlsSvc.getHeaderRowContainerCtrl();if(t)return t.getRowType(e)}findColAtEdgeForHeaderRow(e,t){const{visibleCols:n,ctrlsSvc:i,colGroupSvc:r}=this.beans,s=n.allCols,o=s[t==="start"?0:s.length-1];if(!o)return;const l=i.getHeaderRowContainerCtrl(o.getPinned())?.getRowType(e);if(l=="group"){const u=r?.getColGroupAtLevel(o,e);return{headerRowIndex:e,column:u}}return{headerRowIndex:l==null?-1:e,column:o}}};function Rqe(e,t,n){const i=e==="filter",r=e==="column";let s=i?t:t.getParent(),o=n-1,a=o;if(r&&Kte(t.getParent())){for(;s&&s.isPadding();)s=s.getParent(),o--;a=o,o<0&&(s=t,o=n,a=void 0)}return{column:s,headerRowIndex:o,headerRowIndexWithoutSpan:a}}function Eqe(e,t,n,i="After"){let r=t,s=n+1;const o=s;if(e==="group"){const a=t.getDisplayedLeafColumns(),l=i==="After"?a[0]:Lt(a),u=[];let c=l;for(;c.getParent()!==t;)c=c.getParent(),u.push(c);if(r=l,l.isSpanHeaderHeight())for(let d=u.length-1;d>=0;d--){const h=u[d];if(!h.isPadding()){r=h;break}s++}else r=Lt(u),r||(r=l)}return{column:r,headerRowIndex:s,headerRowIndexWithoutSpan:o}}var Fqe=class extends Z{constructor(){super(...arguments),this.beanName="focusSvc",this.focusFallbackTimeout=null,this.needsFocusRestored=!1}wireBeans(e){this.colModel=e.colModel,this.visibleCols=e.visibleCols,this.rowRenderer=e.rowRenderer,this.navigation=e.navigation,this.filterManager=e.filterManager,this.overlays=e.overlays}postConstruct(){const e=this.clearFocusedCell.bind(this);this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:this.onColumnEverythingChanged.bind(this),columnGroupOpened:e,columnRowGroupChanged:e}),this.addDestroyFunc(BWe(this.beans))}attemptToRecoverFocus(){this.needsFocusRestored=!0,this.focusFallbackTimeout!=null&&clearTimeout(this.focusFallbackTimeout),this.focusFallbackTimeout=window.setTimeout(this.setFocusRecovered.bind(this),100)}setFocusRecovered(){this.needsFocusRestored=!1,this.focusFallbackTimeout!=null&&(clearTimeout(this.focusFallbackTimeout),this.focusFallbackTimeout=null)}shouldTakeFocus(){return this.gos.get("suppressFocusAfterRefresh")?(this.setFocusRecovered(),!1):this.needsFocusRestored?(this.setFocusRecovered(),!0):this.doesRowOrCellHaveBrowserFocus()}onColumnEverythingChanged(){if(!this.focusedCell)return;const e=this.focusedCell.column,t=this.colModel.getCol(e.getId());e!==t&&this.clearFocusedCell()}getFocusCellToUseAfterRefresh(){const{gos:e,focusedCell:t}=this;return e.get("suppressFocusAfterRefresh")||e.get("suppressCellFocus")||!t||!this.doesRowOrCellHaveBrowserFocus()?null:t}getFocusHeaderToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedHeader||!this.isDomDataPresentInHierarchy(nn(this.beans),Ste)?null:this.focusedHeader}doesRowOrCellHaveBrowserFocus(){const e=nn(this.beans);return this.isDomDataPresentInHierarchy(e,m1)?!0:this.isDomDataPresentInHierarchy(e,w1)}isDomDataPresentInHierarchy(e,t){let n=e;for(;n;){if(bee(this.gos,n,t))return!0;n=n.parentNode}return!1}getFocusedCell(){return this.focusedCell}getFocusEventParams(e){const{rowIndex:t,rowPinned:n,column:i}=e,r={rowIndex:t,rowPinned:n,column:i,isFullWidthCell:!1},s=this.rowRenderer.getRowByPosition({rowIndex:t,rowPinned:n});return s&&(r.isFullWidthCell=s.isFullWidth()),r}clearFocusedCell(){if(this.focusedCell==null)return;const e=this.getFocusEventParams(this.focusedCell);this.focusedCell=null,this.eventSvc.dispatchEvent({type:"cellFocusCleared",...e})}setFocusedCell(e){this.setFocusRecovered();const{column:t,rowIndex:n,rowPinned:i,forceBrowserFocus:r=!1,preventScrollOnBrowserFocus:s=!1}=e,o=this.colModel.getCol(t);if(!o){this.focusedCell=null;return}this.focusedCell={rowIndex:n,rowPinned:Il(i),column:o},this.eventSvc.dispatchEvent({type:"cellFocused",...this.getFocusEventParams(this.focusedCell),forceBrowserFocus:r,preventScrollOnBrowserFocus:s})}isCellFocused(e){return this.focusedCell==null?!1:rte(e,this.focusedCell)}isHeaderWrapperFocused(e){if(this.focusedHeader==null)return!1;const{column:t,rowCtrl:{rowIndex:n,pinned:i}}=e,{column:r,headerRowIndex:s}=this.focusedHeader;return t===r&&n===s&&i==r.getPinned()}focusHeaderPosition(e){if(this.setFocusRecovered(),Hd(this.beans))return!1;const{direction:t,fromTab:n,allowUserOverride:i,event:r,fromCell:s,rowWithoutSpanValue:o}=e;let{headerPosition:a}=e;if(s&&this.filterManager?.isAdvFilterHeaderActive())return this.focusAdvancedFilter(a);if(i){const l=this.focusedHeader,u=va(this.beans);if(n){const c=this.gos.getCallback("tabToNextHeader");c&&(a=this.getHeaderPositionFromUserFunc({userFunc:c,direction:t,currentPosition:l,headerPosition:a,headerRowCount:u}))}else{const c=this.gos.getCallback("navigateToNextHeader");if(c&&r){const d={key:r.key,previousHeaderPosition:l,nextHeaderPosition:a,headerRowCount:u,event:r};a=c(d)}}}return a?this.focusProvidedHeaderPosition({headerPosition:a,direction:t,event:r,fromCell:s,rowWithoutSpanValue:o}):!1}focusHeaderPositionFromUserFunc(e){if(Hd(this.beans))return!1;const{userFunc:t,headerPosition:n,direction:i,event:r}=e,s=this.focusedHeader,o=va(this.beans),a=this.getHeaderPositionFromUserFunc({userFunc:t,direction:i,currentPosition:s,headerPosition:n,headerRowCount:o});return!!a&&this.focusProvidedHeaderPosition({headerPosition:a,direction:i,event:r})}getHeaderPositionFromUserFunc(e){const{userFunc:t,direction:n,currentPosition:i,headerPosition:r,headerRowCount:s}=e,a=t({backwards:n==="Before",previousHeaderPosition:i,nextHeaderPosition:r,headerRowCount:s});return a===!0?i:a===!1?null:a}focusProvidedHeaderPosition(e){const{headerPosition:t,direction:n,fromCell:i,rowWithoutSpanValue:r,event:s}=e,{column:o,headerRowIndex:a}=t,{filterManager:l,ctrlsSvc:u,headerNavigation:c}=this.beans;if(a===-1)return l?.isAdvFilterHeaderActive()?this.focusAdvancedFilter(t):this.focusGridView({column:o,event:s});c?.scrollToColumn(o,n);const h=u.getHeaderRowContainerCtrl(o.getPinned())?.focusHeader(t.headerRowIndex,o,s)||!1;return c&&h&&(r!=null||i)&&(c.currentHeaderRowWithoutSpan=r??-1),h}focusFirstHeader(){if(this.overlays?.isExclusive()&&this.focusOverlay())return!0;let e=this.visibleCols.allCols[0];if(!e)return!1;const{colGroupSvc:t}=this.beans;t&&e.getParent()&&(e=t.getColGroupAtLevel(e,0));const n=pT(e,0);return this.focusHeaderPosition({headerPosition:n,rowWithoutSpanValue:0})}focusLastHeader(e){if(this.overlays?.isExclusive()&&this.focusOverlay(!0))return!0;const t=va(this.beans)-1,n=Lt(this.visibleCols.allCols);return this.focusHeaderPosition({headerPosition:{headerRowIndex:t,column:n},rowWithoutSpanValue:-1,event:e})}focusPreviousFromFirstCell(e){return this.filterManager?.isAdvFilterHeaderActive()?this.focusAdvancedFilter(null):this.focusLastHeader(e)}isAnyCellFocused(){return!!this.focusedCell}isRowFocused(e,t){return this.focusedCell==null?!1:this.focusedCell.rowIndex===e&&this.focusedCell.rowPinned===Il(t)}focusOverlay(e){const t=this.overlays?.isVisible()&&this.overlays.eWrapper?.getGui();return!!t&&ph(t,e)}focusGridView(e){const{backwards:t=!1,canFocusOverlay:n=!0,event:i}=e;if(this.overlays?.isExclusive())return n&&this.focusOverlay(t);if(jR(this.beans))return t&&!Hd(this.beans)?this.focusLastHeader():n&&this.focusOverlay(t)?!0:t?!1:Hp(this.beans,t);const r=t?u4e(this.beans):l4e(this.beans);if(r){const s=e.column??this.focusedHeader?.column,{rowIndex:o,rowPinned:a}=r,l=v1(this.beans,r);if(!s||!l||o==null)return!1;if(s.isSuppressNavigable(l)){const u=this.gos.get("enableRtl");let c;return!i||i.key===X.TAB?c=u?X.LEFT:X.RIGHT:c=i.key,this.beans.navigation?.navigateToNextCell(null,c,{rowIndex:o,column:s,rowPinned:a||null},!0),!0}return this.navigation?.ensureCellVisible({rowIndex:o,column:s,rowPinned:a}),t&&this.rowRenderer.getRowByPosition(r)?.isFullWidth()&&this.navigation?.tryToFocusFullWidthRow(r,t)||(this.setFocusedCell({rowIndex:o,column:s,rowPinned:Il(a),forceBrowserFocus:!0}),this.beans.rangeSvc?.setRangeToCell({rowIndex:o,rowPinned:a,column:s})),!0}return!!(n&&this.focusOverlay(t)||t&&this.focusLastHeader())}focusAdvancedFilter(e){return this.advFilterFocusColumn=e?.column,this.beans.advancedFilter?.getCtrl().focusHeaderComp()??!1}focusNextFromAdvancedFilter(e,t){const n=(t?void 0:this.advFilterFocusColumn)??this.visibleCols.allCols?.[0];return e?this.focusHeaderPosition({headerPosition:{column:n,headerRowIndex:va(this.beans)-1}}):this.focusGridView({column:n})}clearAdvancedFilterColumn(){this.advFilterFocusColumn=void 0}},Aqe=class extends Z{constructor(){super(...arguments),this.beanName="scrollVisibleSvc"}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.colAnimation=e.colAnimation}postConstruct(){this.getScrollbarWidth(),this.addManagedEventListeners({displayedColumnsChanged:this.updateScrollVisible.bind(this),displayedColumnsWidthChanged:this.updateScrollVisible.bind(this)})}updateScrollVisible(){const{colAnimation:e}=this;e?.isActive()?e.executeLaterVMTurn(()=>{e.executeLaterVMTurn(()=>this.updateScrollVisibleImpl())}):this.updateScrollVisibleImpl()}updateScrollVisibleImpl(){const e=this.ctrlsSvc.get("center");if(!e||this.colAnimation?.isActive())return;const t={horizontalScrollShowing:e.isHorizontalScrollShowing(),verticalScrollShowing:this.verticalScrollShowing};this.setScrollsVisible(t),this.updateScrollGap()}updateScrollGap(){const e=this.ctrlsSvc.get("center"),t=e.hasHorizontalScrollGap(),n=e.hasVerticalScrollGap();(this.horizontalScrollGap!==t||this.verticalScrollGap!==n)&&(this.horizontalScrollGap=t,this.verticalScrollGap=n,this.eventSvc.dispatchEvent({type:"scrollGapChanged"}))}setScrollsVisible(e){(this.horizontalScrollShowing!==e.horizontalScrollShowing||this.verticalScrollShowing!==e.verticalScrollShowing)&&(this.horizontalScrollShowing=e.horizontalScrollShowing,this.verticalScrollShowing=e.verticalScrollShowing,this.eventSvc.dispatchEvent({type:"scrollVisibilityChanged"}))}getScrollbarWidth(){if(this.scrollbarWidth==null){const e=this.gos.get("scrollbarWidth"),n=typeof e=="number"&&e>=0?e:D5e();n!=null&&(this.scrollbarWidth=n,this.eventSvc.dispatchEvent({type:"scrollbarWidthChanged"}))}return this.scrollbarWidth}},Dqe=class extends Z{constructor(){super(...arguments),this.beanName="gridDestroySvc",this.destroyCalled=!1}destroy(){if(this.destroyCalled)return;const{stateSvc:e,ctrlsSvc:t,context:n}=this.beans;this.eventSvc.dispatchEvent({type:"gridPreDestroyed",state:e?.getState()??{}}),this.destroyCalled=!0,t.get("gridCtrl")?.destroyGridUi(),n.destroy(),super.destroy()}},Iv=new Set(["gridPreDestroyed","fillStart","pasteStart"]),kqe={suppressContextMenu:!1,preventDefaultOnContextMenu:!1,allowContextMenuWithControlKey:!1,suppressMenuHide:!0,enableBrowserTooltips:!1,tooltipTrigger:"hover",tooltipShowDelay:2e3,tooltipHideDelay:1e4,tooltipMouseTrack:!1,tooltipShowMode:"standard",tooltipInteraction:!1,copyHeadersToClipboard:!1,copyGroupHeadersToClipboard:!1,clipboardDelimiter:"	",suppressCopyRowsToClipboard:!1,suppressCopySingleCellRanges:!1,suppressLastEmptyLineOnPaste:!1,suppressClipboardPaste:!1,suppressClipboardApi:!1,suppressCutToClipboard:!1,maintainColumnOrder:!1,enableStrictPivotColumnOrder:!1,suppressFieldDotNotation:!1,allowDragFromColumnsToolPanel:!1,suppressMovableColumns:!1,suppressColumnMoveAnimation:!1,suppressMoveWhenColumnDragging:!1,suppressDragLeaveHidesColumns:!1,suppressRowGroupHidesColumns:!1,suppressAutoSize:!1,autoSizePadding:20,skipHeaderOnAutoSize:!1,singleClickEdit:!1,suppressClickEdit:!1,readOnlyEdit:!1,stopEditingWhenCellsLoseFocus:!1,enterNavigatesVertically:!1,enterNavigatesVerticallyAfterEdit:!1,enableCellEditingOnBackspace:!1,undoRedoCellEditing:!1,undoRedoCellEditingLimit:10,suppressCsvExport:!1,suppressExcelExport:!1,cacheQuickFilter:!1,includeHiddenColumnsInQuickFilter:!1,excludeChildrenWhenTreeDataFiltering:!1,enableAdvancedFilter:!1,includeHiddenColumnsInAdvancedFilter:!1,enableCharts:!1,masterDetail:!1,keepDetailRows:!1,keepDetailRowsCount:10,detailRowAutoHeight:!1,tabIndex:0,rowBuffer:10,valueCache:!1,valueCacheNeverExpires:!1,enableCellExpressions:!1,suppressTouch:!1,suppressFocusAfterRefresh:!1,suppressBrowserResizeObserver:!1,suppressPropertyNamesCheck:!1,suppressChangeDetection:!1,debug:!1,suppressLoadingOverlay:!1,suppressNoRowsOverlay:!1,pagination:!1,paginationPageSize:100,paginationPageSizeSelector:!0,paginationAutoPageSize:!1,paginateChildRows:!1,suppressPaginationPanel:!1,pivotMode:!1,pivotPanelShow:"never",pivotDefaultExpanded:0,pivotSuppressAutoColumn:!1,suppressExpandablePivotGroups:!1,functionsReadOnly:!1,suppressAggFuncInHeader:!1,alwaysAggregateAtRootLevel:!1,aggregateOnlyChangedColumns:!1,suppressAggFilteredOnly:!1,removePivotHeaderRowWhenSingleValueColumn:!1,animateRows:!0,cellFlashDuration:500,cellFadeDuration:1e3,allowShowChangeAfterFilter:!1,domLayout:"normal",ensureDomOrder:!1,enableRtl:!1,suppressColumnVirtualisation:!1,suppressMaxRenderedRowRestriction:!1,suppressRowVirtualisation:!1,rowDragManaged:!1,suppressRowDrag:!1,suppressMoveWhenRowDragging:!1,rowDragEntireRow:!1,rowDragMultiRow:!1,embedFullWidthRows:!1,groupDisplayType:"singleColumn",groupDefaultExpanded:0,groupMaintainOrder:!1,groupSelectsChildren:!1,groupSuppressBlankHeader:!1,groupSelectsFiltered:!1,showOpenedGroup:!1,groupRemoveSingleChildren:!1,groupRemoveLowestSingleChildren:!1,groupHideOpenParents:!1,groupAllowUnbalanced:!1,rowGroupPanelShow:"never",suppressMakeColumnVisibleAfterUnGroup:!1,treeData:!1,rowGroupPanelSuppressSort:!1,suppressGroupRowsSticky:!1,rowModelType:"clientSide",asyncTransactionWaitMillis:50,suppressModelUpdateAfterUpdateTransaction:!1,cacheOverflowSize:1,infiniteInitialRowCount:1,serverSideInitialRowCount:1,cacheBlockSize:100,maxBlocksInCache:-1,maxConcurrentDatasourceRequests:2,blockLoadDebounceMillis:0,purgeClosedRowNodes:!1,serverSideSortAllLevels:!1,serverSideOnlyRefreshFilteredGroups:!1,serverSidePivotResultFieldSeparator:"_",viewportRowModelPageSize:5,viewportRowModelBufferSize:5,alwaysShowHorizontalScroll:!1,alwaysShowVerticalScroll:!1,debounceVerticalScrollbar:!1,suppressHorizontalScroll:!1,suppressScrollOnNewData:!1,suppressScrollWhenPopupsAreOpen:!1,suppressAnimationFrame:!1,suppressMiddleClickScrolls:!1,suppressPreventDefaultOnMouseWheel:!1,rowMultiSelectWithClick:!1,suppressRowDeselection:!1,suppressRowClickSelection:!1,suppressCellFocus:!1,suppressHeaderFocus:!1,suppressMultiRangeSelection:!1,enableCellTextSelection:!1,enableRangeSelection:!1,enableRangeHandle:!1,enableFillHandle:!1,fillHandleDirection:"xy",suppressClearOnFillReduction:!1,accentedSort:!1,unSortIcon:!1,suppressMultiSort:!1,alwaysMultiSort:!1,suppressMaintainUnsortedOrder:!1,suppressRowHoverHighlight:!1,suppressRowTransform:!1,columnHoverHighlight:!1,deltaSort:!1,enableGroupEdit:!1,groupLockGroupColumns:0,serverSideEnableClientSideSort:!1,suppressServerSideFullWidthLoadingRow:!1,pivotMaxGeneratedColumns:-1,columnMenu:"new",reactiveCustomComponents:!0,suppressSetFilterByDefault:!1,rowNumbers:!1},Pqe=0,Mqe=0,Tqe=class extends Z{constructor(){super(...arguments),this.beanName="gos",this.domDataKey="__AG_"+Math.random().toString(),this.gridInstanceId=Mqe++,this.propEventSvc=new hh,this.globalEventHandlerFactory=e=>(t,n)=>{if(!this.isAlive())return;const i=Iv.has(t);if(i&&!e||!i&&e)return;const r=fN(t),s=this.gridOptions[r];typeof s=="function"&&this.beans.frameworkOverrides.wrapOutgoing(()=>{s(n)})}}wireBeans(e){this.gridOptions=e.gridOptions,this.validation=e.validation,this.api=e.gridApi,this.gridId=e.context.getGridId()}get gridOptionsContext(){return this.gridOptions.context}postConstruct(){this.eventSvc.addGlobalListener(this.globalEventHandlerFactory().bind(this),!0),this.eventSvc.addGlobalListener(this.globalEventHandlerFactory(!0).bind(this),!1),this.propEventSvc.setFrameworkOverrides(this.beans.frameworkOverrides),this.addManagedEventListeners({gridOptionsChanged:({options:e})=>{this.updateGridOptions({options:e,force:!0,source:"gridOptionsUpdated"})}})}get(e){return this.gridOptions[e]??kqe[e]}getCallback(e){return this.mergeGridCommonParams(this.gridOptions[e])}exists(e){return Ce(this.gridOptions[e])}mergeGridCommonParams(e){return e&&(n=>e(this.addGridCommonParams(n)))}updateGridOptions({options:e,force:t,source:n="api"}){const i={id:Pqe++,properties:[]},r=[],{gridOptions:s,validation:o}=this;for(const a of Object.keys(e)){const l=e[a];o?.warnOnInitialPropertyUpdate(n,a);const u=t||typeof l=="object"&&n==="api",c=s[a];if(u||c!==l){s[a]=l;const d={type:a,currentValue:l,previousValue:c,changeSet:i,source:n};r.push(d)}}o?.processGridOptions(this.gridOptions),i.properties=r.map(a=>a.type),r.forEach(a=>{fc(this,`Updated property ${a.type} from`,a.previousValue," to ",a.currentValue),this.propEventSvc.dispatchEvent(a)})}addPropertyEventListener(e,t){this.propEventSvc.addEventListener(e,t)}removePropertyEventListener(e,t){this.propEventSvc.removeEventListener(e,t)}getDomDataKey(){return this.domDataKey}addGridCommonParams(e){return e.api=this.api,e.context=this.gridOptionsContext,e}assertModuleRegistered(e,t){const n=Array.isArray(e)?e.some(i=>this.isModuleRegistered(i)):this.isModuleRegistered(e);return n||Ft(200,{...this.getModuleErrorParams(),moduleName:e,reasonOrId:t}),n}getModuleErrorParams(){return{gridId:this.gridId,gridScoped:vN(),rowModelType:this.get("rowModelType"),isUmd:PWe()}}isModuleRegistered(e){return Yee(e,this.gridId,this.get("rowModelType"))}};function Yte(e){const t={"aria-hidden":"true"};return{tag:"div",cls:"ag-cell-label-container",role:"presentation",children:[{tag:"span",ref:"eMenu",cls:"ag-header-icon ag-header-cell-menu-button",attrs:t},{tag:"span",ref:"eFilterButton",cls:"ag-header-icon ag-header-cell-filter-button",attrs:t},{tag:"div",ref:"eLabel",cls:"ag-header-cell-label",role:"presentation",children:[{tag:"span",ref:"eText",cls:"ag-header-cell-text"},{tag:"span",ref:"eFilter",cls:"ag-header-icon ag-header-label-icon ag-filter-icon",attrs:t},e?{tag:"ag-sort-indicator",ref:"eSortIndicator"}:null]}]}}var Iqe=Yte(!0),_qe=Yte(!1),Oqe=class extends At{constructor(){super(...arguments),this.eFilter=ve,this.eFilterButton=ve,this.eSortIndicator=ve,this.eMenu=ve,this.eLabel=ve,this.eText=ve,this.eSortOrder=ve,this.eSortAsc=ve,this.eSortDesc=ve,this.eSortMixed=ve,this.eSortNone=ve,this.isLoadingInnerComponent=!1}refresh(e){const t=this.params;if(this.params=e,this.workOutTemplate(e,!!this.beans?.sortSvc)!=this.currentTemplate||this.workOutShowMenu()!=this.currentShowMenu||e.enableSorting!=this.currentSort||this.currentSuppressMenuHide!=null&&this.shouldSuppressMenuHide()!=this.currentSuppressMenuHide||t.enableFilterButton!=e.enableFilterButton||t.enableFilterIcon!=e.enableFilterIcon)return!1;if(this.innerHeaderComponent){const n={...e};lr(n,e.innerHeaderComponentParams),this.innerHeaderComponent.refresh?.(n)}else this.setDisplayName(e);return!0}workOutTemplate(e,t){const n=e.template;return n?n?.trim?n.trim():n:t?Iqe:_qe}init(e){this.params=e;const{sortSvc:t,touchSvc:n,rowNumbersSvc:i,userCompFactory:r}=this.beans,s=t?.getSortIndicatorSelector();this.currentTemplate=this.workOutTemplate(e,!!s),this.setTemplate(this.currentTemplate,s?[s]:void 0),n?.setupForHeader(this),this.setMenu(),this.setupSort(),i?.setupForHeader(this),this.setupFilterIcon(),this.setupFilterButton(),this.workOutInnerHeaderComponent(r,e),this.setDisplayName(e)}workOutInnerHeaderComponent(e,t){const n=lWe(e,t,t);n&&(this.isLoadingInnerComponent=!0,n.newAgStackInstance().then(i=>{this.isLoadingInnerComponent=!1,i&&(this.isAlive()?(this.innerHeaderComponent=i,this.eText.appendChild(i.getGui())):this.destroyBean(i))}))}setDisplayName(e){const{displayName:t}=e,n=this.currentDisplayName;if(this.currentDisplayName=t,n===t||this.innerHeaderComponent||this.isLoadingInnerComponent)return;const i=Ol(t,!0);this.eText.textContent=i}addInIcon(e,t,n){if(t==null)return;const i=Os(e,this.beans,n);i&&t.appendChild(i)}workOutShowMenu(){return this.params.enableMenu&&!!this.beans.menuSvc?.isHeaderMenuButtonEnabled()}shouldSuppressMenuHide(){return!!this.beans.menuSvc?.isHeaderMenuButtonAlwaysShowEnabled()}setMenu(){if(!this.eMenu)return;if(this.currentShowMenu=this.workOutShowMenu(),!this.currentShowMenu){_s(this.eMenu),this.eMenu=void 0;return}const{gos:e,eMenu:t,params:n}=this,i=Zr(e);this.addInIcon(i?"menu":"menuAlt",t,n.column),t.classList.toggle("ag-header-menu-icon",!i);const r=this.shouldSuppressMenuHide();this.currentSuppressMenuHide=r,this.addManagedElementListeners(t,{click:()=>this.showColumnMenu(this.eMenu)}),this.toggleMenuAlwaysShow(r)}toggleMenuAlwaysShow(e){this.eMenu?.classList.toggle("ag-header-menu-always-show",e)}showColumnMenu(e){const{currentSuppressMenuHide:t,params:n}=this;t||this.toggleMenuAlwaysShow(!0),n.showColumnMenu(e,()=>{t||this.toggleMenuAlwaysShow(!1)})}onMenuKeyboardShortcut(e){const{params:t,gos:n,beans:i,eMenu:r,eFilterButton:s}=this,o=t.column,a=Zr(n);if(e&&!a){if(i.menuSvc?.isFilterMenuInHeaderEnabled(o))return t.showFilter(s??r??this.getGui()),!0}else if(t.enableMenu)return this.showColumnMenu(r??s??this.getGui()),!0;return!1}setupSort(){const{sortSvc:e}=this.beans;if(!e)return;const{enableSorting:t,column:n}=this.params;if(this.currentSort=t,!this.eSortIndicator){this.eSortIndicator=this.createBean(e.createSortIndicator(!0));const{eSortIndicator:i,eSortOrder:r,eSortAsc:s,eSortDesc:o,eSortMixed:a,eSortNone:l}=this;i.attachCustomElements(r,s,o,a,l)}this.eSortIndicator.setupSort(n),this.currentSort&&e.setupHeader(this,n,this.eLabel)}setupFilterIcon(){const{eFilter:e,params:t}=this;e&&this.configureFilter(t.enableFilterIcon,e,this.onFilterChangedIcon.bind(this),"filterActive")}setupFilterButton(){const{eFilterButton:e,params:t}=this;if(!e)return;this.configureFilter(t.enableFilterButton,e,this.onFilterChangedButton.bind(this),"filter")?this.addManagedElementListeners(e,{click:()=>t.showFilter(e)}):this.eFilterButton=void 0}configureFilter(e,t,n,i){if(!e)return _s(t),!1;const r=this.params.column;return this.addInIcon(i,t,r),this.addManagedListeners(r,{filterChanged:n}),n(),!0}onFilterChangedIcon(){const e=this.params.column.isFilterActive();tn(this.eFilter,e,{skipAriaHidden:!0})}onFilterChangedButton(){const e=this.params.column.isFilterActive();this.eFilterButton.classList.toggle("ag-filter-active",e)}getAnchorElementForMenu(e){const{eFilterButton:t,eMenu:n}=this;return e?t??n??this.getGui():n??t??this.getGui()}destroy(){super.destroy(),this.innerHeaderComponent&&(this.destroyBean(this.innerHeaderComponent),this.innerHeaderComponent=void 0)}},Lqe={tag:"div",cls:"ag-header-group-cell-label",role:"presentation",children:[{tag:"span",ref:"agLabel",cls:"ag-header-group-text",role:"presentation"},{tag:"span",ref:"agOpened",cls:"ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"},{tag:"span",ref:"agClosed",cls:"ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"}]},Nqe=class extends At{constructor(){super(Lqe),this.agOpened=ve,this.agClosed=ve,this.agLabel=ve,this.isLoadingInnerComponent=!1}init(e){const{userCompFactory:t}=this.beans;this.params=e,this.checkWarnings(),this.workOutInnerHeaderGroupComponent(t,e),this.setupLabel(e),this.addGroupExpandIcon(e),this.setupExpandIcons()}checkWarnings(){this.params.template&&de(89)}workOutInnerHeaderGroupComponent(e,t){const n=cWe(e,t,t);n&&(this.isLoadingInnerComponent=!0,n.newAgStackInstance().then(i=>{this.isLoadingInnerComponent=!1,i&&(this.isAlive()?(this.innerHeaderGroupComponent=i,this.agLabel.appendChild(i.getGui())):this.destroyBean(i))}))}setupExpandIcons(){const{agOpened:e,agClosed:t,params:{columnGroup:n},beans:i}=this;this.addInIcon("columnGroupOpened",e),this.addInIcon("columnGroupClosed",t);const r=l=>{if(_l(l))return;const u=!n.isExpanded();i.colGroupSvc.setColumnGroupOpened(n.getProvidedColumnGroup(),u,"uiColumnExpanded")};this.addTouchAndClickListeners(i,t,r),this.addTouchAndClickListeners(i,e,r);const s=l=>{Bp(l)};this.addManagedElementListeners(t,{dblclick:s}),this.addManagedElementListeners(e,{dblclick:s}),this.addManagedElementListeners(this.getGui(),{dblclick:r}),this.updateIconVisibility();const o=n.getProvidedColumnGroup(),a=this.updateIconVisibility.bind(this);this.addManagedListeners(o,{expandedChanged:a,expandableChanged:a})}addTouchAndClickListeners(e,t,n){e.touchSvc?.setupForHeaderGroup(this,t,n),this.addManagedElementListeners(t,{click:n})}updateIconVisibility(){const{agOpened:e,agClosed:t,params:{columnGroup:n}}=this;if(n.isExpandable()){const i=n.isExpanded();tn(e,i),tn(t,!i)}else tn(e,!1),tn(t,!1)}addInIcon(e,t){const n=Os(e,this.beans,null);n&&t.appendChild(n)}addGroupExpandIcon(e){if(!e.columnGroup.isExpandable()){const{agOpened:t,agClosed:n}=this;tn(t,!1),tn(n,!1);return}}setupLabel(e){const{displayName:t,columnGroup:n}=e,i=this.innerHeaderGroupComponent||this.isLoadingInnerComponent;if(Ce(t)&&!i){const r=Ol(t,!0);this.agLabel.textContent=r}this.addOrRemoveCssClass("ag-sticky-label",!n.getColGroupDef()?.suppressStickyLabel)}destroy(){super.destroy(),this.innerHeaderGroupComponent&&(this.destroyBean(this.innerHeaderGroupComponent),this.innerHeaderGroupComponent=void 0)}},$qe={moduleName:"ColumnHeaderComp",version:we,userComponents:{agColumnHeader:Oqe},icons:{menu:"menu",menuAlt:"menu-alt"}},Bqe={moduleName:"ColumnGroupHeaderComp",version:we,userComponents:{agColumnGroupHeader:Nqe},icons:{columnGroupOpened:"expanded",columnGroupClosed:"contracted"}},Gqe=class extends Z{constructor(){super(...arguments),this.beanName="animationFrameSvc",this.p1={list:[],sorted:!1},this.p2={list:[],sorted:!1},this.f1={list:[],sorted:!1},this.destroyTasks=[],this.ticking=!1,this.scrollGoingDown=!0,this.lastScrollTop=0,this.taskCount=0}setScrollTop(e){this.scrollGoingDown=e>=this.lastScrollTop,e===0&&(this.scrollGoingDown=!0),this.lastScrollTop=e}postConstruct(){this.active=!this.gos.get("suppressAnimationFrame"),this.batchFrameworkComps=this.beans.frameworkOverrides.batchFrameworkComps}verify(){this.active===!1&&de(92)}createTask(e,t,n,i){this.verify();let r=n;i&&this.batchFrameworkComps&&(r="f1");const s={task:e,index:t,createOrder:++this.taskCount};this.addTaskToList(this[r],s),this.schedule()}addTaskToList(e,t){e.list.push(t),e.sorted=!1}sortTaskList(e){if(e.sorted)return;const t=this.scrollGoingDown?1:-1;e.list.sort((n,i)=>n.index!==i.index?t*(i.index-n.index):i.createOrder-n.createOrder),e.sorted=!0}addDestroyTask(e){this.verify(),this.destroyTasks.push(e),this.schedule()}executeFrame(e){const{p1:t,p2:n,f1:i,destroyTasks:r,beans:s}=this,{ctrlsSvc:o,frameworkOverrides:a}=s,l=t.list,u=n.list,c=i.list,d=Date.now();let h=0;const p=e<=0,g=o.getScrollFeature();for(;p||h<e;){if(!g.scrollGridIfNeeded()){let C;if(l.length)this.sortTaskList(t),C=l.pop().task;else if(u.length)this.sortTaskList(n),C=u.pop().task;else if(c.length)a.wrapOutgoing(()=>{for(;(p||h<e)&&!g.scrollGridIfNeeded();){if(c.length)this.sortTaskList(i),C=c.pop().task,C();else break;h=Date.now()-d}}),C=()=>{};else if(r.length)C=r.pop();else break;C()}h=Date.now()-d}l.length||u.length||c.length||r.length?this.requestFrame():this.ticking=!1}flushAllFrames(){this.active&&this.executeFrame(-1)}schedule(){this.active&&(this.ticking||(this.ticking=!0,this.requestFrame()))}requestFrame(){const e=this.executeFrame.bind(this,60);lu(this.beans,e)}isQueueEmpty(){return!this.ticking}},zqe={moduleName:"AnimationFrame",version:we,beans:[Gqe]},Hqe=class extends Z{constructor(){super(...arguments),this.beanName="touchSvc"}mockBodyContextMenu(e,t){this.mockContextMenu(e,e.eBodyViewport,t)}mockHeaderContextMenu(e,t){this.mockContextMenu(e,e.eGui,t)}mockRowContextMenu(e){if(!Nd())return;const t=(n,i,r)=>{const{rowCtrl:s,cellCtrl:o}=e.getControlsForEventTarget(r?.target??null);o?.column&&o.dispatchCellContextMenuEvent(r??null),this.beans.contextMenuSvc?.handleContextMenuMouseEvent(void 0,r,s,o)};this.mockContextMenu(e,e.element,t)}handleCellDoubleClick(e,t){return(()=>{if(!Nd()||Dee("dblclick"))return!1;const i=Date.now(),r=i-e.lastIPadMouseClickEvent<200;return e.lastIPadMouseClickEvent=i,r})()?(e.onCellDoubleClicked(t),t.preventDefault(),!0):!1}setupForHeader(e){const{gos:t,sortSvc:n}=this.beans;if(t.get("suppressTouch"))return;const{params:i,eMenu:r,eFilterButton:s}=e,o=new xf(e.getGui(),!0),a=e.shouldSuppressMenuHide(),l=a&&Ce(r),u=l?new xf(r,!0):o;if(i.enableMenu){const c=l?"tap":"longTap",d=h=>i.showColumnMenuAfterMouseClick(h.touchStart);e.addManagedListeners(u,{[c]:d})}if(i.enableSorting){const c=d=>{const h=d.touchStart.target;a&&(r?.contains(h)||s?.contains(h))||n?.progressSort(i.column,!1,"uiColumnSorted")};e.addManagedListeners(o,{tap:c})}if(i.enableFilterButton&&s){const c=new xf(s,!0);e.addManagedListeners(c,{tap:()=>i.showFilter(s)}),e.addDestroyFunc(()=>c.destroy())}e.addDestroyFunc(()=>o.destroy()),l&&e.addDestroyFunc(()=>u.destroy())}setupForHeaderGroup(e,t,n){const i=new xf(t,!0);e.addManagedListeners(i,{tap:n}),e.addDestroyFunc(()=>i.destroy())}mockContextMenu(e,t,n){if(!Nd())return;const i=new xf(t),r=s=>{D0(this.gos,s.touchEvent)&&n(void 0,s.touchStart,s.touchEvent)};e.addManagedListeners(i,{longTap:r}),e.addDestroyFunc(()=>i.destroy())}},Vqe={moduleName:"Touch",version:we,beans:[Hqe]},Wqe=class extends Z{constructor(){super(...arguments),this.beanName="cellNavigation"}wireBeans(e){this.rowSpanSvc=e.rowSpanSvc}getNextCellToFocus(e,t,n=!1){return n?this.getNextCellToFocusWithCtrlPressed(e,t):this.getNextCellToFocusWithoutCtrlPressed(e,t)}getNextCellToFocusWithCtrlPressed(e,t){const n=e===X.UP,i=e===X.DOWN,r=e===X.LEFT;let s,o;const{pageBounds:a,gos:l,visibleCols:u}=this.beans;if(n||i)o=n?a.getFirstRow():a.getLastRow(),s=t.column;else{const c=l.get("enableRtl");o=t.rowIndex,s=(r!==c?u.allCols:[...u.allCols].reverse()).find(h=>this.isCellGoodToFocusOn({rowIndex:o,rowPinned:null,column:h}))}return s?{rowIndex:o,rowPinned:null,column:s}:null}getNextCellToFocusWithoutCtrlPressed(e,t){let n=t,i=!1;for(;!i;){switch(e){case X.UP:n=this.getCellAbove(n);break;case X.DOWN:n=this.getCellBelow(n);break;case X.RIGHT:n=this.gos.get("enableRtl")?this.getCellToLeft(n):this.getCellToRight(n);break;case X.LEFT:n=this.gos.get("enableRtl")?this.getCellToRight(n):this.getCellToLeft(n);break;default:n=null,de(8,{key:e});break}n?i=this.isCellGoodToFocusOn(n):i=!0}return n}isCellGoodToFocusOn(e){const t=e.column;let n;const{pinnedRowModel:i,rowModel:r}=this.beans;switch(e.rowPinned){case"top":n=i?.getPinnedTopRow(e.rowIndex);break;case"bottom":n=i?.getPinnedBottomRow(e.rowIndex);break;default:n=r.getRow(e.rowIndex);break}return n?!this.isSuppressNavigable(t,n):!1}getCellToLeft(e){if(!e)return null;const t=this.beans.visibleCols.getColBefore(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellToRight(e){if(!e)return null;const t=this.beans.visibleCols.getColAfter(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellBelow(e){if(!e)return null;const t=this.rowSpanSvc?.getCellEnd(e)??e,n=SW(this.beans,t);return n?{rowIndex:n.rowIndex,column:e.column,rowPinned:n.rowPinned}:null}getCellAbove(e){if(!e)return null;const t=this.rowSpanSvc?.getCellStart(e)??e,n=C1(this.beans,{rowIndex:t.rowIndex,rowPinned:t.rowPinned});return n?{rowIndex:n.rowIndex,column:e.column,rowPinned:n.rowPinned}:null}getNextTabbedCell(e,t){return t?this.getNextTabbedCellBackwards(e):this.getNextTabbedCellForwards(e)}getNextTabbedCellForwards(e){const{visibleCols:t,pagination:n}=this.beans,i=t.allCols;let r=e.rowIndex,s=e.rowPinned,o=t.getColAfter(e.column);if(!o){o=i[0];const a=SW(this.beans,e);if(Xt(a)||!a.rowPinned&&!(n?.isRowInPage(a.rowIndex)??!0))return null;r=a?a.rowIndex:null,s=a?a.rowPinned:null}return{rowIndex:r,column:o,rowPinned:s}}getNextTabbedCellBackwards(e){const{beans:t}=this,{visibleCols:n,pagination:i}=t,r=n.allCols;let s=e.rowIndex,o=e.rowPinned,a=n.getColBefore(e.column);if(!a){a=Lt(r);const l=C1(t,{rowIndex:e.rowIndex,rowPinned:e.rowPinned});if(Xt(l)||!l.rowPinned&&!(i?.isRowInPage(l.rowIndex)??!0))return null;s=l?l.rowIndex:null,o=l?l.rowPinned:null}return{rowIndex:s,column:a,rowPinned:o}}isSuppressNavigable(e,t){const{suppressNavigable:n}=e.colDef;if(typeof n=="boolean")return n;if(typeof n=="function"){const i=e.createColumnFunctionCallbackParams(t);return n(i)}return!1}};function Uqe(e){return e.focusSvc.getFocusedCell()}function qqe(e){return e.focusSvc.clearFocusedCell()}function jqe(e,t,n,i){e.focusSvc.setFocusedCell({rowIndex:t,column:n,rowPinned:i,forceBrowserFocus:!0})}function Kqe(e,t){return e.navigation?.tabToNextCell(!1,t)??!1}function Yqe(e,t){return e.navigation?.tabToNextCell(!0,t)??!1}function Xqe(e,t,n=!1){const i=e.headerNavigation?.getHeaderPositionForColumn(t,n);i&&e.focusSvc.focusHeaderPosition({headerPosition:i})}var Qqe=class extends Z{constructor(){super(),this.beanName="navigation",this.onPageDown=hW(this.onPageDown,100),this.onPageUp=hW(this.onPageUp,100)}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl})}handlePageScrollingKey(e,t=!1){const n=e.key,i=e.altKey,r=e.ctrlKey||e.metaKey,s=!!this.beans.rangeSvc&&e.shiftKey,o=n4e(this.gos,e);let a=!1;switch(n){case X.PAGE_HOME:case X.PAGE_END:!r&&!i&&(this.onHomeOrEndKey(n),a=!0);break;case X.LEFT:case X.RIGHT:case X.UP:case X.DOWN:if(!o)return!1;r&&!i&&!s&&(this.onCtrlUpDownLeftRight(n,o),a=!0);break;case X.PAGE_DOWN:case X.PAGE_UP:!r&&!i&&(a=this.handlePageUpDown(n,o,t));break}return a&&e.preventDefault(),a}handlePageUpDown(e,t,n){return n&&(t=this.beans.focusSvc.getFocusedCell()),t?(e===X.PAGE_UP?this.onPageUp(t):this.onPageDown(t),!0):!1}navigateTo(e){const{scrollIndex:t,scrollType:n,scrollColumn:i,focusIndex:r,focusColumn:s}=e,{scrollFeature:o}=this.gridBodyCon;Ce(i)&&!i.isPinned()&&o.ensureColumnVisible(i),Ce(t)&&o.ensureIndexVisible(t,n),e.isAsync||o.ensureIndexVisible(r);const{focusSvc:a,rangeSvc:l}=this.beans;a.setFocusedCell({rowIndex:r,column:s,rowPinned:null,forceBrowserFocus:!0}),l?.setRangeToCell({rowIndex:r,rowPinned:null,column:s})}onPageDown(e){const t=this.beans,n=sk(t),i=this.getViewportHeight(),{pageBounds:r,rowModel:s,rowAutoHeight:o}=t,a=r.getPixelOffset(),l=n.top+i,u=s.getRowIndexAtPixel(l+a);o?.active?this.navigateToNextPageWithAutoHeight(e,u):this.navigateToNextPage(e,u)}onPageUp(e){const t=this.beans,n=sk(t),{pageBounds:i,rowModel:r,rowAutoHeight:s}=t,o=i.getPixelOffset(),a=n.top,l=r.getRowIndexAtPixel(a+o);s?.active?this.navigateToNextPageWithAutoHeight(e,l,!0):this.navigateToNextPage(e,l,!0)}navigateToNextPage(e,t,n=!1){const{pageBounds:i,rowModel:r}=this.beans,s=this.getViewportHeight(),o=i.getFirstRow(),a=i.getLastRow(),l=i.getPixelOffset(),u=r.getRow(e.rowIndex),c=n?u?.rowHeight-s-l:s-l,d=u?.rowTop+c;let h=r.getRowIndexAtPixel(d+l);if(h===e.rowIndex){const g=n?-1:1;t=h=e.rowIndex+g}let p;n?(p="bottom",h<o&&(h=o),t<o&&(t=o)):(p="top",h>a&&(h=a),t>a&&(t=a)),this.isRowTallerThanView(r.getRow(h))&&(t=h,p="top"),this.navigateTo({scrollIndex:t,scrollType:p,scrollColumn:null,focusIndex:h,focusColumn:e.column})}navigateToNextPageWithAutoHeight(e,t,n=!1){this.navigateTo({scrollIndex:t,scrollType:n?"bottom":"top",scrollColumn:null,focusIndex:t,focusColumn:e.column}),setTimeout(()=>{const i=this.getNextFocusIndexForAutoHeight(e,n);this.navigateTo({scrollIndex:t,scrollType:n?"bottom":"top",scrollColumn:null,focusIndex:i,focusColumn:e.column,isAsync:!0})},50)}getNextFocusIndexForAutoHeight(e,t=!1){const n=t?-1:1,i=this.getViewportHeight(),{pageBounds:r,rowModel:s}=this.beans,o=r.getLastRow();let a=0,l=e.rowIndex;for(;l>=0&&l<=o;){const u=s.getRow(l);if(u){const c=u.rowHeight??0;if(a+c>i)break;a+=c}l+=n}return Math.max(0,Math.min(l,o))}getViewportHeight(){const e=this.beans,t=sk(e),n=this.beans.scrollVisibleSvc.getScrollbarWidth();let i=t.bottom-t.top;return e.ctrlsSvc.get("center").isHorizontalScrollShowing()&&(i-=n),i}isRowTallerThanView(e){if(!e)return!1;const t=e.rowHeight;return typeof t!="number"?!1:t>this.getViewportHeight()}onCtrlUpDownLeftRight(e,t){const n=this.beans.cellNavigation.getNextCellToFocus(e,t,!0),{rowIndex:i}=n,r=n.column;this.navigateTo({scrollIndex:i,scrollType:null,scrollColumn:r,focusIndex:i,focusColumn:r})}onHomeOrEndKey(e){const t=e===X.PAGE_HOME,{visibleCols:n,pageBounds:i,rowModel:r}=this.beans,s=n.allCols,o=t?i.getFirstRow():i.getLastRow(),a=r.getRow(o);if(!a)return;const l=(t?s:[...s].reverse()).find(u=>!u.isSuppressNavigable(a));l&&this.navigateTo({scrollIndex:o,scrollType:null,scrollColumn:l,focusIndex:o,focusColumn:l})}onTabKeyDown(e,t){const n=t.shiftKey,i=this.tabToNextCellCommon(e,n,t),r=this.beans,{ctrlsSvc:s,pageBounds:o,focusSvc:a,gos:l}=r;if(i!==!1){i?t.preventDefault():i===null&&s.get("gridCtrl").allowFocusForNextCoreContainer(n);return}if(n){const{rowIndex:u,rowPinned:c}=e.getRowPosition();(c?u===0:u===o.getFirstRow())&&(l.get("headerHeight")===0||Hd(r)?Hp(r,!0,!0):(t.preventDefault(),a.focusPreviousFromFirstCell(t)))}else e instanceof Pv&&e.focusCell(!0),(!n&&a.focusOverlay(!1)||Hp(r,n))&&t.preventDefault()}tabToNextCell(e,t){const n=this.beans,{focusSvc:i,rowRenderer:r}=n,s=i.getFocusedCell();if(!s)return!1;let o=Tf(n,s);return!o&&(o=r.getRowByPosition(s),!o||!o.isFullWidth())?!1:!!this.tabToNextCellCommon(o,e,t)}tabToNextCellCommon(e,t,n){let i=e.editing;if(!i&&e instanceof Pv){const o=e.rowCtrl;o&&(i=o.editing)}let r;return i?this.gos.get("editType")==="fullRow"?r=this.moveToNextEditingRow(e,t,n):r=this.moveToNextEditingCell(e,t,n):r=this.moveToNextCellNotEditing(e,t,n),r===null?r:r||!!this.beans.focusSvc.focusedHeader}moveToNextEditingCell(e,t,n=null){const i=e.cellPosition;e.eGui.focus(),e.stopEditing();const r=this.findNextCellToFocusOn(i,t,!0);return r===!1?null:r==null?!1:(this.beans.editSvc?.startEditing(r,null,!0,n),r.focusCell(!1),!0)}moveToNextEditingRow(e,t,n=null){const i=e.cellPosition,r=this.findNextCellToFocusOn(i,t,!0);if(r===!1)return null;if(r==null)return!1;const s=r.cellPosition,o=this.isCellEditable(i),a=this.isCellEditable(s),l=s&&i.rowIndex===s.rowIndex&&i.rowPinned===s.rowPinned,{editSvc:u,rowEditSvc:c}=this.beans;if(o&&u?.setFocusOutOnEditor(e),!l){const d=e.rowCtrl;u?.stopRowEditing(d);const h=r.rowCtrl;c?.startEditing(h,void 0,void 0,n)}return a?(u?.setFocusInOnEditor(r),r.focusCell()):r.focusCell(!0),!0}moveToNextCellNotEditing(e,t,n){const i=this.beans.visibleCols.allCols;let r;if(e instanceof b1){if(r={...e.getRowPosition(),column:t?i[0]:Lt(i)},this.gos.get("embedFullWidthRows")&&n){const o=e.findFullWidthInfoForEvent(n);o&&(r.column=o.column)}}else r=e.getFocusedCellPosition();const s=this.findNextCellToFocusOn(r,t,!1);if(s===!1)return null;if(s instanceof Pv)s.focusCell(!0);else if(s)return this.tryToFocusFullWidthRow(s,t);return Ce(s)}findNextCellToFocusOn(e,t,n){let i=e;const r=this.beans,{cellNavigation:s,gos:o,focusSvc:a,rowRenderer:l,rangeSvc:u}=r;for(;;){e!==i&&(e=i),t||(i=this.getLastCellOfColSpan(i)),i=s.getNextTabbedCell(i,t);const c=o.getCallback("tabToNextCell");if(Ce(c)){const g=c({backwards:t,editing:n,previousCellPosition:e,nextCellPosition:i||null});if(g===!0)i=e;else{if(g===!1)return!1;i={rowIndex:g.rowIndex,column:g.column,rowPinned:g.rowPinned}}}if(!i)return null;if(i.rowIndex<0){const p=va(r);return a.focusHeaderPosition({headerPosition:{headerRowIndex:p+i.rowIndex,column:i.column},fromCell:!0}),null}const d=o.get("editType")==="fullRow";if(n&&!d&&!this.isCellEditable(i))continue;this.ensureCellVisible(i);const h=Tf(r,i);if(!h){const p=l.getRowByPosition(i);if(!p||!p.isFullWidth()||n)continue;return{...p.getRowPosition(),column:i?.column}}if(!s.isSuppressNavigable(h.column,h.rowNode))return h.setFocusedCellPosition(i),u?.setRangeToCell(i),h}}isCellEditable(e){const t=this.lookupRowNodeForCell(e);return t?e.column.isCellEditable(t):!1}lookupRowNodeForCell({rowIndex:e,rowPinned:t}){const{pinnedRowModel:n,rowModel:i}=this.beans;return t==="top"?n?.getPinnedTopRow(e):t==="bottom"?n?.getPinnedBottomRow(e):i.getRow(e)}navigateToNextCell(e,t,n,i){let r=n,s=!1;const o=this.beans,{cellNavigation:a,focusSvc:l,gos:u}=o;for(;r&&(r===n||!this.isValidNavigateCell(r));)u.get("enableRtl")?t===X.LEFT&&(r=this.getLastCellOfColSpan(r)):t===X.RIGHT&&(r=this.getLastCellOfColSpan(r)),r=a.getNextCellToFocus(t,r),s=Xt(r);if(s&&e&&e.key===X.UP&&(r={rowIndex:-1,rowPinned:null,column:n.column}),i){const d=u.getCallback("navigateToNextCell");if(Ce(d)){const p=d({key:t,previousCellPosition:n,nextCellPosition:r||null,event:e});Ce(p)?r={rowPinned:p.rowPinned,rowIndex:p.rowIndex,column:p.column}:r=null}}if(!r)return;if(r.rowIndex<0){const d=va(o);l.focusHeaderPosition({headerPosition:{headerRowIndex:d+r.rowIndex,column:n.column},event:e||void 0,fromCell:!0});return}const c=this.getNormalisedPosition(r);c?this.focusPosition(c):this.tryToFocusFullWidthRow(r)}getNormalisedPosition(e){if(!!this.beans.spannedRowRenderer?.getCellByPosition(e))return e;this.ensureCellVisible(e);const n=Tf(this.beans,e);return n?(e=n.getFocusedCellPosition(),this.ensureCellVisible(e),e):null}tryToFocusFullWidthRow(e,t){const{visibleCols:n,rowRenderer:i,focusSvc:r,eventSvc:s}=this.beans,o=n.allCols,a=i.getRowByPosition(e);if(!a||!a.isFullWidth())return!1;const l=r.getFocusedCell(),u={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column||(t?Lt(o):o[0])};this.focusPosition(u);const c=t??(l!=null&&o4e(u,l));return s.dispatchEvent({type:"fullWidthRowFocused",rowIndex:u.rowIndex,rowPinned:u.rowPinned,column:u.column,isFullWidthCell:!0,fromBelow:c}),!0}focusPosition(e){const{focusSvc:t,rangeSvc:n}=this.beans;t.setFocusedCell({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0}),n?.setRangeToCell(e)}isValidNavigateCell(e){return!!v1(this.beans,e)}getLastCellOfColSpan(e){const t=Tf(this.beans,e);if(!t)return e;const n=t.getColSpanningList();return n.length===1?e:{rowIndex:e.rowIndex,column:Lt(n),rowPinned:e.rowPinned}}ensureCellVisible(e){const t=Ree(this.gos),n=this.beans.rowModel.getRow(e.rowIndex),i=t&&n?.sticky,{scrollFeature:r}=this.gridBodyCon;!i&&Xt(e.rowPinned)&&r.ensureIndexVisible(e.rowIndex),e.column.isPinned()||r.ensureColumnVisible(e.column)}};function sk(e){return e.ctrlsSvc.getScrollFeature().getVScrollPosition()}var Zqe={moduleName:"KeyboardNavigation",version:we,beans:[Qqe,Wqe,xqe],apiFunctions:{getFocusedCell:Uqe,clearFocusedCell:qqe,setFocusedCell:jqe,setFocusedHeader:Xqe,tabToNextCell:Kqe,tabToPreviousCell:Yqe}},Jqe=class extends Z{constructor(){super(...arguments),this.beanName="pageBoundsListener"}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this),recalculateRowBounds:this.calculatePages.bind(this)}),this.onModelUpdated()}onModelUpdated(e){this.calculatePages(),this.eventSvc.dispatchEvent({type:"paginationChanged",animate:e?.animate??!1,newData:e?.newData??!1,newPage:e?.newPage??!1,newPageSize:e?.newPageSize??!1,keepRenderedRows:e?.keepRenderedRows??!1})}calculatePages(){const{pageBounds:e,pagination:t,rowModel:n}=this.beans;t?t.calculatePages():e.calculateBounds(0,n.getRowCount()-1)}},eje=class extends Z{constructor(){super(...arguments),this.beanName="pageBounds",this.pixelOffset=0}getFirstRow(){return this.topRowBounds?.rowIndex??-1}getLastRow(){return this.bottomRowBounds?.rowIndex??-1}getCurrentPageHeight(){const{topRowBounds:e,bottomRowBounds:t}=this;return!e||!t?0:Math.max(t.rowTop+t.rowHeight-e.rowTop,0)}getCurrentPagePixelRange(){const{topRowBounds:e,bottomRowBounds:t}=this,n=e?.rowTop??0,i=t?t.rowTop+t.rowHeight:0;return{pageFirstPixel:n,pageLastPixel:i}}calculateBounds(e,t){const{rowModel:n}=this.beans,i=n.getRowBounds(e);i&&(i.rowIndex=e),this.topRowBounds=i;const r=n.getRowBounds(t);r&&(r.rowIndex=t),this.bottomRowBounds=r,this.calculatePixelOffset()}getPixelOffset(){return this.pixelOffset}calculatePixelOffset(){const e=this.topRowBounds?.rowTop??0;this.pixelOffset!==e&&(this.pixelOffset=e,this.eventSvc.dispatchEvent({type:"paginationPixelOffsetChanged"}))}},tje=".ag-pinned-left-floating-bottom,.ag-pinned-left-floating-top,.ag-pinned-right-floating-bottom,.ag-pinned-right-floating-top{min-width:0;overflow:hidden;position:relative}.ag-pinned-left-sticky-top,.ag-pinned-right-sticky-top{height:100%;overflow:hidden;position:relative}.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{height:100%;overflow:hidden;width:100%}.ag-pinned-left-header,.ag-pinned-right-header{display:inline-block;height:100%;overflow:hidden;position:relative}.ag-body-horizontal-scroll:not(.ag-scrollbar-invisible){.ag-horizontal-left-spacer:not(.ag-scroller-corner){border-right:var(--ag-pinned-column-border)}.ag-horizontal-right-spacer:not(.ag-scroller-corner){border-left:var(--ag-pinned-column-border)}}.ag-pinned-right-header{border-left:var(--ag-pinned-column-border)}.ag-pinned-left-header{border-right:var(--ag-pinned-column-border)}.ag-cell.ag-cell-first-right-pinned:not(.ag-cell-range-left,.ag-cell-range-single-cell,.ag-cell-focus:not(.ag-cell-range-selected):focus-within){border-left:var(--ag-pinned-column-border)}.ag-cell.ag-cell-last-left-pinned:not(.ag-cell-range-right,.ag-cell-range-single-cell,.ag-cell-focus:not(.ag-cell-range-selected):focus-within){border-right:var(--ag-pinned-column-border)}.ag-pinned-left-header .ag-header-cell-resize:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}.ag-pinned-right-header .ag-header-cell-resize:after{left:50%}.ag-pinned-left-header .ag-header-cell-resize{right:-3px}.ag-pinned-right-header .ag-header-cell-resize{left:-3px}",nje=class extends Z{constructor(e,t){super(),this.isLeft=e,this.elements=t,this.getWidth=e?()=>this.beans.pinnedCols.leftWidth:()=>this.beans.pinnedCols.rightWidth}postConstruct(){this.addManagedEventListeners({[`${this.isLeft?"left":"right"}PinnedWidthChanged`]:this.onPinnedWidthChanged.bind(this)})}onPinnedWidthChanged(){const e=this.getWidth(),t=e>0;for(const n of this.elements)n&&(tn(n,t),Ra(n,e))}},ije=class extends Z{constructor(){super(...arguments),this.beanName="pinnedCols"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,t=>{this.gridBodyCtrl=t.gridBodyCtrl});const e=this.checkContainerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}checkContainerWidths(){const{gos:e,visibleCols:t,eventSvc:n}=this.beans,i=Si(e,"print"),r=i?0:t.getColsLeftWidth(),s=i?0:t.getDisplayedColumnsRightWidth();r!=this.leftWidth&&(this.leftWidth=r,n.dispatchEvent({type:"leftPinnedWidthChanged"})),s!=this.rightWidth&&(this.rightWidth=s,n.dispatchEvent({type:"rightPinnedWidthChanged"}))}keepPinnedColumnsNarrowerThanViewport(){const e=this.gridBodyCtrl.eBodyViewport,t=w0(e);if(t<=50)return;const n=this.getPinnedColumnsOverflowingViewport(t-50),i=this.gos.getCallback("processUnpinnedColumns"),{columns:r,hasLockedPinned:s}=n;let o=r;!o.length&&!s||(i&&(o=i({columns:o,viewportWidth:t})),!(!o||!o.length)&&(o=o.filter(a=>!Gp(a)),this.setColsPinned(o,null,"viewportSizeFeature")))}createPinnedWidthFeature(e,...t){return new nje(e,t)}setColsPinned(e,t,n){const{colModel:i,colAnimation:r,visibleCols:s,gos:o}=this.beans;if(!i.cols||!e?.length)return;if(Si(o,"print")){de(37);return}r?.start();let a;t===!0||t==="left"?a="left":t==="right"?a="right":a=null;const l=[];e.forEach(u=>{if(!u)return;const c=i.getCol(u);c&&c.getPinned()!==a&&(this.setColPinned(c,a),l.push(c))}),l.length&&(s.refresh(n),zee(this.eventSvc,l,n)),r?.finish()}initCol(e){const{pinned:t,initialPinned:n}=e.colDef;t!==void 0?this.setColPinned(e,t):this.setColPinned(e,n)}setColPinned(e,t){t===!0||t==="left"?e.pinned="left":t==="right"?e.pinned="right":e.pinned=null,e.dispatchStateUpdatedEvent("pinned")}setupHeaderPinnedWidth(e){const{scrollVisibleSvc:t}=this.beans;if(e.pinned==null)return;const n=e.pinned==="left",i=e.pinned==="right";e.hidden=!0;const r=()=>{const s=n?this.leftWidth:this.rightWidth;if(s==null)return;const o=s==0,a=e.hidden!==o,l=this.gos.get("enableRtl"),u=t.getScrollbarWidth(),d=t.verticalScrollShowing&&(l&&n||!l&&i)?s+u:s;e.comp.setPinnedContainerWidth(`${d}px`),e.comp.setDisplayed(!o),a&&(e.hidden=o,e.refresh())};e.addManagedEventListeners({leftPinnedWidthChanged:r,rightPinnedWidthChanged:r,scrollVisibilityChanged:r,scrollbarWidthChanged:r})}getHeaderResizeDiff(e,t){if(t.getPinned()){const{leftWidth:i,rightWidth:r}=this,s=w0(this.beans.ctrlsSvc.getGridBodyCtrl().eBodyViewport)-50;if(i+r+e>s)if(s>i+r)e=s-i-r;else return 0}return e}getPinnedColumnsOverflowingViewport(e){const t=this.rightWidth??0,n=this.leftWidth??0,i=t+n;let r=!1;if(i<e)return{columns:[],hasLockedPinned:r};const{visibleCols:s}=this.beans,o=[...s.leftCols],a=[...s.rightCols];let l=0,u=0;const c=0,d=[];let h=i-c-e;for(;(u<o.length||l<a.length)&&h>0;){if(l<a.length){const p=a[l++];if(p.colDef.lockPinned){r=!0;continue}h-=p.getActualWidth(),d.push(p)}if(u<o.length&&h>0){const p=o[u++];if(p.colDef.lockPinned){r=!0;continue}h-=p.getActualWidth(),d.push(p)}}return{columns:d,hasLockedPinned:r}}},rje={moduleName:"PinnedColumn",version:we,beans:[ije],css:[tje]},sje=class extends Z{constructor(){super(),this.beanName="ariaAnnounce",this.descriptionContainer=null,this.pendingAnnouncements=new Map,this.lastAnnouncement="",this.updateAnnouncement=yi(this,this.updateAnnouncement.bind(this),200)}postConstruct(){const e=this.beans,t=Pn(e),n=this.descriptionContainer=t.createElement("div");n.classList.add("ag-aria-description-container"),JJ(n,"polite"),g5e(n,"additions text"),p5e(n,!0),e.eGridDiv.appendChild(n)}announceValue(e,t){this.pendingAnnouncements.set(t,e),this.updateAnnouncement()}updateAnnouncement(){if(!this.descriptionContainer)return;const e=Array.from(this.pendingAnnouncements.values()).join(". ");this.pendingAnnouncements.clear(),this.descriptionContainer.textContent="",setTimeout(()=>{if(this.isAlive()&&this.descriptionContainer){let t=e;this.lastAnnouncement===t&&(t=`${t}.`),this.lastAnnouncement=t,this.descriptionContainer.textContent=t}},50)}destroy(){super.destroy();const{descriptionContainer:e}=this;e&&(Gi(e),e.parentElement?.removeChild(e)),this.descriptionContainer=null,this.pendingAnnouncements.clear()}},oje={moduleName:"Aria",version:we,beans:[sje]};function aje(e){e.overlays?.showLoadingOverlay()}function lje(e){e.overlays?.showNoRowsOverlay()}function uje(e){e.overlays?.hideOverlay()}var cje=".ag-overlay{inset:0;pointer-events:none;position:absolute;z-index:2}.ag-overlay-panel,.ag-overlay-wrapper{display:flex;height:100%;width:100%}.ag-overlay-wrapper{align-items:center;flex:none;justify-content:center;text-align:center}.ag-overlay-loading-wrapper{pointer-events:all}.ag-overlay-loading-center{background:var(--ag-background-color);border:1px solid var(--ag-border-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-popup-shadow);padding:var(--ag-spacing)}",dje={tag:"div",cls:"ag-overlay",role:"presentation",children:[{tag:"div",cls:"ag-overlay-panel",role:"presentation",children:[{tag:"div",ref:"eOverlayWrapper",cls:"ag-overlay-wrapper",role:"presentation"}]}]},Xte=class extends At{constructor(){super(dje),this.eOverlayWrapper=ve,this.activePromise=null,this.activeOverlay=null,this.updateListenerDestroyFunc=null,this.activeCssClass=null,this.elToFocusAfter=null,this.registerCSS(cje)}handleKeyDown(e){if(e.key!==X.TAB||e.defaultPrevented||_l(e))return;const t=this.beans;if($h(t,this.eOverlayWrapper,!1,e.shiftKey))return;let i=!1;e.shiftKey?i=t.focusSvc.focusGridView({column:Lt(t.visibleCols.allCols),backwards:!0,canFocusOverlay:!1}):i=Hp(t,!1),i&&e.preventDefault()}updateLayoutClasses(e,t){const n=this.eOverlayWrapper.classList,{AUTO_HEIGHT:i,NORMAL:r,PRINT:s}=po;n.toggle(i,t.autoHeight),n.toggle(r,t.normal),n.toggle(s,t.print)}postConstruct(){this.createManagedBean(new yN(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.beans.overlays.setOverlayWrapperComp(this),this.addManagedElementListeners(this.getFocusableElement(),{keydown:this.handleKeyDown.bind(this)})}setWrapperTypeClass(e){const t=this.eOverlayWrapper.classList;this.activeCssClass&&t.toggle(this.activeCssClass,!1),this.activeCssClass=e,t.toggle(e,!0)}showOverlay(e,t,n,i){if(this.setWrapperTypeClass(t),this.destroyActiveOverlay(),this.elToFocusAfter=null,this.activePromise=e,!!e){if(this.setDisplayed(!0,{skipAriaHidden:!0}),n&&this.isGridFocused()){const r=nn(this.beans);r&&!xee(this.beans)&&(this.elToFocusAfter=r)}e.then(r=>{if(this.activePromise!==e){this.activeOverlay!==r&&(this.destroyBean(r),r=null);return}if(this.activePromise=null,!!r){if(this.activeOverlay!==r&&(this.eOverlayWrapper.appendChild(r.getGui()),this.activeOverlay=r,i)){const s=r;this.updateListenerDestroyFunc=this.addManagedPropertyListener(i,({currentValue:o})=>{s.refresh?.(ze(this.gos,{...o??{}}))})}n&&this.isGridFocused()&&ph(this.eOverlayWrapper)}})}}updateOverlayWrapperPaddingTop(e){this.eOverlayWrapper.style.setProperty("padding-top",`${e}px`)}destroyActiveOverlay(){this.activePromise=null;const e=this.activeOverlay;if(!e)return;let t=this.elToFocusAfter;this.activeOverlay=null,this.elToFocusAfter=null,t&&!this.isGridFocused()&&(t=null);const n=this.updateListenerDestroyFunc;n&&(n(),this.updateListenerDestroyFunc=null),this.destroyBean(e),Gi(this.eOverlayWrapper),t?.focus?.({preventScroll:!0})}hideOverlay(){this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})}isGridFocused(){const e=nn(this.beans);return!!e&&this.beans.eGridDiv.contains(e)}destroy(){this.elToFocusAfter=null,this.destroyActiveOverlay(),this.beans.overlays.setOverlayWrapperComp(void 0),super.destroy()}},hje={selector:"AG-OVERLAY-WRAPPER",component:Xte},fje=class extends Z{constructor(){super(...arguments),this.beanName="overlays",this.state=0,this.showInitialOverlay=!0,this.wrapperPadding=0}postConstruct(){this.isClientSide=tr(this.gos),this.isServerSide=!this.isClientSide&&bg(this.gos);const e=()=>this.updateOverlayVisibility();this.addManagedEventListeners({newColumnsLoaded:e,rowDataUpdated:e,gridSizeChanged:this.refreshWrapperPadding.bind(this),rowCountReady:()=>{this.showInitialOverlay=!1,this.updateOverlayVisibility()}}),this.addManagedPropertyListener("loading",e)}setOverlayWrapperComp(e){this.eWrapper=e,this.updateOverlayVisibility()}isVisible(){return this.state!==0&&!!this.eWrapper}isExclusive(){return this.state===1&&!!this.eWrapper}showLoadingOverlay(){this.showInitialOverlay=!1;const e=this.gos,t=e.get("loading");!t&&(t!==void 0||e.get("suppressLoadingOverlay"))||this.doShowLoadingOverlay()}showNoRowsOverlay(){this.showInitialOverlay=!1;const e=this.gos;e.get("loading")||e.get("suppressNoRowsOverlay")||this.doShowNoRowsOverlay()}hideOverlay(){if(this.showInitialOverlay=!1,this.gos.get("loading")){de(99);return}this.doHideOverlay()}getOverlayWrapperSelector(){return hje}getOverlayWrapperCompClass(){return Xte}updateOverlayVisibility(){if(!this.eWrapper){this.state=0;return}const{state:e,isClientSide:t,isServerSide:n,beans:{gos:i,colModel:r,rowModel:s}}=this;let o=this.gos.get("loading");o!==void 0&&(this.showInitialOverlay=!1),this.showInitialOverlay&&o===void 0&&!i.get("suppressLoadingOverlay")&&(o=!i.get("columnDefs")||!r.ready||!i.get("rowData")&&t),o?e!==1&&this.doShowLoadingOverlay():(this.showInitialOverlay=!1,t&&s.isEmpty()&&!i.get("suppressNoRowsOverlay")?e!==2&&this.doShowNoRowsOverlay():(e===1||!n&&e!==0)&&this.doHideOverlay())}doShowLoadingOverlay(){this.eWrapper&&(this.state=1,this.showOverlay(CWe(this.beans.userCompFactory,ze(this.gos,{})),"ag-overlay-loading-wrapper","loadingOverlayComponentParams"),this.updateExclusive())}doShowNoRowsOverlay(){this.eWrapper&&(this.state=2,this.showOverlay(yWe(this.beans.userCompFactory,ze(this.gos,{})),"ag-overlay-no-rows-wrapper","noRowsOverlayComponentParams"),this.updateExclusive())}doHideOverlay(){this.eWrapper&&(this.state=0,this.eWrapper.hideOverlay(),this.updateExclusive())}showOverlay(e,t,n){const i=e?.newAgStackInstance()??null;this.eWrapper?.showOverlay(i,t,this.isExclusive(),n),this.refreshWrapperPadding()}updateExclusive(){const e=this.exclusive;this.exclusive=this.isExclusive(),this.exclusive!==e&&this.eventSvc.dispatchEvent({type:"overlayExclusiveChanged"})}refreshWrapperPadding(){const e=this.eWrapper;if(!e)return;let t=0;this.state===2?t=this.beans.ctrlsSvc.get("gridHeaderCtrl")?.headerHeight||0:this.wrapperPadding!==0&&(t=0),this.wrapperPadding!==t&&(this.wrapperPadding=t,e.updateOverlayWrapperPaddingTop(t))}},pje={moduleName:"Overlay",version:we,userComponents:{agLoadingOverlay:w8e,agNoRowsOverlay:S8e},apiFunctions:{showLoadingOverlay:aje,showNoRowsOverlay:lje,hideOverlay:uje},beans:[fje]},gje=class extends Z{constructor(){super(...arguments),this.beanName="rowContainerHeight",this.scrollY=0,this.uiBodyHeight=0}postConstruct(){this.addManagedEventListeners({bodyHeightChanged:this.updateOffset.bind(this)}),this.maxDivHeight=A5e(),fc(this.gos,"RowContainerHeightService - maxDivHeight = "+this.maxDivHeight)}updateOffset(){if(!this.stretching)return;const e=this.beans.ctrlsSvc.getScrollFeature().getVScrollPosition().top,t=this.getUiBodyHeight();(e!==this.scrollY||t!==this.uiBodyHeight)&&(this.scrollY=e,this.uiBodyHeight=t,this.calculateOffset())}calculateOffset(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;const e=this.scrollY/this.maxScrollY,t=e*this.pixelsToShave;fc(this.gos,`RowContainerHeightService - Div Stretch Offset = ${t} (${this.pixelsToShave} * ${e})`),this.setDivStretchOffset(t)}setUiContainerHeight(e){e!==this.uiContainerHeight&&(this.uiContainerHeight=e,this.eventSvc.dispatchEvent({type:"rowContainerHeightChanged"}))}clearOffset(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)}setDivStretchOffset(e){const t=typeof e=="number"?Math.floor(e):null;this.divStretchOffset!==t&&(this.divStretchOffset=t,this.eventSvc.dispatchEvent({type:"heightScaleChanged"}))}setModelHeight(e){this.modelHeight=e,this.stretching=e!=null&&this.maxDivHeight>0&&e>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()}getRealPixelPosition(e){return e-this.divStretchOffset}getUiBodyHeight(){const e=this.beans.ctrlsSvc.getScrollFeature().getVScrollPosition();return e.bottom-e.top}getScrollPositionForPixel(e){if(this.pixelsToShave<=0)return e;const t=this.modelHeight-this.getUiBodyHeight(),n=e/t;return this.maxScrollY*n}},mje=400,vje=class extends Z{constructor(){super(...arguments),this.beanName="rowRenderer",this.destroyFuncsForColumnListeners=[],this.rowCtrlsByRowIndex={},this.zombieRowCtrls={},this.allRowCtrls=[],this.topRowCtrls=[],this.bottomRowCtrls=[],this.refreshInProgress=!1,this.dataFirstRenderedFired=!1,this.setupRangeSelectionListeners=()=>{const e=()=>{this.getAllCellCtrls().forEach(s=>s.onCellSelectionChanged())},t=()=>{this.getAllCellCtrls().forEach(s=>s.updateRangeBordersIfRangeCount())},n=()=>{this.eventSvc.addEventListener("cellSelectionChanged",e),this.eventSvc.addEventListener("columnMoved",t),this.eventSvc.addEventListener("columnPinned",t),this.eventSvc.addEventListener("columnVisible",t)},i=()=>{this.eventSvc.removeEventListener("cellSelectionChanged",e),this.eventSvc.removeEventListener("columnMoved",t),this.eventSvc.removeEventListener("columnPinned",t),this.eventSvc.removeEventListener("columnVisible",t)};this.addDestroyFunc(()=>i()),this.addManagedPropertyListeners(["enableRangeSelection","cellSelection"],()=>{Wl(this.gos)?n():i()}),Wl(this.gos)&&n()}}wireBeans(e){this.pageBounds=e.pageBounds,this.colModel=e.colModel,this.pinnedRowModel=e.pinnedRowModel,this.rowModel=e.rowModel,this.focusSvc=e.focusSvc,this.rowContainerHeight=e.rowContainerHeight,this.ctrlsSvc=e.ctrlsSvc}postConstruct(){this.ctrlsSvc.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.initialise()})}initialise(){this.addManagedEventListeners({paginationChanged:this.onPageLoaded.bind(this),pinnedRowDataChanged:this.onPinnedRowDataChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),bodyScroll:this.onBodyScroll.bind(this),bodyHeightChanged:this.redraw.bind(this,{})}),this.addManagedPropertyListeners(["domLayout","embedFullWidthRows"],()=>this.onDomLayoutChanged()),this.addManagedPropertyListeners(["suppressMaxRenderedRowRestriction","rowBuffer"],()=>this.redraw()),this.addManagedPropertyListener("suppressCellFocus",i=>this.onSuppressCellFocusChanged(i.currentValue)),this.addManagedPropertyListeners(["groupSuppressBlankHeader","getBusinessKeyForNode","fullWidthCellRenderer","fullWidthCellRendererParams","suppressStickyTotalRow","groupRowRenderer","groupRowRendererParams","loadingCellRenderer","loadingCellRendererParams","detailCellRenderer","detailCellRendererParams","enableRangeSelection","enableCellTextSelection"],()=>this.redrawRows()),this.addManagedPropertyListener("cellSelection",({currentValue:i,previousValue:r})=>{(!r&&i||r&&!i)&&this.redrawRows()});const{stickyRowSvc:e,gos:t,showRowGroupCols:n}=this.beans;if(n&&this.addManagedPropertyListener("showOpenedGroup",()=>{const i=n.getShowRowGroupCols();i.length&&this.refreshCells({columns:i,force:!0})}),e)this.stickyRowFeature=e.createStickyRowFeature(this,this.createRowCon.bind(this),this.destroyRowCtrls.bind(this));else{const i=this.gridBodyCtrl;i.setStickyTopHeight(0),i.setStickyBottomHeight(0)}this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=Si(t,"print"),this.embedFullWidthRows=this.printLayout||t.get("embedFullWidthRows"),this.redrawAfterModelUpdate()}initialiseCache(){if(this.gos.get("keepDetailRows")){const e=this.getKeepDetailRowsCount(),t=e??3;this.cachedRowCtrls=new Cje(t)}}getKeepDetailRowsCount(){return this.gos.get("keepDetailRowsCount")}getStickyTopRowCtrls(){return this.stickyRowFeature?.stickyTopRowCtrls??[]}getStickyBottomRowCtrls(){return this.stickyRowFeature?.stickyBottomRowCtrls??[]}updateAllRowCtrls(){const e=Object.values(this.rowCtrlsByRowIndex),t=Object.values(this.zombieRowCtrls),n=this.cachedRowCtrls?.getEntries()??[];t.length>0||n.length>0?this.allRowCtrls=[...e,...t,...n]:this.allRowCtrls=e}isCellBeingRendered(e,t){const n=this.rowCtrlsByRowIndex[e];return!t||!n?!!n:n.isFullWidth()?!0:!!this.beans.spannedRowRenderer?.getCellByPosition({rowIndex:e,column:t,rowPinned:null})||!!n.getCellCtrl(t)||!n.isRowRendered()}updateCellFocus(e){this.getAllCellCtrls().forEach(t=>t.onCellFocused(e)),this.getFullWidthRowCtrls().forEach(t=>t.onFullWidthRowFocused(e))}onCellFocusChanged(e){if(e&&e.rowIndex!=null&&!e.rowPinned){const t=this.beans.colModel.getCol(e.column)??void 0;this.isCellBeingRendered(e.rowIndex,t)||this.redraw()}this.updateCellFocus(e)}onSuppressCellFocusChanged(e){this.getAllCellCtrls().forEach(t=>t.onSuppressCellFocusChanged(e)),this.getFullWidthRowCtrls().forEach(t=>t.onSuppressCellFocusChanged(e))}registerCellEventListeners(){this.addManagedEventListeners({cellFocused:e=>this.onCellFocusChanged(e),cellFocusCleared:()=>this.updateCellFocus(),flashCells:e=>{const{cellFlashSvc:t}=this.beans;t&&this.getAllCellCtrls().forEach(n=>t.onFlashCells(n,e))},columnHoverChanged:()=>{this.getAllCellCtrls().forEach(e=>e.onColumnHover())},displayedColumnsChanged:()=>{this.getAllCellCtrls().forEach(e=>e.onDisplayedColumnsChanged())},displayedColumnsWidthChanged:()=>{this.printLayout&&this.getAllCellCtrls().forEach(e=>e.onLeftChanged())}}),this.setupRangeSelectionListeners(),this.refreshListenersToColumnsForCellComps(),this.addManagedEventListeners({gridColumnsChanged:this.refreshListenersToColumnsForCellComps.bind(this)}),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))}removeGridColumnListeners(){this.destroyFuncsForColumnListeners.forEach(e=>e()),this.destroyFuncsForColumnListeners.length=0}refreshListenersToColumnsForCellComps(){this.removeGridColumnListeners(),this.colModel.getCols().forEach(t=>{const n=l=>{this.getAllCellCtrls().forEach(u=>{u.column===t&&l(u)})},i=()=>{n(l=>l.onLeftChanged())},r=()=>{n(l=>l.onWidthChanged())},s=()=>{n(l=>l.onFirstRightPinnedChanged())},o=()=>{n(l=>l.onLastLeftPinnedChanged())},a=()=>{n(l=>l.onColDefChanged())};t.__addEventListener("leftChanged",i),t.__addEventListener("widthChanged",r),t.__addEventListener("firstRightPinnedChanged",s),t.__addEventListener("lastLeftPinnedChanged",o),t.__addEventListener("colDefChanged",a),this.destroyFuncsForColumnListeners.push(()=>{t.__removeEventListener("leftChanged",i),t.__removeEventListener("widthChanged",r),t.__removeEventListener("firstRightPinnedChanged",s),t.__removeEventListener("lastLeftPinnedChanged",o),t.__removeEventListener("colDefChanged",a)})})}onDomLayoutChanged(){const e=Si(this.gos,"print"),t=e||this.gos.get("embedFullWidthRows"),n=t!==this.embedFullWidthRows||this.printLayout!==e;this.printLayout=e,this.embedFullWidthRows=t,n&&this.redrawAfterModelUpdate({domLayoutChanged:!0})}datasourceChanged(){this.firstRenderedRow=0,this.lastRenderedRow=-1;const e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)}onPageLoaded(e){const t={recycleRows:e.keepRenderedRows,animate:e.animate,newData:e.newData,newPage:e.newPage,onlyBody:!0};this.redrawAfterModelUpdate(t)}getAllCellsNotSpanningForColumn(e){const t=[];return this.getAllRowCtrls().forEach(n=>{const i=n.getCellCtrl(e,!0)?.eGui;i&&t.push(i)}),t}refreshFloatingRowComps(){this.refreshFloatingRows(this.topRowCtrls,"top"),this.refreshFloatingRows(this.bottomRowCtrls,"bottom")}refreshFloatingRows(e,t){const{pinnedRowModel:n,beans:i,printLayout:r}=this,s=Object.fromEntries(e.map(a=>[a.rowNode.id,a]));n?.forEachPinnedRow(t,(a,l)=>{const u=e[l];u&&n.getPinnedRowById(u.rowNode.id,t)===void 0&&(u.destroyFirstPass(),u.destroySecondPass()),a.id in s?(e[l]=s[a.id],delete s[a.id]):e[l]=new b1(a,i,!1,!1,r)});const o=(t==="top"?n?.getPinnedTopRowCount():n?.getPinnedBottomRowCount())??0;e.length=o}onPinnedRowDataChanged(){const e={recycleRows:!0};this.redrawAfterModelUpdate(e)}redrawRow(e,t=!1){if(e.sticky)this.stickyRowFeature?.refreshStickyNode(e);else if(this.cachedRowCtrls?.has(e)){this.cachedRowCtrls.removeRow(e);return}else{const n=i=>{const r=i[e.rowIndex];r&&r.rowNode===e&&(r.destroyFirstPass(),r.destroySecondPass(),i[e.rowIndex]=this.createRowCon(e,!1,!1))};switch(e.rowPinned){case"top":n(this.topRowCtrls);break;case"bottom":n(this.bottomRowCtrls);break;default:n(this.rowCtrlsByRowIndex),this.updateAllRowCtrls()}}t||this.dispatchDisplayedRowsChanged(!1)}redrawRows(e){if(e!=null){e?.forEach(n=>this.redrawRow(n,!0)),this.dispatchDisplayedRowsChanged(!1);return}this.redrawAfterModelUpdate()}redrawAfterModelUpdate(e={}){this.getLockOnRefresh();const t=this.beans.focusSvc?.getFocusCellToUseAfterRefresh();this.updateContainerHeights(),this.scrollToTopIfNewData(e);const n=!e.domLayoutChanged&&!!e.recycleRows,i=e.animate&&jf(this.gos),r=n?this.getRowsToRecycle():null;n||this.removeAllRowComps(),this.workOutFirstAndLastRowsToRender();const{stickyRowFeature:s}=this;if(s){s.checkStickyRows();const o=s.extraTopHeight+s.extraBottomHeight;o&&this.updateContainerHeights(o)}this.recycleRows(r,i),this.gridBodyCtrl.updateRowCount(),e.onlyBody||this.refreshFloatingRowComps(),this.dispatchDisplayedRowsChanged(),t!=null&&this.restoreFocusedCell(t),this.releaseLockOnRefresh()}scrollToTopIfNewData(e){const t=e.newData||e.newPage,n=this.gos.get("suppressScrollOnNewData");t&&!n&&(this.gridBodyCtrl.scrollFeature.scrollToTop(),this.stickyRowFeature?.resetOffsets())}updateContainerHeights(e=0){const{rowContainerHeight:t}=this;if(this.printLayout){t.setModelHeight(null);return}let n=this.pageBounds.getCurrentPageHeight();n===0&&(n=1),t.setModelHeight(n+e)}getLockOnRefresh(){if(this.refreshInProgress)throw new Error(Xu(252));this.refreshInProgress=!0,this.beans.frameworkOverrides.getLockOnRefresh?.()}releaseLockOnRefresh(){this.refreshInProgress=!1,this.beans.frameworkOverrides.releaseLockOnRefresh?.()}isRefreshInProgress(){return this.refreshInProgress}restoreFocusedCell(e){if(!e)return;const t=this.beans.focusSvc,n=this.findPositionToFocus(e);if(!n){t.focusHeaderPosition({headerPosition:{headerRowIndex:va(this.beans)-1,column:e.column}});return}if(e.rowIndex!==n.rowIndex||e.rowPinned!=n.rowPinned){t.setFocusedCell({...n,preventScrollOnBrowserFocus:!0,forceBrowserFocus:!0});return}t.doesRowOrCellHaveBrowserFocus()||this.updateCellFocus(ze(this.gos,{...n,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,type:"cellFocused"}))}findPositionToFocus(e){const{pagination:t,pageBounds:n}=this.beans;let i=e;for(i.rowPinned==null&&t&&n&&!t.isRowInPage(i.rowIndex)&&(i={rowPinned:null,rowIndex:n.getFirstRow()});i;){if(i.rowPinned==null&&n)if(i.rowIndex<n.getFirstRow()){if(i=C1(this.beans,{rowPinned:null,rowIndex:0}),!i)return null}else i.rowIndex>n.getLastRow()&&(i={rowPinned:null,rowIndex:n.getLastRow()});const r=this.getRowByPosition(i);if(r?.isAlive())return{...r.getRowPosition(),column:e.column};i=C1(this.beans,i)}return null}getAllCellCtrls(){const e=[],t=this.getAllRowCtrls(),n=t.length;for(let i=0;i<n;i++){const r=t[i].getAllCellCtrls(),s=r.length;for(let o=0;o<s;o++)e.push(r[o])}return e}getAllRowCtrls(){const{spannedRowRenderer:e}=this.beans,t=this.getStickyTopRowCtrls(),n=this.getStickyBottomRowCtrls();return[...this.topRowCtrls,...this.bottomRowCtrls,...t,...n,...e?.getCtrls("top")??[],...e?.getCtrls("bottom")??[],...e?.getCtrls("center")??[],...Object.values(this.rowCtrlsByRowIndex)]}addRenderedRowListener(e,t,n){const i=this.rowCtrlsByRowIndex[t];i&&i.addEventListener(e,n)}refreshCells(e={}){const t={forceRefresh:e.force,newData:!1,suppressFlash:e.suppressFlash};for(const n of this.getCellCtrls(e.rowNodes,e.columns))n.refreshOrDestroyCell(t);this.refreshFullWidth(e.rowNodes)}refreshFullWidth(e){if(!e)return;let t=!1;for(const n of this.getRowCtrls(e)){if(!n.isFullWidth())continue;n.refreshFullWidth()||(t=!0,this.redrawRow(n.rowNode,!0))}t&&this.dispatchDisplayedRowsChanged(!1)}getRowCtrls(e){const t=gT(e),n=this.getAllRowCtrls();return!e||!t?n:n.filter(i=>{const r=i.rowNode;return mT(r,t)})}getCellCtrls(e,t){let n;Ce(t)&&(n={},t.forEach(r=>{const s=this.colModel.getCol(r);Ce(s)&&(n[s.getId()]=!0)}));const i=[];return this.getRowCtrls(e).forEach(r=>{r.getAllCellCtrls().forEach(s=>{const o=s.column.getId();n&&!n[o]||i.push(s)})}),i}destroy(){this.removeAllRowComps(!0),super.destroy()}removeAllRowComps(e=!1){const t=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(t,e),this.stickyRowFeature?.destroyStickyCtrls()}getRowsToRecycle(){const e=[];for(const n of Object.keys(this.rowCtrlsByRowIndex))this.rowCtrlsByRowIndex[n].rowNode.id==null&&e.push(n);this.removeRowCtrls(e);const t={};for(const n of Object.values(this.rowCtrlsByRowIndex)){const i=n.rowNode;t[i.id]=n}return this.rowCtrlsByRowIndex={},t}removeRowCtrls(e,t=!1){e.forEach(n=>{const i=this.rowCtrlsByRowIndex[n];i&&(i.destroyFirstPass(t),i.destroySecondPass()),delete this.rowCtrlsByRowIndex[n]})}onBodyScroll(e){e.direction==="vertical"&&this.redraw({afterScroll:!0})}redraw(e={}){const{focusSvc:t,animationFrameSvc:n}=this.beans,{afterScroll:i}=e;let r;const s=this.stickyRowFeature;s&&(r=t?.getFocusCellToUseAfterRefresh()||void 0);const o=this.firstRenderedRow,a=this.lastRenderedRow;this.workOutFirstAndLastRowsToRender();let l=!1;if(s){l=s.checkStickyRows();const c=s.extraTopHeight+s.extraBottomHeight;c&&this.updateContainerHeights(c)}const u=this.firstRenderedRow!==o||this.lastRenderedRow!==a;if(!(i&&!l&&!u)&&(this.getLockOnRefresh(),this.recycleRows(null,!1,i),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(i&&!l),r!=null)){const c=t?.getFocusCellToUseAfterRefresh();r!=null&&c==null&&(n?.flushAllFrames(),this.restoreFocusedCell(r))}}removeRowCompsNotToDraw(e,t){const n={};e.forEach(s=>n[s]=!0);const r=Object.keys(this.rowCtrlsByRowIndex).filter(s=>!n[s]);this.removeRowCtrls(r,t)}calculateIndexesToDraw(e){const t=[];for(let o=this.firstRenderedRow;o<=this.lastRenderedRow;o++)t.push(o);const n=this.beans.pagination,i=this.beans.focusSvc?.getFocusedCell()?.rowIndex;i!=null&&(i<this.firstRenderedRow||i>this.lastRenderedRow)&&(!n||n.isRowInPage(i))&&t.push(i);const r=o=>{const a=o.rowNode.rowIndex;a==null||a===i||(a<this.firstRenderedRow||a>this.lastRenderedRow)&&this.doNotUnVirtualiseRow(o)&&t.push(a)};for(const o of Object.values(this.rowCtrlsByRowIndex))r(o);if(e)for(const o of Object.values(e))r(o);t.sort((o,a)=>o-a);const s=[];for(let o=0;o<t.length;o++){const a=t[o],l=this.rowModel.getRow(a);l&&!l.sticky&&s.push(a)}return s}recycleRows(e,t=!1,n=!1){const i=this.calculateIndexesToDraw(e);if((this.printLayout||n)&&(t=!1),this.removeRowCompsNotToDraw(i,!t),i.forEach(r=>{this.createOrUpdateRowCtrl(r,e,t,n)}),e){const{animationFrameSvc:r}=this.beans;r?.active&&n&&!this.printLayout?r.addDestroyTask(()=>{this.destroyRowCtrls(e,t),this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}):this.destroyRowCtrls(e,t)}this.updateAllRowCtrls()}dispatchDisplayedRowsChanged(e=!1){this.eventSvc.dispatchEvent({type:"displayedRowsChanged",afterScroll:e})}onDisplayedColumnsChanged(){const{visibleCols:e}=this.beans,t=e.isPinningLeft(),n=e.isPinningRight();(this.pinningLeft!==t||n!==this.pinningRight)&&(this.pinningLeft=t,this.pinningRight=n,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())}redrawFullWidthEmbeddedRows(){const e=[];this.getFullWidthRowCtrls().forEach(t=>{const n=t.rowNode.rowIndex;e.push(n.toString())}),this.refreshFloatingRowComps(),this.removeRowCtrls(e),this.redraw({afterScroll:!0})}getFullWidthRowCtrls(e){const t=gT(e);return this.getAllRowCtrls().filter(n=>{if(!n.isFullWidth())return!1;const i=n.rowNode;return!(t!=null&&!mT(i,t))})}createOrUpdateRowCtrl(e,t,n,i){let r,s=this.rowCtrlsByRowIndex[e];if(s||(r=this.rowModel.getRow(e),Ce(r)&&Ce(t)&&t[r.id]&&r.alreadyRendered&&(s=t[r.id],t[r.id]=null)),!s)if(r||(r=this.rowModel.getRow(e)),Ce(r))s=this.createRowCon(r,n,i);else return;return r&&(r.alreadyRendered=!0),this.rowCtrlsByRowIndex[e]=s,s}destroyRowCtrls(e,t){const n=[];if(e){for(const i of Object.values(e))if(i){if(this.cachedRowCtrls&&i.isCacheable()){this.cachedRowCtrls.addRow(i);continue}if(i.destroyFirstPass(!t),t){const r=i.instanceId;this.zombieRowCtrls[r]=i,n.push(()=>{i.destroySecondPass(),delete this.zombieRowCtrls[r]})}else i.destroySecondPass()}}t&&(n.push(()=>{this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}),window.setTimeout(()=>n.forEach(i=>i()),mje))}getRowBuffer(){return this.gos.get("rowBuffer")}getRowBufferInPixels(){const e=this.getRowBuffer(),t=zd(this.beans);return e*t}workOutFirstAndLastRowsToRender(){const{rowContainerHeight:e,pageBounds:t,rowModel:n}=this;e.updateOffset();let i,r;if(!n.isRowsToRender())i=0,r=-1;else if(this.printLayout)this.beans.environment.refreshRowHeightVariable(),i=t.getFirstRow(),r=t.getLastRow();else{const c=this.getRowBufferInPixels(),d=this.ctrlsSvc.getScrollFeature(),h=this.gos.get("suppressRowVirtualisation");let p=!1,g,m;do{const x=t.getPixelOffset(),{pageFirstPixel:E,pageLastPixel:A}=t.getCurrentPagePixelRange(),F=e.divStretchOffset,P=d.getVScrollPosition(),D=P.top,M=P.bottom;h?(g=E+F,m=A+F):(g=Math.max(D+x-c,E)+F,m=Math.min(M+x+c,A)+F),this.firstVisibleVPixel=Math.max(D+x,E)+F,this.lastVisibleVPixel=Math.min(M+x,A)+F,p=this.ensureAllRowsInRangeHaveHeightsCalculated(g,m)}while(p);let C=n.getRowIndexAtPixel(g),y=n.getRowIndexAtPixel(m);const b=t.getFirstRow(),S=t.getLastRow();C<b&&(C=b),y>S&&(y=S),i=C,r=y}const s=Si(this.gos,"normal"),o=this.gos.get("suppressMaxRenderedRowRestriction"),a=Math.max(this.getRowBuffer(),500);s&&!o&&r-i>a&&(r=i+a);const l=i!==this.firstRenderedRow,u=r!==this.lastRenderedRow;(l||u)&&(this.firstRenderedRow=i,this.lastRenderedRow=r,this.eventSvc.dispatchEvent({type:"viewportChanged",firstRow:i,lastRow:r}))}dispatchFirstDataRenderedEvent(){this.dataFirstRenderedFired||(this.dataFirstRenderedFired=!0,lu(this.beans,()=>{this.beans.eventSvc.dispatchEvent({type:"firstDataRendered",firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow})}))}ensureAllRowsInRangeHaveHeightsCalculated(e,t){const n=this.pinnedRowModel?.ensureRowHeightsValid(),i=this.stickyRowFeature?.ensureRowHeightsValid(),{pageBounds:r,rowModel:s}=this,o=s.ensureRowHeightsValid(e,t,r.getFirstRow(),r.getLastRow());return(o||i)&&this.eventSvc.dispatchEvent({type:"recalculateRowBounds"}),i||o||n?(this.updateContainerHeights(),!0):!1}doNotUnVirtualiseRow(e){const i=e.rowNode,r=this.focusSvc.isRowFocused(i.rowIndex,i.rowPinned),s=e.editing,o=i.detail;return r||s||o?!!this.isRowPresent(i):!1}isRowPresent(e){return this.rowModel.isRowPresent(e)?this.beans.pagination?.isRowInPage(e.rowIndex)??!0:!1}createRowCon(e,t,n){const i=this.cachedRowCtrls?.getRow(e)??null;if(i)return i;const r=n&&!this.printLayout&&!!this.beans.animationFrameSvc?.active;return new b1(e,this.beans,t,r,this.printLayout)}getRenderedNodes(){const e=Object.values(this.rowCtrlsByRowIndex).map(i=>i.rowNode),t=this.getStickyTopRowCtrls().map(i=>i.rowNode),n=this.getStickyBottomRowCtrls().map(i=>i.rowNode);return[...t,...e,...n]}getRowByPosition(e){let t;const{rowIndex:n}=e;switch(e.rowPinned){case"top":t=this.topRowCtrls[n];break;case"bottom":t=this.bottomRowCtrls[n];break;default:t=this.rowCtrlsByRowIndex[n],t||(t=this.getStickyTopRowCtrls().find(i=>i.rowNode.rowIndex===n)||null,t||(t=this.getStickyBottomRowCtrls().find(i=>i.rowNode.rowIndex===n)||null));break}return t}isRangeInRenderedViewport(e,t){if(e==null||t==null)return!1;const i=e>this.lastRenderedRow;return!(t<this.firstRenderedRow)&&!i}},Cje=class{constructor(e){this.entriesMap={},this.entriesList=[],this.maxCount=e}addRow(e){if(this.entriesMap[e.rowNode.id]=e,this.entriesList.push(e),e.setCached(!0),this.entriesList.length>this.maxCount){const t=this.entriesList[0];t.destroyFirstPass(),t.destroySecondPass(),this.removeFromCache(t)}}getRow(e){if(e==null||e.id==null)return null;const t=this.entriesMap[e.id];return t?(this.removeFromCache(t),t.setCached(!1),t.rowNode!=e?null:t):null}has(e){return this.entriesMap[e.id]!=null}removeRow(e){const t=e.id,n=this.entriesMap[t];delete this.entriesMap[t],_o(this.entriesList,n)}removeFromCache(e){const t=e.rowNode.id;delete this.entriesMap[t],_o(this.entriesList,e)}getEntries(){return this.entriesList}};function gT(e){if(!e)return;const t={top:{},bottom:{},normal:{}};return e.forEach(n=>{const i=n.id;switch(n.rowPinned){case"top":t.top[i]=n;break;case"bottom":t.bottom[i]=n;break;default:t.normal[i]=n;break}}),t}function mT(e,t){const n=e.id;switch(e.rowPinned){case"top":return t.top[n]!=null;case"bottom":return t.bottom[n]!=null;default:return t.normal[n]!=null}}var yje=class extends Z{constructor(){super(...arguments),this.beanName="rowNodeSorter"}postConstruct(){const{gos:e}=this;this.isAccentedSort=e.get("accentedSort"),this.primaryColumnsSortGroups=pa(e),this.addManagedPropertyListener("accentedSort",t=>this.isAccentedSort=t.currentValue),this.addManagedPropertyListener("autoGroupColumnDef",()=>this.primaryColumnsSortGroups=pa(e))}doFullSort(e,t){const n=e.map((i,r)=>({currentPos:r,rowNode:i}));return n.sort(this.compareRowNodes.bind(this,t)),n.map(i=>i.rowNode)}compareRowNodes(e,t,n){const i=t.rowNode,r=n.rowNode;for(let s=0,o=e.length;s<o;s++){const a=e[s],l=a.sort==="desc",u=this.getValue(i,a.column),c=this.getValue(r,a.column);let d;const h=this.getComparator(a,i);if(h?d=h(u,c,i,r,l):d=_5e(u,c,this.isAccentedSort),!isNaN(d)&&d!==0)return a.sort==="asc"?d:d*-1}return t.currentPos-n.currentPos}getComparator(e,t){const n=e.column,i=n.getColDef().comparator;if(i!=null)return i;if(!n.getColDef().showRowGroup)return;const r=!t.group&&n.getColDef().field;if(!r)return;const s=this.beans.colModel.getColDefCol(r);if(s)return s.getColDef().comparator}getValue(e,t){const{valueSvc:n,colModel:i,showRowGroupCols:r,gos:s}=this.beans;if(!this.primaryColumnsSortGroups)return n.getValue(t,e,!1);if(e.rowGroupColumn===t){if(hN(s,i.isPivotActive())){const u=e.allLeafChildren?.[0];return u?n.getValue(t,u,!1):void 0}const l=r?.getShowRowGroupCol(t.getId());return l?e.groupData?.[l.getId()]:void 0}if(!(e.group&&t.getColDef().showRowGroup))return n.getValue(t,e,!1)}};function wje(e){e.sortSvc?.onSortChanged("api")}var Pm=(e,t)=>({tag:"span",ref:`eSort${e}`,cls:`ag-sort-indicator-icon ag-sort-${t} ag-hidden`,attrs:{"aria-hidden":"true"}}),bje={tag:"span",cls:"ag-sort-indicator-container",children:[Pm("Order","order"),Pm("Asc","ascending-icon"),Pm("Desc","descending-icon"),Pm("Mixed","mixed-icon"),Pm("None","none-icon")]},IN=class extends At{constructor(e){super(),this.eSortOrder=ve,this.eSortAsc=ve,this.eSortDesc=ve,this.eSortMixed=ve,this.eSortNone=ve,e||this.setTemplate(bje)}attachCustomElements(e,t,n,i,r){this.eSortOrder=e,this.eSortAsc=t,this.eSortDesc=n,this.eSortMixed=i,this.eSortNone=r}setupSort(e,t=!1){if(this.column=e,this.suppressOrder=t,this.setupMultiSortIndicator(),!e.isSortable()&&!e.getColDef().showRowGroup)return;this.addInIcon("sortAscending",this.eSortAsc,e),this.addInIcon("sortDescending",this.eSortDesc,e),this.addInIcon("sortUnSort",this.eSortNone,e);const n=this.updateIcons.bind(this),i=this.onSortChanged.bind(this);this.addManagedPropertyListener("unSortIcon",n),this.addManagedEventListeners({newColumnsLoaded:n,sortChanged:i,columnRowGroupChanged:i}),this.onSortChanged()}addInIcon(e,t,n){if(t==null)return;const i=Os(e,this.beans,n);i&&t.appendChild(i)}onSortChanged(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()}updateIcons(){const{eSortAsc:e,eSortDesc:t,eSortNone:n,column:i,gos:r,beans:s}=this,o=s.sortSvc.getDisplaySortForColumn(i);if(e&&tn(e,o==="asc",{skipAriaHidden:!0}),t&&tn(t,o==="desc",{skipAriaHidden:!0}),n){const a=!i.getColDef().unSortIcon&&!r.get("unSortIcon"),l=o==null;tn(n,!a&&l,{skipAriaHidden:!0})}}setupMultiSortIndicator(){const{eSortMixed:e,column:t,gos:n}=this;this.addInIcon("sortUnSort",e,t);const i=t.getColDef().showRowGroup;pa(n)&&i&&(this.addManagedEventListeners({sortChanged:this.updateMultiSortIndicator.bind(this),columnRowGroupChanged:this.updateMultiSortIndicator.bind(this)}),this.updateMultiSortIndicator())}updateMultiSortIndicator(){const{eSortMixed:e,beans:t,column:n}=this;if(e){const i=t.sortSvc.getDisplaySortForColumn(n)==="mixed";tn(e,i,{skipAriaHidden:!0})}}updateSortOrder(){const{eSortOrder:e,column:t,beans:{sortSvc:n}}=this;if(!e)return;const i=n.getColumnsWithSortingOrdered(),r=n.getDisplaySortIndexForColumn(t)??-1,s=i.some(a=>n.getDisplaySortIndexForColumn(a)??!1),o=r>=0&&s;tn(e,o,{skipAriaHidden:!0}),r>=0?e.textContent=(r+1).toString():Gi(e)}},Sje={selector:"AG-SORT-INDICATOR",component:IN},k0=["asc","desc",null],xje=class extends Z{constructor(){super(...arguments),this.beanName="sortSvc"}progressSort(e,t,n){const i=this.getNextSortDirection(e);this.setSortForColumn(e,i,t,n)}progressSortFromEvent(e,t){const i=this.gos.get("multiSortKey")==="ctrl"?t.ctrlKey||t.metaKey:t.shiftKey;this.progressSort(e,i,"uiColumnSorted")}setSortForColumn(e,t,n,i){t!=="asc"&&t!=="desc"&&(t=null);const{gos:r,showRowGroupCols:s}=this.beans,o=pa(r);let a=[e];if(o&&e.getColDef().showRowGroup){const d=s?.getSourceColumnsForGroupColumn?.(e)?.filter(h=>h.isSortable());d&&(a=[e,...d])}a.forEach(c=>this.setColSort(c,t,i));const l=(n||r.get("alwaysMultiSort"))&&!r.get("suppressMultiSort"),u=[];if(!l){const c=this.clearSortBarTheseColumns(a,i);u.push(...c)}this.updateSortIndex(e),u.push(...a),this.dispatchSortChangedEvents(i,u)}updateSortIndex(e){const{gos:t,colModel:n,showRowGroupCols:i}=this.beans,r=pa(t),s=i?.getShowRowGroupCol(e.getId()),o=r&&s||e,a=this.getColumnsWithSortingOrdered();n.forAllCols(c=>this.setColSortIndex(c,null));const l=a.filter(c=>r&&c.getColDef().showRowGroup?!1:c!==o);(o.getSort()?[...l,o]:l).forEach((c,d)=>this.setColSortIndex(c,d))}onSortChanged(e,t){this.dispatchSortChangedEvents(e,t)}isSortActive(){let e=!1;return this.beans.colModel.forAllCols(t=>{t.getSort()&&(e=!0)}),e}dispatchSortChangedEvents(e,t){const n={type:"sortChanged",source:e};t&&(n.columns=t),this.eventSvc.dispatchEvent(n)}clearSortBarTheseColumns(e,t){const n=[];return this.beans.colModel.forAllCols(i=>{e.includes(i)||(i.getSort()&&n.push(i),this.setColSort(i,void 0,t))}),n}getNextSortDirection(e){const t=e.getColDef().sortingOrder??this.gos.get("sortingOrder")??k0,n=t.indexOf(e.getSort()),i=n<0,r=n==t.length-1;return i||r?t[0]:t[n+1]}getIndexedSortMap(){const{gos:e,colModel:t,showRowGroupCols:n,rowGroupColsSvc:i}=this.beans;let r=[];if(t.forAllCols(u=>{u.getSort()&&r.push(u)}),t.isPivotMode()){const u=pa(e);r=r.filter(c=>{const d=!!c.getAggFunc(),h=!c.isPrimary(),p=u?n?.getShowRowGroupCol(c.getId()):c.getColDef().showRowGroup;return d||h||p})}const s=i?.columns.filter(u=>!!u.getSort())??[],o={};r.forEach((u,c)=>o[u.getId()]=c),r.sort((u,c)=>{const d=u.getSortIndex(),h=c.getSortIndex();if(d!=null&&h!=null)return d-h;if(d==null&&h==null){const p=o[u.getId()],g=o[c.getId()];return p>g?1:-1}else return h==null?-1:1});const a=pa(e)&&!!s.length;a&&(r=[...new Set(r.map(u=>n?.getShowRowGroupCol(u.getId())??u))]);const l=new Map;return r.forEach((u,c)=>l.set(u,c)),a&&s.forEach(u=>{const c=n.getShowRowGroupCol(u.getId());l.set(u,l.get(c))}),l}getColumnsWithSortingOrdered(){return[...this.getIndexedSortMap().entries()].sort(([,e],[,t])=>e-t).map(([e])=>e)}getSortModel(){return this.getColumnsWithSortingOrdered().filter(e=>e.getSort()).map(e=>({sort:e.getSort(),colId:e.getId()}))}getSortOptions(){return this.getColumnsWithSortingOrdered().filter(e=>e.getSort()).map(e=>({sort:e.getSort(),column:e}))}canColumnDisplayMixedSort(e){const t=pa(this.gos),n=!!e.getColDef().showRowGroup;return t&&n}getDisplaySortForColumn(e){const t=this.beans.showRowGroupCols?.getSourceColumnsForGroupColumn(e);if(!this.canColumnDisplayMixedSort(e)||!t?.length)return e.getSort();const i=e.getColDef().field!=null||!!e.getColDef().valueGetter?[e,...t]:t,r=i[0].getSort();return i.every(o=>o.getSort()==r)?r:"mixed"}getDisplaySortIndexForColumn(e){return this.getIndexedSortMap().get(e)}setupHeader(e,t,n){let i=0;e.addManagedListeners(t,{movingChanged:()=>{i=Date.now()}}),n&&e.addManagedElementListeners(n,{click:s=>{const o=t.isMoving(),l=Date.now()-i<50;o||l||this.progressSortFromEvent(t,s)}});const r=()=>{const s=t.getSort();if(e.addOrRemoveCssClass("ag-header-cell-sorted-asc",s==="asc"),e.addOrRemoveCssClass("ag-header-cell-sorted-desc",s==="desc"),e.addOrRemoveCssClass("ag-header-cell-sorted-none",!s),t.getColDef().showRowGroup){const l=!this.beans.showRowGroupCols?.getSourceColumnsForGroupColumn(t)?.every(u=>t.getSort()==u.getSort());e.addOrRemoveCssClass("ag-header-cell-sorted-mixed",l)}};e.addManagedEventListeners({sortChanged:r,columnRowGroupChanged:r})}initCol(e){const{sort:t,initialSort:n,sortIndex:i,initialSortIndex:r}=e.colDef;t!==void 0?(t==="asc"||t==="desc")&&(e.sort=t):(n==="asc"||n==="desc")&&(e.sort=n),i!==void 0?i!==null&&(e.sortIndex=i):r!==null&&(e.sortIndex=r)}updateColSort(e,t,n){t!==void 0&&(t==="desc"||t==="asc"?this.setColSort(e,t,n):this.setColSort(e,void 0,n))}setColSort(e,t,n){e.sort!==t&&(e.sort=t,e.dispatchColEvent("sortChanged",n)),e.dispatchStateUpdatedEvent("sort")}setColSortIndex(e,t){e.sortIndex=t,e.dispatchStateUpdatedEvent("sortIndex")}createSortIndicator(e){return new IN(e)}getSortIndicatorSelector(){return Sje}},Qte={moduleName:"Sort",version:we,beans:[xje,yje],apiFunctions:{onSortChanged:wje},userComponents:{agSortIndicator:IN},icons:{sortAscending:"asc",sortDescending:"desc",sortUnSort:"none"}},Rje=class extends Z{constructor(){super(...arguments),this.beanName="syncSvc",this.waitingForColumns=!1}postConstruct(){this.addManagedPropertyListener("columnDefs",e=>this.setColumnDefs(e))}start(){this.beans.ctrlsSvc.whenReady(this,()=>{const e=this.gos.get("columnDefs");e?this.setColumnsAndData(e):this.waitingForColumns=!0,this.gridReady()})}setColumnsAndData(e){const{colModel:t,rowModel:n}=this.beans;t.setColumnDefs(e??[],"gridInitializing"),n.start()}gridReady(){const{eventSvc:e,gos:t}=this;e.dispatchEvent({type:"gridReady"}),fc(t,`initialised successfully, enterprise = ${t.isModuleRegistered("EnterpriseCore")}`)}setColumnDefs(e){const t=this.gos.get("columnDefs");if(t){if(this.waitingForColumns){this.waitingForColumns=!1,this.setColumnsAndData(t);return}this.beans.colModel.setColumnDefs(t,Yf(e.source))}}};function Eje(e){e.valueCache?.expire()}function Fje(e,t){const{colKey:n,rowNode:i,useFormatter:r}=t,s=e.colModel.getColDefCol(n)??e.colModel.getCol(n);if(Xt(s))return null;const o=e.valueSvc.getValueForDisplay(s,i);return r?e.valueSvc.formatValue(s,i,o)??Ol(o,!0):o}var x1=class{constructor(e,t){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=e,this.pathRoot={rowNode:t,children:null},this.mapToItems[t.id]=this.pathRoot}depthFirstSearchChangedPath(e,t){const{rowNode:n,children:i}=e;if(i)for(let r=0;r<i.length;++r)this.depthFirstSearchChangedPath(i[r],t);t(n)}depthFirstSearchEverything(e,t,n){const i=e.childrenAfterGroup;if(i)for(let r=0,s=i.length;r<s;++r){const o=i[r];o.childrenAfterGroup?this.depthFirstSearchEverything(o,t,n):n&&t(o)}t(e)}forEachChangedNodeDepthFirst(e,t=!1,n=!1){this.active&&!n?this.depthFirstSearchChangedPath(this.pathRoot,e):this.depthFirstSearchEverything(this.pathRoot.rowNode,e,t)}executeFromRootNode(e){e(this.pathRoot.rowNode)}createPathItems(e){let t=e,n=0;for(;!this.mapToItems[t.id];){const i={rowNode:t,children:null};this.mapToItems[t.id]=i,n++,t=t.parent}return n}populateColumnsMap(e,t){if(!this.keepingColumns||!t)return;let n=e;for(;n;)this.nodeIdsToColumns[n.id]||(this.nodeIdsToColumns[n.id]={}),t.forEach(i=>this.nodeIdsToColumns[n.id][i.getId()]=!0),n=n.parent}linkPathItems(e,t){let n=e;for(let i=0;i<t;i++){const r=this.mapToItems[n.id],s=this.mapToItems[n.parent.id];s.children||(s.children=[]),s.children.push(r),n=n.parent}}addParentNode(e,t){if(!e||e.isRowPinned())return;const n=this.createPathItems(e);this.linkPathItems(e,n),this.populateColumnsMap(e,t)}canSkip(e){return this.active&&!this.mapToItems[e.id]}getValueColumnsForNode(e,t){if(!this.keepingColumns)return t;const n=this.nodeIdsToColumns[e.id];return t.filter(r=>n[r.getId()])}getNotValueColumnsForNode(e,t){if(!this.keepingColumns)return null;const n=this.nodeIdsToColumns[e.id];return t.filter(r=>!n[r.getId()])}},Aje="paste",Dje=class extends Z{constructor(){super(...arguments),this.beanName="changeDetectionSvc",this.clientSideRowModel=null}postConstruct(){const{gos:e,rowModel:t}=this.beans;tr(e)&&(this.clientSideRowModel=t),this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this)})}onCellValueChanged(e){const{gos:t,rowRenderer:n}=this.beans;if(e.source===Aje||t.get("suppressChangeDetection"))return;const i=e.node,r=[i],s=this.clientSideRowModel,o=s?.rootNode;if(o&&!i.isRowPinned()){const a=t.get("aggregateOnlyChangedColumns"),l=new x1(a,o);l.addParentNode(i.parent,[e.column]),s.doAggregate(l),l.forEachChangedNodeDepthFirst(u=>{r.push(u),u.sibling&&r.push(u.sibling)})}n.refreshCells({rowNodes:r})}},kje=class extends Z{constructor(){super(...arguments),this.beanName="expressionSvc",this.cache={}}evaluate(e,t){if(typeof e=="string")return this.evaluateExpression(e,t);Ft(15,{expression:e})}evaluateExpression(e,t){try{return this.createExpressionFunction(e)(t.value,t.context,t.oldValue,t.newValue,t.value,t.node,t.data,t.colDef,t.rowIndex,t.api,t.getValue,t.column,t.columnGroup)}catch(n){return Ft(16,{expression:e,params:t,e:n}),null}}createExpressionFunction(e){const t=this.cache;if(t[e])return t[e];const n=this.createFunctionBody(e),i=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, getValue, column, columnGroup",n);return t[e]=i,i}createFunctionBody(e){return e.indexOf("return")>=0?e:"return "+e+";"}},Pje=class extends Z{constructor(){super(...arguments),this.beanName="valueCache",this.cacheVersion=0}postConstruct(){const e=this.gos;this.active=e.get("valueCache"),this.neverExpires=e.get("valueCacheNeverExpires")}onDataChanged(){this.neverExpires||this.expire()}expire(){this.cacheVersion++}setValue(e,t,n){if(this.active){const i=this.cacheVersion;e.__cacheVersion!==i&&(e.__cacheVersion=i,e.__cacheData={}),e.__cacheData[t]=n}}getValue(e,t){if(!(!this.active||e.__cacheVersion!==this.cacheVersion))return e.__cacheData[t]}},Mje={moduleName:"ValueCache",version:we,beans:[Pje],apiFunctions:{expireValueCache:Eje}},Tje={moduleName:"Expression",version:we,beans:[kje]},Ije={moduleName:"ChangeDetection",version:we,beans:[Dje]},_je={moduleName:"CellApi",version:we,apiFunctions:{getCellValue:Fje}},Oje=class extends Z{constructor(){super(...arguments),this.beanName="valueSvc",this.initialised=!1,this.isSsrm=!1}wireBeans(e){this.expressionSvc=e.expressionSvc,this.colModel=e.colModel,this.valueCache=e.valueCache,this.dataTypeSvc=e.dataTypeSvc}postConstruct(){this.initialised||this.init()}init(){this.executeValueGetter=this.valueCache?this.executeValueGetterWithValueCache.bind(this):this.executeValueGetterWithoutValueCache.bind(this),this.isSsrm=bg(this.gos),this.cellExpressions=this.gos.get("enableCellExpressions"),this.isTreeData=this.gos.get("treeData"),this.initialised=!0;const e=t=>this.callColumnCellValueChangedHandler(t);this.eventSvc.addEventListener("cellValueChanged",e,!0),this.addDestroyFunc(()=>this.eventSvc.removeEventListener("cellValueChanged",e,!0)),this.addManagedPropertyListener("treeData",t=>this.isTreeData=t.currentValue)}getValueForDisplay(e,t){const n=e.getColDef().showRowGroup;if(n!=null){if(typeof n=="string"){const l=this.getDisplayedNode(t,e,!0);if(l)return this.getValue(e,l)}const a=this.getValue(e,t);if(a==null){const l=this.getDisplayedNode(t,e);if(l)return this.getValue(e,l)}return a}const i=t.leafGroup&&this.colModel.isPivotMode(),r=t.group&&t.expanded&&!t.footer&&!i,s=this.gos.get("groupSuppressBlankHeader")||!t.sibling,o=r&&!s;return this.getValue(e,t,o)}getValue(e,t,n=!1){if(this.initialised||this.init(),!t)return;const i=e.getColDef(),r=i.field,s=e.getColId(),o=t.data;let a;const l=i.showRowGroup;if(typeof l=="string"&&(this.beans.rowGroupColsSvc?.getColumnIndex(l)??-1)>t.level)return null;const u=t.groupData&&t.groupData[s]!==void 0,c=!n&&t.aggData&&t.aggData[s]!==void 0,d=this.isSsrm&&n&&!!e.getColDef().aggFunc,h=this.isSsrm&&t.footer&&t.field&&(e.getColDef().showRowGroup===!0||e.getColDef().showRowGroup===t.field);if(this.isTreeData&&c?a=t.aggData[s]:this.isTreeData&&i.valueGetter?a=this.executeValueGetter(i.valueGetter,o,e,t):this.isTreeData&&r&&o?a=kv(o,r,e.isFieldContainsDots()):u?a=t.groupData[s]:c?a=t.aggData[s]:i.valueGetter?a=this.executeValueGetter(i.valueGetter,o,e,t):h?a=kv(o,t.field,e.isFieldContainsDots()):r&&o&&!d&&(a=kv(o,r,e.isFieldContainsDots())),this.cellExpressions&&typeof a=="string"&&a.indexOf("=")===0){const p=a.substring(1);a=this.executeValueGetter(p,o,e,t)}return a}parseValue(e,t,n,i){const r=e.getColDef(),s=r.valueParser;if(Ce(s)){const o=ze(this.gos,{node:t,data:t?.data,oldValue:i,newValue:n,colDef:r,column:e});return typeof s=="function"?s(o):this.expressionSvc?.evaluate(s,o)}return n}getDeleteValue(e,t){return Ce(e.getColDef().valueParser)?this.parseValue(e,t,"",this.getValueForDisplay(e,t))??null:null}formatValue(e,t,n,i,r=!0){let s=null,o;const a=e.getColDef();if(i?o=i:r&&(o=a.valueFormatter),o){const l=ze(this.gos,{value:n,node:t,data:t?t.data:null,colDef:a,column:e});typeof o=="function"?s=o(l):s=this.expressionSvc?this.expressionSvc.evaluate(o,l):null}else if(a.refData)return a.refData[n]||"";return s==null&&Array.isArray(n)&&(s=n.join(", ")),s}getDisplayedNode(e,t,n=!1){const i=this.gos,r=i.get("groupHideOpenParents"),s=i.get("showOpenedGroup")&&!n;if(!r&&!s)return;const o=t.colDef.showRowGroup;if(o===!0)return e.group?void 0:e.parent??void 0;let a=e;for(;a&&a.rowGroupColumn?.getId()!=o;){const l=a===a.parent?.childrenAfterSort?.[0];if(!s&&!l)return;a=a.parent}if(a!==e)return a??void 0}setValue(e,t,n,i){const r=this.colModel.getColDefCol(t);if(!e||!r)return!1;Xt(e.data)&&(e.data={});const{field:s,valueSetter:o}=r.getColDef();if(Xt(s)&&Xt(o))return de(17),!1;if(this.dataTypeSvc&&!this.dataTypeSvc.checkType(r,n))return de(135),!1;const a=ze(this.gos,{node:e,data:e.data,oldValue:this.getValue(r,e),newValue:n,colDef:r.getColDef(),column:r});a.newValue=n;let l;if(Ce(o)?typeof o=="function"?l=o(a):l=this.expressionSvc?.evaluate(o,a):l=this.setValueUsingField(e.data,s,n,r.isFieldContainsDots()),l===void 0&&(l=!0),!l)return!1;e.resetQuickFilterAggregateText(),this.valueCache?.onDataChanged();const u=this.getValue(r,e);return this.eventSvc.dispatchEvent({type:"cellValueChanged",event:null,rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:a.column,colDef:a.colDef,data:e.data,node:e,oldValue:a.oldValue,newValue:u,value:u,source:i}),!0}callColumnCellValueChangedHandler(e){const t=e.colDef.onCellValueChanged;typeof t=="function"&&this.beans.frameworkOverrides.wrapOutgoing(()=>{t({node:e.node,data:e.data,oldValue:e.oldValue,newValue:e.newValue,colDef:e.colDef,column:e.column,api:e.api,context:e.context})})}setValueUsingField(e,t,n,i){if(!t)return!1;let r=!1;if(!i)r=e[t]===n,r||(e[t]=n);else{const s=t.split(".");let o=e;for(;s.length>0&&o;){const a=s.shift();s.length===0?(r=o[a]===n,r||(o[a]=n)):o=o[a]}}return!r}executeValueGetterWithValueCache(e,t,n,i){const r=n.getColId(),s=this.valueCache.getValue(i,r);if(s!==void 0)return s;const o=this.executeValueGetterWithoutValueCache(e,t,n,i);return this.valueCache.setValue(i,r,o),o}executeValueGetterWithoutValueCache(e,t,n,i){const r=ze(this.gos,{data:t,node:i,column:n,colDef:n.getColDef(),getValue:this.getValueCallback.bind(this,i)});let s;return typeof e=="function"?s=e(r):s=this.expressionSvc?.evaluate(e,r),s}getValueCallback(e,t){const n=this.colModel.getColDefCol(t);return n?this.getValue(n,e):null}getKeyForNode(e,t){const n=this.getValue(e,t),i=e.getColDef().keyCreator;let r=n;if(i){const s=ze(this.gos,{value:n,colDef:e.getColDef(),column:e,node:t,data:t.data});r=i(s)}return typeof r=="string"||r==null||(r=String(r),r==="[object Object]"&&de(121)),r}},Lje={moduleName:"CommunityCore",version:we,beans:[Dqe,RUe,m7e,H6e,gje,M9e,Sqe,Tqe,B6e,eje,Jqe,vje,Oje,Fqe,bqe,Aqe,C7e,Rje,d7e,h7e],icons:{selectOpen:"small-down",smallDown:"small-down",colorPicker:"color-picker",smallUp:"small-up",checkboxChecked:"small-up",checkboxIndeterminate:"checkbox-indeterminate",checkboxUnchecked:"checkbox-unchecked",radioButtonOn:"radio-button-on",radioButtonOff:"radio-button-off",smallLeft:"small-left",smallRight:"small-right"},apiFunctions:{getGridId:EUe,destroy:FUe,isDestroyed:AUe,getGridOption:DUe,setGridOption:kUe,updateGridOptions:kte},dependsOn:[a7e,u9e,m9e,Qte,$qe,I9e,Bqe,pje,Ije,zqe,Zqe,rje,oje,Vqe,g7e,l7e,Tje]},_N=class hd{static applyGlobalGridOptions(t){if(!hd.gridOptions)return{...t};let n={};return lr(n,hd.gridOptions,!0,!0),hd.mergeStrategy==="deep"?lr(n,t,!0,!0):n={...n,...t},hd.gridOptions.context&&(n.context=hd.gridOptions.context),t.context&&(hd.mergeStrategy==="deep"&&n.context&&lr(t.context,n.context,!0,!0),n.context=t.context),n}};_N.gridOptions=void 0;_N.mergeStrategy="shallow";var Nje=_N;function $je(e,t,n){if(!t)return Ft(11),{};const i=n;let r;if(!i?.setThemeOnGridDiv){const o=Sn({tag:"div"});o.style.height="100%",e.appendChild(o),e=o,r=()=>e.remove()}return new Gje().create(e,t,o=>{const a=new SUe(e);o.createBean(a)},void 0,n,r)}var Bje=1,Gje=class{create(e,t,n,i,r,s){const o=Nje.applyGlobalGridOptions(t),a=o.gridId??String(Bje++),l=o.rowModelType??"clientSide",u=this.getRegisteredModules(r,a,l),c=this.createBeansList(l,u,a),d=this.createProvidedBeans(e,o,r);if(!c)return;const h={providedBeanInstances:d,beanClasses:c,gridId:a,beanInitComparator:sUe,beanDestroyComparator:oUe,derivedBeans:[iUe],destroyCallback:s},p=new TWe(h);return this.registerModuleFeatures(p,u),n(p),p.getBean("syncSvc").start(),i&&i(p),p.getBean("gridApi")}getRegisteredModules(e,t,n){return A0(Lje,void 0),e?.modules?.forEach(i=>A0(i,t)),DWe(t,n)}registerModuleFeatures(e,t){const n=e.getBean("registry"),i=e.getBean("apiFunctionSvc");t.forEach(r=>{n.registerModule(r);const s=r.apiFunctions;s&&Object.keys(s).forEach(a=>{i?.addFunction(a,s[a])})})}createProvidedBeans(e,t,n){let i=n?n.frameworkOverrides:null;Xt(i)&&(i=new Ate);const r={gridOptions:t,eGridDiv:e,globalListener:n?n.globalListener:null,globalSyncListener:n?n.globalSyncListener:null,frameworkOverrides:i};return n&&n.providedBeanInstances&&Object.assign(r,n.providedBeanInstances),r}createBeansList(e,t,n){const r={clientSide:"ClientSideRowModel",infinite:"InfiniteRowModel",serverSide:"ServerSideRowModel",viewport:"ViewportRowModel"}[e];if(!r){tT(201,{rowModelType:e},`Unknown rowModelType ${e}.`);return}if(!Yee(r,n,e)){tT(200,{reasonOrId:`rowModelType = '${e}'`,moduleName:r,gridScoped:vN(),gridId:n,rowModelType:e},`Missing module ${r}Module for rowModelType ${e}. 
If upgrading from before v33, see ${Bd}/upgrading-to-ag-grid-33/#changes-to-modules/`);return}const s=new Set;return t.forEach(o=>o.beans?.forEach(a=>s.add(a))),Array.from(s)}};function ja(e){const t=e.rowModel;return t.getType()==="clientSide"?t:void 0}function XR(e){const t=e.rowModel;return t.getType()==="infinite"?t:void 0}function Zte(e){const t=e.rowModel;return t.getType()==="serverSide"?t:void 0}var zje=["columnEverythingChanged","newColumnsLoaded","columnPivotModeChanged","pivotMaxColumnsExceeded","columnRowGroupChanged","expandOrCollapseAll","columnPivotChanged","gridColumnsChanged","columnValueChanged","columnMoved","columnVisible","columnPinned","columnGroupOpened","columnResized","displayedColumnsChanged","virtualColumnsChanged","columnHeaderMouseOver","columnHeaderMouseLeave","columnHeaderClicked","columnHeaderContextMenu","asyncTransactionsFlushed","rowGroupOpened","rowDataUpdated","pinnedRowDataChanged","rangeSelectionChanged","cellSelectionChanged","chartCreated","chartRangeSelectionChanged","chartOptionsChanged","chartDestroyed","toolPanelVisibleChanged","toolPanelSizeChanged","modelUpdated","cutStart","cutEnd","pasteStart","pasteEnd","fillStart","fillEnd","cellSelectionDeleteStart","cellSelectionDeleteEnd","rangeDeleteStart","rangeDeleteEnd","undoStarted","undoEnded","redoStarted","redoEnded","cellClicked","cellDoubleClicked","cellMouseDown","cellContextMenu","cellValueChanged","cellEditRequest","rowValueChanged","headerFocused","cellFocused","rowSelected","selectionChanged","tooltipShow","tooltipHide","cellKeyDown","cellMouseOver","cellMouseOut","filterChanged","filterModified","filterOpened","advancedFilterBuilderVisibleChanged","sortChanged","virtualRowRemoved","rowClicked","rowDoubleClicked","gridReady","gridPreDestroyed","gridSizeChanged","viewportChanged","firstDataRendered","dragStarted","dragStopped","dragCancelled","rowEditingStarted","rowEditingStopped","cellEditingStarted","cellEditingStopped","bodyScroll","bodyScrollEnd","paginationChanged","componentStateChanged","storeRefreshed","stateUpdated","columnMenuVisibleChanged","contextMenuVisibleChanged","rowDragEnter","rowDragMove","rowDragLeave","rowDragEnd","rowDragCancel","findChanged"],Hje=["scrollbarWidthChanged","keyShortcutChangedCellStart","keyShortcutChangedCellEnd","pinnedHeightChanged","cellFocusCleared","fullWidthRowFocused","checkboxChanged","heightScaleChanged","suppressMovableColumns","suppressMenuHide","suppressFieldDotNotation","columnPanelItemDragStart","columnPanelItemDragEnd","bodyHeightChanged","columnContainerWidthChanged","displayedColumnsWidthChanged","scrollVisibilityChanged","scrollGapChanged","columnHoverChanged","flashCells","paginationPixelOffsetChanged","displayedRowsChanged","leftPinnedWidthChanged","rightPinnedWidthChanged","rowContainerHeightChanged","headerHeightChanged","columnGroupHeaderHeightChanged","columnHeaderHeightChanged","gridStylesChanged","storeUpdated","filterDestroyed","rowDataUpdateStarted","rowCountReady","advancedFilterEnabledChanged","dataTypesInferred","fieldValueChanged","fieldPickerValueSelected","richSelectListRowSelected","sideBarUpdated","alignedGridScroll","alignedGridColumn","gridOptionsChanged","chartTitleEdit","recalculateRowBounds","stickyTopOffsetChanged","overlayExclusiveChanged","beforeRefreshModel","rowNodeDataChanged"],Jte=[...zje,...Hje],Vje=class extends Z{constructor(){super(...arguments),this.beanName="localeSvc"}getLocaleTextFunc(){const e=this.gos,t=e.getCallback("getLocaleText");if(t)return(i,r,s)=>t({key:i,defaultValue:r,variableValues:s});const n=e.get("localeText");return(i,r,s)=>{let o=n&&n[i];if(o&&s&&s.length){let a=0;for(;!(a>=s.length||o.indexOf("${variable}")===-1);)o=o.replace("${variable}",s[a++])}return o??r}}},Wje=["overlayLoadingTemplate","overlayNoRowsTemplate","gridId","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","groupDisplayType","treeDataDisplayType","treeDataChildrenField","treeDataParentIdField","colResizeDefault","tooltipTrigger","serverSidePivotResultFieldSeparator","columnMenu","tooltipShowMode","grandTotalRow","themeCssLayer","findSearchValue","styleNonce"],Uje=["components","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","dragAndDropImageComponentParams","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent","themeStyleContainer","statusBar","chartThemeOverrides","customChartThemes","chartToolPanelsDef","dataTypeDefinitions","advancedFilterParent","advancedFilterBuilderParams","initialState","autoSizeStrategy","selectionColumnDef","findOptions"],qje=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass","paginationPageSizeSelector"],ene=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","groupLockGroupColumns","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","pivotDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDuration","cellFadeDuration","tabIndex","pivotMaxGeneratedColumns"],jje=["theme","rowSelection"],Kje=["cellSelection","sideBar","rowNumbers","suppressGroupChangesColumnVisibility","groupAggFiltering","suppressStickyTotalRow","groupHideParentOfSingleChild"],tne=["loadThemeGoogleFonts","suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellFocus","suppressHeaderFocus","suppressHorizontalScroll","groupSelectsChildren","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressColumnMoveAnimation","suppressMoveWhenColumnDragging","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","allowContextMenuWithControlKey","suppressContextMenu","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","alwaysAggregateAtRootLevel","suppressFocusAfterRefresh","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","enableCellSpan","suppressClickEdit","rowDragEntireRow","rowDragManaged","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","includeHiddenColumnsInQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","includeHiddenColumnsInAdvancedFilter","suppressMultiRangeSelection","enterNavigatesVerticallyAfterEdit","enterNavigatesVertically","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","tooltipInteraction","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideSortAllLevels","serverSideEnableClientSideSort","serverSideOnlyRefreshFilteredGroups","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","groupMaintainOrder","columnHoverHighlight","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","suppressGroupRowsSticky","suppressCutToClipboard","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","enableAdvancedFilter","masterDetail","treeData","reactiveCustomComponents","applyQuickFilterBeforePivotOrAgg","suppressServerSideFullWidthLoadingRow","suppressAdvancedFilterEval","loading","maintainColumnOrder","enableStrictPivotColumnOrder","suppressSetFilterByDefault"],Yje=["doesExternalFilterPass","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","rowDragText","groupRowRenderer","dragAndDropImageComponent","fullWidthCellRenderer","loadingCellRenderer","loadingOverlayComponent","noRowsOverlayComponent","detailCellRenderer","quickFilterParser","quickFilterMatcher","getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","isFullWidthRow","sendToClipboard","focusGridInnerElement","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processUnpinnedColumns","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","loadingCellRendererSelector","getRowId","chartMenuItems","groupTotalRow","alwaysPassFilter"],vT=[...qje,...Uje,...Wje,...ene,...Yje,...tne,...Kje,...jje],Xje=class{wrap(e,t,n,i){const r=this.createWrapper(e,i);return t?.forEach(s=>{this.createMethod(r,s,!0)}),n?.forEach(s=>{this.createMethod(r,s,!1)}),r}createMethod(e,t,n){e.addMethod(t,this.createMethodProxy(e,t,n))}createMethodProxy(e,t,n){return function(){return e.hasMethod(t)?e.callMethod(t,arguments):(n&&de(49,{methodName:t}),null)}}},Qje={tag:"div",cls:"ag-tooltip"},Zje=class extends xg{constructor(){super(Qje)}init(e){const{value:t}=e;this.getGui().textContent=Ol(t,!0)}};function nne(e){const{inputValue:t,allSuggestions:n,hideIrrelevant:i,filterByPercentageOfBestMatch:r}=e;let s=n.map((l,u)=>({value:l,relevance:Jje(t,l),idx:u}));if(s.sort((l,u)=>u.relevance-l.relevance),i&&(s=s.filter(l=>l.relevance!==0)),s.length>0&&r&&r>0){const u=s[0].relevance*r;s=s.filter(c=>u-c.relevance<0)}const o=[],a=[];for(const l of s)o.push(l.value),a.push(l.idx);return{values:o,indices:a}}function Jje(e,t){if(e===t)return 1e3;const n=e.length,i=t.length;if(n===0||i===0)return 0;const r=e.toLocaleLowerCase(),s=t.toLocaleLowerCase(),o=s.indexOf(r);if(o!==-1)return 980-o*2;if([...r].filter(d=>s.includes(d)).length===0)return 0;let l=Array.from({length:i+1},(d,h)=>h);for(let d=0;d<n;d++){const h=[d+1];for(let p=0;p<i;p++){const g=l[p+1]+1,m=h[p]+1;let C=l[p]+(e[d]!==t[p]?1:0);i>10&&p>i/2&&(C+=1),d>0&&p>0&&e[d-1]===t[p-1]&&(C-=4),h.push(Math.min(g,m,C))}l=h}const u=Math.round(l[i]),c=Math.max(1,1e3-u*30);return Math.max(1,c)}function eKe(e,t){if(typeof e!="number")return"";const n=t(),i=n("thousandSeparator",","),r=n("decimalSeparator",".");return e.toString().replace(".",r).replace(/(\d)(?=(\d{3})+(?!\d))/g,`$1${i}`)}var tKe=class extends Z{getFileName(e){const t=this.getDefaultFileExtension();return(e==null||!e.length)&&(e=this.getDefaultFileName()),e.indexOf(".")===-1?`${e}.${t}`:e}getData(e){const t=this.createSerializingSession(e);return this.beans.gridSerializer.serialize(t,e)}getDefaultFileName(){return`export.${this.getDefaultFileExtension()}`}},nKe=class{constructor(e){this.groupColumns=[];const{colModel:t,rowGroupColsSvc:n,colNames:i,valueSvc:r,gos:s,processCellCallback:o,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:u}=e;this.colModel=t,this.rowGroupColsSvc=n,this.colNames=i,this.valueSvc=r,this.gos=s,this.processCellCallback=o,this.processHeaderCallback=a,this.processGroupHeaderCallback=l,this.processRowGroupCallback=u}prepare(e){this.groupColumns=e.filter(t=>!!t.getColDef().showRowGroup)}extractHeaderValue(e){return this.getHeaderName(this.processHeaderCallback,e)??""}extractRowCellValue(e,t,n,i,r){const o=(!this.gos.get("groupHideOpenParents")||r.footer)&&this.shouldRenderGroupSummaryCell(r,e,t)?this.createValueForGroupNode(e,r):this.valueSvc.getValueForDisplay(e,r);return this.processCell({accumulatedRowIndex:n,rowNode:r,column:e,value:o,processCellCallback:this.processCellCallback,type:i})}shouldRenderGroupSummaryCell(e,t,n){if(!(e.group&&!this.gos.get("treeData")))return!1;if(this.groupColumns.indexOf(t)!==-1){if(e.groupData?.[t.getId()]!==void 0||bg(this.gos)&&e.group)return!0;if(e.footer&&e.level===-1){const o=t.getColDef();return o==null||o.showRowGroup===!0||o.showRowGroup===this.rowGroupColsSvc?.columns[0].getId()}}const s=hN(this.gos,this.colModel.isPivotMode());return n===0&&s}getHeaderName(e,t){return e?e(ze(this.gos,{column:t})):this.colNames.getDisplayNameForColumn(t,"csv",!0)}createValueForGroupNode(e,t){if(this.processRowGroupCallback)return this.processRowGroupCallback(ze(this.gos,{column:e,node:t}));const n=this.gos.get("treeData"),i=a=>{if(n)return a.key;const l=a.groupData?.[e.getId()];return!l||!a.rowGroupColumn||a.rowGroupColumn.getColDef().useValueFormatterForExport===!1?l:this.valueSvc.formatValue(a.rowGroupColumn,a,l)??l},r=t.footer,s=[i(t)];if(!X5e(this.gos))for(;t.parent;)t=t.parent,s.push(i(t));const o=s.reverse().join(" -> ");return r?`Total ${o}`:o}processCell(e){const{accumulatedRowIndex:t,rowNode:n,column:i,value:r,processCellCallback:s,type:o}=e;return s?{value:s(ze(this.gos,{accumulatedRowIndex:t,column:i,node:n,value:r,type:o,parseValue:a=>this.valueSvc.parseValue(i,n,a,this.valueSvc.getValue(i,n)),formatValue:a=>this.valueSvc.formatValue(i,n,a)??a}))??""}:i.getColDef().useValueFormatterForExport!==!1?{value:r??"",valueFormatted:this.valueSvc.formatValue(i,n,r)}:{value:r??""}}};function iKe(e,t){const n=document.defaultView||window;if(!n){de(52);return}const i=document.createElement("a"),r=n.URL.createObjectURL(t);i.setAttribute("href",r),i.setAttribute("download",e),i.style.display="none",document.body.appendChild(i),i.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:n})),document.body.removeChild(i),n.setTimeout(()=>{n.URL.revokeObjectURL(r)},0)}var rKe={enableBrowserTooltips:!0,tooltipTrigger:!0,tooltipMouseTrack:!0,tooltipShowMode:!0,tooltipInteraction:!0,defaultColGroupDef:!0,suppressAutoSize:!0,skipHeaderOnAutoSize:!0,autoSizeStrategy:!0,components:!0,stopEditingWhenCellsLoseFocus:!0,undoRedoCellEditing:!0,undoRedoCellEditingLimit:!0,excelStyles:!0,cacheQuickFilter:!0,customChartThemes:!0,chartThemeOverrides:!0,chartToolPanelsDef:!0,loadingCellRendererSelector:!0,localeText:!0,keepDetailRows:!0,keepDetailRowsCount:!0,detailRowHeight:!0,detailRowAutoHeight:!0,tabIndex:!0,valueCache:!0,valueCacheNeverExpires:!0,enableCellExpressions:!0,suppressTouch:!0,suppressBrowserResizeObserver:!0,suppressPropertyNamesCheck:!0,debug:!0,dragAndDropImageComponent:!0,loadingOverlayComponent:!0,suppressLoadingOverlay:!0,noRowsOverlayComponent:!0,paginationPageSizeSelector:!0,paginateChildRows:!0,pivotPanelShow:!0,pivotSuppressAutoColumn:!0,suppressExpandablePivotGroups:!0,aggFuncs:!0,allowShowChangeAfterFilter:!0,ensureDomOrder:!0,enableRtl:!0,suppressColumnVirtualisation:!0,suppressMaxRenderedRowRestriction:!0,suppressRowVirtualisation:!0,rowDragText:!0,groupLockGroupColumns:!0,suppressGroupRowsSticky:!0,rowModelType:!0,cacheOverflowSize:!0,infiniteInitialRowCount:!0,serverSideInitialRowCount:!0,maxBlocksInCache:!0,maxConcurrentDatasourceRequests:!0,blockLoadDebounceMillis:!0,serverSideOnlyRefreshFilteredGroups:!0,serverSidePivotResultFieldSeparator:!0,viewportRowModelPageSize:!0,viewportRowModelBufferSize:!0,debounceVerticalScrollbar:!0,suppressAnimationFrame:!0,suppressPreventDefaultOnMouseWheel:!0,scrollbarWidth:!0,icons:!0,suppressRowTransform:!0,gridId:!0,enableGroupEdit:!0,initialState:!0,processUnpinnedColumns:!0,createChartContainer:!0,getLocaleText:!0,getRowId:!0,reactiveCustomComponents:!0,columnMenu:!0,suppressSetFilterByDefault:!0,getDataPath:!0,enableCellSpan:!0},wr="clientSide",Ki="serverSide",vf="infinite",sKe={onGroupExpandedOrCollapsed:[wr],refreshClientSideRowModel:[wr],isRowDataEmpty:[wr],forEachLeafNode:[wr],forEachNodeAfterFilter:[wr],forEachNodeAfterFilterAndSort:[wr],resetRowHeights:[wr],applyTransaction:[wr],applyTransactionAsync:[wr],flushAsyncTransactions:[wr],getBestCostNodeSelection:[wr],getServerSideSelectionState:[Ki],setServerSideSelectionState:[Ki],applyServerSideTransaction:[Ki],applyServerSideTransactionAsync:[Ki],applyServerSideRowData:[Ki],retryServerSideLoads:[Ki],flushServerSideAsyncTransactions:[Ki],refreshServerSide:[Ki],getServerSideGroupLevelState:[Ki],refreshInfiniteCache:[vf],purgeInfiniteCache:[vf],getInfiniteRowCount:[vf],isLastRowIndexKnown:[vf,Ki],expandAll:[wr,Ki],collapseAll:[wr,Ki],onRowHeightChanged:[wr,Ki],setRowCount:[vf,Ki],getCacheBlockState:[vf,Ki]},oKe={showLoadingOverlay:{version:"v32",message:'`showLoadingOverlay` is deprecated. Use the grid option "loading"=true instead or setGridOption("loading", true).'},clearRangeSelection:{version:"v32.2",message:"Use `clearCellSelection` instead."},getInfiniteRowCount:{version:"v32.2",old:"getInfiniteRowCount()",new:"getDisplayedRowCount()"},selectAllFiltered:{version:"v33",old:"selectAllFiltered()",new:'selectAll("filtered")'},deselectAllFiltered:{version:"v33",old:"deselectAllFiltered()",new:'deselectAll("filtered")'},selectAllOnCurrentPage:{version:"v33",old:"selectAllOnCurrentPage()",new:'selectAll("currentPage")'},deselectAllOnCurrentPage:{version:"v33",old:"deselectAllOnCurrentPage()",new:'deselectAll("currentPage")'}};function aKe(e,t,n){const i=oKe[e];if(i){const{version:s,new:o,old:a,message:l}=i,u=a??e;return(...c)=>{const d=o?`Please use ${o} instead. `:"";return Dv(`Since ${s} api.${u} is deprecated. ${d}${l??""}`),t.apply(t,c)}}const r=sKe[e];return r?(...s)=>{const o=n.rowModel.getType();if(!r.includes(o)){qf(`api.${e} can only be called when gridOptions.rowModelType is ${r.join(" or ")}`);return}return t.apply(t,s)}:t}var ine={AdvancedFilter:1,AllEnterprise:1,CellSelection:1,Clipboard:1,ColumnMenu:1,ColumnsToolPanel:1,ContextMenu:1,ExcelExport:1,FiltersToolPanel:1,Find:1,GridCharts:1,IntegratedCharts:1,GroupFilter:1,MasterDetail:1,Menu:1,MultiFilter:1,Pivot:1,RangeSelection:1,RichSelect:1,RowNumbers:1,RowGrouping:1,RowGroupingPanel:1,ServerSideRowModelApi:1,ServerSideRowModel:1,SetFilter:1,SideBar:1,Sparklines:1,StatusBar:1,TreeData:1,ViewportRowModel:1},ok=["TextFilter","NumberFilter","DateFilter","SetFilter","MultiFilter","GroupFilter","CustomFilter"],lKe={EditCore:["TextEditor","NumberEditor","DateEditor","CheckboxEditor","LargeTextEditor","SelectEditor","RichSelect","CustomEditor"],CheckboxCellRenderer:["AllCommunity"],ClientSideRowModelHierarchy:["RowGrouping","Pivot","TreeData"],ColumnFilter:ok,ColumnGroupHeaderComp:["AllCommunity"],ColumnGroup:["AllCommunity"],ColumnHeaderComp:["AllCommunity"],ColumnMove:["AllCommunity"],ColumnResize:["AllCommunity"],CommunityCore:["AllCommunity"],CsrmSsrmSharedApi:["ClientSideRowModelApi","ServerSideRowModelApi"],EnterpriseCore:["AllEnterprise"],FilterCore:[...ok,"QuickFilter","ExternalFilter","AdvancedFilter"],GroupCellRenderer:["RowGrouping","Pivot","TreeData","MasterDetail","ServerSideRowModel"],KeyboardNavigation:["AllCommunity"],LoadingCellRenderer:["ServerSideRowModel"],MenuCore:["ColumnMenu","ContextMenu"],MenuItem:["ColumnMenu","ContextMenu","MultiFilter","IntegratedCharts","ColumnsToolPanel"],Overlay:["AllCommunity"],PinnedColumn:["AllCommunity"],SharedAggregation:["RowGrouping","Pivot","TreeData","ServerSideRowModel"],SharedDragAndDrop:["AllCommunity"],SharedMasterDetail:["MasterDetail","ServerSideRowModel"],SharedMenu:[...ok,"ColumnMenu","ContextMenu"],SharedPivot:["Pivot","ServerSideRowModel"],SharedRowGrouping:["RowGrouping","ServerSideRowModel"],SharedRowSelection:["RowSelection","ServerSideRowModel"],SkeletonCellRenderer:["ServerSideRowModel"],Sort:["AllCommunity"],SsrmInfiniteSharedApi:["InfiniteRowModel","ServerSideRowModelApi"],SharedTreeData:["TreeData","ServerSideRowModel"]},uKe={InfiniteRowModel:"infinite",ClientSideRowModelApi:"clientSide",ClientSideRowModel:"clientSide",ServerSideRowModelApi:"serverSide",ServerSideRowModel:"serverSide",ViewportRowModel:"viewport"};function cKe(e,t){const n=[];return(Array.isArray(e)?e:[e]).forEach(i=>{const r=lKe[i];r?r.forEach(s=>{const o=uKe[s];(!o||o===t)&&n.push(s)}):n.push(i)}),n}var Zf={agSetColumnFilter:"SetFilter",agSetColumnFloatingFilter:"SetFilter",agMultiColumnFilter:"MultiFilter",agMultiColumnFloatingFilter:"MultiFilter",agGroupColumnFilter:"GroupFilter",agGroupColumnFloatingFilter:"GroupFilter",agGroupCellRenderer:"GroupCellRenderer",agGroupRowRenderer:"GroupCellRenderer",agRichSelect:"RichSelect",agRichSelectCellEditor:"RichSelect",agDetailCellRenderer:"SharedMasterDetail",agSparklineCellRenderer:"Sparklines",agDragAndDropImage:"SharedDragAndDrop",agColumnHeader:"ColumnHeaderComp",agColumnGroupHeader:"ColumnGroupHeaderComp",agSortIndicator:"Sort",agAnimateShowChangeCellRenderer:"HighlightChanges",agAnimateSlideCellRenderer:"HighlightChanges",agLoadingCellRenderer:"LoadingCellRenderer",agSkeletonCellRenderer:"SkeletonCellRenderer",agCheckboxCellRenderer:"CheckboxCellRenderer",agLoadingOverlay:"Overlay",agNoRowsOverlay:"Overlay",agTooltipComponent:"Tooltip",agReadOnlyFloatingFilter:"CustomFilter",agTextColumnFilter:"TextFilter",agNumberColumnFilter:"NumberFilter",agDateColumnFilter:"DateFilter",agDateInput:"DateFilter",agTextColumnFloatingFilter:"TextFilter",agNumberColumnFloatingFilter:"NumberFilter",agDateColumnFloatingFilter:"DateFilter",agCellEditor:"TextEditor",agSelectCellEditor:"SelectEditor",agTextCellEditor:"TextEditor",agNumberCellEditor:"NumberEditor",agDateCellEditor:"DateEditor",agDateStringCellEditor:"DateEditor",agCheckboxCellEditor:"CheckboxEditor",agLargeTextCellEditor:"LargeTextEditor",agMenuItem:"MenuItem",agColumnsToolPanel:"ColumnsToolPanel",agFiltersToolPanel:"FiltersToolPanel",agAggregationComponent:"StatusBar",agSelectedRowCountComponent:"StatusBar",agTotalRowCountComponent:"StatusBar",agFilteredRowCountComponent:"StatusBar",agTotalAndFilteredRowCountComponent:"StatusBar",agFindCellRenderer:"Find"},dKe=e=>{const t=e.map(i=>`import { ${_v(i)} } from '${ine[i]?"ag-grid-enterprise":"ag-grid-community"}';`);return e.some(i=>i==="IntegratedCharts"||i==="Sparklines")&&t.push("import { AgChartsEnterpriseModule } from 'ag-charts-enterprise';"),`import { ModuleRegistry } from 'ag-grid-community'; 
${t.join(` 
`)} 

ModuleRegistry.registerModules([ ${e.map(i=>_v(i,!0)).join(", ")} ]); 

For more info see: ${Bd}/modules/`};function _v(e,t=!1){return t&&(e==="IntegratedCharts"||e==="Sparklines")?`${e}Module.with(AgChartsEnterpriseModule)`:`${e}Module`}function hKe(e,t){const n=t.filter(s=>s==="IntegratedCharts"||s==="Sparklines");let i="";return!globalThis?.agCharts&&n.length>0?i=`Unable to use ${e} as either the ag-charts-community or ag-charts-enterprise script needs to be included alongside ag-grid-enterprise.
`:t.some(s=>ine[s])&&(i=i+`Unable to use ${e} as that requires the ag-grid-enterprise script to be included.
`),i}var WW=({reasonOrId:e,moduleName:t,gridScoped:n,gridId:i,rowModelType:r,additionalText:s,isUmd:o})=>{const a=cKe(t,r),l=typeof e=="string"?e:mKe[e];if(o)return hKe(l,a);const u=a.filter(h=>h==="IntegratedCharts"||h==="Sparklines"),c=u.length>0?`${u.map(h=>_v(h)).join()} must be initialised with an AG Charts module. One of 'AgChartsCommunityModule' / 'AgChartsEnterpriseModule'.`:"";return`${`Unable to use ${l} as ${a.length>1?"one of "+a.map(h=>_v(h)).join(", "):_v(a[0])} is not registered${n?" for gridId: "+i:""}. ${c} Check if you have registered the module:
`}
${dKe(a)}`+(s?` 

${s}`:"")},UW=e=>`${e} must be initialised with an AG Charts module. One of 'AgChartsCommunityModule' / 'AgChartsEnterpriseModule'.

import { AgChartsEnterpriseModule } from 'ag-charts-enterprise';
import { ModuleRegistry } from 'ag-grid-community';
import { ${e} } from 'ag-grid-enterprise';
    
ModuleRegistry.registerModules([${e}.with(AgChartsEnterpriseModule)]);
    `,fKe=e=>`AG Grid: Unable to use the Clipboard API (navigator.clipboard.${e}()). The reason why it could not be used has been logged in the previous line. For this reason the grid has defaulted to using a workaround which doesn't perform as well. Either fix why Clipboard API is blocked, OR stop this message from appearing by setting grid property suppressClipboardApi=true (which will default the grid to using the workaround rather than the API.`,pKe={1:()=>"`rowData` must be an array",2:({nodeId:e})=>`Duplicate node id '${e}' detected from getRowId callback, this could cause issues in your grid.`,3:()=>"Calling gridApi.resetRowHeights() makes no sense when using Auto Row Height.",4:({id:e})=>`Could not find row id=${e}, data item was not found for this id`,5:({data:e})=>["Could not find data item as object was not found.",e," Consider using getRowId to help the Grid find matching row data"],6:()=>"'groupHideOpenParents' only works when specifying specific columns for 'colDef.showRowGroup'",7:()=>"Pivoting is not supported with aligned grids as it may produce different columns in each grid.",8:({key:e})=>`Unknown key for navigation ${e}`,9:({variable:e})=>`No value for ${e?.cssName}. This usually means that the grid has been initialised before styles have been loaded. The default value of ${e?.defaultValue} will be used and updated when styles load.`,10:({eventType:e})=>`As of v33, the '${e}' event is deprecated. Use the global 'modelUpdated' event to determine when row children have changed.`,11:()=>"No gridOptions provided to createGrid",12:({colKey:e})=>["column ",e," not found"],13:()=>"Could not find rowIndex, this means tasks are being executed on a rowNode that has been removed from the grid.",14:({groupPrefix:e})=>`Row IDs cannot start with ${e}, this is a reserved prefix for AG Grid's row grouping feature.`,15:({expression:e})=>["value should be either a string or a function",e],16:({expression:e,params:t,e:n})=>["Processing of the expression failed","Expression = ",e,"Params = ",t,"Exception = ",n],17:()=>"you need either field or valueSetter set on colDef for editing to work",18:()=>"alignedGrids contains an undefined option.",19:()=>"alignedGrids - No api found on the linked grid.",20:()=>`You may want to configure via a callback to avoid setup race conditions:
                     "alignedGrids: () => [linkedGrid]"`,21:()=>"pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.",22:({key:e})=>`${e} is an initial property and cannot be updated.`,23:()=>"The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead.",24:()=>"row height must be a number if not using standard row model",25:({id:e})=>["The getRowId callback must return a string. The ID ",e," is being cast to a string."],26:({fnName:e,preDestroyLink:t})=>`Grid API function ${e}() cannot be called as the grid has been destroyed.
 Either clear local references to the grid api, when it is destroyed, or check gridApi.isDestroyed() to avoid calling methods against a destroyed grid.
 To run logic when the grid is about to be destroyed use the gridPreDestroy event. See: ${t}`,27:({fnName:e,module:t})=>`API function '${e}' not registered to module '${t}'`,28:()=>"setRowCount cannot be used while using row grouping.",29:()=>"tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?",30:({toIndex:e})=>["tried to insert columns in invalid location, toIndex = ",e,"remember that you should not count the moving columns when calculating the new index"],31:()=>"infinite loop in resizeColumnSets",32:()=>"applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state.",33:()=>"stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON.",34:({key:e})=>`the column type '${e}' is a default column type and cannot be overridden.`,35:()=>"Column type definitions 'columnTypes' with a 'type' attribute are not supported because a column type cannot refer to another column type. Only column definitions 'columnDefs' can use the 'type' attribute to refer to a column type.",36:({t:e})=>"colDef.type '"+e+"' does not correspond to defined gridOptions.columnTypes",37:()=>"Changing the column pinning status is not allowed with domLayout='print'",38:({iconName:e})=>`provided icon '${e}' needs to be a string or a function`,39:()=>"Applying column order broke a group where columns should be married together. Applying new order has been discarded.",40:({e,method:t})=>`${e}
${fKe(t)}`,41:()=>"Browser did not allow document.execCommand('copy'). Ensure 'api.copySelectedRowsToClipboard() is invoked via a user event, i.e. button click, otherwise the browser will prevent it for security reasons.",42:()=>"Browser does not support document.execCommand('copy') for clipboard operations",43:({iconName:e})=>`As of v33, icon '${e}' is deprecated. Use the icon CSS name instead.`,44:()=>'Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.',45:({parentCellDataType:e})=>`The data type definition ${e} does not exist.`,46:()=>'The "baseDataType" property of a data type definition must match that of its parent.',47:({cellDataType:e})=>`Missing data type definition - "${e}"`,48:({property:e})=>`Cell data type is "object" but no Value ${e} has been provided. Please either provide an object data type definition with a Value ${e}, or set "colDef.value${e}"`,49:({methodName:e})=>`Framework component is missing the method ${e}()`,50:({compName:e})=>`Could not find component ${e}, did you forget to configure this component?`,51:()=>"Export cancelled. Export is not allowed as per your configuration.",52:()=>"There is no `window` associated with the current `document`",53:()=>"unknown value type during csv conversion",54:()=>"Could not find document body, it is needed for drag and drop and context menu.",55:()=>"addRowDropZone - A container target needs to be provided",56:()=>"addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.",57:()=>"unable to show popup filter, filter instantiation failed",58:()=>"no values found for select cellEditor",59:()=>"cannot select pinned rows",60:()=>"cannot select node until it has finished loading",61:()=>"since version v32.2.0, rowNode.isFullWidthCell() has been deprecated. Instead check `rowNode.detail` followed by the user provided `isFullWidthRow` grid option.",62:({colId:e})=>`setFilterModel() - no column found for colId: ${e}`,63:({colId:e})=>`setFilterModel() - unable to fully apply model, filtering disabled for colId: ${e}`,64:({colId:e})=>`setFilterModel() - unable to fully apply model, unable to create filter for colId: ${e}`,65:()=>"filter missing setModel method, which is needed for setFilterModel",66:()=>"filter API missing getModel method, which is needed for getFilterModel",67:()=>"Filter is missing isFilterActive() method",68:()=>"Column Filter API methods have been disabled as Advanced Filters are enabled.",69:({guiFromFilter:e})=>`getGui method from filter returned ${e}; it should be a DOM element.`,70:({newFilter:e})=>`Grid option quickFilterText only supports string inputs, received: ${typeof e}`,71:()=>"debounceMs is ignored when apply button is present",72:({keys:e})=>["ignoring FilterOptionDef as it doesn't contain one of ",e],73:()=>"invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'",74:()=>"no filter options for filter",75:()=>"Unknown button type specified",76:({filterModelType:e})=>['Unexpected type of filter "',e,'", it looks like the filter was configured with incorrect Filter Options'],77:()=>"Filter model is missing 'conditions'",78:()=>'Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.',79:()=>'"filterParams.maxNumConditions" must be greater than or equal to zero.',80:()=>'"filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.',81:()=>'"filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".',82:({param:e})=>`DateFilter ${e} is not a number`,83:()=>"DateFilter minValidYear should be <= maxValidYear",84:()=>"DateFilter minValidDate should be <= maxValidDate",85:()=>"DateFilter should not have both minValidDate and minValidYear parameters set at the same time! minValidYear will be ignored.",86:()=>"DateFilter should not have both maxValidDate and maxValidYear parameters set at the same time! maxValidYear will be ignored.",87:()=>"DateFilter parameter minValidDate should always be lower than or equal to parameter maxValidDate.",88:({index:e})=>`Invalid row index for ensureIndexVisible: ${e}`,89:()=>"A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)",90:()=>"datasource is missing getRows method",91:()=>"Filter is missing method doesFilterPass",92:()=>"AnimationFrameService called but animation frames are off",93:()=>"cannot add multiple ranges when `cellSelection.suppressMultiRanges = true`",94:({paginationPageSizeOption:e,pageSizeSet:t,pageSizesSet:n,pageSizeOptions:i})=>`'paginationPageSize=${e}'${t?"":" (default value)"}, but ${e} is not included in${n?"":" the default"} paginationPageSizeSelector=[${i?.join(", ")}].`,95:({paginationPageSizeOption:e,paginationPageSizeSelector:t})=>`Either set '${t}' to an array that includes ${e} or to 'false' to disable the page size selector.`,96:({id:e,data:t})=>["Duplicate ID",e,"found for pinned row with data",t,"When `getRowId` is defined, it must return unique IDs for all pinned rows. Use the `rowPinned` parameter."],97:({colId:e})=>`cellEditor for column ${e} is missing getGui() method`,98:()=>"popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.",99:()=>"Since v32, `api.hideOverlay()` does not hide the loading overlay when `loading=true`. Set `loading=false` instead.",100:({rowModelType:e})=>`selectAll only available when rowModelType='clientSide', ie not ${e}`,101:({propertyName:e,componentName:t,agGridDefaults:n,jsComps:i})=>{const r=[],s=[...Object.keys(n??[]).filter(a=>!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(a)),...Object.keys(i??[])],o=nne({inputValue:t,allSuggestions:s,hideIrrelevant:!0,filterByPercentageOfBestMatch:.8}).values;return r.push(`Could not find '${t}' component. It was configured as "${e}: '${t}'" but it wasn't found in the list of registered components.
`),o.length>0&&r.push(`         Did you mean: [${o.slice(0,3)}]?
`),r.push("If using a custom component check it has been registered correctly."),r},102:()=>"selectAll: 'filtered' only works when gridOptions.rowModelType='clientSide'",103:()=>"Invalid selection state. When using client-side row model, the state must conform to `string[]`.",104:({value:e,param:t})=>`Numeric value ${e} passed to ${t} param will be interpreted as ${e} seconds. If this is intentional use "${e}s" to silence this warning.`,105:({e})=>["chart rendering failed",e],106:()=>`Theming API and Legacy Themes are both used in the same page. A Theming API theme has been provided to the 'theme' grid option, but the file (ag-grid.css) is also included and will cause styling issues. Remove ag-grid.css from the page. See the migration guide: ${Bd}/theming-migration/`,107:({key:e,value:t})=>`Invalid value for theme param ${e} - ${t}`,108:({e})=>["chart update failed",e],109:({aggFuncOrString:e})=>`unrecognised aggregation function ${e}`,110:()=>"groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup",111:()=>"Invalid selection state. When `groupSelects` is enabled, the state must conform to `IServerSideGroupSelectionState`.",113:()=>"Set Filter cannot initialise because you are using a row model that does not contain all rows in the browser. Either use a different filter type, or configure Set Filter such that you provide it with values",114:({component:e})=>`Could not find component with name of ${e}. Is it in Vue.components?`,116:()=>"Invalid selection state. The state must conform to `IServerSideSelectionState`.",117:()=>"selectAll must be of boolean type.",118:()=>"Infinite scrolling must be enabled in order to set the row count.",119:()=>"Unable to instantiate filter",120:()=>"MultiFloatingFilterComp expects MultiFilter as its parent",121:()=>"a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (see AG Grid docs) or b) to toString() on the object to return a key",122:()=>"could not find the document, document is empty",123:()=>"Advanced Filter is only supported with the Client-Side Row Model or Server-Side Row Model.",124:()=>"No active charts to update.",125:({chartId:e})=>`Unable to update chart. No active chart found with ID: ${e}.`,126:()=>"unable to restore chart as no chart model is provided",127:({allRange:e})=>`unable to create chart as ${e?"there are no columns in the grid":"no range is selected"}.`,128:({feature:e})=>`${e} is only available if using 'multiRow' selection mode.`,129:({feature:e,rowModel:t})=>`${e} is only available if using 'clientSide' or 'serverSide' rowModelType, you are using ${t}.`,130:()=>'cannot multi select unless selection mode is "multiRow"',132:()=>"Row selection features are not available unless `rowSelection` is enabled.",133:({iconName:e})=>`icon '${e}' function should return back a string or a dom object`,134:({iconName:e})=>`Did not find icon '${e}'`,135:()=>"Data type of the new value does not match the cell data type of the column",136:()=>"Unable to update chart as the 'type' is missing. It must be either 'rangeChartUpdate', 'pivotChartUpdate', or 'crossFilterChartUpdate'.",137:({type:e,currentChartType:t})=>`Unable to update chart as a '${e}' update type is not permitted on a ${t}.`,138:({chartType:e})=>`invalid chart type supplied: ${e}`,139:({customThemeName:e})=>`a custom chart theme with the name ${e} has been supplied but not added to the 'chartThemes' list`,140:({name:e})=>`no stock theme exists with the name '${e}' and no custom chart theme with that name was supplied to 'customChartThemes'`,141:()=>"cross filtering with row grouping is not supported.",142:()=>"cross filtering is only supported in the client side row model.",143:({panel:e})=>`'${e}' is not a valid Chart Tool Panel name`,144:({type:e})=>`Invalid charts data panel group name supplied: '${e}'`,145:({group:e})=>`As of v32, only one charts customize panel group can be expanded at a time. '${e}' will not be expanded.`,146:({comp:e})=>`Unable to instantiate component '${e}' as its module hasn't been loaded. Add 'ValidationModule' to see which module is required.`,147:({group:e})=>`Invalid charts customize panel group name supplied: '${e}'`,148:({group:e})=>`invalid chartGroupsDef config '${e}'`,149:({group:e,chartType:t})=>`invalid chartGroupsDef config '${e}.${t}'`,150:()=>"'seriesChartTypes' are required when the 'customCombo' chart type is specified.",151:({chartType:e})=>`invalid chartType '${e}' supplied in 'seriesChartTypes', converting to 'line' instead.`,152:({colId:e})=>`no 'seriesChartType' found for colId = '${e}', defaulting to 'line'.`,153:({chartDataType:e})=>`unexpected chartDataType value '${e}' supplied, instead use 'category', 'series' or 'excluded'`,154:({colId:e})=>`cross filtering requires a 'agSetColumnFilter' or 'agMultiColumnFilter' to be defined on the column with id: ${e}`,155:({option:e})=>`'${e}' is not a valid Chart Toolbar Option`,156:({panel:e})=>`Invalid panel in chartToolPanelsDef.panels: '${e}'`,157:({unrecognisedGroupIds:e})=>["unable to find group(s) for supplied groupIds:",e],158:()=>"can not expand a column item that does not represent a column group header",159:()=>"Invalid params supplied to createExcelFileForExcel() - `ExcelExportParams.data` is empty.",160:()=>"Export cancelled. Export is not allowed as per your configuration.",161:()=>"The Excel Exporter is currently on Multi Sheet mode. End that operation by calling 'api.getMultipleSheetAsExcel()' or 'api.exportMultipleSheetsAsExcel()'",162:({id:e,dataType:t})=>`Unrecognized data type for excel export [${e}.dataType=${t}]`,163:({featureName:e})=>`Excel table export does not work with ${e}. The exported Excel file will not contain any Excel tables.
 Please turn off ${e} to enable Excel table exports.`,164:()=>"Unable to add data table to Excel sheet: A table already exists.",165:()=>"Unable to add data table to Excel sheet: Missing required parameters.",166:({unrecognisedGroupIds:e})=>["unable to find groups for these supplied groupIds:",e],167:({unrecognisedColIds:e})=>["unable to find columns for these supplied colIds:",e],168:()=>"detailCellRendererParams.template should be function or string",169:()=>'Reference to eDetailGrid was missing from the details template. Please add data-ref="eDetailGrid" to the template.',170:({providedStrategy:e})=>`invalid cellRendererParams.refreshStrategy = ${e} supplied, defaulting to refreshStrategy = 'rows'.`,171:()=>"could not find detail grid options for master detail, please set gridOptions.detailCellRendererParams.detailGridOptions",172:()=>"could not find getDetailRowData for master / detail, please set gridOptions.detailCellRendererParams.getDetailRowData",173:({group:e})=>`invalid chartGroupsDef config '${e}'`,174:({group:e,chartType:t})=>`invalid chartGroupsDef config '${e}.${t}'`,175:({menuTabName:e,itemsToConsider:t})=>[`Trying to render an invalid menu item '${e}'. Check that your 'menuTabs' contains one of `,t],176:({key:e})=>`unknown menu item type ${e}`,177:()=>"valid values for cellSelection.handle.direction are 'x', 'y' and 'xy'. Default to 'xy'.",178:({colId:e})=>`column ${e} is not visible`,179:()=>"totalValueGetter should be either a function or a string (expression)",180:()=>"agRichSelectCellEditor requires cellEditorParams.values to be set",181:()=>"agRichSelectCellEditor cannot have `multiSelect` and `allowTyping` set to `true`. AllowTyping has been turned off.",182:()=>'you cannot mix groupDisplayType = "multipleColumns" with treeData, only one column can be used to display groups when doing tree data',183:()=>"Group Column Filter only works on group columns. Please use a different filter.",184:({parentGroupData:e,childNodeData:t})=>["duplicate group keys for row data, keys should be unique",[e,t]],185:({data:e})=>["getDataPath() should not return an empty path",[e]],186:({rowId:e,rowData:t,duplicateRowsData:n})=>["duplicate group keys for row data, keys should be unique",e,t,...n??[]],187:({rowId:e,firstData:t,secondData:n})=>[`Duplicate node id ${e}. Row IDs are provided via the getRowId() callback. Please modify the getRowId() callback code to provide unique row id values.`,"first instance",t,"second instance",n],188:()=>"getRowId callback must be provided for Server Side Row Model selection to work correctly.",189:({startRow:e})=>`invalid value ${e} for startRow, the value should be >= 0`,190:({rowGroupId:e,data:t})=>["null and undefined values are not allowed for server side row model keys",e?`column = ${e}`:"","data is ",t],194:({method:e})=>`calling gridApi.${e}() is only possible when using rowModelType=\`clientSide\`.`,195:({justCurrentPage:e})=>`selecting just ${e?"current page":"filtered"} only works when gridOptions.rowModelType='clientSide'`,196:({key:e})=>`Provided ids must be of string type. Invalid id provided: ${e}`,197:()=>"`toggledNodes` must be an array of string ids.",199:()=>"getSelectedNodes and getSelectedRows functions cannot be used with select all functionality with the server-side row model. Use `api.getServerSideSelectionState()` instead.",200:WW,201:({rowModelType:e})=>`Could not find row model for rowModelType = ${e}`,202:()=>"`getSelectedNodes` and `getSelectedRows` functions cannot be used with `groupSelectsChildren` and the server-side row model. Use `api.getServerSideSelectionState()` instead.",203:()=>"Server Side Row Model does not support Dynamic Row Height and Cache Purging. Either a) remove getRowHeight() callback or b) remove maxBlocksInCache property. Purging has been disabled.",204:()=>"Server Side Row Model does not support Auto Row Height and Cache Purging. Either a) remove colDef.autoHeight or b) remove maxBlocksInCache property. Purging has been disabled.",205:({duplicateIdText:e})=>`Unable to display rows as duplicate row ids (${e}) were returned by the getRowId callback. Please modify the getRowId callback to provide unique ids.`,206:()=>"getRowId callback must be implemented for transactions to work. Transaction was ignored.",207:()=>'The Set Filter Parameter "defaultToNothingSelected" value was ignored because it does not work when "excelMode" is used.',208:()=>"Set Filter Value Formatter must return string values. Please ensure the Set Filter Value Formatter returns string values for complex objects.",209:()=>`Set Filter Key Creator is returning null for provided values and provided values are primitives. Please provide complex objects. See ${Bd}/filter-set-filter-list/#filter-value-types`,210:()=>"Set Filter has a Key Creator, but provided values are primitives. Did you mean to provide complex objects?",211:()=>"property treeList=true for Set Filter params, but you did not provide a treeListPathGetter or values of type Date.",212:()=>"please review all your toolPanel components, it seems like at least one of them doesn't have an id",213:()=>"Advanced Filter does not work with Filters Tool Panel. Filters Tool Panel has been disabled.",214:({key:e})=>`unable to lookup Tool Panel as invalid key supplied: ${e}`,215:({key:e,defaultByKey:t})=>`the key ${e} is not a valid key for specifying a tool panel, valid keys are: ${Object.keys(t??{}).join(",")}`,216:({name:e})=>`Missing component for '${e}'`,217:({invalidColIds:e})=>["unable to find grid columns for the supplied colDef(s):",e],218:({property:e,defaultOffset:t})=>`${e} must be a number, the value you provided is not a valid number. Using the default of ${t}px.`,219:({property:e})=>`Property ${e} does not exist on the target object.`,220:({lineDash:e})=>`'${e}' is not a valid 'lineDash' option.`,221:()=>"agAggregationComponent should only be used with the client and server side row model.",222:()=>"agFilteredRowCountComponent should only be used with the client side row model.",223:()=>"agSelectedRowCountComponent should only be used with the client and server side row model.",224:()=>"agTotalAndFilteredRowCountComponent should only be used with the client side row model.",225:()=>"agTotalRowCountComponent should only be used with the client side row model.",226:()=>"viewport is missing init method.",227:()=>"menu item icon must be DOM node or string",228:({menuItemOrString:e})=>`unrecognised menu item ${e}`,229:({index:e})=>["invalid row index for ensureIndexVisible: ",e],230:()=>"detailCellRendererParams.template is not supported by AG Grid React. To change the template, provide a Custom Detail Cell Renderer. See https://www.ag-grid.com/react-data-grid/master-detail-custom-detail/",231:()=>"As of v32, using custom components with `reactiveCustomComponents = false` is deprecated.",232:()=>"Using both rowData and v-model. rowData will be ignored.",233:({methodName:e})=>`Framework component is missing the method ${e}()`,234:()=>'Group Column Filter does not work with the colDef property "field". This property will be ignored.',235:()=>'Group Column Filter does not work with the colDef property "filterValueGetter". This property will be ignored.',236:()=>'Group Column Filter does not work with the colDef property "filterParams". This property will be ignored.',237:()=>"Group Column Filter does not work with Tree Data enabled. Please disable Tree Data, or use a different filter.",238:()=>"setRowCount can only accept a positive row count.",239:()=>'Theming API and CSS File Themes are both used in the same page. In v33 we released the Theming API as the new default method of styling the grid. See the migration docs https://www.ag-grid.com/react-data-grid/theming-migration/. Because no value was provided to the `theme` grid option it defaulted to themeQuartz. But the file (ag-grid.css) is also included and will cause styling issues. Either pass the string "legacy" to the theme grid option to use v32 style themes, or remove ag-grid.css from the page to use Theming API.',240:({theme:e})=>`theme grid option must be a Theming API theme object or the string "legacy", received: ${e}`,243:()=>"Failed to deserialize state - each provided state object must be an object.",244:()=>"Failed to deserialize state - `selectAllChildren` must be a boolean value or undefined.",245:()=>"Failed to deserialize state - `toggledNodes` must be an array.",246:()=>"Failed to deserialize state - Every `toggledNode` requires an associated string id.",247:()=>`Row selection state could not be parsed due to invalid data. Ensure all child state has toggledNodes or does not conform with the parent rule. 
Please rebuild the selection state and reapply it.`,248:()=>"SetFloatingFilter expects SetFilter as its parent",249:()=>"Must supply a Value Formatter in Set Filter params when using a Key Creator",250:()=>"Must supply a Key Creator in Set Filter params when `treeList = true` on a group column, and Tree Data or Row Grouping is enabled.",251:({chartType:e})=>`AG Grid: Unable to create chart as an invalid chartType = '${e}' was supplied.`,252:()=>`cannot get grid to draw rows when it is in the middle of drawing rows. 
Your code probably called a grid API method while the grid was in the render stage. 
To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). 
To see what part of your code that caused the refresh check this stacktrace.`,253:({version:e})=>["Illegal version string: ",e],254:()=>"Cannot create chart: no chart themes available.",255:({point:e})=>`Lone surrogate U+${e?.toString(16).toUpperCase()} is not a scalar value`,256:()=>"Unable to initialise. See validation error, or load ValidationModule if missing.",257:()=>UW("IntegratedChartsModule"),258:()=>UW("SparklinesModule"),259:({part:e})=>`the argument to theme.withPart must be a Theming API part object, received: ${e}`,260:({propName:e,compName:t,gridScoped:n,gridId:i,rowModelType:r})=>WW({reasonOrId:`AG Grid '${e}' component: ${t}`,moduleName:Zf[t],gridId:i,gridScoped:n,rowModelType:r}),261:()=>"As of v33, `column.isHovered()` is deprecated. Use `api.isColumnHovered(column)` instead.",262:()=>'As of v33, icon key "smallDown" is deprecated. Use "advancedFilterBuilderSelect" for Advanced Filter Builder dropdown, "selectOpen" for Select cell editor and dropdowns (e.g. Integrated Charts menu), "richSelectOpen" for Rich Select cell editor.',263:()=>'As of v33, icon key "smallLeft" is deprecated. Use "panelDelimiterRtl" for Row Group Panel / Pivot Panel, "subMenuOpenRtl" for sub-menus.',264:()=>'As of v33, icon key "smallRight" is deprecated. Use "panelDelimiter" for Row Group Panel / Pivot Panel, "subMenuOpen" for sub-menus.',265:({colId:e})=>`Unable to infer chart data type for column '${e}' if first data entry is null. Please specify "chartDataType", or a "cellDataType" in the column definition. For more information, see ${Bd}/integrated-charts-range-chart#coldefchartdatatype .`,266:()=>'As of v33.1, using "keyCreator" with the Rich Select Editor has been deprecated. It now requires the "formatValue" callback to convert complex data to strings.',267:()=>"Detail grids can not use a different theme to the master grid, the `theme` detail grid option will be ignored.",268:()=>"Transactions aren't supported with tree data when using treeDataChildrenField",269:()=>"When `masterSelects: 'detail'`, detail grids must be configured with multi-row selection",270:({id:e,parentId:t})=>`Cycle detected for row with id='${e}' and parent id='${t}'. Resetting the parent for row with id='${e}' and showing it as a root-level node.`,271:({id:e,parentId:t})=>`Parent row not found for row with id='${e}' and parent id='${t}'. Showing row with id='${e}' as a root-level node.`};function gKe(e,t){const n=pKe[e];if(!n)return[`Missing error text for error id ${e}!`];const i=n(t),s=`
See ${Cee(e,t)}`;return Array.isArray(i)?i.concat(s):[i,s]}var mKe={1:"Charting Aggregation",2:"pivotResultFields",3:"setTooltip"},vKe=()=>({checkboxSelection:{version:"32.2",message:"Use `rowSelection.checkboxes` in `GridOptions` instead."},headerCheckboxSelection:{version:"32.2",message:"Use `rowSelection.headerCheckbox = true` in `GridOptions` instead."},headerCheckboxSelectionFilteredOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "filtered"` in `GridOptions` instead.'},headerCheckboxSelectionCurrentPageOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "currentPage"` in `GridOptions` instead.'},showDisabledCheckboxes:{version:"32.2",message:"Use `rowSelection.hideDisabledCheckboxes = true` in `GridOptions` instead."}}),CKe=()=>({aggFunc:{module:"SharedAggregation"},autoHeight:{supportedRowModels:["clientSide","serverSide"],module:"RowAutoHeight"},cellClass:{module:"CellStyle"},cellClassRules:{module:"CellStyle"},cellEditor:({cellEditor:e,editable:t})=>{if(!t)return null;if(typeof e=="string"){const n=Zf[e];if(n)return{module:n}}return{module:"CustomEditor"}},cellRenderer:({cellRenderer:e})=>{if(typeof e!="string")return null;const t=Zf[e];return t?{module:t}:null},cellRendererParams:{validate:e=>(e.rowGroup!=null||e.rowGroupIndex!=null||e.cellRenderer==="agGroupCellRenderer")&&"checkbox"in e.cellRendererParams?'Since v33.0, `cellRendererParams.checkbox` has been deprecated. Use `rowSelection.checkboxLocation = "autoGroupColumn"` instead.':null},cellStyle:{module:"CellStyle"},children:()=>rne(),columnChooserParams:{module:"ColumnMenu"},contextMenuItems:{module:"ContextMenu"},dndSource:{module:"DragAndDrop"},dndSourceOnRowDrag:{module:"DragAndDrop"},editable:({editable:e,cellEditor:t})=>e&&!t?{module:"TextEditor"}:null,enableCellChangeFlash:{module:"HighlightChanges"},enablePivot:{module:"SharedPivot"},enableRowGroup:{module:"SharedRowGrouping"},enableValue:{module:"SharedAggregation"},filter:({filter:e})=>{if(e&&typeof e!="string"&&typeof e!="boolean")return{module:"CustomFilter"};if(typeof e=="string"){const t=Zf[e];if(t)return{module:t}}return{module:"ColumnFilter"}},floatingFilter:{module:"ColumnFilter"},headerCheckboxSelection:{supportedRowModels:["clientSide","serverSide"],validate:(e,{rowSelection:t})=>t==="multiple"?null:"headerCheckboxSelection is only supported with rowSelection=multiple"},headerCheckboxSelectionCurrentPageOnly:{supportedRowModels:["clientSide"],validate:(e,{rowSelection:t})=>t==="multiple"?null:"headerCheckboxSelectionCurrentPageOnly is only supported with rowSelection=multiple"},headerCheckboxSelectionFilteredOnly:{supportedRowModels:["clientSide"],validate:(e,{rowSelection:t})=>t==="multiple"?null:"headerCheckboxSelectionFilteredOnly is only supported with rowSelection=multiple"},headerTooltip:{module:"Tooltip"},headerValueGetter:{validate:e=>{const t=e.headerValueGetter;return typeof t=="function"||typeof t=="string"?null:"headerValueGetter must be a function or a valid string expression"}},icons:{validate:({icons:e})=>{if(e){if(e.smallDown)return Xu(262);if(e.smallLeft)return Xu(263);if(e.smallRight)return Xu(264)}return null}},mainMenuItems:{module:"ColumnMenu"},menuTabs:e=>{const t=["columnsMenuTab","generalMenuTab"];return e.menuTabs?.some(n=>t.includes(n))?{module:"ColumnMenu"}:null},pivot:{module:"SharedPivot"},pivotIndex:{module:"SharedPivot"},rowDrag:{module:"RowDrag"},rowGroup:{module:"SharedRowGrouping"},rowGroupIndex:{module:"SharedRowGrouping"},sortingOrder:{validate:e=>{const t=e.sortingOrder;if(Array.isArray(t)&&t.length>0){const n=t.filter(i=>!k0.includes(i));if(n.length>0)return`sortingOrder must be an array with elements from [${k0.map(a1).join()}], currently it includes [${n.map(a1).join()}]`}else if(!Array.isArray(t)||t.length<=0)return`sortingOrder must be an array with at least one element, currently it's ${t}`;return null}},tooltipField:{module:"Tooltip"},tooltipValueGetter:{module:"Tooltip"},type:{validate:e=>{const t=e.type;return t instanceof Array?t.some(i=>typeof i!="string")?"if colDef.type is supplied an array it should be of type 'string[]'":null:typeof t=="string"?null:"colDef.type should be of type 'string' | 'string[]'"}},rowSpan:{validate:(e,{suppressRowTransform:t})=>t?null:"colDef.rowSpan requires suppressRowTransform to be enabled."},spanRows:{module:"CellSpan",dependencies:{editable:{required:[!1,void 0]},rowDrag:{required:[!1,void 0]},colSpan:{required:[!1,void 0]},rowSpan:{required:[!1,void 0]}},validate:(e,{rowSelection:t,cellSelection:n,suppressRowTransform:i,enableCellSpan:r,rowDragEntireRow:s,enableCellTextSelection:o})=>typeof t=="object"&&t?.mode==="singleRow"&&t?.enableClickSelection?"colDef.spanRows is not supported with rowSelection.clickSelection":n?"colDef.spanRows is not supported with cellSelection.":i?"colDef.spanRows is not supported with suppressRowTransform.":r?s?"colDef.spanRows is not supported with rowDragEntireRow.":o?"colDef.spanRows is not supported with enableCellTextSelection.":null:"colDef.spanRows requires enableCellSpan to be enabled."}}),yKe={headerName:void 0,columnGroupShow:void 0,headerStyle:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,cellDataType:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellAriaRole:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellEditor:void 0,cellEditorParams:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,tooltipComponentParams:void 0,refData:void 0,columnChooserParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,suppressStickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressHeaderMenuButton:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,spanRows:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,suppressSpanHeaderHeight:void 0,useValueFormatterForExport:void 0,useValueParserForImport:void 0,mainMenuItems:void 0,contextMenuItems:void 0,suppressFloatingFilterButton:void 0,suppressHeaderFilterButton:void 0,suppressHeaderContextMenu:void 0,loadingCellRenderer:void 0,loadingCellRendererParams:void 0,loadingCellRendererSelector:void 0,context:void 0,dateComponent:void 0,dateComponentParams:void 0,getFindText:void 0},wKe=()=>Object.keys(yKe),rne=()=>({objectName:"colDef",allProperties:wKe(),docsUrl:"column-properties/",deprecations:vKe(),validations:CKe()}),bKe=()=>({suppressLoadingOverlay:{version:"32",message:"Use `loading`=false instead."},enableFillHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeSelection:{version:"32.2",message:"Use `cellSelection = true` instead."},suppressMultiRangeSelection:{version:"32.2",message:"Use `cellSelection.suppressMultiRanges` instead."},suppressClearOnFillReduction:{version:"32.2",message:"Use `cellSelection.handle.suppressClearOnFillReduction` instead."},fillHandleDirection:{version:"32.2",message:"Use `cellSelection.handle.direction` instead."},fillOperation:{version:"32.2",message:"Use `cellSelection.handle.setFillValue` instead."},suppressRowClickSelection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},suppressRowDeselection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},rowMultiSelectWithClick:{version:"32.2",message:"Use `rowSelection.enableSelectionWithoutKeys` instead."},groupSelectsChildren:{version:"32.2",message:'Use `rowSelection.groupSelects = "descendants"` instead.'},groupSelectsFiltered:{version:"32.2",message:'Use `rowSelection.groupSelects = "filteredDescendants"` instead.'},isRowSelectable:{version:"32.2",message:"Use `selectionOptions.isRowSelectable` instead."},suppressCopySingleCellRanges:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},suppressCopyRowsToClipboard:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},onRangeSelectionChanged:{version:"32.2",message:"Use `onCellSelectionChanged` instead."},onRangeDeleteStart:{version:"32.2",message:"Use `onCellSelectionDeleteStart` instead."},onRangeDeleteEnd:{version:"32.2",message:"Use `onCellSelectionDeleteEnd` instead."},suppressBrowserResizeObserver:{version:"32.2",message:"The grid always uses the browser's ResizeObserver, this grid option has no effect."},onColumnEverythingChanged:{version:"32.2",message:"Either use `onDisplayedColumnsChanged` which is fired at the same time, or use one of the more specific column events."},groupRemoveSingleChildren:{version:"33",message:"Use `groupHideParentOfSingleChild` instead."},groupRemoveLowestSingleChildren:{version:"33",message:'Use `groupHideParentOfSingleChild: "leafGroupsOnly"` instead.'},suppressRowGroupHidesColumns:{version:"33",message:'Use `suppressGroupChangesColumnVisibility: "suppressHideOnGroup"` instead.'},suppressMakeColumnVisibleAfterUnGroup:{version:"33",message:'Use `suppressGroupChangesColumnVisibility: "suppressShowOnUngroup"` instead.'},unSortIcon:{version:"33",message:"Use `defaultColDef.unSortIcon` instead."},sortingOrder:{version:"33",message:"Use `defaultColDef.sortingOrder` instead."},suppressPropertyNamesCheck:{version:"33",message:"`gridOptions` and `columnDefs` both have a `context` property that should be used for arbitrary user data. This means that column definitions and gridOptions should only contain valid properties making this property redundant."}});function Jo(e,t,n,i=Number.MAX_VALUE){return typeof t=="number"||t==null?t==null||t>=n&&t<=i?null:i===Number.MAX_VALUE?`${e}: value should be greater than or equal to ${n}`:`${e}: value should be between ${n} and ${i}`:`${e}: value should be a number`}var SKe=()=>{const e={alignedGrids:{module:"AlignedGrids"},allowContextMenuWithControlKey:{module:"ContextMenu"},autoSizePadding:{validate({autoSizePadding:n}){return Jo("autoSizePadding",n,0)}},autoSizeStrategy:{module:"ColumnAutoSize"},cacheBlockSize:{supportedRowModels:["serverSide","infinite"],validate({cacheBlockSize:n}){return Jo("cacheBlockSize",n,1)}},cacheOverflowSize:{validate({cacheOverflowSize:n}){return Jo("cacheOverflowSize",n,1)}},cellSelection:{module:"CellSelection"},columnHoverHighlight:{module:"ColumnHover"},datasource:{supportedRowModels:["infinite"],module:"InfiniteRowModel"},doesExternalFilterPass:{module:"ExternalFilter"},domLayout:{validate:n=>{const i=n.domLayout,r=["autoHeight","normal","print"];return i&&!r.includes(i)?`domLayout must be one of [${r.join()}], currently it's ${i}`:null}},editType:{module:"EditCore"},enableAdvancedFilter:{module:"AdvancedFilter"},enableCharts:{module:"IntegratedCharts"},enableFillHandle:{dependencies:{enableRangeSelection:{required:[!0]}}},enableRangeHandle:{dependencies:{enableRangeSelection:{required:[!0]}}},enableRangeSelection:{module:"CellSelection",dependencies:{rowDragEntireRow:{required:[!1,void 0]}}},findSearchValue:{module:"Find"},rowNumbers:{module:"RowNumbers"},getContextMenuItems:{module:"ContextMenu"},getLocaleText:{module:"Locale"},getMainMenuItems:{module:"ColumnMenu"},getRowClass:{module:"RowStyle"},getRowStyle:{module:"RowStyle"},grandTotalRow:{module:"SharedRowGrouping"},groupDefaultExpanded:{supportedRowModels:["clientSide"]},groupHideOpenParents:{supportedRowModels:["clientSide","serverSide"],dependencies:{groupTotalRow:{required:[void 0,"bottom"]},treeData:{required:[void 0,!1],reason:"Tree Data has values at the group level so it doesn't make sense to hide them."}}},groupHideParentOfSingleChild:{dependencies:{groupHideOpenParents:{required:[void 0,!1]}}},groupRemoveLowestSingleChildren:{dependencies:{groupHideOpenParents:{required:[void 0,!1]},groupRemoveSingleChildren:{required:[void 0,!1]}}},groupRemoveSingleChildren:{dependencies:{groupHideOpenParents:{required:[void 0,!1]},groupRemoveLowestSingleChildren:{required:[void 0,!1]}}},groupSelectsChildren:{dependencies:{rowSelection:{required:["multiple"]}}},icons:{validate:({icons:n})=>{if(n){if(n.smallDown)return Xu(262);if(n.smallLeft)return Xu(263);if(n.smallRight)return Xu(264)}return null}},infiniteInitialRowCount:{validate({infiniteInitialRowCount:n}){return Jo("infiniteInitialRowCount",n,1)}},initialGroupOrderComparator:{supportedRowModels:["clientSide"]},initialState:{module:"GridState"},isExternalFilterPresent:{module:"ExternalFilter"},keepDetailRowsCount:{validate({keepDetailRowsCount:n}){return Jo("keepDetailRowsCount",n,1)}},localeText:{module:"Locale"},masterDetail:{module:"SharedMasterDetail"},pagination:{module:"Pagination"},paginationPageSize:{validate({paginationPageSize:n}){return Jo("paginationPageSize",n,1)}},paginationPageSizeSelector:{validate:n=>{const i=n.paginationPageSizeSelector;return typeof i=="boolean"||i==null||i.length?null:`'paginationPageSizeSelector' cannot be an empty array.
                    If you want to hide the page size selector, set paginationPageSizeSelector to false.`}},pinnedTopRowData:{module:"PinnedRow"},pinnedBottomRowData:{module:"PinnedRow"},pivotMode:{dependencies:{treeData:{required:[!1,void 0],reason:"Pivot Mode is not supported with Tree Data."}},module:"SharedPivot"},pivotPanelShow:{module:"RowGroupingPanel"},quickFilterText:{supportedRowModels:["clientSide"],module:"QuickFilter"},rowBuffer:{validate({rowBuffer:n}){return Jo("rowBuffer",n,0)}},rowClass:{validate:n=>typeof n.rowClass=="function"?"rowClass should not be a function, please use getRowClass instead":null,module:"RowStyle"},rowClassRules:{module:"RowStyle"},rowData:{supportedRowModels:["clientSide"],module:"ClientSideRowModel"},rowDragManaged:{supportedRowModels:["clientSide"],dependencies:{treeData:{required:[!1,void 0]},pagination:{required:[!1,void 0]}},module:"RowDrag"},rowGroupPanelShow:{module:"RowGroupingPanel"},rowSelection:{validate({rowSelection:n}){return n&&typeof n=="string"?'As of version 32.2.1, using `rowSelection` with the values "single" or "multiple" has been deprecated. Use the object value instead.':n&&typeof n!="object"?"Expected `RowSelectionOptions` object for the `rowSelection` property.":n&&n.mode!=="multiRow"&&n.mode!=="singleRow"?`Selection mode "${n.mode}" is invalid. Use one of 'singleRow' or 'multiRow'.`:null},module:"SharedRowSelection"},rowStyle:{validate:n=>{const i=n.rowStyle;return i&&typeof i=="function"?"rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead":null},module:"RowStyle"},serverSideDatasource:{supportedRowModels:["serverSide"],module:"ServerSideRowModel"},serverSideInitialRowCount:{supportedRowModels:["serverSide"],validate({serverSideInitialRowCount:n}){return Jo("serverSideInitialRowCount",n,1)}},serverSideOnlyRefreshFilteredGroups:{supportedRowModels:["serverSide"]},serverSideSortAllLevels:{supportedRowModels:["serverSide"]},sideBar:{module:"SideBar"},sortingOrder:{validate:n=>{const i=n.sortingOrder;if(Array.isArray(i)&&i.length>0){const r=i.filter(s=>!k0.includes(s));if(r.length>0)return`sortingOrder must be an array with elements from [${k0.map(a1).join()}], currently it includes [${r.map(a1).join()}]`}else if(!Array.isArray(i)||i.length<=0)return`sortingOrder must be an array with at least one element, currently it's ${i}`;return null}},statusBar:{module:"StatusBar"},tooltipHideDelay:{validate:n=>n.tooltipHideDelay&&n.tooltipHideDelay<0?"tooltipHideDelay should not be lower than 0":null},tooltipShowDelay:{validate:n=>n.tooltipShowDelay&&n.tooltipShowDelay<0?"tooltipShowDelay should not be lower than 0":null},treeData:{supportedRowModels:["clientSide","serverSide"],module:"SharedTreeData",validate:n=>{const i=n.rowModelType??"clientSide";switch(i){case"clientSide":{const{treeDataChildrenField:r,treeDataParentIdField:s,getDataPath:o,getRowId:a}=n;if(!r&&!s&&!o)return"treeData requires either 'treeDataChildrenField' or 'treeDataParentIdField' or 'getDataPath' in the clientSide row model.";if(r){if(o)return"Cannot use both 'treeDataChildrenField' and 'getDataPath' at the same time.";if(s)return"Cannot use both 'treeDataChildrenField' and 'treeDataParentIdField' at the same time."}if(s){if(!a)return"getRowId callback not provided, tree data with parent id cannot be built.";if(o)return"Cannot use both 'treeDataParentIdField' and 'getDataPath' at the same time."}return null}case"serverSide":{const r=`treeData requires 'isServerSideGroup' and 'getServerSideGroupKey' in the ${i} row model.`;return n.isServerSideGroup&&n.getServerSideGroupKey?null:r}}return null}},treeDataChildrenField:{module:"SharedTreeData"},treeDataParentIdField:{module:"SharedTreeData"},undoRedoCellEditing:{module:"UndoRedoEdit"},valueCache:{module:"ValueCache"},viewportDatasource:{supportedRowModels:["viewport"],module:"ViewportRowModel"},viewportRowModelBufferSize:{validate({viewportRowModelBufferSize:n}){return Jo("viewportRowModelBufferSize",n,0)}},viewportRowModelPageSize:{validate({viewportRowModelPageSize:n}){return Jo("viewportRowModelPageSize",n,1)}},rowDragEntireRow:{dependencies:{cellSelection:{required:[void 0]}}},enableCellSpan:{module:"CellSpan"},autoGroupColumnDef:{validate({autoGroupColumnDef:n,showOpenedGroup:i}){return n?.field&&i?"autoGroupColumnDef.field and showOpenedGroup are not supported when used together.":n?.valueGetter&&i?"autoGroupColumnDef.valueGetter and showOpenedGroup are not supported when used together.":null}}},t={};return tne.forEach(n=>{t[n]={expectedType:"boolean"}}),ene.forEach(n=>{t[n]={expectedType:"number"}}),lr(t,e),t},xKe=()=>({objectName:"gridOptions",allProperties:[...vT,...Jte.map(e=>fN(e))],propertyExceptions:["api"],docsUrl:"grid-options/",deprecations:bKe(),validations:SKe()}),RKe={expanded:1,contracted:1,"tree-closed":1,"tree-open":1,"tree-indeterminate":1,pin:1,"eye-slash":1,arrows:1,left:1,right:1,group:1,aggregation:1,pivot:1,"not-allowed":1,chart:1,cross:1,cancel:1,tick:1,first:1,previous:1,next:1,last:1,linked:1,unlinked:1,"color-picker":1,loading:1,menu:1,"menu-alt":1,filter:1,columns:1,maximize:1,minimize:1,copy:1,cut:1,paste:1,grip:1,save:1,csv:1,excel:1,"small-down":1,"small-left":1,"small-right":1,"small-up":1,asc:1,desc:1,none:1,up:1,down:1,plus:1,minus:1,settings:1,"checkbox-checked":1,"checkbox-indeterminate":1,"checkbox-unchecked":1,"radio-button-on":1,"radio-button-off":1,eye:1},EKe={chart:"MenuCore",cancel:"EnterpriseCore",first:"Pagination",previous:"Pagination",next:"Pagination",last:"Pagination",linked:"IntegratedCharts",loadingMenuItems:"MenuCore",unlinked:"IntegratedCharts",menu:"ColumnHeaderComp",legacyMenu:"ColumnMenu",filter:"ColumnFilter",filterActive:"ColumnFilter",filterTab:"ColumnMenu",filtersToolPanel:"FiltersToolPanel",columns:["MenuCore"],columnsToolPanel:["ColumnsToolPanel"],maximize:"EnterpriseCore",minimize:"EnterpriseCore",save:"MenuCore",columnGroupOpened:"ColumnGroupHeaderComp",columnGroupClosed:"ColumnGroupHeaderComp",accordionOpen:"EnterpriseCore",accordionClosed:"EnterpriseCore",accordionIndeterminate:"EnterpriseCore",columnSelectClosed:["ColumnsToolPanel","ColumnMenu"],columnSelectOpen:["ColumnsToolPanel","ColumnMenu"],columnSelectIndeterminate:["ColumnsToolPanel","ColumnMenu"],columnMovePin:"SharedDragAndDrop",columnMoveHide:"SharedDragAndDrop",columnMoveMove:"SharedDragAndDrop",columnMoveLeft:"SharedDragAndDrop",columnMoveRight:"SharedDragAndDrop",columnMoveGroup:"SharedDragAndDrop",columnMoveValue:"SharedDragAndDrop",columnMovePivot:"SharedDragAndDrop",dropNotAllowed:"SharedDragAndDrop",groupContracted:"GroupCellRenderer",groupExpanded:"GroupCellRenderer",setFilterGroupClosed:"SetFilter",setFilterGroupOpen:"SetFilter",setFilterGroupIndeterminate:"SetFilter",setFilterLoading:"SetFilter",close:"EnterpriseCore",check:"MenuItem",colorPicker:"CommunityCore",groupLoading:"LoadingCellRenderer",menuAlt:"ColumnHeaderComp",menuPin:"MenuCore",menuValue:"MenuCore",menuAddRowGroup:["MenuCore","ColumnsToolPanel"],menuRemoveRowGroup:["MenuCore","ColumnsToolPanel"],clipboardCopy:"MenuCore",clipboardCut:"MenuCore",clipboardPaste:"MenuCore",pivotPanel:["ColumnsToolPanel","RowGroupingPanel"],rowGroupPanel:["ColumnsToolPanel","RowGroupingPanel"],valuePanel:"ColumnsToolPanel",columnDrag:"EnterpriseCore",rowDrag:["RowDrag","DragAndDrop"],csvExport:"MenuCore",excelExport:"MenuCore",smallDown:"CommunityCore",selectOpen:"CommunityCore",richSelectOpen:"RichSelect",richSelectRemove:"RichSelect",smallLeft:"CommunityCore",smallRight:"CommunityCore",subMenuOpen:"MenuItem",subMenuOpenRtl:"MenuItem",panelDelimiter:"RowGroupingPanel",panelDelimiterRtl:"RowGroupingPanel",smallUp:"CommunityCore",sortAscending:["MenuCore","Sort"],sortDescending:["MenuCore","Sort"],sortUnSort:["MenuCore","Sort"],advancedFilterBuilder:"AdvancedFilter",advancedFilterBuilderDrag:"AdvancedFilter",advancedFilterBuilderInvalid:"AdvancedFilter",advancedFilterBuilderMoveUp:"AdvancedFilter",advancedFilterBuilderMoveDown:"AdvancedFilter",advancedFilterBuilderAdd:"AdvancedFilter",advancedFilterBuilderRemove:"AdvancedFilter",advancedFilterBuilderSelectOpen:"AdvancedFilter",chartsMenu:"IntegratedCharts",chartsMenuEdit:"IntegratedCharts",chartsMenuAdvancedSettings:"IntegratedCharts",chartsMenuAdd:"IntegratedCharts",chartsColorPicker:"IntegratedCharts",chartsThemePrevious:"IntegratedCharts",chartsThemeNext:"IntegratedCharts",chartsDownload:"IntegratedCharts",checkboxChecked:"CommunityCore",checkboxIndeterminate:"CommunityCore",checkboxUnchecked:"CommunityCore",radioButtonOn:"CommunityCore",radioButtonOff:"CommunityCore"},FKe=new Set(["colorPicker","smallUp","checkboxChecked","checkboxIndeterminate","checkboxUnchecked","radioButtonOn","radioButtonOff","smallDown","smallLeft","smallRight"]),AKe={pinSubMenu:"PinnedColumn",pinLeft:"PinnedColumn",pinRight:"PinnedColumn",clearPinned:"PinnedColumn",valueAggSubMenu:"SharedAggregation",autoSizeThis:"ColumnAutoSize",autoSizeAll:"ColumnAutoSize",rowGroup:"SharedRowGrouping",rowUnGroup:"SharedRowGrouping",resetColumns:"CommunityCore",expandAll:["ClientSideRowModelHierarchy","ServerSideRowModel"],contractAll:["ClientSideRowModelHierarchy","ServerSideRowModel"],copy:"Clipboard",copyWithHeaders:"Clipboard",copyWithGroupHeaders:"Clipboard",cut:"Clipboard",paste:"Clipboard",export:["CsvExport","ExcelExport"],csvExport:"CsvExport",excelExport:"ExcelExport",separator:"CommunityCore",pivotChart:"IntegratedCharts",chartRange:"IntegratedCharts",columnFilter:"ColumnFilter",columnChooser:"ColumnMenu",sortAscending:"Sort",sortDescending:"Sort",sortUnSort:"Sort"},DKe=class extends Z{constructor(){super(...arguments),this.beanName="validation"}wireBeans(e){this.gridOptions=e.gridOptions,$5e(this)}postConstruct(){this.processGridOptions(this.gridOptions)}warnOnInitialPropertyUpdate(e,t){e==="api"&&rKe[t]&&de(22,{key:t})}processGridOptions(e){this.processOptions(e,xKe())}validateApiFunction(e,t){return aKe(e,t,this.beans)}missingUserComponent(e,t,n,i){const r=Zf[t];r?this.gos.assertModuleRegistered(r,`AG Grid '${e}' component: ${t}`):de(101,{propertyName:e,componentName:t,agGridDefaults:n,jsComps:i})}checkRowEvents(e){PKe.has(e)&&de(10,{eventType:e})}validateIcon(e){if(FKe.has(e)&&de(43,{iconName:e}),RKe[e])return;const t=EKe[e];if(t){Ft(200,{reasonOrId:`icon '${e}'`,moduleName:t,gridScoped:vN(),gridId:this.beans.context.getGridId(),rowModelType:this.gos.get("rowModelType"),additionalText:"Alternatively, use the CSS icon name directly."});return}de(134,{iconName:e})}validateMenuItem(e){const t=AKe[e];t&&this.gos.assertModuleRegistered(t,`menu item '${e}'`)}isProvidedUserComp(e){return!!Zf[e]}validateColDef(e,t,n){(n||!this.beans.dataTypeSvc?.isColPendingInference(t))&&this.processOptions(e,rne())}processOptions(e,t){const{validations:n,deprecations:i,allProperties:r,propertyExceptions:s,objectName:o,docsUrl:a}=t;r&&this.gridOptions.suppressPropertyNamesCheck!==!0&&this.checkProperties(e,[...s??[],...Object.keys(i)],r,o,a);const l=new Set,u=d=>{const h=n[d];if(h)if(typeof h=="function"){const p=h(e,this.gridOptions,this.beans);if(!p)return;if("objectName"in p){const g=e[d];if(Array.isArray(g)){g.forEach(m=>{this.processOptions(m,p)});return}this.processOptions(e[d],p);return}return p}else return h;else return};Object.keys(e).forEach(d=>{const h=i[d];if(h){const{message:x,version:E}=h;l.add(`As of v${E}, ${String(d)} is deprecated. ${x??""}`)}const p=e[d];if(p==null||p===!1)return;const g=u(d);if(!g)return;const{module:m,dependencies:C,validate:y,supportedRowModels:b,expectedType:S}=g;if(S){const x=typeof p;if(x!==S){l.add(`${String(d)} should be of type '${S}' but received '${x}' (${p}).`);return}}if(b){const x=this.gridOptions.rowModelType??"clientSide";if(!b.includes(x)){l.add(`${String(d)} is not supported with the '${x}' row model. It is only valid with: ${b.join(", ")}.`);return}}if(m){const x=Array.isArray(m)?m:[m];let E=!0;if(x.forEach(A=>{this.gos.assertModuleRegistered(A,String(d))||(E=!1)}),!E)return}if(C){const x=this.checkForRequiredDependencies(d,C,e);if(x){l.add(x);return}}if(y){const x=y(e,this.gridOptions,this.beans);if(x){l.add(x);return}}}),l.size>0&&l.forEach(d=>{Dv(d)})}checkForRequiredDependencies(e,t,n){const r=Object.entries(t).filter(([s,o])=>{const a=n[s];return!o.required.includes(a)});return r.length===0?null:r.map(([s,o])=>`'${String(e)}' requires '${s}' to be one of [${o.required.map(a=>a===null?"null":a===void 0?"undefined":a).join(", ")}]. ${o.reason??""}`).join(`
           `)}checkProperties(e,t,n,i,r){const s=["__ob__","__v_skip","__metadata__"],o=kKe(Object.getOwnPropertyNames(e),[...s,...t,...n],n),a=Object.keys(o);for(const l of a){const u=o[l];let c=`invalid ${i} property '${l}' did you mean any of these: ${u.slice(0,8).join(", ")}.`;n.includes("context")&&(c+=`
If you are trying to annotate ${i} with application data, use the '${i}.context' property instead.`),Dv(c)}if(a.length>0&&r){const l=this.beans.frameworkOverrides.getDocLink(r);Dv(`to see all the valid ${i} properties please check: ${l}`)}}getConsoleMessage(e,t){return gKe(e,t)}};function kKe(e,t,n){const i={},r=e.filter(s=>!t.some(o=>o===s));return r.length>0&&r.forEach(s=>i[s]=nne({inputValue:s,allSuggestions:n}).values),i}var PKe=new Set(["firstChildChanged","lastChildChanged","childIndexChanged"]),MKe={moduleName:"Validation",version:we,beans:[DKe]};function sne(e){e.sibling&&(e.sibling.childrenAfterFilter=e.childrenAfterFilter)}var TKe=class extends Z{constructor(){super(...arguments),this.beanName="filterStage",this.refreshProps=new Set(["excludeChildrenWhenTreeDataFiltering"]),this.step="filter"}wireBeans(e){this.filterManager=e.filterManager}execute(e){const{changedPath:t}=e;this.filter(t)}filter(e){const t=!!this.filterManager?.isChildFilterPresent();this.filterNodes(t,e)}filterNodes(e,t){const n=(i,r)=>{i.hasChildren()&&e&&!r?i.childrenAfterFilter=i.childrenAfterGroup.filter(s=>{const o=s.childrenAfterFilter&&s.childrenAfterFilter.length>0,a=s.data&&this.filterManager.doesRowPassFilter({rowNode:s});return o||a}):i.childrenAfterFilter=i.childrenAfterGroup,sne(i)};if(this.doingTreeDataFiltering()){const i=(s,o)=>{if(s.childrenAfterGroup)for(let a=0;a<s.childrenAfterGroup.length;a++){const l=s.childrenAfterGroup[a],u=o||this.filterManager.doesRowPassFilter({rowNode:l});l.childrenAfterGroup?i(s.childrenAfterGroup[a],u):n(l,u)}n(s,o)},r=s=>i(s,!1);t.executeFromRootNode(r)}else{const i=r=>n(r,!1);t.forEachChangedNodeDepthFirst(i,!0)}}doingTreeDataFiltering(){return this.gos.get("treeData")&&!this.gos.get("excludeChildrenWhenTreeDataFiltering")}},IKe=class extends FN{constructor(){super(...arguments),this.iconCreated=!1}setComp(e,t,n,i,r){this.comp=e;const s=OC(this,this.beans.context,r);this.eButtonShowMainFilter=n,this.eFloatingFilterBody=i,this.setGui(t,s),this.setupActive(),this.refreshHeaderStyles(),this.setupWidth(s),this.setupLeft(s),this.setupHover(s),this.setupFocus(s),this.setupAria(),this.setupFilterButton(),this.setupUserComp(),this.setupSyncWithFilter(s),this.setupUi(),s.addManagedElementListeners(this.eButtonShowMainFilter,{click:this.showParentFilter.bind(this)}),this.setupFilterChangedListener(s),s.addManagedListeners(this.column,{colDefChanged:()=>this.onColDefChanged(s)}),s.addDestroyFunc(()=>{this.eButtonShowMainFilter=null,this.eFloatingFilterBody=null,this.userCompDetails=null,this.clearComponent()})}resizeHeader(){}moveHeader(){}getHeaderClassParams(){const{column:e,beans:t}=this,n=e.colDef;return ze(t.gos,{colDef:n,column:e,floatingFilter:!0})}setupActive(){const e=this.column.getColDef(),t=!!e.filter,n=!!e.floatingFilter;this.active=t&&n}setupUi(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton),!this.active||this.iconCreated)return;const e=Os("filter",this.beans,this.column);e&&(this.iconCreated=!0,this.eButtonShowMainFilter.appendChild(e))}setupFocus(e){e.createManagedBean(new Sg(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}setupAria(){const e=this.getLocaleTextFunc();WR(this.eButtonShowMainFilter,e("ariaFilterMenuOpen","Open Filter Menu"))}onTabKeyDown(e){const{beans:t}=this;if(nn(t)===this.eGui)return;const r=$h(t,this.eGui,null,e.shiftKey);if(r){t.headerNavigation?.scrollToColumn(this.column),e.preventDefault(),r.focus();return}const s=this.findNextColumnWithFloatingFilter(e.shiftKey);s&&t.focusSvc.focusHeaderPosition({headerPosition:{headerRowIndex:this.rowCtrl.rowIndex,column:s},event:e})&&e.preventDefault()}findNextColumnWithFloatingFilter(e){const t=this.beans.visibleCols;let n=this.column;do if(n=e?t.getColBefore(n):t.getColAfter(n),!n)break;while(!n.getColDef().filter||!n.getColDef().floatingFilter);return n}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();switch(e.key){case X.UP:case X.DOWN:t||e.preventDefault();case X.LEFT:case X.RIGHT:if(t)return;e.stopPropagation();case X.ENTER:t&&ph(this.eGui)&&e.preventDefault();break;case X.ESCAPE:t||this.eGui.focus()}}onFocusIn(e){if(this.eGui.contains(e.relatedTarget))return;const n=!!e.relatedTarget&&!e.relatedTarget.classList.contains("ag-floating-filter"),i=!!e.relatedTarget&&$d(e.relatedTarget,"ag-floating-filter");if(n&&i&&e.target===this.eGui){const r=this.lastFocusEvent,s=!!(r&&r.key===X.TAB);if(r&&s){const o=r.shiftKey;ph(this.eGui,o)}}this.focusThis()}setupHover(e){this.beans.colHover?.addHeaderFilterColumnHoverListener(e,this.comp,this.column,this.eGui)}setupLeft(e){const t=new EN(this.column,this.eGui,this.beans);e.createManagedBean(t)}setupFilterButton(){this.suppressFilterButton=!this.beans.menuSvc?.isFloatingFilterButtonEnabled(this.column),this.highlightFilterButtonWhenActive=!Zr(this.gos)}setupUserComp(){if(!this.active)return;const e=this.beans.filterManager?.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter());e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setCompDetails(e)}showParentFilter(){const e=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;this.beans.menuSvc?.showFilterMenu({column:this.column,buttonElement:e,containerType:"floatingFilter",positionBy:"button"})}setupSyncWithFilter(e){if(!this.active)return;const{filterManager:t}=this.beans,n=i=>{if(i?.source==="filterDestroyed"&&!this.isAlive())return;const r=this.comp.getFloatingFilterComp();r&&r.then(s=>{if(s){const o=t?.getCurrentFloatingFilterParentModel(this.column),a=i?{...i,columns:i.columns??[],source:i.source==="api"?"api":"columnFilter"}:null;s.onParentModelChanged(o,a)}})};[this.destroySyncListener]=e.addManagedListeners(this.column,{filterChanged:n}),t?.isFilterActive(this.column)&&n(null)}setupWidth(e){const t=()=>{const n=`${this.column.getActualWidth()}px`;this.comp.setWidth(n)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupFilterChangedListener(e){this.active&&([this.destroyFilterChangedListener]=e.addManagedListeners(this.column,{filterChanged:this.updateFilterButton.bind(this)}),this.updateFilterButton())}updateFilterButton(){if(!this.suppressFilterButton&&this.comp){const e=!!this.beans.filterManager?.isFilterAllowed(this.column);this.comp.setButtonWrapperDisplayed(e),this.highlightFilterButtonWhenActive&&e&&this.eButtonShowMainFilter.classList.toggle("ag-filter-active",this.column.isFilterActive())}}onColDefChanged(e){const t=this.active;this.setupActive();const n=!t&&this.active;t&&!this.active&&(this.destroySyncListener(),this.destroyFilterChangedListener());const i=this.active?this.beans.filterManager?.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter()):null,r=this.comp.getFloatingFilterComp();!r||!i?this.updateCompDetails(e,i,n):r.then(s=>{!s||this.beans.filterManager?.areFilterCompsDifferent(this.userCompDetails??null,i)?this.updateCompDetails(e,i,n):this.updateFloatingFilterParams(i)})}updateCompDetails(e,t,n){this.isAlive()&&(this.setCompDetails(t),this.setupFilterButton(),this.setupUi(),n&&(this.setupSyncWithFilter(e),this.setupFilterChangedListener(e)))}updateFloatingFilterParams(e){if(!e)return;const t=e.params;this.comp.getFloatingFilterComp()?.then(n=>{n?.refresh&&typeof n.refresh=="function"&&n.refresh(t)})}addResizeAndMoveKeyboardListeners(){}destroy(){super.destroy(),this.destroySyncListener=null,this.destroyFilterChangedListener=null}};function _Ke(e,t){const n=e.colModel.getCol(t);if(!n){Ft(12,{colKey:t});return}e.menuSvc?.showColumnMenu({column:n,positionBy:"auto"})}function OKe(e){e.menuSvc?.hidePopupMenu()}var LKe={moduleName:"SharedMenu",version:we,beans:[C8e],apiFunctions:{showColumnMenu:_Ke,hidePopupMenu:OKe}},NKe=0,$Ke=200,BKe=class extends Z{constructor(){super(...arguments),this.beanName="popupSvc",this.popupList=[]}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridCtrl=e.gridCtrl}),this.addManagedEventListeners({gridStylesChanged:this.handleThemeChange.bind(this)})}getPopupParent(){const e=this.gos.get("popupParent");return e||this.gridCtrl.getGui()}positionPopupForMenu(e){const{eventSource:t,ePopup:n,column:i,node:r,event:s}=e,o=t.getBoundingClientRect(),a=this.getParentRect();this.setAlignedTo(t,n);let l=!1;const u=()=>{const c=this.keepXYWithinBounds(n,o.top-a.top,0),d=n.clientWidth>0?n.clientWidth:200;l||(n.style.minWidth=`${d}px`,l=!0);const p=a.right-a.left-d;let g;return this.gos.get("enableRtl")?(g=C(),g<0&&(g=m(),this.setAlignedStyles(n,"left")),g>p&&(g=0,this.setAlignedStyles(n,"right"))):(g=m(),g>p&&(g=C(),this.setAlignedStyles(n,"right")),g<0&&(g=0,this.setAlignedStyles(n,"left"))),{x:g,y:c};function m(){return o.right-a.left-2}function C(){return o.left-a.left-d}};this.positionPopup({ePopup:n,keepWithinBounds:!0,updatePosition:u,postProcessCallback:()=>this.callPostProcessPopup("subMenu",n,t,s instanceof MouseEvent?s:void 0,i,r)})}positionPopupUnderMouseEvent(e){const{ePopup:t,nudgeX:n,nudgeY:i,skipObserver:r}=e;this.positionPopup({ePopup:t,nudgeX:n,nudgeY:i,keepWithinBounds:!0,skipObserver:r,updatePosition:()=>this.calculatePointerAlign(e.mouseEvent),postProcessCallback:()=>this.callPostProcessPopup(e.type,e.ePopup,null,e.mouseEvent,e.column,e.rowNode)})}calculatePointerAlign(e){const t=this.getParentRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}positionPopupByComponent(e){const{ePopup:t,nudgeX:n,nudgeY:i,keepWithinBounds:r,eventSource:s,alignSide:o="left",position:a="over",column:l,rowNode:u,type:c}=e,d=s.getBoundingClientRect(),h=this.getParentRect();this.setAlignedTo(s,t);const p=()=>{let g=d.left-h.left;o==="right"&&(g-=t.offsetWidth-d.width);let m;return a==="over"?(m=d.top-h.top,this.setAlignedStyles(t,"over")):(this.setAlignedStyles(t,"under"),this.shouldRenderUnderOrAbove(t,d,h,e.nudgeY||0)==="under"?m=d.top-h.top+d.height:m=d.top-t.offsetHeight-(i||0)*2-h.top),{x:g,y:m}};this.positionPopup({ePopup:t,nudgeX:n,nudgeY:i,keepWithinBounds:r,updatePosition:p,postProcessCallback:()=>this.callPostProcessPopup(c,t,s,null,l,u)})}shouldRenderUnderOrAbove(e,t,n,i){const r=n.bottom-t.bottom,s=t.top-n.top,o=e.offsetHeight+i;return r>o?"under":s>o||s>r?"above":"under"}setAlignedStyles(e,t){const n=this.getPopupIndex(e);if(n===-1)return;const i=this.popupList[n],{alignedToElement:r}=i;!r||(["right","left","over","above","under"].forEach(o=>{r.classList.remove(`ag-has-popup-positioned-${o}`),e.classList.remove(`ag-popup-positioned-${o}`)}),!t)||(r.classList.add(`ag-has-popup-positioned-${t}`),e.classList.add(`ag-popup-positioned-${t}`))}setAlignedTo(e,t){const n=this.getPopupIndex(t);if(n!==-1){const i=this.popupList[n];i.alignedToElement=e}}callPostProcessPopup(e,t,n,i,r,s){const o=this.gos.getCallback("postProcessPopup");o&&o({column:r,rowNode:s,ePopup:t,type:e,eventSource:n,mouseEvent:i})}positionPopup(e){const{ePopup:t,keepWithinBounds:n,nudgeX:i,nudgeY:r,skipObserver:s,updatePosition:o}=e,a={width:0,height:0},l=(u=!1)=>{let{x:c,y:d}=o();u&&t.clientWidth===a.width&&t.clientHeight===a.height||(a.width=t.clientWidth,a.height=t.clientHeight,i&&(c+=i),r&&(d+=r),n&&(c=this.keepXYWithinBounds(t,c,1),d=this.keepXYWithinBounds(t,d,0)),t.style.left=`${c}px`,t.style.top=`${d}px`,e.postProcessCallback&&e.postProcessCallback())};if(l(),!s){const u=_c(this.beans,t,()=>l(!0));setTimeout(()=>u(),$Ke)}}getActivePopups(){return this.popupList.map(e=>e.element)}getParentRect(){const e=Pn(this.beans);let t=this.getPopupParent();return t===e.body?t=e.documentElement:getComputedStyle(t).position==="static"&&(t=t.offsetParent),lee(t)}keepXYWithinBounds(e,t,n){const i=n===0,r=i?"clientHeight":"clientWidth",s=i?"top":"left",o=i?"height":"width",a=i?"scrollTop":"scrollLeft",l=Pn(this.beans),u=l.documentElement,c=this.getPopupParent(),d=e.getBoundingClientRect(),h=c.getBoundingClientRect(),p=l.documentElement.getBoundingClientRect(),g=c===l.body,m=Math.ceil(d[o]);let y=g?(i?aee:i1)(u)+u[a]:c[r];g&&(y-=Math.abs(p[s]-h[s]));const b=y-m;return Math.min(Math.max(t,0),Math.abs(b))}addPopup(e){const t=Pn(this.beans),{eChild:n,ariaLabel:i,alwaysOnTop:r,positionCallback:s,anchorToElement:o}=e;if(!t)return de(122),{hideFunc:()=>{}};const a=this.getPopupIndex(n);if(a!==-1)return{hideFunc:this.popupList[a].hideFunc};this.initialisePopupPosition(n);const l=this.createPopupWrapper(n,i,!!r),u=this.addEventListenersToPopup({...e,wrapperEl:l});return s&&s(),this.addPopupToPopupList(n,l,u,o),{hideFunc:u}}initialisePopupPosition(e){const n=this.getPopupParent().getBoundingClientRect();Ce(e.style.top)||(e.style.top=`${n.top*-1}px`),Ce(e.style.left)||(e.style.left=`${n.left*-1}px`)}createPopupWrapper(e,t,n){const i=this.getPopupParent(),{environment:r,gos:s}=this.beans,o=Sn({tag:"div"});return r.applyThemeClasses(o),o.classList.add("ag-popup"),e.classList.add(s.get("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),e.hasAttribute("role")||Vl(e,"dialog"),WR(e,t),o.appendChild(e),i.appendChild(o),n?this.setAlwaysOnTop(e,!0):this.bringPopupToFront(e),o}handleThemeChange(e){if(e.themeChanged){const t=this.beans.environment;for(const n of this.popupList)t.applyThemeClasses(n.wrapper)}}addEventListenersToPopup(e){const t=this.beans,n=Pn(t),i=this.getPopupParent(),{wrapperEl:r,eChild:s,closedCallback:o,afterGuiAttached:a,closeOnEsc:l,modal:u}=e;let c=!1;const d=m=>{if(!r.contains(nn(t)))return;m.key===X.ESCAPE&&!_l(m)&&g({keyboardEvent:m})},h=m=>g({mouseEvent:m}),p=m=>g({touchEvent:m}),g=(m={})=>{const{mouseEvent:C,touchEvent:y,keyboardEvent:b,forceHide:S}=m;!S&&(this.isEventFromCurrentPopup({mouseEvent:C,touchEvent:y},s)||c)||(c=!0,i.removeChild(r),n.removeEventListener("keydown",d),n.removeEventListener("mousedown",h),n.removeEventListener("touchstart",p),n.removeEventListener("contextmenu",h),this.eventSvc.removeEventListener("dragStarted",h),o&&o(C||y||b),this.removePopupFromPopupList(s))};return a&&a({hidePopup:g}),window.setTimeout(()=>{l&&n.addEventListener("keydown",d),u&&(n.addEventListener("mousedown",h),this.eventSvc.addEventListener("dragStarted",h),n.addEventListener("touchstart",p),n.addEventListener("contextmenu",h))},0),g}addPopupToPopupList(e,t,n,i){this.popupList.push({element:e,wrapper:t,hideFunc:n,instanceId:NKe++,isAnchored:!!i}),i&&this.setPopupPositionRelatedToElement(e,i)}getPopupIndex(e){return this.popupList.findIndex(t=>t.element===e)}setPopupPositionRelatedToElement(e,t){const n=this.getPopupIndex(e);if(n===-1)return;const i=this.popupList[n];if(i.stopAnchoringPromise&&i.stopAnchoringPromise.then(s=>s&&s()),i.stopAnchoringPromise=void 0,i.isAnchored=!1,!t)return;const r=this.keepPopupPositionedRelativeTo({element:t,ePopup:e,hidePopup:i.hideFunc});return i.stopAnchoringPromise=r,i.isAnchored=!0,r}removePopupFromPopupList(e){this.setAlignedStyles(e,null),this.setPopupPositionRelatedToElement(e,null),this.popupList=this.popupList.filter(t=>t.element!==e)}keepPopupPositionedRelativeTo(e){const t=this.getPopupParent(),n=t.getBoundingClientRect(),{element:i,ePopup:r}=e,s=i.getBoundingClientRect(),o=d=>parseInt(d.substring(0,d.length-1),10),a=(d,h)=>{const p=n[d]-s[d],g=o(r.style[d]);return{initialDiff:p,lastDiff:p,initial:g,last:g,direction:h}},l=a("top",0),u=a("left",1),c=this.beans.frameworkOverrides;return new ir(d=>{c.wrapIncoming(()=>{c.setInterval(()=>{const h=t.getBoundingClientRect(),p=i.getBoundingClientRect();if(p.top==0&&p.left==0&&p.height==0&&p.width==0){e.hidePopup();return}const m=(C,y)=>{const b=o(r.style[y]);C.last!==b&&(C.initial=b,C.last=b);const S=h[y]-p[y];if(S!=C.lastDiff){const x=this.keepXYWithinBounds(r,C.initial+C.initialDiff-S,C.direction);r.style[y]=`${x}px`,C.last=x}C.lastDiff=S};m(l,"top"),m(u,"left")},200).then(h=>{d(()=>{h!=null&&window.clearInterval(h)})})},"popupPositioning")})}hasAnchoredPopup(){return this.popupList.some(e=>e.isAnchored)}isEventFromCurrentPopup(e,t){const{mouseEvent:n,touchEvent:i}=e,r=n||i;if(!r)return!1;const s=this.getPopupIndex(t);if(s===-1)return!1;for(let o=s;o<this.popupList.length;o++){const a=this.popupList[o];if(u6e(a.element,r))return!0}return this.isElementWithinCustomPopup(r.target)}isElementWithinCustomPopup(e){const t=Pn(this.beans);for(;e&&e!==t.body;){if(e.classList.contains("ag-custom-component-popup")||e.parentElement===null)return!0;e=e.parentElement}return!1}getWrapper(e){for(;!e.classList.contains("ag-popup")&&e.parentElement;)e=e.parentElement;return e.classList.contains("ag-popup")?e:null}setAlwaysOnTop(e,t){const n=this.getWrapper(e);n&&(n.classList.toggle("ag-always-on-top",!!t),t&&this.bringPopupToFront(n))}bringPopupToFront(e){const t=this.getPopupParent(),n=Array.prototype.slice.call(t.querySelectorAll(".ag-popup")),i=n.length,r=this.getWrapper(e);if(!r||i<=1||!t.contains(e))return;const s=[],o=[];for(const h of n)h!==r&&(h.classList.contains("ag-always-on-top")?o.push(h):s.push(h));const a=[],l=o.length,d=r.classList.contains("ag-always-on-top")||!l?[...s,...o,r]:[...s,r,...o];for(let h=0;h<=i;h++){const p=d[h];if(n[h]===d[h]||p===r)continue;p.querySelectorAll("div").forEach(m=>{m.scrollTop!==0&&a.push([m,m.scrollTop])}),h===0?t.insertAdjacentElement("afterbegin",p):d[h-1].insertAdjacentElement("afterend",p)}for(;a.length;){const h=a.pop();h[0].scrollTop=h[1]}}},QR={moduleName:"Popup",version:we,beans:[BKe]},GKe=".ag-set-filter{--ag-indentation-level:0}.ag-set-filter-item{align-items:center;display:flex;height:100%}:where(.ag-ltr) .ag-set-filter-item{padding-left:calc(var(--ag-widget-container-horizontal-padding) + var(--ag-indentation-level)*var(--ag-set-filter-indent-size))}:where(.ag-rtl) .ag-set-filter-item{padding-right:calc(var(--ag-widget-container-horizontal-padding) + var(--ag-indentation-level)*var(--ag-set-filter-indent-size))}.ag-set-filter-item-checkbox{display:flex;height:100%;width:100%}.ag-set-filter-group-icons{display:block;>*{cursor:pointer}}:where(.ag-ltr) .ag-set-filter-group-icons{margin-right:var(--ag-widget-container-horizontal-padding)}:where(.ag-rtl) .ag-set-filter-group-icons{margin-left:var(--ag-widget-container-horizontal-padding)}.ag-filter-body-wrapper{display:flex;flex-direction:column}:where(.ag-menu:not(.ag-tabs) .ag-filter) .ag-filter-body-wrapper,:where(.ag-menu:not(.ag-tabs) .ag-filter)>:not(.ag-filter-wrapper){min-width:180px}.ag-filter-filter{flex:1 1 0px}.ag-filter-condition{display:flex;justify-content:center}.ag-floating-filter-body{display:flex;flex:1 1 auto;height:100%;position:relative}.ag-floating-filter-full-body{align-items:center;display:flex;flex:1 1 auto;height:100%;overflow:hidden;width:100%}:where(.ag-floating-filter-full-body)>div{flex:1 1 auto}.ag-floating-filter-input{align-items:center;display:flex;width:100%;>*{flex:1 1 auto}:where(.ag-input-field-input[type=date]){width:1px}}.ag-floating-filter-button{display:flex;flex:none}.ag-date-floating-filter-wrapper{display:flex}.ag-set-floating-filter-input [disabled]{pointer-events:none}.ag-floating-filter-button-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:none;height:var(--ag-icon-size);width:var(--ag-icon-size)}.ag-filter-loading{align-items:unset;background-color:var(--ag-chrome-background-color);height:100%;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);position:absolute;width:100%;z-index:1;:where(.ag-menu) &{background-color:var(--ag-menu-background-color)}}.ag-filter-separator{border-top:1px solid var(--menu-separator-color)}:where(.ag-filter-select) .ag-picker-field-wrapper{width:0}.ag-filter-condition-operator{height:17px}:where(.ag-ltr) .ag-filter-condition-operator-or{margin-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-filter-condition-operator-or{margin-right:calc(var(--ag-spacing)*2)}.ag-set-filter-select-all{padding-top:var(--ag-widget-container-vertical-padding)}.ag-filter-no-matches,.ag-set-filter-list{height:calc(var(--ag-list-item-height)*6)}.ag-filter-no-matches{padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}.ag-set-filter-tree-list{height:calc(var(--ag-list-item-height)*10)}.ag-set-filter-filter{margin-left:var(--ag-widget-container-horizontal-padding);margin-right:var(--ag-widget-container-horizontal-padding);margin-top:var(--ag-widget-container-vertical-padding)}.ag-filter-to{margin-top:var(--ag-widget-vertical-spacing)}.ag-mini-filter{margin:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}:where(.ag-ltr) .ag-set-filter-add-group-indent{margin-left:calc(var(--ag-icon-size) + var(--ag-widget-container-horizontal-padding))}:where(.ag-rtl) .ag-set-filter-add-group-indent{margin-right:calc(var(--ag-icon-size) + var(--ag-widget-container-horizontal-padding))}:where(.ag-filter-menu) .ag-set-filter-list{min-width:200px}.ag-filter-virtual-list-item:focus-visible{box-shadow:inset var(--ag-focus-shadow)}.ag-filter-apply-panel{display:flex;justify-content:flex-end;overflow:hidden;padding:var(--ag-widget-vertical-spacing) var(--ag-widget-container-horizontal-padding) var(--ag-widget-container-vertical-padding)}.ag-filter-apply-panel-button{line-height:1.5}:where(.ag-ltr) .ag-filter-apply-panel-button{margin-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-filter-apply-panel-button{margin-right:calc(var(--ag-spacing)*2)}.ag-simple-filter-body-wrapper{display:flex;flex-direction:column;min-height:calc(var(--ag-list-item-height) + var(--ag-widget-container-vertical-padding) + var(--ag-widget-vertical-spacing));overflow-y:auto;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);padding-bottom:calc(var(--ag-widget-container-vertical-padding) - var(--ag-widget-vertical-spacing));&>*{margin-bottom:var(--ag-widget-vertical-spacing)}:where(.ag-resizer-wrapper){margin:0}}.ag-multi-filter-menu-item{margin:var(--ag-spacing) 0}.ag-multi-filter-group-title-bar{background-color:transparent;color:var(--ag-header-text-color);font-weight:500;padding:calc(var(--ag-spacing)*1.5) var(--ag-spacing)}.ag-group-filter-field-select-wrapper{display:flex;flex-direction:column;gap:var(--ag-widget-vertical-spacing);padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}";function zKe(e){const t=e.filterManager;return!!t?.isColumnFilterPresent()||!!t?.isAggregateFilterPresent()}function HKe(e,t){return e.filterManager?.getColumnFilterInstance(t)??Promise.resolve(void 0)}function VKe(e,t){const n=e.colModel.getColDefCol(t);if(n)return e.filterManager?.destroyFilter(n,"api")}function WKe(e,t){e.frameworkOverrides.wrapIncoming(()=>e.filterManager?.setFilterModel(t))}function UKe(e){return e.filterManager?.getFilterModel()??{}}function qKe(e,t){return e.filterManager?.getColumnFilterModel(t)??null}function jKe(e,t,n){return e.filterManager?.setColumnFilterModel(t,n)??Promise.resolve()}function KKe(e,t){const n=e.colModel.getCol(t);if(!n){Ft(12,{colKey:t});return}e.menuSvc?.showFilterMenu({column:n,containerType:"columnFilter",positionBy:"auto"})}var qW={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},jW=["january","february","march","april","may","june","july","august","september","october","november","december"];function YKe(e,t){return e==null?-1:t==null?1:parseFloat(e)-parseFloat(t)}var XKe=class extends Z{constructor(){super(...arguments),this.beanName="colFilter",this.allColumnFilters=new Map,this.allColumnListeners=new Map,this.activeAggregateFilters=[],this.activeColumnFilters=[],this.processingFilterChange=!1,this.filterModelUpdateQueue=[],this.columnFilterModelUpdateQueue=[]}postConstruct(){this.addManagedEventListeners({gridColumnsChanged:this.onColumnsChanged.bind(this),beforeRefreshModel:({params:e})=>{(e.rowDataUpdated||e.changedProps?.has("treeData"))&&this.onNewRowsLoaded("rowDataUpdated")},dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)}),this.initialFilterModel={...this.gos.get("initialState")?.filter?.filterModel??{}}}setFilterModel(e,t="api"){const{colModel:n,dataTypeSvc:i,filterManager:r}=this.beans;if(i?.isPendingInference){this.filterModelUpdateQueue.push({model:e,source:t});return}const s=[],o=this.getFilterModel(!0);if(e){const a=new Set(Object.keys(e));this.allColumnFilters.forEach((l,u)=>{const c=e[u];s.push(Lw(l.filterPromise,c)),a.delete(u)}),a.forEach(l=>{const u=n.getColDefCol(l)||n.getCol(l);if(!u){de(62,{colId:l});return}if(!u.isFilterAllowed()){de(63,{colId:l});return}const c=this.getOrCreateFilterWrapper(u);if(!c){de(64,{colId:l});return}s.push(Lw(c.filterPromise,e[l]))})}else this.allColumnFilters.forEach(a=>{s.push(Lw(a.filterPromise,null))});ir.all(s).then(()=>{const a=this.getFilterModel(!0),l=[];this.allColumnFilters.forEach((u,c)=>{const d=o?o[c]:null,h=a?a[c]:null;b0(d,h)||l.push(u.column)}),l.length>0&&r?.onFilterChanged({columns:l,source:t})})}getFilterModel(e){const t={},{allColumnFilters:n,initialFilterModel:i,beans:{colModel:r}}=this;if(n.forEach((s,o)=>{const a=this.getModelFromFilterWrapper(s);Ce(a)&&(t[o]=a)}),!e)for(const s of Object.keys(i)){const o=i[s];Ce(o)&&!n.has(s)&&r.getCol(s)?.isFilterAllowed()&&(t[s]=o)}return t}getModelFromFilterWrapper(e){const{filter:t}=e;return t?typeof t.getModel!="function"?(de(66),null):t.getModel():this.getModelFromInitialState(e.column)}getModelFromInitialState(e){return this.initialFilterModel[e.getColId()]??null}isColumnFilterPresent(){return this.activeColumnFilters.length>0}isAggregateFilterPresent(){return!!this.activeAggregateFilters.length}disableColumnFilters(){this.initialFilterModel={};const{allColumnFilters:e}=this;return e.size?(e.forEach(t=>this.disposeFilterWrapper(t,"advancedFilterEnabled")),!0):!1}doAggregateFiltersPass(e,t){return this.doColumnFiltersPass(e,t,!0)}updateActiveFilters(){const e=a=>a?a.isFilterActive?a.isFilterActive():(de(67),!1):!1,{colModel:t,gos:n}=this.beans,i=!!iT(n),r=a=>{if(!a.isPrimary())return!0;const u=!t.isPivotActive();return!a.isValueActive()||!u?!1:t.isPivotMode()?!0:i},s=[],o=[];return this.forEachColumnFilter((a,l)=>{e(a)&&(r(l.column)?s.push(a):o.push(a))}).then(()=>{this.activeAggregateFilters=s,this.activeColumnFilters=o})}updateFilterFlagInColumns(e,t){return this.forEachColumnFilter((n,i)=>this.setColFilterActive(i.column,n.isFilterActive(),e,t))}forEachColumnFilter(e){const t=[];return this.allColumnFilters.forEach(n=>{const i=n.filterPromise;i&&t.push(i.then(r=>e(r,n)))}),ir.all(t)}doColumnFiltersPass(e,t,n){const{data:i,aggData:r}=e,s=n?this.activeAggregateFilters:this.activeColumnFilters,o=n?r:i;for(let a=0;a<s.length;a++){const l=s[a];if(!(l==null||l===t)){if(typeof l.doesFilterPass!="function"){Ft(91);continue}if(!l.doesFilterPass({node:e,data:o}))return!1}}return!0}callOnFilterChangedOutsideRenderCycle(e){const{rowRenderer:t,filterManager:n}=this.beans,i=()=>{this.isAlive()&&n?.onFilterChanged(e)};t.isRefreshInProgress()?setTimeout(i,0):i()}updateBeforeFilterChanged(e={}){const{filterInstance:t,additionalEventAttributes:n}=e;return this.updateDependentFilters(),this.updateActiveFilters().then(()=>this.updateFilterFlagInColumns("filterChanged",n).then(()=>{this.allColumnFilters.forEach(i=>{i.filterPromise&&i.filterPromise.then(r=>{r&&r!==t&&r.onAnyFilterChanged&&r.onAnyFilterChanged()})}),this.processingFilterChange=!0}))}updateAfterFilterChanged(){this.processingFilterChange=!1}isSuppressFlashingCellsBecauseFiltering(){return!(this.gos.get("allowShowChangeAfterFilter")??!1)&&this.processingFilterChange}onNewRowsLoaded(e){this.forEachColumnFilter(t=>{t.onNewRowsLoaded?.()}).then(()=>this.updateFilterFlagInColumns(e,{afterDataChange:!0})).then(()=>this.updateActiveFilters())}createGetValue(e){const{filterValueSvc:t,colModel:n}=this.beans;return(i,r)=>{const s=r?n.getCol(r):e;return s?t.getValue(s,i):void 0}}isFilterActive(e){const{filter:t}=this.cachedFilter(e)??{};return t?t.isFilterActive():this.getModelFromInitialState(e)!=null}getOrCreateFilterWrapper(e){if(!e.isFilterAllowed())return null;let t=this.cachedFilter(e);return t||(t=this.createFilterWrapper(e),this.setColumnFilterWrapper(e,t)),t}cachedFilter(e){return this.allColumnFilters.get(e.getColId())}getDefaultFilter(e){let t;const{gos:n,dataTypeSvc:i}=this.beans;if(zD(n))t="agSetColumnFilter";else{const r=i?.getBaseDataType(e);r==="number"?t="agNumberColumnFilter":r==="date"||r==="dateString"?t="agDateColumnFilter":t="agTextColumnFilter"}return t}getDefaultFloatingFilter(e){let t;const{gos:n,dataTypeSvc:i}=this.beans;if(zD(n))t="agSetColumnFloatingFilter";else{const r=i?.getBaseDataType(e);r==="number"?t="agNumberColumnFloatingFilter":r==="date"||r==="dateString"?t="agDateColumnFloatingFilter":t="agTextColumnFloatingFilter"}return t}createFilterInstance(e,t){const n=this.getDefaultFilter(e),i=e.getColDef();let r;const s={...this.createFilterParams(e,i),filterModifiedCallback:()=>this.filterModifiedCallbackFactory(r,e)(),filterChangedCallback:a=>this.filterChangedCallbackFactory(r,e)(a),doesRowPassOtherFilter:a=>this.beans.filterManager?.doesRowPassOtherFilters(r,a)??!0},o=mWe(this.beans.userCompFactory,i,s,n);return o?{filterPromise:()=>{const a=o.newAgStackInstance();return a.then(l=>{r=l,t&&(t.filter=l??void 0)}),a},compDetails:o}:{filterPromise:null,compDetails:null}}createFilterParams(e,t){return ze(this.gos,{column:e,colDef:t,rowModel:this.beans.rowModel,filterChangedCallback:()=>{},filterModifiedCallback:()=>{},getValue:this.createGetValue(e),doesRowPassOtherFilter:()=>!0})}createFilterWrapper(e){const t={column:e,filterPromise:null,compDetails:null},{filterPromise:n,compDetails:i}=this.createFilterInstance(e,t);return t.filterPromise=n?.()??null,t.compDetails=i,t}onColumnsChanged(){const e=[],{colModel:t,filterManager:n}=this.beans;this.allColumnFilters.forEach((r,s)=>{let o;r.column.isPrimary()?o=t.getColDefCol(s):o=t.getCol(s),!(o&&o===r.column)&&(e.push(r.column),this.disposeFilterWrapper(r,"columnChanged"),this.disposeColumnListener(s))});const i=e.every(KW);e.length>0&&!i?n?.onFilterChanged({columns:e,source:"api"}):this.updateDependentFilters()}updateDependentFilters(){this.beans.autoColSvc?.getColumns()?.forEach(e=>{KW(e)&&this.getOrCreateFilterWrapper(e)})}isFilterAllowed(e){if(!e.isFilterAllowed())return!1;const{filter:n}=this.allColumnFilters.get(e.getColId())??{};return n&&typeof n?.isFilterAllowed=="function"?n.isFilterAllowed():!0}getFloatingFilterCompDetails(e,t){const n=c=>{const d=this.getOrCreateFilterWrapper(e)?.filterPromise;d?.then(h=>{c(F0(h))})},i=e.getColDef(),r={...this.createFilterParams(e,i),filterChangedCallback:()=>n(c=>this.filterChangedCallbackFactory(c,e)())},{userCompFactory:s,frameworkOverrides:o}=this.beans,a=xWe(s,i,r);let l=b4e(o,i,()=>this.getDefaultFloatingFilter(e));l==null&&(l="agReadOnlyFloatingFilter");const u=ze(this.gos,{column:e,filterParams:a,currentParentModel:()=>this.getCurrentFloatingFilterParentModel(e),parentFilterInstance:n,showParentFilter:t});return bWe(s,i,u,l)}getCurrentFloatingFilterParentModel(e){return this.getModelFromFilterWrapper(this.cachedFilter(e)??{column:e})}destroyFilter(e,t="api"){const n=e.getColId(),i=this.allColumnFilters.get(n);this.disposeColumnListener(n),delete this.initialFilterModel[n],i&&this.disposeFilterWrapper(i,t).then(r=>{r&&this.isAlive()&&this.beans.filterManager?.onFilterChanged({columns:[e],source:"api"})})}disposeColumnListener(e){const t=this.allColumnListeners.get(e);t&&(this.allColumnListeners.delete(e),t())}disposeFilterWrapper(e,t){return e.filterPromise?.then(n=>{const i=!!n?.isFilterActive();return this.destroyBean(n),this.setColFilterActive(e.column,!1,"filterDestroyed"),this.allColumnFilters.delete(e.column.getColId()),this.eventSvc.dispatchEvent({type:"filterDestroyed",source:t,column:e.column}),i})??ir.resolve(!1)}filterModifiedCallbackFactory(e,t){return()=>{this.eventSvc.dispatchEvent({type:"filterModified",column:t,filterInstance:e})}}filterChangedCallbackFactory(e,t){return n=>{const i=n?.source??"columnFilter",r={filter:e,additionalEventAttributes:n,columns:[t],source:i};this.callOnFilterChangedOutsideRenderCycle(r)}}checkDestroyFilter(e){const t=this.allColumnFilters.get(e);if(!t)return;const n=t.column,{compDetails:i}=n.isFilterAllowed()?this.createFilterInstance(n):{compDetails:null};if(this.areFilterCompsDifferent(t.compDetails,i)){this.destroyFilter(n,"paramsUpdated");return}const r=n.getColDef().filterParams;if(!t.filterPromise){this.destroyFilter(n,"paramsUpdated");return}t.filterPromise.then(s=>{(s?.refresh?s.refresh({...this.createFilterParams(n,n.getColDef()),filterModifiedCallback:this.filterModifiedCallbackFactory(s,n),filterChangedCallback:this.filterChangedCallbackFactory(s,n),doesRowPassOtherFilter:a=>this.beans.filterManager?.doesRowPassOtherFilters(s,a)??!0,...r}):!0)===!1&&this.destroyFilter(n,"paramsUpdated")})}setColumnFilterWrapper(e,t){const n=e.getColId();this.allColumnFilters.set(n,t),this.allColumnListeners.set(n,this.addManagedListeners(e,{colDefChanged:()=>this.checkDestroyFilter(n)})[0])}areFilterCompsDifferent(e,t){if(!t||!e)return!0;const{componentClass:n}=e,{componentClass:i}=t;return!(n===i||n?.render&&i?.render&&n.render===i.render)}hasFloatingFilters(){return this.beans.colModel.getCols().some(t=>t.getColDef().floatingFilter)}getColumnFilterInstance(e){return new Promise(t=>{this.getFilterInstanceImpl(e).then(n=>{t(F0(n))})})}getFilterInstanceImpl(e){const t=this.beans.colModel.getColDefCol(e);return t?this.getOrCreateFilterWrapper(t)?.filterPromise??ir.resolve(null):ir.resolve(void 0)}processFilterModelUpdateQueue(){this.filterModelUpdateQueue.forEach(({model:e,source:t})=>this.setFilterModel(e,t)),this.filterModelUpdateQueue=[],this.columnFilterModelUpdateQueue.forEach(({key:e,model:t,resolve:n})=>{this.setColumnFilterModel(e,t).then(()=>n())}),this.columnFilterModelUpdateQueue=[]}getColumnFilterModel(e){const t=this.getFilterWrapper(e);return t?this.getModelFromFilterWrapper(t):null}setColumnFilterModel(e,t){const{colModel:n,dataTypeSvc:i}=this.beans;if(i?.isPendingInference){let a=()=>{};const l=new Promise(u=>{a=u});return this.columnFilterModelUpdateQueue.push({key:e,model:t,resolve:a}),l}const r=n.getColDefCol(e),s=r?this.getOrCreateFilterWrapper(r):null;return s?(a=>new Promise(l=>{a.then(u=>l(u))}))(Lw(s.filterPromise,t)):Promise.resolve()}getFilterWrapper(e){const t=this.beans.colModel.getColDefCol(e);return t?this.cachedFilter(t)??null:null}setColDefPropertiesForDataType(e,t,n){const i=zD(this.gos),r=this.getLocaleTextFunc(),s=o=>{const{filterParams:a}=e;e.filterParams=typeof a=="object"?{...a,...o}:o};switch(t.baseDataType){case"number":{i&&s({comparator:YKe});break}case"boolean":{s(i?{valueFormatter:o=>Ce(o.value)?r(String(o.value),o.value?"True":"False"):r("blanks","(Blanks)")}:{maxNumConditions:1,debounceMs:0,filterOptions:["empty",{displayKey:"true",displayName:"True",predicate:(o,a)=>a,numberOfInputs:0},{displayKey:"false",displayName:"False",predicate:(o,a)=>a===!1,numberOfInputs:0}]});break}case"date":{s(i?{valueFormatter:o=>{const a=n(o);return Ce(a)?a:r("blanks","(Blanks)")},treeList:!0,treeListFormatter:(o,a)=>{if(o==="NaN")return r("invalidDate","Invalid Date");if(a===1&&o!=null){const l=jW[Number(o)-1];return r(l,qW[l])}return o??r("blanks","(Blanks)")}}:{isValidDate:YW});break}case"dateString":{const o=t.dateParser;s(i?{valueFormatter:a=>{const l=n(a);return Ce(l)?l:r("blanks","(Blanks)")},treeList:!0,treeListPathGetter:a=>{const l=o(a??void 0);return l?[String(l.getFullYear()),String(l.getMonth()+1),String(l.getDate())]:null},treeListFormatter:(a,l)=>{if(l===1&&a!=null){const u=jW[Number(a)-1];return r(u,qW[u])}return a??r("blanks","(Blanks)")}}:{comparator:(a,l)=>{const u=o(l);return l==null||u<a?-1:u>a?1:0},isValidDate:a=>typeof a=="string"&&YW(o(a))});break}case"object":{i?s({valueFormatter:o=>{const a=n(o);return Ce(a)?a:r("blanks","(Blanks)")}}):e.filterValueGetter=o=>n({column:o.column,node:o.node,value:this.beans.valueSvc.getValue(o.column,o.node)});break}}}setColFilterActive(e,t,n,i){e.filterActive!==t&&(e.filterActive=t,e.dispatchColEvent("filterActiveChanged",n)),e.dispatchColEvent("filterChanged",n,i)}destroy(){super.destroy(),this.allColumnFilters.forEach(e=>this.disposeFilterWrapper(e,"gridDestroyed")),this.allColumnListeners.clear()}};function Lw(e,t){return e?new ir(n=>{e.then(i=>{typeof i.setModel!="function"&&(de(65),n()),(i.setModel(t)||ir.resolve()).then(()=>n())})}):ir.resolve()}function KW(e){return e.getColDef().filter==="agGroupColumnFilter"}function YW(e){return e instanceof Date&&!isNaN(e.getTime())}function QKe(e){return!!e.filterManager?.isAnyFilterPresent()}function ZKe(e,t="api"){e.filterManager?.onFilterChanged({source:t})}var JKe=class extends Z{constructor(){super(...arguments),this.beanName="filterManager",this.advFilterModelUpdateQueue=[]}wireBeans(e){this.quickFilter=e.quickFilter,this.advancedFilter=e.advancedFilter,this.colFilter=e.colFilter}postConstruct(){const e=this.refreshFiltersForAggregations.bind(this),t=this.updateAdvFilterColumns.bind(this);this.addManagedEventListeners({columnValueChanged:e,columnPivotChanged:e,columnPivotModeChanged:e,newColumnsLoaded:t,columnVisible:t,advancedFilterEnabledChanged:({enabled:i})=>this.onAdvFilterEnabledChanged(i),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)}),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.addManagedPropertyListeners(["isExternalFilterPresent","doesExternalFilterPass"],()=>{this.onFilterChanged({source:"api"})}),this.updateAggFiltering(),this.addManagedPropertyListener("groupAggFiltering",()=>{this.updateAggFiltering(),this.onFilterChanged()}),this.quickFilter&&this.addManagedListeners(this.quickFilter,{quickFilterChanged:()=>this.onFilterChanged({source:"quickFilter"})});const{gos:n}=this;this.alwaysPassFilter=n.get("alwaysPassFilter"),this.addManagedPropertyListener("alwaysPassFilter",()=>{this.alwaysPassFilter=n.get("alwaysPassFilter"),this.onFilterChanged({source:"api"})})}isExternalFilterPresentCallback(){const e=this.gos.getCallback("isExternalFilterPresent");return typeof e=="function"&&e({})}doesExternalFilterPass(e){const t=this.gos.get("doesExternalFilterPass");return typeof t=="function"&&t(e)}setFilterModel(e,t="api"){if(this.isAdvFilterEnabled()){this.warnAdvFilters();return}this.colFilter?.setFilterModel(e,t)}getFilterModel(){return this.colFilter?.getFilterModel()??{}}isColumnFilterPresent(){return!!this.colFilter?.isColumnFilterPresent()}isAggregateFilterPresent(){return!!this.colFilter?.isAggregateFilterPresent()}isChildFilterPresent(){return this.isColumnFilterPresent()||this.isQuickFilterPresent()||this.externalFilterPresent||this.isAdvFilterPresent()}isAnyFilterPresent(){return this.isChildFilterPresent()||this.isAggregateFilterPresent()}isAdvFilterPresent(){return this.isAdvFilterEnabled()&&this.advancedFilter.isFilterPresent()}onAdvFilterEnabledChanged(e){e?this.colFilter?.disableColumnFilters()&&this.onFilterChanged({source:"advancedFilter"}):this.advancedFilter?.isFilterPresent()&&(this.advancedFilter.setModel(null),this.onFilterChanged({source:"advancedFilter"}))}isAdvFilterEnabled(){return!!this.advancedFilter?.isEnabled()}isAdvFilterHeaderActive(){return this.isAdvFilterEnabled()&&this.advancedFilter.isHeaderActive()}refreshFiltersForAggregations(){iT(this.gos)&&this.onFilterChanged()}onFilterChanged(e={}){const{source:t,additionalEventAttributes:n,columns:i=[]}=e;this.externalFilterPresent=this.isExternalFilterPresentCallback(),(this.colFilter?this.colFilter.updateBeforeFilterChanged(e):ir.resolve()).then(()=>{const r={source:t,type:"filterChanged",columns:i};n&&lr(r,n),this.eventSvc.dispatchEvent(r),this.colFilter?.updateAfterFilterChanged()})}isSuppressFlashingCellsBecauseFiltering(){return!!this.colFilter?.isSuppressFlashingCellsBecauseFiltering()}isQuickFilterPresent(){return!!this.quickFilter?.isFilterPresent()}updateAggFiltering(){this.aggFiltering=!!iT(this.gos)}isAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&this.shouldApplyQuickFilterAfterAgg()}isNonAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&!this.shouldApplyQuickFilterAfterAgg()}shouldApplyQuickFilterAfterAgg(){return(this.aggFiltering||this.beans.colModel.isPivotMode())&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")}doesRowPassOtherFilters(e,t){return this.doesRowPassFilter({rowNode:t,filterInstanceToSkip:e})}doesRowPassAggregateFilters(e){const{rowNode:t}=e;return this.alwaysPassFilter?.(t)?!0:!(this.isAggregateQuickFilterPresent()&&!this.quickFilter.doesRowPass(t)||this.isAggregateFilterPresent()&&!this.colFilter.doAggregateFiltersPass(t,e.filterInstanceToSkip))}doesRowPassFilter(e){const{rowNode:t}=e;return this.alwaysPassFilter?.(t)?!0:!(this.isNonAggregateQuickFilterPresent()&&!this.quickFilter.doesRowPass(t)||this.externalFilterPresent&&!this.doesExternalFilterPass(t)||this.isColumnFilterPresent()&&!this.colFilter.doColumnFiltersPass(t,e.filterInstanceToSkip)||this.isAdvFilterPresent()&&!this.advancedFilter.doesFilterPass(t))}isFilterActive(e){return!!this.colFilter?.isFilterActive(e)}getOrCreateFilterWrapper(e){return this.colFilter?.getOrCreateFilterWrapper(e)??null}getDefaultFloatingFilter(e){return this.colFilter.getDefaultFloatingFilter(e)}createFilterParams(e,t){return this.colFilter.createFilterParams(e,t)}isFilterAllowed(e){return this.isAdvFilterEnabled()?!1:!!this.colFilter?.isFilterAllowed(e)}getFloatingFilterCompDetails(e,t){return this.colFilter?.getFloatingFilterCompDetails(e,t)}getCurrentFloatingFilterParentModel(e){return this.colFilter?.getCurrentFloatingFilterParentModel(e)}destroyFilter(e,t="api"){this.colFilter?.destroyFilter(e,t)}areFilterCompsDifferent(e,t){return!!this.colFilter?.areFilterCompsDifferent(e,t)}getAdvFilterModel(){return this.isAdvFilterEnabled()?this.advancedFilter.getModel():null}setAdvFilterModel(e,t="api"){if(this.isAdvFilterEnabled()){if(this.beans.dataTypeSvc?.isPendingInference){this.advFilterModelUpdateQueue.push(e);return}this.advancedFilter.setModel(e??null),this.onFilterChanged({source:t})}}toggleAdvFilterBuilder(e,t){this.isAdvFilterEnabled()&&this.advancedFilter.getCtrl().toggleFilterBuilder({source:t,force:e})}updateAdvFilterColumns(){this.isAdvFilterEnabled()&&this.advancedFilter.updateValidity()&&this.onFilterChanged({source:"advancedFilter"})}hasFloatingFilters(){return this.isAdvFilterEnabled()?!1:!!this.colFilter?.hasFloatingFilters()}getColumnFilterInstance(e){return this.isAdvFilterEnabled()?(this.warnAdvFilters(),Promise.resolve(void 0)):this.colFilter?.getColumnFilterInstance(e)??Promise.resolve(void 0)}warnAdvFilters(){de(68)}setupAdvFilterHeaderComp(e){this.advancedFilter?.getCtrl().setupHeaderComp(e)}getHeaderRowCount(){return this.isAdvFilterHeaderActive()?1:0}getHeaderHeight(){return this.isAdvFilterHeaderActive()?this.advancedFilter.getCtrl().getHeaderHeight():0}processFilterModelUpdateQueue(){this.advFilterModelUpdateQueue.forEach(e=>this.setAdvFilterModel(e)),this.advFilterModelUpdateQueue=[]}getColumnFilterModel(e){return this.colFilter?.getColumnFilterModel(e)}setColumnFilterModel(e,t){return this.isAdvFilterEnabled()?(this.warnAdvFilters(),Promise.resolve()):this.colFilter?.setColumnFilterModel(e,t)??Promise.resolve()}setColDefPropertiesForDataType(e,t,n){this.colFilter?.setColDefPropertiesForDataType(e,t,n)}},eYe=class extends Z{constructor(){super(...arguments),this.beanName="filterMenuFactory"}wireBeans(e){this.popupSvc=e.popupSvc}hideActiveMenu(){this.hidePopup?.()}showMenuAfterMouseEvent(e,t,n,i){this.showPopup(e,r=>{this.popupSvc?.positionPopupUnderMouseEvent({column:e,type:n,mouseEvent:t,ePopup:r})},n,t.target,Zr(this.gos),i)}showMenuAfterButtonClick(e,t,n,i){let r=-1,s="left";const o=Zr(this.gos);!o&&this.gos.get("enableRtl")&&(r=1,s="right");const a=o?void 0:4*r,l=o?void 0:4;this.showPopup(e,u=>{this.popupSvc?.positionPopupByComponent({type:n,eventSource:t,ePopup:u,nudgeX:a,nudgeY:l,alignSide:s,keepWithinBounds:!0,position:"under",column:e})},n,t,o,i)}showPopup(e,t,n,i,r,s){const o=e?this.createBean(new m4e(e,"COLUMN_MENU")):void 0;if(this.activeMenu=o,!o?.hasFilter()||!e){Ft(57);return}const a=Sn({tag:"div",cls:`ag-menu${r?"":" ag-filter-menu"}`,role:"presentation"});[this.tabListener]=this.addManagedElementListeners(a,{keydown:m=>this.trapFocusWithin(m,a)}),a.appendChild(o?.getGui());let l;const u=()=>o?.afterGuiDetached(),c=i6e(this.gos)?i??this.beans.ctrlsSvc.getGridBodyCtrl().eGridBody:void 0,d=m=>{DW(e,!1,"contextMenu");const C=m instanceof KeyboardEvent;this.tabListener&&(this.tabListener=this.tabListener()),C&&i&&Io(i)&&Jee(i)?.focus({preventScroll:!0}),u(),this.destroyBean(this.activeMenu),this.dispatchVisibleChangedEvent(!1,n,e),s?.()},h=this.getLocaleTextFunc(),p=r&&n!=="columnFilter"?h("ariaLabelColumnMenu","Column Menu"):h("ariaLabelColumnFilter","Column Filter"),g=this.popupSvc?.addPopup({modal:!0,eChild:a,closeOnEsc:!0,closedCallback:d,positionCallback:()=>t(a),anchorToElement:c,ariaLabel:p});g&&(this.hidePopup=l=g.hideFunc),o.afterInit().then(()=>{t(a),o.afterGuiAttached({container:n,hidePopup:l})}),DW(e,!0,"contextMenu"),this.dispatchVisibleChangedEvent(!0,n,e)}trapFocusWithin(e,t){e.key!==X.TAB||e.defaultPrevented||$h(this.beans,t,!1,e.shiftKey)||(e.preventDefault(),ph(t,e.shiftKey))}dispatchVisibleChangedEvent(e,t,n){this.eventSvc.dispatchEvent({type:"columnMenuVisibleChanged",visible:e,switchingTab:!1,key:t,column:n??null,columnGroup:null})}isMenuEnabled(e){return e.isFilterAllowed()&&(e.getColDef().menuTabs??["filterMenuTab"]).includes("filterMenuTab")}showMenuAfterContextMenuEvent(){}destroy(){this.destroyBean(this.activeMenu),super.destroy()}},tYe=class extends Z{constructor(){super(...arguments),this.beanName="filterValueSvc"}getValue(e,t){if(!t)return;const n=e.getColDef(),{filterValueGetter:i}=n;return i?this.executeFilterValueGetter(i,t.data,e,t,n):this.beans.valueSvc.getValue(e,t)}executeFilterValueGetter(e,t,n,i,r){const{expressionSvc:s,valueSvc:o}=this.beans,a=ze(this.gos,{data:t,node:i,column:n,colDef:r,getValue:o.getValueCallback.bind(o,i)});return typeof e=="function"?e(a):s?.evaluate(e,a)}},nYe={tag:"div",cls:"ag-floating-filter-input",role:"presentation",children:[{tag:"ag-input-text-field",ref:"eFloatingFilterText"}]},iYe=class extends At{constructor(){super(nYe,[KR]),this.eFloatingFilterText=ve}init(e){this.params=e;const t=this.beans.colNames.getDisplayNameForColumn(e.column,"header",!0);this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(`${t} ${this.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`)}onParentModelChanged(e){if(e==null){this.eFloatingFilterText.setValue("");return}this.params.parentFilterInstance(t=>{if(t.getModelAsString){const n=t.getModelAsString(e);this.eFloatingFilterText.setValue(n)}})}refresh(e){this.init(e)}},one=class{constructor(){this.customFilterOptions={}}init(e,t){this.filterOptions=e.filterOptions||t,this.mapCustomOptions(),this.selectDefaultItem(e)}mapCustomOptions(){const{filterOptions:e}=this;e&&e.forEach(t=>{if(typeof t=="string")return;const n=[["displayKey"],["displayName"],["predicate","test"]],i=r=>r.some(s=>t[s]!=null)?!0:(de(72,{keys:r}),!1);if(!n.every(i)){this.filterOptions=e.filter(r=>r===t)||[];return}this.customFilterOptions[t.displayKey]=t})}selectDefaultItem(e){const{filterOptions:t}=this;if(e.defaultOption)this.defaultOption=e.defaultOption;else if(t.length>=1){const n=t[0];typeof n=="string"?this.defaultOption=n:n.displayKey?this.defaultOption=n.displayKey:de(73)}else de(74)}getCustomOption(e){return this.customFilterOptions[e]}};function Ov(e,t,n){return n==null?e.splice(t):e.splice(t,n)}function R1(e){return e==null||typeof e=="string"&&e.trim().length===0}function rYe(e){return e==="AND"||e==="OR"?e:"AND"}function sYe(e,t,n){if(e==null)return;const{predicate:i}=e;if(i!=null&&!t.some(r=>r==null))return i(t,n)}function oYe(e,t){let n=e.length;return n>t&&(e.splice(t),de(78),n=t),n}var ane=class extends w4e{constructor(){super(...arguments),this.eTypes=[],this.eJoinOperatorPanels=[],this.eJoinOperatorsAnd=[],this.eJoinOperatorsOr=[],this.eConditionBodies=[],this.listener=()=>this.onUiChanged(),this.lastUiCompletePosition=null,this.joinOperatorId=0}getNumberOfInputs(e){const t=this.optionsFactory.getCustomOption(e);if(t){const{numberOfInputs:i}=t;return i??1}return e&&["empty","notBlank","blank"].indexOf(e)>=0?0:e==="inRange"?2:1}onFloatingFilterChanged(e,t){this.setTypeFromFloatingFilter(e),this.setValueFromFloatingFilter(t),this.onUiChanged(!0)}setTypeFromFloatingFilter(e){this.eTypes.forEach((t,n)=>{const i=n===0?e:this.optionsFactory.defaultOption;t.setValue(i,!0)})}getModelFromUi(){const e=this.getUiCompleteConditions();return e.length===0?null:this.maxNumConditions>1&&e.length>1?{filterType:this.filterType,operator:this.getJoinOperator(),conditions:e}:e[0]}getConditionTypes(){return this.eTypes.map(e=>e.getValue())}getConditionType(e){return this.eTypes[e].getValue()}getJoinOperator(){const{eJoinOperatorsOr:e,defaultJoinOperator:t}=this;return e.length===0?t:e[0].getValue()===!0?"OR":"AND"}areModelsEqual(e,t){if(!e&&!t)return!0;if(!e&&t||e&&!t)return!1;const n=!e.operator,i=!t.operator;if(!n&&i||n&&!i)return!1;let s;if(n){const o=e,a=t;s=this.areSimpleModelsEqual(o,a)}else{const o=e,a=t;s=o.operator===a.operator&&Nh(o.conditions,a.conditions,(l,u)=>this.areSimpleModelsEqual(l,u))}return s}shouldRefresh(e){const t=this.getModel(),n=t?t.conditions??[t]:null,i=e.filterOptions?.map(s=>typeof s=="string"?s:s.displayKey)??this.getDefaultFilterOptions();return!(!(!n||n.every(s=>i.find(o=>o===s.type)!==void 0))||typeof e.maxNumConditions=="number"&&n&&n.length>e.maxNumConditions)}refresh(e){return!this.shouldRefresh(e)||!super.refresh(e)?!1:(this.setParams(e),this.removeConditionsAndOperators(0),this.createOption(),this.setModel(this.getModel()),!0)}setModelIntoUi(e){if(e.operator){const n=e;let i=n.conditions;i==null&&(i=[],de(77));const r=oYe(i,this.maxNumConditions),s=this.getNumConditions();if(r<s)this.removeConditionsAndOperators(r);else if(r>s)for(let a=s;a<r;a++)this.createJoinOperatorPanel(),this.createOption();const o=n.operator==="OR";this.eJoinOperatorsAnd.forEach(a=>a.setValue(!o,!0)),this.eJoinOperatorsOr.forEach(a=>a.setValue(o,!0)),i.forEach((a,l)=>{this.eTypes[l].setValue(a.type,!0),this.setConditionIntoUi(a,l)})}else{const n=e;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(n.type,!0),this.setConditionIntoUi(n,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.onUiChanged(),ir.resolve()}doesFilterPass(e){const t=this.getModel();if(t==null)return!0;const{operator:n}=t,i=[];if(n){const s=t;i.push(...s.conditions??[])}else i.push(t);return i[n&&n==="OR"?"some":"every"](s=>this.individualConditionPasses(e,s))}setParams(e){super.setParams(e),this.setNumConditions(e),this.defaultJoinOperator=rYe(e.defaultJoinOperator),this.filterPlaceholder=e.filterPlaceholder,this.optionsFactory=new one,this.optionsFactory.init(e,this.getDefaultFilterOptions()),this.createFilterListOptions(),this.createOption(),this.createMissingConditionsAndOperators(),this.isReadOnly()&&this.eFilterBody.setAttribute("tabindex","-1")}setNumConditions(e){let t=e.maxNumConditions??2;t<1&&(de(79),t=1),this.maxNumConditions=t;let n=e.numAlwaysVisibleConditions??1;n<1&&(de(80),n=1),n>t&&(de(81),n=t),this.numAlwaysVisibleConditions=n}createOption(){const e=this.createManagedBean(new PN);this.eTypes.push(e),e.addCssClass("ag-filter-select"),this.eFilterBody.appendChild(e.getGui());const t=this.createValueElement();this.eConditionBodies.push(t),this.eFilterBody.appendChild(t),this.putOptionsIntoDropdown(e),this.resetType(e);const n=this.getNumConditions()-1;this.forEachPositionInput(n,i=>this.resetInput(i)),this.addChangedListeners(e,n)}createJoinOperatorPanel(){const e=Sn({tag:"div",cls:"ag-filter-condition"});this.eJoinOperatorPanels.push(e);const t=this.createJoinOperator(this.eJoinOperatorsAnd,e,"and"),n=this.createJoinOperator(this.eJoinOperatorsOr,e,"or");this.eFilterBody.appendChild(e);const i=this.eJoinOperatorPanels.length-1,r=this.joinOperatorId++;this.resetJoinOperatorAnd(t,i,r),this.resetJoinOperatorOr(n,i,r),this.isReadOnly()||(t.onValueChange(this.listener),n.onValueChange(this.listener))}createJoinOperator(e,t,n){const i=this.createManagedBean(new G8e);e.push(i);const r="ag-filter-condition-operator";return i.addCssClass(r),i.addCssClass(`${r}-${n}`),t.appendChild(i.getGui()),i}createFilterListOptions(){this.filterListOptions=this.optionsFactory.filterOptions.map(e=>typeof e=="string"?this.createBoilerplateListOption(e):this.createCustomListOption(e))}putOptionsIntoDropdown(e){const{filterListOptions:t}=this;t.forEach(n=>{e.addOption(n)}),e.setDisabled(t.length<=1)}createBoilerplateListOption(e){return{value:e,text:this.translate(e)}}createCustomListOption(e){const{displayKey:t}=e,n=this.optionsFactory.getCustomOption(e.displayKey);return{value:t,text:n?this.getLocaleTextFunc()(n.displayKey,n.displayName):this.translate(t)}}createBodyTemplate(){return null}getAgComponents(){return[]}getCssIdentifier(){return"simple-filter"}updateUiVisibility(){const e=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,e)}updateNumConditions(){let e=-1,t=!0;for(let n=0;n<this.getNumConditions();n++)this.isConditionUiComplete(n)?e=n:t=!1;if(this.shouldAddNewConditionAtEnd(t))this.createJoinOperatorPanel(),this.createOption();else{const n=this.lastUiCompletePosition??this.getNumConditions()-2;if(e<n){this.removeConditionsAndOperators(n+1);const i=e+1,r=n-i;r>0&&this.removeConditionsAndOperators(i,r),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=e}updateConditionStatusesAndValues(e,t){this.eTypes.forEach((i,r)=>{const s=this.isConditionDisabled(r,e);i.setDisabled(s||this.filterListOptions.length<=1),r===1&&(y0(this.eJoinOperatorPanels[0],s),this.eJoinOperatorsAnd[0].setDisabled(s),this.eJoinOperatorsOr[0].setDisabled(s))}),this.eConditionBodies.forEach((i,r)=>{tn(i,this.isConditionBodyVisible(r))});const n=(t??this.getJoinOperator())==="OR";this.eJoinOperatorsAnd.forEach(i=>{i.setValue(!n,!0)}),this.eJoinOperatorsOr.forEach(i=>{i.setValue(n,!0)}),this.forEachInput((i,r,s,o)=>{this.setElementDisplayed(i,r<o),this.setElementDisabled(i,this.isConditionDisabled(s,e))}),this.resetPlaceholder()}shouldAddNewConditionAtEnd(e){return e&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()}removeConditionsAndOperators(e,t){if(e>=this.getNumConditions())return;const{eTypes:n,eConditionBodies:i,eJoinOperatorPanels:r,eJoinOperatorsAnd:s,eJoinOperatorsOr:o}=this;this.removeComponents(n,e,t),this.removeElements(i,e,t),this.removeValueElements(e,t);const a=Math.max(e-1,0);this.removeElements(r,a,t),this.removeComponents(s,a,t),this.removeComponents(o,a,t)}removeElements(e,t,n){Ov(e,t,n).forEach(r=>_s(r))}removeComponents(e,t,n){Ov(e,t,n).forEach(r=>{_s(r.getGui()),this.destroyBean(r)})}afterGuiAttached(e){if(super.afterGuiAttached(e),this.resetPlaceholder(),!e?.suppressFocus){const{eFilterBody:t,eTypes:n}=this;let i;if(!this.isReadOnly()){const r=this.getInputs(0)[0];r instanceof Rd&&this.isConditionBodyVisible(0)?i=r.getInputElement():i=n[0]?.getFocusableElement()}(i??t).focus({preventScroll:!0})}}afterGuiDetached(){super.afterGuiDetached();const e=this.getModel();this.resetUiToActiveModel(e);let t=-1,n=-1,i=!1;const r=this.getJoinOperator();for(let o=this.getNumConditions()-1;o>=0;o--)if(this.isConditionUiComplete(o))t===-1&&(t=o,n=o);else{const a=o>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(o-1),l=o<t;(a||l)&&(this.removeConditionsAndOperators(o,1),i=!0,l&&n--)}let s=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),s=!0),this.shouldAddNewConditionAtEnd(n===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),s=!0),s&&this.updateConditionStatusesAndValues(n,r),i&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=n}getPlaceholderText(e,t){let n=this.translate(e);if(typeof this.filterPlaceholder=="function"){const i=this.eTypes[t].getValue(),r=this.translate(i);n=this.filterPlaceholder({filterOptionKey:i,filterOption:r,placeholder:n})}else typeof this.filterPlaceholder=="string"&&(n=this.filterPlaceholder);return n}resetPlaceholder(){const e=this.getLocaleTextFunc();this.forEachInput((t,n,i,r)=>{if(!(t instanceof Rd))return;const s=n===0&&r>1?"inRangeStart":n===0?"filterOoo":"inRangeEnd",o=n===0&&r>1?e("ariaFilterFromValue","Filter from value"):n===0?e("ariaFilterValue","Filter Value"):e("ariaFilterToValue","Filter to Value");t.setInputPlaceholder(this.getPlaceholderText(s,i)),t.setInputAriaLabel(o)})}setElementValue(e,t,n){e instanceof Rd&&e.setValue(t!=null?String(t):null,!0)}setElementDisplayed(e,t){e instanceof At&&tn(e.getGui(),t)}setElementDisabled(e,t){e instanceof At&&y0(e.getGui(),t)}attachElementOnChange(e,t){e instanceof Rd&&e.onValueChange(t)}forEachInput(e){this.getConditionTypes().forEach((t,n)=>{this.forEachPositionTypeInput(n,t,e)})}forEachPositionInput(e,t){const n=this.getConditionType(e);this.forEachPositionTypeInput(e,n,t)}forEachPositionTypeInput(e,t,n){const i=this.getNumberOfInputs(t),r=this.getInputs(e);for(let s=0;s<r.length;s++){const o=r[s];o!=null&&n(o,s,e,i)}}isConditionDisabled(e,t){return this.isReadOnly()?!0:e===0?!1:e>t+1}isConditionBodyVisible(e){const t=this.getConditionType(e);return this.getNumberOfInputs(t)>0}isConditionUiComplete(e){return!(e>=this.getNumConditions()||this.getConditionType(e)==="empty"||this.getValues(e).some(n=>n==null))}getNumConditions(){return this.eTypes.length}getUiCompleteConditions(){const e=[];for(let t=0;t<this.getNumConditions();t++)this.isConditionUiComplete(t)&&e.push(this.createCondition(t));return e}createMissingConditionsAndOperators(){if(!this.isReadOnly())for(let e=this.getNumConditions();e<this.numAlwaysVisibleConditions;e++)this.createJoinOperatorPanel(),this.createOption()}resetUiToDefaults(e){return this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach(t=>this.resetType(t)),this.eJoinOperatorsAnd.forEach((t,n)=>this.resetJoinOperatorAnd(t,n,this.joinOperatorId+n)),this.eJoinOperatorsOr.forEach((t,n)=>this.resetJoinOperatorOr(t,n,this.joinOperatorId+n)),this.joinOperatorId++,this.forEachInput(t=>this.resetInput(t)),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,e||this.onUiChanged(),ir.resolve()}resetType(e){const n=this.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");e.setValue(this.optionsFactory.defaultOption,!0).setAriaLabel(n).setDisabled(this.isReadOnly()||this.filterListOptions.length<=1)}resetJoinOperatorAnd(e,t,n){this.resetJoinOperator(e,t,this.defaultJoinOperator==="AND",this.translate("andCondition"),n)}resetJoinOperatorOr(e,t,n){this.resetJoinOperator(e,t,this.defaultJoinOperator==="OR",this.translate("orCondition"),n)}resetJoinOperator(e,t,n,i,r){this.updateJoinOperatorDisabled(e.setValue(n,!0).setName(`ag-simple-filter-and-or-${this.getCompId()}-${r}`).setLabel(i),t)}updateJoinOperatorsDisabled(){const e=(t,n)=>this.updateJoinOperatorDisabled(t,n);this.eJoinOperatorsAnd.forEach(e),this.eJoinOperatorsOr.forEach(e)}updateJoinOperatorDisabled(e,t){e.setDisabled(this.isReadOnly()||t>0)}resetInput(e){this.setElementValue(e,null),this.setElementDisabled(e,this.isReadOnly())}setConditionIntoUi(e,t){const n=this.mapValuesFromModel(e);this.forEachInput((i,r,s)=>{s===t&&this.setElementValue(i,n[r]!=null?n[r]:null)})}setValueFromFloatingFilter(e){this.forEachInput((t,n,i)=>{this.setElementValue(t,n===0&&i===0?e:null,!0)})}addChangedListeners(e,t){this.isReadOnly()||(e.onValueChange(this.listener),this.forEachPositionInput(t,n=>{this.attachElementOnChange(n,this.listener)}))}individualConditionPasses(e,t){const n=this.getCellValue(e.node),i=this.mapValuesFromModel(t),r=this.optionsFactory.getCustomOption(t.type),s=sYe(r,i,n);return s??(n==null?this.evaluateNullValue(t.type):this.evaluateNonNullValue(i,n,t,e))}hasInvalidInputs(){return!1}},lne=class extends ane{setParams(e){super.setParams(e),this.scalarFilterParams=e}evaluateNullValue(e){const{includeBlanksInEquals:t,includeBlanksInNotEqual:n,includeBlanksInGreaterThan:i,includeBlanksInLessThan:r,includeBlanksInRange:s}=this.scalarFilterParams;switch(e){case"equals":if(t)return!0;break;case"notEqual":if(n)return!0;break;case"greaterThan":case"greaterThanOrEqual":if(i)return!0;break;case"lessThan":case"lessThanOrEqual":if(r)return!0;break;case"inRange":if(s)return!0;break;case"blank":return!0;case"notBlank":return!1}return!1}evaluateNonNullValue(e,t,n){const i=n.type;if(!this.isValid(t))return i==="notEqual"||i==="notBlank";const r=this.comparator(),s=e[0]!=null?r(e[0],t):0;switch(i){case"equals":return s===0;case"notEqual":return s!==0;case"greaterThan":return s>0;case"greaterThanOrEqual":return s>=0;case"lessThan":return s<0;case"lessThanOrEqual":return s<=0;case"inRange":{const o=r(e[1],t);return this.scalarFilterParams.inRangeInclusive?s>=0&&o<=0:s>0&&o<0}case"blank":return R1(t);case"notBlank":return!R1(t);default:return de(76,{filterModelType:i}),!0}}},une=class{constructor(e,t,n,i,r,s){this.alive=!0,this.context=e,this.eParent=r;const o=vWe(t,n,i);o&&o.newAgStackInstance().then(a=>{if(!this.alive){e.destroyBean(a);return}if(this.dateComp=a,!a)return;r.appendChild(a.getGui()),a?.afterGuiAttached?.();const{tempValue:l,disabled:u}=this;l&&a.setDate(l),u!=null&&a.setDisabled?.(u),s?.(this)})}destroy(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)}getDate(){return this.dateComp?this.dateComp.getDate():this.tempValue}setDate(e){const t=this.dateComp;t?t.setDate(e):this.tempValue=e}setDisabled(e){const t=this.dateComp;t?t.setDisabled?.(e):this.disabled=e}setDisplayed(e){tn(this.eParent,e)}setInputPlaceholder(e){this.dateComp?.setInputPlaceholder?.(e)}setInputAriaLabel(e){this.dateComp?.setInputAriaLabel?.(e)}afterGuiAttached(e){this.dateComp?.afterGuiAttached?.(e)}updateParams(e){this.dateComp?.refresh?.(e)}},cne=["equals","notEqual","lessThan","greaterThan","inRange","blank","notBlank"],ON=class{constructor(e,t,n){this.getLocaleTextFunc=e,this.optionsFactory=t,this.valueFormatter=n}getModelAsString(e){if(!e)return null;const t=e.operator!=null,n=this.getLocaleTextFunc();if(t){const i=e,s=(i.conditions??[]).map(a=>this.getModelAsString(a)),o=i.operator==="AND"?"andCondition":"orCondition";return s.join(` ${n(o,hte[o])} `)}else{if(e.type==="blank"||e.type==="notBlank")return n(e.type,e.type);{const i=e,r=this.optionsFactory.getCustomOption(i.type),{displayKey:s,displayName:o,numberOfInputs:a}=r||{};return s&&o&&a===0?(n(s,o),o):this.conditionToString(i,r)}}}updateParams(e){this.optionsFactory=e.optionsFactory}formatValue(e){const t=this.valueFormatter;return t?t(e??null)??"":String(e)}},dne=class extends ON{constructor(e,t,n){super(t,n),this.dateFilterParams=e}conditionToString(e,t){const{type:n}=e,{numberOfInputs:i}=t||{},r=n=="inRange"||i===2,s=kr(e.dateFrom),o=kr(e.dateTo),a=this.dateFilterParams.inRangeFloatingFilterDateFormat;if(r){const l=s!==null?Tv(s,a):"null",u=o!==null?Tv(o,a):"null";return`${l}-${u}`}return s!=null?Tv(s,a):`${n}`}updateParams(e){super.updateParams(e),this.dateFilterParams=e.dateFilterParams}},XW=1e3,QW=1/0,aYe=class extends lne{constructor(){super("dateFilter"),this.eConditionPanelsFrom=[],this.eConditionPanelsTo=[],this.dateConditionFromComps=[],this.dateConditionToComps=[],this.minValidYear=XW,this.maxValidYear=QW,this.minValidDate=null,this.maxValidDate=null,this.filterType="date"}afterGuiAttached(e){super.afterGuiAttached(e),this.dateConditionFromComps[0].afterGuiAttached(e)}mapValuesFromModel(e){const{dateFrom:t,dateTo:n,type:i}=e||{};return[t&&kr(t)||null,n&&kr(n)||null].slice(0,this.getNumberOfInputs(i))}comparator(){return this.dateFilterParams.comparator??lYe}isValid(e){const t=this.dateFilterParams.isValidDate;return!t||t(e)}setParams(e){this.dateFilterParams=e,super.setParams(e);const t=(n,i)=>{if(e[n]!=null)if(isNaN(e[n]))de(82,{param:n});else return e[n]==null?i:Number(e[n]);return i};this.minValidYear=t("minValidYear",XW),this.maxValidYear=t("maxValidYear",QW),this.minValidYear>this.maxValidYear&&de(83),this.minValidDate=e.minValidDate?e.minValidDate instanceof Date?e.minValidDate:kr(e.minValidDate):null,this.maxValidDate=e.maxValidDate?e.maxValidDate instanceof Date?e.maxValidDate:kr(e.maxValidDate):null,this.minValidDate&&this.maxValidDate&&this.minValidDate>this.maxValidDate&&de(84),this.filterModelFormatter=new dne(this.dateFilterParams,this.getLocaleTextFunc.bind(this),this.optionsFactory)}createDateCompWrapper(e){const{beans:{userCompFactory:t,context:n,gos:i},dateFilterParams:r}=this,s=new une(n,t,r.colDef,ze(i,{onDateChanged:()=>this.onUiChanged(),filterParams:r,location:"filter"}),e);return this.addDestroyFunc(()=>s.destroy()),s}setElementValue(e,t){e.setDate(t)}setElementDisplayed(e,t){e.setDisplayed(t)}setElementDisabled(e,t){e.setDisabled(t)}getDefaultFilterOptions(){return cne}createValueElement(){const t=Pn(this.beans).createElement("div");return t.classList.add("ag-filter-body"),this.createFromToElement(t,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(t,this.eConditionPanelsTo,this.dateConditionToComps,"to"),t}createFromToElement(e,t,n,i){const s=Pn(this.beans).createElement("div");s.classList.add(`ag-filter-${i}`),s.classList.add(`ag-filter-date-${i}`),t.push(s),e.appendChild(s),n.push(this.createDateCompWrapper(s))}removeValueElements(e,t){this.removeDateComps(this.dateConditionFromComps,e,t),this.removeDateComps(this.dateConditionToComps,e,t),Ov(this.eConditionPanelsFrom,e,t),Ov(this.eConditionPanelsTo,e,t)}removeDateComps(e,t,n){Ov(e,t,n).forEach(r=>r.destroy())}isValidDateValue(e){if(e===null)return!1;const{minValidDate:t,maxValidDate:n,minValidYear:i,maxValidYear:r}=this;if(t){if(e<t)return!1}else if(e.getUTCFullYear()<i)return!1;if(n){if(e>n)return!1}else if(e.getUTCFullYear()>r)return!1;return!0}isConditionUiComplete(e){if(!super.isConditionUiComplete(e))return!1;let t=!0;return this.forEachInput((n,i,r,s)=>{r!==e||!t||i>=s||(t=t&&this.isValidDateValue(n.getDate()))}),t}areSimpleModelsEqual(e,t){return e.dateFrom===t.dateFrom&&e.dateTo===t.dateTo&&e.type===t.type}createCondition(e){const t=this.getConditionType(e),n={},i=this.getValues(e);return i.length>0&&(n.dateFrom=Bs(i[0])),i.length>1&&(n.dateTo=Bs(i[1])),{dateFrom:null,dateTo:null,filterType:this.filterType,type:t,...n}}resetPlaceholder(){const e=this.getLocaleTextFunc(),t=this.translate("dateFormatOoo"),n=e("ariaFilterValue","Filter Value");this.forEachInput(i=>{i.setInputPlaceholder(t),i.setInputAriaLabel(n)})}getInputs(e){const{dateConditionFromComps:t,dateConditionToComps:n}=this;return e>=t.length?[null,null]:[t[e],n[e]]}getValues(e){const t=[];return this.forEachPositionInput(e,(n,i,r,s)=>{i<s&&t.push(n.getDate())}),t}translate(e){return e==="lessThan"?super.translate("before"):e==="greaterThan"?super.translate("after"):super.translate(e)}getModelAsString(e){return this.filterModelFormatter.getModelAsString(e)??""}};function lYe(e,t){const n=t;return n<e?-1:n>e?1:0}var hne=class extends At{constructor(){super(...arguments),this.defaultDebounceMs=0}setLastTypeFromModel(e){if(!e){this.lastType=this.optionsFactory.defaultOption;return}const t=e.operator;let n;t?n=e.conditions[0]:n=e,this.lastType=n.type}canWeEditAfterModelFromParentFilter(e){if(!e)return this.isTypeEditable(this.lastType);if(e.operator)return!1;const n=e;return this.isTypeEditable(n.type)}init(e){this.setSimpleParams(e,!1)}setSimpleParams(e,t=!0){const n=new one;this.optionsFactory=n,n.init(e.filterParams,this.getDefaultOptions());const i=n.defaultOption;t||(this.lastType=i),this.readOnly=!!e.filterParams.readOnly;const r=this.isTypeEditable(i);this.setEditable(r)}refresh(e){this.setSimpleParams(e)}hasSingleInput(e){const t=this.optionsFactory.getCustomOption(e)?.numberOfInputs;return t==null||t==1}isTypeEditable(e){const t=["inRange","empty","blank","notBlank"];return!!e&&!this.readOnly&&this.hasSingleInput(e)&&t.indexOf(e)<0}getAriaLabel(e){return`${this.beans.colNames.getDisplayNameForColumn(e.column,"header",!0)} ${this.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`}},uYe={tag:"div",cls:"ag-floating-filter-input",role:"presentation",children:[{tag:"ag-input-text-field",ref:"eReadOnlyText"},{tag:"div",ref:"eDateWrapper",cls:"ag-date-floating-filter-wrapper"}]},cYe=class extends hne{constructor(){super(uYe,[KR]),this.eReadOnlyText=ve,this.eDateWrapper=ve}getDefaultOptions(){return cne}init(e){super.init(e),this.params=e,this.filterParams=e.filterParams,this.createDateComponent(),this.filterModelFormatter=new dne(this.filterParams,this.getLocaleTextFunc.bind(this),this.optionsFactory);const t=this.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(t("ariaDateFilterInput","Date Filter Input"))}refresh(e){super.refresh(e),this.params=e,this.filterParams=e.filterParams,this.dateComp.updateParams(this.getDateComponentParams()),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory,dateFilterParams:this.filterParams}),this.updateCompOnModelChange(e.currentParentModel())}updateCompOnModelChange(e){const t=!this.readOnly&&this.canWeEditAfterModelFromParentFilter(e);if(this.setEditable(t),t){const n=e?kr(e.dateFrom):null;this.dateComp.setDate(n),this.eReadOnlyText.setValue("")}else this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(e)),this.dateComp.setDate(null)}setEditable(e){tn(this.eDateWrapper,e),tn(this.eReadOnlyText.getGui(),!e)}onParentModelChanged(e,t){t?.afterFloatingFilter||t?.afterDataChange||(super.setLastTypeFromModel(e),this.updateCompOnModelChange(e))}onDateChanged(){const e=this.dateComp.getDate(),t=Bs(e);this.params.parentFilterInstance(n=>{if(n){const i=kr(t);n.onFloatingFilterChanged(this.lastType||null,i)}})}getDateComponentParams(){const{filterParams:e,column:t}=this.params,n=CN(e,this.defaultDebounceMs);return ze(this.gos,{onDateChanged:yi(this,this.onDateChanged.bind(this),n),filterParams:t.getColDef().filterParams,location:"floatingFilter"})}createDateComponent(){const{beans:{context:e,userCompFactory:t},eDateWrapper:n,params:i}=this;this.dateComp=new une(e,t,i.column.getColDef(),this.getDateComponentParams(),n,r=>{r.setInputAriaLabel(this.getAriaLabel(i))}),this.addDestroyFunc(()=>this.dateComp.destroy())}},dYe={tag:"div",cls:"ag-filter-filter",children:[{tag:"ag-input-text-field",ref:"eDateInput",cls:"ag-date-filter"}]},hYe=class extends At{constructor(){super(dYe,[KR]),this.eDateInput=ve,this.isApply=!1,this.applyOnFocusOut=!1}init(e){this.params=e,this.setParams(e);const t=this.eDateInput.getInputElement();this.addManagedListeners(t,{mouseDown:()=>{this.eDateInput.isDisabled()||this.usingSafariDatePicker||t.focus({preventScroll:!0})},input:this.handleInput.bind(this,!1),change:this.handleInput.bind(this,!0),focusout:this.handleFocusOut.bind(this)})}handleInput(e){if(!this.eDateInput.isDisabled()){if(this.isApply){this.applyOnFocusOut=!e,e&&this.params.onDateChanged();return}e||this.params.onDateChanged()}}handleFocusOut(){this.applyOnFocusOut&&(this.applyOnFocusOut=!1,this.params.onDateChanged())}setParams(e){const t=this.eDateInput.getInputElement(),n=this.shouldUseBrowserDatePicker(e);this.usingSafariDatePicker=n&&Oh(),t.type=n?"date":"text";const{minValidYear:i,maxValidYear:r,minValidDate:s,maxValidDate:o,buttons:a}=e.filterParams||{};if(s&&i&&de(85),o&&r&&de(86),s&&o){const[l,u]=[s,o].map(c=>c instanceof Date?c:kr(c));l&&u&&l.getTime()>u.getTime()&&de(87)}s?s instanceof Date?t.min=Tv(s):t.min=s:i&&(t.min=`${i}-01-01`),o?o instanceof Date?t.max=Tv(o):t.max=o:r&&(t.max=`${r}-12-31`),this.isApply=e.location==="floatingFilter"&&!!a?.includes("apply")}refresh(e){this.params=e,this.setParams(e)}getDate(){return kr(this.eDateInput.getValue())}setDate(e){this.eDateInput.setValue(Bs(e,!1))}setInputPlaceholder(e){this.eDateInput.setInputPlaceholder(e)}setInputAriaLabel(e){this.eDateInput.setAriaLabel(e)}setDisabled(e){this.eDateInput.setDisabled(e)}afterGuiAttached(e){(!e||!e.suppressFocus)&&this.eDateInput.getInputElement().focus({preventScroll:!0})}shouldUseBrowserDatePicker(e){return e?.filterParams?.browserDatePicker??!0}},fne=["equals","notEqual","greaterThan","greaterThanOrEqual","lessThan","lessThanOrEqual","inRange","blank","notBlank"],pne=class extends ON{conditionToString(e,t){const{numberOfInputs:n}=t||{},{filter:i,filterTo:r,type:s}=e,o=s=="inRange"||n===2,a=this.formatValue.bind(this);return o?`${a(i)}-${a(r)}`:i!=null?a(i):`${s}`}};function CT(e){const{allowedCharPattern:t}=e??{};return t??null}var fYe=class extends lne{constructor(){super("numberFilter"),this.eValuesFrom=[],this.eValuesTo=[],this.filterType="number",this.defaultDebounceMs=500}refresh(e){return this.numberFilterParams.allowedCharPattern!==e.allowedCharPattern?!1:super.refresh(e)}mapValuesFromModel(e){const{filter:t,filterTo:n,type:i}=e||{};return[this.processValue(t),this.processValue(n)].slice(0,this.getNumberOfInputs(i))}comparator(){return(e,t)=>e===t?0:e<t?1:-1}isValid(e){return!isNaN(e)}setParams(e){this.numberFilterParams=e,super.setParams(e),this.filterModelFormatter=new pne(this.getLocaleTextFunc.bind(this),this.optionsFactory,this.numberFilterParams.numberFormatter)}getDefaultFilterOptions(){return fne}setElementValue(e,t,n){const{numberFormatter:i}=this.numberFilterParams,r=!n&&i?i(t??null):t;super.setElementValue(e,r)}createValueElement(){const e=CT(this.numberFilterParams),t=Sn({tag:"div",cls:"ag-filter-body",role:"presentation"});return this.createFromToElement(t,this.eValuesFrom,"from",e),this.createFromToElement(t,this.eValuesTo,"to",e),t}createFromToElement(e,t,n,i){const r=this.createManagedBean(i?new Bh({allowedCharPattern:i}):new kN);r.addCssClass(`ag-filter-${n}`),r.addCssClass("ag-filter-filter"),t.push(r),e.appendChild(r.getGui())}removeValueElements(e,t){const n=i=>this.removeComponents(i,e,t);n(this.eValuesFrom),n(this.eValuesTo)}getValues(e){const t=[];return this.forEachPositionInput(e,(n,i,r,s)=>{i<s&&t.push(this.processValue(this.stringToFloat(n.getValue())))}),t}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}processValue(e){return e==null||isNaN(e)?null:e}stringToFloat(e){if(typeof e=="number")return e;let t=Il(e);t!=null&&t.trim()===""&&(t=null);const n=this.numberFilterParams.numberParser;return n?n(t):t==null||t.trim()==="-"?null:parseFloat(t)}createCondition(e){const t=this.getConditionType(e),n={filterType:this.filterType,type:t},i=this.getValues(e);return i.length>0&&(n.filter=i[0]),i.length>1&&(n.filterTo=i[1]),n}getInputs(e){const{eValuesFrom:t,eValuesTo:n}=this;return e>=t.length?[null,null]:[t[e],n[e]]}getModelAsString(e){return this.filterModelFormatter.getModelAsString(e)??""}hasInvalidInputs(){let e=!1;return this.forEachInput(t=>{if(!t.getInputElement().validity.valid){e=!0;return}}),e}},gne=class extends Z{constructor(e){super(),this.params=e,this.eInput=ve,this.onValueChanged=()=>{}}setupGui(e){this.eInput=this.createManagedBean(new Bh(this.params?.config));const t=this.eInput.getGui();e.appendChild(t);const n=i=>this.onValueChanged(i);this.addManagedListeners(t,{input:n,keydown:n})}setEditable(e){this.eInput.setDisabled(!e)}getValue(){return this.eInput.getValue()}setValue(e,t){this.eInput.setValue(e,t)}setValueChangedListener(e){this.onValueChanged=e}setParams({ariaLabel:e,autoComplete:t}){const{eInput:n}=this;n.setInputAriaLabel(e),t!==void 0&&n.setAutoComplete(t)}};function mne(e){const t=e?.trim();return t===""?e:t}var pYe={tag:"div",ref:"eFloatingFilterInputContainer",cls:"ag-floating-filter-input",role:"presentation"},vne=class extends hne{constructor(){super(...arguments),this.eFloatingFilterInputContainer=ve,this.defaultDebounceMs=500}postConstruct(){this.setTemplate(pYe)}onParentModelChanged(e,t){t?.afterFloatingFilter||t?.afterDataChange||(this.setLastTypeFromModel(e),this.setEditable(this.canWeEditAfterModelFromParentFilter(e)),this.inputSvc.setValue(this.filterModelFormatter.getModelAsString(e)))}init(e){this.setupFloatingFilterInputService(e),super.init(e),this.setTextInputParams(e)}setupFloatingFilterInputService(e){this.inputSvc=this.createFloatingFilterInputService(e),this.inputSvc.setupGui(this.eFloatingFilterInputContainer)}setTextInputParams(e){this.params=e;const t=e.browserAutoComplete??!1,{inputSvc:n,defaultDebounceMs:i,readOnly:r}=this;if(n.setParams({ariaLabel:this.getAriaLabel(e),autoComplete:t}),this.applyActive=y1(e.filterParams),!r){const s=CN(e.filterParams,i),o=yi(this,this.syncUpWithParentFilter.bind(this),s);n.setValueChangedListener(o)}}refresh(e){super.refresh(e),this.setTextInputParams(e)}recreateFloatingFilterInputService(e){const{inputSvc:t}=this,n=t.getValue();Gi(this.eFloatingFilterInputContainer),this.destroyBean(t),this.setupFloatingFilterInputService(e),t.setValue(n,!0)}syncUpWithParentFilter(e){const t=e.key===X.ENTER;if(this.applyActive&&!t)return;const{inputSvc:n,params:i}=this;let r=n.getValue();i.filterParams.trimInput&&(r=mne(r),n.setValue(r,!0)),i.parentFilterInstance(s=>{s?.onFloatingFilterChanged(this.lastType||null,r||null)})}setEditable(e){this.inputSvc.setEditable(e)}},gYe=class extends Z{constructor(){super(...arguments),this.onValueChanged=()=>{},this.numberInputActive=!0}setupGui(e){this.eNumberInput=this.createManagedBean(new kN),this.eTextInput=this.createManagedBean(new Bh),this.eTextInput.setDisabled(!0);const t=this.eNumberInput.getGui(),n=this.eTextInput.getGui();e.appendChild(t),e.appendChild(n),this.setupListeners(t,i=>this.onValueChanged(i)),this.setupListeners(n,i=>this.onValueChanged(i))}setEditable(e){this.numberInputActive=e,this.eNumberInput.setDisplayed(this.numberInputActive),this.eTextInput.setDisplayed(!this.numberInputActive)}setAutoComplete(e){this.eNumberInput.setAutoComplete(e),this.eTextInput.setAutoComplete(e)}getValue(){return this.getActiveInputElement().getValue()}setValue(e,t){this.getActiveInputElement().setValue(e,t)}getActiveInputElement(){return this.numberInputActive?this.eNumberInput:this.eTextInput}setValueChangedListener(e){this.onValueChanged=e}setupListeners(e,t){this.addManagedListeners(e,{input:t,keydown:t})}setParams(e){this.setAriaLabel(e.ariaLabel),e.autoComplete!==void 0&&this.setAutoComplete(e.autoComplete)}setAriaLabel(e){this.eNumberInput.setInputAriaLabel(e),this.eTextInput.setInputAriaLabel(e)}},mYe=class extends vne{init(e){super.init(e),this.filterModelFormatter=new pne(this.getLocaleTextFunc.bind(this),this.optionsFactory,e.filterParams?.numberFormatter)}refresh(e){CT(e.filterParams)!==this.allowedCharPattern&&this.recreateFloatingFilterInputService(e),super.refresh(e),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})}getDefaultOptions(){return fne}createFloatingFilterInputService(e){return this.allowedCharPattern=CT(e.filterParams),this.allowedCharPattern?this.createManagedBean(new gne({config:{allowedCharPattern:this.allowedCharPattern}})):this.createManagedBean(new gYe)}},Cne=["contains","notContains","equals","notEqual","startsWith","endsWith","blank","notBlank"],yne=class extends ON{conditionToString(e,t){const{numberOfInputs:n}=t||{},{filter:i,filterTo:r,type:s}=e;return s=="inRange"||n===2?`${i}-${r}`:i!=null?`${i}`:`${s}`}},vYe=class extends ane{constructor(){super("textFilter"),this.filterType="text",this.defaultFormatter=e=>e,this.defaultLowercaseFormatter=e=>e==null?null:e.toString().toLowerCase(),this.defaultMatcher=({filterOption:e,value:t,filterText:n})=>{if(n==null)return!1;switch(e){case"contains":return t.indexOf(n)>=0;case"notContains":return t.indexOf(n)<0;case"equals":return t===n;case"notEqual":return t!=n;case"startsWith":return t.indexOf(n)===0;case"endsWith":{const i=t.lastIndexOf(n);return i>=0&&i===t.length-n.length}default:return!1}},this.eValuesFrom=[],this.eValuesTo=[],this.defaultDebounceMs=500}setParams(e){this.textFilterParams=e,super.setParams(e),this.matcher=e.textMatcher||this.defaultMatcher,this.formatter=e.textFormatter||(e.caseSensitive?this.defaultFormatter:this.defaultLowercaseFormatter),this.filterModelFormatter=new yne(this.getLocaleTextFunc.bind(this),this.optionsFactory)}createCondition(e){const t=this.getConditionType(e),n={filterType:this.filterType,type:t},i=this.getValuesWithSideEffects(e,!0);return i.length>0&&(n.filter=i[0]),i.length>1&&(n.filterTo=i[1]),n}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}getInputs(e){const{eValuesFrom:t,eValuesTo:n}=this;return e>=t.length?[null,null]:[t[e],n[e]]}getValues(e){return this.getValuesWithSideEffects(e,!1)}getValuesWithSideEffects(e,t){const n=[];return this.forEachPositionInput(e,(i,r,s,o)=>{if(r<o){let a=Il(i.getValue());t&&this.textFilterParams.trimInput&&(a=mne(a)??null,i.setValue(a,!0)),n.push(a)}}),n}getDefaultFilterOptions(){return Cne}createValueElement(){const e=Sn({tag:"div",cls:"ag-filter-body",role:"presentation"});return this.createFromToElement(e,this.eValuesFrom,"from"),this.createFromToElement(e,this.eValuesTo,"to"),e}createFromToElement(e,t,n){const i=this.createManagedBean(new Bh);i.addCssClass(`ag-filter-${n}`),i.addCssClass("ag-filter-filter"),t.push(i),e.appendChild(i.getGui())}removeValueElements(e,t){const n=i=>this.removeComponents(i,e,t);n(this.eValuesFrom),n(this.eValuesTo)}mapValuesFromModel(e){const{filter:t,filterTo:n,type:i}=e||{};return[t||null,n||null].slice(0,this.getNumberOfInputs(i))}evaluateNullValue(e){return e?["notEqual","notContains","blank"].indexOf(e)>=0:!1}evaluateNonNullValue(e,t,n,i){const r=e.map(h=>this.formatter(h))||[],s=this.formatter(t),{api:o,colDef:a,column:l,context:u,textFormatter:c}=this.textFilterParams;if(n.type==="blank")return R1(t);if(n.type==="notBlank")return!R1(t);const d={api:o,colDef:a,column:l,context:u,node:i.node,data:i.data,filterOption:n.type,value:s,textFormatter:c};return r.some(h=>this.matcher({...d,filterText:h}))}getModelAsString(e){return this.filterModelFormatter.getModelAsString(e)??""}},CYe=class extends vne{init(e){super.init(e),this.filterModelFormatter=new yne(this.getLocaleTextFunc.bind(this),this.optionsFactory)}refresh(e){super.refresh(e),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})}getDefaultOptions(){return Cne}createFloatingFilterInputService(){return this.createManagedBean(new gne)}};function yYe(e){return!!e.quickFilter?.isFilterPresent()}function wYe(e){return e.quickFilter?.getText()}function bYe(e){e.quickFilter?.resetCache()}var SYe=class extends Z{constructor(){super(...arguments),this.beanName="quickFilter",this.quickFilter=null,this.quickFilterParts=null}postConstruct(){const e=this.resetCache.bind(this),t=this.gos;this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:e,columnRowGroupChanged:e,columnVisible:()=>{t.get("includeHiddenColumnsInQuickFilter")||this.resetCache()}}),this.addManagedPropertyListener("quickFilterText",n=>this.setFilter(n.currentValue)),this.addManagedPropertyListeners(["includeHiddenColumnsInQuickFilter","applyQuickFilterBeforePivotOrAgg"],()=>this.onColumnConfigChanged()),this.quickFilter=this.parseFilter(t.get("quickFilterText")),this.parser=t.get("quickFilterParser"),this.matcher=t.get("quickFilterMatcher"),this.setFilterParts(),this.addManagedPropertyListeners(["quickFilterMatcher","quickFilterParser"],()=>this.setParserAndMatcher())}refreshCols(){const{autoColSvc:e,colModel:t,gos:n,pivotResultCols:i}=this.beans,r=t.isPivotMode(),s=e?.getColumns(),o=t.getColDefCols();let a=(r&&!n.get("applyQuickFilterBeforePivotOrAgg")?i?.getPivotResultCols()?.list:o)??[];s&&(a=a.concat(s)),this.colsToUse=n.get("includeHiddenColumnsInQuickFilter")?a:a.filter(l=>l.isVisible()||l.isRowGroupActive())}isFilterPresent(){return this.quickFilter!==null}doesRowPass(e){const t=this.gos.get("cacheQuickFilter");return this.matcher?this.doesRowPassMatcher(t,e):this.quickFilterParts.every(n=>t?this.doesRowPassCache(e,n):this.doesRowPassNoCache(e,n))}resetCache(){this.beans.rowModel.forEachNode(e=>e.quickFilterAggregateText=null)}getText(){return this.gos.get("quickFilterText")}setFilterParts(){const{quickFilter:e,parser:t}=this;e?this.quickFilterParts=t?t(e):e.split(" "):this.quickFilterParts=null}parseFilter(e){return Ce(e)?e.toUpperCase():null}setFilter(e){if(e!=null&&typeof e!="string"){de(70,{newFilter:e});return}const t=this.parseFilter(e);this.quickFilter!==t&&(this.quickFilter=t,this.setFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}setParserAndMatcher(){const e=this.gos.get("quickFilterParser"),t=this.gos.get("quickFilterMatcher"),n=e!==this.parser||t!==this.matcher;this.parser=e,this.matcher=t,n&&(this.setFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}onColumnConfigChanged(){this.refreshCols(),this.resetCache(),this.isFilterPresent()&&this.dispatchLocalEvent({type:"quickFilterChanged"})}doesRowPassNoCache(e,t){return this.colsToUse.some(n=>{const i=this.getTextForColumn(n,e);return Ce(i)&&i.indexOf(t)>=0})}doesRowPassCache(e,t){return this.checkGenerateAggText(e),e.quickFilterAggregateText.indexOf(t)>=0}doesRowPassMatcher(e,t){let n;e?(this.checkGenerateAggText(t),n=t.quickFilterAggregateText):n=this.getAggText(t);const{quickFilterParts:i,matcher:r}=this;return r(i,n)}checkGenerateAggText(e){e.quickFilterAggregateText||(e.quickFilterAggregateText=this.getAggText(e))}getTextForColumn(e,t){let n=this.beans.filterValueSvc.getValue(e,t);const i=e.getColDef();if(i.getQuickFilterText){const r=ze(this.gos,{value:n,node:t,data:t.data,column:e,colDef:i});n=i.getQuickFilterText(r)}return Ce(n)?n.toString().toUpperCase():null}getAggText(e){const t=[];return this.colsToUse.forEach(n=>{const i=this.getTextForColumn(n,e);Ce(i)&&t.push(i)}),t.join(`
`)}},xYe={moduleName:"ClientSideRowModelFilter",version:we,rowModels:["clientSide"],beans:[TKe]},LN={moduleName:"FilterCore",version:we,beans:[JKe],apiFunctions:{isAnyFilterPresent:QKe,onFilterChanged:ZKe},css:[GKe],dependsOn:[xYe]},wne={moduleName:"FilterValue",version:we,beans:[tYe]},ZR={moduleName:"ColumnFilter",version:we,beans:[XKe,eYe],dynamicBeans:{headerFilterCellCtrl:IKe},icons:{filter:"filter",filterActive:"filter"},apiFunctions:{isColumnFilterPresent:zKe,getColumnFilterInstance:HKe,destroyFilter:VKe,setFilterModel:WKe,getFilterModel:UKe,getColumnFilterModel:qKe,setColumnFilterModel:jKe,showColumnFilter:KKe},dependsOn:[LN,QR,wne,LKe]},RYe={moduleName:"CustomFilter",version:we,userComponents:{agReadOnlyFloatingFilter:iYe},dependsOn:[ZR]},EYe={moduleName:"TextFilter",version:we,dependsOn:[ZR],userComponents:{agTextColumnFilter:vYe,agTextColumnFloatingFilter:CYe}},FYe={moduleName:"NumberFilter",version:we,dependsOn:[ZR],userComponents:{agNumberColumnFilter:fYe,agNumberColumnFloatingFilter:mYe}},AYe={moduleName:"DateFilter",version:we,dependsOn:[ZR],userComponents:{agDateColumnFilter:aYe,agDateInput:hYe,agDateColumnFloatingFilter:cYe}},DYe={moduleName:"QuickFilterCore",version:we,rowModels:["clientSide"],beans:[SYe],dependsOn:[LN,wne]},kYe={moduleName:"QuickFilter",version:we,apiFunctions:{isQuickFilterPresent:yYe,getQuickFilter:wYe,resetQuickFilter:bYe},dependsOn:[DYe]},PYe={moduleName:"ExternalFilter",version:we,dependsOn:[LN]},uv=class{constructor(e){this.cellValueChanges=e}},ak=class extends uv{constructor(e,t,n,i){super(e),this.initialRange=t,this.finalRange=n,this.ranges=i}},MYe=10,ZW=class{constructor(e){this.actionStack=[],this.maxStackSize=e||MYe,this.actionStack=new Array(this.maxStackSize)}pop(){return this.actionStack.pop()}push(e){e.cellValueChanges&&e.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(e))}clear(){this.actionStack=[]}getCurrentStackSize(){return this.actionStack.length}},TYe=class extends Z{constructor(){super(...arguments),this.beanName="undoRedo",this.cellValueChanges=[],this.activeCellEdit=null,this.activeRowEdit=null,this.isPasting=!1,this.isRangeInAction=!1,this.onCellValueChanged=e=>{const t={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned},n=this.activeCellEdit!==null&&rte(this.activeCellEdit,t),i=this.activeRowEdit!==null&&a4e(this.activeRowEdit,t);if(!(n||i||this.isPasting||this.isRangeInAction))return;const{rowPinned:s,rowIndex:o,column:a,oldValue:l,value:u}=e,c={rowPinned:s,rowIndex:o,columnId:a.getColId(),newValue:u,oldValue:l};this.cellValueChanges.push(c)},this.clearStacks=()=>{this.undoStack.clear(),this.redoStack.clear()}}postConstruct(){const{gos:e,ctrlsSvc:t}=this.beans;if(!e.get("undoRedoCellEditing"))return;const n=e.get("undoRedoCellEditingLimit");if(n<=0)return;this.undoStack=new ZW(n),this.redoStack=new ZW(n),this.addListeners();const i=this.clearStacks.bind(this);this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this),modelUpdated:r=>{r.keepUndoRedoStack||this.clearStacks()},columnPivotModeChanged:i,newColumnsLoaded:i,columnGroupOpened:i,columnRowGroupChanged:i,columnMoved:i,columnPinned:i,columnVisible:i,rowDragEnd:i}),t.whenReady(this,r=>{this.gridBodyCtrl=r.gridBodyCtrl})}getCurrentUndoStackSize(){return this.undoStack?.getCurrentStackSize()??0}getCurrentRedoStackSize(){return this.redoStack?.getCurrentStackSize()??0}undo(e){const{eventSvc:t,undoStack:n,redoStack:i}=this;t.dispatchEvent({type:"undoStarted",source:e});const r=this.undoRedo(n,i,"initialRange","oldValue","undo");t.dispatchEvent({type:"undoEnded",source:e,operationPerformed:r})}redo(e){const{eventSvc:t,undoStack:n,redoStack:i}=this;t.dispatchEvent({type:"redoStarted",source:e});const r=this.undoRedo(i,n,"finalRange","newValue","redo");t.dispatchEvent({type:"redoEnded",source:e,operationPerformed:r})}undoRedo(e,t,n,i,r){if(!e)return!1;const s=e.pop();return!s||!s.cellValueChanges?!1:(this.processAction(s,o=>o[i],r),s instanceof ak?this.processRange(s.ranges||[s[n]]):this.processCell(s.cellValueChanges),t.push(s),!0)}processAction(e,t,n){e.cellValueChanges.forEach(i=>{const{rowIndex:r,rowPinned:s,columnId:o}=i,a={rowIndex:r,rowPinned:s},l=v1(this.beans,a);l.displayed&&l.setDataValue(o,t(i),n)})}processRange(e){let t;const n=this.beans.rangeSvc;n.removeAllCellRanges(!0),e.forEach((i,r)=>{if(!i)return;const s=i.startRow,o=i.endRow;r===e.length-1&&(t={rowPinned:s.rowPinned,rowIndex:s.rowIndex,columnId:i.startColumn.getColId()},this.setLastFocusedCell(t));const a={rowStartIndex:s.rowIndex,rowStartPinned:s.rowPinned,rowEndIndex:o.rowIndex,rowEndPinned:o.rowPinned,columnStart:i.startColumn,columns:i.columns};n.addCellRange(a)})}processCell(e){const t=e[0],{rowIndex:n,rowPinned:i}=t,r={rowIndex:n,rowPinned:i},s=v1(this.beans,r),o={rowPinned:t.rowPinned,rowIndex:s.rowIndex,columnId:t.columnId};this.setLastFocusedCell(o)}setLastFocusedCell(e){const{rowIndex:t,columnId:n,rowPinned:i}=e,{colModel:r,focusSvc:s,rangeSvc:o}=this.beans,a=r.getCol(n);if(!a)return;const{scrollFeature:l}=this.gridBodyCtrl;l.ensureIndexVisible(t),l.ensureColumnVisible(a);const u={rowIndex:t,column:a,rowPinned:i};s.setFocusedCell({...u,forceBrowserFocus:!0}),o?.setRangeToCell(u)}addListeners(){this.addManagedEventListeners({rowEditingStarted:e=>{this.activeRowEdit={rowIndex:e.rowIndex,rowPinned:e.rowPinned}},rowEditingStopped:()=>{const e=new uv(this.cellValueChanges);this.pushActionsToUndoStack(e),this.activeRowEdit=null},cellEditingStarted:e=>{this.activeCellEdit={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned}},cellEditingStopped:e=>{if(this.activeCellEdit=null,e.valueChanged&&!this.activeRowEdit&&!this.isPasting&&!this.isRangeInAction){const n=new uv(this.cellValueChanges);this.pushActionsToUndoStack(n)}},pasteStart:()=>{this.isPasting=!0},pasteEnd:()=>{const e=new uv(this.cellValueChanges);this.pushActionsToUndoStack(e),this.isPasting=!1},fillStart:()=>{this.isRangeInAction=!0},fillEnd:e=>{const t=new ak(this.cellValueChanges,e.initialRange,e.finalRange);this.pushActionsToUndoStack(t),this.isRangeInAction=!1},keyShortcutChangedCellStart:()=>{this.isRangeInAction=!0},keyShortcutChangedCellEnd:()=>{let e;const{rangeSvc:t,gos:n}=this.beans;t&&Wl(n)?e=new ak(this.cellValueChanges,void 0,void 0,[...t.getCellRanges()]):e=new uv(this.cellValueChanges),this.pushActionsToUndoStack(e),this.isRangeInAction=!1}})}pushActionsToUndoStack(e){this.undoStack.push(e),this.cellValueChanges=[],this.redoStack.clear()}},IYe=".ag-cell-inline-editing{border:var(--ag-cell-editing-border)!important;border-radius:var(--ag-border-radius);box-shadow:var(--ag-cell-editing-shadow);padding:0;z-index:1;.ag-cell-edit-wrapper,.ag-cell-editor,.ag-cell-wrapper,:where(.ag-cell-editor) .ag-input-field-input,:where(.ag-cell-editor) .ag-wrapper{height:100%;line-height:normal;width:100%}}:where(.ag-popup-editor) .ag-large-text{background-color:var(--ag-background-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);padding:0}.ag-large-text-input{height:auto;padding:var(--ag-cell-horizontal-padding)}:where(.ag-rtl .ag-large-text-input) textarea{resize:none}:where(.ag-ltr) .ag-checkbox-edit{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-checkbox-edit{padding-right:var(--ag-cell-horizontal-padding)}",_Ye={tag:"div",cls:"ag-cell-wrapper ag-cell-edit-wrapper ag-checkbox-edit",children:[{tag:"ag-checkbox",ref:"eCheckbox",role:"presentation"}]},OYe=class extends xg{constructor(){super(_Ye,[DN]),this.eCheckbox=ve}init(e){this.params=e;const t=e.value??void 0,n=this.eCheckbox;n.setValue(t),n.getInputElement().setAttribute("tabindex","-1"),this.setAriaLabel(t),this.addManagedListeners(n,{fieldValueChanged:r=>this.setAriaLabel(r.selected)})}getValue(){return this.eCheckbox.getValue()}focusIn(){this.eCheckbox.getFocusableElement().focus()}afterGuiAttached(){this.params.cellStartedEdit&&this.focusIn()}isPopup(){return!1}setAriaLabel(e){const t=this.getLocaleTextFunc(),n=sN(t,e),i=t("ariaToggleCellValue","Press SPACE to toggle cell value");this.eCheckbox.setInputAriaLabel(`${i} (${n})`)}},JR=class extends xg{constructor(e){super({tag:"div",cls:"ag-cell-edit-wrapper",children:[e.getTemplate()]},e.getAgComponents()),this.cellEditorInput=e,this.eInput=ve}init(e){this.params=e;const{cellStartedEdit:t,eventKey:n,suppressPreventDefault:i}=e,r=this.eInput;this.cellEditorInput.init(r,e);let s,o=!0;t?(this.focusAfterAttached=!0,n===X.BACKSPACE||n===X.DELETE?s="":n&&n.length===1?i?o=!1:s=n:(s=this.cellEditorInput.getStartValue(),n!==X.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,s=this.cellEditorInput.getStartValue()),o&&s!=null&&r.setStartValue(s),this.addManagedElementListeners(r.getGui(),{keydown:a=>{const{key:l}=a;(l===X.PAGE_UP||l===X.PAGE_DOWN)&&a.preventDefault()}})}afterGuiAttached(){const e=this.getLocaleTextFunc(),t=this.eInput;if(t.setInputAriaLabel(e("ariaInputEditor","Input Editor")),!this.focusAfterAttached)return;Oh()||t.getFocusableElement().focus();const n=t.getInputElement();this.highlightAllOnFocus?n.select():this.cellEditorInput.setCaret?.()}focusIn(){const e=this.eInput,t=e.getFocusableElement(),n=e.getInputElement();t.focus(),n.select()}getValue(){return this.cellEditorInput.getValue()}isPopup(){return!1}},LYe={tag:"ag-input-date-field",ref:"eInput",cls:"ag-cell-editor"},NYe=class{getTemplate(){return LYe}getAgComponents(){return[Ete]}init(e,t){this.eInput=e,this.params=t;const{min:n,max:i,step:r}=t;n!=null&&e.setMin(n),i!=null&&e.setMax(i),r!=null&&e.setStep(r)}getValue(){const{eInput:e,params:t}=this,n=e.getDate();return!Ce(n)&&!Ce(t.value)?t.value:n??null}getStartValue(){const{value:e}=this.params;if(e instanceof Date)return Bs(e,!1)}},$Ye=class extends JR{constructor(){super(new NYe)}},BYe={tag:"ag-input-date-field",ref:"eInput",cls:"ag-cell-editor"},GYe=class{constructor(e){this.getDataTypeService=e}getTemplate(){return BYe}getAgComponents(){return[Ete]}init(e,t){this.eInput=e,this.params=t;const{min:n,max:i,step:r}=t;n!=null&&e.setMin(n),i!=null&&e.setMax(i),r!=null&&e.setStep(r)}getValue(){const{params:e,eInput:t}=this,n=this.formatDate(t.getDate());return!Ce(n)&&!Ce(e.value)?e.value:e.parseValue(n??"")}getStartValue(){return Bs(this.parseDate(this.params.value??void 0)??null,!1)}parseDate(e){const t=this.getDataTypeService();return t?t.getDateParserFunction(this.params.column)(e):kr(e)??void 0}formatDate(e){const t=this.getDataTypeService();return t?t.getDateFormatterFunction(this.params.column)(e):Bs(e??null,!1)??void 0}},zYe=class extends JR{constructor(){super(new GYe(()=>this.beans.dataTypeSvc))}},HYe={tag:"div",cls:"ag-large-text",children:[{tag:"ag-input-text-area",ref:"eTextArea",cls:"ag-large-text-input"}]},VYe=class extends xg{constructor(){super(HYe,[H8e]),this.eTextArea=ve}init(e){this.params=e,this.focusAfterAttached=e.cellStartedEdit,this.eTextArea.setMaxLength(e.maxLength||200).setCols(e.cols||60).setRows(e.rows||10),e.value!=null&&this.eTextArea.setValue(e.value.toString(),!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.activateTabIndex()}onKeyDown(e){const t=e.key;(t===X.LEFT||t===X.UP||t===X.RIGHT||t===X.DOWN||e.shiftKey&&t===X.ENTER)&&e.stopPropagation()}afterGuiAttached(){const e=this.getLocaleTextFunc();this.eTextArea.setInputAriaLabel(e("ariaInputEditor","Input Editor")),this.focusAfterAttached&&this.eTextArea.getFocusableElement().focus()}getValue(){const e=this.eTextArea.getValue(),t=this.params;return!Ce(e)&&!Ce(t.value)?t.value:t.parseValue(e)}},WYe={tag:"ag-input-number-field",ref:"eInput",cls:"ag-cell-editor"},UYe=class{getTemplate(){return WYe}getAgComponents(){return[V8e]}init(e,t){this.eInput=e,this.params=t;const{max:n,min:i,precision:r,step:s}=t;n!=null&&e.setMax(n),i!=null&&e.setMin(i),r!=null&&e.setPrecision(r),s!=null&&e.setStep(s);const o=e.getInputElement();t.preventStepping?e.addManagedElementListeners(o,{keydown:this.preventStepping}):t.showStepperButtons&&o.classList.add("ag-number-field-input-stepper")}preventStepping(e){(e.key===X.UP||e.key===X.DOWN)&&e.preventDefault()}getValue(){const{eInput:e,params:t}=this,n=e.getValue();if(!Ce(n)&&!Ce(t.value))return t.value;let i=t.parseValue(n);if(i==null)return i;if(typeof i=="string"){if(i==="")return null;i=Number(i)}return isNaN(i)?null:i}getStartValue(){return this.params.value}setCaret(){Oh()&&this.eInput.getInputElement().focus({preventScroll:!0})}},qYe=class extends JR{constructor(){super(new UYe)}},jYe={tag:"div",cls:"ag-cell-edit-wrapper",children:[{tag:"ag-select",ref:"eSelect",cls:"ag-cell-editor"}]},KYe=class extends xg{constructor(){super(jYe,[eUe]),this.eSelect=ve,this.startedByEnter=!1}wireBeans(e){this.valueSvc=e.valueSvc}init(e){this.focusAfterAttached=e.cellStartedEdit;const{eSelect:t,valueSvc:n,gos:i}=this,{values:r,value:s,eventKey:o}=e;if(Xt(r)){de(58);return}this.startedByEnter=o!=null?o===X.ENTER:!1;let a=!1;r.forEach(d=>{const h={value:d},p=n.formatValue(e.column,null,d),g=p!=null;h.text=g?p:d,t.addOption(h),a=a||s===d}),a?t.setValue(e.value,!0):e.values.length&&t.setValue(e.values[0],!0);const{valueListGap:l,valueListMaxWidth:u,valueListMaxHeight:c}=e;l!=null&&t.setPickerGap(l),c!=null&&t.setPickerMaxHeight(c),u!=null&&t.setPickerMaxWidth(u),i.get("editType")!=="fullRow"&&this.addManagedListeners(this.eSelect,{selectedItem:()=>e.stopEditing()})}afterGuiAttached(){this.focusAfterAttached&&this.eSelect.getFocusableElement().focus(),this.startedByEnter&&setTimeout(()=>{this.isAlive()&&this.eSelect.showPicker()})}focusIn(){this.eSelect.getFocusableElement().focus()}getValue(){return this.eSelect.getValue()}isPopup(){return!1}},YYe={tag:"ag-input-text-field",ref:"eInput",cls:"ag-cell-editor"},XYe=class{getTemplate(){return YYe}getAgComponents(){return[KR]}init(e,t){this.eInput=e,this.params=t;const n=t.maxLength;n!=null&&e.setMaxLength(n)}getValue(){const{eInput:e,params:t}=this,n=e.getValue();return!Ce(n)&&!Ce(t.value)?t.value:t.parseValue(n)}getStartValue(){const e=this.params;return e.useFormatter||e.column.getColDef().refData?e.formatValue(e.value):e.value}setCaret(){const e=this.eInput,t=e.getValue(),n=Ce(t)&&t.length||0;n&&e.getInputElement().setSelectionRange(n,n)}},JW=class extends JR{constructor(){super(new XYe)}};function QYe(e){return e.ctrlsSvc.getScrollFeature().getVScrollPosition()}function ZYe(e){return e.ctrlsSvc.getScrollFeature().getHScrollPosition()}function bne(e,t,n="auto"){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureColumnVisible(t,n),"ensureVisible")}function Sne(e,t,n){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureIndexVisible(t,n),"ensureVisible")}function JYe(e,t,n=null){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureNodeVisible(t,n),"ensureVisible")}function eXe(e){e.undoRedo?.undo("api")}function tXe(e){e.undoRedo?.redo("api")}function nXe(e,t={}){const n=[];return e.rowRenderer.getCellCtrls(t.rowNodes,t.columns).forEach(i=>{const r=i.comp?.getCellEditor();r&&n.push(F0(r))}),n}function iXe(e){const t=[];return e.rowRenderer.getAllCellCtrls().forEach(n=>{if(n.editing){const{cellPosition:i}=n;t.push(i)}}),t}function rXe(e,t=!1){e.editSvc?.stopAllEditing(t)}function sXe(e,t){const n=e.colModel.getCol(t.colKey);if(!n){de(12,{colKey:t.colKey});return}const i={rowIndex:t.rowIndex,rowPinned:t.rowPinned||null,column:n};t.rowPinned==null&&Sne(e,t.rowIndex),bne(e,t.colKey);const s=Tf(e,i);if(!s)return;const{focusSvc:o,gos:a,editSvc:l}=e,u=()=>{const d=nn(e),h=s.eGui;return d!==h&&!!h?.contains(d)},c=a.get("stopEditingWhenCellsLoseFocus")&&u();(c||!o.isCellFocused(i))&&o.setFocusedCell({...i,forceBrowserFocus:c,preventScrollOnBrowserFocus:!0}),l?.startRowOrCellEdit(s,t.key)}function oXe(e){return e.undoRedo?.getCurrentUndoStackSize()??0}function aXe(e){return e.undoRedo?.getCurrentRedoStackSize()??0}var lXe={tag:"div",cls:"ag-popup-editor",attrs:{tabindex:"-1"}},uXe=class extends xg{constructor(e){super(lXe),this.params=e}postConstruct(){fh(this.gos,this.getGui(),"popupEditorWrapper",!0),this.addKeyDownListener()}addKeyDownListener(){const e=this.getGui(),t=this.params,n=i=>{lT(this.gos,i,t.node,t.column,!0)||t.onKeyDown(i)};this.addManagedElementListeners(e,{keydown:n})}},cXe=class extends Z{constructor(){super(...arguments),this.beanName="editSvc"}startEditing(e,t=null,n=!1,i=null){if(!e.isCellEditable()||e.editing)return!1;if(!e.comp)return e.onCompAttachedFuncs.push(()=>{this.startEditing(e,t,n,i)}),!0;const r=this.createCellEditorParams(e,t,n),s=e.column.getColDef(),o=bW(this.beans.userCompFactory,s,r),a=o?.popupFromSelector!=null?o.popupFromSelector:!!s.cellEditorPopup,l=o?.popupPositionFromSelector!=null?o.popupPositionFromSelector:s.cellEditorPopupPosition;return e4(e,!0,o),e.comp.setEditDetails(o,a,l,this.gos.get("reactiveCustomComponents")),this.eventSvc.dispatchEvent(e.createEvent(i,"cellEditingStarted")),!o?.params?.suppressPreventDefault}stopEditing(e,t=!1){if(e.onEditorAttachedFuncs=[],!e.editing)return!1;const{comp:n,column:i,rowNode:r}=e,{newValue:s,newValueExists:o}=dXe(t,n),a=this.beans.valueSvc.getValueForDisplay(i,r);let l=!1;return o&&(l=hXe(e,a,s,r,i)),e4(e,!1,void 0),n.setEditDetails(),e.updateAndFormatValue(!1),e.refreshCell({forceRefresh:!0,suppressFlash:!0}),this.eventSvc.dispatchEvent({...e.createEvent(null,"cellEditingStopped"),oldValue:a,newValue:s,valueChanged:l}),l}handleColDefChanged(e){const t=e.comp?.getCellEditor();if(t?.refresh){const{eventKey:n,cellStartedEdit:i}=e.editCompDetails.params,r=this.createCellEditorParams(e,n,i),s=e.column.getColDef(),o=bW(this.beans.userCompFactory,s,r);t.refresh(o.params)}}setFocusOutOnEditor(e){if(!e.editing)return;const t=e.comp.getCellEditor();t&&t.focusOut&&t.focusOut()}setFocusInOnEditor(e){if(!e.editing)return;const t=e.comp,n=t.getCellEditor();n?.focusIn?n.focusIn():(e.focusCell(!0),e.onEditorAttachedFuncs.push(()=>t.getCellEditor()?.focusIn?.()))}createPopupEditorWrapper(e){return new uXe(e)}stopAllEditing(e=!1){this.beans.rowRenderer.getAllRowCtrls().forEach(t=>this.stopRowEditing(t,e))}stopRowEditing(e,t=!1){if(e.stoppingRowEdit)return;const n=e.getAllCellCtrls(),i=e.editing;e.stoppingRowEdit=!0;let r=!1;for(const s of n){const o=s.stopEditing(t);i&&!t&&!r&&o&&(r=!0)}r&&this.eventSvc.dispatchEvent(e.createRowEvent("rowValueChanged")),i&&this.beans.rowEditSvc?.setEditing(e,!1),e.stoppingRowEdit=!1}addStopEditingWhenGridLosesFocus(e){if(!this.gos.get("stopEditingWhenCellsLoseFocus"))return;const t=n=>{const i=n.relatedTarget;if(QM(i)===null){this.stopAllEditing();return}let r=e.some(s=>s.contains(i))&&ite(this.gos,i);if(!r){const s=this.beans.popupSvc;r=!!s&&(s.getActivePopups().some(o=>o.contains(i))||s.isElementWithinCustomPopup(i))}r||this.stopAllEditing()};e.forEach(n=>this.addManagedElementListeners(n,{focusout:t}))}setInlineEditingCss(e){const t=e.editing||e.getAllCellCtrls().some(n=>n.editing);e.forEachGui(void 0,n=>{n.rowComp.addOrRemoveCssClass("ag-row-inline-editing",t),n.rowComp.addOrRemoveCssClass("ag-row-not-inline-editing",!t)})}isCellEditable(e,t){if(t.group){if(this.gos.get("treeData")){if(!t.data&&!this.gos.get("enableGroupEdit"))return!1}else if(!this.gos.get("enableGroupEdit"))return!1}return e.isColumnFunc(t,e.colDef.editable)}startRowOrCellEdit(e,t,n=null){return e.comp?this.gos.get("editType")==="fullRow"?this.beans.rowEditSvc?.startEditing(e.rowCtrl,t,e)??!1:this.startEditing(e,t,!0,n):(e.onCompAttachedFuncs.push(()=>{this.startRowOrCellEdit(e,t,n)}),!0)}stopRowOrCellEdit(e,t=!1,n=!1,i=!1){this.gos.get("editType")==="fullRow"?this.stopRowEditing(e.rowCtrl,t):this.stopEditing(e,t),n||this.navigateAfterEdit(i,e.cellPosition)}createCellEditorParams(e,t,n){const{column:i,rowNode:r,cellPosition:{rowIndex:s}}=e,{valueSvc:o,gos:a}=this.beans;return ze(a,{value:o.getValueForDisplay(i,r),eventKey:t,column:i,colDef:i.getColDef(),rowIndex:s,node:r,data:r.data,cellStartedEdit:n,onKeyDown:e.onKeyDown.bind(e),stopEditing:this.stopRowOrCellEdit.bind(this,e,!1),eGridCell:e.eGui,parseValue:l=>o.parseValue(i,r,l,e.value),formatValue:e.formatValue.bind(e)})}navigateAfterEdit(e,t){if(this.gos.get("enterNavigatesVerticallyAfterEdit")){const i=e?X.UP:X.DOWN;this.beans.navigation?.navigateToNextCell(null,i,t,!1)}}};function e4(e,t,n){e.editCompDetails=n,e.editing!==t&&(e.editing=t)}function dXe(e,t){const n={newValueExists:!1};if(e)return n;const i=t.getCellEditor();return!i||i.isCancelAfterEnd&&i.isCancelAfterEnd()?n:{newValue:i.getValue(),newValueExists:!0}}function hXe(e,t,n,i,r){if(n===t)return!1;e.suppressRefreshCell=!0;const s=i.setDataValue(r,n,"edit");return e.suppressRefreshCell=!1,s}var fXe=class extends Z{constructor(){super(...arguments),this.beanName="rowEditSvc"}startEditing(e,t=null,n=null,i=null){if(e.editing)return!1;let r=!0,s=!1;const{editSvc:o}=this.beans;return e.getAllCellCtrls().forEach(a=>{const l=a===n;l?r=o?.startEditing(a,t,l,i)??!1:o?.startEditing(a,null,l,i),s||(s=a.editing)}),s&&this.setEditing(e,!0),r}setEditing(e,t){e.editing=t,e.forEachGui(void 0,i=>i.rowComp.addOrRemoveCssClass("ag-row-editing",t));const n=t?e.createRowEvent("rowEditingStarted"):e.createRowEvent("rowEditingStopped");this.eventSvc.dispatchEvent(n)}},Oc={moduleName:"EditCore",version:we,beans:[cXe,fXe],apiFunctions:{getCellEditorInstances:nXe,getEditingCells:iXe,stopEditing:rXe,startEditingCell:sXe},dependsOn:[QR],css:[IYe]},pXe={moduleName:"UndoRedoEdit",version:we,beans:[TYe],apiFunctions:{undoCellEditing:eXe,redoCellEditing:tXe,getCurrentUndoSize:oXe,getCurrentRedoSize:aXe},dependsOn:[Oc]},gXe={moduleName:"TextEditor",version:we,userComponents:{agCellEditor:JW,agTextCellEditor:JW},dependsOn:[Oc]},mXe={moduleName:"NumberEditor",version:we,userComponents:{agNumberCellEditor:{classImp:qYe,params:{suppressPreventDefault:!0}}},dependsOn:[Oc]},vXe={moduleName:"DateEditor",version:we,userComponents:{agDateCellEditor:$Ye,agDateStringCellEditor:zYe},dependsOn:[Oc]},CXe={moduleName:"CheckboxEditor",version:we,userComponents:{agCheckboxCellEditor:OYe},dependsOn:[Oc]},yXe={moduleName:"SelectEditor",version:we,userComponents:{agSelectCellEditor:KYe},dependsOn:[Oc]},wXe={moduleName:"LargeTextEditor",version:we,userComponents:{agLargeTextCellEditor:VYe},dependsOn:[Oc]},bXe={moduleName:"CustomEditor",version:we,dependsOn:[Oc]},SXe=class extends Z{constructor(){super(...arguments),this.beanName="selectionColSvc"}postConstruct(){this.addManagedPropertyListener("rowSelection",e=>{this.onSelectionOptionsChanged(e.currentValue,e.previousValue,Yf(e.source))}),this.addManagedPropertyListener("selectionColumnDef",this.updateColumns.bind(this))}addColumns(e){const t=this.columns;t!=null&&(e.list=t.list.concat(e.list),e.tree=t.tree.concat(e.tree),x6e(e))}createColumns(e,t){const n=()=>{d1(this.beans,this.columns?.tree),this.columns=null},i=e.treeDepth,s=(this.columns?.treeDepth??-1)==i,o=this.generateSelectionCols();if(S6e(o,this.columns?.list??[])&&s)return;n();const{colGroupSvc:l}=this.beans,u=l?.findDepth(e.tree)??0,c=l?.balanceTreeForAutoCols(o,u)??[];this.columns={list:o,tree:c,treeDepth:u,map:{}},t(h=>{if(!h)return null;const p=h.filter(g=>!Ul(g));return[...o,...p]})}updateColumns(e){const t=Yf(e.source),n=e.currentValue;this.columns?.list.forEach(i=>{const r=this.createSelectionColDef(n);i.setColDef(r,null,t),os(this.beans,{state:[{colId:i.getColId(),...r}]},t)})}getColumn(e){return this.columns?.list.find(t=>Oee(t,e))??null}getColumns(){return this.columns?.list??null}isSelectionColumnEnabled(){const{gos:e,beans:t}=this,n=e.get("rowSelection");if(typeof n!="object"||!Gd(e))return!1;const i=(t.autoColSvc?.getColumns()?.length??0)>0;if(n.checkboxLocation==="autoGroupColumn"&&i)return!1;const r=!!Kf(n),s=gb(n);return r||s}createSelectionColDef(e){const{gos:t}=this.beans,n=e??t.get("selectionColumnDef"),i=t.get("enableRtl"),{rowSpan:r,spanRows:s,...o}=n??{};return{width:50,resizable:!1,suppressHeaderMenuButton:!0,sortable:!1,suppressMovable:!0,lockPosition:i?"right":"left",comparator(a,l,u,c){const d=u.isSelected(),h=c.isSelected();return d===h?0:d?1:-1},editable:!1,suppressFillHandle:!0,pinned:null,...o,colId:Iee}}generateSelectionCols(){if(!this.isSelectionColumnEnabled())return[];const e=this.createSelectionColDef(),t=e.colId;this.beans.validation?.validateColDef(e,t,!0);const n=new pN(e,null,t,!1);return this.createBean(n),[n]}onSelectionOptionsChanged(e,t,n){const i=t&&typeof t!="string"?Kf(t):void 0,r=e&&typeof e!="string"?Kf(e):void 0,s=i!==r,o=t&&typeof t!="string"?gb(t):void 0,a=e&&typeof e!="string"?gb(e):void 0,l=o!==a,u=l1(e),c=l1(t);(s||l||u!==c)&&this.beans.colModel.refreshAll(n)}destroy(){d1(this.beans,this.columns?.tree),super.destroy()}refreshVisibility(e){if(!this.isSelectionColumnEnabled())return;const t=this.beans,n=t.visibleCols.getAllTrees()??[];if(n.length!==0){if(!n.some(xne)){const i=E0(t).find(r=>Ul(r.colId));i&&os(t,{state:[{colId:i.colId,hide:!i.hide}]},e)}if(n.length===1){const i=n[0],r=Rne(i);if(!r)return;os(t,{state:[{colId:r.getColId(),hide:!0}]},e)}}}},xne=e=>e.isColumn?Ul(e):e.getChildren()?.some(xne)??!1;function Rne(e){if(e.isColumn)return Ul(e)?e:null;const t=e.getChildren()??[];for(const n of t){const i=Rne(n);if(i)return i}return null}function xXe(e,t){if(!t.nodes.every(o=>o.rowPinned?(de(59),!1):o.id===void 0?(de(60),!1):!0))return;const{nodes:i,source:r,newValue:s}=t;e.selectionSvc?.setNodesSelected({nodes:i,source:r??"api",newValue:s})}function RXe(e,t,n="apiSelectAll"){e.selectionSvc?.selectAllRowNodes({source:n,selectAll:t})}function EXe(e,t,n="apiSelectAll"){e.selectionSvc?.deselectAllRowNodes({source:n,selectAll:t})}function FXe(e,t="apiSelectAllFiltered"){e.selectionSvc?.selectAllRowNodes({source:t,selectAll:"filtered"})}function AXe(e,t="apiSelectAllFiltered"){e.selectionSvc?.deselectAllRowNodes({source:t,selectAll:"filtered"})}function DXe(e,t="apiSelectAllCurrentPage"){e.selectionSvc?.selectAllRowNodes({source:t,selectAll:"currentPage"})}function kXe(e,t="apiSelectAllCurrentPage"){e.selectionSvc?.deselectAllRowNodes({source:t,selectAll:"currentPage"})}function PXe(e){return e.selectionSvc?.getSelectedNodes()??[]}function MXe(e){return e.selectionSvc?.getSelectedRows()??[]}var TXe=class extends B8e{constructor(){super(...arguments),this.beanName="selectionSvc",this.selectedNodes=new Map,this.detailSelection=new Map,this.masterSelectsDetail=!1}postConstruct(){super.postConstruct();const{gos:e}=this;this.mode=u1(e),this.groupSelectsDescendants=R0(e),this.groupSelectsFiltered=c1(e)==="filteredDescendants",this.masterSelectsDetail=gW(e)==="detail",this.addManagedPropertyListeners(["groupSelectsChildren","groupSelectsFiltered","rowSelection"],()=>{const t=R0(e),n=u1(e),i=c1(e)==="filteredDescendants";this.masterSelectsDetail=gW(e)==="detail",(t!==this.groupSelectsDescendants||i!==this.groupSelectsFiltered||n!==this.mode)&&(this.deselectAllRowNodes({source:"api"}),this.groupSelectsDescendants=t,this.groupSelectsFiltered=i,this.mode=n)}),this.addManagedEventListeners({rowSelected:this.onRowSelected.bind(this)})}destroy(){super.destroy(),this.resetNodes()}handleSelectionEvent(e,t,n){if(this.isRowSelectionBlocked(t))return 0;const i=this.inferNodeSelections(t,e.shiftKey,e.metaKey||e.ctrlKey,n);return i==null?0:(this.selectionCtx.selectAll=!1,"select"in i?(i.reset?this.resetNodes():this.selectRange(i.deselect,!1,n),this.selectRange(i.select,!0,n)):this.setNodesSelected({nodes:[i.node],newValue:i.newValue,clearSelection:i.clearSelection,event:e,source:n}))}setNodesSelected({newValue:e,clearSelection:t,suppressFinishActions:n,nodes:i,event:r,source:s}){if(!Gd(this.gos)&&e)return de(132),0;if(i.length===0)return 0;if(i.length>1&&!this.isMultiSelect())return de(130),0;let o=0;for(let a=0;a<i.length;a++){const l=i[a],u=Nw(l),c=this.groupSelectsFiltered&&u.group;if(u.rowPinned){de(59);continue}if(u.id===void 0){de(60);continue}c||this.selectRowNode(u,e,r,s)&&(this.detailSelection.delete(u.id),o++),this.groupSelectsDescendants&&u.childrenAfterGroup?.length&&(o+=this.selectChildren(u,e,s))}return n||(e&&(t||!this.isMultiSelect())&&(o+=this.clearOtherNodes(Nw(i[0]),s)),o>0&&(this.updateGroupsFromChildrenSelections(s),this.dispatchSelectionChanged(s))),o}selectRange(e,t,n){let i=0;return e.forEach(r=>{if(r.group&&this.groupSelectsDescendants)return;this.selectRowNode(r,t,void 0,n)&&i++}),i>0&&(this.updateGroupsFromChildrenSelections(n),this.dispatchSelectionChanged(n)),i}selectChildren(e,t,n){const i=this.groupSelectsFiltered?e.childrenAfterAggFilter:e.childrenAfterGroup;return i?this.setNodesSelected({newValue:t,clearSelection:!1,suppressFinishActions:!0,source:n,nodes:i}):0}getSelectedNodes(){return Array.from(this.selectedNodes.values())}getSelectedRows(){const e=[];return this.selectedNodes.forEach(t=>e.push(t.data)),e}getSelectionCount(){return this.selectedNodes.size}filterFromSelection(e){const t=new Map;this.selectedNodes.forEach((n,i)=>{e(n)&&t.set(i,n)}),this.selectedNodes=t}updateGroupsFromChildrenSelections(e,t){if(!this.groupSelectsDescendants)return!1;const{gos:n,rowModel:i}=this.beans;if(!tr(n))return!1;const r=i.rootNode;if(!r)return!1;t||(t=new x1(!0,r),t.active=!1);let s=!1;return t.forEachChangedNodeDepthFirst(o=>{if(o!==r){const a=this.calculateSelectedFromChildren(o);s=this.selectRowNode(o,a===null?!1:a,void 0,e)||s}}),s}clearOtherNodes(e,t){const n=new Map;let i=0;return this.selectedNodes.forEach(r=>{if(r&&r.id!==e.id){const s=this.selectedNodes.get(r.id);i+=this.setNodesSelected({nodes:[s],newValue:!1,clearSelection:!1,suppressFinishActions:!0,source:t}),this.groupSelectsDescendants&&r.parent&&n.set(r.parent.id,r.parent)}}),n.forEach(r=>{const s=this.calculateSelectedFromChildren(r);this.selectRowNode(r,s===null?!1:s,void 0,t)}),i}onRowSelected(e){const t=e.node;this.groupSelectsDescendants&&t.group||(t.isSelected()?this.selectedNodes.set(t.id,t):this.selectedNodes.delete(t.id))}syncInRowNode(e,t){this.syncInOldRowNode(e,t),this.syncInNewRowNode(e)}createDaemonNode(e){if(!e.id)return;const t=new Vp(this.beans);return t.id=e.id,t.data=e.data,t.__daemon=!0,t.__selected=e.__selected,t.level=e.level,t}syncInOldRowNode(e,t){t&&e.id!==t.id&&this.selectedNodes.get(t.id)==e&&this.selectedNodes.set(t.id,t)}syncInNewRowNode(e){this.selectedNodes.has(e.id)?(e.__selected=!0,this.selectedNodes.set(e.id,e)):e.__selected=!1}reset(e){const t=this.getSelectionCount();this.resetNodes(),t&&this.dispatchSelectionChanged(e)}resetNodes(){this.selectedNodes.forEach(e=>{this.selectRowNode(e,!1)}),this.selectedNodes.clear()}getBestCostNodeSelection(){const{gos:e,rowModel:t}=this.beans;if(!tr(e))return;const n=t.getTopLevelNodes();if(n===null)return;const i=[];function r(s){for(let o=0,a=s.length;o<a;o++){const l=s[o];l.isSelected()?i.push(l):l.group&&l.childrenAfterGroup&&r(l.childrenAfterGroup)}}return r(n),i}isEmpty(){return this.getSelectionCount()===0}deselectAllRowNodes({source:e,selectAll:t}){const n=tr(this.gos);let i=!1;const r=s=>{const o=this.selectRowNode(Nw(s),!1,void 0,e);i||(i=o)};if(t==="currentPage"||t==="filtered"){if(!n){Ft(102);return}this.getNodesToSelect(t).forEach(r)}else this.selectedNodes.forEach(r),this.reset(e);if(this.selectionCtx.selectAll=!1,n&&this.groupSelectsDescendants){const s=this.updateGroupsFromChildrenSelections(e);i||(i=s)}i&&this.dispatchSelectionChanged(e)}getSelectedCounts(e){let t=0,n=0;return this.getNodesToSelect(e).forEach(i=>{this.groupSelectsDescendants&&i.group||(i.isSelected()?t++:i.selectable&&n++)}),{selectedCount:t,notSelectedCount:n}}getSelectAllState(e){const{selectedCount:t,notSelectedCount:n}=this.getSelectedCounts(e);return Ene(t,n)??null}hasNodesToSelect(e){return this.getNodesToSelect(e).filter(t=>t.selectable).length>0}getNodesToSelect(e){if(!this.canSelectAll())return[];const t=[];if(e==="currentPage")return this.forEachNodeOnPage(i=>{if(!i.group){t.push(i);return}if(!i.expanded&&!i.footer){const r=s=>{t.push(s),s.childrenAfterFilter?.length&&s.childrenAfterFilter.forEach(r)};r(i);return}this.groupSelectsDescendants||t.push(i)}),t;const n=this.beans.rowModel;return e==="filtered"?(n.forEachNodeAfterFilter(i=>{t.push(i)}),t):(n.forEachNode(i=>{t.push(i)}),t)}forEachNodeOnPage(e){const{pageBounds:t,rowModel:n}=this.beans,i=t.getFirstRow(),r=t.getLastRow();for(let s=i;s<=r;s++){const o=n.getRow(s);o&&e(o)}}selectAllRowNodes(e){const{gos:t,selectionCtx:n}=this;if(!Gd(t)){de(132);return}if(J5e(t)&&!x0(t)){de(130);return}if(!this.canSelectAll())return;const{source:i,selectAll:r}=e;let s=!1;if(this.getNodesToSelect(r).forEach(o=>{const a=this.selectRowNode(Nw(o),!0,void 0,i);s||(s=a)}),n.selectAll=!0,tr(t)&&this.groupSelectsDescendants){const o=this.updateGroupsFromChildrenSelections(i);s||(s=o)}s&&this.dispatchSelectionChanged(i)}getSelectionState(){return this.isEmpty()?null:Array.from(this.selectedNodes.keys())}setSelectionState(e,t){if(!Array.isArray(e)){Ft(103);return}const n=new Set(e),i=[];this.beans.rowModel.forEachNode(r=>{n.has(r.id)&&i.push(r)}),this.setNodesSelected({newValue:!0,nodes:i,source:t})}canSelectAll(){const{gos:e,rowModel:t}=this.beans;return tr(e)?!0:(Ft(100,{rowModelType:t.getType()}),!1)}updateSelectable(e){const{gos:t,rowModel:n}=this.beans;if(!Gd(t))return;const i="selectableChanged",r=e!==void 0,s=tr(t)&&this.groupSelectsDescendants,o=[],a=l=>{if(r&&!l.group)return;if(s&&l.group){const c=l.childrenAfterGroup?.some(d=>d.selectable)??!1;this.setRowSelectable(l,c,!0);return}!this.updateRowSelectable(l,!0)&&l.isSelected()&&o.push(l)};if(s){if(e===void 0){const l=n.rootNode;e=l?new x1(!1,l):void 0}e?.forEachChangedNodeDepthFirst(a,!r,!r)}else n.forEachNode(a);o.length&&this.setNodesSelected({nodes:o,newValue:!1,source:i}),!r&&s&&this.updateGroupsFromChildrenSelections?.(i)}updateSelectableAfterGrouping(e){this.updateSelectable(e),this.groupSelectsDescendants&&this.updateGroupsFromChildrenSelections?.("rowGroupChanged",e)&&this.dispatchSelectionChanged("rowGroupChanged")}refreshMasterNodeState(e,t){if(!this.masterSelectsDetail)return;const n=e.detailNode?.detailGridInfo?.api;if(!n)return;const i=IXe(n);if(e.isSelected()!==i&&this.selectRowNode(e,i,t,"masterDetail")&&this.dispatchSelectionChanged("masterDetail"),!i){const s=this.detailSelection.get(e.id)??new Set;for(const o of n.getSelectedNodes())s.add(o.id);this.detailSelection.set(e.id,s)}}setDetailSelectionState(e,t,n){if(this.masterSelectsDetail){if(!x0(t)){de(269);return}switch(e.isSelected()){case!0:{n.selectAll();break}case!1:{n.deselectAll();break}case void 0:{const i=this.detailSelection.get(e.id);if(i){const r=[];for(const s of i){const o=n.getRowNode(s);o&&r.push(o)}n.setNodesSelected({nodes:r,newValue:!0,source:"masterDetail"})}break}}}}dispatchSelectionChanged(e){this.eventSvc.dispatchEvent({type:"selectionChanged",source:e,selectedNodes:this.getSelectedNodes(),serverSideState:null})}};function Nw(e){return e.footer?e.sibling:e}function IXe(e){let t=0,n=0;return e.forEachNode(i=>{i.isSelected()?t++:i.selectable&&n++}),Ene(t,n)}function Ene(e,t){if(e===0&&t===0)return!1;if(!(e>0&&t>0))return e>0}var _Xe={moduleName:"SharedRowSelection",version:we,beans:[SXe],apiFunctions:{setNodesSelected:xXe,selectAll:RXe,deselectAll:EXe,selectAllFiltered:FXe,deselectAllFiltered:AXe,selectAllOnCurrentPage:DXe,deselectAllOnCurrentPage:kXe,getSelectedNodes:PXe,getSelectedRows:MXe}},OXe={moduleName:"RowSelection",version:we,rowModels:["clientSide","infinite","viewport"],beans:[TXe],dependsOn:[_Xe]};function LXe(e){e.expansionSvc?.expandAll(!0)}function NXe(e){e.expansionSvc?.expandAll(!1)}function $Xe(e){const t=ja(e),n=Zte(e);t?t.onRowHeightChanged():n&&n.onRowHeightChanged()}function BXe(e,t,n){const i=Zte(e);if(i){if(e.rowGroupColsSvc?.columns.length===0){if(t<0){Ft(238);return}i.setRowCount(t,n);return}Ft(28);return}const r=XR(e);if(r){r.setRowCount(t,n);return}}function GXe(e){return bg(e.gos)?e.rowModel.getBlockStates():e.rowNodeBlockLoader?.getBlockState()??{}}function zXe(e){return e.rowModel.isLastRowIndexKnown()}var HXe={moduleName:"CsrmSsrmSharedApi",version:we,apiFunctions:{expandAll:LXe,collapseAll:NXe,onRowHeightChanged:$Xe}},VXe={moduleName:"SsrmInfiniteSharedApi",version:we,apiFunctions:{setRowCount:BXe,getCacheBlockState:GXe,isLastRowIndexKnown:zXe}},WXe=class extends Z{constructor(){super(...arguments),this.beanName="alignedGridsSvc",this.consuming=!1}getAlignedGridApis(){let e=this.gos.get("alignedGrids")??[];const t=typeof e=="function";return typeof e=="function"&&(e=e()),e.map(i=>{if(!i){Ft(18),t||Ft(20);return}if(this.isGridApi(i))return i;const r=i;return"current"in r?r.current?.api:(r.api||Ft(19),r.api)}).filter(i=>!!i&&!i.isDestroyed())}isGridApi(e){return!!e&&!!e.dispatchEvent}postConstruct(){const e=this.fireColumnEvent.bind(this);this.addManagedEventListeners({columnMoved:e,columnVisible:e,columnPinned:e,columnGroupOpened:e,columnResized:e,bodyScroll:this.fireScrollEvent.bind(this),alignedGridColumn:({event:t})=>this.onColumnEvent(t),alignedGridScroll:({event:t})=>this.onScrollEvent(t)})}fireEvent(e){this.consuming||this.getAlignedGridApis().forEach(t=>{t.isDestroyed()||t.dispatchEvent(e)})}onEvent(e){this.consuming=!0,e(),this.consuming=!1}fireColumnEvent(e){this.fireEvent({type:"alignedGridColumn",event:e})}fireScrollEvent(e){e.direction==="horizontal"&&this.fireEvent({type:"alignedGridScroll",event:e})}onScrollEvent(e){this.onEvent(()=>{this.beans.ctrlsSvc.getScrollFeature().setHorizontalScrollPosition(e.left,!0)})}extractDataFromEvent(e,t){const n=[];return e.columns?e.columns.forEach(i=>{n.push(t(i))}):e.column&&n.push(t(e.column)),n}getMasterColumns(e){return this.extractDataFromEvent(e,t=>t)}getColumnIds(e){return this.extractDataFromEvent(e,t=>t.getColId())}onColumnEvent(e){this.onEvent(()=>{switch(e.type){case"columnMoved":case"columnVisible":case"columnPinned":case"columnResized":{this.processColumnEvent(e);break}case"columnGroupOpened":{this.processGroupOpenedEvent(e);break}case"columnPivotChanged":de(21);break}})}processGroupOpenedEvent(e){const{colGroupSvc:t}=this.beans;t&&e.columnGroups.forEach(n=>{let i=null;n&&(i=t.getProvidedColGroup(n.getGroupId())),!(n&&!i)&&t.setColumnGroupOpened(i,n.isExpanded(),"alignedGridChanged")})}processColumnEvent(e){const t=e.column;let n=null;const i=this.beans,{colResize:r,ctrlsSvc:s,colModel:o}=i;if(t&&(n=o.getColDefCol(t.getColId())),t&&!n)return;const a=this.getMasterColumns(e);switch(e.type){case"columnMoved":{const d=e.api.getColumnState().map(h=>({colId:h.colId}));os(i,{state:d,applyOrder:!0},"alignedGridChanged")}break;case"columnVisible":{const d=e.api.getColumnState().map(h=>({colId:h.colId,hide:h.hide}));os(i,{state:d},"alignedGridChanged")}break;case"columnPinned":{const d=e.api.getColumnState().map(h=>({colId:h.colId,pinned:h.pinned}));os(i,{state:d},"alignedGridChanged")}break;case"columnResized":{const c=e,d={};a.forEach(h=>{d[h.getId()]={key:h.getColId(),newWidth:h.getActualWidth()}}),c.flexColumns?.forEach(h=>{d[h.getId()]&&delete d[h.getId()]}),r?.setColumnWidths(Object.values(d),!1,c.finished,"alignedGridChanged");break}}const u=s.getGridBodyCtrl().isVerticalScrollShowing();this.getAlignedGridApis().forEach(c=>{c.setGridOption("alwaysShowVerticalScroll",u)})}},UXe={moduleName:"AlignedGrids",version:we,beans:[WXe]},qXe=class extends _8e{constructor(){super(...arguments),this.beanName="csrmNodeSvc"}},lk=class{constructor(){this.removals=new Set,this.updates=new Set,this.adds=new Set}remove(e){this.adds.delete(e)||(this.updates.delete(e),this.removals.add(e))}update(e){this.adds.has(e)||this.updates.add(e)}add(e){this.adds.add(e)}};function jXe(e){if(Xt(e.childrenAfterSort))return;const t=e.childrenAfterSort;for(let n=0;n<t.length;n++){const i=t[n],r=n===0,s=n===e.childrenAfterSort.length-1;i.setFirstChild(r),i.lastChild!==s&&(i.lastChild=s,i.dispatchRowEvent("lastChildChanged")),i.childIndex!==n&&(i.childIndex=n,i.dispatchRowEvent("childIndexChanged"))}}function Fne(e){e.sibling&&(e.sibling.childrenAfterSort=e.childrenAfterSort),jXe(e)}var KXe=class extends Z{constructor(){super(...arguments),this.beanName="sortStage",this.refreshProps=new Set(["postSortRows","groupDisplayType","accentedSort"]),this.step="sort"}execute(e){const t=this.beans,n=t.sortSvc.getSortOptions(),i=Ce(n)&&n.length>0,r=i&&!!e.changedRowNodes&&this.gos.get("deltaSort"),s=n.some(({column:o})=>pa(t.gos)?o.isPrimary()&&o.isRowGroupActive():!!o.getColDef().showRowGroup);this.sort(t,n,i,r,e.changedRowNodes,e.changedPath,s)}sort(e,t,n,i,r,s,o){const{gos:a,colModel:l,rowGroupColsSvc:u,rowNodeSorter:c,rowRenderer:d,showRowGroupCols:h}=e,p=a.get("groupMaintainOrder"),g=l.getCols().some(S=>S.isRowGroupActive()),m=l.isPivotMode(),C=a.getCallback("postSortRows");let y=!1;const b=S=>{const x=m&&S.leafGroup,E=p&&g&&!S.leafGroup&&!o;let A;if(E){const P=u?.columns?.[S.level+1]?.getSort()===null,D=S.childrenAfterAggFilter.slice(0);if(S.childrenAfterSort&&!P){const M={};S.childrenAfterSort.forEach((O,B)=>{M[O.id]=B}),D.sort((O,B)=>(M[O.id]??0)-(M[B.id]??0))}A=D}else!n||x?A=S.childrenAfterAggFilter.slice(0):i&&r?A=YXe(c,S,r,s,t):A=c.doFullSort(S.childrenAfterAggFilter,t);if(y||(y=S.childrenAfterSort?.[0]!==A[0]),S.childrenAfterSort=A,Fne(S),C){const F={nodes:S.childrenAfterSort};C(F)}};if(s?.forEachChangedNodeDepthFirst(b),y&&this.gos.get("groupHideOpenParents")){const S=h?.getShowRowGroupCols();S?.length&&d.refreshCells({columns:S,force:!0})}}};function YXe(e,t,n,i,r){const s=t.childrenAfterAggFilter,o=t.childrenAfterSort;if(!o)return e.doFullSort(s,r);const a=new Set,l=[],{updates:u,adds:c}=n;for(let h=0,p=s.length;h<p;++h){const g=s[h];u.has(g)||c.has(g)||i&&!i.canSkip(g)?l.push({currentPos:l.length,rowNode:g}):a.add(g.id)}const d=o.filter(h=>a.has(h.id)).map((h,p)=>({currentPos:p,rowNode:h}));return l.sort((h,p)=>e.compareRowNodes(r,h,p)),XXe(e,r,l,d)}function XXe(e,t,n,i){const r=[];let s=0,o=0;const a=n.length,l=i.length;for(;s<a&&o<l;){const u=n[s],c=i[o],d=e.compareRowNodes(t,u,c);let h;d<0?(h=u,++s):(h=c,++o),r.push(h.rowNode)}for(;s<a;)r.push(n[s++].rowNode);for(;o<l;)r.push(i[o++].rowNode);return r}var QXe=class extends Z{constructor(){super(...arguments),this.beanName="rowModel",this.rootNode=null,this.rowsToDisplay=[],this.started=!1,this.isRefreshingModel=!1,this.rowNodesCountReady=!1,this.rowCountReady=!1,this.onRowHeightChanged_debounced=yi(this,this.onRowHeightChanged.bind(this),100)}wireBeans(e){this.colModel=e.colModel,this.valueCache=e.valueCache,this.filterStage=e.filterStage,this.sortStage=e.sortStage,this.flattenStage=e.flattenStage,this.groupStage=e.groupStage,this.aggStage=e.aggStage,this.pivotStage=e.pivotStage,this.filterAggStage=e.filterAggStage}postConstruct(){this.orderedStages=[this.groupStage,this.filterStage,this.pivotStage,this.aggStage,this.sortStage,this.filterAggStage,this.flattenStage].filter(i=>!!i);const e=this.refreshModel.bind(this,{step:"group"}),t=this.refreshModel.bind(this,{step:"group",afterColumnsChanged:!0,keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame")});this.addManagedEventListeners({newColumnsLoaded:t,columnRowGroupChanged:e,columnValueChanged:this.onValueChanged.bind(this),columnPivotChanged:this.refreshModel.bind(this,{step:"pivot"}),filterChanged:this.onFilterChanged.bind(this),sortChanged:this.onSortChanged.bind(this),columnPivotModeChanged:e,gridStylesChanged:this.onGridStylesChanges.bind(this),gridReady:this.onGridReady.bind(this)}),this.addPropertyListeners(),this.rootNode=new Vp(this.beans);const n=this.getNewNodeManager();this.nodeManager=n,n.activate(this.rootNode)}getNewNodeManager(){const{gos:e,beans:t}=this;switch(o6e(e)){case"treeNested":return t.csrmChildrenTreeNodeSvc??t.csrmNodeSvc;case"treePath":return t.csrmPathTreeNodeSvc??t.csrmNodeSvc;default:return t.csrmNodeSvc}}addPropertyListeners(){const e=["treeData","treeDataChildrenField",...this.orderedStages.flatMap(({refreshProps:t})=>[...t])];this.addManagedPropertyListeners(e,t=>{const n=t.changeSet?.properties;n&&this.onPropChange(n)}),this.addManagedPropertyListener("rowData",()=>this.onPropChange(["rowData"])),this.addManagedPropertyListener("rowHeight",()=>this.resetRowHeights())}start(){this.started=!0,this.rowNodesCountReady?this.refreshModel({step:"group",rowDataUpdated:!0,newData:!0}):this.setInitialData()}setInitialData(){this.gos.get("rowData")&&this.onPropChange(["rowData"])}ensureRowHeightsValid(e,t,n,i){let r,s=!1;do{r=!1;const o=this.getRowIndexAtPixel(e),a=this.getRowIndexAtPixel(t),l=Math.max(o,n),u=Math.min(a,i);for(let c=l;c<=u;c++){const d=this.getRow(c);if(d.rowHeightEstimated){const h=Np(this.beans,d);d.setRowHeight(h.height),r=!0,s=!0}}r&&this.setRowTopAndRowIndex()}while(r);return s}onPropChange(e){if(!this.rootNode)return;const t=this.gos,n=new Set(e),i={step:"nothing",changedProps:n},r=n.has("rowData"),s=this.nodeManager,o=this.getNewNodeManager(),a=s!==o||r&&n.has("treeData")&&t.get("treeData")||n.has("treeDataChildrenField")&&t.get("treeData");let l;if((a||r)&&(l=t.get("rowData"),l!=null&&!Array.isArray(l)&&(l=null,de(1))),a&&(r||(l=s?.extractRowData()??l),s!==o&&(s?.deactivate(),this.nodeManager=o),o.activate(this.rootNode)),l&&(!a&&!this.isEmpty()&&l.length>0&&t.exists("getRowId")&&!t.get("resetRowDataOnUpdate")?(i.keepRenderedRows=!0,i.animate=!this.gos.get("suppressAnimationFrame"),i.changedRowNodes=new lk,o.setImmutableRowData(i,l)):(i.rowDataUpdated=!0,i.newData=!0,this.beans.selectionSvc?.reset("rowDataChanged"),this.rowNodesCountReady=!0,o.setNewRowData(l))),i.rowDataUpdated)i.step="group";else if(i.step==="nothing"){for(const{refreshProps:u,step:c}of this.orderedStages)if(e.some(d=>u.has(d))){i.step=c;break}}i.step!=="nothing"&&this.refreshModel(i)}setRowTopAndRowIndex(){const{beans:e}=this,t=e.environment.getDefaultRowHeight();let n=0;const i=new Set,r=Si(this.gos,"normal"),s=this.rowsToDisplay;for(let o=0,a=s.length;o<a;++o){const l=s[o];if(l.id!=null&&i.add(l.id),l.rowHeight==null){const u=Np(e,l,r,t);l.setRowHeight(u.height,u.estimated)}l.setRowTop(n),l.setRowIndex(o),n+=l.rowHeight}return i}clearRowTopAndRowIndex(e,t){const n=e.active,i=s=>{s&&s.id!=null&&!t.has(s.id)&&s.clearRowTopAndRowIndex()},r=s=>{if(s!==null&&(i(s),i(s.detailNode),i(s.sibling),s.hasChildren()&&s.childrenAfterGroup)){const o=s.level==-1;n&&!o&&!s.expanded||s.childrenAfterGroup.forEach(r)}};r(this.rootNode)}ensureRowsAtPixel(e,t,n=0){const i=this.getRowIndexAtPixel(t),r=this.getRow(i),s=!this.gos.get("suppressAnimationFrame");if(r===e[0])return!1;const o=this.rootNode?.allLeafChildren;return o?(e.forEach(a=>{_o(o,a)}),e.forEach((a,l)=>{o.splice(Math.max(i+n,0)+l,0,a)}),e.forEach((a,l)=>{a.sourceRowIndex=l}),this.refreshModel({step:"group",keepRenderedRows:!0,animate:s,rowNodesOrderChanged:!0}),!0):!1}highlightRowAtPixel(e,t){const n=t!=null?this.getRowIndexAtPixel(t):null,i=n!=null?this.getRow(n):null;if(!i||!e||t==null){this.clearHighlightedRow();return}const r=this.getHighlightPosition(t,i),s=this.isHighlightingCurrentPosition(e,i,r),o=this.lastHighlightedRow!=null&&this.lastHighlightedRow!==i;(s||o)&&(this.clearHighlightedRow(),s)||(this.setRowNodeHighlighted(i,r),this.lastHighlightedRow=i)}setRowNodeHighlighted(e,t){e.highlighted!==t&&(e.highlighted=t,e.dispatchRowEvent("rowHighlightChanged"))}getHighlightPosition(e,t){if(!t){const r=this.getRowIndexAtPixel(e);if(t=this.getRow(r||0),!t)return"Below"}const{rowTop:n,rowHeight:i}=t;return e-n<i/2?"Above":"Below"}getLastHighlightedRowNode(){return this.lastHighlightedRow}isHighlightingCurrentPosition(e,t,n){if(e===t)return!0;const i=n==="Above"?-1:1;return this.getRow(t.rowIndex+i)===e}clearHighlightedRow(){this.lastHighlightedRow&&(this.setRowNodeHighlighted(this.lastHighlightedRow,null),this.lastHighlightedRow=null)}isLastRowIndexKnown(){return!0}getRowCount(){return this.rowsToDisplay?this.rowsToDisplay.length:0}getTopLevelRowCount(){const e=this.rootNode;if(!e||this.rowsToDisplay.length===0)return 0;if(this.rowsToDisplay&&this.rowsToDisplay[0]===e)return 1;const n=e.childrenAfterAggFilter,i=e.sibling?1:0;return(n?n.length:0)+i}getTopLevelRowDisplayedIndex(e){const{rootNode:t,rowsToDisplay:n}=this;if(!t||!n.length||n[0]===t)return e;const{childrenAfterSort:r}=t,s=a=>{let l=r[a];if(this.gos.get("groupHideOpenParents"))for(;l.expanded&&l.childrenAfterSort&&l.childrenAfterSort.length>0;)l=l.childrenAfterSort[0];return l.rowIndex},{footerSvc:o}=this.beans;return o?o.getTopDisplayIndex(n,e,r,s):s(e)}getTopLevelIndexFromDisplayedIndex(e){const{rootNode:t,rowsToDisplay:n}=this;if(!t||!n.length||n[0]===t)return e;let r=this.getRow(e);for(r.footer&&(r=r.sibling);r.parent&&r.parent!==t;)r=r.parent;const s=t.childrenAfterSort?.findIndex(o=>o===r);return s===-1?e:s??e}getRowBounds(e){const t=this.rowsToDisplay[e];return t?{rowTop:t.rowTop,rowHeight:t.rowHeight}:null}onRowGroupOpened(){const e=jf(this.gos);this.refreshModel({step:"map",keepRenderedRows:!0,animate:e})}onFilterChanged(e){if(e.afterDataChange)return;const t=jf(this.gos),i=e.columns.length===0||e.columns.some(r=>r.isPrimary())?"filter":"filter_aggregates";this.refreshModel({step:i,keepRenderedRows:!0,animate:t})}onSortChanged(){const e=jf(this.gos);this.refreshModel({step:"sort",keepRenderedRows:!0,animate:e})}getType(){return"clientSide"}onValueChanged(){this.refreshModel({step:this.colModel.isPivotActive()?"pivot":"aggregate"})}createChangePath(e){const t=new x1(!1,this.rootNode);return e||(t.active=!1),t}isSuppressModelUpdateAfterUpdateTransaction(e){if(!this.gos.get("suppressModelUpdateAfterUpdateTransaction"))return!1;const{changedRowNodes:t,newData:n,rowDataUpdated:i}=e;return!(!t||n||!i||t.removals.size||t.adds.size)}refreshModel(e){if(!this.rootNode)return;const t=e.changedPath??(e.changedPath=this.createChangePath(!e.newData&&!!e.rowDataUpdated));if(this.nodeManager.refreshModel?.(e,this.started),this.eventSvc.dispatchEvent({type:"beforeRefreshModel",params:e}),!this.started||(e.rowDataUpdated&&this.eventSvc.dispatchEvent({type:"rowDataUpdated"}),this.isRefreshingModel||this.colModel.changeEventsDispatching||this.isSuppressModelUpdateAfterUpdateTransaction(e)))return;switch(this.isRefreshingModel=!0,e.step){case"group":this.doRowGrouping(e.changedRowNodes,t,!!e.rowNodesOrderChanged,!!e.afterColumnsChanged);case"filter":this.doFilter(t);case"pivot":this.doPivot(t);case"aggregate":this.doAggregate(t);case"filter_aggregates":this.doFilterAggregates(t);case"sort":this.doSort(e.changedRowNodes,t);case"map":this.doRowsToDisplay()}const n=this.setRowTopAndRowIndex();this.clearRowTopAndRowIndex(t,n),this.isRefreshingModel=!1,this.eventSvc.dispatchEvent({type:"modelUpdated",animate:e.animate,keepRenderedRows:e.keepRenderedRows,newData:e.newData,newPage:!1,keepUndoRedoStack:e.keepUndoRedoStack})}isEmpty(){return!this.rootNode?.allLeafChildren?.length||!this.colModel?.ready}isRowsToRender(){return this.rowsToDisplay.length>0}getNodesInRangeForSelection(e,t){let n=!1,i=!1;const r=[],s=R0(this.gos);return this.forEachNodeAfterFilterAndSort(o=>{if(i)return;if(n&&(o===t||o===e)&&(i=!0,o.group&&s)){r.push(...o.allLeafChildren);return}if(!n){if(o!==t&&o!==e)return;n=!0}if(!o.group||!s){r.push(o);return}}),r}getTopLevelNodes(){return this.rootNode?.childrenAfterGroup??null}getRow(e){return this.rowsToDisplay[e]}isRowPresent(e){return this.rowsToDisplay.indexOf(e)>=0}getRowIndexAtPixel(e){const t=this.rowsToDisplay;if(this.isEmpty()||t.length===0)return-1;let n=0,i=t.length-1;if(e<=0)return 0;if(Lt(t).rowTop<=e)return t.length-1;let s=-1,o=-1;for(;;){const a=Math.floor((n+i)/2),l=t[a];if(this.isRowInPixel(l,e)||(l.rowTop<e?n=a+1:l.rowTop>e&&(i=a-1),s===n&&o===i))return a;s=n,o=i}}isRowInPixel(e,t){const n=e.rowTop,i=e.rowTop+e.rowHeight;return n<=t&&i>t}forEachLeafNode(e){this.rootNode?.allLeafChildren?.forEach((t,n)=>e(t,n))}forEachNode(e,t=!1){this.depthFirstSearchRowNodes(e,t)}forEachDisplayedNode(e){this.rowsToDisplay.forEach(e)}forEachNodeAfterFilter(e,t=!1){this.depthFirstSearchRowNodes(e,t,n=>n.childrenAfterAggFilter)}forEachNodeAfterFilterAndSort(e,t=!1){this.depthFirstSearchRowNodes(e,t,n=>n.childrenAfterSort)}forEachPivotNode(e,t=!1,n=!1){const i=n?"childrenAfterSort":"childrenAfterGroup";this.depthFirstSearchRowNodes(e,t,r=>r.leafGroup?null:r[i])}depthFirstSearchRowNodes(e,t=!1,n=s=>s.childrenAfterGroup,i=this.rootNode,r=0){let s=r;if(!i)return s;const o=i===this.rootNode;o||e(i,s++);const{footerSvc:a}=this.beans;if(i.hasChildren()&&!i.footer){const l=n(i);if(l){s=a?.addTotalRows(s,i,e,t,o,"top")??s;for(const u of l)s=this.depthFirstSearchRowNodes(e,t,n,u,s);return a?.addTotalRows(s,i,e,t,o,"bottom")??s}}return s}doAggregate(e){const t=this.rootNode;t&&this.aggStage?.execute({rowNode:t,changedPath:e})}doFilterAggregates(e){const t=this.rootNode;this.filterAggStage?this.filterAggStage.execute({rowNode:t,changedPath:e}):t.childrenAfterAggFilter=t.childrenAfterFilter}doSort(e,t){this.sortStage?this.sortStage.execute({rowNode:this.rootNode,changedRowNodes:e,changedPath:t}):t.forEachChangedNodeDepthFirst(n=>{n.childrenAfterSort=n.childrenAfterAggFilter.slice(0),Fne(n)})}doRowGrouping(e,t,n,i){const r=this.rootNode;if(!this.groupStage?.execute({rowNode:r,changedPath:t,changedRowNodes:e,rowNodesOrderChanged:n,afterColumnsChanged:i})&&!this.nodeManager.treeData){const o=r.sibling;r.childrenAfterGroup=r.allLeafChildren,o&&(o.childrenAfterGroup=r.childrenAfterGroup),r.updateHasChildren()}this.rowNodesCountReady&&(this.rowCountReady=!0,this.eventSvc.dispatchEventOnce({type:"rowCountReady"}))}doFilter(e){this.filterStage?this.filterStage.execute({rowNode:this.rootNode,changedPath:e}):e.forEachChangedNodeDepthFirst(t=>{t.childrenAfterFilter=t.childrenAfterGroup,sne(t)},!0)}doPivot(e){this.pivotStage?.execute({rowNode:this.rootNode,changedPath:e})}getRowNode(e){if(typeof e=="string"&&e.indexOf(aT)==0){let n;return this.forEachNode(i=>{i.id===e&&(n=i)}),n}return this.nodeManager.getRowNode(e)}batchUpdateRowData(e,t){if(this.applyAsyncTransactionsTimeout==null){this.rowDataTransactionBatch=[];const n=this.gos.get("asyncTransactionWaitMillis");this.applyAsyncTransactionsTimeout=window.setTimeout(()=>{this.isAlive()&&this.executeBatchUpdateRowData()},n)}this.rowDataTransactionBatch.push({rowDataTransaction:e,callback:t})}flushAsyncTransactions(){this.applyAsyncTransactionsTimeout!=null&&(clearTimeout(this.applyAsyncTransactionsTimeout),this.executeBatchUpdateRowData())}executeBatchUpdateRowData(){this.valueCache?.onDataChanged();const e=[],t=[],n=new lk;let i=!1;this.rowDataTransactionBatch?.forEach(r=>{this.rowNodesCountReady=!0;const{rowNodeTransaction:s,rowsInserted:o}=this.nodeManager.updateRowData(r.rowDataTransaction,n);o&&(i=!0),t.push(s),r.callback&&e.push(r.callback.bind(null,s))}),this.commitTransactions(i,n),e.length>0&&window.setTimeout(()=>{e.forEach(r=>r())},0),t.length>0&&this.eventSvc.dispatchEvent({type:"asyncTransactionsFlushed",results:t}),this.rowDataTransactionBatch=null,this.applyAsyncTransactionsTimeout=void 0}updateRowData(e){this.valueCache?.onDataChanged(),this.rowNodesCountReady=!0;const t=new lk,{rowNodeTransaction:n,rowsInserted:i}=this.nodeManager.updateRowData(e,t);return this.commitTransactions(i,t),n}commitTransactions(e,t){this.refreshModel({step:"group",rowDataUpdated:!0,rowNodesOrderChanged:e,keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame"),changedRowNodes:t,changedPath:this.createChangePath(!0)})}doRowsToDisplay(){const{flattenStage:e,rootNode:t}=this;let n;if(e)n=e.execute({rowNode:t});else{n=t?.childrenAfterSort??[];for(const i of n)i.setUiLevel(0)}this.rowsToDisplay=n}onRowHeightChanged(){this.refreshModel({step:"map",keepRenderedRows:!0,keepUndoRedoStack:!0})}resetRowHeights(){const e=this.rootNode;if(!e)return;const t=this.resetRowHeightsForAllRowNodes();e.setRowHeight(e.rowHeight,!0),e.sibling&&e.sibling.setRowHeight(e.sibling.rowHeight,!0),t&&this.onRowHeightChanged()}resetRowHeightsForAllRowNodes(){let e=!1;return this.forEachNode(t=>{t.setRowHeight(t.rowHeight,!0);const n=t.detailNode;n&&n.setRowHeight(n.rowHeight,!0),t.sibling&&t.sibling.setRowHeight(t.sibling.rowHeight,!0),e=!0}),e}onGridStylesChanges(e){if(e.rowHeightChanged){if(this.beans.rowAutoHeight?.active)return;this.resetRowHeights()}}onGridReady(){this.started||this.setInitialData()}isRowDataLoaded(){return this.rowCountReady}destroy(){super.destroy(),this.clearHighlightedRow(),this.started=!1,this.rootNode=null,this.nodeManager=null,this.rowDataTransactionBatch=null,this.lastHighlightedRow=null,this.orderedStages=vW,this.rowsToDisplay=vW}onRowHeightChangedDebounced(){this.onRowHeightChanged_debounced()}};function ZXe(e){e.expansionSvc?.onGroupExpandedOrCollapsed()}function JXe(e,t){const n=ja(e);n&&((!t||t==="everything")&&(t="group"),n.refreshModel({step:t,keepRenderedRows:!0,animate:!e.gos.get("suppressAnimationFrame")}))}function eQe(e){return ja(e)?.isEmpty()??!0}function tQe(e,t){ja(e)?.forEachLeafNode(t)}function nQe(e,t){ja(e)?.forEachNodeAfterFilter(t)}function iQe(e,t){ja(e)?.forEachNodeAfterFilterAndSort(t)}function rQe(e){if(e.rowAutoHeight?.active){de(3);return}ja(e)?.resetRowHeights()}function sQe(e,t){return e.frameworkOverrides.wrapIncoming(()=>ja(e)?.updateRowData(t))}function oQe(e,t,n){e.frameworkOverrides.wrapIncoming(()=>ja(e)?.batchUpdateRowData(t,n))}function aQe(e){e.frameworkOverrides.wrapIncoming(()=>ja(e)?.flushAsyncTransactions())}function lQe(e){return e.selectionSvc?.getBestCostNodeSelection()}var uQe={moduleName:"ClientSideRowModel",version:we,rowModels:["clientSide"],beans:[qXe,QXe,KXe],dependsOn:[Qte]},cQe={moduleName:"ClientSideRowModelApi",version:we,apiFunctions:{onGroupExpandedOrCollapsed:ZXe,refreshClientSideRowModel:JXe,isRowDataEmpty:eQe,forEachLeafNode:tQe,forEachNodeAfterFilter:nQe,forEachNodeAfterFilterAndSort:iQe,resetRowHeights:rQe,applyTransaction:sQe,applyTransactionAsync:oQe,flushAsyncTransactions:aQe,getBestCostNodeSelection:lQe},dependsOn:[HXe]},dQe=class extends Z{constructor(){super(...arguments),this.beanName="gridSerializer"}wireBeans(e){this.visibleCols=e.visibleCols,this.colModel=e.colModel,this.rowModel=e.rowModel,this.pinnedRowModel=e.pinnedRowModel}serialize(e,t={}){const{allColumns:n,columnKeys:i,skipRowGroups:r,exportRowNumbers:s}=t,o=this.getColumnsToExport({allColumns:n,skipRowGroups:r,columnKeys:i,exportRowNumbers:s});return[this.prepareSession(o),this.prependContent(t),this.exportColumnGroups(t,o),this.exportHeaders(t,o),this.processPinnedTopRows(t,o),this.processRows(t,o),this.processPinnedBottomRows(t,o),this.appendContent(t)].reduce((a,l)=>l(a),e).parse()}processRow(e,t,n,i){const r=t.shouldRowBeSkipped||(()=>!1),o=t.rowPositions!=null||!!t.onlySelected,a=this.gos.get("groupHideOpenParents")&&!o,l=this.colModel.isPivotMode()?i.leafGroup:!i.group,u=!!i.footer,c=i.allChildrenCount===1&&i.childrenAfterGroup?.length===1&&Q5e(this.gos,i);if(!l&&!u&&(t.skipRowGroups||c||a)||t.onlySelected&&!i.isSelected()||t.skipPinnedTop&&i.rowPinned==="top"||t.skipPinnedBottom&&i.rowPinned==="bottom"||i.level===-1&&!l&&!u||r(ze(this.gos,{node:i})))return;const p=e.onNewBodyRow(i);if(n.forEach((g,m)=>{p.onColumn(g,m,i)}),t.getCustomContentBelowRow){const g=t.getCustomContentBelowRow(ze(this.gos,{node:i}));g&&e.addCustomContent(g)}}appendContent(e){return t=>{const n=e.appendContent;return n&&t.addCustomContent(n),t}}prependContent(e){return t=>{const n=e.prependContent;return n&&t.addCustomContent(n),t}}prepareSession(e){return t=>(t.prepare(e),t)}exportColumnGroups(e,t){return n=>{if(!e.skipColumnGroupHeaders){const i=new Wee,{colGroupSvc:r}=this.beans,s=r?r.createColumnGroups({columns:t,idCreator:i,pinned:null,isStandaloneStructure:!0}):t;this.recursivelyAddHeaderGroups(s,n,e.processGroupHeaderCallback)}return n}}exportHeaders(e,t){return n=>{if(!e.skipColumnHeaders){const i=n.onNewHeaderRow();t.forEach((r,s)=>{i.onColumn(r,s,void 0)})}return n}}processPinnedTopRows(e,t){return n=>{const i=this.processRow.bind(this,n,e,t);return e.rowPositions?e.rowPositions.filter(r=>r.rowPinned==="top").sort((r,s)=>r.rowIndex-s.rowIndex).map(r=>this.pinnedRowModel?.getPinnedTopRow(r.rowIndex)).forEach(i):this.pinnedRowModel?.forEachPinnedRow("top",i),n}}processRows(e,t){return n=>{const i=this.rowModel,r=tr(this.gos),s=bg(this.gos),o=!r&&e.onlySelected,a=this.processRow.bind(this,n,e,t),{exportedRows:l="filteredAndSorted"}=e;if(e.rowPositions)return e.rowPositions.filter(u=>u.rowPinned==null).sort((u,c)=>u.rowIndex-c.rowIndex).map(u=>i.getRow(u.rowIndex)).forEach(a),n;if(this.colModel.isPivotMode())return r?i.forEachPivotNode(a,!0,l==="filteredAndSorted"):s?i.forEachNodeAfterFilterAndSort(a,!0):i.forEachNode(a),n;if(e.onlySelectedAllPages||o){const u=this.beans.selectionSvc?.getSelectedNodes()??[];this.replicateSortedOrder(u),u.forEach(a)}else l==="all"?i.forEachNode(a):r||s?i.forEachNodeAfterFilterAndSort(a,!0):i.forEachNode(a);return n}}replicateSortedOrder(e){const{sortSvc:t,rowNodeSorter:n}=this.beans;if(!t||!n)return;const i=t.getSortOptions(),r=(s,o)=>s.rowIndex!=null&&o.rowIndex!=null?s.rowIndex-o.rowIndex:s.level===o.level?s.parent?.id===o.parent?.id?n.compareRowNodes(i,{rowNode:s,currentPos:s.rowIndex??-1},{rowNode:o,currentPos:o.rowIndex??-1}):r(s.parent,o.parent):s.level>o.level?r(s.parent,o):r(s,o.parent);e.sort(r)}processPinnedBottomRows(e,t){return n=>{const i=this.processRow.bind(this,n,e,t);return e.rowPositions?e.rowPositions.filter(r=>r.rowPinned==="bottom").sort((r,s)=>r.rowIndex-s.rowIndex).map(r=>this.pinnedRowModel?.getPinnedBottomRow(r.rowIndex)).forEach(i):this.pinnedRowModel?.forEachPinnedRow("bottom",i),n}}getColumnsToExport(e){const{allColumns:t=!1,skipRowGroups:n=!1,exportRowNumbers:i=!1,columnKeys:r}=e,{colModel:s,gos:o,visibleCols:a}=this,l=s.isPivotMode(),u=h=>Ul(h)?!1:!Gp(h)||i;if(r&&r.length)return s.getColsForKeys(r).filter(u);const c=o.get("treeData");let d=[];return t&&!l?d=s.getCols():d=a.allCols,d=d.filter(h=>u(h)&&(n&&!c?!gN(h):!0)),d}recursivelyAddHeaderGroups(e,t,n){const i=[];e.forEach(r=>{const s=r;s.getChildren&&s.getChildren().forEach(o=>i.push(o))}),e.length>0&&dn(e[0])&&this.doAddHeaderHeader(t,e,n),i&&i.length>0&&this.recursivelyAddHeaderGroups(i,t,n)}doAddHeaderHeader(e,t,n){const i=e.onNewHeaderGroupingRow();let r=0;t.forEach(s=>{const o=s;let a;n?a=n(ze(this.gos,{columnGroup:o})):a=this.beans.colNames.getDisplayNameForColumnGroup(o,"header");const l=o.getLeafColumns().reduce((u,c,d,h)=>{let p=Lt(u);return c.getColumnGroupShow()==="open"?(!p||p[1]!=null)&&(p=[d],u.push(p)):p&&p[1]==null&&(p[1]=d-1),d===h.length-1&&p&&p[1]==null&&(p[1]=d),u},[]);i.onColumn(o,a||"",r++,o.getLeafColumns().length-1,l)})}},hQe={moduleName:"SharedExport",version:we,beans:[dQe]},t4=`\r
`,fQe=class extends nKe{constructor(e){super(e),this.isFirstLine=!0,this.result="";const{suppressQuotes:t,columnSeparator:n}=e;this.suppressQuotes=t,this.columnSeparator=n}addCustomContent(e){e&&(typeof e=="string"?(/^\s*\n/.test(e)||this.beginNewLine(),e=e.replace(/\r?\n/g,t4),this.result+=e):e.forEach(t=>{this.beginNewLine(),t.forEach((n,i)=>{i!==0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(n.data.value||""),n.mergeAcross&&this.appendEmptyCells(n.mergeAcross)})}))}onNewHeaderGroupingRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}}onNewHeaderGroupingRowColumn(e,t,n,i){n!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(t),this.appendEmptyCells(i)}appendEmptyCells(e){for(let t=1;t<=e;t++)this.result+=this.columnSeparator+this.putInQuotes("")}onNewHeaderRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}}onNewHeaderRowColumn(e,t){t!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(e))}onNewBodyRow(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}}onNewBodyRowColumn(e,t,n){t!=0&&(this.result+=this.columnSeparator);const i=this.extractRowCellValue(e,t,t,"csv",n);this.result+=this.putInQuotes(i.valueFormatted??i.value)}putInQuotes(e){if(this.suppressQuotes)return e;if(e==null)return'""';let t;return typeof e=="string"?t=e:typeof e.toString=="function"?t=e.toString():(de(53),t=""),'"'+t.replace(/"/g,'""')+'"'}parse(){return this.result}beginNewLine(){this.isFirstLine||(this.result+=t4),this.isFirstLine=!1}},pQe=class extends tKe{constructor(){super(...arguments),this.beanName="csvCreator"}wireBeans(e){this.colModel=e.colModel,this.colNames=e.colNames,this.rowGroupColsSvc=e.rowGroupColsSvc,this.valueSvc=e.valueSvc}getMergedParams(e){const t=this.gos.get("defaultCsvExportParams");return Object.assign({},t,e)}export(e){if(this.isExportSuppressed()){de(51);return}const t=this.getMergedParams(e),n=this.getData(t),i=new Blob(["\uFEFF",n],{type:"text/plain"}),r=typeof t.fileName=="function"?t.fileName(ze(this.gos,{})):t.fileName;iKe(this.getFileName(r),i)}exportDataAsCsv(e){this.export(e)}getDataAsCsv(e,t=!1){const n=t?Object.assign({},e):this.getMergedParams(e);return this.getData(n)}getDefaultFileExtension(){return"csv"}createSerializingSession(e){const{colModel:t,colNames:n,rowGroupColsSvc:i,valueSvc:r,gos:s}=this,{processCellCallback:o,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:u,suppressQuotes:c,columnSeparator:d}=e;return new fQe({colModel:t,colNames:n,valueSvc:r,gos:s,processCellCallback:o||void 0,processHeaderCallback:a||void 0,processGroupHeaderCallback:l||void 0,processRowGroupCallback:u||void 0,suppressQuotes:c||!1,columnSeparator:d||",",rowGroupColsSvc:i})}isExportSuppressed(){return this.gos.get("suppressCsvExport")}};function gQe(e,t){return e.csvCreator?.getDataAsCsv(t)}function mQe(e,t){e.csvCreator?.exportDataAsCsv(t)}var vQe={moduleName:"CsvExport",version:we,beans:[pQe],apiFunctions:{getDataAsCsv:gQe,exportDataAsCsv:mQe},dependsOn:[hQe]},CQe=class extends Z{constructor(e,t,n){super(),this.id=e,this.parentCache=t,this.params=n,this.state="needsLoading",this.version=0,this.startRow=e*n.blockSize,this.endRow=this.startRow+n.blockSize}load(){this.state="loading",this.loadFromDatasource()}setStateWaitingToLoad(){this.version++,this.state="needsLoading"}pageLoadFailed(e){this.isRequestMostRecentAndLive(e)&&(this.state="failed"),this.dispatchLocalEvent({type:"loadComplete"})}pageLoaded(e,t,n){this.successCommon(e,{rowData:t,rowCount:n})}isRequestMostRecentAndLive(e){const t=e===this.version,n=this.isAlive();return t&&n}successCommon(e,t){this.dispatchLocalEvent({type:"loadComplete"}),this.isRequestMostRecentAndLive(e)&&(this.state="loaded",this.processServerResult(t))}postConstruct(){this.rowNodes=[];const{params:{blockSize:e,rowHeight:t},startRow:n,beans:i,rowNodes:r}=this;for(let s=0;s<e;s++){const o=n+s,a=new Vp(i);a.setRowHeight(t),a.uiLevel=0,a.setRowIndex(o),a.setRowTop(t*o),r.push(a)}}getBlockStateJson(){const{id:e,startRow:t,endRow:n,state:i}=this;return{id:""+e,state:{blockNumber:e,startRow:t,endRow:n,pageStatus:i}}}setDataAndId(e,t,n){Ce(t)?e.setDataAndId(t,n.toString()):e.setDataAndId(void 0,void 0)}loadFromDatasource(){const e=this.createLoadParams();if(Xt(this.params.datasource.getRows)){de(90);return}window.setTimeout(()=>{this.params.datasource.getRows(e)},0)}createLoadParams(){const{startRow:e,endRow:t,version:n,params:{sortModel:i,filterModel:r},gos:s}=this;return{startRow:e,endRow:t,successCallback:this.pageLoaded.bind(this,n),failCallback:this.pageLoadFailed.bind(this,n),sortModel:i,filterModel:r,context:ze(s,{}).context}}forEachNode(e,t,n){this.rowNodes.forEach((i,r)=>{this.startRow+r<n&&e(i,t.value++)})}getRow(e,t=!1){t||(this.lastAccessed=this.params.lastAccessedSequence.value++);const n=e-this.startRow;return this.rowNodes[n]}processServerResult(e){const{rowNodes:t,beans:n}=this;t.forEach((r,s)=>{const o=e.rowData?e.rowData[s]:void 0;!r.id&&r.alreadyRendered&&o&&(t[s]=new Vp(n),t[s].setRowIndex(r.rowIndex),t[s].setRowTop(r.rowTop),t[s].setRowHeight(r.rowHeight),r.clearRowTopAndRowIndex()),this.setDataAndId(t[s],o,this.startRow+s)});const i=e.rowCount!=null&&e.rowCount>=0?e.rowCount:void 0;this.parentCache.pageLoaded(this,i)}destroy(){this.rowNodes.forEach(e=>{e.clearRowTopAndRowIndex()}),super.destroy()}},yQe=2,wQe=class extends Z{constructor(e){super(),this.params=e,this.lastRowIndexKnown=!1,this.blocks={},this.blockCount=0,this.rowCount=e.initialRowCount}getRow(e,t=!1){const n=Math.floor(e/this.params.blockSize);let i=this.blocks[n];if(!i){if(t)return;i=this.createBlock(n)}return i.getRow(e)}createBlock(e){const t=this.params,n=this.createBean(new CQe(e,this,t));return this.blocks[n.id]=n,this.blockCount++,this.purgeBlocksIfNeeded(n),t.rowNodeBlockLoader.addBlock(n),n}refreshCache(){if(this.blockCount==0){this.purgeCache();return}this.getBlocksInOrder().forEach(t=>t.setStateWaitingToLoad()),this.params.rowNodeBlockLoader.checkBlockToLoad()}destroy(){this.getBlocksInOrder().forEach(e=>this.destroyBlock(e)),super.destroy()}getRowCount(){return this.rowCount}isLastRowIndexKnown(){return this.lastRowIndexKnown}pageLoaded(e,t){this.isAlive()&&(fc(this.gos,`InfiniteCache - onPageLoaded: page = ${e.id}, lastRow = ${t}`),this.checkRowCount(e,t),this.onCacheUpdated())}purgeBlocksIfNeeded(e){const t=this.getBlocksInOrder().filter(o=>o!=e),n=(o,a)=>a.lastAccessed-o.lastAccessed;t.sort(n);const i=this.params.maxBlocksInCache>0,r=i?this.params.maxBlocksInCache-1:null,s=yQe-1;t.forEach((o,a)=>{const l=o.state==="needsLoading"&&a>=s,u=i?a>=r:!1;if(l||u){if(this.isBlockCurrentlyDisplayed(o)||this.isBlockFocused(o))return;this.removeBlockFromCache(o)}})}isBlockFocused(e){const t=this.beans.focusSvc.getFocusCellToUseAfterRefresh();if(!t||t.rowPinned!=null)return!1;const{startRow:n,endRow:i}=e;return t.rowIndex>=n&&t.rowIndex<i}isBlockCurrentlyDisplayed(e){const{startRow:t,endRow:n}=e;return this.beans.rowRenderer.isRangeInRenderedViewport(t,n-1)}removeBlockFromCache(e){e&&this.destroyBlock(e)}checkRowCount(e,t){if(typeof t=="number"&&t>=0)this.rowCount=t,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){const{blockSize:n,overflowSize:i}=this.params,s=(e.id+1)*n+i;this.rowCount<s&&(this.rowCount=s)}}setRowCount(e,t){this.rowCount=e,Ce(t)&&(this.lastRowIndexKnown=t),this.lastRowIndexKnown||this.rowCount%this.params.blockSize===0&&this.rowCount++,this.onCacheUpdated()}forEachNodeDeep(e){const t={value:0};this.getBlocksInOrder().forEach(n=>n.forEachNode(e,t,this.rowCount))}getBlocksInOrder(){const e=(n,i)=>n.id-i.id;return Object.values(this.blocks).sort(e)}destroyBlock(e){delete this.blocks[e.id],this.destroyBean(e),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(e)}onCacheUpdated(){this.isAlive()&&(this.destroyAllBlocksPastVirtualRowCount(),this.eventSvc.dispatchEvent({type:"storeUpdated"}))}destroyAllBlocksPastVirtualRowCount(){const e=[];this.getBlocksInOrder().forEach(t=>{t.id*this.params.blockSize>=this.rowCount&&e.push(t)}),e.length>0&&e.forEach(t=>this.destroyBlock(t))}purgeCache(){this.getBlocksInOrder().forEach(e=>this.removeBlockFromCache(e)),this.lastRowIndexKnown=!1,this.rowCount===0&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()}getRowNodesInRange(e,t){const n=[];let i=-1,r=!1;const s={value:0};let o=!1;return this.getBlocksInOrder().forEach(l=>{if(!o){if(r&&i+1!==l.id){o=!0;return}i=l.id,l.forEachNode(u=>{const c=u===e||u===t;(r||c)&&n.push(u),c&&(r=!r)},s,this.rowCount)}}),o||r?[]:n}},bQe=class extends Z{constructor(){super(...arguments),this.beanName="rowModel"}getRowBounds(e){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*e}}ensureRowHeightsValid(){return!1}postConstruct(){this.gos.get("rowModelType")==="infinite"&&(this.rowHeight=zd(this.beans),this.addEventListeners(),this.addDestroyFunc(()=>this.destroyCache()))}start(){this.setDatasource(this.gos.get("datasource"))}destroy(){this.destroyDatasource(),super.destroy()}destroyDatasource(){this.datasource&&(this.destroyBean(this.datasource),this.beans.rowRenderer.datasourceChanged(),this.datasource=null)}addEventListeners(){this.addManagedEventListeners({filterChanged:this.reset.bind(this),sortChanged:this.reset.bind(this),newColumnsLoaded:this.onColumnEverything.bind(this),storeUpdated:this.dispatchModelUpdatedEvent.bind(this)}),this.addManagedPropertyListener("datasource",()=>this.setDatasource(this.gos.get("datasource"))),this.addManagedPropertyListener("cacheBlockSize",()=>this.resetCache()),this.addManagedPropertyListener("rowHeight",()=>{this.rowHeight=zd(this.beans),this.cacheParams.rowHeight=this.rowHeight,this.updateRowHeights()})}onColumnEverything(){let e;this.cacheParams?e=!b0(this.cacheParams.sortModel,this.beans.sortSvc?.getSortModel()??[]):e=!0,e&&this.reset()}getType(){return"infinite"}setDatasource(e){this.destroyDatasource(),this.datasource=e,e&&this.reset()}isEmpty(){return!this.infiniteCache}isRowsToRender(){return!!this.infiniteCache}getNodesInRangeForSelection(e,t){return this.infiniteCache?.getRowNodesInRange(e,t)??[]}reset(){if(!this.datasource)return;$p(this.gos)!=null||this.beans.selectionSvc?.reset("rowDataChanged"),this.resetCache()}dispatchModelUpdatedEvent(){this.eventSvc.dispatchEvent({type:"modelUpdated",newPage:!1,newPageSize:!1,newData:!1,keepRenderedRows:!0,animate:!1})}resetCache(){this.destroyCache();const e=this.beans,{filterManager:t,sortSvc:n,rowNodeBlockLoader:i,eventSvc:r,gos:s}=e;this.cacheParams={datasource:this.datasource,filterModel:t?.getFilterModel()??{},sortModel:n?.getSortModel()??[],rowNodeBlockLoader:i,initialRowCount:s.get("infiniteInitialRowCount"),maxBlocksInCache:s.get("maxBlocksInCache"),rowHeight:zd(e),overflowSize:s.get("cacheOverflowSize"),blockSize:s.get("cacheBlockSize"),lastAccessedSequence:{value:0}},this.infiniteCache=this.createBean(new wQe(this.cacheParams)),r.dispatchEventOnce({type:"rowCountReady"}),this.dispatchModelUpdatedEvent()}updateRowHeights(){this.forEachNode(e=>{e.setRowHeight(this.rowHeight),e.setRowTop(this.rowHeight*e.rowIndex)}),this.dispatchModelUpdatedEvent()}destroyCache(){this.infiniteCache=this.destroyBean(this.infiniteCache)}getRow(e){const t=this.infiniteCache;if(t&&!(e>=t.getRowCount()))return t.getRow(e)}getRowNode(e){let t;return this.forEachNode(n=>{n.id===e&&(t=n)}),t}forEachNode(e){this.infiniteCache?.forEachNodeDeep(e)}getTopLevelRowCount(){return this.getRowCount()}getTopLevelRowDisplayedIndex(e){return e}getRowIndexAtPixel(e){if(this.rowHeight!==0){const t=Math.floor(e/this.rowHeight),n=this.getRowCount()-1;return t>n?n:t}return 0}getRowCount(){return this.infiniteCache?this.infiniteCache.getRowCount():0}isRowPresent(e){return!!this.getRowNode(e.id)}refreshCache(){this.infiniteCache?.refreshCache()}purgeCache(){this.infiniteCache?.purgeCache()}isLastRowIndexKnown(){return this.infiniteCache?.isLastRowIndexKnown()??!1}setRowCount(e,t){this.infiniteCache?.setRowCount(e,t)}};function SQe(e){XR(e)?.refreshCache()}function xQe(e){XR(e)?.purgeCache()}function RQe(e){return XR(e)?.getRowCount()}var EQe=class extends Z{constructor(){super(...arguments),this.beanName="rowNodeBlockLoader",this.activeBlockLoadsCount=0,this.blocks=[],this.active=!0}postConstruct(){this.maxConcurrentRequests=Z5e(this.gos);const e=this.gos.get("blockLoadDebounceMillis");e&&e>0&&(this.checkBlockToLoadDebounce=yi(this,this.performCheckBlocksToLoad.bind(this),e))}addBlock(e){this.blocks.push(e),e.addEventListener("loadComplete",this.loadComplete.bind(this)),this.checkBlockToLoad()}removeBlock(e){_o(this.blocks,e)}destroy(){super.destroy(),this.active=!1}loadComplete(){this.activeBlockLoadsCount--,this.checkBlockToLoad()}checkBlockToLoad(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()}performCheckBlocksToLoad(){if(!this.active)return;if(this.printCacheStatus(),this.maxConcurrentRequests!=null&&this.activeBlockLoadsCount>=this.maxConcurrentRequests){fc(this.gos,"RowNodeBlockLoader - checkBlockToLoad: max loads exceeded");return}const e=this.maxConcurrentRequests!=null?this.maxConcurrentRequests-this.activeBlockLoadsCount:1,t=this.blocks.filter(n=>n.state==="needsLoading").slice(0,e);this.activeBlockLoadsCount+=t.length,t.forEach(n=>n.load()),this.printCacheStatus()}getBlockState(){const e={};return this.blocks.forEach(t=>{const{id:n,state:i}=t.getBlockStateJson();e[n]=i}),e}printCacheStatus(){fc(this.gos,`RowNodeBlockLoader - printCacheStatus: activePageLoadsCount = ${this.activeBlockLoadsCount}, blocks = ${JSON.stringify(this.getBlockState())}`)}},FQe={moduleName:"InfiniteRowModelCore",version:we,rowModels:["infinite"],beans:[bQe,EQe]},AQe={moduleName:"InfiniteRowModel",version:we,apiFunctions:{refreshInfiniteCache:SQe,purgeInfiniteCache:xQe,getInfiniteRowCount:RQe},dependsOn:[FQe,VXe]},DQe="",kQe="",PQe={tag:"span",children:[{tag:"span",ref:"eDelta",cls:"ag-value-change-delta"},{tag:"span",ref:"eValue",cls:"ag-value-change-value"}]},MQe=class extends At{constructor(){super(PQe),this.eValue=ve,this.eDelta=ve,this.refreshCount=0}init(e){this.refresh(e,!0)}showDelta(e,t){const n=Math.abs(t),i=e.formatValue(n),r=Ce(i)?i:n,s=t>=0,o=this.eDelta;s?o.textContent=DQe+r:o.textContent=kQe+r,o.classList.toggle("ag-value-change-delta-up",s),o.classList.toggle("ag-value-change-delta-down",!s)}setTimerToRemoveDelta(){this.refreshCount++;const e=this.refreshCount;this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.hideDeltaValue()},2e3)})}hideDeltaValue(){this.eValue.classList.remove("ag-value-change-value-highlight"),Gi(this.eDelta)}refresh(e,t=!1){const{value:n,valueFormatted:i}=e,{eValue:r,lastValue:s,beans:o}=this;if(n===s||(Ce(i)?r.textContent=i:Ce(n)?r.textContent=n:Gi(r),o.filterManager?.isSuppressFlashingCellsBecauseFiltering()))return!1;if(typeof n=="number"&&typeof s=="number"){const a=n-s;this.showDelta(e,a)}return s&&r.classList.add("ag-value-change-value-highlight"),t||this.setTimerToRemoveDelta(),this.lastValue=n,!0}},TQe=".ag-value-slide-out{opacity:1}:where(.ag-ltr) .ag-value-slide-out{margin-right:5px;transition:opacity 3s,margin-right 3s}:where(.ag-rtl) .ag-value-slide-out{margin-left:5px;transition:opacity 3s,margin-left 3s}:where(.ag-ltr,.ag-rtl) .ag-value-slide-out{transition-timing-function:linear}.ag-value-slide-out-end{opacity:0}:where(.ag-ltr) .ag-value-slide-out-end{margin-right:10px}:where(.ag-rtl) .ag-value-slide-out-end{margin-left:10px}",IQe={tag:"span",children:[{tag:"span",ref:"eCurrent",cls:"ag-value-slide-current"}]},_Qe=class extends At{constructor(){super(IQe),this.eCurrent=ve,this.refreshCount=0,this.registerCSS(TQe)}init(e){this.refresh(e,!0)}addSlideAnimation(){this.refreshCount++;const e=this.refreshCount;this.ePrevious&&this.getGui().removeChild(this.ePrevious);const{beans:t,eCurrent:n}=this,i=Sn({tag:"span",cls:"ag-value-slide-previous ag-value-slide-out"});this.ePrevious=i,i.textContent=n.textContent,this.getGui().insertBefore(i,n),t.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.ePrevious.classList.add("ag-value-slide-out-end")},50),window.setTimeout(()=>{e===this.refreshCount&&(this.getGui().removeChild(this.ePrevious),this.ePrevious=null)},3e3)})}refresh(e,t=!1){let n=e.value;if(Xt(n)&&(n=""),n===this.lastValue||this.beans.filterManager?.isSuppressFlashingCellsBecauseFiltering())return!1;t||this.addSlideAnimation(),this.lastValue=n;const i=this.eCurrent;return Ce(e.valueFormatted)?i.textContent=e.valueFormatted:Ce(e.value)?i.textContent=n:Gi(i),!0}},OQe=class extends Z{constructor(){super(...arguments),this.beanName="cellFlashSvc"}onFlashCells(e,t){if(!e.comp)return;const n=s4e(e.cellPosition);t.cells[n]&&this.animateCell(e,"highlight")}flashCell(e,t){this.animateCell(e,"data-changed",t?.flashDuration,t?.fadeDuration)}animateCell(e,t,n,i){const r=e.comp;if(!r)return;const{gos:s}=this;if(n||(n=s.get("cellFlashDuration")),n===0)return;Ce(i)||(i=s.get("cellFadeDuration"));const o=`ag-cell-${t}`,a=`ag-cell-${t}-animation`;r.addOrRemoveCssClass(o,!0),r.addOrRemoveCssClass(a,!1);const l=e.eGui;this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e.isAlive()&&(r.addOrRemoveCssClass(o,!1),r.addOrRemoveCssClass(a,!0),l.style.transition=`background-color ${i}ms`,window.setTimeout(()=>{e.isAlive()&&(r.addOrRemoveCssClass(a,!1),l.style.transition="")},i))},n)})}};function LQe(e,t={}){const{cellFlashSvc:n}=e;n&&e.frameworkOverrides.wrapIncoming(()=>{e.rowRenderer.getCellCtrls(t.rowNodes,t.columns).forEach(i=>n.flashCell(i,t))})}var NQe={moduleName:"HighlightChanges",version:we,beans:[OQe],userComponents:{agAnimateShowChangeCellRenderer:MQe,agAnimateSlideCellRenderer:_Qe},apiFunctions:{flashCells:LQe}};function $Qe(e){return e.stateSvc?.getState()??{}}function BQe(e){switch(e={...e},e.version||(e.version="32.1.0"),e.version){case"32.1.0":e=GQe(e)}return e}function GQe(e){return e.cellSelection=zQe(e,"rangeSelection"),e}function zQe(e,t){if(e&&typeof e=="object")return e[t]}var HQe=class extends Z{constructor(){super(...arguments),this.beanName="stateSvc",this.updateRowGroupExpansionStateTimer=0,this.suppressEvents=!0,this.queuedUpdateSources=new Set,this.dispatchStateUpdateEventDebounced=yi(this,()=>this.dispatchQueuedStateUpdateEvents(),0),this.onRowGroupOpenedDebounced=yi(this,()=>{this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState())},0),this.onRowSelectedDebounced=yi(this,()=>{this.staleStateKeys.delete("rowSelection"),this.updateCachedState("rowSelection",this.getRowSelectionState())},0),this.staleStateKeys=new Set}postConstruct(){this.isClientSideRowModel=tr(this.gos),this.cachedState=this.getInitialState(),this.setCachedStateValue("version",we);const e=this.suppressEventsAndDispatchInitEvent.bind(this);this.beans.ctrlsSvc.whenReady(this,()=>e(()=>this.setupStateOnGridReady()));const[t,n,i]=this.addManagedEventListeners({newColumnsLoaded:({source:r})=>{r==="gridInitializing"&&(t(),e(()=>this.setupStateOnColumnsInitialised()))},rowCountReady:()=>{n?.(),e(()=>this.setupStateOnRowCountReady())},firstDataRendered:()=>{i?.(),e(()=>this.setupStateOnFirstDataRendered())}})}destroy(){super.destroy(),clearTimeout(this.updateRowGroupExpansionStateTimer),this.queuedUpdateSources.clear()}getInitialState(){return BQe(this.gos.get("initialState")??{})}getState(){return this.staleStateKeys.size&&this.refreshStaleState(),this.cachedState}setupStateOnGridReady(){const e=()=>this.updateCachedState("sideBar",this.getSideBarState());e(),this.addManagedEventListeners({toolPanelVisibleChanged:e,sideBarUpdated:e})}setupStateOnColumnsInitialised(){const e=this.getInitialState();this.setColumnState(e),this.setColumnGroupState(e),this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","pivot","rowGroup","sort"]),this.updateCachedState("columnGroup",this.getColumnGroupState());const t=n=>()=>this.updateColumnState([n]);this.addManagedEventListeners({columnValueChanged:t("aggregation"),columnMoved:t("columnOrder"),columnPinned:t("columnPinning"),columnResized:t("columnSizing"),columnVisible:t("columnVisibility"),columnPivotChanged:t("pivot"),columnPivotModeChanged:t("pivot"),columnRowGroupChanged:t("rowGroup"),sortChanged:t("sort"),newColumnsLoaded:()=>this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","rowGroup","sort"]),columnGroupOpened:()=>this.updateCachedState("columnGroup",this.getColumnGroupState())})}setupStateOnRowCountReady(){const{filter:e,rowGroupExpansion:t,rowSelection:n,pagination:i}=this.getInitialState();e&&this.setFilterState(e),t&&this.setRowGroupExpansionState(t),n&&this.setRowSelectionState(n),i&&this.setPaginationState(i);const r=this.updateCachedState.bind(this);r("filter",this.getFilterState()),r("rowGroupExpansion",this.getRowGroupExpansionState()),r("rowSelection",this.getRowSelectionState()),r("pagination",this.getPaginationState());const s=()=>{this.updateRowGroupExpansionStateTimer=0,r("rowGroupExpansion",this.getRowGroupExpansionState())};this.addManagedEventListeners({filterChanged:()=>r("filter",this.getFilterState()),rowGroupOpened:()=>this.onRowGroupOpenedDebounced(),expandOrCollapseAll:s,columnRowGroupChanged:s,rowDataUpdated:()=>{this.gos.get("groupDefaultExpanded")!==0&&(this.updateRowGroupExpansionStateTimer||(this.updateRowGroupExpansionStateTimer=setTimeout(s)))},selectionChanged:()=>{this.staleStateKeys.add("rowSelection"),this.onRowSelectedDebounced()},paginationChanged:o=>{(o.newPage||o.newPageSize)&&r("pagination",this.getPaginationState())}})}setupStateOnFirstDataRendered(){const{scroll:e,cellSelection:t,focusedCell:n,columnOrder:i}=this.getInitialState();n&&this.setFocusedCellState(n),t&&this.setCellSelectionState(t),e&&this.setScrollState(e),this.setColumnPivotState(!!i?.orderedColIds);const r=this.updateCachedState.bind(this);r("sideBar",this.getSideBarState()),r("focusedCell",this.getFocusedCellState());const s=this.getRangeSelectionState();r("rangeSelection",s),r("cellSelection",s),r("scroll",this.getScrollState()),this.addManagedEventListeners({cellFocused:()=>r("focusedCell",this.getFocusedCellState()),cellSelectionChanged:o=>{if(o.finished){const a=this.getRangeSelectionState();r("rangeSelection",a),r("cellSelection",a)}},bodyScrollEnd:()=>r("scroll",this.getScrollState())})}getColumnState(){const e=this.beans,t=e.colModel.isPivotMode(),n=[],i=[],r=[],s=[],o=[],a=[],l=[],u=[],c=[];let d=0;const h=E0(e);for(let p=0;p<h.length;p++){const{colId:g,sort:m,sortIndex:C,rowGroup:y,rowGroupIndex:b,aggFunc:S,pivot:x,pivotIndex:E,pinned:A,hide:F,width:P,flex:D}=h[p];c.push(g),m&&(n[C??d++]={colId:g,sort:m}),y&&(i[b??0]=g),typeof S=="string"&&r.push({colId:g,aggFunc:S}),x&&(s[E??0]=g),A&&(A==="right"?a:o).push(g),F&&l.push(g),(D!=null||P)&&u.push({colId:g,flex:D??void 0,width:P})}return{sort:n.length?{sortModel:n}:void 0,rowGroup:i.length?{groupColIds:i}:void 0,aggregation:r.length?{aggregationModel:r}:void 0,pivot:s.length||t?{pivotMode:t,pivotColIds:s}:void 0,columnPinning:o.length||a.length?{leftColIds:o,rightColIds:a}:void 0,columnVisibility:l.length?{hiddenColIds:l}:void 0,columnSizing:u.length?{columnSizingModel:u}:void 0,columnOrder:c.length?{orderedColIds:c}:void 0}}setColumnState(e){const{sort:t,rowGroup:n,aggregation:i,pivot:r,columnPinning:s,columnVisibility:o,columnSizing:a,columnOrder:l,partialColumnState:u}=e,c={},d=C=>{let y=c[C];return y||(y={colId:C},c[C]=y,y)},h=u?{}:{sort:null,sortIndex:null,rowGroup:null,rowGroupIndex:null,aggFunc:null,pivot:null,pivotIndex:null,pinned:null,hide:null,flex:null};t&&(t.sortModel.forEach(({colId:C,sort:y},b)=>{const S=d(C);S.sort=y,S.sortIndex=b}),h.sort=null,h.sortIndex=null),n&&(n.groupColIds.forEach((C,y)=>{const b=d(C);b.rowGroup=!0,b.rowGroupIndex=y}),h.rowGroup=null,h.rowGroupIndex=null),i&&(i.aggregationModel.forEach(({colId:C,aggFunc:y})=>{d(C).aggFunc=y}),h.aggFunc=null),r&&(r.pivotColIds.forEach((C,y)=>{const b=d(C);b.pivot=!0,b.pivotIndex=y}),this.gos.updateGridOptions({options:{pivotMode:r.pivotMode},source:"gridInitializing"}),h.pivot=null,h.pivotIndex=null),s&&(s.leftColIds.forEach(C=>{d(C).pinned="left"}),s.rightColIds.forEach(C=>{d(C).pinned="right"}),h.pinned=null),o&&(o.hiddenColIds.forEach(C=>{d(C).hide=!0}),h.hide=null),a&&(a.columnSizingModel.forEach(({colId:C,flex:y,width:b})=>{const S=d(C);S.flex=y??null,S.width=b}),h.flex=null);const p=l?.orderedColIds,g=!!p?.length,m=g?p.map(C=>d(C)):Object.values(c);m.length&&(this.columnStates=m,os(this.beans,{state:m,applyOrder:g,defaultState:h},"gridInitializing"))}setColumnPivotState(e){const t=this.columnStates;this.columnStates=void 0;const n=this.columnGroupStates;this.columnGroupStates=void 0;const i=this.beans,{pivotResultCols:r,colGroupSvc:s}=i;if(r?.isPivotResultColsPresent()){if(t){const o=[];for(const a of t)r.getPivotResultCol(a.colId)&&o.push(a);os(i,{state:o,applyOrder:e},"gridInitializing")}n&&s?.setColumnGroupState(n,"gridInitializing")}}getColumnGroupState(){const e=this.beans.colGroupSvc;if(!e)return;const t=e.getColumnGroupState(),n=[];return t.forEach(({groupId:i,open:r})=>{r&&n.push(i)}),n.length?{openColumnGroupIds:n}:void 0}setColumnGroupState(e){const t=this.beans.colGroupSvc;if(!Object.prototype.hasOwnProperty.call(e,"columnGroup")||!t)return;const n=new Set(e.columnGroup?.openColumnGroupIds),r=t.getColumnGroupState().map(({groupId:s})=>{const o=n.has(s);return o&&n.delete(s),{groupId:s,open:o}});n.forEach(s=>{r.push({groupId:s,open:!0})}),r.length&&(this.columnGroupStates=r),t.setColumnGroupState(r,"gridInitializing")}getFilterState(){const e=this.beans.filterManager;let t=e?.getFilterModel();t&&Object.keys(t).length===0&&(t=void 0);const n=e?.getAdvFilterModel()??void 0;return t||n?{filterModel:t,advancedFilterModel:n}:void 0}setFilterState(e){const t=this.beans.filterManager,{filterModel:n,advancedFilterModel:i}=e??{};n&&t?.setFilterModel(n,"columnFilter"),i&&t?.setAdvFilterModel(i,"advancedFilter")}getRangeSelectionState(){const e=this.beans.rangeSvc?.getCellRanges().map(t=>{const{id:n,type:i,startRow:r,endRow:s,columns:o,startColumn:a}=t;return{id:n,type:i,startRow:r,endRow:s,colIds:o.map(l=>l.getColId()),startColId:a.getColId()}});return e?.length?{cellRanges:e}:void 0}setCellSelectionState(e){const{gos:t,rangeSvc:n,colModel:i,visibleCols:r}=this.beans;if(!Wl(t)||!n)return;const s=[];e.cellRanges.forEach(o=>{const a=[];if(o.colIds.forEach(u=>{const c=i.getCol(u);c&&a.push(c)}),!a.length)return;let l=i.getCol(o.startColId);if(!l){const u=r.allCols,c=new Set(a);l=u.find(d=>c.has(d))}s.push({...o,columns:a,startColumn:l})}),n.setCellRanges(s)}getScrollState(){if(!this.isClientSideRowModel)return;const e=this.beans.ctrlsSvc.getScrollFeature(),{left:t}=e?.getHScrollPosition()??{left:0},{top:n}=e?.getVScrollPosition()??{top:0};return n||t?{top:n,left:t}:void 0}setScrollState(e){if(!this.isClientSideRowModel)return;const{top:t,left:n}=e,{frameworkOverrides:i,rowRenderer:r,animationFrameSvc:s,ctrlsSvc:o}=this.beans;i.wrapIncoming(()=>{o.get("center").setCenterViewportScrollLeft(n),o.getScrollFeature()?.setVerticalScrollPosition(t),r.redraw({afterScroll:!0}),s?.flushAllFrames()})}getSideBarState(){return this.beans.sideBar?.comp?.getState()}getFocusedCellState(){if(!this.isClientSideRowModel)return;const e=this.beans.focusSvc.getFocusedCell();if(e){const{column:t,rowIndex:n,rowPinned:i}=e;return{colId:t.getColId(),rowIndex:n,rowPinned:i}}}setFocusedCellState(e){if(!this.isClientSideRowModel)return;const{colId:t,rowIndex:n,rowPinned:i}=e,{focusSvc:r,colModel:s}=this.beans;r.setFocusedCell({column:s.getCol(t),rowIndex:n,rowPinned:i,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}getPaginationState(){const{pagination:e,gos:t}=this.beans;if(!e)return;const n=e.getCurrentPage(),i=t.get("paginationAutoPageSize")?void 0:e.getPageSize();if(!(!n&&!i))return{page:n,pageSize:i}}setPaginationState(e){const{pagination:t,gos:n}=this.beans;t&&(e.pageSize&&!n.get("paginationAutoPageSize")&&t.setPageSize(e.pageSize,"initialState"),typeof e.page=="number"&&t.setPage(e.page))}getRowSelectionState(){const e=this.beans.selectionSvc;if(!e)return;const t=e.getSelectionState();return!t||!Array.isArray(t)&&(t.selectAll===!1||t.selectAllChildren===!1)&&!t?.toggledNodes?.length?void 0:t}setRowSelectionState(e){this.beans.selectionSvc?.setSelectionState(e,"gridInitializing")}getRowGroupExpansionState(){const{expansionSvc:e,rowModel:t}=this.beans;if(!e)return;const n=[];return t.forEachNode(({expanded:i,id:r})=>{i&&r&&n.push(r)}),n.length?{expandedRowGroupIds:n}:void 0}setRowGroupExpansionState(e){this.beans.expansionSvc?.expandRows(e.expandedRowGroupIds)}updateColumnState(e){const t=this.getColumnState();let n=!1;const i=this.cachedState;for(const r of Object.keys(t)){const s=t[r];b0(s,i[r])||(n=!0)}this.cachedState={...i,...t},n&&this.dispatchStateUpdateEvent(e)}updateCachedState(e,t){const n=this.cachedState[e];this.setCachedStateValue(e,t),b0(t,n)||this.dispatchStateUpdateEvent([e])}setCachedStateValue(e,t){this.cachedState={...this.cachedState,[e]:t}}refreshStaleState(){const e=this.staleStateKeys;e.forEach(t=>{switch(t){case"rowSelection":this.setCachedStateValue(t,this.getRowSelectionState());break}}),e.clear()}dispatchStateUpdateEvent(e){this.suppressEvents||(e.forEach(t=>this.queuedUpdateSources.add(t)),this.dispatchStateUpdateEventDebounced())}dispatchQueuedStateUpdateEvents(){const e=this.queuedUpdateSources,t=Array.from(e);e.clear(),this.eventSvc.dispatchEvent({type:"stateUpdated",sources:t,state:this.cachedState})}suppressEventsAndDispatchInitEvent(e){this.suppressEvents=!0;const t=this.beans.colAnimation;t?.setSuppressAnimation(!0),e(),setTimeout(()=>{this.suppressEvents=!1,this.queuedUpdateSources.clear(),this.isAlive()&&(t?.setSuppressAnimation(!1),this.dispatchStateUpdateEvent(["gridInitializing"]))})}},VQe={moduleName:"GridState",version:we,beans:[HQe],apiFunctions:{getState:$Qe}};function WQe(e){return e.rowModel.isLastRowIndexKnown()}function UQe(e){return e.pagination?.getPageSize()??100}function qQe(e){return e.pagination?.getCurrentPage()??0}function jQe(e){return e.pagination?.getTotalPages()??1}function KQe(e){return e.pagination?e.pagination.getMasterRowCount():e.rowModel.getRowCount()}function YQe(e){e.pagination?.goToNextPage()}function XQe(e){e.pagination?.goToPreviousPage()}function QQe(e){e.pagination?.goToFirstPage()}function ZQe(e){e.pagination?.goToLastPage()}function JQe(e,t){e.pagination?.goToPage(t)}var eZe=class extends Z{constructor(){super(...arguments),this.beanName="paginationAutoPageSizeSvc"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.centerRowsCtrl=e.center;const t=this.checkPageSize.bind(this);this.addManagedEventListeners({bodyHeightChanged:t,scrollVisibilityChanged:t}),this.addManagedPropertyListener("paginationAutoPageSize",this.onPaginationAutoSizeChanged.bind(this)),this.checkPageSize()})}notActive(){return!this.gos.get("paginationAutoPageSize")||this.centerRowsCtrl==null}onPaginationAutoSizeChanged(){this.notActive()?this.beans.pagination.unsetAutoCalculatedPageSize():this.checkPageSize()}checkPageSize(){if(this.notActive())return;const e=this.centerRowsCtrl.viewportSizeFeature.getBodyHeight();if(e>0){const t=this.beans,n=()=>{const i=Math.max(zd(t),1),r=Math.floor(e/i);t.pagination.setPageSize(r,"autoCalculated")};this.isBodyRendered?yi(this,n,50)():(n(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}},Mm="paginationPageSizeSelector",tZe={tag:"span",cls:"ag-paging-page-size"},nZe=class extends At{constructor(){super(tZe),this.hasEmptyOption=!1,this.handlePageSizeItemSelected=()=>{if(!this.selectPageSizeComp)return;const e=this.selectPageSizeComp.getValue();if(!e)return;const t=Number(e);isNaN(t)||t<1||t===this.pagination.getPageSize()||(this.pagination.setPageSize(t,"pageSizeSelector"),this.hasEmptyOption&&this.toggleSelectDisplay(!0),this.selectPageSizeComp.getFocusableElement().focus())}}wireBeans(e){this.pagination=e.pagination}postConstruct(){this.addManagedPropertyListener(Mm,()=>{this.onPageSizeSelectorValuesChange()}),this.addManagedEventListeners({paginationChanged:e=>this.handlePaginationChanged(e)})}handlePaginationChanged(e){if(!this.selectPageSizeComp||!e?.newPageSize)return;const t=this.pagination.getPageSize();this.getPageSizeSelectorValues().includes(t)?this.selectPageSizeComp.setValue(t.toString()):this.hasEmptyOption?this.selectPageSizeComp.setValue(""):this.toggleSelectDisplay(!0)}toggleSelectDisplay(e){this.selectPageSizeComp&&!e&&this.reset(),e&&(this.reloadPageSizesSelector(),this.selectPageSizeComp)}reset(){Gi(this.getGui()),this.selectPageSizeComp&&(this.selectPageSizeComp=this.destroyBean(this.selectPageSizeComp))}onPageSizeSelectorValuesChange(){this.selectPageSizeComp&&this.shouldShowPageSizeSelector()&&this.reloadPageSizesSelector()}shouldShowPageSizeSelector(){return this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel")&&!this.gos.get("paginationAutoPageSize")&&this.gos.get(Mm)!==!1}reloadPageSizesSelector(){const e=this.getPageSizeSelectorValues(),t=this.pagination.getPageSize(),n=!t||!e.includes(t);if(n){const r=this.gos.exists("paginationPageSize"),s=this.gos.get(Mm)!==!0;de(94,{pageSizeSet:r,pageSizesSet:s,pageSizeOptions:e,paginationPageSizeOption:t}),s||de(95,{paginationPageSizeOption:t,paginationPageSizeSelector:Mm}),e.unshift("")}const i=String(n?"":t);this.selectPageSizeComp?(Nh(this.pageSizeOptions,e)||(this.selectPageSizeComp.clearOptions().addOptions(this.createPageSizeSelectOptions(e)),this.pageSizeOptions=e),this.selectPageSizeComp.setValue(i,!0)):this.createPageSizeSelectorComp(e,i),this.hasEmptyOption=n}createPageSizeSelectOptions(e){return e.map(t=>({value:String(t)}))}createPageSizeSelectorComp(e,t){const n=this.getLocaleTextFunc(),i=n("pageSizeSelectorLabel","Page Size:"),r=n("ariaPageSizeSelectorLabel","Page Size");this.selectPageSizeComp=this.createManagedBean(new PN).addOptions(this.createPageSizeSelectOptions(e)).setValue(t).setAriaLabel(r).setLabel(i).onValueChange(()=>this.handlePageSizeItemSelected()),this.appendChild(this.selectPageSizeComp)}getPageSizeSelectorValues(){const e=[20,50,100],t=this.gos.get(Mm);return!Array.isArray(t)||!t?.length?e:[...t].sort((n,i)=>n-i)}destroy(){this.toggleSelectDisplay(!1),super.destroy()}},iZe={selector:"AG-PAGE-SIZE-SELECTOR",component:nZe},rZe=".ag-paging-panel{align-items:center;border-top:var(--ag-footer-row-border);display:flex;gap:calc(var(--ag-spacing)*4);height:max(var(--ag-row-height),22px);justify-content:flex-end;padding:0 var(--ag-cell-horizontal-padding)}:where(.ag-paging-page-size) .ag-wrapper{min-width:50px}.ag-paging-page-summary-panel{align-items:center;display:flex;gap:var(--ag-cell-widget-spacing);.ag-disabled &{pointer-events:none}}.ag-paging-button{cursor:pointer;position:relative;&.ag-disabled{cursor:default;opacity:.5}}.ag-paging-number,.ag-paging-row-summary-panel-number{font-weight:500}",sZe=class extends Fte{constructor(){super(),this.btFirst=ve,this.btPrevious=ve,this.btNext=ve,this.btLast=ve,this.lbRecordCount=ve,this.lbFirstRowOnPage=ve,this.lbLastRowOnPage=ve,this.lbCurrent=ve,this.lbTotal=ve,this.pageSizeComp=ve,this.previousAndFirstButtonsDisabled=!1,this.nextButtonDisabled=!1,this.lastButtonDisabled=!1,this.areListenersSetup=!1,this.allowFocusInnerElement=!1,this.registerCSS(rZe)}wireBeans(e){this.rowModel=e.rowModel,this.pagination=e.pagination,this.ariaAnnounce=e.ariaAnnounce}postConstruct(){const e=this.gos.get("enableRtl");this.setTemplate(this.getTemplate(),[iZe]);const{btFirst:t,btPrevious:n,btNext:i,btLast:r}=this;this.activateTabIndex([t,n,i,r]),t.insertAdjacentElement("afterbegin",Os(e?"last":"first",this.beans)),n.insertAdjacentElement("afterbegin",Os(e?"next":"previous",this.beans)),i.insertAdjacentElement("afterbegin",Os(e?"previous":"next",this.beans)),r.insertAdjacentElement("afterbegin",Os(e?"first":"last",this.beans)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.addManagedPropertyListeners(["paginationPageSizeSelector","paginationAutoPageSize","suppressPaginationPanel"],()=>this.onPageSizeRelatedOptionsChange()),this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector()),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:s=>this.allowFocusInnerElement?this.tabGuardFeature.getTabGuardCtrl().focusInnerElement(s):HWe(this.beans,s),forceFocusOutWhenTabGuardsAreEmpty:!0}),this.onPaginationChanged()}setAllowFocus(e){this.allowFocusInnerElement=e}onPaginationChanged(){const t=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.setDisplayed(t),t&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateLabels(),this.onPageSizeRelatedOptionsChange())}onPageSizeRelatedOptionsChange(){this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector())}setupListeners(){this.areListenersSetup||(this.addManagedEventListeners({paginationChanged:this.onPaginationChanged.bind(this)}),[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}].forEach(e=>{const{el:t,fn:n}=e;this.addManagedListeners(t,{click:n,keydown:i=>{(i.key===X.ENTER||i.key===X.SPACE)&&(i.preventDefault(),n())}})}),zWe(this.beans,this,this.getGui()),this.areListenersSetup=!0)}onBtFirst(){this.previousAndFirstButtonsDisabled||this.pagination.goToFirstPage()}formatNumber(e){const t=this.gos.getCallback("paginationNumberFormatter");return t?t({value:e}):eKe(e,this.getLocaleTextFunc.bind(this))}getTemplate(){const e=this.getLocaleTextFunc(),t=`ag-${this.getCompId()}`;return{tag:"div",cls:"ag-paging-panel ag-unselectable",attrs:{id:`${t}`},children:[{tag:"ag-page-size-selector",ref:"pageSizeComp"},{tag:"span",cls:"ag-paging-row-summary-panel",children:[{tag:"span",ref:"lbFirstRowOnPage",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-first-row`}},{tag:"span",attrs:{id:`${t}-to`},children:e("to","to")},{tag:"span",ref:"lbLastRowOnPage",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-last-row`}},{tag:"span",attrs:{id:`${t}-of`},children:e("of","of")},{tag:"span",ref:"lbRecordCount",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-row-count`}}]},{tag:"span",cls:"ag-paging-page-summary-panel",role:"presentation",children:[{tag:"div",ref:"btFirst",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("firstPage","First Page")}},{tag:"div",ref:"btPrevious",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("previousPage","Previous Page")}},{tag:"span",cls:"ag-paging-description",children:[{tag:"span",attrs:{id:`${t}-start-page`},children:e("page","Page")},{tag:"span",ref:"lbCurrent",cls:"ag-paging-number",attrs:{id:`${t}-start-page-number`}},{tag:"span",attrs:{id:`${t}-of-page`},children:e("of","of")},{tag:"span",ref:"lbTotal",cls:"ag-paging-number",attrs:{id:`${t}-of-page-number`}}]},{tag:"div",ref:"btNext",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("nextPage","Next Page")}},{tag:"div",ref:"btLast",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("lastPage","Last Page")}}]}]}}onBtNext(){this.nextButtonDisabled||this.pagination.goToNextPage()}onBtPrevious(){this.previousAndFirstButtonsDisabled||this.pagination.goToPreviousPage()}onBtLast(){this.lastButtonDisabled||this.pagination.goToLastPage()}enableOrDisableButtons(){const e=this.pagination.getCurrentPage(),t=this.rowModel.isLastRowIndexKnown(),n=this.pagination.getTotalPages();this.previousAndFirstButtonsDisabled=e===0,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);const i=this.isZeroPagesToDisplay(),r=e===n-1;this.nextButtonDisabled=r||i,this.lastButtonDisabled=!t||i||e===n-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)}toggleButtonDisabled(e,t){m5e(e,t),e.classList.toggle("ag-disabled",t)}isZeroPagesToDisplay(){const e=this.rowModel.isLastRowIndexKnown(),t=this.pagination.getTotalPages();return e&&t===0}updateLabels(){const e=this.rowModel.isLastRowIndexKnown(),t=this.pagination.getTotalPages(),n=this.pagination.getMasterRowCount(),i=e?n:null,r=this.pagination.getCurrentPage(),s=this.pagination.getPageSize();let o,a;this.isZeroPagesToDisplay()?o=a=0:(o=s*r+1,a=o+s-1,e&&a>i&&(a=i));const l=o+s-1,u=!e&&n<l,c=this.formatNumber(o);this.lbFirstRowOnPage.textContent=c;let d;const h=this.getLocaleTextFunc();u?d=h("pageLastRowUnknown","?"):d=this.formatNumber(a),this.lbLastRowOnPage.textContent=d;const g=t>0?r+1:0,m=this.formatNumber(g);this.lbCurrent.textContent=m;let C,y;if(e)C=this.formatNumber(t),y=this.formatNumber(i);else{const b=h("more","more");C=b,y=b}this.lbTotal.textContent=C,this.lbRecordCount.textContent=y,this.announceAriaStatus(c,d,y,m,C)}announceAriaStatus(e,t,n,i,r){const s=this.getLocaleTextFunc(),o=s("page","Page"),a=s("to","to"),l=s("of","of"),u=`${e} ${a} ${t} ${l} ${n}`,c=`${o} ${i} ${l} ${r}`;u!==this.ariaRowStatus&&(this.ariaRowStatus=u,this.ariaAnnounce?.announceValue(u,"paginationRow")),c!==this.ariaPageStatus&&(this.ariaPageStatus=c,this.ariaAnnounce?.announceValue(c,"paginationPage"))}setTotalLabelsToZero(){const e=this.formatNumber(0);this.lbFirstRowOnPage.textContent=e,this.lbCurrent.textContent=e,this.lbLastRowOnPage.textContent=e,this.lbTotal.textContent=e,this.lbRecordCount.textContent=e,this.announceAriaStatus(e,e,e,e,e)}},oZe={selector:"AG-PAGINATION",component:sZe},aZe=class extends Z{constructor(){super(...arguments),this.beanName="pagination",this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=0,this.masterRowCount=0}postConstruct(){const e=this.gos;this.active=e.get("pagination"),this.pageSizeFromGridOptions=e.get("paginationPageSize"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedPropertyListener("pagination",this.onPaginationGridOptionChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPageSizeGridOptionChanged.bind(this))}getPaginationSelector(){return oZe}isPaginateChildRows(){const e=this.gos;return e.get("groupHideParentOfSingleChild")||e.get("groupRemoveSingleChildren")||e.get("groupRemoveLowestSingleChildren")?!0:e.get("paginateChildRows")}onPaginationGridOptionChanged(){this.active=this.gos.get("pagination"),this.calculatePages(),this.dispatchPaginationChangedEvent({keepRenderedRows:!0})}onPageSizeGridOptionChanged(){this.setPageSize(this.gos.get("paginationPageSize"),"gridOptions")}goToPage(e){const t=this.currentPage;!this.active||t===e||typeof t!="number"||(this.currentPage=e,this.calculatePages(),this.dispatchPaginationChangedEvent({newPage:!0}))}goToPageWithIndex(e){if(!this.active)return;let t=e;this.paginateChildRows||(t=this.beans.rowModel.getTopLevelIndexFromDisplayedIndex?.(e)??e),this.goToPage(Math.floor(t/this.pageSize))}isRowInPage(e){return this.active?e>=this.topDisplayedRowIndex&&e<=this.bottomDisplayedRowIndex:!0}getCurrentPage(){return this.currentPage}goToNextPage(){this.goToPage(this.currentPage+1)}goToPreviousPage(){this.goToPage(this.currentPage-1)}goToFirstPage(){this.goToPage(0)}goToLastPage(){const e=this.beans.rowModel.getRowCount(),t=Math.floor(e/this.pageSize);this.goToPage(t)}getPageSize(){return this.pageSize}getTotalPages(){return this.totalPages}setPage(e){this.currentPage=e}get pageSize(){return Ce(this.pageSizeAutoCalculated)&&this.gos.get("paginationAutoPageSize")?this.pageSizeAutoCalculated:Ce(this.pageSizeFromPageSizeSelector)?this.pageSizeFromPageSizeSelector:Ce(this.pageSizeFromInitialState)?this.pageSizeFromInitialState:Ce(this.pageSizeFromGridOptions)?this.pageSizeFromGridOptions:this.defaultPageSize}calculatePages(){this.active?this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly():this.calculatedPagesNotActive(),this.beans.pageBounds.calculateBounds(this.topDisplayedRowIndex,this.bottomDisplayedRowIndex)}unsetAutoCalculatedPageSize(){if(this.pageSizeAutoCalculated===void 0)return;const e=this.pageSizeAutoCalculated;this.pageSizeAutoCalculated=void 0,this.pageSize!==e&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0}))}setPageSize(e,t){const n=this.pageSize;switch(t){case"autoCalculated":this.pageSizeAutoCalculated=e;break;case"pageSizeSelector":this.pageSizeFromPageSizeSelector=e,this.currentPage!==0&&this.goToFirstPage();break;case"initialState":this.pageSizeFromInitialState=e;break;case"gridOptions":this.pageSizeFromGridOptions=e,this.pageSizeFromInitialState=void 0,this.pageSizeFromPageSizeSelector=void 0,this.currentPage!==0&&this.goToFirstPage();break}n!==this.pageSize&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0,keepRenderedRows:!0}))}setZeroRows(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0}adjustCurrentPageIfInvalid(){const e=this.totalPages;this.currentPage>=e&&(this.currentPage=e-1);const t=this.currentPage;(!isFinite(t)||isNaN(t)||t<0)&&(this.currentPage=0)}calculatePagesMasterRowsOnly(){const e=this.beans.rowModel,t=e.getTopLevelRowCount();if(this.masterRowCount=t,t<=0){this.setZeroRows();return}const n=this.pageSize,i=t-1;this.totalPages=Math.floor(i/n)+1,this.adjustCurrentPageIfInvalid();const r=this.currentPage,s=n*r;let o=n*(r+1)-1;if(o>i&&(o=i),this.topDisplayedRowIndex=e.getTopLevelRowDisplayedIndex(s),o===i)this.bottomDisplayedRowIndex=e.getRowCount()-1;else{const a=e.getTopLevelRowDisplayedIndex(o+1);this.bottomDisplayedRowIndex=a-1}}getMasterRowCount(){return this.masterRowCount}calculatePagesAllRows(){const e=this.beans.rowModel.getRowCount();if(this.masterRowCount=e,e===0){this.setZeroRows();return}const{pageSize:t,currentPage:n}=this,i=e-1;this.totalPages=Math.floor(i/t)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=t*n,this.bottomDisplayedRowIndex=t*(n+1)-1,this.bottomDisplayedRowIndex>i&&(this.bottomDisplayedRowIndex=i)}calculatedPagesNotActive(){this.setPageSize(void 0,"autoCalculated"),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.beans.rowModel.getRowCount()-1}dispatchPaginationChangedEvent(e){const{keepRenderedRows:t=!1,newPage:n=!1,newPageSize:i=!1}=e;this.eventSvc.dispatchEvent({type:"paginationChanged",animate:!1,newData:!1,newPage:n,newPageSize:i,keepRenderedRows:t})}},lZe={moduleName:"Pagination",version:we,beans:[aZe,eZe],icons:{first:"first",previous:"previous",next:"next",last:"last"},apiFunctions:{paginationIsLastPageFound:WQe,paginationGetPageSize:UQe,paginationGetCurrentPage:qQe,paginationGetTotalPages:jQe,paginationGetRowCount:KQe,paginationGoToNextPage:YQe,paginationGoToPreviousPage:XQe,paginationGoToFirstPage:QQe,paginationGoToLastPage:ZQe,paginationGoToPage:JQe},dependsOn:[QR]};function uZe(e,t={}){const n=t?t.rowNodes:void 0;e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.redrawRows(n))}function Ane(e,t,n,i,r){t&&(i&&t.parent&&t.parent.level!==-1&&Ane(e,t.parent,n,i,r),t.setExpanded(n,void 0,r))}function cZe(e,t){return e.rowModel.getRowNode(t)}function dZe(e,t,n,i){e.rowRenderer.addRenderedRowListener(t,n,i)}function hZe(e){return e.rowRenderer.getRenderedNodes()}function fZe(e,t,n){e.rowModel.forEachNode(t,n)}function pZe(e){return e.rowRenderer.firstRenderedRow}function gZe(e){return e.rowRenderer.lastRenderedRow}function mZe(e,t){return e.rowModel.getRow(t)}function vZe(e){return e.rowModel.getRowCount()}var Dne={moduleName:"RowApi",version:we,apiFunctions:{redrawRows:uZe,setRowNodeExpanded:Ane,getRowNode:cZe,addRenderedRowListener:dZe,getRenderedNodes:hZe,forEachNode:fZe,getFirstDisplayedRowIndex:pZe,getLastDisplayedRowIndex:gZe,getDisplayedRowAtIndex:mZe,getDisplayedRowCount:vZe}},CZe={moduleName:"ScrollApi",version:we,apiFunctions:{getVerticalPixelRange:QYe,getHorizontalPixelRange:ZYe,ensureColumnVisible:bne,ensureIndexVisible:Sne,ensureNodeVisible:JYe}};function yZe(e,t,n){if(!t)return;const i=e.ctrlsSvc.getGridBodyCtrl().eGridBody,r=`aria-${t}`;n===null?i.removeAttribute(r):i.setAttribute(r,n)}function wZe(e,t={}){e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.refreshCells(t))}function bZe(e){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getHeaderRowContainerCtrls().forEach(t=>t.refresh()))}function SZe(e){return e.animationFrameSvc?.isQueueEmpty()??!0}function xZe(e){e.animationFrameSvc?.flushAllFrames()}function RZe(e){return{rowHeight:zd(e),headerHeight:NC(e)}}function EZe(e,t={}){const n=[];if(e.rowRenderer.getCellCtrls(t.rowNodes,t.columns).forEach(s=>{const o=s.getCellRenderer();o!=null&&n.push(F0(o))}),t.columns?.length)return n;const i=[],r=gT(t.rowNodes);return e.rowRenderer.getAllRowCtrls().forEach(s=>{if(r&&!mT(s.rowNode,r)||!s.isFullWidth())return;const o=s.getFullWidthCellRenderers();for(let a=0;a<o.length;a++){const l=o[a];l!=null&&i.push(F0(l))}}),[...i,...n]}var FZe={moduleName:"RenderApi",version:we,apiFunctions:{setGridAriaProperty:yZe,refreshCells:wZe,refreshHeader:bZe,isAnimationFrameQueueEmpty:SZe,flushAllAnimationFrames:xZe,getSizesForCurrentTheme:RZe,getCellRendererInstances:EZe}};function AZe(e,t){typeof t=="number"?e.colAutosize?.sizeColumnsToFit(t,"api"):e.colAutosize?.sizeColumnsToFitGridBody(t)}function DZe(e,t,n){e.colAutosize?.autoSizeCols({colKeys:t,skipHeader:n,source:"api"})}function kZe(e,t){e.colAutosize?.autoSizeAllColumns("api",t)}var PZe=class extends Z{constructor(){super(...arguments),this.beanName="colAutosize",this.timesDelayed=0,this.shouldQueueResizeOperations=!1,this.resizeOperationQueue=[]}postConstruct(){this.addManagedEventListeners({firstDataRendered:()=>this.onFirstDataRendered()})}autoSizeCols(e){if(this.shouldQueueResizeOperations){this.pushResizeOperation(()=>this.autoSizeCols(e));return}const{colKeys:t,skipHeader:n,skipHeaderGroups:i,stopAtGroup:r,source:s="api"}=e,{animationFrameSvc:o,renderStatus:a,colModel:l,autoWidthCalc:u,visibleCols:c}=this.beans;if(o?.flushAllFrames(),this.timesDelayed<5&&a&&!a.areHeaderCellsRendered()){this.timesDelayed++,setTimeout(()=>{this.isAlive()&&this.autoSizeCols(e)});return}this.timesDelayed=0;const d=[];let h=-1;const p=n??this.gos.get("skipHeaderOnAutoSize"),g=i??p;for(;h!==0;){h=0;const m=[];t.forEach(C=>{if(!C)return;const y=l.getCol(C);if(!y||Gp(y)||d.indexOf(y)>=0)return;const b=u.getPreferredWidthForColumn(y,p);if(b>0){const S=MZe(y,b);y.setActualWidth(S,s),d.push(y),h++}m.push(y)}),m.length&&c.refresh(s)}g||this.autoSizeColumnGroupsByColumns(t,s,r),zp(this.eventSvc,d,!0,"autosizeColumns")}autoSizeColumn(e,t,n){e&&this.autoSizeCols({colKeys:[e],skipHeader:n,skipHeaderGroups:!0,source:t})}autoSizeColumnGroupsByColumns(e,t,n){const{colModel:i,ctrlsSvc:r}=this.beans,s=new Set;i.getColsForKeys(e).forEach(u=>{let c=u.getParent();for(;c&&c!=n;)c.isPadding()||s.add(c),c=c.getParent()});let a;const l=[];for(const u of s){for(const c of r.getHeaderRowContainerCtrls())if(a=c.getHeaderCtrlForColumn(u),a)break;a&&a.resizeLeafColumnsToFit(t)}return l}autoSizeAllColumns(e,t){if(this.shouldQueueResizeOperations){this.pushResizeOperation(()=>this.autoSizeAllColumns(e,t));return}const n=this.beans.visibleCols.allCols;this.autoSizeCols({colKeys:n,skipHeader:t,source:e})}addColumnAutosize(e,t){const n=this.gos.get("skipHeaderOnAutoSize"),i=()=>{this.autoSizeColumn(t,"uiColumnResized",n)};e.addEventListener("dblclick",i);const r=new xf(e);return r.addEventListener("doubleTap",i),()=>{e.removeEventListener("dblclick",i),r.removeEventListener("doubleTap",i),r.destroy()}}addColumnGroupResize(e,t,n){const i=this.gos.get("skipHeaderOnAutoSize"),r=()=>{const s=[];t.getDisplayedLeafColumns().forEach(a=>{a.getColDef().suppressAutoSize||s.push(a.getColId())}),s.length>0&&this.autoSizeCols({colKeys:s,skipHeader:i,stopAtGroup:t,source:"uiColumnResized"}),n()};return e.addEventListener("dblclick",r),()=>e.removeEventListener("dblclick",r)}sizeColumnsToFitGridBody(e,t){if(!this.isAlive())return;const{ctrlsSvc:n,scrollVisibleSvc:i}=this.beans,r=n.getGridBodyCtrl(),o=r.isVerticalScrollShowing()?i.getScrollbarWidth():0,l=w0(r.eGridBody)-o;if(l>0){this.sizeColumnsToFit(l,"sizeColumnsToFit",!1,e);return}t===void 0?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,100)},0):t===100?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,500)},100):t===500?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,-1)},500):de(29)}sizeColumnsToFit(e,t="sizeColumnsToFit",n,i){if(this.shouldQueueResizeOperations){this.pushResizeOperation(()=>this.sizeColumnsToFit(e,t,n,i));return}const r={};i&&i?.columnLimits?.forEach(({key:p,...g})=>{r[typeof p=="string"?p:p.getColId()]=g});const s=this.beans.visibleCols.allCols;if(e<=0||!s.length||e===fl(s)&&s.every(g=>{if(g.colDef.suppressSizeToFit)return!0;const m=r?.[g.getId()],C=m?.minWidth??i?.defaultMinWidth,y=m?.maxWidth??i?.defaultMaxWidth,b=g.getActualWidth();return(C==null||b>=C)&&(y==null||b<=y)}))return;const a=[],l=[];s.forEach(p=>{p.getColDef().suppressSizeToFit===!0?l.push(p):a.push(p)});const u=a.slice(0);let c=!1;const d=p=>{_o(a,p),l.push(p)};for(a.forEach(p=>{p.resetActualWidth(t);const g=r?.[p.getId()],m=g?.minWidth??i?.defaultMinWidth,C=g?.maxWidth??i?.defaultMaxWidth,y=p.getActualWidth();typeof m=="number"&&y<m?p.setActualWidth(m,t,!0):typeof C=="number"&&y>C&&p.setActualWidth(C,t,!0)});!c;){c=!0;const p=e-fl(l);if(p<=0)a.forEach(g=>{const m=r?.[g.getId()]?.minWidth??i?.defaultMinWidth;if(typeof m=="number"){g.setActualWidth(m,t,!0);return}g.setActualWidth(g.minWidth,t)});else{const g=p/fl(a);let m=p;for(let C=a.length-1;C>=0;C--){const y=a[C],b=r?.[y.getId()],S=b?.minWidth??i?.defaultMinWidth,x=b?.maxWidth??i?.defaultMaxWidth,E=y.getMinWidth(),A=y.getMaxWidth(),F=typeof S=="number"&&S>E?S:E,P=typeof x=="number"&&x<A?x:A;let D=Math.round(y.getActualWidth()*g);D<F?(D=F,d(y),c=!1):D>P?(D=P,d(y),c=!1):C===0&&(D=m),y.setActualWidth(D,t,!0),m-=D}}}u.forEach(p=>{p.fireColumnWidthChangedEvent(t)});const h=this.beans.visibleCols;h.setLeftValues(t),h.updateBodyWidths(),!n&&zp(this.eventSvc,u,!0,t)}applyAutosizeStrategy(){const e=this.gos.get("autoSizeStrategy");if(!e)return;const{type:t}=e;setTimeout(()=>{if(t==="fitGridWidth"){const{columnLimits:n,defaultMinWidth:i,defaultMaxWidth:r}=e,s=n?.map(({colId:o,minWidth:a,maxWidth:l})=>({key:o,minWidth:a,maxWidth:l}));this.sizeColumnsToFitGridBody({defaultMinWidth:i,defaultMaxWidth:r,columnLimits:s})}else t==="fitProvidedWidth"&&this.sizeColumnsToFit(e.width,"sizeColumnsToFit")})}onFirstDataRendered(){const e=this.gos.get("autoSizeStrategy");if(e?.type!=="fitCellContents")return;const{colIds:t,skipHeader:n}=e;setTimeout(()=>{t?this.autoSizeCols({colKeys:t,skipHeader:n,source:"autosizeColumns"}):this.autoSizeAllColumns("autosizeColumns",n)})}processResizeOperations(){this.shouldQueueResizeOperations=!1,this.resizeOperationQueue.forEach(e=>e()),this.resizeOperationQueue=[]}pushResizeOperation(e){this.resizeOperationQueue.push(e)}destroy(){this.resizeOperationQueue.length=0,super.destroy()}};function MZe(e,t){const n=e.getMinWidth();t<n&&(t=n);const i=e.getMaxWidth();return e.isGreaterThanMax(t)&&(t=i),t}var TZe={moduleName:"ColumnAutoSize",version:we,beans:[PZe],apiFunctions:{sizeColumnsToFit:AZe,autoSizeColumns:DZe,autoSizeAllColumns:kZe},dependsOn:[Ote]};function IZe(e){return e.pinnedRowModel?.getPinnedTopRowCount()??0}function _Ze(e){return e.pinnedRowModel?.getPinnedBottomRowCount()??0}function OZe(e,t){return e.pinnedRowModel?.getPinnedTopRow(t)}function LZe(e,t){return e.pinnedRowModel?.getPinnedBottomRow(t)}var NZe=class extends Z{constructor(){super(...arguments),this.beanName="pinnedRowModel",this.nextId=0,this.pinnedTopRows={cache:{},order:[]},this.pinnedBottomRows={cache:{},order:[]}}postConstruct(){const e=this.gos;this.setPinnedRowData(e.get("pinnedTopRowData"),"top"),this.setPinnedRowData(e.get("pinnedBottomRowData"),"bottom"),this.addManagedPropertyListener("pinnedTopRowData",t=>this.setPinnedRowData(t.currentValue,"top")),this.addManagedPropertyListener("pinnedBottomRowData",t=>this.setPinnedRowData(t.currentValue,"bottom")),this.addManagedEventListeners({gridStylesChanged:this.onGridStylesChanges.bind(this)})}isEmpty(e){return this.getCache(e).order.length===0}isRowsToRender(e){return!this.isEmpty(e)}onGridStylesChanges(e){if(e.rowHeightChanged){const t=n=>{n.setRowHeight(n.rowHeight,!0)};Tm(this.pinnedBottomRows,t),Tm(this.pinnedTopRows,t)}}ensureRowHeightsValid(){let e=!1,t=0;const n=i=>{if(i.rowHeightEstimated){const r=Np(this.beans,i);i.setRowTop(t),i.setRowHeight(r.height),t+=r.height,e=!0}};return Tm(this.pinnedBottomRows,n),t=0,Tm(this.pinnedTopRows,n),this.eventSvc.dispatchEvent({type:"pinnedHeightChanged"}),e}setPinnedRowData(e,t){this.updateNodesFromRowData(e,t),this.eventSvc.dispatchEvent({type:"pinnedRowDataChanged"})}updateNodesFromRowData(e,t){const n=this.getCache(t);if(e===void 0){n.order.length=0,n.cache={};return}const i=$p(this.gos),r=t==="top"?ute:cte,s=new Set(n.order),o=[],a=new Set;let l=0,u=-1;for(const c of e){const d=i?.({data:c,level:0,rowPinned:t})??r+this.nextId++;if(a.has(d)){de(96,{id:d,data:c});continue}u++,a.add(d),o.push(d);const h=Lv(n,d);if(h!==void 0)h.data!==c&&h.setData(c),l+=this.setRowTopAndRowIndex(h,l,u),s.delete(d);else{const p=new Vp(this.beans);p.id=d,p.data=c,p.rowPinned=t,l+=this.setRowTopAndRowIndex(p,l,u),n.cache[d]=p,n.order.push(d)}}s.forEach(c=>{Lv(n,c)?.clearRowTopAndRowIndex(),delete n.cache[c]}),n.order=o}setRowTopAndRowIndex(e,t,n){return e.setRowTop(t),e.setRowHeight(Np(this.beans,e).height),e.setRowIndex(n),e.rowHeight}getPinnedTopTotalHeight(){return n4(this.pinnedTopRows)}getPinnedBottomTotalHeight(){return n4(this.pinnedBottomRows)}getPinnedTopRowCount(){return wT(this.pinnedTopRows)}getPinnedBottomRowCount(){return wT(this.pinnedBottomRows)}getPinnedTopRow(e){return yT(this.pinnedTopRows,e)}getPinnedBottomRow(e){return yT(this.pinnedBottomRows,e)}getPinnedRowById(e,t){return Lv(this.getCache(t),e)}forEachPinnedRow(e,t){return Tm(this.getCache(e),t)}getCache(e){return e==="top"?this.pinnedTopRows:this.pinnedBottomRows}};function n4(e){const t=wT(e);if(t===0)return 0;const n=yT(e,t-1);return n===void 0?0:n.rowTop+n.rowHeight}function Lv(e,t){return e.cache[t]}function yT(e,t){return Lv(e,e.order[t])}function Tm(e,t){e.order.forEach((n,i)=>{const r=Lv(e,n);r&&t(r,i)})}function wT(e){return e.order.length}var $Ze={moduleName:"PinnedRow",version:we,beans:[NZe],apiFunctions:{getPinnedTopRowCount:IZe,getPinnedBottomRowCount:_Ze,getPinnedTopRow:OZe,getPinnedBottomRow:LZe}},BZe=class extends Pv{constructor(e,t,n){super(e.col,e.firstNode,n,t),this.cellSpan=e,this.SPANNED_CELL_CSS_CLASS="ag-spanned-cell"}setComp(e,t,n,i,r,s,o){this.eWrapper=n,super.setComp(e,t,n,i,r,s,o),this.setAriaRowSpan(),this.refreshAriaRowIndex()}isCellSpanning(){return!0}getCellSpan(){return this.cellSpan}refreshAriaRowIndex(){this.rowNode.rowIndex!=null&&rN(this.eGui,this.rowNode.rowIndex)}setAriaRowSpan(){b5e(this.eGui,this.cellSpan.spannedNodes.size)}setFocusedCellPosition(e){this.focusedCellPosition=e}getFocusedCellPosition(){return this.focusedCellPosition??this.cellPosition}checkCellFocused(){const e=this.beans.focusSvc.getFocusedCell();return!!e&&this.cellSpan.doesSpanContain(e)}applyStaticCssClasses(){super.applyStaticCssClasses(),this.comp.addOrRemoveCssClass(this.SPANNED_CELL_CSS_CLASS,!0)}onCellFocused(e){const{beans:t}=this;if(jR(t)){this.focusedCellPosition=void 0;return}const n=this.isCellFocused();n||(this.focusedCellPosition=void 0),e&&n&&(this.focusedCellPosition={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column}),super.onCellFocused(e)}getRootElement(){return this.eWrapper}},GZe=class extends b1{onRowIndexChanged(){super.onRowIndexChanged(),this.getAllCellCtrls().forEach(e=>e.refreshAriaRowIndex())}getInitialRowClasses(e){return["ag-spanned-row"]}getNewCellCtrl(e){const t=this.beans.rowSpanSvc?.getCellSpan(e,this.rowNode);if(!(!t||t.firstNode!==this.rowNode))return new BZe(t,this,this.beans)}isCorrectCtrlForSpan(e){const t=this.beans.rowSpanSvc?.getCellSpan(e.column,this.rowNode);return!t||t.firstNode!==this.rowNode?!1:e.getCellSpan()===t}onRowHeightChanged(){}refreshFirstAndLastRowStyles(){}addHoverFunctionality(){}resetHoveredStatus(){}},zZe=class extends Z{constructor(){super(...arguments),this.beanName="spannedRowRenderer",this.topCtrls=new Map,this.bottomCtrls=new Map,this.centerCtrls=new Map}postConstruct(){this.addManagedEventListeners({displayedRowsChanged:this.createAllCtrls.bind(this)})}createAllCtrls(){this.createCtrls("top"),this.createCtrls("bottom"),this.createCtrls("center")}createCtrls(e){const{rowSpanSvc:t}=this.beans,n=`${e}Ctrls`,i=this[n],r=i.size,s=this.getAllRelevantRowControls(e),o=new Map;let a=!1;for(const u of s)u.isAlive()&&t?.forEachSpannedColumn(u.rowNode,(c,d)=>{if(o.has(d.firstNode))return;const h=i.get(d.firstNode);if(h){o.set(d.firstNode,h),i.delete(d.firstNode);return}a=!0;const p=new GZe(d.firstNode,this.beans,!1,!1,!1);o.set(d.firstNode,p)});this[n]=o;const l=o.size===r;if(!(!a&&l)){for(const u of i.values())u.destroyFirstPass(!0),u.destroySecondPass();this.dispatchLocalEvent({type:"spannedRowsUpdated",ctrlsKey:e})}}getAllRelevantRowControls(e){const{rowRenderer:t}=this.beans;switch(e){case"top":return t.topRowCtrls;case"bottom":return t.bottomRowCtrls;case"center":return t.allRowCtrls}}getCellByPosition(e){const{rowSpanSvc:t}=this.beans,n=t?.getCellSpanByPosition(e);if(!n)return;const i=`${kne(e.rowPinned)}Ctrls`,r=this[i].get(n.firstNode);if(r)return r.getAllCellCtrls().find(s=>s.column===e.column)}getCtrls(e){const t=`${e}Ctrls`;return[...this[t].values()]}destroyRowCtrls(e){const t=`${e}Ctrls`;for(const n of this[t].values())n.destroyFirstPass(!0),n.destroySecondPass();this[t]=new Map}destroy(){super.destroy(),this.destroyRowCtrls("top"),this.destroyRowCtrls("bottom"),this.destroyRowCtrls("center")}},kne=e=>e??"center",HZe=class{constructor(e,t){this.col=e,this.firstNode=t,this.cellSpan=!0,this.spannedNodes=new Set,this.addSpannedNode(t)}reset(){this.spannedNodes.clear(),this.addSpannedNode(this.firstNode)}addSpannedNode(e){this.spannedNodes.add(e),this.lastNode=e}getLastNode(){return this.lastNode}getCellHeight(){return this.lastNode.rowTop+this.lastNode.rowHeight-this.firstNode.rowTop-1}doesSpanContain(e){return e.column!==this.col||e.rowPinned!=this.firstNode.rowPinned?!1:this.firstNode.rowIndex<=e.rowIndex&&e.rowIndex<=this.lastNode.rowIndex}getLastNodeAutoHeight(){const e=this.firstNode.__autoHeights?.[this.col.getColId()];if(e==null)return;let t=0;return this.spannedNodes.forEach(n=>{n!==this.lastNode&&(t+=n.rowHeight)}),e-t}},VZe=class extends Z{constructor(e){super(),this.column=e}buildCache(e){const{column:t,beans:{gos:n,pinnedRowModel:i,rowModel:r,valueSvc:s,pagination:o}}=this,{colDef:a}=t,l=this[`${e}ValueNodeMap`],u=new Map,c=n.getCallback("isFullWidthRow"),d=a.equals,h=a.spanRows,p=typeof h=="function";let g=null,m=null,C;const y=(S,x)=>{g=S,m=null,C=x},b=S=>{const x=!S.isExpandable()&&!S.group&&!S.detail&&(c?!c({rowNode:S}):!0);if(S.rowIndex==null||!x){y(null,null);return}if(g==null||S.level!==g.level||S.footer||m&&S.rowIndex-1!==m?.getLastNode().rowIndex){y(S,s.getValue(t,S));return}const E=s.getValue(t,S);if(p){const A=ze(n,{valueA:C,nodeA:g,valueB:E,nodeB:S,column:t,colDef:a});if(!h(A)){y(S,E);return}}else if(d?!d(C,E):C!==E){y(S,E);return}if(!m){const A=l?.get(g);A?.firstNode===g?(A.reset(),m=A):m=new HZe(t,g),u.set(g,m)}m.addSpannedNode(S),u.set(S,m)};switch(e){case"center":r.forEachDisplayedNode?.(S=>{(!o||o.isRowInPage(S.rowIndex))&&b(S)});break;case"top":i?.forEachPinnedRow("top",b);break;case"bottom":i?.forEachPinnedRow("bottom",b);break}this[`${e}ValueNodeMap`]=u}isCellSpanning(e){return!!this.getCellSpan(e)}getCellSpan(e){return this[`${kne(e.rowPinned)}ValueNodeMap`].get(e)}},WZe=class extends Z{constructor(){super(...arguments),this.beanName="rowSpanSvc",this.spanningColumns=new Map,this.debouncePinnedEvent=yi(this,this.dispatchCellsUpdatedEvent.bind(this,!0),0),this.debounceModelEvent=yi(this,this.dispatchCellsUpdatedEvent.bind(this,!1),0),this.pinnedTimeout=null,this.modelTimeout=null}postConstruct(){const e=this.onRowDataUpdated.bind(this);this.addManagedEventListeners({paginationChanged:this.buildModelCaches.bind(this),pinnedRowDataChanged:this.buildPinnedCaches.bind(this),rowNodeDataChanged:e,cellValueChanged:e})}register(e){const{gos:t}=this.beans;if(!t.get("enableCellSpan")||this.spanningColumns.has(e))return;const n=this.createManagedBean(new VZe(e));this.spanningColumns.set(e,n),n.buildCache("top"),n.buildCache("bottom"),n.buildCache("center"),this.debouncePinnedEvent(),this.debounceModelEvent()}dispatchCellsUpdatedEvent(e){this.dispatchLocalEvent({type:"spannedCellsUpdated",pinned:e})}deregister(e){this.spanningColumns.delete(e)}onRowDataUpdated({node:e}){const{spannedRowRenderer:t}=this.beans;if(e.rowPinned){if(this.pinnedTimeout!=null)return;this.pinnedTimeout=window.setTimeout(()=>{this.pinnedTimeout=null,this.buildPinnedCaches(),t?.createCtrls("top"),t?.createCtrls("bottom")},0);return}this.modelTimeout==null&&(this.modelTimeout=window.setTimeout(()=>{this.modelTimeout=null,this.buildModelCaches(),t?.createCtrls("center")},0))}buildModelCaches(){this.modelTimeout!=null&&clearTimeout(this.modelTimeout),this.spanningColumns.forEach(e=>e.buildCache("center")),this.debounceModelEvent()}buildPinnedCaches(){this.pinnedTimeout!=null&&clearTimeout(this.pinnedTimeout),this.spanningColumns.forEach(e=>{e.buildCache("top"),e.buildCache("bottom")}),this.debouncePinnedEvent()}isCellSpanning(e,t){const n=this.spanningColumns.get(e);return n?n.isCellSpanning(t):!1}getCellSpanByPosition(e){const{pinnedRowModel:t,rowModel:n}=this.beans,i=e.column,r=e.rowIndex,s=this.spanningColumns.get(i);if(!s)return;let o;switch(e.rowPinned){case"top":o=t?.getPinnedTopRow(r);break;case"bottom":o=t?.getPinnedBottomRow(r);break;default:o=n.getRow(r)}if(o)return s.getCellSpan(o)}getCellStart(e){const t=this.getCellSpanByPosition(e);return t?{...e,rowIndex:t.firstNode.rowIndex}:e}getCellEnd(e){const t=this.getCellSpanByPosition(e);return t?{...e,rowIndex:t.getLastNode().rowIndex}:e}getCellSpan(e,t){const n=this.spanningColumns.get(e);if(n)return n.getCellSpan(t)}forEachSpannedColumn(e,t){for(const[n,i]of this.spanningColumns)if(i.isCellSpanning(e)){const r=i.getCellSpan(e);t(n,r)}}destroy(){super.destroy(),this.spanningColumns.clear()}},UZe={moduleName:"CellSpan",version:we,beans:[WZe,zZe]},qZe=class extends Z{constructor(e,t){super(),this.cellCtrl=e,this.staticClasses=[],this.beans=t,this.column=e.column}setComp(e){this.cellComp=e,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()}applyCellClassRules(){const{column:e,cellComp:t}=this,n=e.colDef,i=n.cellClassRules,r=this.getCellClassParams(e,n);bN(this.beans.expressionSvc,i===this.cellClassRules?void 0:this.cellClassRules,i,r,s=>t.addOrRemoveCssClass(s,!0),s=>t.addOrRemoveCssClass(s,!1)),this.cellClassRules=i}applyUserStyles(){const e=this.column,t=e.colDef,n=t.cellStyle;if(!n)return;let i;if(typeof n=="function"){const r=this.getCellClassParams(e,t);i=n(r)}else i=n;i&&this.cellComp.setUserStyles(i)}applyClassesFromColDef(){const{column:e,cellComp:t}=this,n=e.colDef,i=this.getCellClassParams(e,n);this.staticClasses.forEach(s=>t.addOrRemoveCssClass(s,!1));const r=this.beans.cellStyles.getStaticCellClasses(n,i);this.staticClasses=r,r.forEach(s=>t.addOrRemoveCssClass(s,!0))}getCellClassParams(e,t){const{value:n,rowNode:i}=this.cellCtrl;return ze(this.beans.gos,{value:n,data:i.data,node:i,colDef:t,column:e,rowIndex:i.rowIndex})}},jZe=class extends Z{constructor(){super(...arguments),this.beanName="cellStyles"}processAllCellClasses(e,t,n,i){bN(this.beans.expressionSvc,void 0,e.cellClassRules,t,n,i),this.processStaticCellClasses(e,t,n)}getStaticCellClasses(e,t){const{cellClass:n}=e;if(!n)return[];let i;return typeof n=="function"?i=n(t):i=n,typeof i=="string"&&(i=[i]),i||[]}createCellCustomStyleFeature(e,t){return new qZe(e,t)}processStaticCellClasses(e,t,n){this.getStaticCellClasses(e,t).forEach(r=>{n(r)})}},KZe={moduleName:"CellStyle",version:we,beans:[jZe]},YZe={moduleName:"RowStyle",version:we,beans:[R4e]};function XZe(e,t){return!!e.colHover?.isHovered(t)}var QZe=class extends Z{constructor(e,t){super(),this.columns=e,this.element=t,this.destroyManagedListeners=[],this.enableFeature=n=>{const{beans:i,gos:r,element:s,columns:o}=this,a=i.colHover;n??!!r.get("columnHoverHighlight")?this.destroyManagedListeners=this.addManagedElementListeners(s,{mouseover:a.setMouseOver.bind(a,o),mouseout:a.clearMouseOver.bind(a)}):(this.destroyManagedListeners.forEach(u=>u()),this.destroyManagedListeners=[])}}postConstruct(){this.addManagedPropertyListener("columnHoverHighlight",({currentValue:e})=>{this.enableFeature(e)}),this.enableFeature()}destroy(){super.destroy(),this.destroyManagedListeners=null}},ZZe="ag-column-hover",JZe=class extends Z{constructor(){super(...arguments),this.beanName="colHover"}postConstruct(){this.addManagedPropertyListener("columnHoverHighlight",({currentValue:e})=>{e||this.clearMouseOver()})}setMouseOver(e){this.updateState(e)}clearMouseOver(){this.updateState(null)}isHovered(e){if(!this.gos.get("columnHoverHighlight"))return!1;const t=this.selectedColumns;return!!t&&t.indexOf(e)>=0}addHeaderColumnHoverListener(e,t,n){const i=()=>{const r=this.isHovered(n);t.addOrRemoveCssClass("ag-column-hover",r)};e.addManagedEventListeners({columnHoverChanged:i}),i()}onCellColumnHover(e,t){if(!t)return;const n=this.isHovered(e);t.addOrRemoveCssClass(ZZe,n)}addHeaderFilterColumnHoverListener(e,t,n,i){this.createHoverFeature(e,[n],i);const r=()=>{const s=this.isHovered(n);t.addOrRemoveCssClass("ag-column-hover",s)};e.addManagedEventListeners({columnHoverChanged:r}),r()}createHoverFeature(e,t,n){e.createManagedBean(new QZe(t,n))}updateState(e){this.selectedColumns=e,this.eventSvc.dispatchEvent({type:"columnHoverChanged"})}},eJe={moduleName:"ColumnHover",version:we,beans:[JZe],apiFunctions:{isColumnHovered:XZe}},tJe=class extends Z{constructor(){super(...arguments),this.beanName="apiEventSvc",this.syncListeners=new Map,this.asyncListeners=new Map,this.syncGlobalListeners=new Set,this.globalListenerPairs=new Map}postConstruct(){this.wrapSvc=this.beans.frameworkOverrides.createGlobalEventListenerWrapper?.()}addEventListener(e,t){const n=this.wrapSvc?.wrap(t)??t,i=!Iv.has(e),r=i?this.asyncListeners:this.syncListeners;r.has(e)||r.set(e,new Set),r.get(e).add(n),this.eventSvc.addEventListener(e,n,i)}removeEventListener(e,t){const n=this.wrapSvc?.unwrap(t)??t,r=!!this.asyncListeners.get(e)?.delete(n);r||this.syncListeners.get(e)?.delete(n),this.eventSvc.removeEventListener(e,n,r)}addGlobalListener(e){const t=this.wrapSvc?.wrapGlobal(e)??e,n=(s,o)=>{Iv.has(s)&&t(s,o)},i=(s,o)=>{Iv.has(s)||t(s,o)};this.globalListenerPairs.set(e,{syncListener:n,asyncListener:i});const r=this.eventSvc;r.addGlobalListener(n,!1),r.addGlobalListener(i,!0)}removeGlobalListener(e){const{eventSvc:t,wrapSvc:n,globalListenerPairs:i}=this,r=n?.unwrapGlobal(e)??e;if(i.has(r)){const{syncListener:o,asyncListener:a}=i.get(r);t.removeGlobalListener(o,!1),t.removeGlobalListener(a,!0),i.delete(e)}else this.syncGlobalListeners.delete(r),t.removeGlobalListener(r,!1)}destroyEventListeners(e,t){e.forEach((n,i)=>{n.forEach(r=>this.eventSvc.removeEventListener(i,r,t)),n.clear()}),e.clear()}destroyGlobalListeners(e,t){e.forEach(n=>this.eventSvc.removeGlobalListener(n,t)),e.clear()}destroy(){super.destroy(),this.destroyEventListeners(this.syncListeners,!1),this.destroyEventListeners(this.asyncListeners,!0),this.destroyGlobalListeners(this.syncGlobalListeners,!1);const{globalListenerPairs:e,eventSvc:t}=this;e.forEach(({syncListener:n,asyncListener:i})=>{t.removeGlobalListener(n,!1),t.removeGlobalListener(i,!0)}),e.clear()}};function nJe(e,t,n){e.apiEventSvc?.addEventListener(t,n)}function iJe(e,t,n){e.apiEventSvc?.removeEventListener(t,n)}function rJe(e,t){e.apiEventSvc?.addGlobalListener(t)}function sJe(e,t){e.apiEventSvc?.removeGlobalListener(t)}var oJe={moduleName:"EventApi",version:we,apiFunctions:{addEventListener:nJe,addGlobalListener:rJe,removeEventListener:iJe,removeGlobalListener:sJe},beans:[tJe]},aJe=".ag-tooltip{background-color:var(--ag-tooltip-background-color);border:var(--ag-tooltip-border);border-radius:var(--ag-border-radius);color:var(--ag-tooltip-text-color);padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);white-space:normal}.ag-tooltip,.ag-tooltip-custom{position:absolute;z-index:99999}.ag-tooltip-custom:where(:not(.ag-tooltip-interactive)),.ag-tooltip:where(:not(.ag-tooltip-interactive)){pointer-events:none}.ag-tooltip-animate{transition:opacity 1s;&:where(.ag-tooltip-hiding){opacity:0}}",lJe=class extends Z{constructor(){super(...arguments),this.beanName="tooltipSvc"}setupHeaderTooltip(e,t,n,i){e&&t.destroyBean(e);const r=XD(this.gos),{column:s,eGui:o}=t,a=s.getColDef();!i&&r&&!a.headerComponent&&(i=yb(()=>o.querySelector(".ag-header-cell-text")));const l={getColumn:()=>s,getColDef:()=>s.getColDef(),getGui:()=>o,getLocation:()=>"header",getTooltipValue:()=>n??s.getColDef().headerTooltip,shouldDisplayTooltip:i};let u=this.createTooltipFeature(l);return u&&(u=t.createBean(u),t.setRefreshFunction("tooltip",()=>u.refreshTooltip())),u}setupHeaderGroupTooltip(e,t,n,i){e&&t.destroyBean(e);const r=XD(this.gos),{column:s,eGui:o}=t,a=s.getColGroupDef();!i&&r&&!a?.headerGroupComponent&&(i=yb(()=>o.querySelector(".ag-header-group-text")));const l={getColumn:()=>s,getGui:()=>o,getLocation:()=>"headerGroup",getTooltipValue:()=>n??(a&&a.headerTooltip),shouldDisplayTooltip:i};a&&(l.getColDef=()=>a);const u=this.createTooltipFeature(l);return u&&t.createBean(u)}enableCellTooltipFeature(e,t,n){const{column:i,rowNode:r}=e,s=()=>{const l=i.getColDef(),u=r.data;if(l.tooltipField&&Ce(u))return kv(u,l.tooltipField,i.isTooltipFieldContainsDots());const c=l.tooltipValueGetter;return c?c(ze(this.gos,{location:"cell",colDef:i.getColDef(),column:i,rowIndex:e.cellPosition.rowIndex,node:r,data:r.data,value:e.value,valueFormatted:e.valueFormatted})):null},o=XD(this.gos);!n&&o&&!e.isCellRenderer()&&(n=yb(()=>{const l=e.eGui;return l.children.length===0?l:l.querySelector(".ag-cell-value")}));const a={getColumn:()=>i,getColDef:()=>i.getColDef(),getRowIndex:()=>e.cellPosition.rowIndex,getRowNode:()=>r,getGui:()=>e.eGui,getLocation:()=>"cell",getTooltipValue:t!=null?()=>t:s,getValueFormatted:()=>e.valueFormatted,shouldDisplayTooltip:n};return this.createTooltipFeature(a,this.beans)}refreshRowTooltip(e,t,n,i){const r={getGui:()=>t.getFullWidthElement(),getTooltipValue:()=>n,getLocation:()=>"fullWidthRow",shouldDisplayTooltip:i},s=this.beans,o=s.context;e&&t.destroyBean(e,o);const a=this.createTooltipFeature(r,s);return t.createBean(a,o)}initCol(e){const{colDef:t}=e;e.tooltipEnabled=Ce(t.tooltipField)||Ce(t.tooltipValueGetter)||Ce(t.tooltipComponent)}createTooltipFeature(e,t){return this.beans.registry.createDynamicBean("tooltipFeature",!1,e,t)}},uJe={moduleName:"Tooltip",version:we,beans:[lJe],dynamicBeans:{tooltipFeature:K8e},userComponents:{agTooltipComponent:Zje},dependsOn:[QR],css:[aJe]},cJe={moduleName:"Locale",version:we,beans:[Vje]},dJe=class extends Z{constructor(){super(...arguments),this.beanName="rowAutoHeight",this.wasEverActive=!1,this._debouncedCalculateRowHeights=yi(this,this.calculateRowHeights.bind(this),1)}requestCheckAutoHeight(){this.wasEverActive&&this._debouncedCalculateRowHeights()}calculateRowHeights(){const{visibleCols:e,rowModel:t,rowSpanSvc:n,pinnedRowModel:i}=this.beans,r=e.autoHeightCols;let s=!1;const o=a=>{const l=a.__autoHeights;let u=Np(this.beans,a).height;for(const c of r){let d=l?.[c.getColId()];const h=n?.getCellSpan(c,a);if(h){if(h.getLastNode()!==a)continue;if(d=n?.getCellSpan(c,a)?.getLastNodeAutoHeight(),!d)return}if(d==null){if(this.colSpanSkipCell(c,a))continue;return}u=Math.max(d,u)}u!==a.rowHeight&&(a.setRowHeight(u),s=!0)};i?.forEachPinnedRow?.("top",o),i?.forEachPinnedRow?.("bottom",o),t.forEachDisplayedNode?.(o),s&&t.onRowHeightChanged?.()}setRowAutoHeight(e,t,n){if(e.__autoHeights??(e.__autoHeights={}),t==null){delete e.__autoHeights[n.getId()];return}const i=e.__autoHeights[n.getId()];e.__autoHeights[n.getId()]=t,i!==t&&this.requestCheckAutoHeight()}colSpanSkipCell(e,t){const{colModel:n,colViewport:i,visibleCols:r}=this.beans;if(!n.colSpanActive)return!1;let s=[];switch(e.getPinned()){case"left":s=r.getLeftColsForRow(t);break;case"right":s=r.getRightColsForRow(t);break;case null:s=i.getColsWithinViewport(t);break}return!s.includes(e)}setupCellAutoHeight(e,t,n){if(!e.column.isAutoHeight()||!t)return!1;this.wasEverActive=!0;const i=t.parentElement,{rowNode:r,column:s}=e,o=this.beans,a=c=>{if(e.editing||!e.isAlive()||!n.isAlive())return;const{paddingTop:d,paddingBottom:h,borderBottomWidth:p,borderTopWidth:g}=Lh(i),m=d+h+p+g,y=t.offsetHeight+m;if(c<5){const b=Pn(o),S=!b||!b.contains(t),x=y==0;if(S||x){window.setTimeout(()=>a(c+1),0);return}}this.setRowAutoHeight(r,y,s)},l=()=>a(0);l();const u=_c(o,t,l);return n.addDestroyFunc(()=>{u(),this.setRowAutoHeight(r,void 0,s)}),!0}setAutoHeightActive(e){this.active=e.list.some(t=>t.isVisible()&&t.isAutoHeight())}},hJe={moduleName:"RowAutoHeight",version:we,beans:[dJe]},fJe={moduleName:"AllCommunity",version:we,dependsOn:[uQe,vQe,AQe,MKe,gXe,mXe,vXe,CXe,yXe,wXe,bXe,pXe,EYe,FYe,AYe,RYe,kYe,PYe,VQe,UXe,lZe,u7e,Dne,CZe,FZe,TZe,HUe,$Ze,OXe,Mje,KZe,eJe,YZe,oJe,_je,NQe,uJe,cJe,hJe,zUe,cQe,UZe]},pJe=Object.defineProperty,gJe=(e,t,n)=>t in e?pJe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Jf=(e,t,n)=>gJe(e,typeof t!="symbol"?t+"":t,n);class P0{static getComponentDefinition(t,n){let i;return typeof t=="string"?i=this.searchForComponentInstance(n,t):i={extends:mh({...t})},i||Ft(114,{component:t}),i.extends?(i.extends.setup&&(i.setup=i.extends.setup),i.extends.props=this.addParamsToProps(i.extends.props)):i.props=this.addParamsToProps(i.props),i}static addParamsToProps(t){return!t||Array.isArray(t)&&t.indexOf("params")===-1?t=["params",...t||[]]:typeof t=="object"&&!t.params&&(t.params={type:Object}),t}static createAndMountComponent(t,n,i,r){const s=P0.getComponentDefinition(t,i);if(!s)return;const{vNode:o,destroy:a,el:l}=this.mount(s,{params:Object.freeze(n)},i,r||{});return{componentInstance:o.component.proxy,element:l,destroy:a}}static mount(t,n,i,r){let s=jr(t,n);s.appContext={...i.appContext,provides:r};let o=document.createElement("div");return l3(s,o),{vNode:s,destroy:()=>{o&&l3(null,o),o=null,s=null},el:o}}static searchForComponentInstance(t,n,i=10,r=!1){let s=null,o=0,a=t.parent;for(;!s&&a&&a.components&&++o<i;)a.components&&a.components[n]&&(s=a.components[n]),a=a.parent;for(o=0,a=t.parent;!s&&a&&a.$options&&++o<i;){const l=a;l.$options&&l.$options.components&&l.$options.components[n]?s=l.$options.components[n]:l[n]&&(s=l[n]),a=a.parent}for(o=0,a=t.parent;!s&&a&&++o<i;){if(a.exposed){const l=a;l.exposed&&l.exposed[n]?s=l.exposed[n]:l[n]&&(s=l[n])}a=a.parent}if(!s){const l=t.appContext.components;l&&l[n]&&(s=l[n])}return!s&&!r?(Ft(114,{component:n}),null):s}}class mJe extends Xje{constructor(t,n){super(),Jf(this,"parent"),Jf(this,"provides"),this.parent=t,this.provides=n}createWrapper(t){const n=this;class i extends vJe{init(o){super.init(o)}hasMethod(o){var a,l;const u=r.getFrameworkComponentInstance();return u[o]?!0:((a=u.$.exposed)==null?void 0:a[o])!=null||((l=u.exposed)==null?void 0:l[o])!=null||u.$.setupState[o]!=null}callMethod(o,a){var l,u;const c=this.getFrameworkComponentInstance(),d=r.getFrameworkComponentInstance();if(d[o])return d[o].apply(c,a);{const h=((l=c.$.exposed)==null?void 0:l[o])||((u=c.exposed)==null?void 0:u[o])||c.$.setupState[o];return h?.apply(c,a)}}addMethod(o,a){r[o]=a}processMethod(o,a){return o==="refresh"&&(this.getFrameworkComponentInstance().params=a[0]),this.hasMethod(o)?this.callMethod(o,a):o==="refresh"}createComponent(o){return n.createComponent(t,o)}}const r=new i;return r}createComponent(t,n){return P0.createAndMountComponent(t,n,this.parent,this.provides)}createMethodProxy(t,n,i){return function(){return t.hasMethod(n)?t.callMethod(n,arguments):(i&&de(233,{methodName:n}),null)}}destroy(){this.parent=null}}class vJe{constructor(){Jf(this,"componentInstance"),Jf(this,"element"),Jf(this,"unmount")}getGui(){return this.element}destroy(){this.getFrameworkComponentInstance()&&typeof this.getFrameworkComponentInstance().destroy=="function"&&this.getFrameworkComponentInstance().destroy(),this.unmount()}getFrameworkComponentInstance(){return this.componentInstance}init(t){const{componentInstance:n,element:i,destroy:r}=this.createComponent(t);this.componentInstance=n,this.unmount=r,this.element=i.firstElementChild??i}}class CJe extends Ate{constructor(t){super("vue"),Jf(this,"parent"),this.parent=t}frameworkComponent(t,n){let i=P0.searchForComponentInstance(this.parent,t,10,!0)?t:null;if(!i&&n&&n[t]){const r=n[t];i=P0.searchForComponentInstance(this.parent,r,10,!0)?r:null}return i}isFrameworkComponent(t){return typeof t=="object"}}function yJe(){return{gridOptions:{},modules:[],statusBar:void 0,sideBar:void 0,suppressContextMenu:void 0,preventDefaultOnContextMenu:void 0,allowContextMenuWithControlKey:void 0,columnMenu:void 0,suppressMenuHide:void 0,enableBrowserTooltips:void 0,tooltipTrigger:void 0,tooltipShowDelay:void 0,tooltipHideDelay:void 0,tooltipMouseTrack:void 0,tooltipShowMode:void 0,tooltipInteraction:void 0,popupParent:void 0,copyHeadersToClipboard:void 0,copyGroupHeadersToClipboard:void 0,clipboardDelimiter:void 0,suppressCopyRowsToClipboard:void 0,suppressCopySingleCellRanges:void 0,suppressLastEmptyLineOnPaste:void 0,suppressClipboardPaste:void 0,suppressClipboardApi:void 0,suppressCutToClipboard:void 0,columnDefs:void 0,defaultColDef:void 0,defaultColGroupDef:void 0,columnTypes:void 0,dataTypeDefinitions:void 0,maintainColumnOrder:void 0,enableStrictPivotColumnOrder:void 0,suppressFieldDotNotation:void 0,headerHeight:void 0,groupHeaderHeight:void 0,floatingFiltersHeight:void 0,pivotHeaderHeight:void 0,pivotGroupHeaderHeight:void 0,allowDragFromColumnsToolPanel:void 0,suppressMovableColumns:void 0,suppressColumnMoveAnimation:void 0,suppressMoveWhenColumnDragging:void 0,suppressDragLeaveHidesColumns:void 0,suppressGroupChangesColumnVisibility:void 0,suppressMakeColumnVisibleAfterUnGroup:void 0,suppressRowGroupHidesColumns:void 0,colResizeDefault:void 0,suppressAutoSize:void 0,autoSizePadding:void 0,skipHeaderOnAutoSize:void 0,autoSizeStrategy:void 0,components:void 0,editType:void 0,singleClickEdit:void 0,suppressClickEdit:void 0,readOnlyEdit:void 0,stopEditingWhenCellsLoseFocus:void 0,enterNavigatesVertically:void 0,enterNavigatesVerticallyAfterEdit:void 0,enableCellEditingOnBackspace:void 0,undoRedoCellEditing:void 0,undoRedoCellEditingLimit:void 0,defaultCsvExportParams:void 0,suppressCsvExport:void 0,defaultExcelExportParams:void 0,suppressExcelExport:void 0,excelStyles:void 0,findSearchValue:void 0,findOptions:void 0,quickFilterText:void 0,cacheQuickFilter:void 0,includeHiddenColumnsInQuickFilter:void 0,quickFilterParser:void 0,quickFilterMatcher:void 0,applyQuickFilterBeforePivotOrAgg:void 0,excludeChildrenWhenTreeDataFiltering:void 0,enableAdvancedFilter:void 0,alwaysPassFilter:void 0,includeHiddenColumnsInAdvancedFilter:void 0,advancedFilterParent:void 0,advancedFilterBuilderParams:void 0,suppressAdvancedFilterEval:void 0,suppressSetFilterByDefault:void 0,enableCharts:void 0,chartThemes:void 0,customChartThemes:void 0,chartThemeOverrides:void 0,chartToolPanelsDef:void 0,chartMenuItems:void 0,loadingCellRenderer:void 0,loadingCellRendererParams:void 0,loadingCellRendererSelector:void 0,localeText:void 0,masterDetail:void 0,keepDetailRows:void 0,keepDetailRowsCount:void 0,detailCellRenderer:void 0,detailCellRendererParams:void 0,detailRowHeight:void 0,detailRowAutoHeight:void 0,context:void 0,dragAndDropImageComponent:void 0,dragAndDropImageComponentParams:void 0,alignedGrids:void 0,tabIndex:void 0,rowBuffer:void 0,valueCache:void 0,valueCacheNeverExpires:void 0,enableCellExpressions:void 0,suppressTouch:void 0,suppressFocusAfterRefresh:void 0,suppressBrowserResizeObserver:void 0,suppressPropertyNamesCheck:void 0,suppressChangeDetection:void 0,debug:void 0,loading:void 0,overlayLoadingTemplate:void 0,loadingOverlayComponent:void 0,loadingOverlayComponentParams:void 0,suppressLoadingOverlay:void 0,overlayNoRowsTemplate:void 0,noRowsOverlayComponent:void 0,noRowsOverlayComponentParams:void 0,suppressNoRowsOverlay:void 0,pagination:void 0,paginationPageSize:void 0,paginationPageSizeSelector:void 0,paginationAutoPageSize:void 0,paginateChildRows:void 0,suppressPaginationPanel:void 0,pivotMode:void 0,pivotPanelShow:void 0,pivotMaxGeneratedColumns:void 0,pivotDefaultExpanded:void 0,pivotColumnGroupTotals:void 0,pivotRowTotals:void 0,pivotSuppressAutoColumn:void 0,suppressExpandablePivotGroups:void 0,functionsReadOnly:void 0,aggFuncs:void 0,suppressAggFuncInHeader:void 0,alwaysAggregateAtRootLevel:void 0,aggregateOnlyChangedColumns:void 0,suppressAggFilteredOnly:void 0,removePivotHeaderRowWhenSingleValueColumn:void 0,animateRows:void 0,cellFlashDuration:void 0,cellFadeDuration:void 0,allowShowChangeAfterFilter:void 0,domLayout:void 0,ensureDomOrder:void 0,enableCellSpan:void 0,enableRtl:void 0,suppressColumnVirtualisation:void 0,suppressMaxRenderedRowRestriction:void 0,suppressRowVirtualisation:void 0,rowDragManaged:void 0,suppressRowDrag:void 0,suppressMoveWhenRowDragging:void 0,rowDragEntireRow:void 0,rowDragMultiRow:void 0,rowDragText:void 0,fullWidthCellRenderer:void 0,fullWidthCellRendererParams:void 0,embedFullWidthRows:void 0,groupDisplayType:void 0,groupDefaultExpanded:void 0,autoGroupColumnDef:void 0,groupMaintainOrder:void 0,groupSelectsChildren:void 0,groupLockGroupColumns:void 0,groupAggFiltering:void 0,groupTotalRow:void 0,grandTotalRow:void 0,suppressStickyTotalRow:void 0,groupSuppressBlankHeader:void 0,groupSelectsFiltered:void 0,showOpenedGroup:void 0,groupHideParentOfSingleChild:void 0,groupRemoveSingleChildren:void 0,groupRemoveLowestSingleChildren:void 0,groupHideOpenParents:void 0,groupAllowUnbalanced:void 0,rowGroupPanelShow:void 0,groupRowRenderer:void 0,groupRowRendererParams:void 0,treeData:void 0,treeDataChildrenField:void 0,treeDataParentIdField:void 0,rowGroupPanelSuppressSort:void 0,suppressGroupRowsSticky:void 0,pinnedTopRowData:void 0,pinnedBottomRowData:void 0,rowModelType:void 0,rowData:void 0,asyncTransactionWaitMillis:void 0,suppressModelUpdateAfterUpdateTransaction:void 0,datasource:void 0,cacheOverflowSize:void 0,infiniteInitialRowCount:void 0,serverSideInitialRowCount:void 0,suppressServerSideFullWidthLoadingRow:void 0,cacheBlockSize:void 0,maxBlocksInCache:void 0,maxConcurrentDatasourceRequests:void 0,blockLoadDebounceMillis:void 0,purgeClosedRowNodes:void 0,serverSideDatasource:void 0,serverSideSortAllLevels:void 0,serverSideEnableClientSideSort:void 0,serverSideOnlyRefreshFilteredGroups:void 0,serverSidePivotResultFieldSeparator:void 0,viewportDatasource:void 0,viewportRowModelPageSize:void 0,viewportRowModelBufferSize:void 0,alwaysShowHorizontalScroll:void 0,alwaysShowVerticalScroll:void 0,debounceVerticalScrollbar:void 0,suppressHorizontalScroll:void 0,suppressScrollOnNewData:void 0,suppressScrollWhenPopupsAreOpen:void 0,suppressAnimationFrame:void 0,suppressMiddleClickScrolls:void 0,suppressPreventDefaultOnMouseWheel:void 0,scrollbarWidth:void 0,rowSelection:void 0,cellSelection:void 0,rowMultiSelectWithClick:void 0,suppressRowDeselection:void 0,suppressRowClickSelection:void 0,suppressCellFocus:void 0,suppressHeaderFocus:void 0,selectionColumnDef:void 0,rowNumbers:void 0,suppressMultiRangeSelection:void 0,enableCellTextSelection:void 0,enableRangeSelection:void 0,enableRangeHandle:void 0,enableFillHandle:void 0,fillHandleDirection:void 0,suppressClearOnFillReduction:void 0,sortingOrder:void 0,accentedSort:void 0,unSortIcon:void 0,suppressMultiSort:void 0,alwaysMultiSort:void 0,multiSortKey:void 0,suppressMaintainUnsortedOrder:void 0,icons:void 0,rowHeight:void 0,rowStyle:void 0,rowClass:void 0,rowClassRules:void 0,suppressRowHoverHighlight:void 0,suppressRowTransform:void 0,columnHoverHighlight:void 0,gridId:void 0,deltaSort:void 0,treeDataDisplayType:void 0,enableGroupEdit:void 0,initialState:void 0,theme:void 0,loadThemeGoogleFonts:void 0,themeCssLayer:void 0,styleNonce:void 0,themeStyleContainer:void 0,getContextMenuItems:void 0,getMainMenuItems:void 0,postProcessPopup:void 0,processUnpinnedColumns:void 0,processCellForClipboard:void 0,processHeaderForClipboard:void 0,processGroupHeaderForClipboard:void 0,processCellFromClipboard:void 0,sendToClipboard:void 0,processDataFromClipboard:void 0,isExternalFilterPresent:void 0,doesExternalFilterPass:void 0,getChartToolbarItems:void 0,createChartContainer:void 0,focusGridInnerElement:void 0,navigateToNextHeader:void 0,tabToNextHeader:void 0,navigateToNextCell:void 0,tabToNextCell:void 0,getLocaleText:void 0,getDocument:void 0,paginationNumberFormatter:void 0,getGroupRowAgg:void 0,isGroupOpenByDefault:void 0,initialGroupOrderComparator:void 0,processPivotResultColDef:void 0,processPivotResultColGroupDef:void 0,getDataPath:void 0,getChildCount:void 0,getServerSideGroupLevelParams:void 0,isServerSideGroupOpenByDefault:void 0,isApplyServerSideTransaction:void 0,isServerSideGroup:void 0,getServerSideGroupKey:void 0,getBusinessKeyForNode:void 0,getRowId:void 0,resetRowDataOnUpdate:void 0,processRowPostCreate:void 0,isRowSelectable:void 0,isRowMaster:void 0,fillOperation:void 0,postSortRows:void 0,getRowStyle:void 0,getRowClass:void 0,getRowHeight:void 0,isFullWidthRow:void 0,"onColumn-everything-changed":void 0,"onNew-columns-loaded":void 0,"onColumn-pivot-mode-changed":void 0,"onPivot-max-columns-exceeded":void 0,"onColumn-row-group-changed":void 0,"onExpand-or-collapse-all":void 0,"onColumn-pivot-changed":void 0,"onGrid-columns-changed":void 0,"onColumn-value-changed":void 0,"onColumn-moved":void 0,"onColumn-visible":void 0,"onColumn-pinned":void 0,"onColumn-group-opened":void 0,"onColumn-resized":void 0,"onDisplayed-columns-changed":void 0,"onVirtual-columns-changed":void 0,"onColumn-header-mouse-over":void 0,"onColumn-header-mouse-leave":void 0,"onColumn-header-clicked":void 0,"onColumn-header-context-menu":void 0,"onAsync-transactions-flushed":void 0,"onRow-group-opened":void 0,"onRow-data-updated":void 0,"onPinned-row-data-changed":void 0,"onRange-selection-changed":void 0,"onCell-selection-changed":void 0,"onChart-created":void 0,"onChart-range-selection-changed":void 0,"onChart-options-changed":void 0,"onChart-destroyed":void 0,"onTool-panel-visible-changed":void 0,"onTool-panel-size-changed":void 0,"onModel-updated":void 0,"onCut-start":void 0,"onCut-end":void 0,"onPaste-start":void 0,"onPaste-end":void 0,"onFill-start":void 0,"onFill-end":void 0,"onCell-selection-delete-start":void 0,"onCell-selection-delete-end":void 0,"onRange-delete-start":void 0,"onRange-delete-end":void 0,"onUndo-started":void 0,"onUndo-ended":void 0,"onRedo-started":void 0,"onRedo-ended":void 0,"onCell-clicked":void 0,"onCell-double-clicked":void 0,"onCell-mouse-down":void 0,"onCell-context-menu":void 0,"onCell-value-changed":void 0,"onCell-edit-request":void 0,"onRow-value-changed":void 0,"onHeader-focused":void 0,"onCell-focused":void 0,"onRow-selected":void 0,"onSelection-changed":void 0,"onTooltip-show":void 0,"onTooltip-hide":void 0,"onCell-key-down":void 0,"onCell-mouse-over":void 0,"onCell-mouse-out":void 0,"onFilter-changed":void 0,"onFilter-modified":void 0,"onFilter-opened":void 0,"onAdvanced-filter-builder-visible-changed":void 0,"onSort-changed":void 0,"onVirtual-row-removed":void 0,"onRow-clicked":void 0,"onRow-double-clicked":void 0,"onGrid-ready":void 0,"onGrid-pre-destroyed":void 0,"onGrid-size-changed":void 0,"onViewport-changed":void 0,"onFirst-data-rendered":void 0,"onDrag-started":void 0,"onDrag-stopped":void 0,"onDrag-cancelled":void 0,"onRow-editing-started":void 0,"onRow-editing-stopped":void 0,"onCell-editing-started":void 0,"onCell-editing-stopped":void 0,"onBody-scroll":void 0,"onBody-scroll-end":void 0,"onPagination-changed":void 0,"onComponent-state-changed":void 0,"onStore-refreshed":void 0,"onState-updated":void 0,"onColumn-menu-visible-changed":void 0,"onContext-menu-visible-changed":void 0,"onRow-drag-enter":void 0,"onRow-drag-move":void 0,"onRow-drag-leave":void 0,"onRow-drag-end":void 0,"onRow-drag-cancel":void 0,"onFind-changed":void 0}}const wJe=(e,t)=>{let n;return()=>{const i=function(){e()};window.clearTimeout(n),n=window.setTimeout(i,t)}};function bJe(e){return e&&e.constructor&&e.constructor.toString().substring(0,5)==="class"}function Im(e){const t=n=>bJe(n)?a3(n):Array.isArray(n)?n.map(i=>t(i)):bfe(n)||Sfe(n)||xfe(n)?t(a3(n)):n;return t(e)}const SJe={ref:"root"},xJe=mh({__name:"AgGridVue",props:o3(Rfe({gridOptions:{},modules:{},statusBar:{},sideBar:{type:[Object,String,Array,Boolean,null]},suppressContextMenu:{type:Boolean},preventDefaultOnContextMenu:{type:Boolean},allowContextMenuWithControlKey:{type:Boolean},columnMenu:{},suppressMenuHide:{type:Boolean},enableBrowserTooltips:{type:Boolean},tooltipTrigger:{},tooltipShowDelay:{},tooltipHideDelay:{},tooltipMouseTrack:{type:Boolean},tooltipShowMode:{},tooltipInteraction:{type:Boolean},popupParent:{},copyHeadersToClipboard:{type:Boolean},copyGroupHeadersToClipboard:{type:Boolean},clipboardDelimiter:{},suppressCopyRowsToClipboard:{type:Boolean},suppressCopySingleCellRanges:{type:Boolean},suppressLastEmptyLineOnPaste:{type:Boolean},suppressClipboardPaste:{type:Boolean},suppressClipboardApi:{type:Boolean},suppressCutToClipboard:{type:Boolean},columnDefs:{},defaultColDef:{},defaultColGroupDef:{},columnTypes:{},dataTypeDefinitions:{},maintainColumnOrder:{type:Boolean},enableStrictPivotColumnOrder:{type:Boolean},suppressFieldDotNotation:{type:Boolean},headerHeight:{},groupHeaderHeight:{},floatingFiltersHeight:{},pivotHeaderHeight:{},pivotGroupHeaderHeight:{},allowDragFromColumnsToolPanel:{type:Boolean},suppressMovableColumns:{type:Boolean},suppressColumnMoveAnimation:{type:Boolean},suppressMoveWhenColumnDragging:{type:Boolean},suppressDragLeaveHidesColumns:{type:Boolean},suppressGroupChangesColumnVisibility:{type:[Boolean,String]},suppressMakeColumnVisibleAfterUnGroup:{type:Boolean},suppressRowGroupHidesColumns:{type:Boolean},colResizeDefault:{},suppressAutoSize:{type:Boolean},autoSizePadding:{},skipHeaderOnAutoSize:{type:Boolean},autoSizeStrategy:{},components:{},editType:{},singleClickEdit:{type:Boolean},suppressClickEdit:{type:Boolean},readOnlyEdit:{type:Boolean},stopEditingWhenCellsLoseFocus:{type:Boolean},enterNavigatesVertically:{type:Boolean},enterNavigatesVerticallyAfterEdit:{type:Boolean},enableCellEditingOnBackspace:{type:Boolean},undoRedoCellEditing:{type:Boolean},undoRedoCellEditingLimit:{},defaultCsvExportParams:{},suppressCsvExport:{type:Boolean},defaultExcelExportParams:{},suppressExcelExport:{type:Boolean},excelStyles:{},findSearchValue:{},findOptions:{},quickFilterText:{},cacheQuickFilter:{type:Boolean},includeHiddenColumnsInQuickFilter:{type:Boolean},quickFilterParser:{type:Function},quickFilterMatcher:{type:Function},applyQuickFilterBeforePivotOrAgg:{type:Boolean},excludeChildrenWhenTreeDataFiltering:{type:Boolean},enableAdvancedFilter:{type:Boolean},alwaysPassFilter:{type:Function},includeHiddenColumnsInAdvancedFilter:{type:Boolean},advancedFilterParent:{},advancedFilterBuilderParams:{},suppressAdvancedFilterEval:{type:Boolean},suppressSetFilterByDefault:{type:Boolean},enableCharts:{type:Boolean},chartThemes:{},customChartThemes:{},chartThemeOverrides:{},chartToolPanelsDef:{},chartMenuItems:{type:[Array,Function]},loadingCellRenderer:{},loadingCellRendererParams:{},loadingCellRendererSelector:{type:Function},localeText:{},masterDetail:{type:Boolean},keepDetailRows:{type:Boolean},keepDetailRowsCount:{},detailCellRenderer:{},detailCellRendererParams:{},detailRowHeight:{},detailRowAutoHeight:{type:Boolean},context:{},dragAndDropImageComponent:{},dragAndDropImageComponentParams:{},alignedGrids:{type:[Array,Function]},tabIndex:{},rowBuffer:{},valueCache:{type:Boolean},valueCacheNeverExpires:{type:Boolean},enableCellExpressions:{type:Boolean},suppressTouch:{type:Boolean},suppressFocusAfterRefresh:{type:Boolean},suppressBrowserResizeObserver:{type:Boolean},suppressPropertyNamesCheck:{type:Boolean},suppressChangeDetection:{type:Boolean},debug:{type:Boolean},loading:{type:Boolean},overlayLoadingTemplate:{},loadingOverlayComponent:{},loadingOverlayComponentParams:{},suppressLoadingOverlay:{type:Boolean},overlayNoRowsTemplate:{},noRowsOverlayComponent:{},noRowsOverlayComponentParams:{},suppressNoRowsOverlay:{type:Boolean},pagination:{type:Boolean},paginationPageSize:{},paginationPageSizeSelector:{type:[Array,Boolean]},paginationAutoPageSize:{type:Boolean},paginateChildRows:{type:Boolean},suppressPaginationPanel:{type:Boolean},pivotMode:{type:Boolean},pivotPanelShow:{},pivotMaxGeneratedColumns:{},pivotDefaultExpanded:{},pivotColumnGroupTotals:{},pivotRowTotals:{},pivotSuppressAutoColumn:{type:Boolean},suppressExpandablePivotGroups:{type:Boolean},functionsReadOnly:{type:Boolean},aggFuncs:{},suppressAggFuncInHeader:{type:Boolean},alwaysAggregateAtRootLevel:{type:Boolean},aggregateOnlyChangedColumns:{type:Boolean},suppressAggFilteredOnly:{type:Boolean},removePivotHeaderRowWhenSingleValueColumn:{type:Boolean},animateRows:{type:Boolean},cellFlashDuration:{},cellFadeDuration:{},allowShowChangeAfterFilter:{type:Boolean},domLayout:{},ensureDomOrder:{type:Boolean},enableCellSpan:{type:Boolean},enableRtl:{type:Boolean},suppressColumnVirtualisation:{type:Boolean},suppressMaxRenderedRowRestriction:{type:Boolean},suppressRowVirtualisation:{type:Boolean},rowDragManaged:{type:Boolean},suppressRowDrag:{type:Boolean},suppressMoveWhenRowDragging:{type:Boolean},rowDragEntireRow:{type:Boolean},rowDragMultiRow:{type:Boolean},rowDragText:{type:Function},fullWidthCellRenderer:{},fullWidthCellRendererParams:{},embedFullWidthRows:{type:Boolean},groupDisplayType:{},groupDefaultExpanded:{},autoGroupColumnDef:{},groupMaintainOrder:{type:Boolean},groupSelectsChildren:{type:Boolean},groupLockGroupColumns:{},groupAggFiltering:{type:[Boolean,Function]},groupTotalRow:{type:[String,Function]},grandTotalRow:{},suppressStickyTotalRow:{type:[Boolean,String]},groupSuppressBlankHeader:{type:Boolean},groupSelectsFiltered:{type:Boolean},showOpenedGroup:{type:Boolean},groupHideParentOfSingleChild:{type:[Boolean,String]},groupRemoveSingleChildren:{type:Boolean},groupRemoveLowestSingleChildren:{type:Boolean},groupHideOpenParents:{type:Boolean},groupAllowUnbalanced:{type:Boolean},rowGroupPanelShow:{},groupRowRenderer:{},groupRowRendererParams:{},treeData:{type:Boolean},treeDataChildrenField:{},treeDataParentIdField:{},rowGroupPanelSuppressSort:{type:Boolean},suppressGroupRowsSticky:{type:Boolean},pinnedTopRowData:{},pinnedBottomRowData:{},rowModelType:{},rowData:{},asyncTransactionWaitMillis:{},suppressModelUpdateAfterUpdateTransaction:{type:Boolean},datasource:{},cacheOverflowSize:{},infiniteInitialRowCount:{},serverSideInitialRowCount:{},suppressServerSideFullWidthLoadingRow:{type:Boolean},cacheBlockSize:{},maxBlocksInCache:{},maxConcurrentDatasourceRequests:{},blockLoadDebounceMillis:{},purgeClosedRowNodes:{type:Boolean},serverSideDatasource:{},serverSideSortAllLevels:{type:Boolean},serverSideEnableClientSideSort:{type:Boolean},serverSideOnlyRefreshFilteredGroups:{type:Boolean},serverSidePivotResultFieldSeparator:{},viewportDatasource:{},viewportRowModelPageSize:{},viewportRowModelBufferSize:{},alwaysShowHorizontalScroll:{type:Boolean},alwaysShowVerticalScroll:{type:Boolean},debounceVerticalScrollbar:{type:Boolean},suppressHorizontalScroll:{type:Boolean},suppressScrollOnNewData:{type:Boolean},suppressScrollWhenPopupsAreOpen:{type:Boolean},suppressAnimationFrame:{type:Boolean},suppressMiddleClickScrolls:{type:Boolean},suppressPreventDefaultOnMouseWheel:{type:Boolean},scrollbarWidth:{},rowSelection:{},cellSelection:{type:[Boolean,Object]},rowMultiSelectWithClick:{type:Boolean},suppressRowDeselection:{type:Boolean},suppressRowClickSelection:{type:Boolean},suppressCellFocus:{type:Boolean},suppressHeaderFocus:{type:Boolean},selectionColumnDef:{},rowNumbers:{type:[Boolean,Object]},suppressMultiRangeSelection:{type:Boolean},enableCellTextSelection:{type:Boolean},enableRangeSelection:{type:Boolean},enableRangeHandle:{type:Boolean},enableFillHandle:{type:Boolean},fillHandleDirection:{},suppressClearOnFillReduction:{type:Boolean},sortingOrder:{},accentedSort:{type:Boolean},unSortIcon:{type:Boolean},suppressMultiSort:{type:Boolean},alwaysMultiSort:{type:Boolean},multiSortKey:{},suppressMaintainUnsortedOrder:{type:Boolean},icons:{},rowHeight:{},rowStyle:{},rowClass:{},rowClassRules:{},suppressRowHoverHighlight:{type:Boolean},suppressRowTransform:{type:Boolean},columnHoverHighlight:{type:Boolean},gridId:{},deltaSort:{type:Boolean},treeDataDisplayType:{},enableGroupEdit:{type:Boolean},initialState:{},theme:{},loadThemeGoogleFonts:{type:Boolean},themeCssLayer:{},styleNonce:{},themeStyleContainer:{},getContextMenuItems:{type:Function},getMainMenuItems:{type:Function},postProcessPopup:{type:Function},processUnpinnedColumns:{type:Function},processCellForClipboard:{type:Function},processHeaderForClipboard:{type:Function},processGroupHeaderForClipboard:{type:Function},processCellFromClipboard:{type:Function},sendToClipboard:{type:Function},processDataFromClipboard:{type:Function},isExternalFilterPresent:{type:Function},doesExternalFilterPass:{type:Function},getChartToolbarItems:{type:Function},createChartContainer:{type:Function},focusGridInnerElement:{type:Function},navigateToNextHeader:{type:Function},tabToNextHeader:{type:Function},navigateToNextCell:{type:Function},tabToNextCell:{type:Function},getLocaleText:{type:Function},getDocument:{type:Function},paginationNumberFormatter:{type:Function},getGroupRowAgg:{type:Function},isGroupOpenByDefault:{type:Function},initialGroupOrderComparator:{type:Function},processPivotResultColDef:{type:Function},processPivotResultColGroupDef:{type:Function},getDataPath:{type:Function},getChildCount:{type:Function},getServerSideGroupLevelParams:{type:Function},isServerSideGroupOpenByDefault:{type:Function},isApplyServerSideTransaction:{type:Function},isServerSideGroup:{type:Function},getServerSideGroupKey:{type:Function},getBusinessKeyForNode:{type:Function},getRowId:{type:Function},resetRowDataOnUpdate:{type:Boolean},processRowPostCreate:{type:Function},isRowSelectable:{type:Function},isRowMaster:{type:Function},fillOperation:{type:Function},postSortRows:{type:Function},getRowStyle:{type:Function},getRowClass:{type:Function},getRowHeight:{type:Function},isFullWidthRow:{type:Function},"onTool-panel-visible-changed":{},"onTool-panel-size-changed":{},"onColumn-menu-visible-changed":{},"onContext-menu-visible-changed":{},"onCut-start":{},"onCut-end":{},"onPaste-start":{},"onPaste-end":{},"onColumn-visible":{},"onColumn-pinned":{},"onColumn-resized":{},"onColumn-moved":{},"onColumn-value-changed":{},"onColumn-pivot-mode-changed":{},"onColumn-pivot-changed":{},"onColumn-group-opened":{},"onNew-columns-loaded":{},"onGrid-columns-changed":{},"onDisplayed-columns-changed":{},"onVirtual-columns-changed":{},"onColumn-everything-changed":{},"onColumn-header-mouse-over":{},"onColumn-header-mouse-leave":{},"onColumn-header-clicked":{},"onColumn-header-context-menu":{},"onComponent-state-changed":{},"onCell-value-changed":{},"onCell-edit-request":{},"onRow-value-changed":{},"onCell-editing-started":{},"onCell-editing-stopped":{},"onRow-editing-started":{},"onRow-editing-stopped":{},"onUndo-started":{},"onUndo-ended":{},"onRedo-started":{},"onRedo-ended":{},"onCell-selection-delete-start":{},"onCell-selection-delete-end":{},"onRange-delete-start":{},"onRange-delete-end":{},"onFill-start":{},"onFill-end":{},"onFilter-opened":{},"onFilter-changed":{},"onFilter-modified":{},"onAdvanced-filter-builder-visible-changed":{},"onFind-changed":{},"onChart-created":{},"onChart-range-selection-changed":{},"onChart-options-changed":{},"onChart-destroyed":{},"onCell-key-down":{},"onGrid-ready":{},"onGrid-pre-destroyed":{},"onFirst-data-rendered":{},"onGrid-size-changed":{},"onModel-updated":{},"onVirtual-row-removed":{},"onViewport-changed":{},"onBody-scroll":{},"onBody-scroll-end":{},"onDrag-started":{},"onDrag-stopped":{},"onDrag-cancelled":{},"onState-updated":{},"onPagination-changed":{},"onRow-drag-enter":{},"onRow-drag-move":{},"onRow-drag-leave":{},"onRow-drag-end":{},"onRow-drag-cancel":{},"onColumn-row-group-changed":{},"onRow-group-opened":{},"onExpand-or-collapse-all":{},"onPivot-max-columns-exceeded":{},"onPinned-row-data-changed":{},"onRow-data-updated":{},"onAsync-transactions-flushed":{},"onStore-refreshed":{},"onHeader-focused":{},"onCell-clicked":{},"onCell-double-clicked":{},"onCell-focused":{},"onCell-mouse-over":{},"onCell-mouse-out":{},"onCell-mouse-down":{},"onRow-clicked":{},"onRow-double-clicked":{},"onRow-selected":{},"onSelection-changed":{},"onCell-context-menu":{},"onRange-selection-changed":{},"onCell-selection-changed":{},"onTooltip-show":{},"onTooltip-hide":{},"onSort-changed":{}},yJe()),{modelValue:{},modelModifiers:{}}),emits:o3(["update:modelValue"],["update:modelValue"]),setup(e,{expose:t,emit:n}){const i=e,r=vfe("root"),s=Qe(void 0),o=Qe(!1),a=Qe(!1),l=Qe(!1),u=Qe({}),c=Qe(null),d=Cfe(i);vT.filter(D=>D!="gridOptions").forEach(D=>{Yt(()=>d[D],(M,O)=>{(D==="rowData"&&!m.value||D!=="rowData")&&F(D,M),m.value=!1},{deep:!0})});const h=new Set(["rowDataUpdated","cellValueChanged","rowValueChanged"]),p=yfe(e,"modelValue"),g=Qe(!1),m=Qe(!1),C=n;Yt(p,(D,M)=>{o.value&&(m.value||(g.value=!0,F("rowData",Im(D),Im(M))),m.value=!1)},{deep:!0});const y=wJe(()=>{m.value=!0,C("update:modelValue",E())},10),b=es(),S=D=>{var M,O;l.value&&h.has(D)&&(O=(M=b?.vnode)==null?void 0:M.props)!=null&&O["onUpdate:modelValue"]&&y()},x=()=>p.value||i.rowData||i.gridOptions.rowData,E=()=>{const D=[];return s?.value.forEachLeafNode(M=>{D.push(M.data)}),D},A=D=>M=>{if(a.value)return;M==="gridReady"&&(l.value=!0);const O=Iv.has(M);O&&!D||!O&&D||h.has(M)&&(g.value||S(M),g.value=!1)},F=(D,M,O)=>{if(o.value){let B=M.value||M;D==="rowData"&&B!=null&&(B=Im(B)),u.value[D]=B,c.value==null&&(c.value=window.setTimeout(()=>{c.value=null,s6e(u.value,s.value),u.value={}},0))}},P=()=>Object.create(es().provides);return Cc(()=>{Xee.registerModules([Dne]);const D=new mJe(es(),P()),M={globalListener:A(),globalSyncListener:A(!0),frameworkOverrides:new CJe(es()),providedBeanInstances:{frameworkCompWrapper:D},modules:i.modules},O=wfe(r6e(Im(i.gridOptions),i,[...vT,...Jte.map(H=>fN(H))])),B=x();B!==void 0&&(O.rowData=Im(B)),s.value=$je(r.value,O,M),o.value=!0}),j4(()=>{var D;o.value&&((D=s?.value)==null||D.destroy(),a.value=!0)}),t({api:s}),(D,M)=>(Dn(),hi("div",SJe,null,512))}}),RJe=mh({__name:"TableComponent",props:{spec:{},data:{}},setup(e,{expose:t}){t({UDICellRenderer:c5e}),Xee.registerModules([fJe]);const n=e,i=Le(()=>{if(!n.spec||n.spec.representation.length===0)return null;for(const d of n.spec.representation)if(d.mark!=="row")throw new Error("The representation must be a row layer in the table component for every layer");return n.spec.representation}),r=Le(()=>n.data?n.data.length===0?[]:Object.keys(n.data[0]??[]):[]),s=Le(()=>{if(!i.value)return[];const d=[];for(const h of i.value){const p=[];if(!h.mapping)throw new Error("Mapping is required for the table component");let g=UM.cloneDeep(h.mapping);Array.isArray(g)||(g=[g]);for(const m of g)if(m.field==="*")for(const C of r.value)p.push({...m,field:C,column:C});else m.column||(m.column=m.field),p.push(m);d.push(p)}return d}),o=Le(()=>{if(s.value.length===0)return[];const d=[];for(let h=0;h<s.value.length;h++){const p=s.value[h];for(const g of p)d.push({layer:h.toString(),...g})}return d});function a(d,h){let p=1/0,g=-1/0;for(const m of d){const C=m[h];if(C==null)continue;let y=0;typeof C!="number"?(y=+C,console.warn(`Value for field ${h} is not a number: ${C}. Converting to number.`)):y=C,y<p&&(p=y),y>g&&(g=y)}return{min:p,max:g}}function l(d,h){const p=d.filter(m=>m[h]!==null&&typeof m[h]<"u").map(m=>m[h]),g=new Set(p);return{values:Array.from(g)}}const u=Le(()=>{const d=new Map;if(!o.value||!n.data||n.data.length===0)return d;for(const h of o.value){const p=h.field,g=h.type,m=uW(h);if(!d.has(m)){if(g==="quantitative"){const C=a(n.data,p);d.set(m,C)}else if(g==="nominal"||g==="ordinal"){const C=l(n.data,p);d.set(m,C)}}}return d}),c=Le(()=>{if(o.value.length===0)return[];const d=o.value.map(g=>{const m=uW(g);if(u.value.has(m)){const C=u.value.get(m);return{...g,domain:C}}throw new Error(`Domain not found for mapping ${JSON.stringify(g)}`)}),h=Object.groupBy(d,g=>g.column);return[...Object.keys(h).map(g=>({headerName:g,field:g,cellRenderer:"UDICellRenderer",cellRendererParams:{udiColumnMapping:h[g]},valueGetter:m=>{const C=h[g];if(!C||C.length===0)return null;const y=C[0]?.field??null;return y?m.data[y]:null}}))]});return(d,h)=>(Dn(),xb(Y4(xJe),{rowData:n.data,columnDefs:c.value,style:{height:"500px"},rowHeight:20},null,8,["rowData","columnDefs"]))}});function EJe(e){let{source:t,representation:n}=e;const{transformation:i}=e;return Array.isArray(t)||(t=[t]),Array.isArray(n)||(n=[n]),i?{source:t,transformation:i,representation:n}:{source:t,representation:n}}function i4(e,t){return e==null?t:typeof e=="function"?e:n=>n[e]}function FJe(e,t,n,i,r,s){const o=new Float64Array(s),a=(s-1)/(r-i);for(let l=0;l<e.length;++l){const u=e[l],c=t(u,l,e),d=n(u,l,e);if(!(Number.isFinite(c)&&Number.isFinite(d)))continue;const h=(c-i)*a,p=Math.floor(h),g=p+1;0<=p&&g<s?(o[p]+=(g-h)*d,o[g]+=(h-p)*d):p===-1?o[g]+=(h-p)*d:g===s&&(o[p]+=(g-h)*d)}return o}function r4(e,t=!1){const n=new Float64Array(5),i=new Float64Array(4);AJe(n,i,e);const r=Float64Array.of(0,i[1]-n[1]*i[0],i[2]-n[2]*i[0],i[3]-n[3]*i[0],-n[4]*i[0]),s=1+n[1]+n[2]+n[3]+n[4],o=(i[0]+i[1]+i[2]+i[3])/s,a=(r[1]+r[2]+r[3]+r[4])/s;return{sigma:e,negative:t,a:n,b_causal:i,b_anticausal:r,sum_causal:o,sum_anticausal:a}}function AJe(e,t,n){const r=Float64Array.of(.84,1.8675,.84,-1.8675,-.34015,-.1299,-.34015,.1299),s=Math.exp(-1.783/n),o=Math.exp(-1.723/n),a=.6318/n,l=1.997/n,u=Float64Array.of(-s*Math.cos(a),s*Math.sin(a),-s*Math.cos(-a),s*Math.sin(-a),-o*Math.cos(l),o*Math.sin(l),-o*Math.cos(-l),o*Math.sin(-l)),c=n*2.5066282746310007,d=Float64Array.of(r[0],r[1],0,0,0,0,0,0),h=Float64Array.of(1,0,u[0],u[1],0,0,0,0,0,0);let p,g;for(g=2;g<8;g+=2){for(d[g]=u[g]*d[g-2]-u[g+1]*d[g-1],d[g+1]=u[g]*d[g-1]+u[g+1]*d[g-2],p=g-2;p>0;p-=2)d[p]+=u[g]*d[p-2]-u[g+1]*d[p-1],d[p+1]+=u[g]*d[p-1]+u[g+1]*d[p-2];for(p=0;p<=g;p+=2)d[p]+=r[g]*h[p]-r[g+1]*h[p+1],d[p+1]+=r[g]*h[p+1]+r[g+1]*h[p];for(h[g+2]=u[g]*h[g]-u[g+1]*h[g+1],h[g+3]=u[g]*h[g+1]+u[g+1]*h[g],p=g;p>0;p-=2)h[p]+=u[g]*h[p-2]-u[g+1]*h[p-1],h[p+1]+=u[g]*h[p-1]+u[g+1]*h[p-2]}for(g=0;g<4;++g)p=g<<1,t[g]=d[p]/c,e[g+1]=h[p+2]}function DJe(e,t,n,i=1,r=new Float64Array(n),s=new Float64Array(n),o=new Float64Array(5),a=r,l=kJe){const u=i*2,c=i*3,d=i*4,h=i*n;let p,g;for(l(r,t,n,i,e.b_causal,3,e.a,4,e.sum_causal,o,e.sigma),g=4,p=d;g<n;++g,p+=i)r[g]=e.b_causal[0]*t[p]+e.b_causal[1]*t[p-i]+e.b_causal[2]*t[p-u]+e.b_causal[3]*t[p-c]-e.a[1]*r[g-1]-e.a[2]*r[g-2]-e.a[3]*r[g-3]-e.a[4]*r[g-4];for(l(s,t,n,-i,e.b_anticausal,4,e.a,4,e.sum_anticausal,o,e.sigma),g=4,p=h-i*5;g<n;++g,p-=i)s[g]=e.b_anticausal[1]*t[p+i]+e.b_anticausal[2]*t[p+u]+e.b_anticausal[3]*t[p+c]+e.b_anticausal[4]*t[p+d]-e.a[1]*s[g-1]-e.a[2]*s[g-2]-e.a[3]*s[g-3]-e.a[4]*s[g-4];if(e.negative)for(g=0,p=0;g<n;++g,p+=i)a[p]=r[g]+s[n-g-1];else for(g=0,p=0;g<n;++g,p+=i)a[p]=Math.max(0,r[g]+s[n-g-1]);return a}function kJe(e,t,n,i,r,s,o,a,l,u,c,d=.5){const h=Math.abs(i)*n,p=i<0?h+i:0;let g,m,C;for(m=0;m<a;++m)for(u[m]=m<=s?r[m]:0,C=1;C<=a&&C<=m;++C)u[m]-=o[C]*u[m-C];for(C=0;C<a;++C)for(e[C]=0,m=1;m<=C;++m)g=p+i*m,g>=0&&g<h&&(e[C]+=u[C-m]*t[g]);const y=t[p],b=Math.ceil(c*10);for(m=0;m<b;++m){for(C=0;C<a;++C)e[C]+=u[C]*y;if(l-=Math.abs(u[0]),l<=d)break;for(u[a]=m+a<=s?r[m+a]:0,C=1;C<=a;++C)u[a]-=o[C]*u[a-C];for(C=0;C<a;++C)u[C]=u[C+1]}}function PJe(e,t,n=0){const i=e.length;let r,s;for(let o=0;o<i;++o){const a=t(e[o],o,e);a!=null&&(r===void 0?a>=a&&(r=s=a):(a<r&&(r=a),a>s&&(s=a)))}return[r-n,s+n]}function Pne(e,t){const n=e.map(t).filter(u=>u!=null&&u>=u);n.sort((u,c)=>u-c);const i=MJe(n),r=s4(n,.25),s=s4(n,.75),o=n.length,a=(s-r)/1.34;return 1.06*(Math.min(i,a)||i||Math.abs(r)||1)*Math.pow(o,-.2)}function MJe(e){const t=e.length;let n=0,i,r=0,s=0;for(let o=0;o<t;++o){const a=e[o];i=a-r,r+=i/++n,s+=i*(a-r)}return n>1?Math.sqrt(s/(n-1)):NaN}function s4(e,t){const n=e.length;if(!n)return NaN;if((t=+t)<=0||n<2)return e[0];if(t>=1)return e[n-1];const i=(n-1)*t,r=Math.floor(i),s=e[r];return s+(e[r+1]-s)*(i-r)}function TJe(e,t={}){const{adjust:n=1,pad:i=3,bins:r=512}=t,s=i4(t.x,y=>y),o=i4(t.weight,()=>1/e.length);let a=t.bandwidth??n*Pne(e,s);const[l,u]=t.extent??PJe(e,s,i*a),c=FJe(e,s,o,l,u,r),d=(u-l)/(r-1),h=c.some(y=>y<0);let p=r4(a/d,h),g;function*m(y="x",b="y"){const S=C.grid(),x=1/d;for(let E=0;E<r;++E)yield{[y]:l+E*d,[b]:S[E]*x}}const C={[Symbol.iterator]:m,points:m,grid:()=>g||(g=DJe(p,c,r)),extent:()=>[l,u],bandwidth(y){return arguments.length?(y!==a&&(a=y,g=null,p=r4(a/d,h)),C):a}};return C}const $w=2147483648,IJe=4294967295;class NN{constructor(t){this._size=t,this._bits=new Uint32Array(Math.ceil(t/32))}get length(){return this._size}count(){const t=this._bits.length;let n=0;for(let i=0;i<t;++i)for(let r=this._bits[i];r;++n)r&=r-1;return n}get(t){return this._bits[t>>5]&$w>>>t}set(t){this._bits[t>>5]|=$w>>>t}clear(t){this._bits[t>>5]&=~($w>>>t)}scan(t){for(let n=this.next(0);n>=0;n=this.next(n+1))t(n)}next(t){const n=this._bits,i=n.length;let r=t>>5,s=n[r]&IJe>>>t;for(;r<i;s=n[++r])if(s!==0)return(r<<5)+Math.clz32(s);return-1}nth(t){let n=this.next(0);for(;t--&&n>=0;)n=this.next(n+1);return n}not(){const t=this._bits,n=t.length;for(let r=0;r<n;++r)t[r]=~t[r];const i=this._size%32;return i&&(t[n-1]&=$w>>i-1),this}and(t){if(t){const n=this._bits,i=t._bits,r=n.length;for(let s=0;s<r;++s)n[s]&=i[s]}return this}or(t){if(t){const n=this._bits,i=t._bits,r=n.length;for(let s=0;s<r;++s)n[s]|=i[s]}return this}}function _Je(e,t,n,i,r){return e==null?null:e<t?-1/0:e>n?1/0:(e=Math.max(t,Math.min(e,n)),t+i*Math.floor(1e-14+(e-t)/i+(r||0)))}function gc(e){return e instanceof Date}function E1(e){return e instanceof RegExp}function mc(e){return e===Object(e)}function $N(e,t){return e==null||t==null||e!==e||t!==t?!1:e===t?!0:gc(e)||gc(t)?+e==+t:E1(e)&&E1(t)?e+""==t+"":mc(e)&&mc(t)?OJe(e,t):!1}function OJe(e,t){if(Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;if(e.length||t.length)return o4(e,t);const n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length||(n.sort(),i.sort(),!o4(n,i,(s,o)=>s===o)))return!1;const r=n.length;for(let s=0;s<r;++s){const o=n[s];if(!$N(e[o],t[o]))return!1}return!0}function o4(e,t,n=$N){const i=e.length;if(i!==t.length)return!1;for(let r=0;r<i;++r)if(!n(e[r],t[r]))return!1;return!0}function LJe(e,t,n){if(t instanceof Map){if(t.has(e))return t.get(e)}else{const i=`${e}`;if(Object.hasOwn(t,i))return t[i]}return n!==void 0?n:e}function NJe(e,t,n){let i=arguments.length;e=+e,t=+t,n=i<2?(t=e,e=0,1):i<3?1:+n,i=Math.max(0,Math.ceil((t-e)/n))|0;const r=new Array(i);for(let s=0;s<i;++s)r[s]=e+s*n;return r}const Et=void 0;function pr(e){return Array.isArray(e)}const $Je=Object.getPrototypeOf(Int8Array);function eE(e){return e instanceof $Je}function Lc(e){return pr(e)||eE(e)}function qo(e){return typeof e=="string"}function So(e){return e!=null&&e===e}const $C=e=>Lc(e)||qo(e);function BJe(e){return Lc(e)?e.filter(t=>So(t)):e}function GJe(...e){return[].concat(...e)}function zJe(e,t,n){return $C(e)?e.includes(t,n):!1}function HJe(e,t){return $C(e)?e.indexOf(t):-1}function VJe(e,t){return Lc(e)?e.join(t):Et}function WJe(e,t){return $C(e)?e.lastIndexOf(t):-1}function UJe(e){return $C(e)?e.length:0}function qJe(e,t){return Lc(e)?e.map(n=>So(n)?n[t]:Et):Et}function jJe(e){return Lc(e)?e.slice().reverse():qo(e)?e.split("").reverse().join(""):Et}function KJe(e,t,n){return $C(e)?e.slice(t,n):Et}const YJe=Object.freeze(Object.defineProperty({__proto__:null,compact:BJe,concat:GJe,includes:zJe,indexof:HJe,join:VJe,lastindexof:WJe,length:UJe,pluck:qJe,reverse:jJe,slice:KJe},Symbol.toStringTag,{value:"Module"}));function wb(e,t,n="0"){const i=e+"",r=i.length;return r<t?Array(t-r+1).join(n)+i:i}const ea=e=>(e<10?"0":"")+e,XJe=e=>e<0?"-"+wb(-e,6):e>9999?"+"+wb(e,6):wb(e,4);function Mne(e,t,n,i,r,s,o,a,l){const u=a?"Z":"";return XJe(e)+"-"+ea(t+1)+"-"+ea(n)+(!l||o?"T"+ea(i)+":"+ea(r)+":"+ea(s)+"."+wb(o,3)+u:s?"T"+ea(i)+":"+ea(r)+":"+ea(s)+u:r||i||!a?"T"+ea(i)+":"+ea(r)+u:"")}function Tne(e,t){return isNaN(e)?"Invalid Date":Mne(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds(),!1,t)}function tE(e,t){return isNaN(e)?"Invalid Date":Mne(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds(),!0,t)}const QJe=/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/;function Ine(e){return e.match(QJe)&&!isNaN(Date.parse(e))}function ZJe(e,t=Date.parse){return Ine(e)?t(e):e}const _ne=6e4,One=864e5,Lne=6048e5,yn=new Date,wn=new Date,_n=e=>(yn.setTime(typeof e=="string"?ZJe(e):e),yn);function JJe(e,t){return Tne(_n(e),!t)}function eet(e,t){return tE(_n(e),!t)}function tet(){return Date.now()}function net(e){return+_n(e)}function iet(e,t,n,i,r,s,o){return arguments.length?new Date(e,t||0,n??1,i||0,r||0,s||0,o||0):new Date(Date.now())}function ret(e){return _n(e).getFullYear()}function set(e){return Math.floor(_n(e).getMonth()/3)}function oet(e){return _n(e).getMonth()}function aet(e,t){const n=t||0;wn.setTime(+e),wn.setDate(wn.getDate()-(wn.getDay()+7-n)%7),wn.setHours(0,0,0,0),yn.setTime(+e),yn.setMonth(0),yn.setDate(1),yn.setDate(1-(yn.getDay()+7-n)%7),yn.setHours(0,0,0,0);const i=(wn.getTimezoneOffset()-yn.getTimezoneOffset())*_ne;return Math.floor((1+(+wn-+yn)-i)/Lne)}function uet(e){return _n(e).getDate()}function cet(e){wn.setTime(+e),wn.setHours(0,0,0,0),yn.setTime(+wn),yn.setMonth(0),yn.setDate(1);const t=(wn.getTimezoneOffset()-yn.getTimezoneOffset())*_ne;return Math.floor(1+(+wn-+yn-t)/One)}function det(e){return _n(e).getDay()}function het(e){return _n(e).getHours()}function fet(e){return _n(e).getMinutes()}function pet(e){return _n(e).getSeconds()}function get(e){return _n(e).getMilliseconds()}function met(e,t,n,i,r,s,o){return arguments.length?new Date(Date.UTC(e,t||0,n??1,i||0,r||0,s||0,o||0)):new Date(Date.now())}function vet(e){return _n(e).getUTCFullYear()}function Cet(e){return Math.floor(_n(e).getUTCMonth()/3)}function yet(e){return _n(e).getUTCMonth()}function wet(e,t){const n=t||0;return wn.setTime(+e),wn.setUTCDate(wn.getUTCDate()-(wn.getUTCDay()+7-n)%7),wn.setUTCHours(0,0,0,0),yn.setTime(+e),yn.setUTCMonth(0),yn.setUTCDate(1),yn.setUTCDate(1-(yn.getUTCDay()+7-n)%7),yn.setUTCHours(0,0,0,0),Math.floor((1+(+wn-+yn))/Lne)}function bet(e){return _n(e).getUTCDate()}function xet(e){wn.setTime(+e),wn.setUTCHours(0,0,0,0);const t=Date.UTC(wn.getUTCFullYear(),0,1);return Math.floor(1+(+wn-t)/One)}function Ret(e){return _n(e).getUTCDay()}function Eet(e){return _n(e).getUTCHours()}function Fet(e){return _n(e).getUTCMinutes()}function Aet(e){return _n(e).getUTCSeconds()}function Det(e){return _n(e).getUTCMilliseconds()}const ket=Object.freeze(Object.defineProperty({__proto__:null,date:uet,datetime:iet,dayofweek:det,dayofyear:cet,format_date:JJe,format_utcdate:eet,hours:het,milliseconds:get,minutes:fet,month:oet,now:tet,quarter:set,seconds:pet,timestamp:net,utcdate:bet,utcdatetime:met,utcdayofweek:Ret,utcdayofyear:xet,utchours:Eet,utcmilliseconds:Det,utcminutes:Fet,utcmonth:yet,utcquarter:Cet,utcseconds:Aet,utcweek:wet,utcyear:vet,week:aet,year:ret},Symbol.toStringTag,{value:"Module"}));function Pet(e){return JSON.parse(e)}function Met(e){return JSON.stringify(e)}const Tet=Object.freeze(Object.defineProperty({__proto__:null,parse_json:Pet,to_json:Met},Symbol.toStringTag,{value:"Module"}));let Iet=Math.random;function Rg(){return Iet()}function _et(){return Rg()}function Oet(e){return Number.isNaN(e)}function Let(e){return Number.isFinite(e)}function Net(e){return Math.abs(e)}function $et(e){return Math.cbrt(e)}function Bet(e){return Math.ceil(e)}function Get(e){return Math.clz32(e)}function zet(e){return Math.exp(e)}function Het(e){return Math.expm1(e)}function Vet(e){return Math.floor(e)}function Wet(e){return Math.fround(e)}function Uet(...e){return Math.max(...e)}function qet(...e){return Math.min(...e)}function jet(e){return Math.log(e)}function Ket(e){return Math.log10(e)}function Yet(e){return Math.log1p(e)}function Xet(e){return Math.log2(e)}function Qet(e,t){return Math.pow(e,t)}function Zet(e){return Math.round(e)}function Jet(e){return Math.sign(e)}function ett(e){return Math.sqrt(e)}function ttt(e){return Math.trunc(e)}function ntt(e){return 180*e/Math.PI}function itt(e){return Math.PI*e/180}function rtt(e){return Math.acos(e)}function stt(e){return Math.acosh(e)}function ott(e){return Math.asin(e)}function att(e){return Math.asinh(e)}function ltt(e){return Math.atan(e)}function utt(e,t){return Math.atan2(e,t)}function ctt(e){return Math.atanh(e)}function dtt(e){return Math.cos(e)}function htt(e){return Math.cosh(e)}function ftt(e){return Math.sin(e)}function ptt(e){return Math.sinh(e)}function gtt(e){return Math.tan(e)}function mtt(e){return Math.tanh(e)}const vtt=Object.freeze(Object.defineProperty({__proto__:null,abs:Net,acos:rtt,acosh:stt,asin:ott,asinh:att,atan:ltt,atan2:utt,atanh:ctt,cbrt:$et,ceil:Bet,clz32:Get,cos:dtt,cosh:htt,degrees:ntt,exp:zet,expm1:Het,floor:Vet,fround:Wet,greatest:Uet,is_finite:Let,is_nan:Oet,least:qet,log:jet,log10:Ket,log1p:Yet,log2:Xet,pow:Qet,radians:itt,random:_et,round:Zet,sign:Jet,sin:ftt,sinh:ptt,sqrt:ett,tan:gtt,tanh:mtt,trunc:ttt},Symbol.toStringTag,{value:"Module"}));function BN(e){return e instanceof Map}function Ctt(e){return e instanceof Set}function nE(e){return BN(e)||Ctt(e)}function GN(e){return Array.from(e)}function ytt(e,t){return nE(e)?e.has(t):e!=null?Object.hasOwn(e,`${t}`):!1}function wtt(e){return BN(e)?GN(e.keys()):e!=null?Object.keys(e):[]}function btt(e){return nE(e)?GN(e.values()):e!=null?Object.values(e):[]}function Stt(e){return nE(e)?GN(e.entries()):e!=null?Object.entries(e):[]}function xtt(e){return e?Object.fromEntries(e):Et}const Rtt=Object.freeze(Object.defineProperty({__proto__:null,entries:Stt,has:ytt,keys:wtt,object:xtt,values:btt},Symbol.toStringTag,{value:"Module"}));function Ett(e){return e==null?e:new Date(e)}function Ftt(e){return e==null?e:Number.parseFloat(e)}function Att(e,t){return e==null?e:Number.parseInt(e,t)}function Dtt(e,t,n){return e==null?!1:String(e).endsWith(t,n)}function ktt(e,t,n){const i=e==null?e:String(e).match(t);return n==null||i==null?i:typeof n=="number"?i[n]:i.groups?i.groups[n]:null}function Ptt(e,t){return e==null?e:String(e).normalize(t)}function Mtt(e,t,n){return e==null?e:String(e).padEnd(t,n)}function Ttt(e,t,n){return e==null?e:String(e).padStart(t,n)}function Itt(e){return e==null?e:String(e).toUpperCase()}function _tt(e){return e==null?e:String(e).toLowerCase()}function Ott(e,t){return e==null?e:String(e).repeat(t)}function Ltt(e,t,n){return e==null?e:String(e).replace(t,String(n))}function Ntt(e,t,n){return e==null?[]:String(e).split(t,n)}function $tt(e,t,n){return e==null?!1:String(e).startsWith(t,n)}function Btt(e,t,n){return e==null?e:String(e).substring(t,n)}function Gtt(e){return e==null?e:String(e).trim()}const ztt=Object.freeze(Object.defineProperty({__proto__:null,endswith:Dtt,lower:_tt,match:ktt,normalize:Ptt,padend:Mtt,padstart:Ttt,parse_date:Ett,parse_float:Ftt,parse_int:Att,repeat:Ott,replace:Ltt,split:Ntt,startswith:$tt,substring:Btt,trim:Gtt,upper:Itt},Symbol.toStringTag,{value:"Module"})),_f={bin:_Je,equal:$N,recode:LJe,sequence:NJe,...YJe,...ket,...Tet,...vtt,...Rtt,...ztt};function Oa(e){return e!=null?pr(e)?e:[e]:[]}function M0(e){return typeof e=="bigint"}function jl(e){return e===void 0?e+"":M0(e)?e+"n":JSON.stringify(e)}let Htt=class{constructor(t,n,i){this.name=t,this.fields=n,this.params=i}toString(){const t=[...this.fields.map(n=>`d[${jl(n)}]`),...this.params.map(jl)];return`d => op.${this.name}(${t})`}toObject(){return{expr:this.toString(),func:!0}}};function nt(e,t=[],n=[]){return new Htt(e,Oa(t),Oa(n))}const Nne=e=>nt("any",e),$ne=()=>nt("count"),Bne=e=>nt("array_agg",e),Gne=e=>nt("array_agg_distinct",e),zne=(e,t)=>nt("map_agg",[e,t]),Hne=(e,t)=>nt("object_agg",[e,t]),Vne=(e,t)=>nt("entries_agg",[e,t]),ta={..._f,row_object:(...e)=>nt("row_object",null,e.flat()),count:$ne,any:Nne,array_agg:Bne,array_agg_distinct:Gne,object_agg:Hne,map_agg:zne,entries_agg:Vne,valid:e=>nt("valid",e),invalid:e=>nt("invalid",e),distinct:e=>nt("distinct",e),mode:e=>nt("mode",e),sum:e=>nt("sum",e),product:e=>nt("product",e),mean:e=>nt("mean",e),average:e=>nt("average",e),variance:e=>nt("variance",e),variancep:e=>nt("variancep",e),stdev:e=>nt("stdev",e),stdevp:e=>nt("stdevp",e),min:e=>nt("min",e),max:e=>nt("max",e),quantile:(e,t)=>nt("quantile",e,t),median:e=>nt("median",e),covariance:(e,t)=>nt("covariance",[e,t]),covariancep:(e,t)=>nt("covariancep",[e,t]),corr:(e,t)=>nt("corr",[e,t]),bins:(e,t,n,i,r)=>nt("bins",e,[t,n,i,r]),row_number:()=>nt("row_number"),rank:()=>nt("rank"),avg_rank:()=>nt("avg_rank"),dense_rank:()=>nt("dense_rank"),percent_rank:()=>nt("percent_rank"),cume_dist:()=>nt("cume_dist"),ntile:e=>nt("ntile",null,e),lag:(e,t,n)=>nt("lag",e,[t,n]),lead:(e,t,n)=>nt("lead",e,[t,n]),first_value:e=>nt("first_value",e),last_value:e=>nt("last_value",e),nth_value:(e,t)=>nt("nth_value",e,t),fill_down:(e,t)=>nt("fill_down",e,t),fill_up:(e,t)=>nt("fill_up",e,t)};function pn(e,t){throw Error(e,{cause:t})}function Vtt(e,t){e=nE(e)?e:new Set(e);let n=t,i=0;for(;e.has(n);)n=t+ ++i;return n}function Ri(e){return typeof e=="function"}function Eg(e,t){const n=Array(e);if(Ri(t))for(let i=0;i<e;++i)n[i]=t(i);else n.fill(t);return n}function Wtt(e,t,n=15,i=!0,r=0,s){const a=Math.LN10;if(s==null){const l=Math.ceil(Math.log(n)/a),u=t-e||Math.abs(e)||1,c=[5,2];for(s=Math.max(r,Math.pow(10,Math.round(Math.log(u)/a)-l));Math.ceil(u/s)>n;)s*=10;const d=c.length;for(let h=0;h<d;++h){const p=s/c[h];p>=r&&u/p<=n&&(s=p)}}if(i){let l=Math.log(s);const u=l>=0?0:~~(-l/a)+1,c=Math.pow(10,-u-1);l=Math.floor(e/s+c)*s,e=e<l?l-s:l,t=Math.ceil(t/s)*s}return[e,t===e?e+s:t,s]}function Up(e){const t=typeof e;return t==="string"?`"${e}"`:t!=="object"||!e?e:gc(e)?+e:pr(e)||eE(e)?`[${e.map(Up)}]`:E1(e)?e+"":Utt(e)}function Utt(e){let t="{",n=-1;for(const i in e)++n>0&&(t+=","),t+=`"${i}":${Up(e[i])}`;return t+="}",t}function F1(e,t){const n=e.length;return n===1?(i,r)=>Up(e[0](i,r)):(i,r)=>{let s="";for(let o=0;o<n;++o){o>0&&(s+="|");const a=e[o](i,r);if(t&&(a==null||a!==a))return null;s+=Up(a)}return s}}function qtt(){const e=new Map;return{count(){return e.size},values(){return Array.from(e.values(),t=>t.v)},increment(t){const n=Up(t),i=e.get(n);i?++i.n:e.set(n,{v:t,n:1})},decrement(t){const n=Up(t),i=e.get(n);i.n===1?e.delete(n):--i.n},forEach(t){e.forEach(({v:n,n:i})=>t(n,i))}}}function pl(){}function jtt(e,t=0,n=e.length){let i=e[t++];for(let r=t;r<n;++r)i*=e[r];return i}function Hn(e){return e.init=e.init||pl,e.add=e.add||pl,e.rem=e.rem||pl,e}function a4(e,t){return e.product_v=!1,e.product=t}const Wne={count:{create:()=>Hn({value:e=>e.count}),param:[]},array_agg:{create:()=>Hn({init:e=>e.values=!0,value:e=>e.list.values(e.stream)}),param:[1]},object_agg:{create:()=>Hn({init:e=>e.values=!0,value:e=>Object.fromEntries(e.list.values())}),param:[2]},map_agg:{create:()=>Hn({init:e=>e.values=!0,value:e=>new Map(e.list.values())}),param:[2]},entries_agg:{create:()=>Hn({init:e=>e.values=!0,value:e=>e.list.values(e.stream)}),param:[2]},any:{create:()=>Hn({add:(e,t)=>{e.any==null&&(e.any=t)},value:e=>e.valid?e.any:Et}),param:[1]},valid:{create:()=>Hn({value:e=>e.valid}),param:[1]},invalid:{create:()=>Hn({value:e=>e.count-e.valid}),param:[1]},distinct:{create:()=>({init:e=>e.distinct=qtt(),value:e=>e.distinct.count()+(e.valid===e.count?0:1),add:(e,t)=>e.distinct.increment(t),rem:(e,t)=>e.distinct.decrement(t)}),param:[1]},array_agg_distinct:{create:()=>Hn({value:e=>e.distinct.values()}),param:[1],req:["distinct"]},mode:{create:()=>Hn({value:e=>{let t=Et,n=0;return e.distinct.forEach((i,r)=>{r>n&&(n=r,t=i)}),t}}),param:[1],req:["distinct"]},sum:{create:()=>({init:e=>e.sum=0,value:e=>e.valid?e.sum:Et,add:(e,t)=>M0(t)?e.sum===0?e.sum=t:e.sum+=t:e.sum+=+t,rem:(e,t)=>e.sum-=t}),param:[1]},product:{create:()=>({init:e=>a4(e,1),value:e=>e.valid?e.product_v?a4(e,jtt(e.list.values())):e.product:void 0,add:(e,t)=>M0(t)&&e.product===1?e.product=t:e.product*=t,rem:(e,t)=>t==0||t===1/0||t===-1/0?e.product_v=!0:e.product/=t}),param:[1],stream:["array_agg"]},mean:{create:()=>({init:e=>e.mean=0,value:e=>e.valid?e.mean:Et,add:(e,t)=>{e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid},rem:(e,t)=>{e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean}}),param:[1]},average:{create:()=>Hn({value:e=>e.valid?e.mean:Et}),param:[1],req:["mean"]},variance:{create:()=>({init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):Et,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean)}),param:[1],req:["mean"]},variancep:{create:()=>Hn({value:e=>e.valid>1?e.dev/e.valid:Et}),param:[1],req:["variance"]},stdev:{create:()=>Hn({value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):Et}),param:[1],req:["variance"]},stdevp:{create:()=>Hn({value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):Et}),param:[1],req:["variance"]},min:{create:()=>({init:e=>e.min=Et,value:e=>e.min=Number.isNaN(e.min)?e.list.min():e.min,add:(e,t)=>{(t<e.min||e.min===Et)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)}}),param:[1],stream:["array_agg"]},max:{create:()=>({init:e=>e.max=Et,value:e=>e.max=Number.isNaN(e.max)?e.list.max():e.max,add:(e,t)=>{(t>e.max||e.max===Et)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)}}),param:[1],stream:["array_agg"]},quantile:{create:e=>Hn({value:t=>t.list.quantile(e)}),param:[1,1],req:["array_agg"]},median:{create:()=>Hn({value:e=>e.list.quantile(.5)}),param:[1],req:["array_agg"]},covariance:{create:()=>({init:e=>{e.cov=e.mean_x=e.mean_y=e.dev_x=e.dev_y=0},value:e=>e.valid>1?e.cov/(e.valid-1):Et,add:(e,t,n)=>{const i=t-e.mean_x,r=n-e.mean_y;e.mean_x+=i/e.valid,e.mean_y+=r/e.valid;const s=n-e.mean_y;e.dev_x+=i*(t-e.mean_x),e.dev_y+=r*s,e.cov+=i*s},rem:(e,t,n)=>{const i=t-e.mean_x,r=n-e.mean_y;e.mean_x-=e.valid?i/e.valid:e.mean_x,e.mean_y-=e.valid?r/e.valid:e.mean_y;const s=n-e.mean_y;e.dev_x-=i*(t-e.mean_x),e.dev_y-=r*s,e.cov-=i*s}}),param:[2]},covariancep:{create:()=>Hn({value:e=>e.valid>1?e.cov/e.valid:Et}),param:[2],req:["covariance"]},corr:{create:()=>Hn({value:e=>e.valid>1?e.cov/(Math.sqrt(e.dev_x)*Math.sqrt(e.dev_y)):Et}),param:[2],req:["covariance"]},bins:{create:(e,t,n,i)=>Hn({value:r=>Wtt(r.min,r.max,e,t,n,i)}),param:[1,4],req:["min","max"]}},l4={create(){let e;return{init:()=>e=1,value:t=>{const n=t.index;return n&&!t.peer(n)?e=n+1:e}}},param:[]},u4={create(){let e;return{init:()=>e=0,value:t=>{const{index:n,peer:i,size:r}=t;let s=n;if(e<s){for(;s+1<r&&i(s+1);)++s;e=s}return(1+e)/r}}},param:[]},Une={row_number:{create(){return{init:pl,value:e=>e.index+1}},param:[]},rank:l4,avg_rank:{create(){let e,t;return{init:()=>(e=-1,t=1),value:n=>{const i=n.index;if(i>=e){for(t=e=i+1;n.peer(e);t+=++e);t/=e-i}return t}}},param:[]},dense_rank:{create(){let e;return{init:()=>e=1,value:t=>{const n=t.index;return n&&!t.peer(n)?++e:e}}},param:[]},percent_rank:{create(){const{init:e,value:t}=l4.create();return{init:e,value:n=>(t(n)-1)/(n.size-1)}},param:[]},cume_dist:u4,ntile:{create(e){e=+e,e>0||pn("ntile num must be greater than zero.");const{init:t,value:n}=u4.create();return{init:t,value:i=>Math.ceil(e*n(i))}},param:[0,1]},lag:{create(e,t=Et){return e=+e||1,{init:pl,value:(n,i)=>{const r=n.index-e;return r>=0?n.value(r,i):t}}},param:[1,2]},lead:{create(e,t=Et){return e=+e||1,{init:pl,value:(n,i)=>{const r=n.index+e;return r<n.size?n.value(r,i):t}}},param:[1,2]},first_value:{create(){return{init:pl,value:(e,t)=>e.value(e.i0,t)}},param:[1]},last_value:{create(){return{init:pl,value:(e,t)=>e.value(e.i1-1,t)}},param:[1]},nth_value:{create(e){return e=+e,e>0||pn("nth_value nth must be greater than zero."),{init:pl,value:(t,n)=>{const i=t.i0+(e-1);return i<t.i1?t.value(i,n):Et}}},param:[1,1]},fill_down:{create(e=Et){let t;return{init:()=>t=e,value:(n,i)=>{const r=n.value(n.index,i);return So(r)?t=r:t}}},param:[1,1]},fill_up:{create(e=Et){let t,n;return{init:()=>(t=e,n=-1),value:(i,r)=>i.index<=n?t:(n=Ktt(i,r,i.index))>=0?t=i.value(n,r):(n=i.size,t=e)}},param:[1,1]}};function Ktt(e,t,n){for(const i=e.size;n<i;++n)if(So(e.value(n,t)))return n;return-1}function zN(e){return Object.hasOwn(Wne,e)}function HN(e){return Object.hasOwn(Une,e)}function qne(e){return Object.hasOwn(_f,e)||e==="row_object"}function jne(e){return zN(e)&&Wne[e]}function Kne(e){return HN(e)&&Une[e]}function BC(e,t=(i,r)=>i,n=""){const i=e.length;if(!i)return"";let r=t(e[0],0);for(let s=1;s<i;++s)r+=n+t(e[s],s);return r}function Fg(e,t,...n){const i=["_","$"],r=i.slice(0,n.length);return r.push('"use strict"; const '+n.map((s,o)=>s.map((a,l)=>`${i[o]}${l} = ${i[o]}[${l}]`).join(", ")).join(", ")+`; return (${e}) => ${t};`),Function(...r)(...n)}function VN(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Ytt(e,t=0,n=e.length){let i=n?e[t++]:Et;for(let r=t;r<n;++r)i<e[r]&&(i=e[r]);return i}function Xtt(e,t=0,n=e.length){let i=n?e[t++]:Et;for(let r=t;r<n;++r)i>e[r]&&(i=e[r]);return i}function Bw(e){return M0(e)?e:+e}function Qtt(e,t){const n=e.length;if(!n)return Et;if((t=+t)<=0||n<2)return Bw(e[0]);if(t>=1)return Bw(e[n-1]);const i=(n-1)*t,r=Math.floor(i),s=Bw(e[r]);return M0(s)?s:s+(Bw(e[r+1])-s)*(i-r)}class Ztt{constructor(t){this._values=t||[],this._sorted=null,this._start=0}values(t){return this._start&&(this._values=this._values.slice(this._start),this._start=0),t?this._values.slice():this._values}add(t){this._values.push(t),this._sorted=null}rem(){this._start+=1,this._sorted=null}min(){return this._sorted&&this._sorted.length?this._sorted[0]:Xtt(this._values,this._start)}max(){return this._sorted&&this._sorted.length?this._sorted[this._sorted.length-1]:Ytt(this._values,this._start)}quantile(t){return this._sorted||(this._sorted=this.values(!0),this._sorted.sort(VN)),Qtt(this._sorted,t)}}class Jtt{constructor(t){this._outputs=t}size(){return this._outputs.length}outputs(){return this._outputs}init(t){return{}}add(t,n,i){}rem(t,n,i){}write(t,n,i){}}const A1=(e,t,n)=>Fg(t,"{"+BC(e,(i,r)=>`_${r}.${n}(${t});`)+"}",e);function ent(e,t){const{ops:n,output:i}=tnt(e,t),r=e[0].fields,s=r.length,o=s===0?WN:s===1?nnt:s===2?int:pn("Unsupported field count: "+s);return new o(r,n,i,t)}function tnt(e,t){const n={},i=[];function r(o,a=[]){const l=o+":"+a;if(n[l])return n[l];const u=jne(o),c=u.create(...a);return t<0&&u.stream&&u.stream.forEach(d=>r(d,[])),u.req&&u.req.forEach(d=>r(d,[])),n[l]=c,i.push(c),c}const s=e.map(o=>{const a=r(o.name,o.params);return a.output=o.id,a});return{ops:i,output:s}}class WN extends Jtt{constructor(t,n,i,r){super(i),this._op=n,this._fields=t,this._stream=!!r}init(){const t={count:0,valid:0,stream:this._stream};return this._op.forEach(n=>n.init(t)),t.values&&(t.list=new Ztt),t}write(t,n,i){const r=this._outputs,s=r.length;for(let o=0;o<s;++o)n[r[o].output][i]=r[o].value(t);return 1}_add(){}_rem(){}add(t){++t.count}rem(t){--t.count}}class nnt extends WN{constructor(t,n,i,r){super(t,n,i,r);const s=["state","v1","v2"];this._add=A1(n,s,"add"),this._rem=A1(n,s,"rem")}add(t,n,i){const r=this._fields[0](n,i);++t.count,So(r)&&(++t.valid,t.list&&t.list.add(r),this._add(t,r))}rem(t,n,i){const r=this._fields[0](n,i);--t.count,So(r)&&(--t.valid,t.list&&t.list.rem(),this._rem(t,r))}}class int extends WN{constructor(t,n,i,r){super(t,n,i,r);const s=["state","v1","v2"];this._add=A1(n,s,"add"),this._rem=A1(n,s,"rem")}add(t,n,i){const r=this._fields[0](n,i),s=this._fields[1](n,i);++t.count,So(r)&&So(s)&&(++t.valid,t.list&&t.list.add([r,s]),this._add(t,r,s))}rem(t,n,i){const r=this._fields[0](n,i),s=this._fields[1](n,i);--t.count,So(r)&&So(s)&&(--t.valid,t.list&&t.list.rem(),this._rem(t,r,s))}}function Gh(e,t,n){if(t.length){const i=e.data(),{keys:r}=e.groups()||{},s=Ag(e,t),o=r?(a,l)=>s[a][r[l]]:a=>s[a][0];n=n.map(a=>l=>a(l,i,o))}return n}function Ag(e,t,n){if(!t.length)return n;const i=Yne(t),r=e.groups(),s=r?r.size:1;return n=n||Eg(t.length,()=>Array(s)),s>1?i.forEach(o=>{const a=Qne(e,o,r);for(let l=0;l<s;++l)o.write(a[l],n,l)}):i.forEach(o=>{const a=Xne(e,o);o.write(a,n,0)}),n}function Yne(e,t){const n=[],i={};for(const r of e){const s=r.fields.map(o=>o+"").join(",");(i[s]||(i[s]=[])).push(r)}for(const r in i)n.push(ent(i[r],t));return n}function Xne(e,t){const n=t.init(),i=e.totalRows(),r=e.data(),s=e.mask();if(e.isOrdered()){const o=e.indices();for(let a=0;a<i;++a)t.add(n,o[a],r)}else if(s)for(let o=s.next(0);o>=0;o=s.next(o+1))t.add(n,o,r);else for(let o=0;o<i;++o)t.add(n,o,r);return n}function Qne(e,t,n){const{keys:i,size:r}=n,s=Eg(r,()=>t.init()),o=e.data();if(e.isOrdered()){const a=e.indices(),l=a.length;for(let u=0;u<l;++u){const c=a[u];t.add(s[i[c]],c,o)}}else if(e.isFiltered()){const a=e.mask();for(let l=a.next(0);l>=0;l=a.next(l+1))t.add(s[i[l]],l,o)}else{const a=e.totalRows();for(let l=0;l<a;++l)t.add(s[i[l]],l,o)}return s}function Zne(e,t){const{get:n,names:i,rows:r,size:s}=t,o=i.length;for(let a=0;a<o;++a){const l=e.add(i[a],Array(s)),u=n[a];for(let c=0;c<s;++c)l[c]=u(r[c])}}function UN(e){return pr(e)?e:BN(e)?e.entries():e?Object.entries(e):[]}const rnt="ArrayPattern",snt="ArrowFunctionExpression",ont="FunctionExpression",Qu="Identifier",Dg="Literal",Jne="MemberExpression",ant="ObjectExpression",eie="ObjectPattern",tie="Property",nie="Column",lnt="Constant",unt="Dictionary",cnt="Function",dnt="Parameter",iie="Op";function bt(e,t,n,i){const r=n[e.type]||n.Default;if(r&&r(e,t,i)===!1)return;const s=hnt[e.type];s&&s(e,t,n)}const Gw=(e,t,n)=>{bt(e.argument,t,n,e)},uk=(e,t,n)=>{bt(e.left,t,n,e),bt(e.right,t,n,e)},c4=(e,t,n)=>{bt(e.test,t,n,e),bt(e.consequent,t,n,e),e.alternate&&bt(e.alternate,t,n,e)},ck=(e,t,n)=>{sa(e.params,t,n,e),bt(e.body,t,n,e)},d4=(e,t,n)=>{bt(e.callee,t,n,e),sa(e.arguments,t,n,e)},sa=(e,t,n,i)=>{e.forEach(r=>bt(r,t,n,i))},hnt={TemplateLiteral:(e,t,n)=>{sa(e.expressions,t,n,e),sa(e.quasis,t,n,e)},MemberExpression:(e,t,n)=>{bt(e.object,t,n,e),bt(e.property,t,n,e)},CallExpression:d4,NewExpression:d4,ArrayExpression:(e,t,n)=>{sa(e.elements,t,n,e)},AssignmentExpression:uk,AwaitExpression:Gw,BinaryExpression:uk,LogicalExpression:uk,UnaryExpression:Gw,UpdateExpression:Gw,ConditionalExpression:c4,ObjectExpression:(e,t,n)=>{sa(e.properties,t,n,e)},Property:(e,t,n)=>{bt(e.key,t,n,e),bt(e.value,t,n,e)},ArrowFunctionExpression:ck,FunctionExpression:ck,FunctionDeclaration:ck,VariableDeclaration:(e,t,n)=>{sa(e.declarations,t,n,e)},VariableDeclarator:(e,t,n)=>{bt(e.id,t,n,e),bt(e.init,t,n,e)},SpreadElement:(e,t,n)=>{bt(e.argument,t,n,e)},BlockStatement:(e,t,n)=>{sa(e.body,t,n,e)},ExpressionStatement:(e,t,n)=>{bt(e.expression,t,n,e)},IfStatement:c4,ForStatement:(e,t,n)=>{bt(e.init,t,n,e),bt(e.test,t,n,e),bt(e.update,t,n,e),bt(e.body,t,n,e)},WhileStatement:(e,t,n)=>{bt(e.test,t,n,e),bt(e.body,t,n,e)},DoWhileStatement:(e,t,n)=>{bt(e.body,t,n,e),bt(e.test,t,n,e)},SwitchStatement:(e,t,n)=>{bt(e.discriminant,t,n,e),sa(e.cases,t,n,e)},SwitchCase:(e,t,n)=>{e.test&&bt(e.test,t,n,e),sa(e.consequent,t,n,e)},ReturnStatement:Gw,Program:(e,t,n)=>{bt(e.body[0],t,n,e)}};function rie(e){delete e.start,delete e.end,delete e.optional}function h4(e){rie(e),delete e.object,delete e.property,delete e.computed,e.table||delete e.table}function fnt(e){return bt(e,null,{Column:h4,Constant:h4,Default:rie}),e}function Un(e,t){return t&&t.type===e}function pnt(e){return Un(ont,e)||Un(snt,e)}const Kt=(e,t)=>{const n=mnt[e.type];return n?n(e,t):pn(`Unsupported expression construct: ${e.type}`)},dk=(e,t)=>"("+Kt(e.left,t)+" "+e.operator+" "+Kt(e.right,t)+")",hk=(e,t)=>"("+oa(e.params,t)+")=>"+Kt(e.body,t),f4=(e,t)=>Kt(e.callee,t)+"("+oa(e.arguments,t)+")",oa=(e,t,n=",")=>e.map(i=>Kt(i,t)).join(n),qN=e=>e.computed?`[${jl(e.name)}]`:`.${e.name}`,p4=(e,t,n)=>{const i=e.table||"";return`data${i}${qN(e)}.${n}(${t.index}${i})`},gnt=(e,t)=>{const n=e.table||"";return`data${n}${qN(e)}[${t.index}${n}]`},mnt={Constant:e=>e.raw,Column:(e,t)=>e.array?gnt(e,t):p4(e,t,"at"),Dictionary:(e,t)=>p4(e,t,"key"),Function:e=>`fn.${e.name}`,Parameter:e=>`$${qN(e)}`,Op:(e,t)=>`op(${jl(e.name)},${t.op||t.index})`,Literal:e=>e.raw,Identifier:e=>e.name,TemplateLiteral:(e,t)=>{const{quasis:n,expressions:i}=e,r=i.length;let s=n[0].value.raw;for(let o=0;o<r;)s+="${"+Kt(i[o],t)+"}"+n[++o].value.raw;return"`"+s+"`"},MemberExpression:(e,t)=>{const n=!e.computed,i=Kt(e.object,t),r=Kt(e.property,t);return i+(n?"."+r:"["+r+"]")},CallExpression:f4,NewExpression:(e,t)=>"new "+f4(e,t),ArrayExpression:(e,t)=>"["+oa(e.elements,t)+"]",AssignmentExpression:dk,BinaryExpression:dk,LogicalExpression:dk,UnaryExpression:(e,t)=>"("+e.operator+Kt(e.argument,t)+")",ConditionalExpression:(e,t)=>"("+Kt(e.test,t)+"?"+Kt(e.consequent,t)+":"+Kt(e.alternate,t)+")",ObjectExpression:(e,t)=>"({"+oa(e.properties,t)+"})",Property:(e,t)=>{const n=Kt(e.key,t);return(e.computed?`[${n}]`:n)+":"+Kt(e.value,t)},ArrowFunctionExpression:hk,FunctionExpression:hk,FunctionDeclaration:hk,ArrayPattern:(e,t)=>"["+oa(e.elements,t)+"]",ObjectPattern:(e,t)=>"{"+oa(e.properties,t)+"}",VariableDeclaration:(e,t)=>e.kind+" "+oa(e.declarations,t,","),VariableDeclarator:(e,t)=>Kt(e.id,t)+"="+Kt(e.init,t),SpreadElement:(e,t)=>"..."+Kt(e.argument,t),BlockStatement:(e,t)=>"{"+oa(e.body,t,";")+";}",BreakStatement:()=>"break",ExpressionStatement:(e,t)=>Kt(e.expression,t),IfStatement:(e,t)=>"if ("+Kt(e.test,t)+")"+Kt(e.consequent,t)+(e.alternate?" else "+Kt(e.alternate,t):""),SwitchStatement:(e,t)=>"switch ("+Kt(e.discriminant,t)+") {"+oa(e.cases,t,"")+"}",SwitchCase:(e,t)=>(e.test?"case "+Kt(e.test,t):"default")+": "+oa(e.consequent,t,";")+";",ReturnStatement:(e,t)=>"return "+Kt(e.argument,t),Program:(e,t)=>Kt(e.body[0],t)};function D1(e,t={index:"row"}){return Kt(e,t)}function _m(e,t,n){return e=`"use strict"; return ${e};`,Function("fn","$",e)(t,n)}const jN={escape:(e,t,n)=>_m(e,t,n),expr:(e,t)=>_m(`(row,data,op)=>${e}`,_f,t),expr2:(e,t)=>_m(`(row0,data0,row,data)=>${e}`,_f,t),join:(e,t)=>_m(`(row1,data1,row2,data2)=>${e}`,_f,t),param:(e,t)=>_m(e,_f,t)},vnt={"==":1,"!=":1,"===":1,"!==":1};function sie(e,t,n=0,i=void 0,r=void 0){if(e.type=nie,e.name=t,e.table=n,Lc(i)&&(e.array=!0),r&&i&&Ri(i.keyFor)){const s=vnt[r.operator]?r.left===e?r.right:r.left:r.callee&&r.callee.name==="equal"?r.arguments[r.arguments[0]===e?1:0]:null;s&&s.type===Dg&&Cnt(r,e,s,i.keyFor(s.value))}return e}function Cnt(e,t,n,i){return i<0?(e.type=Dg,e.value=!1,e.raw="false"):(t.type=unt,n.value=i,n.raw=i+""),!0}const oie="row_object";function aie(e,t,n=t.columnNames()){e.type=ant;const i=e.properties=[];for(const r of UN(n)){const[s,o]=pr(r)?r:[r,r];i.push({type:tie,key:{type:Dg,raw:jl(o)},value:sie({computed:!0},s,0,t.column(s))})}return e}function lie(e,t){return D1(aie({},e,t))}function uie(e,t){return jN.expr(lie(e,t))}function ynt(e){return Ri(e)?e:()=>e}const wnt="Escaped functions are not valid as rollup or pivot values.";function bnt(e,t,n){e.aggronly&&pn(wnt);const i=`(row,data)=>fn(${lie(e.table)},$)`;return{escape:jN.escape(i,ynt(t.expr),n)}}var Snt=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,7,9,32,4,318,1,80,3,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,68,8,2,0,3,0,2,3,2,4,2,0,15,1,83,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,7,19,58,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,343,9,54,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,10,5350,0,7,14,11465,27,2343,9,87,9,39,4,60,6,26,9,535,9,470,0,2,54,8,3,82,0,12,1,19628,1,4178,9,519,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,245,1,2,9,726,6,110,6,6,9,4759,9,787719,239],cie=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,4,51,13,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,39,27,10,22,251,41,7,1,17,2,60,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,31,9,2,0,3,0,2,37,2,0,26,0,2,0,45,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,200,32,32,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,26,3994,6,582,6842,29,1763,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,433,44,212,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,42,9,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,229,29,3,0,496,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],xnt="-----------------------------------------------------------------------------------------------------------------------------------------------------",die="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",fk={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},pk="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",Rnt={5:pk,"5module":pk+" export import",6:pk+" const class extends export import super"},Ent=/^in(stanceof)?$/,Fnt=new RegExp("["+die+"]"),Ant=new RegExp("["+die+xnt+"]");function bT(e,t){for(var n=65536,i=0;i<t.length;i+=2){if(n+=t[i],n>e)return!1;if(n+=t[i+1],n>=e)return!0}return!1}function Kl(e,t){return e<65?e===36:e<91?!0:e<97?e===95:e<123?!0:e<=65535?e>=170&&Fnt.test(String.fromCharCode(e)):t===!1?!1:bT(e,cie)}function qp(e,t){return e<48?e===36:e<58?!0:e<65?!1:e<91?!0:e<97?e===95:e<123?!0:e<=65535?e>=170&&Ant.test(String.fromCharCode(e)):t===!1?!1:bT(e,cie)||bT(e,Snt)}var Rt=function(t,n){n===void 0&&(n={}),this.label=t,this.keyword=n.keyword,this.beforeExpr=!!n.beforeExpr,this.startsExpr=!!n.startsExpr,this.isLoop=!!n.isLoop,this.isAssign=!!n.isAssign,this.prefix=!!n.prefix,this.postfix=!!n.postfix,this.binop=n.binop||null,this.updateContext=null};function xs(e,t){return new Rt(e,{beforeExpr:!0,binop:t})}var Rs={beforeExpr:!0},br={startsExpr:!0},KN={};function Ct(e,t){return t===void 0&&(t={}),t.keyword=e,KN[e]=new Rt(e,t)}var T={num:new Rt("num",br),regexp:new Rt("regexp",br),string:new Rt("string",br),name:new Rt("name",br),privateId:new Rt("privateId",br),eof:new Rt("eof"),bracketL:new Rt("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new Rt("]"),braceL:new Rt("{",{beforeExpr:!0,startsExpr:!0}),braceR:new Rt("}"),parenL:new Rt("(",{beforeExpr:!0,startsExpr:!0}),parenR:new Rt(")"),comma:new Rt(",",Rs),semi:new Rt(";",Rs),colon:new Rt(":",Rs),dot:new Rt("."),question:new Rt("?",Rs),questionDot:new Rt("?."),arrow:new Rt("=>",Rs),template:new Rt("template"),invalidTemplate:new Rt("invalidTemplate"),ellipsis:new Rt("...",Rs),backQuote:new Rt("`",br),dollarBraceL:new Rt("${",{beforeExpr:!0,startsExpr:!0}),eq:new Rt("=",{beforeExpr:!0,isAssign:!0}),assign:new Rt("_=",{beforeExpr:!0,isAssign:!0}),incDec:new Rt("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new Rt("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:xs("||",1),logicalAND:xs("&&",2),bitwiseOR:xs("|",3),bitwiseXOR:xs("^",4),bitwiseAND:xs("&",5),equality:xs("==/!=/===/!==",6),relational:xs("</>/<=/>=",7),bitShift:xs("<</>>/>>>",8),plusMin:new Rt("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:xs("%",10),star:xs("*",10),slash:xs("/",10),starstar:new Rt("**",{beforeExpr:!0}),coalesce:xs("??",1),_break:Ct("break"),_case:Ct("case",Rs),_catch:Ct("catch"),_continue:Ct("continue"),_debugger:Ct("debugger"),_default:Ct("default",Rs),_do:Ct("do",{isLoop:!0,beforeExpr:!0}),_else:Ct("else",Rs),_finally:Ct("finally"),_for:Ct("for",{isLoop:!0}),_function:Ct("function",br),_if:Ct("if"),_return:Ct("return",Rs),_switch:Ct("switch"),_throw:Ct("throw",Rs),_try:Ct("try"),_var:Ct("var"),_const:Ct("const"),_while:Ct("while",{isLoop:!0}),_with:Ct("with"),_new:Ct("new",{beforeExpr:!0,startsExpr:!0}),_this:Ct("this",br),_super:Ct("super",br),_class:Ct("class",br),_extends:Ct("extends",Rs),_export:Ct("export"),_import:Ct("import",br),_null:Ct("null",br),_true:Ct("true",br),_false:Ct("false",br),_in:Ct("in",{beforeExpr:!0,binop:7}),_instanceof:Ct("instanceof",{beforeExpr:!0,binop:7}),_typeof:Ct("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:Ct("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:Ct("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},Zs=/\r\n?|\n|\u2028|\u2029/,Dnt=new RegExp(Zs.source,"g");function kg(e){return e===10||e===13||e===8232||e===8233}function hie(e,t,n){n===void 0&&(n=e.length);for(var i=t;i<n;i++){var r=e.charCodeAt(i);if(kg(r))return i<n-1&&r===13&&e.charCodeAt(i+1)===10?i+2:i+1}return-1}var fie=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,As=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,pie=Object.prototype,knt=pie.hasOwnProperty,Pnt=pie.toString,Pg=Object.hasOwn||function(e,t){return knt.call(e,t)},g4=Array.isArray||function(e){return Pnt.call(e)==="[object Array]"},m4=Object.create(null);function Vu(e){return m4[e]||(m4[e]=new RegExp("^(?:"+e.replace(/ /g,"|")+")$"))}function Yl(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10)+55296,(e&1023)+56320))}var Mnt=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,T0=function(t,n){this.line=t,this.column=n};T0.prototype.offset=function(t){return new T0(this.line,this.column+t)};var iE=function(t,n,i){this.start=n,this.end=i,t.sourceFile!==null&&(this.source=t.sourceFile)};function gie(e,t){for(var n=1,i=0;;){var r=hie(e,i,t);if(r<0)return new T0(n,t-i);++n,i=r}}var ST={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},v4=!1;function Tnt(e){var t={};for(var n in ST)t[n]=e&&Pg(e,n)?e[n]:ST[n];if(t.ecmaVersion==="latest"?t.ecmaVersion=1e8:t.ecmaVersion==null?(!v4&&typeof console=="object"&&console.warn&&(v4=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),t.ecmaVersion=11):t.ecmaVersion>=2015&&(t.ecmaVersion-=2009),t.allowReserved==null&&(t.allowReserved=t.ecmaVersion<5),(!e||e.allowHashBang==null)&&(t.allowHashBang=t.ecmaVersion>=14),g4(t.onToken)){var i=t.onToken;t.onToken=function(r){return i.push(r)}}return g4(t.onComment)&&(t.onComment=Int(t,t.onComment)),t}function Int(e,t){return function(n,i,r,s,o,a){var l={type:n?"Block":"Line",value:i,start:r,end:s};e.locations&&(l.loc=new iE(this,o,a)),e.ranges&&(l.range=[r,s]),t.push(l)}}var I0=1,Mg=2,YN=4,mie=8,vie=16,Cie=32,XN=64,yie=128,GC=256,QN=I0|Mg|GC;function ZN(e,t){return Mg|(e?YN:0)|(t?mie:0)}var k1=0,JN=1,uu=2,wie=3,bie=4,Sie=5,Yn=function(t,n,i){this.options=t=Tnt(t),this.sourceFile=t.sourceFile,this.keywords=Vu(Rnt[t.ecmaVersion>=6?6:t.sourceType==="module"?"5module":5]);var r="";t.allowReserved!==!0&&(r=fk[t.ecmaVersion>=6?6:t.ecmaVersion===5?5:3],t.sourceType==="module"&&(r+=" await")),this.reservedWords=Vu(r);var s=(r?r+" ":"")+fk.strict;this.reservedWordsStrict=Vu(s),this.reservedWordsStrictBind=Vu(s+" "+fk.strictBind),this.input=String(n),this.containsEsc=!1,i?(this.pos=i,this.lineStart=this.input.lastIndexOf(`
`,i-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(Zs).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=T.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=t.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&t.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(I0),this.regexpState=null,this.privateNameStack=[]},Ka={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};Yn.prototype.parse=function(){var t=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(t)};Ka.inFunction.get=function(){return(this.currentVarScope().flags&Mg)>0};Ka.inGenerator.get=function(){return(this.currentVarScope().flags&mie)>0&&!this.currentVarScope().inClassFieldInit};Ka.inAsync.get=function(){return(this.currentVarScope().flags&YN)>0&&!this.currentVarScope().inClassFieldInit};Ka.canAwait.get=function(){for(var e=this.scopeStack.length-1;e>=0;e--){var t=this.scopeStack[e];if(t.inClassFieldInit||t.flags&GC)return!1;if(t.flags&Mg)return(t.flags&YN)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction};Ka.allowSuper.get=function(){var e=this.currentThisScope(),t=e.flags,n=e.inClassFieldInit;return(t&XN)>0||n||this.options.allowSuperOutsideMethod};Ka.allowDirectSuper.get=function(){return(this.currentThisScope().flags&yie)>0};Ka.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())};Ka.allowNewDotTarget.get=function(){var e=this.currentThisScope(),t=e.flags,n=e.inClassFieldInit;return(t&(Mg|GC))>0||n};Ka.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&GC)>0};Yn.extend=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];for(var i=this,r=0;r<t.length;r++)i=t[r](i);return i};Yn.parse=function(t,n){return new this(n,t).parse()};Yn.parseExpressionAt=function(t,n,i){var r=new this(i,t,n);return r.nextToken(),r.parseExpression()};Yn.tokenizer=function(t,n){return new this(n,t)};Object.defineProperties(Yn.prototype,Ka);var gr=Yn.prototype,_nt=/^(?:'((?:\\[^]|[^'\\])*?)'|"((?:\\[^]|[^"\\])*?)")/;gr.strictDirective=function(e){if(this.options.ecmaVersion<5)return!1;for(;;){As.lastIndex=e,e+=As.exec(this.input)[0].length;var t=_nt.exec(this.input.slice(e));if(!t)return!1;if((t[1]||t[2])==="use strict"){As.lastIndex=e+t[0].length;var n=As.exec(this.input),i=n.index+n[0].length,r=this.input.charAt(i);return r===";"||r==="}"||Zs.test(n[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(r)||r==="!"&&this.input.charAt(i+1)==="=")}e+=t[0].length,As.lastIndex=e,e+=As.exec(this.input)[0].length,this.input[e]===";"&&e++}};gr.eat=function(e){return this.type===e?(this.next(),!0):!1};gr.isContextual=function(e){return this.type===T.name&&this.value===e&&!this.containsEsc};gr.eatContextual=function(e){return this.isContextual(e)?(this.next(),!0):!1};gr.expectContextual=function(e){this.eatContextual(e)||this.unexpected()};gr.canInsertSemicolon=function(){return this.type===T.eof||this.type===T.braceR||Zs.test(this.input.slice(this.lastTokEnd,this.start))};gr.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0};gr.semicolon=function(){!this.eat(T.semi)&&!this.insertSemicolon()&&this.unexpected()};gr.afterTrailingComma=function(e,t){if(this.type===e)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),t||this.next(),!0};gr.expect=function(e){this.eat(e)||this.unexpected()};gr.unexpected=function(e){this.raise(e??this.start,"Unexpected token")};var rE=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};gr.checkPatternErrors=function(e,t){if(e){e.trailingComma>-1&&this.raiseRecoverable(e.trailingComma,"Comma is not permitted after the rest element");var n=t?e.parenthesizedAssign:e.parenthesizedBind;n>-1&&this.raiseRecoverable(n,t?"Assigning to rvalue":"Parenthesized pattern")}};gr.checkExpressionErrors=function(e,t){if(!e)return!1;var n=e.shorthandAssign,i=e.doubleProto;if(!t)return n>=0||i>=0;n>=0&&this.raise(n,"Shorthand property assignments are valid only in destructuring patterns"),i>=0&&this.raiseRecoverable(i,"Redefinition of __proto__ property")};gr.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")};gr.isSimpleAssignTarget=function(e){return e.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(e.expression):e.type==="Identifier"||e.type==="MemberExpression"};var Oe=Yn.prototype;Oe.parseTopLevel=function(e){var t=Object.create(null);for(e.body||(e.body=[]);this.type!==T.eof;){var n=this.parseStatement(null,!0,t);e.body.push(n)}if(this.inModule)for(var i=0,r=Object.keys(this.undefinedExports);i<r.length;i+=1){var s=r[i];this.raiseRecoverable(this.undefinedExports[s].start,"Export '"+s+"' is not defined")}return this.adaptDirectivePrologue(e.body),this.next(),e.sourceType=this.options.sourceType,this.finishNode(e,"Program")};var e$={kind:"loop"},Ont={kind:"switch"};Oe.isLet=function(e){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;As.lastIndex=this.pos;var t=As.exec(this.input),n=this.pos+t[0].length,i=this.input.charCodeAt(n);if(i===91||i===92)return!0;if(e)return!1;if(i===123||i>55295&&i<56320)return!0;if(Kl(i,!0)){for(var r=n+1;qp(i=this.input.charCodeAt(r),!0);)++r;if(i===92||i>55295&&i<56320)return!0;var s=this.input.slice(n,r);if(!Ent.test(s))return!0}return!1};Oe.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;As.lastIndex=this.pos;var e=As.exec(this.input),t=this.pos+e[0].length,n;return!Zs.test(this.input.slice(this.pos,t))&&this.input.slice(t,t+8)==="function"&&(t+8===this.input.length||!(qp(n=this.input.charCodeAt(t+8))||n>55295&&n<56320))};Oe.parseStatement=function(e,t,n){var i=this.type,r=this.startNode(),s;switch(this.isLet(e)&&(i=T._var,s="let"),i){case T._break:case T._continue:return this.parseBreakContinueStatement(r,i.keyword);case T._debugger:return this.parseDebuggerStatement(r);case T._do:return this.parseDoStatement(r);case T._for:return this.parseForStatement(r);case T._function:return e&&(this.strict||e!=="if"&&e!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(r,!1,!e);case T._class:return e&&this.unexpected(),this.parseClass(r,!0);case T._if:return this.parseIfStatement(r);case T._return:return this.parseReturnStatement(r);case T._switch:return this.parseSwitchStatement(r);case T._throw:return this.parseThrowStatement(r);case T._try:return this.parseTryStatement(r);case T._const:case T._var:return s=s||this.value,e&&s!=="var"&&this.unexpected(),this.parseVarStatement(r,s);case T._while:return this.parseWhileStatement(r);case T._with:return this.parseWithStatement(r);case T.braceL:return this.parseBlock(!0,r);case T.semi:return this.parseEmptyStatement(r);case T._export:case T._import:if(this.options.ecmaVersion>10&&i===T._import){As.lastIndex=this.pos;var o=As.exec(this.input),a=this.pos+o[0].length,l=this.input.charCodeAt(a);if(l===40||l===46)return this.parseExpressionStatement(r,this.parseExpression())}return this.options.allowImportExportEverywhere||(t||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),i===T._import?this.parseImport(r):this.parseExport(r,n);default:if(this.isAsyncFunction())return e&&this.unexpected(),this.next(),this.parseFunctionStatement(r,!0,!e);var u=this.value,c=this.parseExpression();return i===T.name&&c.type==="Identifier"&&this.eat(T.colon)?this.parseLabeledStatement(r,u,c,e):this.parseExpressionStatement(r,c)}};Oe.parseBreakContinueStatement=function(e,t){var n=t==="break";this.next(),this.eat(T.semi)||this.insertSemicolon()?e.label=null:this.type!==T.name?this.unexpected():(e.label=this.parseIdent(),this.semicolon());for(var i=0;i<this.labels.length;++i){var r=this.labels[i];if((e.label==null||r.name===e.label.name)&&(r.kind!=null&&(n||r.kind==="loop")||e.label&&n))break}return i===this.labels.length&&this.raise(e.start,"Unsyntactic "+t),this.finishNode(e,n?"BreakStatement":"ContinueStatement")};Oe.parseDebuggerStatement=function(e){return this.next(),this.semicolon(),this.finishNode(e,"DebuggerStatement")};Oe.parseDoStatement=function(e){return this.next(),this.labels.push(e$),e.body=this.parseStatement("do"),this.labels.pop(),this.expect(T._while),e.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(T.semi):this.semicolon(),this.finishNode(e,"DoWhileStatement")};Oe.parseForStatement=function(e){this.next();var t=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(e$),this.enterScope(0),this.expect(T.parenL),this.type===T.semi)return t>-1&&this.unexpected(t),this.parseFor(e,null);var n=this.isLet();if(this.type===T._var||this.type===T._const||n){var i=this.startNode(),r=n?"let":this.value;return this.next(),this.parseVar(i,!0,r),this.finishNode(i,"VariableDeclaration"),(this.type===T._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&i.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===T._in?t>-1&&this.unexpected(t):e.await=t>-1),this.parseForIn(e,i)):(t>-1&&this.unexpected(t),this.parseFor(e,i))}var s=this.isContextual("let"),o=!1,a=this.containsEsc,l=new rE,u=this.start,c=t>-1?this.parseExprSubscripts(l,"await"):this.parseExpression(!0,l);return this.type===T._in||(o=this.options.ecmaVersion>=6&&this.isContextual("of"))?(t>-1?(this.type===T._in&&this.unexpected(t),e.await=!0):o&&this.options.ecmaVersion>=8&&(c.start===u&&!a&&c.type==="Identifier"&&c.name==="async"?this.unexpected():this.options.ecmaVersion>=9&&(e.await=!1)),s&&o&&this.raise(c.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(c,!1,l),this.checkLValPattern(c),this.parseForIn(e,c)):(this.checkExpressionErrors(l,!0),t>-1&&this.unexpected(t),this.parseFor(e,c))};Oe.parseFunctionStatement=function(e,t,n){return this.next(),this.parseFunction(e,Nv|(n?0:xT),!1,t)};Oe.parseIfStatement=function(e){return this.next(),e.test=this.parseParenExpression(),e.consequent=this.parseStatement("if"),e.alternate=this.eat(T._else)?this.parseStatement("if"):null,this.finishNode(e,"IfStatement")};Oe.parseReturnStatement=function(e){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(T.semi)||this.insertSemicolon()?e.argument=null:(e.argument=this.parseExpression(),this.semicolon()),this.finishNode(e,"ReturnStatement")};Oe.parseSwitchStatement=function(e){this.next(),e.discriminant=this.parseParenExpression(),e.cases=[],this.expect(T.braceL),this.labels.push(Ont),this.enterScope(0);for(var t,n=!1;this.type!==T.braceR;)if(this.type===T._case||this.type===T._default){var i=this.type===T._case;t&&this.finishNode(t,"SwitchCase"),e.cases.push(t=this.startNode()),t.consequent=[],this.next(),i?t.test=this.parseExpression():(n&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),n=!0,t.test=null),this.expect(T.colon)}else t||this.unexpected(),t.consequent.push(this.parseStatement(null));return this.exitScope(),t&&this.finishNode(t,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(e,"SwitchStatement")};Oe.parseThrowStatement=function(e){return this.next(),Zs.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),e.argument=this.parseExpression(),this.semicolon(),this.finishNode(e,"ThrowStatement")};var Lnt=[];Oe.parseCatchClauseParam=function(){var e=this.parseBindingAtom(),t=e.type==="Identifier";return this.enterScope(t?Cie:0),this.checkLValPattern(e,t?bie:uu),this.expect(T.parenR),e};Oe.parseTryStatement=function(e){if(this.next(),e.block=this.parseBlock(),e.handler=null,this.type===T._catch){var t=this.startNode();this.next(),this.eat(T.parenL)?t.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),t.param=null,this.enterScope(0)),t.body=this.parseBlock(!1),this.exitScope(),e.handler=this.finishNode(t,"CatchClause")}return e.finalizer=this.eat(T._finally)?this.parseBlock():null,!e.handler&&!e.finalizer&&this.raise(e.start,"Missing catch or finally clause"),this.finishNode(e,"TryStatement")};Oe.parseVarStatement=function(e,t,n){return this.next(),this.parseVar(e,!1,t,n),this.semicolon(),this.finishNode(e,"VariableDeclaration")};Oe.parseWhileStatement=function(e){return this.next(),e.test=this.parseParenExpression(),this.labels.push(e$),e.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(e,"WhileStatement")};Oe.parseWithStatement=function(e){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),e.object=this.parseParenExpression(),e.body=this.parseStatement("with"),this.finishNode(e,"WithStatement")};Oe.parseEmptyStatement=function(e){return this.next(),this.finishNode(e,"EmptyStatement")};Oe.parseLabeledStatement=function(e,t,n,i){for(var r=0,s=this.labels;r<s.length;r+=1){var o=s[r];o.name===t&&this.raise(n.start,"Label '"+t+"' is already declared")}for(var a=this.type.isLoop?"loop":this.type===T._switch?"switch":null,l=this.labels.length-1;l>=0;l--){var u=this.labels[l];if(u.statementStart===e.start)u.statementStart=this.start,u.kind=a;else break}return this.labels.push({name:t,kind:a,statementStart:this.start}),e.body=this.parseStatement(i?i.indexOf("label")===-1?i+"label":i:"label"),this.labels.pop(),e.label=n,this.finishNode(e,"LabeledStatement")};Oe.parseExpressionStatement=function(e,t){return e.expression=t,this.semicolon(),this.finishNode(e,"ExpressionStatement")};Oe.parseBlock=function(e,t,n){for(e===void 0&&(e=!0),t===void 0&&(t=this.startNode()),t.body=[],this.expect(T.braceL),e&&this.enterScope(0);this.type!==T.braceR;){var i=this.parseStatement(null);t.body.push(i)}return n&&(this.strict=!1),this.next(),e&&this.exitScope(),this.finishNode(t,"BlockStatement")};Oe.parseFor=function(e,t){return e.init=t,this.expect(T.semi),e.test=this.type===T.semi?null:this.parseExpression(),this.expect(T.semi),e.update=this.type===T.parenR?null:this.parseExpression(),this.expect(T.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,"ForStatement")};Oe.parseForIn=function(e,t){var n=this.type===T._in;return this.next(),t.type==="VariableDeclaration"&&t.declarations[0].init!=null&&(!n||this.options.ecmaVersion<8||this.strict||t.kind!=="var"||t.declarations[0].id.type!=="Identifier")&&this.raise(t.start,(n?"for-in":"for-of")+" loop variable declaration may not have an initializer"),e.left=t,e.right=n?this.parseExpression():this.parseMaybeAssign(),this.expect(T.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,n?"ForInStatement":"ForOfStatement")};Oe.parseVar=function(e,t,n,i){for(e.declarations=[],e.kind=n;;){var r=this.startNode();if(this.parseVarId(r,n),this.eat(T.eq)?r.init=this.parseMaybeAssign(t):!i&&n==="const"&&!(this.type===T._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!i&&r.id.type!=="Identifier"&&!(t&&(this.type===T._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):r.init=null,e.declarations.push(this.finishNode(r,"VariableDeclarator")),!this.eat(T.comma))break}return e};Oe.parseVarId=function(e,t){e.id=this.parseBindingAtom(),this.checkLValPattern(e.id,t==="var"?JN:uu,!1)};var Nv=1,xT=2,xie=4;Oe.parseFunction=function(e,t,n,i,r){this.initFunction(e),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!i)&&(this.type===T.star&&t&xT&&this.unexpected(),e.generator=this.eat(T.star)),this.options.ecmaVersion>=8&&(e.async=!!i),t&Nv&&(e.id=t&xie&&this.type!==T.name?null:this.parseIdent(),e.id&&!(t&xT)&&this.checkLValSimple(e.id,this.strict||e.generator||e.async?this.treatFunctionsAsVar?JN:uu:wie));var s=this.yieldPos,o=this.awaitPos,a=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(ZN(e.async,e.generator)),t&Nv||(e.id=this.type===T.name?this.parseIdent():null),this.parseFunctionParams(e),this.parseFunctionBody(e,n,!1,r),this.yieldPos=s,this.awaitPos=o,this.awaitIdentPos=a,this.finishNode(e,t&Nv?"FunctionDeclaration":"FunctionExpression")};Oe.parseFunctionParams=function(e){this.expect(T.parenL),e.params=this.parseBindingList(T.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()};Oe.parseClass=function(e,t){this.next();var n=this.strict;this.strict=!0,this.parseClassId(e,t),this.parseClassSuper(e);var i=this.enterClassBody(),r=this.startNode(),s=!1;for(r.body=[],this.expect(T.braceL);this.type!==T.braceR;){var o=this.parseClassElement(e.superClass!==null);o&&(r.body.push(o),o.type==="MethodDefinition"&&o.kind==="constructor"?(s&&this.raiseRecoverable(o.start,"Duplicate constructor in the same class"),s=!0):o.key&&o.key.type==="PrivateIdentifier"&&Nnt(i,o)&&this.raiseRecoverable(o.key.start,"Identifier '#"+o.key.name+"' has already been declared"))}return this.strict=n,this.next(),e.body=this.finishNode(r,"ClassBody"),this.exitClassBody(),this.finishNode(e,t?"ClassDeclaration":"ClassExpression")};Oe.parseClassElement=function(e){if(this.eat(T.semi))return null;var t=this.options.ecmaVersion,n=this.startNode(),i="",r=!1,s=!1,o="method",a=!1;if(this.eatContextual("static")){if(t>=13&&this.eat(T.braceL))return this.parseClassStaticBlock(n),n;this.isClassElementNameStart()||this.type===T.star?a=!0:i="static"}if(n.static=a,!i&&t>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===T.star)&&!this.canInsertSemicolon()?s=!0:i="async"),!i&&(t>=9||!s)&&this.eat(T.star)&&(r=!0),!i&&!s&&!r){var l=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?o=l:i=l)}if(i?(n.computed=!1,n.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),n.key.name=i,this.finishNode(n.key,"Identifier")):this.parseClassElementName(n),t<13||this.type===T.parenL||o!=="method"||r||s){var u=!n.static&&P1(n,"constructor"),c=u&&e;u&&o!=="method"&&this.raise(n.key.start,"Constructor can't have get/set modifier"),n.kind=u?"constructor":o,this.parseClassMethod(n,r,s,c)}else this.parseClassField(n);return n};Oe.isClassElementNameStart=function(){return this.type===T.name||this.type===T.privateId||this.type===T.num||this.type===T.string||this.type===T.bracketL||this.type.keyword};Oe.parseClassElementName=function(e){this.type===T.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),e.computed=!1,e.key=this.parsePrivateIdent()):this.parsePropertyName(e)};Oe.parseClassMethod=function(e,t,n,i){var r=e.key;e.kind==="constructor"?(t&&this.raise(r.start,"Constructor can't be a generator"),n&&this.raise(r.start,"Constructor can't be an async method")):e.static&&P1(e,"prototype")&&this.raise(r.start,"Classes may not have a static property named prototype");var s=e.value=this.parseMethod(t,n,i);return e.kind==="get"&&s.params.length!==0&&this.raiseRecoverable(s.start,"getter should have no params"),e.kind==="set"&&s.params.length!==1&&this.raiseRecoverable(s.start,"setter should have exactly one param"),e.kind==="set"&&s.params[0].type==="RestElement"&&this.raiseRecoverable(s.params[0].start,"Setter cannot use rest params"),this.finishNode(e,"MethodDefinition")};Oe.parseClassField=function(e){if(P1(e,"constructor")?this.raise(e.key.start,"Classes can't have a field named 'constructor'"):e.static&&P1(e,"prototype")&&this.raise(e.key.start,"Classes can't have a static field named 'prototype'"),this.eat(T.eq)){var t=this.currentThisScope(),n=t.inClassFieldInit;t.inClassFieldInit=!0,e.value=this.parseMaybeAssign(),t.inClassFieldInit=n}else e.value=null;return this.semicolon(),this.finishNode(e,"PropertyDefinition")};Oe.parseClassStaticBlock=function(e){e.body=[];var t=this.labels;for(this.labels=[],this.enterScope(GC|XN);this.type!==T.braceR;){var n=this.parseStatement(null);e.body.push(n)}return this.next(),this.exitScope(),this.labels=t,this.finishNode(e,"StaticBlock")};Oe.parseClassId=function(e,t){this.type===T.name?(e.id=this.parseIdent(),t&&this.checkLValSimple(e.id,uu,!1)):(t===!0&&this.unexpected(),e.id=null)};Oe.parseClassSuper=function(e){e.superClass=this.eat(T._extends)?this.parseExprSubscripts(null,!1):null};Oe.enterClassBody=function(){var e={declared:Object.create(null),used:[]};return this.privateNameStack.push(e),e.declared};Oe.exitClassBody=function(){var e=this.privateNameStack.pop(),t=e.declared,n=e.used;if(this.options.checkPrivateFields)for(var i=this.privateNameStack.length,r=i===0?null:this.privateNameStack[i-1],s=0;s<n.length;++s){var o=n[s];Pg(t,o.name)||(r?r.used.push(o):this.raiseRecoverable(o.start,"Private field '#"+o.name+"' must be declared in an enclosing class"))}};function Nnt(e,t){var n=t.key.name,i=e[n],r="true";return t.type==="MethodDefinition"&&(t.kind==="get"||t.kind==="set")&&(r=(t.static?"s":"i")+t.kind),i==="iget"&&r==="iset"||i==="iset"&&r==="iget"||i==="sget"&&r==="sset"||i==="sset"&&r==="sget"?(e[n]="true",!1):i?!0:(e[n]=r,!1)}function P1(e,t){var n=e.computed,i=e.key;return!n&&(i.type==="Identifier"&&i.name===t||i.type==="Literal"&&i.value===t)}Oe.parseExportAllDeclaration=function(e,t){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(e.exported=this.parseModuleExportName(),this.checkExport(t,e.exported,this.lastTokStart)):e.exported=null),this.expectContextual("from"),this.type!==T.string&&this.unexpected(),e.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(e.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(e,"ExportAllDeclaration")};Oe.parseExport=function(e,t){if(this.next(),this.eat(T.star))return this.parseExportAllDeclaration(e,t);if(this.eat(T._default))return this.checkExport(t,"default",this.lastTokStart),e.declaration=this.parseExportDefaultDeclaration(),this.finishNode(e,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())e.declaration=this.parseExportDeclaration(e),e.declaration.type==="VariableDeclaration"?this.checkVariableExport(t,e.declaration.declarations):this.checkExport(t,e.declaration.id,e.declaration.id.start),e.specifiers=[],e.source=null;else{if(e.declaration=null,e.specifiers=this.parseExportSpecifiers(t),this.eatContextual("from"))this.type!==T.string&&this.unexpected(),e.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(e.attributes=this.parseWithClause());else{for(var n=0,i=e.specifiers;n<i.length;n+=1){var r=i[n];this.checkUnreserved(r.local),this.checkLocalExport(r.local),r.local.type==="Literal"&&this.raise(r.local.start,"A string literal cannot be used as an exported binding without `from`.")}e.source=null}this.semicolon()}return this.finishNode(e,"ExportNamedDeclaration")};Oe.parseExportDeclaration=function(e){return this.parseStatement(null)};Oe.parseExportDefaultDeclaration=function(){var e;if(this.type===T._function||(e=this.isAsyncFunction())){var t=this.startNode();return this.next(),e&&this.next(),this.parseFunction(t,Nv|xie,!1,e)}else if(this.type===T._class){var n=this.startNode();return this.parseClass(n,"nullableID")}else{var i=this.parseMaybeAssign();return this.semicolon(),i}};Oe.checkExport=function(e,t,n){e&&(typeof t!="string"&&(t=t.type==="Identifier"?t.name:t.value),Pg(e,t)&&this.raiseRecoverable(n,"Duplicate export '"+t+"'"),e[t]=!0)};Oe.checkPatternExport=function(e,t){var n=t.type;if(n==="Identifier")this.checkExport(e,t,t.start);else if(n==="ObjectPattern")for(var i=0,r=t.properties;i<r.length;i+=1){var s=r[i];this.checkPatternExport(e,s)}else if(n==="ArrayPattern")for(var o=0,a=t.elements;o<a.length;o+=1){var l=a[o];l&&this.checkPatternExport(e,l)}else n==="Property"?this.checkPatternExport(e,t.value):n==="AssignmentPattern"?this.checkPatternExport(e,t.left):n==="RestElement"&&this.checkPatternExport(e,t.argument)};Oe.checkVariableExport=function(e,t){if(e)for(var n=0,i=t;n<i.length;n+=1){var r=i[n];this.checkPatternExport(e,r.id)}};Oe.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()};Oe.parseExportSpecifier=function(e){var t=this.startNode();return t.local=this.parseModuleExportName(),t.exported=this.eatContextual("as")?this.parseModuleExportName():t.local,this.checkExport(e,t.exported,t.exported.start),this.finishNode(t,"ExportSpecifier")};Oe.parseExportSpecifiers=function(e){var t=[],n=!0;for(this.expect(T.braceL);!this.eat(T.braceR);){if(n)n=!1;else if(this.expect(T.comma),this.afterTrailingComma(T.braceR))break;t.push(this.parseExportSpecifier(e))}return t};Oe.parseImport=function(e){return this.next(),this.type===T.string?(e.specifiers=Lnt,e.source=this.parseExprAtom()):(e.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),e.source=this.type===T.string?this.parseExprAtom():this.unexpected()),this.options.ecmaVersion>=16&&(e.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(e,"ImportDeclaration")};Oe.parseImportSpecifier=function(){var e=this.startNode();return e.imported=this.parseModuleExportName(),this.eatContextual("as")?e.local=this.parseIdent():(this.checkUnreserved(e.imported),e.local=e.imported),this.checkLValSimple(e.local,uu),this.finishNode(e,"ImportSpecifier")};Oe.parseImportDefaultSpecifier=function(){var e=this.startNode();return e.local=this.parseIdent(),this.checkLValSimple(e.local,uu),this.finishNode(e,"ImportDefaultSpecifier")};Oe.parseImportNamespaceSpecifier=function(){var e=this.startNode();return this.next(),this.expectContextual("as"),e.local=this.parseIdent(),this.checkLValSimple(e.local,uu),this.finishNode(e,"ImportNamespaceSpecifier")};Oe.parseImportSpecifiers=function(){var e=[],t=!0;if(this.type===T.name&&(e.push(this.parseImportDefaultSpecifier()),!this.eat(T.comma)))return e;if(this.type===T.star)return e.push(this.parseImportNamespaceSpecifier()),e;for(this.expect(T.braceL);!this.eat(T.braceR);){if(t)t=!1;else if(this.expect(T.comma),this.afterTrailingComma(T.braceR))break;e.push(this.parseImportSpecifier())}return e};Oe.parseWithClause=function(){var e=[];if(!this.eat(T._with))return e;this.expect(T.braceL);for(var t={},n=!0;!this.eat(T.braceR);){if(n)n=!1;else if(this.expect(T.comma),this.afterTrailingComma(T.braceR))break;var i=this.parseImportAttribute(),r=i.key.type==="Identifier"?i.key.name:i.key.value;Pg(t,r)&&this.raiseRecoverable(i.key.start,"Duplicate attribute key '"+r+"'"),t[r]=!0,e.push(i)}return e};Oe.parseImportAttribute=function(){var e=this.startNode();return e.key=this.type===T.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never"),this.expect(T.colon),this.type!==T.string&&this.unexpected(),e.value=this.parseExprAtom(),this.finishNode(e,"ImportAttribute")};Oe.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===T.string){var e=this.parseLiteral(this.value);return Mnt.test(e.value)&&this.raise(e.start,"An export name cannot include a lone surrogate."),e}return this.parseIdent(!0)};Oe.adaptDirectivePrologue=function(e){for(var t=0;t<e.length&&this.isDirectiveCandidate(e[t]);++t)e[t].directive=e[t].expression.raw.slice(1,-1)};Oe.isDirectiveCandidate=function(e){return this.options.ecmaVersion>=5&&e.type==="ExpressionStatement"&&e.expression.type==="Literal"&&typeof e.expression.value=="string"&&(this.input[e.start]==='"'||this.input[e.start]==="'")};var Js=Yn.prototype;Js.toAssignable=function(e,t,n){if(this.options.ecmaVersion>=6&&e)switch(e.type){case"Identifier":this.inAsync&&e.name==="await"&&this.raise(e.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":e.type="ObjectPattern",n&&this.checkPatternErrors(n,!0);for(var i=0,r=e.properties;i<r.length;i+=1){var s=r[i];this.toAssignable(s,t),s.type==="RestElement"&&(s.argument.type==="ArrayPattern"||s.argument.type==="ObjectPattern")&&this.raise(s.argument.start,"Unexpected token")}break;case"Property":e.kind!=="init"&&this.raise(e.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(e.value,t);break;case"ArrayExpression":e.type="ArrayPattern",n&&this.checkPatternErrors(n,!0),this.toAssignableList(e.elements,t);break;case"SpreadElement":e.type="RestElement",this.toAssignable(e.argument,t),e.argument.type==="AssignmentPattern"&&this.raise(e.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":e.operator!=="="&&this.raise(e.left.end,"Only '=' operator can be used for specifying default value."),e.type="AssignmentPattern",delete e.operator,this.toAssignable(e.left,t);break;case"ParenthesizedExpression":this.toAssignable(e.expression,t,n);break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!t)break;default:this.raise(e.start,"Assigning to rvalue")}else n&&this.checkPatternErrors(n,!0);return e};Js.toAssignableList=function(e,t){for(var n=e.length,i=0;i<n;i++){var r=e[i];r&&this.toAssignable(r,t)}if(n){var s=e[n-1];this.options.ecmaVersion===6&&t&&s&&s.type==="RestElement"&&s.argument.type!=="Identifier"&&this.unexpected(s.argument.start)}return e};Js.parseSpread=function(e){var t=this.startNode();return this.next(),t.argument=this.parseMaybeAssign(!1,e),this.finishNode(t,"SpreadElement")};Js.parseRestBinding=function(){var e=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==T.name&&this.unexpected(),e.argument=this.parseBindingAtom(),this.finishNode(e,"RestElement")};Js.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case T.bracketL:var e=this.startNode();return this.next(),e.elements=this.parseBindingList(T.bracketR,!0,!0),this.finishNode(e,"ArrayPattern");case T.braceL:return this.parseObj(!0)}return this.parseIdent()};Js.parseBindingList=function(e,t,n,i){for(var r=[],s=!0;!this.eat(e);)if(s?s=!1:this.expect(T.comma),t&&this.type===T.comma)r.push(null);else{if(n&&this.afterTrailingComma(e))break;if(this.type===T.ellipsis){var o=this.parseRestBinding();this.parseBindingListItem(o),r.push(o),this.type===T.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(e);break}else r.push(this.parseAssignableListItem(i))}return r};Js.parseAssignableListItem=function(e){var t=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(t),t};Js.parseBindingListItem=function(e){return e};Js.parseMaybeDefault=function(e,t,n){if(n=n||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(T.eq))return n;var i=this.startNodeAt(e,t);return i.left=n,i.right=this.parseMaybeAssign(),this.finishNode(i,"AssignmentPattern")};Js.checkLValSimple=function(e,t,n){t===void 0&&(t=k1);var i=t!==k1;switch(e.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(e.name)&&this.raiseRecoverable(e.start,(i?"Binding ":"Assigning to ")+e.name+" in strict mode"),i&&(t===uu&&e.name==="let"&&this.raiseRecoverable(e.start,"let is disallowed as a lexically bound name"),n&&(Pg(n,e.name)&&this.raiseRecoverable(e.start,"Argument name clash"),n[e.name]=!0),t!==Sie&&this.declareName(e.name,t,e.start));break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":i&&this.raiseRecoverable(e.start,"Binding member expression");break;case"ParenthesizedExpression":return i&&this.raiseRecoverable(e.start,"Binding parenthesized expression"),this.checkLValSimple(e.expression,t,n);default:this.raise(e.start,(i?"Binding":"Assigning to")+" rvalue")}};Js.checkLValPattern=function(e,t,n){switch(t===void 0&&(t=k1),e.type){case"ObjectPattern":for(var i=0,r=e.properties;i<r.length;i+=1){var s=r[i];this.checkLValInnerPattern(s,t,n)}break;case"ArrayPattern":for(var o=0,a=e.elements;o<a.length;o+=1){var l=a[o];l&&this.checkLValInnerPattern(l,t,n)}break;default:this.checkLValSimple(e,t,n)}};Js.checkLValInnerPattern=function(e,t,n){switch(t===void 0&&(t=k1),e.type){case"Property":this.checkLValInnerPattern(e.value,t,n);break;case"AssignmentPattern":this.checkLValPattern(e.left,t,n);break;case"RestElement":this.checkLValPattern(e.argument,t,n);break;default:this.checkLValPattern(e,t,n)}};var lo=function(t,n,i,r,s){this.token=t,this.isExpr=!!n,this.preserveSpace=!!i,this.override=r,this.generator=!!s},on={b_stat:new lo("{",!1),b_expr:new lo("{",!0),b_tmpl:new lo("${",!1),p_stat:new lo("(",!1),p_expr:new lo("(",!0),q_tmpl:new lo("`",!0,!0,function(e){return e.tryReadTemplateToken()}),f_stat:new lo("function",!1),f_expr:new lo("function",!0),f_expr_gen:new lo("function",!0,!1,null,!0),f_gen:new lo("function",!1,!1,null,!0)},Tg=Yn.prototype;Tg.initialContext=function(){return[on.b_stat]};Tg.curContext=function(){return this.context[this.context.length-1]};Tg.braceIsBlock=function(e){var t=this.curContext();return t===on.f_expr||t===on.f_stat?!0:e===T.colon&&(t===on.b_stat||t===on.b_expr)?!t.isExpr:e===T._return||e===T.name&&this.exprAllowed?Zs.test(this.input.slice(this.lastTokEnd,this.start)):e===T._else||e===T.semi||e===T.eof||e===T.parenR||e===T.arrow?!0:e===T.braceL?t===on.b_stat:e===T._var||e===T._const||e===T.name?!1:!this.exprAllowed};Tg.inGeneratorContext=function(){for(var e=this.context.length-1;e>=1;e--){var t=this.context[e];if(t.token==="function")return t.generator}return!1};Tg.updateContext=function(e){var t,n=this.type;n.keyword&&e===T.dot?this.exprAllowed=!1:(t=n.updateContext)?t.call(this,e):this.exprAllowed=n.beforeExpr};Tg.overrideContext=function(e){this.curContext()!==e&&(this.context[this.context.length-1]=e)};T.parenR.updateContext=T.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var e=this.context.pop();e===on.b_stat&&this.curContext().token==="function"&&(e=this.context.pop()),this.exprAllowed=!e.isExpr};T.braceL.updateContext=function(e){this.context.push(this.braceIsBlock(e)?on.b_stat:on.b_expr),this.exprAllowed=!0};T.dollarBraceL.updateContext=function(){this.context.push(on.b_tmpl),this.exprAllowed=!0};T.parenL.updateContext=function(e){var t=e===T._if||e===T._for||e===T._with||e===T._while;this.context.push(t?on.p_stat:on.p_expr),this.exprAllowed=!0};T.incDec.updateContext=function(){};T._function.updateContext=T._class.updateContext=function(e){e.beforeExpr&&e!==T._else&&!(e===T.semi&&this.curContext()!==on.p_stat)&&!(e===T._return&&Zs.test(this.input.slice(this.lastTokEnd,this.start)))&&!((e===T.colon||e===T.braceL)&&this.curContext()===on.b_stat)?this.context.push(on.f_expr):this.context.push(on.f_stat),this.exprAllowed=!1};T.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0};T.backQuote.updateContext=function(){this.curContext()===on.q_tmpl?this.context.pop():this.context.push(on.q_tmpl),this.exprAllowed=!1};T.star.updateContext=function(e){if(e===T._function){var t=this.context.length-1;this.context[t]===on.f_expr?this.context[t]=on.f_expr_gen:this.context[t]=on.f_gen}this.exprAllowed=!0};T.name.updateContext=function(e){var t=!1;this.options.ecmaVersion>=6&&e!==T.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(t=!0),this.exprAllowed=t};var Ye=Yn.prototype;Ye.checkPropClash=function(e,t,n){if(!(this.options.ecmaVersion>=9&&e.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(e.computed||e.method||e.shorthand))){var i=e.key,r;switch(i.type){case"Identifier":r=i.name;break;case"Literal":r=String(i.value);break;default:return}var s=e.kind;if(this.options.ecmaVersion>=6){r==="__proto__"&&s==="init"&&(t.proto&&(n?n.doubleProto<0&&(n.doubleProto=i.start):this.raiseRecoverable(i.start,"Redefinition of __proto__ property")),t.proto=!0);return}r="$"+r;var o=t[r];if(o){var a;s==="init"?a=this.strict&&o.init||o.get||o.set:a=o.init||o[s],a&&this.raiseRecoverable(i.start,"Redefinition of property")}else o=t[r]={init:!1,get:!1,set:!1};o[s]=!0}};Ye.parseExpression=function(e,t){var n=this.start,i=this.startLoc,r=this.parseMaybeAssign(e,t);if(this.type===T.comma){var s=this.startNodeAt(n,i);for(s.expressions=[r];this.eat(T.comma);)s.expressions.push(this.parseMaybeAssign(e,t));return this.finishNode(s,"SequenceExpression")}return r};Ye.parseMaybeAssign=function(e,t,n){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(e);this.exprAllowed=!1}var i=!1,r=-1,s=-1,o=-1;t?(r=t.parenthesizedAssign,s=t.trailingComma,o=t.doubleProto,t.parenthesizedAssign=t.trailingComma=-1):(t=new rE,i=!0);var a=this.start,l=this.startLoc;(this.type===T.parenL||this.type===T.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=e==="await");var u=this.parseMaybeConditional(e,t);if(n&&(u=n.call(this,u,a,l)),this.type.isAssign){var c=this.startNodeAt(a,l);return c.operator=this.value,this.type===T.eq&&(u=this.toAssignable(u,!1,t)),i||(t.parenthesizedAssign=t.trailingComma=t.doubleProto=-1),t.shorthandAssign>=u.start&&(t.shorthandAssign=-1),this.type===T.eq?this.checkLValPattern(u):this.checkLValSimple(u),c.left=u,this.next(),c.right=this.parseMaybeAssign(e),o>-1&&(t.doubleProto=o),this.finishNode(c,"AssignmentExpression")}else i&&this.checkExpressionErrors(t,!0);return r>-1&&(t.parenthesizedAssign=r),s>-1&&(t.trailingComma=s),u};Ye.parseMaybeConditional=function(e,t){var n=this.start,i=this.startLoc,r=this.parseExprOps(e,t);if(this.checkExpressionErrors(t))return r;if(this.eat(T.question)){var s=this.startNodeAt(n,i);return s.test=r,s.consequent=this.parseMaybeAssign(),this.expect(T.colon),s.alternate=this.parseMaybeAssign(e),this.finishNode(s,"ConditionalExpression")}return r};Ye.parseExprOps=function(e,t){var n=this.start,i=this.startLoc,r=this.parseMaybeUnary(t,!1,!1,e);return this.checkExpressionErrors(t)||r.start===n&&r.type==="ArrowFunctionExpression"?r:this.parseExprOp(r,n,i,-1,e)};Ye.parseExprOp=function(e,t,n,i,r){var s=this.type.binop;if(s!=null&&(!r||this.type!==T._in)&&s>i){var o=this.type===T.logicalOR||this.type===T.logicalAND,a=this.type===T.coalesce;a&&(s=T.logicalAND.binop);var l=this.value;this.next();var u=this.start,c=this.startLoc,d=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,r),u,c,s,r),h=this.buildBinary(t,n,e,d,l,o||a);return(o&&this.type===T.coalesce||a&&(this.type===T.logicalOR||this.type===T.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(h,t,n,i,r)}return e};Ye.buildBinary=function(e,t,n,i,r,s){i.type==="PrivateIdentifier"&&this.raise(i.start,"Private identifier can only be left side of binary expression");var o=this.startNodeAt(e,t);return o.left=n,o.operator=r,o.right=i,this.finishNode(o,s?"LogicalExpression":"BinaryExpression")};Ye.parseMaybeUnary=function(e,t,n,i){var r=this.start,s=this.startLoc,o;if(this.isContextual("await")&&this.canAwait)o=this.parseAwait(i),t=!0;else if(this.type.prefix){var a=this.startNode(),l=this.type===T.incDec;a.operator=this.value,a.prefix=!0,this.next(),a.argument=this.parseMaybeUnary(null,!0,l,i),this.checkExpressionErrors(e,!0),l?this.checkLValSimple(a.argument):this.strict&&a.operator==="delete"&&Rie(a.argument)?this.raiseRecoverable(a.start,"Deleting local variable in strict mode"):a.operator==="delete"&&RT(a.argument)?this.raiseRecoverable(a.start,"Private fields can not be deleted"):t=!0,o=this.finishNode(a,l?"UpdateExpression":"UnaryExpression")}else if(!t&&this.type===T.privateId)(i||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),o=this.parsePrivateIdent(),this.type!==T._in&&this.unexpected();else{if(o=this.parseExprSubscripts(e,i),this.checkExpressionErrors(e))return o;for(;this.type.postfix&&!this.canInsertSemicolon();){var u=this.startNodeAt(r,s);u.operator=this.value,u.prefix=!1,u.argument=o,this.checkLValSimple(o),this.next(),o=this.finishNode(u,"UpdateExpression")}}if(!n&&this.eat(T.starstar))if(t)this.unexpected(this.lastTokStart);else return this.buildBinary(r,s,o,this.parseMaybeUnary(null,!1,!1,i),"**",!1);else return o};function Rie(e){return e.type==="Identifier"||e.type==="ParenthesizedExpression"&&Rie(e.expression)}function RT(e){return e.type==="MemberExpression"&&e.property.type==="PrivateIdentifier"||e.type==="ChainExpression"&&RT(e.expression)||e.type==="ParenthesizedExpression"&&RT(e.expression)}Ye.parseExprSubscripts=function(e,t){var n=this.start,i=this.startLoc,r=this.parseExprAtom(e,t);if(r.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return r;var s=this.parseSubscripts(r,n,i,!1,t);return e&&s.type==="MemberExpression"&&(e.parenthesizedAssign>=s.start&&(e.parenthesizedAssign=-1),e.parenthesizedBind>=s.start&&(e.parenthesizedBind=-1),e.trailingComma>=s.start&&(e.trailingComma=-1)),s};Ye.parseSubscripts=function(e,t,n,i,r){for(var s=this.options.ecmaVersion>=8&&e.type==="Identifier"&&e.name==="async"&&this.lastTokEnd===e.end&&!this.canInsertSemicolon()&&e.end-e.start===5&&this.potentialArrowAt===e.start,o=!1;;){var a=this.parseSubscript(e,t,n,i,s,o,r);if(a.optional&&(o=!0),a===e||a.type==="ArrowFunctionExpression"){if(o){var l=this.startNodeAt(t,n);l.expression=a,a=this.finishNode(l,"ChainExpression")}return a}e=a}};Ye.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(T.arrow)};Ye.parseSubscriptAsyncArrow=function(e,t,n,i){return this.parseArrowExpression(this.startNodeAt(e,t),n,!0,i)};Ye.parseSubscript=function(e,t,n,i,r,s,o){var a=this.options.ecmaVersion>=11,l=a&&this.eat(T.questionDot);i&&l&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var u=this.eat(T.bracketL);if(u||l&&this.type!==T.parenL&&this.type!==T.backQuote||this.eat(T.dot)){var c=this.startNodeAt(t,n);c.object=e,u?(c.property=this.parseExpression(),this.expect(T.bracketR)):this.type===T.privateId&&e.type!=="Super"?c.property=this.parsePrivateIdent():c.property=this.parseIdent(this.options.allowReserved!=="never"),c.computed=!!u,a&&(c.optional=l),e=this.finishNode(c,"MemberExpression")}else if(!i&&this.eat(T.parenL)){var d=new rE,h=this.yieldPos,p=this.awaitPos,g=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var m=this.parseExprList(T.parenR,this.options.ecmaVersion>=8,!1,d);if(r&&!l&&this.shouldParseAsyncArrow())return this.checkPatternErrors(d,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=h,this.awaitPos=p,this.awaitIdentPos=g,this.parseSubscriptAsyncArrow(t,n,m,o);this.checkExpressionErrors(d,!0),this.yieldPos=h||this.yieldPos,this.awaitPos=p||this.awaitPos,this.awaitIdentPos=g||this.awaitIdentPos;var C=this.startNodeAt(t,n);C.callee=e,C.arguments=m,a&&(C.optional=l),e=this.finishNode(C,"CallExpression")}else if(this.type===T.backQuote){(l||s)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var y=this.startNodeAt(t,n);y.tag=e,y.quasi=this.parseTemplate({isTagged:!0}),e=this.finishNode(y,"TaggedTemplateExpression")}return e};Ye.parseExprAtom=function(e,t,n){this.type===T.slash&&this.readRegexp();var i,r=this.potentialArrowAt===this.start;switch(this.type){case T._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),i=this.startNode(),this.next(),this.type===T.parenL&&!this.allowDirectSuper&&this.raise(i.start,"super() call outside constructor of a subclass"),this.type!==T.dot&&this.type!==T.bracketL&&this.type!==T.parenL&&this.unexpected(),this.finishNode(i,"Super");case T._this:return i=this.startNode(),this.next(),this.finishNode(i,"ThisExpression");case T.name:var s=this.start,o=this.startLoc,a=this.containsEsc,l=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!a&&l.name==="async"&&!this.canInsertSemicolon()&&this.eat(T._function))return this.overrideContext(on.f_expr),this.parseFunction(this.startNodeAt(s,o),0,!1,!0,t);if(r&&!this.canInsertSemicolon()){if(this.eat(T.arrow))return this.parseArrowExpression(this.startNodeAt(s,o),[l],!1,t);if(this.options.ecmaVersion>=8&&l.name==="async"&&this.type===T.name&&!a&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return l=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(T.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(s,o),[l],!0,t)}return l;case T.regexp:var u=this.value;return i=this.parseLiteral(u.value),i.regex={pattern:u.pattern,flags:u.flags},i;case T.num:case T.string:return this.parseLiteral(this.value);case T._null:case T._true:case T._false:return i=this.startNode(),i.value=this.type===T._null?null:this.type===T._true,i.raw=this.type.keyword,this.next(),this.finishNode(i,"Literal");case T.parenL:var c=this.start,d=this.parseParenAndDistinguishExpression(r,t);return e&&(e.parenthesizedAssign<0&&!this.isSimpleAssignTarget(d)&&(e.parenthesizedAssign=c),e.parenthesizedBind<0&&(e.parenthesizedBind=c)),d;case T.bracketL:return i=this.startNode(),this.next(),i.elements=this.parseExprList(T.bracketR,!0,!0,e),this.finishNode(i,"ArrayExpression");case T.braceL:return this.overrideContext(on.b_expr),this.parseObj(!1,e);case T._function:return i=this.startNode(),this.next(),this.parseFunction(i,0);case T._class:return this.parseClass(this.startNode(),!1);case T._new:return this.parseNew();case T.backQuote:return this.parseTemplate();case T._import:return this.options.ecmaVersion>=11?this.parseExprImport(n):this.unexpected();default:return this.parseExprAtomDefault()}};Ye.parseExprAtomDefault=function(){this.unexpected()};Ye.parseExprImport=function(e){var t=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===T.parenL&&!e)return this.parseDynamicImport(t);if(this.type===T.dot){var n=this.startNodeAt(t.start,t.loc&&t.loc.start);return n.name="import",t.meta=this.finishNode(n,"Identifier"),this.parseImportMeta(t)}else this.unexpected()};Ye.parseDynamicImport=function(e){if(this.next(),e.source=this.parseMaybeAssign(),this.options.ecmaVersion>=16)this.eat(T.parenR)?e.options=null:(this.expect(T.comma),this.afterTrailingComma(T.parenR)?e.options=null:(e.options=this.parseMaybeAssign(),this.eat(T.parenR)||(this.expect(T.comma),this.afterTrailingComma(T.parenR)||this.unexpected())));else if(!this.eat(T.parenR)){var t=this.start;this.eat(T.comma)&&this.eat(T.parenR)?this.raiseRecoverable(t,"Trailing comma is not allowed in import()"):this.unexpected(t)}return this.finishNode(e,"ImportExpression")};Ye.parseImportMeta=function(e){this.next();var t=this.containsEsc;return e.property=this.parseIdent(!0),e.property.name!=="meta"&&this.raiseRecoverable(e.property.start,"The only valid meta property for import is 'import.meta'"),t&&this.raiseRecoverable(e.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(e.start,"Cannot use 'import.meta' outside a module"),this.finishNode(e,"MetaProperty")};Ye.parseLiteral=function(e){var t=this.startNode();return t.value=e,t.raw=this.input.slice(this.start,this.end),t.raw.charCodeAt(t.raw.length-1)===110&&(t.bigint=t.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(t,"Literal")};Ye.parseParenExpression=function(){this.expect(T.parenL);var e=this.parseExpression();return this.expect(T.parenR),e};Ye.shouldParseArrow=function(e){return!this.canInsertSemicolon()};Ye.parseParenAndDistinguishExpression=function(e,t){var n=this.start,i=this.startLoc,r,s=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var o=this.start,a=this.startLoc,l=[],u=!0,c=!1,d=new rE,h=this.yieldPos,p=this.awaitPos,g;for(this.yieldPos=0,this.awaitPos=0;this.type!==T.parenR;)if(u?u=!1:this.expect(T.comma),s&&this.afterTrailingComma(T.parenR,!0)){c=!0;break}else if(this.type===T.ellipsis){g=this.start,l.push(this.parseParenItem(this.parseRestBinding())),this.type===T.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else l.push(this.parseMaybeAssign(!1,d,this.parseParenItem));var m=this.lastTokEnd,C=this.lastTokEndLoc;if(this.expect(T.parenR),e&&this.shouldParseArrow(l)&&this.eat(T.arrow))return this.checkPatternErrors(d,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=h,this.awaitPos=p,this.parseParenArrowList(n,i,l,t);(!l.length||c)&&this.unexpected(this.lastTokStart),g&&this.unexpected(g),this.checkExpressionErrors(d,!0),this.yieldPos=h||this.yieldPos,this.awaitPos=p||this.awaitPos,l.length>1?(r=this.startNodeAt(o,a),r.expressions=l,this.finishNodeAt(r,"SequenceExpression",m,C)):r=l[0]}else r=this.parseParenExpression();if(this.options.preserveParens){var y=this.startNodeAt(n,i);return y.expression=r,this.finishNode(y,"ParenthesizedExpression")}else return r};Ye.parseParenItem=function(e){return e};Ye.parseParenArrowList=function(e,t,n,i){return this.parseArrowExpression(this.startNodeAt(e,t),n,!1,i)};var $nt=[];Ye.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var e=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===T.dot){var t=this.startNodeAt(e.start,e.loc&&e.loc.start);t.name="new",e.meta=this.finishNode(t,"Identifier"),this.next();var n=this.containsEsc;return e.property=this.parseIdent(!0),e.property.name!=="target"&&this.raiseRecoverable(e.property.start,"The only valid meta property for new is 'new.target'"),n&&this.raiseRecoverable(e.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(e.start,"'new.target' can only be used in functions and class static block"),this.finishNode(e,"MetaProperty")}var i=this.start,r=this.startLoc;return e.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),i,r,!0,!1),this.eat(T.parenL)?e.arguments=this.parseExprList(T.parenR,this.options.ecmaVersion>=8,!1):e.arguments=$nt,this.finishNode(e,"NewExpression")};Ye.parseTemplateElement=function(e){var t=e.isTagged,n=this.startNode();return this.type===T.invalidTemplate?(t||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),n.value={raw:this.value.replace(/\r\n?/g,`
`),cooked:null}):n.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),n.tail=this.type===T.backQuote,this.finishNode(n,"TemplateElement")};Ye.parseTemplate=function(e){e===void 0&&(e={});var t=e.isTagged;t===void 0&&(t=!1);var n=this.startNode();this.next(),n.expressions=[];var i=this.parseTemplateElement({isTagged:t});for(n.quasis=[i];!i.tail;)this.type===T.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(T.dollarBraceL),n.expressions.push(this.parseExpression()),this.expect(T.braceR),n.quasis.push(i=this.parseTemplateElement({isTagged:t}));return this.next(),this.finishNode(n,"TemplateLiteral")};Ye.isAsyncProp=function(e){return!e.computed&&e.key.type==="Identifier"&&e.key.name==="async"&&(this.type===T.name||this.type===T.num||this.type===T.string||this.type===T.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===T.star)&&!Zs.test(this.input.slice(this.lastTokEnd,this.start))};Ye.parseObj=function(e,t){var n=this.startNode(),i=!0,r={};for(n.properties=[],this.next();!this.eat(T.braceR);){if(i)i=!1;else if(this.expect(T.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(T.braceR))break;var s=this.parseProperty(e,t);e||this.checkPropClash(s,r,t),n.properties.push(s)}return this.finishNode(n,e?"ObjectPattern":"ObjectExpression")};Ye.parseProperty=function(e,t){var n=this.startNode(),i,r,s,o;if(this.options.ecmaVersion>=9&&this.eat(T.ellipsis))return e?(n.argument=this.parseIdent(!1),this.type===T.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(n,"RestElement")):(n.argument=this.parseMaybeAssign(!1,t),this.type===T.comma&&t&&t.trailingComma<0&&(t.trailingComma=this.start),this.finishNode(n,"SpreadElement"));this.options.ecmaVersion>=6&&(n.method=!1,n.shorthand=!1,(e||t)&&(s=this.start,o=this.startLoc),e||(i=this.eat(T.star)));var a=this.containsEsc;return this.parsePropertyName(n),!e&&!a&&this.options.ecmaVersion>=8&&!i&&this.isAsyncProp(n)?(r=!0,i=this.options.ecmaVersion>=9&&this.eat(T.star),this.parsePropertyName(n)):r=!1,this.parsePropertyValue(n,e,i,r,s,o,t,a),this.finishNode(n,"Property")};Ye.parseGetterSetter=function(e){e.kind=e.key.name,this.parsePropertyName(e),e.value=this.parseMethod(!1);var t=e.kind==="get"?0:1;if(e.value.params.length!==t){var n=e.value.start;e.kind==="get"?this.raiseRecoverable(n,"getter should have no params"):this.raiseRecoverable(n,"setter should have exactly one param")}else e.kind==="set"&&e.value.params[0].type==="RestElement"&&this.raiseRecoverable(e.value.params[0].start,"Setter cannot use rest params")};Ye.parsePropertyValue=function(e,t,n,i,r,s,o,a){(n||i)&&this.type===T.colon&&this.unexpected(),this.eat(T.colon)?(e.value=t?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,o),e.kind="init"):this.options.ecmaVersion>=6&&this.type===T.parenL?(t&&this.unexpected(),e.kind="init",e.method=!0,e.value=this.parseMethod(n,i)):!t&&!a&&this.options.ecmaVersion>=5&&!e.computed&&e.key.type==="Identifier"&&(e.key.name==="get"||e.key.name==="set")&&this.type!==T.comma&&this.type!==T.braceR&&this.type!==T.eq?((n||i)&&this.unexpected(),this.parseGetterSetter(e)):this.options.ecmaVersion>=6&&!e.computed&&e.key.type==="Identifier"?((n||i)&&this.unexpected(),this.checkUnreserved(e.key),e.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=r),e.kind="init",t?e.value=this.parseMaybeDefault(r,s,this.copyNode(e.key)):this.type===T.eq&&o?(o.shorthandAssign<0&&(o.shorthandAssign=this.start),e.value=this.parseMaybeDefault(r,s,this.copyNode(e.key))):e.value=this.copyNode(e.key),e.shorthand=!0):this.unexpected()};Ye.parsePropertyName=function(e){if(this.options.ecmaVersion>=6){if(this.eat(T.bracketL))return e.computed=!0,e.key=this.parseMaybeAssign(),this.expect(T.bracketR),e.key;e.computed=!1}return e.key=this.type===T.num||this.type===T.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")};Ye.initFunction=function(e){e.id=null,this.options.ecmaVersion>=6&&(e.generator=e.expression=!1),this.options.ecmaVersion>=8&&(e.async=!1)};Ye.parseMethod=function(e,t,n){var i=this.startNode(),r=this.yieldPos,s=this.awaitPos,o=this.awaitIdentPos;return this.initFunction(i),this.options.ecmaVersion>=6&&(i.generator=e),this.options.ecmaVersion>=8&&(i.async=!!t),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(ZN(t,i.generator)|XN|(n?yie:0)),this.expect(T.parenL),i.params=this.parseBindingList(T.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(i,!1,!0,!1),this.yieldPos=r,this.awaitPos=s,this.awaitIdentPos=o,this.finishNode(i,"FunctionExpression")};Ye.parseArrowExpression=function(e,t,n,i){var r=this.yieldPos,s=this.awaitPos,o=this.awaitIdentPos;return this.enterScope(ZN(n,!1)|vie),this.initFunction(e),this.options.ecmaVersion>=8&&(e.async=!!n),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,e.params=this.toAssignableList(t,!0),this.parseFunctionBody(e,!0,!1,i),this.yieldPos=r,this.awaitPos=s,this.awaitIdentPos=o,this.finishNode(e,"ArrowFunctionExpression")};Ye.parseFunctionBody=function(e,t,n,i){var r=t&&this.type!==T.braceL,s=this.strict,o=!1;if(r)e.body=this.parseMaybeAssign(i),e.expression=!0,this.checkParams(e,!1);else{var a=this.options.ecmaVersion>=7&&!this.isSimpleParamList(e.params);(!s||a)&&(o=this.strictDirective(this.end),o&&a&&this.raiseRecoverable(e.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var l=this.labels;this.labels=[],o&&(this.strict=!0),this.checkParams(e,!s&&!o&&!t&&!n&&this.isSimpleParamList(e.params)),this.strict&&e.id&&this.checkLValSimple(e.id,Sie),e.body=this.parseBlock(!1,void 0,o&&!s),e.expression=!1,this.adaptDirectivePrologue(e.body.body),this.labels=l}this.exitScope()};Ye.isSimpleParamList=function(e){for(var t=0,n=e;t<n.length;t+=1){var i=n[t];if(i.type!=="Identifier")return!1}return!0};Ye.checkParams=function(e,t){for(var n=Object.create(null),i=0,r=e.params;i<r.length;i+=1){var s=r[i];this.checkLValInnerPattern(s,JN,t?null:n)}};Ye.parseExprList=function(e,t,n,i){for(var r=[],s=!0;!this.eat(e);){if(s)s=!1;else if(this.expect(T.comma),t&&this.afterTrailingComma(e))break;var o=void 0;n&&this.type===T.comma?o=null:this.type===T.ellipsis?(o=this.parseSpread(i),i&&this.type===T.comma&&i.trailingComma<0&&(i.trailingComma=this.start)):o=this.parseMaybeAssign(!1,i),r.push(o)}return r};Ye.checkUnreserved=function(e){var t=e.start,n=e.end,i=e.name;if(this.inGenerator&&i==="yield"&&this.raiseRecoverable(t,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&i==="await"&&this.raiseRecoverable(t,"Cannot use 'await' as identifier inside an async function"),this.currentThisScope().inClassFieldInit&&i==="arguments"&&this.raiseRecoverable(t,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(i==="arguments"||i==="await")&&this.raise(t,"Cannot use "+i+" in class static initialization block"),this.keywords.test(i)&&this.raise(t,"Unexpected keyword '"+i+"'"),!(this.options.ecmaVersion<6&&this.input.slice(t,n).indexOf("\\")!==-1)){var r=this.strict?this.reservedWordsStrict:this.reservedWords;r.test(i)&&(!this.inAsync&&i==="await"&&this.raiseRecoverable(t,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(t,"The keyword '"+i+"' is reserved"))}};Ye.parseIdent=function(e){var t=this.parseIdentNode();return this.next(!!e),this.finishNode(t,"Identifier"),e||(this.checkUnreserved(t),t.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=t.start)),t};Ye.parseIdentNode=function(){var e=this.startNode();return this.type===T.name?e.name=this.value:this.type.keyword?(e.name=this.type.keyword,(e.name==="class"||e.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=T.name):this.unexpected(),e};Ye.parsePrivateIdent=function(){var e=this.startNode();return this.type===T.privateId?e.name=this.value:this.unexpected(),this.next(),this.finishNode(e,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(e.start,"Private field '#"+e.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(e)),e};Ye.parseYield=function(e){this.yieldPos||(this.yieldPos=this.start);var t=this.startNode();return this.next(),this.type===T.semi||this.canInsertSemicolon()||this.type!==T.star&&!this.type.startsExpr?(t.delegate=!1,t.argument=null):(t.delegate=this.eat(T.star),t.argument=this.parseMaybeAssign(e)),this.finishNode(t,"YieldExpression")};Ye.parseAwait=function(e){this.awaitPos||(this.awaitPos=this.start);var t=this.startNode();return this.next(),t.argument=this.parseMaybeUnary(null,!0,!1,e),this.finishNode(t,"AwaitExpression")};var M1=Yn.prototype;M1.raise=function(e,t){var n=gie(this.input,e);t+=" ("+n.line+":"+n.column+")";var i=new SyntaxError(t);throw i.pos=e,i.loc=n,i.raisedAt=this.pos,i};M1.raiseRecoverable=M1.raise;M1.curPosition=function(){if(this.options.locations)return new T0(this.curLine,this.pos-this.lineStart)};var Nc=Yn.prototype,Bnt=function(t){this.flags=t,this.var=[],this.lexical=[],this.functions=[],this.inClassFieldInit=!1};Nc.enterScope=function(e){this.scopeStack.push(new Bnt(e))};Nc.exitScope=function(){this.scopeStack.pop()};Nc.treatFunctionsAsVarInScope=function(e){return e.flags&Mg||!this.inModule&&e.flags&I0};Nc.declareName=function(e,t,n){var i=!1;if(t===uu){var r=this.currentScope();i=r.lexical.indexOf(e)>-1||r.functions.indexOf(e)>-1||r.var.indexOf(e)>-1,r.lexical.push(e),this.inModule&&r.flags&I0&&delete this.undefinedExports[e]}else if(t===bie){var s=this.currentScope();s.lexical.push(e)}else if(t===wie){var o=this.currentScope();this.treatFunctionsAsVar?i=o.lexical.indexOf(e)>-1:i=o.lexical.indexOf(e)>-1||o.var.indexOf(e)>-1,o.functions.push(e)}else for(var a=this.scopeStack.length-1;a>=0;--a){var l=this.scopeStack[a];if(l.lexical.indexOf(e)>-1&&!(l.flags&Cie&&l.lexical[0]===e)||!this.treatFunctionsAsVarInScope(l)&&l.functions.indexOf(e)>-1){i=!0;break}if(l.var.push(e),this.inModule&&l.flags&I0&&delete this.undefinedExports[e],l.flags&QN)break}i&&this.raiseRecoverable(n,"Identifier '"+e+"' has already been declared")};Nc.checkLocalExport=function(e){this.scopeStack[0].lexical.indexOf(e.name)===-1&&this.scopeStack[0].var.indexOf(e.name)===-1&&(this.undefinedExports[e.name]=e)};Nc.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]};Nc.currentVarScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(t.flags&QN)return t}};Nc.currentThisScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(t.flags&QN&&!(t.flags&vie))return t}};var sE=function(t,n,i){this.type="",this.start=n,this.end=0,t.options.locations&&(this.loc=new iE(t,i)),t.options.directSourceFile&&(this.sourceFile=t.options.directSourceFile),t.options.ranges&&(this.range=[n,0])},zC=Yn.prototype;zC.startNode=function(){return new sE(this,this.start,this.startLoc)};zC.startNodeAt=function(e,t){return new sE(this,e,t)};function Eie(e,t,n,i){return e.type=t,e.end=n,this.options.locations&&(e.loc.end=i),this.options.ranges&&(e.range[1]=n),e}zC.finishNode=function(e,t){return Eie.call(this,e,t,this.lastTokEnd,this.lastTokEndLoc)};zC.finishNodeAt=function(e,t,n,i){return Eie.call(this,e,t,n,i)};zC.copyNode=function(e){var t=new sE(this,e.start,this.startLoc);for(var n in e)t[n]=e[n];return t};var Gnt="Gara Garay Gukh Gurung_Khema Hrkt Katakana_Or_Hiragana Kawi Kirat_Rai Krai Nag_Mundari Nagm Ol_Onal Onao Sunu Sunuwar Todhri Todr Tulu_Tigalari Tutg Unknown Zzzz",Fie="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",Aie=Fie+" Extended_Pictographic",Die=Aie,kie=Die+" EBase EComp EMod EPres ExtPict",Pie=kie,znt=Pie,Hnt={9:Fie,10:Aie,11:Die,12:kie,13:Pie,14:znt},Vnt="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",Wnt={9:"",10:"",11:"",12:"",13:"",14:Vnt},C4="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",Mie="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",Tie=Mie+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",Iie=Tie+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",_ie=Iie+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",Oie=_ie+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",Unt=Oie+" "+Gnt,qnt={9:Mie,10:Tie,11:Iie,12:_ie,13:Oie,14:Unt},Lie={};function jnt(e){var t=Lie[e]={binary:Vu(Hnt[e]+" "+C4),binaryOfStrings:Vu(Wnt[e]),nonBinary:{General_Category:Vu(C4),Script:Vu(qnt[e])}};t.nonBinary.Script_Extensions=t.nonBinary.Script,t.nonBinary.gc=t.nonBinary.General_Category,t.nonBinary.sc=t.nonBinary.Script,t.nonBinary.scx=t.nonBinary.Script_Extensions}for(var gk=0,y4=[9,10,11,12,13,14];gk<y4.length;gk+=1){var Knt=y4[gk];jnt(Knt)}var Pe=Yn.prototype,T1=function(t,n){this.parent=t,this.base=n||this};T1.prototype.separatedFrom=function(t){for(var n=this;n;n=n.parent)for(var i=t;i;i=i.parent)if(n.base===i.base&&n!==i)return!0;return!1};T1.prototype.sibling=function(){return new T1(this.parent,this.base)};var Ya=function(t){this.parser=t,this.validFlags="gim"+(t.options.ecmaVersion>=6?"uy":"")+(t.options.ecmaVersion>=9?"s":"")+(t.options.ecmaVersion>=13?"d":"")+(t.options.ecmaVersion>=15?"v":""),this.unicodeProperties=Lie[t.options.ecmaVersion>=14?14:t.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=Object.create(null),this.backReferenceNames=[],this.branchID=null};Ya.prototype.reset=function(t,n,i){var r=i.indexOf("v")!==-1,s=i.indexOf("u")!==-1;this.start=t|0,this.source=n+"",this.flags=i,r&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=s&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=s&&this.parser.options.ecmaVersion>=9)};Ya.prototype.raise=function(t){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+t)};Ya.prototype.at=function(t,n){n===void 0&&(n=!1);var i=this.source,r=i.length;if(t>=r)return-1;var s=i.charCodeAt(t);if(!(n||this.switchU)||s<=55295||s>=57344||t+1>=r)return s;var o=i.charCodeAt(t+1);return o>=56320&&o<=57343?(s<<10)+o-56613888:s};Ya.prototype.nextIndex=function(t,n){n===void 0&&(n=!1);var i=this.source,r=i.length;if(t>=r)return r;var s=i.charCodeAt(t),o;return!(n||this.switchU)||s<=55295||s>=57344||t+1>=r||(o=i.charCodeAt(t+1))<56320||o>57343?t+1:t+2};Ya.prototype.current=function(t){return t===void 0&&(t=!1),this.at(this.pos,t)};Ya.prototype.lookahead=function(t){return t===void 0&&(t=!1),this.at(this.nextIndex(this.pos,t),t)};Ya.prototype.advance=function(t){t===void 0&&(t=!1),this.pos=this.nextIndex(this.pos,t)};Ya.prototype.eat=function(t,n){return n===void 0&&(n=!1),this.current(n)===t?(this.advance(n),!0):!1};Ya.prototype.eatChars=function(t,n){n===void 0&&(n=!1);for(var i=this.pos,r=0,s=t;r<s.length;r+=1){var o=s[r],a=this.at(i,n);if(a===-1||a!==o)return!1;i=this.nextIndex(i,n)}return this.pos=i,!0};Pe.validateRegExpFlags=function(e){for(var t=e.validFlags,n=e.flags,i=!1,r=!1,s=0;s<n.length;s++){var o=n.charAt(s);t.indexOf(o)===-1&&this.raise(e.start,"Invalid regular expression flag"),n.indexOf(o,s+1)>-1&&this.raise(e.start,"Duplicate regular expression flag"),o==="u"&&(i=!0),o==="v"&&(r=!0)}this.options.ecmaVersion>=15&&i&&r&&this.raise(e.start,"Invalid regular expression flag")};function Ynt(e){for(var t in e)return!0;return!1}Pe.validateRegExpPattern=function(e){this.regexp_pattern(e),!e.switchN&&this.options.ecmaVersion>=9&&Ynt(e.groupNames)&&(e.switchN=!0,this.regexp_pattern(e))};Pe.regexp_pattern=function(e){e.pos=0,e.lastIntValue=0,e.lastStringValue="",e.lastAssertionIsQuantifiable=!1,e.numCapturingParens=0,e.maxBackReference=0,e.groupNames=Object.create(null),e.backReferenceNames.length=0,e.branchID=null,this.regexp_disjunction(e),e.pos!==e.source.length&&(e.eat(41)&&e.raise("Unmatched ')'"),(e.eat(93)||e.eat(125))&&e.raise("Lone quantifier brackets")),e.maxBackReference>e.numCapturingParens&&e.raise("Invalid escape");for(var t=0,n=e.backReferenceNames;t<n.length;t+=1){var i=n[t];e.groupNames[i]||e.raise("Invalid named capture referenced")}};Pe.regexp_disjunction=function(e){var t=this.options.ecmaVersion>=16;for(t&&(e.branchID=new T1(e.branchID,null)),this.regexp_alternative(e);e.eat(124);)t&&(e.branchID=e.branchID.sibling()),this.regexp_alternative(e);t&&(e.branchID=e.branchID.parent),this.regexp_eatQuantifier(e,!0)&&e.raise("Nothing to repeat"),e.eat(123)&&e.raise("Lone quantifier brackets")};Pe.regexp_alternative=function(e){for(;e.pos<e.source.length&&this.regexp_eatTerm(e););};Pe.regexp_eatTerm=function(e){return this.regexp_eatAssertion(e)?(e.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(e)&&e.switchU&&e.raise("Invalid quantifier"),!0):(e.switchU?this.regexp_eatAtom(e):this.regexp_eatExtendedAtom(e))?(this.regexp_eatQuantifier(e),!0):!1};Pe.regexp_eatAssertion=function(e){var t=e.pos;if(e.lastAssertionIsQuantifiable=!1,e.eat(94)||e.eat(36))return!0;if(e.eat(92)){if(e.eat(66)||e.eat(98))return!0;e.pos=t}if(e.eat(40)&&e.eat(63)){var n=!1;if(this.options.ecmaVersion>=9&&(n=e.eat(60)),e.eat(61)||e.eat(33))return this.regexp_disjunction(e),e.eat(41)||e.raise("Unterminated group"),e.lastAssertionIsQuantifiable=!n,!0}return e.pos=t,!1};Pe.regexp_eatQuantifier=function(e,t){return t===void 0&&(t=!1),this.regexp_eatQuantifierPrefix(e,t)?(e.eat(63),!0):!1};Pe.regexp_eatQuantifierPrefix=function(e,t){return e.eat(42)||e.eat(43)||e.eat(63)||this.regexp_eatBracedQuantifier(e,t)};Pe.regexp_eatBracedQuantifier=function(e,t){var n=e.pos;if(e.eat(123)){var i=0,r=-1;if(this.regexp_eatDecimalDigits(e)&&(i=e.lastIntValue,e.eat(44)&&this.regexp_eatDecimalDigits(e)&&(r=e.lastIntValue),e.eat(125)))return r!==-1&&r<i&&!t&&e.raise("numbers out of order in {} quantifier"),!0;e.switchU&&!t&&e.raise("Incomplete quantifier"),e.pos=n}return!1};Pe.regexp_eatAtom=function(e){return this.regexp_eatPatternCharacters(e)||e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)};Pe.regexp_eatReverseSolidusAtomEscape=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatAtomEscape(e))return!0;e.pos=t}return!1};Pe.regexp_eatUncapturingGroup=function(e){var t=e.pos;if(e.eat(40)){if(e.eat(63)){if(this.options.ecmaVersion>=16){var n=this.regexp_eatModifiers(e),i=e.eat(45);if(n||i){for(var r=0;r<n.length;r++){var s=n.charAt(r);n.indexOf(s,r+1)>-1&&e.raise("Duplicate regular expression modifiers")}if(i){var o=this.regexp_eatModifiers(e);!n&&!o&&e.current()===58&&e.raise("Invalid regular expression modifiers");for(var a=0;a<o.length;a++){var l=o.charAt(a);(o.indexOf(l,a+1)>-1||n.indexOf(l)>-1)&&e.raise("Duplicate regular expression modifiers")}}}}if(e.eat(58)){if(this.regexp_disjunction(e),e.eat(41))return!0;e.raise("Unterminated group")}}e.pos=t}return!1};Pe.regexp_eatCapturingGroup=function(e){if(e.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(e):e.current()===63&&e.raise("Invalid group"),this.regexp_disjunction(e),e.eat(41))return e.numCapturingParens+=1,!0;e.raise("Unterminated group")}return!1};Pe.regexp_eatModifiers=function(e){for(var t="",n=0;(n=e.current())!==-1&&Xnt(n);)t+=Yl(n),e.advance();return t};function Xnt(e){return e===105||e===109||e===115}Pe.regexp_eatExtendedAtom=function(e){return e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)||this.regexp_eatInvalidBracedQuantifier(e)||this.regexp_eatExtendedPatternCharacter(e)};Pe.regexp_eatInvalidBracedQuantifier=function(e){return this.regexp_eatBracedQuantifier(e,!0)&&e.raise("Nothing to repeat"),!1};Pe.regexp_eatSyntaxCharacter=function(e){var t=e.current();return Nie(t)?(e.lastIntValue=t,e.advance(),!0):!1};function Nie(e){return e===36||e>=40&&e<=43||e===46||e===63||e>=91&&e<=94||e>=123&&e<=125}Pe.regexp_eatPatternCharacters=function(e){for(var t=e.pos,n=0;(n=e.current())!==-1&&!Nie(n);)e.advance();return e.pos!==t};Pe.regexp_eatExtendedPatternCharacter=function(e){var t=e.current();return t!==-1&&t!==36&&!(t>=40&&t<=43)&&t!==46&&t!==63&&t!==91&&t!==94&&t!==124?(e.advance(),!0):!1};Pe.regexp_groupSpecifier=function(e){if(e.eat(63)){this.regexp_eatGroupName(e)||e.raise("Invalid group");var t=this.options.ecmaVersion>=16,n=e.groupNames[e.lastStringValue];if(n)if(t)for(var i=0,r=n;i<r.length;i+=1){var s=r[i];s.separatedFrom(e.branchID)||e.raise("Duplicate capture group name")}else e.raise("Duplicate capture group name");t?(n||(e.groupNames[e.lastStringValue]=[])).push(e.branchID):e.groupNames[e.lastStringValue]=!0}};Pe.regexp_eatGroupName=function(e){if(e.lastStringValue="",e.eat(60)){if(this.regexp_eatRegExpIdentifierName(e)&&e.eat(62))return!0;e.raise("Invalid capture group name")}return!1};Pe.regexp_eatRegExpIdentifierName=function(e){if(e.lastStringValue="",this.regexp_eatRegExpIdentifierStart(e)){for(e.lastStringValue+=Yl(e.lastIntValue);this.regexp_eatRegExpIdentifierPart(e);)e.lastStringValue+=Yl(e.lastIntValue);return!0}return!1};Pe.regexp_eatRegExpIdentifierStart=function(e){var t=e.pos,n=this.options.ecmaVersion>=11,i=e.current(n);return e.advance(n),i===92&&this.regexp_eatRegExpUnicodeEscapeSequence(e,n)&&(i=e.lastIntValue),Qnt(i)?(e.lastIntValue=i,!0):(e.pos=t,!1)};function Qnt(e){return Kl(e,!0)||e===36||e===95}Pe.regexp_eatRegExpIdentifierPart=function(e){var t=e.pos,n=this.options.ecmaVersion>=11,i=e.current(n);return e.advance(n),i===92&&this.regexp_eatRegExpUnicodeEscapeSequence(e,n)&&(i=e.lastIntValue),Znt(i)?(e.lastIntValue=i,!0):(e.pos=t,!1)};function Znt(e){return qp(e,!0)||e===36||e===95||e===8204||e===8205}Pe.regexp_eatAtomEscape=function(e){return this.regexp_eatBackReference(e)||this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)||e.switchN&&this.regexp_eatKGroupName(e)?!0:(e.switchU&&(e.current()===99&&e.raise("Invalid unicode escape"),e.raise("Invalid escape")),!1)};Pe.regexp_eatBackReference=function(e){var t=e.pos;if(this.regexp_eatDecimalEscape(e)){var n=e.lastIntValue;if(e.switchU)return n>e.maxBackReference&&(e.maxBackReference=n),!0;if(n<=e.numCapturingParens)return!0;e.pos=t}return!1};Pe.regexp_eatKGroupName=function(e){if(e.eat(107)){if(this.regexp_eatGroupName(e))return e.backReferenceNames.push(e.lastStringValue),!0;e.raise("Invalid named reference")}return!1};Pe.regexp_eatCharacterEscape=function(e){return this.regexp_eatControlEscape(e)||this.regexp_eatCControlLetter(e)||this.regexp_eatZero(e)||this.regexp_eatHexEscapeSequence(e)||this.regexp_eatRegExpUnicodeEscapeSequence(e,!1)||!e.switchU&&this.regexp_eatLegacyOctalEscapeSequence(e)||this.regexp_eatIdentityEscape(e)};Pe.regexp_eatCControlLetter=function(e){var t=e.pos;if(e.eat(99)){if(this.regexp_eatControlLetter(e))return!0;e.pos=t}return!1};Pe.regexp_eatZero=function(e){return e.current()===48&&!oE(e.lookahead())?(e.lastIntValue=0,e.advance(),!0):!1};Pe.regexp_eatControlEscape=function(e){var t=e.current();return t===116?(e.lastIntValue=9,e.advance(),!0):t===110?(e.lastIntValue=10,e.advance(),!0):t===118?(e.lastIntValue=11,e.advance(),!0):t===102?(e.lastIntValue=12,e.advance(),!0):t===114?(e.lastIntValue=13,e.advance(),!0):!1};Pe.regexp_eatControlLetter=function(e){var t=e.current();return $ie(t)?(e.lastIntValue=t%32,e.advance(),!0):!1};function $ie(e){return e>=65&&e<=90||e>=97&&e<=122}Pe.regexp_eatRegExpUnicodeEscapeSequence=function(e,t){t===void 0&&(t=!1);var n=e.pos,i=t||e.switchU;if(e.eat(117)){if(this.regexp_eatFixedHexDigits(e,4)){var r=e.lastIntValue;if(i&&r>=55296&&r<=56319){var s=e.pos;if(e.eat(92)&&e.eat(117)&&this.regexp_eatFixedHexDigits(e,4)){var o=e.lastIntValue;if(o>=56320&&o<=57343)return e.lastIntValue=(r-55296)*1024+(o-56320)+65536,!0}e.pos=s,e.lastIntValue=r}return!0}if(i&&e.eat(123)&&this.regexp_eatHexDigits(e)&&e.eat(125)&&Jnt(e.lastIntValue))return!0;i&&e.raise("Invalid unicode escape"),e.pos=n}return!1};function Jnt(e){return e>=0&&e<=1114111}Pe.regexp_eatIdentityEscape=function(e){if(e.switchU)return this.regexp_eatSyntaxCharacter(e)?!0:e.eat(47)?(e.lastIntValue=47,!0):!1;var t=e.current();return t!==99&&(!e.switchN||t!==107)?(e.lastIntValue=t,e.advance(),!0):!1};Pe.regexp_eatDecimalEscape=function(e){e.lastIntValue=0;var t=e.current();if(t>=49&&t<=57){do e.lastIntValue=10*e.lastIntValue+(t-48),e.advance();while((t=e.current())>=48&&t<=57);return!0}return!1};var Bie=0,Xl=1,ks=2;Pe.regexp_eatCharacterClassEscape=function(e){var t=e.current();if(eit(t))return e.lastIntValue=-1,e.advance(),Xl;var n=!1;if(e.switchU&&this.options.ecmaVersion>=9&&((n=t===80)||t===112)){e.lastIntValue=-1,e.advance();var i;if(e.eat(123)&&(i=this.regexp_eatUnicodePropertyValueExpression(e))&&e.eat(125))return n&&i===ks&&e.raise("Invalid property name"),i;e.raise("Invalid property name")}return Bie};function eit(e){return e===100||e===68||e===115||e===83||e===119||e===87}Pe.regexp_eatUnicodePropertyValueExpression=function(e){var t=e.pos;if(this.regexp_eatUnicodePropertyName(e)&&e.eat(61)){var n=e.lastStringValue;if(this.regexp_eatUnicodePropertyValue(e)){var i=e.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(e,n,i),Xl}}if(e.pos=t,this.regexp_eatLoneUnicodePropertyNameOrValue(e)){var r=e.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(e,r)}return Bie};Pe.regexp_validateUnicodePropertyNameAndValue=function(e,t,n){Pg(e.unicodeProperties.nonBinary,t)||e.raise("Invalid property name"),e.unicodeProperties.nonBinary[t].test(n)||e.raise("Invalid property value")};Pe.regexp_validateUnicodePropertyNameOrValue=function(e,t){if(e.unicodeProperties.binary.test(t))return Xl;if(e.switchV&&e.unicodeProperties.binaryOfStrings.test(t))return ks;e.raise("Invalid property name")};Pe.regexp_eatUnicodePropertyName=function(e){var t=0;for(e.lastStringValue="";Gie(t=e.current());)e.lastStringValue+=Yl(t),e.advance();return e.lastStringValue!==""};function Gie(e){return $ie(e)||e===95}Pe.regexp_eatUnicodePropertyValue=function(e){var t=0;for(e.lastStringValue="";tit(t=e.current());)e.lastStringValue+=Yl(t),e.advance();return e.lastStringValue!==""};function tit(e){return Gie(e)||oE(e)}Pe.regexp_eatLoneUnicodePropertyNameOrValue=function(e){return this.regexp_eatUnicodePropertyValue(e)};Pe.regexp_eatCharacterClass=function(e){if(e.eat(91)){var t=e.eat(94),n=this.regexp_classContents(e);return e.eat(93)||e.raise("Unterminated character class"),t&&n===ks&&e.raise("Negated character class may contain strings"),!0}return!1};Pe.regexp_classContents=function(e){return e.current()===93?Xl:e.switchV?this.regexp_classSetExpression(e):(this.regexp_nonEmptyClassRanges(e),Xl)};Pe.regexp_nonEmptyClassRanges=function(e){for(;this.regexp_eatClassAtom(e);){var t=e.lastIntValue;if(e.eat(45)&&this.regexp_eatClassAtom(e)){var n=e.lastIntValue;e.switchU&&(t===-1||n===-1)&&e.raise("Invalid character class"),t!==-1&&n!==-1&&t>n&&e.raise("Range out of order in character class")}}};Pe.regexp_eatClassAtom=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatClassEscape(e))return!0;if(e.switchU){var n=e.current();(n===99||Vie(n))&&e.raise("Invalid class escape"),e.raise("Invalid escape")}e.pos=t}var i=e.current();return i!==93?(e.lastIntValue=i,e.advance(),!0):!1};Pe.regexp_eatClassEscape=function(e){var t=e.pos;if(e.eat(98))return e.lastIntValue=8,!0;if(e.switchU&&e.eat(45))return e.lastIntValue=45,!0;if(!e.switchU&&e.eat(99)){if(this.regexp_eatClassControlLetter(e))return!0;e.pos=t}return this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)};Pe.regexp_classSetExpression=function(e){var t=Xl,n;if(!this.regexp_eatClassSetRange(e))if(n=this.regexp_eatClassSetOperand(e)){n===ks&&(t=ks);for(var i=e.pos;e.eatChars([38,38]);){if(e.current()!==38&&(n=this.regexp_eatClassSetOperand(e))){n!==ks&&(t=Xl);continue}e.raise("Invalid character in character class")}if(i!==e.pos)return t;for(;e.eatChars([45,45]);)this.regexp_eatClassSetOperand(e)||e.raise("Invalid character in character class");if(i!==e.pos)return t}else e.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(e)){if(n=this.regexp_eatClassSetOperand(e),!n)return t;n===ks&&(t=ks)}};Pe.regexp_eatClassSetRange=function(e){var t=e.pos;if(this.regexp_eatClassSetCharacter(e)){var n=e.lastIntValue;if(e.eat(45)&&this.regexp_eatClassSetCharacter(e)){var i=e.lastIntValue;return n!==-1&&i!==-1&&n>i&&e.raise("Range out of order in character class"),!0}e.pos=t}return!1};Pe.regexp_eatClassSetOperand=function(e){return this.regexp_eatClassSetCharacter(e)?Xl:this.regexp_eatClassStringDisjunction(e)||this.regexp_eatNestedClass(e)};Pe.regexp_eatNestedClass=function(e){var t=e.pos;if(e.eat(91)){var n=e.eat(94),i=this.regexp_classContents(e);if(e.eat(93))return n&&i===ks&&e.raise("Negated character class may contain strings"),i;e.pos=t}if(e.eat(92)){var r=this.regexp_eatCharacterClassEscape(e);if(r)return r;e.pos=t}return null};Pe.regexp_eatClassStringDisjunction=function(e){var t=e.pos;if(e.eatChars([92,113])){if(e.eat(123)){var n=this.regexp_classStringDisjunctionContents(e);if(e.eat(125))return n}else e.raise("Invalid escape");e.pos=t}return null};Pe.regexp_classStringDisjunctionContents=function(e){for(var t=this.regexp_classString(e);e.eat(124);)this.regexp_classString(e)===ks&&(t=ks);return t};Pe.regexp_classString=function(e){for(var t=0;this.regexp_eatClassSetCharacter(e);)t++;return t===1?Xl:ks};Pe.regexp_eatClassSetCharacter=function(e){var t=e.pos;if(e.eat(92))return this.regexp_eatCharacterEscape(e)||this.regexp_eatClassSetReservedPunctuator(e)?!0:e.eat(98)?(e.lastIntValue=8,!0):(e.pos=t,!1);var n=e.current();return n<0||n===e.lookahead()&&nit(n)||iit(n)?!1:(e.advance(),e.lastIntValue=n,!0)};function nit(e){return e===33||e>=35&&e<=38||e>=42&&e<=44||e===46||e>=58&&e<=64||e===94||e===96||e===126}function iit(e){return e===40||e===41||e===45||e===47||e>=91&&e<=93||e>=123&&e<=125}Pe.regexp_eatClassSetReservedPunctuator=function(e){var t=e.current();return rit(t)?(e.lastIntValue=t,e.advance(),!0):!1};function rit(e){return e===33||e===35||e===37||e===38||e===44||e===45||e>=58&&e<=62||e===64||e===96||e===126}Pe.regexp_eatClassControlLetter=function(e){var t=e.current();return oE(t)||t===95?(e.lastIntValue=t%32,e.advance(),!0):!1};Pe.regexp_eatHexEscapeSequence=function(e){var t=e.pos;if(e.eat(120)){if(this.regexp_eatFixedHexDigits(e,2))return!0;e.switchU&&e.raise("Invalid escape"),e.pos=t}return!1};Pe.regexp_eatDecimalDigits=function(e){var t=e.pos,n=0;for(e.lastIntValue=0;oE(n=e.current());)e.lastIntValue=10*e.lastIntValue+(n-48),e.advance();return e.pos!==t};function oE(e){return e>=48&&e<=57}Pe.regexp_eatHexDigits=function(e){var t=e.pos,n=0;for(e.lastIntValue=0;zie(n=e.current());)e.lastIntValue=16*e.lastIntValue+Hie(n),e.advance();return e.pos!==t};function zie(e){return e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102}function Hie(e){return e>=65&&e<=70?10+(e-65):e>=97&&e<=102?10+(e-97):e-48}Pe.regexp_eatLegacyOctalEscapeSequence=function(e){if(this.regexp_eatOctalDigit(e)){var t=e.lastIntValue;if(this.regexp_eatOctalDigit(e)){var n=e.lastIntValue;t<=3&&this.regexp_eatOctalDigit(e)?e.lastIntValue=t*64+n*8+e.lastIntValue:e.lastIntValue=t*8+n}else e.lastIntValue=t;return!0}return!1};Pe.regexp_eatOctalDigit=function(e){var t=e.current();return Vie(t)?(e.lastIntValue=t-48,e.advance(),!0):(e.lastIntValue=0,!1)};function Vie(e){return e>=48&&e<=55}Pe.regexp_eatFixedHexDigits=function(e,t){var n=e.pos;e.lastIntValue=0;for(var i=0;i<t;++i){var r=e.current();if(!zie(r))return e.pos=n,!1;e.lastIntValue=16*e.lastIntValue+Hie(r),e.advance()}return!0};var t$=function(t){this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new iE(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])},mt=Yn.prototype;mt.next=function(e){!e&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new t$(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()};mt.getToken=function(){return this.next(),new t$(this)};typeof Symbol<"u"&&(mt[Symbol.iterator]=function(){var e=this;return{next:function(){var t=e.getToken();return{done:t.type===T.eof,value:t}}}});mt.nextToken=function(){var e=this.curContext();if((!e||!e.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(T.eof);if(e.override)return e.override(this);this.readToken(this.fullCharCodeAtPos())};mt.readToken=function(e){return Kl(e,this.options.ecmaVersion>=6)||e===92?this.readWord():this.getTokenFromCode(e)};mt.fullCharCodeAtPos=function(){var e=this.input.charCodeAt(this.pos);if(e<=55295||e>=56320)return e;var t=this.input.charCodeAt(this.pos+1);return t<=56319||t>=57344?e:(e<<10)+t-56613888};mt.skipBlockComment=function(){var e=this.options.onComment&&this.curPosition(),t=this.pos,n=this.input.indexOf("*/",this.pos+=2);if(n===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=n+2,this.options.locations)for(var i=void 0,r=t;(i=hie(this.input,r,this.pos))>-1;)++this.curLine,r=this.lineStart=i;this.options.onComment&&this.options.onComment(!0,this.input.slice(t+2,n),t,this.pos,e,this.curPosition())};mt.skipLineComment=function(e){for(var t=this.pos,n=this.options.onComment&&this.curPosition(),i=this.input.charCodeAt(this.pos+=e);this.pos<this.input.length&&!kg(i);)i=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(t+e,this.pos),t,this.pos,n,this.curPosition())};mt.skipSpace=function(){e:for(;this.pos<this.input.length;){var e=this.input.charCodeAt(this.pos);switch(e){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(e>8&&e<14||e>=5760&&fie.test(String.fromCharCode(e)))++this.pos;else break e}}};mt.finishToken=function(e,t){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var n=this.type;this.type=e,this.value=t,this.updateContext(n)};mt.readToken_dot=function(){var e=this.input.charCodeAt(this.pos+1);if(e>=48&&e<=57)return this.readNumber(!0);var t=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&e===46&&t===46?(this.pos+=3,this.finishToken(T.ellipsis)):(++this.pos,this.finishToken(T.dot))};mt.readToken_slash=function(){var e=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):e===61?this.finishOp(T.assign,2):this.finishOp(T.slash,1)};mt.readToken_mult_modulo_exp=function(e){var t=this.input.charCodeAt(this.pos+1),n=1,i=e===42?T.star:T.modulo;return this.options.ecmaVersion>=7&&e===42&&t===42&&(++n,i=T.starstar,t=this.input.charCodeAt(this.pos+2)),t===61?this.finishOp(T.assign,n+1):this.finishOp(i,n)};mt.readToken_pipe_amp=function(e){var t=this.input.charCodeAt(this.pos+1);if(t===e){if(this.options.ecmaVersion>=12){var n=this.input.charCodeAt(this.pos+2);if(n===61)return this.finishOp(T.assign,3)}return this.finishOp(e===124?T.logicalOR:T.logicalAND,2)}return t===61?this.finishOp(T.assign,2):this.finishOp(e===124?T.bitwiseOR:T.bitwiseAND,1)};mt.readToken_caret=function(){var e=this.input.charCodeAt(this.pos+1);return e===61?this.finishOp(T.assign,2):this.finishOp(T.bitwiseXOR,1)};mt.readToken_plus_min=function(e){var t=this.input.charCodeAt(this.pos+1);return t===e?t===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||Zs.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(T.incDec,2):t===61?this.finishOp(T.assign,2):this.finishOp(T.plusMin,1)};mt.readToken_lt_gt=function(e){var t=this.input.charCodeAt(this.pos+1),n=1;return t===e?(n=e===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+n)===61?this.finishOp(T.assign,n+1):this.finishOp(T.bitShift,n)):t===33&&e===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(t===61&&(n=2),this.finishOp(T.relational,n))};mt.readToken_eq_excl=function(e){var t=this.input.charCodeAt(this.pos+1);return t===61?this.finishOp(T.equality,this.input.charCodeAt(this.pos+2)===61?3:2):e===61&&t===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(T.arrow)):this.finishOp(e===61?T.eq:T.prefix,1)};mt.readToken_question=function(){var e=this.options.ecmaVersion;if(e>=11){var t=this.input.charCodeAt(this.pos+1);if(t===46){var n=this.input.charCodeAt(this.pos+2);if(n<48||n>57)return this.finishOp(T.questionDot,2)}if(t===63){if(e>=12){var i=this.input.charCodeAt(this.pos+2);if(i===61)return this.finishOp(T.assign,3)}return this.finishOp(T.coalesce,2)}}return this.finishOp(T.question,1)};mt.readToken_numberSign=function(){var e=this.options.ecmaVersion,t=35;if(e>=13&&(++this.pos,t=this.fullCharCodeAtPos(),Kl(t,!0)||t===92))return this.finishToken(T.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+Yl(t)+"'")};mt.getTokenFromCode=function(e){switch(e){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(T.parenL);case 41:return++this.pos,this.finishToken(T.parenR);case 59:return++this.pos,this.finishToken(T.semi);case 44:return++this.pos,this.finishToken(T.comma);case 91:return++this.pos,this.finishToken(T.bracketL);case 93:return++this.pos,this.finishToken(T.bracketR);case 123:return++this.pos,this.finishToken(T.braceL);case 125:return++this.pos,this.finishToken(T.braceR);case 58:return++this.pos,this.finishToken(T.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(T.backQuote);case 48:var t=this.input.charCodeAt(this.pos+1);if(t===120||t===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(t===111||t===79)return this.readRadixNumber(8);if(t===98||t===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(e);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(e);case 124:case 38:return this.readToken_pipe_amp(e);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(e);case 60:case 62:return this.readToken_lt_gt(e);case 61:case 33:return this.readToken_eq_excl(e);case 63:return this.readToken_question();case 126:return this.finishOp(T.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+Yl(e)+"'")};mt.finishOp=function(e,t){var n=this.input.slice(this.pos,this.pos+t);return this.pos+=t,this.finishToken(e,n)};mt.readRegexp=function(){for(var e,t,n=this.pos;;){this.pos>=this.input.length&&this.raise(n,"Unterminated regular expression");var i=this.input.charAt(this.pos);if(Zs.test(i)&&this.raise(n,"Unterminated regular expression"),e)e=!1;else{if(i==="[")t=!0;else if(i==="]"&&t)t=!1;else if(i==="/"&&!t)break;e=i==="\\"}++this.pos}var r=this.input.slice(n,this.pos);++this.pos;var s=this.pos,o=this.readWord1();this.containsEsc&&this.unexpected(s);var a=this.regexpState||(this.regexpState=new Ya(this));a.reset(n,r,o),this.validateRegExpFlags(a),this.validateRegExpPattern(a);var l=null;try{l=new RegExp(r,o)}catch{}return this.finishToken(T.regexp,{pattern:r,flags:o,value:l})};mt.readInt=function(e,t,n){for(var i=this.options.ecmaVersion>=12&&t===void 0,r=n&&this.input.charCodeAt(this.pos)===48,s=this.pos,o=0,a=0,l=0,u=t??1/0;l<u;++l,++this.pos){var c=this.input.charCodeAt(this.pos),d=void 0;if(i&&c===95){r&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),a===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),l===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),a=c;continue}if(c>=97?d=c-97+10:c>=65?d=c-65+10:c>=48&&c<=57?d=c-48:d=1/0,d>=e)break;a=c,o=o*e+d}return i&&a===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===s||t!=null&&this.pos-s!==t?null:o};function sit(e,t){return t?parseInt(e,8):parseFloat(e.replace(/_/g,""))}function Wie(e){return typeof BigInt!="function"?null:BigInt(e.replace(/_/g,""))}mt.readRadixNumber=function(e){var t=this.pos;this.pos+=2;var n=this.readInt(e);return n==null&&this.raise(this.start+2,"Expected number in radix "+e),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(n=Wie(this.input.slice(t,this.pos)),++this.pos):Kl(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(T.num,n)};mt.readNumber=function(e){var t=this.pos;!e&&this.readInt(10,void 0,!0)===null&&this.raise(t,"Invalid number");var n=this.pos-t>=2&&this.input.charCodeAt(t)===48;n&&this.strict&&this.raise(t,"Invalid number");var i=this.input.charCodeAt(this.pos);if(!n&&!e&&this.options.ecmaVersion>=11&&i===110){var r=Wie(this.input.slice(t,this.pos));return++this.pos,Kl(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(T.num,r)}n&&/[89]/.test(this.input.slice(t,this.pos))&&(n=!1),i===46&&!n&&(++this.pos,this.readInt(10),i=this.input.charCodeAt(this.pos)),(i===69||i===101)&&!n&&(i=this.input.charCodeAt(++this.pos),(i===43||i===45)&&++this.pos,this.readInt(10)===null&&this.raise(t,"Invalid number")),Kl(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var s=sit(this.input.slice(t,this.pos),n);return this.finishToken(T.num,s)};mt.readCodePoint=function(){var e=this.input.charCodeAt(this.pos),t;if(e===123){this.options.ecmaVersion<6&&this.unexpected();var n=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,t>1114111&&this.invalidStringToken(n,"Code point out of bounds")}else t=this.readHexChar(4);return t};mt.readString=function(e){for(var t="",n=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var i=this.input.charCodeAt(this.pos);if(i===e)break;i===92?(t+=this.input.slice(n,this.pos),t+=this.readEscapedChar(!1),n=this.pos):i===8232||i===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(kg(i)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return t+=this.input.slice(n,this.pos++),this.finishToken(T.string,t)};var Uie={};mt.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(e){if(e===Uie)this.readInvalidTemplateToken();else throw e}this.inTemplateElement=!1};mt.invalidStringToken=function(e,t){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw Uie;this.raise(e,t)};mt.readTmplToken=function(){for(var e="",t=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var n=this.input.charCodeAt(this.pos);if(n===96||n===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===T.template||this.type===T.invalidTemplate)?n===36?(this.pos+=2,this.finishToken(T.dollarBraceL)):(++this.pos,this.finishToken(T.backQuote)):(e+=this.input.slice(t,this.pos),this.finishToken(T.template,e));if(n===92)e+=this.input.slice(t,this.pos),e+=this.readEscapedChar(!0),t=this.pos;else if(kg(n)){switch(e+=this.input.slice(t,this.pos),++this.pos,n){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:e+=`
`;break;default:e+=String.fromCharCode(n);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),t=this.pos}else++this.pos}};mt.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(T.invalidTemplate,this.input.slice(this.start,this.pos));case"\r":this.input[this.pos+1]===`
`&&++this.pos;case`
`:case"\u2028":case"\u2029":++this.curLine,this.lineStart=this.pos+1;break}this.raise(this.start,"Unterminated template")};mt.readEscapedChar=function(e){var t=this.input.charCodeAt(++this.pos);switch(++this.pos,t){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return Yl(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),e){var n=this.pos-1;this.invalidStringToken(n,"Invalid escape sequence in template string")}default:if(t>=48&&t<=55){var i=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],r=parseInt(i,8);return r>255&&(i=i.slice(0,-1),r=parseInt(i,8)),this.pos+=i.length-1,t=this.input.charCodeAt(this.pos),(i!=="0"||t===56||t===57)&&(this.strict||e)&&this.invalidStringToken(this.pos-1-i.length,e?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(r)}return kg(t)?(this.options.locations&&(this.lineStart=this.pos,++this.curLine),""):String.fromCharCode(t)}};mt.readHexChar=function(e){var t=this.pos,n=this.readInt(16,e);return n===null&&this.invalidStringToken(t,"Bad character escape sequence"),n};mt.readWord1=function(){this.containsEsc=!1;for(var e="",t=!0,n=this.pos,i=this.options.ecmaVersion>=6;this.pos<this.input.length;){var r=this.fullCharCodeAtPos();if(qp(r,i))this.pos+=r<=65535?1:2;else if(r===92){this.containsEsc=!0,e+=this.input.slice(n,this.pos);var s=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var o=this.readCodePoint();(t?Kl:qp)(o,i)||this.invalidStringToken(s,"Invalid Unicode escape"),e+=Yl(o),n=this.pos}else break;t=!1}return e+this.input.slice(n,this.pos)};mt.readWord=function(){var e=this.readWord1(),t=T.name;return this.keywords.test(e)&&(t=KN[e]),this.finishToken(t,e)};var oit="8.14.0";Yn.acorn={Parser:Yn,version:oit,defaultOptions:ST,Position:T0,SourceLocation:iE,getLineInfo:gie,Node:sE,TokenType:Rt,tokTypes:T,keywordTypes:KN,TokContext:lo,tokContexts:on,isIdentifierChar:qp,isIdentifierStart:Kl,Token:t$,isNewLine:kg,lineBreak:Zs,lineBreakG:Dnt,nonASCIIwhitespace:fie};function ait(e,t){return Yn.parse(e,t)}const n$={undefined:"void(0)",Infinity:"Number.POSITIVE_INFINITY",NaN:"Number.NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2"};function $c(e){return typeof e=="number"}const lit={ecmaVersion:11},w4="$",uit="d",cit="d1",dit="d2",di=e=>(t,n)=>n.error(t,e+" not allowed"),hit=di("Aggregate function"),fit=di("Window function"),pit="Invalid argument",i$="Invalid column reference",git=i$+" (must be input to an aggregate function)",qie="Invalid function call",mit="Invalid member expression",vit="Invalid operator parameter",Cit="Invalid param reference",yit="Invalid variable reference",wit="Variable not accessible in operator call",bit="Unsupported variable declaration",Sit="Unsupported destructuring pattern",jie="Table expressions do not support closures",Kie="Use aq.escape(fn) to use a function as-is (including closures)",xit="use table.params({ name: value }) to define dynamic parameters",Rit="use aq.addFunction(name, fn) to add new op functions",Eit=`
Note: ${jie}. ${Kie}, or ${xit}.`,Yie=`
Note: ${jie}. ${Kie}, or ${Rit}.`,Fit=`The ${oie} method is not valid in multi-table expressions.`;function Ait(e,t){const n=Dit(t);let i=e.root=n;return e.spec=t,e.tuple=null,e.tuple1=null,e.tuple2=null,e.$param=null,e.$op=0,e.scope=new Set,e.paramsRef=new Map,e.columnRef=new Map,pnt(i)?(Pit(i,e),i=i.body):e.join?(e.scope.add(e.tuple1=cit),e.scope.add(e.tuple2=dit),e.scope.add(e.$param=w4)):(e.scope.add(e.tuple=uit),e.scope.add(e.$param=w4)),bt(i,e,r$),e.root}function Dit(e){try{const t=e.field?kit(e):pr(e)?jl(e):e;return ait(`expr=(${t})`,lit).body[0].expression.right}catch{pn(`Expression parse error: ${e+""}`)}}function kit(e){const t=JSON.stringify(e+"");return e.table?`(a,b)=>b[${t}]`:`d=>d[${t}]`}const r$={FunctionDeclaration:di("Function definitions"),ForStatement:di("For loops"),ForOfStatement:di("For-of loops"),ForInStatement:di("For-in loops"),WhileStatement:di("While loops"),DoWhileStatement:di("Do-while loops"),AwaitExpression:di("Await expressions"),ArrowFunctionExpression:di("Function definitions"),AssignmentExpression:di("Assignments"),FunctionExpression:di("Function definitions"),NewExpression:di('Use of "new"'),UpdateExpression:di("Update expressions"),VariableDeclarator(e,t){AT(e.id,t)},Identifier(e,t,n){Zie(e,t,n)&&!t.scope.has(e.name)&&t.error(e,yit,Eit)},CallExpression(e,t){const n=Xie(e.callee),i=jne(n)||Kne(n);if(i){if((t.join||t.aggregate===!1)&&zN(n)&&hit(e,t),(t.join||t.window===!1)&&HN(n)&&fit(e,t),t.$op=1,t.ast)FT(e,n,t),e.arguments.forEach(r=>bt(r,t,ET));else{const r=t.op(Mit(t,i,n,e.arguments));Object.assign(e,{type:iie,name:r.id})}return t.$op=0,!1}else qne(n)?FT(e,n,t):t.error(e,qie,Yie)},MemberExpression(e,t,n){const{object:i,property:r}=e;if(!Un(Qu,i))return;const{name:s}=i;if(Qie(e)&&Un(Qu,r)&&Object.hasOwn(n$,r.name)){tre(e,r.name);return}const o=s===t.tuple?0:s===t.tuple1?1:s===t.tuple2?2:-1;if(o>=0)return b4(e,o,t,Jie,n);if(s===t.$param)return b4(e,o,t,Iit);t.paramsRef.has(s)?_0(e,t.paramsRef.get(s)):t.columnRef.has(s)?ere(i,s,t,e):Object.hasOwn(t.params,s)&&_0(i,s)}};function b4(e,t,n,i,r){const{property:s,computed:o}=e;let a;if(!o)a=s.name;else if(Un(Dg,s))a=s.value;else try{bt(s,n,r$,e),a=n.param(s)}catch{n.error(e,mit)}return i(e,a,t,n,r),!1}const ET={...r$,VariableDeclarator:di("Variable declaration in operator call"),Identifier(e,t,n){Zie(e,t,n)&&t.error(e,wit)},CallExpression(e,t){const n=Xie(e.callee);qne(n)?FT(e,n,t):t.error(e,qie,Yie)}};function Pit(e,t){e.generator&&di("Generator functions")(e,t),e.async&&di("Async functions")(e,t);const{params:n}=e,i=n.length,r=o=>(a,l)=>t.columnRef.set(a,[l,o]),s=(o,a)=>t.paramsRef.set(o,a);i&&(t.join?(Om(t,n[0],"tuple1",r(1)),i>1&&Om(t,n[1],"tuple2",r(2)),i>2&&Om(t,n[2],"$param",s)):(Om(t,n[0],"tuple",r(0)),i>1&&Om(t,n[1],"$param",s))),t.root=e.body}function Om(e,t,n,i){Un(Qu,t)?(e.scope.add(t.name),e[n]=t.name):Un(eie,t)&&t.properties.forEach(r=>{const s=Un(Qu,r.key)?r.key.name:Un(Dg,r.key)?r.key.value:e.error(r,pit);Un(Qu,r.value)||e.error(r.value,Sit),i(r.value.name,s)})}function Mit(e,t,n,i){const r=[],s=[],o=t.param[0]||0,a=o+(t.param[1]||0);return i.forEach((l,u)=>{u<o?(bt(l,e,ET),r.push(e.field(l))):u<a?(bt(l,e,ET),s.push(e.param(l))):e.error(l,vit)}),{name:n,fields:r,params:s,...e.spec.window||{}}}function Xie(e){return Un(Qu,e)?e.name:Un(Jne,e)?Qie(e)?Tit(e.property.name):e.property.name:null}function Qie(e){return Un(Qu,e.object)&&e.object.name==="Math"}function Tit(e){return e==="max"?"greatest":e==="min"?"least":e}function Zie(e,t,n){const{name:i}=e;if(!(Un(Jne,n)&&n.property===e)){if(!(Un(tie,n)&&n.key===e))if(t.paramsRef.has(i))_0(e,t.paramsRef.get(i));else if(t.columnRef.has(i))ere(e,i,t,n);else if(Object.hasOwn(t.params,i))_0(e,i);else if(Object.hasOwn(n$,i))tre(e,i);else return!0}}function Jie(e,t,n,i,r){const s=n===0?i.table:n>0?i.join[n-1]:null,o=s&&s.column(t);s&&!o&&i.error(e,i$),i.aggronly&&!i.$op&&i.error(e,git),sie(e,t,n,o,r)}function ere(e,t,n,i){const[r,s]=n.columnRef.get(t);Jie(e,r,s,n,i)}function Iit(e,t,n,i){i.params&&!Object.hasOwn(i.params,t)&&i.error(e,Cit),_0(e,t)}function _0(e,t){e.type=dnt,e.name=t}function tre(e,t){e.type=lnt,e.name=t,e.raw=n$[t]}function FT(e,t,n){if(t===oie){const i=n.table;i||n.error(e,Fit),aie(e,i,e.arguments.length?e.arguments.map(r=>{const s=n.param(r),o=$c(s)?i.columnName(s):s;return i.column(o)||n.error(r,i$),o}):i.columnNames())}else e.callee={type:cnt,name:t}}function AT(e,t){Un(Qu,e)?t.scope.add(e.name):Un(rnt,e)?e.elements.forEach(n=>AT(n,t)):Un(eie,e)?e.properties.forEach(n=>AT(n.value,t)):t.error(e.id,bit)}const _it={[nie]:1,[iie]:1};function ds(e,t={}){const n=t.generate||D1,i=t.compiler||jN,r=Lit(t),s={},o={},a=[],l=[];let u=0,c=-1;const d=t.join?i.join:t.index==1?i.expr2:i.expr,h={op(m){const C=Oit(m);return o[C]||(m.id=++c,o[C]=m)},field(m){const C=n(m);return s[C]||(s[C]=++u)},param(m){return Un(Dg,m)?m.value:i.param(n(m),r)},value(m,C){a.push(m);const y=C.escape||(t.ast?fnt(C):d(n(C),r));l.push(y),_it[C.type]&&y!==C&&mc(y)&&(y.field=C.name)},error(m,C,y=""){const b=m.start-6,S=m.end-6,x=String(h.spec).slice(b,S);pn(`${C}: "${x}"${y}`)}};Object.assign(h,t,{params:r});for(const[m,C]of UN(e))h.value(m+"",C.escape?bnt(h,C,r):Ait(h,C));if(t.ast)return{names:a,exprs:l};const p=[];for(const m in s)p[s[m]]=i.expr(m,r);const g=Object.values(o);return g.forEach(m=>m.fields=m.fields.map(C=>p[C])),{names:a,exprs:l,ops:g}}function Oit(e){let t=`${e.name}(${e.fields.concat(e.params).join(",")})`;if(e.frame){const n=e.frame.map(i=>Number.isFinite(i)?Math.abs(i):-1);t+=`[${n},${!!e.peers}]`}return t}function Lit(e){return(e.table?mk(e.table):e.join?{...mk(e.join[1]),...mk(e.join[0])}:{})||{}}function mk(e){return e&&Ri(e.params)?e.params():{}}function s$(e,t){return e&&e.expr?new S4({...e,...t}):new S4(t,e)}class S4{constructor(t,n){this.expr=n,Object.assign(this,t)}toString(){return String(this.expr)}toObject(){return{...this,expr:this.toString(),...Ri(this.expr)?{func:!0}:{}}}}function I1(e,t,n=0){const i=n?{field:!0,table:n}:{field:!0};return s$(e,t?{expr:t,...i}:i)}function nre(e,t){for(const[n,i]of UN(t))e.set(n,i);return e}function Ql(e,t,n=new Map){return t=$c(t)?e.columnName(t):t,qo(t)?n.set(t,t):pr(t)?t.forEach(i=>Ql(e,i,n)):Ri(t)?Ql(e,t(e),n):mc(t)?nre(n,t):pn(`Invalid column selection: ${jl(t)}`),n}function ire(e,t){return e.toObject=t,e}function rre(e){return pr(e)?e.map(rre):e&&e.toObject?e.toObject():e}function O0(){return ire(e=>e.columnNames(),()=>({all:[]}))}function sre(...e){return e=e.flat(),ire(t=>{const n=Ql(t,e);return t.columnNames(i=>!n.has(i))},()=>({not:rre(e)}))}function Oo(e,t,n,i={window:!1}){const r=new Map,s=o=>{o=$c(o)?t.columnName(o):o,qo(o)?r.set(o,I1(o)):Ri(o)?Ql(t,o).forEach(s):mc(o)?nre(r,o):pn(`Invalid ${e} value: ${o+""}`)};return Oa(n).forEach(s),i.preparse&&i.preparse(r),ds(r,{table:t,...i})}function o$(e,...t){return Nit(e,Oo("groupby",e,t.flat()))}function Nit(e,t){return e.create({groups:$it(e,t)})}function $it(e,{names:t=[],exprs:n=[],ops:i=[]}){const r=t.length;if(r===0)return null;if(r===1&&!e.isFiltered()&&n[0].field){const p=e.column(n[0].field);if(p.groups)return p.groups(t)}let s=Gh(e,i,n);const o=F1(s),a=e.totalRows(),l=new Uint32Array(a),u={},c=[],d=e.data(),h=e.mask();if(h)for(let p=h.next(0);p>=0;p=h.next(p+1)){const g=o(p,d)+"";l[p]=u[g]??=c.push(p)-1}else for(let p=0;p<a;++p){const g=o(p,d)+"";l[p]=u[g]??=c.push(p)-1}return i.length||(s=s.map(p=>g=>p(g,d))),{keys:l,get:s,names:t,rows:c,size:c.length}}function hs(e){return e?new x4({...e.data()},e.columnNames()):new x4}class x4{constructor(t,n){this.data=t||{},this.names=n||[]}add(t,n){return this.has(t)||this.names.push(t+""),this.data[t]=n}has(t){return Object.hasOwn(this.data,t)}groupby(t){return this.groups=t,this}new(t){const{data:n,names:i,groups:r=null}=this;return t.create({data:n,names:i,groups:r,filter:null,order:null})}derive(t){return t.create(this)}}function L0(e,t){return a$(e,ds(t,{table:e,aggronly:!0,window:!1}))}function a$(e,{names:t,exprs:n,ops:i=[]}){const r=hs(),s=e.groups();return s&&Zne(r,s),Bit(t,n,s,Ag(e,i),r),r.new(e)}function Bit(e,t,n,i=[],r){if(!t.length)return;const s=n?n.size:1,o=(l,u)=>i[l][u],a=e.length;for(let l=0;l<a;++l){const u=t[l];if(u.field!=null)r.add(e[l],i[u.field]);else if(s>1){const c=r.add(e[l],Array(s));for(let d=0;d<s;++d)c[d]=u(d,null,o)}else r.add(e[l],[u(0,null,o)])}}function ore(e,...t){return l$(e,Ql(e,t.flat()))}function l$(e,t){const n=hs();return t.forEach((i,r)=>{const s=qo(i)?i:r;if(s){const o=e.column(r)||pn(`Unrecognized column: ${r}`);n.add(s,o)}}),n.derive(e)}function Git(e,t){if(!e||!t)return e;const{keys:n,rows:i,size:r}=e,s=new Uint32Array(r);t.scan(c=>s[n[c]]=1);const o=s.reduce((c,d)=>c+d,0);if(o===r)return e;const a=Array(o);let l=0;for(let c=0;c<r;++c)s[c]&&(a[s[c]=l++]=i[c]);const u=new Uint32Array(n.length);return t.scan(c=>u[c]=s[n[c]]),{...e,keys:u,rows:a,size:l}}function zit(e,t,n,i){const{keys:r,rows:s,size:o}=e;let a=s,l=o,u=null;if(n){u=new Int32Array(o),t(g=>u[r[g]]=1);const p=u.reduce((g,m)=>g+m,0);if(p!==o){a=Array(p),l=0;for(let g=0;g<o;++g)u[g]&&(a[u[g]=l++]=s[g])}}let c=-1;const d=new Uint32Array(i);return t(l!==o?p=>d[++c]=u[r[p]]:p=>d[++c]=r[p]),{...e,keys:d,rows:a,size:l}}function Hit(e,t,n,i){const r=i==="map"||i===!0?zne:i==="entries"?Vne:i==="object"?Hne:pn('groups option must be "map", "entries", or "object".'),{names:s}=e.groups(),o=Vtt(e.columnNames(),"_");let a=ore(e,{}).reify(t).create({data:{[o]:n}});a=L0(a,{[o]:Bne(o)});for(let l=s.length;--l>=0;)a=L0(o$(a,s.slice(0,l)),{[o]:r(s[l],o)});return a.get(o)}function Vit(e){return eE(e)?e.constructor:Array}let DT=class{constructor(t,n,i,r,s,o){const a=Object.freeze({...t});n=n?.slice()??Object.keys(a);const l=n.length?a[n[0]].length:0;this._names=Object.freeze(n),this._data=a,this._total=l,this._nrows=i?.count()??l,this._mask=i??null,this._group=r??null,this._order=s??null,this._params=o,this._index=null,this._partitions=null}create({data:t=void 0,names:n=void 0,filter:i=void 0,groups:r=void 0,order:s=void 0}={}){const o=i!==void 0?i:this.mask();return new this.constructor(t||this._data,n||(t?null:this._names),o,r!==void 0?r:Git(this._group,i&&o),s!==void 0?s:this._order,this._params)}params(t){return arguments.length?(t&&(this._params={...this._params,...t}),this):this._params}get[Symbol.toStringTag](){if(!this._names)return"Object";const t=this.numRows(),n=this.numCols(),i=r=>r!==1?"s":"";return`Table: ${n} col${i(n)} x ${t} row${i(t)}`+(this.isFiltered()?` (${this.totalRows()} backing)`:"")+(this.isGrouped()?`, ${this._group.size} groups`:"")+(this.isOrdered()?", ordered":"")}isFiltered(){return!!this._mask}isGrouped(){return!!this._group}isOrdered(){return!!this._order}data(){return this._data}mask(){return this._mask}groups(){return this._group}comparator(){return this._order}totalRows(){return this._total}numRows(){return this._nrows}get size(){return this._nrows}numCols(){return this._names.length}columnNames(t){return t?this._names.filter(t):this._names.slice()}columnName(t){return this._names[t]}columnIndex(t){return this._names.indexOf(t)}column(t){return this._data[t]}columnAt(t){return this._data[this._names[t]]}array(t,n=Array){const i=this.column(t),r=new n(this.numRows());let s=-1;return this.scan(o=>r[++s]=i.at(o),!0),r}get(t,n=0){const i=this.column(t);return this.isFiltered()||this.isOrdered()?i.at(this.indices()[n]):i.at(n)}getter(t){const n=this.column(t),i=this.isFiltered()||this.isOrdered()?this.indices():null;if(i)return r=>n.at(i[r]);if(n)return r=>n.at(r);pn(`Unrecognized column: ${t}`)}object(t=0){return R4(this)(t)}objects(t={}){const{grouped:n,limit:i,offset:r}=t,s=Ql(this,t.columns||O0()),o=uie(this,s),a=[];if(this.scan((l,u)=>a.push(o(l,u)),!0,i,r),n&&this.isGrouped()){const l=[];return this.scan(u=>l.push(u),!0,i,r),Hit(this,l,a,n)}return a}*[Symbol.iterator](){const t=R4(this),n=this.numRows();for(let i=0;i<n;++i)yield t(i)}*values(t){const n=this.getter(t),i=this.numRows();for(let r=0;r<i;++r)yield n(r)}print(t={}){const n=$c(t)?{limit:+t}:{...t,limit:10},i=this.objects({...n,grouped:!1}),r=`${this[Symbol.toStringTag]}. Showing ${i.length} rows.`;return console.log(r),console.table(i),this}indices(t=!0){if(this._index)return this._index;const n=this.numRows(),i=new Uint32Array(n),r=this.isOrdered(),s=this.mask();let o=-1;if(s)for(let a=s.next(0);a>=0;a=s.next(a+1))i[++o]=a;else for(let a=0;a<n;++a)i[++o]=a;if(t&&r){const{_order:a,_data:l}=this;i.sort((u,c)=>a(u,c,l))}return(t||!r)&&(this._index=i),i}partitions(t=!0){if(this._partitions)return this._partitions;if(!this.isGrouped())return[this.indices(t)];const{keys:n,size:i}=this._group,r=Eg(i,()=>[]),s=this._index,o=this.mask(),a=this.numRows();if(s&&this.isOrdered())for(let l=0,u;l<a;++l)u=s[l],r[n[u]].push(u);else if(o)for(let l=o.next(0);l>=0;l=o.next(l+1))r[n[l]].push(l);else for(let l=0;l<a;++l)r[n[l]].push(l);if(t&&!s&&this.isOrdered()){const l=this._order,u=this._data;for(let c=0;c<i;++c)r[c].sort((d,h)=>l(d,h,u))}return(t||!this.isOrdered())&&(this._partitions=r),r}reify(t){const n=t?t.length:this.numRows(),i=this._names;let r,s;if(!t&&!this.isOrdered())if(this.isFiltered())n===this.totalRows()&&(r=this.data());else return this;if(!r){const o=t?l=>t.forEach(l):l=>this.scan(l,!0),a=i.length;r={};for(let l=0;l<a;++l){const u=i[l],c=this.column(u),d=r[u]=new(Vit(c))(n);let h=-1;Lc(c)?o(p=>d[++h]=c[p]):o(p=>d[++h]=c.at(p))}this.isGrouped()&&(s=zit(this.groups(),o,!!t,n))}return this.create({data:r,names:i,groups:s,filter:null,order:null})}scan(t,n,i=1/0,r=0){const s=this._mask,o=this._nrows,a=this._data;let l=r||0;if(l>o)return;const u=Math.min(o,l+i),c=()=>l=this._total;if(n&&this.isOrdered()||s&&this._index){const d=this.indices(),h=this._data;for(;l<u;++l)t(d[l],h,c)}else if(s){let d=u-l+1;for(l=s.nth(l);--d&&l>-1;l=s.next(l+1))t(l,a,c)}else for(;l<u;++l)t(l,a,c)}};function R4(e){let t=e._builder;if(!t){const n=uie(e),i=e.data();if(e.isOrdered()||e.isFiltered()){const r=e.indices();t=s=>n(r[s],i)}else t=r=>n(r,i);e._builder=t}return t}function Wit(e,...t){t=t.flat();const n=e.numRows(),i=e.reify(),r=hs(i).groupby(i.groups());return t.forEach(s=>{s=s instanceof DT?s:new DT(s),s.numRows()!==n&&pn("Assign row counts do not match"),s=s.reify(),s.columnNames(o=>r.add(o,s.column(o)))}),r.new(e)}function are(e,...t){t=t.flat();const n=e.numRows(),i=n+t.reduce((o,a)=>o+a.numRows(),0);if(n===i)return e;const r=[e,...t],s=hs();return e.columnNames().forEach(o=>{const a=Array(i);let l=0;r.forEach(u=>{const c=u.column(o)||{at:()=>Et};u.scan(d=>a[l++]=c.at(d))}),s.add(o,a)}),s.new(e)}function lre(e,t,{before:n=void 0,after:i=void 0}={}){const r=n!=null,s=i!=null;r||s||pn("relocate requires a before or after option."),r&&s&&pn("relocate accepts only one of the before or after options."),t=Ql(e,t);const o=[...Ql(e,r?n:i).keys()],a=r?o[0]:o.pop(),l=new Map;return e.columnNames().forEach(u=>{const c=!t.has(u);if(u===a){s&&c&&l.set(u,u);for(const[d,h]of t)l.set(d,h);if(s)return}c&&l.set(u,u)}),l$(e,l)}function ure(e){return{left(t,n,i,r){for(i==null&&(i=0),r==null&&(r=t.length);i<r;){const s=i+r>>>1;e(t[s],n)<0?i=s+1:r=s}return i},right(t,n,i,r){for(i==null&&(i=0),r==null&&(r=t.length);i<r;){const s=i+r>>>1;e(t[s],n)>0?r=s:i=s+1}return i}}}const E4=ure(VN);function Uit(e,t,n,i,r){let s,o,a,l,u;const c=m=>o[m-1]===o[m],d=i.length,h=r.length,p=i.length?Fg(["w","r","k"],"{"+BC(i,(m,C)=>`r[_${C}.id][k]=_${C}.value(w,_${C}.get);`)+"}",i):()=>{},g={i0:0,i1:0,index:0,size:0,peer:c,init(m,C,y,b){g.index=g.i0=g.i1=0,g.size=C.length,s=m,o=C,l=y,u=b,a=r?r.map(S=>S.init()):null;for(let S=0;S<d;++S)i[S].init();return g},value(m,C){return C(s[m],e)},step(m){const[C,y]=t,b=g.size,S=g.i0,x=g.i1;g.i0=C!=null?Math.max(0,m-Math.abs(C)):0,g.i1=y!=null?Math.min(b,m+Math.abs(y)+1):b,g.index=m,n&&(g.i0>0&&c(g.i0)&&(g.i0=E4.left(o,o[g.i0])),g.i1<b&&c(g.i1)&&(g.i1=E4.right(o,o[g.i1-1])));for(let E=0;E<h;++E){const A=r[E],F=a[E];for(let P=S;P<g.i0;++P)A.rem(F,s[P],e);for(let P=x;P<g.i1;++P)A.add(F,s[P],e);A.write(F,l,u)}return p(g,l,u),l}};return g}const qit=e=>(e.frame||[null,null]).map(t=>Number.isFinite(t)?Math.abs(t):null),jit=e=>!!e.peers;function Kit(e){const{id:t,name:n,fields:i=[],params:r=[]}=e;return{...Kne(n).create(...r),get:i.length?i[0]:null,id:t}}function Yit(e,t,n,i={},r){const s=e.data(),o=Xit(r,s),a=o.length,l=Fg(["r","d","op"],"{"+BC(t,(u,c)=>`_${c}[r] = $${c}(r, d, op);`)+"}",t,n);e.partitions().forEach((u,c)=>{const d=u.length,h=Qit(e,u);for(let g=0;g<a;++g)o[g].init(u,h,i,c);const p=g=>i[g][c];for(let g=0;g<d;++g){for(let m=0;m<a;++m)o[m].step(g);l(u[g],s,p)}})}function Xit(e,t){const n={};return e.forEach(i=>{const r=qit(i),s=jit(i),o=`${r},${s}`,{aggOps:a,winOps:l}=n[o]||(n[o]={frame:r,peers:s,aggOps:[],winOps:[]});zN(i.name)?a.push(i):l.push(Kit(i))}),Object.values(n).map(i=>Uit(t,i.frame,i.peers,i.winOps,Yne(i.aggOps,i.frame[0]!=null?-1:1)))}function Qit(e,t){if(e.isOrdered()){const n=e.comparator(),i=e.data(),r=t.length,s=new Uint32Array(r);for(let o=1,a=0;o<r;++o)s[o]=n(t[o-1],t[o],i)?++a:a;return s}else return t}function Zit(e){return HN(e.name)||e.frame&&(Number.isFinite(e.frame[0])||Number.isFinite(e.frame[1]))}function Jit(e,t,n={}){const i=u$(e,ds(t,{table:e}),n);return n.drop||n.before==null&&n.after==null?i:lre(i,Object.keys(t).filter(r=>!e.column(r)),n)}function u$(e,{names:t,exprs:n,ops:i=[]},r={}){const s=e.totalRows(),o=hs(r.drop?null:e),a=t.map(h=>o.add(h,Array(s))),[l,u]=ert(i),c=e.isGrouped()?e.groups().size:1,d=Ag(e,l,Eg(i.length,()=>Array(c)));return u.length?Yit(e,a,n,d,u):trt(e,a,n,d),o.derive(e)}function ert(e){const t=[],n=[],i=e.length;for(let r=0;r<i;++r){const s=e[r];s.id=r,(Zit(s)?n:t).push(s)}return[t,n]}function trt(e,t,n,i){const r=e.mask(),s=e.data(),{keys:o}=e.groups()||{},a=o?(u,c)=>i[u][o[c]]:u=>i[u][0],l=t.length;for(let u=0;u<l;++u){const c=n[u],d=t[u];if(r)for(let h=r.next(0);h>=0;h=r.next(h+1))d[h]=c(h,s,a);else{const h=e.totalRows();for(let p=0;p<h;++p)d[p]=c(p,s,a)}}}function c$(e,t){const n=ds({p:t},{table:e});let i=n.exprs[0];if(n.ops.length){const r=u$(e,n,{drop:!0}).column("p");i=s=>r.at(s)}return nrt(e,i)}function nrt(e,t){const n=e.totalRows(),i=e.mask(),r=e.data(),s=new NN(n);if(i)for(let o=i.next(0);o>=0;o=i.next(o+1))t(o,r)&&s.set(o);else for(let o=0;o<n;++o)t(o,r)&&s.set(o);return e.create({filter:s})}function aE(e,...t){t=t.flat();const n=o$(e,t.length?t:e.columnNames());return c$(n,"row_number() === 1").ungroup().reify()}function cre(e,t){const n=new Map;return e.scan((i,r)=>{const s=t(i,r);s!=null&&s===s&&n.set(s,i)}),n}function irt(e,t,n){const i=new Map,r=e.length;for(let s=0;s<r;++s){const o=e[s],a=n(o,t);a!=null&&a===a&&(i.has(a)?i.get(a).push(s):i.set(a,[s]))}return i}function rrt(e,t){const n=new Set(t);return e.filter(i=>n.has(i))}function _1(e,t,n){const i=new Map;Oa(n).forEach((s,o)=>{s=$c(s)?t.columnName(s):s,qo(s)?i.set(o,I1(s)):Ri(s)||mc(s)&&s.expr?i.set(o,s):pn(`Invalid ${e} key value: ${s+""}`)});const r=ds(i,{table:t,aggregate:!1,window:!1});return F1(r.exprs,!0)}function d$(e,t,n){if(n)qo(n)?n=[n,n]:pr(n)&&n.length===1&&(n=[n[0],n[0]]);else{const i=rrt(e.columnNames(),t.columnNames());i.length||pn("Natural join requires shared column names."),n=[i,i]}return n}function dre(e,t,n,i){return n.length!==i.length&&pn("Mismatched number of join keys"),[_1("join",e,n),_1("join",t,i)]}function hre(e,t,n){return pre(e,t,n,{anti:!1})}function fre(e,t,n){return pre(e,t,n,{anti:!0})}function pre(e,t,n,i){n=d$(e,t,n);const r=pr(n)?dre(e,t,...n.map(Oa)):ds({on:n},{join:[e,t]}).exprs[0];return srt(e,t,r,i)}function srt(e,t,n,i={}){const r=new NN(e.totalRows());return(pr(n)?ort:art)(r,e,t,n),i.anti&&r.not().and(e.mask()),e.create({filter:r})}function ort(e,t,n,[i,r]){const s=cre(n,r);t.scan((o,a)=>{s.get(i(o,a))>=0&&e.set(o)})}function art(e,t,n,i){const r=t.numRows(),s=n.numRows(),o=t.data(),a=n.data();if(t.isFiltered()||n.isFiltered()){const l=t.indices(!1),u=n.indices(!1);for(let c=0;c<r;++c){const d=l[c];for(let h=0;h<s;++h)if(i(d,o,u[h],a)){e.set(d);break}}}else for(let l=0;l<r;++l)for(let u=0;u<s;++u)if(i(l,o,u,a)){e.set(l);break}}function lrt(e,...t){if(t=t.flat(),t.length===0)return e;const n=e.columnNames();return aE(t.reduce((i,r)=>fre(i,r.select(n)),e))}function urt(e,t,n){return gre(e,Oo("unroll",e,t),n&&n.drop?{...n,drop:Oo("unroll",e,n.drop).names}:n)}function gre(e,{names:t=[],exprs:n=[],ops:i=[]},r={}){if(!t.length)return e;const s=r.limit>0?+r.limit:1/0,o=r.index?r.index===!0?"index":r.index+"":null,a=new Set(r.drop),l=Gh(e,i,n),u=hs(),c=new Set(t),d=[],h=[],p=[];e.columnNames().forEach(x=>{if(!a.has(x)){const E=u.add(x,[]);c.has(x)||(d.push(e.column(x)),h.push(E))}}),t.forEach(x=>{a.has(x)||(u.has(x)||u.add(x,[]),p.push(u.data[x]))});const g=o?u.add(o,[]):null;let m=0;const C=d.length,y=p.length,b=(x,E)=>{for(let A=0;A<C;++A)h[A].length=m+E,h[A].fill(d[A].at(x),m,m+E)},S=g?(x,E)=>{for(let A=0;A<E;++A)g[x+A]=A}:()=>{};if(y===1){const x=l[0],E=p[0];e.scan((A,F)=>{const P=Oa(x(A,F)),D=Math.min(P.length,s);b(A,D);for(let M=0;M<D;++M)E[m+M]=P[M];S(m,D),m+=D})}else e.scan((x,E)=>{let A=0;const F=l.map(P=>{const D=Oa(P(x,E));return A=Math.min(Math.max(A,D.length),s),D});b(x,A);for(let P=0;P<y;++P){const D=p[P],M=F[P];for(let O=0;O<A;++O)D[m+O]=M[O]}S(m,A),m+=A});return u.new(e)}function crt(e,t,n){return drt(e,Oo("fold",e,t),n)}function drt(e,{names:t=[],exprs:n=[],ops:i=[]},r={}){if(t.length===0)return e;const[s="key",o="value"]=r.as||[],a=Gh(e,i,n);return gre(e,{names:[s,o],exprs:[()=>t,(l,u)=>a.map(c=>c(l,u))]},{...r,drop:t})}function lE(e){return e.isGrouped()?e.create({groups:null}):e}function hrt(e,t,n={}){if(t=ds(t,{table:e}),t.names.forEach(i=>e.column(i)?0:pn(`Invalid impute column ${jl(i)}`)),n.expand){const i={preparse:frt,window:!1,aggronly:!0},r=Oo("impute",e,n.expand,i),s=a$(lE(e),r);return F4(e,t,r.names,r.names.map(o=>s.get(o,0)))}else return F4(e,t)}function frt(e){e.forEach((t,n)=>t.field?e.set(n,Gne(t+"")):0)}function F4(e,t,n,i){const r=n&&n.length;e=r?prt(e,n,i):e;const{names:s,exprs:o,ops:a}=t,l=Gh(e,a,o),u=r?null:hs(e),c=e.totalRows();return s.forEach((d,h)=>{const p=e.column(d),g=r?p:u.add(d,Array(c)),m=l[h];e.scan(C=>{const y=p.at(C);g[C]=So(y)?y:m(C)})}),r?e:e.create(u)}function prt(e,t,n){const i=e.groups(),r=e.data(),s=(i?i.names:[]).concat(t),o=(i?i.get:[]).concat(t.map(g=>e.getter(g))),a=new Set,l=F1(o);e.scan((g,m)=>a.add(l(g,m)));const u=e.columnNames(),c=hs(),d=u.map(g=>c.add(g,[]));u.forEach((g,m)=>{const C=r[g],y=d[m];e.scan(b=>y.push(C.at(b)))});const h=F1(o.map((g,m)=>C=>C[m])),p=Fg("v","{"+d.map((g,m)=>`_${m}.push(v[$${m}]);`).join("")+"}",d,u.map(g=>s.indexOf(g)));if(i){let g=i.keys.length;const m=n.reduce((y,b)=>y*b.length,i.size),C=new Uint32Array(m+(g-a.size));C.set(i.keys),A4(i,n,(y,b)=>{a.has(h(y))||(p(y),C[g++]=b[0])}),c.groupby({...i,keys:C})}else A4(i,n,g=>{a.has(h(g))||p(g)});return c.new(e)}function A4(e,t,n){const i=e?e.get.length:0,r=e?1:0,s=r+t.length,o=new Int32Array(s),a=new Int32Array(s),l=[];if(e){const{get:c,rows:d,size:h}=e;o[0]=h,l.push((p,g)=>{const m=d[g];for(let C=0;C<i;++C)p[C]=c[C](m)})}t.forEach((c,d)=>{const h=d+i;o[d+r]=c.length,l.push((p,g)=>p[h]=c[g])});const u=Array(i+t.length);for(let c=0;c<s;++c)l[c](u,0);n(u,a);for(let c=s-1;c>=0;){const d=++a[c];d<o[c]?(l[c](u,d),n(u,a),c=s-1):(a[c]=0,l[c](u,0),--c)}}function grt(e,...t){t=t.flat();const n=e.columnNames();return t.length?aE(t.reduce((i,r)=>hre(i,r.select(n)),e)):e.reify([])}const mrt={aggregate:!1,window:!1},vrt={...mrt,index:1},D4=-1/0;function Crt(e,t,n,i){return cv(e,t,()=>!0,n,{...i,left:!0,right:!0})}function cv(e,t,n,i,r={}){n=d$(e,t,n);const s={join:[e,t]};let o;if(pr(n)){const[a,l]=n.map(Oa);o=dre(e,t,a,l),i||(i=yrt(e,a,l,r))}else o=ds({on:n},s).exprs[0],i||(i=[O0(),O0()]);return Srt(e,t,o,wrt(e,t,i,s,r&&r.suffix),r)}function yrt(e,t,n,i){const r=[];t.forEach((o,a)=>qo(o)&&o===n[a]?r.push(o):0);const s=sre(r);if(i.left&&i.right){const o=new Set(r);return[e.columnNames().map(a=>{const l=`[${jl(a)}]`;return o.has(a)?{[a]:`(a, b) => a${l} == null ? b${l} : a${l}`}:a}),s]}return i.right?[s,O0()]:[O0(),s]}function wrt(e,t,n,i,r=[]){if(pr(n)){let s,o,a,l=n.length;s=o=a={names:[],exprs:[]},l--&&(s=Oo("join",e,n[0],i)),l--&&(o=Oo("join",t,n[1],vrt)),l--&&(a=ds(n[2],i));const u=new Set,c=new Set(s.names);return o.names.forEach(d=>{c.has(d)&&u.add(d)}),u.size&&(r[0]!==""&&k4(s.names,u,r[0]||"_1"),r[1]!==""&&k4(o.names,u,r[1]||"_2")),{names:s.names.concat(o.names,a.names),exprs:s.exprs.concat(o.exprs,a.exprs)}}else return ds(n,i)}function k4(e,t,n){e.forEach((i,r)=>t.has(i)?e[r]=i+n:0)}function brt(e,t){const n=["i","a","j","b"];return Fg(n,"{"+BC(e,(i,r)=>`_${r}.push($${r}(${n}));`)+"}",e,t)}function Srt(e,t,n,{names:i,exprs:r},s={}){const o=e.data(),a=e.indices(!1),l=a.length,u=new Int32Array(l),c=t.data(),d=t.indices(!1),h=d.length,p=new Int32Array(h),g=i.length,m=hs(),C=Array(g),y=Array(g);for(let x=0;x<i.length;++x)C[x]=m.add(i[x],[]),y[x]=r[x];const b=brt(C,y);if((pr(n)?Rrt:xrt)(b,n,o,c,a,d,u,p,l,h),s.left)for(let x=0;x<l;++x)u[x]||b(a[x],o,D4,c);if(s.right)for(let x=0;x<h;++x)p[x]||b(D4,o,d[x],c);return m.new(e)}function xrt(e,t,n,i,r,s,o,a,l,u){for(let c=0;c<l;++c){const d=r[c];for(let h=0;h<u;++h){const p=s[h];t(d,n,p,i)&&(e(d,n,p,i),o[c]=1,a[h]=1)}}}function Rrt(e,[t,n],i,r,s,o,a,l,u,c){let d,h,p,g,m,C,y,b,S=e;u>=c?(d=i,h=t,p=a,g=s,m=r,C=n,y=l,b=o):(d=r,h=n,p=l,g=o,m=i,C=t,y=a,b=s,S=(A,F,P,D)=>e(P,D,A,F));const x=irt(b,m,C),E=g.length;for(let A=0;A<E;++A){const F=g[A],P=x.get(h(F,d));if(P){const D=P.length;for(let M=0;M<D;++M){const O=P[M];S(F,d,b[O],m),y[O]=1}p[A]=1}}}function Ert(e,t,n,...i){return n=d$(e,t,n),i=i.length===0?[sre(e.columnNames())]:i.flat(),Frt(e,t,[_1("lookup",e,n[0]),_1("lookup",t,n[1])],Oo("lookup",t,i))}function Frt(e,t,[n,i],{names:r,exprs:s,ops:o=[]}){const a=hs(e),l=e.totalRows();r.forEach(h=>a.add(h,Array(l).fill(Et)));const u=cre(t,i),c=Fg(["lr","rr","data"],"{"+BC(r,(h,p)=>`_[${p}][lr] = $[${p}](rr, data);`)+"}",r.map(h=>a.data[h]),Gh(t,o,s)),d=t.data();return e.scan((h,p)=>{const g=u.get(n(h,p));g>=0&&c(h,g,d)}),a.derive(e)}const Art=(e,t,n,i)=>`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${n} : (u > v || v == null) && u != null ? ${i} : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n} : v !== v && u === u ? ${i} : `,Drt=(e,t,n,i,r)=>`(v = ${t}, (u = ${e}) == null && v == null) ? 0 : v == null ? ${i} : u == null ? ${n} : (u = ${r}(u,v)) ? u : `;function krt(e,t){const n=[],i=[],r=[];let s=null,o="0",a="0";e.isGrouped()&&(s=e.groups().keys,o="ka",a="kb");const{ops:l}=ds(t,{table:e,value:(p,g)=>{if(n.push(p),g.escape){const m=C=>`fn[${r.length}](${C}, data)`;i.push([m("a"),m("b")]),r.push(g.escape)}else i.push([D1(g,{index:"a",op:o}),D1(g,{index:"b",op:a})])},window:!1}),u=Ag(e,l),c=(p,g)=>u[p][g],d=n.length;let h="return (a, b) => {"+(c&&e.isGrouped()?"const ka = keys[a], kb = keys[b];":"")+"let u, v; return ";for(let p=0;p<d;++p){const g=t.get(n[p]),m=g.desc?-1:1,[C,y]=i[p];g.collate?(h+=Drt(C,y,-m,m,`${m<0?"-":""}fn[${r.length}]`),r.push(g.collate)):h+=Art(C,y,-m,m)}return h+="0;};",Function("op","keys","fn","data",h)(c,s,r,e.data())}function Prt(e,...t){return Trt(e,Mrt(e,t.flat()))}function Mrt(e,t){let n=-1;const i=new Map,r=s=>i.set(++n+"",s);return t.forEach(s=>{const o=s.expr!=null?s.expr:s;if(mc(o)&&!Ri(o))for(const a in o)r(o[a]);else r($c(o)?I1(s,e.columnName(o)):qo(o)?I1(s):Ri(o)?s:pn(`Invalid orderby field: ${s+""}`))}),krt(e,i)}function Trt(e,t){return e.create({order:t})}function Irt(e,t,n,i){return Ort(e,Oo("fold",e,t),Oo("fold",e,n,{preparse:_rt,window:!1,aggronly:!0}),i)}function _rt(e){e.forEach((t,n)=>t.field?e.set(n,Nne(t+"")):0)}const kT=(e,t)=>e??t;function Ort(e,t,n,i={}){const{keys:r,keyColumn:s}=Lrt(e,t,i),o=kT(i.valueSeparator,"_"),a=n.names.length>1?(u,c)=>c+o+r[u]:u=>r[u],l=r.map(u=>Ag(e,n.ops.map(c=>{if(c.name==="count"){const h=p=>u===s[p]?1:NaN;return h.toString=()=>u+":1",{...c,name:"sum",fields:[h]}}const d=c.fields.map(h=>{const p=(g,m)=>u===s[g]?h(g,m):NaN;return p.toString=()=>u+":"+h,p});return{...c,fields:d}})));return Nrt(n,a,e.groups(),l).new(e)}function Lrt(e,t,n){const i=n.limit>0?+n.limit:1/0,r=kT(n.sort,!0),s=kT(n.keySeparator,"_"),o=Gh(e,t.ops,t.exprs),a=o.length===1?o[0]:(d,h)=>o.map(p=>p(d,h)).join(s),l=Array(e.totalRows());e.scan((d,h)=>l[d]=a(d,h));const u=Ag(lE(e),[{id:0,name:"array_agg_distinct",fields:[d=>l[d]],params:[]}])[0][0],c=r?u.sort():u;return{keys:Number.isFinite(i)?c.slice(0,i):c,keyColumn:l}}function Nrt({names:e,exprs:t},n,i,r){const s=i?i.size:1,o=hs(),a=r.length,l=e.length;let u;const c=(d,h)=>u[d][h];i&&Zne(o,i);for(let d=0;d<l;++d){const h=t[d];if(h.field!=null)for(let p=0;p<a;++p)o.add(n(p,e[d]),r[p][h.field]);else if(s>1)for(let p=0;p<a;++p){u=r[p];const g=o.add(n(p,e[d]),Array(s));for(let m=0;m<s;++m)g[m]=h(m,null,c)}else for(let p=0;p<a;++p)u=r[p],o.add(n(p,e[d]),[h(0,null,c)])}return o}function $rt(e,t){const n=hs(),i=e.groups(),{get:r,names:s=[],rows:o,size:a=1}=i||{},l=new Uint32Array(a+1);s.forEach(h=>n.add(h,null));const u=i?Qne(e,t,i):[Xne(e,t)];t.outputs().map(h=>n.add(h,[]));const c=l.length-1;let d=0;for(let h=0;h<c;++h)d+=l[h+1]=t.write(u[h],n.data,l[h]);if(i){const h=e.data();s.forEach((p,g)=>{const m=n.data[p]=Array(d),C=r[g];for(let y=0,b=0;y<a;++y)m.fill(C(o[y],h),b,b+=l[y+1])})}return n.new(e)}function Brt(e,...t){const n=new Map;return e.columnNames(i=>(n.set(i,i),0)),l$(e,Ql(e,t.flat(),n))}function Grt(e,t,n,i){return(t?i?Hrt:zrt:i?Wrt:Vrt)(e.length,e,n,i)}function zrt(e,t,n){const i=n.length;for(let r=0;r<e;++r)t[r]=n[i*Rg()|0];return t}function Hrt(e,t,n,i){const r=n.length,s=new Float64Array(r);let o=0;for(let l=0;l<r;++l)s[l]=o+=i(n[l]);const a=ure(VN).right;for(let l=0;l<e;++l)t[l]=n[a(s,o*Rg())];return t}function Vrt(e,t,n){const i=n.length;if(e>=i)return n;for(let r=0;r<e;++r)t[r]=n[r];for(let r=e;r<i;++r){const s=r*Rg();s<e&&(t[s|0]=n[r])}return t}function Wrt(e,t,n,i){const r=n.length;if(e>=r)return n;const s=new Float32Array(r),o=new Uint32Array(r);for(let a=0;a<r;++a)o[a]=a,s[a]=-Math.log(Rg())/i(n[a]);o.sort((a,l)=>s[a]-s[l]);for(let a=0;a<e;++a)t[a]=n[o[a]];return t}function Urt(e,t=0,n=e.length){let i=n-(t=+t);for(;i;){const r=Rg()*i--|0,s=e[i+t];e[i+t]=e[r+t],e[r+t]=s}return e}function qrt(e,t,n={}){return Yrt(e,jrt(e,t),Krt(e,n.weight),n)}const mre=e=>t=>e.at(t)||0;function jrt(e,t){return $c(t)?()=>t:mre(a$(e,ds({size:t},{table:e,window:!1})).column("size"))}function Krt(e,t){return t==null?null:(t=$c(t)?e.columnName(t):t,mre(qo(t)?e.column(t):u$(e,ds({w:t},{table:e}),{drop:!0}).column("w")))}function Yrt(e,t,n,i={}){const{replace:r,shuffle:s}=i,o=e.partitions(!1);let a=0;t=o.map((c,d)=>{let h=t(d);return a+=h=r?h:Math.min(c.length,h),h});const l=new Uint32Array(a);let u=0;return o.forEach((c,d)=>{const h=t[d],p=l.subarray(u,u+=h);!r&&h===c.length?p.set(c):Grt(p,r,c,n)}),s!==!1&&(o.length>1||!r)&&Urt(l),e.reify(l)}function Xrt(e=0,t=1/0){return`${P4(e)} < row_number() && row_number() <= ${P4(t)}`}function P4(e){return e<0?`count() + ${e}`:e}function Qrt(e,t=0,n=1/0){if(e.isGrouped())return c$(e,Xrt(t,n)).reify();const i=[],r=e.numRows();return t=Math.max(0,t+(t<0?r:0)),n=Math.min(r,Math.max(0,n+(n<0?r:0))),e.scan(s=>i.push(s),!0,n-t,t),e.reify(i)}function Zrt(e,t,n){return Jrt(e,Oo("spread",e,t),n)}function Jrt(e,{names:t,exprs:n,ops:i=[]},r={}){if(t.length===0)return e;const s=t.length===1&&r.as||[],o=r.drop==null?!0:!!r.drop,a=r.limit==null?s.length||1/0:Math.max(1,+r.limit||1),l=Gh(e,i,n),u=hs(),c=t.reduce((h,p,g)=>h.set(p,g),new Map),d=(h,p)=>{const g=est(e,l[h],a),m=g.length;for(let C=0;C<m;++C)u.add(s[C]||`${p}_${C+1}`,g[C])};return e.columnNames().forEach(h=>{c.has(h)?(o||u.add(h,e.column(h)),d(c.get(h),h),c.delete(h)):u.add(h,e.column(h))}),c.forEach(d),u.derive(e)}function est(e,t,n){const i=e.totalRows(),r=[];return e.scan((s,o)=>{const a=Oa(t(s,o)),l=Math.min(a.length,n);for(;r.length<l;)r.push(Array(i).fill(Et));for(let u=0;u<l;++u)r[u][s]=a[u]}),r}function tst(e,...t){return aE(are(e,t.flat()))}function nst(e){return e.isOrdered()?e.create({order:null}):e}const vre=Uint8Array.of(65,82,82,79,87,49),ist=Uint8Array.of(255,255,255,255,0,0,0,0),N0={V1:0,V5:4},rst={Little:0},bb={NONE:0,Schema:1,DictionaryBatch:2,RecordBatch:3},oe={Dictionary:-1,NONE:0,Null:1,Int:2,Float:3,Binary:4,Utf8:5,Bool:6,Decimal:7,Date:8,Time:9,Timestamp:10,Interval:11,List:12,Struct:13,Union:14,FixedSizeBinary:15,FixedSizeList:16,Map:17,Duration:18,LargeBinary:19,LargeUtf8:20,LargeList:21,RunEndEncoded:22,BinaryView:23,Utf8View:24,ListView:25,LargeListView:26},uE={HALF:0,SINGLE:1,DOUBLE:2},$0={DAY:0,MILLISECOND:1},Eo={SECOND:0,MILLISECOND:1,MICROSECOND:2,NANOSECOND:3},B0={YEAR_MONTH:0,DAY_TIME:1,MONTH_DAY_NANO:2},Cre={Sparse:0,Dense:1},Ig=Uint8Array,h$=Uint16Array,f$=Uint32Array,p$=BigUint64Array,g$=Int8Array,yre=Int16Array,_g=Int32Array,Og=BigInt64Array,wre=Float32Array,HC=Float64Array;function sst(e,t){const n=Math.log2(e)-3;return(t?[g$,yre,_g,Og]:[Ig,h$,f$,p$])[n]}const ost=Object.getPrototypeOf(Int8Array);function bre(e){return e instanceof ost}function Sre(e){return Array.isArray(e)||bre(e)}function m$(e){return e===Og||e===p$}function v$(e,t){let n=0,i=e.length;if(i<=2147483648)do{const r=n+i>>>1;e[r]<=t?n=r+1:i=r}while(n<i);else do{const r=Math.trunc((n+i)/2);e[r]<=t?n=r+1:i=r}while(n<i);return n}function ast(e,t=1){return(e*t+7&-8)/t}function lst(e,t=e.length){const n=ast(t,e.BYTES_PER_ELEMENT);return e.length>n?e.subarray(0,n):e.length<n?xre(e,n):e}function xre(e,t,n=0){const i=new e.constructor(t);return i.set(e,n),i}function Rre(e,t,n){for(;e.length<=t;)e=xre(e,e.length<<1,n?e.length:0);return e}function ust(e){return e instanceof Date}function cst(e){return typeof e[Symbol.iterator]=="function"}function Ere(e,t,n){if(t(e))return e;throw new Error(n(e))}function VC(e,t,n){return t=Array.isArray(t)?t:Object.values(t),Ere(e,i=>t.includes(i),n??(()=>`${e} must be one of ${t}`))}function dst(e,t){for(const[n,i]of Object.entries(e))if(i===t)return n;return"<Unknown>"}const cE=e=>`Unsupported data type: "${dst(oe,e)}" (id ${e})`,dE=(e,t,n=!0,i=null)=>({name:e,type:t,nullable:n,metadata:i});function Fre(e){return Object.hasOwn(e,"name")&&Are(e.type)}function Are(e){return typeof e?.typeId=="number"}function Dre(e,t="",n=!0){return Fre(e)?e:dE(t,Ere(e,Are,()=>"Data type expected."),n)}const kre=e=>({typeId:e}),hst=(e,t,n=!1,i=-1)=>({typeId:oe.Dictionary,id:i,dictionary:e,indices:t||C$(),ordered:n}),fst=()=>kre(oe.Null),Bc=(e=32,t=!0)=>({typeId:oe.Int,bitWidth:VC(e,[8,16,32,64]),signed:t,values:sst(e,t)}),Pre=()=>Bc(8),Mre=()=>Bc(16),C$=()=>Bc(32),Tre=()=>Bc(64),pst=()=>Bc(8,!1),gst=()=>Bc(16,!1),mst=()=>Bc(32,!1),vst=()=>Bc(64,!1),Ire=(e=2)=>({typeId:oe.Float,precision:VC(e,uE),values:[h$,wre,HC][e]}),Cst=()=>Ire(uE.SINGLE),y$=()=>Ire(uE.DOUBLE),yst=()=>({typeId:oe.Utf8,offsets:_g}),wst=()=>kre(oe.Bool),bst=e=>({typeId:oe.Date,unit:VC(e,$0),values:e===$0.DAY?_g:Og}),Sst=()=>bst($0.DAY),xst=(e=Eo.MILLISECOND,t=null)=>({typeId:oe.Timestamp,unit:VC(e,Eo),timezone:t,values:Og}),Rst=e=>({typeId:oe.List,children:[Dre(e)],offsets:_g}),Est=e=>({typeId:oe.Struct,children:Array.isArray(e)&&Fre(e[0])?e:Object.entries(e).map(([t,n])=>dE(t,n))}),Fst=(e,t)=>({typeId:oe.FixedSizeList,stride:t,children:[Dre(e)]}),_re=new HC(2),hE=_re.buffer,Ast=new Og(hE),Cf=new f$(hE),M4=new _g(hE),Dst=new Ig(hE);function kst(e){return e}function Rl(e){return BigInt(e)}function Ore(e){return m$(e)?Rl:kst}function Pst(e){return e/864e5|0}function Mst(e){return e===Eo.SECOND?t=>Rl(t/1e3):e===Eo.MILLISECOND?Rl:e===Eo.MICROSECOND?t=>Rl(t*1e3):t=>Rl(t*1e6)}function Tst([e,t,n]){return M4[0]=e,M4[1]=t,Ast[1]=Rl(n),Dst}function vc(e){if(e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER)throw Error(`BigInt exceeds integer number representation: ${e}`);return Number(e)}function w$(e,t){return Number(e/t)+Number(e%t)/Number(t)}function Ist(e,t,n,i,r){const s=typeof e=="bigint"?e:Rl(Math.trunc(e*r));t[n]=s,t[n+1]=s>>64n,i>2&&(t[n+2]=s>>128n,t[n+3]=s>>192n)}const Of=e=>BigInt.asUintN(64,e);function _st(e,t){const n=t<<1;let i;return BigInt.asIntN(64,e[n+1])<0?(i=Of(~e[n])|Of(~e[n+1])<<64n,i=-(i+1n)):i=e[n]|e[n+1]<<64n,i}function Ost(e,t){const n=t<<2;let i;return BigInt.asIntN(64,e[n+3])<0?(i=Of(~e[n])|Of(~e[n+1])<<64n|Of(~e[n+2])<<128n|Of(~e[n+3])<<192n,i=-(i+1n)):i=e[n]|e[n+1]<<64n|e[n+2]<<128n|e[n+3]<<192n,i}function Lst(e){if(e!==e)return 32256;_re[0]=e;const t=(Cf[1]&2147483648)>>16&65535;let n=Cf[1]&2146435072,i=0;return n>=1089470464?Cf[0]>0?n=31744:(n=(n&2080374784)>>16,i=(Cf[1]&1048575)>>10):n<=1056964608?(i=1048576+(Cf[1]&1048575),i=1048576+(i<<(n>>20)-998)>>21,n=0):(n=n-1056964608>>10,i=(Cf[1]&1048575)+512>>10),t|n|i&65535}const Nst=new TextDecoder("utf-8"),$st=new TextEncoder;function b$(e){return Nst.decode(e)}function Lre(e){return $st.encode(e)}function fE(e){return`${typeof e!="object"||!e?e??null:ust(e)?+e:Sre(e)?`[${e.map(fE)}]`:Bst(e)}`}function Bst(e){let t="",n=-1;for(const i in e)++n>0&&(t+=","),t+=`"${i}":${fE(e[i])}`;return`{${t}}`}const Rf=4,vk=2;function Nre(e,t){return(e[t>>3]&1<<t%8)!==0}function Ck(e,t){return Gst(e,t)<<16>>16}function Gst(e,t){return e[t]|e[t+1]<<8}function ep(e,t){return e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24}function T4(e,t){return ep(e,t)>>>0}function zst(e,t){return vc(BigInt.asIntN(64,BigInt(T4(e,t))+(BigInt(T4(e,t+Rf))<<32n)))}const yk=Symbol("rowIndex");function PT(e,t){class n{constructor(s){this[yk]=s}toJSON(){return Bre(e,t,this[yk])}}const i=n.prototype;for(let r=0;r<e.length;++r){if(Object.hasOwn(i,e[r]))continue;const s=t[r];Object.defineProperty(i,e[r],{get(){return s.at(this[yk])},enumerable:!0})}return r=>new n(r)}function $re(e,t){return n=>Bre(e,t,n)}function Bre(e,t,n){const i={};for(let r=0;r<e.length;++r)i[e[r]]=t[r].at(n);return i}function Hst(e){return e instanceof $v}class WC{constructor({length:t,nullCount:n,type:i,validity:r,values:s,offsets:o,sizes:a,children:l}){this.length=t,this.nullCount=n,this.type=i,this.validity=r,this.values=s,this.offsets=o,this.sizes=a,this.children=l,(!n||!this.validity)&&(this.at=u=>this.value(u))}get[Symbol.toStringTag](){return"Batch"}at(t){return this.isValid(t)?this.value(t):null}isValid(t){return Nre(this.validity,t)}value(t){return this.values[t]}slice(t,n){const i=n-t,r=Array(i);for(let s=0;s<i;++s)r[s]=this.at(t+s);return r}*[Symbol.iterator](){for(let t=0;t<this.length;++t)yield this.at(t)}}rf(WC,"ArrayType",null);class $v extends WC{constructor(t){super(t);const{length:n,values:i}=this;this.values=i.subarray(0,n)}slice(t,n){return this.nullCount?super.slice(t,n):this.values.subarray(t,n)}[Symbol.iterator](){return this.nullCount?super[Symbol.iterator]():this.values[Symbol.iterator]()}}class pE extends WC{}rf(pE,"ArrayType",HC);class Rn extends WC{}rf(Rn,"ArrayType",Array);class Gre extends Rn{value(t){return null}}class zh extends pE{value(t){return vc(this.values[t])}}class Vst extends pE{value(t){const n=this.values[t],i=(n&31744)>>10,r=(n&1023)/1024,s=(-1)**((n&32768)>>15);switch(i){case 31:return s*(r?Number.NaN:1/0);case 0:return s*(r?6103515625e-14*r:0)}return s*2**(i-15)*(1+r)}}class Wst extends Rn{value(t){return Nre(this.values,t)}}class zre extends WC{constructor(t){super(t);const{bitWidth:n,scale:i}=this.type;this.decimal=n===128?_st:Ost,this.scale=10n**BigInt(i)}}class Hre extends zre{value(t){return w$(this.decimal(this.values,t),this.scale)}}rf(Hre,"ArrayType",HC);class Vre extends zre{value(t){return this.decimal(this.values,t)}}rf(Vre,"ArrayType",Array);class I4 extends Rn{constructor(t){super(t),this.source=t}value(t){return new Date(this.source.value(t))}}class Ust extends pE{value(t){return 864e5*this.values[t]}}const qst=zh;class jst extends zh{value(t){return super.value(t)*1e3}}const Kst=zh;class Yst extends zh{value(t){return w$(this.values[t],1000n)}}class Xst extends zh{value(t){return w$(this.values[t],1000000n)}}class Qst extends Rn{value(t){return this.values.subarray(t<<1,t+1<<1)}}class Zst extends Rn{value(t){const n=this.values,i=t<<4;return Float64Array.of(ep(n,i),ep(n,i+4),zst(n,i+8))}}const Wre=({values:e,offsets:t},n)=>e.subarray(t[n],t[n+1]),Ure=({values:e,offsets:t},n)=>e.subarray(vc(t[n]),vc(t[n+1]));class Jst extends Rn{value(t){return Wre(this,t)}}class eot extends Rn{value(t){return Ure(this,t)}}class tot extends Rn{value(t){return b$(Wre(this,t))}}class not extends Rn{value(t){return b$(Ure(this,t))}}class iot extends Rn{value(t){const n=this.offsets;return this.children[0].slice(n[t],n[t+1])}}class rot extends Rn{value(t){const n=this.offsets;return this.children[0].slice(vc(n[t]),vc(n[t+1]))}}class sot extends Rn{value(t){const n=this.offsets[t],i=n+this.sizes[t];return this.children[0].slice(n,i)}}class oot extends Rn{value(t){const n=this.offsets[t],i=n+this.sizes[t];return this.children[0].slice(vc(n),vc(i))}}class qre extends Rn{constructor(t){super(t),this.stride=this.type.stride}}class aot extends qre{value(t){const{stride:n,values:i}=this;return i.subarray(t*n,(t+1)*n)}}class lot extends qre{value(t){const{children:n,stride:i}=this;return n[0].slice(t*i,(t+1)*i)}}function jre({children:e,offsets:t},n){const[i,r]=e[0].children,s=t[n],o=t[n+1],a=[];for(let l=s;l<o;++l)a.push([i.at(l),r.at(l)]);return a}class uot extends Rn{value(t){return jre(this,t)}}class cot extends Rn{value(t){return new Map(jre(this,t))}}class Kre extends Rn{constructor({typeIds:t,...n}){super(n),this.typeIds=t,this.typeMap=this.type.typeMap}value(t,n=t){const{typeIds:i,children:r,typeMap:s}=this;return r[s[i[t]]].at(n)}}class dot extends Kre{value(t){return super.value(t,this.offsets[t])}}class Yre extends Rn{constructor(t,n=$re){super(t),this.names=this.type.children.map(i=>i.name),this.factory=n(this.names,this.children)}value(t){return this.factory(t)}}class hot extends Yre{constructor(t){super(t,PT)}}class fot extends Rn{value(t){const[{values:n},i]=this.children;return i.at(v$(n,t))}}class pot extends Rn{setDictionary(t){return this.dictionary=t,this.cache=t.cache(),this}value(t){return this.cache[this.key(t)]}key(t){return this.values[t]}}class Xre extends Rn{constructor({data:t,...n}){super(n),this.data=t}view(t){const{values:n,data:i}=this,r=t<<4;let s=r+4,o=n;const a=ep(o,r);return a>12&&(s=ep(o,r+12),o=i[ep(o,r+8)]),o.subarray(s,s+a)}}class got extends Xre{value(t){return this.view(t)}}class mot extends Xre{value(t){return b$(this.view(t))}}class S${constructor(t,n=t[0]?.type){this.type=n,this.length=t.reduce((s,o)=>s+o.length,0),this.nullCount=t.reduce((s,o)=>s+o.nullCount,0),this.data=t;const i=t.length,r=new Int32Array(i+1);if(i===1){const[s]=t;r[1]=s.length,this.at=o=>s.at(o)}else for(let s=0,o=0;s<i;++s)r[s+1]=o+=t[s].length;this.offsets=r}get[Symbol.toStringTag](){return"Column"}[Symbol.iterator](){const t=this.data;return t.length===1?t[0][Symbol.iterator]():vot(t)}at(t){const{data:n,offsets:i}=this,r=v$(i,t)-1;return n[r]?.at(t-i[r])}get(t){return this.at(t)}toArray(){const{length:t,nullCount:n,data:i}=this,r=!n&&Hst(i[0]),s=i.length;if(r&&s===1)return i[0].values;const o=!s||n>0?Array:i[0].constructor.ArrayType??i[0].values.constructor,a=new o(t);return r?Cot(a,i):yot(a,i)}cache(){return this._cache??(this._cache=this.toArray())}}function*vot(e){for(let t=0;t<e.length;++t){const n=e[t][Symbol.iterator]();for(let i=n.next();!i.done;i=n.next())yield i.value}}function Cot(e,t){for(let n=0,i=0;n<t.length;++n){const{values:r}=t[n];e.set(r,i),i+=r.length}return e}function yot(e,t){let n=-1;for(let i=0;i<t.length;++i){const r=t[i];for(let s=0;s<r.length;++s)e[++n]=r.at(s)}return e}class x${constructor(t,n,i=!1){const r=t.fields.map(o=>o.name);this.schema=t,this.names=r,this.children=n,this.factory=i?PT:$re;const s=[];this.getFactory=o=>s[o]??(s[o]=this.factory(r,n.map(a=>a.data[o])))}get[Symbol.toStringTag](){return"Table"}get numCols(){return this.names.length}get numRows(){return this.children[0]?.length??0}getChildAt(t){return this.children[t]}getChild(t){const n=this.names.findIndex(i=>i===t);return n>-1?this.children[n]:void 0}selectAt(t,n=[]){const{children:i,factory:r,schema:s}=this,{fields:o}=s;return new x$({...s,fields:t.map((a,l)=>wot(o[a],n[l]))},t.map(a=>i[a]),r===PT)}select(t,n){const i=this.names,r=t.map(s=>i.indexOf(s));return this.selectAt(r,n)}toColumns(){const{children:t,names:n}=this,i={};return n.forEach((r,s)=>i[r]=t[s]?.toArray()??[]),i}toArray(){const{children:t,getFactory:n,numRows:i}=this,r=t[0]?.data??[],s=Array(i);for(let o=0,a=-1;o<r.length;++o){const l=n(o);for(let u=0;u<r[o].length;++u)s[++a]=l(u)}return s}*[Symbol.iterator](){const{children:t,getFactory:n}=this,i=t[0]?.data??[];for(let r=0;r<i.length;++r){const s=n(r);for(let o=0;o<i[r].length;++o)yield s(o)}}at(t){const{children:n,getFactory:i,numRows:r}=this;if(t<0||t>=r)return null;const[{offsets:s}]=n,o=v$(s,t)-1;return i(o)(t-s[o])}get(t){return this.at(t)}}function wot(e,t){return t!=null&&t!==e.name?{...e,name:t}:e}function Qre(e,t={}){const{typeId:n,bitWidth:i,precision:r,unit:s}=e,{useBigInt:o,useDate:a,useDecimalBigInt:l,useMap:u,useProxy:c}=t;switch(n){case oe.Null:return Gre;case oe.Bool:return Wst;case oe.Int:case oe.Time:case oe.Duration:return o||i<64?$v:zh;case oe.Float:return r?$v:Vst;case oe.Date:return _4(s===$0.DAY?Ust:qst,a&&I4);case oe.Timestamp:return _4(s===Eo.SECOND?jst:s===Eo.MILLISECOND?Kst:s===Eo.MICROSECOND?Yst:Xst,a&&I4);case oe.Decimal:return l?Vre:Hre;case oe.Interval:return s===B0.DAY_TIME?Qst:s===B0.YEAR_MONTH?$v:Zst;case oe.FixedSizeBinary:return aot;case oe.Utf8:return tot;case oe.LargeUtf8:return not;case oe.Binary:return Jst;case oe.LargeBinary:return eot;case oe.BinaryView:return got;case oe.Utf8View:return mot;case oe.List:return iot;case oe.LargeList:return rot;case oe.Map:return u?cot:uot;case oe.ListView:return sot;case oe.LargeListView:return oot;case oe.FixedSizeList:return lot;case oe.Struct:return c?hot:Yre;case oe.RunEndEncoded:return fot;case oe.Dictionary:return pot;case oe.Union:return e.mode?dot:Kre}throw new Error(cE(n))}function _4(e,t){return t?class extends t{constructor(i){super(new e(i))}}:e}function MT(e,t,n){e[t]=n,e[t+1]=n>>8,e[t+2]=n>>16,e[t+3]=n>>24}const zw=1024;class bot{constructor(t){this.sink=t,this.minalign=1,this.buf=new Uint8Array(zw),this.space=zw,this.vtables=[],this.outputBytes=0}offset(){return this.buf.length-this.space}writeInt8(t){this.buf[this.space-=1]=t}writeInt16(t){this.buf[this.space-=2]=t,this.buf[this.space+1]=t>>8}writeInt32(t){MT(this.buf,this.space-=4,t)}writeInt64(t){const n=BigInt(t);this.writeInt32(Number(BigInt.asIntN(32,n>>BigInt(32)))),this.writeInt32(Number(BigInt.asIntN(32,n)))}addInt8(t){ul(this,1,0),this.writeInt8(t)}addInt16(t){ul(this,2,0),this.writeInt16(t)}addInt32(t){ul(this,4,0),this.writeInt32(t)}addInt64(t){ul(this,8,0),this.writeInt64(t)}addOffset(t){ul(this,Rf,0),this.writeInt32(this.offset()-t+Rf)}addObject(t,n){const i=Sot(this,t);return n?.(i),i.finish()}addVector(t,n,i,r){const s=t?.length;if(!s)return 0;ul(this,Rf,n*s),ul(this,i,n*s);for(let o=s;--o>=0;)r(this,t[o]);return this.writeInt32(s),this.offset()}addOffsetVector(t){return this.addVector(t,4,4,(n,i)=>n.addOffset(i))}addString(t){if(t==null)return 0;const n=Lre(t),i=n.length;return this.addInt8(0),ul(this,Rf,i),this.buf.set(n,this.space-=i),this.writeInt32(i),this.offset()}finish(t){ul(this,this.minalign,Rf),this.addOffset(t)}flush(){const{buf:t,sink:n}=this,i=t.subarray(this.space,t.length);n.write(i),this.outputBytes+=i.byteLength,this.minalign=1,this.vtables=[],this.buf=new Uint8Array(zw),this.space=zw}addBuffer(t){const n=t.byteLength;if(!n)return 0;this.sink.write(t),this.outputBytes+=n;const i=(n+7&-8)-n;return this.addPadding(i),n+i}addPadding(t){t>0&&(this.sink.write(new Uint8Array(t)),this.outputBytes+=t)}}function ul(e,t,n){let{buf:i,space:r,minalign:s}=e;t>s&&(e.minalign=t);const o=i.length,a=o-r+n,l=~a+1&t-1;i=Rre(i,a+l+t-1,!0),r+=i.length-o;for(let u=0;u<l;++u)i[--r]=0;e.buf=i,e.space=r}function Sot(e,t){const n=Array(t).fill(0),i=e.offset();function r(s){n[s]=e.offset()}return{addInt8(s,o,a){o!=a&&(e.addInt8(o),r(s))},addInt16(s,o,a){o!=a&&(e.addInt16(o),r(s))},addInt32(s,o,a){o!=a&&(e.addInt32(o),r(s))},addInt64(s,o,a){o!=a&&(e.addInt64(o),r(s))},addOffset(s,o,a){o!=a&&(e.addOffset(o),r(s))},finish(){e.addInt32(0);const s=e.offset();let o=t;for(;--o>=0&&n[o]===0;);const a=o+1;for(;o>=0;--o)e.addInt16(n[o]?s-n[o]:0);const l=2;e.addInt16(s-i);const u=(a+l)*vk;e.addInt16(u);let c=0;const{buf:d,vtables:h,space:p}=e;e:for(o=0;o<h.length;++o){const g=d.length-h[o];if(u==Ck(d,g)){for(let m=vk;m<u;m+=vk)if(Ck(d,p+m)!=Ck(d,g+m))continue e;c=h[o];break}}if(c)e.space=d.length-s,MT(d,e.space,c-s);else{const g=e.offset();h.push(g),MT(d,d.length-s,g-s)}return s}}}function Zre(e,t){const{nodes:n,regions:i,variadic:r}=t,s=e.addVector(n,16,8,(l,u)=>(l.writeInt64(u.nullCount),l.writeInt64(u.length),l.offset())),o=e.addVector(i,16,8,(l,u)=>(l.writeInt64(u.length),l.writeInt64(u.offset),l.offset())),a=e.addVector(r,8,8,(l,u)=>l.addInt64(u));return e.addObject(5,l=>{l.addInt64(0,n[0].length,0),l.addOffset(1,s,0),l.addOffset(2,o,0),l.addOffset(4,a,0)})}function xot(e,t){const n=Zre(e,t.data);return e.addObject(3,i=>{i.addInt64(0,t.id,0),i.addOffset(1,n,0),i.addInt8(2,+t.isDelta,0)})}function R$(e,t){return t?.size>0?e.addOffsetVector(Array.from(t,([n,i])=>{const r=e.addString(`${n}`),s=e.addString(`${i}`);return e.addObject(2,o=>{o.addOffset(0,r,0),o.addOffset(1,s,0)})})):0}function Sb(e,t){switch(VC(t.typeId,oe,cE)){case oe.Dictionary:return Oot(e,t);case oe.Int:return kot(e,t);case oe.Float:return Dot(e,t);case oe.Decimal:return Eot(e,t);case oe.Date:return Rot(e,t);case oe.Time:return Tot(e,t);case oe.Timestamp:return Iot(e,t);case oe.Interval:return Pot(e,t);case oe.Duration:return Fot(e,t);case oe.FixedSizeBinary:case oe.FixedSizeList:return Aot(e,t);case oe.Map:return Mot(e,t);case oe.Union:return _ot(e,t)}return e.addObject(0)}function Rot(e,t){return e.addObject(1,n=>{n.addInt16(0,t.unit,$0.MILLISECOND)})}function Eot(e,t){return e.addObject(3,n=>{n.addInt32(0,t.precision,0),n.addInt32(1,t.scale,0),n.addInt32(2,t.bitWidth,128)})}function Fot(e,t){return e.addObject(1,n=>{n.addInt16(0,t.unit,Eo.MILLISECOND)})}function Aot(e,t){return e.addObject(1,n=>{n.addInt32(0,t.stride,0)})}function Dot(e,t){return e.addObject(1,n=>{n.addInt16(0,t.precision,uE.HALF)})}function kot(e,t){return e.addObject(2,n=>{n.addInt32(0,t.bitWidth,0),n.addInt8(1,+t.signed,0)})}function Pot(e,t){return e.addObject(1,n=>{n.addInt16(0,t.unit,B0.YEAR_MONTH)})}function Mot(e,t){return e.addObject(1,n=>{n.addInt8(0,+t.keysSorted,0)})}function Tot(e,t){return e.addObject(2,n=>{n.addInt16(0,t.unit,Eo.MILLISECOND),n.addInt32(1,t.bitWidth,32)})}function Iot(e,t){const n=e.addString(t.timezone);return e.addObject(2,i=>{i.addInt16(0,t.unit,Eo.SECOND),i.addOffset(1,n,0)})}function _ot(e,t){const n=e.addVector(t.typeIds,4,4,(i,r)=>i.addInt32(r));return e.addObject(2,i=>{i.addInt16(0,t.mode,Cre.Sparse),i.addOffset(1,n,0)})}function Oot(e,t){return e.addObject(4,n=>{n.addInt64(0,t.id,0),n.addOffset(1,Sb(e,t.indices),0),n.addInt8(2,+t.ordered,0)})}const Lot=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;function Jre(e,t){const{fields:n,metadata:i}=t,r=n.map(a=>ese(e,a)),s=e.addOffsetVector(r),o=R$(e,i);return e.addObject(4,a=>{a.addInt16(0,+!Lot,0),a.addOffset(1,s,0),a.addOffset(2,o,0)})}function ese(e,t){const{name:n,nullable:i,type:r,metadata:s}=t;let{typeId:o}=r,a=0,l=0;if(o!==oe.Dictionary)a=Sb(e,r);else{const p=r.dictionary;o=p.typeId,l=Sb(e,r),a=Sb(e,p)}const u=(r.children||[]).map(p=>ese(e,p)),c=e.addOffsetVector(u),d=R$(e,s),h=e.addString(n);return e.addObject(7,p=>{p.addOffset(0,h,0),p.addInt8(1,+i,0),p.addInt8(2,o,oe.NONE),p.addOffset(3,a,0),p.addOffset(4,l,0),p.addOffset(5,c,0),p.addOffset(6,d,0)})}function Not(e,t,n,i,r){const s=R$(e,r),o=e.addVector(i,24,8,O4),a=e.addVector(n,24,8,O4),l=Jre(e,t);e.finish(e.addObject(5,c=>{c.addInt16(0,N0.V5,N0.V1),c.addOffset(1,l,0),c.addOffset(2,a,0),c.addOffset(3,o,0),c.addOffset(4,s,0)}));const u=e.offset();e.addInt32(0),e.addInt32(-1),e.flush(),e.sink.write(new Uint8Array(Int32Array.of(u).buffer)),e.sink.write(vre)}function O4(e,{offset:t,metadataLength:n,bodyLength:i}){return e.writeInt64(i),e.writeInt32(0),e.writeInt32(n),e.writeInt64(t),e.offset()}function wk(e,t,n,i,r){e.finish(e.addObject(5,l=>{l.addInt16(0,N0.V5,N0.V1),l.addInt8(1,t,bb.NONE),l.addOffset(2,n,0),l.addInt64(3,i,0)}));const s=8,o=e.offset(),a=o+s+7&-8;r?.push({offset:e.outputBytes,metadataLength:a,bodyLength:i}),e.addInt32(a-s),e.addInt32(-1),e.flush(),e.addPadding(a-o-s)}class $ot{write(t){}pad(t){this.write(new Uint8Array(t))}finish(){return null}}class Bot extends $ot{constructor(){super(),this.buffers=[]}write(t){this.buffers.push(t)}finish(){const t=this.buffers,n=t.reduce((r,s)=>r+s.byteLength,0),i=new Uint8Array(n);for(let r=0,s=0;r<t.length;++r)i.set(t[r],s),s+=t[r].byteLength;return i}}const L4="stream",N4="file";function Got(e,{sink:t,format:n=L4}={}){if(n!==L4&&n!==N4)throw new Error(`Unrecognized Arrow IPC format: ${n}`);const{schema:i,dictionaries:r=[],records:s=[],metadata:o}=e,a=new bot(t||new Bot),l=n===N4,u=[],c=[];l&&a.addBuffer(vre),i&&wk(a,bb.Schema,Jre(a,i),0);for(const d of r){const{data:h}=d;wk(a,bb.DictionaryBatch,xot(a,d),h.byteLength,u),$4(a,h.buffers)}for(const d of s)wk(a,bb.RecordBatch,Zre(a,d),d.byteLength,c),$4(a,d.buffers);return a.addBuffer(ist),l&&Not(a,i,u,c,o),a.sink}function $4(e,t){for(let n=0;n<t.length;++n)e.addBuffer(t[n])}function zot(e,t){typeof t=="string"&&(t={format:t});const n=e.children;Hot(n);const{dictionaries:i,idMap:r}=Wot(n),s=qot(n),a={schema:Uot(e.schema,r),dictionaries:i,records:s};return Got(a,t).finish()}function Hot(e){const t=e[0]?.data.map(n=>n.length);e.forEach(({data:n})=>{if(n.length!==t.length||n.some((i,r)=>i.length!==t[r]))throw new Error("Columns have inconsistent batch sizes.")})}function Vot(){let e=0;const t=[],n=[],i=[],r=[];return{node(s,o){t.push({length:s,nullCount:o})},buffer(s){const o=s.byteLength,a=o+7&-8;n.push({offset:e,length:a}),e+=a,i.push(new Uint8Array(s.buffer,s.byteOffset,o))},variadic(s){r.push(s)},children(s,o){s.children.forEach((a,l)=>{nse(a.type,o.children[l],this)})},done(){return{byteLength:e,nodes:t,regions:n,variadic:r,buffers:i}}}}function Wot(e){const t=[],n=new Map,i=new Map;let r=-1;const s=o=>{if(n.has(o))i.set(o.type,n.get(o));else{n.set(o,++r);for(let a=0;a<o.data.length;++a)t.push({id:r,isDelta:a>0,data:tse([o],a)});i.set(o.type,r)}};return e.forEach(o=>TT(o.data[0],s)),{dictionaries:t,idMap:i}}function TT(e,t){if(e?.type.typeId===oe.Dictionary){const n=e.dictionary;t(n),TT(n.data[0],t)}e?.children?.forEach(n=>TT(n,t))}function Uot(e,t){if(!t.size)return e;const n=s=>{s.typeId===oe.Dictionary&&(s.id=t.get(s.dictionary),r(s)),s.children&&(s.children=s.children.slice()).forEach(i)},i=(s,o,a)=>{const l={...s.type};a[o]={...s,type:l},n(l)},r=s=>{const o={...s.dictionary};s.dictionary=o,n(o)};return e={...e,fields:e.fields.slice()},e.fields.forEach(i),e}function qot(e){return(e[0]?.data||[]).map((t,n)=>tse(e,n))}function tse(e,t=0){const n=Vot();return e.forEach(i=>{nse(i.type,i.data[t],n)}),n.done()}function nse(e,t,n){const{typeId:i}=e;if(i!==oe.Null)switch(n.node(t.length,t.nullCount),i){case oe.Bool:case oe.Int:case oe.Time:case oe.Duration:case oe.Float:case oe.Date:case oe.Timestamp:case oe.Decimal:case oe.Interval:case oe.FixedSizeBinary:case oe.Dictionary:n.buffer(t.validity),n.buffer(t.values);return;case oe.Utf8:case oe.LargeUtf8:case oe.Binary:case oe.LargeBinary:n.buffer(t.validity),n.buffer(t.offsets),n.buffer(t.values);return;case oe.BinaryView:case oe.Utf8View:n.buffer(t.validity),n.buffer(t.values),n.variadic(t.data.length),t.data.forEach(r=>n.buffer(r));return;case oe.List:case oe.LargeList:case oe.Map:n.buffer(t.validity),n.buffer(t.offsets),n.children(e,t);return;case oe.ListView:case oe.LargeListView:n.buffer(t.validity),n.buffer(t.offsets),n.buffer(t.sizes),n.children(e,t);return;case oe.FixedSizeList:case oe.Struct:n.buffer(t.validity),n.children(e,t);return;case oe.RunEndEncoded:n.children(e,t);return;case oe.Union:{n.buffer(t.typeIds),e.mode===Cre.Dense&&n.buffer(t.offsets),n.children(e,t);return}default:throw new Error(cE(i))}}function js(e){return new ise(e)}let ise=class{constructor(t=Ig){this.buf=new t(512)}array(t){return lst(this.buf,t)}prep(t){t>=this.buf.length&&(this.buf=Rre(this.buf,t))}get(t){return this.buf[t]}set(t,n){this.prep(n),this.buf[n]=t}write(t,n){this.prep(n+t.length),this.buf.set(t,n)}};function rse(){return new jot}class jot extends ise{set(t){const n=t>>3;this.prep(n),this.buf[n]|=1<<t%8}}class E${constructor(t,n){this.type=t,this.ctx=n,this.batchClass=n.batchType(t)}init(){return this.index=-1,this}set(t,n){return this.index=n,!1}done(){return null}batch(){const t=new this.batchClass(this.done());return this.init(),t}}class jo extends E${constructor(t,n){super(t,n)}init(){return this.nullCount=0,this.validity=rse(),super.init()}set(t,n){this.index=n;const i=t!=null;return i?this.validity.set(n):this.nullCount++,i}done(){const{index:t,nullCount:n,type:i,validity:r}=this;return{length:t+1,nullCount:n,type:i,validity:n?r.array((t>>3)+1):new Ig(0)}}}function Kot(){const e=new Map,t=new Set;return{get(n,i){const r=n.id;if(r>=0&&e.has(r))return e.get(r);{const s=Yot(n,i);return r>=0&&e.set(r,s),t.add(s),s}},finish(n){t.forEach(i=>i.finish(n))}}}function Yot(e,t){const n=Object.create(null),i=t.builder(e.dictionary),r=[];i.init();let s=-1;return{type:e,values:i,add(o){return r.push(o),o},key(o){const a=fE(o);let l=n[a];return l===void 0&&(n[a]=l=++s,i.set(o,l)),l},finish(o){const a=e.dictionary,l=new(Qre(a,o))(i.done()),u=new S$([l]);r.forEach(c=>c.setDictionary(u))}}}class Xot extends jo{constructor(t,n){super(t,n),this.dict=n.dictionary(t)}init(){return this.values=js(this.type.indices.values),super.init()}set(t,n){super.set(t,n)&&this.values.set(this.dict.key(t),n)}done(){return{...super.done(),values:this.values.array(this.index+1)}}batch(){return this.dict.add(super.batch())}}function Qot(e){const t=IT();return e(n=>t.add(n)),t.type()}function IT(){let e=0,t=0,n=0,i=0,r=0,s=0,o=0,a=0,l=0,u=0,c=0,d=1/0,h=-1/0,p=1/0,g=-1/0,m,C,y,b={};return{add(S){if(e++,S==null){t++;return}switch(typeof S){case"string":l++;break;case"number":i++,S<d&&(d=S),S>h&&(h=S),Number.isInteger(S)&&r++;break;case"bigint":s++,m===void 0?m=C=S:(S<m&&(m=S),S>C&&(C=S));break;case"boolean":n++;break;case"object":if(S instanceof Date)o++,+S%864e5===0&&a++;else if(Sre(S)){u++;const x=S.length;x<p&&(p=x),x>g&&(g=x),y??=IT(),S.forEach(y.add)}else{c++;for(const x in S)(b[x]??(b[x]=IT())).add(S[x])}}},type(){const S=e-t;return S===0?fst():r===S?Jot(d,h):i===S?y$():s===S?eat(m,C):n===S?wst():a===S?Sst():o===S?xst():l===S?hst(yst()):u===S?Zot(y.type(),p,g):c===S?Est(Object.entries(b).map(x=>dE(x[0],x[1].type()))):tat()}}}function Zot(e,t,n){return n===t?Fst(e,t):Rst(e)}function Jot(e,t){const n=Math.max(Math.abs(e)-1,t);return n<128?Pre():n<32768?Mre():n<2**31?C$():y$()}function eat(e,t){const n=-e>t?-e-1n:t;if(n>=2**63)throw new Error(`BigInt exceeds 64 bits: ${n}`);return Tre()}function tat(){throw new Error("Mixed types detected, please define a union type.")}class sse extends jo{constructor(t,n){super(t,n),this.toOffset=Ore(t.offsets)}init(){return this.offsets=js(this.type.offsets),this.values=js(),this.pos=0,super.init()}set(t,n){const{offsets:i,values:r,toOffset:s}=this;super.set(t,n)&&(r.write(t,this.pos),this.pos+=t.length),i.set(s(this.pos),n+1)}done(){return{...super.done(),offsets:this.offsets.array(this.index+2),values:this.values.array(this.pos+1)}}}class nat extends jo{constructor(t,n){super(t,n)}init(){return this.values=rse(),super.init()}set(t,n){super.set(t,n),t&&this.values.set(n)}done(){return{...super.done(),values:this.values.array((this.index>>3)+1)}}}class iat extends jo{constructor(t,n){super(t,n),this.scale=10**t.scale,this.stride=t.bitWidth>>6}init(){return this.values=js(this.type.values),super.init()}set(t,n){const{scale:i,stride:r,values:s}=this;super.set(t,n)&&(s.prep((n+1)*r),Ist(t,s.buf,n*r,r,i))}done(){const{index:t,stride:n,values:i}=this;return{...super.done(),values:i.array((t+1)*n)}}}class rat extends jo{constructor(t,n){super(t,n),this.stride=t.stride}init(){return this.values=js(),super.init()}set(t,n){super.set(t,n)&&this.values.write(t,n*this.stride)}done(){const{stride:t,values:n}=this;return{...super.done(),values:n.array(t*(this.index+1))}}}class sat extends jo{constructor(t,n){super(t,n),this.child=n.builder(this.type.children[0].type),this.stride=t.stride}init(){return this.child.init(),super.init()}set(t,n){const{child:i,stride:r}=this,s=n*r;if(super.set(t,n))for(let o=0;o<r;++o)i.set(t[o],s+o);else i.index=s+r}done(){const{child:t}=this;return{...super.done(),children:[t.batch()]}}}class oat extends jo{init(){return this.values=js(this.type.values),super.init()}set(t,n){if(super.set(t,n)){const i=n<<1;this.values.set(t[0],i),this.values.set(t[1],i+1)}}done(){return{...super.done(),values:this.values.array(this.index+1<<1)}}}class aat extends jo{init(){return this.values=js(),super.init()}set(t,n){super.set(t,n)&&this.values.write(Tst(t),n<<4)}done(){return{...super.done(),values:this.values.array(this.index+1<<4)}}}class ose extends jo{constructor(t,n,i){super(t,n),this.child=i}init(){this.child.init();const t=this.type.offsets;return this.offsets=js(t),this.toOffset=Ore(t),this.pos=0,super.init()}done(){return{...super.done(),offsets:this.offsets.array(this.index+2),children:[this.child.batch()]}}}class lat extends ose{constructor(t,n){super(t,n,n.builder(t.children[0].type))}set(t,n){const{child:i,offsets:r,toOffset:s}=this;super.set(t,n)&&t.forEach(o=>i.set(o,this.pos++)),r.set(s(this.pos),n+1)}}class ase extends jo{constructor(t,n){super(t,n),this.children=t.children.map(i=>n.builder(i.type))}init(){return this.children.forEach(t=>t.init()),super.init()}done(){const{children:t}=this;return t.forEach(n=>n.index=this.index),{...super.done(),children:t.map(n=>n.batch())}}}class uat extends ase{constructor(t,n){super(t,n),this.setters=this.children.map((i,r)=>{const s=t.children[r].name;return(o,a)=>i.set(o?.[s],a)})}set(t,n){super.set(t,n);const i=this.setters;for(let r=0;r<i.length;++r)i[r](t,n)}}class cat extends ose{constructor(t,n){super(t,n,new dat(t.children[0].type,n))}set(t,n){const{child:i,offsets:r,toOffset:s}=this;if(super.set(t,n))for(const o of t)i.set(o,this.pos++);r.set(s(this.pos),n+1)}}class dat extends ase{set(t,n){super.set(t,n);const[i,r]=this.children;i.set(t[0],n),r.set(t[1],n)}}const hat={};class fat extends E${constructor(t,n){super(t,n),this.children=t.children.map(i=>n.builder(i.type))}init(){return this.pos=0,this.key=null,this.value=hat,this.children.forEach(t=>t.init()),super.init()}next(){const[t,n]=this.children;t.set(this.index+1,this.pos),n.set(this.value,this.pos++)}set(t,n){if(t!==this.value){const i=fE(t);i!==this.key&&(this.key&&this.next(),this.key=i,this.value=t)}this.index=n}done(){this.next();const{children:t,index:n,type:i}=this;return{length:n+1,nullCount:0,type:i,children:t.map(r=>r.batch())}}}class lse extends E${constructor(t,n){super(t,n),this.children=t.children.map(i=>n.builder(i.type)),this.typeMap=t.typeMap,this.lookup=t.typeIdForValue}init(){return this.nullCount=0,this.typeIds=js(g$),this.children.forEach(t=>t.init()),super.init()}set(t,n){const{children:i,lookup:r,typeMap:s,typeIds:o}=this;this.index=n;const a=r(t,n),l=i[s[a]];o.set(a,n),t==null&&++this.nullCount,this.update(t,n,l)}done(){const{children:t,nullCount:n,type:i,typeIds:r}=this,s=this.index+1;return{length:s,nullCount:n,type:i,typeIds:r.array(s),children:t.map(o=>o.batch())}}}class pat extends lse{update(t,n,i){i.set(t,n),this.children.forEach(r=>{r!==i&&r.set(null,n)})}}class gat extends lse{init(){return this.offsets=js(this.type.offsets),super.init()}update(t,n,i){const r=i.index+1;i.set(t,r),this.offsets.set(r,n)}done(){return{...super.done(),offsets:this.offsets.array(this.index+1)}}}class mat extends sse{set(t,n){super.set(t&&Lre(t),n)}}class Bv extends jo{constructor(t,n){super(t,n),this.values=js(t.values)}init(){return this.values=js(this.type.values),super.init()}set(t,n){super.set(t,n)&&this.values.set(t,n)}done(){return{...super.done(),values:this.values.array(this.index+1)}}}class vat extends Bv{set(t,n){super.set(t==null?t:Rl(t),n)}}class bk extends Bv{constructor(t,n,i){super(t,n),this.transform=i}set(t,n){super.set(t==null?t:this.transform(t),n)}}function use(e={},t=Kot()){return{batchType:n=>Qre(n,e),builder(n){return cse(n,this)},dictionary(n){return t.get(n,this)},finish:()=>t.finish(e)}}function cse(e,t=use()){const{typeId:n}=e;switch(n){case oe.Int:case oe.Time:case oe.Duration:return m$(e.values)?new vat(e,t):new Bv(e,t);case oe.Float:return e.precision?new Bv(e,t):new bk(e,t,Lst);case oe.Binary:case oe.LargeBinary:return new sse(e,t);case oe.Utf8:case oe.LargeUtf8:return new mat(e,t);case oe.Bool:return new nat(e,t);case oe.Decimal:return new iat(e,t);case oe.Date:return new bk(e,t,e.unit?Rl:Pst);case oe.Timestamp:return new bk(e,t,Mst(e.unit));case oe.Interval:switch(e.unit){case B0.DAY_TIME:return new oat(e,t);case B0.MONTH_DAY_NANO:return new aat(e,t)}return new Bv(e,t);case oe.List:case oe.LargeList:return new lat(e,t);case oe.Struct:return new uat(e,t);case oe.Union:return e.mode?new gat(e,t):new pat(e,t);case oe.FixedSizeBinary:return new rat(e,t);case oe.FixedSizeList:return new sat(e,t);case oe.Map:return new cat(e,t);case oe.RunEndEncoded:return new fat(e,t);case oe.Dictionary:return new Xot(e,t)}throw new Error(cE(n))}function dse(e,t,n={},i){const r=cst(e)?l=>{for(const u of e)l(u)}:e;t??=Qot(r);const{maxBatchRows:s=1/0,...o}=n;let a;if(t.typeId===oe.Null){let l=0;r(()=>++l),a=Cat(t,l,s)}else{const l=use(o,i),u=cse(t,l).init(),c=h=>a.push(h.batch());a=[];let d=0;r(h=>{u.set(h,d++),d>=s&&(c(u),d=0)}),d&&c(u),l.finish()}return new S$(a,t)}function Cat(e,t,n){const i=[],r=a=>new Gre({length:a,nullCount:a,type:e}),s=Math.floor(t/n);for(let a=0;a<s;++a)i.push(r(n));const o=t%n;return o&&i.push(r(o)),i}function yat(e,t,n={},i){return!t&&bre(e)?wat(e,n):dse(r=>e.forEach(r),t,n,i)}function wat(e,{maxBatchRows:t,useBigInt:n}){const i=e.constructor,r=bat(i),s=e.length,o=Math.min(t||1/0,s),a=Math.floor(s/o),l=[],u=m$(i)&&!n?zh:$v,c=(h,p)=>l.push(new u({length:p-h,nullCount:0,type:r,validity:new Ig(0),values:e.subarray(h,p)}));let d=0;for(let h=0;h<a;++h)c(d,d+=o);return d<s&&c(d,s),new S$(l)}function bat(e){switch(e){case wre:return Cst();case HC:return y$();case g$:return Pre();case yre:return Mre();case _g:return C$();case Og:return Tre();case Ig:return pst();case h$:return gst();case f$:return mst();case p$:return vst()}}function Sat(e,t){const n=[],i=Array.isArray(e)?e:Object.entries(e),r=i[0]?.[1].length,s=i.map(([a,l])=>{if(l.length!==r)throw new Error("All columns must have the same length.");return n.push(dE(a,l.type)),l}),o={version:N0.V5,endianness:rst.Little,fields:n,metadata:null};return new x$(o,s,t)}function UC(e,t){return Ri(t)?t(e):t||e.columnNames()}function hse(e,t={}){const{columns:n,limit:i=1/0,offset:r=0,types:s={},...o}=t,a=UC(e,n),l=e.data(),u=r===0&&e.numRows()<=i&&!e.isFiltered()&&!e.isOrdered();return Sat(a.map(c=>{const d=l[c],h=s[c],p=Lc(d);let g;if(u&&(p||Ri(d.toArray)))g=yat(p?d:d.toArray(),h,o);else{const m=p?C=>d[C]:C=>d.at(C);g=dse(C=>e.scan(y=>C(m(y)),!0,i,r),h,o)}return[c,g]}))}function xat(e,t={}){const{format:n="stream",...i}=t;return zot(hse(e,i),{format:n})}function gh(e){return e}function F$(e,t,n=100,i,r){const{start:s=gh,cell:o,end:a=gh}=r,l=e.data(),u=t.length;e.scan(c=>{s(c);for(let d=0;d<u;++d){const h=t[d];o(l[h].at(c),h,d)}a(c)},!0,n,i)}function Rat(e,t={}){const n=UC(e,t.columns),i=t.format||{},r=t.delimiter||",",s=t.header??!0,o=new RegExp(`["${r}
\r]`),a=c=>c==null?"":gc(c)?tE(c,!0):o.test(c+="")?'"'+c.replace(/"/g,'""')+'"':c,l=n.map(a);let u=s?l.join(r)+`
`:"";return F$(e,n,t.limit||1/0,t.offset,{cell(c,d,h){l[h]=a(i[d]?i[d](c):c)},end(){u+=l.join(r)+`
`}}),u}function Eat(e,t,n={}){for(const i in e)n[i]=t(e[i],i);return n}function Fat(e){return e.getUTCHours()===0&&e.getUTCMinutes()===0&&e.getUTCSeconds()===0&&e.getUTCMilliseconds()===0}function Aat(e,t={}){let n=0,i=0,r=0,s=0,o=0,a=0;return e(l=>{if(++n,l==null){++i;return}const u=typeof l;if(u==="object"&&gc(l))++r,Fat(l)&&++s;else if(u==="number"&&(++o,l===l&&(l|0)!==l)){const c=l+"",d=c.indexOf(".");if(d>=0){const h=c.indexOf("e"),p=h>0?h:c.length;a=Math.max(a,p-d-1)}}}),{align:(i+o+r)/n>.5?"r":"l",format:{utc:r===s,digits:Math.min(a,t.maxdigits||6)}}}function fse(e,t,n){const i=n.format||{},r=n.align||{},s={},o={};return t.forEach(a=>{const l=Aat(Dat(e,a),n);o[a]=r[a]||l.align,s[a]=i[a]||l.format}),{align:o,format:s}}function Dat(e,t){const n=e.column(t);return i=>e.scan(r=>i(n.at(r)))}function pse(e,t={}){if(Ri(t))return t(e)+"";const n=typeof e;if(n==="object"){if(gc(e))return t.utc?tE(e):Tne(e);{const i=JSON.stringify(e,(s,o)=>eE(o)?Array.from(o):o),r=t.maxlen||30;return i.length>r?i.slice(0,28)+""+(i[0]==="["?"]":"}"):i}}else if(n==="number"){const i=t.digits||0;let r;return e!==0&&((r=Math.abs(e))>=1e18||r<Math.pow(10,-i))?e.toExponential(i):e.toFixed(i)}else return e+""}function kat(e,t={}){const n=UC(e,t.columns),{align:i,format:r}=fse(e,n,t),s=Pat(t),o=t.null,a=m=>m==="c"?"center":m==="r"?"right":"left",l=m=>m.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),u=(m,C)=>l(pse(m,C)),c=o?(m,C)=>m==null?o(m):u(m,C):u;let d=-1,h=-1;const p=(m,C,y)=>{const b=y?a(i[C]):"",S=s[m]&&s[m](C,h,d)||"",x=(b?`text-align: ${b};`+(S?" ":""):"")+S;return`<${m}${x?` style="${x}"`:""}>`};let g=p("table")+p("thead")+p("tr",d)+n.map(m=>`${p("th",m,1)}${m}</th>`).join("")+"</tr></thead>"+p("tbody");return F$(e,n,t.limit,t.offset,{start(m){d=m,++h,g+=p("tr")},cell(m,C){g+=p("td",C,1)+c(m,r[C])+"</td>"},end(){g+="</tr>"}}),g+"</tbody></table>"}function Pat(e){return Eat(e.style,t=>Ri(t)?t:()=>t)}const B4={},yf={},Hw=34,Lm=10,G4=13,Mat="columns",Tat="ndjson",Iat=e=>gc(e)?tE(e,!0):e;function _at(e,{type:t,columns:n,format:i={},limit:r,offset:s}={}){const o=UC(e,n),a=o.map(u=>i[u]||Iat),l=u=>e.scan(u,!0,r,s);return t===Mat?Oat(e,o,a,l):Lat(e,o,a,l,t===Tat)}function Oat(e,t,n,i){let r="{";return t.forEach((s,o)=>{r+=(o?",":"")+JSON.stringify(s)+":[";const a=e.column(s),l=n[o];let u=-1;i(c=>{const d=a.at(c);r+=(++u?",":"")+JSON.stringify(l(d))}),r+="]"}),r+"}"}function Lat(e,t,n,i,r=!1){const s=t.length,o=t.map(h=>`"${h}":`),a=t.map(h=>e.column(h)),l=r?h=>h.replaceAll(`
`,""):gh,u=r?`
`:",";let c=r?"":"[",d=-1;return i(h=>{const p=[];for(let g=0;g<s;++g)p.push(o[g]+JSON.stringify(n[g](a[g].at(h))));c+=(++d?u:"")+l(`{${p.join(",")}}`)}),c+(r?"":"]")}function Nat(e,t={}){const n=UC(e,t.columns),{align:i,format:r}=fse(e,n,t),s=l=>l==="c"?":-:":l==="r"?"-:":":-",o=l=>l.replace(/\|/g,"\\|");let a="|"+n.map(o).join("|")+`|
|`+n.map(l=>s(i[l])).join("|")+`|
`;return F$(e,n,t.limit,t.offset,{start(){a+="|"},cell(l,u){a+=o(pse(l,r[u]))+"|"},end(){a+=`
`}}),a}class gse extends DT{assign(...t){return Wit(this,...t)}count(t={}){const{as:n="count"}=t;return L0(this,{[n]:$ne()})}derive(t,n){return Jit(this,t,n)}filter(t){return c$(this,t)}slice(t,n){return Qrt(this,t,n)}groupby(...t){return o$(this,...t)}orderby(...t){return Prt(this,...t)}relocate(t,n){return lre(this,Oa(t),n)}rename(...t){return Brt(this,...t)}reduce(t){return $rt(this,t)}rollup(t){return L0(this,t)}sample(t,n){return qrt(this,t,n)}select(...t){return ore(this,...t)}ungroup(){return lE(this)}unorder(){return nst(this)}dedupe(...t){return aE(this,...t)}impute(t,n){return hrt(this,t,n)}fold(t,n){return crt(this,t,n)}pivot(t,n,i){return Irt(this,t,n,i)}spread(t,n){return Zrt(this,t,n)}unroll(t,n){return urt(this,t,n)}lookup(t,n,...i){return Ert(this,t,n,...i)}join(t,n,i,r){return cv(this,t,n,i,r)}join_left(t,n,i,r){const s={...r,left:!0,right:!1};return cv(this,t,n,i,s)}join_right(t,n,i,r){const s={...r,left:!1,right:!0};return cv(this,t,n,i,s)}join_full(t,n,i,r){const s={...r,left:!0,right:!0};return cv(this,t,n,i,s)}cross(t,n,i){return Crt(this,t,n,i)}semijoin(t,n){return hre(this,t,n)}antijoin(t,n){return fre(this,t,n)}concat(...t){return are(this,...t)}union(...t){return tst(this,...t)}intersect(...t){return grt(this,...t)}except(...t){return lrt(this,...t)}toArrow(t){return hse(this,t)}toArrowIPC(t){return xat(this,t)}toCSV(t){return Rat(this,t)}toHTML(t){return kat(this,t)}toJSON(t){return _at(this,t)}toMarkdown(t){return Nat(this,t)}}function $at(e){const t=e.slice(-3).toLowerCase();return t===".gz"?"gzip":t===".zz"?"deflate":null}async function Bat(e,{fetch:t=void 0,decompress:n=$at(e)}={}){const i=await fetch(e,t).then(r=>r.body);return n?i.pipeThrough(new DecompressionStream(n)):i}function Gat(e){if(Ri(e[Symbol.asyncIterator]))return e[Symbol.asyncIterator]();{const t=e.getReader();return{next(){return t.read()},[Symbol.asyncIterator](){return this}}}}function zat(e){return e.slice(1,-1).replace(/""/g,'"')}function Hat(e=","){e.length!==1&&pn(`Text delimiter should be a single character, found "${e}"`);const t=e.charCodeAt(0);let n=0,i=0,r=!1,s=!1,o=!1,a=!1,l=null,u=null,c=[];function d(p){u=u?u+p:p}function h(){if(r)return r=!1,B4;const p=n;let g;if(o||l.charCodeAt(p)===Hw){let C=a&&l.charCodeAt(p)!==Hw;if(a=!1,o=!0,!C){for(;++n<i;)if(l.charCodeAt(n)===Hw)if(++n<i){if(l.charCodeAt(n)!==Hw){C=!0;break}}else return d(l.slice(p,i)),a=!0,yf;if(!C)return d(l.slice(p,i)),yf}const y=zat((u??"")+l.slice(p,n));return o=!1,u=null,n>=i?(u=y,yf):(g=l.charCodeAt(n++),g===Lm?r=!0:g===G4&&(r=!0,n>=i?s=!0:l.charCodeAt(n)===Lm&&++n),y)}let m;for(;n<i;){if(g=l.charCodeAt(m=n++),g===Lm)r=!0;else if(g===G4)r=!0,n>=i?s=!0:l.charCodeAt(n)===Lm&&++n;else if(g!==t)continue;return l.slice(p,m)}return d(l.slice(p,i)),yf}return{start(){},transform(p,g){l=p,i=l.length,n=0;const m=[];let C;if(s&&(l.charCodeAt(n)===Lm&&++n,s=!1),u!=null)if((C=h())===yf){g.enqueue(m);return}else c.push((u??"")+C),u=null;for(;;)if((C=h())===yf){g.enqueue(m);return}else C===B4?(m.push(c),c=[]):c.push(C)},flush(p){(c.length||u)&&(u!=null&&c.push(u),p.enqueue([c]))}}}function Vat(e,t,n){return e>0?t?(i,r)=>r<e||n(i).startsWith(t):(i,r)=>r<e:t?i=>n(i).startsWith(t):null}function Wat(e,t,n=gh){const i=Vat(e,t,n);if(!i)return null;let r=0;return{start(){},flush(){},transform(s,o){const a=s.length,l=new NN(a);for(let u=0;u<s.length;++u,++r)i(s[u],r)&&l.set(u);o.enqueue(l.count()?s.filter((u,c)=>!l.get(c)):s)}}}const Uat=[e=>e==="true"||e==="false",e=>e!=="false"],z4=[e=>e==="NaN"||(e=+e)===e,e=>+e],qat=[Ine,e=>new Date(Date.parse(e))];function jat(e){return e&&e!=="."?z4.map(t=>n=>t(n&&n.replace(e,"."))):z4}function Kat(e,t){const{decimal:n,limit:i=e.length}=t,r=[Uat,jat(n),qat],s=r.length;for(let o=0;o<s;++o){const[a,l]=r[o];if(Yat(e,a,i))return l}return gh}function Yat(e,t,n){for(let i=0;i<n;++i){const r=e[i];if(r!=null&&!t(r))return!1}return!0}function Xat(e,t){let n=e;return t.forEach(i=>{i&&(n=n.pipeThrough(new TransformStream(i)))}),n}function Qat(e,t){const n={};return e.forEach((i,r)=>n[i]=t[r]),new gse(n,e)}async function Zat(e,t,n={}){const i=Xat(e,t),r=+n.autoMax||1e3,s=Gat(i),o=[];let a=0;for(;a<r;){const h=await s.next(),p=h.value;if(p?.length>0&&(o.push(p),a+=p.length),h.done)break}const{names:l,values:u,parsers:c}=Jat(o,n),d=l.length;for await(const h of s)for(let p=0;p<h.length;++p){const g=h[p];for(let m=0;m<d;++m)u[m].push(g[m]?c[m](g[m]):null)}return Qat(l,u)}function Jat(e,t){const[n]=e,i=n[0].length,r=+t.autoMax||1e3,s=Eg(i,()=>[]);let o=t.header!==!1?n.shift():t.names;o=o?o.length<i?[...o,H4(i,o.length)]:o:H4(i);for(const l of e)for(let u=0;u<l.length;++u){const c=l[u];for(let d=0;d<i;++d)s[d].push(c[d]===""?null:c[d])}const a=elt(o,s,{...t,limit:r});return a.forEach((l,u)=>{if(l===gh)return;const c=s[u];for(let d=0;d<c.length;++d)c[d]!=null&&(c[d]=l(c[d]))}),{names:o,values:s,parsers:a}}function H4(e,t=0){return Eg(e-t,n=>`col${n+t+1}`)}function elt(e,t,n){const{parse:i={}}=n,r=n.autoType===!1;return e.map((s,o)=>Ri(i[s])?i[s]:r?gh:Kat(t[o],n))}async function tlt(e,t){return(await Bat(e,t)).pipeThrough(new TextDecoderStream)}async function nlt(e,t){return Zat(e,rlt(t),t)}async function ilt(e,t){return nlt(await tlt(e,t),t)}function rlt({delimiter:e=",",skip:t=0,comment:n=void 0}={}){return[Hat(e),Wat(t,n,i=>i[0])]}function V4(e,t={}){const n=`d[${JSON.stringify(e)}]`,{maxbins:i,nice:r,minstep:s,step:o,offset:a}=t,l=[i,r,s,o];let u=l.length;for(;u&&l[--u]==null;)l.pop();const c=l.length?", "+l.map(d=>d+"").join(", "):"";return`d => op.bin(${n}, ...op.bins(${n}${c}), ${a||0})`}function Sk(e){return s$(e,{escape:!0,toString(){pn("Escaped values can not be serialized.")}})}function slt(e,t,n){return s$(e,{window:{frame:t||[-1/0,0],peers:!1}})}function W4(e,t){return L0(lE(e),{_:t}).get("_")}function olt(e,t){const n=i=>pn(`Illegal argument type: ${i||typeof e}`);return e instanceof Map?U4(e.entries(),t):gc(e)?n("Date"):E1(e)?n("RegExp"):qo(e)?n():pr(e)?alt(e,t):Ri(e[Symbol.iterator])?llt(e,t):mc(e)?U4(Object.entries(e),t):n()}function U4(e,t=["key","value"]){const n=[],i=[];for(const[s,o]of e)n.push(s),i.push(o);const r={};return t[0]&&(r[t[0]]=n),t[1]&&(r[t[1]]=i),r}function alt(e,t){const n=e.length,i={},r=s=>i[s]=Array(n);if(n){t=t||Object.keys(e[0]);const s=t.map(r),o=s.length;for(let a=0;a<n;++a){const l=e[a];for(let u=0;u<o;++u)s[u][a]=l[t[u]]}}else t&&t.forEach(r);return i}function llt(e,t){const n={},i=o=>n[o]=[];let r,s;for(const o of e){r||(t=t||Object.keys(o),r=t.map(i),s=r.length);for(let a=0;a<s;++a)r[a].push(o[t[a]])}return!r&&t&&t.forEach(i),n}function q4(e,t){return new gse(olt(e,t),t)}const ult=Efe("DataSourcesStore",()=>{const e=Qe({}),t=Qe(!0);async function n(l){t.value=!0;const u=l.map(c=>i(c));await Promise.all(u),t.value=!1}async function i(l){const u=r(l.name);if(u&&UM.isEqual(u.source,l))return;let c=",";l.source.endsWith(".tsv")&&(c="	");const d=await ilt(l.source,{delimiter:c});e.value[l.name]={source:l,dest:d}}function r(l){return l in e.value?e.value[l]??null:null}function s(l,u){if(t.value)return null;const c=new Map;for(const h of l){const p=r(h);if(p===null)throw new Error(`key not found in data sources: [${h}]`);c.set(h,q4(p.dest.reify()))}return o(c,u??[]).objects()}function o(l,u){console.log("perform data transforations");const c=l.keys().next().value??"",d=l.get(c);if(!d)throw new Error("table not found");const h={key:c,table:d},p=m=>{const C=m?l.get(m):h.table;if(!C)throw new Error("in table not found");return C},g=m=>{m.out?h.key=m.out:m.in&&!Array.isArray(m.in)&&(h.key=m.in),l.set(h.key,h.table)};for(const m of u){if("groupby"in m){const C=p(m.in);Array.isArray(m.groupby)?h.table=C.groupby(...m.groupby):h.table=C.groupby(m.groupby)}else if("binby"in m){const C=p(m.in),{field:y,bins:b=10,nice:S=!0}=m.binby,{bin_start:x="start",bin_end:E="end"}=m.binby.output??{bin_start:"start",bin_end:"end"},A={};A[x]=V4(y,{maxbins:b,nice:S}),A[E]=V4(y,{maxbins:b,nice:S,offset:1}),h.table=C.groupby(A)}else if("rollup"in m){const C=p(m.in),y={},b=[];for(const[S,x]of Object.entries(m.rollup))y[S]=a(x),x.op==="frequency"&&b.push(S);h.table=C.rollup(y);for(const S of b){const x={};x[S]=(E,A)=>E[A.freqKey]/ta.sum(E[A.freqKey]),h.table=h.table.params({freqKey:S}).derive(x)}}else if("orderby"in m){const C=p(m.in);h.table=C.orderby(m.orderby)}else if("derive"in m){const C=p(m.in),y=UM.cloneDeep(m.derive);for(const[b,S]of Object.entries(y))typeof S!="string"&&(y[b]=slt(S.rolling.expression,S.rolling.window));h.table=C.derive(y)}else if("filter"in m){const C=p(m.in);h.table=C.filter(m.filter)}else if("join"in m){const[C,y]=m.in,b=l.get(C),S=l.get(y);if(!b||!S)throw new Error("join table not found");if(typeof m.join.on=="string"||m.join.on.every(x=>typeof x=="string"))h.table=b.join(S,m.join.on);else{const[x,E]=m.join.on;if(x.length!==E.length)throw new Error("left and right multi keys must be the same length");h.table=b.params({leftMultiKeys:m.join.on[0]}).derive({udi_internal_multi_key_join:Sk((A,F)=>F.leftMultiKeys.map(P=>A[P]).join(""))}).join(S.params({rightMultiKeys:m.join.on[1]}).derive({udi_internal_multi_key_join:Sk((A,F)=>F.rightMultiKeys.map(P=>A[P]).join(""))}),"udi_internal_multi_key_join")}}else if("kde"in m){const C=p(m.in),{field:y,samples:b}=m.kde;let{bandwidth:S}=m.kde;S==null&&(S=Pne(C.array(y),M=>M)),S=S??1;const{sample:x="sample",density:E="density"}=m.kde.output??{sample:"sample",density:"density"};let A;const F=W4(C,ta.min(y))-S*3,P=W4(C,ta.max(y))+S*3;console.log({minVal:F,maxVal:P});const D=C.partitions();for(let M=0;M<D.length;M++){const O=D[M];if(!O)throw new Error("partition is undefined");const B=O.map(L=>C.get(y,L)),H=TJe(B,{bandwidth:S,bins:b,extent:[F,P]}).points();let N=q4(H);if(N=N.rename({x,y:E}),C.isGrouped()){const L=C.groups();for(let G=0;G<L.names.length;G++){const q=L.names[G];if(q==null)throw new Error("name is undefined");const V=L.get[G],U=L.rows[M];if(U==null)throw new Error("rowIndex is undefined");const ie=V(U);N=N.derive({[q]:Sk(ie)})}}A?A=A.concat(N):A=N}if(!A)throw new Error("kdeTable is undefined");h.table=A}g(m)}return h.table}function a(l){switch(l.op){case"count":return ta.count();case"sum":if(!l.field)throw new Error("Field is required for sum operation");return ta.sum(l.field);case"min":if(!l.field)throw new Error("Field is required for min operation");return ta.min(l.field);case"median":if(!l.field)throw new Error("Field is required for median operation");return ta.median(l.field);case"max":if(!l.field)throw new Error("Field is required for max operation");return ta.max(l.field);case"mean":return ta.mean(l.field);case"frequency":return ta.count();default:throw new Error("unsupported Aggregate Function"+JSON.stringify(l))}}return{dataSources:e,loading:t,initDataSources:n,getDataObject:s}}),clt={key:0,class:"error-message"},dlt={key:1},hlt=mh({__name:"UDIVis",props:{spec:{}},setup(e){const t=ult(),{loading:n}=Ffe(t),i=e,r=Qe(null),s=Qe(!1),o=Qe("");Cc(()=>{a()});async function a(){r.value=EJe(i.spec),await t.initDataSources(r.value.source),l()}Yt(()=>i.spec,()=>{a()}),Yt(n,()=>l());function l(){r.value&&(h(r.value),d.value!=null&&(u(r.value)?(o.value=p(r.value),s.value=!0):s.value=!1))}function u(m){return!m.representation.map(C=>C.mark).includes("row")}const c=Qe(),d=Qe(null);function h(m){d.value=null;try{c.value=null,d.value=t.getDataObject(m.source.map(C=>C.name),m.transformation)}catch(C){console.error("Failed to complete data transformation",C),c.value=C}}function p(m){const C={$schema:"https://vega.github.io/schema/vega-lite/v5.json",data:{values:[]}};try{c.value=null,C.data.values=d.value}catch(S){console.error("Failed to complete data transformation",S),c.value=S}g.value=C.data.values;const y=m.representation;if(!Array.isArray(y))throw new Error("invalid spec passed to vega conversion");const b=y.map(S=>{const x=Array.isArray(S.mapping)?S.mapping:[S.mapping],E={};for(const A of x){const{encoding:F}=A;if("value"in A)E[F]={value:A.value};else{const P=A.field.replace(/\./g,"\\.");E[F]={field:P,type:A.type}}(F==="x"||F==="y"||F==="size")&&(E[F].scale={zero:!1}),S.mark==="area"&&F==="y"&&(E[F].stack=!1)}return{mark:S.mark,encoding:E}});return C.layer=b,JSON.stringify(C)}const g=Qe();return(m,C)=>Y4(t).loading?(Dn(),hi("p",dlt,"Loading...")):(Dn(),hi(Gv,{key:0},[c.value?(Dn(),hi("div",clt,O1(c.value.message),1)):s.value?(Dn(),xb(r5e,{key:1,spec:o.value},null,8,["spec"])):(Dn(),xb(RJe,{key:2,data:d.value,spec:r.value},null,8,["data","spec"]))],64))}}),flt=L1(hlt,[["__scopeId","data-v-497ad03b"]]),plt={key:1},glt=mh({__name:"EditorPage",setup(e){const t=Bfe(),n={automaticLayout:!0,formatOnType:!0,formatOnPaste:!0},i=Qe(`{
  "source": {
    "name": "donors",
    "source": "./data/example_donors.csv"
  },
  "representation": {
    "mark": "point",
    "mapping": [
      { "encoding": "y", "field": "height", "type": "quantitative" },
      { "encoding": "x", "field": "weight", "type": "quantitative" }
    ]
  }
}`),r=Afe();if(r.query.spec)try{i.value=Gfe.decompressFromEncodedURIComponent(r.query.spec)}catch(p){console.error("Failed to decode spec from URL parameter:",p)}const s=Dfe(),o=Qe(50);function a(p){s.value=p}const l=Le(()=>JSON.parse(i.value)),u=Le(()=>{try{return JSON.parse(i.value),""}catch(p){return p instanceof Error?p.message:"Error parsing specification."}}),c=Le(()=>{try{return JSON.parse(i.value),!0}catch{return!1}}),d=Qe(!1),h=Le(()=>t.getUrlWithCode(i.value,!0));return(p,g)=>{const m=kfe("vue-monaco-editor");return Dn(),hi(Gv,null,[jr($fe,{dense:"",flat:""},{default:yu(()=>[jr(i3,{dense:"",flat:"","no-caps":"",onClick:g[0]||(g[0]=C=>d.value=!0),icon:"share",label:"Share"}),jr(Hpe,{modelValue:d.value,"onUpdate:modelValue":g[3]||(g[3]=C=>d.value=C)},{default:yu(()=>[jr(zfe,{style:{width:"100%"}},{default:yu(()=>[jr(Cpe,null,{default:yu(()=>[g[6]||(g[6]=K4("div",{class:"text-h6"},"Copy Link To Example",-1)),jr(vpe,{modelValue:h.value,"onUpdate:modelValue":g[1]||(g[1]=C=>h.value=C),readonly:"",filled:"",class:"q-mt-md"},null,8,["modelValue"])]),_:1}),jr(Hfe,{align:"right"},{default:yu(()=>[jr(i3,{flat:"",label:"Close",onClick:g[2]||(g[2]=C=>d.value=!1)})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),jr(Vfe),jr(Ufe,{class:"flex row"},{default:yu(()=>[jr(Kpe,{modelValue:o.value,"onUpdate:modelValue":g[5]||(g[5]=C=>o.value=C),class:"flex-grow-1 q-mt-lg"},{before:yu(()=>[jr(m,{value:i.value,"onUpdate:value":g[4]||(g[4]=C=>i.value=C),language:"json",theme:"vs-light",options:n,onMount:a},null,8,["value"])]),after:yu(()=>[c.value?(Dn(),xb(flt,{key:0,spec:l.value},null,8,["spec"])):(Dn(),hi("div",plt,O1(u.value),1))]),_:1},8,["modelValue"])]),_:1})],64)}}}),fut=L1(glt,[["__scopeId","data-v-98ce7900"]]);export{fut as default};
